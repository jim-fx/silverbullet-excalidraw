var J=Object.defineProperty;var H=(I,g)=>{for(var Z in g)J(I,Z,{get:g[Z],enumerable:!0})};var W=I=>{throw new Error("Not initialized yet")},A=typeof window>"u"&&typeof globalThis.WebSocketPair>"u";typeof Deno>"u"&&(self.Deno={args:[],build:{arch:"x86_64"},env:{get(){}}});var V=new Map,c=0;A&&(globalThis.syscall=async(I,...g)=>await new Promise((Z,C)=>{c++,V.set(c,{resolve:Z,reject:C}),W({type:"sys",id:c,name:I,args:g})}));function Y(I,g,Z){A&&(W=Z,self.addEventListener("message",C=>{(async()=>{let b=C.data;switch(b.type){case"inv":{let m=I[b.name];if(!m)throw new Error(`Function not loaded: ${b.name}`);try{let G=await Promise.resolve(m(...b.args||[]));W({type:"invr",id:b.id,result:G})}catch(G){console.error("An exception was thrown as a result of invoking function",b.name,"error:",G.message),W({type:"invr",id:b.id,error:G.message})}}break;case"sysr":{let m=b.id,G=V.get(m);if(!G)throw Error("Invalid request id");V.delete(m),b.error?G.reject(new Error(b.error)):G.resolve(b.result)}break}})().catch(console.error)}),W({type:"manifest",manifest:g}))}function s(I){let g=atob(I),Z=g.length,C=new Uint8Array(Z);for(let b=0;b<Z;b++)C[b]=g.charCodeAt(b);return C}function X(I){typeof I=="string"&&(I=new TextEncoder().encode(I));let g="",Z=I.byteLength;for(let C=0;C<Z;C++)g+=String.fromCharCode(I[C]);return btoa(g)}async function p(I,g){if(typeof I!="string"){let Z=new Uint8Array(await I.arrayBuffer()),C=Z.length>0?X(Z):void 0;g={method:I.method,headers:Object.fromEntries(I.headers.entries()),base64Body:C},I=I.url}return syscall("sandboxFetch.fetch",I,g)}globalThis.nativeFetch=globalThis.fetch;function N(){globalThis.fetch=async function(I,g){let Z=g&&g.body?X(new Uint8Array(await new Response(g.body).arrayBuffer())):void 0,C=await p(I,g&&{method:g.method,headers:g.headers,base64Body:Z});return new Response(C.base64Body?s(C.base64Body):null,{status:C.status,headers:C.headers})}}A&&N();typeof self>"u"&&(self={syscall:()=>{throw new Error("Not implemented here")}});function l(I,...g){return globalThis.syscall(I,...g)}var d={};H(d,{getFileMeta:()=>Q,listFiles:()=>x,readAsset:()=>w});function z(I){let g=atob(I),Z=g.length,C=new Uint8Array(Z);for(let b=0;b<Z;b++)C[b]=g.charCodeAt(b);return C}function i(I){let g=I.split(",",2)[1];return z(g)}async function w(I,g,Z="utf8"){let C=await l("asset.readAsset",I,g);switch(Z){case"utf8":return new TextDecoder().decode(i(C));case"dataurl":return C}}async function x(I){return await l("asset.listFiles",I)}async function Q(I,g){return await l("asset.getFileMeta",I,g)}var B="development";async function y(){let I=await d.readAsset("excalidraw",`assets/react-dom.${B}.js`),g=await d.readAsset("excalidraw",`assets/react.${B}.js`),Z=await d.readAsset("excalidraw","assets/main.js");return{html:`<link rel="stylesheet" href="https://unpkg.com/excalidraw@0.6.4/dist/excalidraw.min.css">
<script src="https://unpkg.com/@excalidraw/excalidraw@0.18.0/dist/prod/index.js"><\/script>
<div id="app"></div>`,script:`${g}
    ${I}
    ${Z}`}}function R(I){return console.log({bodyText:I}),{html:`
      <style>
        .excalidraw .App-menu_bottom section {
          display: none;
        }
        .disable-zen-mode {
          display: none !important;
       }
      </style>
      <code style="display: none;">${I}</code>
      <div id="app" style="min-height: 500px; overflow: hidden; border-radius: 5px;"/>
    `,script:`
      function onChange(elements, state) {
        sessionStorage.setItem("excalidraw-state", JSON.stringify(state));
        sessionStorage.setItem("excalidraw-elements", JSON.stringify(elements));
        console.log({elements})
      }

      const elements = JSON.parse(document.getElementsByTagName("code")[0]?.innerText||sessionStorage.getItem("excalidraw-elements")||'[]');

      const App = () => {
        const appState = JSON.parse(sessionStorage.getItem("excalidraw-state")||"{}");
        delete appState.collaborators;
        const theme = appState?.theme || "light";

        return React.createElement(
          React.Fragment,
          null,
          React.createElement(
            "div", {
              style: { height: "500px" },
            },
            React.createElement(ExcalidrawLib.Excalidraw, {
              onChange, 
              initialData: { appState, elements }, 
              UIOptions: { canvasActions: { toggleTheme: true }},
              theme
            }),
          ),
        );
      };

    `}}var h={excalidrawWidget:R,ExcalidrawViewer:y},u={name:"excalidraw",version:.1,assets:{"assets/react-dom.production.min.js":{data:"data:application/javascript;base64,LyoqCiAqIEBsaWNlbnNlIFJlYWN0CiAqIHJlYWN0LWRvbS5wcm9kdWN0aW9uLm1pbi5qcwogKgogKiBDb3B5cmlnaHQgKGMpIEZhY2Vib29rLCBJbmMuIGFuZCBpdHMgYWZmaWxpYXRlcy4KICoKICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgZm91bmQgaW4gdGhlCiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS4KICovCihmdW5jdGlvbigpey8qCiBNb2Rlcm5penIgMy4wLjBwcmUgKEN1c3RvbSBCdWlsZCkgfCBNSVQKKi8KJ3VzZSBzdHJpY3QnOyhmdW5jdGlvbihRLHpiKXsib2JqZWN0Ij09PXR5cGVvZiBleHBvcnRzJiYidW5kZWZpbmVkIiE9PXR5cGVvZiBtb2R1bGU/emIoZXhwb3J0cyxyZXF1aXJlKCJyZWFjdCIpKToiZnVuY3Rpb24iPT09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZD9kZWZpbmUoWyJleHBvcnRzIiwicmVhY3QiXSx6Yik6KFE9UXx8c2VsZix6YihRLlJlYWN0RE9NPXt9LFEuUmVhY3QpKX0pKHRoaXMsZnVuY3Rpb24oUSx6Yil7ZnVuY3Rpb24gbShhKXtmb3IodmFyIGI9Imh0dHBzOi8vcmVhY3Rqcy5vcmcvZG9jcy9lcnJvci1kZWNvZGVyLmh0bWw/aW52YXJpYW50PSIrYSxjPTE7Yzxhcmd1bWVudHMubGVuZ3RoO2MrKyliKz0iJmFyZ3NbXT0iK2VuY29kZVVSSUNvbXBvbmVudChhcmd1bWVudHNbY10pO3JldHVybiJNaW5pZmllZCBSZWFjdCBlcnJvciAjIithKyI7IHZpc2l0ICIrYisiIGZvciB0aGUgZnVsbCBtZXNzYWdlIG9yIHVzZSB0aGUgbm9uLW1pbmlmaWVkIGRldiBlbnZpcm9ubWVudCBmb3IgZnVsbCBlcnJvcnMgYW5kIGFkZGl0aW9uYWwgaGVscGZ1bCB3YXJuaW5ncy4ifQpmdW5jdGlvbiBtYihhLGIpe0FiKGEsYik7QWIoYSsiQ2FwdHVyZSIsYil9ZnVuY3Rpb24gQWIoYSxiKXskYlthXT1iO2ZvcihhPTA7YTxiLmxlbmd0aDthKyspY2cuYWRkKGJbYV0pfWZ1bmN0aW9uIGJqKGEpe2lmKFpkLmNhbGwoZGcsYSkpcmV0dXJuITA7aWYoWmQuY2FsbChlZyxhKSlyZXR1cm4hMTtpZihjai50ZXN0KGEpKXJldHVybiBkZ1thXT0hMDtlZ1thXT0hMDtyZXR1cm4hMX1mdW5jdGlvbiBkaihhLGIsYyxkKXtpZihudWxsIT09YyYmMD09PWMudHlwZSlyZXR1cm4hMTtzd2l0Y2godHlwZW9mIGIpe2Nhc2UgImZ1bmN0aW9uIjpjYXNlICJzeW1ib2wiOnJldHVybiEwO2Nhc2UgImJvb2xlYW4iOmlmKGQpcmV0dXJuITE7aWYobnVsbCE9PWMpcmV0dXJuIWMuYWNjZXB0c0Jvb2xlYW5zO2E9YS50b0xvd2VyQ2FzZSgpLnNsaWNlKDAsNSk7cmV0dXJuImRhdGEtIiE9PWEmJiJhcmlhLSIhPT1hO2RlZmF1bHQ6cmV0dXJuITF9fWZ1bmN0aW9uIGVqKGEsYixjLGQpe2lmKG51bGw9PT0KYnx8InVuZGVmaW5lZCI9PT10eXBlb2YgYnx8ZGooYSxiLGMsZCkpcmV0dXJuITA7aWYoZClyZXR1cm4hMTtpZihudWxsIT09Yylzd2l0Y2goYy50eXBlKXtjYXNlIDM6cmV0dXJuIWI7Y2FzZSA0OnJldHVybiExPT09YjtjYXNlIDU6cmV0dXJuIGlzTmFOKGIpO2Nhc2UgNjpyZXR1cm4gaXNOYU4oYil8fDE+Yn1yZXR1cm4hMX1mdW5jdGlvbiBZKGEsYixjLGQsZSxmLGcpe3RoaXMuYWNjZXB0c0Jvb2xlYW5zPTI9PT1ifHwzPT09Ynx8ND09PWI7dGhpcy5hdHRyaWJ1dGVOYW1lPWQ7dGhpcy5hdHRyaWJ1dGVOYW1lc3BhY2U9ZTt0aGlzLm11c3RVc2VQcm9wZXJ0eT1jO3RoaXMucHJvcGVydHlOYW1lPWE7dGhpcy50eXBlPWI7dGhpcy5zYW5pdGl6ZVVSTD1mO3RoaXMucmVtb3ZlRW1wdHlTdHJpbmc9Z31mdW5jdGlvbiAkZChhLGIsYyxkKXt2YXIgZT1SLmhhc093blByb3BlcnR5KGIpP1JbYl06bnVsbDtpZihudWxsIT09ZT8wIT09ZS50eXBlOmR8fCEoMjxiLmxlbmd0aCl8fCJvIiE9PQpiWzBdJiYiTyIhPT1iWzBdfHwibiIhPT1iWzFdJiYiTiIhPT1iWzFdKWVqKGIsYyxlLGQpJiYoYz1udWxsKSxkfHxudWxsPT09ZT9iaihiKSYmKG51bGw9PT1jP2EucmVtb3ZlQXR0cmlidXRlKGIpOmEuc2V0QXR0cmlidXRlKGIsIiIrYykpOmUubXVzdFVzZVByb3BlcnR5P2FbZS5wcm9wZXJ0eU5hbWVdPW51bGw9PT1jPzM9PT1lLnR5cGU/ITE6IiI6YzooYj1lLmF0dHJpYnV0ZU5hbWUsZD1lLmF0dHJpYnV0ZU5hbWVzcGFjZSxudWxsPT09Yz9hLnJlbW92ZUF0dHJpYnV0ZShiKTooZT1lLnR5cGUsYz0zPT09ZXx8ND09PWUmJiEwPT09Yz8iIjoiIitjLGQ/YS5zZXRBdHRyaWJ1dGVOUyhkLGIsYyk6YS5zZXRBdHRyaWJ1dGUoYixjKSkpfWZ1bmN0aW9uIGFjKGEpe2lmKG51bGw9PT1hfHwib2JqZWN0IiE9PXR5cGVvZiBhKXJldHVybiBudWxsO2E9ZmcmJmFbZmddfHxhWyJAQGl0ZXJhdG9yIl07cmV0dXJuImZ1bmN0aW9uIj09PXR5cGVvZiBhP2E6bnVsbH1mdW5jdGlvbiBiYyhhLGIsCmMpe2lmKHZvaWQgMD09PWFlKXRyeXt0aHJvdyBFcnJvcigpO31jYXRjaChkKXthZT0oYj1kLnN0YWNrLnRyaW0oKS5tYXRjaCgvXG4oICooYXQgKT8pLykpJiZiWzFdfHwiIn1yZXR1cm4iXG4iK2FlK2F9ZnVuY3Rpb24gYmUoYSxiKXtpZighYXx8Y2UpcmV0dXJuIiI7Y2U9ITA7dmFyIGM9RXJyb3IucHJlcGFyZVN0YWNrVHJhY2U7RXJyb3IucHJlcGFyZVN0YWNrVHJhY2U9dm9pZCAwO3RyeXtpZihiKWlmKGI9ZnVuY3Rpb24oKXt0aHJvdyBFcnJvcigpO30sT2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLCJwcm9wcyIse3NldDpmdW5jdGlvbigpe3Rocm93IEVycm9yKCk7fX0pLCJvYmplY3QiPT09dHlwZW9mIFJlZmxlY3QmJlJlZmxlY3QuY29uc3RydWN0KXt0cnl7UmVmbGVjdC5jb25zdHJ1Y3QoYixbXSl9Y2F0Y2gobil7dmFyIGQ9bn1SZWZsZWN0LmNvbnN0cnVjdChhLFtdLGIpfWVsc2V7dHJ5e2IuY2FsbCgpfWNhdGNoKG4pe2Q9bn1hLmNhbGwoYi5wcm90b3R5cGUpfWVsc2V7dHJ5e3Rocm93IEVycm9yKCk7Cn1jYXRjaChuKXtkPW59YSgpfX1jYXRjaChuKXtpZihuJiZkJiYic3RyaW5nIj09PXR5cGVvZiBuLnN0YWNrKXtmb3IodmFyIGU9bi5zdGFjay5zcGxpdCgiXG4iKSxmPWQuc3RhY2suc3BsaXQoIlxuIiksZz1lLmxlbmd0aC0xLGg9Zi5sZW5ndGgtMTsxPD1nJiYwPD1oJiZlW2ddIT09ZltoXTspaC0tO2Zvcig7MTw9ZyYmMDw9aDtnLS0saC0tKWlmKGVbZ10hPT1mW2hdKXtpZigxIT09Z3x8MSE9PWgpe2RvIGlmKGctLSxoLS0sMD5ofHxlW2ddIT09ZltoXSl7dmFyIGs9IlxuIitlW2ddLnJlcGxhY2UoIiBhdCBuZXcgIiwiIGF0ICIpO2EuZGlzcGxheU5hbWUmJmsuaW5jbHVkZXMoIjxhbm9ueW1vdXM+IikmJihrPWsucmVwbGFjZSgiPGFub255bW91cz4iLGEuZGlzcGxheU5hbWUpKTtyZXR1cm4ga313aGlsZSgxPD1nJiYwPD1oKX1icmVha319fWZpbmFsbHl7Y2U9ITEsRXJyb3IucHJlcGFyZVN0YWNrVHJhY2U9Y31yZXR1cm4oYT1hP2EuZGlzcGxheU5hbWV8fGEubmFtZToiIik/YmMoYSk6CiIifWZ1bmN0aW9uIGZqKGEpe3N3aXRjaChhLnRhZyl7Y2FzZSA1OnJldHVybiBiYyhhLnR5cGUpO2Nhc2UgMTY6cmV0dXJuIGJjKCJMYXp5Iik7Y2FzZSAxMzpyZXR1cm4gYmMoIlN1c3BlbnNlIik7Y2FzZSAxOTpyZXR1cm4gYmMoIlN1c3BlbnNlTGlzdCIpO2Nhc2UgMDpjYXNlIDI6Y2FzZSAxNTpyZXR1cm4gYT1iZShhLnR5cGUsITEpLGE7Y2FzZSAxMTpyZXR1cm4gYT1iZShhLnR5cGUucmVuZGVyLCExKSxhO2Nhc2UgMTpyZXR1cm4gYT1iZShhLnR5cGUsITApLGE7ZGVmYXVsdDpyZXR1cm4iIn19ZnVuY3Rpb24gZGUoYSl7aWYobnVsbD09YSlyZXR1cm4gbnVsbDtpZigiZnVuY3Rpb24iPT09dHlwZW9mIGEpcmV0dXJuIGEuZGlzcGxheU5hbWV8fGEubmFtZXx8bnVsbDtpZigic3RyaW5nIj09PXR5cGVvZiBhKXJldHVybiBhO3N3aXRjaChhKXtjYXNlIEJiOnJldHVybiJGcmFnbWVudCI7Y2FzZSBDYjpyZXR1cm4iUG9ydGFsIjtjYXNlIGVlOnJldHVybiJQcm9maWxlciI7Y2FzZSBmZTpyZXR1cm4iU3RyaWN0TW9kZSI7CmNhc2UgZ2U6cmV0dXJuIlN1c3BlbnNlIjtjYXNlIGhlOnJldHVybiJTdXNwZW5zZUxpc3QifWlmKCJvYmplY3QiPT09dHlwZW9mIGEpc3dpdGNoKGEuJCR0eXBlb2Ype2Nhc2UgZ2c6cmV0dXJuKGEuZGlzcGxheU5hbWV8fCJDb250ZXh0IikrIi5Db25zdW1lciI7Y2FzZSBoZzpyZXR1cm4oYS5fY29udGV4dC5kaXNwbGF5TmFtZXx8IkNvbnRleHQiKSsiLlByb3ZpZGVyIjtjYXNlIGllOnZhciBiPWEucmVuZGVyO2E9YS5kaXNwbGF5TmFtZTthfHwoYT1iLmRpc3BsYXlOYW1lfHxiLm5hbWV8fCIiLGE9IiIhPT1hPyJGb3J3YXJkUmVmKCIrYSsiKSI6IkZvcndhcmRSZWYiKTtyZXR1cm4gYTtjYXNlIGplOnJldHVybiBiPWEuZGlzcGxheU5hbWV8fG51bGwsbnVsbCE9PWI/YjpkZShhLnR5cGUpfHwiTWVtbyI7Y2FzZSBUYTpiPWEuX3BheWxvYWQ7YT1hLl9pbml0O3RyeXtyZXR1cm4gZGUoYShiKSl9Y2F0Y2goYyl7fX1yZXR1cm4gbnVsbH1mdW5jdGlvbiBnaihhKXt2YXIgYj1hLnR5cGU7CnN3aXRjaChhLnRhZyl7Y2FzZSAyNDpyZXR1cm4iQ2FjaGUiO2Nhc2UgOTpyZXR1cm4oYi5kaXNwbGF5TmFtZXx8IkNvbnRleHQiKSsiLkNvbnN1bWVyIjtjYXNlIDEwOnJldHVybihiLl9jb250ZXh0LmRpc3BsYXlOYW1lfHwiQ29udGV4dCIpKyIuUHJvdmlkZXIiO2Nhc2UgMTg6cmV0dXJuIkRlaHlkcmF0ZWRGcmFnbWVudCI7Y2FzZSAxMTpyZXR1cm4gYT1iLnJlbmRlcixhPWEuZGlzcGxheU5hbWV8fGEubmFtZXx8IiIsYi5kaXNwbGF5TmFtZXx8KCIiIT09YT8iRm9yd2FyZFJlZigiK2ErIikiOiJGb3J3YXJkUmVmIik7Y2FzZSA3OnJldHVybiJGcmFnbWVudCI7Y2FzZSA1OnJldHVybiBiO2Nhc2UgNDpyZXR1cm4iUG9ydGFsIjtjYXNlIDM6cmV0dXJuIlJvb3QiO2Nhc2UgNjpyZXR1cm4iVGV4dCI7Y2FzZSAxNjpyZXR1cm4gZGUoYik7Y2FzZSA4OnJldHVybiBiPT09ZmU/IlN0cmljdE1vZGUiOiJNb2RlIjtjYXNlIDIyOnJldHVybiJPZmZzY3JlZW4iO2Nhc2UgMTI6cmV0dXJuIlByb2ZpbGVyIjsKY2FzZSAyMTpyZXR1cm4iU2NvcGUiO2Nhc2UgMTM6cmV0dXJuIlN1c3BlbnNlIjtjYXNlIDE5OnJldHVybiJTdXNwZW5zZUxpc3QiO2Nhc2UgMjU6cmV0dXJuIlRyYWNpbmdNYXJrZXIiO2Nhc2UgMTpjYXNlIDA6Y2FzZSAxNzpjYXNlIDI6Y2FzZSAxNDpjYXNlIDE1OmlmKCJmdW5jdGlvbiI9PT10eXBlb2YgYilyZXR1cm4gYi5kaXNwbGF5TmFtZXx8Yi5uYW1lfHxudWxsO2lmKCJzdHJpbmciPT09dHlwZW9mIGIpcmV0dXJuIGJ9cmV0dXJuIG51bGx9ZnVuY3Rpb24gVWEoYSl7c3dpdGNoKHR5cGVvZiBhKXtjYXNlICJib29sZWFuIjpjYXNlICJudW1iZXIiOmNhc2UgInN0cmluZyI6Y2FzZSAidW5kZWZpbmVkIjpyZXR1cm4gYTtjYXNlICJvYmplY3QiOnJldHVybiBhO2RlZmF1bHQ6cmV0dXJuIiJ9fWZ1bmN0aW9uIGlnKGEpe3ZhciBiPWEudHlwZTtyZXR1cm4oYT1hLm5vZGVOYW1lKSYmImlucHV0Ij09PWEudG9Mb3dlckNhc2UoKSYmKCJjaGVja2JveCI9PT1ifHwicmFkaW8iPT09CmIpfWZ1bmN0aW9uIGhqKGEpe3ZhciBiPWlnKGEpPyJjaGVja2VkIjoidmFsdWUiLGM9T2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihhLmNvbnN0cnVjdG9yLnByb3RvdHlwZSxiKSxkPSIiK2FbYl07aWYoIWEuaGFzT3duUHJvcGVydHkoYikmJiJ1bmRlZmluZWQiIT09dHlwZW9mIGMmJiJmdW5jdGlvbiI9PT10eXBlb2YgYy5nZXQmJiJmdW5jdGlvbiI9PT10eXBlb2YgYy5zZXQpe3ZhciBlPWMuZ2V0LGY9Yy5zZXQ7T2JqZWN0LmRlZmluZVByb3BlcnR5KGEsYix7Y29uZmlndXJhYmxlOiEwLGdldDpmdW5jdGlvbigpe3JldHVybiBlLmNhbGwodGhpcyl9LHNldDpmdW5jdGlvbihhKXtkPSIiK2E7Zi5jYWxsKHRoaXMsYSl9fSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGEsYix7ZW51bWVyYWJsZTpjLmVudW1lcmFibGV9KTtyZXR1cm57Z2V0VmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gZH0sc2V0VmFsdWU6ZnVuY3Rpb24oYSl7ZD0iIithfSxzdG9wVHJhY2tpbmc6ZnVuY3Rpb24oKXthLl92YWx1ZVRyYWNrZXI9Cm51bGw7ZGVsZXRlIGFbYl19fX19ZnVuY3Rpb24gUGMoYSl7YS5fdmFsdWVUcmFja2VyfHwoYS5fdmFsdWVUcmFja2VyPWhqKGEpKX1mdW5jdGlvbiBqZyhhKXtpZighYSlyZXR1cm4hMTt2YXIgYj1hLl92YWx1ZVRyYWNrZXI7aWYoIWIpcmV0dXJuITA7dmFyIGM9Yi5nZXRWYWx1ZSgpO3ZhciBkPSIiO2EmJihkPWlnKGEpP2EuY2hlY2tlZD8idHJ1ZSI6ImZhbHNlIjphLnZhbHVlKTthPWQ7cmV0dXJuIGEhPT1jPyhiLnNldFZhbHVlKGEpLCEwKTohMX1mdW5jdGlvbiBRYyhhKXthPWF8fCgidW5kZWZpbmVkIiE9PXR5cGVvZiBkb2N1bWVudD9kb2N1bWVudDp2b2lkIDApO2lmKCJ1bmRlZmluZWQiPT09dHlwZW9mIGEpcmV0dXJuIG51bGw7dHJ5e3JldHVybiBhLmFjdGl2ZUVsZW1lbnR8fGEuYm9keX1jYXRjaChiKXtyZXR1cm4gYS5ib2R5fX1mdW5jdGlvbiBrZShhLGIpe3ZhciBjPWIuY2hlY2tlZDtyZXR1cm4gRSh7fSxiLHtkZWZhdWx0Q2hlY2tlZDp2b2lkIDAsZGVmYXVsdFZhbHVlOnZvaWQgMCwKdmFsdWU6dm9pZCAwLGNoZWNrZWQ6bnVsbCE9Yz9jOmEuX3dyYXBwZXJTdGF0ZS5pbml0aWFsQ2hlY2tlZH0pfWZ1bmN0aW9uIGtnKGEsYil7dmFyIGM9bnVsbD09Yi5kZWZhdWx0VmFsdWU/IiI6Yi5kZWZhdWx0VmFsdWUsZD1udWxsIT1iLmNoZWNrZWQ/Yi5jaGVja2VkOmIuZGVmYXVsdENoZWNrZWQ7Yz1VYShudWxsIT1iLnZhbHVlP2IudmFsdWU6Yyk7YS5fd3JhcHBlclN0YXRlPXtpbml0aWFsQ2hlY2tlZDpkLGluaXRpYWxWYWx1ZTpjLGNvbnRyb2xsZWQ6ImNoZWNrYm94Ij09PWIudHlwZXx8InJhZGlvIj09PWIudHlwZT9udWxsIT1iLmNoZWNrZWQ6bnVsbCE9Yi52YWx1ZX19ZnVuY3Rpb24gbGcoYSxiKXtiPWIuY2hlY2tlZDtudWxsIT1iJiYkZChhLCJjaGVja2VkIixiLCExKX1mdW5jdGlvbiBsZShhLGIpe2xnKGEsYik7dmFyIGM9VWEoYi52YWx1ZSksZD1iLnR5cGU7aWYobnVsbCE9YylpZigibnVtYmVyIj09PWQpe2lmKDA9PT1jJiYiIj09PWEudmFsdWV8fGEudmFsdWUhPQpjKWEudmFsdWU9IiIrY31lbHNlIGEudmFsdWUhPT0iIitjJiYoYS52YWx1ZT0iIitjKTtlbHNlIGlmKCJzdWJtaXQiPT09ZHx8InJlc2V0Ij09PWQpe2EucmVtb3ZlQXR0cmlidXRlKCJ2YWx1ZSIpO3JldHVybn1iLmhhc093blByb3BlcnR5KCJ2YWx1ZSIpP21lKGEsYi50eXBlLGMpOmIuaGFzT3duUHJvcGVydHkoImRlZmF1bHRWYWx1ZSIpJiZtZShhLGIudHlwZSxVYShiLmRlZmF1bHRWYWx1ZSkpO251bGw9PWIuY2hlY2tlZCYmbnVsbCE9Yi5kZWZhdWx0Q2hlY2tlZCYmKGEuZGVmYXVsdENoZWNrZWQ9ISFiLmRlZmF1bHRDaGVja2VkKX1mdW5jdGlvbiBtZyhhLGIsYyl7aWYoYi5oYXNPd25Qcm9wZXJ0eSgidmFsdWUiKXx8Yi5oYXNPd25Qcm9wZXJ0eSgiZGVmYXVsdFZhbHVlIikpe3ZhciBkPWIudHlwZTtpZighKCJzdWJtaXQiIT09ZCYmInJlc2V0IiE9PWR8fHZvaWQgMCE9PWIudmFsdWUmJm51bGwhPT1iLnZhbHVlKSlyZXR1cm47Yj0iIithLl93cmFwcGVyU3RhdGUuaW5pdGlhbFZhbHVlOwpjfHxiPT09YS52YWx1ZXx8KGEudmFsdWU9Yik7YS5kZWZhdWx0VmFsdWU9Yn1jPWEubmFtZTsiIiE9PWMmJihhLm5hbWU9IiIpO2EuZGVmYXVsdENoZWNrZWQ9ISFhLl93cmFwcGVyU3RhdGUuaW5pdGlhbENoZWNrZWQ7IiIhPT1jJiYoYS5uYW1lPWMpfWZ1bmN0aW9uIG1lKGEsYixjKXtpZigibnVtYmVyIiE9PWJ8fFFjKGEub3duZXJEb2N1bWVudCkhPT1hKW51bGw9PWM/YS5kZWZhdWx0VmFsdWU9IiIrYS5fd3JhcHBlclN0YXRlLmluaXRpYWxWYWx1ZTphLmRlZmF1bHRWYWx1ZSE9PSIiK2MmJihhLmRlZmF1bHRWYWx1ZT0iIitjKX1mdW5jdGlvbiBEYihhLGIsYyxkKXthPWEub3B0aW9ucztpZihiKXtiPXt9O2Zvcih2YXIgZT0wO2U8Yy5sZW5ndGg7ZSsrKWJbIiQiK2NbZV1dPSEwO2ZvcihjPTA7YzxhLmxlbmd0aDtjKyspZT1iLmhhc093blByb3BlcnR5KCIkIithW2NdLnZhbHVlKSxhW2NdLnNlbGVjdGVkIT09ZSYmKGFbY10uc2VsZWN0ZWQ9ZSksZSYmZCYmKGFbY10uZGVmYXVsdFNlbGVjdGVkPQohMCl9ZWxzZXtjPSIiK1VhKGMpO2I9bnVsbDtmb3IoZT0wO2U8YS5sZW5ndGg7ZSsrKXtpZihhW2VdLnZhbHVlPT09Yyl7YVtlXS5zZWxlY3RlZD0hMDtkJiYoYVtlXS5kZWZhdWx0U2VsZWN0ZWQ9ITApO3JldHVybn1udWxsIT09Ynx8YVtlXS5kaXNhYmxlZHx8KGI9YVtlXSl9bnVsbCE9PWImJihiLnNlbGVjdGVkPSEwKX19ZnVuY3Rpb24gbmUoYSxiKXtpZihudWxsIT1iLmRhbmdlcm91c2x5U2V0SW5uZXJIVE1MKXRocm93IEVycm9yKG0oOTEpKTtyZXR1cm4gRSh7fSxiLHt2YWx1ZTp2b2lkIDAsZGVmYXVsdFZhbHVlOnZvaWQgMCxjaGlsZHJlbjoiIithLl93cmFwcGVyU3RhdGUuaW5pdGlhbFZhbHVlfSl9ZnVuY3Rpb24gbmcoYSxiKXt2YXIgYz1iLnZhbHVlO2lmKG51bGw9PWMpe2M9Yi5jaGlsZHJlbjtiPWIuZGVmYXVsdFZhbHVlO2lmKG51bGwhPWMpe2lmKG51bGwhPWIpdGhyb3cgRXJyb3IobSg5MikpO2lmKGNjKGMpKXtpZigxPGMubGVuZ3RoKXRocm93IEVycm9yKG0oOTMpKTsKYz1jWzBdfWI9Y31udWxsPT1iJiYoYj0iIik7Yz1ifWEuX3dyYXBwZXJTdGF0ZT17aW5pdGlhbFZhbHVlOlVhKGMpfX1mdW5jdGlvbiBvZyhhLGIpe3ZhciBjPVVhKGIudmFsdWUpLGQ9VWEoYi5kZWZhdWx0VmFsdWUpO251bGwhPWMmJihjPSIiK2MsYyE9PWEudmFsdWUmJihhLnZhbHVlPWMpLG51bGw9PWIuZGVmYXVsdFZhbHVlJiZhLmRlZmF1bHRWYWx1ZSE9PWMmJihhLmRlZmF1bHRWYWx1ZT1jKSk7bnVsbCE9ZCYmKGEuZGVmYXVsdFZhbHVlPSIiK2QpfWZ1bmN0aW9uIHBnKGEsYil7Yj1hLnRleHRDb250ZW50O2I9PT1hLl93cmFwcGVyU3RhdGUuaW5pdGlhbFZhbHVlJiYiIiE9PWImJm51bGwhPT1iJiYoYS52YWx1ZT1iKX1mdW5jdGlvbiBxZyhhKXtzd2l0Y2goYSl7Y2FzZSAic3ZnIjpyZXR1cm4iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciO2Nhc2UgIm1hdGgiOnJldHVybiJodHRwOi8vd3d3LnczLm9yZy8xOTk4L01hdGgvTWF0aE1MIjtkZWZhdWx0OnJldHVybiJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIn19CmZ1bmN0aW9uIG9lKGEsYil7cmV0dXJuIG51bGw9PWF8fCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj09PWE/cWcoYik6Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj09PWEmJiJmb3JlaWduT2JqZWN0Ij09PWI/Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiOmF9ZnVuY3Rpb24gcmcoYSxiLGMpe3JldHVybiBudWxsPT1ifHwiYm9vbGVhbiI9PT10eXBlb2YgYnx8IiI9PT1iPyIiOmN8fCJudW1iZXIiIT09dHlwZW9mIGJ8fDA9PT1ifHxkYy5oYXNPd25Qcm9wZXJ0eShhKSYmZGNbYV0/KCIiK2IpLnRyaW0oKTpiKyJweCJ9ZnVuY3Rpb24gc2coYSxiKXthPWEuc3R5bGU7Zm9yKHZhciBjIGluIGIpaWYoYi5oYXNPd25Qcm9wZXJ0eShjKSl7dmFyIGQ9MD09PWMuaW5kZXhPZigiLS0iKSxlPXJnKGMsYltjXSxkKTsiZmxvYXQiPT09YyYmKGM9ImNzc0Zsb2F0Iik7ZD9hLnNldFByb3BlcnR5KGMsZSk6YVtjXT1lfX1mdW5jdGlvbiBwZShhLGIpe2lmKGIpe2lmKGlqW2FdJiYKKG51bGwhPWIuY2hpbGRyZW58fG51bGwhPWIuZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUwpKXRocm93IEVycm9yKG0oMTM3LGEpKTtpZihudWxsIT1iLmRhbmdlcm91c2x5U2V0SW5uZXJIVE1MKXtpZihudWxsIT1iLmNoaWxkcmVuKXRocm93IEVycm9yKG0oNjApKTtpZigib2JqZWN0IiE9PXR5cGVvZiBiLmRhbmdlcm91c2x5U2V0SW5uZXJIVE1MfHwhKCJfX2h0bWwiaW4gYi5kYW5nZXJvdXNseVNldElubmVySFRNTCkpdGhyb3cgRXJyb3IobSg2MSkpO31pZihudWxsIT1iLnN0eWxlJiYib2JqZWN0IiE9PXR5cGVvZiBiLnN0eWxlKXRocm93IEVycm9yKG0oNjIpKTt9fWZ1bmN0aW9uIHFlKGEsYil7aWYoLTE9PT1hLmluZGV4T2YoIi0iKSlyZXR1cm4ic3RyaW5nIj09PXR5cGVvZiBiLmlzO3N3aXRjaChhKXtjYXNlICJhbm5vdGF0aW9uLXhtbCI6Y2FzZSAiY29sb3ItcHJvZmlsZSI6Y2FzZSAiZm9udC1mYWNlIjpjYXNlICJmb250LWZhY2Utc3JjIjpjYXNlICJmb250LWZhY2UtdXJpIjpjYXNlICJmb250LWZhY2UtZm9ybWF0IjpjYXNlICJmb250LWZhY2UtbmFtZSI6Y2FzZSAibWlzc2luZy1nbHlwaCI6cmV0dXJuITE7CmRlZmF1bHQ6cmV0dXJuITB9fWZ1bmN0aW9uIHJlKGEpe2E9YS50YXJnZXR8fGEuc3JjRWxlbWVudHx8d2luZG93O2EuY29ycmVzcG9uZGluZ1VzZUVsZW1lbnQmJihhPWEuY29ycmVzcG9uZGluZ1VzZUVsZW1lbnQpO3JldHVybiAzPT09YS5ub2RlVHlwZT9hLnBhcmVudE5vZGU6YX1mdW5jdGlvbiB0ZyhhKXtpZihhPWVjKGEpKXtpZigiZnVuY3Rpb24iIT09dHlwZW9mIHNlKXRocm93IEVycm9yKG0oMjgwKSk7dmFyIGI9YS5zdGF0ZU5vZGU7YiYmKGI9UmMoYiksc2UoYS5zdGF0ZU5vZGUsYS50eXBlLGIpKX19ZnVuY3Rpb24gdWcoYSl7RWI/RmI/RmIucHVzaChhKTpGYj1bYV06RWI9YX1mdW5jdGlvbiB2Zygpe2lmKEViKXt2YXIgYT1FYixiPUZiO0ZiPUViPW51bGw7dGcoYSk7aWYoYilmb3IoYT0wO2E8Yi5sZW5ndGg7YSsrKXRnKGJbYV0pfX1mdW5jdGlvbiB3ZyhhLGIsYyl7aWYodGUpcmV0dXJuIGEoYixjKTt0ZT0hMDt0cnl7cmV0dXJuIHhnKGEsYixjKX1maW5hbGx5e2lmKHRlPQohMSxudWxsIT09RWJ8fG51bGwhPT1GYil5ZygpLHZnKCl9fWZ1bmN0aW9uIGZjKGEsYil7dmFyIGM9YS5zdGF0ZU5vZGU7aWYobnVsbD09PWMpcmV0dXJuIG51bGw7dmFyIGQ9UmMoYyk7aWYobnVsbD09PWQpcmV0dXJuIG51bGw7Yz1kW2JdO2E6c3dpdGNoKGIpe2Nhc2UgIm9uQ2xpY2siOmNhc2UgIm9uQ2xpY2tDYXB0dXJlIjpjYXNlICJvbkRvdWJsZUNsaWNrIjpjYXNlICJvbkRvdWJsZUNsaWNrQ2FwdHVyZSI6Y2FzZSAib25Nb3VzZURvd24iOmNhc2UgIm9uTW91c2VEb3duQ2FwdHVyZSI6Y2FzZSAib25Nb3VzZU1vdmUiOmNhc2UgIm9uTW91c2VNb3ZlQ2FwdHVyZSI6Y2FzZSAib25Nb3VzZVVwIjpjYXNlICJvbk1vdXNlVXBDYXB0dXJlIjpjYXNlICJvbk1vdXNlRW50ZXIiOihkPSFkLmRpc2FibGVkKXx8KGE9YS50eXBlLGQ9ISgiYnV0dG9uIj09PWF8fCJpbnB1dCI9PT1hfHwic2VsZWN0Ij09PWF8fCJ0ZXh0YXJlYSI9PT1hKSk7YT0hZDticmVhayBhO2RlZmF1bHQ6YT0hMX1pZihhKXJldHVybiBudWxsOwppZihjJiYiZnVuY3Rpb24iIT09dHlwZW9mIGMpdGhyb3cgRXJyb3IobSgyMzEsYix0eXBlb2YgYykpO3JldHVybiBjfWZ1bmN0aW9uIGpqKGEsYixjLGQsZSxmLGcsaCxrKXtnYz0hMTtTYz1udWxsO2tqLmFwcGx5KGxqLGFyZ3VtZW50cyl9ZnVuY3Rpb24gbWooYSxiLGMsZCxlLGYsZyxoLGspe2pqLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtpZihnYyl7aWYoZ2Mpe3ZhciBuPVNjO2djPSExO1NjPW51bGx9ZWxzZSB0aHJvdyBFcnJvcihtKDE5OCkpO1RjfHwoVGM9ITAsdWU9bil9fWZ1bmN0aW9uIG5iKGEpe3ZhciBiPWEsYz1hO2lmKGEuYWx0ZXJuYXRlKWZvcig7Yi5yZXR1cm47KWI9Yi5yZXR1cm47ZWxzZXthPWI7ZG8gYj1hLDAhPT0oYi5mbGFncyY0MDk4KSYmKGM9Yi5yZXR1cm4pLGE9Yi5yZXR1cm47d2hpbGUoYSl9cmV0dXJuIDM9PT1iLnRhZz9jOm51bGx9ZnVuY3Rpb24gemcoYSl7aWYoMTM9PT1hLnRhZyl7dmFyIGI9YS5tZW1vaXplZFN0YXRlO251bGw9PT1iJiYoYT1hLmFsdGVybmF0ZSwKbnVsbCE9PWEmJihiPWEubWVtb2l6ZWRTdGF0ZSkpO2lmKG51bGwhPT1iKXJldHVybiBiLmRlaHlkcmF0ZWR9cmV0dXJuIG51bGx9ZnVuY3Rpb24gQWcoYSl7aWYobmIoYSkhPT1hKXRocm93IEVycm9yKG0oMTg4KSk7fWZ1bmN0aW9uIG5qKGEpe3ZhciBiPWEuYWx0ZXJuYXRlO2lmKCFiKXtiPW5iKGEpO2lmKG51bGw9PT1iKXRocm93IEVycm9yKG0oMTg4KSk7cmV0dXJuIGIhPT1hP251bGw6YX1mb3IodmFyIGM9YSxkPWI7Oyl7dmFyIGU9Yy5yZXR1cm47aWYobnVsbD09PWUpYnJlYWs7dmFyIGY9ZS5hbHRlcm5hdGU7aWYobnVsbD09PWYpe2Q9ZS5yZXR1cm47aWYobnVsbCE9PWQpe2M9ZDtjb250aW51ZX1icmVha31pZihlLmNoaWxkPT09Zi5jaGlsZCl7Zm9yKGY9ZS5jaGlsZDtmOyl7aWYoZj09PWMpcmV0dXJuIEFnKGUpLGE7aWYoZj09PWQpcmV0dXJuIEFnKGUpLGI7Zj1mLnNpYmxpbmd9dGhyb3cgRXJyb3IobSgxODgpKTt9aWYoYy5yZXR1cm4hPT1kLnJldHVybiljPWUsZD1mOwplbHNle2Zvcih2YXIgZz0hMSxoPWUuY2hpbGQ7aDspe2lmKGg9PT1jKXtnPSEwO2M9ZTtkPWY7YnJlYWt9aWYoaD09PWQpe2c9ITA7ZD1lO2M9ZjticmVha31oPWguc2libGluZ31pZighZyl7Zm9yKGg9Zi5jaGlsZDtoOyl7aWYoaD09PWMpe2c9ITA7Yz1mO2Q9ZTticmVha31pZihoPT09ZCl7Zz0hMDtkPWY7Yz1lO2JyZWFrfWg9aC5zaWJsaW5nfWlmKCFnKXRocm93IEVycm9yKG0oMTg5KSk7fX1pZihjLmFsdGVybmF0ZSE9PWQpdGhyb3cgRXJyb3IobSgxOTApKTt9aWYoMyE9PWMudGFnKXRocm93IEVycm9yKG0oMTg4KSk7cmV0dXJuIGMuc3RhdGVOb2RlLmN1cnJlbnQ9PT1jP2E6Yn1mdW5jdGlvbiBCZyhhKXthPW5qKGEpO3JldHVybiBudWxsIT09YT9DZyhhKTpudWxsfWZ1bmN0aW9uIENnKGEpe2lmKDU9PT1hLnRhZ3x8Nj09PWEudGFnKXJldHVybiBhO2ZvcihhPWEuY2hpbGQ7bnVsbCE9PWE7KXt2YXIgYj1DZyhhKTtpZihudWxsIT09YilyZXR1cm4gYjthPWEuc2libGluZ31yZXR1cm4gbnVsbH0KZnVuY3Rpb24gb2ooYSxiKXtpZihDYSYmImZ1bmN0aW9uIj09PXR5cGVvZiBDYS5vbkNvbW1pdEZpYmVyUm9vdCl0cnl7Q2Eub25Db21taXRGaWJlclJvb3QoVWMsYSx2b2lkIDAsMTI4PT09KGEuY3VycmVudC5mbGFncyYxMjgpKX1jYXRjaChjKXt9fWZ1bmN0aW9uIHBqKGEpe2E+Pj49MDtyZXR1cm4gMD09PWE/MzI6MzEtKHFqKGEpL3JqfDApfDB9ZnVuY3Rpb24gaGMoYSl7c3dpdGNoKGEmLWEpe2Nhc2UgMTpyZXR1cm4gMTtjYXNlIDI6cmV0dXJuIDI7Y2FzZSA0OnJldHVybiA0O2Nhc2UgODpyZXR1cm4gODtjYXNlIDE2OnJldHVybiAxNjtjYXNlIDMyOnJldHVybiAzMjtjYXNlIDY0OmNhc2UgMTI4OmNhc2UgMjU2OmNhc2UgNTEyOmNhc2UgMTAyNDpjYXNlIDIwNDg6Y2FzZSA0MDk2OmNhc2UgODE5MjpjYXNlIDE2Mzg0OmNhc2UgMzI3Njg6Y2FzZSA2NTUzNjpjYXNlIDEzMTA3MjpjYXNlIDI2MjE0NDpjYXNlIDUyNDI4ODpjYXNlIDEwNDg1NzY6Y2FzZSAyMDk3MTUyOnJldHVybiBhJgo0MTk0MjQwO2Nhc2UgNDE5NDMwNDpjYXNlIDgzODg2MDg6Y2FzZSAxNjc3NzIxNjpjYXNlIDMzNTU0NDMyOmNhc2UgNjcxMDg4NjQ6cmV0dXJuIGEmMTMwMDIzNDI0O2Nhc2UgMTM0MjE3NzI4OnJldHVybiAxMzQyMTc3Mjg7Y2FzZSAyNjg0MzU0NTY6cmV0dXJuIDI2ODQzNTQ1NjtjYXNlIDUzNjg3MDkxMjpyZXR1cm4gNTM2ODcwOTEyO2Nhc2UgMTA3Mzc0MTgyNDpyZXR1cm4gMTA3Mzc0MTgyNDtkZWZhdWx0OnJldHVybiBhfX1mdW5jdGlvbiBWYyhhLGIpe3ZhciBjPWEucGVuZGluZ0xhbmVzO2lmKDA9PT1jKXJldHVybiAwO3ZhciBkPTAsZT1hLnN1c3BlbmRlZExhbmVzLGY9YS5waW5nZWRMYW5lcyxnPWMmMjY4NDM1NDU1O2lmKDAhPT1nKXt2YXIgaD1nJn5lOzAhPT1oP2Q9aGMoaCk6KGYmPWcsMCE9PWYmJihkPWhjKGYpKSl9ZWxzZSBnPWMmfmUsMCE9PWc/ZD1oYyhnKTowIT09ZiYmKGQ9aGMoZikpO2lmKDA9PT1kKXJldHVybiAwO2lmKDAhPT1iJiZiIT09ZCYmMD09PShiJmUpJiYKKGU9ZCYtZCxmPWImLWIsZT49Znx8MTY9PT1lJiYwIT09KGYmNDE5NDI0MCkpKXJldHVybiBiOzAhPT0oZCY0KSYmKGR8PWMmMTYpO2I9YS5lbnRhbmdsZWRMYW5lcztpZigwIT09Yilmb3IoYT1hLmVudGFuZ2xlbWVudHMsYiY9ZDswPGI7KWM9MzEtdGEoYiksZT0xPDxjLGR8PWFbY10sYiY9fmU7cmV0dXJuIGR9ZnVuY3Rpb24gc2ooYSxiKXtzd2l0Y2goYSl7Y2FzZSAxOmNhc2UgMjpjYXNlIDQ6cmV0dXJuIGIrMjUwO2Nhc2UgODpjYXNlIDE2OmNhc2UgMzI6Y2FzZSA2NDpjYXNlIDEyODpjYXNlIDI1NjpjYXNlIDUxMjpjYXNlIDEwMjQ6Y2FzZSAyMDQ4OmNhc2UgNDA5NjpjYXNlIDgxOTI6Y2FzZSAxNjM4NDpjYXNlIDMyNzY4OmNhc2UgNjU1MzY6Y2FzZSAxMzEwNzI6Y2FzZSAyNjIxNDQ6Y2FzZSA1MjQyODg6Y2FzZSAxMDQ4NTc2OmNhc2UgMjA5NzE1MjpyZXR1cm4gYis1RTM7Y2FzZSA0MTk0MzA0OmNhc2UgODM4ODYwODpjYXNlIDE2Nzc3MjE2OmNhc2UgMzM1NTQ0MzI6Y2FzZSA2NzEwODg2NDpyZXR1cm4tMTsKY2FzZSAxMzQyMTc3Mjg6Y2FzZSAyNjg0MzU0NTY6Y2FzZSA1MzY4NzA5MTI6Y2FzZSAxMDczNzQxODI0OnJldHVybi0xO2RlZmF1bHQ6cmV0dXJuLTF9fWZ1bmN0aW9uIHRqKGEsYil7Zm9yKHZhciBjPWEuc3VzcGVuZGVkTGFuZXMsZD1hLnBpbmdlZExhbmVzLGU9YS5leHBpcmF0aW9uVGltZXMsZj1hLnBlbmRpbmdMYW5lczswPGY7KXt2YXIgZz0zMS10YShmKSxoPTE8PGcsaz1lW2ddO2lmKC0xPT09ayl7aWYoMD09PShoJmMpfHwwIT09KGgmZCkpZVtnXT1zaihoLGIpfWVsc2Ugazw9YiYmKGEuZXhwaXJlZExhbmVzfD1oKTtmJj1+aH19ZnVuY3Rpb24gdmUoYSl7YT1hLnBlbmRpbmdMYW5lcyYtMTA3Mzc0MTgyNTtyZXR1cm4gMCE9PWE/YTphJjEwNzM3NDE4MjQ/MTA3Mzc0MTgyNDowfWZ1bmN0aW9uIERnKCl7dmFyIGE9V2M7V2M8PD0xOzA9PT0oV2MmNDE5NDI0MCkmJihXYz02NCk7cmV0dXJuIGF9ZnVuY3Rpb24gd2UoYSl7Zm9yKHZhciBiPVtdLGM9MDszMT5jO2MrKyliLnB1c2goYSk7CnJldHVybiBifWZ1bmN0aW9uIGljKGEsYixjKXthLnBlbmRpbmdMYW5lc3w9Yjs1MzY4NzA5MTIhPT1iJiYoYS5zdXNwZW5kZWRMYW5lcz0wLGEucGluZ2VkTGFuZXM9MCk7YT1hLmV2ZW50VGltZXM7Yj0zMS10YShiKTthW2JdPWN9ZnVuY3Rpb24gdWooYSxiKXt2YXIgYz1hLnBlbmRpbmdMYW5lcyZ+YjthLnBlbmRpbmdMYW5lcz1iO2Euc3VzcGVuZGVkTGFuZXM9MDthLnBpbmdlZExhbmVzPTA7YS5leHBpcmVkTGFuZXMmPWI7YS5tdXRhYmxlUmVhZExhbmVzJj1iO2EuZW50YW5nbGVkTGFuZXMmPWI7Yj1hLmVudGFuZ2xlbWVudHM7dmFyIGQ9YS5ldmVudFRpbWVzO2ZvcihhPWEuZXhwaXJhdGlvblRpbWVzOzA8Yzspe3ZhciBlPTMxLXRhKGMpLGY9MTw8ZTtiW2VdPTA7ZFtlXT0tMTthW2VdPS0xO2MmPX5mfX1mdW5jdGlvbiB4ZShhLGIpe3ZhciBjPWEuZW50YW5nbGVkTGFuZXN8PWI7Zm9yKGE9YS5lbnRhbmdsZW1lbnRzO2M7KXt2YXIgZD0zMS10YShjKSxlPTE8PGQ7ZSZifGFbZF0mCmImJihhW2RdfD1iKTtjJj1+ZX19ZnVuY3Rpb24gRWcoYSl7YSY9LWE7cmV0dXJuIDE8YT80PGE/MCE9PShhJjI2ODQzNTQ1NSk/MTY6NTM2ODcwOTEyOjQ6MX1mdW5jdGlvbiBGZyhhLGIpe3N3aXRjaChhKXtjYXNlICJmb2N1c2luIjpjYXNlICJmb2N1c291dCI6VmE9bnVsbDticmVhaztjYXNlICJkcmFnZW50ZXIiOmNhc2UgImRyYWdsZWF2ZSI6V2E9bnVsbDticmVhaztjYXNlICJtb3VzZW92ZXIiOmNhc2UgIm1vdXNlb3V0IjpYYT1udWxsO2JyZWFrO2Nhc2UgInBvaW50ZXJvdmVyIjpjYXNlICJwb2ludGVyb3V0IjpqYy5kZWxldGUoYi5wb2ludGVySWQpO2JyZWFrO2Nhc2UgImdvdHBvaW50ZXJjYXB0dXJlIjpjYXNlICJsb3N0cG9pbnRlcmNhcHR1cmUiOmtjLmRlbGV0ZShiLnBvaW50ZXJJZCl9fWZ1bmN0aW9uIGxjKGEsYixjLGQsZSxmKXtpZihudWxsPT09YXx8YS5uYXRpdmVFdmVudCE9PWYpcmV0dXJuIGE9e2Jsb2NrZWRPbjpiLGRvbUV2ZW50TmFtZTpjLGV2ZW50U3lzdGVtRmxhZ3M6ZCwKbmF0aXZlRXZlbnQ6Zix0YXJnZXRDb250YWluZXJzOltlXX0sbnVsbCE9PWImJihiPWVjKGIpLG51bGwhPT1iJiZHZyhiKSksYTthLmV2ZW50U3lzdGVtRmxhZ3N8PWQ7Yj1hLnRhcmdldENvbnRhaW5lcnM7bnVsbCE9PWUmJi0xPT09Yi5pbmRleE9mKGUpJiZiLnB1c2goZSk7cmV0dXJuIGF9ZnVuY3Rpb24gdmooYSxiLGMsZCxlKXtzd2l0Y2goYil7Y2FzZSAiZm9jdXNpbiI6cmV0dXJuIFZhPWxjKFZhLGEsYixjLGQsZSksITA7Y2FzZSAiZHJhZ2VudGVyIjpyZXR1cm4gV2E9bGMoV2EsYSxiLGMsZCxlKSwhMDtjYXNlICJtb3VzZW92ZXIiOnJldHVybiBYYT1sYyhYYSxhLGIsYyxkLGUpLCEwO2Nhc2UgInBvaW50ZXJvdmVyIjp2YXIgZj1lLnBvaW50ZXJJZDtqYy5zZXQoZixsYyhqYy5nZXQoZil8fG51bGwsYSxiLGMsZCxlKSk7cmV0dXJuITA7Y2FzZSAiZ290cG9pbnRlcmNhcHR1cmUiOnJldHVybiBmPWUucG9pbnRlcklkLGtjLnNldChmLGxjKGtjLmdldChmKXx8bnVsbCxhLGIsCmMsZCxlKSksITB9cmV0dXJuITF9ZnVuY3Rpb24gSGcoYSl7dmFyIGI9b2IoYS50YXJnZXQpO2lmKG51bGwhPT1iKXt2YXIgYz1uYihiKTtpZihudWxsIT09YylpZihiPWMudGFnLDEzPT09Yil7aWYoYj16ZyhjKSxudWxsIT09Yil7YS5ibG9ja2VkT249Yjt3aihhLnByaW9yaXR5LGZ1bmN0aW9uKCl7eGooYyl9KTtyZXR1cm59fWVsc2UgaWYoMz09PWImJmMuc3RhdGVOb2RlLmN1cnJlbnQubWVtb2l6ZWRTdGF0ZS5pc0RlaHlkcmF0ZWQpe2EuYmxvY2tlZE9uPTM9PT1jLnRhZz9jLnN0YXRlTm9kZS5jb250YWluZXJJbmZvOm51bGw7cmV0dXJufX1hLmJsb2NrZWRPbj1udWxsfWZ1bmN0aW9uIFhjKGEpe2lmKG51bGwhPT1hLmJsb2NrZWRPbilyZXR1cm4hMTtmb3IodmFyIGI9YS50YXJnZXRDb250YWluZXJzOzA8Yi5sZW5ndGg7KXt2YXIgYz15ZShhLmRvbUV2ZW50TmFtZSxhLmV2ZW50U3lzdGVtRmxhZ3MsYlswXSxhLm5hdGl2ZUV2ZW50KTtpZihudWxsPT09Yyl7Yz1hLm5hdGl2ZUV2ZW50Owp2YXIgZD1uZXcgYy5jb25zdHJ1Y3RvcihjLnR5cGUsYyk7emU9ZDtjLnRhcmdldC5kaXNwYXRjaEV2ZW50KGQpO3plPW51bGx9ZWxzZSByZXR1cm4gYj1lYyhjKSxudWxsIT09YiYmR2coYiksYS5ibG9ja2VkT249YywhMTtiLnNoaWZ0KCl9cmV0dXJuITB9ZnVuY3Rpb24gSWcoYSxiLGMpe1hjKGEpJiZjLmRlbGV0ZShiKX1mdW5jdGlvbiB5aigpe0FlPSExO251bGwhPT1WYSYmWGMoVmEpJiYoVmE9bnVsbCk7bnVsbCE9PVdhJiZYYyhXYSkmJihXYT1udWxsKTtudWxsIT09WGEmJlhjKFhhKSYmKFhhPW51bGwpO2pjLmZvckVhY2goSWcpO2tjLmZvckVhY2goSWcpfWZ1bmN0aW9uIG1jKGEsYil7YS5ibG9ja2VkT249PT1iJiYoYS5ibG9ja2VkT249bnVsbCxBZXx8KEFlPSEwLEpnKEtnLHlqKSkpfWZ1bmN0aW9uIG5jKGEpe2lmKDA8WWMubGVuZ3RoKXttYyhZY1swXSxhKTtmb3IodmFyIGI9MTtiPFljLmxlbmd0aDtiKyspe3ZhciBjPVljW2JdO2MuYmxvY2tlZE9uPT09YSYmKGMuYmxvY2tlZE9uPQpudWxsKX19bnVsbCE9PVZhJiZtYyhWYSxhKTtudWxsIT09V2EmJm1jKFdhLGEpO251bGwhPT1YYSYmbWMoWGEsYSk7Yj1mdW5jdGlvbihiKXtyZXR1cm4gbWMoYixhKX07amMuZm9yRWFjaChiKTtrYy5mb3JFYWNoKGIpO2ZvcihiPTA7YjxZYS5sZW5ndGg7YisrKWM9WWFbYl0sYy5ibG9ja2VkT249PT1hJiYoYy5ibG9ja2VkT249bnVsbCk7Zm9yKDswPFlhLmxlbmd0aCYmKGI9WWFbMF0sbnVsbD09PWIuYmxvY2tlZE9uKTspSGcoYiksbnVsbD09PWIuYmxvY2tlZE9uJiZZYS5zaGlmdCgpfWZ1bmN0aW9uIHpqKGEsYixjLGQpe3ZhciBlPXosZj1HYi50cmFuc2l0aW9uO0diLnRyYW5zaXRpb249bnVsbDt0cnl7ej0xLEJlKGEsYixjLGQpfWZpbmFsbHl7ej1lLEdiLnRyYW5zaXRpb249Zn19ZnVuY3Rpb24gQWooYSxiLGMsZCl7dmFyIGU9eixmPUdiLnRyYW5zaXRpb247R2IudHJhbnNpdGlvbj1udWxsO3RyeXt6PTQsQmUoYSxiLGMsZCl9ZmluYWxseXt6PWUsR2IudHJhbnNpdGlvbj0KZn19ZnVuY3Rpb24gQmUoYSxiLGMsZCl7aWYoWmMpe3ZhciBlPXllKGEsYixjLGQpO2lmKG51bGw9PT1lKUNlKGEsYixkLCRjLGMpLEZnKGEsZCk7ZWxzZSBpZih2aihlLGEsYixjLGQpKWQuc3RvcFByb3BhZ2F0aW9uKCk7ZWxzZSBpZihGZyhhLGQpLGImNCYmLTE8QmouaW5kZXhPZihhKSl7Zm9yKDtudWxsIT09ZTspe3ZhciBmPWVjKGUpO251bGwhPT1mJiZDaihmKTtmPXllKGEsYixjLGQpO251bGw9PT1mJiZDZShhLGIsZCwkYyxjKTtpZihmPT09ZSlicmVhaztlPWZ9bnVsbCE9PWUmJmQuc3RvcFByb3BhZ2F0aW9uKCl9ZWxzZSBDZShhLGIsZCxudWxsLGMpfX1mdW5jdGlvbiB5ZShhLGIsYyxkKXskYz1udWxsO2E9cmUoZCk7YT1vYihhKTtpZihudWxsIT09YSlpZihiPW5iKGEpLG51bGw9PT1iKWE9bnVsbDtlbHNlIGlmKGM9Yi50YWcsMTM9PT1jKXthPXpnKGIpO2lmKG51bGwhPT1hKXJldHVybiBhO2E9bnVsbH1lbHNlIGlmKDM9PT1jKXtpZihiLnN0YXRlTm9kZS5jdXJyZW50Lm1lbW9pemVkU3RhdGUuaXNEZWh5ZHJhdGVkKXJldHVybiAzPT09CmIudGFnP2Iuc3RhdGVOb2RlLmNvbnRhaW5lckluZm86bnVsbDthPW51bGx9ZWxzZSBiIT09YSYmKGE9bnVsbCk7JGM9YTtyZXR1cm4gbnVsbH1mdW5jdGlvbiBMZyhhKXtzd2l0Y2goYSl7Y2FzZSAiY2FuY2VsIjpjYXNlICJjbGljayI6Y2FzZSAiY2xvc2UiOmNhc2UgImNvbnRleHRtZW51IjpjYXNlICJjb3B5IjpjYXNlICJjdXQiOmNhc2UgImF1eGNsaWNrIjpjYXNlICJkYmxjbGljayI6Y2FzZSAiZHJhZ2VuZCI6Y2FzZSAiZHJhZ3N0YXJ0IjpjYXNlICJkcm9wIjpjYXNlICJmb2N1c2luIjpjYXNlICJmb2N1c291dCI6Y2FzZSAiaW5wdXQiOmNhc2UgImludmFsaWQiOmNhc2UgImtleWRvd24iOmNhc2UgImtleXByZXNzIjpjYXNlICJrZXl1cCI6Y2FzZSAibW91c2Vkb3duIjpjYXNlICJtb3VzZXVwIjpjYXNlICJwYXN0ZSI6Y2FzZSAicGF1c2UiOmNhc2UgInBsYXkiOmNhc2UgInBvaW50ZXJjYW5jZWwiOmNhc2UgInBvaW50ZXJkb3duIjpjYXNlICJwb2ludGVydXAiOmNhc2UgInJhdGVjaGFuZ2UiOmNhc2UgInJlc2V0IjpjYXNlICJyZXNpemUiOmNhc2UgInNlZWtlZCI6Y2FzZSAic3VibWl0IjpjYXNlICJ0b3VjaGNhbmNlbCI6Y2FzZSAidG91Y2hlbmQiOmNhc2UgInRvdWNoc3RhcnQiOmNhc2UgInZvbHVtZWNoYW5nZSI6Y2FzZSAiY2hhbmdlIjpjYXNlICJzZWxlY3Rpb25jaGFuZ2UiOmNhc2UgInRleHRJbnB1dCI6Y2FzZSAiY29tcG9zaXRpb25zdGFydCI6Y2FzZSAiY29tcG9zaXRpb25lbmQiOmNhc2UgImNvbXBvc2l0aW9udXBkYXRlIjpjYXNlICJiZWZvcmVibHVyIjpjYXNlICJhZnRlcmJsdXIiOmNhc2UgImJlZm9yZWlucHV0IjpjYXNlICJibHVyIjpjYXNlICJmdWxsc2NyZWVuY2hhbmdlIjpjYXNlICJmb2N1cyI6Y2FzZSAiaGFzaGNoYW5nZSI6Y2FzZSAicG9wc3RhdGUiOmNhc2UgInNlbGVjdCI6Y2FzZSAic2VsZWN0c3RhcnQiOnJldHVybiAxOwpjYXNlICJkcmFnIjpjYXNlICJkcmFnZW50ZXIiOmNhc2UgImRyYWdleGl0IjpjYXNlICJkcmFnbGVhdmUiOmNhc2UgImRyYWdvdmVyIjpjYXNlICJtb3VzZW1vdmUiOmNhc2UgIm1vdXNlb3V0IjpjYXNlICJtb3VzZW92ZXIiOmNhc2UgInBvaW50ZXJtb3ZlIjpjYXNlICJwb2ludGVyb3V0IjpjYXNlICJwb2ludGVyb3ZlciI6Y2FzZSAic2Nyb2xsIjpjYXNlICJ0b2dnbGUiOmNhc2UgInRvdWNobW92ZSI6Y2FzZSAid2hlZWwiOmNhc2UgIm1vdXNlZW50ZXIiOmNhc2UgIm1vdXNlbGVhdmUiOmNhc2UgInBvaW50ZXJlbnRlciI6Y2FzZSAicG9pbnRlcmxlYXZlIjpyZXR1cm4gNDtjYXNlICJtZXNzYWdlIjpzd2l0Y2goRGooKSl7Y2FzZSBEZTpyZXR1cm4gMTtjYXNlIE1nOnJldHVybiA0O2Nhc2UgYWQ6Y2FzZSBFajpyZXR1cm4gMTY7Y2FzZSBOZzpyZXR1cm4gNTM2ODcwOTEyO2RlZmF1bHQ6cmV0dXJuIDE2fWRlZmF1bHQ6cmV0dXJuIDE2fX1mdW5jdGlvbiBPZygpe2lmKGJkKXJldHVybiBiZDsKdmFyIGEsYj1FZSxjPWIubGVuZ3RoLGQsZT0idmFsdWUiaW4gWmE/WmEudmFsdWU6WmEudGV4dENvbnRlbnQsZj1lLmxlbmd0aDtmb3IoYT0wO2E8YyYmYlthXT09PWVbYV07YSsrKTt2YXIgZz1jLWE7Zm9yKGQ9MTtkPD1nJiZiW2MtZF09PT1lW2YtZF07ZCsrKTtyZXR1cm4gYmQ9ZS5zbGljZShhLDE8ZD8xLWQ6dm9pZCAwKX1mdW5jdGlvbiBjZChhKXt2YXIgYj1hLmtleUNvZGU7ImNoYXJDb2RlImluIGE/KGE9YS5jaGFyQ29kZSwwPT09YSYmMTM9PT1iJiYoYT0xMykpOmE9YjsxMD09PWEmJihhPTEzKTtyZXR1cm4gMzI8PWF8fDEzPT09YT9hOjB9ZnVuY3Rpb24gZGQoKXtyZXR1cm4hMH1mdW5jdGlvbiBQZygpe3JldHVybiExfWZ1bmN0aW9uIGthKGEpe2Z1bmN0aW9uIGIoYixkLGUsZixnKXt0aGlzLl9yZWFjdE5hbWU9Yjt0aGlzLl90YXJnZXRJbnN0PWU7dGhpcy50eXBlPWQ7dGhpcy5uYXRpdmVFdmVudD1mO3RoaXMudGFyZ2V0PWc7dGhpcy5jdXJyZW50VGFyZ2V0PW51bGw7CmZvcih2YXIgYyBpbiBhKWEuaGFzT3duUHJvcGVydHkoYykmJihiPWFbY10sdGhpc1tjXT1iP2IoZik6ZltjXSk7dGhpcy5pc0RlZmF1bHRQcmV2ZW50ZWQ9KG51bGwhPWYuZGVmYXVsdFByZXZlbnRlZD9mLmRlZmF1bHRQcmV2ZW50ZWQ6ITE9PT1mLnJldHVyblZhbHVlKT9kZDpQZzt0aGlzLmlzUHJvcGFnYXRpb25TdG9wcGVkPVBnO3JldHVybiB0aGlzfUUoYi5wcm90b3R5cGUse3ByZXZlbnREZWZhdWx0OmZ1bmN0aW9uKCl7dGhpcy5kZWZhdWx0UHJldmVudGVkPSEwO3ZhciBhPXRoaXMubmF0aXZlRXZlbnQ7YSYmKGEucHJldmVudERlZmF1bHQ/YS5wcmV2ZW50RGVmYXVsdCgpOiJ1bmtub3duIiE9PXR5cGVvZiBhLnJldHVyblZhbHVlJiYoYS5yZXR1cm5WYWx1ZT0hMSksdGhpcy5pc0RlZmF1bHRQcmV2ZW50ZWQ9ZGQpfSxzdG9wUHJvcGFnYXRpb246ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm5hdGl2ZUV2ZW50O2EmJihhLnN0b3BQcm9wYWdhdGlvbj9hLnN0b3BQcm9wYWdhdGlvbigpOgoidW5rbm93biIhPT10eXBlb2YgYS5jYW5jZWxCdWJibGUmJihhLmNhbmNlbEJ1YmJsZT0hMCksdGhpcy5pc1Byb3BhZ2F0aW9uU3RvcHBlZD1kZCl9LHBlcnNpc3Q6ZnVuY3Rpb24oKXt9LGlzUGVyc2lzdGVudDpkZH0pO3JldHVybiBifWZ1bmN0aW9uIEZqKGEpe3ZhciBiPXRoaXMubmF0aXZlRXZlbnQ7cmV0dXJuIGIuZ2V0TW9kaWZpZXJTdGF0ZT9iLmdldE1vZGlmaWVyU3RhdGUoYSk6KGE9R2pbYV0pPyEhYlthXTohMX1mdW5jdGlvbiBGZShhKXtyZXR1cm4gRmp9ZnVuY3Rpb24gUWcoYSxiKXtzd2l0Y2goYSl7Y2FzZSAia2V5dXAiOnJldHVybi0xIT09SGouaW5kZXhPZihiLmtleUNvZGUpO2Nhc2UgImtleWRvd24iOnJldHVybiAyMjkhPT1iLmtleUNvZGU7Y2FzZSAia2V5cHJlc3MiOmNhc2UgIm1vdXNlZG93biI6Y2FzZSAiZm9jdXNvdXQiOnJldHVybiEwO2RlZmF1bHQ6cmV0dXJuITF9fWZ1bmN0aW9uIFJnKGEpe2E9YS5kZXRhaWw7cmV0dXJuIm9iamVjdCI9PT10eXBlb2YgYSYmCiJkYXRhImluIGE/YS5kYXRhOm51bGx9ZnVuY3Rpb24gSWooYSxiKXtzd2l0Y2goYSl7Y2FzZSAiY29tcG9zaXRpb25lbmQiOnJldHVybiBSZyhiKTtjYXNlICJrZXlwcmVzcyI6aWYoMzIhPT1iLndoaWNoKXJldHVybiBudWxsO1NnPSEwO3JldHVybiBUZztjYXNlICJ0ZXh0SW5wdXQiOnJldHVybiBhPWIuZGF0YSxhPT09VGcmJlNnP251bGw6YTtkZWZhdWx0OnJldHVybiBudWxsfX1mdW5jdGlvbiBKaihhLGIpe2lmKEhiKXJldHVybiJjb21wb3NpdGlvbmVuZCI9PT1hfHwhR2UmJlFnKGEsYik/KGE9T2coKSxiZD1FZT1aYT1udWxsLEhiPSExLGEpOm51bGw7c3dpdGNoKGEpe2Nhc2UgInBhc3RlIjpyZXR1cm4gbnVsbDtjYXNlICJrZXlwcmVzcyI6aWYoIShiLmN0cmxLZXl8fGIuYWx0S2V5fHxiLm1ldGFLZXkpfHxiLmN0cmxLZXkmJmIuYWx0S2V5KXtpZihiLmNoYXImJjE8Yi5jaGFyLmxlbmd0aClyZXR1cm4gYi5jaGFyO2lmKGIud2hpY2gpcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoYi53aGljaCl9cmV0dXJuIG51bGw7CmNhc2UgImNvbXBvc2l0aW9uZW5kIjpyZXR1cm4gVWcmJiJrbyIhPT1iLmxvY2FsZT9udWxsOmIuZGF0YTtkZWZhdWx0OnJldHVybiBudWxsfX1mdW5jdGlvbiBWZyhhKXt2YXIgYj1hJiZhLm5vZGVOYW1lJiZhLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7cmV0dXJuImlucHV0Ij09PWI/ISFLalthLnR5cGVdOiJ0ZXh0YXJlYSI9PT1iPyEwOiExfWZ1bmN0aW9uIExqKGEpe2lmKCFJYSlyZXR1cm4hMTthPSJvbiIrYTt2YXIgYj1hIGluIGRvY3VtZW50O2J8fChiPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpLGIuc2V0QXR0cmlidXRlKGEsInJldHVybjsiKSxiPSJmdW5jdGlvbiI9PT10eXBlb2YgYlthXSk7cmV0dXJuIGJ9ZnVuY3Rpb24gV2coYSxiLGMsZCl7dWcoZCk7Yj1lZChiLCJvbkNoYW5nZSIpOzA8Yi5sZW5ndGgmJihjPW5ldyBIZSgib25DaGFuZ2UiLCJjaGFuZ2UiLG51bGwsYyxkKSxhLnB1c2goe2V2ZW50OmMsbGlzdGVuZXJzOmJ9KSl9ZnVuY3Rpb24gTWooYSl7WGcoYSwKMCl9ZnVuY3Rpb24gZmQoYSl7dmFyIGI9SWIoYSk7aWYoamcoYikpcmV0dXJuIGF9ZnVuY3Rpb24gTmooYSxiKXtpZigiY2hhbmdlIj09PWEpcmV0dXJuIGJ9ZnVuY3Rpb24gWWcoKXtvYyYmKG9jLmRldGFjaEV2ZW50KCJvbnByb3BlcnR5Y2hhbmdlIixaZykscGM9b2M9bnVsbCl9ZnVuY3Rpb24gWmcoYSl7aWYoInZhbHVlIj09PWEucHJvcGVydHlOYW1lJiZmZChwYykpe3ZhciBiPVtdO1dnKGIscGMsYSxyZShhKSk7d2coTWosYil9fWZ1bmN0aW9uIE9qKGEsYixjKXsiZm9jdXNpbiI9PT1hPyhZZygpLG9jPWIscGM9YyxvYy5hdHRhY2hFdmVudCgib25wcm9wZXJ0eWNoYW5nZSIsWmcpKToiZm9jdXNvdXQiPT09YSYmWWcoKX1mdW5jdGlvbiBQaihhLGIpe2lmKCJzZWxlY3Rpb25jaGFuZ2UiPT09YXx8ImtleXVwIj09PWF8fCJrZXlkb3duIj09PWEpcmV0dXJuIGZkKHBjKX1mdW5jdGlvbiBRaihhLGIpe2lmKCJjbGljayI9PT1hKXJldHVybiBmZChiKX1mdW5jdGlvbiBSaihhLGIpe2lmKCJpbnB1dCI9PT0KYXx8ImNoYW5nZSI9PT1hKXJldHVybiBmZChiKX1mdW5jdGlvbiBTaihhLGIpe3JldHVybiBhPT09YiYmKDAhPT1hfHwxL2E9PT0xL2IpfHxhIT09YSYmYiE9PWJ9ZnVuY3Rpb24gcWMoYSxiKXtpZih1YShhLGIpKXJldHVybiEwO2lmKCJvYmplY3QiIT09dHlwZW9mIGF8fG51bGw9PT1hfHwib2JqZWN0IiE9PXR5cGVvZiBifHxudWxsPT09YilyZXR1cm4hMTt2YXIgYz1PYmplY3Qua2V5cyhhKSxkPU9iamVjdC5rZXlzKGIpO2lmKGMubGVuZ3RoIT09ZC5sZW5ndGgpcmV0dXJuITE7Zm9yKGQ9MDtkPGMubGVuZ3RoO2QrKyl7dmFyIGU9Y1tkXTtpZighWmQuY2FsbChiLGUpfHwhdWEoYVtlXSxiW2VdKSlyZXR1cm4hMX1yZXR1cm4hMH1mdW5jdGlvbiAkZyhhKXtmb3IoO2EmJmEuZmlyc3RDaGlsZDspYT1hLmZpcnN0Q2hpbGQ7cmV0dXJuIGF9ZnVuY3Rpb24gYWgoYSxiKXt2YXIgYz0kZyhhKTthPTA7Zm9yKHZhciBkO2M7KXtpZigzPT09Yy5ub2RlVHlwZSl7ZD1hK2MudGV4dENvbnRlbnQubGVuZ3RoOwppZihhPD1iJiZkPj1iKXJldHVybntub2RlOmMsb2Zmc2V0OmItYX07YT1kfWE6e2Zvcig7Yzspe2lmKGMubmV4dFNpYmxpbmcpe2M9Yy5uZXh0U2libGluZzticmVhayBhfWM9Yy5wYXJlbnROb2RlfWM9dm9pZCAwfWM9JGcoYyl9fWZ1bmN0aW9uIGJoKGEsYil7cmV0dXJuIGEmJmI/YT09PWI/ITA6YSYmMz09PWEubm9kZVR5cGU/ITE6YiYmMz09PWIubm9kZVR5cGU/YmgoYSxiLnBhcmVudE5vZGUpOiJjb250YWlucyJpbiBhP2EuY29udGFpbnMoYik6YS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbj8hIShhLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKGIpJjE2KTohMTohMX1mdW5jdGlvbiBjaCgpe2Zvcih2YXIgYT13aW5kb3csYj1RYygpO2IgaW5zdGFuY2VvZiBhLkhUTUxJRnJhbWVFbGVtZW50Oyl7dHJ5e3ZhciBjPSJzdHJpbmciPT09dHlwZW9mIGIuY29udGVudFdpbmRvdy5sb2NhdGlvbi5ocmVmfWNhdGNoKGQpe2M9ITF9aWYoYylhPWIuY29udGVudFdpbmRvdztlbHNlIGJyZWFrOwpiPVFjKGEuZG9jdW1lbnQpfXJldHVybiBifWZ1bmN0aW9uIEllKGEpe3ZhciBiPWEmJmEubm9kZU5hbWUmJmEubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtyZXR1cm4gYiYmKCJpbnB1dCI9PT1iJiYoInRleHQiPT09YS50eXBlfHwic2VhcmNoIj09PWEudHlwZXx8InRlbCI9PT1hLnR5cGV8fCJ1cmwiPT09YS50eXBlfHwicGFzc3dvcmQiPT09YS50eXBlKXx8InRleHRhcmVhIj09PWJ8fCJ0cnVlIj09PWEuY29udGVudEVkaXRhYmxlKX1mdW5jdGlvbiBUaihhKXt2YXIgYj1jaCgpLGM9YS5mb2N1c2VkRWxlbSxkPWEuc2VsZWN0aW9uUmFuZ2U7aWYoYiE9PWMmJmMmJmMub3duZXJEb2N1bWVudCYmYmgoYy5vd25lckRvY3VtZW50LmRvY3VtZW50RWxlbWVudCxjKSl7aWYobnVsbCE9PWQmJkllKGMpKWlmKGI9ZC5zdGFydCxhPWQuZW5kLHZvaWQgMD09PWEmJihhPWIpLCJzZWxlY3Rpb25TdGFydCJpbiBjKWMuc2VsZWN0aW9uU3RhcnQ9YixjLnNlbGVjdGlvbkVuZD1NYXRoLm1pbihhLGMudmFsdWUubGVuZ3RoKTsKZWxzZSBpZihhPShiPWMub3duZXJEb2N1bWVudHx8ZG9jdW1lbnQpJiZiLmRlZmF1bHRWaWV3fHx3aW5kb3csYS5nZXRTZWxlY3Rpb24pe2E9YS5nZXRTZWxlY3Rpb24oKTt2YXIgZT1jLnRleHRDb250ZW50Lmxlbmd0aCxmPU1hdGgubWluKGQuc3RhcnQsZSk7ZD12b2lkIDA9PT1kLmVuZD9mOk1hdGgubWluKGQuZW5kLGUpOyFhLmV4dGVuZCYmZj5kJiYoZT1kLGQ9ZixmPWUpO2U9YWgoYyxmKTt2YXIgZz1haChjLGQpO2UmJmcmJigxIT09YS5yYW5nZUNvdW50fHxhLmFuY2hvck5vZGUhPT1lLm5vZGV8fGEuYW5jaG9yT2Zmc2V0IT09ZS5vZmZzZXR8fGEuZm9jdXNOb2RlIT09Zy5ub2RlfHxhLmZvY3VzT2Zmc2V0IT09Zy5vZmZzZXQpJiYoYj1iLmNyZWF0ZVJhbmdlKCksYi5zZXRTdGFydChlLm5vZGUsZS5vZmZzZXQpLGEucmVtb3ZlQWxsUmFuZ2VzKCksZj5kPyhhLmFkZFJhbmdlKGIpLGEuZXh0ZW5kKGcubm9kZSxnLm9mZnNldCkpOihiLnNldEVuZChnLm5vZGUsZy5vZmZzZXQpLAphLmFkZFJhbmdlKGIpKSl9Yj1bXTtmb3IoYT1jO2E9YS5wYXJlbnROb2RlOykxPT09YS5ub2RlVHlwZSYmYi5wdXNoKHtlbGVtZW50OmEsbGVmdDphLnNjcm9sbExlZnQsdG9wOmEuc2Nyb2xsVG9wfSk7ImZ1bmN0aW9uIj09PXR5cGVvZiBjLmZvY3VzJiZjLmZvY3VzKCk7Zm9yKGM9MDtjPGIubGVuZ3RoO2MrKylhPWJbY10sYS5lbGVtZW50LnNjcm9sbExlZnQ9YS5sZWZ0LGEuZWxlbWVudC5zY3JvbGxUb3A9YS50b3B9fWZ1bmN0aW9uIGRoKGEsYixjKXt2YXIgZD1jLndpbmRvdz09PWM/Yy5kb2N1bWVudDo5PT09Yy5ub2RlVHlwZT9jOmMub3duZXJEb2N1bWVudDtKZXx8bnVsbD09SmJ8fEpiIT09UWMoZCl8fChkPUpiLCJzZWxlY3Rpb25TdGFydCJpbiBkJiZJZShkKT9kPXtzdGFydDpkLnNlbGVjdGlvblN0YXJ0LGVuZDpkLnNlbGVjdGlvbkVuZH06KGQ9KGQub3duZXJEb2N1bWVudCYmZC5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3fHx3aW5kb3cpLmdldFNlbGVjdGlvbigpLGQ9CnthbmNob3JOb2RlOmQuYW5jaG9yTm9kZSxhbmNob3JPZmZzZXQ6ZC5hbmNob3JPZmZzZXQsZm9jdXNOb2RlOmQuZm9jdXNOb2RlLGZvY3VzT2Zmc2V0OmQuZm9jdXNPZmZzZXR9KSxyYyYmcWMocmMsZCl8fChyYz1kLGQ9ZWQoS2UsIm9uU2VsZWN0IiksMDxkLmxlbmd0aCYmKGI9bmV3IEhlKCJvblNlbGVjdCIsInNlbGVjdCIsbnVsbCxiLGMpLGEucHVzaCh7ZXZlbnQ6YixsaXN0ZW5lcnM6ZH0pLGIudGFyZ2V0PUpiKSkpfWZ1bmN0aW9uIGdkKGEsYil7dmFyIGM9e307Y1thLnRvTG93ZXJDYXNlKCldPWIudG9Mb3dlckNhc2UoKTtjWyJXZWJraXQiK2FdPSJ3ZWJraXQiK2I7Y1siTW96IithXT0ibW96IitiO3JldHVybiBjfWZ1bmN0aW9uIGhkKGEpe2lmKExlW2FdKXJldHVybiBMZVthXTtpZighS2JbYV0pcmV0dXJuIGE7dmFyIGI9S2JbYV0sYztmb3IoYyBpbiBiKWlmKGIuaGFzT3duUHJvcGVydHkoYykmJmMgaW4gZWgpcmV0dXJuIExlW2FdPWJbY107cmV0dXJuIGF9ZnVuY3Rpb24gJGEoYSwKYil7Zmguc2V0KGEsYik7bWIoYixbYV0pfWZ1bmN0aW9uIGdoKGEsYixjKXt2YXIgZD1hLnR5cGV8fCJ1bmtub3duLWV2ZW50IjthLmN1cnJlbnRUYXJnZXQ9YzttaihkLGIsdm9pZCAwLGEpO2EuY3VycmVudFRhcmdldD1udWxsfWZ1bmN0aW9uIFhnKGEsYil7Yj0wIT09KGImNCk7Zm9yKHZhciBjPTA7YzxhLmxlbmd0aDtjKyspe3ZhciBkPWFbY10sZT1kLmV2ZW50O2Q9ZC5saXN0ZW5lcnM7YTp7dmFyIGY9dm9pZCAwO2lmKGIpZm9yKHZhciBnPWQubGVuZ3RoLTE7MDw9ZztnLS0pe3ZhciBoPWRbZ10saz1oLmluc3RhbmNlLG49aC5jdXJyZW50VGFyZ2V0O2g9aC5saXN0ZW5lcjtpZihrIT09ZiYmZS5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpKWJyZWFrIGE7Z2goZSxoLG4pO2Y9a31lbHNlIGZvcihnPTA7ZzxkLmxlbmd0aDtnKyspe2g9ZFtnXTtrPWguaW5zdGFuY2U7bj1oLmN1cnJlbnRUYXJnZXQ7aD1oLmxpc3RlbmVyO2lmKGshPT1mJiZlLmlzUHJvcGFnYXRpb25TdG9wcGVkKCkpYnJlYWsgYTsKZ2goZSxoLG4pO2Y9a319fWlmKFRjKXRocm93IGE9dWUsVGM9ITEsdWU9bnVsbCxhO31mdW5jdGlvbiBCKGEsYil7dmFyIGM9YltNZV07dm9pZCAwPT09YyYmKGM9YltNZV09bmV3IFNldCk7dmFyIGQ9YSsiX19idWJibGUiO2MuaGFzKGQpfHwoaGgoYixhLDIsITEpLGMuYWRkKGQpKX1mdW5jdGlvbiBOZShhLGIsYyl7dmFyIGQ9MDtiJiYoZHw9NCk7aGgoYyxhLGQsYil9ZnVuY3Rpb24gc2MoYSl7aWYoIWFbaWRdKXthW2lkXT0hMDtjZy5mb3JFYWNoKGZ1bmN0aW9uKGIpeyJzZWxlY3Rpb25jaGFuZ2UiIT09YiYmKFVqLmhhcyhiKXx8TmUoYiwhMSxhKSxOZShiLCEwLGEpKX0pO3ZhciBiPTk9PT1hLm5vZGVUeXBlP2E6YS5vd25lckRvY3VtZW50O251bGw9PT1ifHxiW2lkXXx8KGJbaWRdPSEwLE5lKCJzZWxlY3Rpb25jaGFuZ2UiLCExLGIpKX19ZnVuY3Rpb24gaGgoYSxiLGMsZCxlKXtzd2l0Y2goTGcoYikpe2Nhc2UgMTplPXpqO2JyZWFrO2Nhc2UgNDplPUFqO2JyZWFrO2RlZmF1bHQ6ZT0KQmV9Yz1lLmJpbmQobnVsbCxiLGMsYSk7ZT12b2lkIDA7IU9lfHwidG91Y2hzdGFydCIhPT1iJiYidG91Y2htb3ZlIiE9PWImJiJ3aGVlbCIhPT1ifHwoZT0hMCk7ZD92b2lkIDAhPT1lP2EuYWRkRXZlbnRMaXN0ZW5lcihiLGMse2NhcHR1cmU6ITAscGFzc2l2ZTplfSk6YS5hZGRFdmVudExpc3RlbmVyKGIsYywhMCk6dm9pZCAwIT09ZT9hLmFkZEV2ZW50TGlzdGVuZXIoYixjLHtwYXNzaXZlOmV9KTphLmFkZEV2ZW50TGlzdGVuZXIoYixjLCExKX1mdW5jdGlvbiBDZShhLGIsYyxkLGUpe3ZhciBmPWQ7aWYoMD09PShiJjEpJiYwPT09KGImMikmJm51bGwhPT1kKWE6Zm9yKDs7KXtpZihudWxsPT09ZClyZXR1cm47dmFyIGc9ZC50YWc7aWYoMz09PWd8fDQ9PT1nKXt2YXIgaD1kLnN0YXRlTm9kZS5jb250YWluZXJJbmZvO2lmKGg9PT1lfHw4PT09aC5ub2RlVHlwZSYmaC5wYXJlbnROb2RlPT09ZSlicmVhaztpZig0PT09Zylmb3IoZz1kLnJldHVybjtudWxsIT09Zzspe3ZhciBrPWcudGFnOwppZigzPT09a3x8ND09PWspaWYoaz1nLnN0YXRlTm9kZS5jb250YWluZXJJbmZvLGs9PT1lfHw4PT09ay5ub2RlVHlwZSYmay5wYXJlbnROb2RlPT09ZSlyZXR1cm47Zz1nLnJldHVybn1mb3IoO251bGwhPT1oOyl7Zz1vYihoKTtpZihudWxsPT09ZylyZXR1cm47az1nLnRhZztpZig1PT09a3x8Nj09PWspe2Q9Zj1nO2NvbnRpbnVlIGF9aD1oLnBhcmVudE5vZGV9fWQ9ZC5yZXR1cm59d2coZnVuY3Rpb24oKXt2YXIgZD1mLGU9cmUoYyksZz1bXTthOnt2YXIgaD1maC5nZXQoYSk7aWYodm9pZCAwIT09aCl7dmFyIGs9SGUsbT1hO3N3aXRjaChhKXtjYXNlICJrZXlwcmVzcyI6aWYoMD09PWNkKGMpKWJyZWFrIGE7Y2FzZSAia2V5ZG93biI6Y2FzZSAia2V5dXAiOms9Vmo7YnJlYWs7Y2FzZSAiZm9jdXNpbiI6bT0iZm9jdXMiO2s9UGU7YnJlYWs7Y2FzZSAiZm9jdXNvdXQiOm09ImJsdXIiO2s9UGU7YnJlYWs7Y2FzZSAiYmVmb3JlYmx1ciI6Y2FzZSAiYWZ0ZXJibHVyIjprPVBlO2JyZWFrOwpjYXNlICJjbGljayI6aWYoMj09PWMuYnV0dG9uKWJyZWFrIGE7Y2FzZSAiYXV4Y2xpY2siOmNhc2UgImRibGNsaWNrIjpjYXNlICJtb3VzZWRvd24iOmNhc2UgIm1vdXNlbW92ZSI6Y2FzZSAibW91c2V1cCI6Y2FzZSAibW91c2VvdXQiOmNhc2UgIm1vdXNlb3ZlciI6Y2FzZSAiY29udGV4dG1lbnUiOms9aWg7YnJlYWs7Y2FzZSAiZHJhZyI6Y2FzZSAiZHJhZ2VuZCI6Y2FzZSAiZHJhZ2VudGVyIjpjYXNlICJkcmFnZXhpdCI6Y2FzZSAiZHJhZ2xlYXZlIjpjYXNlICJkcmFnb3ZlciI6Y2FzZSAiZHJhZ3N0YXJ0IjpjYXNlICJkcm9wIjprPVdqO2JyZWFrO2Nhc2UgInRvdWNoY2FuY2VsIjpjYXNlICJ0b3VjaGVuZCI6Y2FzZSAidG91Y2htb3ZlIjpjYXNlICJ0b3VjaHN0YXJ0IjprPVhqO2JyZWFrO2Nhc2Ugamg6Y2FzZSBraDpjYXNlIGxoOms9WWo7YnJlYWs7Y2FzZSBtaDprPVpqO2JyZWFrO2Nhc2UgInNjcm9sbCI6az1hazticmVhaztjYXNlICJ3aGVlbCI6az1iazticmVhaztjYXNlICJjb3B5IjpjYXNlICJjdXQiOmNhc2UgInBhc3RlIjprPQpjazticmVhaztjYXNlICJnb3Rwb2ludGVyY2FwdHVyZSI6Y2FzZSAibG9zdHBvaW50ZXJjYXB0dXJlIjpjYXNlICJwb2ludGVyY2FuY2VsIjpjYXNlICJwb2ludGVyZG93biI6Y2FzZSAicG9pbnRlcm1vdmUiOmNhc2UgInBvaW50ZXJvdXQiOmNhc2UgInBvaW50ZXJvdmVyIjpjYXNlICJwb2ludGVydXAiOms9bmh9dmFyIGw9MCE9PShiJjQpLHA9IWwmJiJzY3JvbGwiPT09YSx3PWw/bnVsbCE9PWg/aCsiQ2FwdHVyZSI6bnVsbDpoO2w9W107Zm9yKHZhciBBPWQsdDtudWxsIT09QTspe3Q9QTt2YXIgTT10LnN0YXRlTm9kZTs1PT09dC50YWcmJm51bGwhPT1NJiYodD1NLG51bGwhPT13JiYoTT1mYyhBLHcpLG51bGwhPU0mJmwucHVzaCh0YyhBLE0sdCkpKSk7aWYocClicmVhaztBPUEucmV0dXJufTA8bC5sZW5ndGgmJihoPW5ldyBrKGgsbSxudWxsLGMsZSksZy5wdXNoKHtldmVudDpoLGxpc3RlbmVyczpsfSkpfX1pZigwPT09KGImNykpe2E6e2g9Im1vdXNlb3ZlciI9PT1hfHwicG9pbnRlcm92ZXIiPT09CmE7az0ibW91c2VvdXQiPT09YXx8InBvaW50ZXJvdXQiPT09YTtpZihoJiZjIT09emUmJihtPWMucmVsYXRlZFRhcmdldHx8Yy5mcm9tRWxlbWVudCkmJihvYihtKXx8bVtKYV0pKWJyZWFrIGE7aWYoa3x8aCl7aD1lLndpbmRvdz09PWU/ZTooaD1lLm93bmVyRG9jdW1lbnQpP2guZGVmYXVsdFZpZXd8fGgucGFyZW50V2luZG93OndpbmRvdztpZihrKXtpZihtPWMucmVsYXRlZFRhcmdldHx8Yy50b0VsZW1lbnQsaz1kLG09bT9vYihtKTpudWxsLG51bGwhPT1tJiYocD1uYihtKSxtIT09cHx8NSE9PW0udGFnJiY2IT09bS50YWcpKW09bnVsbH1lbHNlIGs9bnVsbCxtPWQ7aWYoayE9PW0pe2w9aWg7TT0ib25Nb3VzZUxlYXZlIjt3PSJvbk1vdXNlRW50ZXIiO0E9Im1vdXNlIjtpZigicG9pbnRlcm91dCI9PT1hfHwicG9pbnRlcm92ZXIiPT09YSlsPW5oLE09Im9uUG9pbnRlckxlYXZlIix3PSJvblBvaW50ZXJFbnRlciIsQT0icG9pbnRlciI7cD1udWxsPT1rP2g6SWIoayk7dD1udWxsPT0KbT9oOkliKG0pO2g9bmV3IGwoTSxBKyJsZWF2ZSIsayxjLGUpO2gudGFyZ2V0PXA7aC5yZWxhdGVkVGFyZ2V0PXQ7TT1udWxsO29iKGUpPT09ZCYmKGw9bmV3IGwodyxBKyJlbnRlciIsbSxjLGUpLGwudGFyZ2V0PXQsbC5yZWxhdGVkVGFyZ2V0PXAsTT1sKTtwPU07aWYoayYmbSliOntsPWs7dz1tO0E9MDtmb3IodD1sO3Q7dD1MYih0KSlBKys7dD0wO2ZvcihNPXc7TTtNPUxiKE0pKXQrKztmb3IoOzA8QS10OylsPUxiKGwpLEEtLTtmb3IoOzA8dC1BOyl3PUxiKHcpLHQtLTtmb3IoO0EtLTspe2lmKGw9PT13fHxudWxsIT09dyYmbD09PXcuYWx0ZXJuYXRlKWJyZWFrIGI7bD1MYihsKTt3PUxiKHcpfWw9bnVsbH1lbHNlIGw9bnVsbDtudWxsIT09ayYmb2goZyxoLGssbCwhMSk7bnVsbCE9PW0mJm51bGwhPT1wJiZvaChnLHAsbSxsLCEwKX19fWE6e2g9ZD9JYihkKTp3aW5kb3c7az1oLm5vZGVOYW1lJiZoLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7aWYoInNlbGVjdCI9PT1rfHwiaW5wdXQiPT09CmsmJiJmaWxlIj09PWgudHlwZSl2YXIgbWE9Tmo7ZWxzZSBpZihWZyhoKSlpZihwaCltYT1SajtlbHNle21hPVBqO3ZhciB2YT1Pan1lbHNlKGs9aC5ub2RlTmFtZSkmJiJpbnB1dCI9PT1rLnRvTG93ZXJDYXNlKCkmJigiY2hlY2tib3giPT09aC50eXBlfHwicmFkaW8iPT09aC50eXBlKSYmKG1hPVFqKTtpZihtYSYmKG1hPW1hKGEsZCkpKXtXZyhnLG1hLGMsZSk7YnJlYWsgYX12YSYmdmEoYSxoLGQpOyJmb2N1c291dCI9PT1hJiYodmE9aC5fd3JhcHBlclN0YXRlKSYmdmEuY29udHJvbGxlZCYmIm51bWJlciI9PT1oLnR5cGUmJm1lKGgsIm51bWJlciIsaC52YWx1ZSl9dmE9ZD9JYihkKTp3aW5kb3c7c3dpdGNoKGEpe2Nhc2UgImZvY3VzaW4iOmlmKFZnKHZhKXx8InRydWUiPT09dmEuY29udGVudEVkaXRhYmxlKUpiPXZhLEtlPWQscmM9bnVsbDticmVhaztjYXNlICJmb2N1c291dCI6cmM9S2U9SmI9bnVsbDticmVhaztjYXNlICJtb3VzZWRvd24iOkplPSEwO2JyZWFrO2Nhc2UgImNvbnRleHRtZW51IjpjYXNlICJtb3VzZXVwIjpjYXNlICJkcmFnZW5kIjpKZT0KITE7ZGgoZyxjLGUpO2JyZWFrO2Nhc2UgInNlbGVjdGlvbmNoYW5nZSI6aWYoZGspYnJlYWs7Y2FzZSAia2V5ZG93biI6Y2FzZSAia2V5dXAiOmRoKGcsYyxlKX12YXIgYWI7aWYoR2UpYjp7c3dpdGNoKGEpe2Nhc2UgImNvbXBvc2l0aW9uc3RhcnQiOnZhciBkYT0ib25Db21wb3NpdGlvblN0YXJ0IjticmVhayBiO2Nhc2UgImNvbXBvc2l0aW9uZW5kIjpkYT0ib25Db21wb3NpdGlvbkVuZCI7YnJlYWsgYjtjYXNlICJjb21wb3NpdGlvbnVwZGF0ZSI6ZGE9Im9uQ29tcG9zaXRpb25VcGRhdGUiO2JyZWFrIGJ9ZGE9dm9pZCAwfWVsc2UgSGI/UWcoYSxjKSYmKGRhPSJvbkNvbXBvc2l0aW9uRW5kIik6ImtleWRvd24iPT09YSYmMjI5PT09Yy5rZXlDb2RlJiYoZGE9Im9uQ29tcG9zaXRpb25TdGFydCIpO2RhJiYoVWcmJiJrbyIhPT1jLmxvY2FsZSYmKEhifHwib25Db21wb3NpdGlvblN0YXJ0IiE9PWRhPyJvbkNvbXBvc2l0aW9uRW5kIj09PWRhJiZIYiYmKGFiPU9nKCkpOihaYT1lLEVlPQoidmFsdWUiaW4gWmE/WmEudmFsdWU6WmEudGV4dENvbnRlbnQsSGI9ITApKSx2YT1lZChkLGRhKSwwPHZhLmxlbmd0aCYmKGRhPW5ldyBxaChkYSxhLG51bGwsYyxlKSxnLnB1c2goe2V2ZW50OmRhLGxpc3RlbmVyczp2YX0pLGFiP2RhLmRhdGE9YWI6KGFiPVJnKGMpLG51bGwhPT1hYiYmKGRhLmRhdGE9YWIpKSkpO2lmKGFiPWVrP0lqKGEsYyk6SmooYSxjKSlkPWVkKGQsIm9uQmVmb3JlSW5wdXQiKSwwPGQubGVuZ3RoJiYoZT1uZXcgZmsoIm9uQmVmb3JlSW5wdXQiLCJiZWZvcmVpbnB1dCIsbnVsbCxjLGUpLGcucHVzaCh7ZXZlbnQ6ZSxsaXN0ZW5lcnM6ZH0pLGUuZGF0YT1hYil9WGcoZyxiKX0pfWZ1bmN0aW9uIHRjKGEsYixjKXtyZXR1cm57aW5zdGFuY2U6YSxsaXN0ZW5lcjpiLGN1cnJlbnRUYXJnZXQ6Y319ZnVuY3Rpb24gZWQoYSxiKXtmb3IodmFyIGM9YisiQ2FwdHVyZSIsZD1bXTtudWxsIT09YTspe3ZhciBlPWEsZj1lLnN0YXRlTm9kZTs1PT09ZS50YWcmJm51bGwhPT0KZiYmKGU9ZixmPWZjKGEsYyksbnVsbCE9ZiYmZC51bnNoaWZ0KHRjKGEsZixlKSksZj1mYyhhLGIpLG51bGwhPWYmJmQucHVzaCh0YyhhLGYsZSkpKTthPWEucmV0dXJufXJldHVybiBkfWZ1bmN0aW9uIExiKGEpe2lmKG51bGw9PT1hKXJldHVybiBudWxsO2RvIGE9YS5yZXR1cm47d2hpbGUoYSYmNSE9PWEudGFnKTtyZXR1cm4gYT9hOm51bGx9ZnVuY3Rpb24gb2goYSxiLGMsZCxlKXtmb3IodmFyIGY9Yi5fcmVhY3ROYW1lLGc9W107bnVsbCE9PWMmJmMhPT1kOyl7dmFyIGg9YyxrPWguYWx0ZXJuYXRlLG49aC5zdGF0ZU5vZGU7aWYobnVsbCE9PWsmJms9PT1kKWJyZWFrOzU9PT1oLnRhZyYmbnVsbCE9PW4mJihoPW4sZT8oaz1mYyhjLGYpLG51bGwhPWsmJmcudW5zaGlmdCh0YyhjLGssaCkpKTplfHwoaz1mYyhjLGYpLG51bGwhPWsmJmcucHVzaCh0YyhjLGssaCkpKSk7Yz1jLnJldHVybn0wIT09Zy5sZW5ndGgmJmEucHVzaCh7ZXZlbnQ6YixsaXN0ZW5lcnM6Z30pfWZ1bmN0aW9uIHJoKGEpe3JldHVybigic3RyaW5nIj09PQp0eXBlb2YgYT9hOiIiK2EpLnJlcGxhY2UoZ2ssIlxuIikucmVwbGFjZShoaywiIil9ZnVuY3Rpb24gamQoYSxiLGMsZCl7Yj1yaChiKTtpZihyaChhKSE9PWImJmMpdGhyb3cgRXJyb3IobSg0MjUpKTt9ZnVuY3Rpb24ga2QoKXt9ZnVuY3Rpb24gUWUoYSxiKXtyZXR1cm4idGV4dGFyZWEiPT09YXx8Im5vc2NyaXB0Ij09PWF8fCJzdHJpbmciPT09dHlwZW9mIGIuY2hpbGRyZW58fCJudW1iZXIiPT09dHlwZW9mIGIuY2hpbGRyZW58fCJvYmplY3QiPT09dHlwZW9mIGIuZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUwmJm51bGwhPT1iLmRhbmdlcm91c2x5U2V0SW5uZXJIVE1MJiZudWxsIT1iLmRhbmdlcm91c2x5U2V0SW5uZXJIVE1MLl9faHRtbH1mdW5jdGlvbiBpayhhKXtzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7dGhyb3cgYTt9KX1mdW5jdGlvbiBSZShhLGIpe3ZhciBjPWIsZD0wO2Rve3ZhciBlPWMubmV4dFNpYmxpbmc7YS5yZW1vdmVDaGlsZChjKTtpZihlJiY4PT09ZS5ub2RlVHlwZSlpZihjPQplLmRhdGEsIi8kIj09PWMpe2lmKDA9PT1kKXthLnJlbW92ZUNoaWxkKGUpO25jKGIpO3JldHVybn1kLS19ZWxzZSIkIiE9PWMmJiIkPyIhPT1jJiYiJCEiIT09Y3x8ZCsrO2M9ZX13aGlsZShjKTtuYyhiKX1mdW5jdGlvbiBLYShhKXtmb3IoO251bGwhPWE7YT1hLm5leHRTaWJsaW5nKXt2YXIgYj1hLm5vZGVUeXBlO2lmKDE9PT1ifHwzPT09YilicmVhaztpZig4PT09Yil7Yj1hLmRhdGE7aWYoIiQiPT09Ynx8IiQhIj09PWJ8fCIkPyI9PT1iKWJyZWFrO2lmKCIvJCI9PT1iKXJldHVybiBudWxsfX1yZXR1cm4gYX1mdW5jdGlvbiBzaChhKXthPWEucHJldmlvdXNTaWJsaW5nO2Zvcih2YXIgYj0wO2E7KXtpZig4PT09YS5ub2RlVHlwZSl7dmFyIGM9YS5kYXRhO2lmKCIkIj09PWN8fCIkISI9PT1jfHwiJD8iPT09Yyl7aWYoMD09PWIpcmV0dXJuIGE7Yi0tfWVsc2UiLyQiPT09YyYmYisrfWE9YS5wcmV2aW91c1NpYmxpbmd9cmV0dXJuIG51bGx9ZnVuY3Rpb24gb2IoYSl7dmFyIGI9YVtEYV07CmlmKGIpcmV0dXJuIGI7Zm9yKHZhciBjPWEucGFyZW50Tm9kZTtjOyl7aWYoYj1jW0phXXx8Y1tEYV0pe2M9Yi5hbHRlcm5hdGU7aWYobnVsbCE9PWIuY2hpbGR8fG51bGwhPT1jJiZudWxsIT09Yy5jaGlsZClmb3IoYT1zaChhKTtudWxsIT09YTspe2lmKGM9YVtEYV0pcmV0dXJuIGM7YT1zaChhKX1yZXR1cm4gYn1hPWM7Yz1hLnBhcmVudE5vZGV9cmV0dXJuIG51bGx9ZnVuY3Rpb24gZWMoYSl7YT1hW0RhXXx8YVtKYV07cmV0dXJuIWF8fDUhPT1hLnRhZyYmNiE9PWEudGFnJiYxMyE9PWEudGFnJiYzIT09YS50YWc/bnVsbDphfWZ1bmN0aW9uIEliKGEpe2lmKDU9PT1hLnRhZ3x8Nj09PWEudGFnKXJldHVybiBhLnN0YXRlTm9kZTt0aHJvdyBFcnJvcihtKDMzKSk7fWZ1bmN0aW9uIFJjKGEpe3JldHVybiBhW3VjXXx8bnVsbH1mdW5jdGlvbiBiYihhKXtyZXR1cm57Y3VycmVudDphfX1mdW5jdGlvbiB2KGEsYil7MD5NYnx8KGEuY3VycmVudD1TZVtNYl0sU2VbTWJdPW51bGwsTWItLSl9CmZ1bmN0aW9uIHkoYSxiLGMpe01iKys7U2VbTWJdPWEuY3VycmVudDthLmN1cnJlbnQ9Yn1mdW5jdGlvbiBOYihhLGIpe3ZhciBjPWEudHlwZS5jb250ZXh0VHlwZXM7aWYoIWMpcmV0dXJuIGNiO3ZhciBkPWEuc3RhdGVOb2RlO2lmKGQmJmQuX19yZWFjdEludGVybmFsTWVtb2l6ZWRVbm1hc2tlZENoaWxkQ29udGV4dD09PWIpcmV0dXJuIGQuX19yZWFjdEludGVybmFsTWVtb2l6ZWRNYXNrZWRDaGlsZENvbnRleHQ7dmFyIGU9e30sZjtmb3IoZiBpbiBjKWVbZl09YltmXTtkJiYoYT1hLnN0YXRlTm9kZSxhLl9fcmVhY3RJbnRlcm5hbE1lbW9pemVkVW5tYXNrZWRDaGlsZENvbnRleHQ9YixhLl9fcmVhY3RJbnRlcm5hbE1lbW9pemVkTWFza2VkQ2hpbGRDb250ZXh0PWUpO3JldHVybiBlfWZ1bmN0aW9uIGVhKGEpe2E9YS5jaGlsZENvbnRleHRUeXBlcztyZXR1cm4gbnVsbCE9PWEmJnZvaWQgMCE9PWF9ZnVuY3Rpb24gdGgoYSxiLGMpe2lmKEouY3VycmVudCE9PWNiKXRocm93IEVycm9yKG0oMTY4KSk7CnkoSixiKTt5KFMsYyl9ZnVuY3Rpb24gdWgoYSxiLGMpe3ZhciBkPWEuc3RhdGVOb2RlO2I9Yi5jaGlsZENvbnRleHRUeXBlcztpZigiZnVuY3Rpb24iIT09dHlwZW9mIGQuZ2V0Q2hpbGRDb250ZXh0KXJldHVybiBjO2Q9ZC5nZXRDaGlsZENvbnRleHQoKTtmb3IodmFyIGUgaW4gZClpZighKGUgaW4gYikpdGhyb3cgRXJyb3IobSgxMDgsZ2ooYSl8fCJVbmtub3duIixlKSk7cmV0dXJuIEUoe30sYyxkKX1mdW5jdGlvbiBsZChhKXthPShhPWEuc3RhdGVOb2RlKSYmYS5fX3JlYWN0SW50ZXJuYWxNZW1vaXplZE1lcmdlZENoaWxkQ29udGV4dHx8Y2I7cGI9Si5jdXJyZW50O3koSixhKTt5KFMsUy5jdXJyZW50KTtyZXR1cm4hMH1mdW5jdGlvbiB2aChhLGIsYyl7dmFyIGQ9YS5zdGF0ZU5vZGU7aWYoIWQpdGhyb3cgRXJyb3IobSgxNjkpKTtjPyhhPXVoKGEsYixwYiksZC5fX3JlYWN0SW50ZXJuYWxNZW1vaXplZE1lcmdlZENoaWxkQ29udGV4dD1hLHYoUyksdihKKSx5KEosYSkpOnYoUyk7CnkoUyxjKX1mdW5jdGlvbiB3aChhKXtudWxsPT09TGE/TGE9W2FdOkxhLnB1c2goYSl9ZnVuY3Rpb24gamsoYSl7bWQ9ITA7d2goYSl9ZnVuY3Rpb24gZGIoKXtpZighVGUmJm51bGwhPT1MYSl7VGU9ITA7dmFyIGE9MCxiPXo7dHJ5e3ZhciBjPUxhO2Zvcih6PTE7YTxjLmxlbmd0aDthKyspe3ZhciBkPWNbYV07ZG8gZD1kKCEwKTt3aGlsZShudWxsIT09ZCl9TGE9bnVsbDttZD0hMX1jYXRjaChlKXt0aHJvdyBudWxsIT09TGEmJihMYT1MYS5zbGljZShhKzEpKSx4aChEZSxkYiksZTt9ZmluYWxseXt6PWIsVGU9ITF9fXJldHVybiBudWxsfWZ1bmN0aW9uIHFiKGEsYil7T2JbUGIrK109bmQ7T2JbUGIrK109b2Q7b2Q9YTtuZD1ifWZ1bmN0aW9uIHloKGEsYixjKXtuYVtvYSsrXT1NYTtuYVtvYSsrXT1OYTtuYVtvYSsrXT1yYjtyYj1hO3ZhciBkPU1hO2E9TmE7dmFyIGU9MzItdGEoZCktMTtkJj1+KDE8PGUpO2MrPTE7dmFyIGY9MzItdGEoYikrZTtpZigzMDxmKXt2YXIgZz1lLWUlNTsKZj0oZCYoMTw8ZyktMSkudG9TdHJpbmcoMzIpO2Q+Pj1nO2UtPWc7TWE9MTw8MzItdGEoYikrZXxjPDxlfGQ7TmE9ZithfWVsc2UgTWE9MTw8ZnxjPDxlfGQsTmE9YX1mdW5jdGlvbiBVZShhKXtudWxsIT09YS5yZXR1cm4mJihxYihhLDEpLHloKGEsMSwwKSl9ZnVuY3Rpb24gVmUoYSl7Zm9yKDthPT09b2Q7KW9kPU9iWy0tUGJdLE9iW1BiXT1udWxsLG5kPU9iWy0tUGJdLE9iW1BiXT1udWxsO2Zvcig7YT09PXJiOylyYj1uYVstLW9hXSxuYVtvYV09bnVsbCxOYT1uYVstLW9hXSxuYVtvYV09bnVsbCxNYT1uYVstLW9hXSxuYVtvYV09bnVsbH1mdW5jdGlvbiB6aChhLGIpe3ZhciBjPXBhKDUsbnVsbCxudWxsLDApO2MuZWxlbWVudFR5cGU9IkRFTEVURUQiO2Muc3RhdGVOb2RlPWI7Yy5yZXR1cm49YTtiPWEuZGVsZXRpb25zO251bGw9PT1iPyhhLmRlbGV0aW9ucz1bY10sYS5mbGFnc3w9MTYpOmIucHVzaChjKX1mdW5jdGlvbiBBaChhLGIpe3N3aXRjaChhLnRhZyl7Y2FzZSA1OnZhciBjPQphLnR5cGU7Yj0xIT09Yi5ub2RlVHlwZXx8Yy50b0xvd2VyQ2FzZSgpIT09Yi5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpP251bGw6YjtyZXR1cm4gbnVsbCE9PWI/KGEuc3RhdGVOb2RlPWIsbGE9YSxmYT1LYShiLmZpcnN0Q2hpbGQpLCEwKTohMTtjYXNlIDY6cmV0dXJuIGI9IiI9PT1hLnBlbmRpbmdQcm9wc3x8MyE9PWIubm9kZVR5cGU/bnVsbDpiLG51bGwhPT1iPyhhLnN0YXRlTm9kZT1iLGxhPWEsZmE9bnVsbCwhMCk6ITE7Y2FzZSAxMzpyZXR1cm4gYj04IT09Yi5ub2RlVHlwZT9udWxsOmIsbnVsbCE9PWI/KGM9bnVsbCE9PXJiP3tpZDpNYSxvdmVyZmxvdzpOYX06bnVsbCxhLm1lbW9pemVkU3RhdGU9e2RlaHlkcmF0ZWQ6Yix0cmVlQ29udGV4dDpjLHJldHJ5TGFuZToxMDczNzQxODI0fSxjPXBhKDE4LG51bGwsbnVsbCwwKSxjLnN0YXRlTm9kZT1iLGMucmV0dXJuPWEsYS5jaGlsZD1jLGxhPWEsZmE9bnVsbCwhMCk6ITE7ZGVmYXVsdDpyZXR1cm4hMX19ZnVuY3Rpb24gV2UoYSl7cmV0dXJuIDAhPT0KKGEubW9kZSYxKSYmMD09PShhLmZsYWdzJjEyOCl9ZnVuY3Rpb24gWGUoYSl7aWYoRCl7dmFyIGI9ZmE7aWYoYil7dmFyIGM9YjtpZighQWgoYSxiKSl7aWYoV2UoYSkpdGhyb3cgRXJyb3IobSg0MTgpKTtiPUthKGMubmV4dFNpYmxpbmcpO3ZhciBkPWxhO2ImJkFoKGEsYik/emgoZCxjKTooYS5mbGFncz1hLmZsYWdzJi00MDk3fDIsRD0hMSxsYT1hKX19ZWxzZXtpZihXZShhKSl0aHJvdyBFcnJvcihtKDQxOCkpO2EuZmxhZ3M9YS5mbGFncyYtNDA5N3wyO0Q9ITE7bGE9YX19fWZ1bmN0aW9uIEJoKGEpe2ZvcihhPWEucmV0dXJuO251bGwhPT1hJiY1IT09YS50YWcmJjMhPT1hLnRhZyYmMTMhPT1hLnRhZzspYT1hLnJldHVybjtsYT1hfWZ1bmN0aW9uIHBkKGEpe2lmKGEhPT1sYSlyZXR1cm4hMTtpZighRClyZXR1cm4gQmgoYSksRD0hMCwhMTt2YXIgYjsoYj0zIT09YS50YWcpJiYhKGI9NSE9PWEudGFnKSYmKGI9YS50eXBlLGI9ImhlYWQiIT09YiYmImJvZHkiIT09YiYmIVFlKGEudHlwZSwKYS5tZW1vaXplZFByb3BzKSk7aWYoYiYmKGI9ZmEpKXtpZihXZShhKSl7Zm9yKGE9ZmE7YTspYT1LYShhLm5leHRTaWJsaW5nKTt0aHJvdyBFcnJvcihtKDQxOCkpO31mb3IoO2I7KXpoKGEsYiksYj1LYShiLm5leHRTaWJsaW5nKX1CaChhKTtpZigxMz09PWEudGFnKXthPWEubWVtb2l6ZWRTdGF0ZTthPW51bGwhPT1hP2EuZGVoeWRyYXRlZDpudWxsO2lmKCFhKXRocm93IEVycm9yKG0oMzE3KSk7YTp7YT1hLm5leHRTaWJsaW5nO2ZvcihiPTA7YTspe2lmKDg9PT1hLm5vZGVUeXBlKXt2YXIgYz1hLmRhdGE7aWYoIi8kIj09PWMpe2lmKDA9PT1iKXtmYT1LYShhLm5leHRTaWJsaW5nKTticmVhayBhfWItLX1lbHNlIiQiIT09YyYmIiQhIiE9PWMmJiIkPyIhPT1jfHxiKyt9YT1hLm5leHRTaWJsaW5nfWZhPW51bGx9fWVsc2UgZmE9bGE/S2EoYS5zdGF0ZU5vZGUubmV4dFNpYmxpbmcpOm51bGw7cmV0dXJuITB9ZnVuY3Rpb24gUWIoKXtmYT1sYT1udWxsO0Q9ITF9ZnVuY3Rpb24gWWUoYSl7bnVsbD09PQp3YT93YT1bYV06d2EucHVzaChhKX1mdW5jdGlvbiB2YyhhLGIsYyl7YT1jLnJlZjtpZihudWxsIT09YSYmImZ1bmN0aW9uIiE9PXR5cGVvZiBhJiYib2JqZWN0IiE9PXR5cGVvZiBhKXtpZihjLl9vd25lcil7Yz1jLl9vd25lcjtpZihjKXtpZigxIT09Yy50YWcpdGhyb3cgRXJyb3IobSgzMDkpKTt2YXIgZD1jLnN0YXRlTm9kZX1pZighZCl0aHJvdyBFcnJvcihtKDE0NyxhKSk7dmFyIGU9ZCxmPSIiK2E7aWYobnVsbCE9PWImJm51bGwhPT1iLnJlZiYmImZ1bmN0aW9uIj09PXR5cGVvZiBiLnJlZiYmYi5yZWYuX3N0cmluZ1JlZj09PWYpcmV0dXJuIGIucmVmO2I9ZnVuY3Rpb24oYSl7dmFyIGI9ZS5yZWZzO251bGw9PT1hP2RlbGV0ZSBiW2ZdOmJbZl09YX07Yi5fc3RyaW5nUmVmPWY7cmV0dXJuIGJ9aWYoInN0cmluZyIhPT10eXBlb2YgYSl0aHJvdyBFcnJvcihtKDI4NCkpO2lmKCFjLl9vd25lcil0aHJvdyBFcnJvcihtKDI5MCxhKSk7fXJldHVybiBhfWZ1bmN0aW9uIHFkKGEsYil7YT0KT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGIpO3Rocm93IEVycm9yKG0oMzEsIltvYmplY3QgT2JqZWN0XSI9PT1hPyJvYmplY3Qgd2l0aCBrZXlzIHsiK09iamVjdC5rZXlzKGIpLmpvaW4oIiwgIikrIn0iOmEpKTt9ZnVuY3Rpb24gQ2goYSl7dmFyIGI9YS5faW5pdDtyZXR1cm4gYihhLl9wYXlsb2FkKX1mdW5jdGlvbiBEaChhKXtmdW5jdGlvbiBiKGIsYyl7aWYoYSl7dmFyIGQ9Yi5kZWxldGlvbnM7bnVsbD09PWQ/KGIuZGVsZXRpb25zPVtjXSxiLmZsYWdzfD0xNik6ZC5wdXNoKGMpfX1mdW5jdGlvbiBjKGMsZCl7aWYoIWEpcmV0dXJuIG51bGw7Zm9yKDtudWxsIT09ZDspYihjLGQpLGQ9ZC5zaWJsaW5nO3JldHVybiBudWxsfWZ1bmN0aW9uIGQoYSxiKXtmb3IoYT1uZXcgTWFwO251bGwhPT1iOyludWxsIT09Yi5rZXk/YS5zZXQoYi5rZXksYik6YS5zZXQoYi5pbmRleCxiKSxiPWIuc2libGluZztyZXR1cm4gYX1mdW5jdGlvbiBlKGEsYil7YT1lYihhLGIpO2EuaW5kZXg9CjA7YS5zaWJsaW5nPW51bGw7cmV0dXJuIGF9ZnVuY3Rpb24gZihiLGMsZCl7Yi5pbmRleD1kO2lmKCFhKXJldHVybiBiLmZsYWdzfD0xMDQ4NTc2LGM7ZD1iLmFsdGVybmF0ZTtpZihudWxsIT09ZClyZXR1cm4gZD1kLmluZGV4LGQ8Yz8oYi5mbGFnc3w9MixjKTpkO2IuZmxhZ3N8PTI7cmV0dXJuIGN9ZnVuY3Rpb24gZyhiKXthJiZudWxsPT09Yi5hbHRlcm5hdGUmJihiLmZsYWdzfD0yKTtyZXR1cm4gYn1mdW5jdGlvbiBoKGEsYixjLGQpe2lmKG51bGw9PT1ifHw2IT09Yi50YWcpcmV0dXJuIGI9WmUoYyxhLm1vZGUsZCksYi5yZXR1cm49YSxiO2I9ZShiLGMpO2IucmV0dXJuPWE7cmV0dXJuIGJ9ZnVuY3Rpb24gayhhLGIsYyxkKXt2YXIgZj1jLnR5cGU7aWYoZj09PUJiKXJldHVybiBsKGEsYixjLnByb3BzLmNoaWxkcmVuLGQsYy5rZXkpO2lmKG51bGwhPT1iJiYoYi5lbGVtZW50VHlwZT09PWZ8fCJvYmplY3QiPT09dHlwZW9mIGYmJm51bGwhPT1mJiZmLiQkdHlwZW9mPT09VGEmJgpDaChmKT09PWIudHlwZSkpcmV0dXJuIGQ9ZShiLGMucHJvcHMpLGQucmVmPXZjKGEsYixjKSxkLnJldHVybj1hLGQ7ZD1yZChjLnR5cGUsYy5rZXksYy5wcm9wcyxudWxsLGEubW9kZSxkKTtkLnJlZj12YyhhLGIsYyk7ZC5yZXR1cm49YTtyZXR1cm4gZH1mdW5jdGlvbiBuKGEsYixjLGQpe2lmKG51bGw9PT1ifHw0IT09Yi50YWd8fGIuc3RhdGVOb2RlLmNvbnRhaW5lckluZm8hPT1jLmNvbnRhaW5lckluZm98fGIuc3RhdGVOb2RlLmltcGxlbWVudGF0aW9uIT09Yy5pbXBsZW1lbnRhdGlvbilyZXR1cm4gYj0kZShjLGEubW9kZSxkKSxiLnJldHVybj1hLGI7Yj1lKGIsYy5jaGlsZHJlbnx8W10pO2IucmV0dXJuPWE7cmV0dXJuIGJ9ZnVuY3Rpb24gbChhLGIsYyxkLGYpe2lmKG51bGw9PT1ifHw3IT09Yi50YWcpcmV0dXJuIGI9c2IoYyxhLm1vZGUsZCxmKSxiLnJldHVybj1hLGI7Yj1lKGIsYyk7Yi5yZXR1cm49YTtyZXR1cm4gYn1mdW5jdGlvbiB1KGEsYixjKXtpZigic3RyaW5nIj09PQp0eXBlb2YgYiYmIiIhPT1ifHwibnVtYmVyIj09PXR5cGVvZiBiKXJldHVybiBiPVplKCIiK2IsYS5tb2RlLGMpLGIucmV0dXJuPWEsYjtpZigib2JqZWN0Ij09PXR5cGVvZiBiJiZudWxsIT09Yil7c3dpdGNoKGIuJCR0eXBlb2Ype2Nhc2Ugc2Q6cmV0dXJuIGM9cmQoYi50eXBlLGIua2V5LGIucHJvcHMsbnVsbCxhLm1vZGUsYyksYy5yZWY9dmMoYSxudWxsLGIpLGMucmV0dXJuPWEsYztjYXNlIENiOnJldHVybiBiPSRlKGIsYS5tb2RlLGMpLGIucmV0dXJuPWEsYjtjYXNlIFRhOnZhciBkPWIuX2luaXQ7cmV0dXJuIHUoYSxkKGIuX3BheWxvYWQpLGMpfWlmKGNjKGIpfHxhYyhiKSlyZXR1cm4gYj1zYihiLGEubW9kZSxjLG51bGwpLGIucmV0dXJuPWEsYjtxZChhLGIpfXJldHVybiBudWxsfWZ1bmN0aW9uIHIoYSxiLGMsZCl7dmFyIGU9bnVsbCE9PWI/Yi5rZXk6bnVsbDtpZigic3RyaW5nIj09PXR5cGVvZiBjJiYiIiE9PWN8fCJudW1iZXIiPT09dHlwZW9mIGMpcmV0dXJuIG51bGwhPT0KZT9udWxsOmgoYSxiLCIiK2MsZCk7aWYoIm9iamVjdCI9PT10eXBlb2YgYyYmbnVsbCE9PWMpe3N3aXRjaChjLiQkdHlwZW9mKXtjYXNlIHNkOnJldHVybiBjLmtleT09PWU/ayhhLGIsYyxkKTpudWxsO2Nhc2UgQ2I6cmV0dXJuIGMua2V5PT09ZT9uKGEsYixjLGQpOm51bGw7Y2FzZSBUYTpyZXR1cm4gZT1jLl9pbml0LHIoYSxiLGUoYy5fcGF5bG9hZCksZCl9aWYoY2MoYyl8fGFjKGMpKXJldHVybiBudWxsIT09ZT9udWxsOmwoYSxiLGMsZCxudWxsKTtxZChhLGMpfXJldHVybiBudWxsfWZ1bmN0aW9uIHAoYSxiLGMsZCxlKXtpZigic3RyaW5nIj09PXR5cGVvZiBkJiYiIiE9PWR8fCJudW1iZXIiPT09dHlwZW9mIGQpcmV0dXJuIGE9YS5nZXQoYyl8fG51bGwsaChiLGEsIiIrZCxlKTtpZigib2JqZWN0Ij09PXR5cGVvZiBkJiZudWxsIT09ZCl7c3dpdGNoKGQuJCR0eXBlb2Ype2Nhc2Ugc2Q6cmV0dXJuIGE9YS5nZXQobnVsbD09PWQua2V5P2M6ZC5rZXkpfHxudWxsLGsoYixhLGQsCmUpO2Nhc2UgQ2I6cmV0dXJuIGE9YS5nZXQobnVsbD09PWQua2V5P2M6ZC5rZXkpfHxudWxsLG4oYixhLGQsZSk7Y2FzZSBUYTp2YXIgZj1kLl9pbml0O3JldHVybiBwKGEsYixjLGYoZC5fcGF5bG9hZCksZSl9aWYoY2MoZCl8fGFjKGQpKXJldHVybiBhPWEuZ2V0KGMpfHxudWxsLGwoYixhLGQsZSxudWxsKTtxZChiLGQpfXJldHVybiBudWxsfWZ1bmN0aW9uIHgoZSxnLGgsayl7Zm9yKHZhciBuPW51bGwsbT1udWxsLGw9Zyx0PWc9MCxxPW51bGw7bnVsbCE9PWwmJnQ8aC5sZW5ndGg7dCsrKXtsLmluZGV4PnQ/KHE9bCxsPW51bGwpOnE9bC5zaWJsaW5nO3ZhciBBPXIoZSxsLGhbdF0sayk7aWYobnVsbD09PUEpe251bGw9PT1sJiYobD1xKTticmVha31hJiZsJiZudWxsPT09QS5hbHRlcm5hdGUmJmIoZSxsKTtnPWYoQSxnLHQpO251bGw9PT1tP249QTptLnNpYmxpbmc9QTttPUE7bD1xfWlmKHQ9PT1oLmxlbmd0aClyZXR1cm4gYyhlLGwpLEQmJnFiKGUsdCksbjtpZihudWxsPT09bCl7Zm9yKDt0PApoLmxlbmd0aDt0KyspbD11KGUsaFt0XSxrKSxudWxsIT09bCYmKGc9ZihsLGcsdCksbnVsbD09PW0/bj1sOm0uc2libGluZz1sLG09bCk7RCYmcWIoZSx0KTtyZXR1cm4gbn1mb3IobD1kKGUsbCk7dDxoLmxlbmd0aDt0KyspcT1wKGwsZSx0LGhbdF0sayksbnVsbCE9PXEmJihhJiZudWxsIT09cS5hbHRlcm5hdGUmJmwuZGVsZXRlKG51bGw9PT1xLmtleT90OnEua2V5KSxnPWYocSxnLHQpLG51bGw9PT1tP249cTptLnNpYmxpbmc9cSxtPXEpO2EmJmwuZm9yRWFjaChmdW5jdGlvbihhKXtyZXR1cm4gYihlLGEpfSk7RCYmcWIoZSx0KTtyZXR1cm4gbn1mdW5jdGlvbiBJKGUsZyxoLGspe3ZhciBuPWFjKGgpO2lmKCJmdW5jdGlvbiIhPT10eXBlb2Ygbil0aHJvdyBFcnJvcihtKDE1MCkpO2g9bi5jYWxsKGgpO2lmKG51bGw9PWgpdGhyb3cgRXJyb3IobSgxNTEpKTtmb3IodmFyIGw9bj1udWxsLHE9Zyx0PWc9MCxBPW51bGwsdz1oLm5leHQoKTtudWxsIT09cSYmIXcuZG9uZTt0Kyssdz0KaC5uZXh0KCkpe3EuaW5kZXg+dD8oQT1xLHE9bnVsbCk6QT1xLnNpYmxpbmc7dmFyIHg9cihlLHEsdy52YWx1ZSxrKTtpZihudWxsPT09eCl7bnVsbD09PXEmJihxPUEpO2JyZWFrfWEmJnEmJm51bGw9PT14LmFsdGVybmF0ZSYmYihlLHEpO2c9Zih4LGcsdCk7bnVsbD09PWw/bj14Omwuc2libGluZz14O2w9eDtxPUF9aWYody5kb25lKXJldHVybiBjKGUscSksRCYmcWIoZSx0KSxuO2lmKG51bGw9PT1xKXtmb3IoOyF3LmRvbmU7dCsrLHc9aC5uZXh0KCkpdz11KGUsdy52YWx1ZSxrKSxudWxsIT09dyYmKGc9Zih3LGcsdCksbnVsbD09PWw/bj13Omwuc2libGluZz13LGw9dyk7RCYmcWIoZSx0KTtyZXR1cm4gbn1mb3IocT1kKGUscSk7IXcuZG9uZTt0Kyssdz1oLm5leHQoKSl3PXAocSxlLHQsdy52YWx1ZSxrKSxudWxsIT09dyYmKGEmJm51bGwhPT13LmFsdGVybmF0ZSYmcS5kZWxldGUobnVsbD09PXcua2V5P3Q6dy5rZXkpLGc9Zih3LGcsdCksbnVsbD09PWw/bj13Omwuc2libGluZz0KdyxsPXcpO2EmJnEuZm9yRWFjaChmdW5jdGlvbihhKXtyZXR1cm4gYihlLGEpfSk7RCYmcWIoZSx0KTtyZXR1cm4gbn1mdW5jdGlvbiB2KGEsZCxmLGgpeyJvYmplY3QiPT09dHlwZW9mIGYmJm51bGwhPT1mJiZmLnR5cGU9PT1CYiYmbnVsbD09PWYua2V5JiYoZj1mLnByb3BzLmNoaWxkcmVuKTtpZigib2JqZWN0Ij09PXR5cGVvZiBmJiZudWxsIT09Zil7c3dpdGNoKGYuJCR0eXBlb2Ype2Nhc2Ugc2Q6YTp7Zm9yKHZhciBrPWYua2V5LG49ZDtudWxsIT09bjspe2lmKG4ua2V5PT09ayl7az1mLnR5cGU7aWYoaz09PUJiKXtpZig3PT09bi50YWcpe2MoYSxuLnNpYmxpbmcpO2Q9ZShuLGYucHJvcHMuY2hpbGRyZW4pO2QucmV0dXJuPWE7YT1kO2JyZWFrIGF9fWVsc2UgaWYobi5lbGVtZW50VHlwZT09PWt8fCJvYmplY3QiPT09dHlwZW9mIGsmJm51bGwhPT1rJiZrLiQkdHlwZW9mPT09VGEmJkNoKGspPT09bi50eXBlKXtjKGEsbi5zaWJsaW5nKTtkPWUobixmLnByb3BzKTtkLnJlZj12YyhhLApuLGYpO2QucmV0dXJuPWE7YT1kO2JyZWFrIGF9YyhhLG4pO2JyZWFrfWVsc2UgYihhLG4pO249bi5zaWJsaW5nfWYudHlwZT09PUJiPyhkPXNiKGYucHJvcHMuY2hpbGRyZW4sYS5tb2RlLGgsZi5rZXkpLGQucmV0dXJuPWEsYT1kKTooaD1yZChmLnR5cGUsZi5rZXksZi5wcm9wcyxudWxsLGEubW9kZSxoKSxoLnJlZj12YyhhLGQsZiksaC5yZXR1cm49YSxhPWgpfXJldHVybiBnKGEpO2Nhc2UgQ2I6YTp7Zm9yKG49Zi5rZXk7bnVsbCE9PWQ7KXtpZihkLmtleT09PW4paWYoND09PWQudGFnJiZkLnN0YXRlTm9kZS5jb250YWluZXJJbmZvPT09Zi5jb250YWluZXJJbmZvJiZkLnN0YXRlTm9kZS5pbXBsZW1lbnRhdGlvbj09PWYuaW1wbGVtZW50YXRpb24pe2MoYSxkLnNpYmxpbmcpO2Q9ZShkLGYuY2hpbGRyZW58fFtdKTtkLnJldHVybj1hO2E9ZDticmVhayBhfWVsc2V7YyhhLGQpO2JyZWFrfWVsc2UgYihhLGQpO2Q9ZC5zaWJsaW5nfWQ9JGUoZixhLm1vZGUsaCk7ZC5yZXR1cm49YTsKYT1kfXJldHVybiBnKGEpO2Nhc2UgVGE6cmV0dXJuIG49Zi5faW5pdCx2KGEsZCxuKGYuX3BheWxvYWQpLGgpfWlmKGNjKGYpKXJldHVybiB4KGEsZCxmLGgpO2lmKGFjKGYpKXJldHVybiBJKGEsZCxmLGgpO3FkKGEsZil9cmV0dXJuInN0cmluZyI9PT10eXBlb2YgZiYmIiIhPT1mfHwibnVtYmVyIj09PXR5cGVvZiBmPyhmPSIiK2YsbnVsbCE9PWQmJjY9PT1kLnRhZz8oYyhhLGQuc2libGluZyksZD1lKGQsZiksZC5yZXR1cm49YSxhPWQpOihjKGEsZCksZD1aZShmLGEubW9kZSxoKSxkLnJldHVybj1hLGE9ZCksZyhhKSk6YyhhLGQpfXJldHVybiB2fWZ1bmN0aW9uIGFmKCl7YmY9UmI9dGQ9bnVsbH1mdW5jdGlvbiBjZihhLGIpe2I9dWQuY3VycmVudDt2KHVkKTthLl9jdXJyZW50VmFsdWU9Yn1mdW5jdGlvbiBkZihhLGIsYyl7Zm9yKDtudWxsIT09YTspe3ZhciBkPWEuYWx0ZXJuYXRlOyhhLmNoaWxkTGFuZXMmYikhPT1iPyhhLmNoaWxkTGFuZXN8PWIsbnVsbCE9PWQmJihkLmNoaWxkTGFuZXN8PQpiKSk6bnVsbCE9PWQmJihkLmNoaWxkTGFuZXMmYikhPT1iJiYoZC5jaGlsZExhbmVzfD1iKTtpZihhPT09YylicmVhazthPWEucmV0dXJufX1mdW5jdGlvbiBTYihhLGIpe3RkPWE7YmY9UmI9bnVsbDthPWEuZGVwZW5kZW5jaWVzO251bGwhPT1hJiZudWxsIT09YS5maXJzdENvbnRleHQmJigwIT09KGEubGFuZXMmYikmJihoYT0hMCksYS5maXJzdENvbnRleHQ9bnVsbCl9ZnVuY3Rpb24gcWEoYSl7dmFyIGI9YS5fY3VycmVudFZhbHVlO2lmKGJmIT09YSlpZihhPXtjb250ZXh0OmEsbWVtb2l6ZWRWYWx1ZTpiLG5leHQ6bnVsbH0sbnVsbD09PVJiKXtpZihudWxsPT09dGQpdGhyb3cgRXJyb3IobSgzMDgpKTtSYj1hO3RkLmRlcGVuZGVuY2llcz17bGFuZXM6MCxmaXJzdENvbnRleHQ6YX19ZWxzZSBSYj1SYi5uZXh0PWE7cmV0dXJuIGJ9ZnVuY3Rpb24gZWYoYSl7bnVsbD09PXRiP3RiPVthXTp0Yi5wdXNoKGEpfWZ1bmN0aW9uIEVoKGEsYixjLGQpe3ZhciBlPWIuaW50ZXJsZWF2ZWQ7Cm51bGw9PT1lPyhjLm5leHQ9YyxlZihiKSk6KGMubmV4dD1lLm5leHQsZS5uZXh0PWMpO2IuaW50ZXJsZWF2ZWQ9YztyZXR1cm4gT2EoYSxkKX1mdW5jdGlvbiBPYShhLGIpe2EubGFuZXN8PWI7dmFyIGM9YS5hbHRlcm5hdGU7bnVsbCE9PWMmJihjLmxhbmVzfD1iKTtjPWE7Zm9yKGE9YS5yZXR1cm47bnVsbCE9PWE7KWEuY2hpbGRMYW5lc3w9YixjPWEuYWx0ZXJuYXRlLG51bGwhPT1jJiYoYy5jaGlsZExhbmVzfD1iKSxjPWEsYT1hLnJldHVybjtyZXR1cm4gMz09PWMudGFnP2Muc3RhdGVOb2RlOm51bGx9ZnVuY3Rpb24gZmYoYSl7YS51cGRhdGVRdWV1ZT17YmFzZVN0YXRlOmEubWVtb2l6ZWRTdGF0ZSxmaXJzdEJhc2VVcGRhdGU6bnVsbCxsYXN0QmFzZVVwZGF0ZTpudWxsLHNoYXJlZDp7cGVuZGluZzpudWxsLGludGVybGVhdmVkOm51bGwsbGFuZXM6MH0sZWZmZWN0czpudWxsfX1mdW5jdGlvbiBGaChhLGIpe2E9YS51cGRhdGVRdWV1ZTtiLnVwZGF0ZVF1ZXVlPT09YSYmKGIudXBkYXRlUXVldWU9CntiYXNlU3RhdGU6YS5iYXNlU3RhdGUsZmlyc3RCYXNlVXBkYXRlOmEuZmlyc3RCYXNlVXBkYXRlLGxhc3RCYXNlVXBkYXRlOmEubGFzdEJhc2VVcGRhdGUsc2hhcmVkOmEuc2hhcmVkLGVmZmVjdHM6YS5lZmZlY3RzfSl9ZnVuY3Rpb24gUGEoYSxiKXtyZXR1cm57ZXZlbnRUaW1lOmEsbGFuZTpiLHRhZzowLHBheWxvYWQ6bnVsbCxjYWxsYmFjazpudWxsLG5leHQ6bnVsbH19ZnVuY3Rpb24gZmIoYSxiLGMpe3ZhciBkPWEudXBkYXRlUXVldWU7aWYobnVsbD09PWQpcmV0dXJuIG51bGw7ZD1kLnNoYXJlZDtpZigwIT09KHAmMikpe3ZhciBlPWQucGVuZGluZztudWxsPT09ZT9iLm5leHQ9YjooYi5uZXh0PWUubmV4dCxlLm5leHQ9Yik7ZC5wZW5kaW5nPWI7cmV0dXJuIGtrKGEsYyl9ZT1kLmludGVybGVhdmVkO251bGw9PT1lPyhiLm5leHQ9YixlZihkKSk6KGIubmV4dD1lLm5leHQsZS5uZXh0PWIpO2QuaW50ZXJsZWF2ZWQ9YjtyZXR1cm4gT2EoYSxjKX1mdW5jdGlvbiB2ZChhLGIsYyl7Yj0KYi51cGRhdGVRdWV1ZTtpZihudWxsIT09YiYmKGI9Yi5zaGFyZWQsMCE9PShjJjQxOTQyNDApKSl7dmFyIGQ9Yi5sYW5lcztkJj1hLnBlbmRpbmdMYW5lcztjfD1kO2IubGFuZXM9Yzt4ZShhLGMpfX1mdW5jdGlvbiBHaChhLGIpe3ZhciBjPWEudXBkYXRlUXVldWUsZD1hLmFsdGVybmF0ZTtpZihudWxsIT09ZCYmKGQ9ZC51cGRhdGVRdWV1ZSxjPT09ZCkpe3ZhciBlPW51bGwsZj1udWxsO2M9Yy5maXJzdEJhc2VVcGRhdGU7aWYobnVsbCE9PWMpe2Rve3ZhciBnPXtldmVudFRpbWU6Yy5ldmVudFRpbWUsbGFuZTpjLmxhbmUsdGFnOmMudGFnLHBheWxvYWQ6Yy5wYXlsb2FkLGNhbGxiYWNrOmMuY2FsbGJhY2ssbmV4dDpudWxsfTtudWxsPT09Zj9lPWY9ZzpmPWYubmV4dD1nO2M9Yy5uZXh0fXdoaWxlKG51bGwhPT1jKTtudWxsPT09Zj9lPWY9YjpmPWYubmV4dD1ifWVsc2UgZT1mPWI7Yz17YmFzZVN0YXRlOmQuYmFzZVN0YXRlLGZpcnN0QmFzZVVwZGF0ZTplLGxhc3RCYXNlVXBkYXRlOmYsCnNoYXJlZDpkLnNoYXJlZCxlZmZlY3RzOmQuZWZmZWN0c307YS51cGRhdGVRdWV1ZT1jO3JldHVybn1hPWMubGFzdEJhc2VVcGRhdGU7bnVsbD09PWE/Yy5maXJzdEJhc2VVcGRhdGU9YjphLm5leHQ9YjtjLmxhc3RCYXNlVXBkYXRlPWJ9ZnVuY3Rpb24gd2QoYSxiLGMsZCl7dmFyIGU9YS51cGRhdGVRdWV1ZTtnYj0hMTt2YXIgZj1lLmZpcnN0QmFzZVVwZGF0ZSxnPWUubGFzdEJhc2VVcGRhdGUsaD1lLnNoYXJlZC5wZW5kaW5nO2lmKG51bGwhPT1oKXtlLnNoYXJlZC5wZW5kaW5nPW51bGw7dmFyIGs9aCxuPWsubmV4dDtrLm5leHQ9bnVsbDtudWxsPT09Zz9mPW46Zy5uZXh0PW47Zz1rO3ZhciBsPWEuYWx0ZXJuYXRlO251bGwhPT1sJiYobD1sLnVwZGF0ZVF1ZXVlLGg9bC5sYXN0QmFzZVVwZGF0ZSxoIT09ZyYmKG51bGw9PT1oP2wuZmlyc3RCYXNlVXBkYXRlPW46aC5uZXh0PW4sbC5sYXN0QmFzZVVwZGF0ZT1rKSl9aWYobnVsbCE9PWYpe3ZhciBtPWUuYmFzZVN0YXRlO2c9MDtsPQpuPWs9bnVsbDtoPWY7ZG97dmFyIHI9aC5sYW5lLHA9aC5ldmVudFRpbWU7aWYoKGQmcik9PT1yKXtudWxsIT09bCYmKGw9bC5uZXh0PXtldmVudFRpbWU6cCxsYW5lOjAsdGFnOmgudGFnLHBheWxvYWQ6aC5wYXlsb2FkLGNhbGxiYWNrOmguY2FsbGJhY2ssbmV4dDpudWxsfSk7YTp7dmFyIHg9YSx2PWg7cj1iO3A9Yztzd2l0Y2godi50YWcpe2Nhc2UgMTp4PXYucGF5bG9hZDtpZigiZnVuY3Rpb24iPT09dHlwZW9mIHgpe209eC5jYWxsKHAsbSxyKTticmVhayBhfW09eDticmVhayBhO2Nhc2UgMzp4LmZsYWdzPXguZmxhZ3MmLTY1NTM3fDEyODtjYXNlIDA6eD12LnBheWxvYWQ7cj0iZnVuY3Rpb24iPT09dHlwZW9mIHg/eC5jYWxsKHAsbSxyKTp4O2lmKG51bGw9PT1yfHx2b2lkIDA9PT1yKWJyZWFrIGE7bT1FKHt9LG0scik7YnJlYWsgYTtjYXNlIDI6Z2I9ITB9fW51bGwhPT1oLmNhbGxiYWNrJiYwIT09aC5sYW5lJiYoYS5mbGFnc3w9NjQscj1lLmVmZmVjdHMsbnVsbD09PXI/ZS5lZmZlY3RzPQpbaF06ci5wdXNoKGgpKX1lbHNlIHA9e2V2ZW50VGltZTpwLGxhbmU6cix0YWc6aC50YWcscGF5bG9hZDpoLnBheWxvYWQsY2FsbGJhY2s6aC5jYWxsYmFjayxuZXh0Om51bGx9LG51bGw9PT1sPyhuPWw9cCxrPW0pOmw9bC5uZXh0PXAsZ3w9cjtoPWgubmV4dDtpZihudWxsPT09aClpZihoPWUuc2hhcmVkLnBlbmRpbmcsbnVsbD09PWgpYnJlYWs7ZWxzZSByPWgsaD1yLm5leHQsci5uZXh0PW51bGwsZS5sYXN0QmFzZVVwZGF0ZT1yLGUuc2hhcmVkLnBlbmRpbmc9bnVsbH13aGlsZSgxKTtudWxsPT09bCYmKGs9bSk7ZS5iYXNlU3RhdGU9aztlLmZpcnN0QmFzZVVwZGF0ZT1uO2UubGFzdEJhc2VVcGRhdGU9bDtiPWUuc2hhcmVkLmludGVybGVhdmVkO2lmKG51bGwhPT1iKXtlPWI7ZG8gZ3w9ZS5sYW5lLGU9ZS5uZXh0O3doaWxlKGUhPT1iKX1lbHNlIG51bGw9PT1mJiYoZS5zaGFyZWQubGFuZXM9MCk7cmF8PWc7YS5sYW5lcz1nO2EubWVtb2l6ZWRTdGF0ZT1tfX1mdW5jdGlvbiBIaChhLApiLGMpe2E9Yi5lZmZlY3RzO2IuZWZmZWN0cz1udWxsO2lmKG51bGwhPT1hKWZvcihiPTA7YjxhLmxlbmd0aDtiKyspe3ZhciBkPWFbYl0sZT1kLmNhbGxiYWNrO2lmKG51bGwhPT1lKXtkLmNhbGxiYWNrPW51bGw7ZD1jO2lmKCJmdW5jdGlvbiIhPT10eXBlb2YgZSl0aHJvdyBFcnJvcihtKDE5MSxlKSk7ZS5jYWxsKGQpfX19ZnVuY3Rpb24gdWIoYSl7aWYoYT09PXdjKXRocm93IEVycm9yKG0oMTc0KSk7cmV0dXJuIGF9ZnVuY3Rpb24gZ2YoYSxiKXt5KHhjLGIpO3koeWMsYSk7eShFYSx3Yyk7YT1iLm5vZGVUeXBlO3N3aXRjaChhKXtjYXNlIDk6Y2FzZSAxMTpiPShiPWIuZG9jdW1lbnRFbGVtZW50KT9iLm5hbWVzcGFjZVVSSTpvZShudWxsLCIiKTticmVhaztkZWZhdWx0OmE9OD09PWE/Yi5wYXJlbnROb2RlOmIsYj1hLm5hbWVzcGFjZVVSSXx8bnVsbCxhPWEudGFnTmFtZSxiPW9lKGIsYSl9dihFYSk7eShFYSxiKX1mdW5jdGlvbiBUYihhKXt2KEVhKTt2KHljKTt2KHhjKX1mdW5jdGlvbiBJaChhKXt1Yih4Yy5jdXJyZW50KTsKdmFyIGI9dWIoRWEuY3VycmVudCk7dmFyIGM9b2UoYixhLnR5cGUpO2IhPT1jJiYoeSh5YyxhKSx5KEVhLGMpKX1mdW5jdGlvbiBoZihhKXt5Yy5jdXJyZW50PT09YSYmKHYoRWEpLHYoeWMpKX1mdW5jdGlvbiB4ZChhKXtmb3IodmFyIGI9YTtudWxsIT09Yjspe2lmKDEzPT09Yi50YWcpe3ZhciBjPWIubWVtb2l6ZWRTdGF0ZTtpZihudWxsIT09YyYmKGM9Yy5kZWh5ZHJhdGVkLG51bGw9PT1jfHwiJD8iPT09Yy5kYXRhfHwiJCEiPT09Yy5kYXRhKSlyZXR1cm4gYn1lbHNlIGlmKDE5PT09Yi50YWcmJnZvaWQgMCE9PWIubWVtb2l6ZWRQcm9wcy5yZXZlYWxPcmRlcil7aWYoMCE9PShiLmZsYWdzJjEyOCkpcmV0dXJuIGJ9ZWxzZSBpZihudWxsIT09Yi5jaGlsZCl7Yi5jaGlsZC5yZXR1cm49YjtiPWIuY2hpbGQ7Y29udGludWV9aWYoYj09PWEpYnJlYWs7Zm9yKDtudWxsPT09Yi5zaWJsaW5nOyl7aWYobnVsbD09PWIucmV0dXJufHxiLnJldHVybj09PWEpcmV0dXJuIG51bGw7Yj1iLnJldHVybn1iLnNpYmxpbmcucmV0dXJuPQpiLnJldHVybjtiPWIuc2libGluZ31yZXR1cm4gbnVsbH1mdW5jdGlvbiBqZigpe2Zvcih2YXIgYT0wO2E8a2YubGVuZ3RoO2ErKylrZlthXS5fd29ya0luUHJvZ3Jlc3NWZXJzaW9uUHJpbWFyeT1udWxsO2tmLmxlbmd0aD0wfWZ1bmN0aW9uIFYoKXt0aHJvdyBFcnJvcihtKDMyMSkpO31mdW5jdGlvbiBsZihhLGIpe2lmKG51bGw9PT1iKXJldHVybiExO2Zvcih2YXIgYz0wO2M8Yi5sZW5ndGgmJmM8YS5sZW5ndGg7YysrKWlmKCF1YShhW2NdLGJbY10pKXJldHVybiExO3JldHVybiEwfWZ1bmN0aW9uIG1mKGEsYixjLGQsZSxmKXt2Yj1mO0M9YjtiLm1lbW9pemVkU3RhdGU9bnVsbDtiLnVwZGF0ZVF1ZXVlPW51bGw7Yi5sYW5lcz0wO3lkLmN1cnJlbnQ9bnVsbD09PWF8fG51bGw9PT1hLm1lbW9pemVkU3RhdGU/bGs6bWs7YT1jKGQsZSk7aWYoemMpe2Y9MDtkb3t6Yz0hMTtBYz0wO2lmKDI1PD1mKXRocm93IEVycm9yKG0oMzAxKSk7Zis9MTtOPUs9bnVsbDtiLnVwZGF0ZVF1ZXVlPW51bGw7CnlkLmN1cnJlbnQ9bms7YT1jKGQsZSl9d2hpbGUoemMpfXlkLmN1cnJlbnQ9emQ7Yj1udWxsIT09SyYmbnVsbCE9PUsubmV4dDt2Yj0wO049Sz1DPW51bGw7QWQ9ITE7aWYoYil0aHJvdyBFcnJvcihtKDMwMCkpO3JldHVybiBhfWZ1bmN0aW9uIG5mKCl7dmFyIGE9MCE9PUFjO0FjPTA7cmV0dXJuIGF9ZnVuY3Rpb24gRmEoKXt2YXIgYT17bWVtb2l6ZWRTdGF0ZTpudWxsLGJhc2VTdGF0ZTpudWxsLGJhc2VRdWV1ZTpudWxsLHF1ZXVlOm51bGwsbmV4dDpudWxsfTtudWxsPT09Tj9DLm1lbW9pemVkU3RhdGU9Tj1hOk49Ti5uZXh0PWE7cmV0dXJuIE59ZnVuY3Rpb24gc2EoKXtpZihudWxsPT09Syl7dmFyIGE9Qy5hbHRlcm5hdGU7YT1udWxsIT09YT9hLm1lbW9pemVkU3RhdGU6bnVsbH1lbHNlIGE9Sy5uZXh0O3ZhciBiPW51bGw9PT1OP0MubWVtb2l6ZWRTdGF0ZTpOLm5leHQ7aWYobnVsbCE9PWIpTj1iLEs9YTtlbHNle2lmKG51bGw9PT1hKXRocm93IEVycm9yKG0oMzEwKSk7Sz1hOwphPXttZW1vaXplZFN0YXRlOksubWVtb2l6ZWRTdGF0ZSxiYXNlU3RhdGU6Sy5iYXNlU3RhdGUsYmFzZVF1ZXVlOksuYmFzZVF1ZXVlLHF1ZXVlOksucXVldWUsbmV4dDpudWxsfTtudWxsPT09Tj9DLm1lbW9pemVkU3RhdGU9Tj1hOk49Ti5uZXh0PWF9cmV0dXJuIE59ZnVuY3Rpb24gQmMoYSxiKXtyZXR1cm4iZnVuY3Rpb24iPT09dHlwZW9mIGI/YihhKTpifWZ1bmN0aW9uIG9mKGEsYixjKXtiPXNhKCk7Yz1iLnF1ZXVlO2lmKG51bGw9PT1jKXRocm93IEVycm9yKG0oMzExKSk7Yy5sYXN0UmVuZGVyZWRSZWR1Y2VyPWE7dmFyIGQ9SyxlPWQuYmFzZVF1ZXVlLGY9Yy5wZW5kaW5nO2lmKG51bGwhPT1mKXtpZihudWxsIT09ZSl7dmFyIGc9ZS5uZXh0O2UubmV4dD1mLm5leHQ7Zi5uZXh0PWd9ZC5iYXNlUXVldWU9ZT1mO2MucGVuZGluZz1udWxsfWlmKG51bGwhPT1lKXtmPWUubmV4dDtkPWQuYmFzZVN0YXRlO3ZhciBoPWc9bnVsbCxrPW51bGwsbj1mO2Rve3ZhciBsPW4ubGFuZTtpZigodmImCmwpPT09bCludWxsIT09ayYmKGs9ay5uZXh0PXtsYW5lOjAsYWN0aW9uOm4uYWN0aW9uLGhhc0VhZ2VyU3RhdGU6bi5oYXNFYWdlclN0YXRlLGVhZ2VyU3RhdGU6bi5lYWdlclN0YXRlLG5leHQ6bnVsbH0pLGQ9bi5oYXNFYWdlclN0YXRlP24uZWFnZXJTdGF0ZTphKGQsbi5hY3Rpb24pO2Vsc2V7dmFyIHU9e2xhbmU6bCxhY3Rpb246bi5hY3Rpb24saGFzRWFnZXJTdGF0ZTpuLmhhc0VhZ2VyU3RhdGUsZWFnZXJTdGF0ZTpuLmVhZ2VyU3RhdGUsbmV4dDpudWxsfTtudWxsPT09az8oaD1rPXUsZz1kKTprPWsubmV4dD11O0MubGFuZXN8PWw7cmF8PWx9bj1uLm5leHR9d2hpbGUobnVsbCE9PW4mJm4hPT1mKTtudWxsPT09az9nPWQ6ay5uZXh0PWg7dWEoZCxiLm1lbW9pemVkU3RhdGUpfHwoaGE9ITApO2IubWVtb2l6ZWRTdGF0ZT1kO2IuYmFzZVN0YXRlPWc7Yi5iYXNlUXVldWU9aztjLmxhc3RSZW5kZXJlZFN0YXRlPWR9YT1jLmludGVybGVhdmVkO2lmKG51bGwhPT1hKXtlPWE7ZG8gZj0KZS5sYW5lLEMubGFuZXN8PWYscmF8PWYsZT1lLm5leHQ7d2hpbGUoZSE9PWEpfWVsc2UgbnVsbD09PWUmJihjLmxhbmVzPTApO3JldHVybltiLm1lbW9pemVkU3RhdGUsYy5kaXNwYXRjaF19ZnVuY3Rpb24gcGYoYSxiLGMpe2I9c2EoKTtjPWIucXVldWU7aWYobnVsbD09PWMpdGhyb3cgRXJyb3IobSgzMTEpKTtjLmxhc3RSZW5kZXJlZFJlZHVjZXI9YTt2YXIgZD1jLmRpc3BhdGNoLGU9Yy5wZW5kaW5nLGY9Yi5tZW1vaXplZFN0YXRlO2lmKG51bGwhPT1lKXtjLnBlbmRpbmc9bnVsbDt2YXIgZz1lPWUubmV4dDtkbyBmPWEoZixnLmFjdGlvbiksZz1nLm5leHQ7d2hpbGUoZyE9PWUpO3VhKGYsYi5tZW1vaXplZFN0YXRlKXx8KGhhPSEwKTtiLm1lbW9pemVkU3RhdGU9ZjtudWxsPT09Yi5iYXNlUXVldWUmJihiLmJhc2VTdGF0ZT1mKTtjLmxhc3RSZW5kZXJlZFN0YXRlPWZ9cmV0dXJuW2YsZF19ZnVuY3Rpb24gSmgoYSxiLGMpe31mdW5jdGlvbiBLaChhLGIsYyl7Yz1DO3ZhciBkPXNhKCksCmU9YigpLGY9IXVhKGQubWVtb2l6ZWRTdGF0ZSxlKTtmJiYoZC5tZW1vaXplZFN0YXRlPWUsaGE9ITApO2Q9ZC5xdWV1ZTtxZihMaC5iaW5kKG51bGwsYyxkLGEpLFthXSk7aWYoZC5nZXRTbmFwc2hvdCE9PWJ8fGZ8fG51bGwhPT1OJiZOLm1lbW9pemVkU3RhdGUudGFnJjEpe2MuZmxhZ3N8PTIwNDg7Q2MoOSxNaC5iaW5kKG51bGwsYyxkLGUsYiksdm9pZCAwLG51bGwpO2lmKG51bGw9PT1PKXRocm93IEVycm9yKG0oMzQ5KSk7MCE9PSh2YiYzMCl8fE5oKGMsYixlKX1yZXR1cm4gZX1mdW5jdGlvbiBOaChhLGIsYyl7YS5mbGFnc3w9MTYzODQ7YT17Z2V0U25hcHNob3Q6Yix2YWx1ZTpjfTtiPUMudXBkYXRlUXVldWU7bnVsbD09PWI/KGI9e2xhc3RFZmZlY3Q6bnVsbCxzdG9yZXM6bnVsbH0sQy51cGRhdGVRdWV1ZT1iLGIuc3RvcmVzPVthXSk6KGM9Yi5zdG9yZXMsbnVsbD09PWM/Yi5zdG9yZXM9W2FdOmMucHVzaChhKSl9ZnVuY3Rpb24gTWgoYSxiLGMsZCl7Yi52YWx1ZT1jO2IuZ2V0U25hcHNob3Q9CmQ7T2goYikmJlBoKGEpfWZ1bmN0aW9uIExoKGEsYixjKXtyZXR1cm4gYyhmdW5jdGlvbigpe09oKGIpJiZQaChhKX0pfWZ1bmN0aW9uIE9oKGEpe3ZhciBiPWEuZ2V0U25hcHNob3Q7YT1hLnZhbHVlO3RyeXt2YXIgYz1iKCk7cmV0dXJuIXVhKGEsYyl9Y2F0Y2goZCl7cmV0dXJuITB9fWZ1bmN0aW9uIFBoKGEpe3ZhciBiPU9hKGEsMSk7bnVsbCE9PWImJnhhKGIsYSwxLC0xKX1mdW5jdGlvbiBRaChhKXt2YXIgYj1GYSgpOyJmdW5jdGlvbiI9PT10eXBlb2YgYSYmKGE9YSgpKTtiLm1lbW9pemVkU3RhdGU9Yi5iYXNlU3RhdGU9YTthPXtwZW5kaW5nOm51bGwsaW50ZXJsZWF2ZWQ6bnVsbCxsYW5lczowLGRpc3BhdGNoOm51bGwsbGFzdFJlbmRlcmVkUmVkdWNlcjpCYyxsYXN0UmVuZGVyZWRTdGF0ZTphfTtiLnF1ZXVlPWE7YT1hLmRpc3BhdGNoPW9rLmJpbmQobnVsbCxDLGEpO3JldHVybltiLm1lbW9pemVkU3RhdGUsYV19ZnVuY3Rpb24gQ2MoYSxiLGMsZCl7YT17dGFnOmEsY3JlYXRlOmIsCmRlc3Ryb3k6YyxkZXBzOmQsbmV4dDpudWxsfTtiPUMudXBkYXRlUXVldWU7bnVsbD09PWI/KGI9e2xhc3RFZmZlY3Q6bnVsbCxzdG9yZXM6bnVsbH0sQy51cGRhdGVRdWV1ZT1iLGIubGFzdEVmZmVjdD1hLm5leHQ9YSk6KGM9Yi5sYXN0RWZmZWN0LG51bGw9PT1jP2IubGFzdEVmZmVjdD1hLm5leHQ9YTooZD1jLm5leHQsYy5uZXh0PWEsYS5uZXh0PWQsYi5sYXN0RWZmZWN0PWEpKTtyZXR1cm4gYX1mdW5jdGlvbiBSaChhKXtyZXR1cm4gc2EoKS5tZW1vaXplZFN0YXRlfWZ1bmN0aW9uIEJkKGEsYixjLGQpe3ZhciBlPUZhKCk7Qy5mbGFnc3w9YTtlLm1lbW9pemVkU3RhdGU9Q2MoMXxiLGMsdm9pZCAwLHZvaWQgMD09PWQ/bnVsbDpkKX1mdW5jdGlvbiBDZChhLGIsYyxkKXt2YXIgZT1zYSgpO2Q9dm9pZCAwPT09ZD9udWxsOmQ7dmFyIGY9dm9pZCAwO2lmKG51bGwhPT1LKXt2YXIgZz1LLm1lbW9pemVkU3RhdGU7Zj1nLmRlc3Ryb3k7aWYobnVsbCE9PWQmJmxmKGQsZy5kZXBzKSl7ZS5tZW1vaXplZFN0YXRlPQpDYyhiLGMsZixkKTtyZXR1cm59fUMuZmxhZ3N8PWE7ZS5tZW1vaXplZFN0YXRlPUNjKDF8YixjLGYsZCl9ZnVuY3Rpb24gU2goYSxiKXtyZXR1cm4gQmQoODM5MDY1Niw4LGEsYil9ZnVuY3Rpb24gcWYoYSxiKXtyZXR1cm4gQ2QoMjA0OCw4LGEsYil9ZnVuY3Rpb24gVGgoYSxiKXtyZXR1cm4gQ2QoNCwyLGEsYil9ZnVuY3Rpb24gVWgoYSxiKXtyZXR1cm4gQ2QoNCw0LGEsYil9ZnVuY3Rpb24gVmgoYSxiKXtpZigiZnVuY3Rpb24iPT09dHlwZW9mIGIpcmV0dXJuIGE9YSgpLGIoYSksZnVuY3Rpb24oKXtiKG51bGwpfTtpZihudWxsIT09YiYmdm9pZCAwIT09YilyZXR1cm4gYT1hKCksYi5jdXJyZW50PWEsZnVuY3Rpb24oKXtiLmN1cnJlbnQ9bnVsbH19ZnVuY3Rpb24gV2goYSxiLGMpe2M9bnVsbCE9PWMmJnZvaWQgMCE9PWM/Yy5jb25jYXQoW2FdKTpudWxsO3JldHVybiBDZCg0LDQsVmguYmluZChudWxsLGIsYSksYyl9ZnVuY3Rpb24gcmYoYSxiKXt9ZnVuY3Rpb24gWGgoYSxiKXt2YXIgYz0Kc2EoKTtiPXZvaWQgMD09PWI/bnVsbDpiO3ZhciBkPWMubWVtb2l6ZWRTdGF0ZTtpZihudWxsIT09ZCYmbnVsbCE9PWImJmxmKGIsZFsxXSkpcmV0dXJuIGRbMF07Yy5tZW1vaXplZFN0YXRlPVthLGJdO3JldHVybiBhfWZ1bmN0aW9uIFloKGEsYil7dmFyIGM9c2EoKTtiPXZvaWQgMD09PWI/bnVsbDpiO3ZhciBkPWMubWVtb2l6ZWRTdGF0ZTtpZihudWxsIT09ZCYmbnVsbCE9PWImJmxmKGIsZFsxXSkpcmV0dXJuIGRbMF07YT1hKCk7Yy5tZW1vaXplZFN0YXRlPVthLGJdO3JldHVybiBhfWZ1bmN0aW9uIFpoKGEsYixjKXtpZigwPT09KHZiJjIxKSlyZXR1cm4gYS5iYXNlU3RhdGUmJihhLmJhc2VTdGF0ZT0hMSxoYT0hMCksYS5tZW1vaXplZFN0YXRlPWM7dWEoYyxiKXx8KGM9RGcoKSxDLmxhbmVzfD1jLHJhfD1jLGEuYmFzZVN0YXRlPSEwKTtyZXR1cm4gYn1mdW5jdGlvbiBwayhhLGIsYyl7Yz16O3o9MCE9PWMmJjQ+Yz9jOjQ7YSghMCk7dmFyIGQ9c2YudHJhbnNpdGlvbjtzZi50cmFuc2l0aW9uPQp7fTt0cnl7YSghMSksYigpfWZpbmFsbHl7ej1jLHNmLnRyYW5zaXRpb249ZH19ZnVuY3Rpb24gJGgoKXtyZXR1cm4gc2EoKS5tZW1vaXplZFN0YXRlfWZ1bmN0aW9uIHFrKGEsYixjKXt2YXIgZD1oYihhKTtjPXtsYW5lOmQsYWN0aW9uOmMsaGFzRWFnZXJTdGF0ZTohMSxlYWdlclN0YXRlOm51bGwsbmV4dDpudWxsfTtpZihhaShhKSliaShiLGMpO2Vsc2UgaWYoYz1FaChhLGIsYyxkKSxudWxsIT09Yyl7dmFyIGU9WigpO3hhKGMsYSxkLGUpO2NpKGMsYixkKX19ZnVuY3Rpb24gb2soYSxiLGMpe3ZhciBkPWhiKGEpLGU9e2xhbmU6ZCxhY3Rpb246YyxoYXNFYWdlclN0YXRlOiExLGVhZ2VyU3RhdGU6bnVsbCxuZXh0Om51bGx9O2lmKGFpKGEpKWJpKGIsZSk7ZWxzZXt2YXIgZj1hLmFsdGVybmF0ZTtpZigwPT09YS5sYW5lcyYmKG51bGw9PT1mfHwwPT09Zi5sYW5lcykmJihmPWIubGFzdFJlbmRlcmVkUmVkdWNlcixudWxsIT09ZikpdHJ5e3ZhciBnPWIubGFzdFJlbmRlcmVkU3RhdGUsCmg9ZihnLGMpO2UuaGFzRWFnZXJTdGF0ZT0hMDtlLmVhZ2VyU3RhdGU9aDtpZih1YShoLGcpKXt2YXIgaz1iLmludGVybGVhdmVkO251bGw9PT1rPyhlLm5leHQ9ZSxlZihiKSk6KGUubmV4dD1rLm5leHQsay5uZXh0PWUpO2IuaW50ZXJsZWF2ZWQ9ZTtyZXR1cm59fWNhdGNoKG4pe31maW5hbGx5e31jPUVoKGEsYixlLGQpO251bGwhPT1jJiYoZT1aKCkseGEoYyxhLGQsZSksY2koYyxiLGQpKX19ZnVuY3Rpb24gYWkoYSl7dmFyIGI9YS5hbHRlcm5hdGU7cmV0dXJuIGE9PT1DfHxudWxsIT09YiYmYj09PUN9ZnVuY3Rpb24gYmkoYSxiKXt6Yz1BZD0hMDt2YXIgYz1hLnBlbmRpbmc7bnVsbD09PWM/Yi5uZXh0PWI6KGIubmV4dD1jLm5leHQsYy5uZXh0PWIpO2EucGVuZGluZz1ifWZ1bmN0aW9uIGNpKGEsYixjKXtpZigwIT09KGMmNDE5NDI0MCkpe3ZhciBkPWIubGFuZXM7ZCY9YS5wZW5kaW5nTGFuZXM7Y3w9ZDtiLmxhbmVzPWM7eGUoYSxjKX19ZnVuY3Rpb24geWEoYSxiKXtpZihhJiYKYS5kZWZhdWx0UHJvcHMpe2I9RSh7fSxiKTthPWEuZGVmYXVsdFByb3BzO2Zvcih2YXIgYyBpbiBhKXZvaWQgMD09PWJbY10mJihiW2NdPWFbY10pO3JldHVybiBifXJldHVybiBifWZ1bmN0aW9uIHRmKGEsYixjLGQpe2I9YS5tZW1vaXplZFN0YXRlO2M9YyhkLGIpO2M9bnVsbD09PWN8fHZvaWQgMD09PWM/YjpFKHt9LGIsYyk7YS5tZW1vaXplZFN0YXRlPWM7MD09PWEubGFuZXMmJihhLnVwZGF0ZVF1ZXVlLmJhc2VTdGF0ZT1jKX1mdW5jdGlvbiBkaShhLGIsYyxkLGUsZixnKXthPWEuc3RhdGVOb2RlO3JldHVybiJmdW5jdGlvbiI9PT10eXBlb2YgYS5zaG91bGRDb21wb25lbnRVcGRhdGU/YS5zaG91bGRDb21wb25lbnRVcGRhdGUoZCxmLGcpOmIucHJvdG90eXBlJiZiLnByb3RvdHlwZS5pc1B1cmVSZWFjdENvbXBvbmVudD8hcWMoYyxkKXx8IXFjKGUsZik6ITB9ZnVuY3Rpb24gZWkoYSxiLGMpe3ZhciBkPSExLGU9Y2I7dmFyIGY9Yi5jb250ZXh0VHlwZTsib2JqZWN0Ij09PXR5cGVvZiBmJiYKbnVsbCE9PWY/Zj1xYShmKTooZT1lYShiKT9wYjpKLmN1cnJlbnQsZD1iLmNvbnRleHRUeXBlcyxmPShkPW51bGwhPT1kJiZ2b2lkIDAhPT1kKT9OYihhLGUpOmNiKTtiPW5ldyBiKGMsZik7YS5tZW1vaXplZFN0YXRlPW51bGwhPT1iLnN0YXRlJiZ2b2lkIDAhPT1iLnN0YXRlP2Iuc3RhdGU6bnVsbDtiLnVwZGF0ZXI9RGQ7YS5zdGF0ZU5vZGU9YjtiLl9yZWFjdEludGVybmFscz1hO2QmJihhPWEuc3RhdGVOb2RlLGEuX19yZWFjdEludGVybmFsTWVtb2l6ZWRVbm1hc2tlZENoaWxkQ29udGV4dD1lLGEuX19yZWFjdEludGVybmFsTWVtb2l6ZWRNYXNrZWRDaGlsZENvbnRleHQ9Zik7cmV0dXJuIGJ9ZnVuY3Rpb24gZmkoYSxiLGMsZCl7YT1iLnN0YXRlOyJmdW5jdGlvbiI9PT10eXBlb2YgYi5jb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzJiZiLmNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMoYyxkKTsiZnVuY3Rpb24iPT09dHlwZW9mIGIuVU5TQUZFX2NvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMmJgpiLlVOU0FGRV9jb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKGMsZCk7Yi5zdGF0ZSE9PWEmJkRkLmVucXVldWVSZXBsYWNlU3RhdGUoYixiLnN0YXRlLG51bGwpfWZ1bmN0aW9uIHVmKGEsYixjLGQpe3ZhciBlPWEuc3RhdGVOb2RlO2UucHJvcHM9YztlLnN0YXRlPWEubWVtb2l6ZWRTdGF0ZTtlLnJlZnM9e307ZmYoYSk7dmFyIGY9Yi5jb250ZXh0VHlwZTsib2JqZWN0Ij09PXR5cGVvZiBmJiZudWxsIT09Zj9lLmNvbnRleHQ9cWEoZik6KGY9ZWEoYik/cGI6Si5jdXJyZW50LGUuY29udGV4dD1OYihhLGYpKTtlLnN0YXRlPWEubWVtb2l6ZWRTdGF0ZTtmPWIuZ2V0RGVyaXZlZFN0YXRlRnJvbVByb3BzOyJmdW5jdGlvbiI9PT10eXBlb2YgZiYmKHRmKGEsYixmLGMpLGUuc3RhdGU9YS5tZW1vaXplZFN0YXRlKTsiZnVuY3Rpb24iPT09dHlwZW9mIGIuZ2V0RGVyaXZlZFN0YXRlRnJvbVByb3BzfHwiZnVuY3Rpb24iPT09dHlwZW9mIGUuZ2V0U25hcHNob3RCZWZvcmVVcGRhdGV8fCJmdW5jdGlvbiIhPT0KdHlwZW9mIGUuVU5TQUZFX2NvbXBvbmVudFdpbGxNb3VudCYmImZ1bmN0aW9uIiE9PXR5cGVvZiBlLmNvbXBvbmVudFdpbGxNb3VudHx8KGI9ZS5zdGF0ZSwiZnVuY3Rpb24iPT09dHlwZW9mIGUuY29tcG9uZW50V2lsbE1vdW50JiZlLmNvbXBvbmVudFdpbGxNb3VudCgpLCJmdW5jdGlvbiI9PT10eXBlb2YgZS5VTlNBRkVfY29tcG9uZW50V2lsbE1vdW50JiZlLlVOU0FGRV9jb21wb25lbnRXaWxsTW91bnQoKSxiIT09ZS5zdGF0ZSYmRGQuZW5xdWV1ZVJlcGxhY2VTdGF0ZShlLGUuc3RhdGUsbnVsbCksd2QoYSxjLGUsZCksZS5zdGF0ZT1hLm1lbW9pemVkU3RhdGUpOyJmdW5jdGlvbiI9PT10eXBlb2YgZS5jb21wb25lbnREaWRNb3VudCYmKGEuZmxhZ3N8PTQxOTQzMDgpfWZ1bmN0aW9uIFViKGEsYil7dHJ5e3ZhciBjPSIiLGQ9YjtkbyBjKz1maihkKSxkPWQucmV0dXJuO3doaWxlKGQpO3ZhciBlPWN9Y2F0Y2goZil7ZT0iXG5FcnJvciBnZW5lcmF0aW5nIHN0YWNrOiAiK2YubWVzc2FnZSsKIlxuIitmLnN0YWNrfXJldHVybnt2YWx1ZTphLHNvdXJjZTpiLHN0YWNrOmUsZGlnZXN0Om51bGx9fWZ1bmN0aW9uIHZmKGEsYixjKXtyZXR1cm57dmFsdWU6YSxzb3VyY2U6bnVsbCxzdGFjazpudWxsIT1jP2M6bnVsbCxkaWdlc3Q6bnVsbCE9Yj9iOm51bGx9fWZ1bmN0aW9uIHdmKGEsYil7dHJ5e2NvbnNvbGUuZXJyb3IoYi52YWx1ZSl9Y2F0Y2goYyl7c2V0VGltZW91dChmdW5jdGlvbigpe3Rocm93IGM7fSl9fWZ1bmN0aW9uIGdpKGEsYixjKXtjPVBhKC0xLGMpO2MudGFnPTM7Yy5wYXlsb2FkPXtlbGVtZW50Om51bGx9O3ZhciBkPWIudmFsdWU7Yy5jYWxsYmFjaz1mdW5jdGlvbigpe0VkfHwoRWQ9ITAseGY9ZCk7d2YoYSxiKX07cmV0dXJuIGN9ZnVuY3Rpb24gaGkoYSxiLGMpe2M9UGEoLTEsYyk7Yy50YWc9Mzt2YXIgZD1hLnR5cGUuZ2V0RGVyaXZlZFN0YXRlRnJvbUVycm9yO2lmKCJmdW5jdGlvbiI9PT10eXBlb2YgZCl7dmFyIGU9Yi52YWx1ZTtjLnBheWxvYWQ9ZnVuY3Rpb24oKXtyZXR1cm4gZChlKX07CmMuY2FsbGJhY2s9ZnVuY3Rpb24oKXt3ZihhLGIpfX12YXIgZj1hLnN0YXRlTm9kZTtudWxsIT09ZiYmImZ1bmN0aW9uIj09PXR5cGVvZiBmLmNvbXBvbmVudERpZENhdGNoJiYoYy5jYWxsYmFjaz1mdW5jdGlvbigpe3dmKGEsYik7ImZ1bmN0aW9uIiE9PXR5cGVvZiBkJiYobnVsbD09PWliP2liPW5ldyBTZXQoW3RoaXNdKTppYi5hZGQodGhpcykpO3ZhciBjPWIuc3RhY2s7dGhpcy5jb21wb25lbnREaWRDYXRjaChiLnZhbHVlLHtjb21wb25lbnRTdGFjazpudWxsIT09Yz9jOiIifSl9KTtyZXR1cm4gY31mdW5jdGlvbiBpaShhLGIsYyl7dmFyIGQ9YS5waW5nQ2FjaGU7aWYobnVsbD09PWQpe2Q9YS5waW5nQ2FjaGU9bmV3IHJrO3ZhciBlPW5ldyBTZXQ7ZC5zZXQoYixlKX1lbHNlIGU9ZC5nZXQoYiksdm9pZCAwPT09ZSYmKGU9bmV3IFNldCxkLnNldChiLGUpKTtlLmhhcyhjKXx8KGUuYWRkKGMpLGE9c2suYmluZChudWxsLGEsYixjKSxiLnRoZW4oYSxhKSl9ZnVuY3Rpb24gamkoYSl7ZG97dmFyIGI7CmlmKGI9MTM9PT1hLnRhZyliPWEubWVtb2l6ZWRTdGF0ZSxiPW51bGwhPT1iP251bGwhPT1iLmRlaHlkcmF0ZWQ/ITA6ITE6ITA7aWYoYilyZXR1cm4gYTthPWEucmV0dXJufXdoaWxlKG51bGwhPT1hKTtyZXR1cm4gbnVsbH1mdW5jdGlvbiBraShhLGIsYyxkLGUpe2lmKDA9PT0oYS5tb2RlJjEpKXJldHVybiBhPT09Yj9hLmZsYWdzfD02NTUzNjooYS5mbGFnc3w9MTI4LGMuZmxhZ3N8PTEzMTA3MixjLmZsYWdzJj0tNTI4MDUsMT09PWMudGFnJiYobnVsbD09PWMuYWx0ZXJuYXRlP2MudGFnPTE3OihiPVBhKC0xLDEpLGIudGFnPTIsZmIoYyxiLDEpKSksYy5sYW5lc3w9MSksYTthLmZsYWdzfD02NTUzNjthLmxhbmVzPWU7cmV0dXJuIGF9ZnVuY3Rpb24gYWEoYSxiLGMsZCl7Yi5jaGlsZD1udWxsPT09YT9saShiLG51bGwsYyxkKTpWYihiLGEuY2hpbGQsYyxkKX1mdW5jdGlvbiBtaShhLGIsYyxkLGUpe2M9Yy5yZW5kZXI7dmFyIGY9Yi5yZWY7U2IoYixlKTtkPW1mKGEsYixjLGQsZiwKZSk7Yz1uZigpO2lmKG51bGwhPT1hJiYhaGEpcmV0dXJuIGIudXBkYXRlUXVldWU9YS51cGRhdGVRdWV1ZSxiLmZsYWdzJj0tMjA1MyxhLmxhbmVzJj1+ZSxRYShhLGIsZSk7RCYmYyYmVWUoYik7Yi5mbGFnc3w9MTthYShhLGIsZCxlKTtyZXR1cm4gYi5jaGlsZH1mdW5jdGlvbiBuaShhLGIsYyxkLGUpe2lmKG51bGw9PT1hKXt2YXIgZj1jLnR5cGU7aWYoImZ1bmN0aW9uIj09PXR5cGVvZiBmJiYheWYoZikmJnZvaWQgMD09PWYuZGVmYXVsdFByb3BzJiZudWxsPT09Yy5jb21wYXJlJiZ2b2lkIDA9PT1jLmRlZmF1bHRQcm9wcylyZXR1cm4gYi50YWc9MTUsYi50eXBlPWYsb2koYSxiLGYsZCxlKTthPXJkKGMudHlwZSxudWxsLGQsYixiLm1vZGUsZSk7YS5yZWY9Yi5yZWY7YS5yZXR1cm49YjtyZXR1cm4gYi5jaGlsZD1hfWY9YS5jaGlsZDtpZigwPT09KGEubGFuZXMmZSkpe3ZhciBnPWYubWVtb2l6ZWRQcm9wcztjPWMuY29tcGFyZTtjPW51bGwhPT1jP2M6cWM7aWYoYyhnLGQpJiZhLnJlZj09PQpiLnJlZilyZXR1cm4gUWEoYSxiLGUpfWIuZmxhZ3N8PTE7YT1lYihmLGQpO2EucmVmPWIucmVmO2EucmV0dXJuPWI7cmV0dXJuIGIuY2hpbGQ9YX1mdW5jdGlvbiBvaShhLGIsYyxkLGUpe2lmKG51bGwhPT1hKXt2YXIgZj1hLm1lbW9pemVkUHJvcHM7aWYocWMoZixkKSYmYS5yZWY9PT1iLnJlZilpZihoYT0hMSxiLnBlbmRpbmdQcm9wcz1kPWYsMCE9PShhLmxhbmVzJmUpKTAhPT0oYS5mbGFncyYxMzEwNzIpJiYoaGE9ITApO2Vsc2UgcmV0dXJuIGIubGFuZXM9YS5sYW5lcyxRYShhLGIsZSl9cmV0dXJuIHpmKGEsYixjLGQsZSl9ZnVuY3Rpb24gcGkoYSxiLGMpe3ZhciBkPWIucGVuZGluZ1Byb3BzLGU9ZC5jaGlsZHJlbixmPW51bGwhPT1hP2EubWVtb2l6ZWRTdGF0ZTpudWxsO2lmKCJoaWRkZW4iPT09ZC5tb2RlKWlmKDA9PT0oYi5tb2RlJjEpKWIubWVtb2l6ZWRTdGF0ZT17YmFzZUxhbmVzOjAsY2FjaGVQb29sOm51bGwsdHJhbnNpdGlvbnM6bnVsbH0seShHYSxiYSksYmF8PWM7CmVsc2V7aWYoMD09PShjJjEwNzM3NDE4MjQpKXJldHVybiBhPW51bGwhPT1mP2YuYmFzZUxhbmVzfGM6YyxiLmxhbmVzPWIuY2hpbGRMYW5lcz0xMDczNzQxODI0LGIubWVtb2l6ZWRTdGF0ZT17YmFzZUxhbmVzOmEsY2FjaGVQb29sOm51bGwsdHJhbnNpdGlvbnM6bnVsbH0sYi51cGRhdGVRdWV1ZT1udWxsLHkoR2EsYmEpLGJhfD1hLG51bGw7Yi5tZW1vaXplZFN0YXRlPXtiYXNlTGFuZXM6MCxjYWNoZVBvb2w6bnVsbCx0cmFuc2l0aW9uczpudWxsfTtkPW51bGwhPT1mP2YuYmFzZUxhbmVzOmM7eShHYSxiYSk7YmF8PWR9ZWxzZSBudWxsIT09Zj8oZD1mLmJhc2VMYW5lc3xjLGIubWVtb2l6ZWRTdGF0ZT1udWxsKTpkPWMseShHYSxiYSksYmF8PWQ7YWEoYSxiLGUsYyk7cmV0dXJuIGIuY2hpbGR9ZnVuY3Rpb24gcWkoYSxiKXt2YXIgYz1iLnJlZjtpZihudWxsPT09YSYmbnVsbCE9PWN8fG51bGwhPT1hJiZhLnJlZiE9PWMpYi5mbGFnc3w9NTEyLGIuZmxhZ3N8PTIwOTcxNTJ9ZnVuY3Rpb24gemYoYSwKYixjLGQsZSl7dmFyIGY9ZWEoYyk/cGI6Si5jdXJyZW50O2Y9TmIoYixmKTtTYihiLGUpO2M9bWYoYSxiLGMsZCxmLGUpO2Q9bmYoKTtpZihudWxsIT09YSYmIWhhKXJldHVybiBiLnVwZGF0ZVF1ZXVlPWEudXBkYXRlUXVldWUsYi5mbGFncyY9LTIwNTMsYS5sYW5lcyY9fmUsUWEoYSxiLGUpO0QmJmQmJlVlKGIpO2IuZmxhZ3N8PTE7YWEoYSxiLGMsZSk7cmV0dXJuIGIuY2hpbGR9ZnVuY3Rpb24gcmkoYSxiLGMsZCxlKXtpZihlYShjKSl7dmFyIGY9ITA7bGQoYil9ZWxzZSBmPSExO1NiKGIsZSk7aWYobnVsbD09PWIuc3RhdGVOb2RlKUZkKGEsYiksZWkoYixjLGQpLHVmKGIsYyxkLGUpLGQ9ITA7ZWxzZSBpZihudWxsPT09YSl7dmFyIGc9Yi5zdGF0ZU5vZGUsaD1iLm1lbW9pemVkUHJvcHM7Zy5wcm9wcz1oO3ZhciBrPWcuY29udGV4dCxuPWMuY29udGV4dFR5cGU7Im9iamVjdCI9PT10eXBlb2YgbiYmbnVsbCE9PW4/bj1xYShuKToobj1lYShjKT9wYjpKLmN1cnJlbnQsbj1OYihiLApuKSk7dmFyIGw9Yy5nZXREZXJpdmVkU3RhdGVGcm9tUHJvcHMsbT0iZnVuY3Rpb24iPT09dHlwZW9mIGx8fCJmdW5jdGlvbiI9PT10eXBlb2YgZy5nZXRTbmFwc2hvdEJlZm9yZVVwZGF0ZTttfHwiZnVuY3Rpb24iIT09dHlwZW9mIGcuVU5TQUZFX2NvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMmJiJmdW5jdGlvbiIhPT10eXBlb2YgZy5jb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzfHwoaCE9PWR8fGshPT1uKSYmZmkoYixnLGQsbik7Z2I9ITE7dmFyIHI9Yi5tZW1vaXplZFN0YXRlO2cuc3RhdGU9cjt3ZChiLGQsZyxlKTtrPWIubWVtb2l6ZWRTdGF0ZTtoIT09ZHx8ciE9PWt8fFMuY3VycmVudHx8Z2I/KCJmdW5jdGlvbiI9PT10eXBlb2YgbCYmKHRmKGIsYyxsLGQpLGs9Yi5tZW1vaXplZFN0YXRlKSwoaD1nYnx8ZGkoYixjLGgsZCxyLGssbikpPyhtfHwiZnVuY3Rpb24iIT09dHlwZW9mIGcuVU5TQUZFX2NvbXBvbmVudFdpbGxNb3VudCYmImZ1bmN0aW9uIiE9PXR5cGVvZiBnLmNvbXBvbmVudFdpbGxNb3VudHx8CigiZnVuY3Rpb24iPT09dHlwZW9mIGcuY29tcG9uZW50V2lsbE1vdW50JiZnLmNvbXBvbmVudFdpbGxNb3VudCgpLCJmdW5jdGlvbiI9PT10eXBlb2YgZy5VTlNBRkVfY29tcG9uZW50V2lsbE1vdW50JiZnLlVOU0FGRV9jb21wb25lbnRXaWxsTW91bnQoKSksImZ1bmN0aW9uIj09PXR5cGVvZiBnLmNvbXBvbmVudERpZE1vdW50JiYoYi5mbGFnc3w9NDE5NDMwOCkpOigiZnVuY3Rpb24iPT09dHlwZW9mIGcuY29tcG9uZW50RGlkTW91bnQmJihiLmZsYWdzfD00MTk0MzA4KSxiLm1lbW9pemVkUHJvcHM9ZCxiLm1lbW9pemVkU3RhdGU9ayksZy5wcm9wcz1kLGcuc3RhdGU9ayxnLmNvbnRleHQ9bixkPWgpOigiZnVuY3Rpb24iPT09dHlwZW9mIGcuY29tcG9uZW50RGlkTW91bnQmJihiLmZsYWdzfD00MTk0MzA4KSxkPSExKX1lbHNle2c9Yi5zdGF0ZU5vZGU7RmgoYSxiKTtoPWIubWVtb2l6ZWRQcm9wcztuPWIudHlwZT09PWIuZWxlbWVudFR5cGU/aDp5YShiLnR5cGUsaCk7Zy5wcm9wcz0KbjttPWIucGVuZGluZ1Byb3BzO3I9Zy5jb250ZXh0O2s9Yy5jb250ZXh0VHlwZTsib2JqZWN0Ij09PXR5cGVvZiBrJiZudWxsIT09az9rPXFhKGspOihrPWVhKGMpP3BiOkouY3VycmVudCxrPU5iKGIsaykpO3ZhciBwPWMuZ2V0RGVyaXZlZFN0YXRlRnJvbVByb3BzOyhsPSJmdW5jdGlvbiI9PT10eXBlb2YgcHx8ImZ1bmN0aW9uIj09PXR5cGVvZiBnLmdldFNuYXBzaG90QmVmb3JlVXBkYXRlKXx8ImZ1bmN0aW9uIiE9PXR5cGVvZiBnLlVOU0FGRV9jb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzJiYiZnVuY3Rpb24iIT09dHlwZW9mIGcuY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wc3x8KGghPT1tfHxyIT09aykmJmZpKGIsZyxkLGspO2diPSExO3I9Yi5tZW1vaXplZFN0YXRlO2cuc3RhdGU9cjt3ZChiLGQsZyxlKTt2YXIgeD1iLm1lbW9pemVkU3RhdGU7aCE9PW18fHIhPT14fHxTLmN1cnJlbnR8fGdiPygiZnVuY3Rpb24iPT09dHlwZW9mIHAmJih0ZihiLGMscCxkKSx4PWIubWVtb2l6ZWRTdGF0ZSksCihuPWdifHxkaShiLGMsbixkLHIseCxrKXx8ITEpPyhsfHwiZnVuY3Rpb24iIT09dHlwZW9mIGcuVU5TQUZFX2NvbXBvbmVudFdpbGxVcGRhdGUmJiJmdW5jdGlvbiIhPT10eXBlb2YgZy5jb21wb25lbnRXaWxsVXBkYXRlfHwoImZ1bmN0aW9uIj09PXR5cGVvZiBnLmNvbXBvbmVudFdpbGxVcGRhdGUmJmcuY29tcG9uZW50V2lsbFVwZGF0ZShkLHgsayksImZ1bmN0aW9uIj09PXR5cGVvZiBnLlVOU0FGRV9jb21wb25lbnRXaWxsVXBkYXRlJiZnLlVOU0FGRV9jb21wb25lbnRXaWxsVXBkYXRlKGQseCxrKSksImZ1bmN0aW9uIj09PXR5cGVvZiBnLmNvbXBvbmVudERpZFVwZGF0ZSYmKGIuZmxhZ3N8PTQpLCJmdW5jdGlvbiI9PT10eXBlb2YgZy5nZXRTbmFwc2hvdEJlZm9yZVVwZGF0ZSYmKGIuZmxhZ3N8PTEwMjQpKTooImZ1bmN0aW9uIiE9PXR5cGVvZiBnLmNvbXBvbmVudERpZFVwZGF0ZXx8aD09PWEubWVtb2l6ZWRQcm9wcyYmcj09PWEubWVtb2l6ZWRTdGF0ZXx8KGIuZmxhZ3N8PQo0KSwiZnVuY3Rpb24iIT09dHlwZW9mIGcuZ2V0U25hcHNob3RCZWZvcmVVcGRhdGV8fGg9PT1hLm1lbW9pemVkUHJvcHMmJnI9PT1hLm1lbW9pemVkU3RhdGV8fChiLmZsYWdzfD0xMDI0KSxiLm1lbW9pemVkUHJvcHM9ZCxiLm1lbW9pemVkU3RhdGU9eCksZy5wcm9wcz1kLGcuc3RhdGU9eCxnLmNvbnRleHQ9ayxkPW4pOigiZnVuY3Rpb24iIT09dHlwZW9mIGcuY29tcG9uZW50RGlkVXBkYXRlfHxoPT09YS5tZW1vaXplZFByb3BzJiZyPT09YS5tZW1vaXplZFN0YXRlfHwoYi5mbGFnc3w9NCksImZ1bmN0aW9uIiE9PXR5cGVvZiBnLmdldFNuYXBzaG90QmVmb3JlVXBkYXRlfHxoPT09YS5tZW1vaXplZFByb3BzJiZyPT09YS5tZW1vaXplZFN0YXRlfHwoYi5mbGFnc3w9MTAyNCksZD0hMSl9cmV0dXJuIEFmKGEsYixjLGQsZixlKX1mdW5jdGlvbiBBZihhLGIsYyxkLGUsZil7cWkoYSxiKTt2YXIgZz0wIT09KGIuZmxhZ3MmMTI4KTtpZighZCYmIWcpcmV0dXJuIGUmJnZoKGIsYywhMSksClFhKGEsYixmKTtkPWIuc3RhdGVOb2RlO3RrLmN1cnJlbnQ9Yjt2YXIgaD1nJiYiZnVuY3Rpb24iIT09dHlwZW9mIGMuZ2V0RGVyaXZlZFN0YXRlRnJvbUVycm9yP251bGw6ZC5yZW5kZXIoKTtiLmZsYWdzfD0xO251bGwhPT1hJiZnPyhiLmNoaWxkPVZiKGIsYS5jaGlsZCxudWxsLGYpLGIuY2hpbGQ9VmIoYixudWxsLGgsZikpOmFhKGEsYixoLGYpO2IubWVtb2l6ZWRTdGF0ZT1kLnN0YXRlO2UmJnZoKGIsYywhMCk7cmV0dXJuIGIuY2hpbGR9ZnVuY3Rpb24gc2koYSl7dmFyIGI9YS5zdGF0ZU5vZGU7Yi5wZW5kaW5nQ29udGV4dD90aChhLGIucGVuZGluZ0NvbnRleHQsYi5wZW5kaW5nQ29udGV4dCE9PWIuY29udGV4dCk6Yi5jb250ZXh0JiZ0aChhLGIuY29udGV4dCwhMSk7Z2YoYSxiLmNvbnRhaW5lckluZm8pfWZ1bmN0aW9uIHRpKGEsYixjLGQsZSl7UWIoKTtZZShlKTtiLmZsYWdzfD0yNTY7YWEoYSxiLGMsZCk7cmV0dXJuIGIuY2hpbGR9ZnVuY3Rpb24gQmYoYSl7cmV0dXJue2Jhc2VMYW5lczphLApjYWNoZVBvb2w6bnVsbCx0cmFuc2l0aW9uczpudWxsfX1mdW5jdGlvbiB1aShhLGIsYyl7dmFyIGQ9Yi5wZW5kaW5nUHJvcHMsZT1GLmN1cnJlbnQsZj0hMSxnPTAhPT0oYi5mbGFncyYxMjgpLGg7KGg9Zyl8fChoPW51bGwhPT1hJiZudWxsPT09YS5tZW1vaXplZFN0YXRlPyExOjAhPT0oZSYyKSk7aWYoaClmPSEwLGIuZmxhZ3MmPS0xMjk7ZWxzZSBpZihudWxsPT09YXx8bnVsbCE9PWEubWVtb2l6ZWRTdGF0ZSllfD0xO3koRixlJjEpO2lmKG51bGw9PT1hKXtYZShiKTthPWIubWVtb2l6ZWRTdGF0ZTtpZihudWxsIT09YSYmKGE9YS5kZWh5ZHJhdGVkLG51bGwhPT1hKSlyZXR1cm4gMD09PShiLm1vZGUmMSk/Yi5sYW5lcz0xOiIkISI9PT1hLmRhdGE/Yi5sYW5lcz04OmIubGFuZXM9MTA3Mzc0MTgyNCxudWxsO2c9ZC5jaGlsZHJlbjthPWQuZmFsbGJhY2s7cmV0dXJuIGY/KGQ9Yi5tb2RlLGY9Yi5jaGlsZCxnPXttb2RlOiJoaWRkZW4iLGNoaWxkcmVuOmd9LDA9PT0oZCYxKSYmbnVsbCE9PQpmPyhmLmNoaWxkTGFuZXM9MCxmLnBlbmRpbmdQcm9wcz1nKTpmPUdkKGcsZCwwLG51bGwpLGE9c2IoYSxkLGMsbnVsbCksZi5yZXR1cm49YixhLnJldHVybj1iLGYuc2libGluZz1hLGIuY2hpbGQ9ZixiLmNoaWxkLm1lbW9pemVkU3RhdGU9QmYoYyksYi5tZW1vaXplZFN0YXRlPUNmLGEpOkRmKGIsZyl9ZT1hLm1lbW9pemVkU3RhdGU7aWYobnVsbCE9PWUmJihoPWUuZGVoeWRyYXRlZCxudWxsIT09aCkpcmV0dXJuIHVrKGEsYixnLGQsaCxlLGMpO2lmKGYpe2Y9ZC5mYWxsYmFjaztnPWIubW9kZTtlPWEuY2hpbGQ7aD1lLnNpYmxpbmc7dmFyIGs9e21vZGU6ImhpZGRlbiIsY2hpbGRyZW46ZC5jaGlsZHJlbn07MD09PShnJjEpJiZiLmNoaWxkIT09ZT8oZD1iLmNoaWxkLGQuY2hpbGRMYW5lcz0wLGQucGVuZGluZ1Byb3BzPWssYi5kZWxldGlvbnM9bnVsbCk6KGQ9ZWIoZSxrKSxkLnN1YnRyZWVGbGFncz1lLnN1YnRyZWVGbGFncyYxNDY4MDA2NCk7bnVsbCE9PWg/Zj1lYihoLGYpOihmPQpzYihmLGcsYyxudWxsKSxmLmZsYWdzfD0yKTtmLnJldHVybj1iO2QucmV0dXJuPWI7ZC5zaWJsaW5nPWY7Yi5jaGlsZD1kO2Q9ZjtmPWIuY2hpbGQ7Zz1hLmNoaWxkLm1lbW9pemVkU3RhdGU7Zz1udWxsPT09Zz9CZihjKTp7YmFzZUxhbmVzOmcuYmFzZUxhbmVzfGMsY2FjaGVQb29sOm51bGwsdHJhbnNpdGlvbnM6Zy50cmFuc2l0aW9uc307Zi5tZW1vaXplZFN0YXRlPWc7Zi5jaGlsZExhbmVzPWEuY2hpbGRMYW5lcyZ+YztiLm1lbW9pemVkU3RhdGU9Q2Y7cmV0dXJuIGR9Zj1hLmNoaWxkO2E9Zi5zaWJsaW5nO2Q9ZWIoZix7bW9kZToidmlzaWJsZSIsY2hpbGRyZW46ZC5jaGlsZHJlbn0pOzA9PT0oYi5tb2RlJjEpJiYoZC5sYW5lcz1jKTtkLnJldHVybj1iO2Quc2libGluZz1udWxsO251bGwhPT1hJiYoYz1iLmRlbGV0aW9ucyxudWxsPT09Yz8oYi5kZWxldGlvbnM9W2FdLGIuZmxhZ3N8PTE2KTpjLnB1c2goYSkpO2IuY2hpbGQ9ZDtiLm1lbW9pemVkU3RhdGU9bnVsbDtyZXR1cm4gZH0KZnVuY3Rpb24gRGYoYSxiLGMpe2I9R2Qoe21vZGU6InZpc2libGUiLGNoaWxkcmVuOmJ9LGEubW9kZSwwLG51bGwpO2IucmV0dXJuPWE7cmV0dXJuIGEuY2hpbGQ9Yn1mdW5jdGlvbiBIZChhLGIsYyxkKXtudWxsIT09ZCYmWWUoZCk7VmIoYixhLmNoaWxkLG51bGwsYyk7YT1EZihiLGIucGVuZGluZ1Byb3BzLmNoaWxkcmVuKTthLmZsYWdzfD0yO2IubWVtb2l6ZWRTdGF0ZT1udWxsO3JldHVybiBhfWZ1bmN0aW9uIHVrKGEsYixjLGQsZSxmLGcpe2lmKGMpe2lmKGIuZmxhZ3MmMjU2KXJldHVybiBiLmZsYWdzJj0tMjU3LGQ9dmYoRXJyb3IobSg0MjIpKSksSGQoYSxiLGcsZCk7aWYobnVsbCE9PWIubWVtb2l6ZWRTdGF0ZSlyZXR1cm4gYi5jaGlsZD1hLmNoaWxkLGIuZmxhZ3N8PTEyOCxudWxsO2Y9ZC5mYWxsYmFjaztlPWIubW9kZTtkPUdkKHttb2RlOiJ2aXNpYmxlIixjaGlsZHJlbjpkLmNoaWxkcmVufSxlLDAsbnVsbCk7Zj1zYihmLGUsZyxudWxsKTtmLmZsYWdzfD0yO2QucmV0dXJuPQpiO2YucmV0dXJuPWI7ZC5zaWJsaW5nPWY7Yi5jaGlsZD1kOzAhPT0oYi5tb2RlJjEpJiZWYihiLGEuY2hpbGQsbnVsbCxnKTtiLmNoaWxkLm1lbW9pemVkU3RhdGU9QmYoZyk7Yi5tZW1vaXplZFN0YXRlPUNmO3JldHVybiBmfWlmKDA9PT0oYi5tb2RlJjEpKXJldHVybiBIZChhLGIsZyxudWxsKTtpZigiJCEiPT09ZS5kYXRhKXtkPWUubmV4dFNpYmxpbmcmJmUubmV4dFNpYmxpbmcuZGF0YXNldDtpZihkKXZhciBoPWQuZGdzdDtkPWg7Zj1FcnJvcihtKDQxOSkpO2Q9dmYoZixkLHZvaWQgMCk7cmV0dXJuIEhkKGEsYixnLGQpfWg9MCE9PShnJmEuY2hpbGRMYW5lcyk7aWYoaGF8fGgpe2Q9TztpZihudWxsIT09ZCl7c3dpdGNoKGcmLWcpe2Nhc2UgNDplPTI7YnJlYWs7Y2FzZSAxNjplPTg7YnJlYWs7Y2FzZSA2NDpjYXNlIDEyODpjYXNlIDI1NjpjYXNlIDUxMjpjYXNlIDEwMjQ6Y2FzZSAyMDQ4OmNhc2UgNDA5NjpjYXNlIDgxOTI6Y2FzZSAxNjM4NDpjYXNlIDMyNzY4OmNhc2UgNjU1MzY6Y2FzZSAxMzEwNzI6Y2FzZSAyNjIxNDQ6Y2FzZSA1MjQyODg6Y2FzZSAxMDQ4NTc2OmNhc2UgMjA5NzE1MjpjYXNlIDQxOTQzMDQ6Y2FzZSA4Mzg4NjA4OmNhc2UgMTY3NzcyMTY6Y2FzZSAzMzU1NDQzMjpjYXNlIDY3MTA4ODY0OmU9CjMyO2JyZWFrO2Nhc2UgNTM2ODcwOTEyOmU9MjY4NDM1NDU2O2JyZWFrO2RlZmF1bHQ6ZT0wfWU9MCE9PShlJihkLnN1c3BlbmRlZExhbmVzfGcpKT8wOmU7MCE9PWUmJmUhPT1mLnJldHJ5TGFuZSYmKGYucmV0cnlMYW5lPWUsT2EoYSxlKSx4YShkLGEsZSwtMSkpfUVmKCk7ZD12ZihFcnJvcihtKDQyMSkpKTtyZXR1cm4gSGQoYSxiLGcsZCl9aWYoIiQ/Ij09PWUuZGF0YSlyZXR1cm4gYi5mbGFnc3w9MTI4LGIuY2hpbGQ9YS5jaGlsZCxiPXZrLmJpbmQobnVsbCxhKSxlLl9yZWFjdFJldHJ5PWIsbnVsbDthPWYudHJlZUNvbnRleHQ7ZmE9S2EoZS5uZXh0U2libGluZyk7bGE9YjtEPSEwO3dhPW51bGw7bnVsbCE9PWEmJihuYVtvYSsrXT1NYSxuYVtvYSsrXT1OYSxuYVtvYSsrXT1yYixNYT1hLmlkLE5hPWEub3ZlcmZsb3cscmI9Yik7Yj1EZihiLGQuY2hpbGRyZW4pO2IuZmxhZ3N8PTQwOTY7cmV0dXJuIGJ9ZnVuY3Rpb24gdmkoYSxiLGMpe2EubGFuZXN8PWI7dmFyIGQ9YS5hbHRlcm5hdGU7Cm51bGwhPT1kJiYoZC5sYW5lc3w9Yik7ZGYoYS5yZXR1cm4sYixjKX1mdW5jdGlvbiBGZihhLGIsYyxkLGUpe3ZhciBmPWEubWVtb2l6ZWRTdGF0ZTtudWxsPT09Zj9hLm1lbW9pemVkU3RhdGU9e2lzQmFja3dhcmRzOmIscmVuZGVyaW5nOm51bGwscmVuZGVyaW5nU3RhcnRUaW1lOjAsbGFzdDpkLHRhaWw6Yyx0YWlsTW9kZTplfTooZi5pc0JhY2t3YXJkcz1iLGYucmVuZGVyaW5nPW51bGwsZi5yZW5kZXJpbmdTdGFydFRpbWU9MCxmLmxhc3Q9ZCxmLnRhaWw9YyxmLnRhaWxNb2RlPWUpfWZ1bmN0aW9uIHdpKGEsYixjKXt2YXIgZD1iLnBlbmRpbmdQcm9wcyxlPWQucmV2ZWFsT3JkZXIsZj1kLnRhaWw7YWEoYSxiLGQuY2hpbGRyZW4sYyk7ZD1GLmN1cnJlbnQ7aWYoMCE9PShkJjIpKWQ9ZCYxfDIsYi5mbGFnc3w9MTI4O2Vsc2V7aWYobnVsbCE9PWEmJjAhPT0oYS5mbGFncyYxMjgpKWE6Zm9yKGE9Yi5jaGlsZDtudWxsIT09YTspe2lmKDEzPT09YS50YWcpbnVsbCE9PWEubWVtb2l6ZWRTdGF0ZSYmCnZpKGEsYyxiKTtlbHNlIGlmKDE5PT09YS50YWcpdmkoYSxjLGIpO2Vsc2UgaWYobnVsbCE9PWEuY2hpbGQpe2EuY2hpbGQucmV0dXJuPWE7YT1hLmNoaWxkO2NvbnRpbnVlfWlmKGE9PT1iKWJyZWFrIGE7Zm9yKDtudWxsPT09YS5zaWJsaW5nOyl7aWYobnVsbD09PWEucmV0dXJufHxhLnJldHVybj09PWIpYnJlYWsgYTthPWEucmV0dXJufWEuc2libGluZy5yZXR1cm49YS5yZXR1cm47YT1hLnNpYmxpbmd9ZCY9MX15KEYsZCk7aWYoMD09PShiLm1vZGUmMSkpYi5tZW1vaXplZFN0YXRlPW51bGw7ZWxzZSBzd2l0Y2goZSl7Y2FzZSAiZm9yd2FyZHMiOmM9Yi5jaGlsZDtmb3IoZT1udWxsO251bGwhPT1jOylhPWMuYWx0ZXJuYXRlLG51bGwhPT1hJiZudWxsPT09eGQoYSkmJihlPWMpLGM9Yy5zaWJsaW5nO2M9ZTtudWxsPT09Yz8oZT1iLmNoaWxkLGIuY2hpbGQ9bnVsbCk6KGU9Yy5zaWJsaW5nLGMuc2libGluZz1udWxsKTtGZihiLCExLGUsYyxmKTticmVhaztjYXNlICJiYWNrd2FyZHMiOmM9Cm51bGw7ZT1iLmNoaWxkO2ZvcihiLmNoaWxkPW51bGw7bnVsbCE9PWU7KXthPWUuYWx0ZXJuYXRlO2lmKG51bGwhPT1hJiZudWxsPT09eGQoYSkpe2IuY2hpbGQ9ZTticmVha31hPWUuc2libGluZztlLnNpYmxpbmc9YztjPWU7ZT1hfUZmKGIsITAsYyxudWxsLGYpO2JyZWFrO2Nhc2UgInRvZ2V0aGVyIjpGZihiLCExLG51bGwsbnVsbCx2b2lkIDApO2JyZWFrO2RlZmF1bHQ6Yi5tZW1vaXplZFN0YXRlPW51bGx9cmV0dXJuIGIuY2hpbGR9ZnVuY3Rpb24gRmQoYSxiKXswPT09KGIubW9kZSYxKSYmbnVsbCE9PWEmJihhLmFsdGVybmF0ZT1udWxsLGIuYWx0ZXJuYXRlPW51bGwsYi5mbGFnc3w9Mil9ZnVuY3Rpb24gUWEoYSxiLGMpe251bGwhPT1hJiYoYi5kZXBlbmRlbmNpZXM9YS5kZXBlbmRlbmNpZXMpO3JhfD1iLmxhbmVzO2lmKDA9PT0oYyZiLmNoaWxkTGFuZXMpKXJldHVybiBudWxsO2lmKG51bGwhPT1hJiZiLmNoaWxkIT09YS5jaGlsZCl0aHJvdyBFcnJvcihtKDE1MykpO2lmKG51bGwhPT0KYi5jaGlsZCl7YT1iLmNoaWxkO2M9ZWIoYSxhLnBlbmRpbmdQcm9wcyk7Yi5jaGlsZD1jO2ZvcihjLnJldHVybj1iO251bGwhPT1hLnNpYmxpbmc7KWE9YS5zaWJsaW5nLGM9Yy5zaWJsaW5nPWViKGEsYS5wZW5kaW5nUHJvcHMpLGMucmV0dXJuPWI7Yy5zaWJsaW5nPW51bGx9cmV0dXJuIGIuY2hpbGR9ZnVuY3Rpb24gd2soYSxiLGMpe3N3aXRjaChiLnRhZyl7Y2FzZSAzOnNpKGIpO1FiKCk7YnJlYWs7Y2FzZSA1OkloKGIpO2JyZWFrO2Nhc2UgMTplYShiLnR5cGUpJiZsZChiKTticmVhaztjYXNlIDQ6Z2YoYixiLnN0YXRlTm9kZS5jb250YWluZXJJbmZvKTticmVhaztjYXNlIDEwOnZhciBkPWIudHlwZS5fY29udGV4dCxlPWIubWVtb2l6ZWRQcm9wcy52YWx1ZTt5KHVkLGQuX2N1cnJlbnRWYWx1ZSk7ZC5fY3VycmVudFZhbHVlPWU7YnJlYWs7Y2FzZSAxMzpkPWIubWVtb2l6ZWRTdGF0ZTtpZihudWxsIT09ZCl7aWYobnVsbCE9PWQuZGVoeWRyYXRlZClyZXR1cm4geShGLEYuY3VycmVudCYKMSksYi5mbGFnc3w9MTI4LG51bGw7aWYoMCE9PShjJmIuY2hpbGQuY2hpbGRMYW5lcykpcmV0dXJuIHVpKGEsYixjKTt5KEYsRi5jdXJyZW50JjEpO2E9UWEoYSxiLGMpO3JldHVybiBudWxsIT09YT9hLnNpYmxpbmc6bnVsbH15KEYsRi5jdXJyZW50JjEpO2JyZWFrO2Nhc2UgMTk6ZD0wIT09KGMmYi5jaGlsZExhbmVzKTtpZigwIT09KGEuZmxhZ3MmMTI4KSl7aWYoZClyZXR1cm4gd2koYSxiLGMpO2IuZmxhZ3N8PTEyOH1lPWIubWVtb2l6ZWRTdGF0ZTtudWxsIT09ZSYmKGUucmVuZGVyaW5nPW51bGwsZS50YWlsPW51bGwsZS5sYXN0RWZmZWN0PW51bGwpO3koRixGLmN1cnJlbnQpO2lmKGQpYnJlYWs7ZWxzZSByZXR1cm4gbnVsbDtjYXNlIDIyOmNhc2UgMjM6cmV0dXJuIGIubGFuZXM9MCxwaShhLGIsYyl9cmV0dXJuIFFhKGEsYixjKX1mdW5jdGlvbiBEYyhhLGIpe2lmKCFEKXN3aXRjaChhLnRhaWxNb2RlKXtjYXNlICJoaWRkZW4iOmI9YS50YWlsO2Zvcih2YXIgYz1udWxsO251bGwhPT0KYjspbnVsbCE9PWIuYWx0ZXJuYXRlJiYoYz1iKSxiPWIuc2libGluZztudWxsPT09Yz9hLnRhaWw9bnVsbDpjLnNpYmxpbmc9bnVsbDticmVhaztjYXNlICJjb2xsYXBzZWQiOmM9YS50YWlsO2Zvcih2YXIgZD1udWxsO251bGwhPT1jOyludWxsIT09Yy5hbHRlcm5hdGUmJihkPWMpLGM9Yy5zaWJsaW5nO251bGw9PT1kP2J8fG51bGw9PT1hLnRhaWw/YS50YWlsPW51bGw6YS50YWlsLnNpYmxpbmc9bnVsbDpkLnNpYmxpbmc9bnVsbH19ZnVuY3Rpb24gVyhhKXt2YXIgYj1udWxsIT09YS5hbHRlcm5hdGUmJmEuYWx0ZXJuYXRlLmNoaWxkPT09YS5jaGlsZCxjPTAsZD0wO2lmKGIpZm9yKHZhciBlPWEuY2hpbGQ7bnVsbCE9PWU7KWN8PWUubGFuZXN8ZS5jaGlsZExhbmVzLGR8PWUuc3VidHJlZUZsYWdzJjE0NjgwMDY0LGR8PWUuZmxhZ3MmMTQ2ODAwNjQsZS5yZXR1cm49YSxlPWUuc2libGluZztlbHNlIGZvcihlPWEuY2hpbGQ7bnVsbCE9PWU7KWN8PWUubGFuZXN8ZS5jaGlsZExhbmVzLApkfD1lLnN1YnRyZWVGbGFncyxkfD1lLmZsYWdzLGUucmV0dXJuPWEsZT1lLnNpYmxpbmc7YS5zdWJ0cmVlRmxhZ3N8PWQ7YS5jaGlsZExhbmVzPWM7cmV0dXJuIGJ9ZnVuY3Rpb24geGsoYSxiLGMpe3ZhciBkPWIucGVuZGluZ1Byb3BzO1ZlKGIpO3N3aXRjaChiLnRhZyl7Y2FzZSAyOmNhc2UgMTY6Y2FzZSAxNTpjYXNlIDA6Y2FzZSAxMTpjYXNlIDc6Y2FzZSA4OmNhc2UgMTI6Y2FzZSA5OmNhc2UgMTQ6cmV0dXJuIFcoYiksbnVsbDtjYXNlIDE6cmV0dXJuIGVhKGIudHlwZSkmJih2KFMpLHYoSikpLFcoYiksbnVsbDtjYXNlIDM6ZD1iLnN0YXRlTm9kZTtUYigpO3YoUyk7dihKKTtqZigpO2QucGVuZGluZ0NvbnRleHQmJihkLmNvbnRleHQ9ZC5wZW5kaW5nQ29udGV4dCxkLnBlbmRpbmdDb250ZXh0PW51bGwpO2lmKG51bGw9PT1hfHxudWxsPT09YS5jaGlsZClwZChiKT9iLmZsYWdzfD00Om51bGw9PT1hfHxhLm1lbW9pemVkU3RhdGUuaXNEZWh5ZHJhdGVkJiYwPT09KGIuZmxhZ3MmCjI1Nil8fChiLmZsYWdzfD0xMDI0LG51bGwhPT13YSYmKEdmKHdhKSx3YT1udWxsKSk7eGkoYSxiKTtXKGIpO3JldHVybiBudWxsO2Nhc2UgNTpoZihiKTt2YXIgZT11Yih4Yy5jdXJyZW50KTtjPWIudHlwZTtpZihudWxsIT09YSYmbnVsbCE9Yi5zdGF0ZU5vZGUpeWsoYSxiLGMsZCxlKSxhLnJlZiE9PWIucmVmJiYoYi5mbGFnc3w9NTEyLGIuZmxhZ3N8PTIwOTcxNTIpO2Vsc2V7aWYoIWQpe2lmKG51bGw9PT1iLnN0YXRlTm9kZSl0aHJvdyBFcnJvcihtKDE2NikpO1coYik7cmV0dXJuIG51bGx9YT11YihFYS5jdXJyZW50KTtpZihwZChiKSl7ZD1iLnN0YXRlTm9kZTtjPWIudHlwZTt2YXIgZj1iLm1lbW9pemVkUHJvcHM7ZFtEYV09YjtkW3VjXT1mO2E9MCE9PShiLm1vZGUmMSk7c3dpdGNoKGMpe2Nhc2UgImRpYWxvZyI6QigiY2FuY2VsIixkKTtCKCJjbG9zZSIsZCk7YnJlYWs7Y2FzZSAiaWZyYW1lIjpjYXNlICJvYmplY3QiOmNhc2UgImVtYmVkIjpCKCJsb2FkIixkKTticmVhazsKY2FzZSAidmlkZW8iOmNhc2UgImF1ZGlvIjpmb3IoZT0wO2U8RWMubGVuZ3RoO2UrKylCKEVjW2VdLGQpO2JyZWFrO2Nhc2UgInNvdXJjZSI6QigiZXJyb3IiLGQpO2JyZWFrO2Nhc2UgImltZyI6Y2FzZSAiaW1hZ2UiOmNhc2UgImxpbmsiOkIoImVycm9yIixkKTtCKCJsb2FkIixkKTticmVhaztjYXNlICJkZXRhaWxzIjpCKCJ0b2dnbGUiLGQpO2JyZWFrO2Nhc2UgImlucHV0IjprZyhkLGYpO0IoImludmFsaWQiLGQpO2JyZWFrO2Nhc2UgInNlbGVjdCI6ZC5fd3JhcHBlclN0YXRlPXt3YXNNdWx0aXBsZTohIWYubXVsdGlwbGV9O0IoImludmFsaWQiLGQpO2JyZWFrO2Nhc2UgInRleHRhcmVhIjpuZyhkLGYpLEIoImludmFsaWQiLGQpfXBlKGMsZik7ZT1udWxsO2Zvcih2YXIgZyBpbiBmKWlmKGYuaGFzT3duUHJvcGVydHkoZykpe3ZhciBoPWZbZ107ImNoaWxkcmVuIj09PWc/InN0cmluZyI9PT10eXBlb2YgaD9kLnRleHRDb250ZW50IT09aCYmKCEwIT09Zi5zdXBwcmVzc0h5ZHJhdGlvbldhcm5pbmcmJgpqZChkLnRleHRDb250ZW50LGgsYSksZT1bImNoaWxkcmVuIixoXSk6Im51bWJlciI9PT10eXBlb2YgaCYmZC50ZXh0Q29udGVudCE9PSIiK2gmJighMCE9PWYuc3VwcHJlc3NIeWRyYXRpb25XYXJuaW5nJiZqZChkLnRleHRDb250ZW50LGgsYSksZT1bImNoaWxkcmVuIiwiIitoXSk6JGIuaGFzT3duUHJvcGVydHkoZykmJm51bGwhPWgmJiJvblNjcm9sbCI9PT1nJiZCKCJzY3JvbGwiLGQpfXN3aXRjaChjKXtjYXNlICJpbnB1dCI6UGMoZCk7bWcoZCxmLCEwKTticmVhaztjYXNlICJ0ZXh0YXJlYSI6UGMoZCk7cGcoZCk7YnJlYWs7Y2FzZSAic2VsZWN0IjpjYXNlICJvcHRpb24iOmJyZWFrO2RlZmF1bHQ6ImZ1bmN0aW9uIj09PXR5cGVvZiBmLm9uQ2xpY2smJihkLm9uY2xpY2s9a2QpfWQ9ZTtiLnVwZGF0ZVF1ZXVlPWQ7bnVsbCE9PWQmJihiLmZsYWdzfD00KX1lbHNle2c9OT09PWUubm9kZVR5cGU/ZTplLm93bmVyRG9jdW1lbnQ7Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPT09CmEmJihhPXFnKGMpKTsiaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI9PT1hPyJzY3JpcHQiPT09Yz8oYT1nLmNyZWF0ZUVsZW1lbnQoImRpdiIpLGEuaW5uZXJIVE1MPSI8c2NyaXB0Plx4M2Mvc2NyaXB0PiIsYT1hLnJlbW92ZUNoaWxkKGEuZmlyc3RDaGlsZCkpOiJzdHJpbmciPT09dHlwZW9mIGQuaXM/YT1nLmNyZWF0ZUVsZW1lbnQoYyx7aXM6ZC5pc30pOihhPWcuY3JlYXRlRWxlbWVudChjKSwic2VsZWN0Ij09PWMmJihnPWEsZC5tdWx0aXBsZT9nLm11bHRpcGxlPSEwOmQuc2l6ZSYmKGcuc2l6ZT1kLnNpemUpKSk6YT1nLmNyZWF0ZUVsZW1lbnROUyhhLGMpO2FbRGFdPWI7YVt1Y109ZDt6ayhhLGIsITEsITEpO2Iuc3RhdGVOb2RlPWE7YTp7Zz1xZShjLGQpO3N3aXRjaChjKXtjYXNlICJkaWFsb2ciOkIoImNhbmNlbCIsYSk7QigiY2xvc2UiLGEpO2U9ZDticmVhaztjYXNlICJpZnJhbWUiOmNhc2UgIm9iamVjdCI6Y2FzZSAiZW1iZWQiOkIoImxvYWQiLGEpO2U9ZDticmVhazsKY2FzZSAidmlkZW8iOmNhc2UgImF1ZGlvIjpmb3IoZT0wO2U8RWMubGVuZ3RoO2UrKylCKEVjW2VdLGEpO2U9ZDticmVhaztjYXNlICJzb3VyY2UiOkIoImVycm9yIixhKTtlPWQ7YnJlYWs7Y2FzZSAiaW1nIjpjYXNlICJpbWFnZSI6Y2FzZSAibGluayI6QigiZXJyb3IiLGEpO0IoImxvYWQiLGEpO2U9ZDticmVhaztjYXNlICJkZXRhaWxzIjpCKCJ0b2dnbGUiLGEpO2U9ZDticmVhaztjYXNlICJpbnB1dCI6a2coYSxkKTtlPWtlKGEsZCk7QigiaW52YWxpZCIsYSk7YnJlYWs7Y2FzZSAib3B0aW9uIjplPWQ7YnJlYWs7Y2FzZSAic2VsZWN0IjphLl93cmFwcGVyU3RhdGU9e3dhc011bHRpcGxlOiEhZC5tdWx0aXBsZX07ZT1FKHt9LGQse3ZhbHVlOnZvaWQgMH0pO0IoImludmFsaWQiLGEpO2JyZWFrO2Nhc2UgInRleHRhcmVhIjpuZyhhLGQpO2U9bmUoYSxkKTtCKCJpbnZhbGlkIixhKTticmVhaztkZWZhdWx0OmU9ZH1wZShjLGUpO2g9ZTtmb3IoZiBpbiBoKWlmKGguaGFzT3duUHJvcGVydHkoZikpe3ZhciBrPQpoW2ZdOyJzdHlsZSI9PT1mP3NnKGEsayk6ImRhbmdlcm91c2x5U2V0SW5uZXJIVE1MIj09PWY/KGs9az9rLl9faHRtbDp2b2lkIDAsbnVsbCE9ayYmeWkoYSxrKSk6ImNoaWxkcmVuIj09PWY/InN0cmluZyI9PT10eXBlb2Ygaz8oInRleHRhcmVhIiE9PWN8fCIiIT09aykmJkZjKGEsayk6Im51bWJlciI9PT10eXBlb2YgayYmRmMoYSwiIitrKToic3VwcHJlc3NDb250ZW50RWRpdGFibGVXYXJuaW5nIiE9PWYmJiJzdXBwcmVzc0h5ZHJhdGlvbldhcm5pbmciIT09ZiYmImF1dG9Gb2N1cyIhPT1mJiYoJGIuaGFzT3duUHJvcGVydHkoZik/bnVsbCE9ayYmIm9uU2Nyb2xsIj09PWYmJkIoInNjcm9sbCIsYSk6bnVsbCE9ayYmJGQoYSxmLGssZykpfXN3aXRjaChjKXtjYXNlICJpbnB1dCI6UGMoYSk7bWcoYSxkLCExKTticmVhaztjYXNlICJ0ZXh0YXJlYSI6UGMoYSk7cGcoYSk7YnJlYWs7Y2FzZSAib3B0aW9uIjpudWxsIT1kLnZhbHVlJiZhLnNldEF0dHJpYnV0ZSgidmFsdWUiLCIiK1VhKGQudmFsdWUpKTsKYnJlYWs7Y2FzZSAic2VsZWN0IjphLm11bHRpcGxlPSEhZC5tdWx0aXBsZTtmPWQudmFsdWU7bnVsbCE9Zj9EYihhLCEhZC5tdWx0aXBsZSxmLCExKTpudWxsIT1kLmRlZmF1bHRWYWx1ZSYmRGIoYSwhIWQubXVsdGlwbGUsZC5kZWZhdWx0VmFsdWUsITApO2JyZWFrO2RlZmF1bHQ6ImZ1bmN0aW9uIj09PXR5cGVvZiBlLm9uQ2xpY2smJihhLm9uY2xpY2s9a2QpfXN3aXRjaChjKXtjYXNlICJidXR0b24iOmNhc2UgImlucHV0IjpjYXNlICJzZWxlY3QiOmNhc2UgInRleHRhcmVhIjpkPSEhZC5hdXRvRm9jdXM7YnJlYWsgYTtjYXNlICJpbWciOmQ9ITA7YnJlYWsgYTtkZWZhdWx0OmQ9ITF9fWQmJihiLmZsYWdzfD00KX1udWxsIT09Yi5yZWYmJihiLmZsYWdzfD01MTIsYi5mbGFnc3w9MjA5NzE1Mil9VyhiKTtyZXR1cm4gbnVsbDtjYXNlIDY6aWYoYSYmbnVsbCE9Yi5zdGF0ZU5vZGUpQWsoYSxiLGEubWVtb2l6ZWRQcm9wcyxkKTtlbHNle2lmKCJzdHJpbmciIT09dHlwZW9mIGQmJm51bGw9PT0KYi5zdGF0ZU5vZGUpdGhyb3cgRXJyb3IobSgxNjYpKTtjPXViKHhjLmN1cnJlbnQpO3ViKEVhLmN1cnJlbnQpO2lmKHBkKGIpKXtkPWIuc3RhdGVOb2RlO2M9Yi5tZW1vaXplZFByb3BzO2RbRGFdPWI7aWYoZj1kLm5vZGVWYWx1ZSE9PWMpaWYoYT1sYSxudWxsIT09YSlzd2l0Y2goYS50YWcpe2Nhc2UgMzpqZChkLm5vZGVWYWx1ZSxjLDAhPT0oYS5tb2RlJjEpKTticmVhaztjYXNlIDU6ITAhPT1hLm1lbW9pemVkUHJvcHMuc3VwcHJlc3NIeWRyYXRpb25XYXJuaW5nJiZqZChkLm5vZGVWYWx1ZSxjLDAhPT0oYS5tb2RlJjEpKX1mJiYoYi5mbGFnc3w9NCl9ZWxzZSBkPSg5PT09Yy5ub2RlVHlwZT9jOmMub3duZXJEb2N1bWVudCkuY3JlYXRlVGV4dE5vZGUoZCksZFtEYV09YixiLnN0YXRlTm9kZT1kfVcoYik7cmV0dXJuIG51bGw7Y2FzZSAxMzp2KEYpO2Q9Yi5tZW1vaXplZFN0YXRlO2lmKG51bGw9PT1hfHxudWxsIT09YS5tZW1vaXplZFN0YXRlJiZudWxsIT09YS5tZW1vaXplZFN0YXRlLmRlaHlkcmF0ZWQpe2lmKEQmJgpudWxsIT09ZmEmJjAhPT0oYi5tb2RlJjEpJiYwPT09KGIuZmxhZ3MmMTI4KSl7Zm9yKGY9ZmE7ZjspZj1LYShmLm5leHRTaWJsaW5nKTtRYigpO2IuZmxhZ3N8PTk4NTYwO2Y9ITF9ZWxzZSBpZihmPXBkKGIpLG51bGwhPT1kJiZudWxsIT09ZC5kZWh5ZHJhdGVkKXtpZihudWxsPT09YSl7aWYoIWYpdGhyb3cgRXJyb3IobSgzMTgpKTtmPWIubWVtb2l6ZWRTdGF0ZTtmPW51bGwhPT1mP2YuZGVoeWRyYXRlZDpudWxsO2lmKCFmKXRocm93IEVycm9yKG0oMzE3KSk7ZltEYV09Yn1lbHNlIFFiKCksMD09PShiLmZsYWdzJjEyOCkmJihiLm1lbW9pemVkU3RhdGU9bnVsbCksYi5mbGFnc3w9NDtXKGIpO2Y9ITF9ZWxzZSBudWxsIT09d2EmJihHZih3YSksd2E9bnVsbCksZj0hMDtpZighZilyZXR1cm4gYi5mbGFncyY2NTUzNj9iOm51bGx9aWYoMCE9PShiLmZsYWdzJjEyOCkpcmV0dXJuIGIubGFuZXM9YyxiO2Q9bnVsbCE9PWQ7ZCE9PShudWxsIT09YSYmbnVsbCE9PWEubWVtb2l6ZWRTdGF0ZSkmJgpkJiYoYi5jaGlsZC5mbGFnc3w9ODE5MiwwIT09KGIubW9kZSYxKSYmKG51bGw9PT1hfHwwIT09KEYuY3VycmVudCYxKT8wPT09TCYmKEw9Myk6RWYoKSkpO251bGwhPT1iLnVwZGF0ZVF1ZXVlJiYoYi5mbGFnc3w9NCk7VyhiKTtyZXR1cm4gbnVsbDtjYXNlIDQ6cmV0dXJuIFRiKCkseGkoYSxiKSxudWxsPT09YSYmc2MoYi5zdGF0ZU5vZGUuY29udGFpbmVySW5mbyksVyhiKSxudWxsO2Nhc2UgMTA6cmV0dXJuIGNmKGIudHlwZS5fY29udGV4dCksVyhiKSxudWxsO2Nhc2UgMTc6cmV0dXJuIGVhKGIudHlwZSkmJih2KFMpLHYoSikpLFcoYiksbnVsbDtjYXNlIDE5OnYoRik7Zj1iLm1lbW9pemVkU3RhdGU7aWYobnVsbD09PWYpcmV0dXJuIFcoYiksbnVsbDtkPTAhPT0oYi5mbGFncyYxMjgpO2c9Zi5yZW5kZXJpbmc7aWYobnVsbD09PWcpaWYoZClEYyhmLCExKTtlbHNle2lmKDAhPT1MfHxudWxsIT09YSYmMCE9PShhLmZsYWdzJjEyOCkpZm9yKGE9Yi5jaGlsZDtudWxsIT09YTspe2c9CnhkKGEpO2lmKG51bGwhPT1nKXtiLmZsYWdzfD0xMjg7RGMoZiwhMSk7ZD1nLnVwZGF0ZVF1ZXVlO251bGwhPT1kJiYoYi51cGRhdGVRdWV1ZT1kLGIuZmxhZ3N8PTQpO2Iuc3VidHJlZUZsYWdzPTA7ZD1jO2ZvcihjPWIuY2hpbGQ7bnVsbCE9PWM7KWY9YyxhPWQsZi5mbGFncyY9MTQ2ODAwNjYsZz1mLmFsdGVybmF0ZSxudWxsPT09Zz8oZi5jaGlsZExhbmVzPTAsZi5sYW5lcz1hLGYuY2hpbGQ9bnVsbCxmLnN1YnRyZWVGbGFncz0wLGYubWVtb2l6ZWRQcm9wcz1udWxsLGYubWVtb2l6ZWRTdGF0ZT1udWxsLGYudXBkYXRlUXVldWU9bnVsbCxmLmRlcGVuZGVuY2llcz1udWxsLGYuc3RhdGVOb2RlPW51bGwpOihmLmNoaWxkTGFuZXM9Zy5jaGlsZExhbmVzLGYubGFuZXM9Zy5sYW5lcyxmLmNoaWxkPWcuY2hpbGQsZi5zdWJ0cmVlRmxhZ3M9MCxmLmRlbGV0aW9ucz1udWxsLGYubWVtb2l6ZWRQcm9wcz1nLm1lbW9pemVkUHJvcHMsZi5tZW1vaXplZFN0YXRlPWcubWVtb2l6ZWRTdGF0ZSwKZi51cGRhdGVRdWV1ZT1nLnVwZGF0ZVF1ZXVlLGYudHlwZT1nLnR5cGUsYT1nLmRlcGVuZGVuY2llcyxmLmRlcGVuZGVuY2llcz1udWxsPT09YT9udWxsOntsYW5lczphLmxhbmVzLGZpcnN0Q29udGV4dDphLmZpcnN0Q29udGV4dH0pLGM9Yy5zaWJsaW5nO3koRixGLmN1cnJlbnQmMXwyKTtyZXR1cm4gYi5jaGlsZH1hPWEuc2libGluZ31udWxsIT09Zi50YWlsJiZQKCk+SGYmJihiLmZsYWdzfD0xMjgsZD0hMCxEYyhmLCExKSxiLmxhbmVzPTQxOTQzMDQpfWVsc2V7aWYoIWQpaWYoYT14ZChnKSxudWxsIT09YSl7aWYoYi5mbGFnc3w9MTI4LGQ9ITAsYz1hLnVwZGF0ZVF1ZXVlLG51bGwhPT1jJiYoYi51cGRhdGVRdWV1ZT1jLGIuZmxhZ3N8PTQpLERjKGYsITApLG51bGw9PT1mLnRhaWwmJiJoaWRkZW4iPT09Zi50YWlsTW9kZSYmIWcuYWx0ZXJuYXRlJiYhRClyZXR1cm4gVyhiKSxudWxsfWVsc2UgMipQKCktZi5yZW5kZXJpbmdTdGFydFRpbWU+SGYmJjEwNzM3NDE4MjQhPT1jJiYoYi5mbGFnc3w9CjEyOCxkPSEwLERjKGYsITEpLGIubGFuZXM9NDE5NDMwNCk7Zi5pc0JhY2t3YXJkcz8oZy5zaWJsaW5nPWIuY2hpbGQsYi5jaGlsZD1nKTooYz1mLmxhc3QsbnVsbCE9PWM/Yy5zaWJsaW5nPWc6Yi5jaGlsZD1nLGYubGFzdD1nKX1pZihudWxsIT09Zi50YWlsKXJldHVybiBiPWYudGFpbCxmLnJlbmRlcmluZz1iLGYudGFpbD1iLnNpYmxpbmcsZi5yZW5kZXJpbmdTdGFydFRpbWU9UCgpLGIuc2libGluZz1udWxsLGM9Ri5jdXJyZW50LHkoRixkP2MmMXwyOmMmMSksYjtXKGIpO3JldHVybiBudWxsO2Nhc2UgMjI6Y2FzZSAyMzpyZXR1cm4gYmE9R2EuY3VycmVudCx2KEdhKSxkPW51bGwhPT1iLm1lbW9pemVkU3RhdGUsbnVsbCE9PWEmJm51bGwhPT1hLm1lbW9pemVkU3RhdGUhPT1kJiYoYi5mbGFnc3w9ODE5MiksZCYmMCE9PShiLm1vZGUmMSk/MCE9PShiYSYxMDczNzQxODI0KSYmKFcoYiksYi5zdWJ0cmVlRmxhZ3MmNiYmKGIuZmxhZ3N8PTgxOTIpKTpXKGIpLG51bGw7Y2FzZSAyNDpyZXR1cm4gbnVsbDsKY2FzZSAyNTpyZXR1cm4gbnVsbH10aHJvdyBFcnJvcihtKDE1NixiLnRhZykpO31mdW5jdGlvbiBCayhhLGIsYyl7VmUoYik7c3dpdGNoKGIudGFnKXtjYXNlIDE6cmV0dXJuIGVhKGIudHlwZSkmJih2KFMpLHYoSikpLGE9Yi5mbGFncyxhJjY1NTM2PyhiLmZsYWdzPWEmLTY1NTM3fDEyOCxiKTpudWxsO2Nhc2UgMzpyZXR1cm4gVGIoKSx2KFMpLHYoSiksamYoKSxhPWIuZmxhZ3MsMCE9PShhJjY1NTM2KSYmMD09PShhJjEyOCk/KGIuZmxhZ3M9YSYtNjU1Mzd8MTI4LGIpOm51bGw7Y2FzZSA1OnJldHVybiBoZihiKSxudWxsO2Nhc2UgMTM6dihGKTthPWIubWVtb2l6ZWRTdGF0ZTtpZihudWxsIT09YSYmbnVsbCE9PWEuZGVoeWRyYXRlZCl7aWYobnVsbD09PWIuYWx0ZXJuYXRlKXRocm93IEVycm9yKG0oMzQwKSk7UWIoKX1hPWIuZmxhZ3M7cmV0dXJuIGEmNjU1MzY/KGIuZmxhZ3M9YSYtNjU1Mzd8MTI4LGIpOm51bGw7Y2FzZSAxOTpyZXR1cm4gdihGKSxudWxsO2Nhc2UgNDpyZXR1cm4gVGIoKSwKbnVsbDtjYXNlIDEwOnJldHVybiBjZihiLnR5cGUuX2NvbnRleHQpLG51bGw7Y2FzZSAyMjpjYXNlIDIzOnJldHVybiBiYT1HYS5jdXJyZW50LHYoR2EpLG51bGw7Y2FzZSAyNDpyZXR1cm4gbnVsbDtkZWZhdWx0OnJldHVybiBudWxsfX1mdW5jdGlvbiBXYihhLGIpe3ZhciBjPWEucmVmO2lmKG51bGwhPT1jKWlmKCJmdW5jdGlvbiI9PT10eXBlb2YgYyl0cnl7YyhudWxsKX1jYXRjaChkKXtHKGEsYixkKX1lbHNlIGMuY3VycmVudD1udWxsfWZ1bmN0aW9uIElmKGEsYixjKXt0cnl7YygpfWNhdGNoKGQpe0coYSxiLGQpfX1mdW5jdGlvbiBDayhhLGIpe0pmPVpjO2E9Y2goKTtpZihJZShhKSl7aWYoInNlbGVjdGlvblN0YXJ0ImluIGEpdmFyIGM9e3N0YXJ0OmEuc2VsZWN0aW9uU3RhcnQsZW5kOmEuc2VsZWN0aW9uRW5kfTtlbHNlIGE6e2M9KGM9YS5vd25lckRvY3VtZW50KSYmYy5kZWZhdWx0Vmlld3x8d2luZG93O3ZhciBkPWMuZ2V0U2VsZWN0aW9uJiZjLmdldFNlbGVjdGlvbigpOwppZihkJiYwIT09ZC5yYW5nZUNvdW50KXtjPWQuYW5jaG9yTm9kZTt2YXIgZT1kLmFuY2hvck9mZnNldCxmPWQuZm9jdXNOb2RlO2Q9ZC5mb2N1c09mZnNldDt0cnl7Yy5ub2RlVHlwZSxmLm5vZGVUeXBlfWNhdGNoKE0pe2M9bnVsbDticmVhayBhfXZhciBnPTAsaD0tMSxrPS0xLG49MCxxPTAsdT1hLHI9bnVsbDtiOmZvcig7Oyl7Zm9yKHZhciBwOzspe3UhPT1jfHwwIT09ZSYmMyE9PXUubm9kZVR5cGV8fChoPWcrZSk7dSE9PWZ8fDAhPT1kJiYzIT09dS5ub2RlVHlwZXx8KGs9ZytkKTszPT09dS5ub2RlVHlwZSYmKGcrPXUubm9kZVZhbHVlLmxlbmd0aCk7aWYobnVsbD09PShwPXUuZmlyc3RDaGlsZCkpYnJlYWs7cj11O3U9cH1mb3IoOzspe2lmKHU9PT1hKWJyZWFrIGI7cj09PWMmJisrbj09PWUmJihoPWcpO3I9PT1mJiYrK3E9PT1kJiYoaz1nKTtpZihudWxsIT09KHA9dS5uZXh0U2libGluZykpYnJlYWs7dT1yO3I9dS5wYXJlbnROb2RlfXU9cH1jPS0xPT09aHx8LTE9PT1rP251bGw6CntzdGFydDpoLGVuZDprfX1lbHNlIGM9bnVsbH1jPWN8fHtzdGFydDowLGVuZDowfX1lbHNlIGM9bnVsbDtLZj17Zm9jdXNlZEVsZW06YSxzZWxlY3Rpb25SYW5nZTpjfTtaYz0hMTtmb3IobD1iO251bGwhPT1sOylpZihiPWwsYT1iLmNoaWxkLDAhPT0oYi5zdWJ0cmVlRmxhZ3MmMTAyOCkmJm51bGwhPT1hKWEucmV0dXJuPWIsbD1hO2Vsc2UgZm9yKDtudWxsIT09bDspe2I9bDt0cnl7dmFyIHg9Yi5hbHRlcm5hdGU7aWYoMCE9PShiLmZsYWdzJjEwMjQpKXN3aXRjaChiLnRhZyl7Y2FzZSAwOmNhc2UgMTE6Y2FzZSAxNTpicmVhaztjYXNlIDE6aWYobnVsbCE9PXgpe3ZhciB2PXgubWVtb2l6ZWRQcm9wcyx6PXgubWVtb2l6ZWRTdGF0ZSx3PWIuc3RhdGVOb2RlLEE9dy5nZXRTbmFwc2hvdEJlZm9yZVVwZGF0ZShiLmVsZW1lbnRUeXBlPT09Yi50eXBlP3Y6eWEoYi50eXBlLHYpLHopO3cuX19yZWFjdEludGVybmFsU25hcHNob3RCZWZvcmVVcGRhdGU9QX1icmVhaztjYXNlIDM6dmFyIHQ9CmIuc3RhdGVOb2RlLmNvbnRhaW5lckluZm87MT09PXQubm9kZVR5cGU/dC50ZXh0Q29udGVudD0iIjo5PT09dC5ub2RlVHlwZSYmdC5kb2N1bWVudEVsZW1lbnQmJnQucmVtb3ZlQ2hpbGQodC5kb2N1bWVudEVsZW1lbnQpO2JyZWFrO2Nhc2UgNTpjYXNlIDY6Y2FzZSA0OmNhc2UgMTc6YnJlYWs7ZGVmYXVsdDp0aHJvdyBFcnJvcihtKDE2MykpO319Y2F0Y2goTSl7RyhiLGIucmV0dXJuLE0pfWE9Yi5zaWJsaW5nO2lmKG51bGwhPT1hKXthLnJldHVybj1iLnJldHVybjtsPWE7YnJlYWt9bD1iLnJldHVybn14PXppO3ppPSExO3JldHVybiB4fWZ1bmN0aW9uIEdjKGEsYixjKXt2YXIgZD1iLnVwZGF0ZVF1ZXVlO2Q9bnVsbCE9PWQ/ZC5sYXN0RWZmZWN0Om51bGw7aWYobnVsbCE9PWQpe3ZhciBlPWQ9ZC5uZXh0O2Rve2lmKChlLnRhZyZhKT09PWEpe3ZhciBmPWUuZGVzdHJveTtlLmRlc3Ryb3k9dm9pZCAwO3ZvaWQgMCE9PWYmJklmKGIsYyxmKX1lPWUubmV4dH13aGlsZShlIT09ZCl9fQpmdW5jdGlvbiBJZChhLGIpe2I9Yi51cGRhdGVRdWV1ZTtiPW51bGwhPT1iP2IubGFzdEVmZmVjdDpudWxsO2lmKG51bGwhPT1iKXt2YXIgYz1iPWIubmV4dDtkb3tpZigoYy50YWcmYSk9PT1hKXt2YXIgZD1jLmNyZWF0ZTtjLmRlc3Ryb3k9ZCgpfWM9Yy5uZXh0fXdoaWxlKGMhPT1iKX19ZnVuY3Rpb24gTGYoYSl7dmFyIGI9YS5yZWY7aWYobnVsbCE9PWIpe3ZhciBjPWEuc3RhdGVOb2RlO3N3aXRjaChhLnRhZyl7Y2FzZSA1OmE9YzticmVhaztkZWZhdWx0OmE9Y30iZnVuY3Rpb24iPT09dHlwZW9mIGI/YihhKTpiLmN1cnJlbnQ9YX19ZnVuY3Rpb24gQWkoYSl7dmFyIGI9YS5hbHRlcm5hdGU7bnVsbCE9PWImJihhLmFsdGVybmF0ZT1udWxsLEFpKGIpKTthLmNoaWxkPW51bGw7YS5kZWxldGlvbnM9bnVsbDthLnNpYmxpbmc9bnVsbDs1PT09YS50YWcmJihiPWEuc3RhdGVOb2RlLG51bGwhPT1iJiYoZGVsZXRlIGJbRGFdLGRlbGV0ZSBiW3VjXSxkZWxldGUgYltNZV0sZGVsZXRlIGJbRGtdLApkZWxldGUgYltFa10pKTthLnN0YXRlTm9kZT1udWxsO2EucmV0dXJuPW51bGw7YS5kZXBlbmRlbmNpZXM9bnVsbDthLm1lbW9pemVkUHJvcHM9bnVsbDthLm1lbW9pemVkU3RhdGU9bnVsbDthLnBlbmRpbmdQcm9wcz1udWxsO2Euc3RhdGVOb2RlPW51bGw7YS51cGRhdGVRdWV1ZT1udWxsfWZ1bmN0aW9uIEJpKGEpe3JldHVybiA1PT09YS50YWd8fDM9PT1hLnRhZ3x8ND09PWEudGFnfWZ1bmN0aW9uIENpKGEpe2E6Zm9yKDs7KXtmb3IoO251bGw9PT1hLnNpYmxpbmc7KXtpZihudWxsPT09YS5yZXR1cm58fEJpKGEucmV0dXJuKSlyZXR1cm4gbnVsbDthPWEucmV0dXJufWEuc2libGluZy5yZXR1cm49YS5yZXR1cm47Zm9yKGE9YS5zaWJsaW5nOzUhPT1hLnRhZyYmNiE9PWEudGFnJiYxOCE9PWEudGFnOyl7aWYoYS5mbGFncyYyKWNvbnRpbnVlIGE7aWYobnVsbD09PWEuY2hpbGR8fDQ9PT1hLnRhZyljb250aW51ZSBhO2Vsc2UgYS5jaGlsZC5yZXR1cm49YSxhPWEuY2hpbGR9aWYoIShhLmZsYWdzJgoyKSlyZXR1cm4gYS5zdGF0ZU5vZGV9fWZ1bmN0aW9uIE1mKGEsYixjKXt2YXIgZD1hLnRhZztpZig1PT09ZHx8Nj09PWQpYT1hLnN0YXRlTm9kZSxiPzg9PT1jLm5vZGVUeXBlP2MucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoYSxiKTpjLmluc2VydEJlZm9yZShhLGIpOig4PT09Yy5ub2RlVHlwZT8oYj1jLnBhcmVudE5vZGUsYi5pbnNlcnRCZWZvcmUoYSxjKSk6KGI9YyxiLmFwcGVuZENoaWxkKGEpKSxjPWMuX3JlYWN0Um9vdENvbnRhaW5lcixudWxsIT09YyYmdm9pZCAwIT09Y3x8bnVsbCE9PWIub25jbGlja3x8KGIub25jbGljaz1rZCkpO2Vsc2UgaWYoNCE9PWQmJihhPWEuY2hpbGQsbnVsbCE9PWEpKWZvcihNZihhLGIsYyksYT1hLnNpYmxpbmc7bnVsbCE9PWE7KU1mKGEsYixjKSxhPWEuc2libGluZ31mdW5jdGlvbiBOZihhLGIsYyl7dmFyIGQ9YS50YWc7aWYoNT09PWR8fDY9PT1kKWE9YS5zdGF0ZU5vZGUsYj9jLmluc2VydEJlZm9yZShhLGIpOmMuYXBwZW5kQ2hpbGQoYSk7CmVsc2UgaWYoNCE9PWQmJihhPWEuY2hpbGQsbnVsbCE9PWEpKWZvcihOZihhLGIsYyksYT1hLnNpYmxpbmc7bnVsbCE9PWE7KU5mKGEsYixjKSxhPWEuc2libGluZ31mdW5jdGlvbiBqYihhLGIsYyl7Zm9yKGM9Yy5jaGlsZDtudWxsIT09YzspRGkoYSxiLGMpLGM9Yy5zaWJsaW5nfWZ1bmN0aW9uIERpKGEsYixjKXtpZihDYSYmImZ1bmN0aW9uIj09PXR5cGVvZiBDYS5vbkNvbW1pdEZpYmVyVW5tb3VudCl0cnl7Q2Eub25Db21taXRGaWJlclVubW91bnQoVWMsYyl9Y2F0Y2goaCl7fXN3aXRjaChjLnRhZyl7Y2FzZSA1Olh8fFdiKGMsYik7Y2FzZSA2OnZhciBkPVQsZT16YTtUPW51bGw7amIoYSxiLGMpO1Q9ZDt6YT1lO251bGwhPT1UJiYoemE/KGE9VCxjPWMuc3RhdGVOb2RlLDg9PT1hLm5vZGVUeXBlP2EucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChjKTphLnJlbW92ZUNoaWxkKGMpKTpULnJlbW92ZUNoaWxkKGMuc3RhdGVOb2RlKSk7YnJlYWs7Y2FzZSAxODpudWxsIT09VCYmKHphPwooYT1ULGM9Yy5zdGF0ZU5vZGUsOD09PWEubm9kZVR5cGU/UmUoYS5wYXJlbnROb2RlLGMpOjE9PT1hLm5vZGVUeXBlJiZSZShhLGMpLG5jKGEpKTpSZShULGMuc3RhdGVOb2RlKSk7YnJlYWs7Y2FzZSA0OmQ9VDtlPXphO1Q9Yy5zdGF0ZU5vZGUuY29udGFpbmVySW5mbzt6YT0hMDtqYihhLGIsYyk7VD1kO3phPWU7YnJlYWs7Y2FzZSAwOmNhc2UgMTE6Y2FzZSAxNDpjYXNlIDE1OmlmKCFYJiYoZD1jLnVwZGF0ZVF1ZXVlLG51bGwhPT1kJiYoZD1kLmxhc3RFZmZlY3QsbnVsbCE9PWQpKSl7ZT1kPWQubmV4dDtkb3t2YXIgZj1lLGc9Zi5kZXN0cm95O2Y9Zi50YWc7dm9pZCAwIT09ZyYmKDAhPT0oZiYyKT9JZihjLGIsZyk6MCE9PShmJjQpJiZJZihjLGIsZykpO2U9ZS5uZXh0fXdoaWxlKGUhPT1kKX1qYihhLGIsYyk7YnJlYWs7Y2FzZSAxOmlmKCFYJiYoV2IoYyxiKSxkPWMuc3RhdGVOb2RlLCJmdW5jdGlvbiI9PT10eXBlb2YgZC5jb21wb25lbnRXaWxsVW5tb3VudCkpdHJ5e2QucHJvcHM9CmMubWVtb2l6ZWRQcm9wcyxkLnN0YXRlPWMubWVtb2l6ZWRTdGF0ZSxkLmNvbXBvbmVudFdpbGxVbm1vdW50KCl9Y2F0Y2goaCl7RyhjLGIsaCl9amIoYSxiLGMpO2JyZWFrO2Nhc2UgMjE6amIoYSxiLGMpO2JyZWFrO2Nhc2UgMjI6Yy5tb2RlJjE/KFg9KGQ9WCl8fG51bGwhPT1jLm1lbW9pemVkU3RhdGUsamIoYSxiLGMpLFg9ZCk6amIoYSxiLGMpO2JyZWFrO2RlZmF1bHQ6amIoYSxiLGMpfX1mdW5jdGlvbiBFaShhKXt2YXIgYj1hLnVwZGF0ZVF1ZXVlO2lmKG51bGwhPT1iKXthLnVwZGF0ZVF1ZXVlPW51bGw7dmFyIGM9YS5zdGF0ZU5vZGU7bnVsbD09PWMmJihjPWEuc3RhdGVOb2RlPW5ldyBGayk7Yi5mb3JFYWNoKGZ1bmN0aW9uKGIpe3ZhciBkPUdrLmJpbmQobnVsbCxhLGIpO2MuaGFzKGIpfHwoYy5hZGQoYiksYi50aGVuKGQsZCkpfSl9fWZ1bmN0aW9uIEFhKGEsYixjKXtjPWIuZGVsZXRpb25zO2lmKG51bGwhPT1jKWZvcih2YXIgZD0wO2Q8Yy5sZW5ndGg7ZCsrKXt2YXIgZT0KY1tkXTt0cnl7dmFyIGY9YSxnPWIsaD1nO2E6Zm9yKDtudWxsIT09aDspe3N3aXRjaChoLnRhZyl7Y2FzZSA1OlQ9aC5zdGF0ZU5vZGU7emE9ITE7YnJlYWsgYTtjYXNlIDM6VD1oLnN0YXRlTm9kZS5jb250YWluZXJJbmZvO3phPSEwO2JyZWFrIGE7Y2FzZSA0OlQ9aC5zdGF0ZU5vZGUuY29udGFpbmVySW5mbzt6YT0hMDticmVhayBhfWg9aC5yZXR1cm59aWYobnVsbD09PVQpdGhyb3cgRXJyb3IobSgxNjApKTtEaShmLGcsZSk7VD1udWxsO3phPSExO3ZhciBrPWUuYWx0ZXJuYXRlO251bGwhPT1rJiYoay5yZXR1cm49bnVsbCk7ZS5yZXR1cm49bnVsbH1jYXRjaChuKXtHKGUsYixuKX19aWYoYi5zdWJ0cmVlRmxhZ3MmMTI4NTQpZm9yKGI9Yi5jaGlsZDtudWxsIT09YjspRmkoYixhKSxiPWIuc2libGluZ31mdW5jdGlvbiBGaShhLGIsYyl7dmFyIGQ9YS5hbHRlcm5hdGU7Yz1hLmZsYWdzO3N3aXRjaChhLnRhZyl7Y2FzZSAwOmNhc2UgMTE6Y2FzZSAxNDpjYXNlIDE1OkFhKGIsYSk7CkhhKGEpO2lmKGMmNCl7dHJ5e0djKDMsYSxhLnJldHVybiksSWQoMyxhKX1jYXRjaChJKXtHKGEsYS5yZXR1cm4sSSl9dHJ5e0djKDUsYSxhLnJldHVybil9Y2F0Y2goSSl7RyhhLGEucmV0dXJuLEkpfX1icmVhaztjYXNlIDE6QWEoYixhKTtIYShhKTtjJjUxMiYmbnVsbCE9PWQmJldiKGQsZC5yZXR1cm4pO2JyZWFrO2Nhc2UgNTpBYShiLGEpO0hhKGEpO2MmNTEyJiZudWxsIT09ZCYmV2IoZCxkLnJldHVybik7aWYoYS5mbGFncyYzMil7dmFyIGU9YS5zdGF0ZU5vZGU7dHJ5e0ZjKGUsIiIpfWNhdGNoKEkpe0coYSxhLnJldHVybixJKX19aWYoYyY0JiYoZT1hLnN0YXRlTm9kZSxudWxsIT1lKSl7dmFyIGY9YS5tZW1vaXplZFByb3BzLGc9bnVsbCE9PWQ/ZC5tZW1vaXplZFByb3BzOmYsaD1hLnR5cGUsaz1hLnVwZGF0ZVF1ZXVlO2EudXBkYXRlUXVldWU9bnVsbDtpZihudWxsIT09ayl0cnl7ImlucHV0Ij09PWgmJiJyYWRpbyI9PT1mLnR5cGUmJm51bGwhPWYubmFtZSYmbGcoZSxmKTsKcWUoaCxnKTt2YXIgbj1xZShoLGYpO2ZvcihnPTA7ZzxrLmxlbmd0aDtnKz0yKXt2YXIgcT1rW2ddLHU9a1tnKzFdOyJzdHlsZSI9PT1xP3NnKGUsdSk6ImRhbmdlcm91c2x5U2V0SW5uZXJIVE1MIj09PXE/eWkoZSx1KToiY2hpbGRyZW4iPT09cT9GYyhlLHUpOiRkKGUscSx1LG4pfXN3aXRjaChoKXtjYXNlICJpbnB1dCI6bGUoZSxmKTticmVhaztjYXNlICJ0ZXh0YXJlYSI6b2coZSxmKTticmVhaztjYXNlICJzZWxlY3QiOnZhciByPWUuX3dyYXBwZXJTdGF0ZS53YXNNdWx0aXBsZTtlLl93cmFwcGVyU3RhdGUud2FzTXVsdGlwbGU9ISFmLm11bHRpcGxlO3ZhciBwPWYudmFsdWU7bnVsbCE9cD9EYihlLCEhZi5tdWx0aXBsZSxwLCExKTpyIT09ISFmLm11bHRpcGxlJiYobnVsbCE9Zi5kZWZhdWx0VmFsdWU/RGIoZSwhIWYubXVsdGlwbGUsZi5kZWZhdWx0VmFsdWUsITApOkRiKGUsISFmLm11bHRpcGxlLGYubXVsdGlwbGU/W106IiIsITEpKX1lW3VjXT1mfWNhdGNoKEkpe0coYSxhLnJldHVybiwKSSl9fWJyZWFrO2Nhc2UgNjpBYShiLGEpO0hhKGEpO2lmKGMmNCl7aWYobnVsbD09PWEuc3RhdGVOb2RlKXRocm93IEVycm9yKG0oMTYyKSk7ZT1hLnN0YXRlTm9kZTtmPWEubWVtb2l6ZWRQcm9wczt0cnl7ZS5ub2RlVmFsdWU9Zn1jYXRjaChJKXtHKGEsYS5yZXR1cm4sSSl9fWJyZWFrO2Nhc2UgMzpBYShiLGEpO0hhKGEpO2lmKGMmNCYmbnVsbCE9PWQmJmQubWVtb2l6ZWRTdGF0ZS5pc0RlaHlkcmF0ZWQpdHJ5e25jKGIuY29udGFpbmVySW5mbyl9Y2F0Y2goSSl7RyhhLGEucmV0dXJuLEkpfWJyZWFrO2Nhc2UgNDpBYShiLGEpO0hhKGEpO2JyZWFrO2Nhc2UgMTM6QWEoYixhKTtIYShhKTtlPWEuY2hpbGQ7ZS5mbGFncyY4MTkyJiYoZj1udWxsIT09ZS5tZW1vaXplZFN0YXRlLGUuc3RhdGVOb2RlLmlzSGlkZGVuPWYsIWZ8fG51bGwhPT1lLmFsdGVybmF0ZSYmbnVsbCE9PWUuYWx0ZXJuYXRlLm1lbW9pemVkU3RhdGV8fChPZj1QKCkpKTtjJjQmJkVpKGEpO2JyZWFrO2Nhc2UgMjI6cT0KbnVsbCE9PWQmJm51bGwhPT1kLm1lbW9pemVkU3RhdGU7YS5tb2RlJjE/KFg9KG49WCl8fHEsQWEoYixhKSxYPW4pOkFhKGIsYSk7SGEoYSk7aWYoYyY4MTkyKXtuPW51bGwhPT1hLm1lbW9pemVkU3RhdGU7aWYoKGEuc3RhdGVOb2RlLmlzSGlkZGVuPW4pJiYhcSYmMCE9PShhLm1vZGUmMSkpZm9yKGw9YSxxPWEuY2hpbGQ7bnVsbCE9PXE7KXtmb3IodT1sPXE7bnVsbCE9PWw7KXtyPWw7cD1yLmNoaWxkO3N3aXRjaChyLnRhZyl7Y2FzZSAwOmNhc2UgMTE6Y2FzZSAxNDpjYXNlIDE1OkdjKDQscixyLnJldHVybik7YnJlYWs7Y2FzZSAxOldiKHIsci5yZXR1cm4pO3ZhciB4PXIuc3RhdGVOb2RlO2lmKCJmdW5jdGlvbiI9PT10eXBlb2YgeC5jb21wb25lbnRXaWxsVW5tb3VudCl7Yz1yO2I9ci5yZXR1cm47dHJ5e2Q9Yyx4LnByb3BzPWQubWVtb2l6ZWRQcm9wcyx4LnN0YXRlPWQubWVtb2l6ZWRTdGF0ZSx4LmNvbXBvbmVudFdpbGxVbm1vdW50KCl9Y2F0Y2goSSl7RyhjLGIsSSl9fWJyZWFrOwpjYXNlIDU6V2IocixyLnJldHVybik7YnJlYWs7Y2FzZSAyMjppZihudWxsIT09ci5tZW1vaXplZFN0YXRlKXtHaSh1KTtjb250aW51ZX19bnVsbCE9PXA/KHAucmV0dXJuPXIsbD1wKTpHaSh1KX1xPXEuc2libGluZ31hOmZvcihxPW51bGwsdT1hOzspe2lmKDU9PT11LnRhZyl7aWYobnVsbD09PXEpe3E9dTt0cnl7ZT11LnN0YXRlTm9kZSxuPyhmPWUuc3R5bGUsImZ1bmN0aW9uIj09PXR5cGVvZiBmLnNldFByb3BlcnR5P2Yuc2V0UHJvcGVydHkoImRpc3BsYXkiLCJub25lIiwiaW1wb3J0YW50Iik6Zi5kaXNwbGF5PSJub25lIik6KGg9dS5zdGF0ZU5vZGUsaz11Lm1lbW9pemVkUHJvcHMuc3R5bGUsZz12b2lkIDAhPT1rJiZudWxsIT09ayYmay5oYXNPd25Qcm9wZXJ0eSgiZGlzcGxheSIpP2suZGlzcGxheTpudWxsLGguc3R5bGUuZGlzcGxheT1yZygiZGlzcGxheSIsZykpfWNhdGNoKEkpe0coYSxhLnJldHVybixJKX19fWVsc2UgaWYoNj09PXUudGFnKXtpZihudWxsPT09cSl0cnl7dS5zdGF0ZU5vZGUubm9kZVZhbHVlPQpuPyIiOnUubWVtb2l6ZWRQcm9wc31jYXRjaChJKXtHKGEsYS5yZXR1cm4sSSl9fWVsc2UgaWYoKDIyIT09dS50YWcmJjIzIT09dS50YWd8fG51bGw9PT11Lm1lbW9pemVkU3RhdGV8fHU9PT1hKSYmbnVsbCE9PXUuY2hpbGQpe3UuY2hpbGQucmV0dXJuPXU7dT11LmNoaWxkO2NvbnRpbnVlfWlmKHU9PT1hKWJyZWFrIGE7Zm9yKDtudWxsPT09dS5zaWJsaW5nOyl7aWYobnVsbD09PXUucmV0dXJufHx1LnJldHVybj09PWEpYnJlYWsgYTtxPT09dSYmKHE9bnVsbCk7dT11LnJldHVybn1xPT09dSYmKHE9bnVsbCk7dS5zaWJsaW5nLnJldHVybj11LnJldHVybjt1PXUuc2libGluZ319YnJlYWs7Y2FzZSAxOTpBYShiLGEpO0hhKGEpO2MmNCYmRWkoYSk7YnJlYWs7Y2FzZSAyMTpicmVhaztkZWZhdWx0OkFhKGIsYSksSGEoYSl9fWZ1bmN0aW9uIEhhKGEpe3ZhciBiPWEuZmxhZ3M7aWYoYiYyKXt0cnl7YTp7Zm9yKHZhciBjPWEucmV0dXJuO251bGwhPT1jOyl7aWYoQmkoYykpe3ZhciBkPWM7CmJyZWFrIGF9Yz1jLnJldHVybn10aHJvdyBFcnJvcihtKDE2MCkpO31zd2l0Y2goZC50YWcpe2Nhc2UgNTp2YXIgZT1kLnN0YXRlTm9kZTtkLmZsYWdzJjMyJiYoRmMoZSwiIiksZC5mbGFncyY9LTMzKTt2YXIgZj1DaShhKTtOZihhLGYsZSk7YnJlYWs7Y2FzZSAzOmNhc2UgNDp2YXIgZz1kLnN0YXRlTm9kZS5jb250YWluZXJJbmZvLGg9Q2koYSk7TWYoYSxoLGcpO2JyZWFrO2RlZmF1bHQ6dGhyb3cgRXJyb3IobSgxNjEpKTt9fWNhdGNoKGspe0coYSxhLnJldHVybixrKX1hLmZsYWdzJj0tM31iJjQwOTYmJihhLmZsYWdzJj0tNDA5Nyl9ZnVuY3Rpb24gSGsoYSxiLGMpe2w9YTtIaShhLGIsYyl9ZnVuY3Rpb24gSGkoYSxiLGMpe2Zvcih2YXIgZD0wIT09KGEubW9kZSYxKTtudWxsIT09bDspe3ZhciBlPWwsZj1lLmNoaWxkO2lmKDIyPT09ZS50YWcmJmQpe3ZhciBnPW51bGwhPT1lLm1lbW9pemVkU3RhdGV8fEpkO2lmKCFnKXt2YXIgaD1lLmFsdGVybmF0ZSxrPW51bGwhPT1oJiZudWxsIT09CmgubWVtb2l6ZWRTdGF0ZXx8WDtoPUpkO3ZhciBuPVg7SmQ9ZztpZigoWD1rKSYmIW4pZm9yKGw9ZTtudWxsIT09bDspZz1sLGs9Zy5jaGlsZCwyMj09PWcudGFnJiZudWxsIT09Zy5tZW1vaXplZFN0YXRlP0lpKGUpOm51bGwhPT1rPyhrLnJldHVybj1nLGw9ayk6SWkoZSk7Zm9yKDtudWxsIT09ZjspbD1mLEhpKGYsYixjKSxmPWYuc2libGluZztsPWU7SmQ9aDtYPW59SmkoYSxiLGMpfWVsc2UgMCE9PShlLnN1YnRyZWVGbGFncyY4NzcyKSYmbnVsbCE9PWY/KGYucmV0dXJuPWUsbD1mKTpKaShhLGIsYyl9fWZ1bmN0aW9uIEppKGEsYixjKXtmb3IoO251bGwhPT1sOyl7Yj1sO2lmKDAhPT0oYi5mbGFncyY4NzcyKSl7Yz1iLmFsdGVybmF0ZTt0cnl7aWYoMCE9PShiLmZsYWdzJjg3NzIpKXN3aXRjaChiLnRhZyl7Y2FzZSAwOmNhc2UgMTE6Y2FzZSAxNTpYfHxJZCg1LGIpO2JyZWFrO2Nhc2UgMTp2YXIgZD1iLnN0YXRlTm9kZTtpZihiLmZsYWdzJjQmJiFYKWlmKG51bGw9PT1jKWQuY29tcG9uZW50RGlkTW91bnQoKTsKZWxzZXt2YXIgZT1iLmVsZW1lbnRUeXBlPT09Yi50eXBlP2MubWVtb2l6ZWRQcm9wczp5YShiLnR5cGUsYy5tZW1vaXplZFByb3BzKTtkLmNvbXBvbmVudERpZFVwZGF0ZShlLGMubWVtb2l6ZWRTdGF0ZSxkLl9fcmVhY3RJbnRlcm5hbFNuYXBzaG90QmVmb3JlVXBkYXRlKX12YXIgZj1iLnVwZGF0ZVF1ZXVlO251bGwhPT1mJiZIaChiLGYsZCk7YnJlYWs7Y2FzZSAzOnZhciBnPWIudXBkYXRlUXVldWU7aWYobnVsbCE9PWcpe2M9bnVsbDtpZihudWxsIT09Yi5jaGlsZClzd2l0Y2goYi5jaGlsZC50YWcpe2Nhc2UgNTpjPWIuY2hpbGQuc3RhdGVOb2RlO2JyZWFrO2Nhc2UgMTpjPWIuY2hpbGQuc3RhdGVOb2RlfUhoKGIsZyxjKX1icmVhaztjYXNlIDU6dmFyIGg9Yi5zdGF0ZU5vZGU7aWYobnVsbD09PWMmJmIuZmxhZ3MmNCl7Yz1oO3ZhciBrPWIubWVtb2l6ZWRQcm9wcztzd2l0Y2goYi50eXBlKXtjYXNlICJidXR0b24iOmNhc2UgImlucHV0IjpjYXNlICJzZWxlY3QiOmNhc2UgInRleHRhcmVhIjprLmF1dG9Gb2N1cyYmCmMuZm9jdXMoKTticmVhaztjYXNlICJpbWciOmsuc3JjJiYoYy5zcmM9ay5zcmMpfX1icmVhaztjYXNlIDY6YnJlYWs7Y2FzZSA0OmJyZWFrO2Nhc2UgMTI6YnJlYWs7Y2FzZSAxMzppZihudWxsPT09Yi5tZW1vaXplZFN0YXRlKXt2YXIgbj1iLmFsdGVybmF0ZTtpZihudWxsIT09bil7dmFyIHE9bi5tZW1vaXplZFN0YXRlO2lmKG51bGwhPT1xKXt2YXIgcD1xLmRlaHlkcmF0ZWQ7bnVsbCE9PXAmJm5jKHApfX19YnJlYWs7Y2FzZSAxOTpjYXNlIDE3OmNhc2UgMjE6Y2FzZSAyMjpjYXNlIDIzOmNhc2UgMjU6YnJlYWs7ZGVmYXVsdDp0aHJvdyBFcnJvcihtKDE2MykpO31YfHxiLmZsYWdzJjUxMiYmTGYoYil9Y2F0Y2gocil7RyhiLGIucmV0dXJuLHIpfX1pZihiPT09YSl7bD1udWxsO2JyZWFrfWM9Yi5zaWJsaW5nO2lmKG51bGwhPT1jKXtjLnJldHVybj1iLnJldHVybjtsPWM7YnJlYWt9bD1iLnJldHVybn19ZnVuY3Rpb24gR2koYSl7Zm9yKDtudWxsIT09bDspe3ZhciBiPWw7aWYoYj09PQphKXtsPW51bGw7YnJlYWt9dmFyIGM9Yi5zaWJsaW5nO2lmKG51bGwhPT1jKXtjLnJldHVybj1iLnJldHVybjtsPWM7YnJlYWt9bD1iLnJldHVybn19ZnVuY3Rpb24gSWkoYSl7Zm9yKDtudWxsIT09bDspe3ZhciBiPWw7dHJ5e3N3aXRjaChiLnRhZyl7Y2FzZSAwOmNhc2UgMTE6Y2FzZSAxNTp2YXIgYz1iLnJldHVybjt0cnl7SWQoNCxiKX1jYXRjaChrKXtHKGIsYyxrKX1icmVhaztjYXNlIDE6dmFyIGQ9Yi5zdGF0ZU5vZGU7aWYoImZ1bmN0aW9uIj09PXR5cGVvZiBkLmNvbXBvbmVudERpZE1vdW50KXt2YXIgZT1iLnJldHVybjt0cnl7ZC5jb21wb25lbnREaWRNb3VudCgpfWNhdGNoKGspe0coYixlLGspfX12YXIgZj1iLnJldHVybjt0cnl7TGYoYil9Y2F0Y2goayl7RyhiLGYsayl9YnJlYWs7Y2FzZSA1OnZhciBnPWIucmV0dXJuO3RyeXtMZihiKX1jYXRjaChrKXtHKGIsZyxrKX19fWNhdGNoKGspe0coYixiLnJldHVybixrKX1pZihiPT09YSl7bD1udWxsO2JyZWFrfXZhciBoPWIuc2libGluZzsKaWYobnVsbCE9PWgpe2gucmV0dXJuPWIucmV0dXJuO2w9aDticmVha31sPWIucmV0dXJufX1mdW5jdGlvbiBIYygpe0hmPVAoKSs1MDB9ZnVuY3Rpb24gWigpe3JldHVybiAwIT09KHAmNik/UCgpOi0xIT09S2Q/S2Q6S2Q9UCgpfWZ1bmN0aW9uIGhiKGEpe2lmKDA9PT0oYS5tb2RlJjEpKXJldHVybiAxO2lmKDAhPT0ocCYyKSYmMCE9PVUpcmV0dXJuIFUmLVU7aWYobnVsbCE9PUlrLnRyYW5zaXRpb24pcmV0dXJuIDA9PT1MZCYmKExkPURnKCkpLExkO2E9ejtpZigwIT09YSlyZXR1cm4gYTthPXdpbmRvdy5ldmVudDthPXZvaWQgMD09PWE/MTY6TGcoYS50eXBlKTtyZXR1cm4gYX1mdW5jdGlvbiB4YShhLGIsYyxkKXtpZig1MDxJYyl0aHJvdyBJYz0wLFBmPW51bGwsRXJyb3IobSgxODUpKTtpYyhhLGMsZCk7aWYoMD09PShwJjIpfHxhIT09TylhPT09TyYmKDA9PT0ocCYyKSYmKE1kfD1jKSw0PT09TCYma2IoYSxVKSksaWEoYSxkKSwxPT09YyYmMD09PXAmJjA9PT0oYi5tb2RlJjEpJiYKKEhjKCksbWQmJmRiKCkpfWZ1bmN0aW9uIGlhKGEsYil7dmFyIGM9YS5jYWxsYmFja05vZGU7dGooYSxiKTt2YXIgZD1WYyhhLGE9PT1PP1U6MCk7aWYoMD09PWQpbnVsbCE9PWMmJktpKGMpLGEuY2FsbGJhY2tOb2RlPW51bGwsYS5jYWxsYmFja1ByaW9yaXR5PTA7ZWxzZSBpZihiPWQmLWQsYS5jYWxsYmFja1ByaW9yaXR5IT09Yil7bnVsbCE9YyYmS2koYyk7aWYoMT09PWIpMD09PWEudGFnP2prKExpLmJpbmQobnVsbCxhKSk6d2goTGkuYmluZChudWxsLGEpKSxKayhmdW5jdGlvbigpezA9PT0ocCY2KSYmZGIoKX0pLGM9bnVsbDtlbHNle3N3aXRjaChFZyhkKSl7Y2FzZSAxOmM9RGU7YnJlYWs7Y2FzZSA0OmM9TWc7YnJlYWs7Y2FzZSAxNjpjPWFkO2JyZWFrO2Nhc2UgNTM2ODcwOTEyOmM9Tmc7YnJlYWs7ZGVmYXVsdDpjPWFkfWM9TWkoYyxOaS5iaW5kKG51bGwsYSkpfWEuY2FsbGJhY2tQcmlvcml0eT1iO2EuY2FsbGJhY2tOb2RlPWN9fWZ1bmN0aW9uIE5pKGEsYil7S2Q9LTE7CkxkPTA7aWYoMCE9PShwJjYpKXRocm93IEVycm9yKG0oMzI3KSk7dmFyIGM9YS5jYWxsYmFja05vZGU7aWYoWGIoKSYmYS5jYWxsYmFja05vZGUhPT1jKXJldHVybiBudWxsO3ZhciBkPVZjKGEsYT09PU8/VTowKTtpZigwPT09ZClyZXR1cm4gbnVsbDtpZigwIT09KGQmMzApfHwwIT09KGQmYS5leHBpcmVkTGFuZXMpfHxiKWI9TmQoYSxkKTtlbHNle2I9ZDt2YXIgZT1wO3B8PTI7dmFyIGY9T2koKTtpZihPIT09YXx8VSE9PWIpUmE9bnVsbCxIYygpLHdiKGEsYik7ZG8gdHJ5e0trKCk7YnJlYWt9Y2F0Y2goaCl7UGkoYSxoKX13aGlsZSgxKTthZigpO09kLmN1cnJlbnQ9ZjtwPWU7bnVsbCE9PUg/Yj0wOihPPW51bGwsVT0wLGI9TCl9aWYoMCE9PWIpezI9PT1iJiYoZT12ZShhKSwwIT09ZSYmKGQ9ZSxiPVFmKGEsZSkpKTtpZigxPT09Yil0aHJvdyBjPUpjLHdiKGEsMCksa2IoYSxkKSxpYShhLFAoKSksYztpZig2PT09YilrYihhLGQpO2Vsc2V7ZT1hLmN1cnJlbnQuYWx0ZXJuYXRlOwppZigwPT09KGQmMzApJiYhTGsoZSkmJihiPU5kKGEsZCksMj09PWImJihmPXZlKGEpLDAhPT1mJiYoZD1mLGI9UWYoYSxmKSkpLDE9PT1iKSl0aHJvdyBjPUpjLHdiKGEsMCksa2IoYSxkKSxpYShhLFAoKSksYzthLmZpbmlzaGVkV29yaz1lO2EuZmluaXNoZWRMYW5lcz1kO3N3aXRjaChiKXtjYXNlIDA6Y2FzZSAxOnRocm93IEVycm9yKG0oMzQ1KSk7Y2FzZSAyOnhiKGEsamEsUmEpO2JyZWFrO2Nhc2UgMzprYihhLGQpO2lmKChkJjEzMDAyMzQyNCk9PT1kJiYoYj1PZis1MDAtUCgpLDEwPGIpKXtpZigwIT09VmMoYSwwKSlicmVhaztlPWEuc3VzcGVuZGVkTGFuZXM7aWYoKGUmZCkhPT1kKXtaKCk7YS5waW5nZWRMYW5lc3w9YS5zdXNwZW5kZWRMYW5lcyZlO2JyZWFrfWEudGltZW91dEhhbmRsZT1SZih4Yi5iaW5kKG51bGwsYSxqYSxSYSksYik7YnJlYWt9eGIoYSxqYSxSYSk7YnJlYWs7Y2FzZSA0OmtiKGEsZCk7aWYoKGQmNDE5NDI0MCk9PT1kKWJyZWFrO2I9YS5ldmVudFRpbWVzOwpmb3IoZT0tMTswPGQ7KXt2YXIgZz0zMS10YShkKTtmPTE8PGc7Zz1iW2ddO2c+ZSYmKGU9Zyk7ZCY9fmZ9ZD1lO2Q9UCgpLWQ7ZD0oMTIwPmQ/MTIwOjQ4MD5kPzQ4MDoxMDgwPmQ/MTA4MDoxOTIwPmQ/MTkyMDozRTM+ZD8zRTM6NDMyMD5kPzQzMjA6MTk2MCpNayhkLzE5NjApKS1kO2lmKDEwPGQpe2EudGltZW91dEhhbmRsZT1SZih4Yi5iaW5kKG51bGwsYSxqYSxSYSksZCk7YnJlYWt9eGIoYSxqYSxSYSk7YnJlYWs7Y2FzZSA1OnhiKGEsamEsUmEpO2JyZWFrO2RlZmF1bHQ6dGhyb3cgRXJyb3IobSgzMjkpKTt9fX1pYShhLFAoKSk7cmV0dXJuIGEuY2FsbGJhY2tOb2RlPT09Yz9OaS5iaW5kKG51bGwsYSk6bnVsbH1mdW5jdGlvbiBRZihhLGIpe3ZhciBjPUtjO2EuY3VycmVudC5tZW1vaXplZFN0YXRlLmlzRGVoeWRyYXRlZCYmKHdiKGEsYikuZmxhZ3N8PTI1Nik7YT1OZChhLGIpOzIhPT1hJiYoYj1qYSxqYT1jLG51bGwhPT1iJiZHZihiKSk7cmV0dXJuIGF9ZnVuY3Rpb24gR2YoYSl7bnVsbD09PQpqYT9qYT1hOmphLnB1c2guYXBwbHkoamEsYSl9ZnVuY3Rpb24gTGsoYSl7Zm9yKHZhciBiPWE7Oyl7aWYoYi5mbGFncyYxNjM4NCl7dmFyIGM9Yi51cGRhdGVRdWV1ZTtpZihudWxsIT09YyYmKGM9Yy5zdG9yZXMsbnVsbCE9PWMpKWZvcih2YXIgZD0wO2Q8Yy5sZW5ndGg7ZCsrKXt2YXIgZT1jW2RdLGY9ZS5nZXRTbmFwc2hvdDtlPWUudmFsdWU7dHJ5e2lmKCF1YShmKCksZSkpcmV0dXJuITF9Y2F0Y2goZyl7cmV0dXJuITF9fX1jPWIuY2hpbGQ7aWYoYi5zdWJ0cmVlRmxhZ3MmMTYzODQmJm51bGwhPT1jKWMucmV0dXJuPWIsYj1jO2Vsc2V7aWYoYj09PWEpYnJlYWs7Zm9yKDtudWxsPT09Yi5zaWJsaW5nOyl7aWYobnVsbD09PWIucmV0dXJufHxiLnJldHVybj09PWEpcmV0dXJuITA7Yj1iLnJldHVybn1iLnNpYmxpbmcucmV0dXJuPWIucmV0dXJuO2I9Yi5zaWJsaW5nfX1yZXR1cm4hMH1mdW5jdGlvbiBrYihhLGIpe2ImPX5TZjtiJj1+TWQ7YS5zdXNwZW5kZWRMYW5lc3w9YjthLnBpbmdlZExhbmVzJj0KfmI7Zm9yKGE9YS5leHBpcmF0aW9uVGltZXM7MDxiOyl7dmFyIGM9MzEtdGEoYiksZD0xPDxjO2FbY109LTE7YiY9fmR9fWZ1bmN0aW9uIExpKGEpe2lmKDAhPT0ocCY2KSl0aHJvdyBFcnJvcihtKDMyNykpO1hiKCk7dmFyIGI9VmMoYSwwKTtpZigwPT09KGImMSkpcmV0dXJuIGlhKGEsUCgpKSxudWxsO3ZhciBjPU5kKGEsYik7aWYoMCE9PWEudGFnJiYyPT09Yyl7dmFyIGQ9dmUoYSk7MCE9PWQmJihiPWQsYz1RZihhLGQpKX1pZigxPT09Yyl0aHJvdyBjPUpjLHdiKGEsMCksa2IoYSxiKSxpYShhLFAoKSksYztpZig2PT09Yyl0aHJvdyBFcnJvcihtKDM0NSkpO2EuZmluaXNoZWRXb3JrPWEuY3VycmVudC5hbHRlcm5hdGU7YS5maW5pc2hlZExhbmVzPWI7eGIoYSxqYSxSYSk7aWEoYSxQKCkpO3JldHVybiBudWxsfWZ1bmN0aW9uIFRmKGEsYil7dmFyIGM9cDtwfD0xO3RyeXtyZXR1cm4gYShiKX1maW5hbGx5e3A9YywwPT09cCYmKEhjKCksbWQmJmRiKCkpfX1mdW5jdGlvbiB5YihhKXtudWxsIT09CmxiJiYwPT09bGIudGFnJiYwPT09KHAmNikmJlhiKCk7dmFyIGI9cDtwfD0xO3ZhciBjPWNhLnRyYW5zaXRpb24sZD16O3RyeXtpZihjYS50cmFuc2l0aW9uPW51bGwsej0xLGEpcmV0dXJuIGEoKX1maW5hbGx5e3o9ZCxjYS50cmFuc2l0aW9uPWMscD1iLDA9PT0ocCY2KSYmZGIoKX19ZnVuY3Rpb24gd2IoYSxiKXthLmZpbmlzaGVkV29yaz1udWxsO2EuZmluaXNoZWRMYW5lcz0wO3ZhciBjPWEudGltZW91dEhhbmRsZTstMSE9PWMmJihhLnRpbWVvdXRIYW5kbGU9LTEsTmsoYykpO2lmKG51bGwhPT1IKWZvcihjPUgucmV0dXJuO251bGwhPT1jOyl7dmFyIGQ9YztWZShkKTtzd2l0Y2goZC50YWcpe2Nhc2UgMTpkPWQudHlwZS5jaGlsZENvbnRleHRUeXBlcztudWxsIT09ZCYmdm9pZCAwIT09ZCYmKHYoUyksdihKKSk7YnJlYWs7Y2FzZSAzOlRiKCk7dihTKTt2KEopO2pmKCk7YnJlYWs7Y2FzZSA1OmhmKGQpO2JyZWFrO2Nhc2UgNDpUYigpO2JyZWFrO2Nhc2UgMTM6dihGKTticmVhazsKY2FzZSAxOTp2KEYpO2JyZWFrO2Nhc2UgMTA6Y2YoZC50eXBlLl9jb250ZXh0KTticmVhaztjYXNlIDIyOmNhc2UgMjM6YmE9R2EuY3VycmVudCx2KEdhKX1jPWMucmV0dXJufU89YTtIPWE9ZWIoYS5jdXJyZW50LG51bGwpO1U9YmE9YjtMPTA7SmM9bnVsbDtTZj1NZD1yYT0wO2phPUtjPW51bGw7aWYobnVsbCE9PXRiKXtmb3IoYj0wO2I8dGIubGVuZ3RoO2IrKylpZihjPXRiW2JdLGQ9Yy5pbnRlcmxlYXZlZCxudWxsIT09ZCl7Yy5pbnRlcmxlYXZlZD1udWxsO3ZhciBlPWQubmV4dCxmPWMucGVuZGluZztpZihudWxsIT09Zil7dmFyIGc9Zi5uZXh0O2YubmV4dD1lO2QubmV4dD1nfWMucGVuZGluZz1kfXRiPW51bGx9cmV0dXJuIGF9ZnVuY3Rpb24gUGkoYSxiKXtkb3t2YXIgYz1IO3RyeXthZigpO3lkLmN1cnJlbnQ9emQ7aWYoQWQpe2Zvcih2YXIgZD1DLm1lbW9pemVkU3RhdGU7bnVsbCE9PWQ7KXt2YXIgZT1kLnF1ZXVlO251bGwhPT1lJiYoZS5wZW5kaW5nPW51bGwpO2Q9ZC5uZXh0fUFkPQohMX12Yj0wO049Sz1DPW51bGw7emM9ITE7QWM9MDtVZi5jdXJyZW50PW51bGw7aWYobnVsbD09PWN8fG51bGw9PT1jLnJldHVybil7TD0xO0pjPWI7SD1udWxsO2JyZWFrfWE6e3ZhciBmPWEsZz1jLnJldHVybixoPWMsaz1iO2I9VTtoLmZsYWdzfD0zMjc2ODtpZihudWxsIT09ayYmIm9iamVjdCI9PT10eXBlb2YgayYmImZ1bmN0aW9uIj09PXR5cGVvZiBrLnRoZW4pe3ZhciBuPWssbD1oLHA9bC50YWc7aWYoMD09PShsLm1vZGUmMSkmJigwPT09cHx8MTE9PT1wfHwxNT09PXApKXt2YXIgcj1sLmFsdGVybmF0ZTtyPyhsLnVwZGF0ZVF1ZXVlPXIudXBkYXRlUXVldWUsbC5tZW1vaXplZFN0YXRlPXIubWVtb2l6ZWRTdGF0ZSxsLmxhbmVzPXIubGFuZXMpOihsLnVwZGF0ZVF1ZXVlPW51bGwsbC5tZW1vaXplZFN0YXRlPW51bGwpfXZhciB2PWppKGcpO2lmKG51bGwhPT12KXt2LmZsYWdzJj0tMjU3O2tpKHYsZyxoLGYsYik7di5tb2RlJjEmJmlpKGYsbixiKTtiPXY7az1uO3ZhciB4PWIudXBkYXRlUXVldWU7CmlmKG51bGw9PT14KXt2YXIgej1uZXcgU2V0O3ouYWRkKGspO2IudXBkYXRlUXVldWU9en1lbHNlIHguYWRkKGspO2JyZWFrIGF9ZWxzZXtpZigwPT09KGImMSkpe2lpKGYsbixiKTtFZigpO2JyZWFrIGF9az1FcnJvcihtKDQyNikpfX1lbHNlIGlmKEQmJmgubW9kZSYxKXt2YXIgeT1qaShnKTtpZihudWxsIT09eSl7MD09PSh5LmZsYWdzJjY1NTM2KSYmKHkuZmxhZ3N8PTI1Nik7a2koeSxnLGgsZixiKTtZZShVYihrLGgpKTticmVhayBhfX1mPWs9VWIoayxoKTs0IT09TCYmKEw9Mik7bnVsbD09PUtjP0tjPVtmXTpLYy5wdXNoKGYpO2Y9Zztkb3tzd2l0Y2goZi50YWcpe2Nhc2UgMzpmLmZsYWdzfD02NTUzNjtiJj0tYjtmLmxhbmVzfD1iO3ZhciB3PWdpKGYsayxiKTtHaChmLHcpO2JyZWFrIGE7Y2FzZSAxOmg9azt2YXIgQT1mLnR5cGUsdD1mLnN0YXRlTm9kZTtpZigwPT09KGYuZmxhZ3MmMTI4KSYmKCJmdW5jdGlvbiI9PT10eXBlb2YgQS5nZXREZXJpdmVkU3RhdGVGcm9tRXJyb3J8fApudWxsIT09dCYmImZ1bmN0aW9uIj09PXR5cGVvZiB0LmNvbXBvbmVudERpZENhdGNoJiYobnVsbD09PWlifHwhaWIuaGFzKHQpKSkpe2YuZmxhZ3N8PTY1NTM2O2ImPS1iO2YubGFuZXN8PWI7dmFyIEI9aGkoZixoLGIpO0doKGYsQik7YnJlYWsgYX19Zj1mLnJldHVybn13aGlsZShudWxsIT09Zil9UWkoYyl9Y2F0Y2gobWEpe2I9bWE7SD09PWMmJm51bGwhPT1jJiYoSD1jPWMucmV0dXJuKTtjb250aW51ZX1icmVha313aGlsZSgxKX1mdW5jdGlvbiBPaSgpe3ZhciBhPU9kLmN1cnJlbnQ7T2QuY3VycmVudD16ZDtyZXR1cm4gbnVsbD09PWE/emQ6YX1mdW5jdGlvbiBFZigpe2lmKDA9PT1MfHwzPT09THx8Mj09PUwpTD00O251bGw9PT1PfHwwPT09KHJhJjI2ODQzNTQ1NSkmJjA9PT0oTWQmMjY4NDM1NDU1KXx8a2IoTyxVKX1mdW5jdGlvbiBOZChhLGIpe3ZhciBjPXA7cHw9Mjt2YXIgZD1PaSgpO2lmKE8hPT1hfHxVIT09YilSYT1udWxsLHdiKGEsYik7ZG8gdHJ5e09rKCk7YnJlYWt9Y2F0Y2goZSl7UGkoYSwKZSl9d2hpbGUoMSk7YWYoKTtwPWM7T2QuY3VycmVudD1kO2lmKG51bGwhPT1IKXRocm93IEVycm9yKG0oMjYxKSk7Tz1udWxsO1U9MDtyZXR1cm4gTH1mdW5jdGlvbiBPaygpe2Zvcig7bnVsbCE9PUg7KVJpKEgpfWZ1bmN0aW9uIEtrKCl7Zm9yKDtudWxsIT09SCYmIVBrKCk7KVJpKEgpfWZ1bmN0aW9uIFJpKGEpe3ZhciBiPVFrKGEuYWx0ZXJuYXRlLGEsYmEpO2EubWVtb2l6ZWRQcm9wcz1hLnBlbmRpbmdQcm9wcztudWxsPT09Yj9RaShhKTpIPWI7VWYuY3VycmVudD1udWxsfWZ1bmN0aW9uIFFpKGEpe3ZhciBiPWE7ZG97dmFyIGM9Yi5hbHRlcm5hdGU7YT1iLnJldHVybjtpZigwPT09KGIuZmxhZ3MmMzI3NjgpKXtpZihjPXhrKGMsYixiYSksbnVsbCE9PWMpe0g9YztyZXR1cm59fWVsc2V7Yz1CayhjLGIpO2lmKG51bGwhPT1jKXtjLmZsYWdzJj0zMjc2NztIPWM7cmV0dXJufWlmKG51bGwhPT1hKWEuZmxhZ3N8PTMyNzY4LGEuc3VidHJlZUZsYWdzPTAsYS5kZWxldGlvbnM9bnVsbDsKZWxzZXtMPTY7SD1udWxsO3JldHVybn19Yj1iLnNpYmxpbmc7aWYobnVsbCE9PWIpe0g9YjtyZXR1cm59SD1iPWF9d2hpbGUobnVsbCE9PWIpOzA9PT1MJiYoTD01KX1mdW5jdGlvbiB4YihhLGIsYyl7dmFyIGQ9eixlPWNhLnRyYW5zaXRpb247dHJ5e2NhLnRyYW5zaXRpb249bnVsbCx6PTEsUmsoYSxiLGMsZCl9ZmluYWxseXtjYS50cmFuc2l0aW9uPWUsej1kfXJldHVybiBudWxsfWZ1bmN0aW9uIFJrKGEsYixjLGQpe2RvIFhiKCk7d2hpbGUobnVsbCE9PWxiKTtpZigwIT09KHAmNikpdGhyb3cgRXJyb3IobSgzMjcpKTtjPWEuZmluaXNoZWRXb3JrO3ZhciBlPWEuZmluaXNoZWRMYW5lcztpZihudWxsPT09YylyZXR1cm4gbnVsbDthLmZpbmlzaGVkV29yaz1udWxsO2EuZmluaXNoZWRMYW5lcz0wO2lmKGM9PT1hLmN1cnJlbnQpdGhyb3cgRXJyb3IobSgxNzcpKTthLmNhbGxiYWNrTm9kZT1udWxsO2EuY2FsbGJhY2tQcmlvcml0eT0wO3ZhciBmPWMubGFuZXN8Yy5jaGlsZExhbmVzOwp1aihhLGYpO2E9PT1PJiYoSD1PPW51bGwsVT0wKTswPT09KGMuc3VidHJlZUZsYWdzJjIwNjQpJiYwPT09KGMuZmxhZ3MmMjA2NCl8fFBkfHwoUGQ9ITAsTWkoYWQsZnVuY3Rpb24oKXtYYigpO3JldHVybiBudWxsfSkpO2Y9MCE9PShjLmZsYWdzJjE1OTkwKTtpZigwIT09KGMuc3VidHJlZUZsYWdzJjE1OTkwKXx8Zil7Zj1jYS50cmFuc2l0aW9uO2NhLnRyYW5zaXRpb249bnVsbDt2YXIgZz16O3o9MTt2YXIgaD1wO3B8PTQ7VWYuY3VycmVudD1udWxsO0NrKGEsYyk7RmkoYyxhKTtUaihLZik7WmM9ISFKZjtLZj1KZj1udWxsO2EuY3VycmVudD1jO0hrKGMsYSxlKTtTaygpO3A9aDt6PWc7Y2EudHJhbnNpdGlvbj1mfWVsc2UgYS5jdXJyZW50PWM7UGQmJihQZD0hMSxsYj1hLFFkPWUpO2Y9YS5wZW5kaW5nTGFuZXM7MD09PWYmJihpYj1udWxsKTtvaihjLnN0YXRlTm9kZSxkKTtpYShhLFAoKSk7aWYobnVsbCE9PWIpZm9yKGQ9YS5vblJlY292ZXJhYmxlRXJyb3IsYz0wO2M8Yi5sZW5ndGg7YysrKWU9CmJbY10sZChlLnZhbHVlLHtjb21wb25lbnRTdGFjazplLnN0YWNrLGRpZ2VzdDplLmRpZ2VzdH0pO2lmKEVkKXRocm93IEVkPSExLGE9eGYseGY9bnVsbCxhOzAhPT0oUWQmMSkmJjAhPT1hLnRhZyYmWGIoKTtmPWEucGVuZGluZ0xhbmVzOzAhPT0oZiYxKT9hPT09UGY/SWMrKzooSWM9MCxQZj1hKTpJYz0wO2RiKCk7cmV0dXJuIG51bGx9ZnVuY3Rpb24gWGIoKXtpZihudWxsIT09bGIpe3ZhciBhPUVnKFFkKSxiPWNhLnRyYW5zaXRpb24sYz16O3RyeXtjYS50cmFuc2l0aW9uPW51bGw7ej0xNj5hPzE2OmE7aWYobnVsbD09PWxiKXZhciBkPSExO2Vsc2V7YT1sYjtsYj1udWxsO1FkPTA7aWYoMCE9PShwJjYpKXRocm93IEVycm9yKG0oMzMxKSk7dmFyIGU9cDtwfD00O2ZvcihsPWEuY3VycmVudDtudWxsIT09bDspe3ZhciBmPWwsZz1mLmNoaWxkO2lmKDAhPT0obC5mbGFncyYxNikpe3ZhciBoPWYuZGVsZXRpb25zO2lmKG51bGwhPT1oKXtmb3IodmFyIGs9MDtrPGgubGVuZ3RoO2srKyl7dmFyIG49Cmhba107Zm9yKGw9bjtudWxsIT09bDspe3ZhciBxPWw7c3dpdGNoKHEudGFnKXtjYXNlIDA6Y2FzZSAxMTpjYXNlIDE1OkdjKDgscSxmKX12YXIgdT1xLmNoaWxkO2lmKG51bGwhPT11KXUucmV0dXJuPXEsbD11O2Vsc2UgZm9yKDtudWxsIT09bDspe3E9bDt2YXIgcj1xLnNpYmxpbmcsdj1xLnJldHVybjtBaShxKTtpZihxPT09bil7bD1udWxsO2JyZWFrfWlmKG51bGwhPT1yKXtyLnJldHVybj12O2w9cjticmVha31sPXZ9fX12YXIgeD1mLmFsdGVybmF0ZTtpZihudWxsIT09eCl7dmFyIHk9eC5jaGlsZDtpZihudWxsIT09eSl7eC5jaGlsZD1udWxsO2Rve3ZhciBDPXkuc2libGluZzt5LnNpYmxpbmc9bnVsbDt5PUN9d2hpbGUobnVsbCE9PXkpfX1sPWZ9fWlmKDAhPT0oZi5zdWJ0cmVlRmxhZ3MmMjA2NCkmJm51bGwhPT1nKWcucmV0dXJuPWYsbD1nO2Vsc2UgYjpmb3IoO251bGwhPT1sOyl7Zj1sO2lmKDAhPT0oZi5mbGFncyYyMDQ4KSlzd2l0Y2goZi50YWcpe2Nhc2UgMDpjYXNlIDExOmNhc2UgMTU6R2MoOSwKZixmLnJldHVybil9dmFyIHc9Zi5zaWJsaW5nO2lmKG51bGwhPT13KXt3LnJldHVybj1mLnJldHVybjtsPXc7YnJlYWsgYn1sPWYucmV0dXJufX12YXIgQT1hLmN1cnJlbnQ7Zm9yKGw9QTtudWxsIT09bDspe2c9bDt2YXIgdD1nLmNoaWxkO2lmKDAhPT0oZy5zdWJ0cmVlRmxhZ3MmMjA2NCkmJm51bGwhPT10KXQucmV0dXJuPWcsbD10O2Vsc2UgYjpmb3IoZz1BO251bGwhPT1sOyl7aD1sO2lmKDAhPT0oaC5mbGFncyYyMDQ4KSl0cnl7c3dpdGNoKGgudGFnKXtjYXNlIDA6Y2FzZSAxMTpjYXNlIDE1OklkKDksaCl9fWNhdGNoKG1hKXtHKGgsaC5yZXR1cm4sbWEpfWlmKGg9PT1nKXtsPW51bGw7YnJlYWsgYn12YXIgQj1oLnNpYmxpbmc7aWYobnVsbCE9PUIpe0IucmV0dXJuPWgucmV0dXJuO2w9QjticmVhayBifWw9aC5yZXR1cm59fXA9ZTtkYigpO2lmKENhJiYiZnVuY3Rpb24iPT09dHlwZW9mIENhLm9uUG9zdENvbW1pdEZpYmVyUm9vdCl0cnl7Q2Eub25Qb3N0Q29tbWl0RmliZXJSb290KFVjLAphKX1jYXRjaChtYSl7fWQ9ITB9cmV0dXJuIGR9ZmluYWxseXt6PWMsY2EudHJhbnNpdGlvbj1ifX1yZXR1cm4hMX1mdW5jdGlvbiBTaShhLGIsYyl7Yj1VYihjLGIpO2I9Z2koYSxiLDEpO2E9ZmIoYSxiLDEpO2I9WigpO251bGwhPT1hJiYoaWMoYSwxLGIpLGlhKGEsYikpfWZ1bmN0aW9uIEcoYSxiLGMpe2lmKDM9PT1hLnRhZylTaShhLGEsYyk7ZWxzZSBmb3IoO251bGwhPT1iOyl7aWYoMz09PWIudGFnKXtTaShiLGEsYyk7YnJlYWt9ZWxzZSBpZigxPT09Yi50YWcpe3ZhciBkPWIuc3RhdGVOb2RlO2lmKCJmdW5jdGlvbiI9PT10eXBlb2YgYi50eXBlLmdldERlcml2ZWRTdGF0ZUZyb21FcnJvcnx8ImZ1bmN0aW9uIj09PXR5cGVvZiBkLmNvbXBvbmVudERpZENhdGNoJiYobnVsbD09PWlifHwhaWIuaGFzKGQpKSl7YT1VYihjLGEpO2E9aGkoYixhLDEpO2I9ZmIoYixhLDEpO2E9WigpO251bGwhPT1iJiYoaWMoYiwxLGEpLGlhKGIsYSkpO2JyZWFrfX1iPWIucmV0dXJufX1mdW5jdGlvbiBzayhhLApiLGMpe3ZhciBkPWEucGluZ0NhY2hlO251bGwhPT1kJiZkLmRlbGV0ZShiKTtiPVooKTthLnBpbmdlZExhbmVzfD1hLnN1c3BlbmRlZExhbmVzJmM7Tz09PWEmJihVJmMpPT09YyYmKDQ9PT1MfHwzPT09TCYmKFUmMTMwMDIzNDI0KT09PVUmJjUwMD5QKCktT2Y/d2IoYSwwKTpTZnw9Yyk7aWEoYSxiKX1mdW5jdGlvbiBUaShhLGIpezA9PT1iJiYoMD09PShhLm1vZGUmMSk/Yj0xOihiPVJkLFJkPDw9MSwwPT09KFJkJjEzMDAyMzQyNCkmJihSZD00MTk0MzA0KSkpO3ZhciBjPVooKTthPU9hKGEsYik7bnVsbCE9PWEmJihpYyhhLGIsYyksaWEoYSxjKSl9ZnVuY3Rpb24gdmsoYSl7dmFyIGI9YS5tZW1vaXplZFN0YXRlLGM9MDtudWxsIT09YiYmKGM9Yi5yZXRyeUxhbmUpO1RpKGEsYyl9ZnVuY3Rpb24gR2soYSxiKXt2YXIgYz0wO3N3aXRjaChhLnRhZyl7Y2FzZSAxMzp2YXIgZD1hLnN0YXRlTm9kZTt2YXIgZT1hLm1lbW9pemVkU3RhdGU7bnVsbCE9PWUmJihjPWUucmV0cnlMYW5lKTsKYnJlYWs7Y2FzZSAxOTpkPWEuc3RhdGVOb2RlO2JyZWFrO2RlZmF1bHQ6dGhyb3cgRXJyb3IobSgzMTQpKTt9bnVsbCE9PWQmJmQuZGVsZXRlKGIpO1RpKGEsYyl9ZnVuY3Rpb24gTWkoYSxiKXtyZXR1cm4geGgoYSxiKX1mdW5jdGlvbiBUayhhLGIsYyxkKXt0aGlzLnRhZz1hO3RoaXMua2V5PWM7dGhpcy5zaWJsaW5nPXRoaXMuY2hpbGQ9dGhpcy5yZXR1cm49dGhpcy5zdGF0ZU5vZGU9dGhpcy50eXBlPXRoaXMuZWxlbWVudFR5cGU9bnVsbDt0aGlzLmluZGV4PTA7dGhpcy5yZWY9bnVsbDt0aGlzLnBlbmRpbmdQcm9wcz1iO3RoaXMuZGVwZW5kZW5jaWVzPXRoaXMubWVtb2l6ZWRTdGF0ZT10aGlzLnVwZGF0ZVF1ZXVlPXRoaXMubWVtb2l6ZWRQcm9wcz1udWxsO3RoaXMubW9kZT1kO3RoaXMuc3VidHJlZUZsYWdzPXRoaXMuZmxhZ3M9MDt0aGlzLmRlbGV0aW9ucz1udWxsO3RoaXMuY2hpbGRMYW5lcz10aGlzLmxhbmVzPTA7dGhpcy5hbHRlcm5hdGU9bnVsbH1mdW5jdGlvbiB5ZihhKXthPQphLnByb3RvdHlwZTtyZXR1cm4hKCFhfHwhYS5pc1JlYWN0Q29tcG9uZW50KX1mdW5jdGlvbiBVayhhKXtpZigiZnVuY3Rpb24iPT09dHlwZW9mIGEpcmV0dXJuIHlmKGEpPzE6MDtpZih2b2lkIDAhPT1hJiZudWxsIT09YSl7YT1hLiQkdHlwZW9mO2lmKGE9PT1pZSlyZXR1cm4gMTE7aWYoYT09PWplKXJldHVybiAxNH1yZXR1cm4gMn1mdW5jdGlvbiBlYihhLGIpe3ZhciBjPWEuYWx0ZXJuYXRlO251bGw9PT1jPyhjPXBhKGEudGFnLGIsYS5rZXksYS5tb2RlKSxjLmVsZW1lbnRUeXBlPWEuZWxlbWVudFR5cGUsYy50eXBlPWEudHlwZSxjLnN0YXRlTm9kZT1hLnN0YXRlTm9kZSxjLmFsdGVybmF0ZT1hLGEuYWx0ZXJuYXRlPWMpOihjLnBlbmRpbmdQcm9wcz1iLGMudHlwZT1hLnR5cGUsYy5mbGFncz0wLGMuc3VidHJlZUZsYWdzPTAsYy5kZWxldGlvbnM9bnVsbCk7Yy5mbGFncz1hLmZsYWdzJjE0NjgwMDY0O2MuY2hpbGRMYW5lcz1hLmNoaWxkTGFuZXM7Yy5sYW5lcz1hLmxhbmVzO2MuY2hpbGQ9CmEuY2hpbGQ7Yy5tZW1vaXplZFByb3BzPWEubWVtb2l6ZWRQcm9wcztjLm1lbW9pemVkU3RhdGU9YS5tZW1vaXplZFN0YXRlO2MudXBkYXRlUXVldWU9YS51cGRhdGVRdWV1ZTtiPWEuZGVwZW5kZW5jaWVzO2MuZGVwZW5kZW5jaWVzPW51bGw9PT1iP251bGw6e2xhbmVzOmIubGFuZXMsZmlyc3RDb250ZXh0OmIuZmlyc3RDb250ZXh0fTtjLnNpYmxpbmc9YS5zaWJsaW5nO2MuaW5kZXg9YS5pbmRleDtjLnJlZj1hLnJlZjtyZXR1cm4gY31mdW5jdGlvbiByZChhLGIsYyxkLGUsZil7dmFyIGc9MjtkPWE7aWYoImZ1bmN0aW9uIj09PXR5cGVvZiBhKXlmKGEpJiYoZz0xKTtlbHNlIGlmKCJzdHJpbmciPT09dHlwZW9mIGEpZz01O2Vsc2UgYTpzd2l0Y2goYSl7Y2FzZSBCYjpyZXR1cm4gc2IoYy5jaGlsZHJlbixlLGYsYik7Y2FzZSBmZTpnPTg7ZXw9ODticmVhaztjYXNlIGVlOnJldHVybiBhPXBhKDEyLGMsYixlfDIpLGEuZWxlbWVudFR5cGU9ZWUsYS5sYW5lcz1mLGE7Y2FzZSBnZTpyZXR1cm4gYT0KcGEoMTMsYyxiLGUpLGEuZWxlbWVudFR5cGU9Z2UsYS5sYW5lcz1mLGE7Y2FzZSBoZTpyZXR1cm4gYT1wYSgxOSxjLGIsZSksYS5lbGVtZW50VHlwZT1oZSxhLmxhbmVzPWYsYTtjYXNlIFVpOnJldHVybiBHZChjLGUsZixiKTtkZWZhdWx0OmlmKCJvYmplY3QiPT09dHlwZW9mIGEmJm51bGwhPT1hKXN3aXRjaChhLiQkdHlwZW9mKXtjYXNlIGhnOmc9MTA7YnJlYWsgYTtjYXNlIGdnOmc9OTticmVhayBhO2Nhc2UgaWU6Zz0xMTticmVhayBhO2Nhc2UgamU6Zz0xNDticmVhayBhO2Nhc2UgVGE6Zz0xNjtkPW51bGw7YnJlYWsgYX10aHJvdyBFcnJvcihtKDEzMCxudWxsPT1hP2E6dHlwZW9mIGEsIiIpKTt9Yj1wYShnLGMsYixlKTtiLmVsZW1lbnRUeXBlPWE7Yi50eXBlPWQ7Yi5sYW5lcz1mO3JldHVybiBifWZ1bmN0aW9uIHNiKGEsYixjLGQpe2E9cGEoNyxhLGQsYik7YS5sYW5lcz1jO3JldHVybiBhfWZ1bmN0aW9uIEdkKGEsYixjLGQpe2E9cGEoMjIsYSxkLGIpO2EuZWxlbWVudFR5cGU9ClVpO2EubGFuZXM9YzthLnN0YXRlTm9kZT17aXNIaWRkZW46ITF9O3JldHVybiBhfWZ1bmN0aW9uIFplKGEsYixjKXthPXBhKDYsYSxudWxsLGIpO2EubGFuZXM9YztyZXR1cm4gYX1mdW5jdGlvbiAkZShhLGIsYyl7Yj1wYSg0LG51bGwhPT1hLmNoaWxkcmVuP2EuY2hpbGRyZW46W10sYS5rZXksYik7Yi5sYW5lcz1jO2Iuc3RhdGVOb2RlPXtjb250YWluZXJJbmZvOmEuY29udGFpbmVySW5mbyxwZW5kaW5nQ2hpbGRyZW46bnVsbCxpbXBsZW1lbnRhdGlvbjphLmltcGxlbWVudGF0aW9ufTtyZXR1cm4gYn1mdW5jdGlvbiBWayhhLGIsYyxkLGUpe3RoaXMudGFnPWI7dGhpcy5jb250YWluZXJJbmZvPWE7dGhpcy5maW5pc2hlZFdvcms9dGhpcy5waW5nQ2FjaGU9dGhpcy5jdXJyZW50PXRoaXMucGVuZGluZ0NoaWxkcmVuPW51bGw7dGhpcy50aW1lb3V0SGFuZGxlPS0xO3RoaXMuY2FsbGJhY2tOb2RlPXRoaXMucGVuZGluZ0NvbnRleHQ9dGhpcy5jb250ZXh0PW51bGw7dGhpcy5jYWxsYmFja1ByaW9yaXR5PQowO3RoaXMuZXZlbnRUaW1lcz13ZSgwKTt0aGlzLmV4cGlyYXRpb25UaW1lcz13ZSgtMSk7dGhpcy5lbnRhbmdsZWRMYW5lcz10aGlzLmZpbmlzaGVkTGFuZXM9dGhpcy5tdXRhYmxlUmVhZExhbmVzPXRoaXMuZXhwaXJlZExhbmVzPXRoaXMucGluZ2VkTGFuZXM9dGhpcy5zdXNwZW5kZWRMYW5lcz10aGlzLnBlbmRpbmdMYW5lcz0wO3RoaXMuZW50YW5nbGVtZW50cz13ZSgwKTt0aGlzLmlkZW50aWZpZXJQcmVmaXg9ZDt0aGlzLm9uUmVjb3ZlcmFibGVFcnJvcj1lO3RoaXMubXV0YWJsZVNvdXJjZUVhZ2VySHlkcmF0aW9uRGF0YT1udWxsfWZ1bmN0aW9uIFZmKGEsYixjLGQsZSxmLGcsaCxrLGwpe2E9bmV3IFZrKGEsYixjLGgsayk7MT09PWI/KGI9MSwhMD09PWYmJihifD04KSk6Yj0wO2Y9cGEoMyxudWxsLG51bGwsYik7YS5jdXJyZW50PWY7Zi5zdGF0ZU5vZGU9YTtmLm1lbW9pemVkU3RhdGU9e2VsZW1lbnQ6ZCxpc0RlaHlkcmF0ZWQ6YyxjYWNoZTpudWxsLHRyYW5zaXRpb25zOm51bGwsCnBlbmRpbmdTdXNwZW5zZUJvdW5kYXJpZXM6bnVsbH07ZmYoZik7cmV0dXJuIGF9ZnVuY3Rpb24gV2soYSxiLGMpe3ZhciBkPTM8YXJndW1lbnRzLmxlbmd0aCYmdm9pZCAwIT09YXJndW1lbnRzWzNdP2FyZ3VtZW50c1szXTpudWxsO3JldHVybnskJHR5cGVvZjpDYixrZXk6bnVsbD09ZD9udWxsOiIiK2QsY2hpbGRyZW46YSxjb250YWluZXJJbmZvOmIsaW1wbGVtZW50YXRpb246Y319ZnVuY3Rpb24gVmkoYSl7aWYoIWEpcmV0dXJuIGNiO2E9YS5fcmVhY3RJbnRlcm5hbHM7YTp7aWYobmIoYSkhPT1hfHwxIT09YS50YWcpdGhyb3cgRXJyb3IobSgxNzApKTt2YXIgYj1hO2Rve3N3aXRjaChiLnRhZyl7Y2FzZSAzOmI9Yi5zdGF0ZU5vZGUuY29udGV4dDticmVhayBhO2Nhc2UgMTppZihlYShiLnR5cGUpKXtiPWIuc3RhdGVOb2RlLl9fcmVhY3RJbnRlcm5hbE1lbW9pemVkTWVyZ2VkQ2hpbGRDb250ZXh0O2JyZWFrIGF9fWI9Yi5yZXR1cm59d2hpbGUobnVsbCE9PWIpO3Rocm93IEVycm9yKG0oMTcxKSk7Cn1pZigxPT09YS50YWcpe3ZhciBjPWEudHlwZTtpZihlYShjKSlyZXR1cm4gdWgoYSxjLGIpfXJldHVybiBifWZ1bmN0aW9uIFdpKGEsYixjLGQsZSxmLGcsaCxrLGwpe2E9VmYoYyxkLCEwLGEsZSxmLGcsaCxrKTthLmNvbnRleHQ9VmkobnVsbCk7Yz1hLmN1cnJlbnQ7ZD1aKCk7ZT1oYihjKTtmPVBhKGQsZSk7Zi5jYWxsYmFjaz12b2lkIDAhPT1iJiZudWxsIT09Yj9iOm51bGw7ZmIoYyxmLGUpO2EuY3VycmVudC5sYW5lcz1lO2ljKGEsZSxkKTtpYShhLGQpO3JldHVybiBhfWZ1bmN0aW9uIFNkKGEsYixjLGQpe3ZhciBlPWIuY3VycmVudCxmPVooKSxnPWhiKGUpO2M9VmkoYyk7bnVsbD09PWIuY29udGV4dD9iLmNvbnRleHQ9YzpiLnBlbmRpbmdDb250ZXh0PWM7Yj1QYShmLGcpO2IucGF5bG9hZD17ZWxlbWVudDphfTtkPXZvaWQgMD09PWQ/bnVsbDpkO251bGwhPT1kJiYoYi5jYWxsYmFjaz1kKTthPWZiKGUsYixnKTtudWxsIT09YSYmKHhhKGEsZSxnLGYpLHZkKGEsZSxnKSk7cmV0dXJuIGd9CmZ1bmN0aW9uIFRkKGEpe2E9YS5jdXJyZW50O2lmKCFhLmNoaWxkKXJldHVybiBudWxsO3N3aXRjaChhLmNoaWxkLnRhZyl7Y2FzZSA1OnJldHVybiBhLmNoaWxkLnN0YXRlTm9kZTtkZWZhdWx0OnJldHVybiBhLmNoaWxkLnN0YXRlTm9kZX19ZnVuY3Rpb24gWGkoYSxiKXthPWEubWVtb2l6ZWRTdGF0ZTtpZihudWxsIT09YSYmbnVsbCE9PWEuZGVoeWRyYXRlZCl7dmFyIGM9YS5yZXRyeUxhbmU7YS5yZXRyeUxhbmU9MCE9PWMmJmM8Yj9jOmJ9fWZ1bmN0aW9uIFdmKGEsYil7WGkoYSxiKTsoYT1hLmFsdGVybmF0ZSkmJlhpKGEsYil9ZnVuY3Rpb24gWGsoYSl7YT1CZyhhKTtyZXR1cm4gbnVsbD09PWE/bnVsbDphLnN0YXRlTm9kZX1mdW5jdGlvbiBZayhhKXtyZXR1cm4gbnVsbH1mdW5jdGlvbiBYZihhKXt0aGlzLl9pbnRlcm5hbFJvb3Q9YX1mdW5jdGlvbiBVZChhKXt0aGlzLl9pbnRlcm5hbFJvb3Q9YX1mdW5jdGlvbiBZZihhKXtyZXR1cm4hKCFhfHwxIT09YS5ub2RlVHlwZSYmOSE9PQphLm5vZGVUeXBlJiYxMSE9PWEubm9kZVR5cGUpfWZ1bmN0aW9uIFZkKGEpe3JldHVybiEoIWF8fDEhPT1hLm5vZGVUeXBlJiY5IT09YS5ub2RlVHlwZSYmMTEhPT1hLm5vZGVUeXBlJiYoOCE9PWEubm9kZVR5cGV8fCIgcmVhY3QtbW91bnQtcG9pbnQtdW5zdGFibGUgIiE9PWEubm9kZVZhbHVlKSl9ZnVuY3Rpb24gWWkoKXt9ZnVuY3Rpb24gWmsoYSxiLGMsZCxlKXtpZihlKXtpZigiZnVuY3Rpb24iPT09dHlwZW9mIGQpe3ZhciBmPWQ7ZD1mdW5jdGlvbigpe3ZhciBhPVRkKGcpO2YuY2FsbChhKX19dmFyIGc9V2koYixkLGEsMCxudWxsLCExLCExLCIiLFlpKTthLl9yZWFjdFJvb3RDb250YWluZXI9ZzthW0phXT1nLmN1cnJlbnQ7c2MoOD09PWEubm9kZVR5cGU/YS5wYXJlbnROb2RlOmEpO3liKCk7cmV0dXJuIGd9Zm9yKDtlPWEubGFzdENoaWxkOylhLnJlbW92ZUNoaWxkKGUpO2lmKCJmdW5jdGlvbiI9PT10eXBlb2YgZCl7dmFyIGg9ZDtkPWZ1bmN0aW9uKCl7dmFyIGE9VGQoayk7CmguY2FsbChhKX19dmFyIGs9VmYoYSwwLCExLG51bGwsbnVsbCwhMSwhMSwiIixZaSk7YS5fcmVhY3RSb290Q29udGFpbmVyPWs7YVtKYV09ay5jdXJyZW50O3NjKDg9PT1hLm5vZGVUeXBlP2EucGFyZW50Tm9kZTphKTt5YihmdW5jdGlvbigpe1NkKGIsayxjLGQpfSk7cmV0dXJuIGt9ZnVuY3Rpb24gV2QoYSxiLGMsZCxlKXt2YXIgZj1jLl9yZWFjdFJvb3RDb250YWluZXI7aWYoZil7dmFyIGc9ZjtpZigiZnVuY3Rpb24iPT09dHlwZW9mIGUpe3ZhciBoPWU7ZT1mdW5jdGlvbigpe3ZhciBhPVRkKGcpO2guY2FsbChhKX19U2QoYixnLGEsZSl9ZWxzZSBnPVprKGMsYixhLGUsZCk7cmV0dXJuIFRkKGcpfXZhciBjZz1uZXcgU2V0LCRiPXt9LElhPSEoInVuZGVmaW5lZCI9PT10eXBlb2Ygd2luZG93fHwidW5kZWZpbmVkIj09PXR5cGVvZiB3aW5kb3cuZG9jdW1lbnR8fCJ1bmRlZmluZWQiPT09dHlwZW9mIHdpbmRvdy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KSxaZD1PYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LApjaj0vXls6QS1aX2Etelx1MDBDMC1cdTAwRDZcdTAwRDgtXHUwMEY2XHUwMEY4LVx1MDJGRlx1MDM3MC1cdTAzN0RcdTAzN0YtXHUxRkZGXHUyMDBDLVx1MjAwRFx1MjA3MC1cdTIxOEZcdTJDMDAtXHUyRkVGXHUzMDAxLVx1RDdGRlx1RjkwMC1cdUZEQ0ZcdUZERjAtXHVGRkZEXVs6QS1aX2Etelx1MDBDMC1cdTAwRDZcdTAwRDgtXHUwMEY2XHUwMEY4LVx1MDJGRlx1MDM3MC1cdTAzN0RcdTAzN0YtXHUxRkZGXHUyMDBDLVx1MjAwRFx1MjA3MC1cdTIxOEZcdTJDMDAtXHUyRkVGXHUzMDAxLVx1RDdGRlx1RjkwMC1cdUZEQ0ZcdUZERjAtXHVGRkZEXC0uMC05XHUwMEI3XHUwMzAwLVx1MDM2Rlx1MjAzRi1cdTIwNDBdKiQvLGVnPXt9LGRnPXt9LFI9e307ImNoaWxkcmVuIGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MIGRlZmF1bHRWYWx1ZSBkZWZhdWx0Q2hlY2tlZCBpbm5lckhUTUwgc3VwcHJlc3NDb250ZW50RWRpdGFibGVXYXJuaW5nIHN1cHByZXNzSHlkcmF0aW9uV2FybmluZyBzdHlsZSIuc3BsaXQoIiAiKS5mb3JFYWNoKGZ1bmN0aW9uKGEpe1JbYV09Cm5ldyBZKGEsMCwhMSxhLG51bGwsITEsITEpfSk7W1siYWNjZXB0Q2hhcnNldCIsImFjY2VwdC1jaGFyc2V0Il0sWyJjbGFzc05hbWUiLCJjbGFzcyJdLFsiaHRtbEZvciIsImZvciJdLFsiaHR0cEVxdWl2IiwiaHR0cC1lcXVpdiJdXS5mb3JFYWNoKGZ1bmN0aW9uKGEpe3ZhciBiPWFbMF07UltiXT1uZXcgWShiLDEsITEsYVsxXSxudWxsLCExLCExKX0pO1siY29udGVudEVkaXRhYmxlIiwiZHJhZ2dhYmxlIiwic3BlbGxDaGVjayIsInZhbHVlIl0uZm9yRWFjaChmdW5jdGlvbihhKXtSW2FdPW5ldyBZKGEsMiwhMSxhLnRvTG93ZXJDYXNlKCksbnVsbCwhMSwhMSl9KTtbImF1dG9SZXZlcnNlIiwiZXh0ZXJuYWxSZXNvdXJjZXNSZXF1aXJlZCIsImZvY3VzYWJsZSIsInByZXNlcnZlQWxwaGEiXS5mb3JFYWNoKGZ1bmN0aW9uKGEpe1JbYV09bmV3IFkoYSwyLCExLGEsbnVsbCwhMSwhMSl9KTsiYWxsb3dGdWxsU2NyZWVuIGFzeW5jIGF1dG9Gb2N1cyBhdXRvUGxheSBjb250cm9scyBkZWZhdWx0IGRlZmVyIGRpc2FibGVkIGRpc2FibGVQaWN0dXJlSW5QaWN0dXJlIGRpc2FibGVSZW1vdGVQbGF5YmFjayBmb3JtTm9WYWxpZGF0ZSBoaWRkZW4gbG9vcCBub01vZHVsZSBub1ZhbGlkYXRlIG9wZW4gcGxheXNJbmxpbmUgcmVhZE9ubHkgcmVxdWlyZWQgcmV2ZXJzZWQgc2NvcGVkIHNlYW1sZXNzIGl0ZW1TY29wZSIuc3BsaXQoIiAiKS5mb3JFYWNoKGZ1bmN0aW9uKGEpe1JbYV09Cm5ldyBZKGEsMywhMSxhLnRvTG93ZXJDYXNlKCksbnVsbCwhMSwhMSl9KTtbImNoZWNrZWQiLCJtdWx0aXBsZSIsIm11dGVkIiwic2VsZWN0ZWQiXS5mb3JFYWNoKGZ1bmN0aW9uKGEpe1JbYV09bmV3IFkoYSwzLCEwLGEsbnVsbCwhMSwhMSl9KTtbImNhcHR1cmUiLCJkb3dubG9hZCJdLmZvckVhY2goZnVuY3Rpb24oYSl7UlthXT1uZXcgWShhLDQsITEsYSxudWxsLCExLCExKX0pO1siY29scyIsInJvd3MiLCJzaXplIiwic3BhbiJdLmZvckVhY2goZnVuY3Rpb24oYSl7UlthXT1uZXcgWShhLDYsITEsYSxudWxsLCExLCExKX0pO1sicm93U3BhbiIsInN0YXJ0Il0uZm9yRWFjaChmdW5jdGlvbihhKXtSW2FdPW5ldyBZKGEsNSwhMSxhLnRvTG93ZXJDYXNlKCksbnVsbCwhMSwhMSl9KTt2YXIgWmY9L1tcLTpdKFthLXpdKS9nLCRmPWZ1bmN0aW9uKGEpe3JldHVybiBhWzFdLnRvVXBwZXJDYXNlKCl9OyJhY2NlbnQtaGVpZ2h0IGFsaWdubWVudC1iYXNlbGluZSBhcmFiaWMtZm9ybSBiYXNlbGluZS1zaGlmdCBjYXAtaGVpZ2h0IGNsaXAtcGF0aCBjbGlwLXJ1bGUgY29sb3ItaW50ZXJwb2xhdGlvbiBjb2xvci1pbnRlcnBvbGF0aW9uLWZpbHRlcnMgY29sb3ItcHJvZmlsZSBjb2xvci1yZW5kZXJpbmcgZG9taW5hbnQtYmFzZWxpbmUgZW5hYmxlLWJhY2tncm91bmQgZmlsbC1vcGFjaXR5IGZpbGwtcnVsZSBmbG9vZC1jb2xvciBmbG9vZC1vcGFjaXR5IGZvbnQtZmFtaWx5IGZvbnQtc2l6ZSBmb250LXNpemUtYWRqdXN0IGZvbnQtc3RyZXRjaCBmb250LXN0eWxlIGZvbnQtdmFyaWFudCBmb250LXdlaWdodCBnbHlwaC1uYW1lIGdseXBoLW9yaWVudGF0aW9uLWhvcml6b250YWwgZ2x5cGgtb3JpZW50YXRpb24tdmVydGljYWwgaG9yaXotYWR2LXggaG9yaXotb3JpZ2luLXggaW1hZ2UtcmVuZGVyaW5nIGxldHRlci1zcGFjaW5nIGxpZ2h0aW5nLWNvbG9yIG1hcmtlci1lbmQgbWFya2VyLW1pZCBtYXJrZXItc3RhcnQgb3ZlcmxpbmUtcG9zaXRpb24gb3ZlcmxpbmUtdGhpY2tuZXNzIHBhaW50LW9yZGVyIHBhbm9zZS0xIHBvaW50ZXItZXZlbnRzIHJlbmRlcmluZy1pbnRlbnQgc2hhcGUtcmVuZGVyaW5nIHN0b3AtY29sb3Igc3RvcC1vcGFjaXR5IHN0cmlrZXRocm91Z2gtcG9zaXRpb24gc3RyaWtldGhyb3VnaC10aGlja25lc3Mgc3Ryb2tlLWRhc2hhcnJheSBzdHJva2UtZGFzaG9mZnNldCBzdHJva2UtbGluZWNhcCBzdHJva2UtbGluZWpvaW4gc3Ryb2tlLW1pdGVybGltaXQgc3Ryb2tlLW9wYWNpdHkgc3Ryb2tlLXdpZHRoIHRleHQtYW5jaG9yIHRleHQtZGVjb3JhdGlvbiB0ZXh0LXJlbmRlcmluZyB1bmRlcmxpbmUtcG9zaXRpb24gdW5kZXJsaW5lLXRoaWNrbmVzcyB1bmljb2RlLWJpZGkgdW5pY29kZS1yYW5nZSB1bml0cy1wZXItZW0gdi1hbHBoYWJldGljIHYtaGFuZ2luZyB2LWlkZW9ncmFwaGljIHYtbWF0aGVtYXRpY2FsIHZlY3Rvci1lZmZlY3QgdmVydC1hZHYteSB2ZXJ0LW9yaWdpbi14IHZlcnQtb3JpZ2luLXkgd29yZC1zcGFjaW5nIHdyaXRpbmctbW9kZSB4bWxuczp4bGluayB4LWhlaWdodCIuc3BsaXQoIiAiKS5mb3JFYWNoKGZ1bmN0aW9uKGEpe3ZhciBiPQphLnJlcGxhY2UoWmYsJGYpO1JbYl09bmV3IFkoYiwxLCExLGEsbnVsbCwhMSwhMSl9KTsieGxpbms6YWN0dWF0ZSB4bGluazphcmNyb2xlIHhsaW5rOnJvbGUgeGxpbms6c2hvdyB4bGluazp0aXRsZSB4bGluazp0eXBlIi5zcGxpdCgiICIpLmZvckVhY2goZnVuY3Rpb24oYSl7dmFyIGI9YS5yZXBsYWNlKFpmLCRmKTtSW2JdPW5ldyBZKGIsMSwhMSxhLCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiwhMSwhMSl9KTtbInhtbDpiYXNlIiwieG1sOmxhbmciLCJ4bWw6c3BhY2UiXS5mb3JFYWNoKGZ1bmN0aW9uKGEpe3ZhciBiPWEucmVwbGFjZShaZiwkZik7UltiXT1uZXcgWShiLDEsITEsYSwiaHR0cDovL3d3dy53My5vcmcvWE1MLzE5OTgvbmFtZXNwYWNlIiwhMSwhMSl9KTtbInRhYkluZGV4IiwiY3Jvc3NPcmlnaW4iXS5mb3JFYWNoKGZ1bmN0aW9uKGEpe1JbYV09bmV3IFkoYSwxLCExLGEudG9Mb3dlckNhc2UoKSxudWxsLCExLCExKX0pO1IueGxpbmtIcmVmPW5ldyBZKCJ4bGlua0hyZWYiLAoxLCExLCJ4bGluazpocmVmIiwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIsITAsITEpO1sic3JjIiwiaHJlZiIsImFjdGlvbiIsImZvcm1BY3Rpb24iXS5mb3JFYWNoKGZ1bmN0aW9uKGEpe1JbYV09bmV3IFkoYSwxLCExLGEudG9Mb3dlckNhc2UoKSxudWxsLCEwLCEwKX0pO3ZhciBTYT16Yi5fX1NFQ1JFVF9JTlRFUk5BTFNfRE9fTk9UX1VTRV9PUl9ZT1VfV0lMTF9CRV9GSVJFRCxzZD1TeW1ib2wuZm9yKCJyZWFjdC5lbGVtZW50IiksQ2I9U3ltYm9sLmZvcigicmVhY3QucG9ydGFsIiksQmI9U3ltYm9sLmZvcigicmVhY3QuZnJhZ21lbnQiKSxmZT1TeW1ib2wuZm9yKCJyZWFjdC5zdHJpY3RfbW9kZSIpLGVlPVN5bWJvbC5mb3IoInJlYWN0LnByb2ZpbGVyIiksaGc9U3ltYm9sLmZvcigicmVhY3QucHJvdmlkZXIiKSxnZz1TeW1ib2wuZm9yKCJyZWFjdC5jb250ZXh0IiksaWU9U3ltYm9sLmZvcigicmVhY3QuZm9yd2FyZF9yZWYiKSxnZT1TeW1ib2wuZm9yKCJyZWFjdC5zdXNwZW5zZSIpLApoZT1TeW1ib2wuZm9yKCJyZWFjdC5zdXNwZW5zZV9saXN0IiksamU9U3ltYm9sLmZvcigicmVhY3QubWVtbyIpLFRhPVN5bWJvbC5mb3IoInJlYWN0LmxhenkiKTtTeW1ib2wuZm9yKCJyZWFjdC5zY29wZSIpO1N5bWJvbC5mb3IoInJlYWN0LmRlYnVnX3RyYWNlX21vZGUiKTt2YXIgVWk9U3ltYm9sLmZvcigicmVhY3Qub2Zmc2NyZWVuIik7U3ltYm9sLmZvcigicmVhY3QubGVnYWN5X2hpZGRlbiIpO1N5bWJvbC5mb3IoInJlYWN0LmNhY2hlIik7U3ltYm9sLmZvcigicmVhY3QudHJhY2luZ19tYXJrZXIiKTt2YXIgZmc9U3ltYm9sLml0ZXJhdG9yLEU9T2JqZWN0LmFzc2lnbixhZSxjZT0hMSxjYz1BcnJheS5pc0FycmF5LFhkLHlpPWZ1bmN0aW9uKGEpe3JldHVybiJ1bmRlZmluZWQiIT09dHlwZW9mIE1TQXBwJiZNU0FwcC5leGVjVW5zYWZlTG9jYWxGdW5jdGlvbj9mdW5jdGlvbihiLGMsZCxlKXtNU0FwcC5leGVjVW5zYWZlTG9jYWxGdW5jdGlvbihmdW5jdGlvbigpe3JldHVybiBhKGIsCmMsZCxlKX0pfTphfShmdW5jdGlvbihhLGIpe2lmKCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIhPT1hLm5hbWVzcGFjZVVSSXx8ImlubmVySFRNTCJpbiBhKWEuaW5uZXJIVE1MPWI7ZWxzZXtYZD1YZHx8ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7WGQuaW5uZXJIVE1MPSI8c3ZnPiIrYi52YWx1ZU9mKCkudG9TdHJpbmcoKSsiPC9zdmc+Ijtmb3IoYj1YZC5maXJzdENoaWxkO2EuZmlyc3RDaGlsZDspYS5yZW1vdmVDaGlsZChhLmZpcnN0Q2hpbGQpO2Zvcig7Yi5maXJzdENoaWxkOylhLmFwcGVuZENoaWxkKGIuZmlyc3RDaGlsZCl9fSksRmM9ZnVuY3Rpb24oYSxiKXtpZihiKXt2YXIgYz1hLmZpcnN0Q2hpbGQ7aWYoYyYmYz09PWEubGFzdENoaWxkJiYzPT09Yy5ub2RlVHlwZSl7Yy5ub2RlVmFsdWU9YjtyZXR1cm59fWEudGV4dENvbnRlbnQ9Yn0sZGM9e2FuaW1hdGlvbkl0ZXJhdGlvbkNvdW50OiEwLGFzcGVjdFJhdGlvOiEwLGJvcmRlckltYWdlT3V0c2V0OiEwLApib3JkZXJJbWFnZVNsaWNlOiEwLGJvcmRlckltYWdlV2lkdGg6ITAsYm94RmxleDohMCxib3hGbGV4R3JvdXA6ITAsYm94T3JkaW5hbEdyb3VwOiEwLGNvbHVtbkNvdW50OiEwLGNvbHVtbnM6ITAsZmxleDohMCxmbGV4R3JvdzohMCxmbGV4UG9zaXRpdmU6ITAsZmxleFNocmluazohMCxmbGV4TmVnYXRpdmU6ITAsZmxleE9yZGVyOiEwLGdyaWRBcmVhOiEwLGdyaWRSb3c6ITAsZ3JpZFJvd0VuZDohMCxncmlkUm93U3BhbjohMCxncmlkUm93U3RhcnQ6ITAsZ3JpZENvbHVtbjohMCxncmlkQ29sdW1uRW5kOiEwLGdyaWRDb2x1bW5TcGFuOiEwLGdyaWRDb2x1bW5TdGFydDohMCxmb250V2VpZ2h0OiEwLGxpbmVDbGFtcDohMCxsaW5lSGVpZ2h0OiEwLG9wYWNpdHk6ITAsb3JkZXI6ITAsb3JwaGFuczohMCx0YWJTaXplOiEwLHdpZG93czohMCx6SW5kZXg6ITAsem9vbTohMCxmaWxsT3BhY2l0eTohMCxmbG9vZE9wYWNpdHk6ITAsc3RvcE9wYWNpdHk6ITAsc3Ryb2tlRGFzaGFycmF5OiEwLApzdHJva2VEYXNob2Zmc2V0OiEwLHN0cm9rZU1pdGVybGltaXQ6ITAsc3Ryb2tlT3BhY2l0eTohMCxzdHJva2VXaWR0aDohMH0sJGs9WyJXZWJraXQiLCJtcyIsIk1veiIsIk8iXTtPYmplY3Qua2V5cyhkYykuZm9yRWFjaChmdW5jdGlvbihhKXskay5mb3JFYWNoKGZ1bmN0aW9uKGIpe2I9YithLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpK2Euc3Vic3RyaW5nKDEpO2RjW2JdPWRjW2FdfSl9KTt2YXIgaWo9RSh7bWVudWl0ZW06ITB9LHthcmVhOiEwLGJhc2U6ITAsYnI6ITAsY29sOiEwLGVtYmVkOiEwLGhyOiEwLGltZzohMCxpbnB1dDohMCxrZXlnZW46ITAsbGluazohMCxtZXRhOiEwLHBhcmFtOiEwLHNvdXJjZTohMCx0cmFjazohMCx3YnI6ITB9KSx6ZT1udWxsLHNlPW51bGwsRWI9bnVsbCxGYj1udWxsLHhnPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGEoYil9LHlnPWZ1bmN0aW9uKCl7fSx0ZT0hMSxPZT0hMTtpZihJYSl0cnl7dmFyIExjPXt9O09iamVjdC5kZWZpbmVQcm9wZXJ0eShMYywKInBhc3NpdmUiLHtnZXQ6ZnVuY3Rpb24oKXtPZT0hMH19KTt3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigidGVzdCIsTGMsTGMpO3dpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCJ0ZXN0IixMYyxMYyl9Y2F0Y2goYSl7T2U9ITF9dmFyIGtqPWZ1bmN0aW9uKGEsYixjLGQsZSxmLGcsaCxrKXt2YXIgbD1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMyk7dHJ5e2IuYXBwbHkoYyxsKX1jYXRjaChxKXt0aGlzLm9uRXJyb3IocSl9fSxnYz0hMSxTYz1udWxsLFRjPSExLHVlPW51bGwsbGo9e29uRXJyb3I6ZnVuY3Rpb24oYSl7Z2M9ITA7U2M9YX19LEJhPXpiLl9fU0VDUkVUX0lOVEVSTkFMU19ET19OT1RfVVNFX09SX1lPVV9XSUxMX0JFX0ZJUkVELlNjaGVkdWxlcixKZz1CYS51bnN0YWJsZV9zY2hlZHVsZUNhbGxiYWNrLEtnPUJhLnVuc3RhYmxlX05vcm1hbFByaW9yaXR5LHhoPUpnLEtpPUJhLnVuc3RhYmxlX2NhbmNlbENhbGxiYWNrLFBrPUJhLnVuc3RhYmxlX3Nob3VsZFlpZWxkLApTaz1CYS51bnN0YWJsZV9yZXF1ZXN0UGFpbnQsUD1CYS51bnN0YWJsZV9ub3csRGo9QmEudW5zdGFibGVfZ2V0Q3VycmVudFByaW9yaXR5TGV2ZWwsRGU9QmEudW5zdGFibGVfSW1tZWRpYXRlUHJpb3JpdHksTWc9QmEudW5zdGFibGVfVXNlckJsb2NraW5nUHJpb3JpdHksYWQ9S2csRWo9QmEudW5zdGFibGVfTG93UHJpb3JpdHksTmc9QmEudW5zdGFibGVfSWRsZVByaW9yaXR5LFVjPW51bGwsQ2E9bnVsbCx0YT1NYXRoLmNsejMyP01hdGguY2x6MzI6cGoscWo9TWF0aC5sb2cscmo9TWF0aC5MTjIsV2M9NjQsUmQ9NDE5NDMwNCx6PTAsQWU9ITEsWWM9W10sVmE9bnVsbCxXYT1udWxsLFhhPW51bGwsamM9bmV3IE1hcCxrYz1uZXcgTWFwLFlhPVtdLEJqPSJtb3VzZWRvd24gbW91c2V1cCB0b3VjaGNhbmNlbCB0b3VjaGVuZCB0b3VjaHN0YXJ0IGF1eGNsaWNrIGRibGNsaWNrIHBvaW50ZXJjYW5jZWwgcG9pbnRlcmRvd24gcG9pbnRlcnVwIGRyYWdlbmQgZHJhZ3N0YXJ0IGRyb3AgY29tcG9zaXRpb25lbmQgY29tcG9zaXRpb25zdGFydCBrZXlkb3duIGtleXByZXNzIGtleXVwIGlucHV0IHRleHRJbnB1dCBjb3B5IGN1dCBwYXN0ZSBjbGljayBjaGFuZ2UgY29udGV4dG1lbnUgcmVzZXQgc3VibWl0Ii5zcGxpdCgiICIpLApHYj1TYS5SZWFjdEN1cnJlbnRCYXRjaENvbmZpZyxaYz0hMCwkYz1udWxsLFphPW51bGwsRWU9bnVsbCxiZD1udWxsLFliPXtldmVudFBoYXNlOjAsYnViYmxlczowLGNhbmNlbGFibGU6MCx0aW1lU3RhbXA6ZnVuY3Rpb24oYSl7cmV0dXJuIGEudGltZVN0YW1wfHxEYXRlLm5vdygpfSxkZWZhdWx0UHJldmVudGVkOjAsaXNUcnVzdGVkOjB9LEhlPWthKFliKSxNYz1FKHt9LFliLHt2aWV3OjAsZGV0YWlsOjB9KSxhaz1rYShNYyksYWcsYmcsTmMsWWQ9RSh7fSxNYyx7c2NyZWVuWDowLHNjcmVlblk6MCxjbGllbnRYOjAsY2xpZW50WTowLHBhZ2VYOjAscGFnZVk6MCxjdHJsS2V5OjAsc2hpZnRLZXk6MCxhbHRLZXk6MCxtZXRhS2V5OjAsZ2V0TW9kaWZpZXJTdGF0ZTpGZSxidXR0b246MCxidXR0b25zOjAscmVsYXRlZFRhcmdldDpmdW5jdGlvbihhKXtyZXR1cm4gdm9pZCAwPT09YS5yZWxhdGVkVGFyZ2V0P2EuZnJvbUVsZW1lbnQ9PT1hLnNyY0VsZW1lbnQ/YS50b0VsZW1lbnQ6YS5mcm9tRWxlbWVudDoKYS5yZWxhdGVkVGFyZ2V0fSxtb3ZlbWVudFg6ZnVuY3Rpb24oYSl7aWYoIm1vdmVtZW50WCJpbiBhKXJldHVybiBhLm1vdmVtZW50WDthIT09TmMmJihOYyYmIm1vdXNlbW92ZSI9PT1hLnR5cGU/KGFnPWEuc2NyZWVuWC1OYy5zY3JlZW5YLGJnPWEuc2NyZWVuWS1OYy5zY3JlZW5ZKTpiZz1hZz0wLE5jPWEpO3JldHVybiBhZ30sbW92ZW1lbnRZOmZ1bmN0aW9uKGEpe3JldHVybiJtb3ZlbWVudFkiaW4gYT9hLm1vdmVtZW50WTpiZ319KSxpaD1rYShZZCksYWw9RSh7fSxZZCx7ZGF0YVRyYW5zZmVyOjB9KSxXaj1rYShhbCksYmw9RSh7fSxNYyx7cmVsYXRlZFRhcmdldDowfSksUGU9a2EoYmwpLGNsPUUoe30sWWIse2FuaW1hdGlvbk5hbWU6MCxlbGFwc2VkVGltZTowLHBzZXVkb0VsZW1lbnQ6MH0pLFlqPWthKGNsKSxkbD1FKHt9LFliLHtjbGlwYm9hcmREYXRhOmZ1bmN0aW9uKGEpe3JldHVybiJjbGlwYm9hcmREYXRhImluIGE/YS5jbGlwYm9hcmREYXRhOndpbmRvdy5jbGlwYm9hcmREYXRhfX0pLApjaz1rYShkbCksZWw9RSh7fSxZYix7ZGF0YTowfSkscWg9a2EoZWwpLGZrPXFoLGZsPXtFc2M6IkVzY2FwZSIsU3BhY2ViYXI6IiAiLExlZnQ6IkFycm93TGVmdCIsVXA6IkFycm93VXAiLFJpZ2h0OiJBcnJvd1JpZ2h0IixEb3duOiJBcnJvd0Rvd24iLERlbDoiRGVsZXRlIixXaW46Ik9TIixNZW51OiJDb250ZXh0TWVudSIsQXBwczoiQ29udGV4dE1lbnUiLFNjcm9sbDoiU2Nyb2xsTG9jayIsTW96UHJpbnRhYmxlS2V5OiJVbmlkZW50aWZpZWQifSxnbD17ODoiQmFja3NwYWNlIiw5OiJUYWIiLDEyOiJDbGVhciIsMTM6IkVudGVyIiwxNjoiU2hpZnQiLDE3OiJDb250cm9sIiwxODoiQWx0IiwxOToiUGF1c2UiLDIwOiJDYXBzTG9jayIsMjc6IkVzY2FwZSIsMzI6IiAiLDMzOiJQYWdlVXAiLDM0OiJQYWdlRG93biIsMzU6IkVuZCIsMzY6IkhvbWUiLDM3OiJBcnJvd0xlZnQiLDM4OiJBcnJvd1VwIiwzOToiQXJyb3dSaWdodCIsNDA6IkFycm93RG93biIsNDU6Ikluc2VydCIsNDY6IkRlbGV0ZSIsCjExMjoiRjEiLDExMzoiRjIiLDExNDoiRjMiLDExNToiRjQiLDExNjoiRjUiLDExNzoiRjYiLDExODoiRjciLDExOToiRjgiLDEyMDoiRjkiLDEyMToiRjEwIiwxMjI6IkYxMSIsMTIzOiJGMTIiLDE0NDoiTnVtTG9jayIsMTQ1OiJTY3JvbGxMb2NrIiwyMjQ6Ik1ldGEifSxHaj17QWx0OiJhbHRLZXkiLENvbnRyb2w6ImN0cmxLZXkiLE1ldGE6Im1ldGFLZXkiLFNoaWZ0OiJzaGlmdEtleSJ9LGhsPUUoe30sTWMse2tleTpmdW5jdGlvbihhKXtpZihhLmtleSl7dmFyIGI9ZmxbYS5rZXldfHxhLmtleTtpZigiVW5pZGVudGlmaWVkIiE9PWIpcmV0dXJuIGJ9cmV0dXJuImtleXByZXNzIj09PWEudHlwZT8oYT1jZChhKSwxMz09PWE/IkVudGVyIjpTdHJpbmcuZnJvbUNoYXJDb2RlKGEpKToia2V5ZG93biI9PT1hLnR5cGV8fCJrZXl1cCI9PT1hLnR5cGU/Z2xbYS5rZXlDb2RlXXx8IlVuaWRlbnRpZmllZCI6IiJ9LGNvZGU6MCxsb2NhdGlvbjowLGN0cmxLZXk6MCxzaGlmdEtleTowLGFsdEtleTowLAptZXRhS2V5OjAscmVwZWF0OjAsbG9jYWxlOjAsZ2V0TW9kaWZpZXJTdGF0ZTpGZSxjaGFyQ29kZTpmdW5jdGlvbihhKXtyZXR1cm4ia2V5cHJlc3MiPT09YS50eXBlP2NkKGEpOjB9LGtleUNvZGU6ZnVuY3Rpb24oYSl7cmV0dXJuImtleWRvd24iPT09YS50eXBlfHwia2V5dXAiPT09YS50eXBlP2Eua2V5Q29kZTowfSx3aGljaDpmdW5jdGlvbihhKXtyZXR1cm4ia2V5cHJlc3MiPT09YS50eXBlP2NkKGEpOiJrZXlkb3duIj09PWEudHlwZXx8ImtleXVwIj09PWEudHlwZT9hLmtleUNvZGU6MH19KSxWaj1rYShobCksaWw9RSh7fSxZZCx7cG9pbnRlcklkOjAsd2lkdGg6MCxoZWlnaHQ6MCxwcmVzc3VyZTowLHRhbmdlbnRpYWxQcmVzc3VyZTowLHRpbHRYOjAsdGlsdFk6MCx0d2lzdDowLHBvaW50ZXJUeXBlOjAsaXNQcmltYXJ5OjB9KSxuaD1rYShpbCksamw9RSh7fSxNYyx7dG91Y2hlczowLHRhcmdldFRvdWNoZXM6MCxjaGFuZ2VkVG91Y2hlczowLGFsdEtleTowLG1ldGFLZXk6MCwKY3RybEtleTowLHNoaWZ0S2V5OjAsZ2V0TW9kaWZpZXJTdGF0ZTpGZX0pLFhqPWthKGpsKSxrbD1FKHt9LFliLHtwcm9wZXJ0eU5hbWU6MCxlbGFwc2VkVGltZTowLHBzZXVkb0VsZW1lbnQ6MH0pLFpqPWthKGtsKSxsbD1FKHt9LFlkLHtkZWx0YVg6ZnVuY3Rpb24oYSl7cmV0dXJuImRlbHRhWCJpbiBhP2EuZGVsdGFYOiJ3aGVlbERlbHRhWCJpbiBhPy1hLndoZWVsRGVsdGFYOjB9LGRlbHRhWTpmdW5jdGlvbihhKXtyZXR1cm4iZGVsdGFZImluIGE/YS5kZWx0YVk6IndoZWVsRGVsdGFZImluIGE/LWEud2hlZWxEZWx0YVk6IndoZWVsRGVsdGEiaW4gYT8tYS53aGVlbERlbHRhOjB9LGRlbHRhWjowLGRlbHRhTW9kZTowfSksYms9a2EobGwpLEhqPVs5LDEzLDI3LDMyXSxHZT1JYSYmIkNvbXBvc2l0aW9uRXZlbnQiaW4gd2luZG93LE9jPW51bGw7SWEmJiJkb2N1bWVudE1vZGUiaW4gZG9jdW1lbnQmJihPYz1kb2N1bWVudC5kb2N1bWVudE1vZGUpO3ZhciBlaz1JYSYmIlRleHRFdmVudCJpbgp3aW5kb3cmJiFPYyxVZz1JYSYmKCFHZXx8T2MmJjg8T2MmJjExPj1PYyksVGc9U3RyaW5nLmZyb21DaGFyQ29kZSgzMiksU2c9ITEsSGI9ITEsS2o9e2NvbG9yOiEwLGRhdGU6ITAsZGF0ZXRpbWU6ITAsImRhdGV0aW1lLWxvY2FsIjohMCxlbWFpbDohMCxtb250aDohMCxudW1iZXI6ITAscGFzc3dvcmQ6ITAscmFuZ2U6ITAsc2VhcmNoOiEwLHRlbDohMCx0ZXh0OiEwLHRpbWU6ITAsdXJsOiEwLHdlZWs6ITB9LG9jPW51bGwscGM9bnVsbCxwaD0hMTtJYSYmKHBoPUxqKCJpbnB1dCIpJiYoIWRvY3VtZW50LmRvY3VtZW50TW9kZXx8OTxkb2N1bWVudC5kb2N1bWVudE1vZGUpKTt2YXIgdWE9ImZ1bmN0aW9uIj09PXR5cGVvZiBPYmplY3QuaXM/T2JqZWN0LmlzOlNqLGRrPUlhJiYiZG9jdW1lbnRNb2RlImluIGRvY3VtZW50JiYxMT49ZG9jdW1lbnQuZG9jdW1lbnRNb2RlLEpiPW51bGwsS2U9bnVsbCxyYz1udWxsLEplPSExLEtiPXthbmltYXRpb25lbmQ6Z2QoIkFuaW1hdGlvbiIsIkFuaW1hdGlvbkVuZCIpLAphbmltYXRpb25pdGVyYXRpb246Z2QoIkFuaW1hdGlvbiIsIkFuaW1hdGlvbkl0ZXJhdGlvbiIpLGFuaW1hdGlvbnN0YXJ0OmdkKCJBbmltYXRpb24iLCJBbmltYXRpb25TdGFydCIpLHRyYW5zaXRpb25lbmQ6Z2QoIlRyYW5zaXRpb24iLCJUcmFuc2l0aW9uRW5kIil9LExlPXt9LGVoPXt9O0lhJiYoZWg9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iikuc3R5bGUsIkFuaW1hdGlvbkV2ZW50ImluIHdpbmRvd3x8KGRlbGV0ZSBLYi5hbmltYXRpb25lbmQuYW5pbWF0aW9uLGRlbGV0ZSBLYi5hbmltYXRpb25pdGVyYXRpb24uYW5pbWF0aW9uLGRlbGV0ZSBLYi5hbmltYXRpb25zdGFydC5hbmltYXRpb24pLCJUcmFuc2l0aW9uRXZlbnQiaW4gd2luZG93fHxkZWxldGUgS2IudHJhbnNpdGlvbmVuZC50cmFuc2l0aW9uKTt2YXIgamg9aGQoImFuaW1hdGlvbmVuZCIpLGtoPWhkKCJhbmltYXRpb25pdGVyYXRpb24iKSxsaD1oZCgiYW5pbWF0aW9uc3RhcnQiKSxtaD1oZCgidHJhbnNpdGlvbmVuZCIpLApmaD1uZXcgTWFwLFppPSJhYm9ydCBhdXhDbGljayBjYW5jZWwgY2FuUGxheSBjYW5QbGF5VGhyb3VnaCBjbGljayBjbG9zZSBjb250ZXh0TWVudSBjb3B5IGN1dCBkcmFnIGRyYWdFbmQgZHJhZ0VudGVyIGRyYWdFeGl0IGRyYWdMZWF2ZSBkcmFnT3ZlciBkcmFnU3RhcnQgZHJvcCBkdXJhdGlvbkNoYW5nZSBlbXB0aWVkIGVuY3J5cHRlZCBlbmRlZCBlcnJvciBnb3RQb2ludGVyQ2FwdHVyZSBpbnB1dCBpbnZhbGlkIGtleURvd24ga2V5UHJlc3Mga2V5VXAgbG9hZCBsb2FkZWREYXRhIGxvYWRlZE1ldGFkYXRhIGxvYWRTdGFydCBsb3N0UG9pbnRlckNhcHR1cmUgbW91c2VEb3duIG1vdXNlTW92ZSBtb3VzZU91dCBtb3VzZU92ZXIgbW91c2VVcCBwYXN0ZSBwYXVzZSBwbGF5IHBsYXlpbmcgcG9pbnRlckNhbmNlbCBwb2ludGVyRG93biBwb2ludGVyTW92ZSBwb2ludGVyT3V0IHBvaW50ZXJPdmVyIHBvaW50ZXJVcCBwcm9ncmVzcyByYXRlQ2hhbmdlIHJlc2V0IHJlc2l6ZSBzZWVrZWQgc2Vla2luZyBzdGFsbGVkIHN1Ym1pdCBzdXNwZW5kIHRpbWVVcGRhdGUgdG91Y2hDYW5jZWwgdG91Y2hFbmQgdG91Y2hTdGFydCB2b2x1bWVDaGFuZ2Ugc2Nyb2xsIHRvZ2dsZSB0b3VjaE1vdmUgd2FpdGluZyB3aGVlbCIuc3BsaXQoIiAiKTsKKGZ1bmN0aW9uKCl7Zm9yKHZhciBhPTA7YTxaaS5sZW5ndGg7YSsrKXt2YXIgYj1aaVthXSxjPWIudG9Mb3dlckNhc2UoKTtiPWJbMF0udG9VcHBlckNhc2UoKStiLnNsaWNlKDEpOyRhKGMsIm9uIitiKX0kYShqaCwib25BbmltYXRpb25FbmQiKTskYShraCwib25BbmltYXRpb25JdGVyYXRpb24iKTskYShsaCwib25BbmltYXRpb25TdGFydCIpOyRhKCJkYmxjbGljayIsIm9uRG91YmxlQ2xpY2siKTskYSgiZm9jdXNpbiIsIm9uRm9jdXMiKTskYSgiZm9jdXNvdXQiLCJvbkJsdXIiKTskYShtaCwib25UcmFuc2l0aW9uRW5kIil9KSgpO0FiKCJvbk1vdXNlRW50ZXIiLFsibW91c2VvdXQiLCJtb3VzZW92ZXIiXSk7QWIoIm9uTW91c2VMZWF2ZSIsWyJtb3VzZW91dCIsIm1vdXNlb3ZlciJdKTtBYigib25Qb2ludGVyRW50ZXIiLFsicG9pbnRlcm91dCIsInBvaW50ZXJvdmVyIl0pO0FiKCJvblBvaW50ZXJMZWF2ZSIsWyJwb2ludGVyb3V0IiwicG9pbnRlcm92ZXIiXSk7bWIoIm9uQ2hhbmdlIiwKImNoYW5nZSBjbGljayBmb2N1c2luIGZvY3Vzb3V0IGlucHV0IGtleWRvd24ga2V5dXAgc2VsZWN0aW9uY2hhbmdlIi5zcGxpdCgiICIpKTttYigib25TZWxlY3QiLCJmb2N1c291dCBjb250ZXh0bWVudSBkcmFnZW5kIGZvY3VzaW4ga2V5ZG93biBrZXl1cCBtb3VzZWRvd24gbW91c2V1cCBzZWxlY3Rpb25jaGFuZ2UiLnNwbGl0KCIgIikpO21iKCJvbkJlZm9yZUlucHV0IixbImNvbXBvc2l0aW9uZW5kIiwia2V5cHJlc3MiLCJ0ZXh0SW5wdXQiLCJwYXN0ZSJdKTttYigib25Db21wb3NpdGlvbkVuZCIsImNvbXBvc2l0aW9uZW5kIGZvY3Vzb3V0IGtleWRvd24ga2V5cHJlc3Mga2V5dXAgbW91c2Vkb3duIi5zcGxpdCgiICIpKTttYigib25Db21wb3NpdGlvblN0YXJ0IiwiY29tcG9zaXRpb25zdGFydCBmb2N1c291dCBrZXlkb3duIGtleXByZXNzIGtleXVwIG1vdXNlZG93biIuc3BsaXQoIiAiKSk7bWIoIm9uQ29tcG9zaXRpb25VcGRhdGUiLCJjb21wb3NpdGlvbnVwZGF0ZSBmb2N1c291dCBrZXlkb3duIGtleXByZXNzIGtleXVwIG1vdXNlZG93biIuc3BsaXQoIiAiKSk7CnZhciBFYz0iYWJvcnQgY2FucGxheSBjYW5wbGF5dGhyb3VnaCBkdXJhdGlvbmNoYW5nZSBlbXB0aWVkIGVuY3J5cHRlZCBlbmRlZCBlcnJvciBsb2FkZWRkYXRhIGxvYWRlZG1ldGFkYXRhIGxvYWRzdGFydCBwYXVzZSBwbGF5IHBsYXlpbmcgcHJvZ3Jlc3MgcmF0ZWNoYW5nZSByZXNpemUgc2Vla2VkIHNlZWtpbmcgc3RhbGxlZCBzdXNwZW5kIHRpbWV1cGRhdGUgdm9sdW1lY2hhbmdlIHdhaXRpbmciLnNwbGl0KCIgIiksVWo9bmV3IFNldCgiY2FuY2VsIGNsb3NlIGludmFsaWQgbG9hZCBzY3JvbGwgdG9nZ2xlIi5zcGxpdCgiICIpLmNvbmNhdChFYykpLGlkPSJfcmVhY3RMaXN0ZW5pbmciK01hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnNsaWNlKDIpLGdrPS9cclxuPy9nLGhrPS9cdTAwMDB8XHVGRkZEL2csSmY9bnVsbCxLZj1udWxsLFJmPSJmdW5jdGlvbiI9PT10eXBlb2Ygc2V0VGltZW91dD9zZXRUaW1lb3V0OnZvaWQgMCxOaz0iZnVuY3Rpb24iPT09dHlwZW9mIGNsZWFyVGltZW91dD8KY2xlYXJUaW1lb3V0OnZvaWQgMCwkaT0iZnVuY3Rpb24iPT09dHlwZW9mIFByb21pc2U/UHJvbWlzZTp2b2lkIDAsSms9ImZ1bmN0aW9uIj09PXR5cGVvZiBxdWV1ZU1pY3JvdGFzaz9xdWV1ZU1pY3JvdGFzazoidW5kZWZpbmVkIiE9PXR5cGVvZiAkaT9mdW5jdGlvbihhKXtyZXR1cm4gJGkucmVzb2x2ZShudWxsKS50aGVuKGEpLmNhdGNoKGlrKX06UmYsWmI9TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc2xpY2UoMiksRGE9Il9fcmVhY3RGaWJlciQiK1piLHVjPSJfX3JlYWN0UHJvcHMkIitaYixKYT0iX19yZWFjdENvbnRhaW5lciQiK1piLE1lPSJfX3JlYWN0RXZlbnRzJCIrWmIsRGs9Il9fcmVhY3RMaXN0ZW5lcnMkIitaYixFaz0iX19yZWFjdEhhbmRsZXMkIitaYixTZT1bXSxNYj0tMSxjYj17fSxKPWJiKGNiKSxTPWJiKCExKSxwYj1jYixMYT1udWxsLG1kPSExLFRlPSExLE9iPVtdLFBiPTAsb2Q9bnVsbCxuZD0wLG5hPVtdLG9hPTAscmI9bnVsbCxNYT0xLE5hPSIiLGxhPQpudWxsLGZhPW51bGwsRD0hMSx3YT1udWxsLElrPVNhLlJlYWN0Q3VycmVudEJhdGNoQ29uZmlnLFZiPURoKCEwKSxsaT1EaCghMSksdWQ9YmIobnVsbCksdGQ9bnVsbCxSYj1udWxsLGJmPW51bGwsdGI9bnVsbCxraz1PYSxnYj0hMSx3Yz17fSxFYT1iYih3YykseWM9YmIod2MpLHhjPWJiKHdjKSxGPWJiKDApLGtmPVtdLHlkPVNhLlJlYWN0Q3VycmVudERpc3BhdGNoZXIsc2Y9U2EuUmVhY3RDdXJyZW50QmF0Y2hDb25maWcsdmI9MCxDPW51bGwsSz1udWxsLE49bnVsbCxBZD0hMSx6Yz0hMSxBYz0wLG1sPTAsemQ9e3JlYWRDb250ZXh0OnFhLHVzZUNhbGxiYWNrOlYsdXNlQ29udGV4dDpWLHVzZUVmZmVjdDpWLHVzZUltcGVyYXRpdmVIYW5kbGU6Vix1c2VJbnNlcnRpb25FZmZlY3Q6Vix1c2VMYXlvdXRFZmZlY3Q6Vix1c2VNZW1vOlYsdXNlUmVkdWNlcjpWLHVzZVJlZjpWLHVzZVN0YXRlOlYsdXNlRGVidWdWYWx1ZTpWLHVzZURlZmVycmVkVmFsdWU6Vix1c2VUcmFuc2l0aW9uOlYsCnVzZU11dGFibGVTb3VyY2U6Vix1c2VTeW5jRXh0ZXJuYWxTdG9yZTpWLHVzZUlkOlYsdW5zdGFibGVfaXNOZXdSZWNvbmNpbGVyOiExfSxsaz17cmVhZENvbnRleHQ6cWEsdXNlQ2FsbGJhY2s6ZnVuY3Rpb24oYSxiKXtGYSgpLm1lbW9pemVkU3RhdGU9W2Esdm9pZCAwPT09Yj9udWxsOmJdO3JldHVybiBhfSx1c2VDb250ZXh0OnFhLHVzZUVmZmVjdDpTaCx1c2VJbXBlcmF0aXZlSGFuZGxlOmZ1bmN0aW9uKGEsYixjKXtjPW51bGwhPT1jJiZ2b2lkIDAhPT1jP2MuY29uY2F0KFthXSk6bnVsbDtyZXR1cm4gQmQoNDE5NDMwOCw0LFZoLmJpbmQobnVsbCxiLGEpLGMpfSx1c2VMYXlvdXRFZmZlY3Q6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gQmQoNDE5NDMwOCw0LGEsYil9LHVzZUluc2VydGlvbkVmZmVjdDpmdW5jdGlvbihhLGIpe3JldHVybiBCZCg0LDIsYSxiKX0sdXNlTWVtbzpmdW5jdGlvbihhLGIpe3ZhciBjPUZhKCk7Yj12b2lkIDA9PT1iP251bGw6YjthPWEoKTtjLm1lbW9pemVkU3RhdGU9ClthLGJdO3JldHVybiBhfSx1c2VSZWR1Y2VyOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD1GYSgpO2I9dm9pZCAwIT09Yz9jKGIpOmI7ZC5tZW1vaXplZFN0YXRlPWQuYmFzZVN0YXRlPWI7YT17cGVuZGluZzpudWxsLGludGVybGVhdmVkOm51bGwsbGFuZXM6MCxkaXNwYXRjaDpudWxsLGxhc3RSZW5kZXJlZFJlZHVjZXI6YSxsYXN0UmVuZGVyZWRTdGF0ZTpifTtkLnF1ZXVlPWE7YT1hLmRpc3BhdGNoPXFrLmJpbmQobnVsbCxDLGEpO3JldHVybltkLm1lbW9pemVkU3RhdGUsYV19LHVzZVJlZjpmdW5jdGlvbihhKXt2YXIgYj1GYSgpO2E9e2N1cnJlbnQ6YX07cmV0dXJuIGIubWVtb2l6ZWRTdGF0ZT1hfSx1c2VTdGF0ZTpRaCx1c2VEZWJ1Z1ZhbHVlOnJmLHVzZURlZmVycmVkVmFsdWU6ZnVuY3Rpb24oYSl7cmV0dXJuIEZhKCkubWVtb2l6ZWRTdGF0ZT1hfSx1c2VUcmFuc2l0aW9uOmZ1bmN0aW9uKCl7dmFyIGE9UWgoITEpLGI9YVswXTthPXBrLmJpbmQobnVsbCxhWzFdKTtGYSgpLm1lbW9pemVkU3RhdGU9CmE7cmV0dXJuW2IsYV19LHVzZU11dGFibGVTb3VyY2U6ZnVuY3Rpb24oYSxiLGMpe30sdXNlU3luY0V4dGVybmFsU3RvcmU6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPUMsZT1GYSgpO2lmKEQpe2lmKHZvaWQgMD09PWMpdGhyb3cgRXJyb3IobSg0MDcpKTtjPWMoKX1lbHNle2M9YigpO2lmKG51bGw9PT1PKXRocm93IEVycm9yKG0oMzQ5KSk7MCE9PSh2YiYzMCl8fE5oKGQsYixjKX1lLm1lbW9pemVkU3RhdGU9Yzt2YXIgZj17dmFsdWU6YyxnZXRTbmFwc2hvdDpifTtlLnF1ZXVlPWY7U2goTGguYmluZChudWxsLGQsZixhKSxbYV0pO2QuZmxhZ3N8PTIwNDg7Q2MoOSxNaC5iaW5kKG51bGwsZCxmLGMsYiksdm9pZCAwLG51bGwpO3JldHVybiBjfSx1c2VJZDpmdW5jdGlvbigpe3ZhciBhPUZhKCksYj1PLmlkZW50aWZpZXJQcmVmaXg7aWYoRCl7dmFyIGM9TmE7dmFyIGQ9TWE7Yz0oZCZ+KDE8PDMyLXRhKGQpLTEpKS50b1N0cmluZygzMikrYztiPSI6IitiKyJSIitjO2M9QWMrKzswPGMmJgooYis9IkgiK2MudG9TdHJpbmcoMzIpKTtiKz0iOiJ9ZWxzZSBjPW1sKyssYj0iOiIrYisiciIrYy50b1N0cmluZygzMikrIjoiO3JldHVybiBhLm1lbW9pemVkU3RhdGU9Yn0sdW5zdGFibGVfaXNOZXdSZWNvbmNpbGVyOiExfSxtaz17cmVhZENvbnRleHQ6cWEsdXNlQ2FsbGJhY2s6WGgsdXNlQ29udGV4dDpxYSx1c2VFZmZlY3Q6cWYsdXNlSW1wZXJhdGl2ZUhhbmRsZTpXaCx1c2VJbnNlcnRpb25FZmZlY3Q6VGgsdXNlTGF5b3V0RWZmZWN0OlVoLHVzZU1lbW86WWgsdXNlUmVkdWNlcjpvZix1c2VSZWY6UmgsdXNlU3RhdGU6ZnVuY3Rpb24oYSl7cmV0dXJuIG9mKEJjKX0sdXNlRGVidWdWYWx1ZTpyZix1c2VEZWZlcnJlZFZhbHVlOmZ1bmN0aW9uKGEpe3ZhciBiPXNhKCk7cmV0dXJuIFpoKGIsSy5tZW1vaXplZFN0YXRlLGEpfSx1c2VUcmFuc2l0aW9uOmZ1bmN0aW9uKCl7dmFyIGE9b2YoQmMpWzBdLGI9c2EoKS5tZW1vaXplZFN0YXRlO3JldHVyblthLGJdfSx1c2VNdXRhYmxlU291cmNlOkpoLAp1c2VTeW5jRXh0ZXJuYWxTdG9yZTpLaCx1c2VJZDokaCx1bnN0YWJsZV9pc05ld1JlY29uY2lsZXI6ITF9LG5rPXtyZWFkQ29udGV4dDpxYSx1c2VDYWxsYmFjazpYaCx1c2VDb250ZXh0OnFhLHVzZUVmZmVjdDpxZix1c2VJbXBlcmF0aXZlSGFuZGxlOldoLHVzZUluc2VydGlvbkVmZmVjdDpUaCx1c2VMYXlvdXRFZmZlY3Q6VWgsdXNlTWVtbzpZaCx1c2VSZWR1Y2VyOnBmLHVzZVJlZjpSaCx1c2VTdGF0ZTpmdW5jdGlvbihhKXtyZXR1cm4gcGYoQmMpfSx1c2VEZWJ1Z1ZhbHVlOnJmLHVzZURlZmVycmVkVmFsdWU6ZnVuY3Rpb24oYSl7dmFyIGI9c2EoKTtyZXR1cm4gbnVsbD09PUs/Yi5tZW1vaXplZFN0YXRlPWE6WmgoYixLLm1lbW9pemVkU3RhdGUsYSl9LHVzZVRyYW5zaXRpb246ZnVuY3Rpb24oKXt2YXIgYT1wZihCYylbMF0sYj1zYSgpLm1lbW9pemVkU3RhdGU7cmV0dXJuW2EsYl19LHVzZU11dGFibGVTb3VyY2U6SmgsdXNlU3luY0V4dGVybmFsU3RvcmU6S2gsdXNlSWQ6JGgsCnVuc3RhYmxlX2lzTmV3UmVjb25jaWxlcjohMX0sRGQ9e2lzTW91bnRlZDpmdW5jdGlvbihhKXtyZXR1cm4oYT1hLl9yZWFjdEludGVybmFscyk/bmIoYSk9PT1hOiExfSxlbnF1ZXVlU2V0U3RhdGU6ZnVuY3Rpb24oYSxiLGMpe2E9YS5fcmVhY3RJbnRlcm5hbHM7dmFyIGQ9WigpLGU9aGIoYSksZj1QYShkLGUpO2YucGF5bG9hZD1iO3ZvaWQgMCE9PWMmJm51bGwhPT1jJiYoZi5jYWxsYmFjaz1jKTtiPWZiKGEsZixlKTtudWxsIT09YiYmKHhhKGIsYSxlLGQpLHZkKGIsYSxlKSl9LGVucXVldWVSZXBsYWNlU3RhdGU6ZnVuY3Rpb24oYSxiLGMpe2E9YS5fcmVhY3RJbnRlcm5hbHM7dmFyIGQ9WigpLGU9aGIoYSksZj1QYShkLGUpO2YudGFnPTE7Zi5wYXlsb2FkPWI7dm9pZCAwIT09YyYmbnVsbCE9PWMmJihmLmNhbGxiYWNrPWMpO2I9ZmIoYSxmLGUpO251bGwhPT1iJiYoeGEoYixhLGUsZCksdmQoYixhLGUpKX0sZW5xdWV1ZUZvcmNlVXBkYXRlOmZ1bmN0aW9uKGEsYil7YT1hLl9yZWFjdEludGVybmFsczsKdmFyIGM9WigpLGQ9aGIoYSksZT1QYShjLGQpO2UudGFnPTI7dm9pZCAwIT09YiYmbnVsbCE9PWImJihlLmNhbGxiYWNrPWIpO2I9ZmIoYSxlLGQpO251bGwhPT1iJiYoeGEoYixhLGQsYyksdmQoYixhLGQpKX19LHJrPSJmdW5jdGlvbiI9PT10eXBlb2YgV2Vha01hcD9XZWFrTWFwOk1hcCx0az1TYS5SZWFjdEN1cnJlbnRPd25lcixoYT0hMSxDZj17ZGVoeWRyYXRlZDpudWxsLHRyZWVDb250ZXh0Om51bGwscmV0cnlMYW5lOjB9O3ZhciB6az1mdW5jdGlvbihhLGIsYyxkKXtmb3IoYz1iLmNoaWxkO251bGwhPT1jOyl7aWYoNT09PWMudGFnfHw2PT09Yy50YWcpYS5hcHBlbmRDaGlsZChjLnN0YXRlTm9kZSk7ZWxzZSBpZig0IT09Yy50YWcmJm51bGwhPT1jLmNoaWxkKXtjLmNoaWxkLnJldHVybj1jO2M9Yy5jaGlsZDtjb250aW51ZX1pZihjPT09YilicmVhaztmb3IoO251bGw9PT1jLnNpYmxpbmc7KXtpZihudWxsPT09Yy5yZXR1cm58fGMucmV0dXJuPT09YilyZXR1cm47Yz1jLnJldHVybn1jLnNpYmxpbmcucmV0dXJuPQpjLnJldHVybjtjPWMuc2libGluZ319O3ZhciB4aT1mdW5jdGlvbihhLGIpe307dmFyIHlrPWZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGY9YS5tZW1vaXplZFByb3BzO2lmKGYhPT1kKXthPWIuc3RhdGVOb2RlO3ViKEVhLmN1cnJlbnQpO2U9bnVsbDtzd2l0Y2goYyl7Y2FzZSAiaW5wdXQiOmY9a2UoYSxmKTtkPWtlKGEsZCk7ZT1bXTticmVhaztjYXNlICJzZWxlY3QiOmY9RSh7fSxmLHt2YWx1ZTp2b2lkIDB9KTtkPUUoe30sZCx7dmFsdWU6dm9pZCAwfSk7ZT1bXTticmVhaztjYXNlICJ0ZXh0YXJlYSI6Zj1uZShhLGYpO2Q9bmUoYSxkKTtlPVtdO2JyZWFrO2RlZmF1bHQ6ImZ1bmN0aW9uIiE9PXR5cGVvZiBmLm9uQ2xpY2smJiJmdW5jdGlvbiI9PT10eXBlb2YgZC5vbkNsaWNrJiYoYS5vbmNsaWNrPWtkKX1wZShjLGQpO3ZhciBnO2M9bnVsbDtmb3IobCBpbiBmKWlmKCFkLmhhc093blByb3BlcnR5KGwpJiZmLmhhc093blByb3BlcnR5KGwpJiZudWxsIT1mW2xdKWlmKCJzdHlsZSI9PT0KbCl7dmFyIGg9ZltsXTtmb3IoZyBpbiBoKWguaGFzT3duUHJvcGVydHkoZykmJihjfHwoYz17fSksY1tnXT0iIil9ZWxzZSJkYW5nZXJvdXNseVNldElubmVySFRNTCIhPT1sJiYiY2hpbGRyZW4iIT09bCYmInN1cHByZXNzQ29udGVudEVkaXRhYmxlV2FybmluZyIhPT1sJiYic3VwcHJlc3NIeWRyYXRpb25XYXJuaW5nIiE9PWwmJiJhdXRvRm9jdXMiIT09bCYmKCRiLmhhc093blByb3BlcnR5KGwpP2V8fChlPVtdKTooZT1lfHxbXSkucHVzaChsLG51bGwpKTtmb3IobCBpbiBkKXt2YXIgaz1kW2xdO2g9bnVsbCE9Zj9mW2xdOnZvaWQgMDtpZihkLmhhc093blByb3BlcnR5KGwpJiZrIT09aCYmKG51bGwhPWt8fG51bGwhPWgpKWlmKCJzdHlsZSI9PT1sKWlmKGgpe2ZvcihnIGluIGgpIWguaGFzT3duUHJvcGVydHkoZyl8fGsmJmsuaGFzT3duUHJvcGVydHkoZyl8fChjfHwoYz17fSksY1tnXT0iIik7Zm9yKGcgaW4gaylrLmhhc093blByb3BlcnR5KGcpJiZoW2ddIT09a1tnXSYmKGN8fAooYz17fSksY1tnXT1rW2ddKX1lbHNlIGN8fChlfHwoZT1bXSksZS5wdXNoKGwsYykpLGM9aztlbHNlImRhbmdlcm91c2x5U2V0SW5uZXJIVE1MIj09PWw/KGs9az9rLl9faHRtbDp2b2lkIDAsaD1oP2guX19odG1sOnZvaWQgMCxudWxsIT1rJiZoIT09ayYmKGU9ZXx8W10pLnB1c2gobCxrKSk6ImNoaWxkcmVuIj09PWw/InN0cmluZyIhPT10eXBlb2YgayYmIm51bWJlciIhPT10eXBlb2Yga3x8KGU9ZXx8W10pLnB1c2gobCwiIitrKToic3VwcHJlc3NDb250ZW50RWRpdGFibGVXYXJuaW5nIiE9PWwmJiJzdXBwcmVzc0h5ZHJhdGlvbldhcm5pbmciIT09bCYmKCRiLmhhc093blByb3BlcnR5KGwpPyhudWxsIT1rJiYib25TY3JvbGwiPT09bCYmQigic2Nyb2xsIixhKSxlfHxoPT09a3x8KGU9W10pKTooZT1lfHxbXSkucHVzaChsLGspKX1jJiYoZT1lfHxbXSkucHVzaCgic3R5bGUiLGMpO3ZhciBsPWU7aWYoYi51cGRhdGVRdWV1ZT1sKWIuZmxhZ3N8PTR9fTt2YXIgQWs9ZnVuY3Rpb24oYSwKYixjLGQpe2MhPT1kJiYoYi5mbGFnc3w9NCl9O3ZhciBKZD0hMSxYPSExLEZrPSJmdW5jdGlvbiI9PT10eXBlb2YgV2Vha1NldD9XZWFrU2V0OlNldCxsPW51bGwsemk9ITEsVD1udWxsLHphPSExLE1rPU1hdGguY2VpbCxPZD1TYS5SZWFjdEN1cnJlbnREaXNwYXRjaGVyLFVmPVNhLlJlYWN0Q3VycmVudE93bmVyLGNhPVNhLlJlYWN0Q3VycmVudEJhdGNoQ29uZmlnLHA9MCxPPW51bGwsSD1udWxsLFU9MCxiYT0wLEdhPWJiKDApLEw9MCxKYz1udWxsLHJhPTAsTWQ9MCxTZj0wLEtjPW51bGwsamE9bnVsbCxPZj0wLEhmPUluZmluaXR5LFJhPW51bGwsRWQ9ITEseGY9bnVsbCxpYj1udWxsLFBkPSExLGxiPW51bGwsUWQ9MCxJYz0wLFBmPW51bGwsS2Q9LTEsTGQ9MDt2YXIgUWs9ZnVuY3Rpb24oYSxiLGMpe2lmKG51bGwhPT1hKWlmKGEubWVtb2l6ZWRQcm9wcyE9PWIucGVuZGluZ1Byb3BzfHxTLmN1cnJlbnQpaGE9ITA7ZWxzZXtpZigwPT09KGEubGFuZXMmYykmJjA9PT0oYi5mbGFncyYKMTI4KSlyZXR1cm4gaGE9ITEsd2soYSxiLGMpO2hhPTAhPT0oYS5mbGFncyYxMzEwNzIpPyEwOiExfWVsc2UgaGE9ITEsRCYmMCE9PShiLmZsYWdzJjEwNDg1NzYpJiZ5aChiLG5kLGIuaW5kZXgpO2IubGFuZXM9MDtzd2l0Y2goYi50YWcpe2Nhc2UgMjp2YXIgZD1iLnR5cGU7RmQoYSxiKTthPWIucGVuZGluZ1Byb3BzO3ZhciBlPU5iKGIsSi5jdXJyZW50KTtTYihiLGMpO2U9bWYobnVsbCxiLGQsYSxlLGMpO3ZhciBmPW5mKCk7Yi5mbGFnc3w9MTsib2JqZWN0Ij09PXR5cGVvZiBlJiZudWxsIT09ZSYmImZ1bmN0aW9uIj09PXR5cGVvZiBlLnJlbmRlciYmdm9pZCAwPT09ZS4kJHR5cGVvZj8oYi50YWc9MSxiLm1lbW9pemVkU3RhdGU9bnVsbCxiLnVwZGF0ZVF1ZXVlPW51bGwsZWEoZCk/KGY9ITAsbGQoYikpOmY9ITEsYi5tZW1vaXplZFN0YXRlPW51bGwhPT1lLnN0YXRlJiZ2b2lkIDAhPT1lLnN0YXRlP2Uuc3RhdGU6bnVsbCxmZihiKSxlLnVwZGF0ZXI9RGQsYi5zdGF0ZU5vZGU9CmUsZS5fcmVhY3RJbnRlcm5hbHM9Yix1ZihiLGQsYSxjKSxiPUFmKG51bGwsYixkLCEwLGYsYykpOihiLnRhZz0wLEQmJmYmJlVlKGIpLGFhKG51bGwsYixlLGMpLGI9Yi5jaGlsZCk7cmV0dXJuIGI7Y2FzZSAxNjpkPWIuZWxlbWVudFR5cGU7YTp7RmQoYSxiKTthPWIucGVuZGluZ1Byb3BzO2U9ZC5faW5pdDtkPWUoZC5fcGF5bG9hZCk7Yi50eXBlPWQ7ZT1iLnRhZz1VayhkKTthPXlhKGQsYSk7c3dpdGNoKGUpe2Nhc2UgMDpiPXpmKG51bGwsYixkLGEsYyk7YnJlYWsgYTtjYXNlIDE6Yj1yaShudWxsLGIsZCxhLGMpO2JyZWFrIGE7Y2FzZSAxMTpiPW1pKG51bGwsYixkLGEsYyk7YnJlYWsgYTtjYXNlIDE0OmI9bmkobnVsbCxiLGQseWEoZC50eXBlLGEpLGMpO2JyZWFrIGF9dGhyb3cgRXJyb3IobSgzMDYsZCwiIikpO31yZXR1cm4gYjtjYXNlIDA6cmV0dXJuIGQ9Yi50eXBlLGU9Yi5wZW5kaW5nUHJvcHMsZT1iLmVsZW1lbnRUeXBlPT09ZD9lOnlhKGQsZSksemYoYSxiLGQsZSxjKTsKY2FzZSAxOnJldHVybiBkPWIudHlwZSxlPWIucGVuZGluZ1Byb3BzLGU9Yi5lbGVtZW50VHlwZT09PWQ/ZTp5YShkLGUpLHJpKGEsYixkLGUsYyk7Y2FzZSAzOmE6e3NpKGIpO2lmKG51bGw9PT1hKXRocm93IEVycm9yKG0oMzg3KSk7ZD1iLnBlbmRpbmdQcm9wcztmPWIubWVtb2l6ZWRTdGF0ZTtlPWYuZWxlbWVudDtGaChhLGIpO3dkKGIsZCxudWxsLGMpO3ZhciBnPWIubWVtb2l6ZWRTdGF0ZTtkPWcuZWxlbWVudDtpZihmLmlzRGVoeWRyYXRlZClpZihmPXtlbGVtZW50OmQsaXNEZWh5ZHJhdGVkOiExLGNhY2hlOmcuY2FjaGUscGVuZGluZ1N1c3BlbnNlQm91bmRhcmllczpnLnBlbmRpbmdTdXNwZW5zZUJvdW5kYXJpZXMsdHJhbnNpdGlvbnM6Zy50cmFuc2l0aW9uc30sYi51cGRhdGVRdWV1ZS5iYXNlU3RhdGU9ZixiLm1lbW9pemVkU3RhdGU9ZixiLmZsYWdzJjI1Nil7ZT1VYihFcnJvcihtKDQyMykpLGIpO2I9dGkoYSxiLGQsYyxlKTticmVhayBhfWVsc2UgaWYoZCE9PWUpe2U9ClViKEVycm9yKG0oNDI0KSksYik7Yj10aShhLGIsZCxjLGUpO2JyZWFrIGF9ZWxzZSBmb3IoZmE9S2EoYi5zdGF0ZU5vZGUuY29udGFpbmVySW5mby5maXJzdENoaWxkKSxsYT1iLEQ9ITAsd2E9bnVsbCxjPWxpKGIsbnVsbCxkLGMpLGIuY2hpbGQ9YztjOyljLmZsYWdzPWMuZmxhZ3MmLTN8NDA5NixjPWMuc2libGluZztlbHNle1FiKCk7aWYoZD09PWUpe2I9UWEoYSxiLGMpO2JyZWFrIGF9YWEoYSxiLGQsYyl9Yj1iLmNoaWxkfXJldHVybiBiO2Nhc2UgNTpyZXR1cm4gSWgoYiksbnVsbD09PWEmJlhlKGIpLGQ9Yi50eXBlLGU9Yi5wZW5kaW5nUHJvcHMsZj1udWxsIT09YT9hLm1lbW9pemVkUHJvcHM6bnVsbCxnPWUuY2hpbGRyZW4sUWUoZCxlKT9nPW51bGw6bnVsbCE9PWYmJlFlKGQsZikmJihiLmZsYWdzfD0zMikscWkoYSxiKSxhYShhLGIsZyxjKSxiLmNoaWxkO2Nhc2UgNjpyZXR1cm4gbnVsbD09PWEmJlhlKGIpLG51bGw7Y2FzZSAxMzpyZXR1cm4gdWkoYSxiLGMpO2Nhc2UgNDpyZXR1cm4gZ2YoYiwKYi5zdGF0ZU5vZGUuY29udGFpbmVySW5mbyksZD1iLnBlbmRpbmdQcm9wcyxudWxsPT09YT9iLmNoaWxkPVZiKGIsbnVsbCxkLGMpOmFhKGEsYixkLGMpLGIuY2hpbGQ7Y2FzZSAxMTpyZXR1cm4gZD1iLnR5cGUsZT1iLnBlbmRpbmdQcm9wcyxlPWIuZWxlbWVudFR5cGU9PT1kP2U6eWEoZCxlKSxtaShhLGIsZCxlLGMpO2Nhc2UgNzpyZXR1cm4gYWEoYSxiLGIucGVuZGluZ1Byb3BzLGMpLGIuY2hpbGQ7Y2FzZSA4OnJldHVybiBhYShhLGIsYi5wZW5kaW5nUHJvcHMuY2hpbGRyZW4sYyksYi5jaGlsZDtjYXNlIDEyOnJldHVybiBhYShhLGIsYi5wZW5kaW5nUHJvcHMuY2hpbGRyZW4sYyksYi5jaGlsZDtjYXNlIDEwOmE6e2Q9Yi50eXBlLl9jb250ZXh0O2U9Yi5wZW5kaW5nUHJvcHM7Zj1iLm1lbW9pemVkUHJvcHM7Zz1lLnZhbHVlO3kodWQsZC5fY3VycmVudFZhbHVlKTtkLl9jdXJyZW50VmFsdWU9ZztpZihudWxsIT09ZilpZih1YShmLnZhbHVlLGcpKXtpZihmLmNoaWxkcmVuPT09CmUuY2hpbGRyZW4mJiFTLmN1cnJlbnQpe2I9UWEoYSxiLGMpO2JyZWFrIGF9fWVsc2UgZm9yKGY9Yi5jaGlsZCxudWxsIT09ZiYmKGYucmV0dXJuPWIpO251bGwhPT1mOyl7dmFyIGg9Zi5kZXBlbmRlbmNpZXM7aWYobnVsbCE9PWgpe2c9Zi5jaGlsZDtmb3IodmFyIGs9aC5maXJzdENvbnRleHQ7bnVsbCE9PWs7KXtpZihrLmNvbnRleHQ9PT1kKXtpZigxPT09Zi50YWcpe2s9UGEoLTEsYyYtYyk7ay50YWc9Mjt2YXIgbD1mLnVwZGF0ZVF1ZXVlO2lmKG51bGwhPT1sKXtsPWwuc2hhcmVkO3ZhciBwPWwucGVuZGluZztudWxsPT09cD9rLm5leHQ9azooay5uZXh0PXAubmV4dCxwLm5leHQ9ayk7bC5wZW5kaW5nPWt9fWYubGFuZXN8PWM7az1mLmFsdGVybmF0ZTtudWxsIT09ayYmKGsubGFuZXN8PWMpO2RmKGYucmV0dXJuLGMsYik7aC5sYW5lc3w9YzticmVha31rPWsubmV4dH19ZWxzZSBpZigxMD09PWYudGFnKWc9Zi50eXBlPT09Yi50eXBlP251bGw6Zi5jaGlsZDtlbHNlIGlmKDE4PT09CmYudGFnKXtnPWYucmV0dXJuO2lmKG51bGw9PT1nKXRocm93IEVycm9yKG0oMzQxKSk7Zy5sYW5lc3w9YztoPWcuYWx0ZXJuYXRlO251bGwhPT1oJiYoaC5sYW5lc3w9Yyk7ZGYoZyxjLGIpO2c9Zi5zaWJsaW5nfWVsc2UgZz1mLmNoaWxkO2lmKG51bGwhPT1nKWcucmV0dXJuPWY7ZWxzZSBmb3IoZz1mO251bGwhPT1nOyl7aWYoZz09PWIpe2c9bnVsbDticmVha31mPWcuc2libGluZztpZihudWxsIT09Zil7Zi5yZXR1cm49Zy5yZXR1cm47Zz1mO2JyZWFrfWc9Zy5yZXR1cm59Zj1nfWFhKGEsYixlLmNoaWxkcmVuLGMpO2I9Yi5jaGlsZH1yZXR1cm4gYjtjYXNlIDk6cmV0dXJuIGU9Yi50eXBlLGQ9Yi5wZW5kaW5nUHJvcHMuY2hpbGRyZW4sU2IoYixjKSxlPXFhKGUpLGQ9ZChlKSxiLmZsYWdzfD0xLGFhKGEsYixkLGMpLGIuY2hpbGQ7Y2FzZSAxNDpyZXR1cm4gZD1iLnR5cGUsZT15YShkLGIucGVuZGluZ1Byb3BzKSxlPXlhKGQudHlwZSxlKSxuaShhLGIsZCxlLGMpO2Nhc2UgMTU6cmV0dXJuIG9pKGEsCmIsYi50eXBlLGIucGVuZGluZ1Byb3BzLGMpO2Nhc2UgMTc6cmV0dXJuIGQ9Yi50eXBlLGU9Yi5wZW5kaW5nUHJvcHMsZT1iLmVsZW1lbnRUeXBlPT09ZD9lOnlhKGQsZSksRmQoYSxiKSxiLnRhZz0xLGVhKGQpPyhhPSEwLGxkKGIpKTphPSExLFNiKGIsYyksZWkoYixkLGUpLHVmKGIsZCxlLGMpLEFmKG51bGwsYixkLCEwLGEsYyk7Y2FzZSAxOTpyZXR1cm4gd2koYSxiLGMpO2Nhc2UgMjI6cmV0dXJuIHBpKGEsYixjKX10aHJvdyBFcnJvcihtKDE1NixiLnRhZykpO307dmFyIHBhPWZ1bmN0aW9uKGEsYixjLGQpe3JldHVybiBuZXcgVGsoYSxiLGMsZCl9LGFqPSJmdW5jdGlvbiI9PT10eXBlb2YgcmVwb3J0RXJyb3I/cmVwb3J0RXJyb3I6ZnVuY3Rpb24oYSl7Y29uc29sZS5lcnJvcihhKX07VWQucHJvdG90eXBlLnJlbmRlcj1YZi5wcm90b3R5cGUucmVuZGVyPWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuX2ludGVybmFsUm9vdDtpZihudWxsPT09Yil0aHJvdyBFcnJvcihtKDQwOSkpOwpTZChhLGIsbnVsbCxudWxsKX07VWQucHJvdG90eXBlLnVubW91bnQ9WGYucHJvdG90eXBlLnVubW91bnQ9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLl9pbnRlcm5hbFJvb3Q7aWYobnVsbCE9PWEpe3RoaXMuX2ludGVybmFsUm9vdD1udWxsO3ZhciBiPWEuY29udGFpbmVySW5mbzt5YihmdW5jdGlvbigpe1NkKG51bGwsYSxudWxsLG51bGwpfSk7YltKYV09bnVsbH19O1VkLnByb3RvdHlwZS51bnN0YWJsZV9zY2hlZHVsZUh5ZHJhdGlvbj1mdW5jdGlvbihhKXtpZihhKXt2YXIgYj1ubCgpO2E9e2Jsb2NrZWRPbjpudWxsLHRhcmdldDphLHByaW9yaXR5OmJ9O2Zvcih2YXIgYz0wO2M8WWEubGVuZ3RoJiYwIT09YiYmYjxZYVtjXS5wcmlvcml0eTtjKyspO1lhLnNwbGljZShjLDAsYSk7MD09PWMmJkhnKGEpfX07dmFyIENqPWZ1bmN0aW9uKGEpe3N3aXRjaChhLnRhZyl7Y2FzZSAzOnZhciBiPWEuc3RhdGVOb2RlO2lmKGIuY3VycmVudC5tZW1vaXplZFN0YXRlLmlzRGVoeWRyYXRlZCl7dmFyIGM9CmhjKGIucGVuZGluZ0xhbmVzKTswIT09YyYmKHhlKGIsY3wxKSxpYShiLFAoKSksMD09PShwJjYpJiYoSGMoKSxkYigpKSl9YnJlYWs7Y2FzZSAxMzp5YihmdW5jdGlvbigpe3ZhciBiPU9hKGEsMSk7aWYobnVsbCE9PWIpe3ZhciBjPVooKTt4YShiLGEsMSxjKX19KSxXZihhLDEpfX07dmFyIEdnPWZ1bmN0aW9uKGEpe2lmKDEzPT09YS50YWcpe3ZhciBiPU9hKGEsMTM0MjE3NzI4KTtpZihudWxsIT09Yil7dmFyIGM9WigpO3hhKGIsYSwxMzQyMTc3MjgsYyl9V2YoYSwxMzQyMTc3MjgpfX07dmFyIHhqPWZ1bmN0aW9uKGEpe2lmKDEzPT09YS50YWcpe3ZhciBiPWhiKGEpLGM9T2EoYSxiKTtpZihudWxsIT09Yyl7dmFyIGQ9WigpO3hhKGMsYSxiLGQpfVdmKGEsYil9fTt2YXIgbmw9ZnVuY3Rpb24oKXtyZXR1cm4gen07dmFyIHdqPWZ1bmN0aW9uKGEsYil7dmFyIGM9ejt0cnl7cmV0dXJuIHo9YSxiKCl9ZmluYWxseXt6PWN9fTtzZT1mdW5jdGlvbihhLGIsYyl7c3dpdGNoKGIpe2Nhc2UgImlucHV0IjpsZShhLApjKTtiPWMubmFtZTtpZigicmFkaW8iPT09Yy50eXBlJiZudWxsIT1iKXtmb3IoYz1hO2MucGFyZW50Tm9kZTspYz1jLnBhcmVudE5vZGU7Yz1jLnF1ZXJ5U2VsZWN0b3JBbGwoImlucHV0W25hbWU9IitKU09OLnN0cmluZ2lmeSgiIitiKSsnXVt0eXBlPSJyYWRpbyJdJyk7Zm9yKGI9MDtiPGMubGVuZ3RoO2IrKyl7dmFyIGQ9Y1tiXTtpZihkIT09YSYmZC5mb3JtPT09YS5mb3JtKXt2YXIgZT1SYyhkKTtpZighZSl0aHJvdyBFcnJvcihtKDkwKSk7amcoZCk7bGUoZCxlKX19fWJyZWFrO2Nhc2UgInRleHRhcmVhIjpvZyhhLGMpO2JyZWFrO2Nhc2UgInNlbGVjdCI6Yj1jLnZhbHVlLG51bGwhPWImJkRiKGEsISFjLm11bHRpcGxlLGIsITEpfX07KGZ1bmN0aW9uKGEsYixjKXt4Zz1hO3lnPWN9KShUZixmdW5jdGlvbihhLGIsYyxkLGUpe3ZhciBmPXosZz1jYS50cmFuc2l0aW9uO3RyeXtyZXR1cm4gY2EudHJhbnNpdGlvbj1udWxsLHo9MSxhKGIsYyxkLGUpfWZpbmFsbHl7ej1mLGNhLnRyYW5zaXRpb249CmcsMD09PXAmJkhjKCl9fSx5Yik7dmFyIG9sPXt1c2luZ0NsaWVudEVudHJ5UG9pbnQ6ITEsRXZlbnRzOltlYyxJYixSYyx1Zyx2ZyxUZl19OyhmdW5jdGlvbihhKXthPXtidW5kbGVUeXBlOmEuYnVuZGxlVHlwZSx2ZXJzaW9uOmEudmVyc2lvbixyZW5kZXJlclBhY2thZ2VOYW1lOmEucmVuZGVyZXJQYWNrYWdlTmFtZSxyZW5kZXJlckNvbmZpZzphLnJlbmRlcmVyQ29uZmlnLG92ZXJyaWRlSG9va1N0YXRlOm51bGwsb3ZlcnJpZGVIb29rU3RhdGVEZWxldGVQYXRoOm51bGwsb3ZlcnJpZGVIb29rU3RhdGVSZW5hbWVQYXRoOm51bGwsb3ZlcnJpZGVQcm9wczpudWxsLG92ZXJyaWRlUHJvcHNEZWxldGVQYXRoOm51bGwsb3ZlcnJpZGVQcm9wc1JlbmFtZVBhdGg6bnVsbCxzZXRFcnJvckhhbmRsZXI6bnVsbCxzZXRTdXNwZW5zZUhhbmRsZXI6bnVsbCxzY2hlZHVsZVVwZGF0ZTpudWxsLGN1cnJlbnREaXNwYXRjaGVyUmVmOlNhLlJlYWN0Q3VycmVudERpc3BhdGNoZXIsZmluZEhvc3RJbnN0YW5jZUJ5RmliZXI6WGssCmZpbmRGaWJlckJ5SG9zdEluc3RhbmNlOmEuZmluZEZpYmVyQnlIb3N0SW5zdGFuY2V8fFlrLGZpbmRIb3N0SW5zdGFuY2VzRm9yUmVmcmVzaDpudWxsLHNjaGVkdWxlUmVmcmVzaDpudWxsLHNjaGVkdWxlUm9vdDpudWxsLHNldFJlZnJlc2hIYW5kbGVyOm51bGwsZ2V0Q3VycmVudEZpYmVyOm51bGwscmVjb25jaWxlclZlcnNpb246IjE4LjMuMSJ9O2lmKCJ1bmRlZmluZWQiPT09dHlwZW9mIF9fUkVBQ1RfREVWVE9PTFNfR0xPQkFMX0hPT0tfXylhPSExO2Vsc2V7dmFyIGI9X19SRUFDVF9ERVZUT09MU19HTE9CQUxfSE9PS19fO2lmKGIuaXNEaXNhYmxlZHx8IWIuc3VwcG9ydHNGaWJlcilhPSEwO2Vsc2V7dHJ5e1VjPWIuaW5qZWN0KGEpLENhPWJ9Y2F0Y2goYyl7fWE9Yi5jaGVja0RDRT8hMDohMX19cmV0dXJuIGF9KSh7ZmluZEZpYmVyQnlIb3N0SW5zdGFuY2U6b2IsYnVuZGxlVHlwZTowLHZlcnNpb246IjE4LjMuMS1uZXh0LWYxMzM4ZjgwODAtMjAyNDA0MjYiLApyZW5kZXJlclBhY2thZ2VOYW1lOiJyZWFjdC1kb20ifSk7US5fX1NFQ1JFVF9JTlRFUk5BTFNfRE9fTk9UX1VTRV9PUl9ZT1VfV0lMTF9CRV9GSVJFRD1vbDtRLmNyZWF0ZVBvcnRhbD1mdW5jdGlvbihhLGIpe3ZhciBjPTI8YXJndW1lbnRzLmxlbmd0aCYmdm9pZCAwIT09YXJndW1lbnRzWzJdP2FyZ3VtZW50c1syXTpudWxsO2lmKCFZZihiKSl0aHJvdyBFcnJvcihtKDIwMCkpO3JldHVybiBXayhhLGIsbnVsbCxjKX07US5jcmVhdGVSb290PWZ1bmN0aW9uKGEsYil7aWYoIVlmKGEpKXRocm93IEVycm9yKG0oMjk5KSk7dmFyIGM9ITEsZD0iIixlPWFqO251bGwhPT1iJiZ2b2lkIDAhPT1iJiYoITA9PT1iLnVuc3RhYmxlX3N0cmljdE1vZGUmJihjPSEwKSx2b2lkIDAhPT1iLmlkZW50aWZpZXJQcmVmaXgmJihkPWIuaWRlbnRpZmllclByZWZpeCksdm9pZCAwIT09Yi5vblJlY292ZXJhYmxlRXJyb3ImJihlPWIub25SZWNvdmVyYWJsZUVycm9yKSk7Yj1WZihhLDEsITEsbnVsbCxudWxsLApjLCExLGQsZSk7YVtKYV09Yi5jdXJyZW50O3NjKDg9PT1hLm5vZGVUeXBlP2EucGFyZW50Tm9kZTphKTtyZXR1cm4gbmV3IFhmKGIpfTtRLmZpbmRET01Ob2RlPWZ1bmN0aW9uKGEpe2lmKG51bGw9PWEpcmV0dXJuIG51bGw7aWYoMT09PWEubm9kZVR5cGUpcmV0dXJuIGE7dmFyIGI9YS5fcmVhY3RJbnRlcm5hbHM7aWYodm9pZCAwPT09Yil7aWYoImZ1bmN0aW9uIj09PXR5cGVvZiBhLnJlbmRlcil0aHJvdyBFcnJvcihtKDE4OCkpO2E9T2JqZWN0LmtleXMoYSkuam9pbigiLCIpO3Rocm93IEVycm9yKG0oMjY4LGEpKTt9YT1CZyhiKTthPW51bGw9PT1hP251bGw6YS5zdGF0ZU5vZGU7cmV0dXJuIGF9O1EuZmx1c2hTeW5jPWZ1bmN0aW9uKGEpe3JldHVybiB5YihhKX07US5oeWRyYXRlPWZ1bmN0aW9uKGEsYixjKXtpZighVmQoYikpdGhyb3cgRXJyb3IobSgyMDApKTtyZXR1cm4gV2QobnVsbCxhLGIsITAsYyl9O1EuaHlkcmF0ZVJvb3Q9ZnVuY3Rpb24oYSxiLGMpe2lmKCFZZihhKSl0aHJvdyBFcnJvcihtKDQwNSkpOwp2YXIgZD1udWxsIT1jJiZjLmh5ZHJhdGVkU291cmNlc3x8bnVsbCxlPSExLGY9IiIsZz1hajtudWxsIT09YyYmdm9pZCAwIT09YyYmKCEwPT09Yy51bnN0YWJsZV9zdHJpY3RNb2RlJiYoZT0hMCksdm9pZCAwIT09Yy5pZGVudGlmaWVyUHJlZml4JiYoZj1jLmlkZW50aWZpZXJQcmVmaXgpLHZvaWQgMCE9PWMub25SZWNvdmVyYWJsZUVycm9yJiYoZz1jLm9uUmVjb3ZlcmFibGVFcnJvcikpO2I9V2koYixudWxsLGEsMSxudWxsIT1jP2M6bnVsbCxlLCExLGYsZyk7YVtKYV09Yi5jdXJyZW50O3NjKGEpO2lmKGQpZm9yKGE9MDthPGQubGVuZ3RoO2ErKyljPWRbYV0sZT1jLl9nZXRWZXJzaW9uLGU9ZShjLl9zb3VyY2UpLG51bGw9PWIubXV0YWJsZVNvdXJjZUVhZ2VySHlkcmF0aW9uRGF0YT9iLm11dGFibGVTb3VyY2VFYWdlckh5ZHJhdGlvbkRhdGE9W2MsZV06Yi5tdXRhYmxlU291cmNlRWFnZXJIeWRyYXRpb25EYXRhLnB1c2goYyxlKTtyZXR1cm4gbmV3IFVkKGIpfTtRLnJlbmRlcj0KZnVuY3Rpb24oYSxiLGMpe2lmKCFWZChiKSl0aHJvdyBFcnJvcihtKDIwMCkpO3JldHVybiBXZChudWxsLGEsYiwhMSxjKX07US51bm1vdW50Q29tcG9uZW50QXROb2RlPWZ1bmN0aW9uKGEpe2lmKCFWZChhKSl0aHJvdyBFcnJvcihtKDQwKSk7cmV0dXJuIGEuX3JlYWN0Um9vdENvbnRhaW5lcj8oeWIoZnVuY3Rpb24oKXtXZChudWxsLG51bGwsYSwhMSxmdW5jdGlvbigpe2EuX3JlYWN0Um9vdENvbnRhaW5lcj1udWxsO2FbSmFdPW51bGx9KX0pLCEwKTohMX07US51bnN0YWJsZV9iYXRjaGVkVXBkYXRlcz1UZjtRLnVuc3RhYmxlX3JlbmRlclN1YnRyZWVJbnRvQ29udGFpbmVyPWZ1bmN0aW9uKGEsYixjLGQpe2lmKCFWZChjKSl0aHJvdyBFcnJvcihtKDIwMCkpO2lmKG51bGw9PWF8fHZvaWQgMD09PWEuX3JlYWN0SW50ZXJuYWxzKXRocm93IEVycm9yKG0oMzgpKTtyZXR1cm4gV2QoYSxiLGMsITEsZCl9O1EudmVyc2lvbj0iMTguMy4xLW5leHQtZjEzMzhmODA4MC0yMDI0MDQyNiJ9KTsKfSkoKTsK",mtime:1744325324149},"assets/excalidraw.min.js":{data:"data:application/javascript;base64,LyohIEZvciBsaWNlbnNlIGluZm9ybWF0aW9uIHBsZWFzZSBzZWUgZXhjYWxpZHJhdy5taW4uanMuTElDRU5TRS50eHQgKi8KIWZ1bmN0aW9uKGUsdCl7Im9iamVjdCI9PXR5cGVvZiBleHBvcnRzJiYib2JqZWN0Ij09dHlwZW9mIG1vZHVsZT9tb2R1bGUuZXhwb3J0cz10KHJlcXVpcmUoInJlYWN0IikscmVxdWlyZSgicmVhY3QtZG9tIikpOiJmdW5jdGlvbiI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFsicmVhY3QiLCJyZWFjdC1kb20iXSx0KToib2JqZWN0Ij09dHlwZW9mIGV4cG9ydHM/ZXhwb3J0cy5FeGNhbGlkcmF3PXQocmVxdWlyZSgicmVhY3QiKSxyZXF1aXJlKCJyZWFjdC1kb20iKSk6ZS5FeGNhbGlkcmF3PXQoZS5SZWFjdCxlLlJlYWN0RE9NKX0od2luZG93LChmdW5jdGlvbihlLHQpe3JldHVybiBmdW5jdGlvbihlKXtmdW5jdGlvbiB0KHQpe2Zvcih2YXIgbixvLGE9dFswXSxpPXRbMV0scz0wLGM9W107czxhLmxlbmd0aDtzKyspbz1hW3NdLE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChyLG8pJiZyW29dJiZjLnB1c2gocltvXVswXSkscltvXT0wO2ZvcihuIGluIGkpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGksbikmJihlW25dPWlbbl0pO2ZvcihsJiZsKHQpO2MubGVuZ3RoOyljLnNoaWZ0KCkoKX12YXIgbj17fSxyPXswOjB9O2Z1bmN0aW9uIG8odCl7aWYoblt0XSlyZXR1cm4gblt0XS5leHBvcnRzO3ZhciByPW5bdF09e2k6dCxsOiExLGV4cG9ydHM6e319O3JldHVybiBlW3RdLmNhbGwoci5leHBvcnRzLHIsci5leHBvcnRzLG8pLHIubD0hMCxyLmV4cG9ydHN9by5lPWZ1bmN0aW9uKCl7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpfSxvLm09ZSxvLmM9bixvLmQ9ZnVuY3Rpb24oZSx0LG4pe28ubyhlLHQpfHxPYmplY3QuZGVmaW5lUHJvcGVydHkoZSx0LHtlbnVtZXJhYmxlOiEwLGdldDpufSl9LG8ucj1mdW5jdGlvbihlKXsidW5kZWZpbmVkIiE9dHlwZW9mIFN5bWJvbCYmU3ltYm9sLnRvU3RyaW5nVGFnJiZPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxTeW1ib2wudG9TdHJpbmdUYWcse3ZhbHVlOiJNb2R1bGUifSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pfSxvLnQ9ZnVuY3Rpb24oZSx0KXtpZigxJnQmJihlPW8oZSkpLDgmdClyZXR1cm4gZTtpZig0JnQmJiJvYmplY3QiPT10eXBlb2YgZSYmZSYmZS5fX2VzTW9kdWxlKXJldHVybiBlO3ZhciBuPU9iamVjdC5jcmVhdGUobnVsbCk7aWYoby5yKG4pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuLCJkZWZhdWx0Iix7ZW51bWVyYWJsZTohMCx2YWx1ZTplfSksMiZ0JiYic3RyaW5nIiE9dHlwZW9mIGUpZm9yKHZhciByIGluIGUpby5kKG4scixmdW5jdGlvbih0KXtyZXR1cm4gZVt0XX0uYmluZChudWxsLHIpKTtyZXR1cm4gbn0sby5uPWZ1bmN0aW9uKGUpe3ZhciB0PWUmJmUuX19lc01vZHVsZT9mdW5jdGlvbigpe3JldHVybiBlLmRlZmF1bHR9OmZ1bmN0aW9uKCl7cmV0dXJuIGV9O3JldHVybiBvLmQodCwiYSIsdCksdH0sby5vPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLHQpfSxvLnA9IiIsby5vZT1mdW5jdGlvbihlKXt0aHJvdyBjb25zb2xlLmVycm9yKGUpLGV9O3ZhciBhPXdpbmRvdy53ZWJwYWNrSnNvbnBFeGNhbGlkcmF3PXdpbmRvdy53ZWJwYWNrSnNvbnBFeGNhbGlkcmF3fHxbXSxpPWEucHVzaC5iaW5kKGEpO2EucHVzaD10LGE9YS5zbGljZSgpO2Zvcih2YXIgcz0wO3M8YS5sZW5ndGg7cysrKXQoYVtzXSk7dmFyIGw9aTtyZXR1cm4gbyhvLnM9MTQ1KX0oW2Z1bmN0aW9uKHQsbil7dC5leHBvcnRzPWV9LGZ1bmN0aW9uKGUsdCxuKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gcihlLHQpe2lmKCEoZSBpbnN0YW5jZW9mIHQpKXRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpfWZ1bmN0aW9uIG8oZSx0KXtmb3IodmFyIG49MDtuPHQubGVuZ3RoO24rKyl7dmFyIHI9dFtuXTtyLmVudW1lcmFibGU9ci5lbnVtZXJhYmxlfHwhMSxyLmNvbmZpZ3VyYWJsZT0hMCwidmFsdWUiaW4gciYmKHIud3JpdGFibGU9ITApLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHIua2V5LHIpfX1uLmQodCwiYiIsKGZ1bmN0aW9uKCl7cmV0dXJuIFR9KSksbi5kKHQsImMiLChmdW5jdGlvbigpe3JldHVybiBffSkpLG4uZCh0LCJkIiwoZnVuY3Rpb24oKXtyZXR1cm4gen0pKSxuLmQodCwiYSIsKGZ1bmN0aW9uKCl7cmV0dXJuIEx9KSksbi5kKHQsImUiLChmdW5jdGlvbigpe3JldHVybiBEfSkpO3ZhciBhPVtdLGk9YS5mb3JFYWNoLHM9YS5zbGljZTtmdW5jdGlvbiBsKGUpe3JldHVybiBpLmNhbGwocy5jYWxsKGFyZ3VtZW50cywxKSwoZnVuY3Rpb24odCl7aWYodClmb3IodmFyIG4gaW4gdCl2b2lkIDA9PT1lW25dJiYoZVtuXT10W25dKX0pKSxlfXZhciBjLHU9ZnVuY3Rpb24oZSx0LG4scil7dmFyIG8sYT1hcmd1bWVudHMubGVuZ3RoPjQmJnZvaWQgMCE9PWFyZ3VtZW50c1s0XT9hcmd1bWVudHNbNF06e3BhdGg6Ii8ifTtpZihuKXt2YXIgaT1uZXcgRGF0ZTtpLnNldFRpbWUoaS5nZXRUaW1lKCkrNjAqbioxZTMpLG89IjsgZXhwaXJlcz0iK2kudG9VVENTdHJpbmcoKX1lbHNlIG89IiI7cj1yPyJkb21haW49IityKyI7IjoiIixhPU9iamVjdC5rZXlzKGEpLnJlZHVjZSgoZnVuY3Rpb24oZSx0KXtyZXR1cm4gZSsiOyIrdC5yZXBsYWNlKC8oW0EtWl0pL2csKGZ1bmN0aW9uKGUpe3JldHVybiItIitlLnRvTG93ZXJDYXNlKCl9KSkrIj0iK2FbdF19KSwiIiksZG9jdW1lbnQuY29va2llPWUrIj0iK2VuY29kZVVSSUNvbXBvbmVudCh0KStvKyI7IityK2F9LGQ9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PWUrIj0iLG49ZG9jdW1lbnQuY29va2llLnNwbGl0KCI7Iikscj0wO3I8bi5sZW5ndGg7cisrKXtmb3IodmFyIG89bltyXTsiICI9PT1vLmNoYXJBdCgwKTspbz1vLnN1YnN0cmluZygxLG8ubGVuZ3RoKTtpZigwPT09by5pbmRleE9mKHQpKXJldHVybiBvLnN1YnN0cmluZyh0Lmxlbmd0aCxvLmxlbmd0aCl9cmV0dXJuIG51bGx9LHA9e25hbWU6ImNvb2tpZSIsbG9va3VwOmZ1bmN0aW9uKGUpe3ZhciB0O2lmKGUubG9va3VwQ29va2llJiYidW5kZWZpbmVkIiE9dHlwZW9mIGRvY3VtZW50KXt2YXIgbj1kKGUubG9va3VwQ29va2llKTtuJiYodD1uKX1yZXR1cm4gdH0sY2FjaGVVc2VyTGFuZ3VhZ2U6ZnVuY3Rpb24oZSx0KXt0Lmxvb2t1cENvb2tpZSYmInVuZGVmaW5lZCIhPXR5cGVvZiBkb2N1bWVudCYmdSh0Lmxvb2t1cENvb2tpZSxlLHQuY29va2llTWludXRlcyx0LmNvb2tpZURvbWFpbix0LmNvb2tpZU9wdGlvbnMpfX0saD17bmFtZToicXVlcnlzdHJpbmciLGxvb2t1cDpmdW5jdGlvbihlKXt2YXIgdDtpZigidW5kZWZpbmVkIiE9dHlwZW9mIHdpbmRvdylmb3IodmFyIG49d2luZG93LmxvY2F0aW9uLnNlYXJjaC5zdWJzdHJpbmcoMSkuc3BsaXQoIiYiKSxyPTA7cjxuLmxlbmd0aDtyKyspe3ZhciBvPW5bcl0uaW5kZXhPZigiPSIpO2lmKG8+MCluW3JdLnN1YnN0cmluZygwLG8pPT09ZS5sb29rdXBRdWVyeXN0cmluZyYmKHQ9bltyXS5zdWJzdHJpbmcobysxKSl9cmV0dXJuIHR9fTt0cnl7Yz0idW5kZWZpbmVkIiE9PXdpbmRvdyYmbnVsbCE9PXdpbmRvdy5sb2NhbFN0b3JhZ2U7d2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKCJpMThuZXh0LnRyYW5zbGF0ZS5ib28iLCJmb28iKSx3aW5kb3cubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oImkxOG5leHQudHJhbnNsYXRlLmJvbyIpfWNhdGNoKGUpe2M9ITF9dmFyIGYsbT17bmFtZToibG9jYWxTdG9yYWdlIixsb29rdXA6ZnVuY3Rpb24oZSl7dmFyIHQ7aWYoZS5sb29rdXBMb2NhbFN0b3JhZ2UmJmMpe3ZhciBuPXdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShlLmxvb2t1cExvY2FsU3RvcmFnZSk7biYmKHQ9bil9cmV0dXJuIHR9LGNhY2hlVXNlckxhbmd1YWdlOmZ1bmN0aW9uKGUsdCl7dC5sb29rdXBMb2NhbFN0b3JhZ2UmJmMmJndpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSh0Lmxvb2t1cExvY2FsU3RvcmFnZSxlKX19O3RyeXtmPSJ1bmRlZmluZWQiIT09d2luZG93JiZudWxsIT09d2luZG93LnNlc3Npb25TdG9yYWdlO3dpbmRvdy5zZXNzaW9uU3RvcmFnZS5zZXRJdGVtKCJpMThuZXh0LnRyYW5zbGF0ZS5ib28iLCJmb28iKSx3aW5kb3cuc2Vzc2lvblN0b3JhZ2UucmVtb3ZlSXRlbSgiaTE4bmV4dC50cmFuc2xhdGUuYm9vIil9Y2F0Y2goZSl7Zj0hMX12YXIgZz17bmFtZToic2Vzc2lvblN0b3JhZ2UiLGxvb2t1cDpmdW5jdGlvbihlKXt2YXIgdDtpZihlLmxvb2t1cHNlc3Npb25TdG9yYWdlJiZmKXt2YXIgbj13aW5kb3cuc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbShlLmxvb2t1cHNlc3Npb25TdG9yYWdlKTtuJiYodD1uKX1yZXR1cm4gdH0sY2FjaGVVc2VyTGFuZ3VhZ2U6ZnVuY3Rpb24oZSx0KXt0Lmxvb2t1cHNlc3Npb25TdG9yYWdlJiZmJiZ3aW5kb3cuc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbSh0Lmxvb2t1cHNlc3Npb25TdG9yYWdlLGUpfX0sYj17bmFtZToibmF2aWdhdG9yIixsb29rdXA6ZnVuY3Rpb24oZSl7dmFyIHQ9W107aWYoInVuZGVmaW5lZCIhPXR5cGVvZiBuYXZpZ2F0b3Ipe2lmKG5hdmlnYXRvci5sYW5ndWFnZXMpZm9yKHZhciBuPTA7bjxuYXZpZ2F0b3IubGFuZ3VhZ2VzLmxlbmd0aDtuKyspdC5wdXNoKG5hdmlnYXRvci5sYW5ndWFnZXNbbl0pO25hdmlnYXRvci51c2VyTGFuZ3VhZ2UmJnQucHVzaChuYXZpZ2F0b3IudXNlckxhbmd1YWdlKSxuYXZpZ2F0b3IubGFuZ3VhZ2UmJnQucHVzaChuYXZpZ2F0b3IubGFuZ3VhZ2UpfXJldHVybiB0Lmxlbmd0aD4wP3Q6dm9pZCAwfX0seT17bmFtZToiaHRtbFRhZyIsbG9va3VwOmZ1bmN0aW9uKGUpe3ZhciB0LG49ZS5odG1sVGFnfHwoInVuZGVmaW5lZCIhPXR5cGVvZiBkb2N1bWVudD9kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ6bnVsbCk7cmV0dXJuIG4mJiJmdW5jdGlvbiI9PXR5cGVvZiBuLmdldEF0dHJpYnV0ZSYmKHQ9bi5nZXRBdHRyaWJ1dGUoImxhbmciKSksdH19LHY9e25hbWU6InBhdGgiLGxvb2t1cDpmdW5jdGlvbihlKXt2YXIgdDtpZigidW5kZWZpbmVkIiE9dHlwZW9mIHdpbmRvdyl7dmFyIG49d2luZG93LmxvY2F0aW9uLnBhdGhuYW1lLm1hdGNoKC9cLyhbYS16QS1aLV0qKS9nKTtpZihuIGluc3RhbmNlb2YgQXJyYXkpaWYoIm51bWJlciI9PXR5cGVvZiBlLmxvb2t1cEZyb21QYXRoSW5kZXgpe2lmKCJzdHJpbmciIT10eXBlb2YgbltlLmxvb2t1cEZyb21QYXRoSW5kZXhdKXJldHVybjt0PW5bZS5sb29rdXBGcm9tUGF0aEluZGV4XS5yZXBsYWNlKCIvIiwiIil9ZWxzZSB0PW5bMF0ucmVwbGFjZSgiLyIsIiIpfXJldHVybiB0fX0saz17bmFtZToic3ViZG9tYWluIixsb29rdXA6ZnVuY3Rpb24oZSl7dmFyIHQ7aWYoInVuZGVmaW5lZCIhPXR5cGVvZiB3aW5kb3cpe3ZhciBuPXdpbmRvdy5sb2NhdGlvbi5ocmVmLm1hdGNoKC8oPzpodHRwW3NdKlw6XC9cLykqKC4qPylcLig/PVteXC9dKlwuLnsyLDV9KS9naSk7biBpbnN0YW5jZW9mIEFycmF5JiYodD0ibnVtYmVyIj09dHlwZW9mIGUubG9va3VwRnJvbVN1YmRvbWFpbkluZGV4P25bZS5sb29rdXBGcm9tU3ViZG9tYWluSW5kZXhdLnJlcGxhY2UoImh0dHA6Ly8iLCIiKS5yZXBsYWNlKCJodHRwczovLyIsIiIpLnJlcGxhY2UoIi4iLCIiKTpuWzBdLnJlcGxhY2UoImh0dHA6Ly8iLCIiKS5yZXBsYWNlKCJodHRwczovLyIsIiIpLnJlcGxhY2UoIi4iLCIiKSl9cmV0dXJuIHR9fTt2YXIgdz1mdW5jdGlvbigpe2Z1bmN0aW9uIGUodCl7dmFyIG49YXJndW1lbnRzLmxlbmd0aD4xJiZ2b2lkIDAhPT1hcmd1bWVudHNbMV0/YXJndW1lbnRzWzFdOnt9O3IodGhpcyxlKSx0aGlzLnR5cGU9Imxhbmd1YWdlRGV0ZWN0b3IiLHRoaXMuZGV0ZWN0b3JzPXt9LHRoaXMuaW5pdCh0LG4pfXZhciB0LG4sYTtyZXR1cm4gdD1lLChuPVt7a2V5OiJpbml0Iix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1hcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXT9hcmd1bWVudHNbMV06e30sbj1hcmd1bWVudHMubGVuZ3RoPjImJnZvaWQgMCE9PWFyZ3VtZW50c1syXT9hcmd1bWVudHNbMl06e307dGhpcy5zZXJ2aWNlcz1lLHRoaXMub3B0aW9ucz1sKHQsdGhpcy5vcHRpb25zfHx7fSx7b3JkZXI6WyJxdWVyeXN0cmluZyIsImNvb2tpZSIsImxvY2FsU3RvcmFnZSIsInNlc3Npb25TdG9yYWdlIiwibmF2aWdhdG9yIiwiaHRtbFRhZyJdLGxvb2t1cFF1ZXJ5c3RyaW5nOiJsbmciLGxvb2t1cENvb2tpZToiaTE4bmV4dCIsbG9va3VwTG9jYWxTdG9yYWdlOiJpMThuZXh0TG5nIixjYWNoZXM6WyJsb2NhbFN0b3JhZ2UiXSxleGNsdWRlQ2FjaGVGb3I6WyJjaW1vZGUiXX0pLHRoaXMub3B0aW9ucy5sb29rdXBGcm9tVXJsSW5kZXgmJih0aGlzLm9wdGlvbnMubG9va3VwRnJvbVBhdGhJbmRleD10aGlzLm9wdGlvbnMubG9va3VwRnJvbVVybEluZGV4KSx0aGlzLmkxOG5PcHRpb25zPW4sdGhpcy5hZGREZXRlY3RvcihwKSx0aGlzLmFkZERldGVjdG9yKGgpLHRoaXMuYWRkRGV0ZWN0b3IobSksdGhpcy5hZGREZXRlY3RvcihnKSx0aGlzLmFkZERldGVjdG9yKGIpLHRoaXMuYWRkRGV0ZWN0b3IoeSksdGhpcy5hZGREZXRlY3Rvcih2KSx0aGlzLmFkZERldGVjdG9yKGspfX0se2tleToiYWRkRGV0ZWN0b3IiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuZGV0ZWN0b3JzW2UubmFtZV09ZX19LHtrZXk6ImRldGVjdCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcztlfHwoZT10aGlzLm9wdGlvbnMub3JkZXIpO3ZhciBuPVtdO3JldHVybiBlLmZvckVhY2goKGZ1bmN0aW9uKGUpe2lmKHQuZGV0ZWN0b3JzW2VdKXt2YXIgcj10LmRldGVjdG9yc1tlXS5sb29rdXAodC5vcHRpb25zKTtyJiYic3RyaW5nIj09dHlwZW9mIHImJihyPVtyXSksciYmKG49bi5jb25jYXQocikpfX0pKSx0aGlzLnNlcnZpY2VzLmxhbmd1YWdlVXRpbHMuZ2V0QmVzdE1hdGNoRnJvbUNvZGVzP246bi5sZW5ndGg+MD9uWzBdOm51bGx9fSx7a2V5OiJjYWNoZVVzZXJMYW5ndWFnZSIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt2YXIgbj10aGlzO3R8fCh0PXRoaXMub3B0aW9ucy5jYWNoZXMpLHQmJih0aGlzLm9wdGlvbnMuZXhjbHVkZUNhY2hlRm9yJiZ0aGlzLm9wdGlvbnMuZXhjbHVkZUNhY2hlRm9yLmluZGV4T2YoZSk+LTF8fHQuZm9yRWFjaCgoZnVuY3Rpb24odCl7bi5kZXRlY3RvcnNbdF0mJm4uZGV0ZWN0b3JzW3RdLmNhY2hlVXNlckxhbmd1YWdlKGUsbi5vcHRpb25zKX0pKSl9fV0pJiZvKHQucHJvdG90eXBlLG4pLGEmJm8odCxhKSxlfSgpO3cudHlwZT0ibGFuZ3VhZ2VEZXRlY3RvciI7dmFyIFM9dyxFPW4oNTApLE89big1MSksQz1mdW5jdGlvbihlLHQpe3ZhciBuLHIsbyxhLGk9e2xhYmVsOjAsc2VudDpmdW5jdGlvbigpe2lmKDEmb1swXSl0aHJvdyBvWzFdO3JldHVybiBvWzFdfSx0cnlzOltdLG9wczpbXX07cmV0dXJuIGE9e25leHQ6cygwKSx0aHJvdzpzKDEpLHJldHVybjpzKDIpfSwiZnVuY3Rpb24iPT10eXBlb2YgU3ltYm9sJiYoYVtTeW1ib2wuaXRlcmF0b3JdPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9KSxhO2Z1bmN0aW9uIHMoYSl7cmV0dXJuIGZ1bmN0aW9uKHMpe3JldHVybiBmdW5jdGlvbihhKXtpZihuKXRocm93IG5ldyBUeXBlRXJyb3IoIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy4iKTtmb3IoO2k7KXRyeXtpZihuPTEsciYmKG89MiZhWzBdP3IucmV0dXJuOmFbMF0/ci50aHJvd3x8KChvPXIucmV0dXJuKSYmby5jYWxsKHIpLDApOnIubmV4dCkmJiEobz1vLmNhbGwocixhWzFdKSkuZG9uZSlyZXR1cm4gbztzd2l0Y2gocj0wLG8mJihhPVsyJmFbMF0sby52YWx1ZV0pLGFbMF0pe2Nhc2UgMDpjYXNlIDE6bz1hO2JyZWFrO2Nhc2UgNDpyZXR1cm4gaS5sYWJlbCsrLHt2YWx1ZTphWzFdLGRvbmU6ITF9O2Nhc2UgNTppLmxhYmVsKysscj1hWzFdLGE9WzBdO2NvbnRpbnVlO2Nhc2UgNzphPWkub3BzLnBvcCgpLGkudHJ5cy5wb3AoKTtjb250aW51ZTtkZWZhdWx0OmlmKCEobz1pLnRyeXMsKG89by5sZW5ndGg+MCYmb1tvLmxlbmd0aC0xXSl8fDYhPT1hWzBdJiYyIT09YVswXSkpe2k9MDtjb250aW51ZX1pZigzPT09YVswXSYmKCFvfHxhWzFdPm9bMF0mJmFbMV08b1szXSkpe2kubGFiZWw9YVsxXTticmVha31pZig2PT09YVswXSYmaS5sYWJlbDxvWzFdKXtpLmxhYmVsPW9bMV0sbz1hO2JyZWFrfWlmKG8mJmkubGFiZWw8b1syXSl7aS5sYWJlbD1vWzJdLGkub3BzLnB1c2goYSk7YnJlYWt9b1syXSYmaS5vcHMucG9wKCksaS50cnlzLnBvcCgpO2NvbnRpbnVlfWE9dC5jYWxsKGUsaSl9Y2F0Y2goZSl7YT1bNixlXSxyPTB9ZmluYWxseXtuPW89MH1pZig1JmFbMF0pdGhyb3cgYVsxXTtyZXR1cm57dmFsdWU6YVswXT9hWzFdOnZvaWQgMCxkb25lOiEwfX0oW2Esc10pfX19O2Z1bmN0aW9uIHgoZSx0LG4scixvLGEsaSl7dHJ5e3ZhciBzPWVbYV0oaSksbD1zLnZhbHVlfWNhdGNoKGUpe3JldHVybiB2b2lkIG4oZSl9cy5kb25lP3QobCk6UHJvbWlzZS5yZXNvbHZlKGwpLnRoZW4ocixvKX1mdW5jdGlvbiBqKGUpe3JldHVybiBmdW5jdGlvbigpe3ZhciB0PXRoaXMsbj1hcmd1bWVudHM7cmV0dXJuIG5ldyBQcm9taXNlKChmdW5jdGlvbihyLG8pe3ZhciBhPWUuYXBwbHkodCxuKTtmdW5jdGlvbiBpKGUpe3goYSxyLG8saSxzLCJuZXh0IixlKX1mdW5jdGlvbiBzKGUpe3goYSxyLG8saSxzLCJ0aHJvdyIsZSl9aSh2b2lkIDApfSkpfX12YXIgVD1be2xuZzoiZW4iLGxhYmVsOiJFbmdsaXNoIixkYXRhOiJlbi5qc29uIn1dLmNvbmNhdChbe2xuZzoiYmctQkciLGxhYmVsOiLQkdGK0LvQs9Cw0YDRgdC60LgiLGRhdGE6ImJnLUJHLmpzb24ifSx7bG5nOiJkZS1ERSIsbGFiZWw6IkRldXRzY2giLGRhdGE6ImRlLURFLmpzb24ifSx7bG5nOiJlcy1FUyIsbGFiZWw6IkVzcGHDsW9sIixkYXRhOiJlcy1FUy5qc29uIn0se2xuZzoiY2EtRVMiLGxhYmVsOiJDYXRhbGFuIixkYXRhOiJjYS1FUy5qc29uIn0se2xuZzoiZWwtR1IiLGxhYmVsOiLOlc67zrvOt869zrnOus6sIixkYXRhOiJlbC1HUi5qc29uIn0se2xuZzoiZnItRlIiLGxhYmVsOiJGcmFuw6dhaXMiLGRhdGE6ImZyLUZSLmpzb24ifSx7bG5nOiJpZC1JRCIsbGFiZWw6IkJhaGFzYSBJbmRvbmVzaWEiLGRhdGE6ImlkLUlELmpzb24ifSx7bG5nOiJpdC1JVCIsbGFiZWw6Ikl0YWxpYW5vIixkYXRhOiJpdC1JVC5qc29uIn0se2xuZzoiaHUtSFUiLGxhYmVsOiJNYWd5YXIiLGRhdGE6Imh1LUhVLmpzb24ifSx7bG5nOiJubC1OTCIsbGFiZWw6Ik5lZGVybGFuZHMiLGRhdGE6Im5sLU5MLmpzb24ifSx7bG5nOiJuYi1OTyIsbGFiZWw6Ik5vcnNrIGJva23DpWwiLGRhdGE6Im5iLU5PLmpzb24ifSx7bG5nOiJubi1OTyIsbGFiZWw6Ik5vcnNrIG55bm9yc2siLGRhdGE6Im5uLU5PLmpzb24ifSx7bG5nOiJwbC1QTCIsbGFiZWw6IlBvbHNraSIsZGF0YToicGwtUEwuanNvbiJ9LHtsbmc6InB0LVBUIixsYWJlbDoiUG9ydHVndcOqcyIsZGF0YToicHQtUFQuanNvbiJ9LHtsbmc6InJ1LVJVIixsYWJlbDoi0KDRg9GB0YHQutC40LkiLGRhdGE6InJ1LVJVLmpzb24ifSx7bG5nOiJ1ay1VQSIsbGFiZWw6ItCj0LrRgNCw0ZfQvdGB0YzQutCwIixkYXRhOiJ1ay1VQS5qc29uIn0se2xuZzoiZmktRkkiLGxhYmVsOiJTdW9taSIsZGF0YToiZmktRkkuanNvbiJ9LHtsbmc6InRyLVRSIixsYWJlbDoiVMO8cmvDp2UiLGRhdGE6InRyLVRSLmpzb24ifSx7bG5nOiJqYS1KUCIsbGFiZWw6IuaXpeacrOiqniIsZGF0YToiamEtSlAuanNvbiJ9LHtsbmc6ImtvLUtSIixsYWJlbDoi7ZWc6rWt7Ja0IixkYXRhOiJrby1LUi5qc29uIn0se2xuZzoiemgtVFciLGxhYmVsOiLnuYHpq5TkuK3mlociLGRhdGE6InpoLVRXLmpzb24ifSx7bG5nOiJ6aC1DTiIsbGFiZWw6IueugOS9k+S4reaWhyIsZGF0YToiemgtQ04uanNvbiJ9LHtsbmc6ImFyLVNBIixsYWJlbDoi2KfZhNi52LHYqNmK2KkiLGRhdGE6ImFyLVNBLmpzb24iLHJ0bDohMH0se2xuZzoiaGUtSUwiLGxhYmVsOiLXoteR16jXmdeqIixkYXRhOiJoZS1JTC5qc29uIixydGw6ITB9LHtsbmc6ImhpLUlOIixsYWJlbDoi4KS54KS/4KSo4KWN4KSm4KWAIixkYXRhOiJoaS1JTi5qc29uIn0se2xuZzoidGEtSU4iLGxhYmVsOiLgrqTgrq7grr/grrTgr40iLGRhdGE6InRhLUlOLmpzb24ifV0uc29ydCgoZnVuY3Rpb24oZSx0KXtyZXR1cm4gZS5sYWJlbD50LmxhYmVsPzE6LTF9KSkpLmZpbHRlcigoZnVuY3Rpb24oZSl7cmV0dXJuIE9bZS5sbmddPjg1fSkpLFA9VFswXSxBPXt9LE09VFswXSxfPWZ1bmN0aW9uKCl7dmFyIGU9aigoZnVuY3Rpb24oZSl7cmV0dXJuIEModGhpcywoZnVuY3Rpb24odCl7c3dpdGNoKHQubGFiZWwpe2Nhc2UgMDpyZXR1cm4gUD1ULmZpbmQoKGZ1bmN0aW9uKHQpe3JldHVybiB0LmxuZz09PWV9KSl8fE0sZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmRpcj1QLnJ0bD8icnRsIjoibHRyIixbNCxuKDUyKSgiLi8iLmNvbmNhdChQLmRhdGEpKV07Y2FzZSAxOnJldHVybiBBPXQuc2VudCgpLE4uY2FjaGVVc2VyTGFuZ3VhZ2UoUC5sbmcpLFsyXX19KSl9KSk7cmV0dXJuIGZ1bmN0aW9uKHQpe3JldHVybiBlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX19KCksej1mdW5jdGlvbigpe3ZhciBlPWooKGZ1bmN0aW9uKCl7dmFyIGU7cmV0dXJuIEModGhpcywoZnVuY3Rpb24odCl7c3dpdGNoKHQubGFiZWwpe2Nhc2UgMDpyZXR1cm4gZT1OLmRldGVjdCgpLFA9VC5maW5kKChmdW5jdGlvbih0KXtyZXR1cm4gdC5sbmc9PT1lfSkpfHxNLGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5kaXI9UC5ydGw/InJ0bCI6Imx0ciIsWzQsbig1MikoIi4vIi5jb25jYXQoUC5kYXRhKSldO2Nhc2UgMTpyZXR1cm4gQT10LnNlbnQoKSxOLmNhY2hlVXNlckxhbmd1YWdlKFAubG5nKSxbMl19fSkpfSkpO3JldHVybiBmdW5jdGlvbigpe3JldHVybiBlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX19KCksTD1mdW5jdGlvbigpe3JldHVybiBQfSxJPWZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBuPTA7bjx0Lmxlbmd0aDsrK24pe3ZhciByPXRbbl07aWYodm9pZCAwPT09ZVtyXSlyZXR1cm47ZT1lW3JdfWlmKCJzdHJpbmciPT10eXBlb2YgZSlyZXR1cm4gZX0sRD1mdW5jdGlvbihlLHQpe3ZhciBuPWUuc3BsaXQoIi4iKSxyPUkoQSxuKXx8SShFLG4pO2lmKHZvaWQgMD09PXIpdGhyb3cgbmV3IEVycm9yKCJDYW4ndCBmaW5kIHRyYW5zbGF0aW9uIGZvciAiLmNvbmNhdChlKSk7aWYodClmb3IodmFyIG8gaW4gdClyPXIucmVwbGFjZSgie3siLmNvbmNhdChvLCJ9fSIpLHRbb10pO3JldHVybiByfSxOPW5ldyBTO04uaW5pdCh7bGFuZ3VhZ2VVdGlsczp7Zm9ybWF0TGFuZ3VhZ2VDb2RlOmZ1bmN0aW9uKGUpe3JldHVybiBlfSxpc1doaXRlbGlzdGVkOmZ1bmN0aW9uKCl7cmV0dXJuITB9fSxjaGVja1doaXRlbGlzdDohMX0pfSxmdW5jdGlvbihlLHQsbil7InVzZSBzdHJpY3QiO24uZCh0LCJhIiwoZnVuY3Rpb24oKXtyZXR1cm4gYX0pKSxuLmQodCwiZyIsKGZ1bmN0aW9uKCl7cmV0dXJuIHN9KSksbi5kKHQsImMiLChmdW5jdGlvbigpe3JldHVybiBsfSkpLG4uZCh0LCJvIiwoZnVuY3Rpb24oKXtyZXR1cm4gY30pKSxuLmQodCwibSIsKGZ1bmN0aW9uKCl7cmV0dXJuIHV9KSksbi5kKHQsInAiLChmdW5jdGlvbigpe3JldHVybiBkfSkpLG4uZCh0LCJoIiwoZnVuY3Rpb24oKXtyZXR1cm4gcH0pKSxuLmQodCwiaSIsKGZ1bmN0aW9uKCl7cmV0dXJuIGh9KSksbi5kKHQsInEiLChmdW5jdGlvbigpe3JldHVybiBmfSkpLG4uZCh0LCJkIiwoZnVuY3Rpb24oKXtyZXR1cm4gbX0pKSxuLmQodCwidiIsKGZ1bmN0aW9uKCl7cmV0dXJuIGd9KSksbi5kKHQsInMiLChmdW5jdGlvbigpe3JldHVybiBifSkpLG4uZCh0LCJlIiwoZnVuY3Rpb24oKXtyZXR1cm4geX0pKSxuLmQodCwidCIsKGZ1bmN0aW9uKCl7cmV0dXJuIHZ9KSksbi5kKHQsInciLChmdW5jdGlvbigpe3JldHVybiBrfSkpLG4uZCh0LCJsIiwoZnVuY3Rpb24oKXtyZXR1cm4gd30pKSxuLmQodCwiYiIsKGZ1bmN0aW9uKCl7cmV0dXJuIFN9KSksbi5kKHQsImYiLChmdW5jdGlvbigpe3JldHVybiBFfSkpLG4uZCh0LCJrIiwoZnVuY3Rpb24oKXtyZXR1cm4gT30pKSxuLmQodCwieSIsKGZ1bmN0aW9uKCl7cmV0dXJuIEN9KSksbi5kKHQsInUiLChmdW5jdGlvbigpe3JldHVybiB4fSkpLG4uZCh0LCJqIiwoZnVuY3Rpb24oKXtyZXR1cm4gan0pKSxuLmQodCwibiIsKGZ1bmN0aW9uKCl7cmV0dXJuIFB9KSksbi5kKHQsIngiLChmdW5jdGlvbigpe3JldHVybiBBfSkpLG4uZCh0LCJyIiwoZnVuY3Rpb24oKXtyZXR1cm4gTX0pKTt2YXIgcj1uKDYpLG89bigzKSxhPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIsaT1udWxsLHM9ZnVuY3Rpb24oKXtpZihpKXJldHVybiBpO3ZhciBlPW5ldyBEYXRlLHQ9ZS5nZXRGdWxsWWVhcigpLG49IiIuY29uY2F0KGUuZ2V0TW9udGgoKSsxKS5wYWRTdGFydCgyLCIwIikscj0iIi5jb25jYXQoZS5nZXREYXRlKCkpLnBhZFN0YXJ0KDIsIjAiKSxvPSIiLmNvbmNhdChlLmdldEhvdXJzKCkpLnBhZFN0YXJ0KDIsIjAiKSxhPSIiLmNvbmNhdChlLmdldE1pbnV0ZXMoKSkucGFkU3RhcnQoMiwiMCIpO3JldHVybiIiLmNvbmNhdCh0LCItIikuY29uY2F0KG4sIi0iKS5jb25jYXQociwiLSIpLmNvbmNhdChvKS5jb25jYXQoYSl9LGw9ZnVuY3Rpb24oZSl7cmV0dXJuIGUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkrZS5zbGljZSgxKX0sYz1mdW5jdGlvbihlKXtyZXR1cm4gZSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50JiZlLmNsYXNzTmFtZS5pbmNsdWRlcygiVG9vbEljb24iKX0sdT1mdW5jdGlvbihlKXtyZXR1cm4gZSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50JiYid3lzaXd5ZyI9PT1lLmRhdGFzZXQudHlwZXx8ZSBpbnN0YW5jZW9mIEhUTUxCUkVsZW1lbnR8fGUgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50fHxlIGluc3RhbmNlb2YgSFRNTFRleHRBcmVhRWxlbWVudHx8ZSBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50fSxkPWZ1bmN0aW9uKGUpe3JldHVybiBlIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQmJiJ3eXNpd3lnIj09PWUuZGF0YXNldC50eXBlfHxlIGluc3RhbmNlb2YgSFRNTEJSRWxlbWVudHx8ZSBpbnN0YW5jZW9mIEhUTUxUZXh0QXJlYUVsZW1lbnR8fGUgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50JiYoInRleHQiPT09ZS50eXBlfHwibnVtYmVyIj09PWUudHlwZSl9LHA9ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5mb250RmFtaWx5O3JldHVybiIiLmNvbmNhdChvLm5bdF0sIiwgIikuY29uY2F0KG8udil9LGg9ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5mb250U2l6ZSxuPWUuZm9udEZhbWlseTtyZXR1cm4iIi5jb25jYXQodCwicHggIikuY29uY2F0KHAoe2ZvbnRGYW1pbHk6bn0pKX0sZj1mdW5jdGlvbihlLHQpe3ZhciBuPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpLHI9ZG9jdW1lbnQuYm9keTtuLnN0eWxlLnBvc2l0aW9uPSJhYnNvbHV0ZSIsbi5zdHlsZS53aGl0ZVNwYWNlPSJwcmUiLG4uc3R5bGUuZm9udD10LHIuYXBwZW5kQ2hpbGQobiksbi5pbm5lclRleHQ9ZS5zcGxpdCgiXG4iKS5tYXAoKGZ1bmN0aW9uKGUpe3JldHVybiBlfHwiICJ9KSkuam9pbigiXG4iKTt2YXIgbz1uLm9mZnNldFdpZHRoLGE9bi5vZmZzZXRIZWlnaHQsaT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzcGFuIik7aS5zdHlsZS5kaXNwbGF5PSJpbmxpbmUtYmxvY2siLGkuc3R5bGUub3ZlcmZsb3c9ImhpZGRlbiIsaS5zdHlsZS53aWR0aD0iMXB4IixpLnN0eWxlLmhlaWdodD0iMXB4IixuLmFwcGVuZENoaWxkKGkpO3ZhciBzPWkub2Zmc2V0VG9wK2kub2Zmc2V0SGVpZ2h0O3JldHVybiBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKG4pLHt3aWR0aDpvLGhlaWdodDphLGJhc2VsaW5lOnN9fSxtPWZ1bmN0aW9uKGUsdCl7dmFyIG4scj0wLG89ZnVuY3Rpb24oKXtmb3IodmFyIG89W10sYT0wO2E8YXJndW1lbnRzLmxlbmd0aDthKyspb1thXT1hcmd1bWVudHNbYV07bj1vLGNsZWFyVGltZW91dChyKSxyPXdpbmRvdy5zZXRUaW1lb3V0KChmdW5jdGlvbigpe3JldHVybiBlLmFwcGx5KHZvaWQgMCxvKX0pLHQpfTtyZXR1cm4gby5mbHVzaD1mdW5jdGlvbigpe2NsZWFyVGltZW91dChyKSxlLmFwcGx5KHZvaWQgMCxuKX0sb30sZz1mdW5jdGlvbihlKXt2YXIgdD13aW5kb3cuZ2V0U2VsZWN0aW9uKCk7aWYodCl7dmFyIG49ZG9jdW1lbnQuY3JlYXRlUmFuZ2UoKTtuLnNlbGVjdE5vZGVDb250ZW50cyhlKSx0LnJlbW92ZUFsbFJhbmdlcygpLHQuYWRkUmFuZ2Uobil9fSxiPWZ1bmN0aW9uKCl7dmFyIGU9d2luZG93LmdldFNlbGVjdGlvbigpO2UmJmUucmVtb3ZlQWxsUmFuZ2VzKCl9LHk9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gTWF0aC5hYnMoZS10KX0sdj1mdW5jdGlvbigpe2RvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5jdXJzb3I9IiJ9LGs9ZnVuY3Rpb24oZSl7InNlbGVjdGlvbiI9PT1lP3YoKTpkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuY3Vyc29yPW8uZC5DUk9TU0hBSVJ9LHc9ZnVuY3Rpb24oKXt2YXIgZTtyZXR1cm4iSFRNTCI9PT0obnVsbD09PShlPWRvY3VtZW50LmZ1bGxzY3JlZW5FbGVtZW50KXx8dm9pZCAwPT09ZT92b2lkIDA6ZS5ub2RlTmFtZSl9LFM9ZnVuY3Rpb24oKXtyZXR1cm4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnJlcXVlc3RGdWxsc2NyZWVuKCl9LEU9ZnVuY3Rpb24oKXtyZXR1cm4gZG9jdW1lbnQuZXhpdEZ1bGxzY3JlZW4oKX0sTz1mdW5jdGlvbihlKXt2YXIgdD0vTWFjfGlQb2R8aVBob25lfGlQYWQvLnRlc3Qod2luZG93Lm5hdmlnYXRvci5wbGF0Zm9ybSk7cmV0dXJuIiIuY29uY2F0KHQ/ZS5yZXBsYWNlKC9cYkN0cmxPckNtZFxiL2ksIkNtZCIpLnJlcGxhY2UoL1xiQWx0XGIvaSwiT3B0aW9uIikucmVwbGFjZSgvXGJEZWxcYi9pLCJEZWxldGUiKS5yZXBsYWNlKC9cYihFbnRlcnxSZXR1cm4pXGIvaSwiRW50ZXIiKTplLnJlcGxhY2UoL1xiQ3RybE9yQ21kXGIvaSwiQ3RybCIpKX0sQz1mdW5jdGlvbihlLHQsbixvKXt2YXIgYT1lLmNsaWVudFgsaT1lLmNsaWVudFkscz1PYmplY3Qoci5pKShuLG8pLGw9cy54KyhhLXMueC10Lm9mZnNldExlZnQpL3Quem9vbSxjPXMueSsoaS1zLnktdC5vZmZzZXRUb3ApL3Quem9vbTtyZXR1cm57eDpsLXQuc2Nyb2xsWCx5OmMtdC5zY3JvbGxZfX0seD1mdW5jdGlvbihlLHQsbixvKXt2YXIgYT1lLnNjZW5lWCxpPWUuc2NlbmVZLHM9T2JqZWN0KHIuaSkobixvKTtyZXR1cm57eDpzLngtKHMueC1hLXQuc2Nyb2xsWC10Lm9mZnNldExlZnQpKnQuem9vbSx5OnMueS0ocy55LWktdC5zY3JvbGxZLXQub2Zmc2V0VG9wKSp0Lnpvb219fSxqPWZ1bmN0aW9uKGUpe3JldHVybiBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCkuZ2V0UHJvcGVydHlWYWx1ZSgiLS0iLmNvbmNhdChlKSl9LFQ9bmV3IFJlZ0V4cCgiXlteIi5jb25jYXQoIkEtWmEtesOALcOWw5gtw7bDuC3KuMyALdaQ4KCALeG/v+KwgC3vrJzvt74t77mv77u9Le+/vyIsIl0qWyIpLmNvbmNhdCgi1pEt37/vrJ0t77e977mwLe+7vCIsIl0iKSksUD1mdW5jdGlvbihlKXtyZXR1cm4gVC50ZXN0KGUpfTtmdW5jdGlvbiBBKGUpe3JldHVybnt4OmVbMF0seTplWzFdfX12YXIgTT1mdW5jdGlvbihlKXtpZigiQWJvcnRFcnJvciIhPT0obnVsbD09ZT92b2lkIDA6ZS5uYW1lKSl0aHJvdyBlfX0sZnVuY3Rpb24oZSx0LG4peyJ1c2Ugc3RyaWN0IjtuLmQodCwiaSIsKGZ1bmN0aW9uKCl7cmV0dXJuIGF9KSksbi5kKHQsInAiLChmdW5jdGlvbigpe3JldHVybiBpfSkpLG4uZCh0LCJqIiwoZnVuY3Rpb24oKXtyZXR1cm4gc30pKSxuLmQodCwiayIsKGZ1bmN0aW9uKCl7cmV0dXJuIGx9KSksbi5kKHQsInUiLChmdW5jdGlvbigpe3JldHVybiBjfSkpLG4uZCh0LCJ0IiwoZnVuY3Rpb24oKXtyZXR1cm4gdX0pKSxuLmQodCwiZCIsKGZ1bmN0aW9uKCl7cmV0dXJuIGR9KSksbi5kKHQsInIiLChmdW5jdGlvbigpe3JldHVybiBwfSkpLG4uZCh0LCJzIiwoZnVuY3Rpb24oKXtyZXR1cm4gcn0pKSxuLmQodCwibSIsKGZ1bmN0aW9uKCl7cmV0dXJuIG99KSksbi5kKHQsImwiLChmdW5jdGlvbigpe3JldHVybiBofSkpLG4uZCh0LCJhIiwoZnVuY3Rpb24oKXtyZXR1cm4gZn0pKSxuLmQodCwiYyIsKGZ1bmN0aW9uKCl7cmV0dXJuIG19KSksbi5kKHQsIm4iLChmdW5jdGlvbigpe3JldHVybiBnfSkpLG4uZCh0LCJ2IiwoZnVuY3Rpb24oKXtyZXR1cm4gYn0pKSxuLmQodCwiZiIsKGZ1bmN0aW9uKCl7cmV0dXJuIHl9KSksbi5kKHQsImUiLChmdW5jdGlvbigpe3JldHVybiB2fSkpLG4uZCh0LCJnIiwoZnVuY3Rpb24oKXtyZXR1cm4ga30pKSxuLmQodCwiaCIsKGZ1bmN0aW9uKCl7cmV0dXJuIHd9KSksbi5kKHQsImIiLChmdW5jdGlvbigpe3JldHVybiBTfSkpLG4uZCh0LCJvIiwoZnVuY3Rpb24oKXtyZXR1cm4gRX0pKSxuLmQodCwicSIsKGZ1bmN0aW9uKCl7cmV0dXJuIE99KSk7dmFyIHIsbyxhPTEwLGk9MTAscz01LGw9MSxjPTMwLHU9TWF0aC5QSS8xMixkPXtURVhUOiJ0ZXh0IixDUk9TU0hBSVI6ImNyb3NzaGFpciIsR1JBQkJJTkc6ImdyYWJiaW5nIixQT0lOVEVSOiJwb2ludGVyIn0scD17TUFJTjowLFdIRUVMOjEsU0VDT05EQVJZOjIsVE9VQ0g6LTF9OyFmdW5jdGlvbihlKXtlLklOSVQ9IlNDRU5FX0lOSVQiLGUuVVBEQVRFPSJTQ0VORV9VUERBVEUifShyfHwocj17fSkpLGZ1bmN0aW9uKGUpe2UuQ09QWT0iY29weSIsZS5QQVNURT0icGFzdGUiLGUuQ1VUPSJjdXQiLGUuS0VZRE9XTj0ia2V5ZG93biIsZS5LRVlVUD0ia2V5dXAiLGUuTU9VU0VfTU9WRT0ibW91c2Vtb3ZlIixlLlJFU0laRT0icmVzaXplIixlLlVOTE9BRD0idW5sb2FkIixlLkJMVVI9ImJsdXIiLGUuRFJBR19PVkVSPSJkcmFnb3ZlciIsZS5EUk9QPSJkcm9wIixlLkdFU1RVUkVfRU5EPSJnZXN0dXJlZW5kIixlLkJFRk9SRV9VTkxPQUQ9ImJlZm9yZXVubG9hZCIsZS5HRVNUVVJFX1NUQVJUPSJnZXN0dXJlc3RhcnQiLGUuR0VTVFVSRV9DSEFOR0U9Imdlc3R1cmVjaGFuZ2UiLGUuUE9JTlRFUl9NT1ZFPSJwb2ludGVybW92ZSIsZS5QT0lOVEVSX1VQPSJwb2ludGVydXAiLGUuU1RBVEVfQ0hBTkdFPSJzdGF0ZWNoYW5nZSIsZS5XSEVFTD0id2hlZWwiLGUuVE9VQ0hfU1RBUlQ9InRvdWNoc3RhcnQiLGUuVE9VQ0hfRU5EPSJ0b3VjaGVuZCIsZS5IQVNIQ0hBTkdFPSJoYXNoY2hhbmdlIn0ob3x8KG89e30pKTt2YXIgaD17VEVTVDoidGVzdCIsREVWRUxPUE1FTlQ6ImRldmVsb3BtZW50In0sZj17U0VSVkVSX1ZPTEFUSUxFOiJzZXJ2ZXItdm9sYXRpbGUtYnJvYWRjYXN0IixTRVJWRVI6InNlcnZlci1icm9hZGNhc3QifSxtPXtTSEFQRV9BQ1RJT05TX01FTlU6IkFwcC1tZW51X19sZWZ0In0sZz17MToiVmlyZ2lsIiwyOiJIZWx2ZXRpY2EiLDM6IkNhc2NhZGlhIn0sYj0iU2Vnb2UgVUkgRW1vamkiLHk9MjAsdj0xLGs9ImxlZnQiLHc9InRvcCIsUz1bInNlbGVjdEFsbCJdLEU9MjAsTz0iY29sbGFiTGlua0ZvcmNlTG9hZEZsYWcifSxmdW5jdGlvbihlLHQsbil7InVzZSBzdHJpY3QiO24uZCh0LCJCIiwoZnVuY3Rpb24oKXtyZXR1cm4gYy5jfSkpLG4uZCh0LCJEIiwoZnVuY3Rpb24oKXtyZXR1cm4gYy5lfSkpLG4uZCh0LCJJIiwoZnVuY3Rpb24oKXtyZXR1cm4gYy5mfSkpLG4uZCh0LCJDIiwoZnVuY3Rpb24oKXtyZXR1cm4gYy5kfSkpLG4uZCh0LCJkIiwoZnVuY3Rpb24oKXtyZXR1cm4gYy5ifSkpLG4uZCh0LCJqIiwoZnVuY3Rpb24oKXtyZXR1cm4gdS5mfSkpLG4uZCh0LCJrIiwoZnVuY3Rpb24oKXtyZXR1cm4gdS5nfSkpLG4uZCh0LCJmIiwoZnVuY3Rpb24oKXtyZXR1cm4gdS5jfSkpLG4uZCh0LCJlIiwoZnVuY3Rpb24oKXtyZXR1cm4gdS5ifSkpLG4uZCh0LCJhIiwoZnVuY3Rpb24oKXtyZXR1cm4gaH0pKSxuLmQodCwidiIsKGZ1bmN0aW9uKCl7cmV0dXJuIHl9KSksbi5kKHQsInUiLChmdW5jdGlvbigpe3JldHVybiB2fSkpLG4uZCh0LCJ3IiwoZnVuY3Rpb24oKXtyZXR1cm4gRX0pKSxuLmQodCwiZyIsKGZ1bmN0aW9uKCl7cmV0dXJuIE19KSksbi5kKHQsIm0iLChmdW5jdGlvbigpe3JldHVybiBUfSkpLG4uZCh0LCJyIiwoZnVuY3Rpb24oKXtyZXR1cm4gUH0pKSxuLmQodCwiRiIsKGZ1bmN0aW9uKCl7cmV0dXJuIFJ9KSksbi5kKHQsInMiLChmdW5jdGlvbigpe3JldHVybiBZfSkpLG4uZCh0LCJxIiwoZnVuY3Rpb24oKXtyZXR1cm4gWH0pKSxuLmQodCwiYyIsKGZ1bmN0aW9uKCl7cmV0dXJuIEp9KSksbi5kKHQsImgiLChmdW5jdGlvbigpe3JldHVybiAkfSkpLG4uZCh0LCJiIiwoZnVuY3Rpb24oKXtyZXR1cm4gUX0pKSxuLmQodCwiQSIsKGZ1bmN0aW9uKCl7cmV0dXJuIG8uY30pKSxuLmQodCwieCIsKGZ1bmN0aW9uKCl7cmV0dXJuIG8uYX0pKSxuLmQodCwiSCIsKGZ1bmN0aW9uKCl7cmV0dXJuIG9lfSkpLG4uZCh0LCJFIiwoZnVuY3Rpb24oKXtyZXR1cm4gYWV9KSksbi5kKHQsInAiLChmdW5jdGlvbigpe3JldHVybiBzfSkpLG4uZCh0LCJ5IiwoZnVuY3Rpb24oKXtyZXR1cm4gaX0pKSxuLmQodCwibyIsKGZ1bmN0aW9uKCl7cmV0dXJuIGx9KSksbi5kKHQsIkciLChmdW5jdGlvbigpe3JldHVybiBzZX0pKSxuLmQodCwidCIsKGZ1bmN0aW9uKCl7cmV0dXJuIGxlfSkpLG4uZCh0LCJsIiwoZnVuY3Rpb24oKXtyZXR1cm4gY2V9KSksbi5kKHQsImkiLChmdW5jdGlvbigpe3JldHVybiB1ZX0pKSxuLmQodCwibiIsKGZ1bmN0aW9uKCl7cmV0dXJuIGRlfSkpLG4uZCh0LCJ6IiwoZnVuY3Rpb24oKXtyZXR1cm4gcGV9KSk7dmFyIHI9big4KSxvPW4oMTEpLGE9bigzKSxpPWZ1bmN0aW9uKGUpe3JldHVybiBPYmplY3Qoby5iKShlKT9lLnBvaW50cy5sZW5ndGg8MjowPT09ZS53aWR0aCYmMD09PWUuaGVpZ2h0fSxzPWZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1NYXRoLmFicyh0KSxvPU1hdGguYWJzKG4pO2lmKCJsaW5lIj09PWV8fCJhcnJvdyI9PT1lfHwiZHJhdyI9PT1lKXt2YXIgaT1NYXRoLnJvdW5kKE1hdGguYXRhbihvL3IpL2EudCkqYS50OzA9PT1pP249MDppPT09TWF0aC5QSS8yP3Q9MDpuPU1hdGgucm91bmQocipNYXRoLnRhbihpKSkqTWF0aC5zaWduKG4pfHxufWVsc2Uic2VsZWN0aW9uIiE9PWUmJihuPXIqTWF0aC5zaWduKG4pKTtyZXR1cm57d2lkdGg6dCxoZWlnaHQ6bn19LGw9ZnVuY3Rpb24oZSl7dmFyIHQ9e3dpZHRoOmUud2lkdGgsaGVpZ2h0OmUuaGVpZ2h0LHg6ZS54LHk6ZS55fTtpZihlLndpZHRoPDApe3ZhciBuPU1hdGguYWJzKGUud2lkdGgpO3Qud2lkdGg9bix0Lng9ZS54LW59aWYoZS5oZWlnaHQ8MCl7dmFyIHI9TWF0aC5hYnMoZS5oZWlnaHQpO3QuaGVpZ2h0PXIsdC55PWUueS1yfXJldHVybiB0fSxjPW4oMjEpLHU9bigxMCksZD1uKDkpLHA9e21vdXNlOjgscGVuOjE2LHRvdWNoOjI4fSxoPXtlOiEwLHM6ITAsbjohMCx3OiEwfSxmPXtlOiEwLHM6ITAsbjohMCx3OiEwfSxtPXtlOiEwLHM6ITAsbjohMCx3OiEwLG53OiEwLHNlOiEwLHJvdGF0aW9uOiEwfSxnPXtlOiEwLHM6ITAsbjohMCx3OiEwLG5lOiEwLHN3OiEwLHJvdGF0aW9uOiEwfSxiPWZ1bmN0aW9uKGUsdCxuLHIsbyxhLGkpe3ZhciBzPU9iamVjdChkLmgpKGUrbi8yLHQrci8yLG8sYSxpKTtyZXR1cm5bc1swXS1uLzIsc1sxXS1yLzIsbixyXX0seT1mdW5jdGlvbihlLHQsbixyLG8pe3ZhciBhPWVbMF0saT1lWzFdLHM9ZVsyXSxsPWVbM107dm9pZCAwPT09ciYmKHI9Im1vdXNlIiksdm9pZCAwPT09byYmKG89e30pO3ZhciBjPXBbcl0sdT1jL24sZD1jL24saD1jL24sZj1jL24sbT1zLWEsZz1sLWkseT0oYStzKS8yLHY9KGkrbCkvMixrPTQvbix3PShjLTgpLygyKm4pLFM9e253Om8ubnc/dm9pZCAwOmIoYS1rLWgrdyxpLWstZit3LHUsZCx5LHYsdCksbmU6by5uZT92b2lkIDA6YihzK2stdyxpLWstZit3LHUsZCx5LHYsdCksc3c6by5zdz92b2lkIDA6YihhLWstaCt3LGwray13LHUsZCx5LHYsdCksc2U6by5zZT92b2lkIDA6YihzK2stdyxsK2stdyx1LGQseSx2LHQpLHJvdGF0aW9uOm8ucm90YXRpb24/dm9pZCAwOmIoYSttLzItdS8yLGktay1mK3ctMTYvbix1LGQseSx2LHQpfSxFPTUqYy9uO3JldHVybiBNYXRoLmFicyhtKT5FJiYoby5ufHwoUy5uPWIoYSttLzItdS8yLGktay1mK3csdSxkLHksdix0KSksby5zfHwoUy5zPWIoYSttLzItdS8yLGwray13LHUsZCx5LHYsdCkpKSxNYXRoLmFicyhnKT5FJiYoby53fHwoUy53PWIoYS1rLWgrdyxpK2cvMi1kLzIsdSxkLHksdix0KSksby5lfHwoUy5lPWIocytrLXcsaStnLzItZC8yLHUsZCx5LHYsdCkpKSxTfSx2PWZ1bmN0aW9uKGUsdCxuKXt2b2lkIDA9PT1uJiYobj0ibW91c2UiKTt2YXIgcj17fTtpZigiYXJyb3ciPT09ZS50eXBlfHwibGluZSI9PT1lLnR5cGV8fCJkcmF3Ij09PWUudHlwZSl7aWYoMj09PWUucG9pbnRzLmxlbmd0aCl7dmFyIG89ZS5wb2ludHNbMV07MD09PW9bMF18fDA9PT1vWzFdP3I9ZzpvWzBdPjAmJm9bMV08MD9yPW06b1swXT4wJiZvWzFdPjA/cj1nOm9bMF08MCYmb1sxXT4wP3I9bTpvWzBdPDAmJm9bMV08MCYmKHI9Zyl9fWVsc2UidGV4dCI9PT1lLnR5cGUmJihyPWYpO3JldHVybiB5KE9iamVjdCh1LmYpKGUpLGUuYW5nbGUsdCxuLHIpfSxrPW4oMjQpLHc9bigxNCksUz1mdW5jdGlvbihlLHQpe2lmKCJhcnJvdyI9PT1lLnR5cGUpcmV0dXJuITE7dmFyIG49InRyYW5zcGFyZW50IiE9PWUuYmFja2dyb3VuZENvbG9yfHx0LnNlbGVjdGVkRWxlbWVudElkc1tlLmlkXTtyZXR1cm4ibGluZSI9PT1lLnR5cGV8fCJkcmF3Ij09PWUudHlwZT9uJiZPYmplY3QoZC5mKShlLnBvaW50cyk6bn0sRT1mdW5jdGlvbihlLHQsbixyLGEpe3ZhciBpLHMsbCxjPTEwL2EscD1PYmplY3QodS5mKShlKSxoPXBbMF0sZj1wWzFdLG09cFsyXSxnPXBbM10sYj0oaCttKS8yLHk9KGYrZykvMjtpZihuPShpPU9iamVjdChkLmgpKG4scixiLHksLWUuYW5nbGUpKVswXSxyPWlbMV0sImVsbGlwc2UiPT09ZS50eXBlKXt2YXIgdj1NYXRoLmFicyhuLWUueC1lLndpZHRoLzIpLGs9TWF0aC5hYnMoci1lLnktZS5oZWlnaHQvMiksRT0uNzA3LHg9LjcwNyxqPU1hdGguYWJzKGUud2lkdGgpLzIsVD1NYXRoLmFicyhlLmhlaWdodCkvMjtyZXR1cm5bMCwxLDIsM10uZm9yRWFjaCgoZnVuY3Rpb24oZSl7dmFyIHQ9aipFLG49VCp4LHI9KGoqai1UKlQpKk1hdGgucG93KEUsMykvaixvPShUKlQtaipqKSpNYXRoLnBvdyh4LDMpL1QsYT10LXIsaT1uLW8scz12LXIsbD1rLW8sYz1NYXRoLmh5cG90KGksYSksdT1NYXRoLmh5cG90KGwscyk7RT1NYXRoLm1pbigxLE1hdGgubWF4KDAsKHMqYy91K3IpL2opKSx4PU1hdGgubWluKDEsTWF0aC5tYXgoMCwobCpjL3UrbykvVCkpO3ZhciBkPU1hdGguaHlwb3QoeCxFKTtFLz1kLHgvPWR9KSksUyhlLHQpP2oqRS0odi1jKT49MCYmVCp4LShrLWMpPj0wOk1hdGguaHlwb3QoaipFLXYsVCp4LWspPGN9aWYoInJlY3RhbmdsZSI9PT1lLnR5cGUpcmV0dXJuIFMoZSx0KT9uPmgtYyYmbjxtK2MmJnI+Zi1jJiZyPGcrYzpPYmplY3QoZC5jKShuLHIsaCxmLG0sZik8Y3x8T2JqZWN0KGQuYykobixyLG0sZixtLGcpPGN8fE9iamVjdChkLmMpKG4scixtLGcsaCxnKTxjfHxPYmplY3QoZC5jKShuLHIsaCxnLGgsZik8YztpZigiZGlhbW9uZCI9PT1lLnR5cGUpe24tPWUueCxyLT1lLnk7dmFyIFA9T2JqZWN0KHUuZSkoZSksQT1QWzBdLE09UFsxXSxfPVBbMl0sej1QWzNdLEw9UFs0XSxJPVBbNV0sRD1QWzZdLE49UFs3XTtyZXR1cm4gUyhlLHQpPyhNPkkmJihJPShzPVtNLEldKVswXSxNPXNbMV0pLF88RCYmKEQ9KGw9W18sRF0pWzBdLF89bFsxXSksSSs9YyxfKz1jLCgoRC09YyktQSkqKHItTiktKEQtbikqKChNLT1jKS1OKTw9MCYmKEEtXykqKHIteiktKG4tXykqKE0teik8PTAmJihfLUwpKihyLUkpLShuLUwpKih6LUkpPD0wJiYoTC1EKSooci1OKS0obi1EKSooSS1OKTw9MCk6T2JqZWN0KGQuYykobixyLEEsTSxfLHopPGN8fE9iamVjdChkLmMpKG4scixfLHosTCxJKTxjfHxPYmplY3QoZC5jKShuLHIsTCxJLEQsTik8Y3x8T2JqZWN0KGQuYykobixyLEQsTixBLE0pPGN9aWYoT2JqZWN0KG8uYikoZSkpe2lmKCFPYmplY3Qody5iKShlKSlyZXR1cm4hMTt2YXIgRj1PYmplY3Qody5iKShlKTtpZihuPGgtY3x8cjxmLWN8fG4+bStjfHxyPmcrYylyZXR1cm4hMTt2YXIgUj1uLWUueCxCPXItZS55O2lmKFMoZSx0KSlpZihGLnNvbWUoKGZ1bmN0aW9uKGUpe3JldHVybiBPKGUsUixCLGMpfSkpKXJldHVybiEwO3JldHVybiBGLnNvbWUoKGZ1bmN0aW9uKGUpe3JldHVybiBDKGUsUixCLGMpfSkpfWlmKCJ0ZXh0Ij09PWUudHlwZSlyZXR1cm4gbj49aCYmbjw9bSYmcj49ZiYmcjw9ZztpZigic2VsZWN0aW9uIj09PWUudHlwZSlyZXR1cm4gY29uc29sZS53YXJuKCJUaGlzIHNob3VsZCBub3QgaGFwcGVuLCB3ZSBuZWVkIHRvIGludmVzdGlnYXRlIHdoeSBpdCBkb2VzLiIpLCExO3Rocm93IG5ldyBFcnJvcigiVW5pbXBsZW1lbnRlZCB0eXBlICIuY29uY2F0KGUudHlwZSkpfSxPPWZ1bmN0aW9uKGUsdCxuLHIpe2Zvcih2YXIgbz1bXSxhPTAsaT1PYmplY3QodS5kKShlKTthPGkubGVuZ3RoO2ErKyl7dmFyIHM9aVthXTtpZigibW92ZSI9PT1zLm9wKXtpZihvLmxlbmd0aClicmVhaztvLnB1c2goW3MuZGF0YVswXSxzLmRhdGFbMV1dKX1lbHNlImJjdXJ2ZVRvIj09PXMub3AmJihvLnB1c2goW3MuZGF0YVswXSxzLmRhdGFbMV1dKSxvLnB1c2goW3MuZGF0YVsyXSxzLmRhdGFbM11dKSxvLnB1c2goW3MuZGF0YVs0XSxzLmRhdGFbNV1dKSl9aWYoby5sZW5ndGg+PTQpe3ZhciBsPU9iamVjdChrLmEpKG8sMTAsNSk7cmV0dXJuIE9iamVjdChkLmcpKGwsdCxuKX1yZXR1cm4hMX0sQz1mdW5jdGlvbihlLHQsbixyKXt2YXIgbz1PYmplY3QodS5kKShlKSxhPVswLDBdO3JldHVybiBvLnNvbWUoKGZ1bmN0aW9uKGUsbyl7dmFyIGk9ZS5vcCxzPWUuZGF0YTtpZigibW92ZSI9PT1pKWE9cztlbHNlIGlmKCJiY3VydmVUbyI9PT1pKXt2YXIgbD1bc1swXSxzWzFdXSxjPVtzWzJdLHNbM11dLHU9W3NbNF0sc1s1XV0sZD1hO3JldHVybiBhPXUsZnVuY3Rpb24oZSx0LG4scixvLGEpe2Zvcih2YXIgaT1vWzBdLHM9b1sxXSxsPWZ1bmN0aW9uKG8sYSl7cmV0dXJuIE1hdGgucG93KDEtbywzKSpyW2FdKzMqbypNYXRoLnBvdygxLW8sMikqblthXSszKk1hdGgucG93KG8sMikqKDEtbykqdFthXStlW2FdKk1hdGgucG93KG8sMyl9LGM9MDtjPD0xOyl7dmFyIHU9bChjLDApLGQ9bChjLDEpO2lmKE1hdGguc3FydChNYXRoLnBvdyh1LWksMikrTWF0aC5wb3coZC1zLDIpKTxhKXJldHVybiEwO2MrPS4wMX1yZXR1cm4hMX0oZCxsLGMsdSxbdCxuXSxyKX1yZXR1cm4hMX0pKX07ZnVuY3Rpb24geChlLHQpe2lmKG51bGw9PWUpcmV0dXJue307dmFyIG4scixvPWZ1bmN0aW9uKGUsdCl7aWYobnVsbD09ZSlyZXR1cm57fTt2YXIgbixyLG89e30sYT1PYmplY3Qua2V5cyhlKTtmb3Iocj0wO3I8YS5sZW5ndGg7cisrKW49YVtyXSx0LmluZGV4T2Yobik+PTB8fChvW25dPWVbbl0pO3JldHVybiBvfShlLHQpO2lmKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpe3ZhciBhPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7Zm9yKHI9MDtyPGEubGVuZ3RoO3IrKyluPWFbcl0sdC5pbmRleE9mKG4pPj0wfHxPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoZSxuKSYmKG9bbl09ZVtuXSl9cmV0dXJuIG99dmFyIGo9ZnVuY3Rpb24oZSx0LG4pe3JldHVybiB0Pj1lWzBdJiZ0PD1lWzBdK2VbMl0mJm4+PWVbMV0mJm48PWVbMV0rZVszXX0sVD1mdW5jdGlvbihlLHQsbixyLG8sYSl7cmV0dXJuIGUucmVkdWNlKChmdW5jdGlvbihlLGkpe2lmKGUpcmV0dXJuIGU7dmFyIHM9ZnVuY3Rpb24oZSx0LG4scixvLGEpe2lmKCF0LnNlbGVjdGVkRWxlbWVudElkc1tlLmlkXSlyZXR1cm4hMTt2YXIgaT12KGUsbyxhKSxzPWkucm90YXRpb24sbD14KGksWyJyb3RhdGlvbiJdKTtpZihzJiZqKHMsbixyKSlyZXR1cm4icm90YXRpb24iO3ZhciBjPU9iamVjdC5rZXlzKGwpLmZpbHRlcigoZnVuY3Rpb24oZSl7dmFyIHQ9bFtlXTtyZXR1cm4hIXQmJmoodCxuLHIpfSkpO3JldHVybiBjLmxlbmd0aD4wJiZjWzBdfShpLHQsbixyLG8sYSk7cmV0dXJuIHM/e2VsZW1lbnQ6aSxyZXNpemVIYW5kbGU6c306bnVsbH0pLG51bGwpfSxQPWZ1bmN0aW9uKGUsdCxuLHIsbyl7dmFyIGE9ZVswXSxpPWVbMV0scz1lWzJdLGw9ZVszXSxjPXkoW2EsaSxzLGxdLDAscixvLGgpO3JldHVybiBPYmplY3Qua2V5cyhjKS5maW5kKChmdW5jdGlvbihlKXt2YXIgcj1jW2VdO3JldHVybiByJiZqKHIsdCxuKX0pKXx8ITF9LEE9WyJucyIsIm5lc3ciLCJldyIsIm53c2UiXSxNPWZ1bmN0aW9uKGUpe3ZhciB0PWUuZWxlbWVudCxuPWUucmVzaXplSGFuZGxlLHI9dCYmTWF0aC5zaWduKHQuaGVpZ2h0KSpNYXRoLnNpZ24odC53aWR0aCk9PS0xLG89bnVsbDtzd2l0Y2gobil7Y2FzZSJuIjpjYXNlInMiOm89Im5zIjticmVhaztjYXNlInciOmNhc2UiZSI6bz0iZXciO2JyZWFrO2Nhc2UibnciOmNhc2Uic2UiOm89cj8ibmVzdyI6Im53c2UiO2JyZWFrO2Nhc2UibmUiOmNhc2Uic3ciOm89cj8ibndzZSI6Im5lc3ciO2JyZWFrO2Nhc2Uicm90YXRpb24iOnJldHVybiJncmFiIn1yZXR1cm4gbyYmdCYmKG89ZnVuY3Rpb24oZSx0KXt2YXIgbj1BLmluZGV4T2YoZSk7aWYobj49MCl7dmFyIHI9TWF0aC5yb3VuZCh0LyhNYXRoLlBJLzQpKTtlPUFbKG4rciklQS5sZW5ndGhdfXJldHVybiBlfShvLHQuYW5nbGUpKSxvPyIiLmNvbmNhdChvLCItcmVzaXplIik6IiJ9LF89bigzMCksej1uKDIpLEw9ZnVuY3Rpb24oKXtmb3IodmFyIGU9MCx0PTAsbj1hcmd1bWVudHMubGVuZ3RoO3Q8bjt0KyspZSs9YXJndW1lbnRzW3RdLmxlbmd0aDt2YXIgcj1BcnJheShlKSxvPTA7Zm9yKHQ9MDt0PG47dCsrKWZvcih2YXIgYT1hcmd1bWVudHNbdF0saT0wLHM9YS5sZW5ndGg7aTxzO2krKyxvKyspcltvXT1hW2ldO3JldHVybiByfTtmdW5jdGlvbiBJKGUsdCl7dmFyIG49T2JqZWN0LmtleXMoZSk7aWYoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyl7dmFyIHI9T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhlKTt0JiYocj1yLmZpbHRlcigoZnVuY3Rpb24odCl7cmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoZSx0KS5lbnVtZXJhYmxlfSkpKSxuLnB1c2guYXBwbHkobixyKX1yZXR1cm4gbn1mdW5jdGlvbiBEKGUpe2Zvcih2YXIgdD0xO3Q8YXJndW1lbnRzLmxlbmd0aDt0Kyspe3ZhciBuPW51bGwhPWFyZ3VtZW50c1t0XT9hcmd1bWVudHNbdF06e307dCUyP0koT2JqZWN0KG4pLCEwKS5mb3JFYWNoKChmdW5jdGlvbih0KXtOKGUsdCxuW3RdKX0pKTpPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycz9PYmplY3QuZGVmaW5lUHJvcGVydGllcyhlLE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKG4pKTpJKE9iamVjdChuKSkuZm9yRWFjaCgoZnVuY3Rpb24odCl7T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsdCxPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG4sdCkpfSkpfXJldHVybiBlfWZ1bmN0aW9uIE4oZSx0LG4pe3JldHVybiB0IGluIGU/T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsdCx7dmFsdWU6bixlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMCx3cml0YWJsZTohMH0pOmVbdF09bixlfXZhciBGPWZ1bmN0aW9uKGUpe3JldHVybiBlPj0yKk1hdGguUEk/ZS0yKk1hdGguUEk6ZX0sUj1mdW5jdGlvbihlLHQsbixhLGkscyxsLGMsdSxkLHAsaCl7aWYoMT09PW4ubGVuZ3RoKXt2YXIgZj1uWzBdO3JldHVybiJyb3RhdGlvbiI9PT1lP0IoZixjLHUsaSk6IU9iamVjdChvLmIpKGYpfHwyIT09Zi5wb2ludHMubGVuZ3RofHwibnciIT09ZSYmIm5lIiE9PWUmJiJzdyIhPT1lJiYic2UiIT09ZT8idGV4dCIhPT1mLnR5cGV8fCJudyIhPT1lJiYibmUiIT09ZSYmInN3IiE9PWUmJiJzZSIhPT1lP2UmJihLKGYsZSxzLGwsYyx1KSx0KGZ1bmN0aW9uKGUsdCl7aWYoZS53aWR0aD49MCYmZS5oZWlnaHQ+PTApcmV0dXJuIHQ7aWYoZS53aWR0aDwwJiZlLmhlaWdodDwwKXN3aXRjaCh0KXtjYXNlIm53IjpyZXR1cm4ic2UiO2Nhc2UibmUiOnJldHVybiJzdyI7Y2FzZSJzZSI6cmV0dXJuIm53IjtjYXNlInN3IjpyZXR1cm4ibmUifWVsc2UgaWYoZS53aWR0aDwwKXN3aXRjaCh0KXtjYXNlIm53IjpyZXR1cm4ibmUiO2Nhc2UibmUiOnJldHVybiJudyI7Y2FzZSJzZSI6cmV0dXJuInN3IjtjYXNlInN3IjpyZXR1cm4ic2UiO2Nhc2UiZSI6cmV0dXJuInciO2Nhc2UidyI6cmV0dXJuImUifWVsc2Ugc3dpdGNoKHQpe2Nhc2UibnciOnJldHVybiJzdyI7Y2FzZSJuZSI6cmV0dXJuInNlIjtjYXNlInNlIjpyZXR1cm4ibmUiO2Nhc2Uic3ciOnJldHVybiJudyI7Y2FzZSJuIjpyZXR1cm4icyI7Y2FzZSJzIjpyZXR1cm4ibiJ9cmV0dXJuIHR9KGYsZSkpLGYud2lkdGg8MCYmT2JqZWN0KHIuYSkoZix7d2lkdGg6LWYud2lkdGh9KSxmLmhlaWdodDwwJiZPYmplY3Qoci5hKShmLHtoZWlnaHQ6LWYuaGVpZ2h0fSkpOlYoZixlLGwsYyx1KTpIKGYsYSxpLGMsdSksZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLmN1cnNvcj1NKHtlbGVtZW50OmYscmVzaXplSGFuZGxlOmV9KSwhMH1pZihuLmxlbmd0aD4xKXtpZigicm90YXRpb24iPT09ZSlyZXR1cm4gcShuLGMsdSxpLGQscCxoKSwhMDtpZigibnciPT09ZXx8Im5lIj09PWV8fCJzdyI9PT1lfHwic2UiPT09ZSlyZXR1cm4gWihuLGUsYyx1KSwhMH1yZXR1cm4hMX0sQj1mdW5jdGlvbihlLHQsbixvKXt2YXIgaT1PYmplY3QodS5mKShlKSxzPWlbMF0sbD1pWzFdLGM9KHMraVsyXSkvMixkPShsK2lbM10pLzIscD01Kk1hdGguUEkvMitNYXRoLmF0YW4yKG4tZCx0LWMpO28mJihwKz1hLnQvMixwLT1wJWEudCkscD1GKHApLE9iamVjdChyLmEpKGUse2FuZ2xlOnB9KX0sSD1mdW5jdGlvbihlLHQsbixvLGEpe3ZhciBpPWUucG9pbnRzWzBdLGw9ZS5wb2ludHNbMV07aWYoImVuZCI9PT10KWlmKG4pe3ZhciBjPXMoZS50eXBlLG8tZS54LGEtZS55KSx1PWMud2lkdGgsZD1jLmhlaWdodDtPYmplY3Qoci5hKShlLHtwb2ludHM6W2ksW3UsZF1dfSl9ZWxzZSBPYmplY3Qoci5hKShlLHtwb2ludHM6W2ksW28taVswXS1lLngsYS1pWzFdLWUueV1dfSk7ZWxzZSBpZihuKXt2YXIgcD1zKGUudHlwZSxlLngrbFswXS1pWzBdLW8sZS55K2xbMV0taVsxXS1hKTt1PXAud2lkdGgsZD1wLmhlaWdodDtPYmplY3Qoci5hKShlLHt4OmUueCtsWzBdLWlbMF0tdSx5OmUueStsWzFdLWlbMV0tZCxwb2ludHM6W2ksW3UsZF1dfSl9ZWxzZSBPYmplY3Qoci5hKShlLHt4Om8seTphLHBvaW50czpbaSxbbFswXS0oby1pWzBdLWUueCksbFsxXS0oYS1pWzFdLWUueSldXX0pfSxHPWZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gT2JqZWN0KG8uYikoZSk/e3BvaW50czpPYmplY3QoXy5iKSgwLHQsT2JqZWN0KF8uYikoMSxuLGUucG9pbnRzKSl9Ont9fSxXPWZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1lLmZvbnRTaXplKih0L2Uud2lkdGgpO2lmKHI8MSlyZXR1cm4gbnVsbDt2YXIgbz1PYmplY3Qoei5xKShlLnRleHQsT2JqZWN0KHouaSkoe2ZvbnRTaXplOnIsZm9udEZhbWlseTplLmZvbnRGYW1pbHl9KSk7cmV0dXJue3NpemU6cixiYXNlbGluZTpvLmJhc2VsaW5lKyhuLW8uaGVpZ2h0KX19LFU9ZnVuY3Rpb24oZSx0KXtyZXR1cm57bjovXihufG5lfG53KSQvLnRlc3QoZSl8fHQmJi9eKHN8c2V8c3cpJC8udGVzdChlKSxzOi9eKHN8c2V8c3cpJC8udGVzdChlKXx8dCYmL14obnxuZXxudykkLy50ZXN0KGUpLHc6L14od3xud3xzdykkLy50ZXN0KGUpfHx0JiYvXihlfG5lfHNlKSQvLnRlc3QoZSksZTovXihlfG5lfHNlKSQvLnRlc3QoZSl8fHQmJi9eKHd8bnd8c3cpJC8udGVzdChlKX19LFY9ZnVuY3Rpb24oZSx0LG4sbyxhKXt2YXIgaSxzPU9iamVjdCh1LmYpKGUpLGw9c1swXSxjPXNbMV0scD1zWzJdLGg9c1szXSxmPShsK3ApLzIsbT0oYytoKS8yLGc9T2JqZWN0KGQuaCkobyxhLGYsbSwtZS5hbmdsZSksYj1nWzBdLHk9Z1sxXTtzd2l0Y2godCl7Y2FzZSJzZSI6aT1NYXRoLm1heCgoYi1sKS8ocC1sKSwoeS1jKS8oaC1jKSk7YnJlYWs7Y2FzZSJudyI6aT1NYXRoLm1heCgocC1iKS8ocC1sKSwoaC15KS8oaC1jKSk7YnJlYWs7Y2FzZSJuZSI6aT1NYXRoLm1heCgoYi1sKS8ocC1sKSwoaC15KS8oaC1jKSk7YnJlYWs7Y2FzZSJzdyI6aT1NYXRoLm1heCgocC1iKS8ocC1sKSwoeS1jKS8oaC1jKSl9aWYoaT4wKXt2YXIgdj1lLndpZHRoKmksaz1lLmhlaWdodCppLHc9VyhlLHYsayk7aWYobnVsbD09PXcpcmV0dXJuO3ZhciBTPU9iamVjdCh1LmkpKGUsdixrKSxFPShsLVNbMF0pLzIsTz0oYy1TWzFdKS8yLEM9KHAtU1syXSkvMix4PShoLVNbM10pLzIsaj1PYmplY3QoZC5hKShVKHQsbiksZS54LGUueSxlLmFuZ2xlLEUsTyxDLHgpLFQ9alswXSxQPWpbMV07T2JqZWN0KHIuYSkoZSx7Zm9udFNpemU6dy5zaXplLHdpZHRoOnYsaGVpZ2h0OmssYmFzZWxpbmU6dy5iYXNlbGluZSx4OlQseTpQfSl9fSxLPWZ1bmN0aW9uKGUsdCxuLGEsaSxzKXt2YXIgbD1PYmplY3QodS5mKShlKSxjPWxbMF0scD1sWzFdLGg9bFsyXSxmPWxbM10sbT0oYytoKS8yLGc9KHArZikvMixiPU9iamVjdChkLmgpKGkscyxtLGcsLWUuYW5nbGUpLHk9YlswXSx2PWJbMV0saz0xLHc9MTsiZSIhPT10JiYibmUiIT09dCYmInNlIiE9PXR8fChrPSh5LWMpLyhoLWMpKSwicyIhPT10JiYic3ciIT09dCYmInNlIiE9PXR8fCh3PSh2LXApLyhmLXApKSwidyIhPT10JiYibnciIT09dCYmInN3IiE9PXR8fChrPShoLXkpLyhoLWMpKSwibiIhPT10JiYibnciIT09dCYmIm5lIiE9PXR8fCh3PShmLXYpLyhmLXApKTt2YXIgUz1lLndpZHRoKmssRT1lLmhlaWdodCp3O24mJihTPUU9TWF0aC5tYXgoUyxFKSk7dmFyIE89T2JqZWN0KHUuaSkoZSxTLEUpLEM9T1swXSx4PU9bMV0saj1PWzJdLFQ9T1szXSxQPShjLUMpLzIsQT0ocC14KS8yLE09KGgtaikvMixfPShmLVQpLzIsej1HKGUsUyxFKSxMPU9iamVjdCh1LmkpKEQoRCh7fSxlKSx6KSxNYXRoLmFicyhTKSxNYXRoLmFicyhFKSksST1MWzBdLE49TFsxXSxGPUxbMl0sUj1MWzNdLEI9T2JqZWN0KGQuZCkodCxTLEUsQyx4LGosVCxJLE4sRixSLE9iamVjdChvLmIpKGUpLGUuYW5nbGUpLEg9QlswXSxXPUJbMV0sVj1PYmplY3QoZC5hKShVKHQsYSksZS54LUgsZS55LVcsZS5hbmdsZSxQLEEsTSxfKSxLPVZbMF0sWj1WWzFdOzAhPT1TJiYwIT09RSYmTnVtYmVyLmlzRmluaXRlKEspJiZOdW1iZXIuaXNGaW5pdGUoWikmJk9iamVjdChyLmEpKGUsRCh7d2lkdGg6UyxoZWlnaHQ6RSx4OksseTpafSx6KSl9LFo9ZnVuY3Rpb24oZSx0LG4sbyl7dmFyIGEsaSxzPU9iamVjdCh1LmMpKGUpLGw9c1swXSxjPXNbMV0sZD1zWzJdLHA9c1szXTtzd2l0Y2godCl7Y2FzZSJzZSI6YT1NYXRoLm1heCgobi1sKS8oZC1sKSwoby1jKS8ocC1jKSksaT1mdW5jdGlvbihlLHQsbil7dmFyIHI9dFswXSxvPXRbMV0saT1uWzBdLHM9blsxXTtyZXR1cm57eDplLngrKHItbCkqKGEtMSkrci1pLHk6ZS55KyhvLWMpKihhLTEpK28tc319O2JyZWFrO2Nhc2UibnciOmE9TWF0aC5tYXgoKGQtbikvKGQtbCksKHAtbykvKHAtYykpLGk9ZnVuY3Rpb24oZSx0LG4pe3ZhciByPXRbMl0sbz10WzNdLGk9blsyXSxzPW5bM107cmV0dXJue3g6ZS54LShkLXIpKihhLTEpK3ItaSx5OmUueS0ocC1vKSooYS0xKStvLXN9fTticmVhaztjYXNlIm5lIjphPU1hdGgubWF4KChuLWwpLyhkLWwpLChwLW8pLyhwLWMpKSxpPWZ1bmN0aW9uKGUsdCxuKXt2YXIgcj10WzBdLG89dFszXSxpPW5bMF0scz1uWzNdO3JldHVybnt4OmUueCsoci1sKSooYS0xKStyLWkseTplLnktKHAtbykqKGEtMSkrby1zfX07YnJlYWs7Y2FzZSJzdyI6YT1NYXRoLm1heCgoZC1uKS8oZC1sKSwoby1jKS8ocC1jKSksaT1mdW5jdGlvbihlLHQsbil7dmFyIHI9dFsxXSxvPXRbMl0saT1uWzFdLHM9blsyXTtyZXR1cm57eDplLngtKGQtbykqKGEtMSkrby1zLHk6ZS55KyhyLWMpKihhLTEpK3ItaX19fWlmKGE+MCl7dmFyIGg9ZS5yZWR1Y2UoKGZ1bmN0aW9uKGUsdCl7aWYoIWUpcmV0dXJuIGU7dmFyIG49dC53aWR0aCphLHI9dC5oZWlnaHQqYSxvPXt9O2lmKCJ0ZXh0Ij09PXQudHlwZSl7dmFyIHM9Vyh0LG4scik7aWYobnVsbD09PXMpcmV0dXJuIG51bGw7bz17Zm9udFNpemU6cy5zaXplLGJhc2VsaW5lOnMuYmFzZWxpbmV9fXZhciBsPU9iamVjdCh1LmYpKHQpLGM9Ryh0LG4sciksZD1PYmplY3QodS5pKShEKEQoe30sdCksYyksbixyKSxwPWkodCxsLGQpLGg9cC54LGY9cC55O3JldHVybiBMKGUsW0QoRCh7d2lkdGg6bixoZWlnaHQ6cix4OmgseTpmfSxjKSxvKV0pfSksW10pO2gmJmUuZm9yRWFjaCgoZnVuY3Rpb24oZSx0KXtPYmplY3Qoci5hKShlLGhbdF0pfSkpfX0scT1mdW5jdGlvbihlLHQsbixpLHMsbCxjKXt2YXIgcD01Kk1hdGguUEkvMitNYXRoLmF0YW4yKG4tbCx0LXMpO2kmJihwKz1hLnQvMixwLT1wJWEudCksZS5mb3JFYWNoKChmdW5jdGlvbihlLHQpe2lmKE9iamVjdChvLmIpKGUpJiYyPT09ZS5wb2ludHMubGVuZ3RoKXt2YXIgbj1jW3RdO2lmKCFPYmplY3Qoby5iKShuKXx8MiE9PW4ucG9pbnRzLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoIm9yaWdpbmFsIGVsZW1lbnQgbm90IGNvbXBhdGlibGUiKTt2YXIgYT1PYmplY3QodS5mKShuKSxpPWFbMF0saD1hWzFdLGY9KGkrYVsyXSkvMixtPShoK2FbM10pLzIsZz1PYmplY3QoZC5oKShmLG0scyxsLHApLGI9Z1swXSx5PWdbMV0sdj1uLnBvaW50cyxrPU9iamVjdChkLmgpKHZbMV1bMF0sdlsxXVsxXSx2WzBdWzBdLHZbMF1bMV0scCksdz1rWzBdLFM9a1sxXTtPYmplY3Qoci5hKShlLHt4Om4ueCsoYi1mKSsoKG4ucG9pbnRzWzBdWzBdK24ucG9pbnRzWzFdWzBdKS8yLSh2WzBdWzBdK3cpLzIpLHk6bi55Kyh5LW0pKygobi5wb2ludHNbMF1bMV0rbi5wb2ludHNbMV1bMV0pLzItKHZbMF1bMV0rUykvMikscG9pbnRzOltbdlswXVswXSx2WzBdWzFdXSxbdyxTXV19KX1lbHNle3ZhciBFPU9iamVjdCh1LmYpKGUpLE89KGk9RVswXSxoPUVbMV0sZj0oaStFWzJdKS8yLG09KGgrRVszXSkvMixPYmplY3QoZC5oKShmLG0scyxsLHArY1t0XS5hbmdsZS1lLmFuZ2xlKSk7Yj1PWzBdLHk9T1sxXTtPYmplY3Qoci5hKShlLHt4OmUueCsoYi1mKSx5OmUueSsoeS1tKSxhbmdsZTpGKHArY1t0XS5hbmdsZSl9KX19KSl9LFk9ZnVuY3Rpb24oZSx0LG4scil7dmFyIG8sYT0xPT09dC5sZW5ndGg/T2JqZWN0KHUuZikodFswXSk6T2JqZWN0KHUuYykodCksaT1hWzBdLHM9YVsxXSxsPWFbMl0sYz1hWzNdLHA9KGkrbCkvMixoPShzK2MpLzIsZj0xPT09dC5sZW5ndGg/dFswXS5hbmdsZTowO3N3aXRjaChuPShvPU9iamVjdChkLmgpKG4scixwLGgsLWYpKVswXSxyPW9bMV0sZSl7Y2FzZSJuIjpyZXR1cm4gT2JqZWN0KGQuaCkobi0oaStsKS8yLHItcywwLDAsZik7Y2FzZSJzIjpyZXR1cm4gT2JqZWN0KGQuaCkobi0oaStsKS8yLHItYywwLDAsZik7Y2FzZSJ3IjpyZXR1cm4gT2JqZWN0KGQuaCkobi1pLHItKHMrYykvMiwwLDAsZik7Y2FzZSJlIjpyZXR1cm4gT2JqZWN0KGQuaCkobi1sLHItKHMrYykvMiwwLDAsZik7Y2FzZSJudyI6cmV0dXJuIE9iamVjdChkLmgpKG4taSxyLXMsMCwwLGYpO2Nhc2UibmUiOnJldHVybiBPYmplY3QoZC5oKShuLWwsci1zLDAsMCxmKTtjYXNlInN3IjpyZXR1cm4gT2JqZWN0KGQuaCkobi1pLHItYywwLDAsZik7Y2FzZSJzZSI6cmV0dXJuIE9iamVjdChkLmgpKG4tbCxyLWMsMCwwLGYpO2RlZmF1bHQ6cmV0dXJuWzAsMF19fSxYPWZ1bmN0aW9uKGUsdCl7dmFyIG49dC5wb2ludHNbMV0scj1uWzBdLG89blsxXTtyZXR1cm4ibnciPT09ZSYmKHI8MHx8bzwwKXx8Im5lIj09PWUmJnI+PTB8fCJzdyI9PT1lJiZyPD0wfHwic2UiPT09ZSYmKHI+MHx8bz4wKT8iZW5kIjoib3JpZ2luIn0sSj1mdW5jdGlvbihlLHQsbil7dmFyIG89T2JqZWN0KHUuYykoZSksYT1vWzBdLGk9b1sxXTtlLmZvckVhY2goKGZ1bmN0aW9uKGUpe09iamVjdChyLmEpKGUse3g6dCtlLngtYSx5Om4rZS55LWl9KX0pKX0sJD1mdW5jdGlvbihlLHQsbil7dmFyIHI9T2JqZWN0KHUuYykoZSk7cmV0dXJuW3QtclswXSxuLXJbMV1dfSxRPWZ1bmN0aW9uKGUsdCxuLG8sYSxpLGwsYyx1LGQpe3ZhciBwO3UmJihsPShwPXModCxsLGk8bz8tYzpjKSkud2lkdGgsKGM9cC5oZWlnaHQpPDAmJihjPS1jKSk7dmFyIGg9YTxuP24tbDpuLGY9aTxvP28tYzpvO2QmJihoPW4tKGwrPWwpLzIsZj1vLShjKz1jKS8yKSwwIT09bCYmMCE9PWMmJk9iamVjdChyLmEpKGUse3g6aCx5OmYsd2lkdGg6bCxoZWlnaHQ6Y30pfSxlZT1uKDUpLHRlPW4oMjIpLG5lPWZ1bmN0aW9uKGUpe3JldHVybiBlLnJlcGxhY2UoL1x0L2csIiAgICAgICAgIikucmVwbGFjZSgvXHI/XG58XHIvZywiXG4iKX0scmU9ZnVuY3Rpb24oZSx0LG4scil7dmFyIG89ci56b29tLGE9ci5vZmZzZXRUb3AsaT1yLm9mZnNldExlZnQscz0xODAqbi9NYXRoLlBJO3JldHVybiJ0cmFuc2xhdGUoIi5jb25jYXQoKGUtMippKSooby0xKS8yLCJweCwgIikuY29uY2F0KCh0LTIqYSkqKG8tMSkvMiwicHgpIHNjYWxlKCIpLmNvbmNhdChvLCIpIHJvdGF0ZSgiKS5jb25jYXQocywiZGVnKSIpfSxvZT1mdW5jdGlvbihlKXt2YXIgdD1lLmlkLG49ZS5hcHBTdGF0ZSxyPWUub25DaGFuZ2UsaT1lLm9uU3VibWl0LHM9ZS5nZXRWaWV3cG9ydENvb3JkcyxsPWUuZWxlbWVudDtmdW5jdGlvbiBjKCl7dmFyIGUscj1udWxsPT09KGU9dGUuYS5nZXRTY2VuZShsKSl8fHZvaWQgMD09PWU/dm9pZCAwOmUuZ2V0RWxlbWVudCh0KTtpZihyJiZPYmplY3Qoby5jKShyKSl7dmFyIGE9cyhyLngsci55KSxpPWFbMF0sYz1hWzFdLGQ9ci50ZXh0QWxpZ24scD1yLmFuZ2xlO3UudmFsdWU9ci50ZXh0O3ZhciBoPXIudGV4dC5yZXBsYWNlKC9cclxuPy9nLCJcbiIpLnNwbGl0KCJcbiIpLGY9ci5oZWlnaHQvaC5sZW5ndGg7T2JqZWN0LmFzc2lnbih1LnN0eWxlLHtmb250Ok9iamVjdCh6LmkpKHIpLGxpbmVIZWlnaHQ6IiIuY29uY2F0KGYsInB4Iiksd2lkdGg6IiIuY29uY2F0KHIud2lkdGgsInB4IiksaGVpZ2h0OiIiLmNvbmNhdChyLmhlaWdodCwicHgiKSxsZWZ0OiIiLmNvbmNhdChpLCJweCIpLHRvcDoiIi5jb25jYXQoYywicHgiKSx0cmFuc2Zvcm06cmUoci53aWR0aCxyLmhlaWdodCxwLG4pLHRleHRBbGlnbjpkLGNvbG9yOnIuc3Ryb2tlQ29sb3Isb3BhY2l0eTpyLm9wYWNpdHkvMTAwfSl9fXZhciB1PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInRleHRhcmVhIik7dS5kaXI9ImF1dG8iLHUudGFiSW5kZXg9MCx1LmRhdGFzZXQudHlwZT0id3lzaXd5ZyIsdS53cmFwPSJvZmYiLE9iamVjdC5hc3NpZ24odS5zdHlsZSx7cG9zaXRpb246ImZpeGVkIixkaXNwbGF5OiJpbmxpbmUtYmxvY2siLG1pbkhlaWdodDoiMWVtIixiYWNrZmFjZVZpc2liaWxpdHk6ImhpZGRlbiIsbWFyZ2luOjAscGFkZGluZzowLGJvcmRlcjowLG91dGxpbmU6MCxyZXNpemU6Im5vbmUiLGJhY2tncm91bmQ6InRyYW5zcGFyZW50IixvdmVyZmxvdzoiaGlkZGVuIix3aGl0ZVNwYWNlOiJwcmUifSksYygpLHImJih1Lm9uaW5wdXQ9ZnVuY3Rpb24oKXtyKG5lKHUudmFsdWUpKX0pLHUub25rZXlkb3duPWZ1bmN0aW9uKGUpe2lmKGUua2V5PT09ZWUuYS5FU0NBUEUpZS5wcmV2ZW50RGVmYXVsdCgpLHAoKTtlbHNlIGlmKGUua2V5PT09ZWUuYS5FTlRFUiYmZVtlZS5hLkNUUkxfT1JfQ01EXSl7aWYoZS5wcmV2ZW50RGVmYXVsdCgpLGUuaXNDb21wb3Npbmd8fDIyOT09PWUua2V5Q29kZSlyZXR1cm47cCgpfWVsc2UgZS5rZXkhPT1lZS5hLkVOVEVSfHxlLmFsdEtleXx8ZS5zdG9wUHJvcGFnYXRpb24oKX07dmFyIGQ9ZnVuY3Rpb24oZSl7ZS5zdG9wUHJvcGFnYXRpb24oKX0scD1mdW5jdGlvbigpe2kobmUodS52YWx1ZSkpLGgoKX0saD1mdW5jdGlvbigpe2J8fChiPSEwLHUub25ibHVyPW51bGwsdS5vbmlucHV0PW51bGwsdS5vbmtleWRvd249bnVsbCx3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigicmVzaXplIixjKSx3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigid2hlZWwiLGQsITApLHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCJwb2ludGVyZG93biIsbSksd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoInBvaW50ZXJ1cCIsZiksd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoImJsdXIiLHApLGcoKSxkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKHUpKX0sZj1mdW5jdGlvbigpe3dpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCJwb2ludGVydXAiLGYpLHNldFRpbWVvdXQoKGZ1bmN0aW9uKCl7dS5vbmJsdXI9cCx1LmZvY3VzKCl9KSl9LG09ZnVuY3Rpb24oZSl7ZS50YXJnZXQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCYmZS50YXJnZXQuY2xvc2VzdCgiLiIuY29uY2F0KGEuYy5TSEFQRV9BQ1RJT05TX01FTlUpKSYmIU9iamVjdCh6LnApKGUudGFyZ2V0KSYmKHUub25ibHVyPW51bGwsd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInBvaW50ZXJ1cCIsZiksd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoImJsdXIiLHApKX0sZz10ZS5hLmdldFNjZW5lKGwpLmFkZENhbGxiYWNrKChmdW5jdGlvbigpe2MoKSx1LmZvY3VzKCl9KSksYj0hMTt1Lm9uYmx1cj1wLHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJyZXNpemUiLGMpLHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJwb2ludGVyZG93biIsbSksd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoIndoZWVsIixkLCEwKSxkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHUpLHUuZm9jdXMoKSx1LnNlbGVjdCgpfSxhZT1mdW5jdGlvbihlKXt2YXIgdD1PYmplY3Qoei5xKShlLnRleHQsT2JqZWN0KHouaSkoZSkpO09iamVjdChyLmEpKGUse3dpZHRoOnQud2lkdGgsaGVpZ2h0OnQuaGVpZ2h0LGJhc2VsaW5lOnQuYmFzZWxpbmV9KX0saWU9big2KSxzZT1mdW5jdGlvbihlLHQpe3JldHVybiBCb29sZWFuKGUuZWRpdGluZ0VsZW1lbnR8fE9iamVjdChpZS5nKSh0LGUpLmxlbmd0aHx8InNlbGVjdGlvbiIhPT1lLmVsZW1lbnRUeXBlKX0sbGU9ZnVuY3Rpb24oZSl7cmV0dXJuIGUuZmlsdGVyKChmdW5jdGlvbihlKXtyZXR1cm4gZS5pc0RlbGV0ZWR8fCFpKGUpfSkpfSxjZT1mdW5jdGlvbihlKXtyZXR1cm4gZS5yZWR1Y2UoKGZ1bmN0aW9uKGUsdCl7cmV0dXJuIGVbdC5pZF09dCxlfSkse30pfSx1ZT1mdW5jdGlvbihlKXtyZXR1cm4gZS5yZWR1Y2UoKGZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUrdC52ZXJzaW9ufSksMCl9LGRlPWZ1bmN0aW9uKGUpe3JldHVybiBlLmZpbHRlcigoZnVuY3Rpb24oZSl7cmV0dXJuIWUuaXNEZWxldGVkfSkpfSxwZT1mdW5jdGlvbihlKXtyZXR1cm4hZS5pc0RlbGV0ZWR9fSxmdW5jdGlvbihlLHQsbil7InVzZSBzdHJpY3QiO24uZCh0LCJmIiwoZnVuY3Rpb24oKXtyZXR1cm4gcn0pKSxuLmQodCwiYSIsKGZ1bmN0aW9uKCl7cmV0dXJuIG99KSksbi5kKHQsImUiLChmdW5jdGlvbigpe3JldHVybiBhfSkpLG4uZCh0LCJiIiwoZnVuY3Rpb24oKXtyZXR1cm4gaX0pKSxuLmQodCwiYyIsKGZ1bmN0aW9uKCl7cmV0dXJuIHN9KSksbi5kKHQsImQiLChmdW5jdGlvbigpe3JldHVybiBsfSkpO3ZhciByPS9NYWN8aVBvZHxpUGhvbmV8aVBhZC8udGVzdCh3aW5kb3cubmF2aWdhdG9yLnBsYXRmb3JtKSxvPXtBUlJPV19MRUZUOiJBcnJvd0xlZnQiLEFSUk9XX1JJR0hUOiJBcnJvd1JpZ2h0IixBUlJPV19ET1dOOiJBcnJvd0Rvd24iLEFSUk9XX1VQOiJBcnJvd1VwIixFTlRFUjoiRW50ZXIiLEVTQ0FQRToiRXNjYXBlIixERUxFVEU6IkRlbGV0ZSIsQkFDS1NQQUNFOiJCYWNrc3BhY2UiLENUUkxfT1JfQ01EOnI/Im1ldGFLZXkiOiJjdHJsS2V5IixUQUI6IlRhYiIsU1BBQ0U6IiAiLFFVRVNUSU9OX01BUks6Ij8iLEZfS0VZX0NPREU6NzAsQUxUX0tFWV9DT0RFOjE4LFpfS0VZX0NPREU6OTAsR1JJRF9LRVlfQ09ERToyMjIsR19LRVlfQ09ERTo3MSxDX0tFWV9DT0RFOjY3LFZfS0VZX0NPREU6ODZ9LGE9ZnVuY3Rpb24oZSl7cmV0dXJuIGU9PT1vLkFSUk9XX0xFRlR8fGU9PT1vLkFSUk9XX1JJR0hUfHxlPT09by5BUlJPV19ET1dOfHxlPT09by5BUlJPV19VUH0saT1mdW5jdGlvbihlKXtyZXR1cm4gZS5hbHRLZXl8fGUud2hpY2g9PT1vLkFMVF9LRVlfQ09ERX0scz1mdW5jdGlvbihlKXtyZXR1cm4gZS5zaGlmdEtleX0sbD1mdW5jdGlvbihlKXtyZXR1cm4gZS5zaGlmdEtleX19LGZ1bmN0aW9uKGUsdCxuKXsidXNlIHN0cmljdCI7bi5kKHQsIm0iLChmdW5jdGlvbigpe3JldHVybiByLmV9KSksbi5kKHQsIm4iLChmdW5jdGlvbigpe3JldHVybiBvLmV9KSksbi5kKHQsImUiLChmdW5jdGlvbigpe3JldHVybiBvLmJ9KSksbi5kKHQsImIiLChmdW5jdGlvbigpe3JldHVybiBvLmF9KSksbi5kKHQsImciLChmdW5jdGlvbigpe3JldHVybiBvLmN9KSksbi5kKHQsImgiLChmdW5jdGlvbigpe3JldHVybiBvLmR9KSksbi5kKHQsIm8iLChmdW5jdGlvbigpe3JldHVybiBhLmJ9KSksbi5kKHQsImEiLChmdW5jdGlvbigpe3JldHVybiBhLmF9KSksbi5kKHQsImoiLChmdW5jdGlvbigpe3JldHVybiBzfSkpLG4uZCh0LCJrIiwoZnVuY3Rpb24oKXtyZXR1cm4gbH0pKSxuLmQodCwiYyIsKGZ1bmN0aW9uKCl7cmV0dXJuIHV9KSksbi5kKHQsImQiLChmdW5jdGlvbigpe3JldHVybiBkfSkpLG4uZCh0LCJsIiwoZnVuY3Rpb24oKXtyZXR1cm4gY30pKSxuLmQodCwiaSIsKGZ1bmN0aW9uKCl7cmV0dXJuIHB9KSksbi5kKHQsImYiLChmdW5jdGlvbigpe3JldHVybiBofSkpO3ZhciByPW4oMTkpLG89bigyOCksYT1uKDM1KSxpPW4oNCkscz1mdW5jdGlvbihlKXtyZXR1cm4icmVjdGFuZ2xlIj09PWV8fCJlbGxpcHNlIj09PWV8fCJkaWFtb25kIj09PWV8fCJkcmF3Ij09PWV8fCJsaW5lIj09PWV9LGw9ZnVuY3Rpb24oZSl7cmV0dXJuInJlY3RhbmdsZSI9PT1lfHwiZWxsaXBzZSI9PT1lfHwiZGlhbW9uZCI9PT1lfHwiYXJyb3ciPT09ZXx8ImRyYXciPT09ZXx8ImxpbmUiPT09ZX0sYz1mdW5jdGlvbihlKXtyZXR1cm4idGV4dCI9PT1lfSx1PWZ1bmN0aW9uKGUsdCxuLHIsbyl7Zm9yKHZhciBhPW51bGwscz1lLmxlbmd0aC0xO3M+PTA7LS1zKWlmKCFlW3NdLmlzRGVsZXRlZCYmT2JqZWN0KGkudykoZVtzXSx0LG4scixvKSl7YT1lW3NdO2JyZWFrfXJldHVybiBhfSxkPWZ1bmN0aW9uKGUsdCxuKXtmb3IodmFyIHI9bnVsbCxvPWUubGVuZ3RoLTE7bz49MDstLW8paWYoIWVbb10uaXNEZWxldGVkKXt2YXIgYT1PYmplY3QoaS5qKShlW29dKSxzPWFbMF0sbD1hWzFdLGM9YVsyXSx1PWFbM107aWYoczx0JiZ0PGMmJmw8biYmbjx1KXtyPWVbb107YnJlYWt9fXJldHVybiByfSxwPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIG51bGw9PT1lfHxudWxsPT09ZS5nZXRDb250ZXh0KCIyZCIpP3t4OjAseTowfTp7eDplLndpZHRoL3QvMix5OmUuaGVpZ2h0L3QvMn19LGg9ZnVuY3Rpb24oZSl7dmFyIHQ9cGFyc2VGbG9hdChlLnRvRml4ZWQoMikpO3JldHVybiBNYXRoLm1heCguMSxNYXRoLm1pbih0LDIpKX19LGZ1bmN0aW9uKGUpe2UuZXhwb3J0cz1KU09OLnBhcnNlKCd7IndoaXRlIjoiI2ZmZmZmZiIsImJsYWNrIjoiIzAwMDAwMCIsImdyYXkiOlsiI2Y4ZjlmYSIsIiNmMWYzZjUiLCIjZTllY2VmIiwiI2RlZTJlNiIsIiNjZWQ0ZGEiLCIjYWRiNWJkIiwiIzg2OGU5NiIsIiM0OTUwNTciLCIjMzQzYTQwIiwiIzIxMjUyOSJdLCJyZWQiOlsiI2ZmZjVmNSIsIiNmZmUzZTMiLCIjZmZjOWM5IiwiI2ZmYThhOCIsIiNmZjg3ODciLCIjZmY2YjZiIiwiI2ZhNTI1MiIsIiNmMDNlM2UiLCIjZTAzMTMxIiwiI2M5MmEyYSJdLCJwaW5rIjpbIiNmZmYwZjYiLCIjZmZkZWViIiwiI2ZjYzJkNyIsIiNmYWEyYzEiLCIjZjc4M2FjIiwiI2YwNjU5NSIsIiNlNjQ5ODAiLCIjZDYzMzZjIiwiI2MyMjU1YyIsIiNhNjFlNGQiXSwiZ3JhcGUiOlsiI2Y4ZjBmYyIsIiNmM2Q5ZmEiLCIjZWViZWZhIiwiI2U1OTlmNyIsIiNkYTc3ZjIiLCIjY2M1ZGU4IiwiI2JlNGJkYiIsIiNhZTNlYzkiLCIjOWMzNmI1IiwiIzg2MmU5YyJdLCJ2aW9sZXQiOlsiI2YzZjBmZiIsIiNlNWRiZmYiLCIjZDBiZmZmIiwiI2IxOTdmYyIsIiM5Nzc1ZmEiLCIjODQ1ZWY3IiwiIzc5NTBmMiIsIiM3MDQ4ZTgiLCIjNjc0MWQ5IiwiIzVmM2RjNCJdLCJpbmRpZ28iOlsiI2VkZjJmZiIsIiNkYmU0ZmYiLCIjYmFjOGZmIiwiIzkxYTdmZiIsIiM3NDhmZmMiLCIjNWM3Y2ZhIiwiIzRjNmVmNSIsIiM0MjYzZWIiLCIjM2I1YmRiIiwiIzM2NGZjNyJdLCJibHVlIjpbIiNlN2Y1ZmYiLCIjZDBlYmZmIiwiI2E1ZDhmZiIsIiM3NGMwZmMiLCIjNGRhYmY3IiwiIzMzOWFmMCIsIiMyMjhiZTYiLCIjMWM3ZWQ2IiwiIzE5NzFjMiIsIiMxODY0YWIiXSwiY3lhbiI6WyIjZTNmYWZjIiwiI2M1ZjZmYSIsIiM5OWU5ZjIiLCIjNjZkOWU4IiwiIzNiYzlkYiIsIiMyMmI4Y2YiLCIjMTVhYWJmIiwiIzEwOThhZCIsIiMwYzg1OTkiLCIjMGI3Mjg1Il0sInRlYWwiOlsiI2U2ZmNmNSIsIiNjM2ZhZTgiLCIjOTZmMmQ3IiwiIzYzZTZiZSIsIiMzOGQ5YTkiLCIjMjBjOTk3IiwiIzEyYjg4NiIsIiMwY2E2NzgiLCIjMDk5MjY4IiwiIzA4N2Y1YiJdLCJncmVlbiI6WyIjZWJmYmVlIiwiI2QzZjlkOCIsIiNiMmYyYmIiLCIjOGNlOTlhIiwiIzY5ZGI3YyIsIiM1MWNmNjYiLCIjNDBjMDU3IiwiIzM3YjI0ZCIsIiMyZjllNDQiLCIjMmI4YTNlIl0sImxpbWUiOlsiI2Y0ZmNlMyIsIiNlOWZhYzgiLCIjZDhmNWEyIiwiI2MwZWI3NSIsIiNhOWUzNGIiLCIjOTRkODJkIiwiIzgyYzkxZSIsIiM3NGI4MTYiLCIjNjZhODBmIiwiIzVjOTQwZCJdLCJ5ZWxsb3ciOlsiI2ZmZjlkYiIsIiNmZmYzYmYiLCIjZmZlYzk5IiwiI2ZmZTA2NiIsIiNmZmQ0M2IiLCIjZmNjNDE5IiwiI2ZhYjAwNSIsIiNmNTlmMDAiLCIjZjA4YzAwIiwiI2U2NzcwMCJdLCJvcmFuZ2UiOlsiI2ZmZjRlNiIsIiNmZmU4Y2MiLCIjZmZkOGE4IiwiI2ZmYzA3OCIsIiNmZmE5NGQiLCIjZmY5MjJiIiwiI2ZkN2UxNCIsIiNmNzY3MDciLCIjZTg1OTBjIiwiI2Q5NDgwZiJdfScpfSxmdW5jdGlvbihlLHQsbil7InVzZSBzdHJpY3QiO24uZCh0LCJhIiwoZnVuY3Rpb24oKXtyZXR1cm4gdX0pKSxuLmQodCwiYiIsKGZ1bmN0aW9uKCl7cmV0dXJuIGR9KSk7dmFyIHI9bigxNCksbz1uKDIyKSxhPW4oMzApLGk9bigyMCk7ZnVuY3Rpb24gcyhlLHQpe3ZhciBuPU9iamVjdC5rZXlzKGUpO2lmKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpe3ZhciByPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7dCYmKHI9ci5maWx0ZXIoKGZ1bmN0aW9uKHQpe3JldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGUsdCkuZW51bWVyYWJsZX0pKSksbi5wdXNoLmFwcGx5KG4scil9cmV0dXJuIG59ZnVuY3Rpb24gbChlKXtmb3IodmFyIHQ9MTt0PGFyZ3VtZW50cy5sZW5ndGg7dCsrKXt2YXIgbj1udWxsIT1hcmd1bWVudHNbdF0/YXJndW1lbnRzW3RdOnt9O3QlMj9zKE9iamVjdChuKSwhMCkuZm9yRWFjaCgoZnVuY3Rpb24odCl7YyhlLHQsblt0XSl9KSk6T2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnM/T2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZSxPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhuKSk6cyhPYmplY3QobikpLmZvckVhY2goKGZ1bmN0aW9uKHQpe09iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHQsT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihuLHQpKX0pKX1yZXR1cm4gZX1mdW5jdGlvbiBjKGUsdCxuKXtyZXR1cm4gdCBpbiBlP09iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHQse3ZhbHVlOm4sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITAsd3JpdGFibGU6ITB9KTplW3RdPW4sZX12YXIgdT1mdW5jdGlvbihlLHQpe3ZhciBuLHM9ITEsYz10LnBvaW50cztmb3IodmFyIHUgaW4gdm9pZCAwIT09YyYmKHQ9bChsKHt9LE9iamVjdChhLmEpKGMpKSx0KSksdCl7dmFyIGQ9dFt1XTtpZih2b2lkIDAhPT1kKXtpZihlW3VdPT09ZCYmKCJvYmplY3QiIT10eXBlb2YgZHx8bnVsbD09PWR8fCJncm91cElkcyI9PT11KSljb250aW51ZTtpZigicG9pbnRzIj09PXUpe3ZhciBwPWVbdV0saD1kO2lmKHAubGVuZ3RoPT09aC5sZW5ndGgpe2Zvcih2YXIgZj0hMSxtPXAubGVuZ3RoOy0tbTspe3ZhciBnPXBbbV0sYj1oW21dO2lmKGdbMF0hPT1iWzBdfHxnWzFdIT09YlsxXSl7Zj0hMDticmVha319aWYoIWYpY29udGludWV9fWVbdV09ZCxzPSEwfX1zJiYodm9pZCAwPT09dC5oZWlnaHQmJnZvaWQgMD09PXQud2lkdGgmJnZvaWQgMD09PWN8fE9iamVjdChyLmMpKGUpLGUudmVyc2lvbisrLGUudmVyc2lvbk5vbmNlPU9iamVjdChpLmIpKCksbnVsbD09PShuPW8uYS5nZXRTY2VuZShlKSl8fHZvaWQgMD09PW58fG4uaW5mb3JtTXV0YXRpb24oKSl9LGQ9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gbChsKGwoe30sZSksdCkse30se3ZlcnNpb246ZS52ZXJzaW9uKzEsdmVyc2lvbk5vbmNlOk9iamVjdChpLmIpKCl9KX19LGZ1bmN0aW9uKGUsdCxuKXsidXNlIHN0cmljdCI7bi5kKHQsImMiLChmdW5jdGlvbigpe3JldHVybiBvfSkpLG4uZCh0LCJoIiwoZnVuY3Rpb24oKXtyZXR1cm4gYX0pKSxuLmQodCwiYSIsKGZ1bmN0aW9uKCl7cmV0dXJuIGl9KSksbi5kKHQsImQiLChmdW5jdGlvbigpe3JldHVybiBzfSkpLG4uZCh0LCJiIiwoZnVuY3Rpb24oKXtyZXR1cm4gbH0pKSxuLmQodCwiZiIsKGZ1bmN0aW9uKCl7cmV0dXJuIGN9KSksbi5kKHQsImciLChmdW5jdGlvbigpe3JldHVybiB1fSkpLG4uZCh0LCJlIiwoZnVuY3Rpb24oKXtyZXR1cm4gZn0pKTt2YXIgcj1uKDMpLG89ZnVuY3Rpb24oZSx0LG4scixvLGEpe3ZhciBpLHMsbD1vLW4sYz1hLXIsdT1sKmwrYypjLGQ9LTE7MCE9PXUmJihkPSgoZS1uKSpsKyh0LXIpKmMpL3UpLGQ8MD8oaT1uLHM9cik6ZD4xPyhpPW8scz1hKTooaT1uK2QqbCxzPXIrZCpjKTt2YXIgcD1lLWksaD10LXM7cmV0dXJuIE1hdGguaHlwb3QocCxoKX0sYT1mdW5jdGlvbihlLHQsbixyLG8pe3JldHVyblsoZS1uKSpNYXRoLmNvcyhvKS0odC1yKSpNYXRoLnNpbihvKStuLChlLW4pKk1hdGguc2luKG8pKyh0LXIpKk1hdGguY29zKG8pK3JdfSxpPWZ1bmN0aW9uKGUsdCxuLHIsbyxhLGkscyl7dmFyIGw9TWF0aC5jb3MociksYz1NYXRoLnNpbihyKTtyZXR1cm4gZS5lJiZlLnc/dCs9bytpOmUuZT8odCs9byooMStsKSxuKz1vKmMsdCs9aSooMS1sKSxuKz1pKi1jKTplLncmJih0Kz1vKigxLWwpLG4rPW8qLWMsdCs9aSooMStsKSxuKz1pKmMpLGUubiYmZS5zP24rPWErczplLm4/KHQrPWEqYyxuKz1hKigxLWwpLHQrPXMqLWMsbis9cyooMStsKSk6ZS5zJiYodCs9YSotYyxuKz1hKigxK2wpLHQrPXMqYyxuKz1zKigxLWwpKSxbdCxuXX0scz1mdW5jdGlvbihlLHQsbixyLG8sYSxpLHMsbCxjLHUsZCxwKXt2YXIgaD1NYXRoLmNvcyhwKSxmPU1hdGguc2luKHApLG09MCxnPTA7cmV0dXJuIHQ8MCYmKCJlIiE9PWUmJiJuZSIhPT1lJiYic2UiIT09ZXx8KGQ/KG0rPShjLXIpKmgsZys9KGMtcikqZik6bSs9Yy1yKSwidyIhPT1lJiYibnciIT09ZSYmInN3IiE9PWV8fChkPyhtKz0ocy1hKSpoLGcrPShzLWEpKmYpOm0rPXMtYSkpLG48MCYmKCJzIiE9PWUmJiJzZSIhPT1lJiYic3ciIT09ZXx8KGQ/KGcrPSh1LW8pKmgsbSs9KHUtbykqLWYpOmcrPXUtbyksIm4iIT09ZSYmIm5lIiE9PWUmJiJudyIhPT1lfHwoZD8oZys9KGwtaSkqaCxtKz0obC1pKSotZik6Zys9bC1pKSksW20sZ119LGw9ZnVuY3Rpb24oZSx0LG4scil7dmFyIG89bi1lLGE9ci10O3JldHVybiBNYXRoLmh5cG90KG8sYSl9LGM9ZnVuY3Rpb24oZSl7aWYoZS5sZW5ndGg+PTMpe3ZhciB0PVtlWzBdLGVbZS5sZW5ndGgtMV1dLG49dFswXSxvPXRbMV07cmV0dXJuIGwoblswXSxuWzFdLG9bMF0sb1sxXSk8PXIucH1yZXR1cm4hMX0sdT1mdW5jdGlvbihlLHQsbil7dmFyIHI9ZS5sZW5ndGg7aWYocjwzKXJldHVybiExO2Zvcih2YXIgbz1bTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIsbl0sYT1bdCxuXSxpPTAscz0wO3M8cjtzKyspe3ZhciBsPWVbc10sYz1lWyhzKzEpJXJdO2lmKGgobCxjLGEsbykpe2lmKDA9PT1wKGwsYSxjKSlyZXR1cm4gZChsLGEsYyk7aSsrfX1yZXR1cm4gaSUyPT0xfSxkPWZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gdFswXTw9TWF0aC5tYXgoZVswXSxuWzBdKSYmdFswXT49TWF0aC5taW4oZVswXSxuWzBdKSYmdFsxXTw9TWF0aC5tYXgoZVsxXSxuWzFdKSYmdFsxXT49TWF0aC5taW4oZVsxXSxuWzFdKX0scD1mdW5jdGlvbihlLHQsbil7dmFyIHI9KHRbMV0tZVsxXSkqKG5bMF0tdFswXSktKHRbMF0tZVswXSkqKG5bMV0tdFsxXSk7cmV0dXJuIDA9PT1yPzA6cj4wPzE6Mn0saD1mdW5jdGlvbihlLHQsbixyKXt2YXIgbz1wKGUsdCxuKSxhPXAoZSx0LHIpLGk9cChuLHIsZSkscz1wKG4scix0KTtyZXR1cm4gbyE9PWEmJmkhPT1zfHwoISgwIT09b3x8IWQoZSxuLHQpKXx8KCEoMCE9PWF8fCFkKGUscix0KSl8fCghKDAhPT1pfHwhZChuLGUscikpfHwhKDAhPT1zfHwhZChuLHQscikpKSkpfSxmPWZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gbj9bTWF0aC5yb3VuZChlL24pKm4sTWF0aC5yb3VuZCh0L24pKm5dOltlLHRdfX0sZnVuY3Rpb24oZSx0LG4peyJ1c2Ugc3RyaWN0IjtuLmQodCwiZiIsKGZ1bmN0aW9uKCl7cmV0dXJuIGx9KSksbi5kKHQsImUiLChmdW5jdGlvbigpe3JldHVybiBjfSkpLG4uZCh0LCJkIiwoZnVuY3Rpb24oKXtyZXR1cm4gdX0pKSxuLmQodCwiYSIsKGZ1bmN0aW9uKCl7cmV0dXJuIGh9KSksbi5kKHQsImciLChmdW5jdGlvbigpe3JldHVybiBmfSkpLG4uZCh0LCJjIiwoZnVuY3Rpb24oKXtyZXR1cm4gbX0pKSxuLmQodCwiaSIsKGZ1bmN0aW9uKCl7cmV0dXJuIGd9KSksbi5kKHQsImgiLChmdW5jdGlvbigpe3JldHVybiBifSkpLG4uZCh0LCJiIiwoZnVuY3Rpb24oKXtyZXR1cm4geX0pKTt2YXIgcj1uKDkpLG89bigyMyksYT1uKDE0KSxpPW4oMTEpLHM9bigzMCksbD1mdW5jdGlvbihlKXtyZXR1cm4gT2JqZWN0KGkuYikoZSk/cChlKTpbZS54LGUueSxlLngrZS53aWR0aCxlLnkrZS5oZWlnaHRdfSxjPWZ1bmN0aW9uKGUpe3ZhciB0PU1hdGguZmxvb3IoZS53aWR0aC8yKSsxLG49ZS53aWR0aCxyPU1hdGguZmxvb3IoZS5oZWlnaHQvMikrMTtyZXR1cm5bdCwwLG4scix0LGUuaGVpZ2h0LDAscl19LHU9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PTAsbj1lLnNldHM7dDxuLmxlbmd0aDt0Kyspe3ZhciByPW5bdF07aWYoInBhdGgiPT09ci50eXBlKXJldHVybiByLm9wc31yZXR1cm4gZS5zZXRzWzBdLm9wc30sZD1mdW5jdGlvbihlLHQpe3ZhciBuPVswLDBdLHI9ZS5yZWR1Y2UoKGZ1bmN0aW9uKGUscil7dmFyIG8sYT1yLm9wLGk9ci5kYXRhO2lmKCJtb3ZlIj09PWEpbj1pO2Vsc2UgaWYoImJjdXJ2ZVRvIj09PWEpe3ZhciBzPVtpWzBdLGlbMV1dLGw9W2lbMl0saVszXV0sYz1baVs0XSxpWzVdXSx1PW47bj1jO2Zvcih2YXIgZD1mdW5jdGlvbihlLHQpe3JldHVybiBNYXRoLnBvdygxLWUsMykqY1t0XSszKmUqTWF0aC5wb3coMS1lLDIpKmxbdF0rMypNYXRoLnBvdyhlLDIpKigxLWUpKnNbdF0rdVt0XSpNYXRoLnBvdyhlLDMpfSxwPTA7cDw9MTspe3ZhciBoPWQocCwwKSxmPWQocCwxKTt0JiYoaD0obz10KGgsZikpWzBdLGY9b1sxXSksZS5taW5ZPU1hdGgubWluKGUubWluWSxmKSxlLm1pblg9TWF0aC5taW4oZS5taW5YLGgpLGUubWF4WD1NYXRoLm1heChlLm1heFgsaCksZS5tYXhZPU1hdGgubWF4KGUubWF4WSxmKSxwKz0uMX19cmV0dXJuIGV9KSx7bWluWDoxLzAsbWluWToxLzAsbWF4WDotMS8wLG1heFk6LTEvMH0pO3JldHVybltyLm1pblgsci5taW5ZLHIubWF4WCxyLm1heFldfSxwPWZ1bmN0aW9uKGUpe2lmKGUucG9pbnRzLmxlbmd0aDwyfHwhT2JqZWN0KGEuYikoZSkpe3ZhciB0PWUucG9pbnRzLnJlZHVjZSgoZnVuY3Rpb24oZSx0KXt2YXIgbj10WzBdLHI9dFsxXTtyZXR1cm4gZS5taW5ZPU1hdGgubWluKGUubWluWSxyKSxlLm1pblg9TWF0aC5taW4oZS5taW5YLG4pLGUubWF4WD1NYXRoLm1heChlLm1heFgsbiksZS5tYXhZPU1hdGgubWF4KGUubWF4WSxyKSxlfSkse21pblg6MS8wLG1pblk6MS8wLG1heFg6LTEvMCxtYXhZOi0xLzB9KSxuPXQubWluWCxyPXQubWluWSxvPXQubWF4WCxpPXQubWF4WTtyZXR1cm5bbitlLngscitlLnksbytlLngsaStlLnldfXZhciBzPU9iamVjdChhLmIpKGUpLGw9dShzWzBdKSxjPWQobCkscD1jWzBdLGg9Y1sxXSxmPWNbMl0sbT1jWzNdO3JldHVybltwK2UueCxoK2UueSxmK2UueCxtK2UueV19LGg9ZnVuY3Rpb24oZSx0KXt2YXIgbj11KHRbMF0pLG89bltuLmxlbmd0aC0xXS5kYXRhLGE9W29bNF0sb1s1XV0saT1bb1syXSxvWzNdXSxzPVtvWzBdLG9bMV1dLGw9bltuLmxlbmd0aC0yXSxjPVswLDBdOyJtb3ZlIj09PWwub3A/Yz1sLmRhdGE6ImJjdXJ2ZVRvIj09PWwub3AmJihjPVtsLmRhdGFbNF0sbC5kYXRhWzVdXSk7dmFyIGQ9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gTWF0aC5wb3coMS1lLDMpKmFbdF0rMyplKk1hdGgucG93KDEtZSwyKSppW3RdKzMqTWF0aC5wb3coZSwyKSooMS1lKSpzW3RdK2NbdF0qTWF0aC5wb3coZSwzKX0scD1hWzBdLGg9YVsxXSxmPVtkKC4zLDApLGQoLjMsMSldLG09ZlswXSxnPWZbMV0sYj1NYXRoLmh5cG90KHAtbSxoLWcpLHk9KHAtbSkvYix2PShoLWcpL2Isaz1lLnBvaW50cy5yZWR1Y2UoKGZ1bmN0aW9uKGUsdCxuLHIpe3ZhciBvPXRbMF0sYT10WzFdLGk9bj4wP3Jbbi0xXTpbMCwwXSxzPWlbMF0sbD1pWzFdO3JldHVybiBlK01hdGguaHlwb3Qoby1zLGEtbCl9KSwwKSx3PU1hdGgubWluKDMwLGsvMiksUz1wLXkqdyxFPWgtdip3LE89T2JqZWN0KHIuaCkoUyxFLHAsaCwtMjAqTWF0aC5QSS8xODApLEM9T1swXSx4PU9bMV0saj1PYmplY3Qoci5oKShTLEUscCxoLDIwKk1hdGguUEkvMTgwKTtyZXR1cm5bcCxoLEMseCxqWzBdLGpbMV1dfSxmPWZ1bmN0aW9uKGUpe3ZhciB0PWwoZSksbj10WzBdLG89dFsxXSxzPXRbMl0sYz10WzNdLHA9KG4rcykvMixoPShvK2MpLzI7aWYoT2JqZWN0KGkuYikoZSkpcmV0dXJuIGZ1bmN0aW9uKGUsdCxuKXtpZihlLnBvaW50cy5sZW5ndGg8Mnx8IU9iamVjdChhLmIpKGUpKXt2YXIgbz1lLnBvaW50cy5yZWR1Y2UoKGZ1bmN0aW9uKG8sYSl7dmFyIGkscz1hWzBdLGw9YVsxXTtyZXR1cm4gcz0oaT1PYmplY3Qoci5oKShlLngrcyxlLnkrbCx0LG4sZS5hbmdsZSkpWzBdLGw9aVsxXSxvLm1pblk9TWF0aC5taW4oby5taW5ZLGwpLG8ubWluWD1NYXRoLm1pbihvLm1pblgscyksby5tYXhYPU1hdGgubWF4KG8ubWF4WCxzKSxvLm1heFk9TWF0aC5tYXgoby5tYXhZLGwpLG99KSx7bWluWDoxLzAsbWluWToxLzAsbWF4WDotMS8wLG1heFk6LTEvMH0pO3JldHVybltvLm1pblgsby5taW5ZLG8ubWF4WCxvLm1heFldfXZhciBpPU9iamVjdChhLmIpKGUpLHM9dShpWzBdKTtyZXR1cm4gZChzLChmdW5jdGlvbihvLGEpe3JldHVybiBPYmplY3Qoci5oKShlLngrbyxlLnkrYSx0LG4sZS5hbmdsZSl9KSl9KGUscCxoKTtpZigiZGlhbW9uZCI9PT1lLnR5cGUpe3ZhciBmPU9iamVjdChyLmgpKHAsbyxwLGgsZS5hbmdsZSksbT1mWzBdLGc9ZlsxXSxiPU9iamVjdChyLmgpKHAsYyxwLGgsZS5hbmdsZSkseT1iWzBdLHY9YlsxXSxrPU9iamVjdChyLmgpKG4saCxwLGgsZS5hbmdsZSksdz1rWzBdLFM9a1sxXSxFPU9iamVjdChyLmgpKHMsaCxwLGgsZS5hbmdsZSksTz1FWzBdLEM9RVsxXTtyZXR1cm5bTWF0aC5taW4obSx5LHcsTyksTWF0aC5taW4oZyx2LFMsQyksTWF0aC5tYXgobSx5LHcsTyksTWF0aC5tYXgoZyx2LFMsQyldfWlmKCJlbGxpcHNlIj09PWUudHlwZSl7dmFyIHg9KHMtbikvMixqPShjLW8pLzIsVD1NYXRoLmNvcyhlLmFuZ2xlKSxQPU1hdGguc2luKGUuYW5nbGUpLEE9TWF0aC5oeXBvdCh4KlQsaipQKSxNPU1hdGguaHlwb3QoaipULHgqUCk7cmV0dXJuW3AtQSxoLU0scCtBLGgrTV19dmFyIF89T2JqZWN0KHIuaCkobixvLHAsaCxlLmFuZ2xlKSx6PV9bMF0sTD1fWzFdLEk9T2JqZWN0KHIuaCkobixjLHAsaCxlLmFuZ2xlKSxEPUlbMF0sTj1JWzFdLEY9T2JqZWN0KHIuaCkocyxjLHAsaCxlLmFuZ2xlKSxSPUZbMF0sQj1GWzFdLEg9T2JqZWN0KHIuaCkocyxvLHAsaCxlLmFuZ2xlKSxHPUhbMF0sVz1IWzFdO3JldHVybltNYXRoLm1pbih6LEQsUixHKSxNYXRoLm1pbihMLE4sQixXKSxNYXRoLm1heCh6LEQsUixHKSxNYXRoLm1heChMLE4sQixXKV19LG09ZnVuY3Rpb24oZSl7aWYoIWUubGVuZ3RoKXJldHVyblswLDAsMCwwXTt2YXIgdD0xLzAsbj0tMS8wLHI9MS8wLG89LTEvMDtyZXR1cm4gZS5mb3JFYWNoKChmdW5jdGlvbihlKXt2YXIgYT1mKGUpLGk9YVswXSxzPWFbMV0sbD1hWzJdLGM9YVszXTt0PU1hdGgubWluKHQsaSkscj1NYXRoLm1pbihyLHMpLG49TWF0aC5tYXgobixsKSxvPU1hdGgubWF4KG8sYyl9KSksW3QscixuLG9dfSxnPWZ1bmN0aW9uKGUsdCxuKXtpZighT2JqZWN0KGkuYikoZSkpcmV0dXJuW2UueCxlLnksZS54K3QsZS55K25dO3ZhciByPU9iamVjdChzLmIpKDAsdCxPYmplY3Qocy5iKSgxLG4sZS5wb2ludHMpKSxsPW8uYS5nZW5lcmF0b3IoKS5jdXJ2ZShyLE9iamVjdChhLmEpKGUpKSxjPXUobCkscD1kKGMpLGg9cFswXSxmPXBbMV0sbT1wWzJdLGc9cFszXTtyZXR1cm5baCtlLngsZitlLnksbStlLngsZytlLnldfSxiPWZ1bmN0aW9uKGUsdCl7dmFyIG49by5hLmdlbmVyYXRvcigpLmN1cnZlKHQsT2JqZWN0KGEuYSkoZSkpLHI9dShuKSxpPWQocikscz1pWzBdLGw9aVsxXSxjPWlbMl0scD1pWzNdO3JldHVybltzK2UueCxsK2UueSxjK2UueCxwK2UueV19LHk9ZnVuY3Rpb24oZSx0KXtpZighZS5sZW5ndGgpcmV0dXJuWzAsMCwwLDBdO3ZhciBuPTEvMCxvPWVbMF07cmV0dXJuIGUuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dmFyIGE9ZihlKSxpPWFbMF0scz1hWzFdLGw9YVsyXSxjPWFbM10sdT1PYmplY3Qoci5iKSgoaStsKS8yLChzK2MpLzIsdC54LHQueSk7dTxuJiYobj11LG89ZSl9KSksZihvKX19LGZ1bmN0aW9uKGUsdCxuKXsidXNlIHN0cmljdCI7bi5kKHQsImMiLChmdW5jdGlvbigpe3JldHVybiByfSkpLG4uZCh0LCJiIiwoZnVuY3Rpb24oKXtyZXR1cm4gb30pKSxuLmQodCwiYSIsKGZ1bmN0aW9uKCl7cmV0dXJuIGF9KSk7dmFyIHI9ZnVuY3Rpb24oZSl7cmV0dXJuIG51bGwhPWUmJiJ0ZXh0Ij09PWUudHlwZX0sbz1mdW5jdGlvbihlKXtyZXR1cm4gbnVsbCE9ZSYmKCJhcnJvdyI9PT1lLnR5cGV8fCJsaW5lIj09PWUudHlwZXx8ImRyYXciPT09ZS50eXBlKX0sYT1mdW5jdGlvbihlKXtyZXR1cm4idGV4dCI9PT0obnVsbD09ZT92b2lkIDA6ZS50eXBlKXx8ImRpYW1vbmQiPT09KG51bGw9PWU/dm9pZCAwOmUudHlwZSl8fCJyZWN0YW5nbGUiPT09KG51bGw9PWU/dm9pZCAwOmUudHlwZSl8fCJlbGxpcHNlIj09PShudWxsPT1lP3ZvaWQgMDplLnR5cGUpfHwiYXJyb3ciPT09KG51bGw9PWU/dm9pZCAwOmUudHlwZSl8fCJkcmF3Ij09PShudWxsPT1lP3ZvaWQgMDplLnR5cGUpfHwibGluZSI9PT0obnVsbD09ZT92b2lkIDA6ZS50eXBlKX19LGZ1bmN0aW9uKGUsdCxuKXsidXNlIHN0cmljdCI7bi5kKHQsImkiLChmdW5jdGlvbigpe3JldHVybiBsfSkpLG4uZCh0LCJnIiwoZnVuY3Rpb24oKXtyZXR1cm4gY30pKSxuLmQodCwiZSIsKGZ1bmN0aW9uKCl7cmV0dXJuIHV9KSksbi5kKHQsImoiLChmdW5jdGlvbigpe3JldHVybiBkfSkpLG4uZCh0LCJmIiwoZnVuY3Rpb24oKXtyZXR1cm4gcH0pKSxuLmQodCwiYiIsKGZ1bmN0aW9uKCl7cmV0dXJuIGh9KSksbi5kKHQsImQiLChmdW5jdGlvbigpe3JldHVybiBmfSkpLG4uZCh0LCJjIiwoZnVuY3Rpb24oKXtyZXR1cm4gbX0pKSxuLmQodCwiYSIsKGZ1bmN0aW9uKCl7cmV0dXJuIGd9KSksbi5kKHQsImgiLChmdW5jdGlvbigpe3JldHVybiBifSkpO3ZhciByPW4oNiksbz1mdW5jdGlvbigpe2Zvcih2YXIgZT0wLHQ9MCxuPWFyZ3VtZW50cy5sZW5ndGg7dDxuO3QrKyllKz1hcmd1bWVudHNbdF0ubGVuZ3RoO3ZhciByPUFycmF5KGUpLG89MDtmb3IodD0wO3Q8bjt0KyspZm9yKHZhciBhPWFyZ3VtZW50c1t0XSxpPTAscz1hLmxlbmd0aDtpPHM7aSsrLG8rKylyW29dPWFbaV07cmV0dXJuIHJ9O2Z1bmN0aW9uIGEoZSx0KXt2YXIgbj1PYmplY3Qua2V5cyhlKTtpZihPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgcj1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO3QmJihyPXIuZmlsdGVyKChmdW5jdGlvbih0KXtyZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihlLHQpLmVudW1lcmFibGV9KSkpLG4ucHVzaC5hcHBseShuLHIpfXJldHVybiBufWZ1bmN0aW9uIGkoZSl7Zm9yKHZhciB0PTE7dDxhcmd1bWVudHMubGVuZ3RoO3QrKyl7dmFyIG49bnVsbCE9YXJndW1lbnRzW3RdP2FyZ3VtZW50c1t0XTp7fTt0JTI/YShPYmplY3QobiksITApLmZvckVhY2goKGZ1bmN0aW9uKHQpe3MoZSx0LG5bdF0pfSkpOk9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzP09iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGUsT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMobikpOmEoT2JqZWN0KG4pKS5mb3JFYWNoKChmdW5jdGlvbih0KXtPYmplY3QuZGVmaW5lUHJvcGVydHkoZSx0LE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iobix0KSl9KSl9cmV0dXJuIGV9ZnVuY3Rpb24gcyhlLHQsbil7cmV0dXJuIHQgaW4gZT9PYmplY3QuZGVmaW5lUHJvcGVydHkoZSx0LHt2YWx1ZTpuLGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwLHdyaXRhYmxlOiEwfSk6ZVt0XT1uLGV9ZnVuY3Rpb24gbChlLHQsbil7dmFyIHIsbyxhPW4uZmlsdGVyKChmdW5jdGlvbih0KXtyZXR1cm4gdC5ncm91cElkcy5pbmNsdWRlcyhlKX0pKTtyZXR1cm4gYS5sZW5ndGg8Mj90LnNlbGVjdGVkR3JvdXBJZHNbZV18fHQuZWRpdGluZ0dyb3VwSWQ9PT1lP2koaSh7fSx0KSx7fSx7c2VsZWN0ZWRHcm91cElkczppKGkoe30sdC5zZWxlY3RlZEdyb3VwSWRzKSx7fSwocj17fSxyW2VdPSExLHIpKSxlZGl0aW5nR3JvdXBJZDpudWxsfSk6dDppKGkoe30sdCkse30se3NlbGVjdGVkR3JvdXBJZHM6aShpKHt9LHQuc2VsZWN0ZWRHcm91cElkcykse30sKG89e30sb1tlXT0hMCxvKSksc2VsZWN0ZWRFbGVtZW50SWRzOmkoaSh7fSx0LnNlbGVjdGVkRWxlbWVudElkcyksT2JqZWN0LmZyb21FbnRyaWVzKGEubWFwKChmdW5jdGlvbihlKXtyZXR1cm5bZS5pZCwhMF19KSkpKX0pfWZ1bmN0aW9uIGMoZSx0KXtyZXR1cm4hIXQuZ3JvdXBJZHMuZmlsdGVyKChmdW5jdGlvbih0KXtyZXR1cm4gdCE9PWUuZWRpdGluZ0dyb3VwSWR9KSkuZmluZCgoZnVuY3Rpb24odCl7cmV0dXJuIGUuc2VsZWN0ZWRHcm91cElkc1t0XX0pKX1mdW5jdGlvbiB1KGUpe3JldHVybiBPYmplY3QuZW50cmllcyhlLnNlbGVjdGVkR3JvdXBJZHMpLmZpbHRlcigoZnVuY3Rpb24oZSl7ZVswXTtyZXR1cm4gZVsxXX0pKS5tYXAoKGZ1bmN0aW9uKGUpe3ZhciB0PWVbMF07ZVsxXTtyZXR1cm4gdH0pKX1mdW5jdGlvbiBkKGUsdCl7Zm9yKHZhciBuPWkoe30sZSksbz0wLGE9T2JqZWN0KHIuZykodCxlKTtvPGEubGVuZ3RoO28rKyl7dmFyIHM9YVtvXS5ncm91cElkcztpZihlLmVkaXRpbmdHcm91cElkKXt2YXIgYz1zLmluZGV4T2YoZS5lZGl0aW5nR3JvdXBJZCk7Yz4tMSYmKHM9cy5zbGljZSgwLGMpKX1pZihzLmxlbmd0aD4wKW49bChzW3MubGVuZ3RoLTFdLG4sdCl9cmV0dXJuIG59ZnVuY3Rpb24gcChlLHQpe3JldHVybiBlLmdyb3VwSWRzLmluY2x1ZGVzKHQpfWZ1bmN0aW9uIGgoZSx0KXtyZXR1cm4gZS5maWx0ZXIoKGZ1bmN0aW9uKGUpe3JldHVybiBwKGUsdCl9KSl9ZnVuY3Rpb24gZihlLHQpe3JldHVybiBlLmdyb3VwSWRzLmZpbmQoKGZ1bmN0aW9uKGUpe3JldHVybiB0W2VdfSkpfWZ1bmN0aW9uIG0oZSx0LG4pe2Zvcih2YXIgcj1vKGUpLGE9dD9lLmluZGV4T2YodCk6LTEsaT1hPi0xP2E6ZS5sZW5ndGgscz0wO3M8aTtzKyspcltzXT1uKHJbc10pO3JldHVybiByfWZ1bmN0aW9uIGcoZSx0LG4pe3ZhciByPW8oZSksYT1uP3IuaW5kZXhPZihuKTotMSxpPWE+LTE/YTpyLmxlbmd0aDtyZXR1cm4gci5zcGxpY2UoaSwwLHQpLHJ9ZnVuY3Rpb24gYihlLHQpe3JldHVybiBlLmZpbHRlcigoZnVuY3Rpb24oZSl7cmV0dXJuIXRbZV19KSl9fSxmdW5jdGlvbihlLHQsbil7InVzZSBzdHJpY3QiOyhmdW5jdGlvbihlKXtuLmQodCwiYSIsKGZ1bmN0aW9uKCl7cmV0dXJuIGt9KSksbi5kKHQsImYiLChmdW5jdGlvbigpe3JldHVybiBPfSkpLG4uZCh0LCJlIiwoZnVuY3Rpb24oKXtyZXR1cm4gQ30pKSxuLmQodCwiYyIsKGZ1bmN0aW9uKCl7cmV0dXJuIGp9KSksbi5kKHQsImIiLChmdW5jdGlvbigpe3JldHVybiBUfSkpLG4uZCh0LCJkIiwoZnVuY3Rpb24oKXtyZXR1cm4gTX0pKSxuLmQodCwiaSIsKGZ1bmN0aW9uKCl7cmV0dXJuIF99KSk7dmFyIHI9bigxNyksbz1uKDI1KSxhPW4oMzIpLGk9bigxKSxzPW4oMTgpLGw9bigyOSksYz1uKDMxKSx1PW4oMzYpO24uZCh0LCJnIiwoZnVuY3Rpb24oKXtyZXR1cm4gdS5hfSkpLG4uZCh0LCJqIiwoZnVuY3Rpb24oKXtyZXR1cm4gbC5jfSkpLG4uZCh0LCJoIiwoZnVuY3Rpb24oKXtyZXR1cm4gbC5ifSkpO24oMTUpO3ZhciBkPWZ1bmN0aW9uKGUsdCl7dmFyIG4scixvLGEsaT17bGFiZWw6MCxzZW50OmZ1bmN0aW9uKCl7aWYoMSZvWzBdKXRocm93IG9bMV07cmV0dXJuIG9bMV19LHRyeXM6W10sb3BzOltdfTtyZXR1cm4gYT17bmV4dDpzKDApLHRocm93OnMoMSkscmV0dXJuOnMoMil9LCJmdW5jdGlvbiI9PXR5cGVvZiBTeW1ib2wmJihhW1N5bWJvbC5pdGVyYXRvcl09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30pLGE7ZnVuY3Rpb24gcyhhKXtyZXR1cm4gZnVuY3Rpb24ocyl7cmV0dXJuIGZ1bmN0aW9uKGEpe2lmKG4pdGhyb3cgbmV3IFR5cGVFcnJvcigiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLiIpO2Zvcig7aTspdHJ5e2lmKG49MSxyJiYobz0yJmFbMF0/ci5yZXR1cm46YVswXT9yLnRocm93fHwoKG89ci5yZXR1cm4pJiZvLmNhbGwociksMCk6ci5uZXh0KSYmIShvPW8uY2FsbChyLGFbMV0pKS5kb25lKXJldHVybiBvO3N3aXRjaChyPTAsbyYmKGE9WzImYVswXSxvLnZhbHVlXSksYVswXSl7Y2FzZSAwOmNhc2UgMTpvPWE7YnJlYWs7Y2FzZSA0OnJldHVybiBpLmxhYmVsKysse3ZhbHVlOmFbMV0sZG9uZTohMX07Y2FzZSA1OmkubGFiZWwrKyxyPWFbMV0sYT1bMF07Y29udGludWU7Y2FzZSA3OmE9aS5vcHMucG9wKCksaS50cnlzLnBvcCgpO2NvbnRpbnVlO2RlZmF1bHQ6aWYoIShvPWkudHJ5cywobz1vLmxlbmd0aD4wJiZvW28ubGVuZ3RoLTFdKXx8NiE9PWFbMF0mJjIhPT1hWzBdKSl7aT0wO2NvbnRpbnVlfWlmKDM9PT1hWzBdJiYoIW98fGFbMV0+b1swXSYmYVsxXTxvWzNdKSl7aS5sYWJlbD1hWzFdO2JyZWFrfWlmKDY9PT1hWzBdJiZpLmxhYmVsPG9bMV0pe2kubGFiZWw9b1sxXSxvPWE7YnJlYWt9aWYobyYmaS5sYWJlbDxvWzJdKXtpLmxhYmVsPW9bMl0saS5vcHMucHVzaChhKTticmVha31vWzJdJiZpLm9wcy5wb3AoKSxpLnRyeXMucG9wKCk7Y29udGludWV9YT10LmNhbGwoZSxpKX1jYXRjaChlKXthPVs2LGVdLHI9MH1maW5hbGx5e249bz0wfWlmKDUmYVswXSl0aHJvdyBhWzFdO3JldHVybnt2YWx1ZTphWzBdP2FbMV06dm9pZCAwLGRvbmU6ITB9fShbYSxzXSl9fX07ZnVuY3Rpb24gcChlLHQpe3ZhciBuPU9iamVjdC5rZXlzKGUpO2lmKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpe3ZhciByPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7dCYmKHI9ci5maWx0ZXIoKGZ1bmN0aW9uKHQpe3JldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGUsdCkuZW51bWVyYWJsZX0pKSksbi5wdXNoLmFwcGx5KG4scil9cmV0dXJuIG59ZnVuY3Rpb24gaChlKXtmb3IodmFyIHQ9MTt0PGFyZ3VtZW50cy5sZW5ndGg7dCsrKXt2YXIgbj1udWxsIT1hcmd1bWVudHNbdF0/YXJndW1lbnRzW3RdOnt9O3QlMj9wKE9iamVjdChuKSwhMCkuZm9yRWFjaCgoZnVuY3Rpb24odCl7ZihlLHQsblt0XSl9KSk6T2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnM/T2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZSxPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhuKSk6cChPYmplY3QobikpLmZvckVhY2goKGZ1bmN0aW9uKHQpe09iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHQsT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihuLHQpKX0pKX1yZXR1cm4gZX1mdW5jdGlvbiBmKGUsdCxuKXtyZXR1cm4gdCBpbiBlP09iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHQse3ZhbHVlOm4sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITAsd3JpdGFibGU6ITB9KTplW3RdPW4sZX1mdW5jdGlvbiBtKGUsdCxuLHIsbyxhLGkpe3RyeXt2YXIgcz1lW2FdKGkpLGw9cy52YWx1ZX1jYXRjaChlKXtyZXR1cm4gdm9pZCBuKGUpfXMuZG9uZT90KGwpOlByb21pc2UucmVzb2x2ZShsKS50aGVuKHIsbyl9ZnVuY3Rpb24gZyhlKXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgdD10aGlzLG49YXJndW1lbnRzO3JldHVybiBuZXcgUHJvbWlzZSgoZnVuY3Rpb24ocixvKXt2YXIgYT1lLmFwcGx5KHQsbik7ZnVuY3Rpb24gaShlKXttKGEscixvLGkscywibmV4dCIsZSl9ZnVuY3Rpb24gcyhlKXttKGEscixvLGkscywidGhyb3ciLGUpfWkodm9pZCAwKX0pKX19dmFyIGI9ZS5lbnYuUkVBQ1RfQVBQX0JBQ0tFTkRfVjFfR0VUX1VSTCx5PWUuZW52LlJFQUNUX0FQUF9CQUNLRU5EX1YyX1BPU1RfVVJMLHY9ZS5lbnYuUkVBQ1RfQVBQX0JBQ0tFTkRfVjJfR0VUX1VSTCxrPWUuZW52LlJFQUNUX0FQUF9TT0NLRVRfU0VSVkVSX1VSTDt3aW5kb3cuaGFuZGxlPW51bGw7dmFyIHc9ZnVuY3Rpb24oZSl7cmV0dXJuIjAiLmNvbmNhdChlLnRvU3RyaW5nKDE2KSkuc2xpY2UoLTIpfSxTPWZ1bmN0aW9uKCl7dmFyIGU9ZygoZnVuY3Rpb24oKXt2YXIgZTtyZXR1cm4gZCh0aGlzLChmdW5jdGlvbih0KXtyZXR1cm4gZT1uZXcgVWludDhBcnJheSgxMCksd2luZG93LmNyeXB0by5nZXRSYW5kb21WYWx1ZXMoZSksWzIsQXJyYXkuZnJvbShlLHcpLmpvaW4oIiIpXX0pKX0pKTtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fSgpLEU9ZnVuY3Rpb24oKXt2YXIgZT1nKChmdW5jdGlvbigpe3ZhciBlO3JldHVybiBkKHRoaXMsKGZ1bmN0aW9uKHQpe3N3aXRjaCh0LmxhYmVsKXtjYXNlIDA6cmV0dXJuWzQsd2luZG93LmNyeXB0by5zdWJ0bGUuZ2VuZXJhdGVLZXkoe25hbWU6IkFFUy1HQ00iLGxlbmd0aDoxMjh9LCEwLFsiZW5jcnlwdCIsImRlY3J5cHQiXSldO2Nhc2UgMTpyZXR1cm4gZT10LnNlbnQoKSxbNCx3aW5kb3cuY3J5cHRvLnN1YnRsZS5leHBvcnRLZXkoImp3ayIsZSldO2Nhc2UgMjpyZXR1cm5bMix0LnNlbnQoKS5rXX19KSl9KSk7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfX0oKSxPPWZ1bmN0aW9uKGUpe2lmKDAhPT1lLmxlbmd0aClyZXR1cm4gbmV3IFVSTChlKS5oYXNoLm1hdGNoKC9eI3Jvb209KFthLXpBLVowLTlfLV0rKSwoW2EtekEtWjAtOV8tXSspJC8pfSxDPWZ1bmN0aW9uKCl7dmFyIGU9ZygoZnVuY3Rpb24oKXt2YXIgZSx0O3JldHVybiBkKHRoaXMsKGZ1bmN0aW9uKG4pe3N3aXRjaChuLmxhYmVsKXtjYXNlIDA6cmV0dXJuWzQsUygpXTtjYXNlIDE6cmV0dXJuIGU9bi5zZW50KCksWzQsRSgpXTtjYXNlIDI6cmV0dXJuIHQ9bi5zZW50KCksWzIsIiIuY29uY2F0KHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4pLmNvbmNhdCh3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUsIiNyb29tPSIpLmNvbmNhdChlLCIsIikuY29uY2F0KHQpXX19KSl9KSk7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfX0oKSx4PWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHdpbmRvdy5jcnlwdG8uc3VidGxlLmltcG9ydEtleSgiandrIix7YWxnOiJBMTI4R0NNIixleHQ6ITAsazplLGtleV9vcHM6WyJlbmNyeXB0IiwiZGVjcnlwdCJdLGt0eToib2N0In0se25hbWU6IkFFUy1HQ00iLGxlbmd0aDoxMjh9LCExLFt0XSl9LGo9ZnVuY3Rpb24oKXt2YXIgZT1nKChmdW5jdGlvbihlLHQpe3ZhciBuLHIsbztyZXR1cm4gZCh0aGlzLChmdW5jdGlvbihhKXtzd2l0Y2goYS5sYWJlbCl7Y2FzZSAwOnJldHVybls0LHgodCwiZW5jcnlwdCIpXTtjYXNlIDE6cmV0dXJuIG49YS5zZW50KCksaT1uZXcgVWludDhBcnJheSgxMikscj13aW5kb3cuY3J5cHRvLmdldFJhbmRvbVZhbHVlcyhpKSxvPXt9LFs0LHdpbmRvdy5jcnlwdG8uc3VidGxlLmVuY3J5cHQoe25hbWU6IkFFUy1HQ00iLGl2OnJ9LG4sZSldO2Nhc2UgMjpyZXR1cm5bMiwoby5kYXRhPWEuc2VudCgpLG8uaXY9cixvKV19dmFyIGl9KSl9KSk7cmV0dXJuIGZ1bmN0aW9uKHQsbil7cmV0dXJuIGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfX0oKSxUPWZ1bmN0aW9uKCl7dmFyIGU9ZygoZnVuY3Rpb24oZSx0LG4pe3ZhciByLG8sYSxzO3JldHVybiBkKHRoaXMsKGZ1bmN0aW9uKGwpe3N3aXRjaChsLmxhYmVsKXtjYXNlIDA6cmV0dXJuIGwudHJ5cy5wdXNoKFswLDMsLDRdKSxbNCx4KHQsImRlY3J5cHQiKV07Y2FzZSAxOnJldHVybiByPWwuc2VudCgpLFs0LHdpbmRvdy5jcnlwdG8uc3VidGxlLmRlY3J5cHQoe25hbWU6IkFFUy1HQ00iLGl2Om59LHIsZSldO2Nhc2UgMjpyZXR1cm4gbz1sLnNlbnQoKSxhPW5ldyBUZXh0RGVjb2RlcigidXRmLTgiKS5kZWNvZGUobmV3IFVpbnQ4QXJyYXkobykpLFsyLEpTT04ucGFyc2UoYSldO2Nhc2UgMzpyZXR1cm4gcz1sLnNlbnQoKSx3aW5kb3cuYWxlcnQoT2JqZWN0KGkuZSkoImFsZXJ0cy5kZWNyeXB0RmFpbGVkIikpLGNvbnNvbGUuZXJyb3IocyksWzMsNF07Y2FzZSA0OnJldHVyblsyLHt0eXBlOiJJTlZBTElEX1JFU1BPTlNFIn1dfX0pKX0pKTtyZXR1cm4gZnVuY3Rpb24odCxuLHIpe3JldHVybiBlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX19KCksUD1mdW5jdGlvbigpe3ZhciBlPWcoKGZ1bmN0aW9uKGUsdCl7dmFyIG4scixvLGEscyxjLHUscCxoLGY7cmV0dXJuIGQodGhpcywoZnVuY3Rpb24oZCl7c3dpdGNoKGQubGFiZWwpe2Nhc2UgMDpyZXR1cm4gbj1PYmplY3QobC5lKShlLHQpLHI9KG5ldyBUZXh0RW5jb2RlcikuZW5jb2RlKG4pLFs0LHdpbmRvdy5jcnlwdG8uc3VidGxlLmdlbmVyYXRlS2V5KHtuYW1lOiJBRVMtR0NNIixsZW5ndGg6MTI4fSwhMCxbImVuY3J5cHQiLCJkZWNyeXB0Il0pXTtjYXNlIDE6cmV0dXJuIG89ZC5zZW50KCksYT1uZXcgVWludDhBcnJheSgxMiksWzQsd2luZG93LmNyeXB0by5zdWJ0bGUuZW5jcnlwdCh7bmFtZToiQUVTLUdDTSIsaXY6YX0sbyxyKV07Y2FzZSAyOnJldHVybiBzPWQuc2VudCgpLFs0LHdpbmRvdy5jcnlwdG8uc3VidGxlLmV4cG9ydEtleSgiandrIixvKV07Y2FzZSAzOmM9ZC5zZW50KCksZC5sYWJlbD00O2Nhc2UgNDpyZXR1cm4gZC50cnlzLnB1c2goWzQsNywsOF0pLFs0LGZldGNoKHkse21ldGhvZDoiUE9TVCIsYm9keTpzfSldO2Nhc2UgNTpyZXR1cm5bNCxkLnNlbnQoKS5qc29uKCldO2Nhc2UgNjpyZXR1cm4odT1kLnNlbnQoKSkuaWQ/KChwPW5ldyBVUkwod2luZG93LmxvY2F0aW9uLmhyZWYpKS5oYXNoPSJqc29uPSIuY29uY2F0KHUuaWQsIiwiKS5jb25jYXQoYy5rKSxoPXAudG9TdHJpbmcoKSx3aW5kb3cucHJvbXB0KCLwn5SSIi5jb25jYXQoT2JqZWN0KGkuZSkoImFsZXJ0cy51cGxvYWRlZFNlY3VybHkiKSksaCkpOndpbmRvdy5hbGVydChPYmplY3QoaS5lKSgiYWxlcnRzLmNvdWxkTm90Q3JlYXRlU2hhcmVhYmxlTGluayIpKSxbMyw4XTtjYXNlIDc6cmV0dXJuIGY9ZC5zZW50KCksY29uc29sZS5lcnJvcihmKSx3aW5kb3cuYWxlcnQoT2JqZWN0KGkuZSkoImFsZXJ0cy5jb3VsZE5vdENyZWF0ZVNoYXJlYWJsZUxpbmsiKSksWzMsOF07Y2FzZSA4OnJldHVyblsyXX19KSl9KSk7cmV0dXJuIGZ1bmN0aW9uKHQsbil7cmV0dXJuIGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfX0oKSxBPWZ1bmN0aW9uKCl7dmFyIGU9ZygoZnVuY3Rpb24oZSx0KXt2YXIgbixvLGEscyxsLHUscCxmLG0sZztyZXR1cm4gZCh0aGlzLChmdW5jdGlvbihkKXtzd2l0Y2goZC5sYWJlbCl7Y2FzZSAwOm49W10sbz1PYmplY3Qoci5jKSgpLGQubGFiZWw9MTtjYXNlIDE6cmV0dXJuIGQudHJ5cy5wdXNoKFsxLDksMTAsMTFdKSxbNCxmZXRjaCh0PyIiLmNvbmNhdCh2KS5jb25jYXQoZSk6IiIuY29uY2F0KGIpLmNvbmNhdChlLCIuanNvbiIpKV07Y2FzZSAyOnJldHVybihhPWQuc2VudCgpKS5vaz8ocz12b2lkIDAsdD9bNCxhLmFycmF5QnVmZmVyKCldOlszLDZdKTood2luZG93LmFsZXJ0KE9iamVjdChpLmUpKCJhbGVydHMuaW1wb3J0QmFja2VuZEZhaWxlZCIpKSxbMixPYmplY3QoYy5hKShuLG8pXSk7Y2FzZSAzOnJldHVybiBsPWQuc2VudCgpLFs0LHgodCwiZGVjcnlwdCIpXTtjYXNlIDQ6cmV0dXJuIHU9ZC5zZW50KCkscD1uZXcgVWludDhBcnJheSgxMiksWzQsd2luZG93LmNyeXB0by5zdWJ0bGUuZGVjcnlwdCh7bmFtZToiQUVTLUdDTSIsaXY6cH0sdSxsKV07Y2FzZSA1OnJldHVybiBmPWQuc2VudCgpLG09bmV3IHdpbmRvdy5UZXh0RGVjb2RlcigidXRmLTgiKS5kZWNvZGUobmV3IFVpbnQ4QXJyYXkoZikpLHM9SlNPTi5wYXJzZShtKSxbMyw4XTtjYXNlIDY6cmV0dXJuWzQsYS5qc29uKCldO2Nhc2UgNzpzPWQuc2VudCgpLGQubGFiZWw9ODtjYXNlIDg6cmV0dXJuIG49cy5lbGVtZW50c3x8bixvPWgoaCh7fSxvKSxzLmFwcFN0YXRlKSxbMywxMV07Y2FzZSA5OnJldHVybiBnPWQuc2VudCgpLHdpbmRvdy5hbGVydChPYmplY3QoaS5lKSgiYWxlcnRzLmltcG9ydEJhY2tlbmRGYWlsZWQiKSksY29uc29sZS5lcnJvcihnKSxbMywxMV07Y2FzZSAxMDpyZXR1cm5bMixPYmplY3QoYy5hKShuLG8pXTtjYXNlIDExOnJldHVyblsyXX19KSl9KSk7cmV0dXJuIGZ1bmN0aW9uKHQsbil7cmV0dXJuIGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfX0oKSxNPWZ1bmN0aW9uKCl7dmFyIGU9ZygoZnVuY3Rpb24oZSx0LG4sbCxjKXt2YXIgdSxwLGYsbT1jLmV4cG9ydEJhY2tncm91bmQsYj1jLmV4cG9ydFBhZGRpbmcseT12b2lkIDA9PT1iPzEwOmIsdj1jLnZpZXdCYWNrZ3JvdW5kQ29sb3Isaz1jLm5hbWUsdz1jLnNjYWxlLFM9dm9pZCAwPT09dz8xOncsRT1jLnNob3VsZEFkZFdhdGVybWFyaztyZXR1cm4gZCh0aGlzLChmdW5jdGlvbihjKXtzd2l0Y2goYy5sYWJlbCl7Y2FzZSAwOnJldHVybiAwPT09dC5sZW5ndGg/WzIsd2luZG93LmFsZXJ0KE9iamVjdChpLmUpKCJhbGVydHMuY2Fubm90RXhwb3J0RW1wdHlDYW52YXMiKSldOiJzdmciIT09ZSYmImNsaXBib2FyZC1zdmciIT09ZT9bMywzXToodT1PYmplY3Qoby5jKSh0LHtleHBvcnRCYWNrZ3JvdW5kOm0sdmlld0JhY2tncm91bmRDb2xvcjp2LGV4cG9ydFBhZGRpbmc6eSxzaG91bGRBZGRXYXRlcm1hcms6RX0pLCJzdmciIT09ZT9bMywyXTpbNCxPYmplY3QoYS5iKShuZXcgQmxvYihbdS5vdXRlckhUTUxdLHt0eXBlOiJpbWFnZS9zdmcreG1sIn0pLHtmaWxlTmFtZToiIi5jb25jYXQoaywiLnN2ZyIpLGV4dGVuc2lvbnM6WyJzdmciXX0pXSk7Y2FzZSAxOnJldHVybiBjLnNlbnQoKSxbMl07Y2FzZSAyOmlmKCJjbGlwYm9hcmQtc3ZnIj09PWUpcmV0dXJuIE9iamVjdChzLmIpKHUpLFsyXTtjLmxhYmVsPTM7Y2FzZSAzOmlmKChwPU9iamVjdChvLmIpKHQsbix7ZXhwb3J0QmFja2dyb3VuZDptLHZpZXdCYWNrZ3JvdW5kQ29sb3I6dixleHBvcnRQYWRkaW5nOnksc2NhbGU6UyxzaG91bGRBZGRXYXRlcm1hcms6RX0pKS5zdHlsZS5kaXNwbGF5PSJub25lIixkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHApLCJwbmciPT09ZSlmPSIiLmNvbmNhdChrLCIucG5nIikscC50b0Jsb2IoZnVuY3Rpb24oKXt2YXIgZT1nKChmdW5jdGlvbihlKXtyZXR1cm4gZCh0aGlzLChmdW5jdGlvbih0KXtzd2l0Y2godC5sYWJlbCl7Y2FzZSAwOnJldHVybiBlP1s0LE9iamVjdChhLmIpKGUse2ZpbGVOYW1lOmYsZXh0ZW5zaW9uczpbInBuZyJdfSldOlszLDJdO2Nhc2UgMTp0LnNlbnQoKSx0LmxhYmVsPTI7Y2FzZSAyOnJldHVyblsyXX19KSl9KSk7cmV0dXJuIGZ1bmN0aW9uKHQpe3JldHVybiBlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX19KCkpO2Vsc2UgaWYoImNsaXBib2FyZCI9PT1lKXRyeXtPYmplY3Qocy5hKShwKX1jYXRjaChlKXt3aW5kb3cuYWxlcnQoT2JqZWN0KGkuZSkoImFsZXJ0cy5jb3VsZE5vdENvcHlUb0NsaXBib2FyZCIpKX1lbHNlImJhY2tlbmQiPT09ZSYmUCh0LGgoaCh7fSxuKSx7fSx7dmlld0JhY2tncm91bmRDb2xvcjptP24udmlld0JhY2tncm91bmRDb2xvcjpPYmplY3Qoci5jKSgpLnZpZXdCYWNrZ3JvdW5kQ29sb3J9KSk7cmV0dXJuIHAhPT1sJiZwLnJlbW92ZSgpLFsyXX19KSl9KSk7cmV0dXJuIGZ1bmN0aW9uKHQsbixyLG8sYSl7cmV0dXJuIGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfX0oKSxfPWZ1bmN0aW9uKCl7dmFyIGU9ZygoZnVuY3Rpb24oZSx0LG4pe3ZhciBvO3JldHVybiBkKHRoaXMsKGZ1bmN0aW9uKGEpe3N3aXRjaChhLmxhYmVsKXtjYXNlIDA6cmV0dXJuIG51bGw9PWU/WzMsMl06WzQsQShlLG4pXTtjYXNlIDE6cmV0dXJuIG89YS5zZW50KCksWzMsM107Y2FzZSAyOm89T2JqZWN0KGMuYSkodCxPYmplY3Qoci5jKSgpKSxhLmxhYmVsPTM7Y2FzZSAzOnJldHVyblsyLHtlbGVtZW50czpvLmVsZW1lbnRzLGFwcFN0YXRlOm8uYXBwU3RhdGUsY29tbWl0VG9IaXN0b3J5OiExfV19fSkpfSkpO3JldHVybiBmdW5jdGlvbih0LG4scil7cmV0dXJuIGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfX0oKX0pLmNhbGwodGhpcyxuKDQzKSl9LGZ1bmN0aW9uKGUsdCxuKXsidXNlIHN0cmljdCI7bi5kKHQsImIiLChmdW5jdGlvbigpe3JldHVybiBofSkpLG4uZCh0LCJjIiwoZnVuY3Rpb24oKXtyZXR1cm4gZn0pKSxuLmQodCwiYSIsKGZ1bmN0aW9uKCl7cmV0dXJuIG19KSksbi5kKHQsImQiLChmdW5jdGlvbigpe3JldHVybiB5fSkpLG4uZCh0LCJlIiwoZnVuY3Rpb24oKXtyZXR1cm4gdn0pKTt2YXIgcj1uKDExKSxvPW4oMTApLGE9bigyKSxpPW4oOSkscz1uKDIzKSxsPVsxMiw4XSxjPVszLDZdLHU9ZnVuY3Rpb24oZSx0LG4pe3N3aXRjaChuLmdsb2JhbEFscGhhPWUub3BhY2l0eS8xMDAsZS50eXBlKXtjYXNlInJlY3RhbmdsZSI6Y2FzZSJkaWFtb25kIjpjYXNlImVsbGlwc2UiOnQuZHJhdyhoKGUpKTticmVhaztjYXNlImFycm93IjpjYXNlImRyYXciOmNhc2UibGluZSI6aChlKS5mb3JFYWNoKChmdW5jdGlvbihlKXt0LmRyYXcoZSl9KSk7YnJlYWs7ZGVmYXVsdDppZighT2JqZWN0KHIuYykoZSkpdGhyb3cgbmV3IEVycm9yKCJVbmltcGxlbWVudGVkIHR5cGUgIi5jb25jYXQoZS50eXBlKSk7dmFyIG89T2JqZWN0KGEubikoZS50ZXh0KSxpPW8mJiFuLmNhbnZhcy5pc0Nvbm5lY3RlZDtpJiZkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG4uY2FudmFzKSxuLmNhbnZhcy5zZXRBdHRyaWJ1dGUoImRpciIsbz8icnRsIjoibHRyIik7dmFyIHM9bi5mb250O24uZm9udD1PYmplY3QoYS5pKShlKTt2YXIgbD1uLmZpbGxTdHlsZTtuLmZpbGxTdHlsZT1lLnN0cm9rZUNvbG9yO3ZhciBjPW4udGV4dEFsaWduO24udGV4dEFsaWduPWUudGV4dEFsaWduO2Zvcih2YXIgdT1lLnRleHQucmVwbGFjZSgvXHJcbj8vZywiXG4iKS5zcGxpdCgiXG4iKSxkPWUuaGVpZ2h0L3UubGVuZ3RoLHA9ZS5oZWlnaHQtZS5iYXNlbGluZSxmPSJjZW50ZXIiPT09ZS50ZXh0QWxpZ24/ZS53aWR0aC8yOiJyaWdodCI9PT1lLnRleHRBbGlnbj9lLndpZHRoOjAsbT0wO208dS5sZW5ndGg7bSsrKW4uZmlsbFRleHQodVttXSxmLChtKzEpKmQtcCk7bi5maWxsU3R5bGU9bCxuLmZvbnQ9cyxuLnRleHRBbGlnbj1jLGkmJm4uY2FudmFzLnJlbW92ZSgpfW4uZ2xvYmFsQWxwaGE9MX0sZD1uZXcgV2Vha01hcCxwPW5ldyBXZWFrTWFwLGg9ZnVuY3Rpb24oZSl7cmV0dXJuIHAuZ2V0KGUpfSxmPWZ1bmN0aW9uKGUpe3JldHVybiBwLmRlbGV0ZShlKX0sbT1mdW5jdGlvbihlKXt2YXIgdD17c2VlZDplLnNlZWQsc3Ryb2tlTGluZURhc2g6ImRhc2hlZCI9PT1lLnN0cm9rZVN0eWxlP2w6ImRvdHRlZCI9PT1lLnN0cm9rZVN0eWxlP2M6dm9pZCAwLGRpc2FibGVNdWx0aVN0cm9rZToic29saWQiIT09ZS5zdHJva2VTdHlsZSxzdHJva2VXaWR0aDoic29saWQiIT09ZS5zdHJva2VTdHlsZT9lLnN0cm9rZVdpZHRoKy41OmUuc3Ryb2tlV2lkdGgsZmlsbFdlaWdodDplLnN0cm9rZVdpZHRoLzIsaGFjaHVyZUdhcDo0KmUuc3Ryb2tlV2lkdGgscm91Z2huZXNzOmUucm91Z2huZXNzLHN0cm9rZTplLnN0cm9rZUNvbG9yfTtzd2l0Y2goZS50eXBlKXtjYXNlInJlY3RhbmdsZSI6Y2FzZSJkaWFtb25kIjpjYXNlImVsbGlwc2UiOnJldHVybiB0LmZpbGxTdHlsZT1lLmZpbGxTdHlsZSx0LmZpbGw9InRyYW5zcGFyZW50Ij09PWUuYmFja2dyb3VuZENvbG9yP3ZvaWQgMDplLmJhY2tncm91bmRDb2xvciwiZWxsaXBzZSI9PT1lLnR5cGUmJih0LmN1cnZlRml0dGluZz0xKSx0O2Nhc2UibGluZSI6Y2FzZSJkcmF3IjpyZXR1cm4gT2JqZWN0KGkuZikoZS5wb2ludHMpJiYodC5maWxsU3R5bGU9ZS5maWxsU3R5bGUsdC5maWxsPSJ0cmFuc3BhcmVudCI9PT1lLmJhY2tncm91bmRDb2xvcj92b2lkIDA6ZS5iYWNrZ3JvdW5kQ29sb3IpLHQ7Y2FzZSJhcnJvdyI6cmV0dXJuIHQ7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoIlVuaW1wbGVtZW50ZWQgdHlwZSAiLmNvbmNhdChlLnR5cGUpKX19LGc9ZnVuY3Rpb24oZSx0KXt2YXIgbj1wLmdldChlKXx8bnVsbDtpZighbil7c3dpdGNoKGQuZGVsZXRlKGUpLGUudHlwZSl7Y2FzZSJyZWN0YW5nbGUiOm49dC5yZWN0YW5nbGUoMCwwLGUud2lkdGgsZS5oZWlnaHQsbShlKSk7YnJlYWs7Y2FzZSJkaWFtb25kIjp2YXIgcj1PYmplY3Qoby5lKShlKSxhPXJbMF0saT1yWzFdLHM9clsyXSxsPXJbM10sYz1yWzRdLHU9cls1XSxoPXJbNl0sZj1yWzddO249dC5wb2x5Z29uKFtbYSxpXSxbcyxsXSxbYyx1XSxbaCxmXV0sbShlKSk7YnJlYWs7Y2FzZSJlbGxpcHNlIjpuPXQuZWxsaXBzZShlLndpZHRoLzIsZS5oZWlnaHQvMixlLndpZHRoLGUuaGVpZ2h0LG0oZSkpO2JyZWFrO2Nhc2UibGluZSI6Y2FzZSJkcmF3IjpjYXNlImFycm93Ijp2YXIgZz1tKGUpLGI9ZS5wb2ludHMubGVuZ3RoP2UucG9pbnRzOltbMCwwXV07aWYobj1bdC5jdXJ2ZShiLGcpXSwiYXJyb3ciPT09ZS50eXBlKXt2YXIgeT1PYmplY3Qoby5hKShlLG4pLHY9eVswXSxrPXlbMV0sdz15WzJdLFM9eVszXSxFPXlbNF0sTz15WzVdOyJkb3R0ZWQiPT09ZS5zdHJva2VTdHlsZT9nLnN0cm9rZUxpbmVEYXNoPVszLDRdOmRlbGV0ZSBnLnN0cm9rZUxpbmVEYXNoLG4ucHVzaC5hcHBseShuLFt0LmxpbmUodyxTLHYsayxnKSx0LmxpbmUoRSxPLHYsayxnKV0pfWJyZWFrO2Nhc2UidGV4dCI6bj1bXX1wLnNldChlLG4pfX0sYj1mdW5jdGlvbihlLHQpe3ZhciBuPXQ/dC56b29tOjEsaT1kLmdldChlKSxsPWkmJmkuY2FudmFzWm9vbSE9PW4mJiEobnVsbD09dD92b2lkIDA6dC5zaG91bGRDYWNoZUlnbm9yZVpvb20pO2lmKCFpfHxsKXt2YXIgYz1mdW5jdGlvbihlLHQpe3ZhciBuPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImNhbnZhcyIpLGk9bi5nZXRDb250ZXh0KCIyZCIpLGw9MCxjPTA7aWYoT2JqZWN0KHIuYikoZSkpe3ZhciBkPU9iamVjdChvLmYpKGUpLHA9ZFswXSxoPWRbMV0sZj1kWzJdLG09ZFszXTtuLndpZHRoPU9iamVjdChhLmUpKHAsZikqd2luZG93LmRldmljZVBpeGVsUmF0aW8qdCs0MCxuLmhlaWdodD1PYmplY3QoYS5lKShoLG0pKndpbmRvdy5kZXZpY2VQaXhlbFJhdGlvKnQrNDAsbD1lLng+cD9NYXRoLmZsb29yKE9iamVjdChhLmUpKGUueCxwKSkqd2luZG93LmRldmljZVBpeGVsUmF0aW86MCxjPWUueT5oP01hdGguZmxvb3IoT2JqZWN0KGEuZSkoZS55LGgpKSp3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbzowLGkudHJhbnNsYXRlKGwqdCxjKnQpfWVsc2Ugbi53aWR0aD1lLndpZHRoKndpbmRvdy5kZXZpY2VQaXhlbFJhdGlvKnQrNDAsbi5oZWlnaHQ9ZS5oZWlnaHQqd2luZG93LmRldmljZVBpeGVsUmF0aW8qdCs0MDtpLnRyYW5zbGF0ZSgyMCwyMCksaS5zY2FsZSh3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyp0LHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvKnQpO3ZhciBnPXMuYS5jYW52YXMobik7cmV0dXJuIHUoZSxnLGkpLGkudHJhbnNsYXRlKC0yMCwtMjApLGkuc2NhbGUoMS8od2luZG93LmRldmljZVBpeGVsUmF0aW8qdCksMS8od2luZG93LmRldmljZVBpeGVsUmF0aW8qdCkpLHtlbGVtZW50OmUsY2FudmFzOm4sY2FudmFzWm9vbTp0LGNhbnZhc09mZnNldFg6bCxjYW52YXNPZmZzZXRZOmN9fShlLG4pO3JldHVybiBkLnNldChlLGMpLGN9cmV0dXJuIGl9LHk9ZnVuY3Rpb24oZSx0LG4scixhKXt2YXIgaT10LmdlbmVyYXRvcjtzd2l0Y2goZS50eXBlKXtjYXNlInNlbGVjdGlvbiI6bi50cmFuc2xhdGUoZS54K2Euc2Nyb2xsWCxlLnkrYS5zY3JvbGxZKTt2YXIgcz1uLmZpbGxTdHlsZTtuLmZpbGxTdHlsZT0icmdiYSgwLCAwLCAyNTUsIDAuMTApIixuLmZpbGxSZWN0KDAsMCxlLndpZHRoLGUuaGVpZ2h0KSxuLmZpbGxTdHlsZT1zLG4udHJhbnNsYXRlKC1lLngtYS5zY3JvbGxYLC1lLnktYS5zY3JvbGxZKTticmVhaztjYXNlInJlY3RhbmdsZSI6Y2FzZSJkaWFtb25kIjpjYXNlImVsbGlwc2UiOmNhc2UibGluZSI6Y2FzZSJkcmF3IjpjYXNlImFycm93IjpjYXNlInRleHQiOmlmKGcoZSxpKSxyKXshZnVuY3Rpb24oZSx0LG4scil7dmFyIGE9ZS5lbGVtZW50LGk9T2JqZWN0KG8uZikoYSkscz1pWzBdLGw9aVsxXSxjPWlbMl0sdT1pWzNdLGQ9KChzK2MpLzIrci5zY3JvbGxYKSp3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyxwPSgobCt1KS8yK3Iuc2Nyb2xsWSkqd2luZG93LmRldmljZVBpeGVsUmF0aW87bi5zY2FsZSgxL3dpbmRvdy5kZXZpY2VQaXhlbFJhdGlvLDEvd2luZG93LmRldmljZVBpeGVsUmF0aW8pLG4udHJhbnNsYXRlKGQscCksbi5yb3RhdGUoYS5hbmdsZSksbi5kcmF3SW1hZ2UoZS5jYW52YXMsLShjLXMpLzIqd2luZG93LmRldmljZVBpeGVsUmF0aW8tMjAvZS5jYW52YXNab29tLC0odS1sKS8yKndpbmRvdy5kZXZpY2VQaXhlbFJhdGlvLTIwL2UuY2FudmFzWm9vbSxlLmNhbnZhcy53aWR0aC9lLmNhbnZhc1pvb20sZS5jYW52YXMuaGVpZ2h0L2UuY2FudmFzWm9vbSksbi5yb3RhdGUoLWEuYW5nbGUpLG4udHJhbnNsYXRlKC1kLC1wKSxuLnNjYWxlKHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvLHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvKX0oYihlLGEpLDAsbixhKX1lbHNle3ZhciBsPU9iamVjdChvLmYpKGUpLGM9bFswXSxkPWxbMV0scD1sWzJdLGg9bFszXSxmPShjK3ApLzIrYS5zY3JvbGxYLG09KGQraCkvMithLnNjcm9sbFkseT0ocC1jKS8yLShlLngtYyksdj0oaC1kKS8yLShlLnktZCk7bi50cmFuc2xhdGUoZixtKSxuLnJvdGF0ZShlLmFuZ2xlKSxuLnRyYW5zbGF0ZSgteSwtdiksdShlLHQsbiksbi50cmFuc2xhdGUoeSx2KSxuLnJvdGF0ZSgtZS5hbmdsZSksbi50cmFuc2xhdGUoLWYsLW0pfWJyZWFrO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKCJVbmltcGxlbWVudGVkIHR5cGUgIi5jb25jYXQoZS50eXBlKSl9fSx2PWZ1bmN0aW9uKGUsdCxuLHMsbCl7dmFyIGM9T2JqZWN0KG8uZikoZSksdT1jWzBdLGQ9Y1sxXSxwPWNbMl0sZj1jWzNdLG09KHAtdSkvMi0oZS54LXUpLGI9KGYtZCkvMi0oZS55LWQpLHk9MTgwKmUuYW5nbGUvTWF0aC5QSSx2PXQuZ2VuZXJhdG9yO3N3aXRjaChlLnR5cGUpe2Nhc2Uic2VsZWN0aW9uIjp0aHJvdyBuZXcgRXJyb3IoIlNlbGVjdGlvbiByZW5kZXJpbmcgaXMgbm90IHN1cHBvcnRlZCBmb3IgU1ZHIik7Y2FzZSJyZWN0YW5nbGUiOmNhc2UiZGlhbW9uZCI6Y2FzZSJlbGxpcHNlIjpnKGUsdik7dmFyIGs9dC5kcmF3KGgoZSkpOzEhPT0oRT1lLm9wYWNpdHkvMTAwKSYmKGsuc2V0QXR0cmlidXRlKCJzdHJva2Utb3BhY2l0eSIsIiIuY29uY2F0KEUpKSxrLnNldEF0dHJpYnV0ZSgiZmlsbC1vcGFjaXR5IiwiIi5jb25jYXQoRSkpKSxrLnNldEF0dHJpYnV0ZSgidHJhbnNmb3JtIiwidHJhbnNsYXRlKCIuY29uY2F0KHN8fDAsIiAiKS5jb25jYXQobHx8MCwiKSByb3RhdGUoIikuY29uY2F0KHksIiAiKS5jb25jYXQobSwiICIpLmNvbmNhdChiLCIpIikpLG4uYXBwZW5kQ2hpbGQoayk7YnJlYWs7Y2FzZSJsaW5lIjpjYXNlImRyYXciOmNhc2UiYXJyb3ciOmcoZSx2KTt2YXIgdz1uLm93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKGEuYSwiZyIpLFM9ZS5vcGFjaXR5LzEwMDtoKGUpLmZvckVhY2goKGZ1bmN0aW9uKG4pe3ZhciByPXQuZHJhdyhuKTsxIT09UyYmKHIuc2V0QXR0cmlidXRlKCJzdHJva2Utb3BhY2l0eSIsIiIuY29uY2F0KFMpKSxyLnNldEF0dHJpYnV0ZSgiZmlsbC1vcGFjaXR5IiwiIi5jb25jYXQoUykpKSxyLnNldEF0dHJpYnV0ZSgidHJhbnNmb3JtIiwidHJhbnNsYXRlKCIuY29uY2F0KHN8fDAsIiAiKS5jb25jYXQobHx8MCwiKSByb3RhdGUoIikuY29uY2F0KHksIiAiKS5jb25jYXQobSwiICIpLmNvbmNhdChiLCIpIikpLCJsaW5lIiE9PWUudHlwZSYmImRyYXciIT09ZS50eXBlfHwhT2JqZWN0KGkuZikoZS5wb2ludHMpfHwidHJhbnNwYXJlbnQiPT09ZS5iYWNrZ3JvdW5kQ29sb3J8fHIuc2V0QXR0cmlidXRlKCJmaWxsLXJ1bGUiLCJldmVub2RkIiksdy5hcHBlbmRDaGlsZChyKX0pKSxuLmFwcGVuZENoaWxkKHcpO2JyZWFrO2RlZmF1bHQ6aWYoIU9iamVjdChyLmMpKGUpKXRocm93IG5ldyBFcnJvcigiVW5pbXBsZW1lbnRlZCB0eXBlICIuY29uY2F0KGUudHlwZSkpO3ZhciBFPWUub3BhY2l0eS8xMDA7az1uLm93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKGEuYSwiZyIpOzEhPT1FJiYoay5zZXRBdHRyaWJ1dGUoInN0cm9rZS1vcGFjaXR5IiwiIi5jb25jYXQoRSkpLGsuc2V0QXR0cmlidXRlKCJmaWxsLW9wYWNpdHkiLCIiLmNvbmNhdChFKSkpLGsuc2V0QXR0cmlidXRlKCJ0cmFuc2Zvcm0iLCJ0cmFuc2xhdGUoIi5jb25jYXQoc3x8MCwiICIpLmNvbmNhdChsfHwwLCIpIHJvdGF0ZSgiKS5jb25jYXQoeSwiICIpLmNvbmNhdChtLCIgIikuY29uY2F0KGIsIikiKSk7Zm9yKHZhciBPPWUudGV4dC5yZXBsYWNlKC9cclxuPy9nLCJcbiIpLnNwbGl0KCJcbiIpLEM9ZS5oZWlnaHQvTy5sZW5ndGgseD1lLmhlaWdodC1lLmJhc2VsaW5lLGo9ImNlbnRlciI9PT1lLnRleHRBbGlnbj9lLndpZHRoLzI6InJpZ2h0Ij09PWUudGV4dEFsaWduP2Uud2lkdGg6MCxUPU9iamVjdChhLm4pKGUudGV4dCk/InJ0bCI6Imx0ciIsUD0iY2VudGVyIj09PWUudGV4dEFsaWduPyJtaWRkbGUiOiJyaWdodCI9PT1lLnRleHRBbGlnbnx8InJ0bCI9PT1UPyJlbmQiOiJzdGFydCIsQT0wO0E8Ty5sZW5ndGg7QSsrKXt2YXIgTT1uLm93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKGEuYSwidGV4dCIpO00udGV4dENvbnRlbnQ9T1tBXSxNLnNldEF0dHJpYnV0ZSgieCIsIiIuY29uY2F0KGopKSxNLnNldEF0dHJpYnV0ZSgieSIsIiIuY29uY2F0KChBKzEpKkMteCkpLE0uc2V0QXR0cmlidXRlKCJmb250LWZhbWlseSIsT2JqZWN0KGEuaCkoZSkpLE0uc2V0QXR0cmlidXRlKCJmb250LXNpemUiLCIiLmNvbmNhdChlLmZvbnRTaXplLCJweCIpKSxNLnNldEF0dHJpYnV0ZSgiZmlsbCIsZS5zdHJva2VDb2xvciksTS5zZXRBdHRyaWJ1dGUoInRleHQtYW5jaG9yIixQKSxNLnNldEF0dHJpYnV0ZSgic3R5bGUiLCJ3aGl0ZS1zcGFjZTogcHJlOyIpLE0uc2V0QXR0cmlidXRlKCJkaXJlY3Rpb24iLFQpLGsuYXBwZW5kQ2hpbGQoTSl9bi5hcHBlbmRDaGlsZChrKX19fSxmdW5jdGlvbihlLHQsbil7InVzZSBzdHJpY3QiO24uZCh0LCJhIiwoZnVuY3Rpb24oKXtyZXR1cm4gc30pKSxuLmQodCwiYiIsKGZ1bmN0aW9uKCl7cmV0dXJuIGx9KSk7bigxNyk7dmFyIHI9bigzMSksbz1mdW5jdGlvbihlLHQpe3ZhciBuLHIsbyxhLGk9e2xhYmVsOjAsc2VudDpmdW5jdGlvbigpe2lmKDEmb1swXSl0aHJvdyBvWzFdO3JldHVybiBvWzFdfSx0cnlzOltdLG9wczpbXX07cmV0dXJuIGE9e25leHQ6cygwKSx0aHJvdzpzKDEpLHJldHVybjpzKDIpfSwiZnVuY3Rpb24iPT10eXBlb2YgU3ltYm9sJiYoYVtTeW1ib2wuaXRlcmF0b3JdPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9KSxhO2Z1bmN0aW9uIHMoYSl7cmV0dXJuIGZ1bmN0aW9uKHMpe3JldHVybiBmdW5jdGlvbihhKXtpZihuKXRocm93IG5ldyBUeXBlRXJyb3IoIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy4iKTtmb3IoO2k7KXRyeXtpZihuPTEsciYmKG89MiZhWzBdP3IucmV0dXJuOmFbMF0/ci50aHJvd3x8KChvPXIucmV0dXJuKSYmby5jYWxsKHIpLDApOnIubmV4dCkmJiEobz1vLmNhbGwocixhWzFdKSkuZG9uZSlyZXR1cm4gbztzd2l0Y2gocj0wLG8mJihhPVsyJmFbMF0sby52YWx1ZV0pLGFbMF0pe2Nhc2UgMDpjYXNlIDE6bz1hO2JyZWFrO2Nhc2UgNDpyZXR1cm4gaS5sYWJlbCsrLHt2YWx1ZTphWzFdLGRvbmU6ITF9O2Nhc2UgNTppLmxhYmVsKysscj1hWzFdLGE9WzBdO2NvbnRpbnVlO2Nhc2UgNzphPWkub3BzLnBvcCgpLGkudHJ5cy5wb3AoKTtjb250aW51ZTtkZWZhdWx0OmlmKCEobz1pLnRyeXMsKG89by5sZW5ndGg+MCYmb1tvLmxlbmd0aC0xXSl8fDYhPT1hWzBdJiYyIT09YVswXSkpe2k9MDtjb250aW51ZX1pZigzPT09YVswXSYmKCFvfHxhWzFdPm9bMF0mJmFbMV08b1szXSkpe2kubGFiZWw9YVsxXTticmVha31pZig2PT09YVswXSYmaS5sYWJlbDxvWzFdKXtpLmxhYmVsPW9bMV0sbz1hO2JyZWFrfWlmKG8mJmkubGFiZWw8b1syXSl7aS5sYWJlbD1vWzJdLGkub3BzLnB1c2goYSk7YnJlYWt9b1syXSYmaS5vcHMucG9wKCksaS50cnlzLnBvcCgpO2NvbnRpbnVlfWE9dC5jYWxsKGUsaSl9Y2F0Y2goZSl7YT1bNixlXSxyPTB9ZmluYWxseXtuPW89MH1pZig1JmFbMF0pdGhyb3cgYVsxXTtyZXR1cm57dmFsdWU6YVswXT9hWzFdOnZvaWQgMCxkb25lOiEwfX0oW2Esc10pfX19O2Z1bmN0aW9uIGEoZSx0LG4scixvLGEsaSl7dHJ5e3ZhciBzPWVbYV0oaSksbD1zLnZhbHVlfWNhdGNoKGUpe3JldHVybiB2b2lkIG4oZSl9cy5kb25lP3QobCk6UHJvbWlzZS5yZXNvbHZlKGwpLnRoZW4ocixvKX12YXIgaT1udWxsLHM9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oKXt2YXIgZSx0PShlPWZ1bmN0aW9uKGUpe3ZhciB0LG47cmV0dXJuIG8odGhpcywoZnVuY3Rpb24obyl7aWYoaSlyZXR1cm5bMixlKEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoaSkpKV07dHJ5e2lmKCEodD1sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgiZXhjYWxpZHJhdy1saWJyYXJ5IikpKXJldHVyblsyLGUoW10pXTtuPUpTT04ucGFyc2UodCkubWFwKChmdW5jdGlvbihlKXtyZXR1cm4gT2JqZWN0KHIuYSkoZSxudWxsKS5lbGVtZW50c30pKSxpPUpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkobikpLGUobil9Y2F0Y2godCl7Y29uc29sZS5lcnJvcih0KSxlKFtdKX1yZXR1cm5bMl19KSl9LGZ1bmN0aW9uKCl7dmFyIHQ9dGhpcyxuPWFyZ3VtZW50cztyZXR1cm4gbmV3IFByb21pc2UoKGZ1bmN0aW9uKHIsbyl7dmFyIGk9ZS5hcHBseSh0LG4pO2Z1bmN0aW9uIHMoZSl7YShpLHIsbyxzLGwsIm5leHQiLGUpfWZ1bmN0aW9uIGwoZSl7YShpLHIsbyxzLGwsInRocm93IixlKX1zKHZvaWQgMCl9KSl9KTtyZXR1cm4gZnVuY3Rpb24oZSl7cmV0dXJuIHQuYXBwbHkodGhpcyxhcmd1bWVudHMpfX0oKSl9LGw9ZnVuY3Rpb24oZSl7dmFyIHQ9aTt0cnl7dmFyIG49SlNPTi5zdHJpbmdpZnkoZSk7aT1KU09OLnBhcnNlKG4pLGxvY2FsU3RvcmFnZS5zZXRJdGVtKCJleGNhbGlkcmF3LWxpYnJhcnkiLG4pfWNhdGNoKGUpe2k9dCxjb25zb2xlLmVycm9yKGUpfX19LGZ1bmN0aW9uKGUsdCxuKXsidXNlIHN0cmljdCI7bi5kKHQsImEiLChmdW5jdGlvbigpe3JldHVybiBwfSkpO3ZhciByPW4oOSksbz1uKDQpLGE9bigxMCksaT1uKDgpLHM9bigyMiksbD1mdW5jdGlvbigpe2Zvcih2YXIgZT0wLHQ9MCxuPWFyZ3VtZW50cy5sZW5ndGg7dDxuO3QrKyllKz1hcmd1bWVudHNbdF0ubGVuZ3RoO3ZhciByPUFycmF5KGUpLG89MDtmb3IodD0wO3Q8bjt0KyspZm9yKHZhciBhPWFyZ3VtZW50c1t0XSxpPTAscz1hLmxlbmd0aDtpPHM7aSsrLG8rKylyW29dPWFbaV07cmV0dXJuIHJ9O2Z1bmN0aW9uIGMoZSx0KXt2YXIgbj1PYmplY3Qua2V5cyhlKTtpZihPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgcj1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO3QmJihyPXIuZmlsdGVyKChmdW5jdGlvbih0KXtyZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihlLHQpLmVudW1lcmFibGV9KSkpLG4ucHVzaC5hcHBseShuLHIpfXJldHVybiBufWZ1bmN0aW9uIHUoZSl7Zm9yKHZhciB0PTE7dDxhcmd1bWVudHMubGVuZ3RoO3QrKyl7dmFyIG49bnVsbCE9YXJndW1lbnRzW3RdP2FyZ3VtZW50c1t0XTp7fTt0JTI/YyhPYmplY3QobiksITApLmZvckVhY2goKGZ1bmN0aW9uKHQpe2QoZSx0LG5bdF0pfSkpOk9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzP09iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGUsT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMobikpOmMoT2JqZWN0KG4pKS5mb3JFYWNoKChmdW5jdGlvbih0KXtPYmplY3QuZGVmaW5lUHJvcGVydHkoZSx0LE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iobix0KSl9KSl9cmV0dXJuIGV9ZnVuY3Rpb24gZChlLHQsbil7cmV0dXJuIHQgaW4gZT9PYmplY3QuZGVmaW5lUHJvcGVydHkoZSx0LHt2YWx1ZTpuLGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwLHdyaXRhYmxlOiEwfSk6ZVt0XT1uLGV9dmFyIHA9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQsbil7dGhpcy5lbGVtZW50SWQ9dC5pZCxzLmEubWFwRWxlbWVudFRvU2NlbmUodGhpcy5lbGVtZW50SWQsbiksZS5ub3JtYWxpemVQb2ludHModCksdGhpcy5hY3RpdmVQb2ludEluZGV4PW51bGwsdGhpcy5sYXN0VW5jb21taXR0ZWRQb2ludD1udWxsLHRoaXMuZHJhZ2dpbmdFbGVtZW50UG9pbnRJbmRleD1udWxsfXJldHVybiBlLmdldEVsZW1lbnQ9ZnVuY3Rpb24oZSl7dmFyIHQsbj1udWxsPT09KHQ9cy5hLmdldFNjZW5lKGUpKXx8dm9pZCAwPT09dD92b2lkIDA6dC5nZXROb25EZWxldGVkRWxlbWVudChlKTtyZXR1cm4gbnx8bnVsbH0sZS5oYW5kbGVQb2ludERyYWdnaW5nPWZ1bmN0aW9uKHQsbixvLGEsaSxzKXt2YXIgbCxjO2lmKCF0LmVkaXRpbmdMaW5lYXJFbGVtZW50KXJldHVybiExO3ZhciBkPXQuZWRpdGluZ0xpbmVhckVsZW1lbnQscD1kLmRyYWdnaW5nRWxlbWVudFBvaW50SW5kZXgsaD1kLmVsZW1lbnRJZCxmPWUuZ2V0RWxlbWVudChoKTtpZighZilyZXR1cm4hMTt2YXIgbT1udWxsIT09KGw9cCkmJnZvaWQgMCE9PWw/bDplLmdldFBvaW50SW5kZXhVbmRlckN1cnNvcihmLHQuem9vbSxvLGEpO2lmKChwPW51bGwhPT0oYz1wKSYmdm9pZCAwIT09Yz9jOm0pPi0xKXtkLmRyYWdnaW5nRWxlbWVudFBvaW50SW5kZXg9PT1wJiZkLmFjdGl2ZVBvaW50SW5kZXg9PT1tfHxuKHtlZGl0aW5nTGluZWFyRWxlbWVudDp1KHUoe30sZCkse30se2RyYWdnaW5nRWxlbWVudFBvaW50SW5kZXg6cCxhY3RpdmVQb2ludEluZGV4Om19KX0pO3ZhciBnPU9iamVjdChyLmgpKG8taSxhLXMsMCwwLC1mLmFuZ2xlKSxiPWdbMF0seT1nWzFdLHY9Zi5wb2ludHNbbV07cmV0dXJuIGUubW92ZVBvaW50KGYsbSxbdlswXStiLHZbMV0reV0pLCEwfXJldHVybiExfSxlLmhhbmRsZVBvaW50ZXJVcD1mdW5jdGlvbih0KXt2YXIgbj10LmVsZW1lbnRJZCxvPXQuZHJhZ2dpbmdFbGVtZW50UG9pbnRJbmRleCxhPWUuZ2V0RWxlbWVudChuKTtyZXR1cm4gYT8obnVsbD09PW98fDAhPT1vJiZvIT09YS5wb2ludHMubGVuZ3RoLTF8fCFPYmplY3Qoci5mKShhLnBvaW50cyl8fGUubW92ZVBvaW50KGEsbywwPT09bz9hLnBvaW50c1thLnBvaW50cy5sZW5ndGgtMV06YS5wb2ludHNbMF0pLG51bGwhPT1vP3UodSh7fSx0KSx7fSx7ZHJhZ2dpbmdFbGVtZW50UG9pbnRJbmRleDpudWxsfSk6dCk6dH0sZS5oYW5kbGVQb2ludGVyRG93bj1mdW5jdGlvbih0LG4scixvLGEscyl7dmFyIGM9e2RpZEFkZFBvaW50OiExLGhpdEVsZW1lbnQ6bnVsbH07aWYoIW4uZWRpdGluZ0xpbmVhckVsZW1lbnQpcmV0dXJuIGM7dmFyIGQ9bi5lZGl0aW5nTGluZWFyRWxlbWVudC5lbGVtZW50SWQscD1lLmdldEVsZW1lbnQoZCk7aWYoIXApcmV0dXJuIGM7aWYodC5hbHRLZXkpcmV0dXJuIG4uZWRpdGluZ0xpbmVhckVsZW1lbnQubGFzdFVuY29tbWl0dGVkUG9pbnR8fE9iamVjdChpLmEpKHAse3BvaW50czpsKHAucG9pbnRzLFtlLmNyZWF0ZVBvaW50QXQocCxhLHMpXSl9KSxvLnJlc3VtZVJlY29yZGluZygpLHIoe2VkaXRpbmdMaW5lYXJFbGVtZW50OnUodSh7fSxuLmVkaXRpbmdMaW5lYXJFbGVtZW50KSx7fSx7YWN0aXZlUG9pbnRJbmRleDpwLnBvaW50cy5sZW5ndGgtMSxsYXN0VW5jb21taXR0ZWRQb2ludDpudWxsfSl9KSxjLmRpZEFkZFBvaW50PSEwLGM7dmFyIGg9ZS5nZXRQb2ludEluZGV4VW5kZXJDdXJzb3IocCxuLnpvb20sYSxzKTtyZXR1cm4gaD4tMSYmKGMuaGl0RWxlbWVudD1wKSxyKHtlZGl0aW5nTGluZWFyRWxlbWVudDp1KHUoe30sbi5lZGl0aW5nTGluZWFyRWxlbWVudCkse30se2FjdGl2ZVBvaW50SW5kZXg6aD4tMT9oOm51bGx9KX0pLGN9LGUuaGFuZGxlUG9pbnRlck1vdmU9ZnVuY3Rpb24odCxuLHIsbyl7dmFyIGE9by5lbGVtZW50SWQsaT1vLmxhc3RVbmNvbW1pdHRlZFBvaW50LHM9ZS5nZXRFbGVtZW50KGEpO2lmKCFzKXJldHVybiBvO3ZhciBsPXMucG9pbnRzLGM9bFtsLmxlbmd0aC0xXTtpZighdC5hbHRLZXkpcmV0dXJuIGM9PT1pJiZlLm1vdmVQb2ludChzLGwubGVuZ3RoLTEsImRlbGV0ZSIpLG87dmFyIGQ9ZS5jcmVhdGVQb2ludEF0KHMsbixyKTtyZXR1cm4gYz09PWk/ZS5tb3ZlUG9pbnQocyxzLnBvaW50cy5sZW5ndGgtMSxkKTplLm1vdmVQb2ludChzLCJuZXciLGQpLHUodSh7fSxvKSx7fSx7bGFzdFVuY29tbWl0dGVkUG9pbnQ6cy5wb2ludHNbcy5wb2ludHMubGVuZ3RoLTFdfSl9LGUuZ2V0UG9pbnRzR2xvYmFsQ29vcmRpbmF0ZXM9ZnVuY3Rpb24oZSl7dmFyIHQ9T2JqZWN0KG8uaikoZSksbj10WzBdLGE9dFsxXSxpPXRbMl0scz10WzNdLGw9KG4raSkvMixjPShhK3MpLzI7cmV0dXJuIGUucG9pbnRzLm1hcCgoZnVuY3Rpb24odCl7dmFyIG4sbz1lLngsYT1lLnk7cmV0dXJuW289KG49T2JqZWN0KHIuaCkobyt0WzBdLGErdFsxXSxsLGMsZS5hbmdsZSkpWzBdLGE9blsxXV19KSl9LGUuZ2V0UG9pbnRJbmRleFVuZGVyQ3Vyc29yPWZ1bmN0aW9uKGUsdCxuLG8pe2Zvcih2YXIgYT10aGlzLmdldFBvaW50c0dsb2JhbENvb3JkaW5hdGVzKGUpLGk9YS5sZW5ndGg7LS1pPi0xOyl7dmFyIHM9YVtpXTtpZihPYmplY3Qoci5iKShuLG8sc1swXSxzWzFdKSp0PHRoaXMuUE9JTlRfSEFORExFX1NJWkUvMisxKXJldHVybiBpfXJldHVybi0xfSxlLmNyZWF0ZVBvaW50QXQ9ZnVuY3Rpb24oZSx0LG4pe3ZhciBhPU9iamVjdChvLmopKGUpLGk9YVswXSxzPWFbMV0sbD0oaSthWzJdKS8yLGM9KHMrYVszXSkvMix1PU9iamVjdChyLmgpKHQsbixsLGMsLWUuYW5nbGUpLGQ9dVswXSxwPXVbMV07cmV0dXJuW2QtZS54LHAtZS55XX0sZS5ub3JtYWxpemVQb2ludHM9ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5wb2ludHMsbj10WzBdWzBdLHI9dFswXVsxXTtPYmplY3QoaS5hKShlLHtwb2ludHM6dC5tYXAoKGZ1bmN0aW9uKGUsdCl7cmV0dXJuW2VbMF0tbixlWzFdLXJdfSkpLHg6ZS54K24seTplLnkrcn0pfSxlLm1vdmVQb2ludD1mdW5jdGlvbihlLHQsbil7dmFyIG8scz1lLnBvaW50cyxjPTAsdT0wO2lmKCJkZWxldGUiPT09bil7aWYoIm5ldyI9PT10KXRocm93IG5ldyBFcnJvcigiaW52YWxpZCBhcmdzIGluIG1vdmVQb2ludCIpOyhvPXMuc2xpY2UoKSkuc3BsaWNlKHQsMSksMD09PXQmJihjPW9bMF1bMF0sdT1vWzBdWzFdLG89by5tYXAoKGZ1bmN0aW9uKGUsdCl7cmV0dXJuIDA9PT10P1swLDBdOltlWzBdLWMsZVsxXS11XX0pKSl9ZWxzZSBpZigibmV3Ij09PXQpbz1sKHMsW25dKTtlbHNle3ZhciBkPW5bMF0tc1t0XVswXSxwPW5bMV0tc1t0XVsxXTtvPXMubWFwKChmdW5jdGlvbihlLG4pe3JldHVybiBuPT09dD8wPT09bj8oYz1kLHU9cCxlKTooYz0wLHU9MCxbZVswXStkLGVbMV0rcF0pOmN8fHU/W2VbMF0tYyxlWzFdLXVdOmV9KSl9dmFyIGg9T2JqZWN0KGEuaCkoZSxvKSxmPU9iamVjdChhLmgpKGUscyksbT0oaFswXStoWzJdKS8yLGc9KGhbMV0raFszXSkvMixiPShmWzBdK2ZbMl0pLzItbSx5PShmWzFdK2ZbM10pLzItZyx2PU9iamVjdChyLmgpKGMsdSxiLHksZS5hbmdsZSk7T2JqZWN0KGkuYSkoZSx7cG9pbnRzOm8seDplLngrdlswXSx5OmUueSt2WzFdfSl9LGV9KCk7cC5QT0lOVF9IQU5ETEVfU0laRT0yMH0sZnVuY3Rpb24oZSx0LG4peyJ1c2Ugc3RyaWN0IjtuLmQodCwiYyIsKGZ1bmN0aW9uKCl7cmV0dXJuIHN9KSksbi5kKHQsImIiLChmdW5jdGlvbigpe3JldHVybiB1fSkpLG4uZCh0LCJhIiwoZnVuY3Rpb24oKXtyZXR1cm4gZH0pKTt2YXIgcj1uKDcpLG89bigyKSxhPW4oMSksaT1uKDMpLHM9ZnVuY3Rpb24oKXtyZXR1cm57aXNMb2FkaW5nOiExLGVycm9yTWVzc2FnZTpudWxsLGRyYWdnaW5nRWxlbWVudDpudWxsLHJlc2l6aW5nRWxlbWVudDpudWxsLG11bHRpRWxlbWVudDpudWxsLGVkaXRpbmdFbGVtZW50Om51bGwsZWRpdGluZ0xpbmVhckVsZW1lbnQ6bnVsbCxlbGVtZW50VHlwZToic2VsZWN0aW9uIixlbGVtZW50TG9ja2VkOiExLGV4cG9ydEJhY2tncm91bmQ6ITAsc2hvdWxkQWRkV2F0ZXJtYXJrOiExLGN1cnJlbnRJdGVtU3Ryb2tlQ29sb3I6ci5ibGFjayxjdXJyZW50SXRlbUJhY2tncm91bmRDb2xvcjoidHJhbnNwYXJlbnQiLGN1cnJlbnRJdGVtRmlsbFN0eWxlOiJoYWNodXJlIixjdXJyZW50SXRlbVN0cm9rZVdpZHRoOjEsY3VycmVudEl0ZW1TdHJva2VTdHlsZToic29saWQiLGN1cnJlbnRJdGVtUm91Z2huZXNzOjEsY3VycmVudEl0ZW1PcGFjaXR5OjEwMCxjdXJyZW50SXRlbUZvbnRTaXplOmkuZixjdXJyZW50SXRlbUZvbnRGYW1pbHk6aS5lLGN1cnJlbnRJdGVtVGV4dEFsaWduOmkuZyx2aWV3QmFja2dyb3VuZENvbG9yOnIud2hpdGUsc2Nyb2xsWDowLHNjcm9sbFk6MCxjdXJzb3JYOjAsY3Vyc29yWTowLGN1cnNvckJ1dHRvbjoidXAiLHNjcm9sbGVkT3V0c2lkZTohMSxuYW1lOiIiLmNvbmNhdChPYmplY3QoYS5lKSgibGFiZWxzLnVudGl0bGVkIiksIi0iKS5jb25jYXQoT2JqZWN0KG8uZykoKSksdXNlcm5hbWU6IiIsaXNDb2xsYWJvcmF0aW5nOiExLGlzUmVzaXppbmc6ITEsaXNSb3RhdGluZzohMSxzZWxlY3Rpb25FbGVtZW50Om51bGwsem9vbToxLG9wZW5NZW51Om51bGwsbGFzdFBvaW50ZXJEb3duV2l0aDoibW91c2UiLHNlbGVjdGVkRWxlbWVudElkczp7fSxwcmV2aW91c1NlbGVjdGVkRWxlbWVudElkczp7fSxjb2xsYWJvcmF0b3JzOm5ldyBNYXAsc2hvdWxkQ2FjaGVJZ25vcmVab29tOiExLHNob3dTaG9ydGN1dHNEaWFsb2c6ITEsemVuTW9kZUVuYWJsZWQ6ITEsZ3JpZFNpemU6bnVsbCxlZGl0aW5nR3JvdXBJZDpudWxsLHNlbGVjdGVkR3JvdXBJZHM6e30sd2lkdGg6d2luZG93LmlubmVyV2lkdGgsaGVpZ2h0OndpbmRvdy5pbm5lckhlaWdodCxpc0xpYnJhcnlPcGVuOiExfX0sbD17Y29sbGFib3JhdG9yczp7YnJvd3NlcjohMSxleHBvcnQ6ITF9LGN1cnJlbnRJdGVtQmFja2dyb3VuZENvbG9yOnticm93c2VyOiEwLGV4cG9ydDohMX0sY3VycmVudEl0ZW1GaWxsU3R5bGU6e2Jyb3dzZXI6ITAsZXhwb3J0OiExfSxjdXJyZW50SXRlbUZvbnRGYW1pbHk6e2Jyb3dzZXI6ITAsZXhwb3J0OiExfSxjdXJyZW50SXRlbUZvbnRTaXplOnticm93c2VyOiEwLGV4cG9ydDohMX0sY3VycmVudEl0ZW1PcGFjaXR5Onticm93c2VyOiEwLGV4cG9ydDohMX0sY3VycmVudEl0ZW1Sb3VnaG5lc3M6e2Jyb3dzZXI6ITAsZXhwb3J0OiExfSxjdXJyZW50SXRlbVN0cm9rZUNvbG9yOnticm93c2VyOiEwLGV4cG9ydDohMX0sY3VycmVudEl0ZW1TdHJva2VTdHlsZTp7YnJvd3NlcjohMCxleHBvcnQ6ITF9LGN1cnJlbnRJdGVtU3Ryb2tlV2lkdGg6e2Jyb3dzZXI6ITAsZXhwb3J0OiExfSxjdXJyZW50SXRlbVRleHRBbGlnbjp7YnJvd3NlcjohMCxleHBvcnQ6ITF9LGN1cnNvckJ1dHRvbjp7YnJvd3NlcjohMCxleHBvcnQ6ITF9LGN1cnNvclg6e2Jyb3dzZXI6ITAsZXhwb3J0OiExfSxjdXJzb3JZOnticm93c2VyOiEwLGV4cG9ydDohMX0sZHJhZ2dpbmdFbGVtZW50Onticm93c2VyOiExLGV4cG9ydDohMX0sZWRpdGluZ0VsZW1lbnQ6e2Jyb3dzZXI6ITEsZXhwb3J0OiExfSxlZGl0aW5nR3JvdXBJZDp7YnJvd3NlcjohMCxleHBvcnQ6ITF9LGVkaXRpbmdMaW5lYXJFbGVtZW50Onticm93c2VyOiExLGV4cG9ydDohMX0sZWxlbWVudExvY2tlZDp7YnJvd3NlcjohMCxleHBvcnQ6ITF9LGVsZW1lbnRUeXBlOnticm93c2VyOiEwLGV4cG9ydDohMX0sZXJyb3JNZXNzYWdlOnticm93c2VyOiExLGV4cG9ydDohMX0sZXhwb3J0QmFja2dyb3VuZDp7YnJvd3NlcjohMCxleHBvcnQ6ITF9LGdyaWRTaXplOnticm93c2VyOiEwLGV4cG9ydDohMH0saGVpZ2h0Onticm93c2VyOiExLGV4cG9ydDohMX0saXNDb2xsYWJvcmF0aW5nOnticm93c2VyOiExLGV4cG9ydDohMX0saXNMaWJyYXJ5T3Blbjp7YnJvd3NlcjohMSxleHBvcnQ6ITF9LGlzTG9hZGluZzp7YnJvd3NlcjohMSxleHBvcnQ6ITF9LGlzUmVzaXppbmc6e2Jyb3dzZXI6ITEsZXhwb3J0OiExfSxpc1JvdGF0aW5nOnticm93c2VyOiExLGV4cG9ydDohMX0sbGFzdFBvaW50ZXJEb3duV2l0aDp7YnJvd3NlcjohMCxleHBvcnQ6ITF9LG11bHRpRWxlbWVudDp7YnJvd3NlcjohMSxleHBvcnQ6ITF9LG5hbWU6e2Jyb3dzZXI6ITAsZXhwb3J0OiExfSxvcGVuTWVudTp7YnJvd3NlcjohMCxleHBvcnQ6ITF9LHByZXZpb3VzU2VsZWN0ZWRFbGVtZW50SWRzOnticm93c2VyOiEwLGV4cG9ydDohMX0scmVzaXppbmdFbGVtZW50Onticm93c2VyOiExLGV4cG9ydDohMX0sc2Nyb2xsZWRPdXRzaWRlOnticm93c2VyOiEwLGV4cG9ydDohMX0sc2Nyb2xsWDp7YnJvd3NlcjohMCxleHBvcnQ6ITF9LHNjcm9sbFk6e2Jyb3dzZXI6ITAsZXhwb3J0OiExfSxzZWxlY3RlZEVsZW1lbnRJZHM6e2Jyb3dzZXI6ITAsZXhwb3J0OiExfSxzZWxlY3RlZEdyb3VwSWRzOnticm93c2VyOiEwLGV4cG9ydDohMX0sc2VsZWN0aW9uRWxlbWVudDp7YnJvd3NlcjohMSxleHBvcnQ6ITF9LHNob3VsZEFkZFdhdGVybWFyazp7YnJvd3NlcjohMCxleHBvcnQ6ITF9LHNob3VsZENhY2hlSWdub3JlWm9vbTp7YnJvd3NlcjohMCxleHBvcnQ6ITF9LHNob3dTaG9ydGN1dHNEaWFsb2c6e2Jyb3dzZXI6ITEsZXhwb3J0OiExfSx1c2VybmFtZTp7YnJvd3NlcjohMCxleHBvcnQ6ITF9LHZpZXdCYWNrZ3JvdW5kQ29sb3I6e2Jyb3dzZXI6ITAsZXhwb3J0OiEwfSx3aWR0aDp7YnJvd3NlcjohMSxleHBvcnQ6ITF9LHplbk1vZGVFbmFibGVkOnticm93c2VyOiEwLGV4cG9ydDohMX0sem9vbTp7YnJvd3NlcjohMCxleHBvcnQ6ITF9LG9mZnNldFRvcDp7YnJvd3NlcjohMSxleHBvcnQ6ITF9LG9mZnNldExlZnQ6e2Jyb3dzZXI6ITEsZXhwb3J0OiExfX0sYz1mdW5jdGlvbihlLHQpe2Zvcih2YXIgbj17fSxyPTAsbz1PYmplY3Qua2V5cyhlKTtyPG8ubGVuZ3RoO3IrKyl7dmFyIGE9b1tyXSxpPWxbYV07aXx8Y29uc29sZS5lcnJvcignX2NsZWFyQXBwU3RhdGVGb3JTdG9yYWdlOiBhcHBTdGF0ZSBrZXkgIicuY29uY2F0KGEsJyIgY29uZmlnIGRvZXNuXCd0IGV4aXN0IGZvciAiJykuY29uY2F0KHQsJyIgZXhwb3J0IHR5cGUnKSksKG51bGw9PWk/dm9pZCAwOmlbdF0pJiYoblthXT1lW2FdKX1yZXR1cm4gbn0sdT1mdW5jdGlvbihlKXtyZXR1cm4gYyhlLCJicm93c2VyIil9LGQ9ZnVuY3Rpb24oZSl7cmV0dXJuIGMoZSwiZXhwb3J0Iil9fSxmdW5jdGlvbihlLHQsbil7InVzZSBzdHJpY3QiO24uZCh0LCJnIiwoZnVuY3Rpb24oKXtyZXR1cm4gdn0pKSxuLmQodCwiZiIsKGZ1bmN0aW9uKCl7cmV0dXJuIGt9KSksbi5kKHQsImQiLChmdW5jdGlvbigpe3JldHVybiB3fSkpLG4uZCh0LCJlIiwoZnVuY3Rpb24oKXtyZXR1cm4gRX0pKSxuLmQodCwiYSIsKGZ1bmN0aW9uKCl7cmV0dXJuIE99KSksbi5kKHQsImIiLChmdW5jdGlvbigpe3JldHVybiBDfSkpLG4uZCh0LCJjIiwoZnVuY3Rpb24oKXtyZXR1cm4geH0pKTt2YXIgcj1uKDYpLG89bigyNSksYT1uKDQpLGk9bigxKSxzPW4oMyksbD1mdW5jdGlvbigpe2Zvcih2YXIgZT0wLHQ9MCxuPWFyZ3VtZW50cy5sZW5ndGg7dDxuO3QrKyllKz1hcmd1bWVudHNbdF0ubGVuZ3RoO3ZhciByPUFycmF5KGUpLG89MDtmb3IodD0wO3Q8bjt0KyspZm9yKHZhciBhPWFyZ3VtZW50c1t0XSxpPTAscz1hLmxlbmd0aDtpPHM7aSsrLG8rKylyW29dPWFbaV07cmV0dXJuIHJ9O2Z1bmN0aW9uIGMoZSl7dmFyIHQ9L15bJOKCrMKjwqXigqldPyhbMC05XSsoXC5bMC05XSspPykkLy5leGVjKGUpO3JldHVybiB0P3BhcnNlRmxvYXQodFsxXSk6bnVsbH1mdW5jdGlvbiB1KGUsdCl7cmV0dXJuIGUuc2xpY2UoMSkuZXZlcnkoKGZ1bmN0aW9uKGUpe3JldHVybiBudWxsIT09YyhlW3RdKX0pKX1mdW5jdGlvbiBkKGUpe3ZhciB0PWVbMF0ubGVuZ3RoO2lmKHQ+MilyZXR1cm57dHlwZToibWFsZm9ybWVkIHNwcmVhZHNoZWV0IixlcnJvcjpPYmplY3QoaS5lKSgiY2hhcnRzLnRvb01hbnlDb2x1bW5zIil9O2lmKDE9PT10KXtpZighdShlLDApKXJldHVybnt0eXBlOiJub3QgYSBzcHJlYWRzaGVldCJ9O3ZhciBuPW51bGw9PT1jKGVbMF1bMF0pLHI9KG4/ZS5zbGljZSgxKTplKS5tYXAoKGZ1bmN0aW9uKGUpe3JldHVybiBjKGVbMF0pfSkpO3JldHVybiByLmxlbmd0aDwyP3t0eXBlOiJub3QgYSBzcHJlYWRzaGVldCJ9Ont0eXBlOiJzcHJlYWRzaGVldCIsc3ByZWFkc2hlZXQ6e3lBeGlzTGFiZWw6bj9lWzBdWzBdOm51bGwsbGFiZWxzOm51bGwsdmFsdWVzOnJ9fX12YXIgbz11KGUsMCk/MDoxO2lmKCF1KGUsbykpcmV0dXJue3R5cGU6Im1hbGZvcm1lZCBzcHJlYWRzaGVldCIsZXJyb3I6T2JqZWN0KGkuZSkoImNoYXJ0cy5ub051bWVyaWNDb2x1bW4iKX07dmFyIGE9KG8rMSklMixzPW51bGw9PT1jKGVbMF1bb10pLGw9cz9lLnNsaWNlKDEpOmU7cmV0dXJuIGwubGVuZ3RoPDI/e3R5cGU6Im5vdCBhIHNwcmVhZHNoZWV0In06e3R5cGU6InNwcmVhZHNoZWV0IixzcHJlYWRzaGVldDp7eUF4aXNMYWJlbDpzP2VbMF1bb106bnVsbCxsYWJlbHM6bC5tYXAoKGZ1bmN0aW9uKGUpe3JldHVybiBlW2FdfSkpLHZhbHVlczpsLm1hcCgoZnVuY3Rpb24oZSl7cmV0dXJuIGMoZVtvXSl9KSl9fX1mdW5jdGlvbiBwKGUsdCxuLHIpe3ZhciBvLGk9TWF0aC5tYXguYXBwbHkoTWF0aCx0LnZhbHVlcyksYz1NYXRoLm1pbi5hcHBseShNYXRoLGwoWzBdLHQudmFsdWVzKSksdT1pLWMsZD1PYmplY3QoYS5EKSh7eDpuLHk6cisxOTIsc3Ryb2tlQ29sb3I6ZS5jdXJyZW50SXRlbVN0cm9rZUNvbG9yLGJhY2tncm91bmRDb2xvcjplLmN1cnJlbnRJdGVtQmFja2dyb3VuZENvbG9yLGZpbGxTdHlsZTplLmN1cnJlbnRJdGVtRmlsbFN0eWxlLHN0cm9rZVdpZHRoOmUuY3VycmVudEl0ZW1TdHJva2VXaWR0aCxzdHJva2VTdHlsZTplLmN1cnJlbnRJdGVtU3Ryb2tlU3R5bGUscm91Z2huZXNzOmUuY3VycmVudEl0ZW1Sb3VnaG5lc3Msb3BhY2l0eTplLmN1cnJlbnRJdGVtT3BhY2l0eSx0ZXh0OmMudG9Mb2NhbGVTdHJpbmcoKSxmb250U2l6ZToxNixmb250RmFtaWx5OmUuY3VycmVudEl0ZW1Gb250RmFtaWx5LHRleHRBbGlnbjplLmN1cnJlbnRJdGVtVGV4dEFsaWduLHZlcnRpY2FsQWxpZ246cy5ofSkscD1PYmplY3QoYS5EKSh7eDpuLHk6cixzdHJva2VDb2xvcjplLmN1cnJlbnRJdGVtU3Ryb2tlQ29sb3IsYmFja2dyb3VuZENvbG9yOmUuY3VycmVudEl0ZW1CYWNrZ3JvdW5kQ29sb3IsZmlsbFN0eWxlOmUuY3VycmVudEl0ZW1GaWxsU3R5bGUsc3Ryb2tlV2lkdGg6ZS5jdXJyZW50SXRlbVN0cm9rZVdpZHRoLHN0cm9rZVN0eWxlOmUuY3VycmVudEl0ZW1TdHJva2VTdHlsZSxyb3VnaG5lc3M6ZS5jdXJyZW50SXRlbVJvdWdobmVzcyxvcGFjaXR5OmUuY3VycmVudEl0ZW1PcGFjaXR5LHRleHQ6aS50b0xvY2FsZVN0cmluZygpLGZvbnRTaXplOjE2LGZvbnRGYW1pbHk6ZS5jdXJyZW50SXRlbUZvbnRGYW1pbHksdGV4dEFsaWduOmUuY3VycmVudEl0ZW1UZXh0QWxpZ24sdmVydGljYWxBbGlnbjpzLmh9KSxoPXQudmFsdWVzLm1hcCgoZnVuY3Rpb24odCxvKXt2YXIgaT0xOTIqKCh0LWMpL3UpLHM9NDQqbyszNixsPTE5Mi1pO3JldHVybiBPYmplY3QoYS5CKSh7dHlwZToicmVjdGFuZ2xlIix4OnMrbix5Omwrcix3aWR0aDozMixoZWlnaHQ6aSxzdHJva2VDb2xvcjplLmN1cnJlbnRJdGVtU3Ryb2tlQ29sb3IsYmFja2dyb3VuZENvbG9yOmUuY3VycmVudEl0ZW1CYWNrZ3JvdW5kQ29sb3IsZmlsbFN0eWxlOmUuY3VycmVudEl0ZW1GaWxsU3R5bGUsc3Ryb2tlV2lkdGg6ZS5jdXJyZW50SXRlbVN0cm9rZVdpZHRoLHN0cm9rZVN0eWxlOmUuY3VycmVudEl0ZW1TdHJva2VTdHlsZSxyb3VnaG5lc3M6ZS5jdXJyZW50SXRlbVJvdWdobmVzcyxvcGFjaXR5OmUuY3VycmVudEl0ZW1PcGFjaXR5fSl9KSksZj0obnVsbD09PShvPXQubGFiZWxzKXx8dm9pZCAwPT09bz92b2lkIDA6by5tYXAoKGZ1bmN0aW9uKHQsbyl7dmFyIGk9NDQqbyszNisxMjtyZXR1cm4gT2JqZWN0KGEuRCkoe3RleHQ6dC5sZW5ndGg+OD8iIi5jb25jYXQodC5zbGljZSgwLDUpLCIuLi4iKTp0LHg6bitpLHk6cisyMDQsc3Ryb2tlQ29sb3I6ZS5jdXJyZW50SXRlbVN0cm9rZUNvbG9yLGJhY2tncm91bmRDb2xvcjplLmN1cnJlbnRJdGVtQmFja2dyb3VuZENvbG9yLGZpbGxTdHlsZTplLmN1cnJlbnRJdGVtRmlsbFN0eWxlLHN0cm9rZVdpZHRoOmUuY3VycmVudEl0ZW1TdHJva2VXaWR0aCxzdHJva2VTdHlsZTplLmN1cnJlbnRJdGVtU3Ryb2tlU3R5bGUscm91Z2huZXNzOmUuY3VycmVudEl0ZW1Sb3VnaG5lc3Msb3BhY2l0eTplLmN1cnJlbnRJdGVtT3BhY2l0eSxmb250U2l6ZToxNixmb250RmFtaWx5OmUuY3VycmVudEl0ZW1Gb250RmFtaWx5LHRleHRBbGlnbjoiY2VudGVyIix2ZXJ0aWNhbEFsaWduOnMuaCx3aWR0aDozMixhbmdsZTo1Ljg3fSl9KSkpfHxbXSxtPXQueUF4aXNMYWJlbD9PYmplY3QoYS5EKSh7dGV4dDp0LnlBeGlzTGFiZWwseDpuLTM2LHk6cis5Ni0xMCxzdHJva2VDb2xvcjplLmN1cnJlbnRJdGVtU3Ryb2tlQ29sb3IsYmFja2dyb3VuZENvbG9yOmUuY3VycmVudEl0ZW1CYWNrZ3JvdW5kQ29sb3IsZmlsbFN0eWxlOmUuY3VycmVudEl0ZW1GaWxsU3R5bGUsc3Ryb2tlV2lkdGg6ZS5jdXJyZW50SXRlbVN0cm9rZVdpZHRoLHN0cm9rZVN0eWxlOmUuY3VycmVudEl0ZW1TdHJva2VTdHlsZSxyb3VnaG5lc3M6ZS5jdXJyZW50SXRlbVJvdWdobmVzcyxvcGFjaXR5OmUuY3VycmVudEl0ZW1PcGFjaXR5LGZvbnRTaXplOjIwLGZvbnRGYW1pbHk6ZS5jdXJyZW50SXRlbUZvbnRGYW1pbHksdGV4dEFsaWduOiJjZW50ZXIiLHZlcnRpY2FsQWxpZ246cy5oLHdpZHRoOjMyLGFuZ2xlOjUuODd9KTpudWxsO3JldHVybiBsKGgsW20sZCxwXSxmKS5maWx0ZXIoKGZ1bmN0aW9uKGUpe3JldHVybiBudWxsIT09ZX0pKX12YXIgaD1mdW5jdGlvbihlLHQpe3ZhciBuLHIsbyxhLGk9e2xhYmVsOjAsc2VudDpmdW5jdGlvbigpe2lmKDEmb1swXSl0aHJvdyBvWzFdO3JldHVybiBvWzFdfSx0cnlzOltdLG9wczpbXX07cmV0dXJuIGE9e25leHQ6cygwKSx0aHJvdzpzKDEpLHJldHVybjpzKDIpfSwiZnVuY3Rpb24iPT10eXBlb2YgU3ltYm9sJiYoYVtTeW1ib2wuaXRlcmF0b3JdPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9KSxhO2Z1bmN0aW9uIHMoYSl7cmV0dXJuIGZ1bmN0aW9uKHMpe3JldHVybiBmdW5jdGlvbihhKXtpZihuKXRocm93IG5ldyBUeXBlRXJyb3IoIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy4iKTtmb3IoO2k7KXRyeXtpZihuPTEsciYmKG89MiZhWzBdP3IucmV0dXJuOmFbMF0/ci50aHJvd3x8KChvPXIucmV0dXJuKSYmby5jYWxsKHIpLDApOnIubmV4dCkmJiEobz1vLmNhbGwocixhWzFdKSkuZG9uZSlyZXR1cm4gbztzd2l0Y2gocj0wLG8mJihhPVsyJmFbMF0sby52YWx1ZV0pLGFbMF0pe2Nhc2UgMDpjYXNlIDE6bz1hO2JyZWFrO2Nhc2UgNDpyZXR1cm4gaS5sYWJlbCsrLHt2YWx1ZTphWzFdLGRvbmU6ITF9O2Nhc2UgNTppLmxhYmVsKysscj1hWzFdLGE9WzBdO2NvbnRpbnVlO2Nhc2UgNzphPWkub3BzLnBvcCgpLGkudHJ5cy5wb3AoKTtjb250aW51ZTtkZWZhdWx0OmlmKCEobz1pLnRyeXMsKG89by5sZW5ndGg+MCYmb1tvLmxlbmd0aC0xXSl8fDYhPT1hWzBdJiYyIT09YVswXSkpe2k9MDtjb250aW51ZX1pZigzPT09YVswXSYmKCFvfHxhWzFdPm9bMF0mJmFbMV08b1szXSkpe2kubGFiZWw9YVsxXTticmVha31pZig2PT09YVswXSYmaS5sYWJlbDxvWzFdKXtpLmxhYmVsPW9bMV0sbz1hO2JyZWFrfWlmKG8mJmkubGFiZWw8b1syXSl7aS5sYWJlbD1vWzJdLGkub3BzLnB1c2goYSk7YnJlYWt9b1syXSYmaS5vcHMucG9wKCksaS50cnlzLnBvcCgpO2NvbnRpbnVlfWE9dC5jYWxsKGUsaSl9Y2F0Y2goZSl7YT1bNixlXSxyPTB9ZmluYWxseXtuPW89MH1pZig1JmFbMF0pdGhyb3cgYVsxXTtyZXR1cm57dmFsdWU6YVswXT9hWzFdOnZvaWQgMCxkb25lOiEwfX0oW2Esc10pfX19O2Z1bmN0aW9uIGYoZSx0LG4scixvLGEsaSl7dHJ5e3ZhciBzPWVbYV0oaSksbD1zLnZhbHVlfWNhdGNoKGUpe3JldHVybiB2b2lkIG4oZSl9cy5kb25lP3QobCk6UHJvbWlzZS5yZXNvbHZlKGwpLnRoZW4ocixvKX1mdW5jdGlvbiBtKGUpe3JldHVybiBmdW5jdGlvbigpe3ZhciB0PXRoaXMsbj1hcmd1bWVudHM7cmV0dXJuIG5ldyBQcm9taXNlKChmdW5jdGlvbihyLG8pe3ZhciBhPWUuYXBwbHkodCxuKTtmdW5jdGlvbiBpKGUpe2YoYSxyLG8saSxzLCJuZXh0IixlKX1mdW5jdGlvbiBzKGUpe2YoYSxyLG8saSxzLCJ0aHJvdyIsZSl9aSh2b2lkIDApfSkpfX12YXIgZz0iIixiPSExLHk9ImNsaXBib2FyZCJpbiBuYXZpZ2F0b3ImJiJyZWFkVGV4dCJpbiBuYXZpZ2F0b3IuY2xpcGJvYXJkLHY9ImNsaXBib2FyZCJpbiBuYXZpZ2F0b3ImJiJ3cml0ZVRleHQiaW4gbmF2aWdhdG9yLmNsaXBib2FyZCxrPSJjbGlwYm9hcmQiaW4gbmF2aWdhdG9yJiYid3JpdGUiaW4gbmF2aWdhdG9yLmNsaXBib2FyZCYmIkNsaXBib2FyZEl0ZW0iaW4gd2luZG93JiYidG9CbG9iImluIEhUTUxDYW52YXNFbGVtZW50LnByb3RvdHlwZSx3PWZ1bmN0aW9uKCl7dmFyIGU9bSgoZnVuY3Rpb24oZSx0KXtyZXR1cm4gaCh0aGlzLChmdW5jdGlvbihuKXtzd2l0Y2gobi5sYWJlbCl7Y2FzZSAwOmc9SlNPTi5zdHJpbmdpZnkoT2JqZWN0KHIuZykoZSx0KSksbi5sYWJlbD0xO2Nhc2UgMTpyZXR1cm4gbi50cnlzLnB1c2goWzEsMywsNF0pLFs0LHgobnVsbCldO2Nhc2UgMjpyZXR1cm4gbi5zZW50KCksYj0hMSxbMyw0XTtjYXNlIDM6cmV0dXJuIG4uc2VudCgpLGI9ITAsWzMsNF07Y2FzZSA0OnJldHVyblsyXX19KSl9KSk7cmV0dXJuIGZ1bmN0aW9uKHQsbil7cmV0dXJuIGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfX0oKSxTPWZ1bmN0aW9uKCl7aWYoIWcpcmV0dXJue307dHJ5e3ZhciBlPUpTT04ucGFyc2UoZyk7aWYoQXJyYXkuaXNBcnJheShlKSYmZS5sZW5ndGg+MCYmZVswXS50eXBlKXJldHVybntlbGVtZW50czplfX1jYXRjaChlKXtjb25zb2xlLmVycm9yKGUpfXJldHVybnt9fSxFPWZ1bmN0aW9uKCl7dmFyIGU9bSgoZnVuY3Rpb24oZSx0LG4scil7dmFyIGEsaSxzLGwsYyx1O3JldHVybiBoKHRoaXMsKGZ1bmN0aW9uKGgpe3N3aXRjaChoLmxhYmVsKXtjYXNlIDA6cmV0dXJuIGgudHJ5cy5wdXNoKFswLDUsLDZdKSxyPyhzPW51bGw9PT0oYT1yLmNsaXBib2FyZERhdGEpfHx2b2lkIDA9PT1hP3ZvaWQgMDphLmdldERhdGEoInRleHQvcGxhaW4iKS50cmltKCksWzMsNF0pOlszLDFdO2Nhc2UgMTpyZXR1cm4obD15KT9bNCxuYXZpZ2F0b3IuY2xpcGJvYXJkLnJlYWRUZXh0KCldOlszLDNdO2Nhc2UgMjpsPWguc2VudCgpLGgubGFiZWw9MztjYXNlIDM6cz1sLGgubGFiZWw9NDtjYXNlIDQ6cmV0dXJuIShpPXMpfHxifHxpLmluY2x1ZGVzKG8uYSk/WzMsNl06InNwcmVhZHNoZWV0Ij09PShjPWZ1bmN0aW9uKGUpe3ZhciB0PWUudHJpbSgpLnNwbGl0KCJcbiIpLm1hcCgoZnVuY3Rpb24oZSl7cmV0dXJuIGUudHJpbSgpLnNwbGl0KCJcdCIpfSkpO2lmKDA9PT10Lmxlbmd0aClyZXR1cm57dHlwZToibm90IGEgc3ByZWFkc2hlZXQifTt2YXIgbj10WzBdLmxlbmd0aDtpZighdC5ldmVyeSgoZnVuY3Rpb24oZSl7cmV0dXJuIGUubGVuZ3RoPT09bn0pKSlyZXR1cm57dHlwZToibm90IGEgc3ByZWFkc2hlZXQifTt2YXIgcj1kKHQpO2lmKCJzcHJlYWRzaGVldCIhPT1yLnR5cGUpe3ZhciBvPWQoZnVuY3Rpb24oZSl7Zm9yKHZhciB0PVtdLG49MDtuPGVbMF0ubGVuZ3RoO24rKyl7Zm9yKHZhciByPVtdLG89MDtvPGUubGVuZ3RoO28rKylyLnB1c2goZVtvXVtuXSk7dC5wdXNoKHIpfXJldHVybiB0fSh0KSk7aWYoInNwcmVhZHNoZWV0Ij09PW8udHlwZSlyZXR1cm4gb31yZXR1cm4gcn0oaSkpLnR5cGU/WzIse2VsZW1lbnRzOnAoZSxjLnNwcmVhZHNoZWV0LHQsbil9XToibWFsZm9ybWVkIHNwcmVhZHNoZWV0Ij09PWMudHlwZT9bMix7ZXJyb3I6Yy5lcnJvcn1dOlsyLHt0ZXh0Oml9XTtjYXNlIDU6cmV0dXJuIHU9aC5zZW50KCksY29uc29sZS5lcnJvcih1KSxbMyw2XTtjYXNlIDY6cmV0dXJuWzIsUygpXX19KSl9KSk7cmV0dXJuIGZ1bmN0aW9uKHQsbixyLG8pe3JldHVybiBlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX19KCksTz1mdW5jdGlvbigpe3ZhciBlPW0oKGZ1bmN0aW9uKGUpe3JldHVybiBoKHRoaXMsKGZ1bmN0aW9uKHQpe3JldHVyblsyLG5ldyBQcm9taXNlKChmdW5jdGlvbih0LG4pe3RyeXtlLnRvQmxvYihmdW5jdGlvbigpe3ZhciBlPW0oKGZ1bmN0aW9uKGUpe3ZhciByO3JldHVybiBoKHRoaXMsKGZ1bmN0aW9uKG8pe3N3aXRjaChvLmxhYmVsKXtjYXNlIDA6cmV0dXJuIG8udHJ5cy5wdXNoKFswLDIsLDNdKSxbNCxuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlKFtuZXcgd2luZG93LkNsaXBib2FyZEl0ZW0oeyJpbWFnZS9wbmciOmV9KV0pXTtjYXNlIDE6cmV0dXJuIG8uc2VudCgpLHQoKSxbMywzXTtjYXNlIDI6cmV0dXJuIHI9by5zZW50KCksbihyKSxbMywzXTtjYXNlIDM6cmV0dXJuWzJdfX0pKX0pKTtyZXR1cm4gZnVuY3Rpb24odCl7cmV0dXJuIGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfX0oKSl9Y2F0Y2goZSl7bihlKX19KSldfSkpfSkpO3JldHVybiBmdW5jdGlvbih0KXtyZXR1cm4gZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fSgpLEM9ZnVuY3Rpb24oKXt2YXIgZT1tKChmdW5jdGlvbihlKXt2YXIgdDtyZXR1cm4gaCh0aGlzLChmdW5jdGlvbihuKXtzd2l0Y2gobi5sYWJlbCl7Y2FzZSAwOnJldHVybiBuLnRyeXMucHVzaChbMCwyLCwzXSksWzQsbmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQoZS5vdXRlckhUTUwpXTtjYXNlIDE6cmV0dXJuIG4uc2VudCgpLFszLDNdO2Nhc2UgMjpyZXR1cm4gdD1uLnNlbnQoKSxjb25zb2xlLmVycm9yKHQpLFszLDNdO2Nhc2UgMzpyZXR1cm5bMl19fSkpfSkpO3JldHVybiBmdW5jdGlvbih0KXtyZXR1cm4gZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fSgpLHg9ZnVuY3Rpb24oKXt2YXIgZT1tKChmdW5jdGlvbihlKXt2YXIgdCxuO3JldHVybiBoKHRoaXMsKGZ1bmN0aW9uKHIpe3N3aXRjaChyLmxhYmVsKXtjYXNlIDA6aWYodD0hMSwhdilyZXR1cm5bMyw0XTtyLmxhYmVsPTE7Y2FzZSAxOnJldHVybiByLnRyeXMucHVzaChbMSwzLCw0XSksWzQsbmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQoZXx8IiIpXTtjYXNlIDI6cmV0dXJuIHIuc2VudCgpLHQ9ITAsWzMsNF07Y2FzZSAzOnJldHVybiBuPXIuc2VudCgpLGNvbnNvbGUuZXJyb3IobiksWzMsNF07Y2FzZSA0OmlmKCF0JiYhaihlfHwiICIpKXRocm93IG5ldyBFcnJvcigiY291bGRuJ3QgY29weSIpO3JldHVyblsyXX19KSl9KSk7cmV0dXJuIGZ1bmN0aW9uKHQpe3JldHVybiBlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX19KCksaj1mdW5jdGlvbihlKXt2YXIgdD0icnRsIj09PWRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoImRpciIpLG49ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidGV4dGFyZWEiKTtuLnN0eWxlLmJvcmRlcj0iMCIsbi5zdHlsZS5wYWRkaW5nPSIwIixuLnN0eWxlLm1hcmdpbj0iMCIsbi5zdHlsZS5wb3NpdGlvbj0iYWJzb2x1dGUiLG4uc3R5bGVbdD8icmlnaHQiOiJsZWZ0Il09Ii05OTk5cHgiO3ZhciByPXdpbmRvdy5wYWdlWU9mZnNldHx8ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcDtuLnN0eWxlLnRvcD0iIi5jb25jYXQociwicHgiKSxuLnN0eWxlLmZvbnRTaXplPSIxMnB0IixuLnNldEF0dHJpYnV0ZSgicmVhZG9ubHkiLCIiKSxuLnZhbHVlPWUsZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChuKTt2YXIgbz0hMTt0cnl7bi5zZWxlY3QoKSxuLnNldFNlbGVjdGlvblJhbmdlKDAsbi52YWx1ZS5sZW5ndGgpLG89ZG9jdW1lbnQuZXhlY0NvbW1hbmQoImNvcHkiKX1jYXRjaChlKXtjb25zb2xlLmVycm9yKGUpfXJldHVybiBuLnJlbW92ZSgpLG99fSxmdW5jdGlvbihlLHQsbil7InVzZSBzdHJpY3QiO24uZCh0LCJiIiwoZnVuY3Rpb24oKXtyZXR1cm4gaX0pKSxuLmQodCwiYyIsKGZ1bmN0aW9uKCl7cmV0dXJuIHN9KSksbi5kKHQsImEiLChmdW5jdGlvbigpe3JldHVybiBsfSkpLG4uZCh0LCJkIiwoZnVuY3Rpb24oKXtyZXR1cm4gY30pKSxuLmQodCwiZSIsKGZ1bmN0aW9uKCl7cmV0dXJuIHV9KSk7dmFyIHI9big0KSxvPW4oMiksYT1uKDEpLGk9NCxzPTYsbD0icmdiYSgwLDAsMCwwLjMpIixjPWZ1bmN0aW9uKGUsdCxuLGwpe3ZhciBjPWwuc2Nyb2xsWCx1PWwuc2Nyb2xsWSxkPWwuem9vbSxwPU9iamVjdChyLmYpKGUpLGg9cFswXSxmPXBbMV0sbT1wWzJdLGc9cFszXSxiPXQvZCx5PW4vZCx2PXQtYixrPW4teSx3PXt0b3A6cGFyc2VJbnQoT2JqZWN0KG8uaikoInNhdCIpKSxib3R0b206cGFyc2VJbnQoT2JqZWN0KG8uaikoInNhYiIpKSxsZWZ0OnBhcnNlSW50KE9iamVjdChvLmopKCJzYWwiKSkscmlnaHQ6cGFyc2VJbnQoT2JqZWN0KG8uaikoInNhciIpKX0sUz1PYmplY3QoYS5hKSgpLnJ0bCxFPXYvMi1jK3cubGVmdCxPPWsvMi11K3cudG9wLEM9RStiLXcucmlnaHQseD1PK3ktdy5ib3R0b20saj1NYXRoLm1pbihoLEUpLFQ9TWF0aC5taW4oZixPKSxQPU1hdGgubWF4KG0sQyksQT1NYXRoLm1heChnLHgpO3JldHVybntob3Jpem9udGFsOkU9PT1qJiZDPT09UD9udWxsOnt4Ok1hdGgubWF4KHcubGVmdCxpKSsoRS1qKS8oUC1qKSp0LHk6bi1zLU1hdGgubWF4KGksdy5ib3R0b20pLHdpZHRoOihDLUUpLyhQLWopKnQtTWF0aC5tYXgoMippLHcubGVmdCt3LnJpZ2h0KSxoZWlnaHQ6c30sdmVydGljYWw6Tz09PVQmJng9PT1BP251bGw6e3g6Uz9NYXRoLm1heCh3LmxlZnQsaSk6dC1zLU1hdGgubWF4KHcucmlnaHQsaSkseTooTy1UKS8oQS1UKSpuK01hdGgubWF4KHcudG9wLGkpLHdpZHRoOnMsaGVpZ2h0Oih4LU8pLyhBLVQpKm4tTWF0aC5tYXgoMippLHcudG9wK3cuYm90dG9tKX19fSx1PWZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1bZS5ob3Jpem9udGFsLGUudmVydGljYWxdLm1hcCgoZnVuY3Rpb24oZSl7cmV0dXJuIG51bGwhPWUmJmUueDw9dCYmdDw9ZS54K2Uud2lkdGgmJmUueTw9biYmbjw9ZS55K2UuaGVpZ2h0fSkpLG89clswXSxhPXJbMV07cmV0dXJue2lzT3ZlckVpdGhlcjpvfHxhLGlzT3Zlckhvcml6b250YWw6byxpc092ZXJWZXJ0aWNhbDphfX19LGZ1bmN0aW9uKGUsdCxuKXsidXNlIHN0cmljdCI7bi5kKHQsImIiLChmdW5jdGlvbigpe3JldHVybiBzfSkpLG4uZCh0LCJhIiwoZnVuY3Rpb24oKXtyZXR1cm4gbH0pKTt2YXIgcj1uKDMzKSxvPW4oNjcpLGE9bi5uKG8pLGk9bmV3IHIuYShEYXRlLm5vdygpKSxzPWZ1bmN0aW9uKCl7cmV0dXJuIE1hdGguZmxvb3IoaS5uZXh0KCkqTWF0aC5wb3coMiwzMSkpfSxsPWZ1bmN0aW9uKCl7cmV0dXJuIGEoKSgpfX0sZnVuY3Rpb24oZSx0LG4peyJ1c2Ugc3RyaWN0IjtuLmQodCwiYyIsKGZ1bmN0aW9uKCl7cmV0dXJuIG19KSksbi5kKHQsImUiLChmdW5jdGlvbigpe3JldHVybiBifSkpLG4uZCh0LCJmIiwoZnVuY3Rpb24oKXtyZXR1cm4geX0pKSxuLmQodCwiZCIsKGZ1bmN0aW9uKCl7cmV0dXJuIHZ9KSksbi5kKHQsImEiLChmdW5jdGlvbigpe3JldHVybiBrfSkpLG4uZCh0LCJiIiwoZnVuY3Rpb24oKXtyZXR1cm4gd30pKTt2YXIgcj1uKDIpLG89bigyMCksYT1uKDgpLGk9bigxMikscz1uKDQpLGw9big5KSxjPW4oMTApO2Z1bmN0aW9uIHUoZSx0KXt2YXIgbj1PYmplY3Qua2V5cyhlKTtpZihPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgcj1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO3QmJihyPXIuZmlsdGVyKChmdW5jdGlvbih0KXtyZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihlLHQpLmVudW1lcmFibGV9KSkpLG4ucHVzaC5hcHBseShuLHIpfXJldHVybiBufWZ1bmN0aW9uIGQoZSl7Zm9yKHZhciB0PTE7dDxhcmd1bWVudHMubGVuZ3RoO3QrKyl7dmFyIG49bnVsbCE9YXJndW1lbnRzW3RdP2FyZ3VtZW50c1t0XTp7fTt0JTI/dShPYmplY3QobiksITApLmZvckVhY2goKGZ1bmN0aW9uKHQpe3AoZSx0LG5bdF0pfSkpOk9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzP09iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGUsT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMobikpOnUoT2JqZWN0KG4pKS5mb3JFYWNoKChmdW5jdGlvbih0KXtPYmplY3QuZGVmaW5lUHJvcGVydHkoZSx0LE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iobix0KSl9KSl9cmV0dXJuIGV9ZnVuY3Rpb24gcChlLHQsbil7cmV0dXJuIHQgaW4gZT9PYmplY3QuZGVmaW5lUHJvcGVydHkoZSx0LHt2YWx1ZTpuLGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwLHdyaXRhYmxlOiEwfSk6ZVt0XT1uLGV9ZnVuY3Rpb24gaChlLHQpe2lmKG51bGw9PWUpcmV0dXJue307dmFyIG4scixvPWZ1bmN0aW9uKGUsdCl7aWYobnVsbD09ZSlyZXR1cm57fTt2YXIgbixyLG89e30sYT1PYmplY3Qua2V5cyhlKTtmb3Iocj0wO3I8YS5sZW5ndGg7cisrKW49YVtyXSx0LmluZGV4T2Yobik+PTB8fChvW25dPWVbbl0pO3JldHVybiBvfShlLHQpO2lmKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpe3ZhciBhPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7Zm9yKHI9MDtyPGEubGVuZ3RoO3IrKyluPWFbcl0sdC5pbmRleE9mKG4pPj0wfHxPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoZSxuKSYmKG9bbl09ZVtuXSl9cmV0dXJuIG99dmFyIGY9ZnVuY3Rpb24oZSx0KXt2YXIgbixyLGE9dC54LGk9dC55LHM9dC5zdHJva2VDb2xvcixsPXQuYmFja2dyb3VuZENvbG9yLGM9dC5maWxsU3R5bGUsdT10LnN0cm9rZVdpZHRoLGQ9dC5zdHJva2VTdHlsZSxwPXQucm91Z2huZXNzLGY9dC5vcGFjaXR5LG09dC53aWR0aCxnPXZvaWQgMD09PW0/MDptLGI9dC5oZWlnaHQseT12b2lkIDA9PT1iPzA6Yix2PXQuYW5nbGUsaz12b2lkIDA9PT12PzA6dix3PXQuZ3JvdXBJZHMsUz12b2lkIDA9PT13P1tdOncsRT1oKHQsWyJ4IiwieSIsInN0cm9rZUNvbG9yIiwiYmFja2dyb3VuZENvbG9yIiwiZmlsbFN0eWxlIiwic3Ryb2tlV2lkdGgiLCJzdHJva2VTdHlsZSIsInJvdWdobmVzcyIsIm9wYWNpdHkiLCJ3aWR0aCIsImhlaWdodCIsImFuZ2xlIiwiZ3JvdXBJZHMiXSk7cmV0dXJue2lkOkUuaWR8fE9iamVjdChvLmEpKCksdHlwZTplLHg6YSx5Omksd2lkdGg6ZyxoZWlnaHQ6eSxhbmdsZTprLHN0cm9rZUNvbG9yOnMsYmFja2dyb3VuZENvbG9yOmwsZmlsbFN0eWxlOmMsc3Ryb2tlV2lkdGg6dSxzdHJva2VTdHlsZTpkLHJvdWdobmVzczpwLG9wYWNpdHk6Zixncm91cElkczpTLHNlZWQ6bnVsbCE9PShuPUUuc2VlZCkmJnZvaWQgMCE9PW4/bjpPYmplY3Qoby5iKSgpLHZlcnNpb246RS52ZXJzaW9ufHwxLHZlcnNpb25Ob25jZTpudWxsIT09KHI9RS52ZXJzaW9uTm9uY2UpJiZ2b2lkIDAhPT1yP3I6MCxpc0RlbGV0ZWQ6ITF9fSxtPWZ1bmN0aW9uKGUpe3JldHVybiBmKGUudHlwZSxlKX07ZnVuY3Rpb24gZyhlLHQpe3JldHVybnt4OiJjZW50ZXIiPT09ZS50ZXh0QWxpZ24/dC53aWR0aC8yOiJyaWdodCI9PT1lLnRleHRBbGlnbj90LndpZHRoOjAseToibWlkZGxlIj09PWUudmVydGljYWxBbGlnbj90LmhlaWdodC8yOjB9fXZhciBiPWZ1bmN0aW9uKGUpe3ZhciB0PU9iamVjdChyLnEpKGUudGV4dCxPYmplY3Qoci5pKShlKSksbj1nKGUsdCk7cmV0dXJuIE9iamVjdChhLmIpKGQoZCh7fSxmKCJ0ZXh0IixlKSkse30se3RleHQ6ZS50ZXh0LGZvbnRTaXplOmUuZm9udFNpemUsZm9udEZhbWlseTplLmZvbnRGYW1pbHksdGV4dEFsaWduOmUudGV4dEFsaWduLHZlcnRpY2FsQWxpZ246ZS52ZXJ0aWNhbEFsaWduLHg6ZS54LW4ueCx5OmUueS1uLnksd2lkdGg6dC53aWR0aCxoZWlnaHQ6dC5oZWlnaHQsYmFzZWxpbmU6dC5iYXNlbGluZX0pLHt9KX0seT1mdW5jdGlvbihlLHQpe3ZhciBuPXQudGV4dCxvPXQuaXNEZWxldGVkO3JldHVybiBPYmplY3QoYS5iKShlLGQoe3RleHQ6bixpc0RlbGV0ZWQ6bnVsbCE9bz9vOmUuaXNEZWxldGVkfSxmdW5jdGlvbihlLHQpe3ZhciBuLG8sYSxpPU9iamVjdChyLnEpKHQsT2JqZWN0KHIuaSkoZSkpLHU9aS53aWR0aCxkPWkuaGVpZ2h0LHA9aS5iYXNlbGluZSxoPWUudGV4dEFsaWduLGY9ZS52ZXJ0aWNhbEFsaWduO2lmKCJjZW50ZXIiPT09aCYmIm1pZGRsZSI9PT1mKXt2YXIgbT1PYmplY3Qoci5xKShlLnRleHQsT2JqZWN0KHIuaSkoZSkpLGI9ZyhlLHt3aWR0aDp1LW0ud2lkdGgsaGVpZ2h0OmQtbS5oZWlnaHR9KTtvPWUueC1iLngsYT1lLnktYi55fWVsc2V7dmFyIHk9T2JqZWN0KHMuaikoZSksdj15WzBdLGs9eVsxXSx3PXlbMl0sUz15WzNdLEU9T2JqZWN0KGMuaSkoZSx1LGQpLE89KHYtRVswXSkvMixDPShrLUVbMV0pLzIseD0ody1FWzJdKS8yLGo9KFMtRVszXSkvMjtvPShuPU9iamVjdChsLmEpKHtzOiEwLGU6ImNlbnRlciI9PT1ofHwibGVmdCI9PT1oLHc6ImNlbnRlciI9PT1ofHwicmlnaHQiPT09aH0sZS54LGUueSxlLmFuZ2xlLE8sQyx4LGopKVswXSxhPW5bMV19cmV0dXJue3dpZHRoOnUsaGVpZ2h0OmQseDpOdW1iZXIuaXNGaW5pdGUobyk/bzplLngseTpOdW1iZXIuaXNGaW5pdGUoYSk/YTplLnksYmFzZWxpbmU6cH19KGUsbikpKX0sdj1mdW5jdGlvbihlKXtyZXR1cm4gZChkKHt9LGYoZS50eXBlLGUpKSx7fSx7cG9pbnRzOltdLGxhc3RDb21taXR0ZWRQb2ludDpudWxsfSl9LGs9ZnVuY3Rpb24oZSx0KXtpZih2b2lkIDA9PT10JiYodD0wKSxudWxsPT1lfHwib2JqZWN0IiE9dHlwZW9mIGUpcmV0dXJuIGU7aWYoIltvYmplY3QgT2JqZWN0XSI9PT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoZSkpe3ZhciBuPSJmdW5jdGlvbiI9PXR5cGVvZiBlLmNvbnN0cnVjdG9yP09iamVjdC5jcmVhdGUoT2JqZWN0LmdldFByb3RvdHlwZU9mKGUpKTp7fTtmb3IodmFyIHIgaW4gZSlpZihlLmhhc093blByb3BlcnR5KHIpKXtpZigwPT09dCYmKCJzaGFwZSI9PT1yfHwiY2FudmFzIj09PXIpKWNvbnRpbnVlO25bcl09ayhlW3JdLHQrMSl9cmV0dXJuIG59aWYoQXJyYXkuaXNBcnJheShlKSl7Zm9yKHZhciBvPWUubGVuZ3RoLGE9bmV3IEFycmF5KG8pO28tLTspYVtvXT1rKGVbb10sdCsxKTtyZXR1cm4gYX1yZXR1cm4gZX0sdz1mdW5jdGlvbihlLHQsbixyKXt2YXIgYT1rKG4pO3JldHVybiBhLmlkPU9iamVjdChvLmEpKCksYS5zZWVkPU9iamVjdChvLmIpKCksYS5ncm91cElkcz1PYmplY3QoaS5jKShhLmdyb3VwSWRzLGUsKGZ1bmN0aW9uKGUpe3JldHVybiB0LmhhcyhlKXx8dC5zZXQoZSxPYmplY3Qoby5hKSgpKSx0LmdldChlKX0pKSxyJiYoYT1PYmplY3QuYXNzaWduKGEscikpLGF9fSxmdW5jdGlvbihlLHQsbil7InVzZSBzdHJpY3QiO3ZhciByPW4oNCksbz1mdW5jdGlvbihlKXtyZXR1cm4ic3RyaW5nIj09dHlwZW9mIGV9LGE9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7dGhpcy5jYWxsYmFja3M9bmV3IFNldCx0aGlzLm5vbkRlbGV0ZWRFbGVtZW50cz1bXSx0aGlzLmVsZW1lbnRzPVtdLHRoaXMuZWxlbWVudHNNYXA9bmV3IE1hcH1yZXR1cm4gZS5tYXBFbGVtZW50VG9TY2VuZT1mdW5jdGlvbihlLHQpe28oZSk/dGhpcy5zY2VuZU1hcEJ5SWQuc2V0KGUsdCk6dGhpcy5zY2VuZU1hcEJ5RWxlbWVudC5zZXQoZSx0KX0sZS5nZXRTY2VuZT1mdW5jdGlvbihlKXtyZXR1cm4gbyhlKT90aGlzLnNjZW5lTWFwQnlJZC5nZXQoZSl8fG51bGw6dGhpcy5zY2VuZU1hcEJ5RWxlbWVudC5nZXQoZSl8fG51bGx9LGUucHJvdG90eXBlLmdldEVsZW1lbnRzSW5jbHVkaW5nRGVsZXRlZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVsZW1lbnRzfSxlLnByb3RvdHlwZS5nZXRFbGVtZW50cz1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5vbkRlbGV0ZWRFbGVtZW50c30sZS5wcm90b3R5cGUuZ2V0RWxlbWVudD1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5lbGVtZW50c01hcC5nZXQoZSl8fG51bGx9LGUucHJvdG90eXBlLmdldE5vbkRlbGV0ZWRFbGVtZW50PWZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuZ2V0RWxlbWVudChlKTtyZXR1cm4gdCYmT2JqZWN0KHIueikodCk/dDpudWxsfSxlLnByb3RvdHlwZS5yZXBsYWNlQWxsRWxlbWVudHM9ZnVuY3Rpb24odCl7dmFyIG49dGhpczt0aGlzLmVsZW1lbnRzPXQsdGhpcy5lbGVtZW50c01hcC5jbGVhcigpLHQuZm9yRWFjaCgoZnVuY3Rpb24odCl7bi5lbGVtZW50c01hcC5zZXQodC5pZCx0KSxlLm1hcEVsZW1lbnRUb1NjZW5lKHQsbil9KSksdGhpcy5ub25EZWxldGVkRWxlbWVudHM9T2JqZWN0KHIubikodGhpcy5lbGVtZW50cyksdGhpcy5pbmZvcm1NdXRhdGlvbigpfSxlLnByb3RvdHlwZS5pbmZvcm1NdXRhdGlvbj1mdW5jdGlvbigpe2Zvcih2YXIgZT0wLHQ9QXJyYXkuZnJvbSh0aGlzLmNhbGxiYWNrcyk7ZTx0Lmxlbmd0aDtlKyspeygwLHRbZV0pKCl9fSxlLnByb3RvdHlwZS5hZGRDYWxsYmFjaz1mdW5jdGlvbihlKXt2YXIgdD10aGlzO2lmKHRoaXMuY2FsbGJhY2tzLmhhcyhlKSl0aHJvdyBuZXcgRXJyb3I7cmV0dXJuIHRoaXMuY2FsbGJhY2tzLmFkZChlKSxmdW5jdGlvbigpe2lmKCF0LmNhbGxiYWNrcy5oYXMoZSkpdGhyb3cgbmV3IEVycm9yO3QuY2FsbGJhY2tzLmRlbGV0ZShlKX19LGUucHJvdG90eXBlLmRlc3Ryb3k9ZnVuY3Rpb24oKXt2YXIgdD10aGlzO2Uuc2NlbmVNYXBCeUlkLmZvckVhY2goKGZ1bmN0aW9uKG4scil7bj09PXQmJmUuc2NlbmVNYXBCeUlkLmRlbGV0ZShyKX0pKSx0aGlzLmNhbGxiYWNrcy5jbGVhcigpfSxlfSgpO2Euc2NlbmVNYXBCeUVsZW1lbnQ9bmV3IFdlYWtNYXAsYS5zY2VuZU1hcEJ5SWQ9bmV3IE1hcCx0LmE9YX0sZnVuY3Rpb24oZSx0LG4peyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiByKGUsdCxuKXtpZihlJiZlLmxlbmd0aCl7dmFyIHI9dFswXSxvPXRbMV0sYT1NYXRoLlBJLzE4MCpuLGk9TWF0aC5jb3MoYSkscz1NYXRoLnNpbihhKTtlLmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciB0PWVbMF0sbj1lWzFdO2VbMF09KHQtcikqaS0obi1vKSpzK3IsZVsxXT0odC1yKSpzKyhuLW8pKmkrb30pKX19ZnVuY3Rpb24gbyhlKXt2YXIgdD1lWzBdLG49ZVsxXTtyZXR1cm4gTWF0aC5zcXJ0KE1hdGgucG93KHRbMF0tblswXSwyKStNYXRoLnBvdyh0WzFdLW5bMV0sMikpfWZ1bmN0aW9uIGEoZSx0LG4pe3ZhciByPWUubGVuZ3RoO2lmKHI8MylyZXR1cm4hMTtmb3IodmFyIG89W051bWJlci5NQVhfU0FGRV9JTlRFR0VSLG5dLGE9W3Qsbl0sYz0wLHU9MDt1PHI7dSsrKXt2YXIgZD1lW3VdLHA9ZVsodSsxKSVyXTtpZihsKGQscCxhLG8pKXtpZigwPT09cyhkLGEscCkpcmV0dXJuIGkoZCxhLHApO2MrK319cmV0dXJuIGMlMj09MX1mdW5jdGlvbiBpKGUsdCxuKXtyZXR1cm4gdFswXTw9TWF0aC5tYXgoZVswXSxuWzBdKSYmdFswXT49TWF0aC5taW4oZVswXSxuWzBdKSYmdFsxXTw9TWF0aC5tYXgoZVsxXSxuWzFdKSYmdFsxXT49TWF0aC5taW4oZVsxXSxuWzFdKX1mdW5jdGlvbiBzKGUsdCxuKXt2YXIgcj0odFsxXS1lWzFdKSooblswXS10WzBdKS0odFswXS1lWzBdKSooblsxXS10WzFdKTtyZXR1cm4gMD09PXI/MDpyPjA/MToyfWZ1bmN0aW9uIGwoZSx0LG4scil7dmFyIG89cyhlLHQsbiksYT1zKGUsdCxyKSxsPXMobixyLGUpLGM9cyhuLHIsdCk7cmV0dXJuIG8hPT1hJiZsIT09Y3x8KCEoMCE9PW98fCFpKGUsbix0KSl8fCghKDAhPT1hfHwhaShlLHIsdCkpfHwoISgwIT09bHx8IWkobixlLHIpKXx8ISgwIT09Y3x8IWkobix0LHIpKSkpKX12YXIgYz1mdW5jdGlvbigpe2Zvcih2YXIgZT0wLHQ9MCxuPWFyZ3VtZW50cy5sZW5ndGg7dDxuO3QrKyllKz1hcmd1bWVudHNbdF0ubGVuZ3RoO3ZhciByPUFycmF5KGUpLG89MDtmb3IodD0wO3Q8bjt0KyspZm9yKHZhciBhPWFyZ3VtZW50c1t0XSxpPTAscz1hLmxlbmd0aDtpPHM7aSsrLG8rKylyW29dPWFbaV07cmV0dXJuIHJ9O2Z1bmN0aW9uIHUoZSx0KXt2YXIgbj1bMCwwXSxvPU1hdGgucm91bmQodC5oYWNodXJlQW5nbGUrOTApO28mJnIoZSxuLG8pO3ZhciBhPWZ1bmN0aW9uKGUsdCl7dmFyIG49YyhlKTtuWzBdLmpvaW4oIiwiKSE9PW5bbi5sZW5ndGgtMV0uam9pbigiLCIpJiZuLnB1c2goW25bMF1bMF0sblswXVsxXV0pO3ZhciByPVtdO2lmKG4mJm4ubGVuZ3RoPjIpe3ZhciBvPXQuaGFjaHVyZUdhcDtvPDAmJihvPTQqdC5zdHJva2VXaWR0aCksbz1NYXRoLm1heChvLC4xKTtmb3IodmFyIGE9W10saT0wO2k8bi5sZW5ndGgtMTtpKyspe3ZhciBzPW5baV0sbD1uW2krMV07aWYoc1sxXSE9PWxbMV0pe3ZhciB1PU1hdGgubWluKHNbMV0sbFsxXSk7YS5wdXNoKHt5bWluOnUseW1heDpNYXRoLm1heChzWzFdLGxbMV0pLHg6dT09PXNbMV0/c1swXTpsWzBdLGlzbG9wZToobFswXS1zWzBdKS8obFsxXS1zWzFdKX0pfX1pZihhLnNvcnQoKGZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUueW1pbjx0LnltaW4/LTE6ZS55bWluPnQueW1pbj8xOmUueDx0Lng/LTE6ZS54PnQueD8xOmUueW1heD09PXQueW1heD8wOihlLnltYXgtdC55bWF4KS9NYXRoLmFicyhlLnltYXgtdC55bWF4KX0pKSwhYS5sZW5ndGgpcmV0dXJuIHI7Zm9yKHZhciBkPVtdLHA9YVswXS55bWluO2QubGVuZ3RofHxhLmxlbmd0aDspe2lmKGEubGVuZ3RoKXt2YXIgaD0tMTtmb3IoaT0wO2k8YS5sZW5ndGgmJiEoYVtpXS55bWluPnApO2krKyloPWk7YS5zcGxpY2UoMCxoKzEpLmZvckVhY2goKGZ1bmN0aW9uKGUpe2QucHVzaCh7czpwLGVkZ2U6ZX0pfSkpfWlmKChkPWQuZmlsdGVyKChmdW5jdGlvbihlKXtyZXR1cm4hKGUuZWRnZS55bWF4PD1wKX0pKSkuc29ydCgoZnVuY3Rpb24oZSx0KXtyZXR1cm4gZS5lZGdlLng9PT10LmVkZ2UueD8wOihlLmVkZ2UueC10LmVkZ2UueCkvTWF0aC5hYnMoZS5lZGdlLngtdC5lZGdlLngpfSkpLGQubGVuZ3RoPjEpZm9yKGk9MDtpPGQubGVuZ3RoO2krPTIpe3ZhciBmPWkrMTtpZihmPj1kLmxlbmd0aClicmVhazt2YXIgbT1kW2ldLmVkZ2UsZz1kW2ZdLmVkZ2U7ci5wdXNoKFtbTWF0aC5yb3VuZChtLngpLHBdLFtNYXRoLnJvdW5kKGcueCkscF1dKX1wKz1vLGQuZm9yRWFjaCgoZnVuY3Rpb24oZSl7ZS5lZGdlLng9ZS5lZGdlLngrbyplLmVkZ2UuaXNsb3BlfSkpfX1yZXR1cm4gcn0oZSx0KTtyZXR1cm4gbyYmKHIoZSxuLC1vKSxmdW5jdGlvbihlLHQsbil7dmFyIG89W107ZS5mb3JFYWNoKChmdW5jdGlvbihlKXtyZXR1cm4gby5wdXNoLmFwcGx5KG8sZSl9KSkscihvLHQsbil9KGEsbiwtbykpLGF9dmFyIGQscD1mdW5jdGlvbigpe2Zvcih2YXIgZT0wLHQ9MCxuPWFyZ3VtZW50cy5sZW5ndGg7dDxuO3QrKyllKz1hcmd1bWVudHNbdF0ubGVuZ3RoO3ZhciByPUFycmF5KGUpLG89MDtmb3IodD0wO3Q8bjt0KyspZm9yKHZhciBhPWFyZ3VtZW50c1t0XSxpPTAscz1hLmxlbmd0aDtpPHM7aSsrLG8rKylyW29dPWFbaV07cmV0dXJuIHJ9LGg9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUpe3RoaXMuaGVscGVyPWV9cmV0dXJuIGUucHJvdG90eXBlLmZpbGxQb2x5Z29uPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuX2ZpbGxQb2x5Z29uKGUsdCl9LGUucHJvdG90eXBlLl9maWxsUG9seWdvbj1mdW5jdGlvbihlLHQsbil7dm9pZCAwPT09biYmKG49ITEpO3ZhciByPXUoZSx0KTtpZihuKXt2YXIgbz10aGlzLmNvbm5lY3RpbmdMaW5lcyhlLHIpO3I9ci5jb25jYXQobyl9cmV0dXJue3R5cGU6ImZpbGxTa2V0Y2giLG9wczp0aGlzLnJlbmRlckxpbmVzKHIsdCl9fSxlLnByb3RvdHlwZS5yZW5kZXJMaW5lcz1mdW5jdGlvbihlLHQpe2Zvcih2YXIgbj1bXSxyPTAsbz1lO3I8by5sZW5ndGg7cisrKXt2YXIgYT1vW3JdO24ucHVzaC5hcHBseShuLHRoaXMuaGVscGVyLmRvdWJsZUxpbmVPcHMoYVswXVswXSxhWzBdWzFdLGFbMV1bMF0sYVsxXVsxXSx0KSl9cmV0dXJuIG59LGUucHJvdG90eXBlLmNvbm5lY3RpbmdMaW5lcz1mdW5jdGlvbihlLHQpe3ZhciBuPVtdO2lmKHQubGVuZ3RoPjEpZm9yKHZhciByPTE7cjx0Lmxlbmd0aDtyKyspe3ZhciBhPXRbci0xXTtpZighKG8oYSk8Mykpe3ZhciBpPVt0W3JdWzBdLGFbMV1dO2lmKG8oaSk+Myl7dmFyIHM9dGhpcy5zcGxpdE9uSW50ZXJzZWN0aW9ucyhlLGkpO24ucHVzaC5hcHBseShuLHMpfX19cmV0dXJuIG59LGUucHJvdG90eXBlLm1pZFBvaW50SW5Qb2x5Z29uPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIGEoZSwodFswXVswXSt0WzFdWzBdKS8yLCh0WzBdWzFdK3RbMV1bMV0pLzIpfSxlLnByb3RvdHlwZS5zcGxpdE9uSW50ZXJzZWN0aW9ucz1mdW5jdGlvbihlLHQpe2Zvcih2YXIgbixyLGkscyxjLHUsZCxoLGYsbSxnLGI9TWF0aC5tYXgoNSwuMSpvKHQpKSx5PVtdLHY9MDt2PGUubGVuZ3RoO3YrKyl7dmFyIGs9ZVt2XSx3PWVbKHYrMSklZS5sZW5ndGhdO2lmKGwuYXBwbHkodm9pZCAwLHAoW2ssd10sdCkpKXt2YXIgUz0obj1rLHI9dyxpPXRbMF0scz10WzFdLGM9dm9pZCAwLHU9dm9pZCAwLGQ9dm9pZCAwLGg9dm9pZCAwLGY9dm9pZCAwLG09dm9pZCAwLGc9dm9pZCAwLGM9clsxXS1uWzFdLHU9blswXS1yWzBdLGQ9YypuWzBdK3UqblsxXSxoPXNbMV0taVsxXSxmPWlbMF0tc1swXSxtPWgqaVswXStmKmlbMV0sKGc9YypmLWgqdSk/WyhmKmQtdSptKS9nLChjKm0taCpkKS9nXTpudWxsKTtpZihTKXt2YXIgRT1vKFtTLHRbMF1dKSxPPW8oW1MsdFsxXV0pO0U+YiYmTz5iJiZ5LnB1c2goe3BvaW50OlMsZGlzdGFuY2U6RX0pfX19aWYoeS5sZW5ndGg+MSl7dmFyIEM9eS5zb3J0KChmdW5jdGlvbihlLHQpe3JldHVybiBlLmRpc3RhbmNlLXQuZGlzdGFuY2V9KSkubWFwKChmdW5jdGlvbihlKXtyZXR1cm4gZS5wb2ludH0pKTtpZihhLmFwcGx5KHZvaWQgMCxwKFtlXSx0WzBdKSl8fEMuc2hpZnQoKSxhLmFwcGx5KHZvaWQgMCxwKFtlXSx0WzFdKSl8fEMucG9wKCksQy5sZW5ndGg8PTEpcmV0dXJuIHRoaXMubWlkUG9pbnRJblBvbHlnb24oZSx0KT9bdF06W107dmFyIHg9cChbdFswXV0sQyxbdFsxXV0pLGo9W107Zm9yKHY9MDt2PHgubGVuZ3RoLTE7dis9Mil7dmFyIFQ9W3hbdl0seFt2KzFdXTt0aGlzLm1pZFBvaW50SW5Qb2x5Z29uKGUsVCkmJmoucHVzaChUKX1yZXR1cm4gan1yZXR1cm4gdGhpcy5taWRQb2ludEluUG9seWdvbihlLHQpP1t0XTpbXX0sZX0oKSxmPShkPWZ1bmN0aW9uKGUsdCl7cmV0dXJuKGQ9T2JqZWN0LnNldFByb3RvdHlwZU9mfHx7X19wcm90b19fOltdfWluc3RhbmNlb2YgQXJyYXkmJmZ1bmN0aW9uKGUsdCl7ZS5fX3Byb3RvX189dH18fGZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBuIGluIHQpdC5oYXNPd25Qcm9wZXJ0eShuKSYmKGVbbl09dFtuXSl9KShlLHQpfSxmdW5jdGlvbihlLHQpe2Z1bmN0aW9uIG4oKXt0aGlzLmNvbnN0cnVjdG9yPWV9ZChlLHQpLGUucHJvdG90eXBlPW51bGw9PT10P09iamVjdC5jcmVhdGUodCk6KG4ucHJvdG90eXBlPXQucHJvdG90eXBlLG5ldyBuKX0pLG09ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdCgpe3JldHVybiBudWxsIT09ZSYmZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl8fHRoaXN9cmV0dXJuIGYodCxlKSx0LnByb3RvdHlwZS5maWxsUG9seWdvbj1mdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLl9maWxsUG9seWdvbihlLHQsITApfSx0fShoKSxnPWZ1bmN0aW9uKCl7dmFyIGU9ZnVuY3Rpb24odCxuKXtyZXR1cm4oZT1PYmplY3Quc2V0UHJvdG90eXBlT2Z8fHtfX3Byb3RvX186W119aW5zdGFuY2VvZiBBcnJheSYmZnVuY3Rpb24oZSx0KXtlLl9fcHJvdG9fXz10fXx8ZnVuY3Rpb24oZSx0KXtmb3IodmFyIG4gaW4gdCl0Lmhhc093blByb3BlcnR5KG4pJiYoZVtuXT10W25dKX0pKHQsbil9O3JldHVybiBmdW5jdGlvbih0LG4pe2Z1bmN0aW9uIHIoKXt0aGlzLmNvbnN0cnVjdG9yPXR9ZSh0LG4pLHQucHJvdG90eXBlPW51bGw9PT1uP09iamVjdC5jcmVhdGUobik6KHIucHJvdG90eXBlPW4ucHJvdG90eXBlLG5ldyByKX19KCksYj1mdW5jdGlvbihlKXtmdW5jdGlvbiB0KCl7cmV0dXJuIG51bGwhPT1lJiZlLmFwcGx5KHRoaXMsYXJndW1lbnRzKXx8dGhpc31yZXR1cm4gZyh0LGUpLHQucHJvdG90eXBlLmZpbGxQb2x5Z29uPWZ1bmN0aW9uKGUsdCl7dmFyIG49dGhpcy5fZmlsbFBvbHlnb24oZSx0KSxyPU9iamVjdC5hc3NpZ24oe30sdCx7aGFjaHVyZUFuZ2xlOnQuaGFjaHVyZUFuZ2xlKzkwfSksbz10aGlzLl9maWxsUG9seWdvbihlLHIpO3JldHVybiBuLm9wcz1uLm9wcy5jb25jYXQoby5vcHMpLG59LHR9KGgpLHk9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUpe3RoaXMuaGVscGVyPWV9cmV0dXJuIGUucHJvdG90eXBlLmZpbGxQb2x5Z29uPWZ1bmN0aW9uKGUsdCl7dmFyIG49dShlLHQ9T2JqZWN0LmFzc2lnbih7fSx0LHtjdXJ2ZVN0ZXBDb3VudDo0LGhhY2h1cmVBbmdsZTowLHJvdWdobmVzczoxfSkpO3JldHVybiB0aGlzLmRvdHNPbkxpbmVzKG4sdCl9LGUucHJvdG90eXBlLmRvdHNPbkxpbmVzPWZ1bmN0aW9uKGUsdCl7dmFyIG49W10scj10LmhhY2h1cmVHYXA7cjwwJiYocj00KnQuc3Ryb2tlV2lkdGgpLHI9TWF0aC5tYXgociwuMSk7dmFyIGE9dC5maWxsV2VpZ2h0O2E8MCYmKGE9dC5zdHJva2VXaWR0aC8yKTtmb3IodmFyIGk9ci80LHM9MCxsPWU7czxsLmxlbmd0aDtzKyspZm9yKHZhciBjPWxbc10sdT1vKGMpLGQ9dS9yLHA9TWF0aC5jZWlsKGQpLTEsaD11LXAqcixmPShjWzBdWzBdK2NbMV1bMF0pLzItci80LG09TWF0aC5taW4oY1swXVsxXSxjWzFdWzFdKSxnPTA7ZzxwO2crKyl7dmFyIGI9bStoK2cqcix5PXRoaXMuaGVscGVyLnJhbmRPZmZzZXRXaXRoUmFuZ2UoZi1pLGYraSx0KSx2PXRoaXMuaGVscGVyLnJhbmRPZmZzZXRXaXRoUmFuZ2UoYi1pLGIraSx0KSxrPXRoaXMuaGVscGVyLmVsbGlwc2UoeSx2LGEsYSx0KTtuLnB1c2guYXBwbHkobixrLm9wcyl9cmV0dXJue3R5cGU6ImZpbGxTa2V0Y2giLG9wczpufX0sZX0oKSx2PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlKXt0aGlzLmhlbHBlcj1lfXJldHVybiBlLnByb3RvdHlwZS5maWxsUG9seWdvbj1mdW5jdGlvbihlLHQpe3ZhciBuPXUoZSx0KTtyZXR1cm57dHlwZToiZmlsbFNrZXRjaCIsb3BzOnRoaXMuZGFzaGVkTGluZShuLHQpfX0sZS5wcm90b3R5cGUuZGFzaGVkTGluZT1mdW5jdGlvbihlLHQpe3ZhciBuPXRoaXMscj10LmRhc2hPZmZzZXQ8MD90LmhhY2h1cmVHYXA8MD80KnQuc3Ryb2tlV2lkdGg6dC5oYWNodXJlR2FwOnQuZGFzaE9mZnNldCxhPXQuZGFzaEdhcDwwP3QuaGFjaHVyZUdhcDwwPzQqdC5zdHJva2VXaWR0aDp0LmhhY2h1cmVHYXA6dC5kYXNoR2FwLGk9W107cmV0dXJuIGUuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dmFyIHM9byhlKSxsPU1hdGguZmxvb3Iocy8ocithKSksYz0ocythLWwqKHIrYSkpLzIsdT1lWzBdLGQ9ZVsxXTt1WzBdPmRbMF0mJih1PWVbMV0sZD1lWzBdKTtmb3IodmFyIHA9TWF0aC5hdGFuKChkWzFdLXVbMV0pLyhkWzBdLXVbMF0pKSxoPTA7aDxsO2grKyl7dmFyIGY9aCoocithKSxtPWYrcixnPVt1WzBdK2YqTWF0aC5jb3MocCkrYypNYXRoLmNvcyhwKSx1WzFdK2YqTWF0aC5zaW4ocCkrYypNYXRoLnNpbihwKV0sYj1bdVswXSttKk1hdGguY29zKHApK2MqTWF0aC5jb3MocCksdVsxXSttKk1hdGguc2luKHApK2MqTWF0aC5zaW4ocCldO2kucHVzaC5hcHBseShpLG4uaGVscGVyLmRvdWJsZUxpbmVPcHMoZ1swXSxnWzFdLGJbMF0sYlsxXSx0KSl9fSkpLGl9LGV9KCksaz1mdW5jdGlvbigpe2Zvcih2YXIgZT0wLHQ9MCxuPWFyZ3VtZW50cy5sZW5ndGg7dDxuO3QrKyllKz1hcmd1bWVudHNbdF0ubGVuZ3RoO3ZhciByPUFycmF5KGUpLG89MDtmb3IodD0wO3Q8bjt0KyspZm9yKHZhciBhPWFyZ3VtZW50c1t0XSxpPTAscz1hLmxlbmd0aDtpPHM7aSsrLG8rKylyW29dPWFbaV07cmV0dXJuIHJ9LHc9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUpe3RoaXMuaGVscGVyPWV9cmV0dXJuIGUucHJvdG90eXBlLmZpbGxQb2x5Z29uPWZ1bmN0aW9uKGUsdCl7dmFyIG49dC5oYWNodXJlR2FwPDA/NCp0LnN0cm9rZVdpZHRoOnQuaGFjaHVyZUdhcCxyPXQuemlnemFnT2Zmc2V0PDA/bjp0LnppZ3phZ09mZnNldCxvPXUoZSx0PU9iamVjdC5hc3NpZ24oe30sdCx7aGFjaHVyZUdhcDpuK3J9KSk7cmV0dXJue3R5cGU6ImZpbGxTa2V0Y2giLG9wczp0aGlzLnppZ3phZ0xpbmVzKG8scix0KX19LGUucHJvdG90eXBlLnppZ3phZ0xpbmVzPWZ1bmN0aW9uKGUsdCxuKXt2YXIgcj10aGlzLGE9W107cmV0dXJuIGUuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dmFyIGk9byhlKSxzPU1hdGgucm91bmQoaS8oMip0KSksbD1lWzBdLGM9ZVsxXTtsWzBdPmNbMF0mJihsPWVbMV0sYz1lWzBdKTtmb3IodmFyIHU9TWF0aC5hdGFuKChjWzFdLWxbMV0pLyhjWzBdLWxbMF0pKSxkPTA7ZDxzO2QrKyl7dmFyIHA9MipkKnQsaD0yKihkKzEpKnQsZj1NYXRoLnNxcnQoMipNYXRoLnBvdyh0LDIpKSxtPVtsWzBdK3AqTWF0aC5jb3ModSksbFsxXStwKk1hdGguc2luKHUpXSxnPVtsWzBdK2gqTWF0aC5jb3ModSksbFsxXStoKk1hdGguc2luKHUpXSxiPVttWzBdK2YqTWF0aC5jb3ModStNYXRoLlBJLzQpLG1bMV0rZipNYXRoLnNpbih1K01hdGguUEkvNCldO2EucHVzaC5hcHBseShhLGsoci5oZWxwZXIuZG91YmxlTGluZU9wcyhtWzBdLG1bMV0sYlswXSxiWzFdLG4pLHIuaGVscGVyLmRvdWJsZUxpbmVPcHMoYlswXSxiWzFdLGdbMF0sZ1sxXSxuKSkpfX0pKSxhfSxlfSgpLFM9e307dmFyIEU9bigzMyk7Y29uc3QgTz17QTo3LGE6NyxDOjYsYzo2LEg6MSxoOjEsTDoyLGw6MixNOjIsbToyLFE6NCxxOjQsUzo0LHM6NCxUOjIsdDoyLFY6MSx2OjEsWjowLHo6MH07ZnVuY3Rpb24gQyhlLHQpe3JldHVybiBlLnR5cGU9PT10fWZ1bmN0aW9uIHgoZSl7Y29uc3QgdD1bXSxuPWZ1bmN0aW9uKGUpe2NvbnN0IHQ9bmV3IEFycmF5O2Zvcig7IiIhPT1lOylpZihlLm1hdGNoKC9eKFsgXHRcclxuLF0rKS8pKWU9ZS5zdWJzdHIoUmVnRXhwLiQxLmxlbmd0aCk7ZWxzZSBpZihlLm1hdGNoKC9eKFthQWNDaEhsTG1NcVFzU3RUdlZ6Wl0pLykpdFt0Lmxlbmd0aF09e3R5cGU6MCx0ZXh0OlJlZ0V4cC4kMX0sZT1lLnN1YnN0cihSZWdFeHAuJDEubGVuZ3RoKTtlbHNle2lmKCFlLm1hdGNoKC9eKChbLStdP1swLTldKyhcLlswLTldKik/fFstK10/XC5bMC05XSspKFtlRV1bLStdP1swLTldKyk/KS8pKXJldHVybltdO3RbdC5sZW5ndGhdPXt0eXBlOjEsdGV4dDpgJHtwYXJzZUZsb2F0KFJlZ0V4cC4kMSl9YH0sZT1lLnN1YnN0cihSZWdFeHAuJDEubGVuZ3RoKX1yZXR1cm4gdFt0Lmxlbmd0aF09e3R5cGU6Mix0ZXh0OiIifSx0fShlKTtsZXQgcj0iQk9EIixvPTAsYT1uW29dO2Zvcig7IUMoYSwyKTspe2xldCBpPTA7Y29uc3Qgcz1bXTtpZigiQk9EIj09PXIpe2lmKCJNIiE9PWEudGV4dCYmIm0iIT09YS50ZXh0KXJldHVybiB4KCJNMCwwIitlKTtvKyssaT1PW2EudGV4dF0scj1hLnRleHR9ZWxzZSBDKGEsMSk/aT1PW3JdOihvKyssaT1PW2EudGV4dF0scj1hLnRleHQpO2lmKCEobytpPG4ubGVuZ3RoKSl0aHJvdyBuZXcgRXJyb3IoIlBhdGggZGF0YSBlbmRlZCBzaG9ydCIpO2ZvcihsZXQgZT1vO2U8bytpO2UrKyl7Y29uc3QgdD1uW2VdO2lmKCFDKHQsMSkpdGhyb3cgbmV3IEVycm9yKCJQYXJhbSBub3QgYSBudW1iZXI6ICIrcisiLCIrdC50ZXh0KTtzW3MubGVuZ3RoXT0rdC50ZXh0fWlmKCJudW1iZXIiIT10eXBlb2YgT1tyXSl0aHJvdyBuZXcgRXJyb3IoIkJhZCBzZWdtZW50OiAiK3IpO3tjb25zdCBlPXtrZXk6cixkYXRhOnN9O3QucHVzaChlKSxvKz1pLGE9bltvXSwiTSI9PT1yJiYocj0iTCIpLCJtIj09PXImJihyPSJsIil9fXJldHVybiB0fWZ1bmN0aW9uIGooZSl7bGV0IHQ9MCxuPTAscj0wLG89MDtjb25zdCBhPVtdO2Zvcihjb25zdHtrZXk6aSxkYXRhOnN9b2YgZSlzd2l0Y2goaSl7Y2FzZSJNIjphLnB1c2goe2tleToiTSIsZGF0YTpbLi4uc119KSxbdCxuXT1zLFtyLG9dPXM7YnJlYWs7Y2FzZSJtIjp0Kz1zWzBdLG4rPXNbMV0sYS5wdXNoKHtrZXk6Ik0iLGRhdGE6W3Qsbl19KSxyPXQsbz1uO2JyZWFrO2Nhc2UiTCI6YS5wdXNoKHtrZXk6IkwiLGRhdGE6Wy4uLnNdfSksW3Qsbl09czticmVhaztjYXNlImwiOnQrPXNbMF0sbis9c1sxXSxhLnB1c2goe2tleToiTCIsZGF0YTpbdCxuXX0pO2JyZWFrO2Nhc2UiQyI6YS5wdXNoKHtrZXk6IkMiLGRhdGE6Wy4uLnNdfSksdD1zWzRdLG49c1s1XTticmVhaztjYXNlImMiOntjb25zdCBlPXMubWFwKChlLHIpPT5yJTI/ZStuOmUrdCk7YS5wdXNoKHtrZXk6IkMiLGRhdGE6ZX0pLHQ9ZVs0XSxuPWVbNV07YnJlYWt9Y2FzZSJRIjphLnB1c2goe2tleToiUSIsZGF0YTpbLi4uc119KSx0PXNbMl0sbj1zWzNdO2JyZWFrO2Nhc2UicSI6e2NvbnN0IGU9cy5tYXAoKGUscik9PnIlMj9lK246ZSt0KTthLnB1c2goe2tleToiUSIsZGF0YTplfSksdD1lWzJdLG49ZVszXTticmVha31jYXNlIkEiOmEucHVzaCh7a2V5OiJBIixkYXRhOlsuLi5zXX0pLHQ9c1s1XSxuPXNbNl07YnJlYWs7Y2FzZSJhIjp0Kz1zWzVdLG4rPXNbNl0sYS5wdXNoKHtrZXk6IkEiLGRhdGE6W3NbMF0sc1sxXSxzWzJdLHNbM10sc1s0XSx0LG5dfSk7YnJlYWs7Y2FzZSJIIjphLnB1c2goe2tleToiSCIsZGF0YTpbLi4uc119KSx0PXNbMF07YnJlYWs7Y2FzZSJoIjp0Kz1zWzBdLGEucHVzaCh7a2V5OiJIIixkYXRhOlt0XX0pO2JyZWFrO2Nhc2UiViI6YS5wdXNoKHtrZXk6IlYiLGRhdGE6Wy4uLnNdfSksbj1zWzBdO2JyZWFrO2Nhc2UidiI6bis9c1swXSxhLnB1c2goe2tleToiViIsZGF0YTpbbl19KTticmVhaztjYXNlIlMiOmEucHVzaCh7a2V5OiJTIixkYXRhOlsuLi5zXX0pLHQ9c1syXSxuPXNbM107YnJlYWs7Y2FzZSJzIjp7Y29uc3QgZT1zLm1hcCgoZSxyKT0+ciUyP2UrbjplK3QpO2EucHVzaCh7a2V5OiJTIixkYXRhOmV9KSx0PWVbMl0sbj1lWzNdO2JyZWFrfWNhc2UiVCI6YS5wdXNoKHtrZXk6IlQiLGRhdGE6Wy4uLnNdfSksdD1zWzBdLG49c1sxXTticmVhaztjYXNlInQiOnQrPXNbMF0sbis9c1sxXSxhLnB1c2goe2tleToiVCIsZGF0YTpbdCxuXX0pO2JyZWFrO2Nhc2UiWiI6Y2FzZSJ6IjphLnB1c2goe2tleToiWiIsZGF0YTpbXX0pLHQ9cixuPW99cmV0dXJuIGF9ZnVuY3Rpb24gVChlKXtjb25zdCB0PVtdO2xldCBuPSIiLHI9MCxvPTAsYT0wLGk9MCxzPTAsbD0wO2Zvcihjb25zdHtrZXk6YyxkYXRhOnV9b2YgZSl7c3dpdGNoKGMpe2Nhc2UiTSI6dC5wdXNoKHtrZXk6Ik0iLGRhdGE6Wy4uLnVdfSksW3Isb109dSxbYSxpXT11O2JyZWFrO2Nhc2UiQyI6dC5wdXNoKHtrZXk6IkMiLGRhdGE6Wy4uLnVdfSkscj11WzRdLG89dVs1XSxzPXVbMl0sbD11WzNdO2JyZWFrO2Nhc2UiTCI6dC5wdXNoKHtrZXk6IkwiLGRhdGE6Wy4uLnVdfSksW3Isb109dTticmVhaztjYXNlIkgiOnI9dVswXSx0LnB1c2goe2tleToiTCIsZGF0YTpbcixvXX0pO2JyZWFrO2Nhc2UiViI6bz11WzBdLHQucHVzaCh7a2V5OiJMIixkYXRhOltyLG9dfSk7YnJlYWs7Y2FzZSJTIjp7bGV0IGU9MCxhPTA7IkMiPT09bnx8IlMiPT09bj8oZT1yKyhyLXMpLGE9bysoby1sKSk6KGU9cixhPW8pLHQucHVzaCh7a2V5OiJDIixkYXRhOltlLGEsLi4udV19KSxzPXVbMF0sbD11WzFdLHI9dVsyXSxvPXVbM107YnJlYWt9Y2FzZSJUIjp7Y29uc3RbZSxhXT11O2xldCBpPTAsYz0wOyJRIj09PW58fCJUIj09PW4/KGk9cisoci1zKSxjPW8rKG8tbCkpOihpPXIsYz1vKTtjb25zdCBkPXIrMiooaS1yKS8zLHA9bysyKihjLW8pLzMsaD1lKzIqKGktZSkvMyxmPWErMiooYy1hKS8zO3QucHVzaCh7a2V5OiJDIixkYXRhOltkLHAsaCxmLGUsYV19KSxzPWksbD1jLHI9ZSxvPWE7YnJlYWt9Y2FzZSJRIjp7Y29uc3RbZSxuLGEsaV09dSxjPXIrMiooZS1yKS8zLGQ9bysyKihuLW8pLzMscD1hKzIqKGUtYSkvMyxoPWkrMioobi1pKS8zO3QucHVzaCh7a2V5OiJDIixkYXRhOltjLGQscCxoLGEsaV19KSxzPWUsbD1uLHI9YSxvPWk7YnJlYWt9Y2FzZSJBIjp7Y29uc3QgZT1NYXRoLmFicyh1WzBdKSxuPU1hdGguYWJzKHVbMV0pLGE9dVsyXSxpPXVbM10scz11WzRdLGw9dVs1XSxjPXVbNl07aWYoMD09PWV8fDA9PT1uKXQucHVzaCh7a2V5OiJDIixkYXRhOltyLG8sbCxjLGwsY119KSxyPWwsbz1jO2Vsc2UgaWYociE9PWx8fG8hPT1jKXtBKHIsbyxsLGMsZSxuLGEsaSxzKS5mb3JFYWNoKChmdW5jdGlvbihlKXt0LnB1c2goe2tleToiQyIsZGF0YTplfSl9KSkscj1sLG89Y31icmVha31jYXNlIloiOnQucHVzaCh7a2V5OiJaIixkYXRhOltdfSkscj1hLG89aX1uPWN9cmV0dXJuIHR9ZnVuY3Rpb24gUChlLHQsbil7cmV0dXJuW2UqTWF0aC5jb3MobiktdCpNYXRoLnNpbihuKSxlKk1hdGguc2luKG4pK3QqTWF0aC5jb3MobildfWZ1bmN0aW9uIEEoZSx0LG4scixvLGEsaSxzLGwsYyl7Y29uc3QgdT0oZD1pLE1hdGguUEkqZC8xODApO3ZhciBkO2xldCBwPVtdLGg9MCxmPTAsbT0wLGc9MDtpZihjKVtoLGYsbSxnXT1jO2Vsc2V7W2UsdF09UChlLHQsLXUpLFtuLHJdPVAobixyLC11KTtjb25zdCBpPShlLW4pLzIsYz0odC1yKS8yO2xldCBkPWkqaS8obypvKStjKmMvKGEqYSk7ZD4xJiYoZD1NYXRoLnNxcnQoZCksbyo9ZCxhKj1kKTtjb25zdCBwPW8qbyxiPWEqYSx5PXAqYi1wKmMqYy1iKmkqaSx2PXAqYypjK2IqaSppLGs9KHM9PT1sPy0xOjEpKk1hdGguc3FydChNYXRoLmFicyh5L3YpKTttPWsqbypjL2ErKGUrbikvMixnPWsqLWEqaS9vKyh0K3IpLzIsaD1NYXRoLmFzaW4ocGFyc2VGbG9hdCgoKHQtZykvYSkudG9GaXhlZCg5KSkpLGY9TWF0aC5hc2luKHBhcnNlRmxvYXQoKChyLWcpL2EpLnRvRml4ZWQoOSkpKSxlPG0mJihoPU1hdGguUEktaCksbjxtJiYoZj1NYXRoLlBJLWYpLGg8MCYmKGg9MipNYXRoLlBJK2gpLGY8MCYmKGY9MipNYXRoLlBJK2YpLGwmJmg+ZiYmKGgtPTIqTWF0aC5QSSksIWwmJmY+aCYmKGYtPTIqTWF0aC5QSSl9bGV0IGI9Zi1oO2lmKE1hdGguYWJzKGIpPjEyMCpNYXRoLlBJLzE4MCl7Y29uc3QgZT1mLHQ9bixzPXI7Zj1sJiZmPmg/aCsxMjAqTWF0aC5QSS8xODAqMTpoKzEyMCpNYXRoLlBJLzE4MCotMSxwPUEobj1tK28qTWF0aC5jb3MoZikscj1nK2EqTWF0aC5zaW4oZiksdCxzLG8sYSxpLDAsbCxbZixlLG0sZ10pfWI9Zi1oO2NvbnN0IHk9TWF0aC5jb3MoaCksdj1NYXRoLnNpbihoKSxrPU1hdGguY29zKGYpLHc9TWF0aC5zaW4oZiksUz1NYXRoLnRhbihiLzQpLEU9NC8zKm8qUyxPPTQvMyphKlMsQz1bZSx0XSx4PVtlK0Uqdix0LU8qeV0saj1bbitFKncsci1PKmtdLFQ9W24scl07aWYoeFswXT0yKkNbMF0teFswXSx4WzFdPTIqQ1sxXS14WzFdLGMpcmV0dXJuW3gsaixUXS5jb25jYXQocCk7e3A9W3gsaixUXS5jb25jYXQocCk7Y29uc3QgZT1bXTtmb3IobGV0IHQ9MDt0PHAubGVuZ3RoO3QrPTMpe2NvbnN0IG49UChwW3RdWzBdLHBbdF1bMV0sdSkscj1QKHBbdCsxXVswXSxwW3QrMV1bMV0sdSksbz1QKHBbdCsyXVswXSxwW3QrMl1bMV0sdSk7ZS5wdXNoKFtuWzBdLG5bMV0sclswXSxyWzFdLG9bMF0sb1sxXV0pfXJldHVybiBlfX12YXIgTT1mdW5jdGlvbigpe2Zvcih2YXIgZT0wLHQ9MCxuPWFyZ3VtZW50cy5sZW5ndGg7dDxuO3QrKyllKz1hcmd1bWVudHNbdF0ubGVuZ3RoO3ZhciByPUFycmF5KGUpLG89MDtmb3IodD0wO3Q8bjt0KyspZm9yKHZhciBhPWFyZ3VtZW50c1t0XSxpPTAscz1hLmxlbmd0aDtpPHM7aSsrLG8rKylyW29dPWFbaV07cmV0dXJuIHJ9LF89e3JhbmRPZmZzZXQ6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gVihlLHQpfSxyYW5kT2Zmc2V0V2l0aFJhbmdlOmZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gVShlLHQsbil9LGVsbGlwc2U6ZnVuY3Rpb24oZSx0LG4scixvKXt2YXIgYT1OKG4scixvKTtyZXR1cm4gRihlLHQsbyxhKS5vcHNldH0sZG91YmxlTGluZU9wczpmdW5jdGlvbihlLHQsbixyLG8pe3JldHVybiBLKGUsdCxuLHIsbywhMCl9fTtmdW5jdGlvbiB6KGUsdCxuLHIsbyl7cmV0dXJue3R5cGU6InBhdGgiLG9wczpLKGUsdCxuLHIsbyl9fWZ1bmN0aW9uIEwoZSx0LG4pe3ZhciByPShlfHxbXSkubGVuZ3RoO2lmKHI+Mil7Zm9yKHZhciBvPVtdLGE9MDthPHItMTthKyspby5wdXNoLmFwcGx5KG8sSyhlW2FdWzBdLGVbYV1bMV0sZVthKzFdWzBdLGVbYSsxXVsxXSxuKSk7cmV0dXJuIHQmJm8ucHVzaC5hcHBseShvLEsoZVtyLTFdWzBdLGVbci0xXVsxXSxlWzBdWzBdLGVbMF1bMV0sbikpLHt0eXBlOiJwYXRoIixvcHM6b319cmV0dXJuIDI9PT1yP3ooZVswXVswXSxlWzBdWzFdLGVbMV1bMF0sZVsxXVsxXSxuKTp7dHlwZToicGF0aCIsb3BzOltdfX1mdW5jdGlvbiBJKGUsdCxuLHIsbyl7cmV0dXJuIGZ1bmN0aW9uKGUsdCl7cmV0dXJuIEwoZSwhMCx0KX0oW1tlLHRdLFtlK24sdF0sW2Urbix0K3JdLFtlLHQrcl1dLG8pfWZ1bmN0aW9uIEQoZSx0KXt2YXIgbj1xKGUsMSooMSsuMip0LnJvdWdobmVzcyksdCk7aWYoIXQuZGlzYWJsZU11bHRpU3Ryb2tlKXt2YXIgcj1xKGUsMS41KigxKy4yMip0LnJvdWdobmVzcyksZnVuY3Rpb24oZSl7dmFyIHQ9T2JqZWN0LmFzc2lnbih7fSxlKTt0LnJhbmRvbWl6ZXI9dm9pZCAwLGUuc2VlZCYmKHQuc2VlZD1lLnNlZWQrMSk7cmV0dXJuIHR9KHQpKTtuPW4uY29uY2F0KHIpfXJldHVybnt0eXBlOiJwYXRoIixvcHM6bn19ZnVuY3Rpb24gTihlLHQsbil7dmFyIHI9TWF0aC5zcXJ0KDIqTWF0aC5QSSpNYXRoLnNxcnQoKE1hdGgucG93KGUvMiwyKStNYXRoLnBvdyh0LzIsMikpLzIpKSxvPU1hdGgubWF4KG4uY3VydmVTdGVwQ291bnQsbi5jdXJ2ZVN0ZXBDb3VudC9NYXRoLnNxcnQoMjAwKSpyKSxhPTIqTWF0aC5QSS9vLGk9TWF0aC5hYnMoZS8yKSxzPU1hdGguYWJzKHQvMiksbD0xLW4uY3VydmVGaXR0aW5nO3JldHVybntpbmNyZW1lbnQ6YSxyeDppKz1WKGkqbCxuKSxyeTpzKz1WKHMqbCxuKX19ZnVuY3Rpb24gRihlLHQsbixyKXt2YXIgbz1YKHIuaW5jcmVtZW50LGUsdCxyLnJ4LHIucnksMSxyLmluY3JlbWVudCpVKC4xLFUoLjQsMSxuKSxuKSxuKSxhPW9bMF0saT1vWzFdLHM9WShhLG51bGwsbik7aWYoIW4uZGlzYWJsZU11bHRpU3Ryb2tlKXt2YXIgbD1ZKFgoci5pbmNyZW1lbnQsZSx0LHIucngsci5yeSwxLjUsMCxuKVswXSxudWxsLG4pO3M9cy5jb25jYXQobCl9cmV0dXJue2VzdGltYXRlZFBvaW50czppLG9wc2V0Ont0eXBlOiJwYXRoIixvcHM6c319fWZ1bmN0aW9uIFIoZSx0LG4scixvLGEsaSxzLGwpe3ZhciBjPWUsdT10LGQ9TWF0aC5hYnMobi8yKSxwPU1hdGguYWJzKHIvMik7ZCs9ViguMDEqZCxsKSxwKz1WKC4wMSpwLGwpO2Zvcih2YXIgaD1vLGY9YTtoPDA7KWgrPTIqTWF0aC5QSSxmKz0yKk1hdGguUEk7Zi1oPjIqTWF0aC5QSSYmKGg9MCxmPTIqTWF0aC5QSSk7dmFyIG09MipNYXRoLlBJL2wuY3VydmVTdGVwQ291bnQsZz1NYXRoLm1pbihtLzIsKGYtaCkvMiksYj1KKGcsYyx1LGQscCxoLGYsMSxsKTtpZighbC5kaXNhYmxlTXVsdGlTdHJva2Upe3ZhciB5PUooZyxjLHUsZCxwLGgsZiwxLjUsbCk7Yi5wdXNoLmFwcGx5KGIseSl9cmV0dXJuIGkmJihzP2IucHVzaC5hcHBseShiLE0oSyhjLHUsYytkKk1hdGguY29zKGgpLHUrcCpNYXRoLnNpbihoKSxsKSxLKGMsdSxjK2QqTWF0aC5jb3MoZiksdStwKk1hdGguc2luKGYpLGwpKSk6Yi5wdXNoKHtvcDoibGluZVRvIixkYXRhOltjLHVdfSx7b3A6ImxpbmVUbyIsZGF0YTpbYytkKk1hdGguY29zKGgpLHUrcCpNYXRoLnNpbihoKV19KSkse3R5cGU6InBhdGgiLG9wczpifX1mdW5jdGlvbiBCKGUsdCl7Zm9yKHZhciBuPVQoaih4KGUpKSkscj1bXSxvPVswLDBdLGE9WzAsMF0saT1mdW5jdGlvbihlLG4pe3N3aXRjaChlKXtjYXNlIk0iOnZhciBpPTEqKHQubWF4UmFuZG9tbmVzc09mZnNldHx8MCk7ci5wdXNoKHtvcDoibW92ZSIsZGF0YTpuLm1hcCgoZnVuY3Rpb24oZSl7cmV0dXJuIGUrVihpLHQpfSkpfSksYT1bblswXSxuWzFdXSxvPVtuWzBdLG5bMV1dO2JyZWFrO2Nhc2UiTCI6ci5wdXNoLmFwcGx5KHIsSyhhWzBdLGFbMV0sblswXSxuWzFdLHQpKSxhPVtuWzBdLG5bMV1dO2JyZWFrO2Nhc2UiQyI6dmFyIHM9blswXSxsPW5bMV0sYz1uWzJdLHU9blszXSxkPW5bNF0scD1uWzVdO3IucHVzaC5hcHBseShyLGZ1bmN0aW9uKGUsdCxuLHIsbyxhLGkscyl7Zm9yKHZhciBsPVtdLGM9W3MubWF4UmFuZG9tbmVzc09mZnNldHx8MSwocy5tYXhSYW5kb21uZXNzT2Zmc2V0fHwxKSsuM10sdT1bMCwwXSxkPXMuZGlzYWJsZU11bHRpU3Ryb2tlPzE6MixwPTA7cDxkO3ArKykwPT09cD9sLnB1c2goe29wOiJtb3ZlIixkYXRhOltpWzBdLGlbMV1dfSk6bC5wdXNoKHtvcDoibW92ZSIsZGF0YTpbaVswXStWKGNbMF0scyksaVsxXStWKGNbMF0scyldfSksdT1bbytWKGNbcF0scyksYStWKGNbcF0scyldLGwucHVzaCh7b3A6ImJjdXJ2ZVRvIixkYXRhOltlK1YoY1twXSxzKSx0K1YoY1twXSxzKSxuK1YoY1twXSxzKSxyK1YoY1twXSxzKSx1WzBdLHVbMV1dfSk7cmV0dXJuIGx9KHMsbCxjLHUsZCxwLGEsdCkpLGE9W2QscF07YnJlYWs7Y2FzZSJaIjpyLnB1c2guYXBwbHkocixLKGFbMF0sYVsxXSxvWzBdLG9bMV0sdCkpLGE9W29bMF0sb1sxXV19fSxzPTAsbD1uO3M8bC5sZW5ndGg7cysrKXt2YXIgYz1sW3NdO2koYy5rZXksYy5kYXRhKX1yZXR1cm57dHlwZToicGF0aCIsb3BzOnJ9fWZ1bmN0aW9uIEgoZSx0KXt2YXIgbj1bXTtpZihlLmxlbmd0aCl7dmFyIHI9dC5tYXhSYW5kb21uZXNzT2Zmc2V0fHwwLG89ZS5sZW5ndGg7aWYobz4yKXtuLnB1c2goe29wOiJtb3ZlIixkYXRhOltlWzBdWzBdK1Yocix0KSxlWzBdWzFdK1Yocix0KV19KTtmb3IodmFyIGE9MTthPG87YSsrKW4ucHVzaCh7b3A6ImxpbmVUbyIsZGF0YTpbZVthXVswXStWKHIsdCksZVthXVsxXStWKHIsdCldfSl9fXJldHVybnt0eXBlOiJmaWxsUGF0aCIsb3BzOm59fWZ1bmN0aW9uIEcoZSx0KXtyZXR1cm4gZnVuY3Rpb24oZSx0KXt2YXIgbj1lLmZpbGxTdHlsZXx8ImhhY2h1cmUiO2lmKCFTW25dKXN3aXRjaChuKXtjYXNlInppZ3phZyI6U1tuXXx8KFNbbl09bmV3IG0odCkpO2JyZWFrO2Nhc2UiY3Jvc3MtaGF0Y2giOlNbbl18fChTW25dPW5ldyBiKHQpKTticmVhaztjYXNlImRvdHMiOlNbbl18fChTW25dPW5ldyB5KHQpKTticmVhaztjYXNlImRhc2hlZCI6U1tuXXx8KFNbbl09bmV3IHYodCkpO2JyZWFrO2Nhc2UiemlnemFnLWxpbmUiOlNbbl18fChTW25dPW5ldyB3KHQpKTticmVhaztjYXNlImhhY2h1cmUiOmRlZmF1bHQ6U1tuPSJoYWNodXJlIl18fChTW25dPW5ldyBoKHQpKX1yZXR1cm4gU1tuXX0odCxfKS5maWxsUG9seWdvbihlLHQpfWZ1bmN0aW9uIFcoZSl7cmV0dXJuIGUucmFuZG9taXplcnx8KGUucmFuZG9taXplcj1uZXcgRS5hKGUuc2VlZHx8MCkpLGUucmFuZG9taXplci5uZXh0KCl9ZnVuY3Rpb24gVShlLHQsbixyKXtyZXR1cm4gdm9pZCAwPT09ciYmKHI9MSksbi5yb3VnaG5lc3MqciooVyhuKSoodC1lKStlKX1mdW5jdGlvbiBWKGUsdCxuKXtyZXR1cm4gdm9pZCAwPT09biYmKG49MSksVSgtZSxlLHQsbil9ZnVuY3Rpb24gSyhlLHQsbixyLG8sYSl7dm9pZCAwPT09YSYmKGE9ITEpO3ZhciBpPWE/by5kaXNhYmxlTXVsdGlTdHJva2VGaWxsOm8uZGlzYWJsZU11bHRpU3Ryb2tlLHM9WihlLHQsbixyLG8sITAsITEpO2lmKGkpcmV0dXJuIHM7dmFyIGw9WihlLHQsbixyLG8sITAsITApO3JldHVybiBzLmNvbmNhdChsKX1mdW5jdGlvbiBaKGUsdCxuLHIsbyxhLGkpe3ZhciBzPU1hdGgucG93KGUtbiwyKStNYXRoLnBvdyh0LXIsMiksbD1NYXRoLnNxcnQocyksYz0xO2M9bDwyMDA/MTpsPjUwMD8uNDotLjAwMTY2NjgqbCsxLjIzMzMzNDt2YXIgdT1vLm1heFJhbmRvbW5lc3NPZmZzZXR8fDA7dSp1KjEwMD5zJiYodT1sLzEwKTt2YXIgZD11LzIscD0uMisuMipXKG8pLGg9by5ib3dpbmcqby5tYXhSYW5kb21uZXNzT2Zmc2V0KihyLXQpLzIwMCxmPW8uYm93aW5nKm8ubWF4UmFuZG9tbmVzc09mZnNldCooZS1uKS8yMDA7aD1WKGgsbyxjKSxmPVYoZixvLGMpO3ZhciBtPVtdLGc9ZnVuY3Rpb24oKXtyZXR1cm4gVihkLG8sYyl9LGI9ZnVuY3Rpb24oKXtyZXR1cm4gVih1LG8sYyl9O3JldHVybiBhJiYoaT9tLnB1c2goe29wOiJtb3ZlIixkYXRhOltlK2coKSx0K2coKV19KTptLnB1c2goe29wOiJtb3ZlIixkYXRhOltlK1YodSxvLGMpLHQrVih1LG8sYyldfSkpLGk/bS5wdXNoKHtvcDoiYmN1cnZlVG8iLGRhdGE6W2grZSsobi1lKSpwK2coKSxmK3QrKHItdCkqcCtnKCksaCtlKzIqKG4tZSkqcCtnKCksZit0KzIqKHItdCkqcCtnKCksbitnKCkscitnKCldfSk6bS5wdXNoKHtvcDoiYmN1cnZlVG8iLGRhdGE6W2grZSsobi1lKSpwK2IoKSxmK3QrKHItdCkqcCtiKCksaCtlKzIqKG4tZSkqcCtiKCksZit0KzIqKHItdCkqcCtiKCksbitiKCkscitiKCldfSksbX1mdW5jdGlvbiBxKGUsdCxuKXt2YXIgcj1bXTtyLnB1c2goW2VbMF1bMF0rVih0LG4pLGVbMF1bMV0rVih0LG4pXSksci5wdXNoKFtlWzBdWzBdK1YodCxuKSxlWzBdWzFdK1YodCxuKV0pO2Zvcih2YXIgbz0xO288ZS5sZW5ndGg7bysrKXIucHVzaChbZVtvXVswXStWKHQsbiksZVtvXVsxXStWKHQsbildKSxvPT09ZS5sZW5ndGgtMSYmci5wdXNoKFtlW29dWzBdK1YodCxuKSxlW29dWzFdK1YodCxuKV0pO3JldHVybiBZKHIsbnVsbCxuKX1mdW5jdGlvbiBZKGUsdCxuKXt2YXIgcj1lLmxlbmd0aCxvPVtdO2lmKHI+Myl7dmFyIGE9W10saT0xLW4uY3VydmVUaWdodG5lc3M7by5wdXNoKHtvcDoibW92ZSIsZGF0YTpbZVsxXVswXSxlWzFdWzFdXX0pO2Zvcih2YXIgcz0xO3MrMjxyO3MrKyl7dmFyIGw9ZVtzXTthWzBdPVtsWzBdLGxbMV1dLGFbMV09W2xbMF0rKGkqZVtzKzFdWzBdLWkqZVtzLTFdWzBdKS82LGxbMV0rKGkqZVtzKzFdWzFdLWkqZVtzLTFdWzFdKS82XSxhWzJdPVtlW3MrMV1bMF0rKGkqZVtzXVswXS1pKmVbcysyXVswXSkvNixlW3MrMV1bMV0rKGkqZVtzXVsxXS1pKmVbcysyXVsxXSkvNl0sYVszXT1bZVtzKzFdWzBdLGVbcysxXVsxXV0sby5wdXNoKHtvcDoiYmN1cnZlVG8iLGRhdGE6W2FbMV1bMF0sYVsxXVsxXSxhWzJdWzBdLGFbMl1bMV0sYVszXVswXSxhWzNdWzFdXX0pfWlmKHQmJjI9PT10Lmxlbmd0aCl7dmFyIGM9bi5tYXhSYW5kb21uZXNzT2Zmc2V0O28ucHVzaCh7b3A6ImxpbmVUbyIsZGF0YTpbdFswXStWKGMsbiksdFsxXStWKGMsbildfSl9fWVsc2UgMz09PXI/KG8ucHVzaCh7b3A6Im1vdmUiLGRhdGE6W2VbMV1bMF0sZVsxXVsxXV19KSxvLnB1c2goe29wOiJiY3VydmVUbyIsZGF0YTpbZVsxXVswXSxlWzFdWzFdLGVbMl1bMF0sZVsyXVsxXSxlWzJdWzBdLGVbMl1bMV1dfSkpOjI9PT1yJiZvLnB1c2guYXBwbHkobyxLKGVbMF1bMF0sZVswXVsxXSxlWzFdWzBdLGVbMV1bMV0sbikpO3JldHVybiBvfWZ1bmN0aW9uIFgoZSx0LG4scixvLGEsaSxzKXt2YXIgbD1bXSxjPVtdLHU9ViguNSxzKS1NYXRoLlBJLzI7Yy5wdXNoKFtWKGEscykrdCsuOSpyKk1hdGguY29zKHUtZSksVihhLHMpK24rLjkqbypNYXRoLnNpbih1LWUpXSk7Zm9yKHZhciBkPXU7ZDwyKk1hdGguUEkrdS0uMDE7ZCs9ZSl7dmFyIHA9W1YoYSxzKSt0K3IqTWF0aC5jb3MoZCksVihhLHMpK24rbypNYXRoLnNpbihkKV07bC5wdXNoKHApLGMucHVzaChwKX1yZXR1cm4gYy5wdXNoKFtWKGEscykrdCtyKk1hdGguY29zKHUrMipNYXRoLlBJKy41KmkpLFYoYSxzKStuK28qTWF0aC5zaW4odSsyKk1hdGguUEkrLjUqaSldKSxjLnB1c2goW1YoYSxzKSt0Ky45OCpyKk1hdGguY29zKHUraSksVihhLHMpK24rLjk4Km8qTWF0aC5zaW4odStpKV0pLGMucHVzaChbVihhLHMpK3QrLjkqcipNYXRoLmNvcyh1Ky41KmkpLFYoYSxzKStuKy45Km8qTWF0aC5zaW4odSsuNSppKV0pLFtjLGxdfWZ1bmN0aW9uIEooZSx0LG4scixvLGEsaSxzLGwpe3ZhciBjPWErViguMSxsKSx1PVtdO3UucHVzaChbVihzLGwpK3QrLjkqcipNYXRoLmNvcyhjLWUpLFYocyxsKStuKy45Km8qTWF0aC5zaW4oYy1lKV0pO2Zvcih2YXIgZD1jO2Q8PWk7ZCs9ZSl1LnB1c2goW1YocyxsKSt0K3IqTWF0aC5jb3MoZCksVihzLGwpK24rbypNYXRoLnNpbihkKV0pO3JldHVybiB1LnB1c2goW3QrcipNYXRoLmNvcyhpKSxuK28qTWF0aC5zaW4oaSldKSx1LnB1c2goW3QrcipNYXRoLmNvcyhpKSxuK28qTWF0aC5zaW4oaSldKSxZKHUsbnVsbCxsKX1mdW5jdGlvbiAkKGUpe3JldHVyblsuLi5lXX12YXIgUT1uKDI0KTt2YXIgZWU9Im5vbmUiLHRlPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlKXt0aGlzLmRlZmF1bHRPcHRpb25zPXttYXhSYW5kb21uZXNzT2Zmc2V0OjIscm91Z2huZXNzOjEsYm93aW5nOjEsc3Ryb2tlOiIjMDAwIixzdHJva2VXaWR0aDoxLGN1cnZlVGlnaHRuZXNzOjAsY3VydmVGaXR0aW5nOi45NSxjdXJ2ZVN0ZXBDb3VudDo5LGZpbGxTdHlsZToiaGFjaHVyZSIsZmlsbFdlaWdodDotMSxoYWNodXJlQW5nbGU6LTQxLGhhY2h1cmVHYXA6LTEsZGFzaE9mZnNldDotMSxkYXNoR2FwOi0xLHppZ3phZ09mZnNldDotMSxzZWVkOjAsY29tYmluZU5lc3RlZFN2Z1BhdGhzOiExLGRpc2FibGVNdWx0aVN0cm9rZTohMSxkaXNhYmxlTXVsdGlTdHJva2VGaWxsOiExfSx0aGlzLmNvbmZpZz1lfHx7fSx0aGlzLmNvbmZpZy5vcHRpb25zJiYodGhpcy5kZWZhdWx0T3B0aW9ucz10aGlzLl9vKHRoaXMuY29uZmlnLm9wdGlvbnMpKX1yZXR1cm4gZS5uZXdTZWVkPWZ1bmN0aW9uKCl7cmV0dXJuIE9iamVjdChFLmIpKCl9LGUucHJvdG90eXBlLl9vPWZ1bmN0aW9uKGUpe3JldHVybiBlP09iamVjdC5hc3NpZ24oe30sdGhpcy5kZWZhdWx0T3B0aW9ucyxlKTp0aGlzLmRlZmF1bHRPcHRpb25zfSxlLnByb3RvdHlwZS5fZD1mdW5jdGlvbihlLHQsbil7cmV0dXJue3NoYXBlOmUsc2V0czp0fHxbXSxvcHRpb25zOm58fHRoaXMuZGVmYXVsdE9wdGlvbnN9fSxlLnByb3RvdHlwZS5saW5lPWZ1bmN0aW9uKGUsdCxuLHIsbyl7dmFyIGE9dGhpcy5fbyhvKTtyZXR1cm4gdGhpcy5fZCgibGluZSIsW3ooZSx0LG4scixhKV0sYSl9LGUucHJvdG90eXBlLnJlY3RhbmdsZT1mdW5jdGlvbihlLHQsbixyLG8pe3ZhciBhPXRoaXMuX28obyksaT1bXSxzPUkoZSx0LG4scixhKTtpZihhLmZpbGwpe3ZhciBsPVtbZSx0XSxbZStuLHRdLFtlK24sdCtyXSxbZSx0K3JdXTsic29saWQiPT09YS5maWxsU3R5bGU/aS5wdXNoKEgobCxhKSk6aS5wdXNoKEcobCxhKSl9cmV0dXJuIGEuc3Ryb2tlIT09ZWUmJmkucHVzaChzKSx0aGlzLl9kKCJyZWN0YW5nbGUiLGksYSl9LGUucHJvdG90eXBlLmVsbGlwc2U9ZnVuY3Rpb24oZSx0LG4scixvKXt2YXIgYT10aGlzLl9vKG8pLGk9W10scz1OKG4scixhKSxsPUYoZSx0LGEscyk7aWYoYS5maWxsKWlmKCJzb2xpZCI9PT1hLmZpbGxTdHlsZSl7dmFyIGM9RihlLHQsYSxzKS5vcHNldDtjLnR5cGU9ImZpbGxQYXRoIixpLnB1c2goYyl9ZWxzZSBpLnB1c2goRyhsLmVzdGltYXRlZFBvaW50cyxhKSk7cmV0dXJuIGEuc3Ryb2tlIT09ZWUmJmkucHVzaChsLm9wc2V0KSx0aGlzLl9kKCJlbGxpcHNlIixpLGEpfSxlLnByb3RvdHlwZS5jaXJjbGU9ZnVuY3Rpb24oZSx0LG4scil7dmFyIG89dGhpcy5lbGxpcHNlKGUsdCxuLG4scik7cmV0dXJuIG8uc2hhcGU9ImNpcmNsZSIsb30sZS5wcm90b3R5cGUubGluZWFyUGF0aD1mdW5jdGlvbihlLHQpe3ZhciBuPXRoaXMuX28odCk7cmV0dXJuIHRoaXMuX2QoImxpbmVhclBhdGgiLFtMKGUsITEsbildLG4pfSxlLnByb3RvdHlwZS5hcmM9ZnVuY3Rpb24oZSx0LG4scixvLGEsaSxzKXt2b2lkIDA9PT1pJiYoaT0hMSk7dmFyIGw9dGhpcy5fbyhzKSxjPVtdLHU9UihlLHQsbixyLG8sYSxpLCEwLGwpO2lmKGkmJmwuZmlsbClpZigic29saWQiPT09bC5maWxsU3R5bGUpe3ZhciBkPVIoZSx0LG4scixvLGEsITAsITEsbCk7ZC50eXBlPSJmaWxsUGF0aCIsYy5wdXNoKGQpfWVsc2UgYy5wdXNoKGZ1bmN0aW9uKGUsdCxuLHIsbyxhLGkpe3ZhciBzPWUsbD10LGM9TWF0aC5hYnMobi8yKSx1PU1hdGguYWJzKHIvMik7Yys9ViguMDEqYyxpKSx1Kz1WKC4wMSp1LGkpO2Zvcih2YXIgZD1vLHA9YTtkPDA7KWQrPTIqTWF0aC5QSSxwKz0yKk1hdGguUEk7cC1kPjIqTWF0aC5QSSYmKGQ9MCxwPTIqTWF0aC5QSSk7Zm9yKHZhciBoPShwLWQpL2kuY3VydmVTdGVwQ291bnQsZj1bXSxtPWQ7bTw9cDttKz1oKWYucHVzaChbcytjKk1hdGguY29zKG0pLGwrdSpNYXRoLnNpbihtKV0pO3JldHVybiBmLnB1c2goW3MrYypNYXRoLmNvcyhwKSxsK3UqTWF0aC5zaW4ocCldKSxmLnB1c2goW3MsbF0pLEcoZixpKX0oZSx0LG4scixvLGEsbCkpO3JldHVybiBsLnN0cm9rZSE9PWVlJiZjLnB1c2godSksdGhpcy5fZCgiYXJjIixjLGwpfSxlLnByb3RvdHlwZS5jdXJ2ZT1mdW5jdGlvbihlLHQpe3ZhciBuPXRoaXMuX28odCkscj1bXSxvPUQoZSxuKTtpZihuLmZpbGwmJm4uZmlsbCE9PWVlJiZlLmxlbmd0aD49Myl7dmFyIGE9ZnVuY3Rpb24oZSx0PTApe2NvbnN0IG49ZS5sZW5ndGg7aWYobjwzKXRocm93IG5ldyBFcnJvcigiQSBjdXJ2ZSBtdXN0IGhhdmUgYXQgbGVhc3QgdGhyZWUgcG9pbnRzLiIpO2NvbnN0IHI9W107aWYoMz09PW4pci5wdXNoKCQoZVswXSksJChlWzFdKSwkKGVbMl0pLCQoZVsyXSkpO2Vsc2V7Y29uc3Qgbj1bXTtuLnB1c2goZVswXSxlWzBdKTtmb3IobGV0IHQ9MTt0PGUubGVuZ3RoO3QrKyluLnB1c2goZVt0XSksdD09PWUubGVuZ3RoLTEmJm4ucHVzaChlW3RdKTtjb25zdCBvPVtdLGE9MS10O3IucHVzaCgkKG5bMF0pKTtmb3IobGV0IGU9MTtlKzI8bi5sZW5ndGg7ZSsrKXtjb25zdCB0PW5bZV07b1swXT1bdFswXSx0WzFdXSxvWzFdPVt0WzBdKyhhKm5bZSsxXVswXS1hKm5bZS0xXVswXSkvNix0WzFdKyhhKm5bZSsxXVsxXS1hKm5bZS0xXVsxXSkvNl0sb1syXT1bbltlKzFdWzBdKyhhKm5bZV1bMF0tYSpuW2UrMl1bMF0pLzYsbltlKzFdWzFdKyhhKm5bZV1bMV0tYSpuW2UrMl1bMV0pLzZdLG9bM109W25bZSsxXVswXSxuW2UrMV1bMV1dLHIucHVzaChvWzFdLG9bMl0sb1szXSl9fXJldHVybiByfShlKSxpPU9iamVjdChRLmEpKGEsMTAsKDErbi5yb3VnaG5lc3MpLzIpOyJzb2xpZCI9PT1uLmZpbGxTdHlsZT9yLnB1c2goSChpLG4pKTpyLnB1c2goRyhpLG4pKX1yZXR1cm4gbi5zdHJva2UhPT1lZSYmci5wdXNoKG8pLHRoaXMuX2QoImN1cnZlIixyLG4pfSxlLnByb3RvdHlwZS5wb2x5Z29uPWZ1bmN0aW9uKGUsdCl7dmFyIG49dGhpcy5fbyh0KSxyPVtdLG89TChlLCEwLG4pO3JldHVybiBuLmZpbGwmJigic29saWQiPT09bi5maWxsU3R5bGU/ci5wdXNoKEgoZSxuKSk6ci5wdXNoKEcoZSxuKSkpLG4uc3Ryb2tlIT09ZWUmJnIucHVzaChvKSx0aGlzLl9kKCJwb2x5Z29uIixyLG4pfSxlLnByb3RvdHlwZS5wYXRoPWZ1bmN0aW9uKGUsdCl7dmFyIG49dGhpcy5fbyh0KSxyPVtdO2lmKCFlKXJldHVybiB0aGlzLl9kKCJwYXRoIixyLG4pO2U9KGV8fCIiKS5yZXBsYWNlKC9cbi9nLCIgIikucmVwbGFjZSgvKC1ccykvZywiLSIpLnJlcGxhY2UoIi8oc3MpL2ciLCIgIik7dmFyIG89bi5maWxsJiYidHJhbnNwYXJlbnQiIT09bi5maWxsJiZuLmZpbGwhPT1lZSxhPW4uc3Ryb2tlIT09ZWUsaT0hIShuLnNpbXBsaWZpY2F0aW9uJiZuLnNpbXBsaWZpY2F0aW9uPDEpLHM9ZnVuY3Rpb24oZSx0LG4pe2NvbnN0IHI9VChqKHgoZSkpKSxvPVtdO2xldCBhPVtdLGk9WzAsMF0scz1bXTtjb25zdCBsPSgpPT57cy5sZW5ndGg+PTQmJmEucHVzaCguLi5PYmplY3QoUS5hKShzLHQpKSxzPVtdfSxjPSgpPT57bCgpLGEubGVuZ3RoJiYoby5wdXNoKGEpLGE9W10pfTtmb3IoY29uc3R7a2V5OmUsZGF0YTp0fW9mIHIpc3dpdGNoKGUpe2Nhc2UiTSI6YygpLGk9W3RbMF0sdFsxXV0sYS5wdXNoKGkpO2JyZWFrO2Nhc2UiTCI6bCgpLGEucHVzaChbdFswXSx0WzFdXSk7YnJlYWs7Y2FzZSJDIjppZighcy5sZW5ndGgpe2NvbnN0IGU9YS5sZW5ndGg/YVthLmxlbmd0aC0xXTppO3MucHVzaChbZVswXSxlWzFdXSl9cy5wdXNoKFt0WzBdLHRbMV1dKSxzLnB1c2goW3RbMl0sdFszXV0pLHMucHVzaChbdFs0XSx0WzVdXSk7YnJlYWs7Y2FzZSJaIjpsKCksYS5wdXNoKFtpWzBdLGlbMV1dKX1pZihjKCksIW4pcmV0dXJuIG87Y29uc3QgdT1bXTtmb3IoY29uc3QgZSBvZiBvKXtjb25zdCB0PU9iamVjdChRLmIpKGUsbik7dC5sZW5ndGgmJnUucHVzaCh0KX1yZXR1cm4gdX0oZSwxLGk/NC00Km4uc2ltcGxpZmljYXRpb246KDErbi5yb3VnaG5lc3MpLzIpO2lmKG8paWYobi5jb21iaW5lTmVzdGVkU3ZnUGF0aHMpe3ZhciBsPVtdO3MuZm9yRWFjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIGwucHVzaC5hcHBseShsLGUpfSkpLCJzb2xpZCI9PT1uLmZpbGxTdHlsZT9yLnB1c2goSChsLG4pKTpyLnB1c2goRyhsLG4pKX1lbHNlIHMuZm9yRWFjaCgoZnVuY3Rpb24oZSl7InNvbGlkIj09PW4uZmlsbFN0eWxlP3IucHVzaChIKGUsbikpOnIucHVzaChHKGUsbikpfSkpO3JldHVybiBhJiYoaT9zLmZvckVhY2goKGZ1bmN0aW9uKGUpe3IucHVzaChMKGUsITEsbikpfSkpOnIucHVzaChCKGUsbikpKSx0aGlzLl9kKCJwYXRoIixyLG4pfSxlLnByb3RvdHlwZS5vcHNUb1BhdGg9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PSIiLG49MCxyPWUub3BzO248ci5sZW5ndGg7bisrKXt2YXIgbz1yW25dLGE9by5kYXRhO3N3aXRjaChvLm9wKXtjYXNlIm1vdmUiOnQrPSJNIi5jb25jYXQoYVswXSwiICIpLmNvbmNhdChhWzFdLCIgIik7YnJlYWs7Y2FzZSJiY3VydmVUbyI6dCs9IkMiLmNvbmNhdChhWzBdLCIgIikuY29uY2F0KGFbMV0sIiwgIikuY29uY2F0KGFbMl0sIiAiKS5jb25jYXQoYVszXSwiLCAiKS5jb25jYXQoYVs0XSwiICIpLmNvbmNhdChhWzVdLCIgIik7YnJlYWs7Y2FzZSJsaW5lVG8iOnQrPSJMIi5jb25jYXQoYVswXSwiICIpLmNvbmNhdChhWzFdLCIgIil9fXJldHVybiB0LnRyaW0oKX0sZS5wcm90b3R5cGUudG9QYXRocz1mdW5jdGlvbihlKXtmb3IodmFyIHQ9ZS5zZXRzfHxbXSxuPWUub3B0aW9uc3x8dGhpcy5kZWZhdWx0T3B0aW9ucyxyPVtdLG89MCxhPXQ7bzxhLmxlbmd0aDtvKyspe3ZhciBpPWFbb10scz1udWxsO3N3aXRjaChpLnR5cGUpe2Nhc2UicGF0aCI6cz17ZDp0aGlzLm9wc1RvUGF0aChpKSxzdHJva2U6bi5zdHJva2Usc3Ryb2tlV2lkdGg6bi5zdHJva2VXaWR0aCxmaWxsOmVlfTticmVhaztjYXNlImZpbGxQYXRoIjpzPXtkOnRoaXMub3BzVG9QYXRoKGkpLHN0cm9rZTplZSxzdHJva2VXaWR0aDowLGZpbGw6bi5maWxsfHxlZX07YnJlYWs7Y2FzZSJmaWxsU2tldGNoIjpzPXRoaXMuZmlsbFNrZXRjaChpLG4pfXMmJnIucHVzaChzKX1yZXR1cm4gcn0sZS5wcm90b3R5cGUuZmlsbFNrZXRjaD1mdW5jdGlvbihlLHQpe3ZhciBuPXQuZmlsbFdlaWdodDtyZXR1cm4gbjwwJiYobj10LnN0cm9rZVdpZHRoLzIpLHtkOnRoaXMub3BzVG9QYXRoKGUpLHN0cm9rZTp0LmZpbGx8fGVlLHN0cm9rZVdpZHRoOm4sZmlsbDplZX19LGV9KCksbmU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUsdCl7dGhpcy5jYW52YXM9ZSx0aGlzLmN0eD10aGlzLmNhbnZhcy5nZXRDb250ZXh0KCIyZCIpLHRoaXMuZ2VuPW5ldyB0ZSh0KX1yZXR1cm4gZS5wcm90b3R5cGUuZHJhdz1mdW5jdGlvbihlKXtmb3IodmFyIHQ9ZS5zZXRzfHxbXSxuPWUub3B0aW9uc3x8dGhpcy5nZXREZWZhdWx0T3B0aW9ucygpLHI9dGhpcy5jdHgsbz0wLGE9dDtvPGEubGVuZ3RoO28rKyl7dmFyIGk9YVtvXTtzd2l0Y2goaS50eXBlKXtjYXNlInBhdGgiOnIuc2F2ZSgpLHIuc3Ryb2tlU3R5bGU9Im5vbmUiPT09bi5zdHJva2U/InRyYW5zcGFyZW50IjpuLnN0cm9rZSxyLmxpbmVXaWR0aD1uLnN0cm9rZVdpZHRoLG4uc3Ryb2tlTGluZURhc2gmJnIuc2V0TGluZURhc2gobi5zdHJva2VMaW5lRGFzaCksbi5zdHJva2VMaW5lRGFzaE9mZnNldCYmKHIubGluZURhc2hPZmZzZXQ9bi5zdHJva2VMaW5lRGFzaE9mZnNldCksdGhpcy5fZHJhd1RvQ29udGV4dChyLGkpLHIucmVzdG9yZSgpO2JyZWFrO2Nhc2UiZmlsbFBhdGgiOnIuc2F2ZSgpLHIuZmlsbFN0eWxlPW4uZmlsbHx8IiI7dmFyIHM9ImN1cnZlIj09PWUuc2hhcGV8fCJwb2x5Z29uIj09PWUuc2hhcGU/ImV2ZW5vZGQiOiJub256ZXJvIjt0aGlzLl9kcmF3VG9Db250ZXh0KHIsaSxzKSxyLnJlc3RvcmUoKTticmVhaztjYXNlImZpbGxTa2V0Y2giOnRoaXMuZmlsbFNrZXRjaChyLGksbil9fX0sZS5wcm90b3R5cGUuZmlsbFNrZXRjaD1mdW5jdGlvbihlLHQsbil7dmFyIHI9bi5maWxsV2VpZ2h0O3I8MCYmKHI9bi5zdHJva2VXaWR0aC8yKSxlLnNhdmUoKSxuLmZpbGxMaW5lRGFzaCYmZS5zZXRMaW5lRGFzaChuLmZpbGxMaW5lRGFzaCksbi5maWxsTGluZURhc2hPZmZzZXQmJihlLmxpbmVEYXNoT2Zmc2V0PW4uZmlsbExpbmVEYXNoT2Zmc2V0KSxlLnN0cm9rZVN0eWxlPW4uZmlsbHx8IiIsZS5saW5lV2lkdGg9cix0aGlzLl9kcmF3VG9Db250ZXh0KGUsdCksZS5yZXN0b3JlKCl9LGUucHJvdG90eXBlLl9kcmF3VG9Db250ZXh0PWZ1bmN0aW9uKGUsdCxuKXt2b2lkIDA9PT1uJiYobj0ibm9uemVybyIpLGUuYmVnaW5QYXRoKCk7Zm9yKHZhciByPTAsbz10Lm9wcztyPG8ubGVuZ3RoO3IrKyl7dmFyIGE9b1tyXSxpPWEuZGF0YTtzd2l0Y2goYS5vcCl7Y2FzZSJtb3ZlIjplLm1vdmVUbyhpWzBdLGlbMV0pO2JyZWFrO2Nhc2UiYmN1cnZlVG8iOmUuYmV6aWVyQ3VydmVUbyhpWzBdLGlbMV0saVsyXSxpWzNdLGlbNF0saVs1XSk7YnJlYWs7Y2FzZSJsaW5lVG8iOmUubGluZVRvKGlbMF0saVsxXSl9fSJmaWxsUGF0aCI9PT10LnR5cGU/ZS5maWxsKG4pOmUuc3Ryb2tlKCl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLnByb3RvdHlwZSwiZ2VuZXJhdG9yIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2VufSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pLGUucHJvdG90eXBlLmdldERlZmF1bHRPcHRpb25zPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2VuLmRlZmF1bHRPcHRpb25zfSxlLnByb3RvdHlwZS5saW5lPWZ1bmN0aW9uKGUsdCxuLHIsbyl7dmFyIGE9dGhpcy5nZW4ubGluZShlLHQsbixyLG8pO3JldHVybiB0aGlzLmRyYXcoYSksYX0sZS5wcm90b3R5cGUucmVjdGFuZ2xlPWZ1bmN0aW9uKGUsdCxuLHIsbyl7dmFyIGE9dGhpcy5nZW4ucmVjdGFuZ2xlKGUsdCxuLHIsbyk7cmV0dXJuIHRoaXMuZHJhdyhhKSxhfSxlLnByb3RvdHlwZS5lbGxpcHNlPWZ1bmN0aW9uKGUsdCxuLHIsbyl7dmFyIGE9dGhpcy5nZW4uZWxsaXBzZShlLHQsbixyLG8pO3JldHVybiB0aGlzLmRyYXcoYSksYX0sZS5wcm90b3R5cGUuY2lyY2xlPWZ1bmN0aW9uKGUsdCxuLHIpe3ZhciBvPXRoaXMuZ2VuLmNpcmNsZShlLHQsbixyKTtyZXR1cm4gdGhpcy5kcmF3KG8pLG99LGUucHJvdG90eXBlLmxpbmVhclBhdGg9ZnVuY3Rpb24oZSx0KXt2YXIgbj10aGlzLmdlbi5saW5lYXJQYXRoKGUsdCk7cmV0dXJuIHRoaXMuZHJhdyhuKSxufSxlLnByb3RvdHlwZS5wb2x5Z29uPWZ1bmN0aW9uKGUsdCl7dmFyIG49dGhpcy5nZW4ucG9seWdvbihlLHQpO3JldHVybiB0aGlzLmRyYXcobiksbn0sZS5wcm90b3R5cGUuYXJjPWZ1bmN0aW9uKGUsdCxuLHIsbyxhLGkscyl7dm9pZCAwPT09aSYmKGk9ITEpO3ZhciBsPXRoaXMuZ2VuLmFyYyhlLHQsbixyLG8sYSxpLHMpO3JldHVybiB0aGlzLmRyYXcobCksbH0sZS5wcm90b3R5cGUuY3VydmU9ZnVuY3Rpb24oZSx0KXt2YXIgbj10aGlzLmdlbi5jdXJ2ZShlLHQpO3JldHVybiB0aGlzLmRyYXcobiksbn0sZS5wcm90b3R5cGUucGF0aD1mdW5jdGlvbihlLHQpe3ZhciBuPXRoaXMuZ2VuLnBhdGgoZSx0KTtyZXR1cm4gdGhpcy5kcmF3KG4pLG59LGV9KCkscmU9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIixvZT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSx0KXt0aGlzLnN2Zz1lLHRoaXMuZ2VuPW5ldyB0ZSh0KX1yZXR1cm4gZS5wcm90b3R5cGUuZHJhdz1mdW5jdGlvbihlKXtmb3IodmFyIHQ9ZS5zZXRzfHxbXSxuPWUub3B0aW9uc3x8dGhpcy5nZXREZWZhdWx0T3B0aW9ucygpLHI9dGhpcy5zdmcub3duZXJEb2N1bWVudHx8d2luZG93LmRvY3VtZW50LG89ci5jcmVhdGVFbGVtZW50TlMocmUsImciKSxhPTAsaT10O2E8aS5sZW5ndGg7YSsrKXt2YXIgcz1pW2FdLGw9bnVsbDtzd2l0Y2gocy50eXBlKXtjYXNlInBhdGgiOihsPXIuY3JlYXRlRWxlbWVudE5TKHJlLCJwYXRoIikpLnNldEF0dHJpYnV0ZSgiZCIsdGhpcy5vcHNUb1BhdGgocykpLGwuc2V0QXR0cmlidXRlKCJzdHJva2UiLG4uc3Ryb2tlKSxsLnNldEF0dHJpYnV0ZSgic3Ryb2tlLXdpZHRoIixuLnN0cm9rZVdpZHRoKyIiKSxsLnNldEF0dHJpYnV0ZSgiZmlsbCIsIm5vbmUiKSxuLnN0cm9rZUxpbmVEYXNoJiZsLnNldEF0dHJpYnV0ZSgic3Ryb2tlLWRhc2hhcnJheSIsbi5zdHJva2VMaW5lRGFzaC5qb2luKCIgIikudHJpbSgpKSxuLnN0cm9rZUxpbmVEYXNoT2Zmc2V0JiZsLnNldEF0dHJpYnV0ZSgic3Ryb2tlLWRhc2hvZmZzZXQiLCIiLmNvbmNhdChuLnN0cm9rZUxpbmVEYXNoT2Zmc2V0KSk7YnJlYWs7Y2FzZSJmaWxsUGF0aCI6KGw9ci5jcmVhdGVFbGVtZW50TlMocmUsInBhdGgiKSkuc2V0QXR0cmlidXRlKCJkIix0aGlzLm9wc1RvUGF0aChzKSksbC5zZXRBdHRyaWJ1dGUoInN0cm9rZSIsIm5vbmUiKSxsLnNldEF0dHJpYnV0ZSgic3Ryb2tlLXdpZHRoIiwiMCIpLGwuc2V0QXR0cmlidXRlKCJmaWxsIixuLmZpbGx8fCIiKSwiY3VydmUiIT09ZS5zaGFwZSYmInBvbHlnb24iIT09ZS5zaGFwZXx8bC5zZXRBdHRyaWJ1dGUoImZpbGwtcnVsZSIsImV2ZW5vZGQiKTticmVhaztjYXNlImZpbGxTa2V0Y2giOmw9dGhpcy5maWxsU2tldGNoKHIscyxuKX1sJiZvLmFwcGVuZENoaWxkKGwpfXJldHVybiBvfSxlLnByb3RvdHlwZS5maWxsU2tldGNoPWZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1uLmZpbGxXZWlnaHQ7cjwwJiYocj1uLnN0cm9rZVdpZHRoLzIpO3ZhciBvPWUuY3JlYXRlRWxlbWVudE5TKHJlLCJwYXRoIik7cmV0dXJuIG8uc2V0QXR0cmlidXRlKCJkIix0aGlzLm9wc1RvUGF0aCh0KSksby5zZXRBdHRyaWJ1dGUoInN0cm9rZSIsbi5maWxsfHwiIiksby5zZXRBdHRyaWJ1dGUoInN0cm9rZS13aWR0aCIscisiIiksby5zZXRBdHRyaWJ1dGUoImZpbGwiLCJub25lIiksbi5maWxsTGluZURhc2gmJm8uc2V0QXR0cmlidXRlKCJzdHJva2UtZGFzaGFycmF5IixuLmZpbGxMaW5lRGFzaC5qb2luKCIgIikudHJpbSgpKSxuLmZpbGxMaW5lRGFzaE9mZnNldCYmby5zZXRBdHRyaWJ1dGUoInN0cm9rZS1kYXNob2Zmc2V0IiwiIi5jb25jYXQobi5maWxsTGluZURhc2hPZmZzZXQpKSxvfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZS5wcm90b3R5cGUsImdlbmVyYXRvciIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdlbn0sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KSxlLnByb3RvdHlwZS5nZXREZWZhdWx0T3B0aW9ucz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmdlbi5kZWZhdWx0T3B0aW9uc30sZS5wcm90b3R5cGUub3BzVG9QYXRoPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmdlbi5vcHNUb1BhdGgoZSl9LGUucHJvdG90eXBlLmxpbmU9ZnVuY3Rpb24oZSx0LG4scixvKXt2YXIgYT10aGlzLmdlbi5saW5lKGUsdCxuLHIsbyk7cmV0dXJuIHRoaXMuZHJhdyhhKX0sZS5wcm90b3R5cGUucmVjdGFuZ2xlPWZ1bmN0aW9uKGUsdCxuLHIsbyl7dmFyIGE9dGhpcy5nZW4ucmVjdGFuZ2xlKGUsdCxuLHIsbyk7cmV0dXJuIHRoaXMuZHJhdyhhKX0sZS5wcm90b3R5cGUuZWxsaXBzZT1mdW5jdGlvbihlLHQsbixyLG8pe3ZhciBhPXRoaXMuZ2VuLmVsbGlwc2UoZSx0LG4scixvKTtyZXR1cm4gdGhpcy5kcmF3KGEpfSxlLnByb3RvdHlwZS5jaXJjbGU9ZnVuY3Rpb24oZSx0LG4scil7dmFyIG89dGhpcy5nZW4uY2lyY2xlKGUsdCxuLHIpO3JldHVybiB0aGlzLmRyYXcobyl9LGUucHJvdG90eXBlLmxpbmVhclBhdGg9ZnVuY3Rpb24oZSx0KXt2YXIgbj10aGlzLmdlbi5saW5lYXJQYXRoKGUsdCk7cmV0dXJuIHRoaXMuZHJhdyhuKX0sZS5wcm90b3R5cGUucG9seWdvbj1mdW5jdGlvbihlLHQpe3ZhciBuPXRoaXMuZ2VuLnBvbHlnb24oZSx0KTtyZXR1cm4gdGhpcy5kcmF3KG4pfSxlLnByb3RvdHlwZS5hcmM9ZnVuY3Rpb24oZSx0LG4scixvLGEsaSxzKXt2b2lkIDA9PT1pJiYoaT0hMSk7dmFyIGw9dGhpcy5nZW4uYXJjKGUsdCxuLHIsbyxhLGkscyk7cmV0dXJuIHRoaXMuZHJhdyhsKX0sZS5wcm90b3R5cGUuY3VydmU9ZnVuY3Rpb24oZSx0KXt2YXIgbj10aGlzLmdlbi5jdXJ2ZShlLHQpO3JldHVybiB0aGlzLmRyYXcobil9LGUucHJvdG90eXBlLnBhdGg9ZnVuY3Rpb24oZSx0KXt2YXIgbj10aGlzLmdlbi5wYXRoKGUsdCk7cmV0dXJuIHRoaXMuZHJhdyhuKX0sZX0oKTt0LmE9e2NhbnZhczpmdW5jdGlvbihlLHQpe3JldHVybiBuZXcgbmUoZSx0KX0sc3ZnOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIG5ldyBvZShlLHQpfSxnZW5lcmF0b3I6ZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyB0ZShlKX0sbmV3U2VlZDpmdW5jdGlvbigpe3JldHVybiB0ZS5uZXdTZWVkKCl9fX0sZnVuY3Rpb24oZSx0LG4peyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiByKGUsdCl7cmV0dXJuIE1hdGgucG93KGVbMF0tdFswXSwyKStNYXRoLnBvdyhlWzFdLXRbMV0sMil9ZnVuY3Rpb24gbyhlLHQsbil7Y29uc3Qgbz1yKHQsbik7aWYoMD09PW8pcmV0dXJuIHIoZSx0KTtsZXQgaT0oKGVbMF0tdFswXSkqKG5bMF0tdFswXSkrKGVbMV0tdFsxXSkqKG5bMV0tdFsxXSkpL287cmV0dXJuIGk9TWF0aC5tYXgoMCxNYXRoLm1pbigxLGkpKSxyKGUsYSh0LG4saSkpfWZ1bmN0aW9uIGEoZSx0LG4pe3JldHVybltlWzBdKyh0WzBdLWVbMF0pKm4sZVsxXSsodFsxXS1lWzFdKSpuXX1mdW5jdGlvbiBpKGUsdCxuLG8pe2NvbnN0IHM9b3x8W107aWYoZnVuY3Rpb24oZSx0KXtjb25zdCBuPWVbdCswXSxyPWVbdCsxXSxvPWVbdCsyXSxhPWVbdCszXTtsZXQgaT0zKnJbMF0tMipuWzBdLWFbMF07aSo9aTtsZXQgcz0zKnJbMV0tMipuWzFdLWFbMV07cyo9cztsZXQgbD0zKm9bMF0tMiphWzBdLW5bMF07bCo9bDtsZXQgYz0zKm9bMV0tMiphWzFdLW5bMV07cmV0dXJuIGMqPWMsaTxsJiYoaT1sKSxzPGMmJihzPWMpLGkrc30oZSx0KTxuKXtjb25zdCBuPWVbdCswXTtpZihzLmxlbmd0aCl7KGw9c1tzLmxlbmd0aC0xXSxjPW4sTWF0aC5zcXJ0KHIobCxjKSkpPjEmJnMucHVzaChuKX1lbHNlIHMucHVzaChuKTtzLnB1c2goZVt0KzNdKX1lbHNle2NvbnN0IHI9LjUsbz1lW3QrMF0sbD1lW3QrMV0sYz1lW3QrMl0sdT1lW3QrM10sZD1hKG8sbCxyKSxwPWEobCxjLHIpLGg9YShjLHUsciksZj1hKGQscCxyKSxtPWEocCxoLHIpLGc9YShmLG0scik7aShbbyxkLGYsZ10sMCxuLHMpLGkoW2csbSxoLHVdLDAsbixzKX12YXIgbCxjO3JldHVybiBzfWZ1bmN0aW9uIHMoZSx0KXtyZXR1cm4gbChlLDAsZS5sZW5ndGgsdCl9ZnVuY3Rpb24gbChlLHQsbixyLGEpe2NvbnN0IGk9YXx8W10scz1lW3RdLGM9ZVtuLTFdO2xldCB1PTAsZD0xO2ZvcihsZXQgcj10KzE7cjxuLTE7KytyKXtjb25zdCB0PW8oZVtyXSxzLGMpO3Q+dSYmKHU9dCxkPXIpfXJldHVybiBNYXRoLnNxcnQodSk+cj8obChlLHQsZCsxLHIsaSksbChlLGQsbixyLGkpKTooaS5sZW5ndGh8fGkucHVzaChzKSxpLnB1c2goYykpLGl9ZnVuY3Rpb24gYyhlLHQ9LjE1LG4pe2NvbnN0IHI9W10sbz0oZS5sZW5ndGgtMSkvMztmb3IobGV0IG49MDtuPG87bisrKXtpKGUsMypuLHQscil9cmV0dXJuIG4mJm4+MD9sKHIsMCxyLmxlbmd0aCxuKTpyfW4uZCh0LCJiIiwoZnVuY3Rpb24oKXtyZXR1cm4gc30pKSxuLmQodCwiYSIsKGZ1bmN0aW9uKCl7cmV0dXJuIGN9KSl9LGZ1bmN0aW9uKGUsdCxuKXsidXNlIHN0cmljdCI7bi5kKHQsImEiLChmdW5jdGlvbigpe3JldHVybiBofSkpLG4uZCh0LCJiIiwoZnVuY3Rpb24oKXtyZXR1cm4gZn0pKSxuLmQodCwiYyIsKGZ1bmN0aW9uKCl7cmV0dXJuIG19KSk7dmFyIHI9bigyMyksbz1uKDcpLGE9big0KSxpPW4oMTApLHM9bigzOCksbD1uKDIpLGM9bigzNSksdT1uKDEpLGQ9bigzKSxwPWZ1bmN0aW9uKCl7Zm9yKHZhciBlPTAsdD0wLG49YXJndW1lbnRzLmxlbmd0aDt0PG47dCsrKWUrPWFyZ3VtZW50c1t0XS5sZW5ndGg7dmFyIHI9QXJyYXkoZSksbz0wO2Zvcih0PTA7dDxuO3QrKylmb3IodmFyIGE9YXJndW1lbnRzW3RdLGk9MCxzPWEubGVuZ3RoO2k8cztpKyssbysrKXJbb109YVtpXTtyZXR1cm4gcn0saD0iXHgzYyEtLSBzdmctc291cmNlOmV4Y2FsaWRyYXcgLS1ceDNlIixmPWZ1bmN0aW9uKGUsdCxuLG8pe3ZhciBhPW4uZXhwb3J0QmFja2dyb3VuZCx1PW4uZXhwb3J0UGFkZGluZyxkPXZvaWQgMD09PXU/MTA6dSxoPW4udmlld0JhY2tncm91bmRDb2xvcixmPW4uc2NhbGUsbT12b2lkIDA9PT1mPzE6ZixiPW4uc2hvdWxkQWRkV2F0ZXJtYXJrO3ZvaWQgMD09PW8mJihvPWZ1bmN0aW9uKGUsdCl7dmFyIG49ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiY2FudmFzIik7cmV0dXJuIG4ud2lkdGg9ZSptLG4uaGVpZ2h0PXQqbSxufSk7dmFyIHk9ZTtpZihiKXt2YXIgdj1PYmplY3QoaS5jKShlKSxrPXZbMl0sdz12WzNdO3k9cCh5LFtnKGssdyldKX12YXIgUz1PYmplY3QoaS5jKSh5KSxFPVNbMF0sTz1TWzFdLEM9U1syXSx4PVNbM10saj1vKE9iamVjdChsLmUpKEUsQykrMipkLE9iamVjdChsLmUpKE8seCkrZCsoYj8wOmQpKTtyZXR1cm4gT2JqZWN0KHMuYSkoeSx0LG51bGwsbSxyLmEuY2FudmFzKGopLGose3ZpZXdCYWNrZ3JvdW5kQ29sb3I6YT9oOm51bGwsc2Nyb2xsWDpPYmplY3QoYy5iKSgtRStkKSxzY3JvbGxZOk9iamVjdChjLmIpKC1PK2QpLHpvb206MSxyZW1vdGVQb2ludGVyVmlld3BvcnRDb29yZHM6e30scmVtb3RlU2VsZWN0ZWRFbGVtZW50SWRzOnt9LHNob3VsZENhY2hlSWdub3JlWm9vbTohMSxyZW1vdGVQb2ludGVyVXNlcm5hbWVzOnt9fSx7cmVuZGVyU2Nyb2xsYmFyczohMSxyZW5kZXJTZWxlY3Rpb246ITEscmVuZGVyT3B0aW1pemF0aW9uczohMSxyZW5kZXJHcmlkOiExfSksan0sbT1mdW5jdGlvbihlLHQpe3ZhciBuPXQuZXhwb3J0QmFja2dyb3VuZCxvPXQuZXhwb3J0UGFkZGluZyxhPXZvaWQgMD09PW8/MTA6byxjPXQudmlld0JhY2tncm91bmRDb2xvcix1PXQuc2hvdWxkQWRkV2F0ZXJtYXJrLGQ9ZTtpZih1KXt2YXIgZj1PYmplY3QoaS5jKShlKSxtPWZbMl0sYj1mWzNdO2Q9cChkLFtnKG0sYildKX12YXIgeT1PYmplY3QoaS5jKShkKSx2PXlbMF0saz15WzFdLHc9eVsyXSxTPXlbM10sRT1PYmplY3QobC5lKSh2LHcpKzIqYSxPPU9iamVjdChsLmUpKGssUykrYSsodT8wOmEpLEM9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKGwuYSwic3ZnIik7aWYoQy5zZXRBdHRyaWJ1dGUoInZlcnNpb24iLCIxLjEiKSxDLnNldEF0dHJpYnV0ZSgieG1sbnMiLGwuYSksQy5zZXRBdHRyaWJ1dGUoInZpZXdCb3giLCIwIDAgIi5jb25jYXQoRSwiICIpLmNvbmNhdChPKSksQy5pbm5lckhUTUw9IlxuICAiLmNvbmNhdChoLCdcbiAgPGRlZnM+XG4gICAgPHN0eWxlPlxuICAgICAgQGZvbnQtZmFjZSB7XG4gICAgICAgIGZvbnQtZmFtaWx5OiAiVmlyZ2lsIjtcbiAgICAgICAgc3JjOiB1cmwoImh0dHBzOi8vZXhjYWxpZHJhdy5jb20vRkdfVmlyZ2lsLndvZmYyIik7XG4gICAgICB9XG4gICAgICBAZm9udC1mYWNlIHtcbiAgICAgICAgZm9udC1mYW1pbHk6ICJDYXNjYWRpYSI7XG4gICAgICAgIHNyYzogdXJsKCJodHRwczovL2V4Y2FsaWRyYXcuY29tL0Nhc2NhZGlhLndvZmYyIik7XG4gICAgICB9XG4gICAgPC9zdHlsZT5cbiAgPC9kZWZzPlxuICAnKSxuJiZjKXt2YXIgeD1DLm93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKGwuYSwicmVjdCIpO3guc2V0QXR0cmlidXRlKCJ4IiwiMCIpLHguc2V0QXR0cmlidXRlKCJ5IiwiMCIpLHguc2V0QXR0cmlidXRlKCJ3aWR0aCIsIiIuY29uY2F0KEUpKSx4LnNldEF0dHJpYnV0ZSgiaGVpZ2h0IiwiIi5jb25jYXQoTykpLHguc2V0QXR0cmlidXRlKCJmaWxsIixjKSxDLmFwcGVuZENoaWxkKHgpfXZhciBqPXIuYS5zdmcoQyk7cmV0dXJuIE9iamVjdChzLmIpKGQsaixDLHtvZmZzZXRYOi12K2Esb2Zmc2V0WTotaythfSksQ30sZz1mdW5jdGlvbihlLHQpe3JldHVybiBPYmplY3QoYS5EKSh7dGV4dDpPYmplY3QodS5lKSgibGFiZWxzLm1hZGVXaXRoRXhjYWxpZHJhdyIpLGZvbnRTaXplOjE2LGZvbnRGYW1pbHk6ZC5lLHRleHRBbGlnbjoicmlnaHQiLHZlcnRpY2FsQWxpZ246ZC5oLHg6ZSx5OnQrMTYsc3Ryb2tlQ29sb3I6by5ncmF5WzVdLGJhY2tncm91bmRDb2xvcjoidHJhbnNwYXJlbnQiLGZpbGxTdHlsZToiaGFjaHVyZSIsc3Ryb2tlV2lkdGg6MSxzdHJva2VTdHlsZToic29saWQiLHJvdWdobmVzczoxLG9wYWNpdHk6MTAwfSl9fSxmdW5jdGlvbihlLG4pe2UuZXhwb3J0cz10fSxmdW5jdGlvbihlLHQsbil7KGZ1bmN0aW9uKHIpe3QubG9nPWZ1bmN0aW9uKC4uLmUpe3JldHVybiJvYmplY3QiPT10eXBlb2YgY29uc29sZSYmY29uc29sZS5sb2cmJmNvbnNvbGUubG9nKC4uLmUpfSx0LmZvcm1hdEFyZ3M9ZnVuY3Rpb24odCl7aWYodFswXT0odGhpcy51c2VDb2xvcnM/IiVjIjoiIikrdGhpcy5uYW1lc3BhY2UrKHRoaXMudXNlQ29sb3JzPyIgJWMiOiIgIikrdFswXSsodGhpcy51c2VDb2xvcnM/IiVjICI6IiAiKSsiKyIrZS5leHBvcnRzLmh1bWFuaXplKHRoaXMuZGlmZiksIXRoaXMudXNlQ29sb3JzKXJldHVybjtjb25zdCBuPSJjb2xvcjogIit0aGlzLmNvbG9yO3Quc3BsaWNlKDEsMCxuLCJjb2xvcjogaW5oZXJpdCIpO2xldCByPTAsbz0wO3RbMF0ucmVwbGFjZSgvJVthLXpBLVolXS9nLGU9PnsiJSUiIT09ZSYmKHIrKywiJWMiPT09ZSYmKG89cikpfSksdC5zcGxpY2UobywwLG4pfSx0LnNhdmU9ZnVuY3Rpb24oZSl7dHJ5e2U/dC5zdG9yYWdlLnNldEl0ZW0oImRlYnVnIixlKTp0LnN0b3JhZ2UucmVtb3ZlSXRlbSgiZGVidWciKX1jYXRjaChlKXt9fSx0LmxvYWQ9ZnVuY3Rpb24oKXtsZXQgZTt0cnl7ZT10LnN0b3JhZ2UuZ2V0SXRlbSgiZGVidWciKX1jYXRjaChlKXt9IWUmJnZvaWQgMCE9PXImJiJlbnYiaW4gciYmKGU9ci5lbnYuREVCVUcpO3JldHVybiBlfSx0LnVzZUNvbG9ycz1mdW5jdGlvbigpe2lmKCJ1bmRlZmluZWQiIT10eXBlb2Ygd2luZG93JiZ3aW5kb3cucHJvY2VzcyYmKCJyZW5kZXJlciI9PT13aW5kb3cucHJvY2Vzcy50eXBlfHx3aW5kb3cucHJvY2Vzcy5fX253anMpKXJldHVybiEwO2lmKCJ1bmRlZmluZWQiIT10eXBlb2YgbmF2aWdhdG9yJiZuYXZpZ2F0b3IudXNlckFnZW50JiZuYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCkubWF0Y2goLyhlZGdlfHRyaWRlbnQpXC8oXGQrKS8pKXJldHVybiExO3JldHVybiJ1bmRlZmluZWQiIT10eXBlb2YgZG9jdW1lbnQmJmRvY3VtZW50LmRvY3VtZW50RWxlbWVudCYmZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlJiZkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuV2Via2l0QXBwZWFyYW5jZXx8InVuZGVmaW5lZCIhPXR5cGVvZiB3aW5kb3cmJndpbmRvdy5jb25zb2xlJiYod2luZG93LmNvbnNvbGUuZmlyZWJ1Z3x8d2luZG93LmNvbnNvbGUuZXhjZXB0aW9uJiZ3aW5kb3cuY29uc29sZS50YWJsZSl8fCJ1bmRlZmluZWQiIT10eXBlb2YgbmF2aWdhdG9yJiZuYXZpZ2F0b3IudXNlckFnZW50JiZuYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCkubWF0Y2goL2ZpcmVmb3hcLyhcZCspLykmJnBhcnNlSW50KFJlZ0V4cC4kMSwxMCk+PTMxfHwidW5kZWZpbmVkIiE9dHlwZW9mIG5hdmlnYXRvciYmbmF2aWdhdG9yLnVzZXJBZ2VudCYmbmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpLm1hdGNoKC9hcHBsZXdlYmtpdFwvKFxkKykvKX0sdC5zdG9yYWdlPWZ1bmN0aW9uKCl7dHJ5e3JldHVybiBsb2NhbFN0b3JhZ2V9Y2F0Y2goZSl7fX0oKSx0LmNvbG9ycz1bIiMwMDAwQ0MiLCIjMDAwMEZGIiwiIzAwMzNDQyIsIiMwMDMzRkYiLCIjMDA2NkNDIiwiIzAwNjZGRiIsIiMwMDk5Q0MiLCIjMDA5OUZGIiwiIzAwQ0MwMCIsIiMwMENDMzMiLCIjMDBDQzY2IiwiIzAwQ0M5OSIsIiMwMENDQ0MiLCIjMDBDQ0ZGIiwiIzMzMDBDQyIsIiMzMzAwRkYiLCIjMzMzM0NDIiwiIzMzMzNGRiIsIiMzMzY2Q0MiLCIjMzM2NkZGIiwiIzMzOTlDQyIsIiMzMzk5RkYiLCIjMzNDQzAwIiwiIzMzQ0MzMyIsIiMzM0NDNjYiLCIjMzNDQzk5IiwiIzMzQ0NDQyIsIiMzM0NDRkYiLCIjNjYwMENDIiwiIzY2MDBGRiIsIiM2NjMzQ0MiLCIjNjYzM0ZGIiwiIzY2Q0MwMCIsIiM2NkNDMzMiLCIjOTkwMENDIiwiIzk5MDBGRiIsIiM5OTMzQ0MiLCIjOTkzM0ZGIiwiIzk5Q0MwMCIsIiM5OUNDMzMiLCIjQ0MwMDAwIiwiI0NDMDAzMyIsIiNDQzAwNjYiLCIjQ0MwMDk5IiwiI0NDMDBDQyIsIiNDQzAwRkYiLCIjQ0MzMzAwIiwiI0NDMzMzMyIsIiNDQzMzNjYiLCIjQ0MzMzk5IiwiI0NDMzNDQyIsIiNDQzMzRkYiLCIjQ0M2NjAwIiwiI0NDNjYzMyIsIiNDQzk5MDAiLCIjQ0M5OTMzIiwiI0NDQ0MwMCIsIiNDQ0NDMzMiLCIjRkYwMDAwIiwiI0ZGMDAzMyIsIiNGRjAwNjYiLCIjRkYwMDk5IiwiI0ZGMDBDQyIsIiNGRjAwRkYiLCIjRkYzMzAwIiwiI0ZGMzMzMyIsIiNGRjMzNjYiLCIjRkYzMzk5IiwiI0ZGMzNDQyIsIiNGRjMzRkYiLCIjRkY2NjAwIiwiI0ZGNjYzMyIsIiNGRjk5MDAiLCIjRkY5OTMzIiwiI0ZGQ0MwMCIsIiNGRkNDMzMiXSxlLmV4cG9ydHM9bigxMTkpKHQpO2NvbnN0e2Zvcm1hdHRlcnM6b309ZS5leHBvcnRzO28uaj1mdW5jdGlvbihlKXt0cnl7cmV0dXJuIEpTT04uc3RyaW5naWZ5KGUpfWNhdGNoKGUpe3JldHVybiJbVW5leHBlY3RlZEpTT05QYXJzZUVycm9yXTogIitlLm1lc3NhZ2V9fX0pLmNhbGwodGhpcyxuKDQzKSl9LGZ1bmN0aW9uKGUsdCxuKXsidXNlIHN0cmljdCI7bi5kKHQsImIiLChmdW5jdGlvbigpe3JldHVybiBvfSkpLG4uZCh0LCJlIiwoZnVuY3Rpb24oKXtyZXR1cm4gYX0pKSxuLmQodCwiYSIsKGZ1bmN0aW9uKCl7cmV0dXJuIGl9KSksbi5kKHQsImMiLChmdW5jdGlvbigpe3JldHVybiBzfSkpLG4uZCh0LCJkIiwoZnVuY3Rpb24oKXtyZXR1cm4gbH0pKTt2YXIgcj1uKDQpLG89ZnVuY3Rpb24oZSx0KXt2YXIgbj1PYmplY3Qoci5qKSh0KSxvPW5bMF0sYT1uWzFdLGk9blsyXSxzPW5bM107cmV0dXJuIGUuZmlsdGVyKChmdW5jdGlvbihlKXt2YXIgdD1PYmplY3Qoci5rKShlKSxuPXRbMF0sbD10WzFdLGM9dFsyXSx1PXRbM107cmV0dXJuInNlbGVjdGlvbiIhPT1lLnR5cGUmJm88PW4mJmE8PWwmJmk+PWMmJnM+PXV9KSl9LGE9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZS5zb21lKChmdW5jdGlvbihlKXtyZXR1cm4gdC5zZWxlY3RlZEVsZW1lbnRJZHNbZS5pZF19KSl9LGk9ZnVuY3Rpb24oZSx0LG4pe3ZhciByPUFycmF5LmZyb20obmV3IFNldChzKGUsdCkubWFwKChmdW5jdGlvbihlKXtyZXR1cm4gbihlKX0pKSkpO3JldHVybiAxPT09ci5sZW5ndGg/clswXTpudWxsfSxzPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUuZmlsdGVyKChmdW5jdGlvbihlKXtyZXR1cm4gdC5zZWxlY3RlZEVsZW1lbnRJZHNbZS5pZF19KSl9LGw9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdC5lZGl0aW5nRWxlbWVudD9bdC5lZGl0aW5nRWxlbWVudF06cyhlLHQpfX0sZnVuY3Rpb24oZSx0LG4peyJ1c2Ugc3RyaWN0IjtuLmQodCwiZSIsKGZ1bmN0aW9uKCl7cmV0dXJuIGR9KSksbi5kKHQsImMiLChmdW5jdGlvbigpe3JldHVybiBwfSkpLG4uZCh0LCJiIiwoZnVuY3Rpb24oKXtyZXR1cm4gaH0pKSxuLmQodCwiZCIsKGZ1bmN0aW9uKCl7cmV0dXJuIGZ9KSksbi5kKHQsImEiLChmdW5jdGlvbigpe3JldHVybiBtfSkpO3ZhciByPW4oMTcpLG89bigzMiksYT1uKDM2KSxpPW4oMTUpLHM9big0MiksbD1mdW5jdGlvbihlLHQpe3ZhciBuLHIsbyxhLGk9e2xhYmVsOjAsc2VudDpmdW5jdGlvbigpe2lmKDEmb1swXSl0aHJvdyBvWzFdO3JldHVybiBvWzFdfSx0cnlzOltdLG9wczpbXX07cmV0dXJuIGE9e25leHQ6cygwKSx0aHJvdzpzKDEpLHJldHVybjpzKDIpfSwiZnVuY3Rpb24iPT10eXBlb2YgU3ltYm9sJiYoYVtTeW1ib2wuaXRlcmF0b3JdPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9KSxhO2Z1bmN0aW9uIHMoYSl7cmV0dXJuIGZ1bmN0aW9uKHMpe3JldHVybiBmdW5jdGlvbihhKXtpZihuKXRocm93IG5ldyBUeXBlRXJyb3IoIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy4iKTtmb3IoO2k7KXRyeXtpZihuPTEsciYmKG89MiZhWzBdP3IucmV0dXJuOmFbMF0/ci50aHJvd3x8KChvPXIucmV0dXJuKSYmby5jYWxsKHIpLDApOnIubmV4dCkmJiEobz1vLmNhbGwocixhWzFdKSkuZG9uZSlyZXR1cm4gbztzd2l0Y2gocj0wLG8mJihhPVsyJmFbMF0sby52YWx1ZV0pLGFbMF0pe2Nhc2UgMDpjYXNlIDE6bz1hO2JyZWFrO2Nhc2UgNDpyZXR1cm4gaS5sYWJlbCsrLHt2YWx1ZTphWzFdLGRvbmU6ITF9O2Nhc2UgNTppLmxhYmVsKysscj1hWzFdLGE9WzBdO2NvbnRpbnVlO2Nhc2UgNzphPWkub3BzLnBvcCgpLGkudHJ5cy5wb3AoKTtjb250aW51ZTtkZWZhdWx0OmlmKCEobz1pLnRyeXMsKG89by5sZW5ndGg+MCYmb1tvLmxlbmd0aC0xXSl8fDYhPT1hWzBdJiYyIT09YVswXSkpe2k9MDtjb250aW51ZX1pZigzPT09YVswXSYmKCFvfHxhWzFdPm9bMF0mJmFbMV08b1szXSkpe2kubGFiZWw9YVsxXTticmVha31pZig2PT09YVswXSYmaS5sYWJlbDxvWzFdKXtpLmxhYmVsPW9bMV0sbz1hO2JyZWFrfWlmKG8mJmkubGFiZWw8b1syXSl7aS5sYWJlbD1vWzJdLGkub3BzLnB1c2goYSk7YnJlYWt9b1syXSYmaS5vcHMucG9wKCksaS50cnlzLnBvcCgpO2NvbnRpbnVlfWE9dC5jYWxsKGUsaSl9Y2F0Y2goZSl7YT1bNixlXSxyPTB9ZmluYWxseXtuPW89MH1pZig1JmFbMF0pdGhyb3cgYVsxXTtyZXR1cm57dmFsdWU6YVswXT9hWzFdOnZvaWQgMCxkb25lOiEwfX0oW2Esc10pfX19O2Z1bmN0aW9uIGMoZSx0LG4scixvLGEsaSl7dHJ5e3ZhciBzPWVbYV0oaSksbD1zLnZhbHVlfWNhdGNoKGUpe3JldHVybiB2b2lkIG4oZSl9cy5kb25lP3QobCk6UHJvbWlzZS5yZXNvbHZlKGwpLnRoZW4ocixvKX1mdW5jdGlvbiB1KGUpe3JldHVybiBmdW5jdGlvbigpe3ZhciB0PXRoaXMsbj1hcmd1bWVudHM7cmV0dXJuIG5ldyBQcm9taXNlKChmdW5jdGlvbihyLG8pe3ZhciBhPWUuYXBwbHkodCxuKTtmdW5jdGlvbiBpKGUpe2MoYSxyLG8saSxzLCJuZXh0IixlKX1mdW5jdGlvbiBzKGUpe2MoYSxyLG8saSxzLCJ0aHJvdyIsZSl9aSh2b2lkIDApfSkpfX12YXIgZD1mdW5jdGlvbihlLHQpe3JldHVybiBKU09OLnN0cmluZ2lmeSh7dHlwZToiZXhjYWxpZHJhdyIsdmVyc2lvbjoyLHNvdXJjZTp3aW5kb3cubG9jYXRpb24ub3JpZ2luLGVsZW1lbnRzOmUuZmlsdGVyKChmdW5jdGlvbihlKXtyZXR1cm4hZS5pc0RlbGV0ZWR9KSksYXBwU3RhdGU6T2JqZWN0KHIuYSkodCl9LG51bGwsMil9LHA9ZnVuY3Rpb24oKXt2YXIgZT11KChmdW5jdGlvbihlLHQsbil7dmFyIHIsYSxpLHM7cmV0dXJuIGwodGhpcywoZnVuY3Rpb24obCl7c3dpdGNoKGwubGFiZWwpe2Nhc2UgMDpyZXR1cm4gcj1kKGUsdCksYT1uZXcgQmxvYihbcl0se3R5cGU6ImFwcGxpY2F0aW9uL2pzb24ifSksaT0iIi5jb25jYXQodC5uYW1lLCIuZXhjYWxpZHJhdyIpLHM9d2luZG93LFs0LE9iamVjdChvLmIpKGEse2ZpbGVOYW1lOmksZGVzY3JpcHRpb246IkV4Y2FsaWRyYXcgZmlsZSIsZXh0ZW5zaW9uczpbImV4Y2FsaWRyYXciXX0sbnx8bnVsbCldO2Nhc2UgMTpyZXR1cm4gcy5oYW5kbGU9bC5zZW50KCksWzJdfX0pKX0pKTtyZXR1cm4gZnVuY3Rpb24odCxuLHIpe3JldHVybiBlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX19KCksaD1mdW5jdGlvbigpe3ZhciBlPXUoKGZ1bmN0aW9uKGUpe3ZhciB0O3JldHVybiBsKHRoaXMsKGZ1bmN0aW9uKG4pe3N3aXRjaChuLmxhYmVsKXtjYXNlIDA6cmV0dXJuWzQsT2JqZWN0KG8uYSkoe2Rlc2NyaXB0aW9uOiJFeGNhbGlkcmF3IGZpbGVzIixleHRlbnNpb25zOlsianNvbiIsImV4Y2FsaWRyYXciXSxtaW1lVHlwZXM6WyJhcHBsaWNhdGlvbi9qc29uIl19KV07Y2FzZSAxOnJldHVybiB0PW4uc2VudCgpLFsyLE9iamVjdChhLmEpKHQsZSldfX0pKX0pKTtyZXR1cm4gZnVuY3Rpb24odCl7cmV0dXJuIGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfX0oKSxmPWZ1bmN0aW9uKCl7dmFyIGU9dSgoZnVuY3Rpb24oKXt2YXIgZSx0LG47cmV0dXJuIGwodGhpcywoZnVuY3Rpb24ocil7c3dpdGNoKHIubGFiZWwpe2Nhc2UgMDpyZXR1cm5bNCxPYmplY3QoaS5hKSgpXTtjYXNlIDE6cmV0dXJuIGU9ci5zZW50KCksdD1KU09OLnN0cmluZ2lmeSh7dHlwZToiZXhjYWxpZHJhd2xpYiIsdmVyc2lvbjoxLGxpYnJhcnk6ZX0sbnVsbCwyKSwibGlicmFyeS5leGNhbGlkcmF3bGliIixuPW5ldyBCbG9iKFt0XSx7dHlwZToiYXBwbGljYXRpb24vdm5kLmV4Y2FsaWRyYXdsaWIranNvbiJ9KSxbNCxPYmplY3Qoby5iKShuLHtmaWxlTmFtZToibGlicmFyeS5leGNhbGlkcmF3bGliIixkZXNjcmlwdGlvbjoiRXhjYWxpZHJhdyBsaWJyYXJ5IGZpbGUiLGV4dGVuc2lvbnM6WyJleGNhbGlkcmF3bGliIl19KV07Y2FzZSAyOnJldHVybiByLnNlbnQoKSxbMl19fSkpfSkpO3JldHVybiBmdW5jdGlvbigpe3JldHVybiBlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX19KCksbT1mdW5jdGlvbigpe3ZhciBlPXUoKGZ1bmN0aW9uKCl7dmFyIGU7cmV0dXJuIGwodGhpcywoZnVuY3Rpb24odCl7c3dpdGNoKHQubGFiZWwpe2Nhc2UgMDpyZXR1cm5bNCxPYmplY3Qoby5hKSh7ZGVzY3JpcHRpb246IkV4Y2FsaWRyYXcgbGlicmFyeSBmaWxlcyIsZXh0ZW5zaW9uczpbImpzb24iLCJleGNhbGlkcmF3bGliIl0sbWltZVR5cGVzOlsiYXBwbGljYXRpb24vanNvbiJdfSldO2Nhc2UgMTpyZXR1cm4gZT10LnNlbnQoKSxzLmEuaW1wb3J0TGlicmFyeShlKSxbMl19fSkpfSkpO3JldHVybiBmdW5jdGlvbigpe3JldHVybiBlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX19KCl9LGZ1bmN0aW9uKGUsdCxuKXsidXNlIHN0cmljdCI7bi5kKHQsImEiLChmdW5jdGlvbigpe3JldHVybiByfSkpLG4uZCh0LCJiIiwoZnVuY3Rpb24oKXtyZXR1cm4gb30pKTt2YXIgcj1mdW5jdGlvbihlKXt2YXIgdD1lLm1hcCgoZnVuY3Rpb24oZSl7cmV0dXJuIGVbMF19KSksbj1lLm1hcCgoZnVuY3Rpb24oZSl7cmV0dXJuIGVbMV19KSk7cmV0dXJue3dpZHRoOk1hdGgubWF4LmFwcGx5KE1hdGgsdCktTWF0aC5taW4uYXBwbHkoTWF0aCx0KSxoZWlnaHQ6TWF0aC5tYXguYXBwbHkoTWF0aCxuKS1NYXRoLm1pbi5hcHBseShNYXRoLG4pfX0sbz1mdW5jdGlvbihlLHQsbil7dmFyIHI9bi5tYXAoKGZ1bmN0aW9uKHQpe3JldHVybiB0W2VdfSkpLG89TWF0aC5tYXguYXBwbHkoTWF0aCxyKSxhPU1hdGgubWluLmFwcGx5KE1hdGgsciksaT1vLWEscz0wPT09aT8xOnQvaSxsPTEvMCxjPW4ubWFwKChmdW5jdGlvbih0KXtyZXR1cm4gdC5tYXAoKGZ1bmN0aW9uKHQsbil7aWYobiE9PWUpcmV0dXJuIHQ7dmFyIHI9dCpzO3JldHVybiBsPU1hdGgubWluKHIsbCkscn0pKX0pKTtpZigyPT09Yy5sZW5ndGgpcmV0dXJuIGM7dmFyIHU9YS1sO3JldHVybiBjLm1hcCgoZnVuY3Rpb24odCl7cmV0dXJuIHQubWFwKChmdW5jdGlvbih0LG4pe3JldHVybiBuPT09ZT90K3U6dH0pKX0pKX19LGZ1bmN0aW9uKGUsdCxuKXsidXNlIHN0cmljdCI7bi5kKHQsImEiLChmdW5jdGlvbigpe3JldHVybiBkfSkpO3ZhciByPW4oNCksbz1uKDIwKSxhPW4oMyk7ZnVuY3Rpb24gaShlLHQpe3ZhciBuPU9iamVjdC5rZXlzKGUpO2lmKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpe3ZhciByPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7dCYmKHI9ci5maWx0ZXIoKGZ1bmN0aW9uKHQpe3JldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGUsdCkuZW51bWVyYWJsZX0pKSksbi5wdXNoLmFwcGx5KG4scil9cmV0dXJuIG59ZnVuY3Rpb24gcyhlKXtmb3IodmFyIHQ9MTt0PGFyZ3VtZW50cy5sZW5ndGg7dCsrKXt2YXIgbj1udWxsIT1hcmd1bWVudHNbdF0/YXJndW1lbnRzW3RdOnt9O3QlMj9pKE9iamVjdChuKSwhMCkuZm9yRWFjaCgoZnVuY3Rpb24odCl7bChlLHQsblt0XSl9KSk6T2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnM/T2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZSxPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhuKSk6aShPYmplY3QobikpLmZvckVhY2goKGZ1bmN0aW9uKHQpe09iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHQsT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihuLHQpKX0pKX1yZXR1cm4gZX1mdW5jdGlvbiBsKGUsdCxuKXtyZXR1cm4gdCBpbiBlP09iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHQse3ZhbHVlOm4sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITAsd3JpdGFibGU6ITB9KTplW3RdPW4sZX1mdW5jdGlvbiBjKGUsdCl7dmFyIG4sYSxpLGwsYyx1PXt0eXBlOmUudHlwZSx2ZXJzaW9uOmUudmVyc2lvbnx8MSx2ZXJzaW9uTm9uY2U6bnVsbCE9PShuPWUudmVyc2lvbk5vbmNlKSYmdm9pZCAwIT09bj9uOjAsaXNEZWxldGVkOm51bGwhPT0oYT1lLmlzRGVsZXRlZCkmJnZvaWQgMCE9PWEmJmEsaWQ6ZS5pZHx8T2JqZWN0KG8uYSkoKSxmaWxsU3R5bGU6ZS5maWxsU3R5bGV8fCJoYWNodXJlIixzdHJva2VXaWR0aDplLnN0cm9rZVdpZHRofHwxLHN0cm9rZVN0eWxlOm51bGwhPT0oaT1lLnN0cm9rZVN0eWxlKSYmdm9pZCAwIT09aT9pOiJzb2xpZCIscm91Z2huZXNzOm51bGwhPT0obD1lLnJvdWdobmVzcykmJnZvaWQgMCE9PWw/bDoxLG9wYWNpdHk6bnVsbD09ZS5vcGFjaXR5PzEwMDplLm9wYWNpdHksYW5nbGU6ZS5hbmdsZXx8MCx4OmUueHx8MCx5OmUueXx8MCxzdHJva2VDb2xvcjplLnN0cm9rZUNvbG9yLGJhY2tncm91bmRDb2xvcjplLmJhY2tncm91bmRDb2xvcix3aWR0aDplLndpZHRofHwwLGhlaWdodDplLmhlaWdodHx8MCxzZWVkOm51bGwhPT0oYz1lLnNlZWQpJiZ2b2lkIDAhPT1jP2M6MSxncm91cElkczplLmdyb3VwSWRzfHxbXX07cmV0dXJuIHMocyhzKHt9LHUpLE9iamVjdChyLm8pKHUpKSx0KX12YXIgdT1mdW5jdGlvbihlKXt2YXIgdDtzd2l0Y2goZS50eXBlKXtjYXNlInRleHQiOnZhciBuPWUuZm9udFNpemUscj1lLmZvbnRGYW1pbHk7aWYoImZvbnQiaW4gZSl7dmFyIG89ZS5mb250LnNwbGl0KCIgIiksaT1vWzBdLHM9b1sxXTtuPXBhcnNlSW50KGksMTApLHI9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PTAsbj1PYmplY3QuZW50cmllcyhhLm4pO3Q8bi5sZW5ndGg7dCsrKXt2YXIgcj1uW3RdLG89clswXTtpZihyWzFdLmluY2x1ZGVzKGUpKXJldHVybiBwYXJzZUludChvKX1yZXR1cm4gYS5lfShzKX1yZXR1cm4gYyhlLHtmb250U2l6ZTpuLGZvbnRGYW1pbHk6cix0ZXh0Om51bGwhPT0odD1lLnRleHQpJiZ2b2lkIDAhPT10P3Q6IiIsYmFzZWxpbmU6ZS5iYXNlbGluZSx0ZXh0QWxpZ246ZS50ZXh0QWxpZ258fGEuZyx2ZXJ0aWNhbEFsaWduOmUudmVydGljYWxBbGlnbnx8YS5ofSk7Y2FzZSJkcmF3IjpjYXNlImxpbmUiOmNhc2UiYXJyb3ciOnJldHVybiBjKGUse3BvaW50czohQXJyYXkuaXNBcnJheShlLnBvaW50cyl8fGUucG9pbnRzLmxlbmd0aDwyP1tbMCwwXSxbZS53aWR0aCxlLmhlaWdodF1dOmUucG9pbnRzLGxhc3RDb21taXR0ZWRQb2ludDpudWxsfSk7Y2FzZSJlbGxpcHNlIjpjYXNlInJlY3RhbmdsZSI6Y2FzZSJkaWFtb25kIjpyZXR1cm4gYyhlLHt9KX19LGQ9ZnVuY3Rpb24oZSx0KXtyZXR1cm57ZWxlbWVudHM6ZS5yZWR1Y2UoKGZ1bmN0aW9uKGUsdCl7aWYoInNlbGVjdGlvbiIhPT10LnR5cGUmJiFPYmplY3Qoci55KSh0KSl7dmFyIG49dSh0KTtuJiZlLnB1c2gobil9cmV0dXJuIGV9KSxbXSksYXBwU3RhdGU6dH19fSxmdW5jdGlvbihlLHQsbil7InVzZSBzdHJpY3QiO24uZCh0LCJhIiwoZnVuY3Rpb24oKXtyZXR1cm4gbH0pKSxuLmQodCwiYiIsKGZ1bmN0aW9uKCl7cmV0dXJuIGZ9KSk7dmFyIHI9ImNob29zZUZpbGVTeXN0ZW1FbnRyaWVzImluIHNlbGY/ImNob29zZUZpbGVTeXN0ZW1FbnRyaWVzIjoic2hvd09wZW5GaWxlUGlja2VyImluIHNlbGYmJiJzaG93T3BlbkZpbGVQaWNrZXIiLG89ZnVuY3Rpb24oZSx0KXt2YXIgbixyLG8sYSxpPXtsYWJlbDowLHNlbnQ6ZnVuY3Rpb24oKXtpZigxJm9bMF0pdGhyb3cgb1sxXTtyZXR1cm4gb1sxXX0sdHJ5czpbXSxvcHM6W119O3JldHVybiBhPXtuZXh0OnMoMCksdGhyb3c6cygxKSxyZXR1cm46cygyKX0sImZ1bmN0aW9uIj09dHlwZW9mIFN5bWJvbCYmKGFbU3ltYm9sLml0ZXJhdG9yXT1mdW5jdGlvbigpe3JldHVybiB0aGlzfSksYTtmdW5jdGlvbiBzKGEpe3JldHVybiBmdW5jdGlvbihzKXtyZXR1cm4gZnVuY3Rpb24oYSl7aWYobil0aHJvdyBuZXcgVHlwZUVycm9yKCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuIik7Zm9yKDtpOyl0cnl7aWYobj0xLHImJihvPTImYVswXT9yLnJldHVybjphWzBdP3IudGhyb3d8fCgobz1yLnJldHVybikmJm8uY2FsbChyKSwwKTpyLm5leHQpJiYhKG89by5jYWxsKHIsYVsxXSkpLmRvbmUpcmV0dXJuIG87c3dpdGNoKHI9MCxvJiYoYT1bMiZhWzBdLG8udmFsdWVdKSxhWzBdKXtjYXNlIDA6Y2FzZSAxOm89YTticmVhaztjYXNlIDQ6cmV0dXJuIGkubGFiZWwrKyx7dmFsdWU6YVsxXSxkb25lOiExfTtjYXNlIDU6aS5sYWJlbCsrLHI9YVsxXSxhPVswXTtjb250aW51ZTtjYXNlIDc6YT1pLm9wcy5wb3AoKSxpLnRyeXMucG9wKCk7Y29udGludWU7ZGVmYXVsdDppZighKG89aS50cnlzLChvPW8ubGVuZ3RoPjAmJm9bby5sZW5ndGgtMV0pfHw2IT09YVswXSYmMiE9PWFbMF0pKXtpPTA7Y29udGludWV9aWYoMz09PWFbMF0mJighb3x8YVsxXT5vWzBdJiZhWzFdPG9bM10pKXtpLmxhYmVsPWFbMV07YnJlYWt9aWYoNj09PWFbMF0mJmkubGFiZWw8b1sxXSl7aS5sYWJlbD1vWzFdLG89YTticmVha31pZihvJiZpLmxhYmVsPG9bMl0pe2kubGFiZWw9b1syXSxpLm9wcy5wdXNoKGEpO2JyZWFrfW9bMl0mJmkub3BzLnBvcCgpLGkudHJ5cy5wb3AoKTtjb250aW51ZX1hPXQuY2FsbChlLGkpfWNhdGNoKGUpe2E9WzYsZV0scj0wfWZpbmFsbHl7bj1vPTB9aWYoNSZhWzBdKXRocm93IGFbMV07cmV0dXJue3ZhbHVlOmFbMF0/YVsxXTp2b2lkIDAsZG9uZTohMH19KFthLHNdKX19fTtmdW5jdGlvbiBhKGUsdCxuLHIsbyxhLGkpe3RyeXt2YXIgcz1lW2FdKGkpLGw9cy52YWx1ZX1jYXRjaChlKXtyZXR1cm4gdm9pZCBuKGUpfXMuZG9uZT90KGwpOlByb21pc2UucmVzb2x2ZShsKS50aGVuKHIsbyl9ZnVuY3Rpb24gaShlKXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgdD10aGlzLG49YXJndW1lbnRzO3JldHVybiBuZXcgUHJvbWlzZSgoZnVuY3Rpb24ocixvKXt2YXIgaT1lLmFwcGx5KHQsbik7ZnVuY3Rpb24gcyhlKXthKGkscixvLHMsbCwibmV4dCIsZSl9ZnVuY3Rpb24gbChlKXthKGkscixvLHMsbCwidGhyb3ciLGUpfXModm9pZCAwKX0pKX19dmFyIHM9cj8iY2hvb3NlRmlsZVN5c3RlbUVudHJpZXMiPT09cj9Qcm9taXNlLnJlc29sdmUoKS50aGVuKG4uYmluZChudWxsLDE0NykpOlByb21pc2UucmVzb2x2ZSgpLnRoZW4obi5iaW5kKG51bGwsMTQ4KSk6UHJvbWlzZS5yZXNvbHZlKCkudGhlbihuLmJpbmQobnVsbCwxNDkpKTtmdW5jdGlvbiBsKCl7cmV0dXJuIGMuYXBwbHkodGhpcyxhcmd1bWVudHMpfWZ1bmN0aW9uIGMoKXtyZXR1cm4oYz1pKChmdW5jdGlvbigpe3ZhciBlLHQsbj1bXTtmb3IoZT0wO2U8YXJndW1lbnRzLmxlbmd0aDtlKyspbltlXT1hcmd1bWVudHNbZV07cmV0dXJuIG8odGhpcywoZnVuY3Rpb24oZSl7c3dpdGNoKGUubGFiZWwpe2Nhc2UgMDpyZXR1cm5bNCxzXTtjYXNlIDE6cmV0dXJuWzIsKHQ9ZS5zZW50KCkpLmRlZmF1bHQuYXBwbHkodCxuKV19fSkpfSkpKS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9cj8iY2hvb3NlRmlsZVN5c3RlbUVudHJpZXMiPT09cj9Qcm9taXNlLnJlc29sdmUoKS50aGVuKG4uYmluZChudWxsLDE1MCkpOlByb21pc2UucmVzb2x2ZSgpLnRoZW4obi5iaW5kKG51bGwsMTUxKSk6UHJvbWlzZS5yZXNvbHZlKCkudGhlbihuLmJpbmQobnVsbCwxNTIpKTt2YXIgdT1mdW5jdGlvbihlLHQpe3ZhciBuLHIsbyxhLGk9e2xhYmVsOjAsc2VudDpmdW5jdGlvbigpe2lmKDEmb1swXSl0aHJvdyBvWzFdO3JldHVybiBvWzFdfSx0cnlzOltdLG9wczpbXX07cmV0dXJuIGE9e25leHQ6cygwKSx0aHJvdzpzKDEpLHJldHVybjpzKDIpfSwiZnVuY3Rpb24iPT10eXBlb2YgU3ltYm9sJiYoYVtTeW1ib2wuaXRlcmF0b3JdPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9KSxhO2Z1bmN0aW9uIHMoYSl7cmV0dXJuIGZ1bmN0aW9uKHMpe3JldHVybiBmdW5jdGlvbihhKXtpZihuKXRocm93IG5ldyBUeXBlRXJyb3IoIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy4iKTtmb3IoO2k7KXRyeXtpZihuPTEsciYmKG89MiZhWzBdP3IucmV0dXJuOmFbMF0/ci50aHJvd3x8KChvPXIucmV0dXJuKSYmby5jYWxsKHIpLDApOnIubmV4dCkmJiEobz1vLmNhbGwocixhWzFdKSkuZG9uZSlyZXR1cm4gbztzd2l0Y2gocj0wLG8mJihhPVsyJmFbMF0sby52YWx1ZV0pLGFbMF0pe2Nhc2UgMDpjYXNlIDE6bz1hO2JyZWFrO2Nhc2UgNDpyZXR1cm4gaS5sYWJlbCsrLHt2YWx1ZTphWzFdLGRvbmU6ITF9O2Nhc2UgNTppLmxhYmVsKysscj1hWzFdLGE9WzBdO2NvbnRpbnVlO2Nhc2UgNzphPWkub3BzLnBvcCgpLGkudHJ5cy5wb3AoKTtjb250aW51ZTtkZWZhdWx0OmlmKCEobz1pLnRyeXMsKG89by5sZW5ndGg+MCYmb1tvLmxlbmd0aC0xXSl8fDYhPT1hWzBdJiYyIT09YVswXSkpe2k9MDtjb250aW51ZX1pZigzPT09YVswXSYmKCFvfHxhWzFdPm9bMF0mJmFbMV08b1szXSkpe2kubGFiZWw9YVsxXTticmVha31pZig2PT09YVswXSYmaS5sYWJlbDxvWzFdKXtpLmxhYmVsPW9bMV0sbz1hO2JyZWFrfWlmKG8mJmkubGFiZWw8b1syXSl7aS5sYWJlbD1vWzJdLGkub3BzLnB1c2goYSk7YnJlYWt9b1syXSYmaS5vcHMucG9wKCksaS50cnlzLnBvcCgpO2NvbnRpbnVlfWE9dC5jYWxsKGUsaSl9Y2F0Y2goZSl7YT1bNixlXSxyPTB9ZmluYWxseXtuPW89MH1pZig1JmFbMF0pdGhyb3cgYVsxXTtyZXR1cm57dmFsdWU6YVswXT9hWzFdOnZvaWQgMCxkb25lOiEwfX0oW2Esc10pfX19O2Z1bmN0aW9uIGQoZSx0LG4scixvLGEsaSl7dHJ5e3ZhciBzPWVbYV0oaSksbD1zLnZhbHVlfWNhdGNoKGUpe3JldHVybiB2b2lkIG4oZSl9cy5kb25lP3QobCk6UHJvbWlzZS5yZXNvbHZlKGwpLnRoZW4ocixvKX1mdW5jdGlvbiBwKGUpe3JldHVybiBmdW5jdGlvbigpe3ZhciB0PXRoaXMsbj1hcmd1bWVudHM7cmV0dXJuIG5ldyBQcm9taXNlKChmdW5jdGlvbihyLG8pe3ZhciBhPWUuYXBwbHkodCxuKTtmdW5jdGlvbiBpKGUpe2QoYSxyLG8saSxzLCJuZXh0IixlKX1mdW5jdGlvbiBzKGUpe2QoYSxyLG8saSxzLCJ0aHJvdyIsZSl9aSh2b2lkIDApfSkpfX12YXIgaD1yPyJjaG9vc2VGaWxlU3lzdGVtRW50cmllcyI9PT1yP1Byb21pc2UucmVzb2x2ZSgpLnRoZW4obi5iaW5kKG51bGwsMTUzKSk6UHJvbWlzZS5yZXNvbHZlKCkudGhlbihuLmJpbmQobnVsbCwxNTQpKTpQcm9taXNlLnJlc29sdmUoKS50aGVuKG4uYmluZChudWxsLDE1NSkpO2Z1bmN0aW9uIGYoKXtyZXR1cm4gbS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9ZnVuY3Rpb24gbSgpe3JldHVybihtPXAoKGZ1bmN0aW9uKCl7dmFyIGUsdCxuPVtdO2ZvcihlPTA7ZTxhcmd1bWVudHMubGVuZ3RoO2UrKyluW2VdPWFyZ3VtZW50c1tlXTtyZXR1cm4gdSh0aGlzLChmdW5jdGlvbihlKXtzd2l0Y2goZS5sYWJlbCl7Y2FzZSAwOnJldHVybls0LGhdO2Nhc2UgMTpyZXR1cm5bMiwodD1lLnNlbnQoKSkuZGVmYXVsdC5hcHBseSh0LG4pXX19KSl9KSkpLmFwcGx5KHRoaXMsYXJndW1lbnRzKX19LGZ1bmN0aW9uKGUsdCxuKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gcigpe3JldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqTWF0aC5wb3coMiwzMSkpfW4uZCh0LCJiIiwoZnVuY3Rpb24oKXtyZXR1cm4gcn0pKSxuLmQodCwiYSIsKGZ1bmN0aW9uKCl7cmV0dXJuIG99KSk7dmFyIG89ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUpe3RoaXMuc2VlZD1lfXJldHVybiBlLnByb3RvdHlwZS5uZXh0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2VlZD8oTWF0aC5wb3coMiwzMSktMSYodGhpcy5zZWVkPU1hdGguaW11bCg0ODI3MSx0aGlzLnNlZWQpKSkvTWF0aC5wb3coMiwzMSk6TWF0aC5yYW5kb20oKX0sZX0oKX0sZnVuY3Rpb24oZSx0LG4pe3ZhciByLG89bigxMzMpLGE9big2MCksaT1uKDEzNSkscz1uKDEzNiksbD1uKDEzNyk7InVuZGVmaW5lZCIhPXR5cGVvZiBBcnJheUJ1ZmZlciYmKHI9bigxMzgpKTt2YXIgYz0idW5kZWZpbmVkIiE9dHlwZW9mIG5hdmlnYXRvciYmL0FuZHJvaWQvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpLHU9InVuZGVmaW5lZCIhPXR5cGVvZiBuYXZpZ2F0b3ImJi9QaGFudG9tSlMvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpLGQ9Y3x8dTt0LnByb3RvY29sPTM7dmFyIHA9dC5wYWNrZXRzPXtvcGVuOjAsY2xvc2U6MSxwaW5nOjIscG9uZzozLG1lc3NhZ2U6NCx1cGdyYWRlOjUsbm9vcDo2fSxoPW8ocCksZj17dHlwZToiZXJyb3IiLGRhdGE6InBhcnNlciBlcnJvciJ9LG09bigxMzkpO2Z1bmN0aW9uIGcoZSx0LG4pe2Zvcih2YXIgcj1uZXcgQXJyYXkoZS5sZW5ndGgpLG89cyhlLmxlbmd0aCxuKSxhPWZ1bmN0aW9uKGUsbixvKXt0KG4sKGZ1bmN0aW9uKHQsbil7cltlXT1uLG8odCxyKX0pKX0saT0wO2k8ZS5sZW5ndGg7aSsrKWEoaSxlW2ldLG8pfXQuZW5jb2RlUGFja2V0PWZ1bmN0aW9uKGUsbixyLG8peyJmdW5jdGlvbiI9PXR5cGVvZiBuJiYobz1uLG49ITEpLCJmdW5jdGlvbiI9PXR5cGVvZiByJiYobz1yLHI9bnVsbCk7dmFyIGE9dm9pZCAwPT09ZS5kYXRhP3ZvaWQgMDplLmRhdGEuYnVmZmVyfHxlLmRhdGE7aWYoInVuZGVmaW5lZCIhPXR5cGVvZiBBcnJheUJ1ZmZlciYmYSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKXJldHVybiBmdW5jdGlvbihlLG4scil7aWYoIW4pcmV0dXJuIHQuZW5jb2RlQmFzZTY0UGFja2V0KGUscik7dmFyIG89ZS5kYXRhLGE9bmV3IFVpbnQ4QXJyYXkobyksaT1uZXcgVWludDhBcnJheSgxK28uYnl0ZUxlbmd0aCk7aVswXT1wW2UudHlwZV07Zm9yKHZhciBzPTA7czxhLmxlbmd0aDtzKyspaVtzKzFdPWFbc107cmV0dXJuIHIoaS5idWZmZXIpfShlLG4sbyk7aWYodm9pZCAwIT09bSYmYSBpbnN0YW5jZW9mIG0pcmV0dXJuIGZ1bmN0aW9uKGUsbixyKXtpZighbilyZXR1cm4gdC5lbmNvZGVCYXNlNjRQYWNrZXQoZSxyKTtpZihkKXJldHVybiBmdW5jdGlvbihlLG4scil7aWYoIW4pcmV0dXJuIHQuZW5jb2RlQmFzZTY0UGFja2V0KGUscik7dmFyIG89bmV3IEZpbGVSZWFkZXI7cmV0dXJuIG8ub25sb2FkPWZ1bmN0aW9uKCl7dC5lbmNvZGVQYWNrZXQoe3R5cGU6ZS50eXBlLGRhdGE6by5yZXN1bHR9LG4sITAscil9LG8ucmVhZEFzQXJyYXlCdWZmZXIoZS5kYXRhKX0oZSxuLHIpO3ZhciBvPW5ldyBVaW50OEFycmF5KDEpO29bMF09cFtlLnR5cGVdO3ZhciBhPW5ldyBtKFtvLmJ1ZmZlcixlLmRhdGFdKTtyZXR1cm4gcihhKX0oZSxuLG8pO2lmKGEmJmEuYmFzZTY0KXJldHVybiBmdW5jdGlvbihlLG4pe3ZhciByPSJiIit0LnBhY2tldHNbZS50eXBlXStlLmRhdGEuZGF0YTtyZXR1cm4gbihyKX0oZSxvKTt2YXIgaT1wW2UudHlwZV07cmV0dXJuIHZvaWQgMCE9PWUuZGF0YSYmKGkrPXI/bC5lbmNvZGUoU3RyaW5nKGUuZGF0YSkse3N0cmljdDohMX0pOlN0cmluZyhlLmRhdGEpKSxvKCIiK2kpfSx0LmVuY29kZUJhc2U2NFBhY2tldD1mdW5jdGlvbihlLG4pe3ZhciByLG89ImIiK3QucGFja2V0c1tlLnR5cGVdO2lmKHZvaWQgMCE9PW0mJmUuZGF0YSBpbnN0YW5jZW9mIG0pe3ZhciBhPW5ldyBGaWxlUmVhZGVyO3JldHVybiBhLm9ubG9hZD1mdW5jdGlvbigpe3ZhciBlPWEucmVzdWx0LnNwbGl0KCIsIilbMV07bihvK2UpfSxhLnJlYWRBc0RhdGFVUkwoZS5kYXRhKX10cnl7cj1TdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsbmV3IFVpbnQ4QXJyYXkoZS5kYXRhKSl9Y2F0Y2godCl7Zm9yKHZhciBpPW5ldyBVaW50OEFycmF5KGUuZGF0YSkscz1uZXcgQXJyYXkoaS5sZW5ndGgpLGw9MDtsPGkubGVuZ3RoO2wrKylzW2xdPWlbbF07cj1TdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwscyl9cmV0dXJuIG8rPWJ0b2EociksbihvKX0sdC5kZWNvZGVQYWNrZXQ9ZnVuY3Rpb24oZSxuLHIpe2lmKHZvaWQgMD09PWUpcmV0dXJuIGY7aWYoInN0cmluZyI9PXR5cGVvZiBlKXtpZigiYiI9PT1lLmNoYXJBdCgwKSlyZXR1cm4gdC5kZWNvZGVCYXNlNjRQYWNrZXQoZS5zdWJzdHIoMSksbik7aWYociYmITE9PT0oZT1mdW5jdGlvbihlKXt0cnl7ZT1sLmRlY29kZShlLHtzdHJpY3Q6ITF9KX1jYXRjaChlKXtyZXR1cm4hMX1yZXR1cm4gZX0oZSkpKXJldHVybiBmO3ZhciBvPWUuY2hhckF0KDApO3JldHVybiBOdW1iZXIobyk9PW8mJmhbb10/ZS5sZW5ndGg+MT97dHlwZTpoW29dLGRhdGE6ZS5zdWJzdHJpbmcoMSl9Ont0eXBlOmhbb119OmZ9bz1uZXcgVWludDhBcnJheShlKVswXTt2YXIgYT1pKGUsMSk7cmV0dXJuIG0mJiJibG9iIj09PW4mJihhPW5ldyBtKFthXSkpLHt0eXBlOmhbb10sZGF0YTphfX0sdC5kZWNvZGVCYXNlNjRQYWNrZXQ9ZnVuY3Rpb24oZSx0KXt2YXIgbj1oW2UuY2hhckF0KDApXTtpZighcilyZXR1cm57dHlwZTpuLGRhdGE6e2Jhc2U2NDohMCxkYXRhOmUuc3Vic3RyKDEpfX07dmFyIG89ci5kZWNvZGUoZS5zdWJzdHIoMSkpO3JldHVybiJibG9iIj09PXQmJm0mJihvPW5ldyBtKFtvXSkpLHt0eXBlOm4sZGF0YTpvfX0sdC5lbmNvZGVQYXlsb2FkPWZ1bmN0aW9uKGUsbixyKXsiZnVuY3Rpb24iPT10eXBlb2YgbiYmKHI9bixuPW51bGwpO3ZhciBvPWEoZSk7aWYobiYmbylyZXR1cm4gbSYmIWQ/dC5lbmNvZGVQYXlsb2FkQXNCbG9iKGUscik6dC5lbmNvZGVQYXlsb2FkQXNBcnJheUJ1ZmZlcihlLHIpO2lmKCFlLmxlbmd0aClyZXR1cm4gcigiMDoiKTtnKGUsKGZ1bmN0aW9uKGUscil7dC5lbmNvZGVQYWNrZXQoZSwhIW8mJm4sITEsKGZ1bmN0aW9uKGUpe3IobnVsbCxmdW5jdGlvbihlKXtyZXR1cm4gZS5sZW5ndGgrIjoiK2V9KGUpKX0pKX0pLChmdW5jdGlvbihlLHQpe3JldHVybiByKHQuam9pbigiIikpfSkpfSx0LmRlY29kZVBheWxvYWQ9ZnVuY3Rpb24oZSxuLHIpe2lmKCJzdHJpbmciIT10eXBlb2YgZSlyZXR1cm4gdC5kZWNvZGVQYXlsb2FkQXNCaW5hcnkoZSxuLHIpO3ZhciBvO2lmKCJmdW5jdGlvbiI9PXR5cGVvZiBuJiYocj1uLG49bnVsbCksIiI9PT1lKXJldHVybiByKGYsMCwxKTtmb3IodmFyIGEsaSxzPSIiLGw9MCxjPWUubGVuZ3RoO2w8YztsKyspe3ZhciB1PWUuY2hhckF0KGwpO2lmKCI6Ij09PXUpe2lmKCIiPT09c3x8cyE9KGE9TnVtYmVyKHMpKSlyZXR1cm4gcihmLDAsMSk7aWYocyE9KGk9ZS5zdWJzdHIobCsxLGEpKS5sZW5ndGgpcmV0dXJuIHIoZiwwLDEpO2lmKGkubGVuZ3RoKXtpZihvPXQuZGVjb2RlUGFja2V0KGksbiwhMSksZi50eXBlPT09by50eXBlJiZmLmRhdGE9PT1vLmRhdGEpcmV0dXJuIHIoZiwwLDEpO2lmKCExPT09cihvLGwrYSxjKSlyZXR1cm59bCs9YSxzPSIifWVsc2Ugcys9dX1yZXR1cm4iIiE9PXM/cihmLDAsMSk6dm9pZCAwfSx0LmVuY29kZVBheWxvYWRBc0FycmF5QnVmZmVyPWZ1bmN0aW9uKGUsbil7aWYoIWUubGVuZ3RoKXJldHVybiBuKG5ldyBBcnJheUJ1ZmZlcigwKSk7ZyhlLChmdW5jdGlvbihlLG4pe3QuZW5jb2RlUGFja2V0KGUsITAsITAsKGZ1bmN0aW9uKGUpe3JldHVybiBuKG51bGwsZSl9KSl9KSwoZnVuY3Rpb24oZSx0KXt2YXIgcj10LnJlZHVjZSgoZnVuY3Rpb24oZSx0KXt2YXIgbjtyZXR1cm4gZSsobj0ic3RyaW5nIj09dHlwZW9mIHQ/dC5sZW5ndGg6dC5ieXRlTGVuZ3RoKS50b1N0cmluZygpLmxlbmd0aCtuKzJ9KSwwKSxvPW5ldyBVaW50OEFycmF5KHIpLGE9MDtyZXR1cm4gdC5mb3JFYWNoKChmdW5jdGlvbihlKXt2YXIgdD0ic3RyaW5nIj09dHlwZW9mIGUsbj1lO2lmKHQpe2Zvcih2YXIgcj1uZXcgVWludDhBcnJheShlLmxlbmd0aCksaT0wO2k8ZS5sZW5ndGg7aSsrKXJbaV09ZS5jaGFyQ29kZUF0KGkpO249ci5idWZmZXJ9b1thKytdPXQ/MDoxO3ZhciBzPW4uYnl0ZUxlbmd0aC50b1N0cmluZygpO2ZvcihpPTA7aTxzLmxlbmd0aDtpKyspb1thKytdPXBhcnNlSW50KHNbaV0pO29bYSsrXT0yNTU7Zm9yKHI9bmV3IFVpbnQ4QXJyYXkobiksaT0wO2k8ci5sZW5ndGg7aSsrKW9bYSsrXT1yW2ldfSkpLG4oby5idWZmZXIpfSkpfSx0LmVuY29kZVBheWxvYWRBc0Jsb2I9ZnVuY3Rpb24oZSxuKXtnKGUsKGZ1bmN0aW9uKGUsbil7dC5lbmNvZGVQYWNrZXQoZSwhMCwhMCwoZnVuY3Rpb24oZSl7dmFyIHQ9bmV3IFVpbnQ4QXJyYXkoMSk7aWYodFswXT0xLCJzdHJpbmciPT10eXBlb2YgZSl7Zm9yKHZhciByPW5ldyBVaW50OEFycmF5KGUubGVuZ3RoKSxvPTA7bzxlLmxlbmd0aDtvKyspcltvXT1lLmNoYXJDb2RlQXQobyk7ZT1yLmJ1ZmZlcix0WzBdPTB9dmFyIGE9KGUgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcj9lLmJ5dGVMZW5ndGg6ZS5zaXplKS50b1N0cmluZygpLGk9bmV3IFVpbnQ4QXJyYXkoYS5sZW5ndGgrMSk7Zm9yKG89MDtvPGEubGVuZ3RoO28rKylpW29dPXBhcnNlSW50KGFbb10pO2lmKGlbYS5sZW5ndGhdPTI1NSxtKXt2YXIgcz1uZXcgbShbdC5idWZmZXIsaS5idWZmZXIsZV0pO24obnVsbCxzKX19KSl9KSwoZnVuY3Rpb24oZSx0KXtyZXR1cm4gbihuZXcgbSh0KSl9KSl9LHQuZGVjb2RlUGF5bG9hZEFzQmluYXJ5PWZ1bmN0aW9uKGUsbixyKXsiZnVuY3Rpb24iPT10eXBlb2YgbiYmKHI9bixuPW51bGwpO2Zvcih2YXIgbz1lLGE9W107by5ieXRlTGVuZ3RoPjA7KXtmb3IodmFyIHM9bmV3IFVpbnQ4QXJyYXkobyksbD0wPT09c1swXSxjPSIiLHU9MTsyNTUhPT1zW3VdO3UrKyl7aWYoYy5sZW5ndGg+MzEwKXJldHVybiByKGYsMCwxKTtjKz1zW3VdfW89aShvLDIrYy5sZW5ndGgpLGM9cGFyc2VJbnQoYyk7dmFyIGQ9aShvLDAsYyk7aWYobCl0cnl7ZD1TdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsbmV3IFVpbnQ4QXJyYXkoZCkpfWNhdGNoKGUpe3ZhciBwPW5ldyBVaW50OEFycmF5KGQpO2Q9IiI7Zm9yKHU9MDt1PHAubGVuZ3RoO3UrKylkKz1TdHJpbmcuZnJvbUNoYXJDb2RlKHBbdV0pfWEucHVzaChkKSxvPWkobyxjKX12YXIgaD1hLmxlbmd0aDthLmZvckVhY2goKGZ1bmN0aW9uKGUsbyl7cih0LmRlY29kZVBhY2tldChlLG4sITApLG8saCl9KSl9fSxmdW5jdGlvbihlLHQsbil7InVzZSBzdHJpY3QiO24uZCh0LCJiIiwoZnVuY3Rpb24oKXtyZXR1cm4gYX0pKSxuLmQodCwiYSIsKGZ1bmN0aW9uKCl7cmV0dXJuIGl9KSk7dmFyIHI9big0KSxvPW4oMiksYT1mdW5jdGlvbihlKXtyZXR1cm4gTWF0aC5mbG9vcihlKX07dmFyIGk9ZnVuY3Rpb24oZSx0LG4pe3ZhciBpO2lmKCFlLmxlbmd0aClyZXR1cm57c2Nyb2xsWDphKDApLHNjcm9sbFk6YSgwKX07dmFyIHM9d2luZG93LmRldmljZVBpeGVsUmF0aW8sbD1PYmplY3Qoci5mKShlKSxjPWxbMF0sdT1sWzFdLGQ9bFsyXSxwPWxbM107KGZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1uWzBdLGE9blsxXSxpPW5bMl0scz1uWzNdLGw9T2JqZWN0KG8udSkoe3NjZW5lWDpyLHNjZW5lWTphfSxlLHQsd2luZG93LmRldmljZVBpeGVsUmF0aW8pLGM9bC54LHU9bC55LGQ9T2JqZWN0KG8udSkoe3NjZW5lWDppLHNjZW5lWTpzfSxlLHQsd2luZG93LmRldmljZVBpeGVsUmF0aW8pLHA9ZC54LGg9ZC55O3JldHVybiBwLWM+ZS53aWR0aHx8aC11PmUuaGVpZ2h0fSkodCxuLFtjLHUsZCxwXSkmJihjPShpPU9iamVjdChyLmUpKGUsT2JqZWN0KG8ueSkoe2NsaWVudFg6dC5zY3JvbGxYLGNsaWVudFk6dC5zY3JvbGxZfSx0LG4scykpKVswXSx1PWlbMV0sZD1pWzJdLHA9aVszXSk7dmFyIGg9KGMrZCkvMixmPSh1K3ApLzI7cmV0dXJue3Njcm9sbFg6YSh0LndpZHRoLzItaCksc2Nyb2xsWTphKHQuaGVpZ2h0LzItZil9fX0sZnVuY3Rpb24oZSx0LG4peyJ1c2Ugc3RyaWN0IjtuLmQodCwiYSIsKGZ1bmN0aW9uKCl7cmV0dXJuIGZ9KSksbi5kKHQsImIiLChmdW5jdGlvbigpe3JldHVybiBtfSkpO3ZhciByPW4oMTcpLG89bigzMSksYT1uKDEpLGk9big2KSxzPWZ1bmN0aW9uKGUsdCl7dmFyIG4scixvLGEsaT17bGFiZWw6MCxzZW50OmZ1bmN0aW9uKCl7aWYoMSZvWzBdKXRocm93IG9bMV07cmV0dXJuIG9bMV19LHRyeXM6W10sb3BzOltdfTtyZXR1cm4gYT17bmV4dDpzKDApLHRocm93OnMoMSkscmV0dXJuOnMoMil9LCJmdW5jdGlvbiI9PXR5cGVvZiBTeW1ib2wmJihhW1N5bWJvbC5pdGVyYXRvcl09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30pLGE7ZnVuY3Rpb24gcyhhKXtyZXR1cm4gZnVuY3Rpb24ocyl7cmV0dXJuIGZ1bmN0aW9uKGEpe2lmKG4pdGhyb3cgbmV3IFR5cGVFcnJvcigiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLiIpO2Zvcig7aTspdHJ5e2lmKG49MSxyJiYobz0yJmFbMF0/ci5yZXR1cm46YVswXT9yLnRocm93fHwoKG89ci5yZXR1cm4pJiZvLmNhbGwociksMCk6ci5uZXh0KSYmIShvPW8uY2FsbChyLGFbMV0pKS5kb25lKXJldHVybiBvO3N3aXRjaChyPTAsbyYmKGE9WzImYVswXSxvLnZhbHVlXSksYVswXSl7Y2FzZSAwOmNhc2UgMTpvPWE7YnJlYWs7Y2FzZSA0OnJldHVybiBpLmxhYmVsKysse3ZhbHVlOmFbMV0sZG9uZTohMX07Y2FzZSA1OmkubGFiZWwrKyxyPWFbMV0sYT1bMF07Y29udGludWU7Y2FzZSA3OmE9aS5vcHMucG9wKCksaS50cnlzLnBvcCgpO2NvbnRpbnVlO2RlZmF1bHQ6aWYoIShvPWkudHJ5cywobz1vLmxlbmd0aD4wJiZvW28ubGVuZ3RoLTFdKXx8NiE9PWFbMF0mJjIhPT1hWzBdKSl7aT0wO2NvbnRpbnVlfWlmKDM9PT1hWzBdJiYoIW98fGFbMV0+b1swXSYmYVsxXTxvWzNdKSl7aS5sYWJlbD1hWzFdO2JyZWFrfWlmKDY9PT1hWzBdJiZpLmxhYmVsPG9bMV0pe2kubGFiZWw9b1sxXSxvPWE7YnJlYWt9aWYobyYmaS5sYWJlbDxvWzJdKXtpLmxhYmVsPW9bMl0saS5vcHMucHVzaChhKTticmVha31vWzJdJiZpLm9wcy5wb3AoKSxpLnRyeXMucG9wKCk7Y29udGludWV9YT10LmNhbGwoZSxpKX1jYXRjaChlKXthPVs2LGVdLHI9MH1maW5hbGx5e249bz0wfWlmKDUmYVswXSl0aHJvdyBhWzFdO3JldHVybnt2YWx1ZTphWzBdP2FbMV06dm9pZCAwLGRvbmU6ITB9fShbYSxzXSl9fX07ZnVuY3Rpb24gbChlLHQpe3ZhciBuPU9iamVjdC5rZXlzKGUpO2lmKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpe3ZhciByPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7dCYmKHI9ci5maWx0ZXIoKGZ1bmN0aW9uKHQpe3JldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGUsdCkuZW51bWVyYWJsZX0pKSksbi5wdXNoLmFwcGx5KG4scil9cmV0dXJuIG59ZnVuY3Rpb24gYyhlKXtmb3IodmFyIHQ9MTt0PGFyZ3VtZW50cy5sZW5ndGg7dCsrKXt2YXIgbj1udWxsIT1hcmd1bWVudHNbdF0/YXJndW1lbnRzW3RdOnt9O3QlMj9sKE9iamVjdChuKSwhMCkuZm9yRWFjaCgoZnVuY3Rpb24odCl7dShlLHQsblt0XSl9KSk6T2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnM/T2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZSxPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhuKSk6bChPYmplY3QobikpLmZvckVhY2goKGZ1bmN0aW9uKHQpe09iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHQsT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihuLHQpKX0pKX1yZXR1cm4gZX1mdW5jdGlvbiB1KGUsdCxuKXtyZXR1cm4gdCBpbiBlP09iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHQse3ZhbHVlOm4sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITAsd3JpdGFibGU6ITB9KTplW3RdPW4sZX1mdW5jdGlvbiBkKGUsdCxuLHIsbyxhLGkpe3RyeXt2YXIgcz1lW2FdKGkpLGw9cy52YWx1ZX1jYXRjaChlKXtyZXR1cm4gdm9pZCBuKGUpfXMuZG9uZT90KGwpOlByb21pc2UucmVzb2x2ZShsKS50aGVuKHIsbyl9ZnVuY3Rpb24gcChlKXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgdD10aGlzLG49YXJndW1lbnRzO3JldHVybiBuZXcgUHJvbWlzZSgoZnVuY3Rpb24ocixvKXt2YXIgYT1lLmFwcGx5KHQsbik7ZnVuY3Rpb24gaShlKXtkKGEscixvLGkscywibmV4dCIsZSl9ZnVuY3Rpb24gcyhlKXtkKGEscixvLGkscywidGhyb3ciLGUpfWkodm9pZCAwKX0pKX19dmFyIGg9ZnVuY3Rpb24oKXt2YXIgZT1wKChmdW5jdGlvbihlKXt2YXIgdDtyZXR1cm4gcyh0aGlzLChmdW5jdGlvbihuKXtzd2l0Y2gobi5sYWJlbCl7Y2FzZSAwOnJldHVybiJ0ZXh0ImluIEJsb2I/WzQsZS50ZXh0KCldOlszLDJdO2Nhc2UgMTpyZXR1cm4gdD1uLnNlbnQoKSxbMyw0XTtjYXNlIDI6cmV0dXJuWzQsbmV3IFByb21pc2UoKGZ1bmN0aW9uKHQpe3ZhciBuPW5ldyBGaWxlUmVhZGVyO24ucmVhZEFzVGV4dChlLCJ1dGY4Iiksbi5vbmxvYWRlbmQ9ZnVuY3Rpb24oKXtuLnJlYWR5U3RhdGU9PT1GaWxlUmVhZGVyLkRPTkUmJnQobi5yZXN1bHQpfX0pKV07Y2FzZSAzOnQ9bi5zZW50KCksbi5sYWJlbD00O2Nhc2UgNDpyZXR1cm5bMix0XX19KSl9KSk7cmV0dXJuIGZ1bmN0aW9uKHQpe3JldHVybiBlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX19KCksZj1mdW5jdGlvbigpe3ZhciBlPXAoKGZ1bmN0aW9uKGUsdCl7dmFyIG4sbCx1LGQscDtyZXR1cm4gcyh0aGlzLChmdW5jdGlvbihzKXtzd2l0Y2gocy5sYWJlbCl7Y2FzZSAwOnJldHVybiBlLmhhbmRsZSYmKHdpbmRvdy5oYW5kbGU9ZS5oYW5kbGUpLFs0LGgoZSldO2Nhc2UgMTpuPXMuc2VudCgpLGw9T2JqZWN0KHIuYykoKSx1PVtdLGQ9dHx8bDt0cnl7aWYoImV4Y2FsaWRyYXciIT09KHA9SlNPTi5wYXJzZShuKSkudHlwZSl0aHJvdyBuZXcgRXJyb3IoT2JqZWN0KGEuZSkoImFsZXJ0cy5jb3VsZE5vdExvYWRJbnZhbGlkRmlsZSIpKTt1PXAuZWxlbWVudHN8fFtdLGQ9YyhjKGMoe30sbCksT2JqZWN0KHIuYSkocC5hcHBTdGF0ZSkpLHQ/T2JqZWN0KGkuYSkodSx0LG51bGwpOnt9KX1jYXRjaChlKXt0aHJvdyBuZXcgRXJyb3IoT2JqZWN0KGEuZSkoImFsZXJ0cy5jb3VsZE5vdExvYWRJbnZhbGlkRmlsZSIpKX1yZXR1cm5bMixPYmplY3Qoby5hKSh1LGQpXX19KSl9KSk7cmV0dXJuIGZ1bmN0aW9uKHQsbil7cmV0dXJuIGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfX0oKSxtPWZ1bmN0aW9uKCl7dmFyIGU9cCgoZnVuY3Rpb24oZSl7dmFyIHQsbjtyZXR1cm4gcyh0aGlzLChmdW5jdGlvbihyKXtzd2l0Y2goci5sYWJlbCl7Y2FzZSAwOnJldHVybls0LGgoZSldO2Nhc2UgMTppZih0PXIuc2VudCgpLCJleGNhbGlkcmF3bGliIiE9PShuPUpTT04ucGFyc2UodCkpLnR5cGUpdGhyb3cgbmV3IEVycm9yKE9iamVjdChhLmUpKCJhbGVydHMuY291bGROb3RMb2FkSW52YWxpZEZpbGUiKSk7cmV0dXJuWzIsbl19fSkpfSkpO3JldHVybiBmdW5jdGlvbih0KXtyZXR1cm4gZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fSgpfSxmdW5jdGlvbihlLHQsbil7InVzZSBzdHJpY3QiO24uZCh0LCJhIiwoZnVuY3Rpb24oKXtyZXR1cm4gb30pKSxuLmQodCwiYiIsKGZ1bmN0aW9uKCl7cmV0dXJuIGF9KSk7dmFyIHI9bigzOSksbz1mdW5jdGlvbihlKXt2YXIgdD1lLnNwbGl0KCIiKS5yZWR1Y2UoKGZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUrdC5jaGFyQ29kZUF0KDApfSksMCksbj1yLmEuZWxlbWVudEJhY2tncm91bmQuc2xpY2UoMSksbz1yLmEuZWxlbWVudFN0cm9rZS5zbGljZSgxKTtyZXR1cm57YmFja2dyb3VuZDpuW3Qlbi5sZW5ndGhdLHN0cm9rZTpvW3Qlby5sZW5ndGhdfX0sYT1mdW5jdGlvbihlKXtpZighZSlyZXR1cm4iPyI7dmFyIHQ9ZS50cmltKCkuc3BsaXQoIiAiKTtpZih0Lmxlbmd0aDwyKXJldHVybiB0WzBdLnN1YnN0cmluZygwLDIpLnRvVXBwZXJDYXNlKCk7dmFyIG49dFswXSxyPXRbdC5sZW5ndGgtMV07cmV0dXJuKG5bMF0rclswXSkudG9VcHBlckNhc2UoKX19LGZ1bmN0aW9uKGUsdCxuKXsidXNlIHN0cmljdCI7bi5kKHQsImEiLChmdW5jdGlvbigpe3JldHVybiBofSkpLG4uZCh0LCJiIiwoZnVuY3Rpb24oKXtyZXR1cm4gbX0pKTt2YXIgcj1uKDcpLG89big0KSxhPW4oMTkpLGk9bigyOCkscz1uKDE0KSxsPW4oMzcpLGM9bigxNiksdT1uKDEyKSxkPWZ1bmN0aW9uKGUsdCxuLHIsbyxhLGkscyxsKXtlLnRyYW5zbGF0ZShhLGkpLGUucm90YXRlKHMpLGwmJmUuZmlsbFJlY3QodC1hLG4taSxyLG8pLGUuc3Ryb2tlUmVjdCh0LWEsbi1pLHIsbyksZS5yb3RhdGUoLXMpLGUudHJhbnNsYXRlKC1hLC1pKX0scD1mdW5jdGlvbihlLHQsbixyLG8pe2UuYmVnaW5QYXRoKCksZS5hcmModCtyLzIsbitvLzIsci8yLDAsMipNYXRoLlBJKSxlLmZpbGwoKSxlLnN0cm9rZSgpfSxoPWZ1bmN0aW9uKGUsdCxuLGgsbSxnLGIseSl7dmFyIHY9dm9pZCAwPT09eT97fTp5LGs9di5yZW5kZXJTY3JvbGxiYXJzLHc9dm9pZCAwPT09a3x8ayxTPXYucmVuZGVyU2VsZWN0aW9uLEU9dm9pZCAwPT09U3x8UyxPPXYucmVuZGVyT3B0aW1pemF0aW9ucyxDPXZvaWQgMCE9PU8mJk8seD12LnJlbmRlckdyaWQsaj12b2lkIDA9PT14fHx4O2lmKCFnKXJldHVybnthdExlYXN0T25lVmlzaWJsZUVsZW1lbnQ6ITF9O3ZhciBUPWcuZ2V0Q29udGV4dCgiMmQiKTtULnNjYWxlKGgsaCk7dmFyIFA9Zy53aWR0aC9oLEE9Zy5oZWlnaHQvaDtpZigic3RyaW5nIj09dHlwZW9mIGIudmlld0JhY2tncm91bmRDb2xvcil7KCJ0cmFuc3BhcmVudCI9PT1iLnZpZXdCYWNrZ3JvdW5kQ29sb3J8fDU9PT1iLnZpZXdCYWNrZ3JvdW5kQ29sb3IubGVuZ3RofHw5PT09Yi52aWV3QmFja2dyb3VuZENvbG9yLmxlbmd0aHx8Lyhoc2xhfHJnYmEpXCgvLnRlc3QoYi52aWV3QmFja2dyb3VuZENvbG9yKSkmJlQuY2xlYXJSZWN0KDAsMCxQLEEpO3ZhciBNPVQuZmlsbFN0eWxlO1QuZmlsbFN0eWxlPWIudmlld0JhY2tncm91bmRDb2xvcixULmZpbGxSZWN0KDAsMCxQLEEpLFQuZmlsbFN0eWxlPU19ZWxzZSBULmNsZWFyUmVjdCgwLDAsUCxBKTt2YXIgXz0tUCooYi56b29tLTEpLzIsej0tQSooYi56b29tLTEpLzI7VC50cmFuc2xhdGUoXyx6KSxULnNjYWxlKGIuem9vbSxiLnpvb20pLGomJnQuZ3JpZFNpemUmJmZ1bmN0aW9uKGUsdCxuLHIsbyxhKXt2YXIgaT1lLnN0cm9rZVN0eWxlO2Uuc3Ryb2tlU3R5bGU9InJnYmEoMCwwLDAsMC4xKSIsZS5iZWdpblBhdGgoKTtmb3IodmFyIHM9bjtzPG4rbysyKnQ7cys9dCllLm1vdmVUbyhzLHItdCksZS5saW5lVG8ocyxyK2ErMip0KTtmb3IodmFyIGw9cjtsPHIrYSsyKnQ7bCs9dCllLm1vdmVUbyhuLXQsbCksZS5saW5lVG8obitvKzIqdCxsKTtlLnN0cm9rZSgpLGUuc3Ryb2tlU3R5bGU9aX0oVCx0LmdyaWRTaXplLC1NYXRoLmNlaWwoXy9iLnpvb20vdC5ncmlkU2l6ZSkqdC5ncmlkU2l6ZStiLnNjcm9sbFgldC5ncmlkU2l6ZSwtTWF0aC5jZWlsKHovYi56b29tL3QuZ3JpZFNpemUpKnQuZ3JpZFNpemUrYi5zY3JvbGxZJXQuZ3JpZFNpemUsUC9iLnpvb20sQS9iLnpvb20pO3ZhciBMLEk9ZS5maWx0ZXIoKGZ1bmN0aW9uKGUpe3JldHVybiBmKGUsUCxBLGIpfSkpO2lmKEkuZm9yRWFjaCgoZnVuY3Rpb24oZSl7T2JqZWN0KHMuZCkoZSxtLFQsQyxiKX0pKSx0LmVkaXRpbmdMaW5lYXJFbGVtZW50KXt2YXIgRD1jLmEuZ2V0RWxlbWVudCh0LmVkaXRpbmdMaW5lYXJFbGVtZW50LmVsZW1lbnRJZCk7RCYmZnVuY3Rpb24oZSx0LG4scil7ZS50cmFuc2xhdGUobi5zY3JvbGxYLG4uc2Nyb2xsWSk7dmFyIG89ZS5zdHJva2VTdHlsZSxhPWUubGluZVdpZHRoO2UubGluZVdpZHRoPTEvbi56b29tLGMuYS5nZXRQb2ludHNHbG9iYWxDb29yZGluYXRlcyhyKS5mb3JFYWNoKChmdW5jdGlvbihyLG8pe3ZhciBhO2Uuc3Ryb2tlU3R5bGU9InJlZCIsZS5zZXRMaW5lRGFzaChbXSksZS5maWxsU3R5bGU9KG51bGw9PT0oYT10LmVkaXRpbmdMaW5lYXJFbGVtZW50KXx8dm9pZCAwPT09YT92b2lkIDA6YS5hY3RpdmVQb2ludEluZGV4KT09PW8/InJnYmEoMjU1LCAxMjcsIDEyNywgMC45KSI6InJnYmEoMjU1LCAyNTUsIDI1NSwgMC45KSI7dmFyIGk9Yy5hLlBPSU5UX0hBTkRMRV9TSVpFO3AoZSxyWzBdLWkvMi9uLnpvb20sclsxXS1pLzIvbi56b29tLGkvbi56b29tLGkvbi56b29tKX0pKSxlLnNldExpbmVEYXNoKFtdKSxlLmxpbmVXaWR0aD1hLGUudHJhbnNsYXRlKC1uLnNjcm9sbFgsLW4uc2Nyb2xsWSksZS5zdHJva2VTdHlsZT1vfShULHQsYixEKX1pZihuJiZPYmplY3Qocy5kKShuLG0sVCxDLGIpLEUmJiF0Lm11bHRpRWxlbWVudCYmIXQuZWRpdGluZ0xpbmVhckVsZW1lbnQpe1QudHJhbnNsYXRlKGIuc2Nyb2xsWCxiLnNjcm9sbFkpO3ZhciBOPWUucmVkdWNlKChmdW5jdGlvbihlLG4pe3ZhciBhPVtdO2lmKHQuc2VsZWN0ZWRFbGVtZW50SWRzW24uaWRdJiYhT2JqZWN0KHUuZykodCxuKSYmYS5wdXNoKHIuYmxhY2spLGIucmVtb3RlU2VsZWN0ZWRFbGVtZW50SWRzW24uaWRdJiZhLnB1c2guYXBwbHkoYSxiLnJlbW90ZVNlbGVjdGVkRWxlbWVudElkc1tuLmlkXS5tYXAoKGZ1bmN0aW9uKGUpe3JldHVybiBPYmplY3QobC5hKShlKS5iYWNrZ3JvdW5kfSkpKSxhLmxlbmd0aCl7dmFyIGk9T2JqZWN0KG8uaikobikscz1pWzBdLGM9aVsxXSxkPWlbMl0scD1pWzNdO2UucHVzaCh7YW5nbGU6bi5hbmdsZSxlbGVtZW50WDE6cyxlbGVtZW50WTE6YyxlbGVtZW50WDI6ZCxlbGVtZW50WTI6cCxzZWxlY3Rpb25Db2xvcnM6YX0pfXJldHVybiBlfSksW10pO2Z1bmN0aW9uIEYodCl7dmFyIG49T2JqZWN0KHUuYikoZSx0KSxhPU9iamVjdChvLmYpKG4pLGk9YVswXSxzPWFbMV0sbD1hWzJdLGM9YVszXTtOLnB1c2goe2FuZ2xlOjAsZWxlbWVudFgxOmksZWxlbWVudFgyOmwsZWxlbWVudFkxOnMsZWxlbWVudFkyOmMsc2VsZWN0aW9uQ29sb3JzOltyLmJsYWNrXX0pfWZvcih2YXIgUj0wLEI9T2JqZWN0KHUuZSkodCk7UjxCLmxlbmd0aDtSKyspe0YoQltSXSl9dC5lZGl0aW5nR3JvdXBJZCYmRih0LmVkaXRpbmdHcm91cElkKSxOLmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciB0PWUuYW5nbGUsbj1lLmVsZW1lbnRYMSxyPWUuZWxlbWVudFkxLG89ZS5lbGVtZW50WDIsYT1lLmVsZW1lbnRZMixpPWUuc2VsZWN0aW9uQ29sb3JzLHM9by1uLGw9YS1yLGM9VC5nZXRMaW5lRGFzaCgpLHU9VC5saW5lV2lkdGgscD1ULmxpbmVEYXNoT2Zmc2V0LGg9VC5zdHJva2VTdHlsZSxmPTQvYi56b29tLG09OC9iLnpvb20sZz00L2Iuem9vbTtULmxpbmVXaWR0aD0xL2Iuem9vbTtmb3IodmFyIHk9aS5sZW5ndGgsdj0wO3Y8eTsrK3YpVC5zdHJva2VTdHlsZT1pW3ZdLFQuc2V0TGluZURhc2goW20sZysobStnKSooeS0xKV0pLFQubGluZURhc2hPZmZzZXQ9KG0rZykqdixkKFQsbi1mLHItZixzKzIqZixsKzIqZixuK3MvMixyK2wvMix0KTtULmxpbmVEYXNoT2Zmc2V0PXAsVC5zdHJva2VTdHlsZT1oLFQubGluZVdpZHRoPXUsVC5zZXRMaW5lRGFzaChjKX0pKSxULnRyYW5zbGF0ZSgtYi5zY3JvbGxYLC1iLnNjcm9sbFkpO3ZhciBIPU9iamVjdChpLmMpKGUsdCk7aWYoMT09PUgubGVuZ3RoKXtULnRyYW5zbGF0ZShiLnNjcm9sbFgsYi5zY3JvbGxZKSxULmZpbGxTdHlsZT1yLndoaXRlO3ZhciBHPU9iamVjdChvLnUpKEhbMF0sYi56b29tKTtPYmplY3Qua2V5cyhHKS5mb3JFYWNoKChmdW5jdGlvbihlKXt2YXIgdD1HW2VdO2lmKHZvaWQgMCE9PXQpe3ZhciBuPVQubGluZVdpZHRoO1QubGluZVdpZHRoPTEvYi56b29tLCJyb3RhdGlvbiI9PT1lP3AoVCx0WzBdLHRbMV0sdFsyXSx0WzNdKTpkKFQsdFswXSx0WzFdLHRbMl0sdFszXSx0WzBdK3RbMl0vMix0WzFdK3RbM10vMixIWzBdLmFuZ2xlLCEwKSxULmxpbmVXaWR0aD1ufX0pKSxULnRyYW5zbGF0ZSgtYi5zY3JvbGxYLC1iLnNjcm9sbFkpfWVsc2UgaWYoSC5sZW5ndGg+MSYmIXQuaXNSb3RhdGluZyl7dmFyIFc9NC9iLnpvb207VC50cmFuc2xhdGUoYi5zY3JvbGxYLGIuc2Nyb2xsWSksVC5maWxsU3R5bGU9ci53aGl0ZTt2YXIgVT1PYmplY3Qoby5mKShIKSxWPVVbMF0sSz1VWzFdLFo9VVsyXSxxPVVbM10sWT1ULmdldExpbmVEYXNoKCk7VC5zZXRMaW5lRGFzaChbMi9iLnpvb21dKTt2YXIgWD1ULmxpbmVXaWR0aDtULmxpbmVXaWR0aD0xL2Iuem9vbSxkKFQsVi1XLEstVyxaLVYrMipXLHEtSysyKlcsKFYrWikvMiwoSytxKS8yLDApLFQubGluZVdpZHRoPVgsVC5zZXRMaW5lRGFzaChZKTt2YXIgSj1PYmplY3Qoby52KShbVixLLFoscV0sMCxiLnpvb20sdm9pZCAwLG8uYSk7T2JqZWN0LmtleXMoSikuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dmFyIHQ9SltlXTtpZih2b2lkIDAhPT10KXt2YXIgbj1ULmxpbmVXaWR0aDtULmxpbmVXaWR0aD0xL2Iuem9vbSwicm90YXRpb24iPT09ZT9wKFQsdFswXSx0WzFdLHRbMl0sdFszXSk6ZChULHRbMF0sdFsxXSx0WzJdLHRbM10sdFswXSt0WzJdLzIsdFsxXSt0WzNdLzIsMCwhMCksVC5saW5lV2lkdGg9bn19KSksVC50cmFuc2xhdGUoLWIuc2Nyb2xsWCwtYi5zY3JvbGxZKX19Zm9yKHZhciAkIGluIFQuc2NhbGUoMS9iLnpvb20sMS9iLnpvb20pLFQudHJhbnNsYXRlKC1fLC16KSxiLnJlbW90ZVBvaW50ZXJWaWV3cG9ydENvb3Jkcyl7dmFyIFE9Yi5yZW1vdGVQb2ludGVyVmlld3BvcnRDb29yZHNbJF0sZWU9US54LHRlPVEueSxuZT1iLnJlbW90ZVBvaW50ZXJVc2VybmFtZXNbJF0scmU9ZWU8MHx8ZWU+UC05fHx0ZTwwfHx0ZT5BLTE0O2VlPU1hdGgubWF4KGVlLDApLGVlPU1hdGgubWluKGVlLFAtOSksdGU9TWF0aC5tYXgodGUsMCksdGU9TWF0aC5taW4odGUsQS0xNCk7dmFyIG9lPU9iamVjdChsLmEpKCQpLGFlPW9lLmJhY2tncm91bmQsaWU9b2Uuc3Ryb2tlLHNlPVQuc3Ryb2tlU3R5bGUsbGU9KE09VC5maWxsU3R5bGUsVC5nbG9iYWxBbHBoYSk7aWYoVC5zdHJva2VTdHlsZT1pZSxULmZpbGxTdHlsZT1hZSxyZSYmKFQuZ2xvYmFsQWxwaGE9LjIpLGIucmVtb3RlUG9pbnRlckJ1dHRvbiYmImRvd24iPT09Yi5yZW1vdGVQb2ludGVyQnV0dG9uWyRdJiYoVC5iZWdpblBhdGgoKSxULmFyYyhlZSx0ZSwxNSwwLDIqTWF0aC5QSSwhMSksVC5saW5lV2lkdGg9MyxULnN0cm9rZVN0eWxlPSIjZmZmZmZmODgiLFQuc3Ryb2tlKCksVC5jbG9zZVBhdGgoKSxULmJlZ2luUGF0aCgpLFQuYXJjKGVlLHRlLDE1LDAsMipNYXRoLlBJLCExKSxULmxpbmVXaWR0aD0xLFQuc3Ryb2tlU3R5bGU9aWUsVC5zdHJva2UoKSxULmNsb3NlUGF0aCgpKSxULmJlZ2luUGF0aCgpLFQubW92ZVRvKGVlLHRlKSxULmxpbmVUbyhlZSsxLHRlKzE0KSxULmxpbmVUbyhlZSs0LHRlKzkpLFQubGluZVRvKGVlKzksdGUrMTApLFQubGluZVRvKGVlLHRlKSxULmZpbGwoKSxULnN0cm9rZSgpLCFyZSYmbmUpe3ZhciBjZT1lZSs5LHVlPXRlKzE0LGRlPVQubWVhc3VyZVRleHQobmUpLHBlPWRlLmFjdHVhbEJvdW5kaW5nQm94RGVzY2VudCtkZS5hY3R1YWxCb3VuZGluZ0JveEFzY2VudDtULmZpbGxTdHlsZT1pZSxULmdsb2JhbEFscGhhPWxlLFQuZmlsbFJlY3QoY2UtMSx1ZS0xLGRlLndpZHRoKzgrMixwZSs4KzIpLFQuZmlsbFN0eWxlPWFlLFQuZmlsbFJlY3QoY2UsdWUsZGUud2lkdGgrOCxwZSs4KSxULmZpbGxTdHlsZT1yLndoaXRlLFQuZmlsbFRleHQobmUsY2UrNCx1ZSs0K2RlLmFjdHVhbEJvdW5kaW5nQm94QXNjZW50KX1ULnN0cm9rZVN0eWxlPXNlLFQuZmlsbFN0eWxlPU0sVC5nbG9iYWxBbHBoYT1sZSxULmNsb3NlUGF0aCgpfWlmKHcpe0w9T2JqZWN0KGEuZCkoZSxQLEEsYik7TT1ULmZpbGxTdHlsZSxzZT1ULnN0cm9rZVN0eWxlO1QuZmlsbFN0eWxlPWEuYSxULnN0cm9rZVN0eWxlPSJyZ2JhKDI1NSwyNTUsMjU1LDAuOCkiLFtMLmhvcml6b250YWwsTC52ZXJ0aWNhbF0uZm9yRWFjaCgoZnVuY3Rpb24oZSl7ZSYmZnVuY3Rpb24oZSx0LG4scixvLGEpe2UuYmVnaW5QYXRoKCksZS5tb3ZlVG8odCthLG4pLGUubGluZVRvKHQrci1hLG4pLGUucXVhZHJhdGljQ3VydmVUbyh0K3Isbix0K3IsbithKSxlLmxpbmVUbyh0K3IsbitvLWEpLGUucXVhZHJhdGljQ3VydmVUbyh0K3IsbitvLHQrci1hLG4rbyksZS5saW5lVG8odCthLG4rbyksZS5xdWFkcmF0aWNDdXJ2ZVRvKHQsbitvLHQsbitvLWEpLGUubGluZVRvKHQsbithKSxlLnF1YWRyYXRpY0N1cnZlVG8odCxuLHQrYSxuKSxlLmNsb3NlUGF0aCgpLGUuZmlsbCgpLGUuc3Ryb2tlKCl9KFQsZS54LGUueSxlLndpZHRoLGUuaGVpZ2h0LGEuYy8yKX0pKSxULmZpbGxTdHlsZT1NLFQuc3Ryb2tlU3R5bGU9c2V9cmV0dXJuIFQuc2NhbGUoMS9oLDEvaCkse2F0TGVhc3RPbmVWaXNpYmxlRWxlbWVudDpJLmxlbmd0aD4wLHNjcm9sbEJhcnM6TH19LGY9ZnVuY3Rpb24oZSx0LG4scil7dmFyIGE9ci5zY3JvbGxYLGk9ci5zY3JvbGxZLHM9ci56b29tLGw9T2JqZWN0KG8uaykoZSksYz1sWzBdLHU9bFsxXSxkPWxbMl0scD1sWzNdLGg9dC9zLGY9bi9zLG09dC1oLGc9bi1mO3JldHVybiBkK2EtbS8yPj0wJiZjK2EtbS8yPD1oJiZwK2ktZy8yPj0wJiZ1K2ktZy8yPD1mfSxtPWZ1bmN0aW9uKGUsdCxuLHIpe3ZhciBvPXZvaWQgMD09PXI/e306cixhPW8ub2Zmc2V0WCxpPXZvaWQgMD09PWE/MDphLGw9by5vZmZzZXRZLGM9dm9pZCAwPT09bD8wOmw7biYmZS5mb3JFYWNoKChmdW5jdGlvbihlKXtlLmlzRGVsZXRlZHx8T2JqZWN0KHMuZSkoZSx0LG4sZS54K2ksZS55K2MpfSkpfX0sZnVuY3Rpb24oZSx0LG4peyJ1c2Ugc3RyaWN0Ijt2YXIgcj1uKDcpLG89ZnVuY3Rpb24oKXtmb3IodmFyIGU9MCx0PTAsbj1hcmd1bWVudHMubGVuZ3RoO3Q8bjt0KyspZSs9YXJndW1lbnRzW3RdLmxlbmd0aDt2YXIgcj1BcnJheShlKSxvPTA7Zm9yKHQ9MDt0PG47dCsrKWZvcih2YXIgYT1hcmd1bWVudHNbdF0saT0wLHM9YS5sZW5ndGg7aTxzO2krKyxvKyspcltvXT1hW2ldO3JldHVybiByfSxhPWZ1bmN0aW9uKGUpe3JldHVybltyLnJlZFtlXSxyLnBpbmtbZV0sci5ncmFwZVtlXSxyLnZpb2xldFtlXSxyLmluZGlnb1tlXSxyLmJsdWVbZV0sci5jeWFuW2VdLHIudGVhbFtlXSxyLmdyZWVuW2VdLHIubGltZVtlXSxyLnllbGxvd1tlXSxyLm9yYW5nZVtlXV19O3QuYT17Y2FudmFzQmFja2dyb3VuZDpvKFtyLndoaXRlLHIuZ3JheVswXSxyLmdyYXlbMV1dLGEoMCkpLGVsZW1lbnRCYWNrZ3JvdW5kOm8oWyJ0cmFuc3BhcmVudCIsci5ncmF5WzRdLHIuZ3JheVs2XV0sYSg2KSksZWxlbWVudFN0cm9rZTpvKFtyLmJsYWNrLHIuZ3JheVs4XSxyLmdyYXlbN11dLGEoOSkpfX0sZnVuY3Rpb24oZSx0KXt0LmVuY29kZT1mdW5jdGlvbihlKXt2YXIgdD0iIjtmb3IodmFyIG4gaW4gZSllLmhhc093blByb3BlcnR5KG4pJiYodC5sZW5ndGgmJih0Kz0iJiIpLHQrPWVuY29kZVVSSUNvbXBvbmVudChuKSsiPSIrZW5jb2RlVVJJQ29tcG9uZW50KGVbbl0pKTtyZXR1cm4gdH0sdC5kZWNvZGU9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PXt9LG49ZS5zcGxpdCgiJiIpLHI9MCxvPW4ubGVuZ3RoO3I8bztyKyspe3ZhciBhPW5bcl0uc3BsaXQoIj0iKTt0W2RlY29kZVVSSUNvbXBvbmVudChhWzBdKV09ZGVjb2RlVVJJQ29tcG9uZW50KGFbMV0pfXJldHVybiB0fX0sZnVuY3Rpb24oZSx0KXtlLmV4cG9ydHM9ZnVuY3Rpb24oZSx0KXt2YXIgbj1mdW5jdGlvbigpe307bi5wcm90b3R5cGU9dC5wcm90b3R5cGUsZS5wcm90b3R5cGU9bmV3IG4sZS5wcm90b3R5cGUuY29uc3RydWN0b3I9ZX19LGZ1bmN0aW9uKGUsdCxuKXsidXNlIHN0cmljdCI7bi5kKHQsImEiLChmdW5jdGlvbigpe3JldHVybiBsfSkpO3ZhciByPW4oMzYpLG89bigxNSksYT1mdW5jdGlvbihlLHQpe3ZhciBuLHIsbyxhLGk9e2xhYmVsOjAsc2VudDpmdW5jdGlvbigpe2lmKDEmb1swXSl0aHJvdyBvWzFdO3JldHVybiBvWzFdfSx0cnlzOltdLG9wczpbXX07cmV0dXJuIGE9e25leHQ6cygwKSx0aHJvdzpzKDEpLHJldHVybjpzKDIpfSwiZnVuY3Rpb24iPT10eXBlb2YgU3ltYm9sJiYoYVtTeW1ib2wuaXRlcmF0b3JdPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9KSxhO2Z1bmN0aW9uIHMoYSl7cmV0dXJuIGZ1bmN0aW9uKHMpe3JldHVybiBmdW5jdGlvbihhKXtpZihuKXRocm93IG5ldyBUeXBlRXJyb3IoIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy4iKTtmb3IoO2k7KXRyeXtpZihuPTEsciYmKG89MiZhWzBdP3IucmV0dXJuOmFbMF0/ci50aHJvd3x8KChvPXIucmV0dXJuKSYmby5jYWxsKHIpLDApOnIubmV4dCkmJiEobz1vLmNhbGwocixhWzFdKSkuZG9uZSlyZXR1cm4gbztzd2l0Y2gocj0wLG8mJihhPVsyJmFbMF0sby52YWx1ZV0pLGFbMF0pe2Nhc2UgMDpjYXNlIDE6bz1hO2JyZWFrO2Nhc2UgNDpyZXR1cm4gaS5sYWJlbCsrLHt2YWx1ZTphWzFdLGRvbmU6ITF9O2Nhc2UgNTppLmxhYmVsKysscj1hWzFdLGE9WzBdO2NvbnRpbnVlO2Nhc2UgNzphPWkub3BzLnBvcCgpLGkudHJ5cy5wb3AoKTtjb250aW51ZTtkZWZhdWx0OmlmKCEobz1pLnRyeXMsKG89by5sZW5ndGg+MCYmb1tvLmxlbmd0aC0xXSl8fDYhPT1hWzBdJiYyIT09YVswXSkpe2k9MDtjb250aW51ZX1pZigzPT09YVswXSYmKCFvfHxhWzFdPm9bMF0mJmFbMV08b1szXSkpe2kubGFiZWw9YVsxXTticmVha31pZig2PT09YVswXSYmaS5sYWJlbDxvWzFdKXtpLmxhYmVsPW9bMV0sbz1hO2JyZWFrfWlmKG8mJmkubGFiZWw8b1syXSl7aS5sYWJlbD1vWzJdLGkub3BzLnB1c2goYSk7YnJlYWt9b1syXSYmaS5vcHMucG9wKCksaS50cnlzLnBvcCgpO2NvbnRpbnVlfWE9dC5jYWxsKGUsaSl9Y2F0Y2goZSl7YT1bNixlXSxyPTB9ZmluYWxseXtuPW89MH1pZig1JmFbMF0pdGhyb3cgYVsxXTtyZXR1cm57dmFsdWU6YVswXT9hWzFdOnZvaWQgMCxkb25lOiEwfX0oW2Esc10pfX19LGk9ZnVuY3Rpb24oKXtmb3IodmFyIGU9MCx0PTAsbj1hcmd1bWVudHMubGVuZ3RoO3Q8bjt0KyspZSs9YXJndW1lbnRzW3RdLmxlbmd0aDt2YXIgcj1BcnJheShlKSxvPTA7Zm9yKHQ9MDt0PG47dCsrKWZvcih2YXIgYT1hcmd1bWVudHNbdF0saT0wLHM9YS5sZW5ndGg7aTxzO2krKyxvKyspcltvXT1hW2ldO3JldHVybiByfTtmdW5jdGlvbiBzKGUsdCxuLHIsbyxhLGkpe3RyeXt2YXIgcz1lW2FdKGkpLGw9cy52YWx1ZX1jYXRjaChlKXtyZXR1cm4gdm9pZCBuKGUpfXMuZG9uZT90KGwpOlByb21pc2UucmVzb2x2ZShsKS50aGVuKHIsbyl9dmFyIGw9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7fXJldHVybiBlLmltcG9ydExpYnJhcnk9ZnVuY3Rpb24oZSl7cmV0dXJuKHQ9ZnVuY3Rpb24oKXt2YXIgdCxuLHMsbDtyZXR1cm4gYSh0aGlzLChmdW5jdGlvbihhKXtzd2l0Y2goYS5sYWJlbCl7Y2FzZSAwOnJldHVybls0LE9iamVjdChyLmIpKGUpXTtjYXNlIDE6cmV0dXJuKHQ9YS5zZW50KCkpJiZ0LmxpYnJhcnk/KG49ZnVuY3Rpb24oZSx0KXtyZXR1cm4hZS5maW5kKChmdW5jdGlvbihlKXtyZXR1cm4gZS5sZW5ndGg9PT10Lmxlbmd0aCYmZS5ldmVyeSgoZnVuY3Rpb24oZSxuKXtyZXR1cm4gZS5pZD09PXRbbl0uaWQmJmUudmVyc2lvbk5vbmNlPT09dFtuXS52ZXJzaW9uTm9uY2V9KSl9KSl9LFs0LE9iamVjdChvLmEpKCldKTpbMl07Y2FzZSAyOnJldHVybiBzPWEuc2VudCgpLGw9dC5saWJyYXJ5LmZpbHRlcigoZnVuY3Rpb24oZSl7cmV0dXJuIG4ocyxlKX0pKSxPYmplY3Qoby5iKShpKHMsbCkpLFsyXX19KSl9LGZ1bmN0aW9uKCl7dmFyIGU9dGhpcyxuPWFyZ3VtZW50cztyZXR1cm4gbmV3IFByb21pc2UoKGZ1bmN0aW9uKHIsbyl7dmFyIGE9dC5hcHBseShlLG4pO2Z1bmN0aW9uIGkoZSl7cyhhLHIsbyxpLGwsIm5leHQiLGUpfWZ1bmN0aW9uIGwoZSl7cyhhLHIsbyxpLGwsInRocm93IixlKX1pKHZvaWQgMCl9KSl9KSgpO3ZhciB0fSxlfSgpfSxmdW5jdGlvbihlLHQpe3ZhciBuLHIsbz1lLmV4cG9ydHM9e307ZnVuY3Rpb24gYSgpe3Rocm93IG5ldyBFcnJvcigic2V0VGltZW91dCBoYXMgbm90IGJlZW4gZGVmaW5lZCIpfWZ1bmN0aW9uIGkoKXt0aHJvdyBuZXcgRXJyb3IoImNsZWFyVGltZW91dCBoYXMgbm90IGJlZW4gZGVmaW5lZCIpfWZ1bmN0aW9uIHMoZSl7aWYobj09PXNldFRpbWVvdXQpcmV0dXJuIHNldFRpbWVvdXQoZSwwKTtpZigobj09PWF8fCFuKSYmc2V0VGltZW91dClyZXR1cm4gbj1zZXRUaW1lb3V0LHNldFRpbWVvdXQoZSwwKTt0cnl7cmV0dXJuIG4oZSwwKX1jYXRjaCh0KXt0cnl7cmV0dXJuIG4uY2FsbChudWxsLGUsMCl9Y2F0Y2godCl7cmV0dXJuIG4uY2FsbCh0aGlzLGUsMCl9fX0hZnVuY3Rpb24oKXt0cnl7bj0iZnVuY3Rpb24iPT10eXBlb2Ygc2V0VGltZW91dD9zZXRUaW1lb3V0OmF9Y2F0Y2goZSl7bj1hfXRyeXtyPSJmdW5jdGlvbiI9PXR5cGVvZiBjbGVhclRpbWVvdXQ/Y2xlYXJUaW1lb3V0Oml9Y2F0Y2goZSl7cj1pfX0oKTt2YXIgbCxjPVtdLHU9ITEsZD0tMTtmdW5jdGlvbiBwKCl7dSYmbCYmKHU9ITEsbC5sZW5ndGg/Yz1sLmNvbmNhdChjKTpkPS0xLGMubGVuZ3RoJiZoKCkpfWZ1bmN0aW9uIGgoKXtpZighdSl7dmFyIGU9cyhwKTt1PSEwO2Zvcih2YXIgdD1jLmxlbmd0aDt0Oyl7Zm9yKGw9YyxjPVtdOysrZDx0OylsJiZsW2RdLnJ1bigpO2Q9LTEsdD1jLmxlbmd0aH1sPW51bGwsdT0hMSxmdW5jdGlvbihlKXtpZihyPT09Y2xlYXJUaW1lb3V0KXJldHVybiBjbGVhclRpbWVvdXQoZSk7aWYoKHI9PT1pfHwhcikmJmNsZWFyVGltZW91dClyZXR1cm4gcj1jbGVhclRpbWVvdXQsY2xlYXJUaW1lb3V0KGUpO3RyeXtyKGUpfWNhdGNoKHQpe3RyeXtyZXR1cm4gci5jYWxsKG51bGwsZSl9Y2F0Y2godCl7cmV0dXJuIHIuY2FsbCh0aGlzLGUpfX19KGUpfX1mdW5jdGlvbiBmKGUsdCl7dGhpcy5mdW49ZSx0aGlzLmFycmF5PXR9ZnVuY3Rpb24gbSgpe31vLm5leHRUaWNrPWZ1bmN0aW9uKGUpe3ZhciB0PW5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoLTEpO2lmKGFyZ3VtZW50cy5sZW5ndGg+MSlmb3IodmFyIG49MTtuPGFyZ3VtZW50cy5sZW5ndGg7bisrKXRbbi0xXT1hcmd1bWVudHNbbl07Yy5wdXNoKG5ldyBmKGUsdCkpLDEhPT1jLmxlbmd0aHx8dXx8cyhoKX0sZi5wcm90b3R5cGUucnVuPWZ1bmN0aW9uKCl7dGhpcy5mdW4uYXBwbHkobnVsbCx0aGlzLmFycmF5KX0sby50aXRsZT0iYnJvd3NlciIsby5icm93c2VyPSEwLG8uZW52PXt9LG8uYXJndj1bXSxvLnZlcnNpb249IiIsby52ZXJzaW9ucz17fSxvLm9uPW0sby5hZGRMaXN0ZW5lcj1tLG8ub25jZT1tLG8ub2ZmPW0sby5yZW1vdmVMaXN0ZW5lcj1tLG8ucmVtb3ZlQWxsTGlzdGVuZXJzPW0sby5lbWl0PW0sby5wcmVwZW5kTGlzdGVuZXI9bSxvLnByZXBlbmRPbmNlTGlzdGVuZXI9bSxvLmxpc3RlbmVycz1mdW5jdGlvbihlKXtyZXR1cm5bXX0sby5iaW5kaW5nPWZ1bmN0aW9uKGUpe3Rocm93IG5ldyBFcnJvcigicHJvY2Vzcy5iaW5kaW5nIGlzIG5vdCBzdXBwb3J0ZWQiKX0sby5jd2Q9ZnVuY3Rpb24oKXtyZXR1cm4iLyJ9LG8uY2hkaXI9ZnVuY3Rpb24oZSl7dGhyb3cgbmV3IEVycm9yKCJwcm9jZXNzLmNoZGlyIGlzIG5vdCBzdXBwb3J0ZWQiKX0sby51bWFzaz1mdW5jdGlvbigpe3JldHVybiAwfX0sZnVuY3Rpb24oZSx0KXt2YXIgbjtuPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9KCk7dHJ5e249bnx8bmV3IEZ1bmN0aW9uKCJyZXR1cm4gdGhpcyIpKCl9Y2F0Y2goZSl7Im9iamVjdCI9PXR5cGVvZiB3aW5kb3cmJihuPXdpbmRvdyl9ZS5leHBvcnRzPW59LGZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1uKDEyMSkoInNvY2tldC5pby1wYXJzZXIiKSxvPW4oMTI0KSxhPW4oMTI1KSxpPW4oNTUpLHM9big1Nik7ZnVuY3Rpb24gbCgpe310LnByb3RvY29sPTQsdC50eXBlcz1bIkNPTk5FQ1QiLCJESVNDT05ORUNUIiwiRVZFTlQiLCJBQ0siLCJFUlJPUiIsIkJJTkFSWV9FVkVOVCIsIkJJTkFSWV9BQ0siXSx0LkNPTk5FQ1Q9MCx0LkRJU0NPTk5FQ1Q9MSx0LkVWRU5UPTIsdC5BQ0s9Myx0LkVSUk9SPTQsdC5CSU5BUllfRVZFTlQ9NSx0LkJJTkFSWV9BQ0s9Nix0LkVuY29kZXI9bCx0LkRlY29kZXI9ZDt2YXIgYz10LkVSUk9SKyciZW5jb2RlIGVycm9yIic7ZnVuY3Rpb24gdShlKXt2YXIgbj0iIitlLnR5cGU7aWYodC5CSU5BUllfRVZFTlQhPT1lLnR5cGUmJnQuQklOQVJZX0FDSyE9PWUudHlwZXx8KG4rPWUuYXR0YWNobWVudHMrIi0iKSxlLm5zcCYmIi8iIT09ZS5uc3AmJihuKz1lLm5zcCsiLCIpLG51bGwhPWUuaWQmJihuKz1lLmlkKSxudWxsIT1lLmRhdGEpe3ZhciBvPWZ1bmN0aW9uKGUpe3RyeXtyZXR1cm4gSlNPTi5zdHJpbmdpZnkoZSl9Y2F0Y2goZSl7cmV0dXJuITF9fShlLmRhdGEpO2lmKCExPT09bylyZXR1cm4gYztuKz1vfXJldHVybiByKCJlbmNvZGVkICVqIGFzICVzIixlLG4pLG59ZnVuY3Rpb24gZCgpe3RoaXMucmVjb25zdHJ1Y3Rvcj1udWxsfWZ1bmN0aW9uIHAoZSl7dGhpcy5yZWNvblBhY2s9ZSx0aGlzLmJ1ZmZlcnM9W119ZnVuY3Rpb24gaChlKXtyZXR1cm57dHlwZTp0LkVSUk9SLGRhdGE6InBhcnNlciBlcnJvcjogIitlfX1sLnByb3RvdHlwZS5lbmNvZGU9ZnVuY3Rpb24oZSxuKXsocigiZW5jb2RpbmcgcGFja2V0ICVqIixlKSx0LkJJTkFSWV9FVkVOVD09PWUudHlwZXx8dC5CSU5BUllfQUNLPT09ZS50eXBlKT9mdW5jdGlvbihlLHQpe2EucmVtb3ZlQmxvYnMoZSwoZnVuY3Rpb24oZSl7dmFyIG49YS5kZWNvbnN0cnVjdFBhY2tldChlKSxyPXUobi5wYWNrZXQpLG89bi5idWZmZXJzO28udW5zaGlmdChyKSx0KG8pfSkpfShlLG4pOm4oW3UoZSldKX0sbyhkLnByb3RvdHlwZSksZC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGUpe3ZhciBuO2lmKCJzdHJpbmciPT10eXBlb2YgZSluPWZ1bmN0aW9uKGUpe3ZhciBuPTAsbz17dHlwZTpOdW1iZXIoZS5jaGFyQXQoMCkpfTtpZihudWxsPT10LnR5cGVzW28udHlwZV0pcmV0dXJuIGgoInVua25vd24gcGFja2V0IHR5cGUgIitvLnR5cGUpO2lmKHQuQklOQVJZX0VWRU5UPT09by50eXBlfHx0LkJJTkFSWV9BQ0s9PT1vLnR5cGUpe2Zvcih2YXIgYT0iIjsiLSIhPT1lLmNoYXJBdCgrK24pJiYoYSs9ZS5jaGFyQXQobiksbiE9ZS5sZW5ndGgpOyk7aWYoYSE9TnVtYmVyKGEpfHwiLSIhPT1lLmNoYXJBdChuKSl0aHJvdyBuZXcgRXJyb3IoIklsbGVnYWwgYXR0YWNobWVudHMiKTtvLmF0dGFjaG1lbnRzPU51bWJlcihhKX1pZigiLyI9PT1lLmNoYXJBdChuKzEpKWZvcihvLm5zcD0iIjsrK247KXtpZigiLCI9PT0obD1lLmNoYXJBdChuKSkpYnJlYWs7aWYoby5uc3ArPWwsbj09PWUubGVuZ3RoKWJyZWFrfWVsc2Ugby5uc3A9Ii8iO3ZhciBzPWUuY2hhckF0KG4rMSk7aWYoIiIhPT1zJiZOdW1iZXIocyk9PXMpe2ZvcihvLmlkPSIiOysrbjspe3ZhciBsO2lmKG51bGw9PShsPWUuY2hhckF0KG4pKXx8TnVtYmVyKGwpIT1sKXstLW47YnJlYWt9aWYoby5pZCs9ZS5jaGFyQXQobiksbj09PWUubGVuZ3RoKWJyZWFrfW8uaWQ9TnVtYmVyKG8uaWQpfWlmKGUuY2hhckF0KCsrbikpe3ZhciBjPWZ1bmN0aW9uKGUpe3RyeXtyZXR1cm4gSlNPTi5wYXJzZShlKX1jYXRjaChlKXtyZXR1cm4hMX19KGUuc3Vic3RyKG4pKTtpZighKCExIT09YyYmKG8udHlwZT09PXQuRVJST1J8fGkoYykpKSlyZXR1cm4gaCgiaW52YWxpZCBwYXlsb2FkIik7by5kYXRhPWN9cmV0dXJuIHIoImRlY29kZWQgJXMgYXMgJWoiLGUsbyksb30oZSksdC5CSU5BUllfRVZFTlQ9PT1uLnR5cGV8fHQuQklOQVJZX0FDSz09PW4udHlwZT8odGhpcy5yZWNvbnN0cnVjdG9yPW5ldyBwKG4pLDA9PT10aGlzLnJlY29uc3RydWN0b3IucmVjb25QYWNrLmF0dGFjaG1lbnRzJiZ0aGlzLmVtaXQoImRlY29kZWQiLG4pKTp0aGlzLmVtaXQoImRlY29kZWQiLG4pO2Vsc2V7aWYoIXMoZSkmJiFlLmJhc2U2NCl0aHJvdyBuZXcgRXJyb3IoIlVua25vd24gdHlwZTogIitlKTtpZighdGhpcy5yZWNvbnN0cnVjdG9yKXRocm93IG5ldyBFcnJvcigiZ290IGJpbmFyeSBkYXRhIHdoZW4gbm90IHJlY29uc3RydWN0aW5nIGEgcGFja2V0Iik7KG49dGhpcy5yZWNvbnN0cnVjdG9yLnRha2VCaW5hcnlEYXRhKGUpKSYmKHRoaXMucmVjb25zdHJ1Y3Rvcj1udWxsLHRoaXMuZW1pdCgiZGVjb2RlZCIsbikpfX0sZC5wcm90b3R5cGUuZGVzdHJveT1mdW5jdGlvbigpe3RoaXMucmVjb25zdHJ1Y3RvciYmdGhpcy5yZWNvbnN0cnVjdG9yLmZpbmlzaGVkUmVjb25zdHJ1Y3Rpb24oKX0scC5wcm90b3R5cGUudGFrZUJpbmFyeURhdGE9ZnVuY3Rpb24oZSl7aWYodGhpcy5idWZmZXJzLnB1c2goZSksdGhpcy5idWZmZXJzLmxlbmd0aD09PXRoaXMucmVjb25QYWNrLmF0dGFjaG1lbnRzKXt2YXIgdD1hLnJlY29uc3RydWN0UGFja2V0KHRoaXMucmVjb25QYWNrLHRoaXMuYnVmZmVycyk7cmV0dXJuIHRoaXMuZmluaXNoZWRSZWNvbnN0cnVjdGlvbigpLHR9cmV0dXJuIG51bGx9LHAucHJvdG90eXBlLmZpbmlzaGVkUmVjb25zdHJ1Y3Rpb249ZnVuY3Rpb24oKXt0aGlzLnJlY29uUGFjaz1udWxsLHRoaXMuYnVmZmVycz1bXX19LGZ1bmN0aW9uKGUsdCxuKXsidXNlIHN0cmljdCI7KGZ1bmN0aW9uKGUpe3ZhciByPW4oMTI2KSxvPW4oMTI3KSxhPW4oMTI4KTtmdW5jdGlvbiBpKCl7cmV0dXJuIGwuVFlQRURfQVJSQVlfU1VQUE9SVD8yMTQ3NDgzNjQ3OjEwNzM3NDE4MjN9ZnVuY3Rpb24gcyhlLHQpe2lmKGkoKTx0KXRocm93IG5ldyBSYW5nZUVycm9yKCJJbnZhbGlkIHR5cGVkIGFycmF5IGxlbmd0aCIpO3JldHVybiBsLlRZUEVEX0FSUkFZX1NVUFBPUlQ/KGU9bmV3IFVpbnQ4QXJyYXkodCkpLl9fcHJvdG9fXz1sLnByb3RvdHlwZToobnVsbD09PWUmJihlPW5ldyBsKHQpKSxlLmxlbmd0aD10KSxlfWZ1bmN0aW9uIGwoZSx0LG4pe2lmKCEobC5UWVBFRF9BUlJBWV9TVVBQT1JUfHx0aGlzIGluc3RhbmNlb2YgbCkpcmV0dXJuIG5ldyBsKGUsdCxuKTtpZigibnVtYmVyIj09dHlwZW9mIGUpe2lmKCJzdHJpbmciPT10eXBlb2YgdCl0aHJvdyBuZXcgRXJyb3IoIklmIGVuY29kaW5nIGlzIHNwZWNpZmllZCB0aGVuIHRoZSBmaXJzdCBhcmd1bWVudCBtdXN0IGJlIGEgc3RyaW5nIik7cmV0dXJuIGQodGhpcyxlKX1yZXR1cm4gYyh0aGlzLGUsdCxuKX1mdW5jdGlvbiBjKGUsdCxuLHIpe2lmKCJudW1iZXIiPT10eXBlb2YgdCl0aHJvdyBuZXcgVHlwZUVycm9yKCcidmFsdWUiIGFyZ3VtZW50IG11c3Qgbm90IGJlIGEgbnVtYmVyJyk7cmV0dXJuInVuZGVmaW5lZCIhPXR5cGVvZiBBcnJheUJ1ZmZlciYmdCBpbnN0YW5jZW9mIEFycmF5QnVmZmVyP2Z1bmN0aW9uKGUsdCxuLHIpe2lmKHQuYnl0ZUxlbmd0aCxuPDB8fHQuYnl0ZUxlbmd0aDxuKXRocm93IG5ldyBSYW5nZUVycm9yKCInb2Zmc2V0JyBpcyBvdXQgb2YgYm91bmRzIik7aWYodC5ieXRlTGVuZ3RoPG4rKHJ8fDApKXRocm93IG5ldyBSYW5nZUVycm9yKCInbGVuZ3RoJyBpcyBvdXQgb2YgYm91bmRzIik7dD12b2lkIDA9PT1uJiZ2b2lkIDA9PT1yP25ldyBVaW50OEFycmF5KHQpOnZvaWQgMD09PXI/bmV3IFVpbnQ4QXJyYXkodCxuKTpuZXcgVWludDhBcnJheSh0LG4scik7bC5UWVBFRF9BUlJBWV9TVVBQT1JUPyhlPXQpLl9fcHJvdG9fXz1sLnByb3RvdHlwZTplPXAoZSx0KTtyZXR1cm4gZX0oZSx0LG4scik6InN0cmluZyI9PXR5cGVvZiB0P2Z1bmN0aW9uKGUsdCxuKXsic3RyaW5nIj09dHlwZW9mIG4mJiIiIT09bnx8KG49InV0ZjgiKTtpZighbC5pc0VuY29kaW5nKG4pKXRocm93IG5ldyBUeXBlRXJyb3IoJyJlbmNvZGluZyIgbXVzdCBiZSBhIHZhbGlkIHN0cmluZyBlbmNvZGluZycpO3ZhciByPTB8Zih0LG4pLG89KGU9cyhlLHIpKS53cml0ZSh0LG4pO28hPT1yJiYoZT1lLnNsaWNlKDAsbykpO3JldHVybiBlfShlLHQsbik6ZnVuY3Rpb24oZSx0KXtpZihsLmlzQnVmZmVyKHQpKXt2YXIgbj0wfGgodC5sZW5ndGgpO3JldHVybiAwPT09KGU9cyhlLG4pKS5sZW5ndGh8fHQuY29weShlLDAsMCxuKSxlfWlmKHQpe2lmKCJ1bmRlZmluZWQiIT10eXBlb2YgQXJyYXlCdWZmZXImJnQuYnVmZmVyIGluc3RhbmNlb2YgQXJyYXlCdWZmZXJ8fCJsZW5ndGgiaW4gdClyZXR1cm4ibnVtYmVyIiE9dHlwZW9mIHQubGVuZ3RofHwocj10Lmxlbmd0aCkhPXI/cyhlLDApOnAoZSx0KTtpZigiQnVmZmVyIj09PXQudHlwZSYmYSh0LmRhdGEpKXJldHVybiBwKGUsdC5kYXRhKX12YXIgcjt0aHJvdyBuZXcgVHlwZUVycm9yKCJGaXJzdCBhcmd1bWVudCBtdXN0IGJlIGEgc3RyaW5nLCBCdWZmZXIsIEFycmF5QnVmZmVyLCBBcnJheSwgb3IgYXJyYXktbGlrZSBvYmplY3QuIil9KGUsdCl9ZnVuY3Rpb24gdShlKXtpZigibnVtYmVyIiE9dHlwZW9mIGUpdGhyb3cgbmV3IFR5cGVFcnJvcignInNpemUiIGFyZ3VtZW50IG11c3QgYmUgYSBudW1iZXInKTtpZihlPDApdGhyb3cgbmV3IFJhbmdlRXJyb3IoJyJzaXplIiBhcmd1bWVudCBtdXN0IG5vdCBiZSBuZWdhdGl2ZScpfWZ1bmN0aW9uIGQoZSx0KXtpZih1KHQpLGU9cyhlLHQ8MD8wOjB8aCh0KSksIWwuVFlQRURfQVJSQVlfU1VQUE9SVClmb3IodmFyIG49MDtuPHQ7KytuKWVbbl09MDtyZXR1cm4gZX1mdW5jdGlvbiBwKGUsdCl7dmFyIG49dC5sZW5ndGg8MD8wOjB8aCh0Lmxlbmd0aCk7ZT1zKGUsbik7Zm9yKHZhciByPTA7cjxuO3IrPTEpZVtyXT0yNTUmdFtyXTtyZXR1cm4gZX1mdW5jdGlvbiBoKGUpe2lmKGU+PWkoKSl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiQXR0ZW1wdCB0byBhbGxvY2F0ZSBCdWZmZXIgbGFyZ2VyIHRoYW4gbWF4aW11bSBzaXplOiAweCIraSgpLnRvU3RyaW5nKDE2KSsiIGJ5dGVzIik7cmV0dXJuIDB8ZX1mdW5jdGlvbiBmKGUsdCl7aWYobC5pc0J1ZmZlcihlKSlyZXR1cm4gZS5sZW5ndGg7aWYoInVuZGVmaW5lZCIhPXR5cGVvZiBBcnJheUJ1ZmZlciYmImZ1bmN0aW9uIj09dHlwZW9mIEFycmF5QnVmZmVyLmlzVmlldyYmKEFycmF5QnVmZmVyLmlzVmlldyhlKXx8ZSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSlyZXR1cm4gZS5ieXRlTGVuZ3RoOyJzdHJpbmciIT10eXBlb2YgZSYmKGU9IiIrZSk7dmFyIG49ZS5sZW5ndGg7aWYoMD09PW4pcmV0dXJuIDA7Zm9yKHZhciByPSExOzspc3dpdGNoKHQpe2Nhc2UiYXNjaWkiOmNhc2UibGF0aW4xIjpjYXNlImJpbmFyeSI6cmV0dXJuIG47Y2FzZSJ1dGY4IjpjYXNlInV0Zi04IjpjYXNlIHZvaWQgMDpyZXR1cm4gQihlKS5sZW5ndGg7Y2FzZSJ1Y3MyIjpjYXNlInVjcy0yIjpjYXNlInV0ZjE2bGUiOmNhc2UidXRmLTE2bGUiOnJldHVybiAyKm47Y2FzZSJoZXgiOnJldHVybiBuPj4+MTtjYXNlImJhc2U2NCI6cmV0dXJuIEgoZSkubGVuZ3RoO2RlZmF1bHQ6aWYocilyZXR1cm4gQihlKS5sZW5ndGg7dD0oIiIrdCkudG9Mb3dlckNhc2UoKSxyPSEwfX1mdW5jdGlvbiBtKGUsdCxuKXt2YXIgcj0hMTtpZigodm9pZCAwPT09dHx8dDwwKSYmKHQ9MCksdD50aGlzLmxlbmd0aClyZXR1cm4iIjtpZigodm9pZCAwPT09bnx8bj50aGlzLmxlbmd0aCkmJihuPXRoaXMubGVuZ3RoKSxuPD0wKXJldHVybiIiO2lmKChuPj4+PTApPD0odD4+Pj0wKSlyZXR1cm4iIjtmb3IoZXx8KGU9InV0ZjgiKTs7KXN3aXRjaChlKXtjYXNlImhleCI6cmV0dXJuIFAodGhpcyx0LG4pO2Nhc2UidXRmOCI6Y2FzZSJ1dGYtOCI6cmV0dXJuIHgodGhpcyx0LG4pO2Nhc2UiYXNjaWkiOnJldHVybiBqKHRoaXMsdCxuKTtjYXNlImxhdGluMSI6Y2FzZSJiaW5hcnkiOnJldHVybiBUKHRoaXMsdCxuKTtjYXNlImJhc2U2NCI6cmV0dXJuIEModGhpcyx0LG4pO2Nhc2UidWNzMiI6Y2FzZSJ1Y3MtMiI6Y2FzZSJ1dGYxNmxlIjpjYXNlInV0Zi0xNmxlIjpyZXR1cm4gQSh0aGlzLHQsbik7ZGVmYXVsdDppZihyKXRocm93IG5ldyBUeXBlRXJyb3IoIlVua25vd24gZW5jb2Rpbmc6ICIrZSk7ZT0oZSsiIikudG9Mb3dlckNhc2UoKSxyPSEwfX1mdW5jdGlvbiBnKGUsdCxuKXt2YXIgcj1lW3RdO2VbdF09ZVtuXSxlW25dPXJ9ZnVuY3Rpb24gYihlLHQsbixyLG8pe2lmKDA9PT1lLmxlbmd0aClyZXR1cm4tMTtpZigic3RyaW5nIj09dHlwZW9mIG4/KHI9bixuPTApOm4+MjE0NzQ4MzY0Nz9uPTIxNDc0ODM2NDc6bjwtMjE0NzQ4MzY0OCYmKG49LTIxNDc0ODM2NDgpLG49K24saXNOYU4obikmJihuPW8/MDplLmxlbmd0aC0xKSxuPDAmJihuPWUubGVuZ3RoK24pLG4+PWUubGVuZ3RoKXtpZihvKXJldHVybi0xO249ZS5sZW5ndGgtMX1lbHNlIGlmKG48MCl7aWYoIW8pcmV0dXJuLTE7bj0wfWlmKCJzdHJpbmciPT10eXBlb2YgdCYmKHQ9bC5mcm9tKHQscikpLGwuaXNCdWZmZXIodCkpcmV0dXJuIDA9PT10Lmxlbmd0aD8tMTp5KGUsdCxuLHIsbyk7aWYoIm51bWJlciI9PXR5cGVvZiB0KXJldHVybiB0Jj0yNTUsbC5UWVBFRF9BUlJBWV9TVVBQT1JUJiYiZnVuY3Rpb24iPT10eXBlb2YgVWludDhBcnJheS5wcm90b3R5cGUuaW5kZXhPZj9vP1VpbnQ4QXJyYXkucHJvdG90eXBlLmluZGV4T2YuY2FsbChlLHQsbik6VWludDhBcnJheS5wcm90b3R5cGUubGFzdEluZGV4T2YuY2FsbChlLHQsbik6eShlLFt0XSxuLHIsbyk7dGhyb3cgbmV3IFR5cGVFcnJvcigidmFsIG11c3QgYmUgc3RyaW5nLCBudW1iZXIgb3IgQnVmZmVyIil9ZnVuY3Rpb24geShlLHQsbixyLG8pe3ZhciBhLGk9MSxzPWUubGVuZ3RoLGw9dC5sZW5ndGg7aWYodm9pZCAwIT09ciYmKCJ1Y3MyIj09PShyPVN0cmluZyhyKS50b0xvd2VyQ2FzZSgpKXx8InVjcy0yIj09PXJ8fCJ1dGYxNmxlIj09PXJ8fCJ1dGYtMTZsZSI9PT1yKSl7aWYoZS5sZW5ndGg8Mnx8dC5sZW5ndGg8MilyZXR1cm4tMTtpPTIscy89MixsLz0yLG4vPTJ9ZnVuY3Rpb24gYyhlLHQpe3JldHVybiAxPT09aT9lW3RdOmUucmVhZFVJbnQxNkJFKHQqaSl9aWYobyl7dmFyIHU9LTE7Zm9yKGE9bjthPHM7YSsrKWlmKGMoZSxhKT09PWModCwtMT09PXU/MDphLXUpKXtpZigtMT09PXUmJih1PWEpLGEtdSsxPT09bClyZXR1cm4gdSppfWVsc2UtMSE9PXUmJihhLT1hLXUpLHU9LTF9ZWxzZSBmb3IobitsPnMmJihuPXMtbCksYT1uO2E+PTA7YS0tKXtmb3IodmFyIGQ9ITAscD0wO3A8bDtwKyspaWYoYyhlLGErcCkhPT1jKHQscCkpe2Q9ITE7YnJlYWt9aWYoZClyZXR1cm4gYX1yZXR1cm4tMX1mdW5jdGlvbiB2KGUsdCxuLHIpe249TnVtYmVyKG4pfHwwO3ZhciBvPWUubGVuZ3RoLW47cj8ocj1OdW1iZXIocikpPm8mJihyPW8pOnI9bzt2YXIgYT10Lmxlbmd0aDtpZihhJTIhPTApdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBoZXggc3RyaW5nIik7cj5hLzImJihyPWEvMik7Zm9yKHZhciBpPTA7aTxyOysraSl7dmFyIHM9cGFyc2VJbnQodC5zdWJzdHIoMippLDIpLDE2KTtpZihpc05hTihzKSlyZXR1cm4gaTtlW24raV09c31yZXR1cm4gaX1mdW5jdGlvbiBrKGUsdCxuLHIpe3JldHVybiBHKEIodCxlLmxlbmd0aC1uKSxlLG4scil9ZnVuY3Rpb24gdyhlLHQsbixyKXtyZXR1cm4gRyhmdW5jdGlvbihlKXtmb3IodmFyIHQ9W10sbj0wO248ZS5sZW5ndGg7KytuKXQucHVzaCgyNTUmZS5jaGFyQ29kZUF0KG4pKTtyZXR1cm4gdH0odCksZSxuLHIpfWZ1bmN0aW9uIFMoZSx0LG4scil7cmV0dXJuIHcoZSx0LG4scil9ZnVuY3Rpb24gRShlLHQsbixyKXtyZXR1cm4gRyhIKHQpLGUsbixyKX1mdW5jdGlvbiBPKGUsdCxuLHIpe3JldHVybiBHKGZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBuLHIsbyxhPVtdLGk9MDtpPGUubGVuZ3RoJiYhKCh0LT0yKTwwKTsrK2kpbj1lLmNoYXJDb2RlQXQoaSkscj1uPj44LG89biUyNTYsYS5wdXNoKG8pLGEucHVzaChyKTtyZXR1cm4gYX0odCxlLmxlbmd0aC1uKSxlLG4scil9ZnVuY3Rpb24gQyhlLHQsbil7cmV0dXJuIDA9PT10JiZuPT09ZS5sZW5ndGg/ci5mcm9tQnl0ZUFycmF5KGUpOnIuZnJvbUJ5dGVBcnJheShlLnNsaWNlKHQsbikpfWZ1bmN0aW9uIHgoZSx0LG4pe249TWF0aC5taW4oZS5sZW5ndGgsbik7Zm9yKHZhciByPVtdLG89dDtvPG47KXt2YXIgYSxpLHMsbCxjPWVbb10sdT1udWxsLGQ9Yz4yMzk/NDpjPjIyMz8zOmM+MTkxPzI6MTtpZihvK2Q8PW4pc3dpdGNoKGQpe2Nhc2UgMTpjPDEyOCYmKHU9Yyk7YnJlYWs7Y2FzZSAyOjEyOD09KDE5MiYoYT1lW28rMV0pKSYmKGw9KDMxJmMpPDw2fDYzJmEpPjEyNyYmKHU9bCk7YnJlYWs7Y2FzZSAzOmE9ZVtvKzFdLGk9ZVtvKzJdLDEyOD09KDE5MiZhKSYmMTI4PT0oMTkyJmkpJiYobD0oMTUmYyk8PDEyfCg2MyZhKTw8Nnw2MyZpKT4yMDQ3JiYobDw1NTI5Nnx8bD41NzM0MykmJih1PWwpO2JyZWFrO2Nhc2UgNDphPWVbbysxXSxpPWVbbysyXSxzPWVbbyszXSwxMjg9PSgxOTImYSkmJjEyOD09KDE5MiZpKSYmMTI4PT0oMTkyJnMpJiYobD0oMTUmYyk8PDE4fCg2MyZhKTw8MTJ8KDYzJmkpPDw2fDYzJnMpPjY1NTM1JiZsPDExMTQxMTImJih1PWwpfW51bGw9PT11Pyh1PTY1NTMzLGQ9MSk6dT42NTUzNSYmKHUtPTY1NTM2LHIucHVzaCh1Pj4+MTAmMTAyM3w1NTI5NiksdT01NjMyMHwxMDIzJnUpLHIucHVzaCh1KSxvKz1kfXJldHVybiBmdW5jdGlvbihlKXt2YXIgdD1lLmxlbmd0aDtpZih0PD00MDk2KXJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KFN0cmluZyxlKTt2YXIgbj0iIixyPTA7Zm9yKDtyPHQ7KW4rPVN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkoU3RyaW5nLGUuc2xpY2UocixyKz00MDk2KSk7cmV0dXJuIG59KHIpfXQuQnVmZmVyPWwsdC5TbG93QnVmZmVyPWZ1bmN0aW9uKGUpeytlIT1lJiYoZT0wKTtyZXR1cm4gbC5hbGxvYygrZSl9LHQuSU5TUEVDVF9NQVhfQllURVM9NTAsbC5UWVBFRF9BUlJBWV9TVVBQT1JUPXZvaWQgMCE9PWUuVFlQRURfQVJSQVlfU1VQUE9SVD9lLlRZUEVEX0FSUkFZX1NVUFBPUlQ6ZnVuY3Rpb24oKXt0cnl7dmFyIGU9bmV3IFVpbnQ4QXJyYXkoMSk7cmV0dXJuIGUuX19wcm90b19fPXtfX3Byb3RvX186VWludDhBcnJheS5wcm90b3R5cGUsZm9vOmZ1bmN0aW9uKCl7cmV0dXJuIDQyfX0sNDI9PT1lLmZvbygpJiYiZnVuY3Rpb24iPT10eXBlb2YgZS5zdWJhcnJheSYmMD09PWUuc3ViYXJyYXkoMSwxKS5ieXRlTGVuZ3RofWNhdGNoKGUpe3JldHVybiExfX0oKSx0LmtNYXhMZW5ndGg9aSgpLGwucG9vbFNpemU9ODE5MixsLl9hdWdtZW50PWZ1bmN0aW9uKGUpe3JldHVybiBlLl9fcHJvdG9fXz1sLnByb3RvdHlwZSxlfSxsLmZyb209ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBjKG51bGwsZSx0LG4pfSxsLlRZUEVEX0FSUkFZX1NVUFBPUlQmJihsLnByb3RvdHlwZS5fX3Byb3RvX189VWludDhBcnJheS5wcm90b3R5cGUsbC5fX3Byb3RvX189VWludDhBcnJheSwidW5kZWZpbmVkIiE9dHlwZW9mIFN5bWJvbCYmU3ltYm9sLnNwZWNpZXMmJmxbU3ltYm9sLnNwZWNpZXNdPT09bCYmT2JqZWN0LmRlZmluZVByb3BlcnR5KGwsU3ltYm9sLnNwZWNpZXMse3ZhbHVlOm51bGwsY29uZmlndXJhYmxlOiEwfSkpLGwuYWxsb2M9ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBmdW5jdGlvbihlLHQsbixyKXtyZXR1cm4gdSh0KSx0PD0wP3MoZSx0KTp2b2lkIDAhPT1uPyJzdHJpbmciPT10eXBlb2Ygcj9zKGUsdCkuZmlsbChuLHIpOnMoZSx0KS5maWxsKG4pOnMoZSx0KX0obnVsbCxlLHQsbil9LGwuYWxsb2NVbnNhZmU9ZnVuY3Rpb24oZSl7cmV0dXJuIGQobnVsbCxlKX0sbC5hbGxvY1Vuc2FmZVNsb3c9ZnVuY3Rpb24oZSl7cmV0dXJuIGQobnVsbCxlKX0sbC5pc0J1ZmZlcj1mdW5jdGlvbihlKXtyZXR1cm4hKG51bGw9PWV8fCFlLl9pc0J1ZmZlcil9LGwuY29tcGFyZT1mdW5jdGlvbihlLHQpe2lmKCFsLmlzQnVmZmVyKGUpfHwhbC5pc0J1ZmZlcih0KSl0aHJvdyBuZXcgVHlwZUVycm9yKCJBcmd1bWVudHMgbXVzdCBiZSBCdWZmZXJzIik7aWYoZT09PXQpcmV0dXJuIDA7Zm9yKHZhciBuPWUubGVuZ3RoLHI9dC5sZW5ndGgsbz0wLGE9TWF0aC5taW4obixyKTtvPGE7KytvKWlmKGVbb10hPT10W29dKXtuPWVbb10scj10W29dO2JyZWFrfXJldHVybiBuPHI/LTE6cjxuPzE6MH0sbC5pc0VuY29kaW5nPWZ1bmN0aW9uKGUpe3N3aXRjaChTdHJpbmcoZSkudG9Mb3dlckNhc2UoKSl7Y2FzZSJoZXgiOmNhc2UidXRmOCI6Y2FzZSJ1dGYtOCI6Y2FzZSJhc2NpaSI6Y2FzZSJsYXRpbjEiOmNhc2UiYmluYXJ5IjpjYXNlImJhc2U2NCI6Y2FzZSJ1Y3MyIjpjYXNlInVjcy0yIjpjYXNlInV0ZjE2bGUiOmNhc2UidXRmLTE2bGUiOnJldHVybiEwO2RlZmF1bHQ6cmV0dXJuITF9fSxsLmNvbmNhdD1mdW5jdGlvbihlLHQpe2lmKCFhKGUpKXRocm93IG5ldyBUeXBlRXJyb3IoJyJsaXN0IiBhcmd1bWVudCBtdXN0IGJlIGFuIEFycmF5IG9mIEJ1ZmZlcnMnKTtpZigwPT09ZS5sZW5ndGgpcmV0dXJuIGwuYWxsb2MoMCk7dmFyIG47aWYodm9pZCAwPT09dClmb3IodD0wLG49MDtuPGUubGVuZ3RoOysrbil0Kz1lW25dLmxlbmd0aDt2YXIgcj1sLmFsbG9jVW5zYWZlKHQpLG89MDtmb3Iobj0wO248ZS5sZW5ndGg7KytuKXt2YXIgaT1lW25dO2lmKCFsLmlzQnVmZmVyKGkpKXRocm93IG5ldyBUeXBlRXJyb3IoJyJsaXN0IiBhcmd1bWVudCBtdXN0IGJlIGFuIEFycmF5IG9mIEJ1ZmZlcnMnKTtpLmNvcHkocixvKSxvKz1pLmxlbmd0aH1yZXR1cm4gcn0sbC5ieXRlTGVuZ3RoPWYsbC5wcm90b3R5cGUuX2lzQnVmZmVyPSEwLGwucHJvdG90eXBlLnN3YXAxNj1mdW5jdGlvbigpe3ZhciBlPXRoaXMubGVuZ3RoO2lmKGUlMiE9MCl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiQnVmZmVyIHNpemUgbXVzdCBiZSBhIG11bHRpcGxlIG9mIDE2LWJpdHMiKTtmb3IodmFyIHQ9MDt0PGU7dCs9MilnKHRoaXMsdCx0KzEpO3JldHVybiB0aGlzfSxsLnByb3RvdHlwZS5zd2FwMzI9ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmxlbmd0aDtpZihlJTQhPTApdGhyb3cgbmV3IFJhbmdlRXJyb3IoIkJ1ZmZlciBzaXplIG11c3QgYmUgYSBtdWx0aXBsZSBvZiAzMi1iaXRzIik7Zm9yKHZhciB0PTA7dDxlO3QrPTQpZyh0aGlzLHQsdCszKSxnKHRoaXMsdCsxLHQrMik7cmV0dXJuIHRoaXN9LGwucHJvdG90eXBlLnN3YXA2ND1mdW5jdGlvbigpe3ZhciBlPXRoaXMubGVuZ3RoO2lmKGUlOCE9MCl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiQnVmZmVyIHNpemUgbXVzdCBiZSBhIG11bHRpcGxlIG9mIDY0LWJpdHMiKTtmb3IodmFyIHQ9MDt0PGU7dCs9OClnKHRoaXMsdCx0KzcpLGcodGhpcyx0KzEsdCs2KSxnKHRoaXMsdCsyLHQrNSksZyh0aGlzLHQrMyx0KzQpO3JldHVybiB0aGlzfSxsLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3ZhciBlPTB8dGhpcy5sZW5ndGg7cmV0dXJuIDA9PT1lPyIiOjA9PT1hcmd1bWVudHMubGVuZ3RoP3godGhpcywwLGUpOm0uYXBwbHkodGhpcyxhcmd1bWVudHMpfSxsLnByb3RvdHlwZS5lcXVhbHM9ZnVuY3Rpb24oZSl7aWYoIWwuaXNCdWZmZXIoZSkpdGhyb3cgbmV3IFR5cGVFcnJvcigiQXJndW1lbnQgbXVzdCBiZSBhIEJ1ZmZlciIpO3JldHVybiB0aGlzPT09ZXx8MD09PWwuY29tcGFyZSh0aGlzLGUpfSxsLnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7dmFyIGU9IiIsbj10LklOU1BFQ1RfTUFYX0JZVEVTO3JldHVybiB0aGlzLmxlbmd0aD4wJiYoZT10aGlzLnRvU3RyaW5nKCJoZXgiLDAsbikubWF0Y2goLy57Mn0vZykuam9pbigiICIpLHRoaXMubGVuZ3RoPm4mJihlKz0iIC4uLiAiKSksIjxCdWZmZXIgIitlKyI+In0sbC5wcm90b3R5cGUuY29tcGFyZT1mdW5jdGlvbihlLHQsbixyLG8pe2lmKCFsLmlzQnVmZmVyKGUpKXRocm93IG5ldyBUeXBlRXJyb3IoIkFyZ3VtZW50IG11c3QgYmUgYSBCdWZmZXIiKTtpZih2b2lkIDA9PT10JiYodD0wKSx2b2lkIDA9PT1uJiYobj1lP2UubGVuZ3RoOjApLHZvaWQgMD09PXImJihyPTApLHZvaWQgMD09PW8mJihvPXRoaXMubGVuZ3RoKSx0PDB8fG4+ZS5sZW5ndGh8fHI8MHx8bz50aGlzLmxlbmd0aCl0aHJvdyBuZXcgUmFuZ2VFcnJvcigib3V0IG9mIHJhbmdlIGluZGV4Iik7aWYocj49byYmdD49bilyZXR1cm4gMDtpZihyPj1vKXJldHVybi0xO2lmKHQ+PW4pcmV0dXJuIDE7aWYodGhpcz09PWUpcmV0dXJuIDA7Zm9yKHZhciBhPShvPj4+PTApLShyPj4+PTApLGk9KG4+Pj49MCktKHQ+Pj49MCkscz1NYXRoLm1pbihhLGkpLGM9dGhpcy5zbGljZShyLG8pLHU9ZS5zbGljZSh0LG4pLGQ9MDtkPHM7KytkKWlmKGNbZF0hPT11W2RdKXthPWNbZF0saT11W2RdO2JyZWFrfXJldHVybiBhPGk/LTE6aTxhPzE6MH0sbC5wcm90b3R5cGUuaW5jbHVkZXM9ZnVuY3Rpb24oZSx0LG4pe3JldHVybi0xIT09dGhpcy5pbmRleE9mKGUsdCxuKX0sbC5wcm90b3R5cGUuaW5kZXhPZj1mdW5jdGlvbihlLHQsbil7cmV0dXJuIGIodGhpcyxlLHQsbiwhMCl9LGwucHJvdG90eXBlLmxhc3RJbmRleE9mPWZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gYih0aGlzLGUsdCxuLCExKX0sbC5wcm90b3R5cGUud3JpdGU9ZnVuY3Rpb24oZSx0LG4scil7aWYodm9pZCAwPT09dClyPSJ1dGY4IixuPXRoaXMubGVuZ3RoLHQ9MDtlbHNlIGlmKHZvaWQgMD09PW4mJiJzdHJpbmciPT10eXBlb2YgdClyPXQsbj10aGlzLmxlbmd0aCx0PTA7ZWxzZXtpZighaXNGaW5pdGUodCkpdGhyb3cgbmV3IEVycm9yKCJCdWZmZXIud3JpdGUoc3RyaW5nLCBlbmNvZGluZywgb2Zmc2V0WywgbGVuZ3RoXSkgaXMgbm8gbG9uZ2VyIHN1cHBvcnRlZCIpO3R8PTAsaXNGaW5pdGUobik/KG58PTAsdm9pZCAwPT09ciYmKHI9InV0ZjgiKSk6KHI9bixuPXZvaWQgMCl9dmFyIG89dGhpcy5sZW5ndGgtdDtpZigodm9pZCAwPT09bnx8bj5vKSYmKG49byksZS5sZW5ndGg+MCYmKG48MHx8dDwwKXx8dD50aGlzLmxlbmd0aCl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiQXR0ZW1wdCB0byB3cml0ZSBvdXRzaWRlIGJ1ZmZlciBib3VuZHMiKTtyfHwocj0idXRmOCIpO2Zvcih2YXIgYT0hMTs7KXN3aXRjaChyKXtjYXNlImhleCI6cmV0dXJuIHYodGhpcyxlLHQsbik7Y2FzZSJ1dGY4IjpjYXNlInV0Zi04IjpyZXR1cm4gayh0aGlzLGUsdCxuKTtjYXNlImFzY2lpIjpyZXR1cm4gdyh0aGlzLGUsdCxuKTtjYXNlImxhdGluMSI6Y2FzZSJiaW5hcnkiOnJldHVybiBTKHRoaXMsZSx0LG4pO2Nhc2UiYmFzZTY0IjpyZXR1cm4gRSh0aGlzLGUsdCxuKTtjYXNlInVjczIiOmNhc2UidWNzLTIiOmNhc2UidXRmMTZsZSI6Y2FzZSJ1dGYtMTZsZSI6cmV0dXJuIE8odGhpcyxlLHQsbik7ZGVmYXVsdDppZihhKXRocm93IG5ldyBUeXBlRXJyb3IoIlVua25vd24gZW5jb2Rpbmc6ICIrcik7cj0oIiIrcikudG9Mb3dlckNhc2UoKSxhPSEwfX0sbC5wcm90b3R5cGUudG9KU09OPWZ1bmN0aW9uKCl7cmV0dXJue3R5cGU6IkJ1ZmZlciIsZGF0YTpBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCh0aGlzLl9hcnJ8fHRoaXMsMCl9fTtmdW5jdGlvbiBqKGUsdCxuKXt2YXIgcj0iIjtuPU1hdGgubWluKGUubGVuZ3RoLG4pO2Zvcih2YXIgbz10O288bjsrK28pcis9U3RyaW5nLmZyb21DaGFyQ29kZSgxMjcmZVtvXSk7cmV0dXJuIHJ9ZnVuY3Rpb24gVChlLHQsbil7dmFyIHI9IiI7bj1NYXRoLm1pbihlLmxlbmd0aCxuKTtmb3IodmFyIG89dDtvPG47KytvKXIrPVN0cmluZy5mcm9tQ2hhckNvZGUoZVtvXSk7cmV0dXJuIHJ9ZnVuY3Rpb24gUChlLHQsbil7dmFyIHI9ZS5sZW5ndGg7KCF0fHx0PDApJiYodD0wKSwoIW58fG48MHx8bj5yKSYmKG49cik7Zm9yKHZhciBvPSIiLGE9dDthPG47KythKW8rPVIoZVthXSk7cmV0dXJuIG99ZnVuY3Rpb24gQShlLHQsbil7Zm9yKHZhciByPWUuc2xpY2UodCxuKSxvPSIiLGE9MDthPHIubGVuZ3RoO2ErPTIpbys9U3RyaW5nLmZyb21DaGFyQ29kZShyW2FdKzI1NipyW2ErMV0pO3JldHVybiBvfWZ1bmN0aW9uIE0oZSx0LG4pe2lmKGUlMSE9MHx8ZTwwKXRocm93IG5ldyBSYW5nZUVycm9yKCJvZmZzZXQgaXMgbm90IHVpbnQiKTtpZihlK3Q+bil0aHJvdyBuZXcgUmFuZ2VFcnJvcigiVHJ5aW5nIHRvIGFjY2VzcyBiZXlvbmQgYnVmZmVyIGxlbmd0aCIpfWZ1bmN0aW9uIF8oZSx0LG4scixvLGEpe2lmKCFsLmlzQnVmZmVyKGUpKXRocm93IG5ldyBUeXBlRXJyb3IoJyJidWZmZXIiIGFyZ3VtZW50IG11c3QgYmUgYSBCdWZmZXIgaW5zdGFuY2UnKTtpZih0Pm98fHQ8YSl0aHJvdyBuZXcgUmFuZ2VFcnJvcignInZhbHVlIiBhcmd1bWVudCBpcyBvdXQgb2YgYm91bmRzJyk7aWYobityPmUubGVuZ3RoKXRocm93IG5ldyBSYW5nZUVycm9yKCJJbmRleCBvdXQgb2YgcmFuZ2UiKX1mdW5jdGlvbiB6KGUsdCxuLHIpe3Q8MCYmKHQ9NjU1MzUrdCsxKTtmb3IodmFyIG89MCxhPU1hdGgubWluKGUubGVuZ3RoLW4sMik7bzxhOysrbyllW24rb109KHQmMjU1PDw4KihyP286MS1vKSk+Pj44KihyP286MS1vKX1mdW5jdGlvbiBMKGUsdCxuLHIpe3Q8MCYmKHQ9NDI5NDk2NzI5NSt0KzEpO2Zvcih2YXIgbz0wLGE9TWF0aC5taW4oZS5sZW5ndGgtbiw0KTtvPGE7KytvKWVbbitvXT10Pj4+OCoocj9vOjMtbykmMjU1fWZ1bmN0aW9uIEkoZSx0LG4scixvLGEpe2lmKG4rcj5lLmxlbmd0aCl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiSW5kZXggb3V0IG9mIHJhbmdlIik7aWYobjwwKXRocm93IG5ldyBSYW5nZUVycm9yKCJJbmRleCBvdXQgb2YgcmFuZ2UiKX1mdW5jdGlvbiBEKGUsdCxuLHIsYSl7cmV0dXJuIGF8fEkoZSwwLG4sNCksby53cml0ZShlLHQsbixyLDIzLDQpLG4rNH1mdW5jdGlvbiBOKGUsdCxuLHIsYSl7cmV0dXJuIGF8fEkoZSwwLG4sOCksby53cml0ZShlLHQsbixyLDUyLDgpLG4rOH1sLnByb3RvdHlwZS5zbGljZT1mdW5jdGlvbihlLHQpe3ZhciBuLHI9dGhpcy5sZW5ndGg7aWYoKGU9fn5lKTwwPyhlKz1yKTwwJiYoZT0wKTplPnImJihlPXIpLCh0PXZvaWQgMD09PXQ/cjp+fnQpPDA/KHQrPXIpPDAmJih0PTApOnQ+ciYmKHQ9ciksdDxlJiYodD1lKSxsLlRZUEVEX0FSUkFZX1NVUFBPUlQpKG49dGhpcy5zdWJhcnJheShlLHQpKS5fX3Byb3RvX189bC5wcm90b3R5cGU7ZWxzZXt2YXIgbz10LWU7bj1uZXcgbChvLHZvaWQgMCk7Zm9yKHZhciBhPTA7YTxvOysrYSluW2FdPXRoaXNbYStlXX1yZXR1cm4gbn0sbC5wcm90b3R5cGUucmVhZFVJbnRMRT1mdW5jdGlvbihlLHQsbil7ZXw9MCx0fD0wLG58fE0oZSx0LHRoaXMubGVuZ3RoKTtmb3IodmFyIHI9dGhpc1tlXSxvPTEsYT0wOysrYTx0JiYobyo9MjU2KTspcis9dGhpc1tlK2FdKm87cmV0dXJuIHJ9LGwucHJvdG90eXBlLnJlYWRVSW50QkU9ZnVuY3Rpb24oZSx0LG4pe2V8PTAsdHw9MCxufHxNKGUsdCx0aGlzLmxlbmd0aCk7Zm9yKHZhciByPXRoaXNbZSstLXRdLG89MTt0PjAmJihvKj0yNTYpOylyKz10aGlzW2UrLS10XSpvO3JldHVybiByfSxsLnByb3RvdHlwZS5yZWFkVUludDg9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdHx8TShlLDEsdGhpcy5sZW5ndGgpLHRoaXNbZV19LGwucHJvdG90eXBlLnJlYWRVSW50MTZMRT1mdW5jdGlvbihlLHQpe3JldHVybiB0fHxNKGUsMix0aGlzLmxlbmd0aCksdGhpc1tlXXx0aGlzW2UrMV08PDh9LGwucHJvdG90eXBlLnJlYWRVSW50MTZCRT1mdW5jdGlvbihlLHQpe3JldHVybiB0fHxNKGUsMix0aGlzLmxlbmd0aCksdGhpc1tlXTw8OHx0aGlzW2UrMV19LGwucHJvdG90eXBlLnJlYWRVSW50MzJMRT1mdW5jdGlvbihlLHQpe3JldHVybiB0fHxNKGUsNCx0aGlzLmxlbmd0aCksKHRoaXNbZV18dGhpc1tlKzFdPDw4fHRoaXNbZSsyXTw8MTYpKzE2Nzc3MjE2KnRoaXNbZSszXX0sbC5wcm90b3R5cGUucmVhZFVJbnQzMkJFPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHR8fE0oZSw0LHRoaXMubGVuZ3RoKSwxNjc3NzIxNip0aGlzW2VdKyh0aGlzW2UrMV08PDE2fHRoaXNbZSsyXTw8OHx0aGlzW2UrM10pfSxsLnByb3RvdHlwZS5yZWFkSW50TEU9ZnVuY3Rpb24oZSx0LG4pe2V8PTAsdHw9MCxufHxNKGUsdCx0aGlzLmxlbmd0aCk7Zm9yKHZhciByPXRoaXNbZV0sbz0xLGE9MDsrK2E8dCYmKG8qPTI1Nik7KXIrPXRoaXNbZSthXSpvO3JldHVybiByPj0obyo9MTI4KSYmKHItPU1hdGgucG93KDIsOCp0KSkscn0sbC5wcm90b3R5cGUucmVhZEludEJFPWZ1bmN0aW9uKGUsdCxuKXtlfD0wLHR8PTAsbnx8TShlLHQsdGhpcy5sZW5ndGgpO2Zvcih2YXIgcj10LG89MSxhPXRoaXNbZSstLXJdO3I+MCYmKG8qPTI1Nik7KWErPXRoaXNbZSstLXJdKm87cmV0dXJuIGE+PShvKj0xMjgpJiYoYS09TWF0aC5wb3coMiw4KnQpKSxhfSxsLnByb3RvdHlwZS5yZWFkSW50OD1mdW5jdGlvbihlLHQpe3JldHVybiB0fHxNKGUsMSx0aGlzLmxlbmd0aCksMTI4JnRoaXNbZV0/LTEqKDI1NS10aGlzW2VdKzEpOnRoaXNbZV19LGwucHJvdG90eXBlLnJlYWRJbnQxNkxFPWZ1bmN0aW9uKGUsdCl7dHx8TShlLDIsdGhpcy5sZW5ndGgpO3ZhciBuPXRoaXNbZV18dGhpc1tlKzFdPDw4O3JldHVybiAzMjc2OCZuPzQyOTQ5MDE3NjB8bjpufSxsLnByb3RvdHlwZS5yZWFkSW50MTZCRT1mdW5jdGlvbihlLHQpe3R8fE0oZSwyLHRoaXMubGVuZ3RoKTt2YXIgbj10aGlzW2UrMV18dGhpc1tlXTw8ODtyZXR1cm4gMzI3Njgmbj80Mjk0OTAxNzYwfG46bn0sbC5wcm90b3R5cGUucmVhZEludDMyTEU9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdHx8TShlLDQsdGhpcy5sZW5ndGgpLHRoaXNbZV18dGhpc1tlKzFdPDw4fHRoaXNbZSsyXTw8MTZ8dGhpc1tlKzNdPDwyNH0sbC5wcm90b3R5cGUucmVhZEludDMyQkU9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdHx8TShlLDQsdGhpcy5sZW5ndGgpLHRoaXNbZV08PDI0fHRoaXNbZSsxXTw8MTZ8dGhpc1tlKzJdPDw4fHRoaXNbZSszXX0sbC5wcm90b3R5cGUucmVhZEZsb2F0TEU9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdHx8TShlLDQsdGhpcy5sZW5ndGgpLG8ucmVhZCh0aGlzLGUsITAsMjMsNCl9LGwucHJvdG90eXBlLnJlYWRGbG9hdEJFPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHR8fE0oZSw0LHRoaXMubGVuZ3RoKSxvLnJlYWQodGhpcyxlLCExLDIzLDQpfSxsLnByb3RvdHlwZS5yZWFkRG91YmxlTEU9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdHx8TShlLDgsdGhpcy5sZW5ndGgpLG8ucmVhZCh0aGlzLGUsITAsNTIsOCl9LGwucHJvdG90eXBlLnJlYWREb3VibGVCRT1mdW5jdGlvbihlLHQpe3JldHVybiB0fHxNKGUsOCx0aGlzLmxlbmd0aCksby5yZWFkKHRoaXMsZSwhMSw1Miw4KX0sbC5wcm90b3R5cGUud3JpdGVVSW50TEU9ZnVuY3Rpb24oZSx0LG4scil7KGU9K2UsdHw9MCxufD0wLHIpfHxfKHRoaXMsZSx0LG4sTWF0aC5wb3coMiw4Km4pLTEsMCk7dmFyIG89MSxhPTA7Zm9yKHRoaXNbdF09MjU1JmU7KythPG4mJihvKj0yNTYpOyl0aGlzW3QrYV09ZS9vJjI1NTtyZXR1cm4gdCtufSxsLnByb3RvdHlwZS53cml0ZVVJbnRCRT1mdW5jdGlvbihlLHQsbixyKXsoZT0rZSx0fD0wLG58PTAscil8fF8odGhpcyxlLHQsbixNYXRoLnBvdygyLDgqbiktMSwwKTt2YXIgbz1uLTEsYT0xO2Zvcih0aGlzW3Qrb109MjU1JmU7LS1vPj0wJiYoYSo9MjU2KTspdGhpc1t0K29dPWUvYSYyNTU7cmV0dXJuIHQrbn0sbC5wcm90b3R5cGUud3JpdGVVSW50OD1mdW5jdGlvbihlLHQsbil7cmV0dXJuIGU9K2UsdHw9MCxufHxfKHRoaXMsZSx0LDEsMjU1LDApLGwuVFlQRURfQVJSQVlfU1VQUE9SVHx8KGU9TWF0aC5mbG9vcihlKSksdGhpc1t0XT0yNTUmZSx0KzF9LGwucHJvdG90eXBlLndyaXRlVUludDE2TEU9ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBlPStlLHR8PTAsbnx8Xyh0aGlzLGUsdCwyLDY1NTM1LDApLGwuVFlQRURfQVJSQVlfU1VQUE9SVD8odGhpc1t0XT0yNTUmZSx0aGlzW3QrMV09ZT4+PjgpOnoodGhpcyxlLHQsITApLHQrMn0sbC5wcm90b3R5cGUud3JpdGVVSW50MTZCRT1mdW5jdGlvbihlLHQsbil7cmV0dXJuIGU9K2UsdHw9MCxufHxfKHRoaXMsZSx0LDIsNjU1MzUsMCksbC5UWVBFRF9BUlJBWV9TVVBQT1JUPyh0aGlzW3RdPWU+Pj44LHRoaXNbdCsxXT0yNTUmZSk6eih0aGlzLGUsdCwhMSksdCsyfSxsLnByb3RvdHlwZS53cml0ZVVJbnQzMkxFPWZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gZT0rZSx0fD0wLG58fF8odGhpcyxlLHQsNCw0Mjk0OTY3Mjk1LDApLGwuVFlQRURfQVJSQVlfU1VQUE9SVD8odGhpc1t0KzNdPWU+Pj4yNCx0aGlzW3QrMl09ZT4+PjE2LHRoaXNbdCsxXT1lPj4+OCx0aGlzW3RdPTI1NSZlKTpMKHRoaXMsZSx0LCEwKSx0KzR9LGwucHJvdG90eXBlLndyaXRlVUludDMyQkU9ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBlPStlLHR8PTAsbnx8Xyh0aGlzLGUsdCw0LDQyOTQ5NjcyOTUsMCksbC5UWVBFRF9BUlJBWV9TVVBQT1JUPyh0aGlzW3RdPWU+Pj4yNCx0aGlzW3QrMV09ZT4+PjE2LHRoaXNbdCsyXT1lPj4+OCx0aGlzW3QrM109MjU1JmUpOkwodGhpcyxlLHQsITEpLHQrNH0sbC5wcm90b3R5cGUud3JpdGVJbnRMRT1mdW5jdGlvbihlLHQsbixyKXtpZihlPStlLHR8PTAsIXIpe3ZhciBvPU1hdGgucG93KDIsOCpuLTEpO18odGhpcyxlLHQsbixvLTEsLW8pfXZhciBhPTAsaT0xLHM9MDtmb3IodGhpc1t0XT0yNTUmZTsrK2E8biYmKGkqPTI1Nik7KWU8MCYmMD09PXMmJjAhPT10aGlzW3QrYS0xXSYmKHM9MSksdGhpc1t0K2FdPShlL2k+PjApLXMmMjU1O3JldHVybiB0K259LGwucHJvdG90eXBlLndyaXRlSW50QkU9ZnVuY3Rpb24oZSx0LG4scil7aWYoZT0rZSx0fD0wLCFyKXt2YXIgbz1NYXRoLnBvdygyLDgqbi0xKTtfKHRoaXMsZSx0LG4sby0xLC1vKX12YXIgYT1uLTEsaT0xLHM9MDtmb3IodGhpc1t0K2FdPTI1NSZlOy0tYT49MCYmKGkqPTI1Nik7KWU8MCYmMD09PXMmJjAhPT10aGlzW3QrYSsxXSYmKHM9MSksdGhpc1t0K2FdPShlL2k+PjApLXMmMjU1O3JldHVybiB0K259LGwucHJvdG90eXBlLndyaXRlSW50OD1mdW5jdGlvbihlLHQsbil7cmV0dXJuIGU9K2UsdHw9MCxufHxfKHRoaXMsZSx0LDEsMTI3LC0xMjgpLGwuVFlQRURfQVJSQVlfU1VQUE9SVHx8KGU9TWF0aC5mbG9vcihlKSksZTwwJiYoZT0yNTUrZSsxKSx0aGlzW3RdPTI1NSZlLHQrMX0sbC5wcm90b3R5cGUud3JpdGVJbnQxNkxFPWZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gZT0rZSx0fD0wLG58fF8odGhpcyxlLHQsMiwzMjc2NywtMzI3NjgpLGwuVFlQRURfQVJSQVlfU1VQUE9SVD8odGhpc1t0XT0yNTUmZSx0aGlzW3QrMV09ZT4+PjgpOnoodGhpcyxlLHQsITApLHQrMn0sbC5wcm90b3R5cGUud3JpdGVJbnQxNkJFPWZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gZT0rZSx0fD0wLG58fF8odGhpcyxlLHQsMiwzMjc2NywtMzI3NjgpLGwuVFlQRURfQVJSQVlfU1VQUE9SVD8odGhpc1t0XT1lPj4+OCx0aGlzW3QrMV09MjU1JmUpOnoodGhpcyxlLHQsITEpLHQrMn0sbC5wcm90b3R5cGUud3JpdGVJbnQzMkxFPWZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gZT0rZSx0fD0wLG58fF8odGhpcyxlLHQsNCwyMTQ3NDgzNjQ3LC0yMTQ3NDgzNjQ4KSxsLlRZUEVEX0FSUkFZX1NVUFBPUlQ/KHRoaXNbdF09MjU1JmUsdGhpc1t0KzFdPWU+Pj44LHRoaXNbdCsyXT1lPj4+MTYsdGhpc1t0KzNdPWU+Pj4yNCk6TCh0aGlzLGUsdCwhMCksdCs0fSxsLnByb3RvdHlwZS53cml0ZUludDMyQkU9ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBlPStlLHR8PTAsbnx8Xyh0aGlzLGUsdCw0LDIxNDc0ODM2NDcsLTIxNDc0ODM2NDgpLGU8MCYmKGU9NDI5NDk2NzI5NStlKzEpLGwuVFlQRURfQVJSQVlfU1VQUE9SVD8odGhpc1t0XT1lPj4+MjQsdGhpc1t0KzFdPWU+Pj4xNix0aGlzW3QrMl09ZT4+PjgsdGhpc1t0KzNdPTI1NSZlKTpMKHRoaXMsZSx0LCExKSx0KzR9LGwucHJvdG90eXBlLndyaXRlRmxvYXRMRT1mdW5jdGlvbihlLHQsbil7cmV0dXJuIEQodGhpcyxlLHQsITAsbil9LGwucHJvdG90eXBlLndyaXRlRmxvYXRCRT1mdW5jdGlvbihlLHQsbil7cmV0dXJuIEQodGhpcyxlLHQsITEsbil9LGwucHJvdG90eXBlLndyaXRlRG91YmxlTEU9ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBOKHRoaXMsZSx0LCEwLG4pfSxsLnByb3RvdHlwZS53cml0ZURvdWJsZUJFPWZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gTih0aGlzLGUsdCwhMSxuKX0sbC5wcm90b3R5cGUuY29weT1mdW5jdGlvbihlLHQsbixyKXtpZihufHwobj0wKSxyfHwwPT09cnx8KHI9dGhpcy5sZW5ndGgpLHQ+PWUubGVuZ3RoJiYodD1lLmxlbmd0aCksdHx8KHQ9MCkscj4wJiZyPG4mJihyPW4pLHI9PT1uKXJldHVybiAwO2lmKDA9PT1lLmxlbmd0aHx8MD09PXRoaXMubGVuZ3RoKXJldHVybiAwO2lmKHQ8MCl0aHJvdyBuZXcgUmFuZ2VFcnJvcigidGFyZ2V0U3RhcnQgb3V0IG9mIGJvdW5kcyIpO2lmKG48MHx8bj49dGhpcy5sZW5ndGgpdGhyb3cgbmV3IFJhbmdlRXJyb3IoInNvdXJjZVN0YXJ0IG91dCBvZiBib3VuZHMiKTtpZihyPDApdGhyb3cgbmV3IFJhbmdlRXJyb3IoInNvdXJjZUVuZCBvdXQgb2YgYm91bmRzIik7cj50aGlzLmxlbmd0aCYmKHI9dGhpcy5sZW5ndGgpLGUubGVuZ3RoLXQ8ci1uJiYocj1lLmxlbmd0aC10K24pO3ZhciBvLGE9ci1uO2lmKHRoaXM9PT1lJiZuPHQmJnQ8cilmb3Iobz1hLTE7bz49MDstLW8pZVtvK3RdPXRoaXNbbytuXTtlbHNlIGlmKGE8MWUzfHwhbC5UWVBFRF9BUlJBWV9TVVBQT1JUKWZvcihvPTA7bzxhOysrbyllW28rdF09dGhpc1tvK25dO2Vsc2UgVWludDhBcnJheS5wcm90b3R5cGUuc2V0LmNhbGwoZSx0aGlzLnN1YmFycmF5KG4sbithKSx0KTtyZXR1cm4gYX0sbC5wcm90b3R5cGUuZmlsbD1mdW5jdGlvbihlLHQsbixyKXtpZigic3RyaW5nIj09dHlwZW9mIGUpe2lmKCJzdHJpbmciPT10eXBlb2YgdD8ocj10LHQ9MCxuPXRoaXMubGVuZ3RoKToic3RyaW5nIj09dHlwZW9mIG4mJihyPW4sbj10aGlzLmxlbmd0aCksMT09PWUubGVuZ3RoKXt2YXIgbz1lLmNoYXJDb2RlQXQoMCk7bzwyNTYmJihlPW8pfWlmKHZvaWQgMCE9PXImJiJzdHJpbmciIT10eXBlb2Ygcil0aHJvdyBuZXcgVHlwZUVycm9yKCJlbmNvZGluZyBtdXN0IGJlIGEgc3RyaW5nIik7aWYoInN0cmluZyI9PXR5cGVvZiByJiYhbC5pc0VuY29kaW5nKHIpKXRocm93IG5ldyBUeXBlRXJyb3IoIlVua25vd24gZW5jb2Rpbmc6ICIrcil9ZWxzZSJudW1iZXIiPT10eXBlb2YgZSYmKGUmPTI1NSk7aWYodDwwfHx0aGlzLmxlbmd0aDx0fHx0aGlzLmxlbmd0aDxuKXRocm93IG5ldyBSYW5nZUVycm9yKCJPdXQgb2YgcmFuZ2UgaW5kZXgiKTtpZihuPD10KXJldHVybiB0aGlzO3ZhciBhO2lmKHQ+Pj49MCxuPXZvaWQgMD09PW4/dGhpcy5sZW5ndGg6bj4+PjAsZXx8KGU9MCksIm51bWJlciI9PXR5cGVvZiBlKWZvcihhPXQ7YTxuOysrYSl0aGlzW2FdPWU7ZWxzZXt2YXIgaT1sLmlzQnVmZmVyKGUpP2U6QihuZXcgbChlLHIpLnRvU3RyaW5nKCkpLHM9aS5sZW5ndGg7Zm9yKGE9MDthPG4tdDsrK2EpdGhpc1thK3RdPWlbYSVzXX1yZXR1cm4gdGhpc307dmFyIEY9L1teK1wvMC05QS1aYS16LV9dL2c7ZnVuY3Rpb24gUihlKXtyZXR1cm4gZTwxNj8iMCIrZS50b1N0cmluZygxNik6ZS50b1N0cmluZygxNil9ZnVuY3Rpb24gQihlLHQpe3ZhciBuO3Q9dHx8MS8wO2Zvcih2YXIgcj1lLmxlbmd0aCxvPW51bGwsYT1bXSxpPTA7aTxyOysraSl7aWYoKG49ZS5jaGFyQ29kZUF0KGkpKT41NTI5NSYmbjw1NzM0NCl7aWYoIW8pe2lmKG4+NTYzMTkpeyh0LT0zKT4tMSYmYS5wdXNoKDIzOSwxOTEsMTg5KTtjb250aW51ZX1pZihpKzE9PT1yKXsodC09Myk+LTEmJmEucHVzaCgyMzksMTkxLDE4OSk7Y29udGludWV9bz1uO2NvbnRpbnVlfWlmKG48NTYzMjApeyh0LT0zKT4tMSYmYS5wdXNoKDIzOSwxOTEsMTg5KSxvPW47Y29udGludWV9bj02NTUzNisoby01NTI5Njw8MTB8bi01NjMyMCl9ZWxzZSBvJiYodC09Myk+LTEmJmEucHVzaCgyMzksMTkxLDE4OSk7aWYobz1udWxsLG48MTI4KXtpZigodC09MSk8MClicmVhazthLnB1c2gobil9ZWxzZSBpZihuPDIwNDgpe2lmKCh0LT0yKTwwKWJyZWFrO2EucHVzaChuPj42fDE5Miw2MyZufDEyOCl9ZWxzZSBpZihuPDY1NTM2KXtpZigodC09Myk8MClicmVhazthLnB1c2gobj4+MTJ8MjI0LG4+PjYmNjN8MTI4LDYzJm58MTI4KX1lbHNle2lmKCEobjwxMTE0MTEyKSl0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgY29kZSBwb2ludCIpO2lmKCh0LT00KTwwKWJyZWFrO2EucHVzaChuPj4xOHwyNDAsbj4+MTImNjN8MTI4LG4+PjYmNjN8MTI4LDYzJm58MTI4KX19cmV0dXJuIGF9ZnVuY3Rpb24gSChlKXtyZXR1cm4gci50b0J5dGVBcnJheShmdW5jdGlvbihlKXtpZigoZT1mdW5jdGlvbihlKXtyZXR1cm4gZS50cmltP2UudHJpbSgpOmUucmVwbGFjZSgvXlxzK3xccyskL2csIiIpfShlKS5yZXBsYWNlKEYsIiIpKS5sZW5ndGg8MilyZXR1cm4iIjtmb3IoO2UubGVuZ3RoJTQhPTA7KWUrPSI9IjtyZXR1cm4gZX0oZSkpfWZ1bmN0aW9uIEcoZSx0LG4scil7Zm9yKHZhciBvPTA7bzxyJiYhKG8rbj49dC5sZW5ndGh8fG8+PWUubGVuZ3RoKTsrK28pdFtvK25dPWVbb107cmV0dXJuIG99fSkuY2FsbCh0aGlzLG4oNDQpKX0sZnVuY3Rpb24oZSx0LG4pe3ZhciByPW4oMTMxKTtlLmV4cG9ydHM9ZnVuY3Rpb24oZSl7dmFyIHQ9ZS54ZG9tYWluLG49ZS54c2NoZW1lLG89ZS5lbmFibGVzWERSO3RyeXtpZigidW5kZWZpbmVkIiE9dHlwZW9mIFhNTEh0dHBSZXF1ZXN0JiYoIXR8fHIpKXJldHVybiBuZXcgWE1MSHR0cFJlcXVlc3R9Y2F0Y2goZSl7fXRyeXtpZigidW5kZWZpbmVkIiE9dHlwZW9mIFhEb21haW5SZXF1ZXN0JiYhbiYmbylyZXR1cm4gbmV3IFhEb21haW5SZXF1ZXN0fWNhdGNoKGUpe31pZighdCl0cnl7cmV0dXJuIG5ldyhzZWxmW1siQWN0aXZlIl0uY29uY2F0KCJPYmplY3QiKS5qb2luKCJYIildKSgiTWljcm9zb2Z0LlhNTEhUVFAiKX1jYXRjaChlKXt9fX0sZnVuY3Rpb24oZSx0LG4pe3ZhciByPW4oMzQpLG89big0OSk7ZnVuY3Rpb24gYShlKXt0aGlzLnBhdGg9ZS5wYXRoLHRoaXMuaG9zdG5hbWU9ZS5ob3N0bmFtZSx0aGlzLnBvcnQ9ZS5wb3J0LHRoaXMuc2VjdXJlPWUuc2VjdXJlLHRoaXMucXVlcnk9ZS5xdWVyeSx0aGlzLnRpbWVzdGFtcFBhcmFtPWUudGltZXN0YW1wUGFyYW0sdGhpcy50aW1lc3RhbXBSZXF1ZXN0cz1lLnRpbWVzdGFtcFJlcXVlc3RzLHRoaXMucmVhZHlTdGF0ZT0iIix0aGlzLmFnZW50PWUuYWdlbnR8fCExLHRoaXMuc29ja2V0PWUuc29ja2V0LHRoaXMuZW5hYmxlc1hEUj1lLmVuYWJsZXNYRFIsdGhpcy53aXRoQ3JlZGVudGlhbHM9ZS53aXRoQ3JlZGVudGlhbHMsdGhpcy5wZng9ZS5wZngsdGhpcy5rZXk9ZS5rZXksdGhpcy5wYXNzcGhyYXNlPWUucGFzc3BocmFzZSx0aGlzLmNlcnQ9ZS5jZXJ0LHRoaXMuY2E9ZS5jYSx0aGlzLmNpcGhlcnM9ZS5jaXBoZXJzLHRoaXMucmVqZWN0VW5hdXRob3JpemVkPWUucmVqZWN0VW5hdXRob3JpemVkLHRoaXMuZm9yY2VOb2RlPWUuZm9yY2VOb2RlLHRoaXMuaXNSZWFjdE5hdGl2ZT1lLmlzUmVhY3ROYXRpdmUsdGhpcy5leHRyYUhlYWRlcnM9ZS5leHRyYUhlYWRlcnMsdGhpcy5sb2NhbEFkZHJlc3M9ZS5sb2NhbEFkZHJlc3N9ZS5leHBvcnRzPWEsbyhhLnByb3RvdHlwZSksYS5wcm90b3R5cGUub25FcnJvcj1mdW5jdGlvbihlLHQpe3ZhciBuPW5ldyBFcnJvcihlKTtyZXR1cm4gbi50eXBlPSJUcmFuc3BvcnRFcnJvciIsbi5kZXNjcmlwdGlvbj10LHRoaXMuZW1pdCgiZXJyb3IiLG4pLHRoaXN9LGEucHJvdG90eXBlLm9wZW49ZnVuY3Rpb24oKXtyZXR1cm4iY2xvc2VkIiE9PXRoaXMucmVhZHlTdGF0ZSYmIiIhPT10aGlzLnJlYWR5U3RhdGV8fCh0aGlzLnJlYWR5U3RhdGU9Im9wZW5pbmciLHRoaXMuZG9PcGVuKCkpLHRoaXN9LGEucHJvdG90eXBlLmNsb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIm9wZW5pbmciIT09dGhpcy5yZWFkeVN0YXRlJiYib3BlbiIhPT10aGlzLnJlYWR5U3RhdGV8fCh0aGlzLmRvQ2xvc2UoKSx0aGlzLm9uQ2xvc2UoKSksdGhpc30sYS5wcm90b3R5cGUuc2VuZD1mdW5jdGlvbihlKXtpZigib3BlbiIhPT10aGlzLnJlYWR5U3RhdGUpdGhyb3cgbmV3IEVycm9yKCJUcmFuc3BvcnQgbm90IG9wZW4iKTt0aGlzLndyaXRlKGUpfSxhLnByb3RvdHlwZS5vbk9wZW49ZnVuY3Rpb24oKXt0aGlzLnJlYWR5U3RhdGU9Im9wZW4iLHRoaXMud3JpdGFibGU9ITAsdGhpcy5lbWl0KCJvcGVuIil9LGEucHJvdG90eXBlLm9uRGF0YT1mdW5jdGlvbihlKXt2YXIgdD1yLmRlY29kZVBhY2tldChlLHRoaXMuc29ja2V0LmJpbmFyeVR5cGUpO3RoaXMub25QYWNrZXQodCl9LGEucHJvdG90eXBlLm9uUGFja2V0PWZ1bmN0aW9uKGUpe3RoaXMuZW1pdCgicGFja2V0IixlKX0sYS5wcm90b3R5cGUub25DbG9zZT1mdW5jdGlvbigpe3RoaXMucmVhZHlTdGF0ZT0iY2xvc2VkIix0aGlzLmVtaXQoImNsb3NlIil9fSxmdW5jdGlvbihlLHQsbil7ZnVuY3Rpb24gcihlKXtpZihlKXJldHVybiBmdW5jdGlvbihlKXtmb3IodmFyIHQgaW4gci5wcm90b3R5cGUpZVt0XT1yLnByb3RvdHlwZVt0XTtyZXR1cm4gZX0oZSl9ZS5leHBvcnRzPXIsci5wcm90b3R5cGUub249ci5wcm90b3R5cGUuYWRkRXZlbnRMaXN0ZW5lcj1mdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLl9jYWxsYmFja3M9dGhpcy5fY2FsbGJhY2tzfHx7fSwodGhpcy5fY2FsbGJhY2tzWyIkIitlXT10aGlzLl9jYWxsYmFja3NbIiQiK2VdfHxbXSkucHVzaCh0KSx0aGlzfSxyLnByb3RvdHlwZS5vbmNlPWZ1bmN0aW9uKGUsdCl7ZnVuY3Rpb24gbigpe3RoaXMub2ZmKGUsbiksdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9cmV0dXJuIG4uZm49dCx0aGlzLm9uKGUsbiksdGhpc30sci5wcm90b3R5cGUub2ZmPXIucHJvdG90eXBlLnJlbW92ZUxpc3RlbmVyPXIucHJvdG90eXBlLnJlbW92ZUFsbExpc3RlbmVycz1yLnByb3RvdHlwZS5yZW1vdmVFdmVudExpc3RlbmVyPWZ1bmN0aW9uKGUsdCl7aWYodGhpcy5fY2FsbGJhY2tzPXRoaXMuX2NhbGxiYWNrc3x8e30sMD09YXJndW1lbnRzLmxlbmd0aClyZXR1cm4gdGhpcy5fY2FsbGJhY2tzPXt9LHRoaXM7dmFyIG4scj10aGlzLl9jYWxsYmFja3NbIiQiK2VdO2lmKCFyKXJldHVybiB0aGlzO2lmKDE9PWFyZ3VtZW50cy5sZW5ndGgpcmV0dXJuIGRlbGV0ZSB0aGlzLl9jYWxsYmFja3NbIiQiK2VdLHRoaXM7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspaWYoKG49cltvXSk9PT10fHxuLmZuPT09dCl7ci5zcGxpY2UobywxKTticmVha31yZXR1cm4gdGhpc30sci5wcm90b3R5cGUuZW1pdD1mdW5jdGlvbihlKXt0aGlzLl9jYWxsYmFja3M9dGhpcy5fY2FsbGJhY2tzfHx7fTt2YXIgdD1bXS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSxuPXRoaXMuX2NhbGxiYWNrc1siJCIrZV07aWYobilmb3IodmFyIHI9MCxvPShuPW4uc2xpY2UoMCkpLmxlbmd0aDtyPG87KytyKW5bcl0uYXBwbHkodGhpcyx0KTtyZXR1cm4gdGhpc30sci5wcm90b3R5cGUubGlzdGVuZXJzPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9jYWxsYmFja3M9dGhpcy5fY2FsbGJhY2tzfHx7fSx0aGlzLl9jYWxsYmFja3NbIiQiK2VdfHxbXX0sci5wcm90b3R5cGUuaGFzTGlzdGVuZXJzPWZ1bmN0aW9uKGUpe3JldHVybiEhdGhpcy5saXN0ZW5lcnMoZSkubGVuZ3RofX0sZnVuY3Rpb24oZSl7ZS5leHBvcnRzPUpTT04ucGFyc2UoJ3sibGFiZWxzIjp7InBhc3RlIjoiUGFzdGUiLCJzZWxlY3RBbGwiOiJTZWxlY3QgYWxsIiwibXVsdGlTZWxlY3QiOiJBZGQgZWxlbWVudCB0byBzZWxlY3Rpb24iLCJtb3ZlQ2FudmFzIjoiTW92ZSBjYW52YXMiLCJjb3B5IjoiQ29weSIsImNvcHlBc1BuZyI6IkNvcHkgdG8gY2xpcGJvYXJkIGFzIFBORyIsImNvcHlBc1N2ZyI6IkNvcHkgdG8gY2xpcGJvYXJkIGFzIFNWRyIsImJyaW5nRm9yd2FyZCI6IkJyaW5nIGZvcndhcmQiLCJzZW5kVG9CYWNrIjoiU2VuZCB0byBiYWNrIiwiYnJpbmdUb0Zyb250IjoiQnJpbmcgdG8gZnJvbnQiLCJzZW5kQmFja3dhcmQiOiJTZW5kIGJhY2t3YXJkIiwiZGVsZXRlIjoiRGVsZXRlIiwiY29weVN0eWxlcyI6IkNvcHkgc3R5bGVzIiwicGFzdGVTdHlsZXMiOiJQYXN0ZSBzdHlsZXMiLCJzdHJva2UiOiJTdHJva2UiLCJiYWNrZ3JvdW5kIjoiQmFja2dyb3VuZCIsImZpbGwiOiJGaWxsIiwic3Ryb2tlV2lkdGgiOiJTdHJva2Ugd2lkdGgiLCJzdHJva2VTdHlsZSI6IlN0cm9rZSBzdHlsZSIsInN0cm9rZVN0eWxlX3NvbGlkIjoiU29saWQiLCJzdHJva2VTdHlsZV9kYXNoZWQiOiJEYXNoZWQiLCJzdHJva2VTdHlsZV9kb3R0ZWQiOiJEb3R0ZWQiLCJzbG9wcGluZXNzIjoiU2xvcHBpbmVzcyIsIm9wYWNpdHkiOiJPcGFjaXR5IiwidGV4dEFsaWduIjoiVGV4dCBhbGlnbiIsImZvbnRTaXplIjoiRm9udCBzaXplIiwiZm9udEZhbWlseSI6IkZvbnQgZmFtaWx5Iiwib25seVNlbGVjdGVkIjoiT25seSBzZWxlY3RlZCIsIndpdGhCYWNrZ3JvdW5kIjoiV2l0aCBCYWNrZ3JvdW5kIiwiYWRkV2F0ZXJtYXJrIjoiQWRkIFxcIk1hZGUgd2l0aCBFeGNhbGlkcmF3XFwiIiwiaGFuZERyYXduIjoiSGFuZC1kcmF3biIsIm5vcm1hbCI6Ik5vcm1hbCIsImNvZGUiOiJDb2RlIiwic21hbGwiOiJTbWFsbCIsIm1lZGl1bSI6Ik1lZGl1bSIsImxhcmdlIjoiTGFyZ2UiLCJ2ZXJ5TGFyZ2UiOiJWZXJ5IGxhcmdlIiwic29saWQiOiJTb2xpZCIsImhhY2h1cmUiOiJIYWNodXJlIiwiY3Jvc3NIYXRjaCI6IkNyb3NzLWhhdGNoIiwidGhpbiI6IlRoaW4iLCJib2xkIjoiQm9sZCIsImxlZnQiOiJMZWZ0IiwiY2VudGVyIjoiQ2VudGVyIiwicmlnaHQiOiJSaWdodCIsImV4dHJhQm9sZCI6IkV4dHJhIGJvbGQiLCJhcmNoaXRlY3QiOiJBcmNoaXRlY3QiLCJhcnRpc3QiOiJBcnRpc3QiLCJjYXJ0b29uaXN0IjoiQ2FydG9vbmlzdCIsImZpbGVUaXRsZSI6IkZpbGUgdGl0bGUiLCJjb2xvclBpY2tlciI6IkNvbG9yIHBpY2tlciIsImNhbnZhc0JhY2tncm91bmQiOiJDYW52YXMgYmFja2dyb3VuZCIsImRyYXdpbmdDYW52YXMiOiJEcmF3aW5nIGNhbnZhcyIsImxheWVycyI6IkxheWVycyIsImFjdGlvbnMiOiJBY3Rpb25zIiwibGFuZ3VhZ2UiOiJMYW5ndWFnZSIsImNyZWF0ZVJvb20iOiJTaGFyZSBhIGxpdmUtY29sbGFib3JhdGlvbiBzZXNzaW9uIiwiZHVwbGljYXRlU2VsZWN0aW9uIjoiRHVwbGljYXRlIiwidW50aXRsZWQiOiJVbnRpdGxlZCIsIm5hbWUiOiJOYW1lIiwieW91ck5hbWUiOiJZb3VyIG5hbWUiLCJtYWRlV2l0aEV4Y2FsaWRyYXciOiJNYWRlIHdpdGggRXhjYWxpZHJhdyIsImdyb3VwIjoiR3JvdXAgc2VsZWN0aW9uIiwidW5ncm91cCI6IlVuZ3JvdXAgc2VsZWN0aW9uIiwiY29sbGFib3JhdG9ycyI6IkNvbGxhYm9yYXRvcnMiLCJ0b2dnbGVHcmlkTW9kZSI6IlRvZ2dsZSBncmlkIG1vZGUiLCJhZGRUb0xpYnJhcnkiOiJBZGQgdG8gbGlicmFyeSIsInJlbW92ZUZyb21MaWJyYXJ5IjoiUmVtb3ZlIGZyb20gbGlicmFyeSIsImxpYnJhcnlMb2FkaW5nTWVzc2FnZSI6IkxvYWRpbmcgbGlicmFyeS4uLiJ9LCJidXR0b25zIjp7ImNsZWFyUmVzZXQiOiJSZXNldCB0aGUgY2FudmFzIiwiZXhwb3J0IjoiRXhwb3J0IiwiZXhwb3J0VG9QbmciOiJFeHBvcnQgdG8gUE5HIiwiZXhwb3J0VG9TdmciOiJFeHBvcnQgdG8gU1ZHIiwiY29weVRvQ2xpcGJvYXJkIjoiQ29weSB0byBjbGlwYm9hcmQiLCJjb3B5UG5nVG9DbGlwYm9hcmQiOiJDb3B5IFBORyB0byBjbGlwYm9hcmQiLCJzYXZlIjoiU2F2ZSIsInNhdmVBcyI6IlNhdmUgYXMiLCJsb2FkIjoiTG9hZCIsImdldFNoYXJlYWJsZUxpbmsiOiJHZXQgc2hhcmVhYmxlIGxpbmsiLCJjbG9zZSI6IkNsb3NlIiwic2VsZWN0TGFuZ3VhZ2UiOiJTZWxlY3QgbGFuZ3VhZ2UiLCJzY3JvbGxCYWNrVG9Db250ZW50IjoiU2Nyb2xsIGJhY2sgdG8gY29udGVudCIsInpvb21JbiI6Ilpvb20gaW4iLCJ6b29tT3V0IjoiWm9vbSBvdXQiLCJyZXNldFpvb20iOiJSZXNldCB6b29tIiwibWVudSI6Ik1lbnUiLCJkb25lIjoiRG9uZSIsImVkaXQiOiJFZGl0IiwidW5kbyI6IlVuZG8iLCJyZWRvIjoiUmVkbyIsInJvb21EaWFsb2ciOiJTdGFydCBsaXZlIGNvbGxhYm9yYXRpb24iLCJjcmVhdGVOZXdSb29tIjoiQ3JlYXRlIG5ldyByb29tIiwidG9nZ2xlRnVsbFNjcmVlbiI6IlRvZ2dsZSBmdWxsIHNjcmVlbiIsInRvZ2dsZVplbk1vZGUiOiJUb2dnbGUgemVuIG1vZGUiLCJleGl0WmVuTW9kZSI6IkV4aXQgemVuIG1vZGUifSwiYWxlcnRzIjp7ImNsZWFyUmVzZXQiOiJUaGlzIHdpbGwgY2xlYXIgdGhlIHdob2xlIGNhbnZhcy4gQXJlIHlvdSBzdXJlPyIsImNvdWxkTm90Q3JlYXRlU2hhcmVhYmxlTGluayI6IkNvdWxkblwndCBjcmVhdGUgc2hhcmVhYmxlIGxpbmsuIiwiY291bGROb3RMb2FkSW52YWxpZEZpbGUiOiJDb3VsZG5cJ3QgbG9hZCBpbnZhbGlkIGZpbGUiLCJpbXBvcnRCYWNrZW5kRmFpbGVkIjoiSW1wb3J0aW5nIGZyb20gYmFja2VuZCBmYWlsZWQuIiwiY2Fubm90RXhwb3J0RW1wdHlDYW52YXMiOiJDYW5ub3QgZXhwb3J0IGVtcHR5IGNhbnZhcy4iLCJjb3VsZE5vdENvcHlUb0NsaXBib2FyZCI6IkNvdWxkblwndCBjb3B5IHRvIGNsaXBib2FyZC4gVHJ5IHVzaW5nIENocm9tZSBicm93c2VyLiIsImRlY3J5cHRGYWlsZWQiOiJDb3VsZG5cJ3QgZGVjcnlwdCBkYXRhLiIsInVwbG9hZGVkU2VjdXJseSI6IlRoZSB1cGxvYWQgaGFzIGJlZW4gc2VjdXJlZCB3aXRoIGVuZC10by1lbmQgZW5jcnlwdGlvbiwgd2hpY2ggbWVhbnMgdGhhdCBFeGNhbGlkcmF3IHNlcnZlciBhbmQgdGhpcmQgcGFydGllcyBjYW5cJ3QgcmVhZCB0aGUgY29udGVudC4iLCJsb2FkU2NlbmVPdmVycmlkZVByb21wdCI6IkxvYWRpbmcgZXh0ZXJuYWwgZHJhd2luZyB3aWxsIHJlcGxhY2UgeW91ciBleGlzdGluZyBjb250ZW50LiBEbyB5b3Ugd2lzaCB0byBjb250aW51ZT8ifSwidG9vbEJhciI6eyJzZWxlY3Rpb24iOiJTZWxlY3Rpb24iLCJkcmF3IjoiRnJlZSBkcmF3IiwicmVjdGFuZ2xlIjoiUmVjdGFuZ2xlIiwiZGlhbW9uZCI6IkRpYW1vbmQiLCJlbGxpcHNlIjoiRWxsaXBzZSIsImFycm93IjoiQXJyb3ciLCJsaW5lIjoiTGluZSIsInRleHQiOiJUZXh0IiwibGlicmFyeSI6IkxpYnJhcnkiLCJsb2NrIjoiS2VlcCBzZWxlY3RlZCB0b29sIGFjdGl2ZSBhZnRlciBkcmF3aW5nIn0sImhlYWRpbmdzIjp7ImNhbnZhc0FjdGlvbnMiOiJDYW52YXMgYWN0aW9ucyIsInNlbGVjdGVkU2hhcGVBY3Rpb25zIjoiU2VsZWN0ZWQgc2hhcGUgYWN0aW9ucyIsInNoYXBlcyI6IlNoYXBlcyJ9LCJoaW50cyI6eyJsaW5lYXJFbGVtZW50IjoiQ2xpY2sgdG8gc3RhcnQgbXVsdGlwbGUgcG9pbnRzLCBkcmFnIGZvciBzaW5nbGUgbGluZSIsImZyZWVEcmF3IjoiQ2xpY2sgYW5kIGRyYWcsIHJlbGVhc2Ugd2hlbiB5b3VcJ3JlIGZpbmlzaGVkIiwibGluZWFyRWxlbWVudE11bHRpIjoiQ2xpY2sgb24gbGFzdCBwb2ludCBvciBwcmVzcyBFc2NhcGUgb3IgRW50ZXIgdG8gZmluaXNoIiwicmVzaXplIjoiWW91IGNhbiBjb25zdHJhaW4gcHJvcG9ydGlvbnMgYnkgaG9sZGluZyBTSElGVCB3aGlsZSByZXNpemluZyxcXG5ob2xkIEFMVCB0byByZXNpemUgZnJvbSB0aGUgY2VudGVyIiwicm90YXRlIjoiWW91IGNhbiBjb25zdHJhaW4gYW5nbGVzIGJ5IGhvbGRpbmcgU0hJRlQgd2hpbGUgcm90YXRpbmciLCJsaW5lRWRpdG9yX2luZm8iOiJEb3VibGUtY2xpY2sgb3IgcHJlc3MgRW50ZXIgdG8gZWRpdCBwb2ludHMiLCJsaW5lRWRpdG9yX3BvaW50U2VsZWN0ZWQiOiJQcmVzcyBEZWxldGUgdG8gcmVtb3ZlIHBvaW50LCBDdHJsT3JDbWQrRCB0byBkdXBsaWNhdGUsIG9yIGRyYWcgdG8gbW92ZSIsImxpbmVFZGl0b3Jfbm90aGluZ1NlbGVjdGVkIjoiU2VsZWN0IGEgcG9pbnQgdG8gbW92ZSBvciByZW1vdmUsIG9yIGhvbGQgQWx0IGFuZCBjbGljayB0byBhZGQgbmV3IHBvaW50cyJ9LCJlcnJvclNwbGFzaCI6eyJoZWFkaW5nTWFpbl9wcmUiOiJFbmNvdW50ZXJlZCBhbiBlcnJvci4gVHJ5ICIsImhlYWRpbmdNYWluX2J1dHRvbiI6InJlbG9hZGluZyB0aGUgcGFnZS4iLCJjbGVhckNhbnZhc01lc3NhZ2UiOiJJZiByZWxvYWRpbmcgZG9lc25cJ3Qgd29yaywgdHJ5ICIsImNsZWFyQ2FudmFzTWVzc2FnZV9idXR0b24iOiJjbGVhcmluZyB0aGUgY2FudmFzLiIsImNsZWFyQ2FudmFzQ2F2ZWF0IjoiIFRoaXMgd2lsbCByZXN1bHQgaW4gbG9zcyBvZiB3b3JrICIsInRyYWNrZWRUb1NlbnRyeV9wcmUiOiJUaGUgZXJyb3Igd2l0aCBpZGVudGlmaWVyICIsInRyYWNrZWRUb1NlbnRyeV9wb3N0IjoiIHdhcyB0cmFja2VkIG9uIG91ciBzeXN0ZW0uIiwib3Blbklzc3VlTWVzc2FnZV9wcmUiOiJXZSB3ZXJlIHZlcnkgY2F1dGlvdXMgbm90IHRvIGluY2x1ZGUgeW91ciBzY2VuZSBpbmZvcm1hdGlvbiBvbiB0aGUgZXJyb3IuIElmIHlvdXIgc2NlbmUgaXMgbm90IHByaXZhdGUsIHBsZWFzZSBjb25zaWRlciBmb2xsb3dpbmcgdXAgb24gb3VyICIsIm9wZW5Jc3N1ZU1lc3NhZ2VfYnV0dG9uIjoiYnVnIHRyYWNrZXIuIiwib3Blbklzc3VlTWVzc2FnZV9wb3N0IjoiIFBsZWFzZSBpbmNsdWRlIGluZm9ybWF0aW9uIGJlbG93IGJ5IGNvcHlpbmcgYW5kIHBhc3RpbmcgaW50byB0aGUgR2l0SHViIGlzc3VlLiIsInNjZW5lQ29udGVudCI6IlNjZW5lIGNvbnRlbnQ6In0sInJvb21EaWFsb2ciOnsiZGVzY19pbnRybyI6IllvdSBjYW4gaW52aXRlIHBlb3BsZSB0byB5b3VyIGN1cnJlbnQgc2NlbmUgdG8gY29sbGFib3JhdGUgd2l0aCB5b3UuIiwiZGVzY19wcml2YWN5IjoiRG9uXCd0IHdvcnJ5LCB0aGUgc2Vzc2lvbiB1c2VzIGVuZC10by1lbmQgZW5jcnlwdGlvbiwgc28gd2hhdGV2ZXIgeW91IGRyYXcgd2lsbCBzdGF5IHByaXZhdGUuIE5vdCBldmVuIG91ciBzZXJ2ZXIgd2lsbCBiZSBhYmxlIHRvIHNlZSB3aGF0IHlvdSBjb21lIHVwIHdpdGguIiwiYnV0dG9uX3N0YXJ0U2Vzc2lvbiI6IlN0YXJ0IHNlc3Npb24iLCJidXR0b25fc3RvcFNlc3Npb24iOiJTdG9wIHNlc3Npb24iLCJkZXNjX2luUHJvZ3Jlc3NJbnRybyI6IkxpdmUtY29sbGFib3JhdGlvbiBzZXNzaW9uIGlzIG5vdyBpbiBwcm9ncmVzcy4iLCJkZXNjX3BlcnNpc3RlbmNlV2FybmluZyI6Ik5vdGUgdGhhdCB0aGUgc2NlbmUgZGF0YSBpcyBzaGFyZWQgYWNyb3NzIGNvbGxhYm9yYXRvcnMgaW4gYSBQMlAgZmFzaGlvbiwgYW5kIG5vdCBwZXJzaXN0ZWQgdG8gb3VyIHNlcnZlci4gVGh1cywgaWYgYWxsIG9mIHlvdSBkaXNjb25uZWN0LCB5b3Ugd2lsbCBsb3NlIHRoZSBkYXRhIHVubGVzcyB5b3UgZXhwb3J0IGl0IHRvIGEgZmlsZSBvciBhIHNoYXJlYWJsZSBsaW5rLiIsImRlc2Nfc2hhcmVMaW5rIjoiU2hhcmUgdGhpcyBsaW5rIHdpdGggYW55b25lIHlvdSB3YW50IHRvIGNvbGxhYm9yYXRlIHdpdGg6IiwiZGVzY19leGl0U2Vzc2lvbiI6IlN0b3BwaW5nIHRoZSBzZXNzaW9uIHdpbGwgZGlzY29ubmVjdCB5b3UgZnJvbSB0aGUgcm9vbSwgYnV0IHlvdVwnbGwgYmUgYWJsZSB0byBjb250aW51ZSB3b3JraW5nIHdpdGggdGhlIHNjZW5lLCBsb2NhbGx5LiBOb3RlIHRoYXQgdGhpcyB3b25cJ3QgYWZmZWN0IG90aGVyIHBlb3BsZSwgYW5kIHRoZXlcJ2xsIHN0aWxsIGJlIGFibGUgdG8gY29sbGFib3JhdGUgb24gdGhlaXIgdmVyc2lvbi4ifSwiZXJyb3JEaWFsb2ciOnsidGl0bGUiOiJFcnJvciJ9LCJzaG9ydGN1dHNEaWFsb2ciOnsidGl0bGUiOiJLZXlib2FyZCBzaG9ydGN1dHMiLCJzaGFwZXMiOiJTaGFwZXMiLCJvciI6Im9yIiwiY2xpY2siOiJjbGljayIsImRyYWciOiJkcmFnIiwiY3VydmVkQXJyb3ciOiJDdXJ2ZWQgYXJyb3ciLCJjdXJ2ZWRMaW5lIjoiQ3VydmVkIGxpbmUiLCJlZGl0b3IiOiJFZGl0b3IiLCJ2aWV3IjoiVmlldyIsImJsb2ciOiJSZWFkIG91ciBibG9nIiwiaG93dG8iOiJGb2xsb3cgb3VyIGd1aWRlcyIsImdpdGh1YiI6IkZvdW5kIGFuIGlzc3VlPyBTdWJtaXQiLCJ0ZXh0TmV3TGluZSI6IkFkZCBuZXcgbGluZSAodGV4dCkiLCJ0ZXh0RmluaXNoIjoiRmluaXNoIGVkaXRpbmcgKHRleHQpIiwiem9vbVRvRml0IjoiWm9vbSB0byBmaXQgYWxsIGVsZW1lbnRzIn0sImVuY3J5cHRlZCI6eyJ0b29sdGlwIjoiWW91ciBkcmF3aW5ncyBhcmUgZW5kLXRvLWVuZCBlbmNyeXB0ZWQgc28gRXhjYWxpZHJhd1wncyBzZXJ2ZXJzIHdpbGwgbmV2ZXIgc2VlIHRoZW0uIn0sImNoYXJ0cyI6eyJub051bWVyaWNDb2x1bW4iOiJZb3UgcGFzdGVkIGEgc3ByZWFkc2hlZXQgd2l0aG91dCBhIG51bWVyaWMgY29sdW1uLiIsInRvb01hbnlDb2x1bW5zIjoiWW91IHBhc3RlZCBhIHNwcmVhZHNoZWV0IHdpdGggbW9yZSB0aGFuIHR3byBjb2x1bW5zLiJ9fScpfSxmdW5jdGlvbihlKXtlLmV4cG9ydHM9SlNPTi5wYXJzZSgneyJhci1TQSI6NTUsImJnLUJHIjo3OSwiY2EtRVMiOjEwMCwiZGUtREUiOjEwMCwiZWwtR1IiOjk1LCJlbiI6MTAwLCJlcy1FUyI6MTAwLCJmYS1JUiI6OTcsImZpLUZJIjoxMDAsImZyLUZSIjoxMDAsImhlLUlMIjo5MCwiaGktSU4iOjk3LCJodS1IVSI6NTcsImlkLUlEIjo1NywiaXQtSVQiOjEwMCwiamEtSlAiOjc0LCJrby1LUiI6NjksIm5iLU5PIjoxMDAsIm5sLU5MIjo4MSwibm4tTk8iOjEwMCwicGwtUEwiOjk1LCJwdC1QVCI6MTAwLCJydS1SVSI6OTAsInNxLUFMIjo0MSwidGEtSU4iOjYsInRyLVRSIjo5OSwidWstVUEiOjEwMCwiemgtQ04iOjEwMCwiemgtVFciOjEwMH0nKX0sZnVuY3Rpb24oZSx0LG4pe3ZhciByPXsiLi9SRUFETUUubWQiOls4OSw3LDBdLCIuL2FyLVNBLmpzb24iOls5MCwzLDBdLCIuL2JnLUJHLmpzb24iOls5MSwzLDBdLCIuL2NhLUVTLmpzb24iOls5MiwzLDBdLCIuL2RlLURFLmpzb24iOls5MywzLDBdLCIuL2VsLUdSLmpzb24iOls5NCwzLDBdLCIuL2VuLmpzb24iOls1MCwzXSwiLi9lcy1FUy5qc29uIjpbOTUsMywwXSwiLi9mYS1JUi5qc29uIjpbOTYsMywwXSwiLi9maS1GSS5qc29uIjpbOTcsMywwXSwiLi9mci1GUi5qc29uIjpbOTgsMywwXSwiLi9oZS1JTC5qc29uIjpbOTksMywwXSwiLi9oaS1JTi5qc29uIjpbMTAwLDMsMF0sIi4vaHUtSFUuanNvbiI6WzEwMSwzLDBdLCIuL2lkLUlELmpzb24iOlsxMDIsMywwXSwiLi9pdC1JVC5qc29uIjpbMTAzLDMsMF0sIi4vamEtSlAuanNvbiI6WzEwNCwzLDBdLCIuL2tvLUtSLmpzb24iOlsxMDUsMywwXSwiLi9uYi1OTy5qc29uIjpbMTA2LDMsMF0sIi4vbmwtTkwuanNvbiI6WzEwNywzLDBdLCIuL25uLU5PLmpzb24iOlsxMDgsMywwXSwiLi9wZXJjZW50YWdlcy5qc29uIjpbNTEsM10sIi4vcGwtUEwuanNvbiI6WzEwOSwzLDBdLCIuL3B0LVBULmpzb24iOlsxMTAsMywwXSwiLi9ydS1SVS5qc29uIjpbMTExLDMsMF0sIi4vc3EtQUwuanNvbiI6WzExMiwzLDBdLCIuL3RhLUlOLmpzb24iOlsxMTMsMywwXSwiLi90ci1UUi5qc29uIjpbMTE0LDMsMF0sIi4vdWstVUEuanNvbiI6WzExNSwzLDBdLCIuL3poLUNOLmpzb24iOlsxMTYsMywwXSwiLi96aC1UVy5qc29uIjpbMTE3LDMsMF19O2Z1bmN0aW9uIG8oZSl7aWYoIW4ubyhyLGUpKXJldHVybiBQcm9taXNlLnJlc29sdmUoKS50aGVuKChmdW5jdGlvbigpe3ZhciB0PW5ldyBFcnJvcigiQ2Fubm90IGZpbmQgbW9kdWxlICciK2UrIiciKTt0aHJvdyB0LmNvZGU9Ik1PRFVMRV9OT1RfRk9VTkQiLHR9KSk7dmFyIHQ9cltlXSxvPXRbMF07cmV0dXJuIFByb21pc2UuYWxsKHQuc2xpY2UoMikubWFwKG4uZSkpLnRoZW4oKGZ1bmN0aW9uKCl7cmV0dXJuIG4udChvLHRbMV0pfSkpfW8ua2V5cz1mdW5jdGlvbigpe3JldHVybiBPYmplY3Qua2V5cyhyKX0sby5pZD01MixlLmV4cG9ydHM9b30sZnVuY3Rpb24oZSx0LG4pe30sZnVuY3Rpb24oZSx0KXt2YXIgbj0vXig/Oig/IVteOkBdKzpbXjpAXC9dKkApKGh0dHB8aHR0cHN8d3N8d3NzKTpcL1wvKT8oKD86KChbXjpAXSopKD86OihbXjpAXSopKT8pP0ApPygoPzpbYS1mMC05XXswLDR9Oil7Miw3fVthLWYwLTldezAsNH18W146XC8/I10qKSg/OjooXGQqKSk/KSgoKFwvKD86W14/I10oPyFbXj8jXC9dKlwuW14/I1wvLl0rKD86Wz8jXXwkKSkpKlwvPyk/KFtePyNcL10qKSkoPzpcPyhbXiNdKikpPyg/OiMoLiopKT8pLyxyPVsic291cmNlIiwicHJvdG9jb2wiLCJhdXRob3JpdHkiLCJ1c2VySW5mbyIsInVzZXIiLCJwYXNzd29yZCIsImhvc3QiLCJwb3J0IiwicmVsYXRpdmUiLCJwYXRoIiwiZGlyZWN0b3J5IiwiZmlsZSIsInF1ZXJ5IiwiYW5jaG9yIl07ZS5leHBvcnRzPWZ1bmN0aW9uKGUpe3ZhciB0PWUsbz1lLmluZGV4T2YoIlsiKSxhPWUuaW5kZXhPZigiXSIpOy0xIT1vJiYtMSE9YSYmKGU9ZS5zdWJzdHJpbmcoMCxvKStlLnN1YnN0cmluZyhvLGEpLnJlcGxhY2UoLzovZywiOyIpK2Uuc3Vic3RyaW5nKGEsZS5sZW5ndGgpKTtmb3IodmFyIGk9bi5leGVjKGV8fCIiKSxzPXt9LGw9MTQ7bC0tOylzW3JbbF1dPWlbbF18fCIiO3JldHVybi0xIT1vJiYtMSE9YSYmKHMuc291cmNlPXQscy5ob3N0PXMuaG9zdC5zdWJzdHJpbmcoMSxzLmhvc3QubGVuZ3RoLTEpLnJlcGxhY2UoLzsvZywiOiIpLHMuYXV0aG9yaXR5PXMuYXV0aG9yaXR5LnJlcGxhY2UoIlsiLCIiKS5yZXBsYWNlKCJdIiwiIikucmVwbGFjZSgvOy9nLCI6Iikscy5pcHY2dXJpPSEwKSxzfX0sZnVuY3Rpb24oZSx0KXt2YXIgbj17fS50b1N0cmluZztlLmV4cG9ydHM9QXJyYXkuaXNBcnJheXx8ZnVuY3Rpb24oZSl7cmV0dXJuIltvYmplY3QgQXJyYXldIj09bi5jYWxsKGUpfX0sZnVuY3Rpb24oZSx0LG4peyhmdW5jdGlvbih0KXtlLmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuIG4mJnQuaXNCdWZmZXIoZSl8fHImJihlIGluc3RhbmNlb2YgQXJyYXlCdWZmZXJ8fGZ1bmN0aW9uKGUpe3JldHVybiJmdW5jdGlvbiI9PXR5cGVvZiBBcnJheUJ1ZmZlci5pc1ZpZXc/QXJyYXlCdWZmZXIuaXNWaWV3KGUpOmUuYnVmZmVyIGluc3RhbmNlb2YgQXJyYXlCdWZmZXJ9KGUpKX07dmFyIG49ImZ1bmN0aW9uIj09dHlwZW9mIHQmJiJmdW5jdGlvbiI9PXR5cGVvZiB0LmlzQnVmZmVyLHI9ImZ1bmN0aW9uIj09dHlwZW9mIEFycmF5QnVmZmVyfSkuY2FsbCh0aGlzLG4oNDYpLkJ1ZmZlcil9LGZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1uKDEyOSksbz1uKDYzKSxhPW4oNjQpLGk9big0NSkscz1uKDY1KSxsPW4oNjYpLGM9bigyNykoInNvY2tldC5pby1jbGllbnQ6bWFuYWdlciIpLHU9big2MiksZD1uKDE0NCkscD1PYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5O2Z1bmN0aW9uIGgoZSx0KXtpZighKHRoaXMgaW5zdGFuY2VvZiBoKSlyZXR1cm4gbmV3IGgoZSx0KTtlJiYib2JqZWN0Ij09dHlwZW9mIGUmJih0PWUsZT12b2lkIDApLCh0PXR8fHt9KS5wYXRoPXQucGF0aHx8Ii9zb2NrZXQuaW8iLHRoaXMubnNwcz17fSx0aGlzLnN1YnM9W10sdGhpcy5vcHRzPXQsdGhpcy5yZWNvbm5lY3Rpb24oITEhPT10LnJlY29ubmVjdGlvbiksdGhpcy5yZWNvbm5lY3Rpb25BdHRlbXB0cyh0LnJlY29ubmVjdGlvbkF0dGVtcHRzfHwxLzApLHRoaXMucmVjb25uZWN0aW9uRGVsYXkodC5yZWNvbm5lY3Rpb25EZWxheXx8MWUzKSx0aGlzLnJlY29ubmVjdGlvbkRlbGF5TWF4KHQucmVjb25uZWN0aW9uRGVsYXlNYXh8fDVlMyksdGhpcy5yYW5kb21pemF0aW9uRmFjdG9yKHQucmFuZG9taXphdGlvbkZhY3Rvcnx8LjUpLHRoaXMuYmFja29mZj1uZXcgZCh7bWluOnRoaXMucmVjb25uZWN0aW9uRGVsYXkoKSxtYXg6dGhpcy5yZWNvbm5lY3Rpb25EZWxheU1heCgpLGppdHRlcjp0aGlzLnJhbmRvbWl6YXRpb25GYWN0b3IoKX0pLHRoaXMudGltZW91dChudWxsPT10LnRpbWVvdXQ/MmU0OnQudGltZW91dCksdGhpcy5yZWFkeVN0YXRlPSJjbG9zZWQiLHRoaXMudXJpPWUsdGhpcy5jb25uZWN0aW5nPVtdLHRoaXMubGFzdFBpbmc9bnVsbCx0aGlzLmVuY29kaW5nPSExLHRoaXMucGFja2V0QnVmZmVyPVtdO3ZhciBuPXQucGFyc2VyfHxpO3RoaXMuZW5jb2Rlcj1uZXcgbi5FbmNvZGVyLHRoaXMuZGVjb2Rlcj1uZXcgbi5EZWNvZGVyLHRoaXMuYXV0b0Nvbm5lY3Q9ITEhPT10LmF1dG9Db25uZWN0LHRoaXMuYXV0b0Nvbm5lY3QmJnRoaXMub3BlbigpfWUuZXhwb3J0cz1oLGgucHJvdG90eXBlLmVtaXRBbGw9ZnVuY3Rpb24oKXtmb3IodmFyIGUgaW4gdGhpcy5lbWl0LmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLm5zcHMpcC5jYWxsKHRoaXMubnNwcyxlKSYmdGhpcy5uc3BzW2VdLmVtaXQuYXBwbHkodGhpcy5uc3BzW2VdLGFyZ3VtZW50cyl9LGgucHJvdG90eXBlLnVwZGF0ZVNvY2tldElkcz1mdW5jdGlvbigpe2Zvcih2YXIgZSBpbiB0aGlzLm5zcHMpcC5jYWxsKHRoaXMubnNwcyxlKSYmKHRoaXMubnNwc1tlXS5pZD10aGlzLmdlbmVyYXRlSWQoZSkpfSxoLnByb3RvdHlwZS5nZW5lcmF0ZUlkPWZ1bmN0aW9uKGUpe3JldHVybigiLyI9PT1lPyIiOmUrIiMiKSt0aGlzLmVuZ2luZS5pZH0sYShoLnByb3RvdHlwZSksaC5wcm90b3R5cGUucmVjb25uZWN0aW9uPWZ1bmN0aW9uKGUpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyh0aGlzLl9yZWNvbm5lY3Rpb249ISFlLHRoaXMpOnRoaXMuX3JlY29ubmVjdGlvbn0saC5wcm90b3R5cGUucmVjb25uZWN0aW9uQXR0ZW1wdHM9ZnVuY3Rpb24oZSl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KHRoaXMuX3JlY29ubmVjdGlvbkF0dGVtcHRzPWUsdGhpcyk6dGhpcy5fcmVjb25uZWN0aW9uQXR0ZW1wdHN9LGgucHJvdG90eXBlLnJlY29ubmVjdGlvbkRlbGF5PWZ1bmN0aW9uKGUpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyh0aGlzLl9yZWNvbm5lY3Rpb25EZWxheT1lLHRoaXMuYmFja29mZiYmdGhpcy5iYWNrb2ZmLnNldE1pbihlKSx0aGlzKTp0aGlzLl9yZWNvbm5lY3Rpb25EZWxheX0saC5wcm90b3R5cGUucmFuZG9taXphdGlvbkZhY3Rvcj1mdW5jdGlvbihlKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8odGhpcy5fcmFuZG9taXphdGlvbkZhY3Rvcj1lLHRoaXMuYmFja29mZiYmdGhpcy5iYWNrb2ZmLnNldEppdHRlcihlKSx0aGlzKTp0aGlzLl9yYW5kb21pemF0aW9uRmFjdG9yfSxoLnByb3RvdHlwZS5yZWNvbm5lY3Rpb25EZWxheU1heD1mdW5jdGlvbihlKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8odGhpcy5fcmVjb25uZWN0aW9uRGVsYXlNYXg9ZSx0aGlzLmJhY2tvZmYmJnRoaXMuYmFja29mZi5zZXRNYXgoZSksdGhpcyk6dGhpcy5fcmVjb25uZWN0aW9uRGVsYXlNYXh9LGgucHJvdG90eXBlLnRpbWVvdXQ9ZnVuY3Rpb24oZSl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KHRoaXMuX3RpbWVvdXQ9ZSx0aGlzKTp0aGlzLl90aW1lb3V0fSxoLnByb3RvdHlwZS5tYXliZVJlY29ubmVjdE9uT3Blbj1mdW5jdGlvbigpeyF0aGlzLnJlY29ubmVjdGluZyYmdGhpcy5fcmVjb25uZWN0aW9uJiYwPT09dGhpcy5iYWNrb2ZmLmF0dGVtcHRzJiZ0aGlzLnJlY29ubmVjdCgpfSxoLnByb3RvdHlwZS5vcGVuPWgucHJvdG90eXBlLmNvbm5lY3Q9ZnVuY3Rpb24oZSx0KXtpZihjKCJyZWFkeVN0YXRlICVzIix0aGlzLnJlYWR5U3RhdGUpLH50aGlzLnJlYWR5U3RhdGUuaW5kZXhPZigib3BlbiIpKXJldHVybiB0aGlzO2MoIm9wZW5pbmcgJXMiLHRoaXMudXJpKSx0aGlzLmVuZ2luZT1yKHRoaXMudXJpLHRoaXMub3B0cyk7dmFyIG49dGhpcy5lbmdpbmUsbz10aGlzO3RoaXMucmVhZHlTdGF0ZT0ib3BlbmluZyIsdGhpcy5za2lwUmVjb25uZWN0PSExO3ZhciBhPXMobiwib3BlbiIsKGZ1bmN0aW9uKCl7by5vbm9wZW4oKSxlJiZlKCl9KSksaT1zKG4sImVycm9yIiwoZnVuY3Rpb24odCl7aWYoYygiY29ubmVjdF9lcnJvciIpLG8uY2xlYW51cCgpLG8ucmVhZHlTdGF0ZT0iY2xvc2VkIixvLmVtaXRBbGwoImNvbm5lY3RfZXJyb3IiLHQpLGUpe3ZhciBuPW5ldyBFcnJvcigiQ29ubmVjdGlvbiBlcnJvciIpO24uZGF0YT10LGUobil9ZWxzZSBvLm1heWJlUmVjb25uZWN0T25PcGVuKCl9KSk7aWYoITEhPT10aGlzLl90aW1lb3V0KXt2YXIgbD10aGlzLl90aW1lb3V0O2MoImNvbm5lY3QgYXR0ZW1wdCB3aWxsIHRpbWVvdXQgYWZ0ZXIgJWQiLGwpO3ZhciB1PXNldFRpbWVvdXQoKGZ1bmN0aW9uKCl7YygiY29ubmVjdCBhdHRlbXB0IHRpbWVkIG91dCBhZnRlciAlZCIsbCksYS5kZXN0cm95KCksbi5jbG9zZSgpLG4uZW1pdCgiZXJyb3IiLCJ0aW1lb3V0Iiksby5lbWl0QWxsKCJjb25uZWN0X3RpbWVvdXQiLGwpfSksbCk7dGhpcy5zdWJzLnB1c2goe2Rlc3Ryb3k6ZnVuY3Rpb24oKXtjbGVhclRpbWVvdXQodSl9fSl9cmV0dXJuIHRoaXMuc3Vicy5wdXNoKGEpLHRoaXMuc3Vicy5wdXNoKGkpLHRoaXN9LGgucHJvdG90eXBlLm9ub3Blbj1mdW5jdGlvbigpe2MoIm9wZW4iKSx0aGlzLmNsZWFudXAoKSx0aGlzLnJlYWR5U3RhdGU9Im9wZW4iLHRoaXMuZW1pdCgib3BlbiIpO3ZhciBlPXRoaXMuZW5naW5lO3RoaXMuc3Vicy5wdXNoKHMoZSwiZGF0YSIsbCh0aGlzLCJvbmRhdGEiKSkpLHRoaXMuc3Vicy5wdXNoKHMoZSwicGluZyIsbCh0aGlzLCJvbnBpbmciKSkpLHRoaXMuc3Vicy5wdXNoKHMoZSwicG9uZyIsbCh0aGlzLCJvbnBvbmciKSkpLHRoaXMuc3Vicy5wdXNoKHMoZSwiZXJyb3IiLGwodGhpcywib25lcnJvciIpKSksdGhpcy5zdWJzLnB1c2gocyhlLCJjbG9zZSIsbCh0aGlzLCJvbmNsb3NlIikpKSx0aGlzLnN1YnMucHVzaChzKHRoaXMuZGVjb2RlciwiZGVjb2RlZCIsbCh0aGlzLCJvbmRlY29kZWQiKSkpfSxoLnByb3RvdHlwZS5vbnBpbmc9ZnVuY3Rpb24oKXt0aGlzLmxhc3RQaW5nPW5ldyBEYXRlLHRoaXMuZW1pdEFsbCgicGluZyIpfSxoLnByb3RvdHlwZS5vbnBvbmc9ZnVuY3Rpb24oKXt0aGlzLmVtaXRBbGwoInBvbmciLG5ldyBEYXRlLXRoaXMubGFzdFBpbmcpfSxoLnByb3RvdHlwZS5vbmRhdGE9ZnVuY3Rpb24oZSl7dGhpcy5kZWNvZGVyLmFkZChlKX0saC5wcm90b3R5cGUub25kZWNvZGVkPWZ1bmN0aW9uKGUpe3RoaXMuZW1pdCgicGFja2V0IixlKX0saC5wcm90b3R5cGUub25lcnJvcj1mdW5jdGlvbihlKXtjKCJlcnJvciIsZSksdGhpcy5lbWl0QWxsKCJlcnJvciIsZSl9LGgucHJvdG90eXBlLnNvY2tldD1mdW5jdGlvbihlLHQpe3ZhciBuPXRoaXMubnNwc1tlXTtpZighbil7bj1uZXcgbyh0aGlzLGUsdCksdGhpcy5uc3BzW2VdPW47dmFyIHI9dGhpcztuLm9uKCJjb25uZWN0aW5nIixhKSxuLm9uKCJjb25uZWN0IiwoZnVuY3Rpb24oKXtuLmlkPXIuZ2VuZXJhdGVJZChlKX0pKSx0aGlzLmF1dG9Db25uZWN0JiZhKCl9ZnVuY3Rpb24gYSgpe351KHIuY29ubmVjdGluZyxuKXx8ci5jb25uZWN0aW5nLnB1c2gobil9cmV0dXJuIG59LGgucHJvdG90eXBlLmRlc3Ryb3k9ZnVuY3Rpb24oZSl7dmFyIHQ9dSh0aGlzLmNvbm5lY3RpbmcsZSk7fnQmJnRoaXMuY29ubmVjdGluZy5zcGxpY2UodCwxKSx0aGlzLmNvbm5lY3RpbmcubGVuZ3RofHx0aGlzLmNsb3NlKCl9LGgucHJvdG90eXBlLnBhY2tldD1mdW5jdGlvbihlKXtjKCJ3cml0aW5nIHBhY2tldCAlaiIsZSk7dmFyIHQ9dGhpcztlLnF1ZXJ5JiYwPT09ZS50eXBlJiYoZS5uc3ArPSI/IitlLnF1ZXJ5KSx0LmVuY29kaW5nP3QucGFja2V0QnVmZmVyLnB1c2goZSk6KHQuZW5jb2Rpbmc9ITAsdGhpcy5lbmNvZGVyLmVuY29kZShlLChmdW5jdGlvbihuKXtmb3IodmFyIHI9MDtyPG4ubGVuZ3RoO3IrKyl0LmVuZ2luZS53cml0ZShuW3JdLGUub3B0aW9ucyk7dC5lbmNvZGluZz0hMSx0LnByb2Nlc3NQYWNrZXRRdWV1ZSgpfSkpKX0saC5wcm90b3R5cGUucHJvY2Vzc1BhY2tldFF1ZXVlPWZ1bmN0aW9uKCl7aWYodGhpcy5wYWNrZXRCdWZmZXIubGVuZ3RoPjAmJiF0aGlzLmVuY29kaW5nKXt2YXIgZT10aGlzLnBhY2tldEJ1ZmZlci5zaGlmdCgpO3RoaXMucGFja2V0KGUpfX0saC5wcm90b3R5cGUuY2xlYW51cD1mdW5jdGlvbigpe2MoImNsZWFudXAiKTtmb3IodmFyIGU9dGhpcy5zdWJzLmxlbmd0aCx0PTA7dDxlO3QrKyl7dGhpcy5zdWJzLnNoaWZ0KCkuZGVzdHJveSgpfXRoaXMucGFja2V0QnVmZmVyPVtdLHRoaXMuZW5jb2Rpbmc9ITEsdGhpcy5sYXN0UGluZz1udWxsLHRoaXMuZGVjb2Rlci5kZXN0cm95KCl9LGgucHJvdG90eXBlLmNsb3NlPWgucHJvdG90eXBlLmRpc2Nvbm5lY3Q9ZnVuY3Rpb24oKXtjKCJkaXNjb25uZWN0IiksdGhpcy5za2lwUmVjb25uZWN0PSEwLHRoaXMucmVjb25uZWN0aW5nPSExLCJvcGVuaW5nIj09PXRoaXMucmVhZHlTdGF0ZSYmdGhpcy5jbGVhbnVwKCksdGhpcy5iYWNrb2ZmLnJlc2V0KCksdGhpcy5yZWFkeVN0YXRlPSJjbG9zZWQiLHRoaXMuZW5naW5lJiZ0aGlzLmVuZ2luZS5jbG9zZSgpfSxoLnByb3RvdHlwZS5vbmNsb3NlPWZ1bmN0aW9uKGUpe2MoIm9uY2xvc2UiKSx0aGlzLmNsZWFudXAoKSx0aGlzLmJhY2tvZmYucmVzZXQoKSx0aGlzLnJlYWR5U3RhdGU9ImNsb3NlZCIsdGhpcy5lbWl0KCJjbG9zZSIsZSksdGhpcy5fcmVjb25uZWN0aW9uJiYhdGhpcy5za2lwUmVjb25uZWN0JiZ0aGlzLnJlY29ubmVjdCgpfSxoLnByb3RvdHlwZS5yZWNvbm5lY3Q9ZnVuY3Rpb24oKXtpZih0aGlzLnJlY29ubmVjdGluZ3x8dGhpcy5za2lwUmVjb25uZWN0KXJldHVybiB0aGlzO3ZhciBlPXRoaXM7aWYodGhpcy5iYWNrb2ZmLmF0dGVtcHRzPj10aGlzLl9yZWNvbm5lY3Rpb25BdHRlbXB0cyljKCJyZWNvbm5lY3QgZmFpbGVkIiksdGhpcy5iYWNrb2ZmLnJlc2V0KCksdGhpcy5lbWl0QWxsKCJyZWNvbm5lY3RfZmFpbGVkIiksdGhpcy5yZWNvbm5lY3Rpbmc9ITE7ZWxzZXt2YXIgdD10aGlzLmJhY2tvZmYuZHVyYXRpb24oKTtjKCJ3aWxsIHdhaXQgJWRtcyBiZWZvcmUgcmVjb25uZWN0IGF0dGVtcHQiLHQpLHRoaXMucmVjb25uZWN0aW5nPSEwO3ZhciBuPXNldFRpbWVvdXQoKGZ1bmN0aW9uKCl7ZS5za2lwUmVjb25uZWN0fHwoYygiYXR0ZW1wdGluZyByZWNvbm5lY3QiKSxlLmVtaXRBbGwoInJlY29ubmVjdF9hdHRlbXB0IixlLmJhY2tvZmYuYXR0ZW1wdHMpLGUuZW1pdEFsbCgicmVjb25uZWN0aW5nIixlLmJhY2tvZmYuYXR0ZW1wdHMpLGUuc2tpcFJlY29ubmVjdHx8ZS5vcGVuKChmdW5jdGlvbih0KXt0PyhjKCJyZWNvbm5lY3QgYXR0ZW1wdCBlcnJvciIpLGUucmVjb25uZWN0aW5nPSExLGUucmVjb25uZWN0KCksZS5lbWl0QWxsKCJyZWNvbm5lY3RfZXJyb3IiLHQuZGF0YSkpOihjKCJyZWNvbm5lY3Qgc3VjY2VzcyIpLGUub25yZWNvbm5lY3QoKSl9KSkpfSksdCk7dGhpcy5zdWJzLnB1c2goe2Rlc3Ryb3k6ZnVuY3Rpb24oKXtjbGVhclRpbWVvdXQobil9fSl9fSxoLnByb3RvdHlwZS5vbnJlY29ubmVjdD1mdW5jdGlvbigpe3ZhciBlPXRoaXMuYmFja29mZi5hdHRlbXB0czt0aGlzLnJlY29ubmVjdGluZz0hMSx0aGlzLmJhY2tvZmYucmVzZXQoKSx0aGlzLnVwZGF0ZVNvY2tldElkcygpLHRoaXMuZW1pdEFsbCgicmVjb25uZWN0IixlKX19LGZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1uKDQ3KSxvPW4oMTMyKSxhPW4oMTQwKSxpPW4oMTQxKTt0LnBvbGxpbmc9ZnVuY3Rpb24oZSl7dmFyIHQ9ITEsbj0hMSxpPSExIT09ZS5qc29ucDtpZigidW5kZWZpbmVkIiE9dHlwZW9mIGxvY2F0aW9uKXt2YXIgcz0iaHR0cHM6Ij09PWxvY2F0aW9uLnByb3RvY29sLGw9bG9jYXRpb24ucG9ydDtsfHwobD1zPzQ0Mzo4MCksdD1lLmhvc3RuYW1lIT09bG9jYXRpb24uaG9zdG5hbWV8fGwhPT1lLnBvcnQsbj1lLnNlY3VyZSE9PXN9aWYoZS54ZG9tYWluPXQsZS54c2NoZW1lPW4sIm9wZW4iaW4gbmV3IHIoZSkmJiFlLmZvcmNlSlNPTlApcmV0dXJuIG5ldyBvKGUpO2lmKCFpKXRocm93IG5ldyBFcnJvcigiSlNPTlAgZGlzYWJsZWQiKTtyZXR1cm4gbmV3IGEoZSl9LHQud2Vic29ja2V0PWl9LGZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1uKDQ4KSxvPW4oNDApLGE9bigzNCksaT1uKDQxKSxzPW4oNjEpLGw9bigyNykoImVuZ2luZS5pby1jbGllbnQ6cG9sbGluZyIpO2UuZXhwb3J0cz11O3ZhciBjPW51bGwhPW5ldyhuKDQ3KSkoe3hkb21haW46ITF9KS5yZXNwb25zZVR5cGU7ZnVuY3Rpb24gdShlKXt2YXIgdD1lJiZlLmZvcmNlQmFzZTY0O2MmJiF0fHwodGhpcy5zdXBwb3J0c0JpbmFyeT0hMSksci5jYWxsKHRoaXMsZSl9aSh1LHIpLHUucHJvdG90eXBlLm5hbWU9InBvbGxpbmciLHUucHJvdG90eXBlLmRvT3Blbj1mdW5jdGlvbigpe3RoaXMucG9sbCgpfSx1LnByb3RvdHlwZS5wYXVzZT1mdW5jdGlvbihlKXt2YXIgdD10aGlzO2Z1bmN0aW9uIG4oKXtsKCJwYXVzZWQiKSx0LnJlYWR5U3RhdGU9InBhdXNlZCIsZSgpfWlmKHRoaXMucmVhZHlTdGF0ZT0icGF1c2luZyIsdGhpcy5wb2xsaW5nfHwhdGhpcy53cml0YWJsZSl7dmFyIHI9MDt0aGlzLnBvbGxpbmcmJihsKCJ3ZSBhcmUgY3VycmVudGx5IHBvbGxpbmcgLSB3YWl0aW5nIHRvIHBhdXNlIikscisrLHRoaXMub25jZSgicG9sbENvbXBsZXRlIiwoZnVuY3Rpb24oKXtsKCJwcmUtcGF1c2UgcG9sbGluZyBjb21wbGV0ZSIpLC0tcnx8bigpfSkpKSx0aGlzLndyaXRhYmxlfHwobCgid2UgYXJlIGN1cnJlbnRseSB3cml0aW5nIC0gd2FpdGluZyB0byBwYXVzZSIpLHIrKyx0aGlzLm9uY2UoImRyYWluIiwoZnVuY3Rpb24oKXtsKCJwcmUtcGF1c2Ugd3JpdGluZyBjb21wbGV0ZSIpLC0tcnx8bigpfSkpKX1lbHNlIG4oKX0sdS5wcm90b3R5cGUucG9sbD1mdW5jdGlvbigpe2woInBvbGxpbmciKSx0aGlzLnBvbGxpbmc9ITAsdGhpcy5kb1BvbGwoKSx0aGlzLmVtaXQoInBvbGwiKX0sdS5wcm90b3R5cGUub25EYXRhPWZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7bCgicG9sbGluZyBnb3QgZGF0YSAlcyIsZSk7YS5kZWNvZGVQYXlsb2FkKGUsdGhpcy5zb2NrZXQuYmluYXJ5VHlwZSwoZnVuY3Rpb24oZSxuLHIpe2lmKCJvcGVuaW5nIj09PXQucmVhZHlTdGF0ZSYmdC5vbk9wZW4oKSwiY2xvc2UiPT09ZS50eXBlKXJldHVybiB0Lm9uQ2xvc2UoKSwhMTt0Lm9uUGFja2V0KGUpfSkpLCJjbG9zZWQiIT09dGhpcy5yZWFkeVN0YXRlJiYodGhpcy5wb2xsaW5nPSExLHRoaXMuZW1pdCgicG9sbENvbXBsZXRlIiksIm9wZW4iPT09dGhpcy5yZWFkeVN0YXRlP3RoaXMucG9sbCgpOmwoJ2lnbm9yaW5nIHBvbGwgLSB0cmFuc3BvcnQgc3RhdGUgIiVzIicsdGhpcy5yZWFkeVN0YXRlKSl9LHUucHJvdG90eXBlLmRvQ2xvc2U9ZnVuY3Rpb24oKXt2YXIgZT10aGlzO2Z1bmN0aW9uIHQoKXtsKCJ3cml0aW5nIGNsb3NlIHBhY2tldCIpLGUud3JpdGUoW3t0eXBlOiJjbG9zZSJ9XSl9Im9wZW4iPT09dGhpcy5yZWFkeVN0YXRlPyhsKCJ0cmFuc3BvcnQgb3BlbiAtIGNsb3NpbmciKSx0KCkpOihsKCJ0cmFuc3BvcnQgbm90IG9wZW4gLSBkZWZlcnJpbmcgY2xvc2UiKSx0aGlzLm9uY2UoIm9wZW4iLHQpKX0sdS5wcm90b3R5cGUud3JpdGU9ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpczt0aGlzLndyaXRhYmxlPSExO3ZhciBuPWZ1bmN0aW9uKCl7dC53cml0YWJsZT0hMCx0LmVtaXQoImRyYWluIil9O2EuZW5jb2RlUGF5bG9hZChlLHRoaXMuc3VwcG9ydHNCaW5hcnksKGZ1bmN0aW9uKGUpe3QuZG9Xcml0ZShlLG4pfSkpfSx1LnByb3RvdHlwZS51cmk9ZnVuY3Rpb24oKXt2YXIgZT10aGlzLnF1ZXJ5fHx7fSx0PXRoaXMuc2VjdXJlPyJodHRwcyI6Imh0dHAiLG49IiI7cmV0dXJuITEhPT10aGlzLnRpbWVzdGFtcFJlcXVlc3RzJiYoZVt0aGlzLnRpbWVzdGFtcFBhcmFtXT1zKCkpLHRoaXMuc3VwcG9ydHNCaW5hcnl8fGUuc2lkfHwoZS5iNjQ9MSksZT1vLmVuY29kZShlKSx0aGlzLnBvcnQmJigiaHR0cHMiPT09dCYmNDQzIT09TnVtYmVyKHRoaXMucG9ydCl8fCJodHRwIj09PXQmJjgwIT09TnVtYmVyKHRoaXMucG9ydCkpJiYobj0iOiIrdGhpcy5wb3J0KSxlLmxlbmd0aCYmKGU9Ij8iK2UpLHQrIjovLyIrKC0xIT09dGhpcy5ob3N0bmFtZS5pbmRleE9mKCI6Iik/IlsiK3RoaXMuaG9zdG5hbWUrIl0iOnRoaXMuaG9zdG5hbWUpK24rdGhpcy5wYXRoK2V9fSxmdW5jdGlvbihlLHQsbil7KGZ1bmN0aW9uKHQpe3ZhciByPW4oMTM0KSxvPU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcsYT0iZnVuY3Rpb24iPT10eXBlb2YgQmxvYnx8InVuZGVmaW5lZCIhPXR5cGVvZiBCbG9iJiYiW29iamVjdCBCbG9iQ29uc3RydWN0b3JdIj09PW8uY2FsbChCbG9iKSxpPSJmdW5jdGlvbiI9PXR5cGVvZiBGaWxlfHwidW5kZWZpbmVkIiE9dHlwZW9mIEZpbGUmJiJbb2JqZWN0IEZpbGVDb25zdHJ1Y3Rvcl0iPT09by5jYWxsKEZpbGUpO2UuZXhwb3J0cz1mdW5jdGlvbiBlKG4pe2lmKCFufHwib2JqZWN0IiE9dHlwZW9mIG4pcmV0dXJuITE7aWYocihuKSl7Zm9yKHZhciBvPTAscz1uLmxlbmd0aDtvPHM7bysrKWlmKGUobltvXSkpcmV0dXJuITA7cmV0dXJuITF9aWYoImZ1bmN0aW9uIj09dHlwZW9mIHQmJnQuaXNCdWZmZXImJnQuaXNCdWZmZXIobil8fCJmdW5jdGlvbiI9PXR5cGVvZiBBcnJheUJ1ZmZlciYmbiBpbnN0YW5jZW9mIEFycmF5QnVmZmVyfHxhJiZuIGluc3RhbmNlb2YgQmxvYnx8aSYmbiBpbnN0YW5jZW9mIEZpbGUpcmV0dXJuITA7aWYobi50b0pTT04mJiJmdW5jdGlvbiI9PXR5cGVvZiBuLnRvSlNPTiYmMT09PWFyZ3VtZW50cy5sZW5ndGgpcmV0dXJuIGUobi50b0pTT04oKSwhMCk7Zm9yKHZhciBsIGluIG4paWYoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG4sbCkmJmUobltsXSkpcmV0dXJuITA7cmV0dXJuITF9fSkuY2FsbCh0aGlzLG4oNDYpLkJ1ZmZlcil9LGZ1bmN0aW9uKGUsdCxuKXsidXNlIHN0cmljdCI7dmFyIHIsbz0iMDEyMzQ1Njc4OUFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXotXyIuc3BsaXQoIiIpLGE9e30saT0wLHM9MDtmdW5jdGlvbiBsKGUpe3ZhciB0PSIiO2Rve3Q9b1tlJTY0XSt0LGU9TWF0aC5mbG9vcihlLzY0KX13aGlsZShlPjApO3JldHVybiB0fWZ1bmN0aW9uIGMoKXt2YXIgZT1sKCtuZXcgRGF0ZSk7cmV0dXJuIGUhPT1yPyhpPTAscj1lKTplKyIuIitsKGkrKyl9Zm9yKDtzPDY0O3MrKylhW29bc11dPXM7Yy5lbmNvZGU9bCxjLmRlY29kZT1mdW5jdGlvbihlKXt2YXIgdD0wO2ZvcihzPTA7czxlLmxlbmd0aDtzKyspdD02NCp0K2FbZS5jaGFyQXQocyldO3JldHVybiB0fSxlLmV4cG9ydHM9Y30sZnVuY3Rpb24oZSx0KXt2YXIgbj1bXS5pbmRleE9mO2UuZXhwb3J0cz1mdW5jdGlvbihlLHQpe2lmKG4pcmV0dXJuIGUuaW5kZXhPZih0KTtmb3IodmFyIHI9MDtyPGUubGVuZ3RoOysrcilpZihlW3JdPT09dClyZXR1cm4gcjtyZXR1cm4tMX19LGZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1uKDQ1KSxvPW4oNjQpLGE9bigxNDMpLGk9big2NSkscz1uKDY2KSxsPW4oMjcpKCJzb2NrZXQuaW8tY2xpZW50OnNvY2tldCIpLGM9big0MCksdT1uKDYwKTtlLmV4cG9ydHM9aDt2YXIgZD17Y29ubmVjdDoxLGNvbm5lY3RfZXJyb3I6MSxjb25uZWN0X3RpbWVvdXQ6MSxjb25uZWN0aW5nOjEsZGlzY29ubmVjdDoxLGVycm9yOjEscmVjb25uZWN0OjEscmVjb25uZWN0X2F0dGVtcHQ6MSxyZWNvbm5lY3RfZmFpbGVkOjEscmVjb25uZWN0X2Vycm9yOjEscmVjb25uZWN0aW5nOjEscGluZzoxLHBvbmc6MX0scD1vLnByb3RvdHlwZS5lbWl0O2Z1bmN0aW9uIGgoZSx0LG4pe3RoaXMuaW89ZSx0aGlzLm5zcD10LHRoaXMuanNvbj10aGlzLHRoaXMuaWRzPTAsdGhpcy5hY2tzPXt9LHRoaXMucmVjZWl2ZUJ1ZmZlcj1bXSx0aGlzLnNlbmRCdWZmZXI9W10sdGhpcy5jb25uZWN0ZWQ9ITEsdGhpcy5kaXNjb25uZWN0ZWQ9ITAsdGhpcy5mbGFncz17fSxuJiZuLnF1ZXJ5JiYodGhpcy5xdWVyeT1uLnF1ZXJ5KSx0aGlzLmlvLmF1dG9Db25uZWN0JiZ0aGlzLm9wZW4oKX1vKGgucHJvdG90eXBlKSxoLnByb3RvdHlwZS5zdWJFdmVudHM9ZnVuY3Rpb24oKXtpZighdGhpcy5zdWJzKXt2YXIgZT10aGlzLmlvO3RoaXMuc3Vicz1baShlLCJvcGVuIixzKHRoaXMsIm9ub3BlbiIpKSxpKGUsInBhY2tldCIscyh0aGlzLCJvbnBhY2tldCIpKSxpKGUsImNsb3NlIixzKHRoaXMsIm9uY2xvc2UiKSldfX0saC5wcm90b3R5cGUub3Blbj1oLnByb3RvdHlwZS5jb25uZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29ubmVjdGVkfHwodGhpcy5zdWJFdmVudHMoKSx0aGlzLmlvLm9wZW4oKSwib3BlbiI9PT10aGlzLmlvLnJlYWR5U3RhdGUmJnRoaXMub25vcGVuKCksdGhpcy5lbWl0KCJjb25uZWN0aW5nIikpLHRoaXN9LGgucHJvdG90eXBlLnNlbmQ9ZnVuY3Rpb24oKXt2YXIgZT1hKGFyZ3VtZW50cyk7cmV0dXJuIGUudW5zaGlmdCgibWVzc2FnZSIpLHRoaXMuZW1pdC5hcHBseSh0aGlzLGUpLHRoaXN9LGgucHJvdG90eXBlLmVtaXQ9ZnVuY3Rpb24oZSl7aWYoZC5oYXNPd25Qcm9wZXJ0eShlKSlyZXR1cm4gcC5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpczt2YXIgdD1hKGFyZ3VtZW50cyksbj17dHlwZToodm9pZCAwIT09dGhpcy5mbGFncy5iaW5hcnk/dGhpcy5mbGFncy5iaW5hcnk6dSh0KSk/ci5CSU5BUllfRVZFTlQ6ci5FVkVOVCxkYXRhOnQsb3B0aW9uczp7fX07cmV0dXJuIG4ub3B0aW9ucy5jb21wcmVzcz0hdGhpcy5mbGFnc3x8ITEhPT10aGlzLmZsYWdzLmNvbXByZXNzLCJmdW5jdGlvbiI9PXR5cGVvZiB0W3QubGVuZ3RoLTFdJiYobCgiZW1pdHRpbmcgcGFja2V0IHdpdGggYWNrIGlkICVkIix0aGlzLmlkcyksdGhpcy5hY2tzW3RoaXMuaWRzXT10LnBvcCgpLG4uaWQ9dGhpcy5pZHMrKyksdGhpcy5jb25uZWN0ZWQ/dGhpcy5wYWNrZXQobik6dGhpcy5zZW5kQnVmZmVyLnB1c2gobiksdGhpcy5mbGFncz17fSx0aGlzfSxoLnByb3RvdHlwZS5wYWNrZXQ9ZnVuY3Rpb24oZSl7ZS5uc3A9dGhpcy5uc3AsdGhpcy5pby5wYWNrZXQoZSl9LGgucHJvdG90eXBlLm9ub3Blbj1mdW5jdGlvbigpe2lmKGwoInRyYW5zcG9ydCBpcyBvcGVuIC0gY29ubmVjdGluZyIpLCIvIiE9PXRoaXMubnNwKWlmKHRoaXMucXVlcnkpe3ZhciBlPSJvYmplY3QiPT10eXBlb2YgdGhpcy5xdWVyeT9jLmVuY29kZSh0aGlzLnF1ZXJ5KTp0aGlzLnF1ZXJ5O2woInNlbmRpbmcgY29ubmVjdCBwYWNrZXQgd2l0aCBxdWVyeSAlcyIsZSksdGhpcy5wYWNrZXQoe3R5cGU6ci5DT05ORUNULHF1ZXJ5OmV9KX1lbHNlIHRoaXMucGFja2V0KHt0eXBlOnIuQ09OTkVDVH0pfSxoLnByb3RvdHlwZS5vbmNsb3NlPWZ1bmN0aW9uKGUpe2woImNsb3NlICglcykiLGUpLHRoaXMuY29ubmVjdGVkPSExLHRoaXMuZGlzY29ubmVjdGVkPSEwLGRlbGV0ZSB0aGlzLmlkLHRoaXMuZW1pdCgiZGlzY29ubmVjdCIsZSl9LGgucHJvdG90eXBlLm9ucGFja2V0PWZ1bmN0aW9uKGUpe3ZhciB0PWUubnNwPT09dGhpcy5uc3Asbj1lLnR5cGU9PT1yLkVSUk9SJiYiLyI9PT1lLm5zcDtpZih0fHxuKXN3aXRjaChlLnR5cGUpe2Nhc2Ugci5DT05ORUNUOnRoaXMub25jb25uZWN0KCk7YnJlYWs7Y2FzZSByLkVWRU5UOmNhc2Ugci5CSU5BUllfRVZFTlQ6dGhpcy5vbmV2ZW50KGUpO2JyZWFrO2Nhc2Ugci5BQ0s6Y2FzZSByLkJJTkFSWV9BQ0s6dGhpcy5vbmFjayhlKTticmVhaztjYXNlIHIuRElTQ09OTkVDVDp0aGlzLm9uZGlzY29ubmVjdCgpO2JyZWFrO2Nhc2Ugci5FUlJPUjp0aGlzLmVtaXQoImVycm9yIixlLmRhdGEpfX0saC5wcm90b3R5cGUub25ldmVudD1mdW5jdGlvbihlKXt2YXIgdD1lLmRhdGF8fFtdO2woImVtaXR0aW5nIGV2ZW50ICVqIix0KSxudWxsIT1lLmlkJiYobCgiYXR0YWNoaW5nIGFjayBjYWxsYmFjayB0byBldmVudCIpLHQucHVzaCh0aGlzLmFjayhlLmlkKSkpLHRoaXMuY29ubmVjdGVkP3AuYXBwbHkodGhpcyx0KTp0aGlzLnJlY2VpdmVCdWZmZXIucHVzaCh0KX0saC5wcm90b3R5cGUuYWNrPWZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj0hMTtyZXR1cm4gZnVuY3Rpb24oKXtpZighbil7bj0hMDt2YXIgbz1hKGFyZ3VtZW50cyk7bCgic2VuZGluZyBhY2sgJWoiLG8pLHQucGFja2V0KHt0eXBlOnUobyk/ci5CSU5BUllfQUNLOnIuQUNLLGlkOmUsZGF0YTpvfSl9fX0saC5wcm90b3R5cGUub25hY2s9ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5hY2tzW2UuaWRdOyJmdW5jdGlvbiI9PXR5cGVvZiB0PyhsKCJjYWxsaW5nIGFjayAlcyB3aXRoICVqIixlLmlkLGUuZGF0YSksdC5hcHBseSh0aGlzLGUuZGF0YSksZGVsZXRlIHRoaXMuYWNrc1tlLmlkXSk6bCgiYmFkIGFjayAlcyIsZS5pZCl9LGgucHJvdG90eXBlLm9uY29ubmVjdD1mdW5jdGlvbigpe3RoaXMuY29ubmVjdGVkPSEwLHRoaXMuZGlzY29ubmVjdGVkPSExLHRoaXMuZW1pdCgiY29ubmVjdCIpLHRoaXMuZW1pdEJ1ZmZlcmVkKCl9LGgucHJvdG90eXBlLmVtaXRCdWZmZXJlZD1mdW5jdGlvbigpe3ZhciBlO2ZvcihlPTA7ZTx0aGlzLnJlY2VpdmVCdWZmZXIubGVuZ3RoO2UrKylwLmFwcGx5KHRoaXMsdGhpcy5yZWNlaXZlQnVmZmVyW2VdKTtmb3IodGhpcy5yZWNlaXZlQnVmZmVyPVtdLGU9MDtlPHRoaXMuc2VuZEJ1ZmZlci5sZW5ndGg7ZSsrKXRoaXMucGFja2V0KHRoaXMuc2VuZEJ1ZmZlcltlXSk7dGhpcy5zZW5kQnVmZmVyPVtdfSxoLnByb3RvdHlwZS5vbmRpc2Nvbm5lY3Q9ZnVuY3Rpb24oKXtsKCJzZXJ2ZXIgZGlzY29ubmVjdCAoJXMpIix0aGlzLm5zcCksdGhpcy5kZXN0cm95KCksdGhpcy5vbmNsb3NlKCJpbyBzZXJ2ZXIgZGlzY29ubmVjdCIpfSxoLnByb3RvdHlwZS5kZXN0cm95PWZ1bmN0aW9uKCl7aWYodGhpcy5zdWJzKXtmb3IodmFyIGU9MDtlPHRoaXMuc3Vicy5sZW5ndGg7ZSsrKXRoaXMuc3Vic1tlXS5kZXN0cm95KCk7dGhpcy5zdWJzPW51bGx9dGhpcy5pby5kZXN0cm95KHRoaXMpfSxoLnByb3RvdHlwZS5jbG9zZT1oLnByb3RvdHlwZS5kaXNjb25uZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29ubmVjdGVkJiYobCgicGVyZm9ybWluZyBkaXNjb25uZWN0ICglcykiLHRoaXMubnNwKSx0aGlzLnBhY2tldCh7dHlwZTpyLkRJU0NPTk5FQ1R9KSksdGhpcy5kZXN0cm95KCksdGhpcy5jb25uZWN0ZWQmJnRoaXMub25jbG9zZSgiaW8gY2xpZW50IGRpc2Nvbm5lY3QiKSx0aGlzfSxoLnByb3RvdHlwZS5jb21wcmVzcz1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5mbGFncy5jb21wcmVzcz1lLHRoaXN9LGgucHJvdG90eXBlLmJpbmFyeT1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5mbGFncy5iaW5hcnk9ZSx0aGlzfX0sZnVuY3Rpb24oZSx0LG4pe2Z1bmN0aW9uIHIoZSl7aWYoZSlyZXR1cm4gZnVuY3Rpb24oZSl7Zm9yKHZhciB0IGluIHIucHJvdG90eXBlKWVbdF09ci5wcm90b3R5cGVbdF07cmV0dXJuIGV9KGUpfWUuZXhwb3J0cz1yLHIucHJvdG90eXBlLm9uPXIucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXI9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5fY2FsbGJhY2tzPXRoaXMuX2NhbGxiYWNrc3x8e30sKHRoaXMuX2NhbGxiYWNrc1siJCIrZV09dGhpcy5fY2FsbGJhY2tzWyIkIitlXXx8W10pLnB1c2godCksdGhpc30sci5wcm90b3R5cGUub25jZT1mdW5jdGlvbihlLHQpe2Z1bmN0aW9uIG4oKXt0aGlzLm9mZihlLG4pLHQuYXBwbHkodGhpcyxhcmd1bWVudHMpfXJldHVybiBuLmZuPXQsdGhpcy5vbihlLG4pLHRoaXN9LHIucHJvdG90eXBlLm9mZj1yLnByb3RvdHlwZS5yZW1vdmVMaXN0ZW5lcj1yLnByb3RvdHlwZS5yZW1vdmVBbGxMaXN0ZW5lcnM9ci5wcm90b3R5cGUucmVtb3ZlRXZlbnRMaXN0ZW5lcj1mdW5jdGlvbihlLHQpe2lmKHRoaXMuX2NhbGxiYWNrcz10aGlzLl9jYWxsYmFja3N8fHt9LDA9PWFyZ3VtZW50cy5sZW5ndGgpcmV0dXJuIHRoaXMuX2NhbGxiYWNrcz17fSx0aGlzO3ZhciBuLHI9dGhpcy5fY2FsbGJhY2tzWyIkIitlXTtpZighcilyZXR1cm4gdGhpcztpZigxPT1hcmd1bWVudHMubGVuZ3RoKXJldHVybiBkZWxldGUgdGhpcy5fY2FsbGJhY2tzWyIkIitlXSx0aGlzO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKWlmKChuPXJbb10pPT09dHx8bi5mbj09PXQpe3Iuc3BsaWNlKG8sMSk7YnJlYWt9cmV0dXJuIHRoaXN9LHIucHJvdG90eXBlLmVtaXQ9ZnVuY3Rpb24oZSl7dGhpcy5fY2FsbGJhY2tzPXRoaXMuX2NhbGxiYWNrc3x8e307dmFyIHQ9W10uc2xpY2UuY2FsbChhcmd1bWVudHMsMSksbj10aGlzLl9jYWxsYmFja3NbIiQiK2VdO2lmKG4pZm9yKHZhciByPTAsbz0obj1uLnNsaWNlKDApKS5sZW5ndGg7cjxvOysrciluW3JdLmFwcGx5KHRoaXMsdCk7cmV0dXJuIHRoaXN9LHIucHJvdG90eXBlLmxpc3RlbmVycz1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fY2FsbGJhY2tzPXRoaXMuX2NhbGxiYWNrc3x8e30sdGhpcy5fY2FsbGJhY2tzWyIkIitlXXx8W119LHIucHJvdG90eXBlLmhhc0xpc3RlbmVycz1mdW5jdGlvbihlKXtyZXR1cm4hIXRoaXMubGlzdGVuZXJzKGUpLmxlbmd0aH19LGZ1bmN0aW9uKGUsdCl7ZS5leHBvcnRzPWZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gZS5vbih0LG4pLHtkZXN0cm95OmZ1bmN0aW9uKCl7ZS5yZW1vdmVMaXN0ZW5lcih0LG4pfX19fSxmdW5jdGlvbihlLHQpe3ZhciBuPVtdLnNsaWNlO2UuZXhwb3J0cz1mdW5jdGlvbihlLHQpe2lmKCJzdHJpbmciPT10eXBlb2YgdCYmKHQ9ZVt0XSksImZ1bmN0aW9uIiE9dHlwZW9mIHQpdGhyb3cgbmV3IEVycm9yKCJiaW5kKCkgcmVxdWlyZXMgYSBmdW5jdGlvbiIpO3ZhciByPW4uY2FsbChhcmd1bWVudHMsMik7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIHQuYXBwbHkoZSxyLmNvbmNhdChuLmNhbGwoYXJndW1lbnRzKSkpfX19LGZ1bmN0aW9uKGUsdCxuKXtmb3IodmFyIHI9c2VsZi5jcnlwdG98fHNlbGYubXNDcnlwdG8sbz0iLV8iLGE9MzY7YS0tOylvKz1hLnRvU3RyaW5nKDM2KTtmb3IoYT0zNjthLS0tMTA7KW8rPWEudG9TdHJpbmcoMzYpLnRvVXBwZXJDYXNlKCk7ZS5leHBvcnRzPWZ1bmN0aW9uKGUpe3ZhciB0PSIiLG49ci5nZXRSYW5kb21WYWx1ZXMobmV3IFVpbnQ4QXJyYXkoZXx8MjEpKTtmb3IoYT1lfHwyMTthLS07KXQrPW9bNjMmblthXV07cmV0dXJuIHR9fSxmdW5jdGlvbihlLHQsbil7KGZ1bmN0aW9uKHQpe3ZhciBuPS9eXHMrfFxzKyQvZyxyPS9eWy0rXTB4WzAtOWEtZl0rJC9pLG89L14wYlswMV0rJC9pLGE9L14wb1swLTddKyQvaSxpPXBhcnNlSW50LHM9Im9iamVjdCI9PXR5cGVvZiB0JiZ0JiZ0Lk9iamVjdD09PU9iamVjdCYmdCxsPSJvYmplY3QiPT10eXBlb2Ygc2VsZiYmc2VsZiYmc2VsZi5PYmplY3Q9PT1PYmplY3QmJnNlbGYsYz1zfHxsfHxGdW5jdGlvbigicmV0dXJuIHRoaXMiKSgpLHU9T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZyxkPU1hdGgubWF4LHA9TWF0aC5taW4saD1mdW5jdGlvbigpe3JldHVybiBjLkRhdGUubm93KCl9O2Z1bmN0aW9uIGYoZSx0LG4pe3ZhciByLG8sYSxpLHMsbCxjPTAsdT0hMSxmPSExLGI9ITA7aWYoImZ1bmN0aW9uIiE9dHlwZW9mIGUpdGhyb3cgbmV3IFR5cGVFcnJvcigiRXhwZWN0ZWQgYSBmdW5jdGlvbiIpO2Z1bmN0aW9uIHkodCl7dmFyIG49cixhPW87cmV0dXJuIHI9bz12b2lkIDAsYz10LGk9ZS5hcHBseShhLG4pfWZ1bmN0aW9uIHYoZSl7cmV0dXJuIGM9ZSxzPXNldFRpbWVvdXQodyx0KSx1P3koZSk6aX1mdW5jdGlvbiBrKGUpe3ZhciBuPWUtbDtyZXR1cm4gdm9pZCAwPT09bHx8bj49dHx8bjwwfHxmJiZlLWM+PWF9ZnVuY3Rpb24gdygpe3ZhciBlPWgoKTtpZihrKGUpKXJldHVybiBTKGUpO3M9c2V0VGltZW91dCh3LGZ1bmN0aW9uKGUpe3ZhciBuPXQtKGUtbCk7cmV0dXJuIGY/cChuLGEtKGUtYykpOm59KGUpKX1mdW5jdGlvbiBTKGUpe3JldHVybiBzPXZvaWQgMCxiJiZyP3koZSk6KHI9bz12b2lkIDAsaSl9ZnVuY3Rpb24gRSgpe3ZhciBlPWgoKSxuPWsoZSk7aWYocj1hcmd1bWVudHMsbz10aGlzLGw9ZSxuKXtpZih2b2lkIDA9PT1zKXJldHVybiB2KGwpO2lmKGYpcmV0dXJuIHM9c2V0VGltZW91dCh3LHQpLHkobCl9cmV0dXJuIHZvaWQgMD09PXMmJihzPXNldFRpbWVvdXQodyx0KSksaX1yZXR1cm4gdD1nKHQpfHwwLG0obikmJih1PSEhbi5sZWFkaW5nLGE9KGY9Im1heFdhaXQiaW4gbik/ZChnKG4ubWF4V2FpdCl8fDAsdCk6YSxiPSJ0cmFpbGluZyJpbiBuPyEhbi50cmFpbGluZzpiKSxFLmNhbmNlbD1mdW5jdGlvbigpe3ZvaWQgMCE9PXMmJmNsZWFyVGltZW91dChzKSxjPTAscj1sPW89cz12b2lkIDB9LEUuZmx1c2g9ZnVuY3Rpb24oKXtyZXR1cm4gdm9pZCAwPT09cz9pOlMoaCgpKX0sRX1mdW5jdGlvbiBtKGUpe3ZhciB0PXR5cGVvZiBlO3JldHVybiEhZSYmKCJvYmplY3QiPT10fHwiZnVuY3Rpb24iPT10KX1mdW5jdGlvbiBnKGUpe2lmKCJudW1iZXIiPT10eXBlb2YgZSlyZXR1cm4gZTtpZihmdW5jdGlvbihlKXtyZXR1cm4ic3ltYm9sIj09dHlwZW9mIGV8fGZ1bmN0aW9uKGUpe3JldHVybiEhZSYmIm9iamVjdCI9PXR5cGVvZiBlfShlKSYmIltvYmplY3QgU3ltYm9sXSI9PXUuY2FsbChlKX0oZSkpcmV0dXJuIE5hTjtpZihtKGUpKXt2YXIgdD0iZnVuY3Rpb24iPT10eXBlb2YgZS52YWx1ZU9mP2UudmFsdWVPZigpOmU7ZT1tKHQpP3QrIiI6dH1pZigic3RyaW5nIiE9dHlwZW9mIGUpcmV0dXJuIDA9PT1lP2U6K2U7ZT1lLnJlcGxhY2UobiwiIik7dmFyIHM9by50ZXN0KGUpO3JldHVybiBzfHxhLnRlc3QoZSk/aShlLnNsaWNlKDIpLHM/Mjo4KTpyLnRlc3QoZSk/TmFOOitlfWUuZXhwb3J0cz1mdW5jdGlvbihlLHQsbil7dmFyIHI9ITAsbz0hMDtpZigiZnVuY3Rpb24iIT10eXBlb2YgZSl0aHJvdyBuZXcgVHlwZUVycm9yKCJFeHBlY3RlZCBhIGZ1bmN0aW9uIik7cmV0dXJuIG0obikmJihyPSJsZWFkaW5nImluIG4/ISFuLmxlYWRpbmc6cixvPSJ0cmFpbGluZyJpbiBuPyEhbi50cmFpbGluZzpvKSxmKGUsdCx7bGVhZGluZzpyLG1heFdhaXQ6dCx0cmFpbGluZzpvfSl9fSkuY2FsbCh0aGlzLG4oNDQpKX0sZnVuY3Rpb24oZSx0LG4pe30sZnVuY3Rpb24oZSx0LG4pe30sZnVuY3Rpb24oZSx0LG4pe30sZnVuY3Rpb24oZSx0LG4pe30sZnVuY3Rpb24oZSx0LG4pe30sZnVuY3Rpb24oZSx0LG4pe30sZnVuY3Rpb24oZSx0LG4pe30sZnVuY3Rpb24oZSx0LG4pe30sZnVuY3Rpb24oZSx0LG4pe30sZnVuY3Rpb24oZSx0LG4pe30sZnVuY3Rpb24oZSx0LG4pe30sZnVuY3Rpb24oZSx0LG4pe30sZnVuY3Rpb24oZSx0LG4pe30sZnVuY3Rpb24oZSx0LG4pe30sZnVuY3Rpb24oZSx0LG4pe30sZnVuY3Rpb24oZSx0LG4pe30sZnVuY3Rpb24oZSx0LG4pe30sZnVuY3Rpb24oZSx0LG4pe30sZnVuY3Rpb24oZSx0LG4pe30sZnVuY3Rpb24oZSx0LG4pe30sZnVuY3Rpb24oZSx0KXt0aHJvdyBuZXcgRXJyb3IoIk1vZHVsZSBwYXJzZSBmYWlsZWQ6IFVuZXhwZWN0ZWQgY2hhcmFjdGVyICcjJyAoMTowKVxuWW91IG1heSBuZWVkIGFuIGFwcHJvcHJpYXRlIGxvYWRlciB0byBoYW5kbGUgdGhpcyBmaWxlIHR5cGUsIGN1cnJlbnRseSBubyBsb2FkZXJzIGFyZSBjb25maWd1cmVkIHRvIHByb2Nlc3MgdGhpcyBmaWxlLiBTZWUgaHR0cHM6Ly93ZWJwYWNrLmpzLm9yZy9jb25jZXB0cyNsb2FkZXJzXG4+ICMjIEhvdyB0byBjb250cmlidXRlXG58IFxufCBQbGVhc2UgZG8gbm90IGNvbnRyaWJ1dGUgY2hhbmdlcyBkaXJlY3RseSB0byB0aGVzZSBmaWxlcywgYXMgd2UgbWFuYWdlIHRoZW0gd2l0aCBDcm93ZGluLiBJbnN0ZWFkOiIpfSxmdW5jdGlvbihlKXtlLmV4cG9ydHM9SlNPTi5wYXJzZSgneyJsYWJlbHMiOnsicGFzdGUiOiLZhNi12YIiLCJzZWxlY3RBbGwiOiLYqtit2K/ZitivINin2YTZg9mEIiwibXVsdGlTZWxlY3QiOiIiLCJtb3ZlQ2FudmFzIjoiIiwiY29weSI6ItmG2LPYriIsImNvcHlBc1BuZyI6ItmG2LPYriDYpdmE2Ykg2KfZhNit2KfZgdi42Kkg2YPZgCBQTkciLCJjb3B5QXNTdmciOiIiLCJicmluZ0ZvcndhcmQiOiIiLCJzZW5kVG9CYWNrIjoiIiwiYnJpbmdUb0Zyb250IjoiIiwic2VuZEJhY2t3YXJkIjoiIiwiZGVsZXRlIjoi2K3YsNmBIiwiY29weVN0eWxlcyI6IiIsInBhc3RlU3R5bGVzIjoiIiwic3Ryb2tlIjoi2KfZhNit2K/ZiNivIiwiYmFja2dyb3VuZCI6Itin2YTYrtmE2YHZitipIiwiZmlsbCI6Itin2YTYqti52KjYptipIiwic3Ryb2tlV2lkdGgiOiIiLCJzdHJva2VTdHlsZSI6IiIsInN0cm9rZVN0eWxlX3NvbGlkIjoiIiwic3Ryb2tlU3R5bGVfZGFzaGVkIjoiIiwic3Ryb2tlU3R5bGVfZG90dGVkIjoiIiwic2xvcHBpbmVzcyI6Itin2YTYpdmF2KfZhNipIiwib3BhY2l0eSI6Itin2YTYtNmB2KfZgdmK2KkiLCJ0ZXh0QWxpZ24iOiIiLCJmb250U2l6ZSI6IiIsImZvbnRGYW1pbHkiOiIiLCJvbmx5U2VsZWN0ZWQiOiLYp9mE2YXYrdiv2K8g2YHZgti3Iiwid2l0aEJhY2tncm91bmQiOiLZhdi5INin2YTYrtmE2YHZitipIiwiYWRkV2F0ZXJtYXJrIjoiIiwiaGFuZERyYXduIjoiIiwibm9ybWFsIjoi2LnYp9iv2YoiLCJjb2RlIjoi2KfZhNix2YXYsiIsInNtYWxsIjoi2LXYutmK2LEiLCJtZWRpdW0iOiLZhdiq2YjYs9i3IiwibGFyZ2UiOiLZg9io2YrYsSIsInZlcnlMYXJnZSI6IiIsInNvbGlkIjoi2YPYp9mF2YQiLCJoYWNodXJlIjoi2K7Yt9mI2LciLCJjcm9zc0hhdGNoIjoiIiwidGhpbiI6ItmG2K3ZitmBIiwiYm9sZCI6Itiv2KfZg9mGIiwibGVmdCI6IiIsImNlbnRlciI6IiIsInJpZ2h0IjoiIiwiZXh0cmFCb2xkIjoiIiwiYXJjaGl0ZWN0Ijoi2YXYudmF2KfYsdmKIiwiYXJ0aXN0Ijoi2LHYs9in2YUiLCJjYXJ0b29uaXN0Ijoi2YPYsdiq2YjZhtmKIiwiZmlsZVRpdGxlIjoi2LnZhtmI2KfZhiDYp9mE2YXZhNmBIiwiY29sb3JQaWNrZXIiOiLYp9iu2KrZitin2LEg2KfZhNij2YTZiNin2YYiLCJjYW52YXNCYWNrZ3JvdW5kIjoi2K7ZhNmB2YrYqSDYp9mE2YTZiNit2KkiLCJkcmF3aW5nQ2FudmFzIjoiIiwibGF5ZXJzIjoi2KfZhNi32KjZgtin2KoiLCJhY3Rpb25zIjoi2KfZhNil2KzYsdin2KHYp9iqIiwibGFuZ3VhZ2UiOiLYp9mE2YTYutipIiwiY3JlYXRlUm9vbSI6ItmF2LTYp9ix2YPYqSDYp9mE2KzZhNiz2Kkg2YXYqNin2LTYsdipIiwiZHVwbGljYXRlU2VsZWN0aW9uIjoiIiwidW50aXRsZWQiOiIiLCJuYW1lIjoiIiwieW91ck5hbWUiOiIiLCJtYWRlV2l0aEV4Y2FsaWRyYXciOiIiLCJncm91cCI6IiIsInVuZ3JvdXAiOiIiLCJjb2xsYWJvcmF0b3JzIjoiIiwidG9nZ2xlR3JpZE1vZGUiOiIiLCJhZGRUb0xpYnJhcnkiOiIiLCJyZW1vdmVGcm9tTGlicmFyeSI6IiIsImxpYnJhcnlMb2FkaW5nTWVzc2FnZSI6IiJ9LCJidXR0b25zIjp7ImNsZWFyUmVzZXQiOiLYpdi52KfYr9ipINiq2LnZitmK2YYg2KfZhNmE2YjYrdipIiwiZXhwb3J0Ijoi2KrYtdiv2YrYsSIsImV4cG9ydFRvUG5nIjoi2KrYtdiv2YrYsSDZg9mAIFBORyIsImV4cG9ydFRvU3ZnIjoi2KrYtdiv2YrYsSDZg9mAIFNWRyIsImNvcHlUb0NsaXBib2FyZCI6ItmG2LPYriDYpdmE2Ykg2KfZhNit2KfZgdi42KkiLCJjb3B5UG5nVG9DbGlwYm9hcmQiOiLZhtiz2K4g2KfZhNmAIFBORyDYp9mE2Ykg2KfZhNit2KfZgdi42KkiLCJzYXZlIjoi2K3Zgdi4Iiwic2F2ZUFzIjoiIiwibG9hZCI6Itiq2K3ZhdmK2YQiLCJnZXRTaGFyZWFibGVMaW5rIjoi2KfYrdi12YQg2LnZhNmJINix2KfYqNi3INin2YTZhdi02KfYsdmD2KkiLCJjbG9zZSI6Itil2LrZhNin2YIiLCJzZWxlY3RMYW5ndWFnZSI6IiIsInNjcm9sbEJhY2tUb0NvbnRlbnQiOiLYp9mE2LHYrNmI2Lkg2YTZhNmF2K3YqtmI2YkiLCJ6b29tSW4iOiLYqtmD2KjZitixIiwiem9vbU91dCI6Itiq2LXYutmK2LEiLCJyZXNldFpvb20iOiLYpdi52KfYr9ipINiq2LnZitmK2YYg2KfZhNi02KfYtNipIiwibWVudSI6Itin2YTZgtin2KbZhdipIiwiZG9uZSI6Itiq2YUiLCJlZGl0Ijoi2KrYudiv2YrZhCIsInVuZG8iOiLYqtix2KfYrNi5INi52YYiLCJyZWRvIjoi2KXYudin2K/YqSDYqtmG2YHZitiwIiwicm9vbURpYWxvZyI6Itio2K/YoSDYp9mE2YXYtNin2LHZg9ipINin2YTYrdmK2KkiLCJjcmVhdGVOZXdSb29tIjoi2KXZhti02KfYoSDYutix2YHYqSDYrNiv2YrYr9ipIiwidG9nZ2xlRnVsbFNjcmVlbiI6IiIsInRvZ2dsZVplbk1vZGUiOiIiLCJleGl0WmVuTW9kZSI6IiJ9LCJhbGVydHMiOnsiY2xlYXJSZXNldCI6ItmH2LDYpyDYs9mK2LLZitmEINmD2KfZhdmEINin2YTZhNmI2K3YqS4g2YfZhCDYo9mG2Kog2YXYqtij2YPYryDYnyIsImNvdWxkTm90Q3JlYXRlU2hhcmVhYmxlTGluayI6Itiq2LnYsNixINil2YbYtNin2KEg2LHYp9io2LfYqSDYp9mE2YXYtNin2LHZg9ipLiIsImNvdWxkTm90TG9hZEludmFsaWRGaWxlIjoi2KrYudiw2LEg2KfZhNiq2K3ZhdmK2YTYjCDYp9mE2YXZhNmBINi62YrYsSDYtdin2YTYrSIsImltcG9ydEJhY2tlbmRGYWlsZWQiOiLZgdi02YQg2KfZhNil2LPYqtmK2LHYp9ivINmF2YYg2KfZhNiz2YrYsdmB2LEuIiwiY2Fubm90RXhwb3J0RW1wdHlDYW52YXMiOiLZhNinINmK2YXZg9mGINiq2LXYr9mK2LEg2YTZiNit2Kkg2YHYp9ix2LrYqS4iLCJjb3VsZE5vdENvcHlUb0NsaXBib2FyZCI6Itiq2LnYsNixINin2YTZhtiz2K4g2KXZhNmJINin2YTYrdin2YHYuNipLiDYrdin2YjZhCDYp9iz2KrYrtiv2KfZhSDZhdiq2LXZgditIENocm9tZS4iLCJkZWNyeXB0RmFpbGVkIjoi2KrYudiw2LEg2YHZgyDYqti02YHZitixINin2YTYqNmK2KfZhtin2KouIiwidXBsb2FkZWRTZWN1cmx5Ijoi2KrZhSDYqtij2YXZitmGINin2YTYqtit2YXZitmEINio2KrYtNmB2YrYsSDYp9mE2YbZh9in2YrYqSDYpdmE2Ykg2KfZhNmG2YfYp9mK2KnYjCDZhdmF2Kcg2YrYudmG2Yog2KPZhiDYrtin2K/ZhSBFeGNhbGlkcmF3INmI2KfZhNij2LfYsdin2YEg2KfZhNir2KfZhNir2Kkg2YTYpyDZitmF2YPZhtmH2Kcg2YLYsdin2KHYqSDYp9mE2YXYrdiq2YjZiS4iLCJsb2FkU2NlbmVPdmVycmlkZVByb21wdCI6IiJ9LCJ0b29sQmFyIjp7InNlbGVjdGlvbiI6Itiq2K3Yr9mK2K8iLCJkcmF3IjoiIiwicmVjdGFuZ2xlIjoi2YXYs9iq2LfZitmEIiwiZGlhbW9uZCI6ItmF2LbZhNi5IiwiZWxsaXBzZSI6Itiv2KfYptix2KkiLCJhcnJvdyI6Itiz2YfZhSIsImxpbmUiOiLYrti3IiwidGV4dCI6ItmG2LUiLCJsaWJyYXJ5IjoiIiwibG9jayI6Itin2YTYrdmB2KfYuCDYudmE2Ykg2KPYr9in2Kkg2KfZhNiq2K3Yr9mK2K8g2YbYtNi32Kkg2KjYudivINin2YTYsdiz2YUifSwiaGVhZGluZ3MiOnsiY2FudmFzQWN0aW9ucyI6Itil2KzYsdin2KHYp9iqINin2YTZhNmI2K3YqSIsInNlbGVjdGVkU2hhcGVBY3Rpb25zIjoi2KXYrNix2KfYodin2Kog2KfZhNi02YPZhCDYp9mE2YXYrdiv2K8iLCJzaGFwZXMiOiLYp9mE2KPYtNmD2KfZhCJ9LCJoaW50cyI6eyJsaW5lYXJFbGVtZW50Ijoi2KfZhtmC2LEg2YTYqNiv2KEg2YbZgtin2Lcg2YXYqti52K/Yr9ip2Iwg2KfYs9it2Kgg2YTYrti3INmI2KfYrdivIiwiZnJlZURyYXciOiIiLCJsaW5lYXJFbGVtZW50TXVsdGkiOiLYp9mG2YLYsSDZgdmI2YIg2KfZhNmG2YLYt9ipINin2YTYo9iu2YrYsdipINij2Ygg2KfYtti62Lcg2LnZhNmJIEVzYyDYo9mIIEVudGVyINmE2YTYpdmG2YfYp9ihIiwicmVzaXplIjoiIiwicm90YXRlIjoi2YrZhdmD2YbZgyDYqtmC2YrZitivINin2YTYstmI2KfZitinINmF2YYg2K7ZhNin2YQg2KfZhNi22LrYtyDYudmE2YkgU0hJRlQg2KPYq9mG2KfYoSDYp9mE2K/ZiNix2KfZhiIsImxpbmVFZGl0b3JfaW5mbyI6IiIsImxpbmVFZGl0b3JfcG9pbnRTZWxlY3RlZCI6IiIsImxpbmVFZGl0b3Jfbm90aGluZ1NlbGVjdGVkIjoiIn0sImVycm9yU3BsYXNoIjp7ImhlYWRpbmdNYWluX3ByZSI6Itit2K/YqyDYrti32KPYjCDYrdin2YjZhCDZhdix2Kkg2KPYrtix2YkgIiwiaGVhZGluZ01haW5fYnV0dG9uIjoi2KXYudin2K/YqSDYqtit2YXZitmEINin2YTYtdmB2K3YqS4iLCJjbGVhckNhbnZhc01lc3NhZ2UiOiLYpdiw2Kcg2YTZhSDYqti52YXZhCDYpdi52KfYr9ipINin2YTYqtit2YXZitmE2Iwg2K3Yp9mI2YQg2YXYsdipINij2K7YsdmJICIsImNsZWFyQ2FudmFzTWVzc2FnZV9idXR0b24iOiLZhdiz2K0g2KfZhNmE2YjYrdipLiIsImNsZWFyQ2FudmFzQ2F2ZWF0IjoiINmH2LDYpyDYs9mK2KTYr9mKINil2YTZiSDZgdmC2K/Yp9mGINin2YTYudmF2YQgIiwidHJhY2tlZFRvU2VudHJ5X3ByZSI6Itin2YTYrti32KMg2KjYudmG2YjYp9mGICIsInRyYWNrZWRUb1NlbnRyeV9wb3N0IjoiINiq2YUg2KrYudmC2KjZhyDYudmE2Ykg2YbYuNin2YXZhtinLiIsIm9wZW5Jc3N1ZU1lc3NhZ2VfcHJlIjoi2YPZhtinINit2LDYsdmK2YYg2KzYr9inINmE2LnYr9mFINiq2LbZhdmK2YYg2YXYudmE2YjZhdin2Kog2KfZhNmF2LTZh9ivINin2YTYrtin2LXYqSDYqNmDINmB2Yog2KfZhNiu2LfYoy4g2KXYsNinINmE2YUg2YrZg9mGINin2YTZhdi02YfYryDYrtin2LXZi9inINiMINmK2LHYrNmJINin2YTZhti42LEg2YHZiiDZhdiq2KfYqNi52Kkg2YfYsNinINin2YTYo9mF2LEgIiwib3Blbklzc3VlTWVzc2FnZV9idXR0b24iOiLZhdiq2LnZgtmR2Kgg2KfZhNiu2YTZhC4iLCJvcGVuSXNzdWVNZXNzYWdlX3Bvc3QiOiIg2YrYsdis2Ykg2KrYttmF2YrZhiDYp9mE2YXYudmE2YjZhdin2Kog2KfYr9mG2KfZhyDYudmGINi32LHZitmCINmG2LPYriDZiNmE2LXZgiDYp9mE2YXYtNmD2YTYqSDZgdmKIEdpdEh1Yi4iLCJzY2VuZUNvbnRlbnQiOiLZhdit2KrZiNmJINin2YTZhdi02YfYrzoifSwicm9vbURpYWxvZyI6eyJkZXNjX2ludHJvIjoi2YrZhdmD2YbZgyDYr9i52YjYqSDYp9mE2KLYrtix2YrZhiDZhNmF2LTYp9ix2YPYqtmDINmG2YHYsyDYp9mE2KzZhNiz2Kkg2KfZhNiq2Yog2KrYudmF2YQg2LnZhNmK2YfYpy4iLCJkZXNjX3ByaXZhY3kiOiLZhNinINiq2YLZhNmC2Iwg2KfZhNis2YTYs9ipINiq2LPYqtiu2K/ZhSDYp9mE2KrYtNmB2YrYsSDZhdmGINin2YTZhtmH2KfZitipINil2YTZiSDYp9mE2YbZh9in2YrYqdiMINmE2LDZhNmDINmB2KXZhiDYo9mKINi02YrYoSDYqtix2LPZhdmHINiz2YrYqNmC2Ykg2K7Yp9i12KfZiy4g2YTZhiDZitiq2YXZg9mGINit2KrZiSDYp9mE2K7Yp9iv2YUg2KfZhNiu2KfYtSDYqNmG2Kcg2YXZhiDYsdik2YrYqSDZhdinINiq2YjYtdmE2Kog2KXZhNmK2YcuIiwiYnV0dG9uX3N0YXJ0U2Vzc2lvbiI6Itio2K/YoSDYp9mE2KzZhNiz2KkiLCJidXR0b25fc3RvcFNlc3Npb24iOiLYpdmK2YLYp9mBINin2YTYrNmE2LPYqSIsImRlc2NfaW5Qcm9ncmVzc0ludHJvIjoi2KrYrNix2Yog2KfZhNii2YYg2KfZhNmF2LTYp9ix2YPYqSDYp9mE2K3ZitipLiIsImRlc2NfcGVyc2lzdGVuY2VXYXJuaW5nIjoiIiwiZGVzY19zaGFyZUxpbmsiOiLYtNin2LHZgyDZh9iw2Kcg2KfZhNix2KfYqNi3INmF2Lkg2KPZiiDYtNiu2LUg2KrYsdmK2K/ZhyDYp9mGINmK2LTYp9ix2YPZgyDYp9mE2KzZhNiz2Kk6IiwiZGVzY19leGl0U2Vzc2lvbiI6IiJ9LCJlcnJvckRpYWxvZyI6eyJ0aXRsZSI6Itiu2LfYoyJ9LCJzaG9ydGN1dHNEaWFsb2ciOnsidGl0bGUiOiIiLCJzaGFwZXMiOiIiLCJvciI6IiIsImNsaWNrIjoiIiwiZHJhZyI6IiIsImN1cnZlZEFycm93IjoiIiwiY3VydmVkTGluZSI6IiIsImVkaXRvciI6IiIsInZpZXciOiIiLCJibG9nIjoiIiwiaG93dG8iOiIiLCJnaXRodWIiOiIiLCJ0ZXh0TmV3TGluZSI6IiIsInRleHRGaW5pc2giOiIiLCJ6b29tVG9GaXQiOiIifSwiZW5jcnlwdGVkIjp7InRvb2x0aXAiOiIifSwiY2hhcnRzIjp7Im5vTnVtZXJpY0NvbHVtbiI6IiIsInRvb01hbnlDb2x1bW5zIjoiIn19Jyl9LGZ1bmN0aW9uKGUpe2UuZXhwb3J0cz1KU09OLnBhcnNlKCd7ImxhYmVscyI6eyJwYXN0ZSI6ItCf0L7RgdGC0LDQstC4Iiwic2VsZWN0QWxsIjoi0JzQsNGA0LrQuNGA0LDQuSDQstGB0LjRh9C60L4iLCJtdWx0aVNlbGVjdCI6IiIsIm1vdmVDYW52YXMiOiIiLCJjb3B5Ijoi0JrQvtC/0LjRgNCw0LkiLCJjb3B5QXNQbmciOiLQmtC+0L/QuNGA0LDQvdC1INCyINC60LvQuNC/0LHQvtGA0LTQsCIsImNvcHlBc1N2ZyI6ItCa0L7Qv9C40YDQsNC90LUg0LIg0LrQu9C40L/QsdC+0YDQtNCwIiwiYnJpbmdGb3J3YXJkIjoi0J/RgNC10LzQtdGB0YLQstCw0L3QtSDQvdCwftC/0YDQtdC0Iiwic2VuZFRvQmFjayI6ItCY0LfQvdCw0YHRj9C90LUg0L3QsNC30LDQtCIsImJyaW5nVG9Gcm9udCI6In7QmNC30L3QsNGB0Y/QvdC1INC+0YLQv9GA0LXQtCIsInNlbmRCYWNrd2FyZCI6ItCY0LfQv9GA0LDRgtC4INC90LDQt9Cw0LQiLCJkZWxldGUiOiLQmNC30YLRgNC40LkiLCJjb3B5U3R5bGVzIjoi0JrQvtC/0LjRgNCw0LnRgtC1INGB0YLQuNC70L7QstC1IiwicGFzdGVTdHlsZXMiOiLQn9C+0YHRgtCw0LLQuCDRgdGC0LjQu9C+0LLQtSIsInN0cm9rZSI6ItCp0YDQuNGFIiwiYmFja2dyb3VuZCI6ItCk0L7QvSIsImZpbGwiOiLQndCw0YHQuNGC0LXQvdC+0YHRgiIsInN0cm9rZVdpZHRoIjoi0KjQuNGA0LjQvdCwINC90LAg0YnRgNC40YXQsCIsInN0cm9rZVN0eWxlIjoiIiwic3Ryb2tlU3R5bGVfc29saWQiOiIiLCJzdHJva2VTdHlsZV9kYXNoZWQiOiIiLCJzdHJva2VTdHlsZV9kb3R0ZWQiOiIiLCJzbG9wcGluZXNzIjoi0J3QtdCx0YDQtdC20L3QvtGB0YIiLCJvcGFjaXR5Ijoi0J3QtdC/0YDQvtC30YDQsNGH0L3QvtGB0YIiLCJ0ZXh0QWxpZ24iOiLQn9C+0LTRgNCw0LLQvdGP0LLQsNC90LUg0L3QsCDRgtC10LrRgdGC0LAiLCJmb250U2l6ZSI6ItCg0LDQt9C80LXRgCDQvdCwINGI0YDQuNGE0YLQsCIsImZvbnRGYW1pbHkiOiLQodC10LzQtdC50YHRgtCy0L4g0YjRgNC40YTRgtC+0LLQtSIsIm9ubHlTZWxlY3RlZCI6ItCh0LDQvNC+INC40LfQsdGA0LDQvdC+0YLQviIsIndpdGhCYWNrZ3JvdW5kIjoi0KEg0YTQvtC9IiwiYWRkV2F0ZXJtYXJrIjoiIiwiaGFuZERyYXduIjoi0J3QsNGA0LjRgdGD0LLQsNC90L4g0L3QsCDRgNGK0LrQsCIsIm5vcm1hbCI6ItCd0L7RgNC80LDQu9C10L0iLCJjb2RlIjoi0JrQvtC0Iiwic21hbGwiOiLQnNCw0LvRitC6IiwibWVkaXVtIjoi0KHRgNC10LTQtdC9IiwibGFyZ2UiOiLQk9C+0LvRj9C8IiwidmVyeUxhcmdlIjoi0JzQvdC+0LPQviDQs9C+0LvRj9C8Iiwic29saWQiOiLQodC+0LvQuNC00LXQvSIsImhhY2h1cmUiOiLQpdC10YDQsNC70LTQuNC60LAiLCJjcm9zc0hhdGNoIjoiIiwidGhpbiI6ItCi0YrQvdGK0LoiLCJib2xkIjoi0K/RgdC90L4g0L7Rh9C10YDRgtCw0L0iLCJsZWZ0Ijoi0JvRj9Cy0L4iLCJjZW50ZXIiOiLQptC10L3RgtGK0YAiLCJyaWdodCI6ItCU0Y/RgdC90L4iLCJleHRyYUJvbGQiOiLQnNC90L7Qs9C+INGP0YHQvdC+INC+0YfQtdGA0YLQsNC9IiwiYXJjaGl0ZWN0Ijoi0JDRgNGF0LjRgtC10LrRgiIsImFydGlzdCI6ItCl0YPQtNC+0LbQvdC40LoiLCJjYXJ0b29uaXN0Ijoi0JrQsNGA0LjQutCw0YLRg9GA0LjRgdGCIiwiZmlsZVRpdGxlIjoi0JfQsNCz0LvQsNCy0LjQtSDQvdCwINGE0LDQudC7IiwiY29sb3JQaWNrZXIiOiLQmNC30LHQvtGAINC90LAg0YbQstGP0YIiLCJjYW52YXNCYWNrZ3JvdW5kIjoi0KTQvtC9INC90LAg0L/Qu9Cw0YLQvdC+IiwiZHJhd2luZ0NhbnZhcyI6ItCf0LvQsNGC0L3QviDQt9CwINGA0LjRgdGD0LLQsNC90LUiLCJsYXllcnMiOiLQodC70L7QtdCy0LUiLCJhY3Rpb25zIjoi0JTQtdC50YHRgtCy0LjRjyIsImxhbmd1YWdlIjoi0JXQt9C40LoiLCJjcmVhdGVSb29tIjoi0KHQv9C+0LTQtdC70LXRgtC1INGB0LXRgdC40Y8g0LfQsCDRgdGK0YLRgNGD0LTQvdC40YfQtdGB0YLQstC+INC90LAg0LbQuNCy0L4iLCJkdXBsaWNhdGVTZWxlY3Rpb24iOiLQlNGD0LHQu9C40YDQsNC5IiwidW50aXRsZWQiOiLQndC10L7Qt9Cw0LPQu9Cw0LLQtdC90L4iLCJuYW1lIjoi0JjQvNC1IiwieW91ck5hbWUiOiIiLCJtYWRlV2l0aEV4Y2FsaWRyYXciOiIiLCJncm91cCI6IiIsInVuZ3JvdXAiOiIiLCJjb2xsYWJvcmF0b3JzIjoiIiwidG9nZ2xlR3JpZE1vZGUiOiIiLCJhZGRUb0xpYnJhcnkiOiIiLCJyZW1vdmVGcm9tTGlicmFyeSI6IiIsImxpYnJhcnlMb2FkaW5nTWVzc2FnZSI6IiJ9LCJidXR0b25zIjp7ImNsZWFyUmVzZXQiOiLQndGD0LvQuNGA0LDQvdC1INC90LAg0L/Qu9Cw0YLQvdC+IiwiZXhwb3J0Ijoi0JXQutGB0L/QvtGA0YLQuNGA0LDQvdC1IiwiZXhwb3J0VG9QbmciOiLQmNC30L3QsNGB0Y/QvdC1INCyIFBORyIsImV4cG9ydFRvU3ZnIjoi0JjQt9C90LDRgdGP0L3QtSDQsiBTVkciLCJjb3B5VG9DbGlwYm9hcmQiOiLQmtC+0L/QuNGA0LDQvdC1INCyINC60LvQuNC/0LHQvtGA0LTQsCIsImNvcHlQbmdUb0NsaXBib2FyZCI6ItCa0L7Qv9C40YDQsNC5IFBORyDQsiDQutC70LjQv9Cx0L7RgNC00LAiLCJzYXZlIjoi0JfQsNC/0LDQt9C4Iiwic2F2ZUFzIjoi0JfQsNC/0LjRiNC4INC60LDRgtC+IiwibG9hZCI6ItCX0LDRgNC10LbQtNCw0L3QtSIsImdldFNoYXJlYWJsZUxpbmsiOiLQn9C+0LvRg9GH0LDQstCw0L3QtSDQvdCwINCy0YDRitC30LrQsCDQt9CwINGB0L/QvtC00LXQu9GP0L3QtSIsImNsb3NlIjoi0JfQsNGC0LLQvtGA0LgiLCJzZWxlY3RMYW5ndWFnZSI6ItCY0LfQsdC+0YAg0L3QsCDQtdC30LjQuiIsInNjcm9sbEJhY2tUb0NvbnRlbnQiOiLQn9GA0LXQstGK0YDRgtC10YLQtSDQvtCx0YDQsNGC0L3QviDQutGK0Lwg0YHRitC00YrRgNC20LDQvdC40LXRgtC+Iiwiem9vbUluIjoi0J/RgNC40LHQu9C40LbQsNCy0LDQvdC1Iiwiem9vbU91dCI6ItCe0YLQtNCw0LvQtdGH0LDQstCw0L3QtSIsInJlc2V0Wm9vbSI6ItCh0YLQsNC90LTQsNGA0YLQtdC9INC80LDRidCw0LEiLCJtZW51Ijoi0JzQtdC90Y4iLCJkb25lIjoi0JfQsNCy0YrRgNGI0LXQvdC+IiwiZWRpdCI6ItCg0LXQtNCw0LrRgtC40YDQsNC90LUiLCJ1bmRvIjoi0J7RgtC80Y/QvdCwIiwicmVkbyI6ItCf0L7QstGC0L7RgNC4Iiwicm9vbURpYWxvZyI6ItCX0LDQv9C+0YfQvdC10YLQtSDRgdGK0YLRgNGD0LTQvdC40YfQtdGB0YLQstC+INC90LAg0LbQuNCy0L4iLCJjcmVhdGVOZXdSb29tIjoi0KHRitC30LTQsNC5INC90L7QstCwINGB0YLQsNGPIiwidG9nZ2xlRnVsbFNjcmVlbiI6ItCf0YDQtdCy0LrQu9GO0YfQstCw0L3QtSDQvdCwINGG0Y/QuyDQtdC60YDQsNC9IiwidG9nZ2xlWmVuTW9kZSI6IiIsImV4aXRaZW5Nb2RlIjoiIn0sImFsZXJ0cyI6eyJjbGVhclJlc2V0Ijoi0KLQvtCy0LAg0YnQtSDQuNC30YfQuNGB0YLQuCDRhtGP0LvQvtGC0L4g0L/Qu9Cw0YLQvdC+LiDQodC40LPRg9GA0L3QuCDQu9C4INGB0YLQtT8iLCJjb3VsZE5vdENyZWF0ZVNoYXJlYWJsZUxpbmsiOiLQktGA0YrQt9C60LDRgtCwINC90LUg0LzQvtC20LUg0LTQsCDQsdGK0LTQtSDRgdGK0LfQtNCw0LTQtdC90LAuIiwiY291bGROb3RMb2FkSW52YWxpZEZpbGUiOiLQndC10LLQsNC70LjQtNC10L0g0YTQsNC50Lsg0L3QtSDQvNC+0LbQtSDQtNCwINGB0LUg0LfQsNGA0LXQtNC4IiwiaW1wb3J0QmFja2VuZEZhaWxlZCI6ItCY0LzQv9C+0YDRgtC40YDQsNC90LXRgtC+INC+0YIg0LHQtdC60LXQvdC0INC90LUg0LHQtdGI0LUg0YPRgdC/0LXRiNC90L4uIiwiY2Fubm90RXhwb3J0RW1wdHlDYW52YXMiOiLQndC1INC80L7QttC1INC00LAg0YHQtSDQtdC60YHQv9C+0YDRgtC40YDQsCDQv9GA0LDQt9C90L4g0L/Qu9Cw0YLQvdC+LiIsImNvdWxkTm90Q29weVRvQ2xpcGJvYXJkIjoi0J3QtdGD0YHQv9C10YjQvdC+INC60L7Qv9C40YDQsNC90LUg0LIg0LrQu9C40L/QsdC+0YDQtNCwLiDQntC/0LjRgtCw0LnRgtC1INC00LAg0LjQt9C/0L7Qu9C30LLQsNGC0LUg0LHRgNCw0YPQt9GK0YDQsCBDaHJvbWUuIiwiZGVjcnlwdEZhaWxlZCI6ItCU0LDQvdC90LjRgtC1INC90LUg0LzQvtC20LDRhdCwINC00LAg0YHQtSDQtNC10YjQuNGE0YDQuNGA0LDRgi4iLCJ1cGxvYWRlZFNlY3VybHkiOiLQmtCw0YfQstCw0L3QtdGC0L4g0LUg0LfQsNGJ0LjRgtC10L3QviDRgSDQutGA0LjQv9GC0LjRgNCw0L3QtSDQvtGCINC60YDQsNC5INC00L4g0LrRgNCw0LksINC60L7QtdGC0L4g0L7Qt9C90LDRh9Cw0LLQsCwg0YfQtSDRgdGK0YDQstGK0YDRitGCIEV4Y2FsaWRyYXcg0Lgg0YLRgNC10YLQuCDRgdGC0YDQsNC90Lgg0L3QtSDQvNC+0LPQsNGCINC00LAg0YfQtdGC0LDRgiDRgdGK0LTRitGA0LbQsNC90LjQtdGC0L4uIiwibG9hZFNjZW5lT3ZlcnJpZGVQcm9tcHQiOiIifSwidG9vbEJhciI6eyJzZWxlY3Rpb24iOiLQodC10LvQtdC60YbQuNGPIiwiZHJhdyI6IiIsInJlY3RhbmdsZSI6ItCf0YDQsNCy0L7RitCz0YrQu9C90LjQuiIsImRpYW1vbmQiOiLQlNC40LDQvNCw0L3RgiIsImVsbGlwc2UiOiLQldC70LjQv9GBIiwiYXJyb3ciOiLQodGC0YDQtdC70LrQsCIsImxpbmUiOiLQm9C40L3QuNGPIiwidGV4dCI6ItCi0LXQutGB0YIiLCJsaWJyYXJ5IjoiIiwibG9jayI6ItCf0L7QtNC00YrRgNC20LDQudGC0LUg0LjQt9Cx0YDQsNC90LjRjyDQuNC90YHRgtGA0YPQvNC10L3RgiDQsNC60YLQuNCy0LXQvSDRgdC70LXQtCDRgNC40YHRg9Cy0LDQvdC1In0sImhlYWRpbmdzIjp7ImNhbnZhc0FjdGlvbnMiOiLQlNC10LnRgdGC0LLQuNGPINC/0L4g0L/Qu9Cw0YLQvdC+0YLQviIsInNlbGVjdGVkU2hhcGVBY3Rpb25zIjoi0JjQt9Cx0YDQsNC90Lgg0LTQtdC50YHRgtCy0LjRjyIsInNoYXBlcyI6ItCk0LjQs9GD0YDQuCJ9LCJoaW50cyI6eyJsaW5lYXJFbGVtZW50Ijoi0JrQu9C40LrQvdC10YLQtSwg0LfQsCDQtNCwINGB0YLQsNGA0YLQuNGA0LDRgtC1INC90Y/QutC+0LvQutC+INGC0L7Rh9C60LgsINC/0LvRitC30L3QtdGC0LUg0LfQsCDQtdC00L3QsCDQu9C40L3QuNGPIiwiZnJlZURyYXciOiIiLCJsaW5lYXJFbGVtZW50TXVsdGkiOiLQmtC70LjQutC90LXRgtC1INCy0YrRgNGF0YMg0L/QvtGB0LvQtdC00L3QsNGC0LAg0YLQvtGH0LrQsCDQuNC70Lgg0L3QsNGC0LjRgdC90LXRgtC1IEVzY2FwZSDQuNC70LggRW50ZXIsINC30LAg0LTQsCDQt9Cw0LLRitGA0YjQuNGC0LUiLCJyZXNpemUiOiIiLCJyb3RhdGUiOiLQnNC+0LbQtdGC0LUg0LTQsCDQvtCz0YDQsNC90LjRh9C40YLQtSDRitCz0LvQuNGC0LUsINC60LDRgtC+INC00YrRgNC20LjRgtC1IFNISUZULCDQtNC+0LrQsNGC0L4g0YHQtSDQstGK0YDRgtC40YLQtSIsImxpbmVFZGl0b3JfaW5mbyI6IiIsImxpbmVFZGl0b3JfcG9pbnRTZWxlY3RlZCI6IiIsImxpbmVFZGl0b3Jfbm90aGluZ1NlbGVjdGVkIjoiIn0sImVycm9yU3BsYXNoIjp7ImhlYWRpbmdNYWluX3ByZSI6ItCh0YDQtdGJ0LAg0LPRgNC10YjQutCwLiDQntC/0LjRgtCw0LnRgtC1ICIsImhlYWRpbmdNYWluX2J1dHRvbiI6ItC/0YDQtdC30LDRgNC10LbQtNCw0L3QtSDQvdCwINGB0YLRgNCw0L3QuNGG0LDRgtCwLiIsImNsZWFyQ2FudmFzTWVzc2FnZSI6ItCQ0LrQviDQv9GA0LXQt9Cw0YDQtdC20LTQsNC90LXRgtC+INC90LUg0YDQsNCx0L7RgtC4LCDQvtC/0LjRgtCw0LnRgtC1ICIsImNsZWFyQ2FudmFzTWVzc2FnZV9idXR0b24iOiLQuNC30YfQuNGB0YLQstCw0L3QtSDQvdCwINC/0LvQsNGC0L3QvtGC0L4uIiwiY2xlYXJDYW52YXNDYXZlYXQiOiIg0KLQvtCy0LAg0YnQtSDQtNC+0LLQtdC00LUg0LTQviDQt9Cw0LPRg9Cx0LAg0L3QsCDRgNCw0LHQvtGC0LAgIiwidHJhY2tlZFRvU2VudHJ5X3ByZSI6ItCT0YDQtdGI0LrQsNGC0LAg0YEg0LjQtNC10L3RgtC40YTQuNC60LDRgtC+0YAgIiwidHJhY2tlZFRvU2VudHJ5X3Bvc3QiOiIg0LHQtdGI0LUg0L/RgNC+0YHQu9C10LTQtdC9INCyINC90LDRiNCw0YLQsCDRgdC40YHRgtC10LzQsC4iLCJvcGVuSXNzdWVNZXNzYWdlX3ByZSI6ItCR0Y/RhdC80LUg0LzQvdC+0LPQviDQv9GA0LXQtNC/0LDQt9C70LjQstC4INC00LAg0L3QtSDQstC60LvRjtGH0LjRgtC1INC40L3RhNC+0YDQvNCw0YbQuNGP0YLQsCDQt9CwINCy0LDRiNCw0YLQsCDRgdGG0LXQvdCwINC/0YDQuCDQs9GA0LXRiNC60LDRgtCwLiDQkNC60L4g0YHRhtC10L3QsNGC0LAg0LLQuCDQvdC1INC1INGH0LDRgdGC0L3QsCwg0LzQvtC70Y8sINC/0L7QvNC40YHQu9C10YLQtSDQt9CwINC/0L7RgdC70LXQtNCy0LDRidC4INC00LXQudGB0YLQstC40Y8g0L3QsCDQvdCw0YjQsNGC0LAgIiwib3Blbklzc3VlTWVzc2FnZV9idXR0b24iOiLRgtGA0LDQutC10YAg0LfQsCDQs9GA0LXRiNC60LguIiwib3Blbklzc3VlTWVzc2FnZV9wb3N0IjoiINCc0L7Qu9GPLCDQstC60LvRjtGH0LXRgtC1INC40L3RhNC+0YDQvNCw0YbQuNGPINC/0L4t0LTQvtC70YMsINC60LDRgtC+INGPINC60L7Qv9C40YDQsNGC0LUg0Lgg0LTQvtCx0LDQstC40YLQtSDQsiBHaXRIdWIuIiwic2NlbmVDb250ZW50Ijoi0KHRitC00YrRgNC20LDQvdC40LUg0L3QsCDRgdGG0LXQvdCw0YLQsDoifSwicm9vbURpYWxvZyI6eyJkZXNjX2ludHJvIjoi0JzQvtC20LXRgtC1INC00LAg0L/QvtC60LDQvdC40YLQtSDRhdC+0YDQsCDQvdCwINGC0LXQutGD0YnQsNGC0LAg0YHQuCDRgdGG0LXQvdCwINC00LAg0YHQuCDRgdGK0YLRgNGD0LTQvdC40YfQsNGCINGBINCy0LDRgS4iLCJkZXNjX3ByaXZhY3kiOiLQndC1INGB0LUg0L/RgNC40YLQtdGB0L3Rj9Cy0LDQudGC0LUsINGB0LXRgdC40Y/RgtCwINC40LfQv9C+0LvQt9Cy0LAg0LrRgNC40L/RgtC40YDQsNC90LUg0L7RgiDQutGA0LDQuSDQtNC+INC60YDQsNC5LCDRgtCw0LrQsCDRh9C1INC60LDQutCy0L7RgtC+INC90LDRgNC40YHRg9Cy0LDRgtC1INGJ0LUg0L7RgdGC0LDQvdC1INGH0LDRgdGC0L3Qvi4g0JTQvtGA0Lgg0L3QsNGI0LjRj9GCINGB0YrRgNCy0YrRgCDQvdGP0LzQsCDQtNCwINC80L7QttC1INC00LAg0LLQuNC00Lgg0LrQsNC60LLQviDQv9GA0LXQtNC70LDQs9Cw0YLQtS4iLCJidXR0b25fc3RhcnRTZXNzaW9uIjoi0KHRgtCw0YDRgtC40YDQsNC50YLQtSDRgdC10YHQuNGP0YLQsCIsImJ1dHRvbl9zdG9wU2Vzc2lvbiI6ItCh0YLQvtC/INC90LAg0YHQtdGB0LjRj9GC0LAiLCJkZXNjX2luUHJvZ3Jlc3NJbnRybyI6ItCh0LXRgdC40Y/RgtCwINC30LAg0YHRitGC0YDRg9C00L3QuNGH0LXRgdGC0LLQviDQvdCwINC20LjQstC+INC1INCyINGF0L7QtC4iLCJkZXNjX3BlcnNpc3RlbmNlV2FybmluZyI6IiIsImRlc2Nfc2hhcmVMaW5rIjoi0KHQv9C+0LTQtdC70LXRgtC1INGC0LDQt9C4INCy0YDRitC30LrQsCDRgSDQstGB0LXQutC4LCDRgSDQutC+0LPQvtGC0L4g0LjRgdC60LDRgtC1INC00LAg0YHQuCDRgdGK0YLRgNGD0LTQvdC40YfQuNGC0LU6IiwiZGVzY19leGl0U2Vzc2lvbiI6IiJ9LCJlcnJvckRpYWxvZyI6eyJ0aXRsZSI6ItCT0YDQtdGI0LrQsCJ9LCJzaG9ydGN1dHNEaWFsb2ciOnsidGl0bGUiOiLQmtC70LDQstC40YjQuCDQt9CwINCx0YrRgNC3INC00L7RgdGC0YrQvyIsInNoYXBlcyI6ItCk0LjQs9GD0YDQuCIsIm9yIjoi0LjQu9C4IiwiY2xpY2siOiLQutC70LjQuiIsImRyYWciOiLQv9C70YrQt9C90LXRgtC1IiwiY3VydmVkQXJyb3ciOiLQmNC30LLQuNGC0LAg0YHRgtGA0LXQu9C60LAiLCJjdXJ2ZWRMaW5lIjoi0JjQt9Cy0LjRgtCwINC70LjQvdC40Y8iLCJlZGl0b3IiOiLQoNC10LTQsNC60YLQvtGAIiwidmlldyI6ItCf0YDQtdCz0LvQtdC0IiwiYmxvZyI6ItCf0YDQvtGH0LXRgtC10YLQtSDQvdCw0YjQuNGPINCx0LvQvtCzIiwiaG93dG8iOiLQodC70LXQtNCy0LDQudGC0LUg0L3QsNGI0LjRgtC1INGA0YrQutC+0LLQvtC00YHRgtCy0LAiLCJnaXRodWIiOiLQndCw0LzQtdGA0LjRhdGC0LUg0L/RgNC+0LHQu9C10Lw/INCY0LfQv9GA0LDRgtC10YLQtSIsInRleHROZXdMaW5lIjoi0JTQvtCx0LDQstGP0L3QtSDQvdCwINC90L7QsiDRgNC10LQgKNGC0LXQutGB0YIpIiwidGV4dEZpbmlzaCI6ItCX0LDQstGK0YDRiNC10YLQtSDRgNC10LTQsNC60YLQuNGA0LDQvdC1ICjRgtC10LrRgdGCKSIsInpvb21Ub0ZpdCI6IiJ9LCJlbmNyeXB0ZWQiOnsidG9vbHRpcCI6IiJ9LCJjaGFydHMiOnsibm9OdW1lcmljQ29sdW1uIjoiIiwidG9vTWFueUNvbHVtbnMiOiIifX0nKX0sZnVuY3Rpb24oZSl7ZS5leHBvcnRzPUpTT04ucGFyc2UoJ3sibGFiZWxzIjp7InBhc3RlIjoiRW5nYW54YXIiLCJzZWxlY3RBbGwiOiJTZWxlY2Npb25hciB0b3QiLCJtdWx0aVNlbGVjdCI6IkFmZWdpciBlbGVtZW50IGEgbGEgc2VsZWNjacOzIiwibW92ZUNhbnZhcyI6Ik1vdXJlIGVsIGxsZW7DpyIsImNvcHkiOiJDb3BpYXIiLCJjb3B5QXNQbmciOiJDb3BpYXIgYWwgcG9ydGEtcmV0YWxscyBjb20gYSBQTkciLCJjb3B5QXNTdmciOiJDb3BpYXIgYWwgcG9ydGEtcmV0YWxscyBjb20gYSBTVkciLCJicmluZ0ZvcndhcmQiOiJQb3J0YXIgZW5kYXZhbnQiLCJzZW5kVG9CYWNrIjoiRW52aWFyIGVuZGFycmVyZSIsImJyaW5nVG9Gcm9udCI6IlBvcnRhciBhbCBjYXBkYXZhbnQiLCJzZW5kQmFja3dhcmQiOiJFbnZpYXIgYWwgZm9ucyIsImRlbGV0ZSI6IkVsaW1pbmFyIiwiY29weVN0eWxlcyI6IkNvcGlhciBlc3RpbHMiLCJwYXN0ZVN0eWxlcyI6IkVuZ2FueGFyIGVzdGlscyIsInN0cm9rZSI6IkNvbG9yIGRlbCB0cmHDpyIsImJhY2tncm91bmQiOiJDb2xvciBkZWwgZm9ucyIsImZpbGwiOiJFc3RpbCBkZWwgZm9ucyIsInN0cm9rZVdpZHRoIjoiQW1wbGFkYSBkZWwgdHJhw6ciLCJzdHJva2VTdHlsZSI6IkVzdGlsIGRlbCB0cmHDpyIsInN0cm9rZVN0eWxlX3NvbGlkIjoiU8OybGlkIiwic3Ryb2tlU3R5bGVfZGFzaGVkIjoiR3Vpb25zIiwic3Ryb2tlU3R5bGVfZG90dGVkIjoiUHVudHMiLCJzbG9wcGluZXNzIjoiRXN0aWwgZGVsIHRyYcOnIiwib3BhY2l0eSI6Ik9wYWNpdGF0IiwidGV4dEFsaWduIjoiQWxpbmVhY2nDsyBkZWwgdGV4dCIsImZvbnRTaXplIjoiTWlkYSBkZSBsbGV0cmEiLCJmb250RmFtaWx5IjoiVGlwdXMgZGUgbGxldHJhIiwib25seVNlbGVjdGVkIjoiTm9tw6lzIHNlbGVjY2lvbmF0cyIsIndpdGhCYWNrZ3JvdW5kIjoiQW1iIGZvbnMiLCJhZGRXYXRlcm1hcmsiOiJBZmVnaXIgXFwiRmV0IGFtYiBFeGNhbGlkcmF3XFwiIiwiaGFuZERyYXduIjoiRGlidWl4YXQgYSBtw6AiLCJub3JtYWwiOiJOb3JtYWwiLCJjb2RlIjoiQ29kaSIsInNtYWxsIjoiUGV0aXQiLCJtZWRpdW0iOiJNaXRqw6AiLCJsYXJnZSI6IkdyYW4iLCJ2ZXJ5TGFyZ2UiOiJNb2x0IGdyYW4iLCJzb2xpZCI6IlPDsmxpZCIsImhhY2h1cmUiOiJSYXRsbGV0ZXMiLCJjcm9zc0hhdGNoIjoiUmF0bGxldGVzIGNyZXVhZGVzIiwidGhpbiI6IkZpIiwiYm9sZCI6Ik5lZ3JldGEiLCJsZWZ0IjoiRXNxdWVycmEiLCJjZW50ZXIiOiJDZW50cmUiLCJyaWdodCI6IkRyZXRhIiwiZXh0cmFCb2xkIjoiRXh0cmEgbmVncmV0YSIsImFyY2hpdGVjdCI6IkFycXVpdGVjdGUiLCJhcnRpc3QiOiJBcnRpc3RhIiwiY2FydG9vbmlzdCI6IkRpYnVpeGFudCIsImZpbGVUaXRsZSI6IlTDrXRvbCBkZWwgZml0eGVyIiwiY29sb3JQaWNrZXIiOiJTZWxlY3RvciBkZSBjb2xvcnMiLCJjYW52YXNCYWNrZ3JvdW5kIjoiRm9ucyBkZSBsYSB0ZWxhIiwiZHJhd2luZ0NhbnZhcyI6IlRlbGEgZGUgZGlidWl4IiwibGF5ZXJzIjoiQ2FwZXMiLCJhY3Rpb25zIjoiQWNjaW9ucyIsImxhbmd1YWdlIjoiTGxlbmd1YSIsImNyZWF0ZVJvb20iOiJDb21wYXJ0aXIgdW5hIHNlc3Npw7MgZGUgY29swrdsYWJvcmFjacOzIGVuIGRpcmVjdGUiLCJkdXBsaWNhdGVTZWxlY3Rpb24iOiJEdXBsaWNhciIsInVudGl0bGVkIjoiU2Vuc2UgdMOtdG9sIiwibmFtZSI6Ik5vbSIsInlvdXJOYW1lIjoiRWwgdGV1IG5vbSIsIm1hZGVXaXRoRXhjYWxpZHJhdyI6IkZldCBhbWIgRXhjYWxpZHJhdyIsImdyb3VwIjoiQWdydXBhciBsYSBzZWxlY2Npw7MiLCJ1bmdyb3VwIjoiRGVzYWdydXBhciBsYSBzZWxlY2Npw7MiLCJjb2xsYWJvcmF0b3JzIjoiQ29swrdsYWJvcmFkb3JzIiwidG9nZ2xlR3JpZE1vZGUiOiJDb21tdXRhciBsw61uaWVzIGRlIGdyYWVsbGEiLCJhZGRUb0xpYnJhcnkiOiJBZmVnaXIgYSBsYSBiaWJsaW90ZWNhIiwicmVtb3ZlRnJvbUxpYnJhcnkiOiJFbGltaW5hciBkZSBsYSBiaWJsaW90ZWNhIiwibGlicmFyeUxvYWRpbmdNZXNzYWdlIjoiQ2FycmVnYW50IGxhIGJpYmxpb3RlY2EuLi4ifSwiYnV0dG9ucyI6eyJjbGVhclJlc2V0IjoiTmV0ZWphciBlbCBsbGVuw6ciLCJleHBvcnQiOiJFeHBvcnRhciIsImV4cG9ydFRvUG5nIjoiRXhwb3J0YXIgYSBQTkciLCJleHBvcnRUb1N2ZyI6IkV4cG9ydGFyIGEgU05HIiwiY29weVRvQ2xpcGJvYXJkIjoiQ29waWFyIGFsIHBvcnRhLXJldGFsbHMiLCJjb3B5UG5nVG9DbGlwYm9hcmQiOiJDb3BpYXIgUE5HIGFsIHBvcnRhLXJldGFsbHMiLCJzYXZlIjoiRGVzYXIiLCJzYXZlQXMiOiJEZXNhciBjb20iLCJsb2FkIjoiQ2FycmVnYXIiLCJnZXRTaGFyZWFibGVMaW5rIjoiT2J0ZW5pciBlbmxsYcOnIHBlciBjb21wYXJ0aXIiLCJjbG9zZSI6IlRhbmNhciIsInNlbGVjdExhbmd1YWdlIjoiVHJpYXIgaWRpb21hIiwic2Nyb2xsQmFja1RvQ29udGVudCI6IlRvcm5hciBhbCBjb250aW5ndXQiLCJ6b29tSW4iOiJBbXBsaWFyIiwiem9vbU91dCI6IlJlZHVpciIsInJlc2V0Wm9vbSI6IlJlc3RhYmxpciB6b29tIiwibWVudSI6Ik1lbsO6IiwiZG9uZSI6IkZldCIsImVkaXQiOiJFZGl0YXIiLCJ1bmRvIjoiRGVzZmVyIiwicmVkbyI6IlJlZmVyIiwicm9vbURpYWxvZyI6IkNvbWVuw6dhciBjb2zCt2xhYm9yYWNpw7MgZW4gZGlyZWN0ZSIsImNyZWF0ZU5ld1Jvb20iOiJDcmVhciBzYWxhIG5vdmEiLCJ0b2dnbGVGdWxsU2NyZWVuIjoiQ29tbXV0YXIgcGFudGFsbGEgY29tcGxldGEiLCJ0b2dnbGVaZW5Nb2RlIjoiQ29tbXV0YXIgbW9kbyB6ZW4iLCJleGl0WmVuTW9kZSI6IlNvcnRpciBkZSBtb2RvIHplbiJ9LCJhbGVydHMiOnsiY2xlYXJSZXNldCI6IlRvdCBlbCBsbGVuw6cgc1wnZXNib3JyYXLDoC4gRXN0w6BzIHNlZ3VyPyIsImNvdWxkTm90Q3JlYXRlU2hhcmVhYmxlTGluayI6Ik5vIHNcJ2hhIHBvZ3V0IGNyZWFyIHVuIGVubGxhw6cgcGVyIGNvbXBhcnRpci4iLCJjb3VsZE5vdExvYWRJbnZhbGlkRmlsZSI6Ik5vIHNcJ2hhIHBvZ3V0IGNhcnJlZ2FyIHVuIGZpdHhlciBubyB2w6BsaWQiLCJpbXBvcnRCYWNrZW5kRmFpbGVkIjoiSW1wb3J0YWNpw7MgZmFsbGlkYS4iLCJjYW5ub3RFeHBvcnRFbXB0eUNhbnZhcyI6Ik5vIGVzIHBvdCBleHBvcnRhciB1biBsbGVuw6cgYnVpdC4iLCJjb3VsZE5vdENvcHlUb0NsaXBib2FyZCI6Ik5vIHNcJ2hhIHBvZ3V0IGNvcGlhciBhbCBwb3J0YS1yZXRhbGxzLiBJbnRlbnRhciBhbWIgZWwgbmF2ZWdhZG9yIEdvb2dsZSBDaHJvbWUuIiwiZGVjcnlwdEZhaWxlZCI6Ik5vIHNcJ2hhIHBvZ3V0IGRlc2VuY3JpcHRhci4iLCJ1cGxvYWRlZFNlY3VybHkiOiJMYSBjw6BycmVnYSBzXCdoYSBhc3NlZ3VyYXQgYW1iIHhpZnJhdGdlIHB1bnRhIGEgcHVudGEsIGNvc2EgcXVlIHNpZ25pZmljYSBxdWUgZWwgc2Vydmlkb3IgRXhjYWxpZHJhdyBpIHRlcmNlcnMgbm8gcG9kZW4gbGxlZ2lyIGVsIGNvbnRpbmd1dC4iLCJsb2FkU2NlbmVPdmVycmlkZVByb21wdCI6IlNpIGNhcnJlZ2FzIGFxdWVzdCBkaWJ1aXggZXh0ZXJuLCBzdWJzdGl0dWlyw6EgZWwgcXVlIHRlbnMuIFZvbHMgY29udGludWFyPyJ9LCJ0b29sQmFyIjp7InNlbGVjdGlvbiI6IlNlbGVjY2nDsyIsImRyYXciOiJEaWJ1aXggbGxpdXJlIiwicmVjdGFuZ2xlIjoiUmVjdGFuZ2xlIiwiZGlhbW9uZCI6IlJvbWJlIiwiZWxsaXBzZSI6IkVswrdsaXBzZSIsImFycm93IjoiRmxldHhhIiwibGluZSI6IkzDrW5pYSIsInRleHQiOiJUZXh0IiwibGlicmFyeSI6IkJpYmxpb3RlY2EiLCJsb2NrIjoiTWFudGVuaXIgYWN0aXZhIGxcJ2VpbmEgc2VsZWNjaW9uYWRhIGRlc3Byw6hzIGRlIGRpYnVpeGFyIn0sImhlYWRpbmdzIjp7ImNhbnZhc0FjdGlvbnMiOiJBY2Npb25zIGRlbCBsbGVuw6ciLCJzZWxlY3RlZFNoYXBlQWN0aW9ucyI6IkFjY2lvbnMgcGVyIGEgbGVzIGZvcm1lcyBzZWxlY2Npb25hZGVzIiwic2hhcGVzIjoiRm9ybWVzIn0sImhpbnRzIjp7ImxpbmVhckVsZW1lbnQiOiJGZXIgY2xpYyBwZXIgZGlidWl4YXIgbcO6bHRpcGxlcyBwdW50czsgYXJyb3NzZWdhciBwZXIgdW5hIHNvbGEgbMOtbmVhIiwiZnJlZURyYXciOiJGZXIgY2xpYyBpIGFycm9zZWdhciwgZGVpeGFyIGFuYXIgYWwgcHVudCBmaW5hbCIsImxpbmVhckVsZW1lbnRNdWx0aSI6IkZlciBjbGljIGEgbFwndWx0aW0gcHVudCwgbyBwb2xzYXIgRXNjYXBlIG8gRW50ZXIgcGVyIGFjYWJhciIsInJlc2l6ZSI6IlBlciByZXN0cmluZ2lyIGxlcyBwcm9wb3JjaW9ucyBtZW50cmVzIGVzIGNhbnZpYSBsYSBtaWRhLCBtYW50ZW5pciBwcmVtdXQgZWwgbWFqw7pzY3VsIChTSElGVCk7IHBlciBjYW52aWFyIGxhIG1pZGEgZGVzIGRlbCBjZW50cmUsIG1hbnRlbmlyIHByZW11dCBBTFQiLCJyb3RhdGUiOiJQZXIgcmVzdHJpbmdpciBlbHMgYW5nbGVzIG1lbnRyZSBnaXJhLCBtYW50ZW5pciBwcmVtdXQgZWwgbWFqw7pzY3VsIChTSElGVCkiLCJsaW5lRWRpdG9yX2luZm8iOiJGZXMgZG9ibGUgY2xpYyBvIHByZW1pIEVudGVyIHBlciBlZGl0YXIgcHVudHMiLCJsaW5lRWRpdG9yX3BvaW50U2VsZWN0ZWQiOiJQcmVtaSBTdXByaW1pciBwZXIgZWxpbWluYXIgZWwgcHVudCwgQ3RybE9yQ21kK0QgcGVyIGR1cGxpY2FyLWxvLCBvIGFycm9zZWdhXCdsIHBlciBtb3VyZVwnbCIsImxpbmVFZGl0b3Jfbm90aGluZ1NlbGVjdGVkIjoiU2VsZWNjaW9uYSB1biBwdW50IHBlciBtb3VyZSBvIGVsaW1pbmFyLCBvIG1hbnTDqSBwcmVtdXQgQWx0IGkgZmVzIGNsaWMgcGVyIGFmZWdpciBwdW50cyBub3VzIn0sImVycm9yU3BsYXNoIjp7ImhlYWRpbmdNYWluX3ByZSI6IlNcJ2hhIHByb2R1w690IHVuIGVycm9yLiBJbnRlbnRhciAiLCJoZWFkaW5nTWFpbl9idXR0b24iOiJyZWNhcnJlZ2FyIGxhIHDDoGdpbmEuIiwiY2xlYXJDYW52YXNNZXNzYWdlIjoiU2kgbGEgcmVjYXJyZWdhIG5vIGZ1bmNpb25hLCBpbnRlbnRhciAiLCJjbGVhckNhbnZhc01lc3NhZ2VfYnV0dG9uIjoiZXNib3JyYXIgZWwgbGxlbsOnLiIsImNsZWFyQ2FudmFzQ2F2ZWF0IjoiIEFpeMOyIHJlc3VsdGFyw6AgZW4gcMOocmR1YSBkZSBmZWluYSAiLCJ0cmFja2VkVG9TZW50cnlfcHJlIjoiTFwnZXJyb3IgYW1iIGxcJ2lkZW50aWZpY2Fkb3IgIiwidHJhY2tlZFRvU2VudHJ5X3Bvc3QiOiIgc1wnaGEgcmFzdHJlamF0IGVuIGVsIG5vc3RyZSBzaXN0ZW1hLiIsIm9wZW5Jc3N1ZU1lc3NhZ2VfcHJlIjoiRXN0w6B2ZW0gbW9sdCBhbWIgY29tcHRlIGRlIG5vIGluY2xvdXJlIGxhIHRldmEgaW5mb3JtYWNpw7MgZGUgbFwnZXNjZW5hIGVuIGxcJ2Vycm9yLiBTaSBsYSB0ZXZhIGVzY2VuYSBubyDDqXMgcHJpdmFkYSwgcG90cyBmZXIgZWwgc2VndWltZW50IGFsIG5vc3RyZSAiLCJvcGVuSXNzdWVNZXNzYWdlX2J1dHRvbiI6InJhc3RyZWphZG9yIGRcJ2Vycm9ycy4iLCJvcGVuSXNzdWVNZXNzYWdlX3Bvc3QiOiIgU2kgdXMgcGxhdSBpbmNsb3VyZSBsYSBpbmZvcm1hY2nDsyBhIGNvbnRpbnVhY2nDsyBjb3BpYW50IGkgZW5nYW54YW50IGEgR2l0SHViIElzc3Vlcy4iLCJzY2VuZUNvbnRlbnQiOiJDb250aW5ndXQgZGUgbFwnZXNjZW5hOiJ9LCJyb29tRGlhbG9nIjp7ImRlc2NfaW50cm8iOiJQb3RzIGNvbnZpZGFyIHBlcnNvbmVzIGEgbGEgdGV2YSBlc2NlbmEgYWN0dWFsIGEgY29swrdsYWJvcmFyIGFtYiB0dS4iLCJkZXNjX3ByaXZhY3kiOiJObyBldCBwcmVvY3VwaXMsIGxhIHNlc3Npw7MgdXRpbGl0emEgZWwgeGlmcmF0Z2UgZGUgcHVudGEgYSBwdW50YSwgZGUgbWFuZXJhIHF1ZSBxdWFsc2V2b2wgY29zYSBxdWUgZGlidWl4aXMgcXVlZGFyw6AgcHJpdmFkYS4gTmkgdGFuIHNvbHMgZWwgbm9zdHJlIHNlcnZpZG9yIHBvZHLDoCB2ZXVyZSBlbCBxdWUgZmFzLiIsImJ1dHRvbl9zdGFydFNlc3Npb24iOiJJbmljaWFyIHNlc3Npw7MiLCJidXR0b25fc3RvcFNlc3Npb24iOiJBdHVyYXIgc2Vzc2nDsyIsImRlc2NfaW5Qcm9ncmVzc0ludHJvIjoiTGEgc2Vzc2nDsyBkZSBjb2zCt2xhYm9yYWNpw7MgZW4gZGlyZWN0ZSBlc3TDoCBlbiBtYXJ4YS4iLCJkZXNjX3BlcnNpc3RlbmNlV2FybmluZyI6IlRpbmd1ZXMgZW4gY29tcHRlIHF1ZSBsZXMgZGFkZXMgZGUgbFwnZXNjZW5hIGVzIGNvbXBhcnRlaXhlbiBlbnRyZSBjb2zCt2xhYm9yYWRvcnMgZGUgbWFuZXJhIFAyUCBpIG5vIGVzIGRlc2VuIGFsIG5vc3RyZSBzZXJ2aWRvci4gQWl4w60sIHNpIHRvdHMgdXMgZGVzY29ubmVjdGV1LCBwZXJkcmV1IGxlcyBkYWRlcywgdHJldCBxdWUgZWxzIGV4cG9ydGV1IGEgdW4gZml0eGVyIG8gYSB1biBlbmxsYcOnIHBlciBhIGNvbXBhcnRpci4iLCJkZXNjX3NoYXJlTGluayI6IkNvbXBhcnRlaXggYXF1ZXN0IGVubGxhw6cgYW1iIHF1YWxzZXZvbCBwZXJzb25hIGFtYiBxdWkgdnVsZ3VpcyBjb2zCt2xhYm9yYXI6IiwiZGVzY19leGl0U2Vzc2lvbiI6IlNpIGF0dXJhcyBsYSBzZXNzacOzLCBldCBkZXNjb25lY3RhcsOhcyBkZSBsYSBzYWxhLCBwZXLDsiBwb2Ryw6FzIGNvbnRpbnVhciB0cmViYWxsYW50IGFtYiBlbCBkaWJ1aXggbG9jYWxtZW50LiBUaW5ndWVzIGVuIGNvbXB0ZSBxdWUgYWl4w7Igbm8gYWZlY3RhcsOgIGEgYWx0cmVzIHBlcnNvbmVzLCBpIGVuY2FyYSBwb2RyYW4gY29swrdsYWJvcmFyIGVuIGxhIHNldmEgdmVyc2nDsy4ifSwiZXJyb3JEaWFsb2ciOnsidGl0bGUiOiJFcnJvciJ9LCJzaG9ydGN1dHNEaWFsb2ciOnsidGl0bGUiOiJEcmVjZXJlcyBkZSB0ZWNsYXQiLCJzaGFwZXMiOiJGb3JtZXMiLCJvciI6Im8iLCJjbGljayI6ImZlciBjbGljIiwiZHJhZyI6ImFycm9zZWdhciIsImN1cnZlZEFycm93IjoiRmxldHhhIGN1cnZhIiwiY3VydmVkTGluZSI6IkzDrW5lYSBjdXJ2YSIsImVkaXRvciI6IkVkaXRvciIsInZpZXciOiJWaXN0YSIsImJsb2ciOiJMbGVnaXIgZWwgbm9zdHJlIGJsb2ciLCJob3d0byI6IlNlZ3VpciBlbHMgbm9zdHJlcyBndWllcyIsImdpdGh1YiI6IkhhcyB0cm9iYXQgdW4gcHJvYmxlbWE/IEVudmlhci1obyIsInRleHROZXdMaW5lIjoiQWZlZ2lyIGzDrW5lYSBub3ZhICh0ZXh0KSIsInRleHRGaW5pc2giOiJBY2FiYXIgZFwnZWRpdGFyICh0ZXh0KSIsInpvb21Ub0ZpdCI6Ilpvb20gcGVyIHZldXJlIHRvdHMgZWxzIGVsZW1lbnRzIn0sImVuY3J5cHRlZCI6eyJ0b29sdGlwIjoiRWxzIHZvc3RyZXMgZGlidWl4b3MgZXN0YW4geGlmcmF0cyBkZSBwdW50YSBhIHB1bnRhIGRlIG1hbmVyYSBxdWUgZWxzIHNlcnZpZG9ycyBk4oCZRXhjYWxpZHJhdyBubyBlbHMgdmV1cmFuIG1haS4ifSwiY2hhcnRzIjp7Im5vTnVtZXJpY0NvbHVtbiI6IkhhcyBlbmdhbnhhdCB1biBmdWxsIGRlIGPDoGxjdWwgc2Vuc2UgY29sdW1uYSBudW3DqHJpY2EuIiwidG9vTWFueUNvbHVtbnMiOiJIYXMgZW5nYW54YXQgdW4gZnVsbCBkZSBjw6BsY3VsIGFtYiBtw6lzIGRlIGR1ZXMgY29sdW1uZXMuIn19Jyl9LGZ1bmN0aW9uKGUpe2UuZXhwb3J0cz1KU09OLnBhcnNlKCd7ImxhYmVscyI6eyJwYXN0ZSI6IkVpbmbDvGdlbiIsInNlbGVjdEFsbCI6IkFsbGUgYXVzd8OkaGxlbiIsIm11bHRpU2VsZWN0IjoiRWxlbWVudCB6dXIgQXVzd2FobCBoaW56dWbDvGdlbiIsIm1vdmVDYW52YXMiOiJMZWlud2FuZCB2ZXJzY2hpZWJlbiIsImNvcHkiOiJLb3BpZXJlbiIsImNvcHlBc1BuZyI6IkluIFp3aXNjaGVuYWJsYWdlIGtvcGllcmVuIChQTkcpIiwiY29weUFzU3ZnIjoiSW4gWndpc2NoZW5hYmxhZ2Uga29waWVyZW4gKFNWRykiLCJicmluZ0ZvcndhcmQiOiJOYWNoIHZvcm5lIiwic2VuZFRvQmFjayI6IkluIGRlbiBIaW50ZXJncnVuZCIsImJyaW5nVG9Gcm9udCI6IkluIGRlbiBWb3JkZXJncnVuZCIsInNlbmRCYWNrd2FyZCI6Ik5hY2ggaGludGVuIiwiZGVsZXRlIjoiTMO2c2NoZW4iLCJjb3B5U3R5bGVzIjoiRm9ybWF0aWVydW5nIGtvcGllcmVuIiwicGFzdGVTdHlsZXMiOiJGb3JtYXRpZXJ1bmcgw7xiZXJuZWhtZW4iLCJzdHJva2UiOiJTdHJpY2giLCJiYWNrZ3JvdW5kIjoiSGludGVyZ3J1bmQiLCJmaWxsIjoiRsO8bGx1bmciLCJzdHJva2VXaWR0aCI6IlN0cmljaHN0w6Rya2UiLCJzdHJva2VTdHlsZSI6IktvbnR1cnN0aWwiLCJzdHJva2VTdHlsZV9zb2xpZCI6IkR1cmNoZ2V6b2dlbiIsInN0cm9rZVN0eWxlX2Rhc2hlZCI6Ikdlc3RyaWNoZWx0Iiwic3Ryb2tlU3R5bGVfZG90dGVkIjoiR2VwdW5rdGV0Iiwic2xvcHBpbmVzcyI6IlNhdWJlcmtlaXQiLCJvcGFjaXR5IjoiRGVja2tyYWZ0IiwidGV4dEFsaWduIjoiVGV4dGF1c3JpY2h0dW5nIiwiZm9udFNpemUiOiJTY2hyaWZ0Z3LDtsOfZSIsImZvbnRGYW1pbHkiOiJTY2hyaWZ0ZmFtaWxpZSIsIm9ubHlTZWxlY3RlZCI6Ik51ciBhdXNnZXfDpGhsdGUiLCJ3aXRoQmFja2dyb3VuZCI6Ik1pdCBIaW50ZXJncnVuZCIsImFkZFdhdGVybWFyayI6IlxcIk1hZGUgd2l0aCBFeGNhbGlkcmF3XFwiIGhpbnp1ZsO8Z2VuIiwiaGFuZERyYXduIjoiSGFuZGdlemVpY2huZXQiLCJub3JtYWwiOiJOb3JtYWwiLCJjb2RlIjoiQ29kZSIsInNtYWxsIjoiS2xlaW4iLCJtZWRpdW0iOiJNaXR0ZWwiLCJsYXJnZSI6Ikdyb8OfIiwidmVyeUxhcmdlIjoiU2VociBncm/DnyIsInNvbGlkIjoiRGVja2VuZCIsImhhY2h1cmUiOiJTY2hyYWZmaWVydCIsImNyb3NzSGF0Y2giOiJLcmV1enNjaHJhZmZpZXJ0IiwidGhpbiI6IkTDvG5uIiwiYm9sZCI6IkZldHQiLCJsZWZ0IjoiTGlua3MiLCJjZW50ZXIiOiJaZW50cmllcnQiLCJyaWdodCI6IlJlY2h0cyIsImV4dHJhQm9sZCI6IkV4dHJhIEZldHQiLCJhcmNoaXRlY3QiOiJBcmNoaXRla3QiLCJhcnRpc3QiOiJLw7xuc3RsZXIiLCJjYXJ0b29uaXN0IjoiS2FyaWthdHVyaXN0IiwiZmlsZVRpdGxlIjoiRGF0ZWluYW1lIiwiY29sb3JQaWNrZXIiOiJGYXJiYXVzd8OkaGxlciIsImNhbnZhc0JhY2tncm91bmQiOiJaZWljaGVuZmzDpGNoZW5oaW50ZXJncnVuZCIsImRyYXdpbmdDYW52YXMiOiJMZWlud2FuZCIsImxheWVycyI6IkViZW5lbiIsImFjdGlvbnMiOiJBa3Rpb25lbiIsImxhbmd1YWdlIjoiU3ByYWNoZSIsImNyZWF0ZVJvb20iOiJMaXZlLUtvbGxhYm9yYXRpb25zc2l0enVuZyB0ZWlsZW4iLCJkdXBsaWNhdGVTZWxlY3Rpb24iOiJEdXBsaXppZXJlbiIsInVudGl0bGVkIjoiVW5iZW5hbm50IiwibmFtZSI6Ik5hbWUiLCJ5b3VyTmFtZSI6IkRlaW4gTmFtZSIsIm1hZGVXaXRoRXhjYWxpZHJhdyI6Ik1hZGUgd2l0aCBFeGNhbGlkcmF3IiwiZ3JvdXAiOiJBdXN3YWhsIGdydXBwaWVyZW4iLCJ1bmdyb3VwIjoiR3J1cHBpZXJ1bmcgYXVmaGViZW4iLCJjb2xsYWJvcmF0b3JzIjoiTWl0YXJiZWl0ZW5kZSIsInRvZ2dsZUdyaWRNb2RlIjoiR2l0dGVybGluaWVuIGVpbi0vYXVzc2NoYWx0ZW4iLCJhZGRUb0xpYnJhcnkiOiJadXIgQmlibGlvdGhlayBoaW56dWbDvGdlbiIsInJlbW92ZUZyb21MaWJyYXJ5IjoiQXVzIEJpYmxpb3RoZWsgZW50ZmVybmVuIiwibGlicmFyeUxvYWRpbmdNZXNzYWdlIjoiTGFkZSBCaWJsaW90aGVrLi4uIn0sImJ1dHRvbnMiOnsiY2xlYXJSZXNldCI6IlplaWNoZW5mbMOkY2hlIGzDtnNjaGVuICYgSGludGVyZ3J1bmRmYXJiZSB6dXLDvGNrc2V0emVuIiwiZXhwb3J0IjoiRXhwb3J0aWVyZW4iLCJleHBvcnRUb1BuZyI6IkFscyBQTkcgZXhwb3J0aWVyZW4iLCJleHBvcnRUb1N2ZyI6IkFscyBTVkcgZXhwb3J0aWVyZW4iLCJjb3B5VG9DbGlwYm9hcmQiOiJJbiBad2lzY2hlbmFibGFnZSBrb3BpZXJlbiIsImNvcHlQbmdUb0NsaXBib2FyZCI6IlBORyBpbiBkaWUgWndpc2NoZW5hYmxhZ2Uga29waWVyZW4iLCJzYXZlIjoiU3BlaWNoZXJuIiwic2F2ZUFzIjoiU3BlaWNoZXJuIHVudGVyIiwibG9hZCI6IkxhZGVuIiwiZ2V0U2hhcmVhYmxlTGluayI6IlRlaWxiYXJlbiBMaW5rIGVyaGFsdGVuIiwiY2xvc2UiOiJTY2hsaWXDn2VuIiwic2VsZWN0TGFuZ3VhZ2UiOiJTcHJhY2hlIGF1c3fDpGhsZW4iLCJzY3JvbGxCYWNrVG9Db250ZW50IjoiWnVyw7xjayB6dW0gSW5oYWx0Iiwiem9vbUluIjoiVmVyZ3LDtsOfZXJuIiwiem9vbU91dCI6IlZlcmtsZWluZXJuIiwicmVzZXRab29tIjoiWm9vbSB6dXLDvGNrc2V0emVuIiwibWVudSI6Ik1lbsO8IiwiZG9uZSI6IkZlcnRpZyIsImVkaXQiOiJCZWFyYmVpdGVuIiwidW5kbyI6IlLDvGNrZ8OkbmdpZyBtYWNoZW4iLCJyZWRvIjoiV2llZGVyaG9sZW4iLCJyb29tRGlhbG9nIjoiTGl2ZS1Lb2xsYWJvcmF0aW9uc3NpdHp1bmcgc3RhcnRlbiIsImNyZWF0ZU5ld1Jvb20iOiJOZXVlbiBSYXVtIGVyc3RlbGxlbiIsInRvZ2dsZUZ1bGxTY3JlZW4iOiJWb2xsYmlsZCB1bXNjaGFsdGVuIiwidG9nZ2xlWmVuTW9kZSI6Ilplbi1Nb2R1cyB1bXNjaGFsdGVuIiwiZXhpdFplbk1vZGUiOiJaZW4tTW9kdXMgdmVybGFzc2VuIn0sImFsZXJ0cyI6eyJjbGVhclJlc2V0IjoiRGllcyB3aXJkIGRpZSBnYW56ZSBaZWljaGVuZmzDpGNoZSBsw7ZzY2hlbi4gQmlzdCBkdSBkaXIgc2ljaGVyPyIsImNvdWxkTm90Q3JlYXRlU2hhcmVhYmxlTGluayI6Iktvbm50ZSBrZWluZW4gdGVpbGJhcmVuIExpbmsgZXJzdGVsbGVuLiIsImNvdWxkTm90TG9hZEludmFsaWRGaWxlIjoiVW5nw7xsdGlnZSBEYXRlaSBrb25udGUgbmljaHQgZ2VsYWRlbiB3ZXJkZW4iLCJpbXBvcnRCYWNrZW5kRmFpbGVkIjoiSW1wb3J0IHZvbSBTZXJ2ZXIgaXN0IGZlaGxnZXNjaGxhZ2VuLiIsImNhbm5vdEV4cG9ydEVtcHR5Q2FudmFzIjoiTGVlcmUgWmVpY2hlbmZsw6RjaGUga2FubiBuaWNodCBleHBvcnRpZXJ0IHdlcmRlbi4iLCJjb3VsZE5vdENvcHlUb0NsaXBib2FyZCI6Iktvbm50ZSBuaWNodCBpbiBkaWUgWndpc2NoZW5hYmxhZ2Uga29waWVyZW4uIFZlcnN1Y2ggZXMgbWl0IGRlbSBDaHJvbWUgQnJvd3Nlci4iLCJkZWNyeXB0RmFpbGVkIjoiRGF0ZW4ga29ubnRlbiBuaWNodCBlbnRzY2hsw7xzc2VsdCB3ZXJkZW4uIiwidXBsb2FkZWRTZWN1cmx5IjoiRGVyIFVwbG9hZCB3dXJkZSBtaXQgRW5kZS16dS1FbmRlLVZlcnNjaGzDvHNzZWx1bmcgZ2VzcGVpY2hlcnQuIFdlZGVyIEV4Y2FsaWRyYXcgbm9jaCBEcml0dGUga8O2bm5lbiBkZW4gSW5oYWx0IGVpbnNlaGVuLiIsImxvYWRTY2VuZU92ZXJyaWRlUHJvbXB0IjoiRGFzIExhZGVuIGRlciBleHRlcm5lbiBaZWljaG51bmcgZXJzZXR6dCBkZW4gdm9yaGFuZGVuZW4gSW5oYWx0LiBNw7ZjaHRlc3QgRHUgZm9ydGZhaHJlbj8ifSwidG9vbEJhciI6eyJzZWxlY3Rpb24iOiJBdXN3YWhsIiwiZHJhdyI6IkZyZWllcyBaZWljaG5lbiIsInJlY3RhbmdsZSI6IlJlY2h0ZWNrIiwiZGlhbW9uZCI6IlJhdXRlIiwiZWxsaXBzZSI6IkVsbGlwc2UiLCJhcnJvdyI6IlBmZWlsIiwibGluZSI6IkxpbmllIiwidGV4dCI6IlRleHQiLCJsaWJyYXJ5IjoiQmlibGlvdGhlayIsImxvY2siOiJBdXNnZXfDpGhsdGVzIFdlcmt6ZXVnIG5hY2ggWmVpY2huZW4gYWt0aXYgbGFzc2VuIn0sImhlYWRpbmdzIjp7ImNhbnZhc0FjdGlvbnMiOiJBa3Rpb25lbiBmw7xyIFplaWNoZW5mbMOkY2hlIiwic2VsZWN0ZWRTaGFwZUFjdGlvbnMiOiJBa3Rpb25lbiBmw7xyIEF1c3dhaGwiLCJzaGFwZXMiOiJGb3JtZW4ifSwiaGludHMiOnsibGluZWFyRWxlbWVudCI6IktsaWNrZW4gZsO8ciBMaW5pZSBtaXQgbWVocmVyZW4gUHVua3RlbiwgWmllaGVuIGbDvHIgZWluemVsbmUgTGluaWUiLCJmcmVlRHJhdyI6IktsaWNrZSB1bmQgemllaGUuIExhc3MgbG9zLCB3ZW5uIGR1IGZlcnRpZyBiaXN0IiwibGluZWFyRWxlbWVudE11bHRpIjoiWnVtIEJlZW5kZW4gYXVmIGRlbiBsZXR6dGVuIFB1bmt0IGtsaWNrZW4gb2RlciBFc2NhcGUgb2RlciBFaW5nYWJlIGRyw7xja2VuIiwicmVzaXplIjoiRHUga2FubnN0IGRpZSBQcm9wb3J0aW9uZW4gZWluc2NocsOkbmtlbiwgaW5kZW0gZHUgU0hJRlQgd8OkaHJlbmQgZGVyIEdyw7bDn2Vuw6RuZGVydW5nIGdlZHLDvGNrdCBow6RsdHN0LiBIYWx0ZSBBTFQgZ2VkcsO8Y2t0LCB1bSBkaWUgR3LDtsOfZSB2b20gWmVudHJ1bSBhdXMgenUgw6RuZGVybiIsInJvdGF0ZSI6IkR1IGthbm5zdCBXaW5rZWwgZWluc2NocsOkbmtlbiwgaW5kZW0gZHUgU0hJRlQgd8OkaHJlbmQgZGVyIERyZWh1bmcgZ2VkcsO8Y2t0IGjDpGx0c3QiLCJsaW5lRWRpdG9yX2luZm8iOiJEb3BwZWxrbGlja2VuIG9kZXIgRWluZ2FiZXRhc3RlIGRyw7xja2VuLCB1bSBQdW5rdGUgenUgYmVhcmJlaXRlbiIsImxpbmVFZGl0b3JfcG9pbnRTZWxlY3RlZCI6IkRyw7xja2UgTMO2c2NoZW4sIHVtIFB1bmt0IHp1IGVudGZlcm5lbiwgU3RyZytEIG9kZXIgQ21kK0QgenVtIER1cGxpemllcmVuIG9kZXIgemllaGUgenVtIFZlcnNjaGllYmVuIiwibGluZUVkaXRvcl9ub3RoaW5nU2VsZWN0ZWQiOiJXw6RobGUgZWluZW4gUHVua3QgenVtIFZlcnNjaGllYmVuIG9kZXIgTMO2c2NoZW4gb2RlciBoYWx0ZSBkaWUgQWx0LVRhc3RlIGdlZHLDvGNrdCB1bmQga2xpY2tlLCB1bSBuZXVlIFB1bmt0ZSBoaW56dXp1ZsO8Z2VuIn0sImVycm9yU3BsYXNoIjp7ImhlYWRpbmdNYWluX3ByZSI6IkVzIGlzdCBlaW4gRmVobGVyIGF1ZmdldHJldGVuLiBWZXJzdWNoZSAiLCJoZWFkaW5nTWFpbl9idXR0b24iOiJkaWUgU2VpdGUgbmV1IHp1IGxhZGVuLiIsImNsZWFyQ2FudmFzTWVzc2FnZSI6Ildlbm4gZGFzIE5ldWxhZGVuIG5pY2h0IGZ1bmt0aW9uaWVydCwgdmVyc3VjaGUgIiwiY2xlYXJDYW52YXNNZXNzYWdlX2J1dHRvbiI6ImRpZSBaZWljaGVuZmzDpGNoZSB6dSBsw7ZzY2hlbi4iLCJjbGVhckNhbnZhc0NhdmVhdCI6IiBEaWVzIHdpcmQgenVtIFZlcmx1c3Qgdm9uIERhdGVuIGbDvGhyZW4gIiwidHJhY2tlZFRvU2VudHJ5X3ByZSI6IkRlciBGZWhsZXIgbWl0IGRlciBLZW5udW5nICIsInRyYWNrZWRUb1NlbnRyeV9wb3N0IjoiIHd1cmRlIGluIHVuc2VyZW0gU3lzdGVtIHJlZ2lzdHJpZXJ0LiIsIm9wZW5Jc3N1ZU1lc3NhZ2VfcHJlIjoiV2lyIHdhcmVuIHNlaHIgdm9yc2ljaHRpZyB1bmQgaGFiZW4gZGVpbmUgWmVpY2hudW5nc2luZm9ybWF0aW9uZW4gbmljaHQgaW4gZGllIEZlaGxlcmluZm9ybWF0aW9uZW4gYXVmZ2Vub21tZW4uIFdlbm4gZGVpbmUgWmVpY2hudW5nIG5pY2h0IHByaXZhdCBpc3QsIHVudGVyc3TDvHR6ZSB1bnMgYml0dGUgw7xiZXIgdW5zZXJlbiAiLCJvcGVuSXNzdWVNZXNzYWdlX2J1dHRvbiI6IkJ1Zy1UcmFja2VyLiIsIm9wZW5Jc3N1ZU1lc3NhZ2VfcG9zdCI6IiBCaXR0ZSB0ZWlsZSBkaWUgdW50ZW4gc3RlaGVuZGVuIEluZm9ybWF0aW9uZW4gbWl0IHVucyBpbSBHaXRIdWIgSXNzdWUgKEtvcGllcmVuIHVuZCBFaW5mw7xnZW4pLiIsInNjZW5lQ29udGVudCI6IlplaWNobnVuZ3NpbmhhbHQ6In0sInJvb21EaWFsb2ciOnsiZGVzY19pbnRybyI6IkR1IGthbm5zdCBMZXV0ZSB6dSBkZWluZXIgYWt0dWVsbGVuIFplaWNobnVuZyBlaW5sYWRlbiB1bSBtaXQgaWhuZW4genVzYW1tZW56dWFyYmVpdGVuLiIsImRlc2NfcHJpdmFjeSI6IlNlaSBiZXJ1aGlndCwgZGEgZGllIFNpdHp1bmcgZWluZSBFbmRlLXp1LUVuZGUtVmVyc2NobMO8c3NlbHVuZyBudXR6dC4gQWxsZXMgdm9uIGRpciBnZXplaWNobmV0ZSwgcHJpdmF0IGJsZWlidC4gQXVjaCB1bnNlcmUgU2VydmVyIHNlaGVuIG5pY2h0LCB3YXMgZHUgZGlyIGVpbmZhbGxlbiBsw6Rzc3QuIiwiYnV0dG9uX3N0YXJ0U2Vzc2lvbiI6IlNpdHp1bmcgc3RhcnRlbiIsImJ1dHRvbl9zdG9wU2Vzc2lvbiI6IlNpdHp1bmcgYmVlbmRlbiIsImRlc2NfaW5Qcm9ncmVzc0ludHJvIjoiRGllIExpdmUtU2l0enVuZyB3aXJkIG51biBhdXNnZWbDvGhydC4iLCJkZXNjX3BlcnNpc3RlbmNlV2FybmluZyI6IkJlYWNodGUsIGRhc3MgZGllIFplaWNobnVuZ3NkYXRlbiBiZWkgZGVyIFp1c2FtbWVuYXJiZWl0IMO8YmVyIFAyUCBnZXRlaWx0IHVuZCBuaWNodCBhdWYgdW5zZXJlbSBTZXJ2ZXIgZ2VzcGVpY2hlcnQgd2VyZGVuLiBXZW5uIGlociBhbGxlIGRpZSBWZXJiaW5kdW5nIHRyZW5udCwgZ2VoZW4gZXVyZSBEYXRlbiB2ZXJsb3JlbiwgZXMgc2VpIGRlbm4sIGlociBleHBvcnRpZXJ0IHNpZSBpbiBlaW5lIERhdGVpIG9kZXIgZWluZW4gZ2VtZWluc2FtIG51dHpiYXJlbiBMaW5rLiIsImRlc2Nfc2hhcmVMaW5rIjoiVGVpbGUgZGllc2VuIExpbmsgbWl0IGFsbGVuLCBtaXQgZGVuZW4gZHUgenVzYW1tZW5hcmJlaXRlbiBtw7ZjaHRlc3Q6IiwiZGVzY19leGl0U2Vzc2lvbiI6Ildlbm4gZHUgZGllIFNpdHp1bmcgYmVlbmRlc3QsIHdpcmQgZGVpbmUgVmVyYmluZHVuZyB6dW0gUmF1bSBnZXRyZW5udC4gRHUga2FubnN0IGplZG9jaCBsb2thbCB3ZWl0ZXIgYW4gZGVyIFplaWNobnVuZyBhcmJlaXRlbi4gQmVhY2h0ZSwgZGFzcyBkaWVzIGtlaW5lIEF1c3dpcmt1bmdlbiBhdWYgYW5kZXJlIGhhdCB1bmQgZGllc2Ugd2VpdGVyaGluIGdlbWVpbnNhbSBhbiBpaHJlciBWZXJzaW9uIGFyYmVpdGVuIGvDtm5uZW4uIn0sImVycm9yRGlhbG9nIjp7InRpdGxlIjoiRmVobGVyIn0sInNob3J0Y3V0c0RpYWxvZyI6eyJ0aXRsZSI6IlRhc3RhdHVya8O8cnplbCIsInNoYXBlcyI6IkZvcm1lbiIsIm9yIjoib2RlciIsImNsaWNrIjoia2xpY2tlbiIsImRyYWciOiJ6aWVoZW4iLCJjdXJ2ZWRBcnJvdyI6IkdlYm9nZW5lciBQZmVpbCIsImN1cnZlZExpbmUiOiJHZWJvZ2VuZSBMaW5pZSIsImVkaXRvciI6IkVkaXRvciIsInZpZXciOiJBbnNpY2h0IiwiYmxvZyI6IlVuc2VyZW4gQmxvZyBsZXNlbiIsImhvd3RvIjoiRm9sZ2UgdW5zZXJlbiBBbmxlaXR1bmdlbiIsImdpdGh1YiI6IkVpbiBQcm9ibGVtIGdlZnVuZGVuPyBJbmZvcm1pZXJlIHVucyIsInRleHROZXdMaW5lIjoiTmV1ZSBaZWlsZSBoaW56dWbDvGdlbiAoVGV4dCkiLCJ0ZXh0RmluaXNoIjoiQmVhcmJlaXRlbiBiZWVuZGVuIChUZXh0KSIsInpvb21Ub0ZpdCI6Ilpvb21lbiB1bSBhbGxlIEVsZW1lbnRlIGVpbnp1cGFzc2VuIn0sImVuY3J5cHRlZCI6eyJ0b29sdGlwIjoiRGEgZGVpbmUgWmVpY2hudW5nZW4gRW5kZS16dS1FbmRlIHZlcnNjaGzDvHNzZWx0IHdlcmRlbiwgc2VoZW4gYXVjaCB1bnNlcmUgRXhjYWxpZHJhdy1TZXJ2ZXIgc2llIG5pZW1hbHMuIn0sImNoYXJ0cyI6eyJub051bWVyaWNDb2x1bW4iOiJEdSBoYXN0IGVpbmUgVGFiZWxsZSBvaG5lIG51bWVyaXNjaGUgU3BhbHRlIGVpbmdlZsO8Z3QuIiwidG9vTWFueUNvbHVtbnMiOiJEdSBoYXN0IGVpbmUgVGFiZWxsZSBtaXQgbWVociBhbHMgendlaSBTcGFsdGVuIGVpbmdlZsO8Z3QuIn19Jyl9LGZ1bmN0aW9uKGUpe2UuZXhwb3J0cz1KU09OLnBhcnNlKCd7ImxhYmVscyI6eyJwYXN0ZSI6Is6Vz4DOuc66z4zOu867zrfPg863Iiwic2VsZWN0QWxsIjoizpXPgM65zrvOv86zzq4gz4zOu8+Jzr0iLCJtdWx0aVNlbGVjdCI6IiIsIm1vdmVDYW52YXMiOiLOnM61z4TOsc66zq/Ovc63z4POtyDOus6xzrzOss6sIiwiY29weSI6Is6Rzr3PhM65zrPPgc6xz4bOriIsImNvcHlBc1BuZyI6Is6Rzr3PhM65zrPPgc6xz4bOriDPg8+Ezr8gz4DPgc+Mz4fOtc65z4HOvyDPic+CIFBORyIsImNvcHlBc1N2ZyI6Is6Rzr3PhM65zrPPgc6xz4bOriDPg8+Ezr8gz4DPgc+Mz4fOtc65z4HOvyDPic+CIFNWRyIsImJyaW5nRm9yd2FyZCI6Is6jz4TOvyDPgM+Bzr/Pg866zq7Ovc65zr8iLCJzZW5kVG9CYWNrIjoizojOvc6xIM61z4DOr8+AzrXOtM6/IM+Azq/Pg8+JIiwiYnJpbmdUb0Zyb250IjoizojOvc6xIM61z4DOr8+AzrXOtM6/IM68z4DPgc6/z4PPhM6sIiwic2VuZEJhY2t3YXJkIjoizqPPhM6/IM+AzrHPgc6xz4POus6uzr3Ouc6/IiwiZGVsZXRlIjoizpTOuc6xzrPPgc6xz4bOriIsImNvcHlTdHlsZXMiOiLOkc69z4TOuc6zz4HOsc+Gzq4gzrXOvM+GzqzOvc65z4POt8+CIiwicGFzdGVTdHlsZXMiOiLOlc+AzrnOus+MzrvOu863z4POtyDOtc68z4bOrM69zrnPg863z4IiLCJzdHJva2UiOiLOnM6/zrvPhc6yzrnOrCIsImJhY2tncm91bmQiOiLOps+Mzr3PhM6/IiwiZmlsbCI6Is6Tzq3OvM65z4POvM6xIiwic3Ryb2tlV2lkdGgiOiLOoM6sz4fOv8+CIM68zr/Ou8+FzrLOuc6sz4IiLCJzdHJva2VTdHlsZSI6Is6jz4TPhc67IM+AzrXPgc65zrPPgc6szrzOvM6xz4TOv8+CIiwic3Ryb2tlU3R5bGVfc29saWQiOiLOo8+FzrzPgM6xzrPOrs+CIiwic3Ryb2tlU3R5bGVfZGFzaGVkIjoizpTOuc6xzrrOtc66zr/OvM68zq3Ovc63IM68zrUgz4DOsc+NzrvOtc+CIiwic3Ryb2tlU3R5bGVfZG90dGVkIjoizpTOuc6xzrrOtc66zr/OvM68zq3Ovc63IM68zrUgz4TOtc67zrXOr861z4IiLCJzbG9wcGluZXNzIjoizpHOus6xz4TOsc+Dz4TOsc+Dzq/OsSIsIm9wYWNpdHkiOiLOlM65zrHPhs6szr3Otc65zrEiLCJ0ZXh0QWxpZ24iOiLOo8+Ezr/Or8+HzrnPg863IM66zrXOuc68zq3Ovc6/z4UiLCJmb250U2l6ZSI6Is6czq3Os861zrjOv8+CIM6zz4HOsc68zrzOsc+Ezr/Pg861zrnPgc6sz4IiLCJmb250RmFtaWx5IjoizpPPgc6xzrzOvM6xz4TOv8+DzrXOuc+BzqwiLCJvbmx5U2VsZWN0ZWQiOiLOnM+Mzr3OvyDPhM6xIM6Vz4DOuc67zrXOs868zq3Ovc6xIiwid2l0aEJhY2tncm91bmQiOiLOnM61IM6mz4zOvc+Ezr8iLCJhZGRXYXRlcm1hcmsiOiLOoM+Bzr/Pg864zq7Ous63IFxcIs6mz4TOuc6xzrPOvM6tzr3OvyDOvM61IEV4Y2FsaWRyYXdcXCIiLCJoYW5kRHJhd24iOiLOo8+HzrXOtM65zrHPg868zq3Ovc6/IM+Dz4TOvyDPh86tz4HOuSIsIm5vcm1hbCI6Is6azrHOvc6/zr3Ouc66zq4iLCJjb2RlIjoizprPjs60zrnOus6xz4IiLCJzbWFsbCI6Is6czrnOus+Bz4wiLCJtZWRpdW0iOiLOnM61z4POsc6vzr8iLCJsYXJnZSI6Is6czrXOs86szrvOvyIsInZlcnlMYXJnZSI6Is6gzr/Ou8+NIM68zrXOs86szrvOvyIsInNvbGlkIjoizqPPhc68z4DOsc6zzq7PgiIsImhhY2h1cmUiOiLOlc66zrrPjM67zrHPiM63IiwiY3Jvc3NIYXRjaCI6Is6UzrnOsc+Dz4TOsc+Fz4HOv8+NzrzOtc69zrcgzrXOus66z4zOu86xz4jOtyIsInRoaW4iOiLOm861z4DPhM6uIiwiYm9sZCI6Is6Izr3PhM6/zr3OtyIsImxlZnQiOiLOkc+BzrnPg8+EzrXPgc6sIiwiY2VudGVyIjoizprOrc69z4TPgc6/IiwicmlnaHQiOiLOlM61zr7Ouc6sIiwiZXh0cmFCb2xkIjoizqDOv867z40gzq3Ovc+Ezr/Ovc63IiwiYXJjaGl0ZWN0IjoizpHPgc+HzrnPhM6tzrrPhM6/zr3Osc+CIiwiYXJ0aXN0IjoizprOsc67zrvOuc+Ezq3Ph869zrfPgiIsImNhcnRvb25pc3QiOiLOo866zrnPhM+Dzr/Os8+BzqzPhs6/z4IiLCJmaWxlVGl0bGUiOiLOpM6vz4TOu86/z4IgzpHPgc+HzrXOr86/z4UiLCJjb2xvclBpY2tlciI6Is6Vz4DOuc67zr/Os86uIM6nz4HPjs68zrHPhM6/z4IiLCJjYW52YXNCYWNrZ3JvdW5kIjoizqbPjM69z4TOvyDOus6xzrzOss6sIiwiZHJhd2luZ0NhbnZhcyI6Is6jz4fOtc60zq/Osc+DzrcgzrrOsc68zrLOrCIsImxheWVycyI6Is6jz4TPgc+OzrzOsc+EzrEiLCJhY3Rpb25zIjoizpXOvc6tz4HOs861zrnOtc+CIiwibGFuZ3VhZ2UiOiLOk867z47Pg8+DzrEiLCJjcmVhdGVSb29tIjoizojOvc6xz4HOvs63IM62z4nOvc+EzrHOvc6uz4Igz4PPhc69zrXOtM+Bzq/Osc+CIiwiZHVwbGljYXRlU2VsZWN0aW9uIjoizpTOt868zrnOv8+Fz4HOs86vzrEgzrHOvc+EzrnOs8+BzqzPhs6/z4UiLCJ1bnRpdGxlZCI6Is6nz4nPgc6vz4Igz4TOr8+EzrvOvyIsIm5hbWUiOiLOjM69zr/OvM6xIiwieW91ck5hbWUiOiLOpM6/IM+Mzr3Ov868zqwgz4POv8+FIiwibWFkZVdpdGhFeGNhbGlkcmF3IjoizqbPhM65zrHOs868zq3Ovc6/IM68zrUgRXhjYWxpZHJhdyIsImdyb3VwIjoizpTOt868zrnOv8+Fz4HOs86vzrEgzr/OvM6szrTOsc+CIM6xz4DPjCDOtc+AzrnOu86/zrPOriIsInVuZ3JvdXAiOiLOms6xz4TOrM+BzrPOt8+Dzrcgzr/OvM6szrTOsc+CIM6xz4DPjCDOtc+AzrnOu86/zrPOriIsImNvbGxhYm9yYXRvcnMiOiLOo8+Fzr3Otc+BzrPOrM+EzrXPgiIsInRvZ2dsZUdyaWRNb2RlIjoizpXOvc6xzrvOu86xzrPOriDOu861zrnPhM6/z4XPgc6zzq/Osc+CIM+AzrvOrc6zzrzOsc+Ezr/PgiIsImFkZFRvTGlicmFyeSI6IiIsInJlbW92ZUZyb21MaWJyYXJ5IjoiIiwibGlicmFyeUxvYWRpbmdNZXNzYWdlIjoiIn0sImJ1dHRvbnMiOnsiY2xlYXJSZXNldCI6Is6Vz4DOsc69zrHPhs6/z4HOrCDPhM6/z4UgzrrOsc68zrLOrCIsImV4cG9ydCI6Is6Vzr7Osc6zz4nOs86uIiwiZXhwb3J0VG9QbmciOiLOlc6+zrHOs8+JzrPOriDPg861IFBORyIsImV4cG9ydFRvU3ZnIjoizpXOvs6xzrPPic6zzq4gz4POtSBTVkciLCJjb3B5VG9DbGlwYm9hcmQiOiLOkc69z4TOuc6zz4HOsc+Gzq4gz4PPhM6/IM+Az4HPjM+HzrXOuc+Bzr8iLCJjb3B5UG5nVG9DbGlwYm9hcmQiOiLOkc69z4TOuc6zz4HOsc+Gzq4gUE5HIM+Dz4TOvyDPgM+Bz4zPh861zrnPgc6/Iiwic2F2ZSI6Is6Rz4DOv864zq7Ous61z4XPg863Iiwic2F2ZUFzIjoizpHPgM6/zrjOrs66zrXPhc+Dzrcgz4nPgiIsImxvYWQiOiLOhs69zr/Ouc6zzrzOsSIsImdldFNoYXJlYWJsZUxpbmsiOiLOlM63zrzPjM+DzrnOv8+CIM+Dz43Ovc60zrXPg868zr/PgiIsImNsb3NlIjoizprOu861zq/Pg865zrzOvyIsInNlbGVjdExhbmd1YWdlIjoizpXPgM65zrvOv86zzq4gzrPOu8+Oz4PPg86xz4IiLCJzY3JvbGxCYWNrVG9Db250ZW50IjoizpzOtc+EzrHOus65zr3Ot864zrXOr8+EzrUgz4DOr8+Dz4kgz4PPhM6/IM+AzrXPgc65zrXPh8+MzrzOtc69zr8iLCJ6b29tSW4iOiLOnM61zrPOrc64z4XOvc+DzrciLCJ6b29tT3V0IjoizqPOvM6vzrrPgc+Fzr3Pg863IiwicmVzZXRab29tIjoizpXPgM6xzr3Osc+Gzr/Pgc6sIM68zrXOs86tzrjPhc69z4POt8+CIiwibWVudSI6Is6czrXOvc6/z40iLCJkb25lIjoizqTOrc67zr/PgiIsImVkaXQiOiLOlc+AzrXOvs61z4HOs86xz4POr86xIiwidW5kbyI6Is6Rzr3Osc6vz4HOtc+DzrciLCJyZWRvIjoizpXPgM6xzr3Osc+Gzr/Pgc6sIiwicm9vbURpYWxvZyI6Is6Izr3Osc+Bzr7OtyDOts+Jzr3PhM6xzr3Ors+CIM+Dz4XOvc61z4HOs86xz4POr86xz4IiLCJjcmVhdGVOZXdSb29tIjoizpTOt868zrnOv8+Fz4HOs86vzrEgzr3Orc6/z4Ugz4fPjs+Bzr/PhSIsInRvZ2dsZUZ1bGxTY3JlZW4iOiLOlc69zrHOu867zrHOs86uIM+AzrvOrs+Bzr/Phc+CIM6/zrjPjM69zrfPgiIsInRvZ2dsZVplbk1vZGUiOiLOlc69zrHOu867zrHOs86uIM67zrXOuc+Ezr/Phc+BzrPOr86xz4IgWmVuIiwiZXhpdFplbk1vZGUiOiLOiM6+zr/OtM6/z4IgzrHPgM6/IM+EzrfOvSDOu861zrnPhM6/z4XPgc6zzq/OsSBaZW4ifSwiYWxlcnRzIjp7ImNsZWFyUmVzZXQiOiLOkc+Fz4TPjCDOuM6xIM+DzrLOrs+DzrXOuSDOv867z4zOus67zrfPgc6/IM+Ezr/OvSDOus6xzrzOss6sLiDOlc6vz4POsc65IM+Dzq/Os86/z4XPgc6/z4I7IiwiY291bGROb3RDcmVhdGVTaGFyZWFibGVMaW5rIjoizpTOtc69IM6uz4TOsc69IM60z4XOvc6xz4TOriDOtyDOtM63zrzOuc6/z4XPgc6zzq/OsSDPg8+Fzr3OtM6tz4POvM6/z4UgzrrOv865zr3Ors+CIM+Hz4HOrs+DzrfPgi4iLCJjb3VsZE5vdExvYWRJbnZhbGlkRmlsZSI6Is6UzrXOvSDOvM+Az4zPgc61z4POtSDOvc6xIM6xzr3Ov86vzr7Otc65IM61z4PPhs6xzrvOvM6tzr3OvyDOsc+Bz4fOtc6vzr8iLCJpbXBvcnRCYWNrZW5kRmFpbGVkIjoizpcgzrXOuc+DzrHOs8+JzrPOriDOsc+Az4wgz4TOvyBiYWNrZW5kIM6xz4DOrc+Ez4XPh861LiIsImNhbm5vdEV4cG9ydEVtcHR5Q2FudmFzIjoizpTOtc69IM61zq/Ovc6xzrkgzrTPhc69zrHPhM6uIM63IM61zr7Osc6zz4nOs86uIM66zrXOvc6/z40gzrrOsc68zrLOrC4iLCJjb3VsZE5vdENvcHlUb0NsaXBib2FyZCI6Is6UzrXOvSDOrs+EzrHOvSDOtM+Fzr3Osc+Ezq4gzrcgzrHOvc+EzrnOs8+BzrHPhs6uIM+Dz4TOvyDPgM+Bz4zPh861zrnPgc6/LiDOlM6/zrrOr868zrHPg861IM+Ezrcgz4fPgc6uz4POtyDPhM6/z4Ugz4DPgc6/zrPPgc6szrzOvM6xz4TOv8+CIM+AzrXPgc65zq7Os863z4POt8+CIENocm9tZS4iLCJkZWNyeXB0RmFpbGVkIjoizpTOtc69IM6uz4TOsc69IM60z4XOvc6xz4TOriDOtyDOsc+Azr/Ous+Bz4XPgM+Ezr/Os8+BzqzPhs63z4POtyDOtM61zrTOv868zq3Ovc+Jzr0uIiwidXBsb2FkZWRTZWN1cmx5IjoizpcgzrzOtc+EzrHPhs+Mz4HPhM+Jz4POtyDOrc+HzrXOuSDOtc6+zrHPg8+GzrHOu865z4PPhM61zq8gzrzOtSDOus+Bz4XPgM+Ezr/Os8+BzqzPhs63z4POtyDOsc+Az4wgzqzOus+Bzr8gz4POtSDOrM66z4HOvywgz4DPgc6szrPOvM6xIM+Azr/PhSDPg863zrzOsc6vzr3Otc65IM+Mz4TOuSDOvyDOtM65zrHOus6/zrzOuc+Dz4TOrs+CIEV4Y2FsaWRyYXcgzrrOsc65IM+Ez4HOr8+EzrEgzrzOrc+BzrcgzrTOtc69IM68z4DOv8+Bzr/Pjc69IM69zrEgzrTOuc6xzrLOrM+Dzr/Phc69IM+Ezr8gz4DOtc+BzrnOtc+Hz4zOvM61zr3Ovy4iLCJsb2FkU2NlbmVPdmVycmlkZVByb21wdCI6IiJ9LCJ0b29sQmFyIjp7InNlbGVjdGlvbiI6Is6Vz4DOuc67zr/Os86uIiwiZHJhdyI6Is6VzrvOtc+NzrjOtc+Bzr8gz4PPh86tzrTOuc6/IiwicmVjdGFuZ2xlIjoizp/Pgc64zr/Os8+Ozr3Ouc6/IiwiZGlhbW9uZCI6Is6hz4zOvM6yzr/PgiIsImVsbGlwc2UiOiLOiM67zrvOtc65z4jOtyIsImFycm93IjoizpLOrc67zr/PgiIsImxpbmUiOiLOk8+BzrHOvM68zq4iLCJ0ZXh0IjoizprOtc6vzrzOtc69zr8iLCJsaWJyYXJ5IjoiIiwibG9jayI6Is6az4HOrM+EzrfPg861IM61z4DOuc67zrXOs868zq3Ovc6/IM+Ezr8gzrXPgc6zzrHOu861zq/OvyDOvM61z4TOrCDPhM6/IM+Dz4fOrc60zrnOvyJ9LCJoZWFkaW5ncyI6eyJjYW52YXNBY3Rpb25zIjoizpXOvc6tz4HOs861zrnOtc+CIM66zrHOvM6yzqwiLCJzZWxlY3RlZFNoYXBlQWN0aW9ucyI6Is6Vz4DOuc67zrXOs868zq3Ovc61z4IgzrXOvc6tz4HOs861zrnOtc+CIM+Dz4fOrs68zrHPhM6/z4IiLCJzaGFwZXMiOiLOo8+Hzq7OvM6xz4TOsSJ9LCJoaW50cyI6eyJsaW5lYXJFbGVtZW50IjoizprOrM69zrUgzrrOu865zrogzrPOuc6xIM69zrEgzr7Otc66zrnOvc6uz4POtc65z4Igz4DOv867zrvOsc+AzrvOrCDPg863zrzOtc6vzrEsIM+Dz43Pgc61IM6zzrnOsSDOvM65zrEgzrPPgc6xzrzOvM6uIiwiZnJlZURyYXciOiLOms6szr3PhM61IM66zrvOuc66IM66zrHOuSDPg8+Nz4HOsc+EzrUsIM6xz4DOtc67zrXPhc64zrXPgc+Oz4POsc+EzrUgz4zPhM6xzr0gzq3Ph861z4TOtSDPhM61zrvOtc65z47Pg861zrkiLCJsaW5lYXJFbGVtZW50TXVsdGkiOiLOms6szr3OtSDOus67zrnOuiDPg8+Ezr8gz4TOtc67zrXPhc+EzrHOr86/IM+DzrfOvM61zq/OvyDOriDPgM6sz4TOt8+DzrUgRXNjYXBlIM6uIEVudGVyIM6zzrnOsSDOvc6xIM+EzrXOu861zrnPjs+DzrXOuc+CIiwicmVzaXplIjoizpzPgM6/z4HOtc6vz4Igzr3OsSDPgM61z4HOuc6/z4HOr8+DzrXOuc+CIM+EzrnPgiDOsc69zrHOu86/zrPOr861z4IgzrrPgc6xz4TPjs69z4TOsc+CIM+Ezr8gU0hJRlQgzrXOvc+OIM6xzrvOu86szrbOtc65z4IgzrzOrc6zzrXOuM6/z4IsXFxuzrrPgc6sz4TOt8+DzrUgz4DOsc+EzrfOvM6tzr3OvyDPhM6/IEFMVCDOs865zrEgzrHOu867zrHOs86uIM68zrXOs86tzrjOv8+Fz4IgzrHPgM+MIM+Ezr8gzrrOrc69z4TPgc6/Iiwicm90YXRlIjoizpzPgM6/z4HOtc6vz4Igzr3OsSDPgM61z4HOuc6/z4HOr8+DzrXOuc+CIM+EzrnPgiDOs8+Jzr3Or861z4IgzrrPgc6xz4TPjs69z4TOsc+CIM+AzrHPhM63zrzOrc69zr8gz4TOvyDPgM67zq7Ous+Ez4HOvyBTSElGVCDOus6xz4TOrCDPhM63zr0gz4DOtc+BzrnPg8+Ez4HOv8+Gzq4iLCJsaW5lRWRpdG9yX2luZm8iOiLOlM65z4DOu8+MLc66zrvOuc66IM6uIM+AzrnOrc+Dz4TOtSBFbnRlciDOs865zrEgzr3OsSDOtc+AzrXOvs61z4HOs86xz4PPhM61zq/PhM61IM+EzrEgz4POt868zrXOr86xIiwibGluZUVkaXRvcl9wb2ludFNlbGVjdGVkIjoiIiwibGluZUVkaXRvcl9ub3RoaW5nU2VsZWN0ZWQiOiLOlc+AzrnOu86tzr7PhM61IM6tzr3OsSDPg863zrzOtc6vzr8gzrPOuc6xIM68zrXPhM6xzrrOr869zrfPg863IM6uIM6xz4bOsc6vz4HOtc+DzrcsIM6uIM66z4HOsc+Ezq7Pg8+EzrUgz4DOsc+BzrHPhM61z4TOsc68zq3Ovc6xIM+Ezr8gQWx0IM66zrHOuSDOus6szr3PhM61IM66zrvOuc66IM6zzrnOsSDOvc6xIM+Az4HOv8+DzrjOrc+DzrXPhM61IM69zq3OsSDPg863zrzOtc6vzrEifSwiZXJyb3JTcGxhc2giOnsiaGVhZGluZ01haW5fcHJlIjoizqPPhc69zq3Oss63IM66zqzPgM6/zrnOvyDPg8+GzqzOu868zrEuIM6gz4HOv8+Dz4DOrM64zrfPg861ICIsImhlYWRpbmdNYWluX2J1dHRvbiI6Is+Gz4zPgc+Ez4nPg861IM6+zrHOvc6sIM+EzrfOvSDPg861zrvOr860zrEuIiwiY2xlYXJDYW52YXNNZXNzYWdlIjoizpXOrM69IM+Ezr8gz4DOsc+BzrHPgM6szr3PiSDOtM61zr0gzrTOv8+FzrvOrc+IzrXOuSwgz4DPgc6/z4PPgM6szrjOt8+DzrUgIiwiY2xlYXJDYW52YXNNZXNzYWdlX2J1dHRvbiI6Is66zrHOuM6xz4HOr8+DzrXPhM61IM+Ezr/OvSDOus6xzr3Oss6sLiIsImNsZWFyQ2FudmFzQ2F2ZWF0IjoiIM6Rz4XPhM+MIM64zrEgz4DPgc6/zrrOsc67zq3Pg861zrkgzrHPgM+OzrvOtc65zrEgz4TOt8+CIM60zr/Phc67zrXOuc6sz4Igz4POv8+FICIsInRyYWNrZWRUb1NlbnRyeV9wcmUiOiLOpM6/IM+Dz4bOrM67zrzOsSDOvM61IM6xzr3Osc6zzr3Pic+BzrnPg8+EzrnOus+MICIsInRyYWNrZWRUb1NlbnRyeV9wb3N0IjoiIM+AzrHPgc6xzrrOv867zr/Phc64zq7OuM63zrrOtSDPg8+Ezr8gz4PPjc+Dz4TOt868zqwgzrzOsc+CLiIsIm9wZW5Jc3N1ZU1lc3NhZ2VfcHJlIjoizonOvM6xz4PPhM6xzr0gz4DOv867z40gz4DPgc6/z4POtc66z4TOuc66zr/OryDOs865zrEgzr3OsSDOvM63zr0gz4PPhc68z4DOtc+BzrnOu86szrLOv8+FzrzOtSDPhM65z4Igz4DOu863z4HOv8+Gzr/Pgc6vzrXPgiDPhM63z4Igz4POus63zr3Ors+CIM+Dzr/PhSDPg8+Ezr8gz4PPhs6szrvOvM6xLiDOkc69IM63IM+DzrrOt869zq4gz4POv8+FIM60zrXOvSDOtc6vzr3Osc65IM65zrTOuc+Jz4TOuc66zq4sIM+AzrHPgc6xzrrOsc67z44gz4POus6tz4jOv8+Fzr0gzr3OsSDOsc66zr/Ou86/z4XOuM6uz4POtc65z4Igz4TOvyDOtM65zrrPjCDOvM6xz4IgIiwib3Blbklzc3VlTWVzc2FnZV9idXR0b24iOiLOsc69zrnPh869zrXPhc+Ezq7PgiDPg8+GzrHOu868zqzPhM+Jzr0uIiwib3Blbklzc3VlTWVzc2FnZV9wb3N0IjoiIM6gzrHPgc6xzrrOsc67z44gzr3OsSDPg8+FzrzPgM61z4HOuc67zqzOss61z4TOtSDPhM65z4Igz4DOsc+BzrHOus6sz4TPiSDPgM67zrfPgc6/z4bOv8+Bzq/Otc+CLCDOsc69z4TOuc6zz4HOrM+Gzr/Ovc+EzrHPgiDOus6xzrkgzrXPgM65zrrOv867zrvPjs69z4TOsc+CIM+Ezr8gzrbOrs+EzrfOvM6xIM+Dz4TOvyBHaXRIdWIuIiwic2NlbmVDb250ZW50IjoizqDOtc+BzrnOtc+Hz4zOvM61zr3OvyDPg866zrfOvc6uz4I6In0sInJvb21EaWFsb2ciOnsiZGVzY19pbnRybyI6Is6cz4DOv8+BzrXOr8+CIM69zrEgz4DPgc6/z4POus6xzrvOrc+DzrXOuc+CIM6szrvOu86/z4XPgiDOvc6xIM60zr/Phc67zq3PiM6/z4XOvSDOvM6xzrbOryDPg86/z4UuIiwiZGVzY19wcml2YWN5IjoizpzOt869IM6xzr3Ot8+Dz4XPh861zq/Pgiwgzrcgz4PPhc69zrXOtM+Bzq/OsSDPh8+BzrfPg865zrzOv8+Azr/Ouc61zq8gzrrPgc+Fz4DPhM6/zrPPgc6sz4bOt8+DzrcgzrHPgM+MIM+DzrfOvM61zq/OvyDPg861IM+DzrfOvM61zq/OvywgzqzPgc6xIM6/z4TOuc60zq7PgM6/z4TOtSDOus6szr3Otc65z4IgzrjOsSDPgM6xz4HOsc68zrXOr869zrXOuSDOsc69zr/Ouc+Hz4TPjCDOvM+Mzr3OvyDPg861IM61z4POrc69zrEuIM6fz43PhM61IM6/zrkgzrzOt8+HzrHOvc6tz4IgzrzOsc+CIM68z4DOv8+Bzr/Pjc69IM69zrEgzrTOv8+Fzr0gz4TOuSDOus6szr3Otc65z4IuIiwiYnV0dG9uX3N0YXJ0U2Vzc2lvbiI6Is6Izr3Osc+Bzr7OtyDOo8+Fzr3Otc60z4HOr86xz4IiLCJidXR0b25fc3RvcFNlc3Npb24iOiLOpM61z4HOvM6xz4TOuc+DzrzPjM+CIM6jz4XOvc61zrTPgc6vzrHPgiIsImRlc2NfaW5Qcm9ncmVzc0ludHJvIjoizpcgzrbPic69z4TOsc69zq4gz4PPhc69zrXPgc6zzrHPg86vzrEgzrzOtSDOrM67zrvOv8+Fz4IgzrXOr869zrHOuSDPg861IM61zr3Otc+BzrPOri4iLCJkZXNjX3BlcnNpc3RlbmNlV2FybmluZyI6Is6jzrfOvM61zrnPjs+DzrHPhM61IM+Az4nPgiDPhM6xIM60zrXOtM6/zrzOrc69zrEgz4TOv8+FIM+Azq/Ovc6xzrrOsSDOvM6/zrnPgc6szrbOv869z4TOsc65IM+Dz4TOv8+Fz4Igz4PPhc69zrXOuc+Dz4bOrc+Bzr/Ovc+EzrXPgiDOvM61IFAyUCDPhM+Bz4zPgM6/LCDOus6xzrkgzrTOtc69IM6xz4DOv864zrfOus61z43Ov869z4TOsc65IM+Dz4TOv869IHNlcnZlciDOvM6xz4IuIM6jz4XOvc61z4DPjs+CLCDOtc6szr0gzrHPgM6/z4PPhc69zrTOtc64zrXOr8+EzrUgz4zOu86/zrkgz4POsc+CLCDOuM6xIM+HzqzPg861z4TOtSDPhM6xIM60zrXOtM6/zrzOrc69zrEgzrXOus+Ez4zPgiDOus6xzrkgzrHOvSDPhM6xIM61zr7OrM6zzrXPhM61IM+DzrUgzq3Ovc6xIM6xz4HPh861zq/OvyDOriDOrc69zrHOvSDOus6/zrnOvc6/z4DOv865zq7Pg865zrzOvyDPg8+Nzr3OtM61z4POvM6/LiIsImRlc2Nfc2hhcmVMaW5rIjoizpzOv865z4HOsc+Dz4TOtc6vz4TOtSDPhM6/zr0gz4PPjc69zrTOtc+DzrzOvyDOvM61IM+Mz4DOv865zr/OvSDOuM6tzrvOtc+EzrUgzr3OsSDOtM6/z4XOu86tz4jOtc+EzrUgzrzOsc62zq86IiwiZGVzY19leGl0U2Vzc2lvbiI6Is6XIM60zrnOsc66zr/PgM6uIM64zrEgz4POsc+CIM6xz4DOv8+Dz4XOvc60zq3Pg861zrkgzrHPgM+MIM+Ezr8gzrTPic68zqzPhM65zr8sIM6xzrvOu86sIM64zrEgzrzPgM6/z4HOtc6vz4TOtSDOvc6xIM+Dz4XOvc61z4fOr8+DzrXPhM61IM69zrEgzrTOv8+FzrvOtc+NzrXPhM61IM+Dz4TOv869IM+Azq/Ovc6xzrrOsSwgz4TOv8+AzrnOus6sLiDOo863zrzOtc65z47Pg86xz4TOtSDPjM+EzrkgzrHPhc+Ez4wgzrTOtc69IM64zrEgzrXPgM63z4HOtc6sz4POtc65IM+Ezr/OvSDPgM6vzr3Osc66zrEgzqzOu867z4nOvSwgzrrOsc65IM64zrEgzrzPgM6/z4HOv8+Nzr0gzrHOus+MzrzOsSDOvc6xIM+Dz4XOvc61zrnPg8+Gzq3Pgc6/z4XOvSDPg8+EzrfOvSDOtM65zrrOriDPhM6/z4XPgiDOrc66zrTOv8+DzrcuIn0sImVycm9yRGlhbG9nIjp7InRpdGxlIjoizqPPhs6szrvOvM6xIn0sInNob3J0Y3V0c0RpYWxvZyI6eyJ0aXRsZSI6Is6jz4XOvc+Ezr/OvM61z43Pg861zrnPgiDPgM67zrfOus+Ez4HOv867zr/Os86vzr/PhSIsInNoYXBlcyI6Is6jz4fOrs68zrHPhM6xIiwib3IiOiLOriIsImNsaWNrIjoizrrOu865zroiLCJkcmFnIjoiz4PPjc+BzrUiLCJjdXJ2ZWRBcnJvdyI6Is6az4XPgc+Ez4wgzrLOrc67zr/PgiIsImN1cnZlZExpbmUiOiLOms+Fz4HPhM6uIM6zz4HOsc68zrzOriIsImVkaXRvciI6Is6Vz4DOtc6+zrXPgc6zzrHPg8+Ezq7PgiIsInZpZXciOiLOoM+Bzr/Oss6/zrvOriIsImJsb2ciOiLOlM65zrHOss6sz4PPhM61IM+Ezr8gzrnPg8+Ezr/Ou8+MzrPOuc6/IM68zrHPgiIsImhvd3RvIjoizpHOus6/zrvOv8+FzrjOrs+Dz4TOtSDPhM6/z4XPgiDOv860zrfOs86/z43PgiDOvM6xz4IiLCJnaXRodWIiOiLOks+Bzq7Ous6xz4TOtSDPgM+Bz4zOss67zrfOvM6xOyDOpc+Azr/Oss6szrvOtc+EzrUgz4TOvyIsInRleHROZXdMaW5lIjoizqDPgc6/z4POuM6uzrrOtyDOvc6tzrHPgiDOs8+BzrHOvM68zq7PgiAozrrOtc6vzrzOtc69zr8pIiwidGV4dEZpbmlzaCI6Is6fzrvOv866zrvOrs+Bz4nPg863IM61z4DOtc6+zrXPgc6zzrHPg86vzrHPgiAozrrOtc6vzrzOtc69zr8pIiwiem9vbVRvRml0IjoiWm9vbSDPjs+Dz4TOtSDOvc6xIM+Hz4nPgc6tz4POv8+Fzr0gz4zOu86xIM+EzrEgz4PPhM6/zrnPh861zq/OsSJ9LCJlbmNyeXB0ZWQiOnsidG9vbHRpcCI6Is6kzrEgz4PPh86tzrTOuc6sIM+Dzr/PhSDOtc6vzr3Osc65IM66z4HPhc+Az4TOv86zz4HOsc+GzrfOvM6tzr3OsSDOsc+Az4wgzqzOus+Bzr8gz4POtSDOrM66z4HOvywgzq3PhM+DzrkgzrTOtc69IM64zrEgzq3Ouc69zrHOuSDPgM6/z4TOrSDOv8+BzrHPhM6sIM68zq3Pg86xIM6xz4DPjCDPhM6/z4XPgiDOtM65zrHOus6/zrzOuc+Dz4TOrc+CIM+Ezr/PhSBFeGNhbGlkcmF3LiJ9LCJjaGFydHMiOnsibm9OdW1lcmljQ29sdW1uIjoizpXPgM65zrrPjM67zrvOt8+DzrXPgiDOrc69zrEgz4XPgM6/zrvOv86zzrnPg8+EzrnOus+MIM+Gz43Ou867zr8gz4fPic+Bzq/PgiDOsc+BzrnOuM68zrfPhM65zrrOriDPg8+Ezq7Ou863LiIsInRvb01hbnlDb2x1bW5zIjoizpXPgM65zrrPjM67zrvOt8+DzrXPgiDOrc69zrEgz4XPgM6/zrvOv86zzrnPg8+EzrnOus+MIM+Gz43Ou867zr8gzrzOtSDPgM61z4HOuc+Dz4PPjM+EzrXPgc61z4IgzrHPgM+MIM60z43OvyDPg8+Ezq7Ou861z4IuIn19Jyl9LGZ1bmN0aW9uKGUpe2UuZXhwb3J0cz1KU09OLnBhcnNlKCd7ImxhYmVscyI6eyJwYXN0ZSI6IlBlZ2FyIiwic2VsZWN0QWxsIjoiU2VsZWNjaW9uYXIgdG9kbyIsIm11bHRpU2VsZWN0IjoiQcOxYWRpciBlbGVtZW50byBhIGxhIHNlbGVjY2nDs24iLCJtb3ZlQ2FudmFzIjoiTW92ZXIgZWwgbGllbnpvIiwiY29weSI6IkNvcGlhciIsImNvcHlBc1BuZyI6IkNvcGlhciBhbCBwb3J0YXBhcGVsZXMgY29tbyBQTkciLCJjb3B5QXNTdmciOiJDb3BpYXIgYWwgcG9ydGFwYXBlbGVzIGNvbW8gU1ZHIiwiYnJpbmdGb3J3YXJkIjoiVHJhZXIgaGFjaWEgZGVsYW50ZSIsInNlbmRUb0JhY2siOiJFbnZpYXIgYWwgZm9uZG8iLCJicmluZ1RvRnJvbnQiOiJUcmFlciBhbCBmcmVudGUiLCJzZW5kQmFja3dhcmQiOiJFbnZpYXIgYXRyw6FzIiwiZGVsZXRlIjoiQm9ycmFyIiwiY29weVN0eWxlcyI6IkNvcGlhciBlc3RpbG9zIiwicGFzdGVTdHlsZXMiOiJQZWdhciBlc3RpbG9zIiwic3Ryb2tlIjoiVHJhem8iLCJiYWNrZ3JvdW5kIjoiRm9uZG8iLCJmaWxsIjoiUmVsbGVuYXIiLCJzdHJva2VXaWR0aCI6Ikdyb3NvciBkZWwgdHJhem8iLCJzdHJva2VTdHlsZSI6IkVzdGlsbyBkZWwgdHJhem8iLCJzdHJva2VTdHlsZV9zb2xpZCI6IlPDs2xpZG8iLCJzdHJva2VTdHlsZV9kYXNoZWQiOiJMaW5lYSBkaXNjb250aW51YSIsInN0cm9rZVN0eWxlX2RvdHRlZCI6IlB1bnRlYWRvIiwic2xvcHBpbmVzcyI6IkVzdGlsbyBkZSB0cmF6byIsIm9wYWNpdHkiOiJPcGFjaWRhZCIsInRleHRBbGlnbiI6IkFsaW5lYWRvIGRlIHRleHRvIiwiZm9udFNpemUiOiJUYW1hw7FvIGRlIGxhIGZ1ZW50ZSIsImZvbnRGYW1pbHkiOiJUaXBvIGRlIGZ1ZW50ZSIsIm9ubHlTZWxlY3RlZCI6IlPDs2xvIHNlbGVjY2lvbmFkb3MiLCJ3aXRoQmFja2dyb3VuZCI6IkNvbiBmb25kbyIsImFkZFdhdGVybWFyayI6IkFncmVnYXIgXFwiSGVjaG8gY29uIEV4Y2FsaWRyYXdcXCIiLCJoYW5kRHJhd24iOiJEaWJ1amFkbyBhIG1hbm8iLCJub3JtYWwiOiJOb3JtYWwiLCJjb2RlIjoiQ8OzZGlnbyIsInNtYWxsIjoiUGVxdWXDsWEiLCJtZWRpdW0iOiJNZWRpYW5hIiwibGFyZ2UiOiJHcmFuZGUiLCJ2ZXJ5TGFyZ2UiOiJNdXkgZ3JhbmRlIiwic29saWQiOiJTw7NsaWRvIiwiaGFjaHVyZSI6IkZvbGxldG8iLCJjcm9zc0hhdGNoIjoiUmF5YWRvIHRyYW5zdmVyc2FsIiwidGhpbiI6IkZpbm8iLCJib2xkIjoiR3J1ZXNvIiwibGVmdCI6Ikl6cXVpZXJkYSIsImNlbnRlciI6IkNlbnRyYWRvIiwicmlnaHQiOiJEZXJlY2hhIiwiZXh0cmFCb2xkIjoiRXh0cmEgbmVncml0YSIsImFyY2hpdGVjdCI6IkFycXVpdGVjdG8iLCJhcnRpc3QiOiJBcnRpc3RhIiwiY2FydG9vbmlzdCI6IkNhcmljYXR1cmEiLCJmaWxlVGl0bGUiOiJUw610dWxvIGRlbCBhcmNoaXZvIiwiY29sb3JQaWNrZXIiOiJTZWxlY3RvciBkZSBjb2xvciIsImNhbnZhc0JhY2tncm91bmQiOiJGb25kbyBkZWwgbGllbnpvIiwiZHJhd2luZ0NhbnZhcyI6IkxpZW56byBkZSBkaWJ1am8iLCJsYXllcnMiOiJDYXBhcyIsImFjdGlvbnMiOiJBY2Npb25lcyIsImxhbmd1YWdlIjoiSWRpb21hIiwiY3JlYXRlUm9vbSI6IkNvbXBhcnRpciB1bmEgc2VzacOzbiBkZSBjb2xhYm9yYWNpw7NuIGVuIHZpdm8iLCJkdXBsaWNhdGVTZWxlY3Rpb24iOiJEdXBsaWNhciIsInVudGl0bGVkIjoiU2luIHTDrXR1bG8iLCJuYW1lIjoiTm9tYnJlIiwieW91ck5hbWUiOiJUdSBub21icmUiLCJtYWRlV2l0aEV4Y2FsaWRyYXciOiJIZWNobyBjb24gRXhjYWxpZHJhdyIsImdyb3VwIjoiU2VsZWNjacOzbiBkZSBncnVwbyIsInVuZ3JvdXAiOiJEaXZpZGlyIHNlbGVjY2nDs24iLCJjb2xsYWJvcmF0b3JzIjoiQ29sYWJvcmFkb3JlcyIsInRvZ2dsZUdyaWRNb2RlIjoiQWx0ZXJuYXIgbW9kbyBjdWFkcsOtY3VsYSIsImFkZFRvTGlicmFyeSI6IkHDsWFkaXIgYSBsYSBiaWJsaW90ZWNhIiwicmVtb3ZlRnJvbUxpYnJhcnkiOiJFbGltaW5hciBkZSBsYSBiaWJsaW90ZWNhIiwibGlicmFyeUxvYWRpbmdNZXNzYWdlIjoiQ2FyZ2FuZG8gYmlibGlvdGVjYS4uLiJ9LCJidXR0b25zIjp7ImNsZWFyUmVzZXQiOiJMaW1waWFyIGxpZW56byB5IHJlaW5pY2lhciBlbCBjb2xvciBkZSBmb25kbyIsImV4cG9ydCI6IkV4cG9ydGFyIiwiZXhwb3J0VG9QbmciOiJFeHBvcnRhciBhIFBORyIsImV4cG9ydFRvU3ZnIjoiRXhwb3J0YXIgYSBTVkciLCJjb3B5VG9DbGlwYm9hcmQiOiJDb3BpYXIgYWwgcG9ydGFwYXBlbGVzIiwiY29weVBuZ1RvQ2xpcGJvYXJkIjoiQ29waWFyIFBORyBhbCBwb3J0YXBhcGVsZXMiLCJzYXZlIjoiR3VhcmRhciIsInNhdmVBcyI6Ikd1YXJkYXIgY29tbyIsImxvYWQiOiJDYXJnYXIiLCJnZXRTaGFyZWFibGVMaW5rIjoiT2J0ZW5lciBlbmxhY2UgcGFyYSBjb21wYXJ0aXIiLCJjbG9zZSI6IkNlcnJhciIsInNlbGVjdExhbmd1YWdlIjoiRWxlZ2lyIGlkaW9tYSIsInNjcm9sbEJhY2tUb0NvbnRlbnQiOiJWb2x2ZXIgYWwgY29udGVuaWRvIiwiem9vbUluIjoiQWNlcmNhcnNlIiwiem9vbU91dCI6IkFsZWphcnNlIiwicmVzZXRab29tIjoiUmVzdGFibGVjZXIgem9vbSIsIm1lbnUiOiJNZW7DuiIsImRvbmUiOiJIZWNobyIsImVkaXQiOiJFZGl0YXIiLCJ1bmRvIjoiRGVzaGFjZXIiLCJyZWRvIjoiUmVoYWNlciIsInJvb21EaWFsb2ciOiJJbmljaWFyIGNvbGFib3JhY2nDs24gZW4gdml2byIsImNyZWF0ZU5ld1Jvb20iOiJDcmVhciBudWV2YSBzYWxhIiwidG9nZ2xlRnVsbFNjcmVlbiI6IkFsdGVybmFyIHBhbnRhbGxhIGNvbXBsZXRhIiwidG9nZ2xlWmVuTW9kZSI6IkFsdGVybmFyIG1vZG8gemVuIiwiZXhpdFplbk1vZGUiOiJTYWxpciBkZWwgbW9kbyBaZW4ifSwiYWxlcnRzIjp7ImNsZWFyUmVzZXQiOiJFc3RvIGxpbXBpYXLDoSB0b2RvIGVsIGxpZW56by4gRXN0w6FzIHNlZ3Vybz8iLCJjb3VsZE5vdENyZWF0ZVNoYXJlYWJsZUxpbmsiOiJObyBzZSBwdWRvIGNyZWFyIHVuIGVubGFjZSBwYXJhIGNvbXBhcnRpci4iLCJjb3VsZE5vdExvYWRJbnZhbGlkRmlsZSI6Ik5vIHNlIHB1ZG8gY2FyZ2FyIGVsIGFyY2hpdm8gaW52w6FsaWRvIiwiaW1wb3J0QmFja2VuZEZhaWxlZCI6IkxhIGltcG9ydGFjacOzbiBmYWxsw7MuIiwiY2Fubm90RXhwb3J0RW1wdHlDYW52YXMiOiJObyBzZSBwdWVkZSBleHBvcnRhciB1biBsaWVuem8gdmFjacOzIiwiY291bGROb3RDb3B5VG9DbGlwYm9hcmQiOiJObyBzZSBoYSBwb2RpZG8gY29waWFyIGFsIHBvcnRhcGFwZWxlcywgaW50ZW50ZSB1c2FyIENocm9tZSBjb21vIG5hdmVnYWRvci4iLCJkZWNyeXB0RmFpbGVkIjoiTm8gc2UgcHVkaWVyb24gZGVzY2lmcmFyIGxvcyBkYXRvcy4iLCJ1cGxvYWRlZFNlY3VybHkiOiJMYSBjYXJnYSBoYSBzaWRvIGFzZWd1cmFkYSBjb24gY2lmcmFkbyBkZSBleHRyZW1vIGEgZXh0cmVtbywgbG8gcXVlIHNpZ25pZmljYSBxdWUgZWwgc2Vydmlkb3IgZGUgRXhjYWxpZHJhdyB5IHRlcmNlcm9zIG5vIHB1ZWRlbiBsZWVyIGVsIGNvbnRlbmlkby4iLCJsb2FkU2NlbmVPdmVycmlkZVByb21wdCI6IlNpIGNhcmdhIGVzdGUgZGlidWpvIGV4dGVybm8sIHJlZW1wbGF6YXLDoSBlbCBxdWUgdGllbmUuIMK/RGVzZWEgY29udGludWFyPyJ9LCJ0b29sQmFyIjp7InNlbGVjdGlvbiI6IlNlbGVjY2nDs24iLCJkcmF3IjoiRGlidWpvIGxpYnJlIiwicmVjdGFuZ2xlIjoiUmVjdMOhbmd1bG8iLCJkaWFtb25kIjoiRGlhbWFudGUiLCJlbGxpcHNlIjoiRWxpcHNlIiwiYXJyb3ciOiJGbGVjaGEiLCJsaW5lIjoiTMOtbmVhIiwidGV4dCI6IlRleHRvIiwibGlicmFyeSI6IkJpYmxpb3RlY2EiLCJsb2NrIjoiTWFudGVuZXIgbGEgaGVycmFtaWVudGEgc2VsZWNjaW9uYWRhIGFjdGl2YSBkZXNwdcOpcyBkZSBkaWJ1amFyIn0sImhlYWRpbmdzIjp7ImNhbnZhc0FjdGlvbnMiOiJBY2Npb25lcyBkZWwgbGllbnpvIiwic2VsZWN0ZWRTaGFwZUFjdGlvbnMiOiJBY2Npb25lcyBkZSBsYSBmb3JtYSBzZWxlY2Npb25hZGEiLCJzaGFwZXMiOiJGb3JtYXMifSwiaGludHMiOnsibGluZWFyRWxlbWVudCI6IkhhZ2EgY2xpYyBwYXJhIGRpYnVqYXIgbXVsdGlwbGVzIHB1bnRvcyBvIGFycmFzdHJlIHBhcmEgdW5hIHNvbGEgbMOtbmVhIiwiZnJlZURyYXciOiJIYXogY2xpYyB5IGFycmFzdHJhLCBzdWVsdGEgYWwgdGVybWluYXIiLCJsaW5lYXJFbGVtZW50TXVsdGkiOiJIYWdhIGNsaWMgZW4gZWwgw7psdGltbyBwdW50byBvIHB1bHNlIEVzY2FwZSBvIEVudGVyIHBhcmEgZmluYWxpemFyIiwicmVzaXplIjoiUGFyYSBtYW50ZW5lciBsYXMgcHJvcG9yY2lvbmVzIG1hbnTDqW4gU0hJRlQgcHJlc2lvbmFkbyBtaWVudHJhcyBtb2RpZmljYXMgZWwgdGFtYcOxbywgXFxubWFudMOpbiBwcmVzaW9uYWRvIEFMVCBwYXJhIG1vZGlmaWNhciBlbCB0YW1hw7FvIGRlc2RlIGVsIGNlbnRybyIsInJvdGF0ZSI6IlB1ZWRlIHJlc3RyaW5naXIgbG9zIMOhbmd1bG9zIG1hbnRlbmllbmRvIHByZXNpb25hZG8gU0hJRlQgbWllbnRyYXMgZ2lyYSIsImxpbmVFZGl0b3JfaW5mbyI6ImhhZ2EgZG9ibGUgY2xpYyBvIHB1bHNlIEVudGVyIHBhcmEgZWRpdGFyIHB1bnRvcyIsImxpbmVFZGl0b3JfcG9pbnRTZWxlY3RlZCI6IlByZXNpb25lIFN1cHJpbWlyIHBhcmEgZWxpbWluYXIgZWwgcHVudG8sIEN0cmxPckNtZCtEIHBhcmEgZHVwbGljYXJsbywgbyBhcnLDoXN0cmVsbyBwYXJhIG1vdmVybG8iLCJsaW5lRWRpdG9yX25vdGhpbmdTZWxlY3RlZCI6IlNlbGVjY2lvbmUgdW4gcHVudG8gcGFyYSBtb3ZlciBvIGVsaW1pbmFyLCBvIG1hbnRlbmdhIHB1bHNhZG8gQWx0IHkgaGFnYSBjbGljIHBhcmEgYcOxYWRpciBudWV2b3MgcHVudG9zIn0sImVycm9yU3BsYXNoIjp7ImhlYWRpbmdNYWluX3ByZSI6IlNlIGVuY29udHLDsyB1biBlcnJvci4gSW50ZW50ZSAiLCJoZWFkaW5nTWFpbl9idXR0b24iOiJyZWNhcmdhbmRvIGxhIHDDoWdpbmEuIiwiY2xlYXJDYW52YXNNZXNzYWdlIjoiU2kgbGEgcmVjYXJnYSBubyBmdW5jaW9uYSwgaW50ZW50ZSAiLCJjbGVhckNhbnZhc01lc3NhZ2VfYnV0dG9uIjoibGltcGlhbmRvIGVsIGxpZW56by4iLCJjbGVhckNhbnZhc0NhdmVhdCI6IiBFc3RvIHJlc3VsdGFyw6EgZW4gbGEgcMOpcmRpZGEgZGVsIHRyYWJham8gIiwidHJhY2tlZFRvU2VudHJ5X3ByZSI6IkVsIGVycm9yIGNvbiBlbCBpZGVudGlmaWNhZG9yICIsInRyYWNrZWRUb1NlbnRyeV9wb3N0IjoiIGZ1ZSByYXN0cmVhZG8gZW4gbnVlc3RybyBzaXN0ZW1hLiIsIm9wZW5Jc3N1ZU1lc3NhZ2VfcHJlIjoiRnVpbW9zIG11eSBjYXV0ZWxvc29zIHBhcmEgbm8gaW5jbHVpciBsYSBpbmZvcm1hY2nDs24gZGUgdHUgZXNjZW5hIGVuIGVsIGVycm9yLiBTaSB0dSBlc2NlbmEgbm8gZXMgcHJpdmFkYSwgcG9yIGZhdm9yIGNvbnNpZGVyYSBzZWd1aXIgbnVlc3RybyAiLCJvcGVuSXNzdWVNZXNzYWdlX2J1dHRvbiI6InNlZ3VpbWllbnRvIGRlIGVycm9yZXMuIiwib3Blbklzc3VlTWVzc2FnZV9wb3N0IjoiIFBvciBmYXZvciwgaW5jbHV5YSBsYSBzaWd1aWVudGUgaW5mb3JtYWNpw7NuIGNvcGnDoW5kb2xhIHkgcGVnw6FuZG9sYSBlbiBlbCBpc3N1ZSBkZSBHaXRIdWIuIiwic2NlbmVDb250ZW50IjoiQ29udGVuaWRvIGRlIGxhIGVzY2VuYToifSwicm9vbURpYWxvZyI6eyJkZXNjX2ludHJvIjoiUHVlZGVzIGludml0YXIgYSBnZW50ZSBhIHR1IGVzY2VuYSBhY3R1YWwgcGFyYSBjb2xhYm9yYXIgY29udGlnby4iLCJkZXNjX3ByaXZhY3kiOiJObyB0ZSBwcmVvY3VwZXMsIGxhIHNlc2nDs24gdXNhIGVuY3JpcHRhY2nDs24gZGUgZXh0cmVtbyBhIGV4dHJlbW8sIHBvciBsbyBxdWUgdG9kbyBsbyBxdWUgc2UgZGlidWplIHNlIG1hbnRlbmRyw6EgcHJpdmFkby4gTmkgc2lxdWllcmEgbnVlc3RybyBzZXJ2aWRvciBwb2Ryw6EgdmVyIGxvIHF1ZSBoYWNlcy4iLCJidXR0b25fc3RhcnRTZXNzaW9uIjoiSW5pY2lhciBzZXNpw7NuIiwiYnV0dG9uX3N0b3BTZXNzaW9uIjoiRGV0ZW5lciBzZXNpw7NuIiwiZGVzY19pblByb2dyZXNzSW50cm8iOiJMYSBzZXNpw7NuIGRlIGNvbGFib3JhY2nDs24gZW4gdml2byBlc3TDoSBhaG9yYSBlbiBwcm9ncmVzby4iLCJkZXNjX3BlcnNpc3RlbmNlV2FybmluZyI6IlRlbiBlbiBjdWVudGEgcXVlIGxvcyBkYXRvcyBkZSBsYSBlc2NlbmEgc2UgY29tcGFydGVuIGVudHJlIGxvcyBjb2xhYm9yYWRvcmVzIGRlIGZvcm1hIFAyUCB5IG5vIHNlIGFsbWFjZW5hbiBlbiBudWVzdHJvIHNlcnZpZG9yLiBQb3IgbG8gdGFudG8sIHNpIHRvZG9zIHNlIGRlc2NvbmVjdGFuLCBwZXJkZXLDoXMgbG9zIGRhdG9zIGEgbWVub3MgcXVlIHNlYW4gZXhwb3J0YWRvcyBhIHVuIGFyY2hpdm8gbyB1biBlbmxhY2UgcGFyYSBjb21wYXJ0aXIuIiwiZGVzY19zaGFyZUxpbmsiOiJDb21wYXJ0ZSBlc3RlIGVubGFjZSBjb24gdHVzIGNvbGFib3JhZG9yZXM6IiwiZGVzY19leGl0U2Vzc2lvbiI6IkRldGVuZXIgbGEgc2VzacOzbiB0ZSBkZXNjb25lY3RhcsOhIGRlIGxhIHNhbGEsIHBlcm8gcG9kcsOhcyBzZWd1aXIgdHJhYmFqYW5kbyBjb24gbGEgZXNjZW5hIGxvY2FsbWVudGUuIFRlbiBlbiBjdWVudGEgcXVlIGVzdG8gbm8gYWZlY3RhcsOhIGEgb3RyYXMgcGVyc29uYXMsIHkgcXVlIHNlZ3VpcsOhbiBzaWVuZG8gY2FwYWNlcyBkZSBjb2xhYm9yYXIgZW4gc3UgdmVyc2nDs24uIn0sImVycm9yRGlhbG9nIjp7InRpdGxlIjoiRXJyb3IifSwic2hvcnRjdXRzRGlhbG9nIjp7InRpdGxlIjoiQXRham9zIGRlbCB0ZWNsYWRvIiwic2hhcGVzIjoiRm9ybWFzIiwib3IiOiJvIiwiY2xpY2siOiJoYWNlciBjbGljIiwiZHJhZyI6ImFycmFzdHJhciIsImN1cnZlZEFycm93IjoiRmxlY2hhIGN1cnZhIiwiY3VydmVkTGluZSI6IkzDrW5lYSBjdXJ2YSIsImVkaXRvciI6IkVkaXRvciIsInZpZXciOiJWaXN0YSIsImJsb2ciOiJMZWUgbnVlc3RybyBibG9nIiwiaG93dG8iOiJTaWd1ZSBudWVzdHJhcyBndcOtYXMiLCJnaXRodWIiOiLCv0hhcyBlbmNvbnRyYWRvIHVuIHByb2JsZW1hPyBFbnbDrWFsbyIsInRleHROZXdMaW5lIjoiQcOxYWRpciBudWV2YSBsw61uZWEgKHRleHRvKSIsInRleHRGaW5pc2giOiJGaW5hbGl6YXIgZWRpY2nDs24gKHRleHRvKSIsInpvb21Ub0ZpdCI6IkFqdXN0YXIgcGFyYSBtb3N0cmFyIHRvZG9zIGxvcyBlbGVtZW50b3MifSwiZW5jcnlwdGVkIjp7InRvb2x0aXAiOiJUdXMgZGlidWpvcyBlc3TDoW4gY2lmcmFkb3MgZGUgcHVudG8gYSBwdW50bywgcG9yIGxvIHF1ZSBsb3Mgc2Vydmlkb3JlcyBkZSBFeGNhbGlkcmF3IG51bmNhIGxvcyB2ZXLDoW4uIn0sImNoYXJ0cyI6eyJub051bWVyaWNDb2x1bW4iOiJQZWdhc3RlIHVuYSBob2phIGRlIGPDoWxjdWxvIHNpbiB1bmEgY29sdW1uYSBudW3DqXJpY2EuIiwidG9vTWFueUNvbHVtbnMiOiJQZWdhc3RlIHVuYSBob2phIGRlIGPDoWxjdWxvIGNvbiBtw6FzIGRlIGRvcyBjb2x1bW5hcy4ifX0nKX0sZnVuY3Rpb24oZSl7ZS5leHBvcnRzPUpTT04ucGFyc2UoJ3sibGFiZWxzIjp7InBhc3RlIjoi2KzYp9uMINqv2LDYp9ix24wiLCJzZWxlY3RBbGwiOiLYp9mG2KrYrtin2Kgg2YfZhdmHIiwibXVsdGlTZWxlY3QiOiLbjNqpINin24zYqtmFINio2Ycg2KfZhtiq2K7Yp9ioINi02K/ZhyDZh9inINin2LbYp9mB2Ycg2qnZhtuM2K8uIiwibW92ZUNhbnZhcyI6Itio2YjZhSDYsdinINit2LHaqdiqINio2K/Zh9uM2K8iLCJjb3B5Ijoi2qnZvtuMIiwiY29weUFzUG5nIjoi2qnZvtuMINiv2LEg2K3Yp9mB2LfZhyDZhdmI2YLYqiDYqNmHINi12YjYsdiqIFBORyIsImNvcHlBc1N2ZyI6Itqp2b7bjCDYr9ixINit2KfZgdi32Ycg2YXZiNmC2Kog2KjZhyDYtdmI2LHYqiBTVkciLCJicmluZ0ZvcndhcmQiOiLYrNmE2Ygg2KLZiNix2K/ZhiIsInNlbmRUb0JhY2siOiLZvtizINmB2LHYs9iq2KfYr9mGIiwiYnJpbmdUb0Zyb250Ijoi2KzZhNmIINii2YjYsdiv2YYiLCJzZW5kQmFja3dhcmQiOiLZvtizINmB2LHYs9iq2KfYr9mGIiwiZGVsZXRlIjoi2K3YsNmBIiwiY29weVN0eWxlcyI6Itqp2b7bjCDYp9iz2KrYp9uM2YQiLCJwYXN0ZVN0eWxlcyI6ItqG2LPYqNin2YbYr9mGINin2LPYqtin24zZhCIsInN0cm9rZSI6Itiu2LciLCJiYWNrZ3JvdW5kIjoi2b7YsyDYstmF24zZhtmHIiwiZmlsbCI6Itix2YbaryDYotmF24zYstuMIiwic3Ryb2tlV2lkdGgiOiLYttiu2KfZhdiqINiu2LciLCJzdHJva2VTdHlsZSI6Itin2LPYqtin24zZhCDYrti3Iiwic3Ryb2tlU3R5bGVfc29saWQiOiLbjNqp2K/Ys9iqIiwic3Ryb2tlU3R5bGVfZGFzaGVkIjoi2K7YtyDahtuM2YYiLCJzdHJva2VTdHlsZV9kb3R0ZWQiOiLZhtmC2LfZhyDahtuM2YYiLCJzbG9wcGluZXNzIjoi2K/ZgtiqIiwib3BhY2l0eSI6Itiq2KfYsduMIiwidGV4dEFsaWduIjoi2obbjNiv2YXYp9mGINmF2KrZhiIsImZvbnRTaXplIjoi2KfZhtiv2KfYstmHINmC2YTZhSIsImZvbnRGYW1pbHkiOiLZhtmI2Lkg2YLZhNmFIiwib25seVNlbGVjdGVkIjoi2YHZgti3INin2YbYqtiu2KfYqCDYtNiv2Ycg2YfYpyIsIndpdGhCYWNrZ3JvdW5kIjoi2KjYpyDZvtizINiy2YXbjNmG2YciLCJhZGRXYXRlcm1hcmsiOiJcXCLYs9in2K7YqtmHINi02K/ZhyDYqNinIEV4Y2FsaWRyYXdcXCIg2LHYpyDYp9i22KfZgdmHINqp2YYiLCJoYW5kRHJhd24iOiLYr9iz2Kog2YbZiNuM2LMiLCJub3JtYWwiOiLYudin2K/bjCIsImNvZGUiOiLaqdivIiwic21hbGwiOiLaqdmI2obaqSIsIm1lZGl1bSI6ItmF2KrZiNiz2LciLCJsYXJnZSI6Itio2LLYsdqvIiwidmVyeUxhcmdlIjoi2KjYs9uM2KfYsSDYqNiy2LHaryIsInNvbGlkIjoi2KrZiNm+2LEiLCJoYWNodXJlIjoi2YfYp9i02YjYsSIsImNyb3NzSGF0Y2giOiLZh9in2LTZiNixINmF2KrZgtin2LfYuSIsInRoaW4iOiLZhtin2LLaqSIsImJvbGQiOiLYttiu24zZhSIsImxlZnQiOiLahtm+IiwiY2VudGVyIjoi2YjYs9i3IiwicmlnaHQiOiLYsdin2LPYqiIsImV4dHJhQm9sZCI6Itiu24zZhNuMINi22K7bjNmFIiwiYXJjaGl0ZWN0Ijoi2YXYudmF2KfYsSIsImFydGlzdCI6ItmH2YbYsdmF2YbYryIsImNhcnRvb25pc3QiOiLaqdin2LHYqtmI2YbbjNiz2KoiLCJmaWxlVGl0bGUiOiLYudmG2YjYp9mGINmB2KfbjNmEIiwiY29sb3JQaWNrZXIiOiLYp9mG2KrYrtin2Kjar9ixINix2YbaryIsImNhbnZhc0JhY2tncm91bmQiOiLYqNmI2YUiLCJkcmF3aW5nQ2FudmFzIjoi2KjZiNmFINmG2YLYp9i024wiLCJsYXllcnMiOiLZhNin24zZhyDZh9inIiwiYWN0aW9ucyI6Iti52YXZhNuM2KfYqiIsImxhbmd1YWdlIjoi2LLYqNin2YYiLCJjcmVhdGVSb29tIjoi2KfYtNiq2LHYp9qpINqv2LDYp9ix24wg2KzZhNiz2Ycg2YfZhdqp2KfYsduMINiy2YbYr9mHIiwiZHVwbGljYXRlU2VsZWN0aW9uIjoi2Kraqdix2KfYsSIsInVudGl0bGVkIjoi2KjYr9mI2YYg2LnZhtmI2KfZhiIsIm5hbWUiOiLZhtin2YUiLCJ5b3VyTmFtZSI6ItmG2KfZhSDYtNmF2KciLCJtYWRlV2l0aEV4Y2FsaWRyYXciOiLYs9in2K7YqtmHINi02K/ZhyDYqNinIEV4Y2FsaWRyYXciLCJncm91cCI6Itqv2LHZiNmH2KjZhtiv24wg2KfZhtiq2K7Yp9io2YfYpyIsInVuZ3JvdXAiOiLYrdiw2YEg2q/YsdmI2YfYqNmG2K/bjCDYp9mG2KrYrtin2KjZh9inIiwiY29sbGFib3JhdG9ycyI6ItmH2YXaqdin2LHYp9mGIiwidG9nZ2xlR3JpZE1vZGUiOiLYs9mI2YrahiDYrti32YjYtyDYsdin2YfZhtmF2KciLCJhZGRUb0xpYnJhcnkiOiIiLCJyZW1vdmVGcm9tTGlicmFyeSI6IiIsImxpYnJhcnlMb2FkaW5nTWVzc2FnZSI6IiJ9LCJidXR0b25zIjp7ImNsZWFyUmVzZXQiOiLZvtin2qnYs9in2LLbjCDYqNmI2YUg2YbZgtin2LTbjCIsImV4cG9ydCI6Itiq2KjYr9uM2YQiLCJleHBvcnRUb1BuZyI6Itiq2KjYr9uM2YQg2KjZhyBQTkciLCJleHBvcnRUb1N2ZyI6Itiq2KjYr9uM2YQg2KjZhyBTVkciLCJjb3B5VG9DbGlwYm9hcmQiOiLaqdm+24wg2K/YsSDYrdin2YHYuNmHINmF2YjZgtiqIiwiY29weVBuZ1RvQ2xpcGJvYXJkIjoi2qnZvtuMIFBORyDYr9ixINit2KfZgdi42Ycg2YXZiNmC2KoiLCJzYXZlIjoi2LDYrtuM2LHZhyIsInNhdmVBcyI6Itiw2K7bjNix2Ycg2KjYpyDZhtin2YUiLCJsb2FkIjoi2KjYp9ix2q/YsNin2LHbjCIsImdldFNoYXJlYWJsZUxpbmsiOiLYr9ix24zYp9mB2Kog2YTbjNmG2qkg2YLYp9io2YQg2KfYtNiq2LHYp9qpIiwiY2xvc2UiOiLYqNiz2KrZhiIsInNlbGVjdExhbmd1YWdlIjoi2KfZhtiq2K7Yp9ioINiy2KjYp9mGIiwic2Nyb2xsQmFja1RvQ29udGVudCI6Itio2Ycg2YXYrdiq2YjYpyDYqNix2YjbjNivIiwiem9vbUluIjoi2KjYstix2q8g2YbZhdin24zbjCIsInpvb21PdXQiOiLaqdmI2obaqSDZhtmF2KfbjNuMIiwicmVzZXRab29tIjoi2KfZhtiv2KfYstmHINin2LXZhNuMIiwibWVudSI6ItmB2YfYsdiz2KoiLCJkb25lIjoi2KfZhtis2KfZhSDYtNivIiwiZWRpdCI6ItmI24zYsdin24zYtCIsInVuZG8iOiLYqNin2LLar9ix2K8iLCJyZWRvIjoi2KfYsiDYs9ixIiwicm9vbURpYWxvZyI6ItmH2YXaqdin2LHbjCDYotmG2YTYp9uM2YYg2LHYpyDYtNix2YjYuSDaqdmG24zYryIsImNyZWF0ZU5ld1Jvb20iOiLYp9uM2KzYp9ivINuM2qkg2KfYqtin2YIg2KzYr9uM2K8iLCJ0b2dnbGVGdWxsU2NyZWVuIjoi2KrYutuM24zYsSDYqNmHINit2KfZhNiqINiq2YXYp9mFINi12YHYrdmHIiwidG9nZ2xlWmVuTW9kZSI6Itiq2LrbjNuM2LEg2KjZhyDYrdin2YTYqiDYqtmF2LHaqdiyIiwiZXhpdFplbk1vZGUiOiLYrtix2YjYrCDYp9iyINit2KfZhNiqINiq2YXYsdqp2LIifSwiYWxlcnRzIjp7ImNsZWFyUmVzZXQiOiLYp9uM2YYg2qnYp9ixINqp2YQg2LXZgdit2Ycg2LHYpyDZvtin2qkg2YXbjNqp2YbYry4g2KLbjNinINmF2LfZhdim2YbbjNiv2J8iLCJjb3VsZE5vdENyZWF0ZVNoYXJlYWJsZUxpbmsiOiLYudiv2YUg2KrZiNin2YbYp9uM24wg2K/YsSDYs9in2K7YqiDbjNqpINmE24zZhtqpINmC2KfYqNmEINin2LTYqtix2KfaqS4iLCJjb3VsZE5vdExvYWRJbnZhbGlkRmlsZSI6Iti52K/ZhSDYqtmI2KfZhtin24zbjCDYr9ixINio2KfYstqv2LDYp9ix24wg2YHYp9uM2YQg2YbYp9mF2LnYqtio2LEiLCJpbXBvcnRCYWNrZW5kRmFpbGVkIjoi2KjYp9ix2q/bjNix24wg2KfYsiDZvti02Kog2LXYrdmG2Ycg2KjYpyDYtNqp2LPYqiDZhdmI2KfYrNmHINi02K8uIiwiY2Fubm90RXhwb3J0RW1wdHlDYW52YXMiOiLYqNmI2YUg2K7Yp9mE24wg2YLYp9io2YQg2KrYqNiv24zZhCDZhtuM2LPYqi4iLCJjb3VsZE5vdENvcHlUb0NsaXBib2FyZCI6Itqp2b7bjCDZhti02K8uINin2LIg2YXYsdmI2LHar9ixIENocm9tZSDYp9iz2KrZgdin2K/ZhyDaqdmG24zYry4iLCJkZWNyeXB0RmFpbGVkIjoi2LHZhdiy2q/YtNin24zbjCDYr9in2K/ZhyDZh9inINin2YXaqdin2YYg2b7YsNuM2LEg2YbbjNiz2KouIiwidXBsb2FkZWRTZWN1cmx5Ijoi2KLZvtmE2YjYryDYqNinINix2YXYstqv2LDYp9ix24wg2K/ZiCDYt9ix2YHZhyDYp9mG2KzYp9mFINmF24zYtNmI2K/YjCDYqNmHINin24zZhiDZhdi52YbbjCDaqdmHINiz2LHZiNixIEV4Y2FsaWRyYXcg2Ygg2KfYtNiu2KfYtSDYq9in2YTYqyDZhtmF24wg2KrZiNin2YbZhtivINmF2LfYp9mE2Kgg2LTZhdinINix2Kcg2KjYrtmI2KfZhtmG2K8uIiwibG9hZFNjZW5lT3ZlcnJpZGVQcm9tcHQiOiLYqNin2LHar9iy2KfYsduMINuM2qkg2LfYsditINiu2KfYsdis24wg2YXYrdiq2YjYp9uMINmB2LnZhNuMINix2Ygg2KfYsiDYqNuM2YYg2YXbjNio2LHYry4g2KLbjNinINmF24zYrtmI2KfZh9uM2K8g2KfYr9in2YXZhyDYr9mH24zYr9ifIn0sInRvb2xCYXIiOnsic2VsZWN0aW9uIjoi2q/YstuM2YbYtCIsImRyYXciOiLYt9ix2KfYrduMINii2LLYp9ivIiwicmVjdGFuZ2xlIjoi2YXYs9iq2LfbjNmEIiwiZGlhbW9uZCI6ItmE2YjYstuMIiwiZWxsaXBzZSI6Itio24zYttuMIiwiYXJyb3ciOiLZvtuM2qnYp9mGIiwibGluZSI6Itiu2LciLCJ0ZXh0Ijoi2YXYqtmGIiwibGlicmFyeSI6IiIsImxvY2siOiLYp9io2LLYp9ixINin2YbYqtiu2KfYqCDYtNiv2Ycg2LHYpyDYqNi52K8g2KfYsiDaqdi024zYr9mGINmG2q/ZhyDYr9in2LEifSwiaGVhZGluZ3MiOnsiY2FudmFzQWN0aW9ucyI6Iti52YXZhNuM2KfYqiDYsdmI24wg2KjZiNmFIiwic2VsZWN0ZWRTaGFwZUFjdGlvbnMiOiLYudmF2YTbjNin2Kog2LHZiNuMINi02qnZhCDYp9mG2KrYrtin2Kgg2LTYr9mHIiwic2hhcGVzIjoi2LTaqdmE4oCM2YfYpyJ9LCJoaW50cyI6eyJsaW5lYXJFbGVtZW50Ijoi2KjYsdin24wg2obZhtivINmG2YLYt9mHINqp2YTbjNqpINmIINio2LHYp9uMINuM2qkg2K7YtyDYqNqp2LTbjNivIiwiZnJlZURyYXciOiLaqdmE24zaqSDaqdmG24zYryDZiCDYqNqp2LTbjNivINmIINmI2YLYqtuMINqp2KfYsSDYqtmF2KfZhSDYtNivINix2YfYpyDaqdmG24zYryIsImxpbmVhckVsZW1lbnRNdWx0aSI6Itix2YjbjCDYotiu2LHbjNmGINmG2YLYt9mHINqp2YTbjNqpINqp2YbbjNivINuM2Kcg2qnZhNuM2K8gRVNDINix2Kcg2KjYstmG24zYryDbjNinINqp2YTbjNivIEVudGVyINix2Kcg2KjYstmG24zYryDYqNix2KfbjCDYp9iq2YXYp9mFINqp2KfYsSIsInJlc2l6ZSI6ItmF24wg2KrZiNin2YbbjNivINio2Kcg2Ybar9mHINiv2KfYtNiq2YYgU0hJRlQg2K/YsSDZh9mG2q/Yp9mFINiq2LrbjNuM2LEg2KfZhtiv2KfYstmH2Iwg2YbYs9io2Kog2YfYpyDYsdinINmF2K3Yr9mI2K8g2qnZhtuM2K/YjEFMVCDYsdinINio2LHYp9uMINiq2LrbjNuM2LEg2KfZhtiv2KfYstmHINin2LIg2YXYsdqp2LIg2Ybar9mHINiv2KfYsduM2K8iLCJyb3RhdGUiOiLYqNinINmG2q/ZhyDYr9in2LTYqtmGIFNISUZUINmH2Ybar9in2YUg2obYsdiu2LQg2YXbjCDYqtmI2KfZhtuM2K8g2LLYp9mI24zZhyDZh9inINix2Kcg2YXYrdiv2YjYryDaqdmG24zYryIsImxpbmVFZGl0b3JfaW5mbyI6Itiv2YjYqNin2LEg2qnZhNuM2qkg2qnZhtuM2K8g24zYpyBFbnRlciDYsdinINmB2LTYp9ixINiv2YfbjNivINiq2Kcg2YbZgtin2Lcg2LHYpyDZiNuM2LHYp9uM2LQg2qnZhtuM2K8iLCJsaW5lRWRpdG9yX3BvaW50U2VsZWN0ZWQiOiLYqNix2KfbjCDYrdiw2YEg2YbZgti32YcgRGVsZXRlINio2LHYp9uMINqp2b7bjCDYstiv2YYgQ3RybCDbjNinIENtZCtEINix2Kcg2KjYstmG24zYryDZiCDbjNinINio2LHYp9uMINis2KfYqNis2KfbjNuMINio2qnYtNuM2K8uIiwibGluZUVkaXRvcl9ub3RoaW5nU2VsZWN0ZWQiOiLbjNqpINmG2YLYt9mHINix2Kcg2KjYsdin24wg2KzYp9io2KzYp9uM24wg24zYpyDYrdiw2YEg2KfZhtiq2K7Yp9ioINqp2YbbjNivINuM2Kcg2qnZhNuM2K8gQWx0INio2q/bjNix24zYryDZiCDaqdmE24zaqSDaqdmG24zYryDYqtinINio2KrZiNin2YbbjNivINuM2qkg2YbZgti32Ycg2KzYr9uM2K8g2KfYttin2YHZhyDaqdmG24zYryJ9LCJlcnJvclNwbGFzaCI6eyJoZWFkaW5nTWFpbl9wcmUiOiLYqNinINmF2LTaqdmE24wg2YXZiNin2KzZhyDYtNiv24zZhS4g2KfbjNmGINix2Kcg2KfZhdiq2K3Yp9mGINqp2YbbjNivICIsImhlYWRpbmdNYWluX2J1dHRvbiI6Itiv2LEg2K3Yp9mEINio2KfYstmG2LTYp9mG24wg2LXZgdit2YcuIiwiY2xlYXJDYW52YXNNZXNzYWdlIjoi2Kfar9ixINio2KfYstmG2LTYp9mG24wg2LXZgdit2Ycg2YXYtNqp2YQg2LHYpyDYrdmEINmG2qnYsdivINin24zZhiDYsdinINin2YXYqtit2KfZhiDaqdmG24zYryAiLCJjbGVhckNhbnZhc01lc3NhZ2VfYnV0dG9uIjoi2K/YsSDYrdin2YQg2KrZhduM2LIg2qnYsdiv2YYg2KjZiNmFIiwiY2xlYXJDYW52YXNDYXZlYXQiOiIg2KfbjNmGINio2KfYudirINmF24zYtNmI2K8g2qnYp9ix2YfYp9uMINi02YXYpyDYp9iyINio24zZhiDYqNix2YjYryAiLCJ0cmFja2VkVG9TZW50cnlfcHJlIjoi2K7Yt9inINiv2LEg2LTZhtin2LPZhyAiLCJ0cmFja2VkVG9TZW50cnlfcG9zdCI6IiDYr9ixINiz24zYs9iq2YUg2YXYpyDYsdmH2q/bjNix24wg2LTYry4iLCJvcGVuSXNzdWVNZXNzYWdlX3ByZSI6ItmF2Kcg2K7bjNmE24wg2YXYrdiq2KfYtyDZh9iz2KrbjNmFINqp2Ycg2KfYt9mE2KfYudin2Kog2LTZhdinINix2Kcg2K/YsSDYrti32Kcg2YLYsdin2LEg2YbYr9mH24zZhS4g2KjYpyDYp9uM2YYg2K3Yp9mEINin2q/YsSDYp9i32YTYp9i52KfYqiDYtNmF2Kcg2K7YtdmI2LXbjCDZhtuM2LPYqiDZhNi32YHYpyDZvtuM2q/bjNix24wg2qnZhtuM2K8gIiwib3Blbklzc3VlTWVzc2FnZV9idXR0b24iOiLZvtuM2q/bjNix24wg2KfYtNqp2KfZhNin2KouIiwib3Blbklzc3VlTWVzc2FnZV9wb3N0IjoiINmE2LfZgdinINin2LfZhNin2LnYp9iqINiy24zYsSDYsdinINio2Kcg2qnZvtuMINqp2LHYr9mGINiv2LEg2LXZgdit2Ycg2YXYtNqp2YTYp9iqIEdpdEh1YiDYqNqv2LDYp9ix24zYry4iLCJzY2VuZUNvbnRlbnQiOiLZhdit2KrZiNin24wg2LXYrdmG2Yc6In0sInJvb21EaWFsb2ciOnsiZGVzY19pbnRybyI6ItmF24wg2KrZiNin2YbbjNivINin2YHYsdin2K/bjCDYsdinINio2Ycg2LXYrdmG2Ycg2YHYudmE24wg2K7ZiNivINiv2LnZiNiqINqp2YbbjNivINiq2Kcg2KjYpyDYtNmF2Kcg2YfZhdqp2KfYsduMINqp2YbZhtivLiIsImRlc2NfcHJpdmFjeSI6ItmG2q/Ysdin2YYg2YbYqNin2LTbjNiv2Iwg2KfbjNmGINis2YTYs9mHINin2LIg2LHZhdiy2q/YsNin2LHbjCDYr9mI2LfYsdmB2Ycg2KfYs9iq2YHYp9iv2Ycg2YXbjCDaqdmG2K/YjCDZvtizINmH2LEg2obbjNiy24wg2Kjaqdi024zYryDYrti12YjYtduMINiu2YjYp9mH2K8g2YXYp9mG2K8uINit2KrbjCDYs9ix2YjYsSDZhdinINmG2YXbjNiq2YjYp9mG2K8g2KjYqNuM2YbYryDahtuM2LLbjCDaqdmHINi02YXYpyDYt9ix2KfYrduMINmF24zaqdmG24zYry4iLCJidXR0b25fc3RhcnRTZXNzaW9uIjoi2LTYsdmI2Lkg2KzZhNiz2YciLCJidXR0b25fc3RvcFNlc3Npb24iOiLZvtin24zYp9mGINis2YTYs9mHIiwiZGVzY19pblByb2dyZXNzSW50cm8iOiLYrNmE2LPZhyDZh9mF2qnYp9ix24wg2KLZhtmE2KfbjNmGINiv2LEg2K3Yp9mEINin2YbYrNin2YUg2KfYs9iqLiIsImRlc2NfcGVyc2lzdGVuY2VXYXJuaW5nIjoi2KrZiNis2Ycg2K/Yp9i02KrZhyDYqNin2LTbjNivINqp2Ycg2K/Yp9iv2Ycg2YfYp9uMINix2YjbjCDYqNmI2YUg2KjZhyDYtdmI2LHYqiBQMlAg2KjbjNmGINmH2YXaqdin2LHYp9mGINio2Ycg2KfYtNiq2LHYp9qpINqv2LDYp9i02KrZhyDZhduMINi02YjZhtivINmIINiv2LEg2LPYsdmI2LEg2YXYpyDZh9mF2obZhtin2YYg2YbZhduMINmF2KfZhtivLiDZvtiz2Iwg2Kfar9ixINin2LHYqtio2KfYtyDYtNmF2Kcg2YLYt9i5INi02YjYr9iMINiv2KfYr9mHINmH2Kcg2LHYpyDYp9iyINiv2LPYqiDYrtmI2KfZh9uM2K8g2K/Yp9ivINmF2q/YsSDYp9uM2YbaqdmHINii2YbZh9inINix2Kcg2KjZhyDbjNqpINmB2KfbjNmEINuM2Kcg24zaqSDZhNuM2YbaqSDZgtin2KjZhCDYp9i02KrYsdin2qkg2KrYqNiv24zZhCDaqdmG24zYry4iLCJkZXNjX3NoYXJlTGluayI6Itin24zZhiDZhNuM2YbaqSDYsdinINio2Kcg2YfYsSDaqdiz24wg2qnZhyDZhduMINiu2YjYp9mH24zYryDYqNinINin2Ygg2YfZhdqp2KfYsduMINqp2YbbjNivINio2Ycg2KfYtNiq2LHYp9qpINio2q/YsNin2LHbjNivOiIsImRlc2NfZXhpdFNlc3Npb24iOiLYqNinINm+2KfbjNin2YYg2K/Yp9iv2YYg2KzZhNiz2YfYjCDYtNmF2Kcg2KfYsiDYp9iq2KfZgiDYrdiw2YEg2YXbjNqp2YbYr9iMINin2YXYpyDZhduMINiq2YjYp9mG24zYryDYqNmHINi12YjYsdiqINmF2K3ZhNuMINqp2KfYsSDYrtmI2K8g2LHYpyDYqNinINio2YjZhSDYp9iv2KfZhdmHINiv2YfbjNivLiDYqtmI2KzZhyDYr9in2LTYqtmHINio2KfYtNuM2K8g2qnZhyDYp9uM2YYg2YXZiNix2K8g2KjYsSDYs9in24zYsSDYp9mB2LHYp9ivINiq2KPYq9uM2LEg2YbZhduMINqv2LDYp9ix2K8g2Ygg2YfZhdqG2YbYp9mGINmF24wg2KrZiNin2YbZhtivINiv2LEg2YbYs9iu2Ycg2K7ZiNivINmH2YXaqdin2LHbjCDaqdmG2YbYry4ifSwiZXJyb3JEaWFsb2ciOnsidGl0bGUiOiLYrti32KcifSwic2hvcnRjdXRzRGlhbG9nIjp7InRpdGxlIjoi2YXbjNin2YbYqNix2YfYp9uMINi12YHYrdmHINqp2YTbjNivIiwic2hhcGVzIjoi2LTaqdmE4oCM2YfYpyIsIm9yIjoi24zYpyIsImNsaWNrIjoi2qnZhNuM2qkiLCJkcmFnIjoi2qnYtNuM2K/ZhiIsImN1cnZlZEFycm93Ijoi2YHZhNi0INiu2YXbjNiv2YciLCJjdXJ2ZWRMaW5lIjoi2YXZhtit2YbbjCIsImVkaXRvciI6ItmI24zYsdin24zYtNqv2LEiLCJ2aWV3Ijoi2YbZhdin24zYtCIsImJsb2ciOiLYqNmE2KfaryDZhdinINix2Kcg2KjYrtmI2KfZhtuM2K8iLCJob3d0byI6Itix2KfZh9mG2YXYp9uMINmF2Kcg2LHYpyDYr9mG2KjYp9mEINqp2YbbjNivIiwiZ2l0aHViIjoi2KfYtNqp2KfZhNuMINmF24wg2KjbjNmG24zYr9ifINqv2LLYp9ix2LQg2K/Zh9uM2K8iLCJ0ZXh0TmV3TGluZSI6ItuM2qkg2K7YtyDYrNiv24zYryDYp9i22KfZgdmHINqp2YbbjNivICjZhdiq2YYpIiwidGV4dEZpbmlzaCI6Itm+2KfbjNin2YYg2YjbjNix2KfbjNi0ICjZhdiq2YYpIiwiem9vbVRvRml0Ijoi2KjYstix2q/ZhtmF2KfbjNuMINio2LHYp9uMINiv24zYr9mGINiq2YXYp9mFINii24zYqtmFINmH2KcifSwiZW5jcnlwdGVkIjp7InRvb2x0aXAiOiLYtNmF2Kcg2K/YsSDbjNqpINmF2K3bjNi3INix2YXYstqv2LLYp9ix24wg2LTYr9mHINiv2Ygg2LfYsdmB2Ycg2K/YsSDYrdin2YQg2LfYsdin2K3bjCDZh9iz2KrbjNivINm+2LMgRXhjYWxpZHJhdyDZh9ix2q/YsiDYt9ix2K0g2YfYp9uMINi02YXYpyDYsdinINmG2YXbjNio2YbYry4ifSwiY2hhcnRzIjp7Im5vTnVtZXJpY0NvbHVtbiI6Iti02YXYpyDbjNqpINi12YHYrdmHINqv2LPYqtix2K/ZhyDYsdinINio2K/ZiNmGINiz2KrZiNmGINi52K/Yr9uMINqp2b7bjCDaqdix2K/ZhyDYp9uM2K8uIiwidG9vTWFueUNvbHVtbnMiOiLYtNmF2Kcg24zaqSDYtdmB2K3ZhyDar9iz2KrYsdiv2Ycg2LHYpyDYqNinINio24zYtCDYp9iyINiv2Ygg2LPYqtmI2YYg2qnZvtuMINqp2LHYr9mHINin24zYry4ifX0nKX0sZnVuY3Rpb24oZSl7ZS5leHBvcnRzPUpTT04ucGFyc2UoJ3sibGFiZWxzIjp7InBhc3RlIjoiTGlpdMOkIiwic2VsZWN0QWxsIjoiVmFsaXRzZSBrYWlra2kiLCJtdWx0aVNlbGVjdCI6Ikxpc8Okw6Qga29oZGUgdmFsaW50YWFuIiwibW92ZUNhbnZhcyI6IlNpaXJyw6QgcGlpcnRvYWx1ZXR0YSIsImNvcHkiOiJLb3Bpb2kiLCJjb3B5QXNQbmciOiJLb3Bpb2kgbGVpa2Vww7Z5ZMOkbGxlIFBORy10aWVkb3N0b25hIiwiY29weUFzU3ZnIjoiS29waW9pIGxlaWtlcMO2eWTDpGxsZSBTVkctdGllZG9zdG9uYSIsImJyaW5nRm9yd2FyZCI6IlNpaXJyw6QgZXRlZW5ww6RpbiIsInNlbmRUb0JhY2siOiJWaWUgdGFha3NlIiwiYnJpbmdUb0Zyb250IjoiVHVvIGV0ZWVuIiwic2VuZEJhY2t3YXJkIjoiU2lpcnLDpCB0YWFrc2Vww6RpbiIsImRlbGV0ZSI6IlBvaXN0YSIsImNvcHlTdHlsZXMiOiJLb3Bpb2kgdHl5bGkiLCJwYXN0ZVN0eWxlcyI6IkxpaXTDpCB0eXlsaSIsInN0cm9rZSI6IlBpaXJ0byIsImJhY2tncm91bmQiOiJUYXVzdGEiLCJmaWxsIjoiVMOkeXR0w7YiLCJzdHJva2VXaWR0aCI6IlZpaXZhbiBsZXZleXMiLCJzdHJva2VTdHlsZSI6IlZpaXZhbiB0eXlsaSIsInN0cm9rZVN0eWxlX3NvbGlkIjoiWWh0ZW7DpGluZW4iLCJzdHJva2VTdHlsZV9kYXNoZWQiOiJLYXRrb3ZpaXZhIiwic3Ryb2tlU3R5bGVfZG90dGVkIjoiUGlzdGV2aWl2YSIsInNsb3BwaW5lc3MiOiJWaWl2YW4gdGFya2t1dXMiLCJvcGFjaXR5IjoiUGVpdHTDpHZ5eXMiLCJ0ZXh0QWxpZ24iOiJUZWtzdGluIHRhc2F1cyIsImZvbnRTaXplIjoiS2lyamFzaW5rb2tvIiwiZm9udEZhbWlseSI6Iktpcmphc2ludHl5cHBpIiwib25seVNlbGVjdGVkIjoiVmFpbiB2YWxpdHV0Iiwid2l0aEJhY2tncm91bmQiOiJTaXPDpGxseXTDpCB0YXVzdGEiLCJhZGRXYXRlcm1hcmsiOiJMaXPDpMOkIFxcIlRlaHR5IEV4Y2FsaWRyYXdpbGxhXFwiIiwiaGFuZERyYXduIjoiS8Okc2lua2lyam9pdGV0dHUiLCJub3JtYWwiOiJUYXZhbGxpbmVuIiwiY29kZSI6Iktvb2RpIiwic21hbGwiOiJQaWVuaSIsIm1lZGl1bSI6Iktlc2tpa29rbyIsImxhcmdlIjoiU3V1cmkiLCJ2ZXJ5TGFyZ2UiOiJFcml0dMOkaW4gc3V1cmkiLCJzb2xpZCI6IllodGVuw6RpbmVuIiwiaGFjaHVyZSI6IlZpbm92aWl2b2l0dXMiLCJjcm9zc0hhdGNoIjoiUmlzdGl2aWl2b2l0dXMiLCJ0aGluIjoiT2h1dCIsImJvbGQiOiJMaWhhdm9pdHUiLCJsZWZ0IjoiVmFzZW4iLCJjZW50ZXIiOiJLZXNraXTDpCIsInJpZ2h0IjoiT2lrZWEiLCJleHRyYUJvbGQiOiJFcml0dMOkaW4gbGloYXZvaXR1IiwiYXJjaGl0ZWN0IjoiQXJra2l0ZWh0aSIsImFydGlzdCI6IlRhaXRlaWxpamEiLCJjYXJ0b29uaXN0IjoiU2FyamFrdXZhIiwiZmlsZVRpdGxlIjoiVGllZG9zdG9uaW1pIiwiY29sb3JQaWNrZXIiOiJWw6RyaW4gdmFsaW50YSIsImNhbnZhc0JhY2tncm91bmQiOiJQaWlydG9hbHVlZW4gdGF1c3RhIiwiZHJhd2luZ0NhbnZhcyI6IlBpaXJ0b2FsdWUiLCJsYXllcnMiOiJUYXNvdCIsImFjdGlvbnMiOiJUb2ltaW5ub3QiLCJsYW5ndWFnZSI6IktpZWxpIiwiY3JlYXRlUm9vbSI6IkphYSB5aHRlaXN0ecO2aXN0dW50byIsImR1cGxpY2F0ZVNlbGVjdGlvbiI6Ik1vbmlzdGEiLCJ1bnRpdGxlZCI6Ik5pbWV0w7ZuIiwibmFtZSI6Ik5pbWkiLCJ5b3VyTmFtZSI6Ik5pbWVzaSIsIm1hZGVXaXRoRXhjYWxpZHJhdyI6IlRlaHR5IEV4Y2FsaWRyYXdpbGxhIiwiZ3JvdXAiOiJSeWhtaXTDpCB2YWxpbnRhIiwidW5ncm91cCI6IlB1cmEgdmFsaXR0dSByeWhtw6QiLCJjb2xsYWJvcmF0b3JzIjoiWWh0ZWlzdHnDtmt1bXBwYW5pdCIsInRvZ2dsZUdyaWRNb2RlIjoiUnV1ZHVra28gcMOkw6RsbGUvcG9pcyIsImFkZFRvTGlicmFyeSI6Ikxpc8Okw6Qga2lyamFzdG9vbiIsInJlbW92ZUZyb21MaWJyYXJ5IjoiUG9pc3RhIGtpcmphc3Rvc3RhIiwibGlicmFyeUxvYWRpbmdNZXNzYWdlIjoiTGFkYXRhYW4ga2lyamFzdG9hLi4uIn0sImJ1dHRvbnMiOnsiY2xlYXJSZXNldCI6IlR5aGplbm7DpCBwaWlydG9hbHVlIiwiZXhwb3J0IjoiVmllIiwiZXhwb3J0VG9QbmciOiJWaWUgUE5HLXRpZWRvc3RvbmEiLCJleHBvcnRUb1N2ZyI6IlZpZSBTVkctdGllZG9zdG9uYSIsImNvcHlUb0NsaXBib2FyZCI6IktvcGlvaSBsZWlrZXDDtnlkw6RsbGUiLCJjb3B5UG5nVG9DbGlwYm9hcmQiOiJLb3Bpb2kgUE5HLXRpZWRvc3RvIGxlaWtlcMO2eWTDpGxsZSIsInNhdmUiOiJUYWxsZW5uYSIsInNhdmVBcyI6IlRhbGxlbm5hIG5pbWVsbMOkIiwibG9hZCI6IkF2YWEiLCJnZXRTaGFyZWFibGVMaW5rIjoiSGFlIGphZXR0YXZhIGxpbmtraSIsImNsb3NlIjoiU3VsamUiLCJzZWxlY3RMYW5ndWFnZSI6IlZhbGl0c2Uga2llbGkiLCJzY3JvbGxCYWNrVG9Db250ZW50IjoiTsOkeXTDpCBzaXPDpGx0w7YiLCJ6b29tSW4iOiJab29tYWEgc2lzw6TDpG4iLCJ6b29tT3V0IjoiWm9vbWFhIHVsb3MiLCJyZXNldFpvb20iOiJOb2xsYWEgem9vbWF1cyIsIm1lbnUiOiJWYWxpa2tvIiwiZG9uZSI6IlZhbG1pcyIsImVkaXQiOiJNdW9ra2FhIiwidW5kbyI6Ikt1bW9hIiwicmVkbyI6IlRlZSB1dWRlbGxlZW4iLCJyb29tRGlhbG9nIjoiQWxvaXRhIGxpdmUteWh0ZWlzdHnDtiIsImNyZWF0ZU5ld1Jvb20iOiJMdW8gaHVvbmUiLCJ0b2dnbGVGdWxsU2NyZWVuIjoiS29rbyBuw6R5dMO2biB0aWxhIHDDpMOkbGxlL3BvaXMiLCJ0b2dnbGVaZW5Nb2RlIjoiWmVuLXRpbGEgcMOkw6RsbGUiLCJleGl0WmVuTW9kZSI6IlBvaXN0dSB6ZW4tdGlsYXN0YSJ9LCJhbGVydHMiOnsiY2xlYXJSZXNldCI6IlTDpG3DpCB0eWhqZW50w6TDpCBrb2tvIHBpaXJ0b2FsdWVlbi4gSmF0a2V0YWFua28/IiwiY291bGROb3RDcmVhdGVTaGFyZWFibGVMaW5rIjoiSmFldHRhdmFuIGxpbmtpbiBsdW9taW5lbiBlcMOkb25uaXN0dWkuIiwiY291bGROb3RMb2FkSW52YWxpZEZpbGUiOiJWaXJoZWVsbGlzdMOkIHRpZWRvc3RvYSBlaSB2b2l0dSBhdmF0YSIsImltcG9ydEJhY2tlbmRGYWlsZWQiOiJQYWx2ZWxpbWVsdGEgdHVvbnRpIGVww6Rvbm5pc3R1aS4iLCJjYW5ub3RFeHBvcnRFbXB0eUNhbnZhcyI6IlR5aGrDpMOkIHBpaXJ0b2FsdWV0dGEgZWkgdm9pIHZpZWTDpC4iLCJjb3VsZE5vdENvcHlUb0NsaXBib2FyZCI6IkxlaWtlcMO2eWTDpGxsZSBrb3Bpb2ludGkgZXDDpG9ubmlzdHVpLiBLb2tlaWxlIENocm9tZS1zZWxhaW50YS4iLCJkZWNyeXB0RmFpbGVkIjoiU2FsYXVrc2VuIHB1cmthbWluZW4gZXDDpG9ubmlzdHVpLiIsInVwbG9hZGVkU2VjdXJseSI6IkzDpGhldHlzIG9uIHR1cnZhdHR1IHDDpMOkc3TDpCBww6TDpGjDpG4gc2FsYXVrc2VsbGEuIEV4Y2FsaWRyYXdpbiBwYWx2ZWxpbiBqYSBrb2xtYW5uZXQgb3NhcHVvbGV0IGVpdsOkdCB2b2kgbHVrZWEgc2lzw6RsdMO2w6QuIiwibG9hZFNjZW5lT3ZlcnJpZGVQcm9tcHQiOiJVbGtvcHVvbGlzZW4gcGlpcnJva3NlbiBsYXRhYW1pbmVuIGtvcnZhYSBueWt5aXNlbiBzaXPDpGx0w7ZzaS4gSGFsdWF0a28gamF0a2FhPyJ9LCJ0b29sQmFyIjp7InNlbGVjdGlvbiI6IlZhbGludGEiLCJkcmF3IjoiVmFwYWEgcGlpcnRvIiwicmVjdGFuZ2xlIjoiU3VvcmFrdWxtaW8iLCJkaWFtb25kIjoiVmlub25lbGnDtiIsImVsbGlwc2UiOiJTb2lraW8iLCJhcnJvdyI6Ik51b2xpIiwibGluZSI6IlZpaXZhIiwidGV4dCI6IlRla3N0aSIsImxpYnJhcnkiOiJLaXJqYXN0byIsImxvY2siOiJQaWTDpCB2YWxpdHR1IHR5w7ZrYWx1IGFrdGlpdmlzZW5hIHBpaXJyb24gasOkbGtlZW4ifSwiaGVhZGluZ3MiOnsiY2FudmFzQWN0aW9ucyI6IlBpaXJ0b2FsdWVlbiB0b2ltaW5ub3QiLCJzZWxlY3RlZFNoYXBlQWN0aW9ucyI6IlZhbGl0dW4gbXVvZG9uIHRvaW1pbm5vdCIsInNoYXBlcyI6Ik11b2RvdCJ9LCJoaW50cyI6eyJsaW5lYXJFbGVtZW50IjoiS2xpa2thYSBwaWlydMOkw6Rrc2VzaSB1c2VhbXBpIHBpc3RlLCByYWFoYWEgcGlpcnTDpMOka3Nlc2kgeWtzaXR0w6RpbmVuIHZpaXZhIiwiZnJlZURyYXciOiJQYWluYSBqYSByYWFoYWEsIHDDpMOkc3TDpCBpcnRpIGt1biBvbGV0IHZhbG1pcyIsImxpbmVhckVsZW1lbnRNdWx0aSI6IktsaWtrYWEgdmlpbWVpc3TDpCBwaXN0ZXR0w6QsIHBhaW5hIEVzY2FwZSB0YWkgcGFpbmEgRW50ZXIgbG9wZXR0YWFrc2VzaSIsInJlc2l6ZSI6IlZvaXQgcmFqb2l0dGFhIG1pdHRhc3VodGVldCBwaXTDpG3DpGxsw6QgU0hJRlQgcG9oamFzc2Ega3VuIG11dXRhdCBrb2tvYSwgcGlkw6QgQUxUIHBvaGphc3NhIG11dXR0YWFrc2VzaSBrb2tvYSBrZXNraXBpc3RlZW4gc3VodGVlbiIsInJvdGF0ZSI6IlZvaXQgcmFqb2l0dGFhIGt1bG1hbiBwaXTDpG3DpGxsw6QgU0hJRlQgcG9oamFzc2EgcHnDtnJpdHTDpGVzc8Okc2kiLCJsaW5lRWRpdG9yX2luZm8iOiJLYWtzb2lzbmFwYXV0YSB0YWkgcGFpbmEgRW50ZXIgbXVva2F0YWtzZXNpIHBpc3RlaXTDpCIsImxpbmVFZGl0b3JfcG9pbnRTZWxlY3RlZCI6IlBhaW5hIERlbGV0ZSBwb2lzdGFha3Nlc2kgcGlzdGVlbiwgQ3RybE9yQ21kK0QgbW9uaXN0YWFrc2VzaSwgdGFpIHJhYWhhYSBsaWlrdXR0YWFrc2VzaSIsImxpbmVFZGl0b3Jfbm90aGluZ1NlbGVjdGVkIjoiVmFsaXRzZSBsaWlrdXRldHRhdmEgdGFpIHBvaXN0ZXR0YXZhIHBpc3RlLCB0YWkgcGlkw6QgQWx0IHBvaGphc3NhIGphIG5hcGF1dGEgbGlzw6R0w6Rrc2VzaSB1dXNpYSBwaXN0ZWl0w6QifSwiZXJyb3JTcGxhc2giOnsiaGVhZGluZ01haW5fcHJlIjoiVGFwYWh0dWkgdmlyaGUuIFlyaXTDpCAiLCJoZWFkaW5nTWFpbl9idXR0b24iOiJzaXZ1biBsYXRhYW1pc3RhIHV1ZGVsbGVlbi4iLCJjbGVhckNhbnZhc01lc3NhZ2UiOiJKb3MgbGF0YWFtaW5lbiB1dWRlbGxlZW4gZWkgYXV0YSwgeXJpdMOkICIsImNsZWFyQ2FudmFzTWVzc2FnZV9idXR0b24iOiJ0eWhqZW50w6TDpCBwaWlydG9hbHVlLiIsImNsZWFyQ2FudmFzQ2F2ZWF0IjoiIFTDpG3DpCBqb2h0YWEgdHnDtm4gbWVuZXR5a3NlZW4gIiwidHJhY2tlZFRvU2VudHJ5X3ByZSI6IlZpcmhlIHR1bm5pc3RlZWxsYSAiLCJ0cmFja2VkVG9TZW50cnlfcG9zdCI6IiB0YWxsZW5uZXR0aWluIGrDpHJqZXN0ZWxtw6TDpG1tZS4iLCJvcGVuSXNzdWVNZXNzYWdlX3ByZSI6Ik9saW1tZSB2YXJvdmFpc2lhIGVtbWVrw6Qgc2lzw6RsbHl0dMOkbmVldCB0aWV0b2EgcGlpcnJva3Nlc3Rhc2kgdmlyaGVlc2Vlbi4gSm9zIHBpaXJyb2tzZXNpIGVpIG9sZSB5a3NpdHlpbmVuLCBoYXJraXRzZXRoYW4ga2VydG92YXNpIG1laWxsZSAiLCJvcGVuSXNzdWVNZXNzYWdlX2J1dHRvbiI6InZpcmhlZW5zZXVyYW50YWrDpHJqZXN0ZWxtw6Rzc8OkbW1lLiIsIm9wZW5Jc3N1ZU1lc3NhZ2VfcG9zdCI6IiBTaXPDpGxseXTDpCBhbGxhIG9sZXZhdCB0aWVkb3Qga29waW9pbWFsbGEgbmUgR2l0SHViLW9uZ2VsbWFhbi4iLCJzY2VuZUNvbnRlbnQiOiJQaWlycm9rc2VuIHRpZWRvdDoifSwicm9vbURpYWxvZyI6eyJkZXNjX2ludHJvIjoiVm9pdCBrdXRzdWEgaWhtaXNpw6QgcGlpcnJva3NlZXNpIHRla2Vtw6TDpG4geWh0ZWlzdHnDtnTDpCBrYW5zc2FzaS4iLCJkZXNjX3ByaXZhY3kiOiLDhGzDpCBodW9saSwgaXN0dW50byBrw6R5dHTDpMOkIHDDpMOkc3TDpCBww6TDpGjDpG4gc2FsYXVzdGEsIGpvdGVuIG1pdMOkIHRhaGFuc2EgcGlpcnLDpHRraW4sIHNlIHB5c3l5IHNhbGFzc2EuIEVkZXMgcGFsdmVsaW1lbW1lIGVpIG7DpGUgbWl0w6Qga2Vrc2l0LiIsImJ1dHRvbl9zdGFydFNlc3Npb24iOiJBbG9pdGEgaXN0dW50byIsImJ1dHRvbl9zdG9wU2Vzc2lvbiI6IkxvcGV0YSBpc3R1bnRvIiwiZGVzY19pblByb2dyZXNzSW50cm8iOiJKYWV0dHUgaXN0dW50byBvbiBueXQga8OkeW5uaXNzw6QuIiwiZGVzY19wZXJzaXN0ZW5jZVdhcm5pbmciOiJIdW9tYWEsIGV0dMOkIHR5w7ZuIHRpZWRvdCBqYWV0YWFuIG11aWRlbiBtdWlkZW4ga8OkeXR0w6RqaWVuIGtlc2tlbiBQMlAtbWVuZXRlbG3DpGxsw6QsIGVpa8OkIG5paXTDpCB0YWxsZW5uZXRhIHBhbHZlbGltZWxsZW1tZS4gSm9zIGthaWtraSB0ecO2biBrw6R5dHTDpGrDpHQga2F0a2Fpc2V2YXQgeWh0ZXlkZW4sIG1lbmV0w6R0dGUgdHnDtm4sIGVsbGV0dGUgdGFsbGVubmEgc2l0w6QgdGllZG9zdG9rc2kgdGFpIGphZXR0YXZha3NpIGxpbmtpa3NpLiIsImRlc2Nfc2hhcmVMaW5rIjoiSmFhIHTDpG3DpCBsaW5ra2kga2VuZWxsZSB0YWhhbnNhLCBqb25rYSBrYW5zc2EgaGFsdWF0IHRlaGTDpCB5aHRlaXN0ecO2dMOkOiIsImRlc2NfZXhpdFNlc3Npb24iOiJJc3R1bm5vbiBweXPDpHl0dMOkbWluZW4ga2F0a2Fpc2VlIHlodGV5ZGVuIGh1b25lZXNlZW4sIG11dHRhIHZvaXQgdmllbMOkIGphdGthYSB0ecO2c2tlbnRlbHnDpCBwYWlrYWxsaXNlc3RpLiBIdW9tYWEsIGV0dMOkIHTDpG3DpCBlaSB2YWlrdXRhIG11aWhpbiBrw6R5dHTDpGppaW4gamEgaGUgdm9pdmF0IGphdGthYSBvbWFuIHZlcnNpb25zYSBwYXJpc3NhIHR5w7Zza2VudGVsecOkLiJ9LCJlcnJvckRpYWxvZyI6eyJ0aXRsZSI6IlZpcmhlIn0sInNob3J0Y3V0c0RpYWxvZyI6eyJ0aXRsZSI6IlBpa2Fuw6RwcMOkaW1ldCIsInNoYXBlcyI6Ik11b2RvdCIsIm9yIjoidGFpIiwiY2xpY2siOiJrbGlra2FhIiwiZHJhZyI6InZlZMOkIiwiY3VydmVkQXJyb3ciOiJLYWFyZXZhIG51b2xpIiwiY3VydmVkTGluZSI6IkthYXJldmEgdmlpdmEiLCJlZGl0b3IiOiJFZGl0b3JpIiwidmlldyI6Ik7DpGt5bcOkIiwiYmxvZyI6Ikx1ZSBibG9naWFtbWUiLCJob3d0byI6IlNldXJhYSBvcHBhaXRhbW1lIiwiZ2l0aHViIjoiTMO2eXNpdGvDtiBvbmdlbG1hbj8gS2Vycm8gbWVpbGxlIiwidGV4dE5ld0xpbmUiOiJMaXPDpMOkIHV1c2kgcml2aSAodGVrc3RpKSIsInRleHRGaW5pc2giOiJMb3BldGEgbXVva2thdXMgKHRla3N0aSkiLCJ6b29tVG9GaXQiOiJab29tYWEga2Fpa2tpIGVsZW1lbnRpdCBuw6RreXZpaW4ifSwiZW5jcnlwdGVkIjp7InRvb2x0aXAiOiJQaWlycm9rc2VzaSBvdmF0IHDDpMOkc3TDpCBww6TDpGjDpG4gc2FsYXR0dWphLCBqb3RlbiBFeGNhbGlkcmF3aW4gcGFsdmVsaW1ldCBlaXbDpHQga29za2FhbiBuw6RlIG5paXTDpC4ifSwiY2hhcnRzIjp7Im5vTnVtZXJpY0NvbHVtbiI6IkxpaXRpdCB0YXVsdWtvbiBpbG1hbiBsdWt1amEgc2lzw6RsdMOkdsOkw6Qgc2FyYWtldHRhLiIsInRvb01hbnlDb2x1bW5zIjoiTGlpdGl0IHRhdWx1a29uLCBqb3NzYSBvbiBlbmVtbcOkbiBrdWluIGtha3NpIHNhcmFrZXR0YS4ifX0nKX0sZnVuY3Rpb24oZSl7ZS5leHBvcnRzPUpTT04ucGFyc2UoJ3sibGFiZWxzIjp7InBhc3RlIjoiQ29sbGVyIiwic2VsZWN0QWxsIjoiVG91dCBzw6lsZWN0aW9ubmVyIiwibXVsdGlTZWxlY3QiOiJBam91dGVyIGxcJ8OpbMOpbWVudCDDoCBsYSBzw6lsZWN0aW9uIiwibW92ZUNhbnZhcyI6IkTDqXBsYWNlciBsZSBjYW5ldmFzIiwiY29weSI6IkNvcGllciIsImNvcHlBc1BuZyI6IkNvcGllciBkYW5zIGxlIHByZXNzZS1wYXBpZXIgZW4gUE5HIiwiY29weUFzU3ZnIjoiQ29waWVyIGRhbnMgbGUgcHJlc3NlLXBhcGllciBlbiBTVkciLCJicmluZ0ZvcndhcmQiOiJFbnZveWVyIHZlcnMgbFwnYXZhbnQiLCJzZW5kVG9CYWNrIjoiTWV0dHJlIGVuIGFycmnDqHJlLXBsYW4iLCJicmluZ1RvRnJvbnQiOiJNZXR0cmUgYXUgcHJlbWllciBwbGFuIiwic2VuZEJhY2t3YXJkIjoiRW52b3llciB2ZXJzIGxcJ2FycmnDqHJlIiwiZGVsZXRlIjoiU3VwcHJpbWVyIiwiY29weVN0eWxlcyI6IkNvcGllciBsZXMgc3R5bGVzIiwicGFzdGVTdHlsZXMiOiJDb2xsZXIgbGVzIHN0eWxlcyIsInN0cm9rZSI6IkNvbnRvdXIiLCJiYWNrZ3JvdW5kIjoiQXJyacOocmUtcGxhbiIsImZpbGwiOiJSZW1wbGlzc2FnZSIsInN0cm9rZVdpZHRoIjoiTGFyZ2V1ciBkdSBjb250b3VyIiwic3Ryb2tlU3R5bGUiOiJTdHlsZSBkdSB0cmFpdCIsInN0cm9rZVN0eWxlX3NvbGlkIjoiUGxlaW4iLCJzdHJva2VTdHlsZV9kYXNoZWQiOiJUaXJldHMiLCJzdHJva2VTdHlsZV9kb3R0ZWQiOiJQb2ludGlsbMOpIiwic2xvcHBpbmVzcyI6IlN0eWxlIGRlIHRyYWPDqSIsIm9wYWNpdHkiOiJPcGFjaXTDqSIsInRleHRBbGlnbiI6IkFsaWduZW1lbnQgZHUgdGV4dGUiLCJmb250U2l6ZSI6IlRhaWxsZSBkZSBsYSBwb2xpY2UiLCJmb250RmFtaWx5IjoiUG9saWNlIiwib25seVNlbGVjdGVkIjoiVW5pcXVlbWVudCBsYSBzw6lsZWN0aW9uIiwid2l0aEJhY2tncm91bmQiOiJBdmVjIGFycmnDqHJlLXBsYW4iLCJhZGRXYXRlcm1hcmsiOiJBam91dGVyIFxcIkZhYnJpcXXDqSBhdmVjIEV4Y2FsaWRyYXdcXCIiLCJoYW5kRHJhd24iOiJNYW51c2NyaXRlIiwibm9ybWFsIjoiTm9ybWFsZSIsImNvZGUiOiJDb2RlIiwic21hbGwiOiJQZXRpdCIsIm1lZGl1bSI6Ik1veWVuIiwibGFyZ2UiOiJHcmFuZCIsInZlcnlMYXJnZSI6IlRyw6hzIGdyYW5kIiwic29saWQiOiJTb2xpZGUiLCJoYWNodXJlIjoiSGFjaHVyZSIsImNyb3NzSGF0Y2giOiJIYWNodXJlIGNyb2lzw6llIiwidGhpbiI6IkZpbiIsImJvbGQiOiLDiXBhaXMiLCJsZWZ0IjoiR2F1Y2hlIiwiY2VudGVyIjoiQ2VudHJlIiwicmlnaHQiOiJEcm9pdGUiLCJleHRyYUJvbGQiOiJUcsOocyDDqXBhaXMiLCJhcmNoaXRlY3QiOiJBcmNoaXRlY3RlIiwiYXJ0aXN0IjoiQXJ0aXN0ZSIsImNhcnRvb25pc3QiOiJDYXJpY2F0dXJpc3RlIiwiZmlsZVRpdGxlIjoiVGl0cmUgZHUgZmljaGllciIsImNvbG9yUGlja2VyIjoiU8OpbGVjdGV1ciBkZSBjb3VsZXVyIiwiY2FudmFzQmFja2dyb3VuZCI6IkZvbmQgZHUgY2FuZXZhcyIsImRyYXdpbmdDYW52YXMiOiJDYW5ldmFzIGRlIGRlc3NpbiIsImxheWVycyI6IkNhbHF1ZXMiLCJhY3Rpb25zIjoiQWN0aW9ucyIsImxhbmd1YWdlIjoiTGFuZ3VlIiwiY3JlYXRlUm9vbSI6IlBhcnRhZ2VyIHVuZSBzZXNzaW9uIGRlIGNvbGxhYm9yYXRpb24gZW4gZGlyZWN0IiwiZHVwbGljYXRlU2VsZWN0aW9uIjoiRHVwbGlxdWVyIiwidW50aXRsZWQiOiJTYW5zIHRpdHJlIiwibmFtZSI6Ik5vbSIsInlvdXJOYW1lIjoiVm90cmUgbm9tIiwibWFkZVdpdGhFeGNhbGlkcmF3IjoiRmFicmlxdcOpIGF2ZWMgRXhjYWxpZHJhdyIsImdyb3VwIjoiR3JvdXBlciBsYSBzw6lsZWN0aW9uIiwidW5ncm91cCI6IkTDqWdyb3VwZXIgbGEgc8OpbGVjdGlvbiIsImNvbGxhYm9yYXRvcnMiOiJDb2xsYWJvcmF0ZXVycyIsInRvZ2dsZUdyaWRNb2RlIjoiQmFzY3VsZXIgbGUgbW9kZSBncmlsbGUiLCJhZGRUb0xpYnJhcnkiOiJBam91dGVyIMOgIGxhIGJpYmxpb3Row6hxdWUiLCJyZW1vdmVGcm9tTGlicmFyeSI6IlN1cHByaW1lciBkZSBsYSBiaWJsaW90aMOocXVlIiwibGlicmFyeUxvYWRpbmdNZXNzYWdlIjoiQ2hhcmdlbWVudCBkZSBsYSBiaWJsaW90aMOocXVlLi4uIn0sImJ1dHRvbnMiOnsiY2xlYXJSZXNldCI6IkVmZmFjZXIgbGUgY2FudmFzICYgcsOpaW5pdGlhbGlzZXIgbGEgY291bGV1ciBkXCdhcnJpw6hyZS1wbGFuIiwiZXhwb3J0IjoiRXhwb3J0ZXIiLCJleHBvcnRUb1BuZyI6IkV4cG9ydGVyIGVuIFBORyIsImV4cG9ydFRvU3ZnIjoiRXhwb3J0ZXIgZW4gU1ZHIiwiY29weVRvQ2xpcGJvYXJkIjoiQ29waWVyIGRhbnMgbGUgcHJlc3NlLXBhcGllciIsImNvcHlQbmdUb0NsaXBib2FyZCI6IkNvcGllciBsZSBQTkcgZGFucyBsZSBwcmVzc2UtcGFwaWVyIiwic2F2ZSI6IlNhdXZlZ2FyZGVyIiwic2F2ZUFzIjoiRW5yZWdpc3RyZXIgc291cyIsImxvYWQiOiJPdXZyaXIiLCJnZXRTaGFyZWFibGVMaW5rIjoiT2J0ZW5pciB1biBsaWVuIGRlIHBhcnRhZ2UiLCJjbG9zZSI6IkZlcm1lciIsInNlbGVjdExhbmd1YWdlIjoiQ2hvaXNpciB1bmUgbGFuZ3VlIiwic2Nyb2xsQmFja1RvQ29udGVudCI6IlJldmVuaXIgYXUgY29udGVudSIsInpvb21JbiI6Ilpvb21lciIsInpvb21PdXQiOiJEw6l6b29tZXIiLCJyZXNldFpvb20iOiJSw6lpbml0aWFsaXNlciBsZSB6b29tIiwibWVudSI6Ik1lbnUiLCJkb25lIjoiVGVybWluw6kiLCJlZGl0IjoiTW9kaWZpZXIiLCJ1bmRvIjoiQW5udWxlciIsInJlZG8iOiJSw6l0YWJsaXIiLCJyb29tRGlhbG9nIjoiRMOpbWFycmVyIGxhIGNvbGxhYm9yYXRpb24gZW4gdGVtcHMgcsOpZWwiLCJjcmVhdGVOZXdSb29tIjoiQ3LDqWVyIHVuIG5vdXZlYXUgc2Fsb24iLCJ0b2dnbGVGdWxsU2NyZWVuIjoiTW9kZSBwbGVpbi3DqWNyYW4iLCJ0b2dnbGVaZW5Nb2RlIjoiQWN0aXZlci9kw6lzYWN0aXZlciBsZSBtb2RlIHplbiIsImV4aXRaZW5Nb2RlIjoiUXVpdHRlciBsZSBtb2RlIHplbiJ9LCJhbGVydHMiOnsiY2xlYXJSZXNldCI6IkxcJ2ludMOpZ3JhbGl0w6kgZHUgY2FudmFzIHZhIMOqdHJlIGVmZmFjw6kuIMOKdGVzLXZvdXMgc3VyID8iLCJjb3VsZE5vdENyZWF0ZVNoYXJlYWJsZUxpbmsiOiJJbXBvc3NpYmxlIGRlIGNyw6llciB1biBsaWVuIGRlIHBhcnRhZ2UuIiwiY291bGROb3RMb2FkSW52YWxpZEZpbGUiOiJJbXBvc3NpYmxlIGRlIGNoYXJnZXIgdW4gZmljaGllciBpbnZhbGlkZSIsImltcG9ydEJhY2tlbmRGYWlsZWQiOiJMXCdpbXBvcnQgZGVwdWlzIGxlIGJhY2tlbmQgYSDDqWNob3XDqS4iLCJjYW5ub3RFeHBvcnRFbXB0eUNhbnZhcyI6IkltcG9zc2libGUgZFwnZXhwb3J0ZXIgdW4gY2FudmFzIHZpZGUuIiwiY291bGROb3RDb3B5VG9DbGlwYm9hcmQiOiJJbXBvc3NpYmxlIGRlIGNvcGllciBkYW5zIGxlIHByZXNzZS1wYXBpZXIuIEVzc2F5ZXogZFwndXRpbGlzZXIgbGUgbmF2aWdhdGV1ciBDaHJvbWUuIiwiZGVjcnlwdEZhaWxlZCI6IkxlcyBkb25uw6llcyBuXCdvbnQgcGFzIHB1IMOqdHJlIGTDqWNoaWZmcsOpZXMuIiwidXBsb2FkZWRTZWN1cmx5IjoiTGUgdMOpbMOpY2hhcmdlbWVudCBhIMOpdMOpIHPDqWN1cmlzw6kgYXZlYyB1biBjaGlmZnJlbWVudCBkZSBib3V0IGVuIGJvdXQsIGNlIHF1aSBzaWduaWZpZSBxdWUgbmkgRXhjYWxpZHJhdyBuaSBwZXJzb25uZSBkXCdhdXRyZSBuZSBwZXV0IGVuIGxpcmUgbGUgY29udGVudS4iLCJsb2FkU2NlbmVPdmVycmlkZVByb21wdCI6IkxlIGNoYXJnZW1lbnQgZFwndW4gZGVzc2luIGV4dGVybmUgcmVtcGxhY2VyYSB2b3RyZSBjb250ZW51IGFjdHVlbC4gU291aGFpdGV6LXZvdXMgY29udGludWVyID8ifSwidG9vbEJhciI6eyJzZWxlY3Rpb24iOiJTw6lsZWN0aW9uIiwiZHJhdyI6IkRlc3NpbiBsaWJyZSIsInJlY3RhbmdsZSI6IlJlY3RhbmdsZSIsImRpYW1vbmQiOiJMb3NhbmdlIiwiZWxsaXBzZSI6IkVsbGlwc2UiLCJhcnJvdyI6IkZsw6hjaGUiLCJsaW5lIjoiTGlnbmUiLCJ0ZXh0IjoiVGV4dGUiLCJsaWJyYXJ5IjoiQmlibGlvdGjDqHF1ZSIsImxvY2siOiJHYXJkZXIgbFwnb3V0aWwgc8OpbGVjdGlvbm7DqSBhY3RpZiBhcHLDqHMgbGUgZGVzc2luIn0sImhlYWRpbmdzIjp7ImNhbnZhc0FjdGlvbnMiOiJBY3Rpb25zIGR1IGNhbmV2YXMiLCJzZWxlY3RlZFNoYXBlQWN0aW9ucyI6IkFjdGlvbnMgcG91ciBsYSBmb3JtZSBzw6lsZWN0aW9ubsOpZSIsInNoYXBlcyI6IkZvcm1lcyJ9LCJoaW50cyI6eyJsaW5lYXJFbGVtZW50IjoiQ2xpcXVleiBwb3VyIGTDqW1hcnJlciBwbHVzaWV1cnMgcG9pbnRzLCBmYWl0ZXMgZ2xpc3NlciBwb3VyIHVuZSBzZXVsZSBsaWduZSIsImZyZWVEcmF3IjoiQ2xpcXVleiBldCBmYWl0ZXMgZ2xpc3NleiwgcmVsw6JjaGV6IHF1YW5kIHZvdXMgYXZleiB0ZXJtaW7DqSIsImxpbmVhckVsZW1lbnRNdWx0aSI6IkNsaXF1ZXogc3VyIGxlIGRlcm5pZXIgcG9pbnQgb3UgYXBwdXlleiBzdXIgw4ljaGFwIG91IEVudHLDqWUgcG91ciB0ZXJtaW5lciIsInJlc2l6ZSI6IlZvdXMgcG91dmV6IGNvbnNlcnZlciBsZXMgcHJvcG9ydGlvbnMgZW4gbWFpbnRlbmFudCBsYSB0b3VjaGUgU0hJRlQgcGVuZGFudCBsZSByZWRpbWVuc2lvbm5lbWVudCxcXG5lbiBtYWludGVuYW50IGxhIHRvdWNoZSBBTFQgcG91ciByZWRpbWVuc2lvbm5lciBwYXIgcmFwcG9ydCBhdSBjZW50cmUiLCJyb3RhdGUiOiJWb3VzIHBvdXZleiBjb250cmFpbmRyZSBsZXMgYW5nbGVzIGVuIG1haW50ZW5hbnQgTUFKIGVuZm9uY8OpIHBlbmRhbnQgbGEgcm90YXRpb24iLCJsaW5lRWRpdG9yX2luZm8iOiJEb3VibGUtY2xpcXVleiBvdSBhcHB1eWV6IHN1ciBFbnRyw6llIHBvdXIgw6lkaXRlciBsZXMgcG9pbnRzIiwibGluZUVkaXRvcl9wb2ludFNlbGVjdGVkIjoiQXBwdXlleiBzdXIgU3VwcHJpbWVyIHBvdXIgc3VwcHJpbWVyIGxlIHBvaW50LCBDdHJsT3JDbWQrRCBwb3VyIGxlIGR1cGxpcXVlciwgb3UgZmFpdGVzLWxlIGdsaXNzZXIgcG91ciBsZSBkw6lwbGFjZXIiLCJsaW5lRWRpdG9yX25vdGhpbmdTZWxlY3RlZCI6IlPDqWxlY3Rpb25uZXogdW4gcG9pbnQgw6AgZMOpcGxhY2VyIG91IMOgIHN1cHByaW1lciwgb3UgbWFpbnRlbmV6IEFsdCBlbmZvbmPDqSBldCBjbGlxdWV6IHBvdXIgYWpvdXRlciBkZSBub3V2ZWF1eCBwb2ludHMifSwiZXJyb3JTcGxhc2giOnsiaGVhZGluZ01haW5fcHJlIjoiVW5lIGVycmV1ciBlc3Qgc3VydmVudWUuIEVzc2F5ZXogIiwiaGVhZGluZ01haW5fYnV0dG9uIjoiZGUgcmVjaGFyZ2VyIGxhIHBhZ2UuIiwiY2xlYXJDYW52YXNNZXNzYWdlIjoiU2kgbGUgcmVjaGFyZ2VtZW50IG5lIHLDqXNvdXQgcGFzIGxcJ2VycmV1ciwgZXNzYXlleiAiLCJjbGVhckNhbnZhc01lc3NhZ2VfYnV0dG9uIjoiZFwnZWZmYWNlciBsZSBjYW5ldmFzLiIsImNsZWFyQ2FudmFzQ2F2ZWF0IjoiIENlbGEgZW50cmHDrm5lcmEgdW5lIHBlcnRlIGR1IHRyYXZhaWwgIiwidHJhY2tlZFRvU2VudHJ5X3ByZSI6IkxcJ2VycmV1ciAiLCJ0cmFja2VkVG9TZW50cnlfcG9zdCI6IiBhIMOpdMOpIGVucmVnaXN0csOpZSBkYW5zIG5vdHJlIHN5c3TDqG1lLiIsIm9wZW5Jc3N1ZU1lc3NhZ2VfcHJlIjoiTm91cyBhdm9ucyDDqXTDqSB0csOocyBwcnVkZW50cyBkZSBuZSBwYXMgaW5jbHVyZSBsZXMgaW5mb3JtYXRpb25zIGRlIHZvdHJlIHNjw6huZSBkYW5zIGxcJ2VycmV1ci4gU2kgdm90cmUgc2PDqG5lIG5cJ2VzdCBwYXMgcHJpdsOpZSwgdmV1aWxsZXogZW52aXNhZ2VyIGRlIHBvdXJzdWl2cmUgc3VyIG5vdHJlICIsIm9wZW5Jc3N1ZU1lc3NhZ2VfYnV0dG9uIjoib3V0aWwgZGUgc3VpdmkgZGVzIGJ1Z3MuIiwib3Blbklzc3VlTWVzc2FnZV9wb3N0IjoiIFZldWlsbGV6IGluY2x1cmUgbGVzIGluZm9ybWF0aW9ucyBjaS1kZXNzb3VzIGVuIGxlcyBjb3BpYW50LWNvbGxhbnQgZGFucyBsZSB0aWNrZXQgR2l0SHViLiIsInNjZW5lQ29udGVudCI6IkNvbnRlbnUgZGUgbGEgc2PDqG5lIDoifSwicm9vbURpYWxvZyI6eyJkZXNjX2ludHJvIjoiVm91cyBwb3V2ZXogaW52aXRlciBkZXMgcGVyc29ubmVzIGRhbnMgdm90cmUgc2PDqG5lIGFjdHVlbGxlIMOgIGNvbGxhYm9yZXIgYXZlYyB2b3VzLiIsImRlc2NfcHJpdmFjeSI6Ik5lIHZvdXMgaW5xdWnDqXRleiBwYXMsIGxhIHNlc3Npb24gdXRpbGlzZSBsZSBjaGlmZnJlbWVudCBkZSBib3V0IGVuIGJvdXQsIGRvbmMgdG91dCBjZSBxdWUgdm91cyBkZXNzaW5leiByZXN0ZXJhIHByaXbDqS4gTcOqbWUgbm90cmUgc2VydmV1ciBuZSBzZXJhIHBhcyBlbiBtZXN1cmUgZGUgdm9pciBjZSBxdWUgdm91cyBmYWl0ZXMuIiwiYnV0dG9uX3N0YXJ0U2Vzc2lvbiI6IkTDqW1hcnJlciBsYSBzZXNzaW9uIiwiYnV0dG9uX3N0b3BTZXNzaW9uIjoiQXJyw6p0ZXIgbGEgc2Vzc2lvbiIsImRlc2NfaW5Qcm9ncmVzc0ludHJvIjoiTGEgc2Vzc2lvbiBkZSBjb2xsYWJvcmF0aW9uIGVuIGRpcmVjdCBlc3QgbWFpbnRlbmFudCBlbiBjb3Vycy4iLCJkZXNjX3BlcnNpc3RlbmNlV2FybmluZyI6Ik5vdGV6IHF1ZSBsZXMgZG9ubsOpZXMgZGUgbGEgc2PDqG5lIHNvbnQgcGFydGFnw6llcyBlbnRyZSBjb2xsYWJvcmF0ZXVycyBkZSBtYW5pw6hyZSBQMlAgZXQgbmUgc29udCBwYXMgZW5yZWdpc3Ryw6lzIHN1ciBub3RyZSBzZXJ2ZXVyLiBBaW5zaSwgc2kgdm91cyB2b3VzIGTDqWNvbm5lY3RleiB0b3VzLCB2b3VzIHBlcmRyZXogbGVzIGRvbm7DqWVzIHNhdWYgc2kgdm91cyBsZXMgZXhwb3J0ZXogdmVycyB1biBmaWNoaWVyIG91IHVuIGxpZW4gZGUgcGFydGFnZS4iLCJkZXNjX3NoYXJlTGluayI6IlBhcnRhZ2V6IGNlIGxpZW4gYXZlYyBjZXV4IGF2ZWMgcXVpIHZvdXMgc291aGFpdGV6IGNvbGxhYm9yZXIgOiIsImRlc2NfZXhpdFNlc3Npb24iOiJBcnLDqnRlciBsYSBzZXNzaW9uIHZvdXMgZMOpY29ubmVjdGVyYSBkdSBzYWxvbiwgbWFpcyB2b3VzIHBvdXJyZXogY29udGludWVyIMOgIHRyYXZhaWxsZXIgYXZlYyBsYSBzY8OobmUsIGxvY2FsZW1lbnQuIE5vdGV6IHF1ZSBjZWxhIG5cJ2FmZmVjdGVyYSBwYXMgbGVzIGF1dHJlcyBwZXJzb25uZXMsIGV0IGlscyBzZXJvbnQgdG91am91cnMgZW4gbWVzdXJlIGRlIGNvbGxhYm9yZXIgc3VyIGxldXIgdmVyc2lvbi4ifSwiZXJyb3JEaWFsb2ciOnsidGl0bGUiOiJFcnJldXIifSwic2hvcnRjdXRzRGlhbG9nIjp7InRpdGxlIjoiUmFjY291cmNpcyBjbGF2aWVyIiwic2hhcGVzIjoiRm9ybWVzIiwib3IiOiJvdSIsImNsaWNrIjoiY2xpcXVlciIsImRyYWciOiJnbGlzc2VyIiwiY3VydmVkQXJyb3ciOiJGbMOoY2hlIGNvdXJiw6llIiwiY3VydmVkTGluZSI6IkxpZ25lIGNvdXJiw6llIiwiZWRpdG9yIjoiw4lkaXRldXIiLCJ2aWV3IjoiQWZmaWNoZXIiLCJibG9nIjoiTGlzZXogbm90cmUgYmxvZyIsImhvd3RvIjoiU3VpdmV6IG5vcyBndWlkZXMiLCJnaXRodWIiOiJWb3VzIGF2ZXogdHJvdXbDqSB1biBwcm9ibMOobWUgPyBFbnZveWVyIiwidGV4dE5ld0xpbmUiOiJBam91dGVyIHVuZSBub3V2ZWxsZSBsaWduZSAodGV4dGUpIiwidGV4dEZpbmlzaCI6IlRlcm1pbmVyIGxcJ8OpZGl0aW9uICh0ZXh0ZSkiLCJ6b29tVG9GaXQiOiJab29tZXIgcG91ciB2aXN1YWxpc2VyIHRvdXMgbGVzIMOpbMOpbWVudHMifSwiZW5jcnlwdGVkIjp7InRvb2x0aXAiOiJWb3MgZGVzc2lucyBzb250IGNyeXB0w6lzIGRlIGJvdXQgZW4gYm91dCwgbGVzIHNlcnZldXJzIGRcJ0V4Y2FsaWRyYXcgbmUgbGVzIHZlcnJvbnQgamFtYWlzLiJ9LCJjaGFydHMiOnsibm9OdW1lcmljQ29sdW1uIjoiVm91cyBhdmV6IGNvbGzDqSB1bmUgZmV1aWxsZSBkZSBjYWxjdWwgc2FucyBkb25uw6llcyBudW3DqXJpcXVlLiIsInRvb01hbnlDb2x1bW5zIjoiVm91cyBhdmV6IGNvbGzDqSB1bmUgZmV1aWxsZSBkZSBjYWxjdWwgYXZlYyBwbHVzIGRlIGRldXggY29sb25uZXMuIn19Jyl9LGZ1bmN0aW9uKGUpe2UuZXhwb3J0cz1KU09OLnBhcnNlKCd7ImxhYmVscyI6eyJwYXN0ZSI6IteU15PXkdenIiwic2VsZWN0QWxsIjoi15HXl9eoINeU15vXnCIsIm11bHRpU2VsZWN0IjoiIiwibW92ZUNhbnZhcyI6IiIsImNvcHkiOiLXlNei16rXpyIsImNvcHlBc1BuZyI6IteU16LXqtenINec15zXldeXINebIFBORyIsImNvcHlBc1N2ZyI6IteU16LXqtenINec15zXldeXINebIFNWRyIsImJyaW5nRm9yd2FyZCI6IteU15HXkCDXqdeb15HXlCDXp9eT15nXnteUIiwic2VuZFRvQmFjayI6IteU16LXkdeoINec16HXldejIiwiYnJpbmdUb0Zyb250Ijoi15TXoteR16gg15zXl9eW15nXqiIsInNlbmRCYWNrd2FyZCI6IteU16LXkdeoINep15vXkdeUINeQ15fXldeo15QiLCJkZWxldGUiOiLXnteX16ciLCJjb3B5U3R5bGVzIjoi15TXoteq16cg16HXkteg15XXnyIsInBhc3RlU3R5bGVzIjoi15TXk9eR16cg16HXkteg15XXnyIsInN0cm9rZSI6Iten15Ug157XqteQ16giLCJiYWNrZ3JvdW5kIjoi16jXp9eiIiwiZmlsbCI6Itee15nXnNeV15kiLCJzdHJva2VXaWR0aCI6Itei15XXkdeZINen15Ug157XqteQ16giLCJzdHJva2VTdHlsZSI6Iteh15LXoNeV158g16fXlSDXlNee16rXkNeoIiwic3Ryb2tlU3R5bGVfc29saWQiOiLXntec15AiLCJzdHJva2VTdHlsZV9kYXNoZWQiOiLXnten15XXlden15UiLCJzdHJva2VTdHlsZV9kb3R0ZWQiOiLXnteg15XXp9eTIiwic2xvcHBpbmVzcyI6Iteh15LXoNeV158iLCJvcGFjaXR5Ijoi15DXmNeZ157XldeqIiwidGV4dEFsaWduIjoi15nXmdep15XXqCDXmNen16HXmCIsImZvbnRTaXplIjoi15LXldeT15wg15LXldek158iLCJmb250RmFtaWx5Ijoi16HXldeSINeU15LXldek158iLCJvbmx5U2VsZWN0ZWQiOiLXqNenINee15Qg16nXoNeR15fXqCIsIndpdGhCYWNrZ3JvdW5kIjoi16LXnSDXqNen16IiLCJhZGRXYXRlcm1hcmsiOiLXlNeV16HXoyBcXCLXoNeV16bXqCDXkdeQ157Xptei15XXqiBFeGNhbGlkcmF3XFwiIiwiaGFuZERyYXduIjoi15vXqteRINeZ15MiLCJub3JtYWwiOiLXqNeS15nXnCIsImNvZGUiOiLXp9eV15MiLCJzbWFsbCI6Iten15jXnyIsIm1lZGl1bSI6IteR16DXldeg15kiLCJsYXJnZSI6IteS15PXldecIiwidmVyeUxhcmdlIjoi16LXoNenIiwic29saWQiOiLXnteV16bXpyIsImhhY2h1cmUiOiLXp9eV15XXmdedINee16nXldek16LXmdedIiwiY3Jvc3NIYXRjaCI6Iten15XXldeZ150g157Xldem15zXkdeZ150iLCJ0aGluIjoi15PXpyIsImJvbGQiOiLXnteV15PXktepIiwibGVmdCI6Itep157XkNecIiwiY2VudGVyIjoi157XqNeb15YiLCJyaWdodCI6IteZ157XmdefIiwiZXh0cmFCb2xkIjoi16LXkdeUIiwiYXJjaGl0ZWN0Ijoi15DXqNeb15nXmNen15giLCJhcnRpc3QiOiLXkNee158iLCJjYXJ0b29uaXN0Ijoi16fXqNeZ16fXmNeV16jXmdeh15giLCJmaWxlVGl0bGUiOiLXm9eV16rXqNeqINen15XXkdelIiwiY29sb3JQaWNrZXIiOiLXkdeX15nXqNeqINem15HXoiIsImNhbnZhc0JhY2tncm91bmQiOiLXqNen16Ig15TXnNeV15ciLCJkcmF3aW5nQ2FudmFzIjoi15zXldeXINem15nXldeoIiwibGF5ZXJzIjoi16nXm9eR15XXqiIsImFjdGlvbnMiOiLXpNei15XXnNeV16oiLCJsYW5ndWFnZSI6Itep16TXlCIsImNyZWF0ZVJvb20iOiLXlNeq15fXnCDXqdeZ16rXldejINek16LXldec15Qg15fXmSIsImR1cGxpY2F0ZVNlbGVjdGlvbiI6Itep15vXpNecIiwidW50aXRsZWQiOiLXnNec15Ag15vXldeq16jXqiIsIm5hbWUiOiLXqdedIiwieW91ck5hbWUiOiLXqdedIiwibWFkZVdpdGhFeGNhbGlkcmF3Ijoi16DXldem16gg15HXkNee16bXoteV16ogRXhjYWxpZHJhdyIsImdyb3VwIjoi15DXl9eTINec16fXkdeV16bXlCIsInVuZ3JvdXAiOiLXpNeo16cg16fXkdeV16bXlCIsImNvbGxhYm9yYXRvcnMiOiIiLCJ0b2dnbGVHcmlkTW9kZSI6IiIsImFkZFRvTGlicmFyeSI6IiIsInJlbW92ZUZyb21MaWJyYXJ5IjoiIiwibGlicmFyeUxvYWRpbmdNZXNzYWdlIjoiIn0sImJ1dHRvbnMiOnsiY2xlYXJSZXNldCI6IteQ16TXoSDXkNeqINeU15zXldeXIiwiZXhwb3J0Ijoi15nXmdem15AiLCJleHBvcnRUb1BuZyI6IteZ16bXkCDXnCBQTkciLCJleHBvcnRUb1N2ZyI6IteZ16bXkCDXnCBTVkciLCJjb3B5VG9DbGlwYm9hcmQiOiLXlNei16rXpyDXnNec15XXlyIsImNvcHlQbmdUb0NsaXBib2FyZCI6IteU16LXqtenIFBORyDXnNec15XXlyIsInNhdmUiOiLXqdee15XXqCIsInNhdmVBcyI6IiIsImxvYWQiOiLXmNei158iLCJnZXRTaGFyZWFibGVMaW5rIjoi16fXkdecINen15nXqdeV16gg15zXqdeZ16rXldejIiwiY2xvc2UiOiLXodeS15XXqCIsInNlbGVjdExhbmd1YWdlIjoi15HXl9eoINep16TXlCIsInNjcm9sbEJhY2tUb0NvbnRlbnQiOiLXktec15XXnCDXkdeX15bXqNeUINec16rXldeb158iLCJ6b29tSW4iOiLXlNeS15PXnCIsInpvb21PdXQiOiLXlNen15jXnyIsInJlc2V0Wm9vbSI6IteQ15nXpNeV16Eg15bXldedIiwibWVudSI6Iteq16TXqNeZ15giLCJkb25lIjoi15HXldem16IiLCJlZGl0Ijoi16LXqNeV15oiLCJ1bmRvIjoi15HXmNecIiwicmVkbyI6IteR16bXoiDXnteX15PXqSIsInJvb21EaWFsb2ciOiLXlNeq15fXnCDXqdeZ16rXldejINeX15kiLCJjcmVhdGVOZXdSb29tIjoi16bXldeoINeX15PXqCIsInRvZ2dsZUZ1bGxTY3JlZW4iOiLXlNek16LXnC/XlNek16HXpyDXnteh15og157XnNeQIiwidG9nZ2xlWmVuTW9kZSI6IteU16rXl9ecL9eU16TXodenINee16bXkSDXqtek16jXmdeYINee16jXl9ejIiwiZXhpdFplbk1vZGUiOiLXpteQINee157XpteRINeq16TXqNeZ15gg157XqNeX16MifSwiYWxlcnRzIjp7ImNsZWFyUmVzZXQiOiLXpNei15XXnNeUINeW15Ug16rXoNen15Qg15DXqiDXm9ecINeU15zXldeXLiDXkNeq15Qg15HXmNeV15c/IiwiY291bGROb3RDcmVhdGVTaGFyZWFibGVMaW5rIjoi15zXkCDXoNeZ16rXnyDXnNeZ15nXpteoINec15nXoNenINec16nXmdeq15XXoy4iLCJjb3VsZE5vdExvYWRJbnZhbGlkRmlsZSI6Itec15Ag16DXmdeq158g15zXmNei15XXnyDXp9eV15HXpSDXqdeQ15nXoNeg15Ug16rXldeQ150iLCJpbXBvcnRCYWNrZW5kRmFpbGVkIjoi15nXmdeR15XXkCDXnteU16nXqNeqINeg15vXqdecLiIsImNhbm5vdEV4cG9ydEVtcHR5Q2FudmFzIjoi15zXkCDXoNeZ16rXnyDXnNeZ15nXpteQINec15XXlyDXqNeZ16cuIiwiY291bGROb3RDb3B5VG9DbGlwYm9hcmQiOiLXnNeQINeg15nXqtefINec15TXoteq15nXpyDXnNec15XXly4g16DXodeUINec15TXqdeq157XqSDXkdeT16TXk9ek158gQ2hyb21lLiIsImRlY3J5cHRGYWlsZWQiOiLXnNeQINeg15nXqtefINec16TXoteg15cg157XmdeT16IuIiwidXBsb2FkZWRTZWN1cmx5Ijoi15TXlNei15zXkNeUINeU15XXptek16DXlCDXnten16bXlCDXnNen16bXlCwg15XXnNeb158g16nXqNeqIEV4Y2FsaWRyYXcg15XXpteTINep15zXmdep15kg15zXkCDXmdeb15XXnNeZ150g15zXp9eo15XXkCDXkNeqINeU16rXldeb158uIiwibG9hZFNjZW5lT3ZlcnJpZGVQcm9tcHQiOiIifSwidG9vbEJhciI6eyJzZWxlY3Rpb24iOiLXkdeX15nXqNeUIiwiZHJhdyI6Item15nXldeoINeX15XXpNep15kiLCJyZWN0YW5nbGUiOiLXnteo15XXkdeiIiwiZGlhbW9uZCI6Itee16LXldeZ158iLCJlbGxpcHNlIjoi15DXnNeZ16TXodeUIiwiYXJyb3ciOiLXl9elIiwibGluZSI6Iten15UiLCJ0ZXh0Ijoi15jXp9eh15giLCJsaWJyYXJ5IjoiIiwibG9jayI6IteU16nXkNeoINeQ16og15TXm9ec15kg15TXoNeR15fXqCDXpNei15nXnCDXktedINec15DXl9eoINeh15nXldedINeU16bXmdeV16gifSwiaGVhZGluZ3MiOnsiY2FudmFzQWN0aW9ucyI6Itek16LXldec15XXqiDXlNec15XXlyIsInNlbGVjdGVkU2hhcGVBY3Rpb25zIjoi16TXoteV15zXldeqINem15XXqNeUINep16DXkdeX16jXlCIsInNoYXBlcyI6Item15XXqNeV16oifSwiaGludHMiOnsibGluZWFyRWxlbWVudCI6IteU16fXnNenINeR16nXkdeZ15wg15zXkdeX15XXqCDXoNen15XXk9eV16og157XqNeV15HXldeqLCDXkteo15XXqCDXkdep15HXmdecINen15Ug15HXldeT15MiLCJmcmVlRHJhdyI6Itec15fXpSDXldeS16jXldeoLCDXqdeX16jXqCDXm9ep16HXmdeZ157XqiIsImxpbmVhckVsZW1lbnRNdWx0aSI6IteU16fXnNenINei15wg15TXoNen15XXk9eUINeU15DXl9eo15XXoNeUINeQ15Ug15TXp9epIEVzY2FwZSDXkNeVIEVudGVyINec16HXmdeV150iLCJyZXNpemUiOiLXoNeZ16rXnyDXnNeU15LXkdeZ15wg16TXqNeV16TXldeo16bXmdeV16og16LXnCDXmdeT15kg15zXl9eZ16bXlCDXotecIFNISUZUINeq15XXmiDXm9eT15kg16nXmdeg15XXmSDXkteV15PXnCxcXG7XlNeX15bXpyBBTFQg15HXqdeR15nXnCDXnNep16DXldeqINeS15XXk9ecINeR15nXl9ehINec157XqNeb15YiLCJyb3RhdGUiOiLXoNeZ16rXnyDXnNeU15LXkdeZ15wg15bXldeV15nXldeqINei15wg15nXk9eZINec15fXmdem15Qg16LXnCBTSElGVCDXqteV15og15vXk9eZINeh15nXkdeV15EiLCJsaW5lRWRpdG9yX2luZm8iOiIiLCJsaW5lRWRpdG9yX3BvaW50U2VsZWN0ZWQiOiIiLCJsaW5lRWRpdG9yX25vdGhpbmdTZWxlY3RlZCI6IiJ9LCJlcnJvclNwbGFzaCI6eyJoZWFkaW5nTWFpbl9wcmUiOiLXkNeZ16jXoteUINep15LXmdeQ15QuINeg16HXlCAiLCJoZWFkaW5nTWFpbl9idXR0b24iOiLXmNeV16LXnyDXkNeqINeU16LXnteV15Mg157Xl9eT16kuIiwiY2xlYXJDYW52YXNNZXNzYWdlIjoi15DXnSDXmNei15nXoNeUINee15fXk9epINec15Ag16LXldeR15PXqiwg16DXodeUICIsImNsZWFyQ2FudmFzTWVzc2FnZV9idXR0b24iOiLXnteg16fXlCDXkNeqINeU15zXldeXLiIsImNsZWFyQ2FudmFzQ2F2ZWF0IjoiINeW15Qg15nXkdeZ15Ag15zXkNeV15HXk9efINei15HXldeT15QgIiwidHJhY2tlZFRvU2VudHJ5X3ByZSI6Itep15LXmdeQ15Qg16LXnSDXnteW15TXlCAiLCJ0cmFja2VkVG9TZW50cnlfcG9zdCI6IiDXoNee16bXkNeUINeR157Xoteo15vXqiDXqdec16DXlS4iLCJvcGVuSXNzdWVNZXNzYWdlX3ByZSI6Iteg15bXlNeo16DXlSDXnteQ15XXkyDXqdec15Ag15zXm9ec15XXnCDXnteZ15PXoiDXqdec15og15HXqdeS15nXkNeULiDXkNedINeU157XmdeT16Ig15DXmdeg16DXlSDXkNeZ16nXmSwg15HXkden16nXlCDXoten15XXkSDXkNeX16ggIiwib3Blbklzc3VlTWVzc2FnZV9idXR0b24iOiLXntei16fXkSDXkdeQ15LXmdedLiIsIm9wZW5Jc3N1ZU1lc3NhZ2VfcG9zdCI6IiDXkdeR16fXqdeUINeb15zXldecINeQ16og15TXnteZ15PXoiDXnNee15jXlCDXkdeQ157Xptei15XXqiDXlNei16rXp9eUINeV15TXk9eR16fXlCDXkdeg15XXqdeQINeRIEdpdEh1Yi4iLCJzY2VuZUNvbnRlbnQiOiLXqteV15vXnyDXlNec15XXlzoifSwicm9vbURpYWxvZyI6eyJkZXNjX2ludHJvIjoi15DXqteUINeZ15vXldecINec15TXltee15nXnyDXkNeg16nXmdedINec15zXldeXINeU16DXldeb15fXmSDXqdec15og15HXm9eT15kg15zXqdeq16Mg16TXoteV15zXlC4iLCJkZXNjX3ByaXZhY3kiOiLXkNecINeT15DXkteULCDXlNep15nXqteV16Mg157Xldem16TXnyDXnten16bXlCDXnNen16bXlCwg15vXmiDXqdeb15wg157XlCDXqdeq16bXmdeZ16gg15nXqdeQ16gg16TXqNeY15kuINeQ16TXmdec15Ug15TXqdeo16rXmdedINep15zXoNeVINec15Ag15nXldeb15zXlSDXnNeo15DXldeqINeQ16og157XlCDXqdeQ16rXlCDXntee16bXmdeQLiIsImJ1dHRvbl9zdGFydFNlc3Npb24iOiLXlNeq15fXnCDXqdeZ16rXldejIiwiYnV0dG9uX3N0b3BTZXNzaW9uIjoi15TXpNeh16cg16nXmdeq15XXoyIsImRlc2NfaW5Qcm9ncmVzc0ludHJvIjoi16nXmdeq15XXoyDXl9eZINeb16jXkteiINeR16TXoteV15zXlC4iLCJkZXNjX3BlcnNpc3RlbmNlV2FybmluZyI6Itep15nXnSDXnNeRINep16nXmdeq15XXoyDXlNec15XXlyDXoNei16nXlCDXkdeZ158g15TXntep16rXqtek15nXnSDXntee15fXqdeRINec157Xl9ep15Eg15HXkNeV16TXnyDXmdep15nXqCwg15XXnNeQINeg16nXnteoINeR16nXqNeq15nXnSDXqdec16DXlS4g15zXm9efLCDXkNedINeb15XXnNeb150g16rXqteg16rXp9eVLCDXlNee15nXk9eiINeZ15DXkdeTINeQ15zXkCDXkNedINeb158g16rXmdeZ16bXkCDXkNeV16rXlSDXnNen15XXkdelINeQ15Ug15HXkNee16bXoteV16og15zXmdeg16cg15TXoNeZ16rXnyDXnNep15nXqteV16MuIiwiZGVzY19zaGFyZUxpbmsiOiLXqdeq16Mg15DXqiDXlNen15nXqdeV16gg16LXnSDXm9ecINee15kg16nXkNeq15Qg157XoteV16DXmdeZ158g15zXoteR15XXkyDXkNeq15U6IiwiZGVzY19leGl0U2Vzc2lvbiI6Itei16bXmdeo16og15TXqdeZ16rXldejINeq16DXqtenINeQ15XXqteaINee15TXl9eT16gsINeQ15HXnCDXoteT15nXmdefINeq15XXm9ecINec15TXntep15nXmiDXnNei15HXldeTINei15wg15TXnNeV15csINee16fXldee15nXqi4g16nXmdedINec15Eg16nXlteUINec15Ag15nXqdek15nXoiDXotecINeQ16DXqdeZ150g15DXl9eo15nXnSwg15XXlNedINei15PXmdeZ158g15nXldeb15zXlSDXnNep16rXoyDXpNei15XXnNeUINei150g15TXkteZ16jXodeUINep15zXlNedLiJ9LCJlcnJvckRpYWxvZyI6eyJ0aXRsZSI6Itep15LXmdeQ15QifSwic2hvcnRjdXRzRGlhbG9nIjp7InRpdGxlIjoi16fXmdem15XXqNeZINee16fXnNeT16oiLCJzaGFwZXMiOiLXpteV16jXldeqIiwib3IiOiLXkNeVIiwiY2xpY2siOiLXnNeX16UiLCJkcmFnIjoi15LXqNeV16giLCJjdXJ2ZWRBcnJvdyI6IteX16Ug157XoteV16fXnCIsImN1cnZlZExpbmUiOiLXp9eVINee16LXlden15wiLCJlZGl0b3IiOiLXoteV16jXmiIsInZpZXciOiLXqtem15XXkteUIiwiYmxvZyI6Iten16jXkCDXkNeqINeU15HXnNeV15Ig16nXnNeg15UiLCJob3d0byI6Itei16fXldeRINeQ15fXqCDXlNee15PXqNeZ15vXmdedINep15zXoNeVIiwiZ2l0aHViIjoi157XpteQ16og15HXoteZ15Q/INeT15XXldeXIiwidGV4dE5ld0xpbmUiOiLXlNeV16HXoyDXqdeV16jXlCDXl9eT16nXlCAo15jXp9eh15gpIiwidGV4dEZpbmlzaCI6Iteh15nXmdedINei16jXmdeb15QgKNeY16fXodeYKSIsInpvb21Ub0ZpdCI6IteW15XXnSDXnNeU16rXkNee16og15vXnCDXlNeQ15zXnteg15jXmdedINec157XodeaIn0sImVuY3J5cHRlZCI6eyJ0b29sdGlwIjoi15TXqNeZ16nXldee15nXnSDXqdec15og157Xldem16TXoNeZ150g157Xp9em15Qg15zXp9em15Qg15vXmiDXqdeU16nXqNeq15nXnSDXqdecIEV4Y2FsaWRyYXcg15zXkCDXmdeo15DXlSDXkNeV16rXnSDXnNei15XXnNedLiJ9LCJjaGFydHMiOnsibm9OdW1lcmljQ29sdW1uIjoiIiwidG9vTWFueUNvbHVtbnMiOiIifX0nKX0sZnVuY3Rpb24oZSl7ZS5leHBvcnRzPUpTT04ucGFyc2UoJ3sibGFiZWxzIjp7InBhc3RlIjoi4KSa4KS/4KSq4KSV4KS+4KSP4KSBIiwic2VsZWN0QWxsIjoi4KS44KSt4KWAIOCkmuClgeCkqOClh+CkgiIsIm11bHRpU2VsZWN0Ijoi4KSG4KSV4KS+4KSwIOCkleCliyDgpJrgpK/gpKgg4KSu4KWH4KSCIOCknOCli+ClnOClh+CkgiIsIm1vdmVDYW52YXMiOiLgpJXgpYjgpKjgpLXgpL7gpLgg4KSV4KWLIOCkuOCljeCkpeCkvuCkqOCkvuCkguCkpOCksOCkv+CkpCDgpJXgpLDgpYfgpIIiLCJjb3B5Ijoi4KSq4KWN4KSw4KSk4KS/4KSy4KS/4KSq4KS/IiwiY29weUFzUG5nIjoi4KSV4KWN4KSy4KS/4KSq4KSs4KWL4KSw4KWN4KShIOCkquCksCDgpJXgpYngpKrgpYAg4KSV4KSw4KWH4KSCICzgpKrgpYDgpI/gpKjgpJzgpYAg4KSV4KWHIOCksOClguCkqiDgpK7gpYfgpIIiLCJjb3B5QXNTdmciOiLgpJXgpY3gpLLgpL/gpKrgpKzgpYvgpLDgpY3gpKEg4KSq4KSwIOCkleClieCkquClgCDgpJXgpLDgpYfgpIIs4KSP4KS44KS14KWA4KSc4KWAIOCkleClhyDgpLDgpYLgpKog4KSu4KWH4KSCIiwiYnJpbmdGb3J3YXJkIjoi4KS44KS+4KSu4KSo4KWHIOCksuCkvuCkj+CkgiIsInNlbmRUb0JhY2siOiLgpKrgpYDgpJvgpYcg4KSt4KWH4KSc4KWH4KSCIiwiYnJpbmdUb0Zyb250Ijoi4KS44KS+4KSu4KSo4KWHIOCksuCkvuCkj+CkgSIsInNlbmRCYWNrd2FyZCI6IuCkquClgOCkmuClhyDgpK3gpYDgpJzgpYciLCJkZWxldGUiOiLgpK7gpL/gpJ/gpL7gpI8iLCJjb3B5U3R5bGVzIjoi4KSV4KWJ4KSq4KWAIOCkuOCljeCkn+CkvuCkh+CksiIsInBhc3RlU3R5bGVzIjoi4KS44KWN4KSf4KS+4KSH4KSyIOCkquClh+CkuOCljeCknyDgpJXgpLDgpYfgpIIiLCJzdHJva2UiOiLgpLDgpYfgpJbgpL4iLCJiYWNrZ3JvdW5kIjoi4KSq4KWD4KS34KWN4KSg4KSt4KWC4KSu4KS/IiwiZmlsbCI6IuCkreCksOClh+CkgiIsInN0cm9rZVdpZHRoIjoi4KSw4KWH4KSW4KS+IOCkleClgCDgpJrgpYzgpKHgpLzgpL7gpIgiLCJzdHJva2VTdHlsZSI6IuCkuOCljeCkn+CljeCksOCli+CklSDgpJXgpL4g4KSG4KSV4KS+4KSwIiwic3Ryb2tlU3R5bGVfc29saWQiOiLgpKDgpYvgpLgiLCJzdHJva2VTdHlsZV9kYXNoZWQiOiLgpKHgpYjgpLYiLCJzdHJva2VTdHlsZV9kb3R0ZWQiOiLgpKzgpL/gpILgpKbgpYDgpKbgpL7gpLAiLCJzbG9wcGluZXNzIjoi4KSs4KWH4KSi4KS84KSC4KSX4KS+4KSq4KSoIiwib3BhY2l0eSI6IuCkheCkquCkvuCksOCkpuCksOCljeCktuCkv+CkpOCkviIsInRleHRBbGlnbiI6IuCkn+Clh+CkleCljeCkuOCljeCknyDgpLjgpILgpLDgpYfgpJbgpKgiLCJmb250U2l6ZSI6IuCkq+CkvOClieCkqOCljeCknyDgpJXgpL4g4KSG4KSV4KS+4KSwIiwiZm9udEZhbWlseSI6IuCkq+CkvOClieCkqOCljeCknyDgpJXgpL4g4KSq4KSw4KS/4KS14KS+4KSwIiwib25seVNlbGVjdGVkIjoi4KSV4KWH4KS14KSyIOCkmuCkr+CkqOCkv+CkpCIsIndpdGhCYWNrZ3JvdW5kIjoi4KSs4KWI4KSV4KSX4KWN4KSw4KS+4KSJ4KSC4KShIOCkleClhyDgpLjgpL7gpKUiLCJhZGRXYXRlcm1hcmsiOiLgpJDgpKEgXFwi4KSu4KWH4KShIOCkteCkv+CkpSDgpI/gpJXgpY3gpLjgpJXgpYjgpLLgpL/gpKHgpLDgpL7gpLVcXCIiLCJoYW5kRHJhd24iOiLgpLngpL7gpKUg4KS44KWHIOCkrOCkqOCkvuCkr+CkviDgpLngpYHgpIYiLCJub3JtYWwiOiLgpLjgpL7gpKfgpL7gpLDgpKMiLCJjb2RlIjoi4KSV4KWL4KShIiwic21hbGwiOiLgpJvgpYvgpJ/gpL4iLCJtZWRpdW0iOiLgpK7gpKfgpY3gpK/gpK4iLCJsYXJnZSI6IuCkrOCkoeCkvOCkviIsInZlcnlMYXJnZSI6IuCkrOCkueClgeCkpCDgpKzgpKHgpLzgpL4iLCJzb2xpZCI6IuCkpuClg+CkouCkvCIsImhhY2h1cmUiOiLgpLngpL7gpJrgpYHgpLDgpYciLCJjcm9zc0hhdGNoIjoi4KSV4KWN4KSw4KWJ4KS4IOCkueCliOCkmiIsInRoaW4iOiLgpKrgpKTgpLLgpL4iLCJib2xkIjoi4KSu4KWL4KSf4KS+IiwibGVmdCI6IuCkrOCkvuCkj+CkgiIsImNlbnRlciI6IuCkruCkp+CljeCkryIsInJpZ2h0Ijoi4KSm4KS+4KSP4KSBIiwiZXh0cmFCb2xkIjoi4KSs4KS54KWB4KSkIOCkruCli+Ckn+CkviIsImFyY2hpdGVjdCI6IuCkteCkvuCkuOCljeCkpOClgeCkleCkvuCksCIsImFydGlzdCI6IuCkleCksuCkvuCkleCkvuCksCIsImNhcnRvb25pc3QiOiLgpLXgpY3gpK/gpILgpJfgpY3gpK8g4KSa4KS/4KSk4KWN4KSw4KSV4KS+4KSwIiwiZmlsZVRpdGxlIjoi4KSr4KS84KS+4KSH4KSyIOCkleCkviDgpLbgpYDgpLDgpY3gpLfgpJUiLCJjb2xvclBpY2tlciI6IuCksOCkguCklyDgpJrgpK/gpKgiLCJjYW52YXNCYWNrZ3JvdW5kIjoi4KSV4KWI4KSo4KS14KS+4KS4IOCkrOCliOCkleCkl+CljeCksOCkvuCkieCkguCkoSIsImRyYXdpbmdDYW52YXMiOiLgpJXgpYjgpKjgpLXgpL7gpLgg4KSs4KSo4KS+IOCksOCkueClhyDgpLngpYjgpIIiLCJsYXllcnMiOiLgpKrgpLDgpKTgpYfgpIIiLCJhY3Rpb25zIjoi4KSV4KS+4KSw4KWN4KSw4KS14KS+4KSIIiwibGFuZ3VhZ2UiOiLgpK3gpL7gpLfgpL4iLCJjcmVhdGVSb29tIjoi4KSF4KSn4KS/4KS14KWH4KS24KSoIiwiZHVwbGljYXRlU2VsZWN0aW9uIjoi4KSh4KWB4KSq4KWN4KSy4KS/4KSV4KWH4KSfIiwidW50aXRsZWQiOiLgpIXgpLbgpYDgpLDgpY3gpLfgpL/gpKQiLCJuYW1lIjoi4KSo4KS+4KSuIiwieW91ck5hbWUiOiLgpIbgpKrgpJXgpL4g4KSo4KS+4KSuIiwibWFkZVdpdGhFeGNhbGlkcmF3Ijoi4KSu4KWH4KShIOCkteCkv+CkpSDgpI/gpJXgpY3gpLjgpJXgpYjgpLLgpL/gpKHgpLDgpL7gpLUiLCJncm91cCI6IuCkuOCkruClguCkuSDgpJrgpK/gpKgiLCJ1bmdyb3VwIjoi4KS44KSu4KWC4KS5IOCkmuCkr+CkqCDgpIXgpLjgpK7gpYLgpLngpYDgpJXgpYPgpKQg4KSV4KSw4KWH4KSCIiwiY29sbGFib3JhdG9ycyI6IuCkuOCkueCkr+Cli+Ckl+ClgCIsInRvZ2dsZUdyaWRNb2RlIjoi4KSf4KWJ4KSX4KSyIOCkl+CljeCksOCkv+CkoSDgpK7gpYvgpKEiLCJhZGRUb0xpYnJhcnkiOiIiLCJyZW1vdmVGcm9tTGlicmFyeSI6IiIsImxpYnJhcnlMb2FkaW5nTWVzc2FnZSI6IiJ9LCJidXR0b25zIjp7ImNsZWFyUmVzZXQiOiLgpJXgpYjgpKjgpLXgpL7gpLgg4KSw4KWA4KS44KWH4KSfIOCkleCksOClh+CkgiIsImV4cG9ydCI6IuCkqOCkv+CksOCljeCkr+CkvuCkpCIsImV4cG9ydFRvUG5nIjoi4KSq4KWA4KSP4KSo4KSc4KWAIOCkleClhyDgpLDgpYLgpKog4KSu4KWH4KSCIOCkqOCkv+CksOCljeCkr+CkvuCkpCDgpJXgpLDgpYciLCJleHBvcnRUb1N2ZyI6IlN2ZyDgpJXgpYcg4KSw4KWC4KSqIOCkruClh+CkgiDgpKjgpL/gpLDgpY3gpK/gpL7gpKQg4KSV4KSw4KWHIiwiY29weVRvQ2xpcGJvYXJkIjoi4KSV4KWN4KSy4KS/4KSq4KSs4KWL4KSw4KWN4KShIOCkquCksCDgpKrgpY3gpLDgpKTgpL/gpLLgpL/gpKrgpL8g4KSs4KSo4KS+4KSP4KSBIiwiY29weVBuZ1RvQ2xpcGJvYXJkIjoi4KSV4KWN4KSy4KS/4KSq4KSs4KWL4KSw4KWN4KShIOCkquCksCDgpJXgpYngpKrgpYAg4KSV4KSw4KWH4KSCLOCkquClgOCkj+CkqOCknOClgCDgpJXgpYcg4KSw4KWC4KSqIOCkruClh+CkgiIsInNhdmUiOiLgpLjgpLngpYfgpJzgpYfgpIIiLCJzYXZlQXMiOiLgpLjgpYfgpLUg4KSV4KSw4KWHIOCkh+CkuCDgpKTgpLDgpLkiLCJsb2FkIjoi4KSy4KWL4KShIOCkleCksOClh+CkgiIsImdldFNoYXJlYWJsZUxpbmsiOiLgpLjgpL7gpJ3gpL4g4KSV4KSw4KSo4KWHIOCkr+Cli+Ckl+CljeCkryDgpLLgpL/gpILgpJUg4KSq4KWN4KSw4KS+4KSq4KWN4KSkIOCkleCksOClh+CkgiIsImNsb3NlIjoi4KSs4KSC4KSmIOCkleCksOClh+CkgiIsInNlbGVjdExhbmd1YWdlIjoi4KSt4KS+4KS34KS+IOCkmuClgeCkqOClh+CkgiIsInNjcm9sbEJhY2tUb0NvbnRlbnQiOiLgpLjgpL7gpK7gpJfgpY3gpLDgpYAg4KSq4KSwIOCkteCkvuCkquCkuCDgpLjgpY3gpJXgpY3gpLDgpYngpLIg4KSV4KSw4KWH4KSCIiwiem9vbUluIjoi4KSs4KWc4KS+IOCkleCksOClh+CkgiIsInpvb21PdXQiOiLgpJvgpYvgpJ/gpL4g4KSV4KSw4KWH4KSCIiwicmVzZXRab29tIjoi4KSc4KS84KWC4KSuIOCksOClgOCkuOClh+CknyDgpJXgpLDgpYfgpIIiLCJtZW51Ijoi4KSu4KWH4KSo4KWN4KSv4KWCIiwiZG9uZSI6IuCkuOCkruCkvuCkquCljeCkpCIsImVkaXQiOiLgpLjgpILgpLbgpYvgpKfgpKgg4KSV4KSw4KWH4KSCIiwidW5kbyI6IuCkquClguCksOCljeCkteCkteCkpOCljSDgpJXgpLDgpYfgpIIiLCJyZWRvIjoi4KSr4KS/4KSwIOCkuOClhyDgpJXgpLDgpYfgpIIiLCJyb29tRGlhbG9nIjoi4KSy4KS+4KSH4KS1IOCkuOCkueCkr+Cli+CklyDgpLbgpYHgpLDgpYIg4KSV4KSw4KWH4KSCIiwiY3JlYXRlTmV3Um9vbSI6IuCkj+CklSDgpKjgpK/gpL4g4KSV4KSu4KSw4KS+IOCkrOCkqOCkvuCkj+CkgiIsInRvZ2dsZUZ1bGxTY3JlZW4iOiLgpKrgpYLgpLDgpY3gpKPgpLjgpY3gpJXgpY3gpLDgpYDgpKgg4KSa4KS+4KSy4KWCIOCkleCksOClh+CkgiIsInRvZ2dsZVplbk1vZGUiOiLgpJ/gpYngpJfgpLIg4KSc4KS84KWH4KSoIOCkruCli+CkoSIsImV4aXRaZW5Nb2RlIjoi4KSc4KWH4KSoIOCkruCli+CkoSDgpLjgpYcg4KSs4KS+4KS54KSwIOCkqOCkv+CkleCksuClh+CkgiJ9LCJhbGVydHMiOnsiY2xlYXJSZXNldCI6IuCkh+CkuOCkuOClhyDgpKrgpYLgpLDgpL4g4KSV4KWI4KSo4KS14KS+4KS4IOCkuOCkvuCkqyDgpLngpYsg4KSc4KS+4KSP4KSX4KS+4KWkIOCkleCljeCkr+CkviDgpIbgpKrgpJXgpYsg4KSv4KSV4KWA4KSoIOCkueCliD8iLCJjb3VsZE5vdENyZWF0ZVNoYXJlYWJsZUxpbmsiOiLgpLjgpL7gpJ3gpL4g4KSV4KSw4KSo4KWHIOCkr+Cli+Ckl+CljeCkryDgpLLgpL/gpILgpJUg4KSo4KS54KWA4KSCIOCkrOCkqOCkvuCkr+CkviDgpJzgpL4g4KS44KSV4KS+4KWkIiwiY291bGROb3RMb2FkSW52YWxpZEZpbGUiOiLgpIXgpK7gpL7gpKjgpY3gpK8g4KSr4KS84KS+4KSH4KSyIOCksuCli+CkoSDgpKjgpLngpYDgpIIg4KSV4KWAIOCknOCkviDgpLjgpJXgpYAiLCJpbXBvcnRCYWNrZW5kRmFpbGVkIjoi4KSs4KWI4KSV4KSP4KSC4KShIOCkuOClhyDgpIbgpK/gpL7gpKQg4KSV4KSw4KSo4KS+IOCkteCkv+Ckq+CksiDgpLDgpLngpL7gpaQiLCJjYW5ub3RFeHBvcnRFbXB0eUNhbnZhcyI6IuCkluCkvuCksuClgCDgpJXgpYjgpKjgpLXgpL7gpLgg4KSo4KS/4KSw4KWN4KSv4KS+4KSkIOCkqOCkueClgOCkgiDgpJXgpLAg4KS44KSV4KSk4KS+4KWkIiwiY291bGROb3RDb3B5VG9DbGlwYm9hcmQiOiLgpJXgpY3gpLLgpL/gpKrgpKzgpYvgpLDgpY3gpKEg4KSq4KSwIOCkleClieCkquClgCDgpKjgpLngpYDgpIIg4KSV4KS/4KSv4KS+IOCknOCkviDgpLjgpJXgpL7gpaQgQ2hyb21lIOCkrOCljeCksOCkvuCkieCknOCkvOCksCDgpJXgpL4g4KSJ4KSq4KSv4KWL4KSXIOCkleCksOCkqOClhyDgpJXgpL4g4KSq4KWN4KSw4KSv4KS+4KS4IOCkleCksOClh+CkguClpCIsImRlY3J5cHRGYWlsZWQiOiLgpKHgpYfgpJ/gpL4g4KSV4KWLIOCkoeCkv+CkleCljeCksOCkv+CkquCljeCknyDgpKjgpLngpYDgpIIg4KSV4KS/4KSv4KS+IOCknOCkviDgpLjgpJXgpL7gpaQiLCJ1cGxvYWRlZFNlY3VybHkiOiLgpIXgpKrgpLLgpYvgpKEg4KSV4KWLIOCkj+CkguCkoS3gpJ/gpYIt4KSP4KSC4KShIOCkj+CkqOCljeCkleCljeCksOCkv+CkquCljeCktuCkqCDgpJXgpYcg4KS44KS+4KSlIOCkuOClgeCksOCkleCljeCkt+Ckv+CkpCDgpJXgpL/gpK/gpL4g4KSX4KSv4KS+IOCkueCliCwg4KSc4KS/4KS44KSV4KS+IOCkruCkpOCksuCkrCDgpLngpYgg4KSV4KS/IOCkj+CkleCljeCkuOCkleCljeCksuClguCkuOCkv+CktSDgpLjgpLDgpY3gpLXgpLAg4KSU4KSwIOCkpeCksOCljeCkoSDgpKrgpL7gpLDgpY3gpJ/gpYAg4KSV4KSC4KSf4KWH4KSC4KSfIOCkqOCkueClgOCkgiDgpKrgpKLgpLwg4KS44KSV4KSk4KWHIOCkueCliOCkguClpCIsImxvYWRTY2VuZU92ZXJyaWRlUHJvbXB0Ijoi4KSy4KWL4KShIOCkueCliyDgpLDgpLngpL4g4KS54KWIIOCkrOCkvuCkueCksOClgCDgpKHgpY3gpLDgpL7gpIfgpILgpJcg4KSG4KSq4KSV4KWHIOCkruCljOCknOClguCkpuCkviDgpLjgpL7gpK7gpJfgpY3gpLDgpYAg4KSV4KWLIOCkrOCkpuCksiDgpKbgpYfgpJfgpL7gpaQg4KSV4KWN4KSv4KS+IOCkhuCkqiDgpJzgpL7gpLDgpYAg4KSw4KSW4KSo4KS+IOCkmuCkvuCkueCkpOClhyDgpLngpYjgpII/In0sInRvb2xCYXIiOnsic2VsZWN0aW9uIjoi4KSa4KSv4KSoIiwiZHJhdyI6IuCkruClgeCkq+CljeCkpCDgpKHgpY3gpLDgpL4iLCJyZWN0YW5nbGUiOiLgpIbgpK/gpL7gpKQiLCJkaWFtb25kIjoi4KSk4KS/4KSw4KWN4KSv4KSX4KWN4KS14KSw4KWN4KSXIiwiZWxsaXBzZSI6IuCkpuClgOCksOCljeCkmOCkteClg+CkpOCljeCkpCIsImFycm93Ijoi4KSk4KWA4KSwIiwibGluZSI6IuCksOClh+CkluCkviIsInRleHQiOiLgpKrgpL7gpKAiLCJsaWJyYXJ5IjoiIiwibG9jayI6IuCkoeCljeCksOCkvuCkh+CkguCklyDgpJXgpYcg4KSs4KS+4KSmIOCkmuCkr+CkqOCkv+CkpCDgpJ/gpYLgpLIg4KSV4KWLIOCkuOCkleCljeCksOCkv+CkryDgpLDgpJbgpYfgpIIifSwiaGVhZGluZ3MiOnsiY2FudmFzQWN0aW9ucyI6IuCkleCliOCkqOCkteCkvuCkuCDgpJXgpY3gpLDgpL/gpK/gpL4iLCJzZWxlY3RlZFNoYXBlQWN0aW9ucyI6IuCkmuCkr+CkqOCkv+CkpCDgpIbgpJXgpYPgpKTgpL8g4KSV4KWN4KSw4KS/4KSv4KS+4KSP4KSCIiwic2hhcGVzIjoi4KSG4KSV4KWD4KSk4KS/4KSv4KS+4KSBIn0sImhpbnRzIjp7ImxpbmVhckVsZW1lbnQiOiLgpJXgpIgg4KSs4KS/4KSC4KSm4KWB4KST4KSCIOCkleCliyDgpLbgpYHgpLDgpYIg4KSV4KSw4KSo4KWHIOCkleClhyDgpLLgpL/gpI8g4KSV4KWN4KSy4KS/4KSVIOCkleCksOClh+Ckgiwg4KS44KS/4KSC4KSX4KSyIOCksuCkvuCkh+CkqCDgpJXgpYcg4KSy4KS/4KSPIOCkluClgOCkguCkmuClh+CkgiIsImZyZWVEcmF3Ijoi4KSV4KWN4KSy4KS/4KSVIOCkleCksOClh+CkgiDgpJTgpLAg4KSW4KWA4KSC4KSa4KWH4KSC4KWkIOCkuOCkruCkvuCkquCljeCkpCDgpJXgpLDgpKjgpYcg4KSV4KWHIOCksuCkv+Ckjywg4KSb4KWL4KSh4KS84KWLIiwibGluZWFyRWxlbWVudE11bHRpIjoi4KSF4KSC4KSk4KS/4KSuIOCkrOCkv+CkguCkpuClgSDgpKrgpLAg4KSV4KWN4KSy4KS/4KSVIOCkleCksOClh+CkgiDgpK/gpL4g4KS44KSu4KS+4KSq4KWN4KSkIOCkueCli+CkqOClhyDgpJXgpYcg4KSy4KS/4KSPIOCkj+CkuOCljeCkleClh+CkqiDgpK/gpL4g4KSP4KSC4KSf4KSwIOCkpuCkrOCkvuCkj+CkgiIsInJlc2l6ZSI6IuCkhuCkleCkvuCksCDgpKzgpKbgpLLgpKTgpYcg4KS44KSu4KSvIOCkhuCkqiBTSElGVCDgpJXgpYsg4KSq4KSV4KSh4KS8IOCkleCksCDgpIXgpKjgpYHgpKrgpL7gpKQg4KSu4KWH4KSCIOCkleCkruClgCDgpJXgpLAg4KS44KSV4KSk4KWHIOCkueCliOCkgixcXG7gpJXgpYfgpILgpKbgpY3gpLAg4KS44KWHIOCkhuCkleCkvuCksCDgpKzgpKbgpLLgpKjgpYcg4KSV4KWHIOCksuCkv+CkjyBBTFQg4KSm4KSs4KS+4KSPIOCksOCkluClh+CkgiIsInJvdGF0ZSI6IuCkhuCkqiDgpJjgpYLgpLDgpY3gpKPgpKgg4KSV4KSw4KSk4KWHIOCkuOCkruCkryBTSElGVCDgpKrgpJXgpKHgpLzgpJXgpLAg4KSV4KWL4KSj4KWL4KSCIOCkleCliyDgpLXgpL/gpLXgpLYg4KSV4KSwIOCkuOCkleCkpOClhyDgpLngpYjgpIIiLCJsaW5lRWRpdG9yX2luZm8iOiLgpKzgpL/gpILgpKbgpYHgpJPgpIIg4KSV4KWLIOCkuOCkguCkquCkvuCkpuCkv+CkpCDgpJXgpLDgpKjgpYcg4KSV4KWHIOCksuCkv+CkjyBFbnRlciDgpKrgpLAg4KSh4KSs4KSyLeCkleCljeCksuCkv+CklSDgpJXgpLDgpYfgpIIg4KSv4KS+IOCkpuCkrOCkvuCkj+CkgSIsImxpbmVFZGl0b3JfcG9pbnRTZWxlY3RlZCI6IuCkrOCkv+CkguCkpuClgSDgpLngpJ/gpL7gpKjgpYcg4KSV4KWHIOCksuCkv+CkjyDgpKHgpL/gpLLgpYDgpJ8g4KSm4KSs4KS+4KSP4KSCLCDgpKrgpY3gpLDgpKTgpL/gpLDgpYLgpKrgpL/gpKQg4KSV4KSw4KSo4KWHIOCkleClhyDgpLLgpL/gpI8g4KSV4KSj4KWN4KSf4KWN4KSw4KWL4KSyIOCkr+CkviDgpJXgpK7gpL7gpILgpKEg4KSh4KWAIOCkpuCkrOCkvuCkj+CkgiDgpK/gpL4g4KS44KWN4KSl4KS+4KSo4KS+4KSC4KSk4KSw4KS/4KSkIOCkleCksOCkqOClhyDgpJXgpYcg4KSy4KS/4KSPIOCkluClgOCkguCkmuClhyIsImxpbmVFZGl0b3Jfbm90aGluZ1NlbGVjdGVkIjoi4KS44KWN4KSl4KS+4KSo4KS+4KSC4KSk4KSw4KS/4KSkIOCkleCksOCkqOClhyDgpK/gpL4g4KS54KSf4KS+4KSo4KWHIOCkleClhyDgpLLgpL/gpI8g4KSP4KSVIOCkrOCkv+CkguCkpuClgSDgpJXgpL4g4KSa4KSv4KSoIOCkleCksOClh+Ckgiwg4KSv4KS+IEFsdCDgpKbgpKzgpL7gpI8g4KSw4KSW4KWH4KSCIOCklOCksCDgpKjgpI8g4KSs4KS/4KSC4KSm4KWB4KST4KSCIOCkleCliyDgpJzgpYvgpKHgpLzgpKjgpYcg4KSV4KWHIOCksuCkv+CkjyDgpJXgpY3gpLLgpL/gpJUg4KSV4KSw4KWH4KSCIn0sImVycm9yU3BsYXNoIjp7ImhlYWRpbmdNYWluX3ByZSI6IuCkj+CklSDgpKTgpY3gpLDgpYHgpJ/gpL8g4KSV4KS+IOCkuOCkvuCkruCkqOCkviDgpJXgpLDgpKjgpL4g4KSq4KSh4KS84KS+4KWkIOCkquCljeCksOCkr+CkpOCljeCkqCAiLCJoZWFkaW5nTWFpbl9idXR0b24iOiLgpIfgpLgg4KSq4KWD4KS34KWN4KSgIOCkleCliyDgpKrgpYHgpKjgpIMg4KSy4KWL4KShIOCkleCksOClh+CkgiIsImNsZWFyQ2FudmFzTWVzc2FnZSI6IuCkr+CkpuCkvyDgpKrgpYHgpKjgpIMg4KSy4KWL4KShIOCkleCksOCkqOCkviDgpJXgpL7gpK4g4KSo4KS54KWA4KSCIOCkleCksOCkpOCkviDgpLngpYgsIOCkpOCliyDgpKrgpY3gpLDgpK/gpL7gpLgg4KSV4KSw4KWH4KSCICIsImNsZWFyQ2FudmFzTWVzc2FnZV9idXR0b24iOiLgpJXgpYjgpKjgpLXgpL7gpLgg4KS44KS+4KSrIOCkleCksOCkqOCkvuClpCIsImNsZWFyQ2FudmFzQ2F2ZWF0IjoiIOCkh+CkuOCkuOClhyDgpJXgpL7gpK4g4KSV4KS+IOCkqOClgeCkleCkuOCkvuCkqCDgpLngpYvgpJfgpL4gIiwidHJhY2tlZFRvU2VudHJ5X3ByZSI6IuCkquCkueCkmuCkvuCkqOCkleCksOCljeCkpOCkviDgpJXgpYcg4KS44KS+4KSlIOCkpOCljeCksOClgeCkn+CkvyAiLCJ0cmFja2VkVG9TZW50cnlfcG9zdCI6IiDgpLngpK7gpL7gpLDgpYcg4KS44KS/4KS44KWN4KSf4KSuIOCkquCksCDgpKjgpJzgpLzgpLAg4KSw4KSW4KWAIOCkl+CkiCDgpKXgpYDgpaQiLCJvcGVuSXNzdWVNZXNzYWdlX3ByZSI6IuCkueCkriDgpKzgpLngpYHgpKQg4KS44KSk4KSw4KWN4KSVIOCkpeClhyDgpJXgpL8g4KSk4KWN4KSw4KWB4KSf4KS/IOCkquCksCDgpIbgpKrgpJXgpYAg4KSm4KWD4KS24KWN4KSvIOCknOCkvuCkqOCkleCkvuCksOClgCDgpLbgpL7gpK7gpL/gpLIg4KSoIOCkleCksOClh+CkguClpCDgpK/gpKbgpL8g4KSG4KSq4KSV4KS+IOCkpuClg+CktuCljeCkryDgpKjgpL/gpJzgpYAg4KSo4KS54KWA4KSCIOCkueCliCwg4KSk4KWLIOCkleClg+CkquCkr+CkviDgpLngpK7gpL7gpLDgpYcg4KSs4KS+4KSw4KWHIOCkruClh+CkgiDgpLXgpL/gpJrgpL7gpLAg4KSV4KSw4KWH4KSCICIsIm9wZW5Jc3N1ZU1lc3NhZ2VfYnV0dG9uIjoi4KSs4KSXIOCkn+CljeCksOCliOCkleCksCIsIm9wZW5Jc3N1ZU1lc3NhZ2VfcG9zdCI6IiDgpJXgpYPgpKrgpK/gpL4gR2l0SHViIOCkruClgeCkpuCljeCkpuClhyDgpJXgpYsg4KSV4KWJ4KSq4KWAIOCklOCksCDgpKrgpYfgpLjgpY3gpJ8g4KSV4KSw4KSV4KWHIOCkqOClgOCkmuClhyDgpKbgpYAg4KSX4KSIIOCknOCkvuCkqOCkleCkvuCksOClgCDgpLbgpL7gpK7gpL/gpLIg4KSV4KSw4KWH4KSC4KWkIiwic2NlbmVDb250ZW50Ijoi4KSm4KWD4KS24KWN4KSvIOCkuOCkvuCkruCkl+CljeCksOClgDoifSwicm9vbURpYWxvZyI6eyJkZXNjX2ludHJvIjoi4KSG4KSqIOCkheCkquCkqOClhyDgpLXgpLDgpY3gpKTgpK7gpL7gpKgg4KSm4KWD4KS24KWN4KSvIOCkleClhyDgpLLgpYvgpJfgpYvgpIIg4KSV4KWLIOCkheCkquCkqOClhyDgpLjgpL7gpKUg4KS44KS54KSv4KWL4KSXIOCkleCksOCkqOClhyDgpJXgpYcg4KSy4KS/4KSPIOCkhuCkruCkguCkpOCljeCksOCkv+CkpCDgpJXgpLAg4KS44KSV4KSk4KWHIOCkueCliOCkguClpCIsImRlc2NfcHJpdmFjeSI6IuCkmuCkv+CkguCkpOCkviDgpKgg4KSV4KSw4KWH4KSCLCDgpLjgpKTgpY3gpLAg4KSF4KSC4KSkLeCkuOClhy3gpIXgpILgpKQg4KSP4KSo4KWN4KSV4KWN4KSw4KS/4KSq4KWN4KS24KSoIOCkleCkviDgpIngpKrgpK/gpYvgpJcg4KSV4KSw4KSk4KS+IOCkueCliCwg4KSH4KS44KSy4KS/4KSPIOCkhuCkqiDgpJzgpYsg4KSt4KWAIOCkoeCljeCksOCkviDgpJXgpLDgpYfgpILgpJfgpYcg4KS14KS5IOCkqOCkv+CknOClgCDgpLDgpLngpYfgpJfgpL7gpaQg4KSv4KS54KS+4KSCIOCkpOCklSDgpJXgpL8g4KS54KSu4KS+4KSw4KS+IOCkuOCksOCljeCkteCksCDgpK3gpYAg4KSo4KS54KWA4KSCIOCkpuClh+CkliDgpKrgpL7gpI/gpJfgpL4g4KSV4KS/IOCkhuCkqiDgpJXgpY3gpK/gpL4g4KSV4KSwIOCksOCkueClhyDgpLngpYjgpILgpaQiLCJidXR0b25fc3RhcnRTZXNzaW9uIjoi4KS44KSk4KWN4KSwIOCkquCljeCksOCkvuCksOCkguCkrSDgpJXgpLDgpYfgpIIiLCJidXR0b25fc3RvcFNlc3Npb24iOiLgpLjgpKTgpY3gpLAg4KSw4KWB4KSV4KWH4KSCIiwiZGVzY19pblByb2dyZXNzSW50cm8iOiLgpLLgpL7gpIfgpLUg4KS44KS54KSv4KWL4KSXIOCkuOCkpOCljeCksCDgpIXgpKwg4KSc4KS+4KSw4KWAIOCkueCliOClpCIsImRlc2NfcGVyc2lzdGVuY2VXYXJuaW5nIjoi4KSn4KWN4KSv4KS+4KSoIOCkpuClh+CkgiDgpJXgpL8g4KSm4KWD4KS24KWN4KSvIOCkoeClh+Ckn+CkviDgpI/gpJUg4KSq4KWAIDIg4KSq4KWAIOCkq+CliOCktuCkqCDgpK7gpYfgpIIg4KS44KS54KSv4KWL4KSX4KS/4KSv4KWL4KSCIOCkleClhyDgpKzgpYDgpJog4KS44KS+4KSd4KS+IOCkleCkv+Ckr+CkviDgpJfgpK/gpL4g4KS54KWILCDgpJTgpLAg4KS54KSu4KS+4KSw4KWHIOCkuOCksOCljeCkteCksCDgpKrgpLAg4KSV4KS+4KSv4KSuIOCkqOCkueClgOCkgiDgpLngpYjgpaQg4KSH4KS4IOCkquCljeCksOCkleCkvuCksCwg4KSv4KSm4KS/IOCkhuCkqiDgpLjgpK3gpYAg4KSh4KS/4KS44KWN4KSV4KSo4KWH4KSV4KWN4KSfIOCkleCksOCkpOClhyDgpLngpYjgpIIsIOCkpOCliyDgpIbgpKog4KSh4KWH4KSf4KS+IOCkluCliyDgpKbgpYfgpILgpJfgpYcg4KSc4KSsIOCkpOCklSDgpIbgpKog4KSH4KS44KWHIOCkq+CkvOCkvuCkh+CksiDgpK/gpL4g4KS44KS+4KSd4KS+IOCkleCksOCkqOClhyDgpK/gpYvgpJfgpY3gpK8g4KSy4KS/4KSC4KSVIOCkquCksCDgpKjgpL/gpLDgpY3gpK/gpL7gpKQg4KSo4KS54KWA4KSCIOCkleCksOCkpOClh+ClpCIsImRlc2Nfc2hhcmVMaW5rIjoi4KSH4KS4IOCksuCkv+CkguCklSDgpJXgpYsg4KSG4KSqIOCknOCkv+CkuCDgpJXgpL/gpLjgpYAg4KSV4KWHIOCkuOCkvuCkpSDgpK3gpYAg4KS44KS54KSv4KWL4KSXIOCkleCksOCkqOCkviDgpJrgpL7gpLngpKTgpYcg4KS54KWI4KSCLCDgpIngpLjgpJXgpYcg4KS44KS+4KSlIOCkuOCkvuCkneCkviDgpJXgpLDgpYfgpIIiLCJkZXNjX2V4aXRTZXNzaW9uIjoi4KS44KSk4KWN4KSwIOCksOCli+CkleCkqOCkviDgpIbgpKrgpJXgpYsg4KSw4KWC4KSuIOCkuOClhyDgpKzgpL7gpLngpLAg4KSV4KSwIOCkpuClh+Ckl+Ckviwg4KSy4KWH4KSV4KS/4KSoIOCkhuCkqiDgpLjgpY3gpKXgpL7gpKjgpYDgpK8g4KS44KWN4KSk4KSwIOCkquCksCDgpKbgpYPgpLbgpY3gpK8g4KSV4KWHIOCkuOCkvuCkpSDgpJXgpL7gpK4g4KSV4KSw4KSo4KS+IOCknOCkvuCksOClgCDgpLDgpJYg4KSq4KS+4KSP4KSC4KSX4KWH4KWkIOCkp+CljeCkr+CkvuCkqCDgpKbgpYfgpIIg4KSV4KS/IOCkr+CkuSDgpIXgpKjgpY3gpK8g4KSy4KWL4KSX4KWL4KSCIOCkleCliyDgpKrgpY3gpLDgpK3gpL7gpLXgpL/gpKQg4KSo4KS54KWA4KSCIOCkleCksOClh+Ckl+Ckviwg4KSU4KSwIOCkteClhyDgpIXgpK3gpYAg4KSt4KWAIOCkheCkquCkqOClhyDgpLjgpILgpLjgpY3gpJXgpLDgpKMg4KSq4KSwIOCkuOCkueCkr+Cli+CklyDgpJXgpLDgpKjgpYcg4KSu4KWH4KSCIOCkuOCkleCljeCkt+CkriDgpLngpYvgpILgpJfgpYfgpaQifSwiZXJyb3JEaWFsb2ciOnsidGl0bGUiOiLgpJfgpLLgpKTgpYAifSwic2hvcnRjdXRzRGlhbG9nIjp7InRpdGxlIjoi4KSV4KWA4KSs4KWL4KSw4KWN4KShIOCkleClhyDgpLbgpYngpLDgpY3gpJ/gpJXgpJ/gpY3gpLgiLCJzaGFwZXMiOiLgpIbgpJXgpYPgpKTgpL/gpK/gpL7gpIEiLCJvciI6IuCkr+CkviIsImNsaWNrIjoi4KSV4KWN4KSy4KS/4KSVIOCkleCksOClh+CkgiIsImRyYWciOiLgpJbgpYDgpILgpJrgpYfgpIIiLCJjdXJ2ZWRBcnJvdyI6IuCkmOClgeCkruCkvuCkteCkpuCkvuCksCDgpKTgpYDgpLAiLCJjdXJ2ZWRMaW5lIjoi4KSY4KWB4KSu4KS+4KS14KSm4KS+4KSwIOCksOClh+CkluCkviIsImVkaXRvciI6IuCkuOCkguCkquCkvuCkpuCklSIsInZpZXciOiLgpKbgpYPgpLbgpY3gpK8iLCJibG9nIjoi4KS54KSu4KS+4KSw4KS+IOCkrOCljeCksuClieCklyDgpKrgpKLgpYciLCJob3d0byI6IuCkueCkruCkvuCksOClhyDgpJfgpL7gpIfgpKEg4KSV4KS+IOCkquCkvuCksuCkqCDgpJXgpLDgpYfgpIIiLCJnaXRodWIiOiLgpI/gpJUg4KSu4KWB4KSm4KWN4KSm4KS+IOCkruCkv+CksuCkvj8g4KSq4KWN4KSw4KS44KWN4KSk4KWB4KSkIOCkleCksOClhyIsInRleHROZXdMaW5lIjoi4KSo4KSIIOCkquCkguCkleCljeCkpOCkvyAo4KSq4KS+4KSgKSDgpJzgpYvgpKHgpLzgpYfgpIIiLCJ0ZXh0RmluaXNoIjoi4KS44KSC4KSq4KS+4KSm4KSoIOCkuOCkruCkvuCkquCljeCkpCDgpJXgpLDgpYfgpIIgKOCkquCkvuCkoCkiLCJ6b29tVG9GaXQiOiLgpLjgpK3gpYAg4KSk4KSk4KWN4KS14KWL4KSCIOCkleCliyDgpKvgpL/gpJ8g4KSV4KSw4KSo4KWHIOCkleClhyDgpLLgpL/gpI8g4KSc4KS84KWC4KSuIOCkleCksOClh+CkgiJ9LCJlbmNyeXB0ZWQiOnsidG9vbHRpcCI6IuCkhuCkquCkleClhyDgpJrgpL/gpKTgpY3gpLAg4KSF4KSC4KSkLeCkuOClhy3gpIXgpILgpKQg4KSP4KSo4KWN4KSV4KWN4KSw4KS/4KSq4KWN4KSf4KWH4KShIOCkueCliOCkgiwg4KSH4KS44KSy4KS/4KSPIOCkj+CkleCljeCkuOCkleCljeCksuClguCkuOCkv+CkteCljeCksOClieCktSDgpJXgpYcg4KS44KSw4KWN4KS14KSwIOCkieCkqOCljeCkueClh+CkgiDgpJXgpK3gpYAg4KSo4KS54KWA4KSCIOCkpuClh+CkluClh+CkguCkl+Clh+ClpCJ9LCJjaGFydHMiOnsibm9OdW1lcmljQ29sdW1uIjoi4KSG4KSq4KSo4KWHIOCkj+CklSDgpLjgpILgpJbgpY3gpK/gpL7gpKTgpY3gpK7gpJUg4KSV4KWJ4KSy4KSuIOCkleClhyDgpKzgpL/gpKjgpL4g4KSP4KSVIOCkuOCljeCkquCljeCksOClh+CkoeCktuClgOCknyDgpJrgpL/gpKrgpJXgpL7gpIjgpaQiLCJ0b29NYW55Q29sdW1ucyI6IuCkhuCkquCkqOClhyDgpKbgpYsg4KS44KWHIOCkheCkp+Ckv+CklSDgpJXgpYngpLLgpK4g4KSV4KWHIOCkuOCkvuCkpSDgpI/gpJUg4KS44KWN4KSq4KWN4KSw4KWH4KSh4KS24KWA4KSfIOCkmuCkv+CkquCkleCkvuCkiOClpCJ9fScpfSxmdW5jdGlvbihlKXtlLmV4cG9ydHM9SlNPTi5wYXJzZSgneyJsYWJlbHMiOnsicGFzdGUiOiJCZWlsbGVzenTDqXMiLCJzZWxlY3RBbGwiOiLDlnNzemVzIGtpamVsw7Zsw6lzZSIsIm11bHRpU2VsZWN0IjoiIiwibW92ZUNhbnZhcyI6IiIsImNvcHkiOiJNw6Fzb2zDoXMiLCJjb3B5QXNQbmciOiJWw6Fnw7NsYXByYSBtw6Fzb2zDoXMgbWludCBQTkciLCJjb3B5QXNTdmciOiJWw6Fnw7NsYXByYSBtw6Fzb2zDoXMgbWludCBTVkciLCJicmluZ0ZvcndhcmQiOiJFbMWRcsOpYmIgaG96w6FzIiwic2VuZFRvQmFjayI6IiIsImJyaW5nVG9Gcm9udCI6IiIsInNlbmRCYWNrd2FyZCI6IiIsImRlbGV0ZSI6IlTDtnJsw6lzIiwiY29weVN0eWxlcyI6IiIsInBhc3RlU3R5bGVzIjoiIiwic3Ryb2tlIjoiS8O2cnZvbmFsIiwiYmFja2dyb3VuZCI6IkjDoXR0w6lyIiwiZmlsbCI6IktpdMO2bHTDqXMiLCJzdHJva2VXaWR0aCI6IiIsInN0cm9rZVN0eWxlIjoiIiwic3Ryb2tlU3R5bGVfc29saWQiOiIiLCJzdHJva2VTdHlsZV9kYXNoZWQiOiIiLCJzdHJva2VTdHlsZV9kb3R0ZWQiOiIiLCJzbG9wcGluZXNzIjoiU3TDrWx1cyIsIm9wYWNpdHkiOiLDgXR0ZXRzesWRc8OpZyIsInRleHRBbGlnbiI6IiIsImZvbnRTaXplIjoiIiwiZm9udEZhbWlseSI6IiIsIm9ubHlTZWxlY3RlZCI6IkNzYWsgYSBraXbDoWxhc3p0b3R0Iiwid2l0aEJhY2tncm91bmQiOiJIw6F0dMOpcnJlbCBlZ3nDvHR0IiwiYWRkV2F0ZXJtYXJrIjoiIiwiaGFuZERyYXduIjoiIiwibm9ybWFsIjoiTm9ybcOhbCIsImNvZGUiOiJDb2RlIiwic21hbGwiOiJLaWNzaSIsIm1lZGl1bSI6IkvDtnplcGVzIiwibGFyZ2UiOiJOYWd5IiwidmVyeUxhcmdlIjoiIiwic29saWQiOiJLaXTDtmx0w7Z0dCIsImhhY2h1cmUiOiJWb25hbGvDoXpvdHQiLCJjcm9zc0hhdGNoIjoiIiwidGhpbiI6IlbDqWtvbnkiLCJib2xkIjoiRsOpbGvDtnbDqXIiLCJsZWZ0IjoiQmFsIiwiY2VudGVyIjoiIiwicmlnaHQiOiIiLCJleHRyYUJvbGQiOiIiLCJhcmNoaXRlY3QiOiJUZXJ2ZXrFkWkiLCJhcnRpc3QiOiJNxbF2w6lzemkiLCJjYXJ0b29uaXN0IjoiS2FyaWthdMO6csOhcyIsImZpbGVUaXRsZSI6IkbDoWpsIGPDrW1lIiwiY29sb3JQaWNrZXIiOiJTesOtbnbDoWxhc3p0w7MiLCJjYW52YXNCYWNrZ3JvdW5kIjoiVsOhc3pvbiBow6F0dMOpcnN6w61uZSIsImRyYXdpbmdDYW52YXMiOiIiLCJsYXllcnMiOiJSw6l0ZWdlayIsImFjdGlvbnMiOiJNxbF2ZWxldGVrIiwibGFuZ3VhZ2UiOiJOeWVsdiIsImNyZWF0ZVJvb20iOiLDiWzFkSBlZ3nDvHR0bcO8a8O2ZMOpcyBtZWdvc3p0w6FzYSIsImR1cGxpY2F0ZVNlbGVjdGlvbiI6IiIsInVudGl0bGVkIjoiIiwibmFtZSI6Ik7DqXYiLCJ5b3VyTmFtZSI6IiIsIm1hZGVXaXRoRXhjYWxpZHJhdyI6IiIsImdyb3VwIjoiIiwidW5ncm91cCI6IiIsImNvbGxhYm9yYXRvcnMiOiIiLCJ0b2dnbGVHcmlkTW9kZSI6IiIsImFkZFRvTGlicmFyeSI6IiIsInJlbW92ZUZyb21MaWJyYXJ5IjoiIiwibGlicmFyeUxvYWRpbmdNZXNzYWdlIjoiIn0sImJ1dHRvbnMiOnsiY2xlYXJSZXNldCI6IlbDoXN6b24gdMO2cmzDqXNlIiwiZXhwb3J0IjoiRXhwb3J0w6Fsw6FzIiwiZXhwb3J0VG9QbmciOiJFeHBvcnTDoWzDoXMgUE5HLWJlIiwiZXhwb3J0VG9TdmciOiJFeHBvcnTDoWzDoXMgU1ZHLWJlIiwiY29weVRvQ2xpcGJvYXJkIjoiVsOhZ8OzbGFwcmEgbcOhc29sw6FzIiwiY29weVBuZ1RvQ2xpcGJvYXJkIjoiUE5HIG3DoXNvbMOhc2EgYSB2w6Fnw7NsYXByYSIsInNhdmUiOiJNZW50w6lzIiwic2F2ZUFzIjoiIiwibG9hZCI6IkJldMO2bHTDqXMiLCJnZXRTaGFyZWFibGVMaW5rIjoiTWVnb3N6dGhhdMOzIGxpbmsgbMOpdHJlaG96w6FzYSIsImNsb3NlIjoiQmV6w6Fyw6FzIiwic2VsZWN0TGFuZ3VhZ2UiOiIiLCJzY3JvbGxCYWNrVG9Db250ZW50IjoiVmlzc3phZ8O2cmdldMOpcyBhIHRhcnRhbG9taG96Iiwiem9vbUluIjoiTmFnecOtdMOhcyIsInpvb21PdXQiOiJLaWNzaW55w610w6lzIiwicmVzZXRab29tIjoiTmFnecOtdMOhcyBhbGFwaGVseXpldGJlIiwibWVudSI6Ik1lbsO8IiwiZG9uZSI6IkvDqXN6IiwiZWRpdCI6IlN6ZXJrZXN6dMOpcyIsInVuZG8iOiJWaXNzemF2b27DoXMiLCJyZWRvIjoiw5pqcmEgdsOpZ3JlaGFqdMOhcyIsInJvb21EaWFsb2ciOiLDiWzFkSBlZ3nDvHR0bcWxa8O2ZMOpcyBpbmTDrXTDoXNhIiwiY3JlYXRlTmV3Um9vbSI6IsOaaiBzem9iYSBsw6l0cmVob3rDoXNhIiwidG9nZ2xlRnVsbFNjcmVlbiI6IiIsInRvZ2dsZVplbk1vZGUiOiIiLCJleGl0WmVuTW9kZSI6IiJ9LCJhbGVydHMiOnsiY2xlYXJSZXNldCI6IkV6IGEgbcWxdmVsZXQgdMO2cmxpIGEgdsOhc3pvbnQuIEJpenRvcyBiZW5uZT8iLCJjb3VsZE5vdENyZWF0ZVNoYXJlYWJsZUxpbmsiOiJOZW0gc2lrZXLDvGx0IG1lZ29zenRoYXTDsyBsaW5rZXQgbMOpdHJlaG96bmkuIiwiY291bGROb3RMb2FkSW52YWxpZEZpbGUiOiIiLCJpbXBvcnRCYWNrZW5kRmFpbGVkIjoiTmVtIHNpa2Vyw7xsdCBiZXTDtmx0ZW5pIGEgc3plcnZlcnLFkWwuIiwiY2Fubm90RXhwb3J0RW1wdHlDYW52YXMiOiLDnHJlcyB2w6Fzem9udCBuZW0gbGVoZXQgZXhwb3J0w6FsbmkuIiwiY291bGROb3RDb3B5VG9DbGlwYm9hcmQiOiJOZW0gc2lrZXLDvGx0IHbDoWfDs2xhcHJhIG1lbnRlbmkuIFByw7Niw6FsamEgbWVnIENocm9tZSBiw7ZuZ8Opc3rFkXZlbC4iLCJkZWNyeXB0RmFpbGVkIjoiTmVtIHNpa2Vyw7xsdCBkZWvDs2RvbG5pIGF6IGFkYXRvdC4iLCJ1cGxvYWRlZFNlY3VybHkiOiJBIGZlbHTDtmx0w6lzdCB2w6lncG9udG9rIGvDtnrDtnR0aSB0aXRrb3PDrXTDoXNzYWwgYml6dG9zw610b3R0dWssIGFtaSBhenQgamVsZW50aSwgaG9neSBheiBFeGNhbGlkcmF3IHN6ZXJ2ZXIgw6lzIGhhcm1hZGlrIGZlbGVrIG5lbSB0dWRqw6FrIGVsb2x2YXNuaSBhIGZlbHTDtmx0w6lzIHRhcnRhbG3DoXQuIiwibG9hZFNjZW5lT3ZlcnJpZGVQcm9tcHQiOiIifSwidG9vbEJhciI6eyJzZWxlY3Rpb24iOiJLaXbDoWxhc3p0w6FzIiwiZHJhdyI6IiIsInJlY3RhbmdsZSI6IlTDqWdsYWxhcCIsImRpYW1vbmQiOiJSb21idXN6IiwiZWxsaXBzZSI6IkVsbGlwc3ppcyIsImFycm93IjoiTnnDrWwiLCJsaW5lIjoiVm9uYWwiLCJ0ZXh0IjoiU3rDtnZlZyIsImxpYnJhcnkiOiIiLCJsb2NrIjoiUmFqem9sw6FzIHV0w6FuIGF6IGFrdMOtdiBlc3prw7Z6dCB0YXJ0c2Ega2l2w6FsYXN6dHZhIn0sImhlYWRpbmdzIjp7ImNhbnZhc0FjdGlvbnMiOiJWw6Fzem9uIG3FsXZlbGV0ZWsiLCJzZWxlY3RlZFNoYXBlQWN0aW9ucyI6IktpdsOhbGFzenRvdHQgZm9ybWEgbcWxdmVsZXRlaSIsInNoYXBlcyI6IkZvcm3DoWsifSwiaGludHMiOnsibGluZWFyRWxlbWVudCI6IkthdHRpbnRzb24gYSB0w7ZiYiBwb250IGVsaW5kw610w6Fzw6Fob3osIGjDunp6YSBheiBlZ3llbmVzIHZvbmFsaG96IiwiZnJlZURyYXciOiIiLCJsaW5lYXJFbGVtZW50TXVsdGkiOiJLYXR0aW50c29uIGF6IHV0b2xzw7MgcG9udHJhLCB2YWd5IG55b21qYSBtZWcgYXogRXNjYXBlIHZhZ3kgYXogRW50ZXIgYmlsbGVudHnFsXQgYSBiZWZlamV6w6lzaGV6IiwicmVzaXplIjoiIiwicm90YXRlIjoiQSBTSElGVCBiaWxsZW50ecWxIGxlbnlvbXZhIHRhcnTDoXPDoXZhbCBrb3Jsw6F0b3poYXRqYSBhIHN6w7ZnZWsgaWxsZXN6dMOpc8OpdCIsImxpbmVFZGl0b3JfaW5mbyI6IiIsImxpbmVFZGl0b3JfcG9pbnRTZWxlY3RlZCI6IiIsImxpbmVFZGl0b3Jfbm90aGluZ1NlbGVjdGVkIjoiIn0sImVycm9yU3BsYXNoIjp7ImhlYWRpbmdNYWluX3ByZSI6IkhpYmEgdMO2cnTDqW50LiBQcsOzYsOhbGphICIsImhlYWRpbmdNYWluX2J1dHRvbiI6IsO6anJhdMO2bHRlbmkgYXogb2xkYWx0LiIsImNsZWFyQ2FudmFzTWVzc2FnZSI6IkhhIGF6IMO6anJhdMO2bHTDqXMgbmVtIG3FsWvDtmRpaywgcHLDs2LDoWxqYSAiLCJjbGVhckNhbnZhc01lc3NhZ2VfYnV0dG9uIjoidMO2csO2bG5pIGEgdsOhc3pvbnQuIiwiY2xlYXJDYW52YXNDYXZlYXQiOiIgRXp6ZWwgZWx2ZXN6aWsgbWluZGVuIGVkZGlnaSBtdW5rw6FqYSAiLCJ0cmFja2VkVG9TZW50cnlfcHJlIjoiQSBoaWJha8OzZCBhem9ub3PDrXTDs3ZhbCAiLCJ0cmFja2VkVG9TZW50cnlfcG9zdCI6IiBueW9tb24gdmFuIGvDtnZldHZlIGEgcmVuZHN6ZXLDvG5rYmVuLiIsIm9wZW5Jc3N1ZU1lc3NhZ2VfcHJlIjoiTmFneW9uIHZpZ3nDoXp0dW5rLCBob2d5IG5lIGFkanVuayBtZWcgYSBqZWxlbmV0cmUgdm9uYXRrb3rDsyBpbmZvcm3DoWNpw7NrYXQgYSBoaWLDoWJhbi4gSGEgYSBqZWxlbmV0ZWQgbmVtIGJpemFsbWFzLCBrw6lyasO8ayBmb250b2xqYSBtZWcgYSBqZWxlbmV0IGhvenrDoWFkw6Fzw6F0IGEgaGliYWvDtnZldMWRIHJlbmRzemVyw7xua2JlbiAiLCJvcGVuSXNzdWVNZXNzYWdlX2J1dHRvbiI6ImhpYmFiZWplbGVudMWRLiIsIm9wZW5Jc3N1ZU1lc3NhZ2VfcG9zdCI6IiBLw6lyasO8aywgbcOhc29samEgYmUgYXogYWzDoWJiaSBpbmZvcm3DoWNpw7NrYXQgYSBHaXRIdWIgcHJvYmzDqW3DoWJhLiIsInNjZW5lQ29udGVudCI6IkplbGVuZXQgdGFydGFsbWE6In0sInJvb21EaWFsb2ciOnsiZGVzY19pbnRybyI6Ik1lZ2jDrXZoYXQgZW1iZXJla2V0IGEgamVsZW5sZWdpIGplbGVuZXRiZSwgaG9neSBlZ3nDvHR0bcWxa8O2ZGplbmVrIMO2bm5lbC4iLCJkZXNjX3ByaXZhY3kiOiJOZSBhZ2fDs2Rqb24sIGEgbXVua2FtZW5ldCB2w6lncG9udG9rIGvDtnrDtnR0aSB0aXRrb3PDrXTDoXN0IGhhc3puw6FsLCB0ZWjDoXQgYsOhcm1pdCByYWp6b2wsIHByaXbDoXQgbWFyYWQuIE3DqWcgYSBzemVydmVyw7xuayBzZW0gZm9namEgbMOhdG5pLCBob2d5IG1pdCByYWp6b2x0LiIsImJ1dHRvbl9zdGFydFNlc3Npb24iOiJNdW5rYW1lbmV0IGluZMOtdMOhc2EiLCJidXR0b25fc3RvcFNlc3Npb24iOiJNdW5rYW1lbmV0IGxlw6FsbMOtdMOhc2EiLCJkZXNjX2luUHJvZ3Jlc3NJbnRybyI6IkF6IMOpbMWRIGVnecO8dHRtxbFrw7Zkw6lzaSBtdW5rYW1lbmV0IGZvbHlhbWF0YmFuIHZhbi4iLCJkZXNjX3BlcnNpc3RlbmNlV2FybmluZyI6IiIsImRlc2Nfc2hhcmVMaW5rIjoiT3NzemEgbWVnIGV6dCBhIGxpbmtldCBiw6Fya2l2ZWwsIGFraXZlbCBlZ3nDvHR0IHN6ZXJldG5lIG3FsWvDtmRuaToiLCJkZXNjX2V4aXRTZXNzaW9uIjoiIn0sImVycm9yRGlhbG9nIjp7InRpdGxlIjoiIn0sInNob3J0Y3V0c0RpYWxvZyI6eyJ0aXRsZSI6IiIsInNoYXBlcyI6IiIsIm9yIjoiIiwiY2xpY2siOiIiLCJkcmFnIjoiIiwiY3VydmVkQXJyb3ciOiIiLCJjdXJ2ZWRMaW5lIjoiIiwiZWRpdG9yIjoiIiwidmlldyI6IiIsImJsb2ciOiIiLCJob3d0byI6IiIsImdpdGh1YiI6IiIsInRleHROZXdMaW5lIjoiIiwidGV4dEZpbmlzaCI6IiIsInpvb21Ub0ZpdCI6IiJ9LCJlbmNyeXB0ZWQiOnsidG9vbHRpcCI6IiJ9LCJjaGFydHMiOnsibm9OdW1lcmljQ29sdW1uIjoiIiwidG9vTWFueUNvbHVtbnMiOiIifX0nKX0sZnVuY3Rpb24oZSl7ZS5leHBvcnRzPUpTT04ucGFyc2UoJ3sibGFiZWxzIjp7InBhc3RlIjoiVGVtcGVsIiwic2VsZWN0QWxsIjoiUGlsaWggc2VtdWEiLCJtdWx0aVNlbGVjdCI6IiIsIm1vdmVDYW52YXMiOiIiLCJjb3B5IjoiU2FsaW4iLCJjb3B5QXNQbmciOiJTYWxpbiBrZSBQYXBhbiBLbGlwIFNlYmFnYWkgUE5HIiwiY29weUFzU3ZnIjoiU2FsaW4ga2UgUGFwYW4gS2xpcCBTZWJhZ2FpIFNWRyIsImJyaW5nRm9yd2FyZCI6Ik1hanVrYW4iLCJzZW5kVG9CYWNrIjoiQmF3YSBrZSBCZWxha2FuZyIsImJyaW5nVG9Gcm9udCI6IkJhd2Ega2UgZGVwYW4iLCJzZW5kQmFja3dhcmQiOiJNdW5kdXJrYW4iLCJkZWxldGUiOiJIYXB1cyIsImNvcHlTdHlsZXMiOiIiLCJwYXN0ZVN0eWxlcyI6IiIsInN0cm9rZSI6IlN0cm9rZSIsImJhY2tncm91bmQiOiJMYXRhciIsImZpbGwiOiJJc2lhbiIsInN0cm9rZVdpZHRoIjoiIiwic3Ryb2tlU3R5bGUiOiIiLCJzdHJva2VTdHlsZV9zb2xpZCI6IiIsInN0cm9rZVN0eWxlX2Rhc2hlZCI6IiIsInN0cm9rZVN0eWxlX2RvdHRlZCI6IiIsInNsb3BwaW5lc3MiOiJTbG9wcGluZXNzIiwib3BhY2l0eSI6Ik9wYXNpdGFzIiwidGV4dEFsaWduIjoiUGVyYXRhYW4gVGVrcyIsImZvbnRTaXplIjoiVWt1cmFuIGZvbnQiLCJmb250RmFtaWx5IjoiSmVuaXMgZm9udCIsIm9ubHlTZWxlY3RlZCI6IkhhbnlhIHlhbmcgRGlwaWxpaCIsIndpdGhCYWNrZ3JvdW5kIjoiRGVuZ2FuIExhdGFyIiwiYWRkV2F0ZXJtYXJrIjoiVGFtYmFoa2FuIFxcIkRpYnVhdCBkZW5nYW4gRXhjYWxpZHJhd1xcIiIsImhhbmREcmF3biI6IiIsIm5vcm1hbCI6IkJpYXNhIiwiY29kZSI6IktvZGUiLCJzbWFsbCI6IktlY2lsIiwibWVkaXVtIjoiTWVuZW5nYWgiLCJsYXJnZSI6IkJlc2FyIiwidmVyeUxhcmdlIjoiIiwic29saWQiOiJQYWRhdCIsImhhY2h1cmUiOiJHYXJpcy1nYXJpcyIsImNyb3NzSGF0Y2giOiIiLCJ0aGluIjoiTGVtYnV0IiwiYm9sZCI6IlRlYmFsIiwibGVmdCI6IktpcmkiLCJjZW50ZXIiOiJUZW5nYWgiLCJyaWdodCI6IkthbmFuIiwiZXh0cmFCb2xkIjoiIiwiYXJjaGl0ZWN0IjoiQXJzaXRlayIsImFydGlzdCI6IkFydGlzIiwiY2FydG9vbmlzdCI6IkthcnR1bmlzIiwiZmlsZVRpdGxlIjoiSnVkdWwgQmVya2FzIiwiY29sb3JQaWNrZXIiOiJQaWxpaGFuIFdhcm5hIiwiY2FudmFzQmFja2dyb3VuZCI6IkxhdGFyIEthbnZhcyIsImRyYXdpbmdDYW52YXMiOiIiLCJsYXllcnMiOiJMYXBpc2FuIiwiYWN0aW9ucyI6IkFrc2kiLCJsYW5ndWFnZSI6IkJhaGFzYSIsImNyZWF0ZVJvb20iOiIiLCJkdXBsaWNhdGVTZWxlY3Rpb24iOiJEdXBsaWthdCIsInVudGl0bGVkIjoiVGFucGEganVkdWwiLCJuYW1lIjoiTmFtYSIsInlvdXJOYW1lIjoiIiwibWFkZVdpdGhFeGNhbGlkcmF3IjoiIiwiZ3JvdXAiOiIiLCJ1bmdyb3VwIjoiIiwiY29sbGFib3JhdG9ycyI6IiIsInRvZ2dsZUdyaWRNb2RlIjoiIiwiYWRkVG9MaWJyYXJ5IjoiIiwicmVtb3ZlRnJvbUxpYnJhcnkiOiIiLCJsaWJyYXJ5TG9hZGluZ01lc3NhZ2UiOiIifSwiYnV0dG9ucyI6eyJjbGVhclJlc2V0IjoiU2V0ZWwgVWxhbmcgS2FudmFzIiwiZXhwb3J0IjoiRWtzcG9yIiwiZXhwb3J0VG9QbmciOiJFa3Nwb3Iga2UgUE5HIiwiZXhwb3J0VG9TdmciOiJFa3Nwb3Iga2UgU1ZHIiwiY29weVRvQ2xpcGJvYXJkIjoiU2FsaW4ga2UgUGFwYW4gS2xpcCIsImNvcHlQbmdUb0NsaXBib2FyZCI6IlNhbGluIFBORyBrZSBQYXBhbiBLbGlwIiwic2F2ZSI6IlNpbXBhbiIsInNhdmVBcyI6IiIsImxvYWQiOiJNdWF0IiwiZ2V0U2hhcmVhYmxlTGluayI6IkJ1YXQgVGF1dGFuIHlhbmcgQmlzYSBEaWJhZ2lhbiIsImNsb3NlIjoiVHV0dXAiLCJzZWxlY3RMYW5ndWFnZSI6IlBpbGloIEJhaGFzYSIsInNjcm9sbEJhY2tUb0NvbnRlbnQiOiJHdWxpciBrZW1iYWxpIGtlIGtvbnRlbiIsInpvb21JbiI6IkJlc2Fya2FuIiwiem9vbU91dCI6IktlY2lsa2FuIiwicmVzZXRab29tIjoiUmVzZXQgUGVtYmVzYXJhbiIsIm1lbnUiOiJNZW51IiwiZG9uZSI6IlNlbGVzYWkiLCJlZGl0IjoiU3VudGluZyIsInVuZG8iOiJVcnVuZ2thbiIsInJlZG8iOiJNZW5ndWxhbmciLCJyb29tRGlhbG9nIjoiTXVsYWkga29sYWJvcmFzaSBzZWNhcmEgbGFuZ3N1bmciLCJjcmVhdGVOZXdSb29tIjoiQnVhdCBydWFuZyBiYXJ1IiwidG9nZ2xlRnVsbFNjcmVlbiI6IkFrdGlmIC8gTm9uYWt0aWZrYW4gbGF5YXIgcGVudWgiLCJ0b2dnbGVaZW5Nb2RlIjoiIiwiZXhpdFplbk1vZGUiOiIifSwiYWxlcnRzIjp7ImNsZWFyUmVzZXQiOiJJbmkgYWthbiBtZW5naGFwdXMgc2VtdWEgeWFuZyBhZGEgZGlrYW52YXMuIEFwYWthaCBrYW11IHlha2luID8iLCJjb3VsZE5vdENyZWF0ZVNoYXJlYWJsZUxpbmsiOiJUaWRhayBiaXNhIG1lbWJ1YXQgdGF1dGFuIHlhbmcgYmlzYSBkaWJhZ2lrYW4iLCJjb3VsZE5vdExvYWRJbnZhbGlkRmlsZSI6IlRpZGFrIERhcGF0IE1lbXVhdCBCZXJrYXMgeWFuZyBUaWRhayBWYWxpZCIsImltcG9ydEJhY2tlbmRGYWlsZWQiOiJHYWdhbCBtZW5naW1wb3IgZGFyaSBiYWNrZW5kIiwiY2Fubm90RXhwb3J0RW1wdHlDYW52YXMiOiJUaWRhayBiaXNhIG1lbmdla3Nwb3Iga2FudmFzIGtvc29uZyIsImNvdWxkTm90Q29weVRvQ2xpcGJvYXJkIjoiVGlkYWsgYmlzYSBtZW55YWxpbiBrZSBwYXBhbiBrbGlwLiBDb2JhIGd1bmFrYW4gQnJvd3NlciBDaHJvbWUiLCJkZWNyeXB0RmFpbGVkIjoiVGlkYWsgZGFwYXQgbWVuZ2Rlc2tyaXBzaSBkYXRhLiIsInVwbG9hZGVkU2VjdXJseSI6IlBlbmd1bmdnYWhhbiBpbmkgdGVsYWggZGlhbWFua2FuIG1lbmdndW5ha2FuIGVua3JpcHNpIGVuZC10by1lbmQsIGFydGlueWEgc2VydmVyIEV4Y2FsaWRyYXcgZGFuIHBpaGFrIGtldGlnYSB0aWRhayBkYXRhIG1lbWJhY2EgbnlhIiwibG9hZFNjZW5lT3ZlcnJpZGVQcm9tcHQiOiIifSwidG9vbEJhciI6eyJzZWxlY3Rpb24iOiJQaWxpaGFuIiwiZHJhdyI6IiIsInJlY3RhbmdsZSI6IlBlcnNlZ2kiLCJkaWFtb25kIjoiQmVybGlhbiIsImVsbGlwc2UiOiJFbGlwcyIsImFycm93IjoiUGFuYWgiLCJsaW5lIjoiR2FyaXMiLCJ0ZXh0IjoiVGVrcyIsImxpYnJhcnkiOiIiLCJsb2NrIjoiQmlhcmthbiBhbGF0IHlhbmcgZGlwaWxpaCBha3RpZiBzZXRlbGFoIG1lbmdnYW1iYXIifSwiaGVhZGluZ3MiOnsiY2FudmFzQWN0aW9ucyI6Ik9wc2kgS2FudmFzIiwic2VsZWN0ZWRTaGFwZUFjdGlvbnMiOiJPcHNpIGJlbnR1ayB5YW5nIGRpcGlsaWgiLCJzaGFwZXMiOiJCZW50dWsifSwiaGludHMiOnsibGluZWFyRWxlbWVudCI6IktsaWsgdW50dWsgbWVtdWxhaSBiYW55YWsgcG9pbiwgc2VyZXQgdW50dWsgc2F0dSBiYXJpcyIsImZyZWVEcmF3IjoiIiwibGluZWFyRWxlbWVudE11bHRpIjoiIiwicmVzaXplIjoiIiwicm90YXRlIjoiIiwibGluZUVkaXRvcl9pbmZvIjoiIiwibGluZUVkaXRvcl9wb2ludFNlbGVjdGVkIjoiIiwibGluZUVkaXRvcl9ub3RoaW5nU2VsZWN0ZWQiOiIifSwiZXJyb3JTcGxhc2giOnsiaGVhZGluZ01haW5fcHJlIjoiIiwiaGVhZGluZ01haW5fYnV0dG9uIjoibXVhdCB1bGFuZyBoYWxhbWFuLiIsImNsZWFyQ2FudmFzTWVzc2FnZSI6Ikppa2EgbWVtdWF0IGhhbGFtYW4gdGlkYWsgYmlzYSwgY29iYSAiLCJjbGVhckNhbnZhc01lc3NhZ2VfYnV0dG9uIjoiYmVyc2loa2FuIGNhbnZhcy4iLCJjbGVhckNhbnZhc0NhdmVhdCI6IiIsInRyYWNrZWRUb1NlbnRyeV9wcmUiOiIiLCJ0cmFja2VkVG9TZW50cnlfcG9zdCI6IiIsIm9wZW5Jc3N1ZU1lc3NhZ2VfcHJlIjoiIiwib3Blbklzc3VlTWVzc2FnZV9idXR0b24iOiIiLCJvcGVuSXNzdWVNZXNzYWdlX3Bvc3QiOiIgTW9ob24gYmVyaWthbiBpbmZvcm1hc2kgZGliYXdhaCBpbmkgZGVuZ2FuIG1lbnlhbGluIGRhbiB0ZW1wZWxrYW4gZGkgR2l0aHViIGlzc3VlLiIsInNjZW5lQ29udGVudCI6IiJ9LCJyb29tRGlhbG9nIjp7ImRlc2NfaW50cm8iOiIiLCJkZXNjX3ByaXZhY3kiOiIiLCJidXR0b25fc3RhcnRTZXNzaW9uIjoiTXVsYWkgU2VzaSIsImJ1dHRvbl9zdG9wU2Vzc2lvbiI6IkhlbnRpa2FuIHNlc2kiLCJkZXNjX2luUHJvZ3Jlc3NJbnRybyI6IiIsImRlc2NfcGVyc2lzdGVuY2VXYXJuaW5nIjoiIiwiZGVzY19zaGFyZUxpbmsiOiIiLCJkZXNjX2V4aXRTZXNzaW9uIjoiIn0sImVycm9yRGlhbG9nIjp7InRpdGxlIjoiIn0sInNob3J0Y3V0c0RpYWxvZyI6eyJ0aXRsZSI6IiIsInNoYXBlcyI6IiIsIm9yIjoiIiwiY2xpY2siOiIiLCJkcmFnIjoiIiwiY3VydmVkQXJyb3ciOiIiLCJjdXJ2ZWRMaW5lIjoiIiwiZWRpdG9yIjoiIiwidmlldyI6IiIsImJsb2ciOiIiLCJob3d0byI6IiIsImdpdGh1YiI6IiIsInRleHROZXdMaW5lIjoiIiwidGV4dEZpbmlzaCI6IiIsInpvb21Ub0ZpdCI6IiJ9LCJlbmNyeXB0ZWQiOnsidG9vbHRpcCI6IiJ9LCJjaGFydHMiOnsibm9OdW1lcmljQ29sdW1uIjoiIiwidG9vTWFueUNvbHVtbnMiOiIifX0nKX0sZnVuY3Rpb24oZSl7ZS5leHBvcnRzPUpTT04ucGFyc2UoJ3sibGFiZWxzIjp7InBhc3RlIjoiSW5jb2xsYSIsInNlbGVjdEFsbCI6IlNlbGV6aW9uYSB0dXR0byIsIm11bHRpU2VsZWN0IjoiQWdnaXVuZ2kgZWxlbWVudG8gYWxsYSBzZWxlemlvbmUiLCJtb3ZlQ2FudmFzIjoiU3Bvc3RhIHRlbGEiLCJjb3B5IjoiQ29waWEiLCJjb3B5QXNQbmciOiJDb3BpYSBuZWdsaSBhcHB1bnRpIGNvbWUgUE5HIiwiY29weUFzU3ZnIjoiQ29waWEgbmVnbGkgYXBwdW50aSBjb21lIFNWRyIsImJyaW5nRm9yd2FyZCI6IlBvcnRhIGF2YW50aSIsInNlbmRUb0JhY2siOiJNYW5kYSBpbiBmb25kbyIsImJyaW5nVG9Gcm9udCI6IlBvcnRhIGluIGNpbWEiLCJzZW5kQmFja3dhcmQiOiJNYW5kYSBkaWV0cm8iLCJkZWxldGUiOiJFbGltaW5hIiwiY29weVN0eWxlcyI6IkNvcGlhIHN0aWxpIiwicGFzdGVTdHlsZXMiOiJJbmNvbGxhIHN0aWxpIiwic3Ryb2tlIjoiVHJhdHRvIiwiYmFja2dyb3VuZCI6IlNmb25kbyIsImZpbGwiOiJSaWVtcGltZW50byIsInN0cm9rZVdpZHRoIjoiU3Blc3NvcmUgZGVsIHRyYXR0byIsInN0cm9rZVN0eWxlIjoiU3RpbGUgZGVsIHRyYXR0byIsInN0cm9rZVN0eWxlX3NvbGlkIjoiUGllbm8iLCJzdHJva2VTdHlsZV9kYXNoZWQiOiJUcmF0dGVnZ2lhdG8iLCJzdHJva2VTdHlsZV9kb3R0ZWQiOiJQdW50ZWdnaWF0byIsInNsb3BwaW5lc3MiOiJJbXByZWNpc2lvbmUiLCJvcGFjaXR5IjoiT3BhY2l0w6AiLCJ0ZXh0QWxpZ24iOiJBbGxpbmVhbWVudG8gZGVsIHRlc3RvIiwiZm9udFNpemUiOiJEaW1lbnNpb25lIGNhcmF0dGVyZSIsImZvbnRGYW1pbHkiOiJDYXJhdHRlcmUiLCJvbmx5U2VsZWN0ZWQiOiJTb2xvIHNlbGV6aW9uYXRpIiwid2l0aEJhY2tncm91bmQiOiJDb24gU2ZvbmRvIiwiYWRkV2F0ZXJtYXJrIjoiQWdnaXVuZ2kgXFwiQ3JlYXRvIGNvbiBFeGNhbGlkcmF3XFwiIiwiaGFuZERyYXduIjoiQSBtYW5vIGxpYmVyYSIsIm5vcm1hbCI6Ik5vcm1hbGUiLCJjb2RlIjoiQ29kaWNlIiwic21hbGwiOiJQaWNjb2xvIiwibWVkaXVtIjoiTWVkaW8iLCJsYXJnZSI6IkdyYW5kZSIsInZlcnlMYXJnZSI6Ik1vbHRvIGdyYW5kZSIsInNvbGlkIjoiUGllbm8iLCJoYWNodXJlIjoiVHJhdHRlZ2dpbyBvYmxpcXVvIiwiY3Jvc3NIYXRjaCI6IlRyYXR0ZWdnaW8gaW5jcm9jaWF0byIsInRoaW4iOiJTb3R0aWxlIiwiYm9sZCI6IkdyYXNzZXR0byIsImxlZnQiOiJTaW5pc3RyYSIsImNlbnRlciI6IkNlbnRybyIsInJpZ2h0IjoiRGVzdHJhIiwiZXh0cmFCb2xkIjoiRXh0cmEgR3Jhc3NldHRvIiwiYXJjaGl0ZWN0IjoiQXJjaGl0ZXR0byIsImFydGlzdCI6IkFydGlzdGEiLCJjYXJ0b29uaXN0IjoiRnVtZXR0aXN0YSIsImZpbGVUaXRsZSI6IlRpdG9sbyBmaWxlIiwiY29sb3JQaWNrZXIiOiJTZWxldHRvcmUgY29sb3JlIiwiY2FudmFzQmFja2dyb3VuZCI6IlNmb25kbyB0ZWxhIiwiZHJhd2luZ0NhbnZhcyI6IkFyZWEgZGkgZGlzZWdubyIsImxheWVycyI6IkxpdmVsbGkiLCJhY3Rpb25zIjoiQXppb25pIiwibGFuZ3VhZ2UiOiJMaW5ndWEiLCJjcmVhdGVSb29tIjoiQ29uZGl2aWRpIHVuYSBzZXNzaW9uZSBkaSBjb2xsYWJvcmF6aW9uZSBpbiBkaXJldHRhIiwiZHVwbGljYXRlU2VsZWN0aW9uIjoiRHVwbGljYSIsInVudGl0bGVkIjoiU2VuemEgdGl0b2xvIiwibmFtZSI6Ik5vbWUiLCJ5b3VyTmFtZSI6IklsIHZvc3RybyBub21lIiwibWFkZVdpdGhFeGNhbGlkcmF3IjoiQ3JlYXRvIGNvbiBFeGNhbGlkcmF3IiwiZ3JvdXAiOiJDcmVhIGdydXBwbyBkYSBzZWxlemlvbmUiLCJ1bmdyb3VwIjoiRGl2aWRpIGdydXBwbyBkYSBzZWxlemlvbmUiLCJjb2xsYWJvcmF0b3JzIjoiQ29sbGFib3JhdG9yaSIsInRvZ2dsZUdyaWRNb2RlIjoiQXR0aXZhL2Rpc2F0dGl2YSBtb2RhbGl0w6AgcXVhZHLDrWN1bGEiLCJhZGRUb0xpYnJhcnkiOiJBZ2dpdW5naSBhbGxhIGJpYmxpb3RlY2EiLCJyZW1vdmVGcm9tTGlicmFyeSI6IlJpbXVvdmkgZGFsbGEgYmlibGlvdGVjYSIsImxpYnJhcnlMb2FkaW5nTWVzc2FnZSI6IkNhcmljYW1lbnRvIGRlbGxhIGJpYmxpb3RlY2EuLi4ifSwiYnV0dG9ucyI6eyJjbGVhclJlc2V0IjoiUmlwcmlzdGluYSBsYSB0ZWxhIiwiZXhwb3J0IjoiRXNwb3J0YSIsImV4cG9ydFRvUG5nIjoiRXNwb3J0YSBjb21lIFBORyIsImV4cG9ydFRvU3ZnIjoiRXNwb3J0YSBjb21lIFNWRyIsImNvcHlUb0NsaXBib2FyZCI6IkNvcGlhIG5lZ2xpIGFwcHVudGkiLCJjb3B5UG5nVG9DbGlwYm9hcmQiOiJDb3BpYSBQTkcgbmVnbGkgYXBwdW50aSIsInNhdmUiOiJTYWx2YSIsInNhdmVBcyI6IlNhbHZhIGNvbiBub21lIiwibG9hZCI6IkNhcmljYSIsImdldFNoYXJlYWJsZUxpbmsiOiJPdHRpZW5pIGxpbmsgY29uZGl2aXNpYmlsZSIsImNsb3NlIjoiQ2hpdWRpIiwic2VsZWN0TGFuZ3VhZ2UiOiJTZWxlemlvbmEgbGluZ3VhIiwic2Nyb2xsQmFja1RvQ29udGVudCI6IlNjb3JyaSBpbmRpZXRybyBmaW5vIGFsIGNvbnRlbnV0byIsInpvb21JbiI6IkF1bWVudGEgaW5ncmFuZGltZW50byIsInpvb21PdXQiOiJSaWR1Y2kgaW5ncmFuZGltZW50byIsInJlc2V0Wm9vbSI6IlJpcHJpc3RpbmEgaW5ncmFuZGltZW50byIsIm1lbnUiOiJNZW7DuSIsImRvbmUiOiJGYXR0byIsImVkaXQiOiJNb2RpZmljYSIsInVuZG8iOiJBbm51bGxhIiwicmVkbyI6IlJpcGV0aSIsInJvb21EaWFsb2ciOiJJbml6aWEgY29sbGFib3JhemlvbmUgaW4gZGlyZXR0YSIsImNyZWF0ZU5ld1Jvb20iOiJDcmVhIG51b3ZhIHN0YW56YSIsInRvZ2dsZUZ1bGxTY3JlZW4iOiJBdHRpdmEvRGlzYXR0aXZhIHNjaGVybW8gaW50ZXJvIiwidG9nZ2xlWmVuTW9kZSI6IkF0dGl2YS9EaXNhdHRpdmEgbW9kYWxpdMOgIHplbiIsImV4aXRaZW5Nb2RlIjoiVXNjaXJlIGRhbGxhIG1vZGFsaXTDoCB6ZW4ifSwiYWxlcnRzIjp7ImNsZWFyUmVzZXQiOiJRdWVzdG8gY2FuY2VsbGVyw6AgbFwnaW50ZXJhIHRlbGEuIFNlaSBzaWN1cm8/IiwiY291bGROb3RDcmVhdGVTaGFyZWFibGVMaW5rIjoiTm9uIHJpZXNjbyBhIGNyZWFyZSB1biBsaW5rIGNvbmRpdmlzaWJpbGUuIiwiY291bGROb3RMb2FkSW52YWxpZEZpbGUiOiJJbXBvc3NpYmlsZSBjYXJpY2FyZSB1biBmaWxlIG5vIHZhbGlkbyIsImltcG9ydEJhY2tlbmRGYWlsZWQiOiJJbXBvcnRhemlvbmUgZGFsIHNlcnZlciBmYWxsaXRhLiIsImNhbm5vdEV4cG9ydEVtcHR5Q2FudmFzIjoiTm9uIMOoIHBvc3NpYmlsZSBlc3BvcnRhcmUgdW5hIHRlbGEgdnVvdGEuIiwiY291bGROb3RDb3B5VG9DbGlwYm9hcmQiOiJJbXBvc3NpYmlsZSBjb3BpYXJlIG5lZ2xpIGFwcHVudGkuIFByb3ZhcmUgdXNhbmRvIGlsIGJyb3dzZXIgQ2hyb21lLiIsImRlY3J5cHRGYWlsZWQiOiJJbXBvc3NpYmlsZSBkZWNyaXB0YXJlIGkgZGF0aS4iLCJ1cGxvYWRlZFNlY3VybHkiOiJMXCd1cGxvYWQgw6ggc3RhdG8gcHJvdGV0dG8gY29uIGxhIGNyaXR0b2dyYWZpYSBlbmQtdG8tZW5kLCBpbCBjaGUgc2lnbmlmaWNhIGNoZSBpbCBzZXJ2ZXIgRXhjYWxpZHJhdyBlIHRlcnplIHBhcnRpIG5vbiBwb3Nzb25vIGxlZ2dlcmUgaWwgY29udGVudXRvLiIsImxvYWRTY2VuZU92ZXJyaWRlUHJvbXB0IjoiU2UgY2FyaWNoaSBxdWVzdG8gZGlzZWdubyBlc3Rlcm5vLCBzb3N0aXR1aXLDoCBxdWVsbG8gY2hlIGhhaS4gVnVvaSBjb250aW51YXJlPyJ9LCJ0b29sQmFyIjp7InNlbGVjdGlvbiI6IlNlbGV6aW9uZSIsImRyYXciOiJEaXNlZ25vIGxpYmVybyIsInJlY3RhbmdsZSI6IlJldHRhbmdvbG8iLCJkaWFtb25kIjoiUm9tYm8iLCJlbGxpcHNlIjoiRWxsaXNzZSIsImFycm93IjoiRnJlY2NpYSIsImxpbmUiOiJMaW5lYSIsInRleHQiOiJUZXN0byIsImxpYnJhcnkiOiJCaWJsaW90ZWNhIiwibG9jayI6Ik1hbnRpZW5pIGxvIHN0cnVtZW50byBzZWxlemlvbmF0byBhdHRpdm8gZG9wbyBhdmVyIGRpc2VnbmF0byJ9LCJoZWFkaW5ncyI6eyJjYW52YXNBY3Rpb25zIjoiQXppb25pIHN1bGxhIFRlbGEiLCJzZWxlY3RlZFNoYXBlQWN0aW9ucyI6IkltcG9zdGF6aW9uaSBkZWxsYSBmb3JtYSBzZWxlemlvbmF0YSIsInNoYXBlcyI6IkZvcm1lIn0sImhpbnRzIjp7ImxpbmVhckVsZW1lbnQiOiJDbGljY2EgcGVyIGluaXppYXJlIHVuYSBsaW5lYSBpbiBwacO5IHB1bnRpLCB0cmFzY2luYSBwZXIgc2luZ29sYSBsaW5lYSIsImZyZWVEcmF3IjoiQ2xpY2NhIGUgdHJhc2NpbmEsIHJpbGFzY2lhIHF1YW5kbyBhdnJhaSBmaW5pdG8iLCJsaW5lYXJFbGVtZW50TXVsdGkiOiJDbGljY2Egc3VsbFwndWx0aW1vIHB1bnRvIG8gcHJlbWkgRXNjIG8gSW52aW8gcGVyIGZpbmlyZSIsInJlc2l6ZSI6IlBlciB2aW5jb2xhcmUgbGUgcHJvcG9yemlvbmksIHRlbmlyIHByZW11dG8gTUFJVVNDIGR1cmFudGUgaWwgcmlkaW1lbnNpb25hbWVudG87XFxucGVyIHJpZGltZW5zaW9uYXJlIGRhbCBjZW50cm8sIHRlbmlyIHByZW11dG8gQUxUIiwicm90YXRlIjoiUHVvaSBtYW50ZW5lcmUgZ2xpIGFuZ29saSB0ZW5lbmRvIHByZW11dG8gU0hJRlQgZHVyYW50ZSBsYSByb3RhemlvbmUiLCJsaW5lRWRpdG9yX2luZm8iOiJGYWkgZG9wcGlvIGNsaWNrIG8gcHJlbWkgaW52aW8gcGVyIG1vZGlmaWNhcmUgaSBwdW50aSIsImxpbmVFZGl0b3JfcG9pbnRTZWxlY3RlZCI6IlByZW1lcmUgRWxpbWluYSBwZXIgcmltdW92ZXJlIGlsIHB1bnRvLCBDdHJsT3JDbWQrRCBwZXIgZHVwbGljYXJlIG8gdHJhc2NpbmFyZSBwZXIgc3Bvc3RhcmUiLCJsaW5lRWRpdG9yX25vdGhpbmdTZWxlY3RlZCI6IlNlbGV6aW9uYSB1biBwdW50byBwZXIgc3Bvc3RhcmUgbyByaW11b3ZlcmUsIG9wcHVyZSB0aWVuaSBwcmVtdXRvIEFsdCBlIGZhaSBjbGljIHBlciBhZ2dpdW5nZXJlIG51b3ZpIHB1bnRpIn0sImVycm9yU3BsYXNoIjp7ImhlYWRpbmdNYWluX3ByZSI6IlNpIMOoIHZlcmlmaWNhdG8gdW4gZXJyb3JlLiBQcm92YXJlICIsImhlYWRpbmdNYWluX2J1dHRvbiI6InJpY2FyaWNhbmRvIGxhIHBhZ2luYS4iLCJjbGVhckNhbnZhc01lc3NhZ2UiOiJTZSByaWNhcmljYXJlIG5vbiBmdW56aW9uYSwgcHJvdmEgIiwiY2xlYXJDYW52YXNNZXNzYWdlX2J1dHRvbiI6InB1bGlyZSBsYSB0ZWxhLiIsImNsZWFyQ2FudmFzQ2F2ZWF0IjoiIFF1ZXN0byByaXN1bHRlcsOgIG5lbGxhIHBlcmRpdGEgZGVsIGxhdm9ybyAiLCJ0cmFja2VkVG9TZW50cnlfcHJlIjoiTFwnZXJyb3JlIGNvbiBpZGVudGlmaWNhdGl2byAiLCJ0cmFja2VkVG9TZW50cnlfcG9zdCI6IiDDqCBzdGF0byB0cmFjY2lhdG8gbmVsIG5vc3RybyBzaXN0ZW1hLiIsIm9wZW5Jc3N1ZU1lc3NhZ2VfcHJlIjoiU2lhbW8gc3RhdGkgbW9sdG8gY2F1dGkgbmVsIG5vbiBpbmNsdWRlcmUgaW5mb3JtYXppb25pIGRlbGxhIHNjZW5hIG5lbGxcJ2Vycm9yZS4gU2UgbGEgdHVhIHNjZW5hIG5vbiDDqCBwcml2YXRhLCB0aSBwcmVnaGlhbW8gZGkgY29uc2lkZXJhcmUgbGEgc3VhIGluY2x1c2lvbmUgbmVsIG5vc3RybyAiLCJvcGVuSXNzdWVNZXNzYWdlX2J1dHRvbiI6ImJ1ZyB0cmFja2VyLiIsIm9wZW5Jc3N1ZU1lc3NhZ2VfcG9zdCI6IiBQZXIgZmF2b3JlIGluY2x1ZGkgbGUgaW5mb3JtYXppb25pIHJpcG9ydGF0ZSBxdWkgc290dG8gY29waWFuZG9sZSBlIGluY29sbGFuZG9sZSBuZWxsYSBpc3N1ZSBkaSBHaXRIdWIuIiwic2NlbmVDb250ZW50IjoiQ29udGVudXRvIGRlbGxhIHNjZW5hOiJ9LCJyb29tRGlhbG9nIjp7ImRlc2NfaW50cm8iOiJQdW9pIGludml0YXJlIHBlcnNvbmUgbmVsbGEgdHVhIHNjZW5hIGF0dHVhbGUgcGVyIGNvbGxhYm9yYXJlIGNvbiB0ZS4iLCJkZXNjX3ByaXZhY3kiOiJOb24gcHJlb2NjdXBhcnRpLCBsYSBzZXNzaW9uZSB1dGlsaXp6YSBsYSBjcml0dG9ncmFmaWEgZW5kLXRvLWVuZCwgcXVpbmRpIHF1YWxzaWFzaSBjb3NhIGRpc2VnbmkgcmltYXJyw6AgcHJpdmF0YS4gTmVtbWVubyBpbCBub3N0cm8gc2VydmVyIHNhcsOgIGluIGdyYWRvIGRpIHZlZGVyZSBjb3NhIGhhaSBjcmVhdG8uIiwiYnV0dG9uX3N0YXJ0U2Vzc2lvbiI6IkF2dmlhIHNlc3Npb25lIiwiYnV0dG9uX3N0b3BTZXNzaW9uIjoiVGVybWluYSBzZXNzaW9uZSIsImRlc2NfaW5Qcm9ncmVzc0ludHJvIjoiTGEgc2Vzc2lvbmUgZGkgY29sbGFib3JhemlvbmUgw6ggYXR0dWFsbWVudGUgaW4gY29yc28uIiwiZGVzY19wZXJzaXN0ZW5jZVdhcm5pbmciOiJUaWVuaSBwcmVzZW50ZSBjaGUgaSBkYXRpIGRlbGxhIHNjZW5hIHNvbm8gY29uZGl2aXNpIHRyYSBpIGNvbGxhYm9yYXRvcmkgaW4gbW9kbyBQMlAgZSBub24gcGVyc2lzdG9ubyBzdWwgbm9zdHJvIHNlcnZlci4gUGVydGFudG8sIHNlIHZpIGRpc2Nvbm5ldHRlcmUgdHV0dGksIHBlcmRlcmV0ZSBpIGRhdGkgYSBtZW5vIGNoZSBub24gbGkgZXNwb3J0aWF0ZSBpbiB1biBmaWxlIG8gaW4gdW4gbGluayBjb25kaXZpc2liaWxlLiIsImRlc2Nfc2hhcmVMaW5rIjoiQ29uZGl2aWRpIHF1ZXN0byBsaW5rIGNvbiBjaGl1bnF1ZSBkZXNpZGVyaSBjb2xsYWJvcmFyZToiLCJkZXNjX2V4aXRTZXNzaW9uIjoiSW50ZXJyb21wZXJlIGxhIHNlc3Npb25lIHNjb2xsZWdoZXLDoCBsYSB0dWEgc3RhbnphIG1hIHBvdHJhaSBjb250aW51YXJlIGEgbGF2b3JhcmUgY29uIGxhIHNjZW5hLCBsb2NhbG1lbnRlLiBUaWVuaSBwcmVzZW50ZSBjaGUgcXVlc3RvIG5vbiBpbmZsdWlyw6Agc3VsbGUgYWx0cmUgcGVyc29uZSwgZSBjaGUgc2FyYW5ubyBhbmNvcmEgaW4gZ3JhZG8gZGkgY29sbGFib3JhcmUgYWxsYSBsb3JvIHZlcnNpb25lLiJ9LCJlcnJvckRpYWxvZyI6eyJ0aXRsZSI6IkVycm9yZSJ9LCJzaG9ydGN1dHNEaWFsb2ciOnsidGl0bGUiOiJTY29yY2lhdG9pZSBkYSB0YXN0aWVyYSIsInNoYXBlcyI6IkZvcm1lIiwib3IiOiJvcHB1cmUiLCJjbGljayI6ImNsaWNrIiwiZHJhZyI6InRyYXNjaW5hIiwiY3VydmVkQXJyb3ciOiJGcmVjY2lhIGN1cnZhIiwiY3VydmVkTGluZSI6IkxpbmVhIGN1cnZhIiwiZWRpdG9yIjoiRWRpdG9yIiwidmlldyI6IlZpc3RhIiwiYmxvZyI6IkxlZ2dpIGlsIG5vc3RybyBibG9nIiwiaG93dG8iOiJTZWd1aSBsZSBub3N0cmUgZ3VpZGUiLCJnaXRodWIiOiJIYWkgdHJvdmF0byB1biBwcm9ibGVtYT8gU2VnbmFsYWxvIiwidGV4dE5ld0xpbmUiOiJBZ2dpdW5naSBudW92YSByaWdhICh0ZXN0bykiLCJ0ZXh0RmluaXNoIjoiQ29tcGxldGEgbGEgbW9kaWZpY2EgKHRlc3RvKSIsInpvb21Ub0ZpdCI6IkFkYXR0YSB6b29tIHBlciBtb3N0cmFyZSB0dXR0aSBnbGkgZWxlbWVudGkifSwiZW5jcnlwdGVkIjp7InRvb2x0aXAiOiJJIHR1b2kgZGlzZWduaSBzb25vIGNyaXR0b2dyYWZhdGkgZW5kLXRvLWVuZCBpbiBtb2RvIGNoZSBpIHNlcnZlciBkaSBFeGNhbGlkcmF3IG5vbiBsaSBwb3NzYW5vIG1haSB2ZWRlcmUuIn0sImNoYXJ0cyI6eyJub051bWVyaWNDb2x1bW4iOiJIYWkgaW5jb2xsYXRvIHVuIGZvZ2xpbyBkaSBjYWxjb2xvIHNlbnphIHVuYSBjb2xvbm5hIG51bWVyaWNhLiIsInRvb01hbnlDb2x1bW5zIjoiSGFpIGluY29sbGF0byB1biBmb2dsaW8gZGkgY2FsY29sbyBjb24gcGnDuSBkaSBkdWUgY29sb25uZS4ifX0nKX0sZnVuY3Rpb24oZSl7ZS5leHBvcnRzPUpTT04ucGFyc2UoJ3sibGFiZWxzIjp7InBhc3RlIjoi6LK844KK5LuY44GRIiwic2VsZWN0QWxsIjoi44GZ44G544Gm6YG45oqeIiwibXVsdGlTZWxlY3QiOiIiLCJtb3ZlQ2FudmFzIjoiIiwiY29weSI6IuOCs+ODlOODvCIsImNvcHlBc1BuZyI6IlBOR+OBqOOBl+OBpuOCr+ODquODg+ODl+ODnOODvOODieOBuOOCs+ODlOODvCIsImNvcHlBc1N2ZyI6IlNWR+OBqOOBl+OBpuOCr+ODquODg+ODl+ODnOODvOODieOBuOOCs+ODlOODvCIsImJyaW5nRm9yd2FyZCI6IuWJjemdouOBq+enu+WLlSIsInNlbmRUb0JhY2siOiLmnIDog4zpnaLjgavnp7vli5UiLCJicmluZ1RvRnJvbnQiOiLmnIDliY3pnaLjgavnp7vli5UiLCJzZW5kQmFja3dhcmQiOiLog4zpnaLjgavnp7vli5UiLCJkZWxldGUiOiLliYrpmaQiLCJjb3B5U3R5bGVzIjoi44K544K/44Kk44Or44Gu44Kz44OU44O8IiwicGFzdGVTdHlsZXMiOiLjgrnjgr/jgqTjg6vjga7osrzjgorku5jjgZEiLCJzdHJva2UiOiLnt5rjga7oibIiLCJiYWNrZ3JvdW5kIjoi6IOM5pmv44Gu6ImyIiwiZmlsbCI6IuWhl+OCiuOBpOOBtuOBlyIsInN0cm9rZVdpZHRoIjoi57ea44Gu5bmFIiwic3Ryb2tlU3R5bGUiOiIiLCJzdHJva2VTdHlsZV9zb2xpZCI6IiIsInN0cm9rZVN0eWxlX2Rhc2hlZCI6IiIsInN0cm9rZVN0eWxlX2RvdHRlZCI6IiIsInNsb3BwaW5lc3MiOiLnt5rjga7jgbDjgonjgaTjgY0iLCJvcGFjaXR5Ijoi6YCP5piO5bqmIiwidGV4dEFsaWduIjoi44OG44Kt44K544OI44Gu6YWN572uIiwiZm9udFNpemUiOiLjg5Xjgqnjg7Pjg4jjga7lpKfjgY3jgZUiLCJmb250RmFtaWx5Ijoi44OV44Kp44Oz44OI44Gu56iu6aGeIiwib25seVNlbGVjdGVkIjoi6YG45oqe5Lit44Gu44G/Iiwid2l0aEJhY2tncm91bmQiOiLog4zmma/jgpLlkKvjgoHjgosiLCJhZGRXYXRlcm1hcmsiOiJcXCJNYWRlIHdpdGggRXhjYWxpZHJhd1xcIuOBqOihqOekuiIsImhhbmREcmF3biI6IuaJi+aPj+OBjemiqCIsIm5vcm1hbCI6IuaZrumAmiIsImNvZGUiOiLjgrPjg7zjg4kiLCJzbWFsbCI6IuWwjyIsIm1lZGl1bSI6IuS4rSIsImxhcmdlIjoi5aSnIiwidmVyeUxhcmdlIjoi54m55aSnIiwic29saWQiOiLjg5njgr/loZfjgooiLCJoYWNodXJlIjoi5pac57eaIiwiY3Jvc3NIYXRjaCI6Iue2suaOm+OBkSIsInRoaW4iOiLntLAiLCJib2xkIjoi5aSq5a2XIiwibGVmdCI6IuW3puWvhOOBmyIsImNlbnRlciI6IuS4reWkruWvhOOBmyIsInJpZ2h0Ijoi5Y+z5a+E44GbIiwiZXh0cmFCb2xkIjoi5qW15aSqIiwiYXJjaGl0ZWN0Ijoi5q2j56K6IiwiYXJ0aXN0Ijoi44Ki44O844OIIiwiY2FydG9vbmlzdCI6Iua8q+eUu+miqCIsImZpbGVUaXRsZSI6IuODleOCoeOCpOODq+WQjSIsImNvbG9yUGlja2VyIjoi6Imy6YG45oqeIiwiY2FudmFzQmFja2dyb3VuZCI6IuOCreODo+ODs+ODkOOCueOBruiDjOaZryIsImRyYXdpbmdDYW52YXMiOiLjgq3jg6Pjg7Pjg5Djgrnjga7mj4/nlLsiLCJsYXllcnMiOiLjg6zjgqTjg6Tjg7wiLCJhY3Rpb25zIjoi5pON5L2cIiwibGFuZ3VhZ2UiOiLoqIDoqp4iLCJjcmVhdGVSb29tIjoi5YWx5ZCM57eo6ZuG44K744OD44K344On44Oz44Gu5YWx5pyJIiwiZHVwbGljYXRlU2VsZWN0aW9uIjoi6KSH6KO9IiwidW50aXRsZWQiOiJVbnRpdGxlZCIsIm5hbWUiOiLlkI3liY0iLCJ5b3VyTmFtZSI6IiIsIm1hZGVXaXRoRXhjYWxpZHJhdyI6IkV4Y2FsaWRyYXfjgafkvZzmiJAiLCJncm91cCI6IiIsInVuZ3JvdXAiOiIiLCJjb2xsYWJvcmF0b3JzIjoiIiwidG9nZ2xlR3JpZE1vZGUiOiIiLCJhZGRUb0xpYnJhcnkiOiIiLCJyZW1vdmVGcm9tTGlicmFyeSI6IiIsImxpYnJhcnlMb2FkaW5nTWVzc2FnZSI6IiJ9LCJidXR0b25zIjp7ImNsZWFyUmVzZXQiOiLjgq3jg6Pjg7Pjg5Djgrnjga7jg6rjgrvjg4Pjg4giLCJleHBvcnQiOiLjgqjjgq/jgrnjg53jg7zjg4giLCJleHBvcnRUb1BuZyI6IlBORyDjgavjgqjjgq/jgrnjg53jg7zjg4giLCJleHBvcnRUb1N2ZyI6IlNWRyDjgavjgqjjgq/jgrnjg53jg7zjg4giLCJjb3B5VG9DbGlwYm9hcmQiOiLjgq/jg6rjg4Pjg5fjg5zjg7zjg4njgavjgrPjg5Tjg7wiLCJjb3B5UG5nVG9DbGlwYm9hcmQiOiLjgq/jg6rjg4Pjg5fjg5zjg7zjg4njgatQTkfjgpLjgrPjg5Tjg7wiLCJzYXZlIjoi5L+d5a2YIiwic2F2ZUFzIjoiIiwibG9hZCI6IuiqreOBv+i+vOOBvy4uLiIsImdldFNoYXJlYWJsZUxpbmsiOiLlhbHmnIlVUkzjga7lj5blvpciLCJjbG9zZSI6IumWieOBmOOCiyIsInNlbGVjdExhbmd1YWdlIjoi6KiA6Kqe44Gu6YG45oqeIiwic2Nyb2xsQmFja1RvQ29udGVudCI6IiIsInpvb21JbiI6IuaLoeWkpyIsInpvb21PdXQiOiLnuK7lsI8iLCJyZXNldFpvb20iOiLmi6HlpKcv57iu5bCP44KS44Oq44K744OD44OIIiwibWVudSI6IuODoeODi+ODpeODvCIsImRvbmUiOiLlrozkuoYiLCJlZGl0Ijoi57eo6ZuGIiwidW5kbyI6IuWFg+OBq+aIu+OBmSIsInJlZG8iOiLjgoTjgornm7TjgZciLCJyb29tRGlhbG9nIjoi5YWx5ZCM57eo6ZuG44KS6ZaL5aeL44GZ44KLIiwiY3JlYXRlTmV3Um9vbSI6IuaWsOOBl+OBhOmDqOWxi+OCkuS9nOaIkOOBmeOCiyIsInRvZ2dsZUZ1bGxTY3JlZW4iOiLlhajnlLvpnaLooajnpLrjgavliIfjgormm7/jgYjjgosiLCJ0b2dnbGVaZW5Nb2RlIjoi6ZuG5Lit44Oi44O844OJ44Gr5YiH44KK5pu/44GI44KLIiwiZXhpdFplbk1vZGUiOiLpm4bkuK3jg6Ljg7zjg4njgpLjgoTjgoHjgosifSwiYWxlcnRzIjp7ImNsZWFyUmVzZXQiOiLjgZPjga7mk43kvZzjgavjgojjgaPjgabjgq3jg6Pjg7Pjg5DjgrnlhajkvZPjgYzmtojjgYjjgb7jgZnjgILjgojjgo3jgZfjgYTjgafjgZnjgYvvvJ8iLCJjb3VsZE5vdENyZWF0ZVNoYXJlYWJsZUxpbmsiOiLlhbHmnIlVUkzjgpLkvZzmiJDjgafjgY3jgb7jgZvjgpPjgafjgZfjgZ/jgIIiLCJjb3VsZE5vdExvYWRJbnZhbGlkRmlsZSI6IueEoeWKueOBquODleOCoeOCpOODq+OCkuiqreOBv+i+vOOCgeOBvuOBm+OCk+OBp+OBl+OBn+OAgiIsImltcG9ydEJhY2tlbmRGYWlsZWQiOiLjgrXjg7zjg5Djg7zjgYvjgonjga7oqq3jgb/ovrzjgb/jgavlpLHmlZfjgZfjgb7jgZfjgZ/jgIIiLCJjYW5ub3RFeHBvcnRFbXB0eUNhbnZhcyI6IuepuuOBruOCreODo+ODs+ODkOOCueOBr+OCqOOCr+OCueODneODvOODiOOBp+OBjeOBvuOBm+OCk+OAgiIsImNvdWxkTm90Q29weVRvQ2xpcGJvYXJkIjoi44Kv44Oq44OD44OX44Oc44O844OJ44Gr44Kz44OU44O844Gn44GN44G+44Gb44KT44CCR29vZ2xlIENocm9tZeOBp+OBiuippuOBl+OBj+OBoOOBleOBhOOAgiIsImRlY3J5cHRGYWlsZWQiOiLjg4fjg7zjgr/jgpLlvqnlj7fjgafjgY3jgb7jgZvjgpPjgafjgZfjgZ/jgIIiLCJ1cGxvYWRlZFNlY3VybHkiOiLjg4fjg7zjgr/jga7jgqLjg4Pjg5fjg63jg7zjg4njga/jgqjjg7Pjg4njg4Tjg7zjgqjjg7Pjg4nmmpflj7fljJbjgavjgojjgaPjgabkv53orbfjgZXjgozjgabjgYTjgb7jgZnjgIJFeGNhbGlkcmF344K144O844OQ44O844Go56ys5LiJ6ICF44Gv44OH44O844K/44Gu5YaF5a6544KS6KaL44KL44GT44Go44GM44Gn44GN44G+44Gb44KT44CCIiwibG9hZFNjZW5lT3ZlcnJpZGVQcm9tcHQiOiIifSwidG9vbEJhciI6eyJzZWxlY3Rpb24iOiLpgbjmip4iLCJkcmF3IjoiIiwicmVjdGFuZ2xlIjoi55+p5b2iIiwiZGlhbW9uZCI6IuOBsuOBl+W9oiIsImVsbGlwc2UiOiLmpZXlhoYiLCJhcnJvdyI6IuefouWNsCIsImxpbmUiOiLnm7Tnt5oiLCJ0ZXh0Ijoi44OG44Kt44K544OIIiwibGlicmFyeSI6IiIsImxvY2siOiLmj4/nlLvlvozjgoLkvb/nlKjkuK3jga7jg4Tjg7zjg6vjgpLpgbjmip7jgZfjgZ/jgb7jgb7jgavjgZnjgosifSwiaGVhZGluZ3MiOnsiY2FudmFzQWN0aW9ucyI6IuOCreODo+ODs+ODkOOCueaTjeS9nCIsInNlbGVjdGVkU2hhcGVBY3Rpb25zIjoi6YG45oqe44GV44KM44Gf5Zuz5b2i44Gr5a++44GZ44KL5pON5L2cIiwic2hhcGVzIjoi5Zuz5b2iIn0sImhpbnRzIjp7ImxpbmVhckVsZW1lbnQiOiIiLCJmcmVlRHJhdyI6IiIsImxpbmVhckVsZW1lbnRNdWx0aSI6IiIsInJlc2l6ZSI6IiIsInJvdGF0ZSI6IiIsImxpbmVFZGl0b3JfaW5mbyI6IiIsImxpbmVFZGl0b3JfcG9pbnRTZWxlY3RlZCI6IiIsImxpbmVFZGl0b3Jfbm90aGluZ1NlbGVjdGVkIjoiIn0sImVycm9yU3BsYXNoIjp7ImhlYWRpbmdNYWluX3ByZSI6IiIsImhlYWRpbmdNYWluX2J1dHRvbiI6IiIsImNsZWFyQ2FudmFzTWVzc2FnZSI6IiIsImNsZWFyQ2FudmFzTWVzc2FnZV9idXR0b24iOiIiLCJjbGVhckNhbnZhc0NhdmVhdCI6IiIsInRyYWNrZWRUb1NlbnRyeV9wcmUiOiIiLCJ0cmFja2VkVG9TZW50cnlfcG9zdCI6IiIsIm9wZW5Jc3N1ZU1lc3NhZ2VfcHJlIjoiIiwib3Blbklzc3VlTWVzc2FnZV9idXR0b24iOiLjg5DjgrDloLHlkYoiLCJvcGVuSXNzdWVNZXNzYWdlX3Bvc3QiOiIiLCJzY2VuZUNvbnRlbnQiOiIifSwicm9vbURpYWxvZyI6eyJkZXNjX2ludHJvIjoi5LuW44Gu5Lq644KS57eo6ZuG5Lit44Gu44GC44Gq44Gf44Gu55S76Z2i44Gr5oub5b6F44GX44Gm5YWx5ZCM57eo6ZuG44GZ44KL44GT44Go44GM44Gn44GN44G+44GZ44CCIiwiZGVzY19wcml2YWN5Ijoi44GT44Gu44K744OD44K344On44Oz44Gv44Ko44Oz44OJ44OE44O844Ko44Oz44OJ5pqX5Y+35YyW44GV44KM44Gm44GK44KK44CB5o+P55S75YaF5a6544Gv5L+d6K2344GV44KM44Gm44GE44G+44GZ44CC6YGL5Za244K144O844OQ44O844GL44KJ44KC5YaF5a6544Gv6KaL44GI44G+44Gb44KT44CCIiwiYnV0dG9uX3N0YXJ0U2Vzc2lvbiI6IuOCu+ODg+OCt+ODp+ODs+OCkumWi+Wni+OBmeOCiyIsImJ1dHRvbl9zdG9wU2Vzc2lvbiI6IuOCu+ODg+OCt+ODp+ODs+OCkue1guS6huOBmeOCiyIsImRlc2NfaW5Qcm9ncmVzc0ludHJvIjoi5YWx5ZCM57eo6ZuG44K744OD44K344On44Oz44GM5pyJ5Yq544Gr44Gq44Gj44Gm44GE44G+44GZ44CCIiwiZGVzY19wZXJzaXN0ZW5jZVdhcm5pbmciOiIiLCJkZXNjX3NoYXJlTGluayI6IuS4i+iomFVSTOOCkuWFseWQjOe3qOmbhuOBl+OBn+OBhOS6uuOBq+WFseacieOBl+OBpuOBj+OBoOOBleOBhO+8miIsImRlc2NfZXhpdFNlc3Npb24iOiIifSwiZXJyb3JEaWFsb2ciOnsidGl0bGUiOiLjgqjjg6njg7wifSwic2hvcnRjdXRzRGlhbG9nIjp7InRpdGxlIjoi44Kt44O844Oc44O844OJ44K344On44O844OI44Kr44OD44OIIiwic2hhcGVzIjoi5Zuz5b2iIiwib3IiOiLjgb7jgZ/jga8iLCJjbGljayI6IuOCr+ODquODg+OCryIsImRyYWciOiLjg4njg6njg4PjgrAiLCJjdXJ2ZWRBcnJvdyI6IuabsuOBjOOBo+OBn+efouWNsCIsImN1cnZlZExpbmUiOiLmm7Lnt5oiLCJlZGl0b3IiOiLjgqjjg4fjgqPjgr8iLCJ2aWV3Ijoi6KGo56S6IiwiYmxvZyI6IuWFrOW8j+ODluODreOCsOOCkuiqreOCgCIsImhvd3RvIjoi44OY44Or44OX44O744Oe44OL44Ol44Ki44OrIiwiZ2l0aHViIjoi5LiN5YW35ZCI5aCx5ZGK44Gv44GT44Gh44KJIiwidGV4dE5ld0xpbmUiOiLjg4bjgq3jgrnjg4jjga7mlLnooYwiLCJ0ZXh0RmluaXNoIjoi44OG44Kt44K544OI44Gu57eo6ZuG44KS57WC44GI44KLIiwiem9vbVRvRml0Ijoi44GZ44G544Gm44Gu5Zuz5b2i44GM5Y+O44G+44KL44KI44GG5ouh5aSnL+e4ruWwjyJ9LCJlbmNyeXB0ZWQiOnsidG9vbHRpcCI6IuaPj+eUu+WGheWuueOBr+OCqOODs+ODieODhOODvOOCqOODs+ODieaal+WPt+WMluOBjOaWveOBleOCjOOBpuOBiuOCiuOAgUV4Y2FsaWRyYXfjgrXjg7zjg5Djg7zjgYzlhoXlrrnjgpLopovjgovjgZPjgajjga/jgafjgY3jgb7jgZvjgpPjgIIifSwiY2hhcnRzIjp7Im5vTnVtZXJpY0NvbHVtbiI6IiIsInRvb01hbnlDb2x1bW5zIjoiIn19Jyl9LGZ1bmN0aW9uKGUpe2UuZXhwb3J0cz1KU09OLnBhcnNlKCd7ImxhYmVscyI6eyJwYXN0ZSI6Iuu2meyXrOuEo+q4sCIsInNlbGVjdEFsbCI6IuyghOyytCDshKDtg50iLCJtdWx0aVNlbGVjdCI6IiIsIm1vdmVDYW52YXMiOiIiLCJjb3B5Ijoi67O17IKs7ZWY6riwIiwiY29weUFzUG5nIjoi7YG066a967O065Oc66GcIFBORyDsnbTrr7jsp4Ag67O17IKsIiwiY29weUFzU3ZnIjoi7YG066a967O065Oc66GcIFNWRyDsnbTrr7jsp4Ag67O17IKsIiwiYnJpbmdGb3J3YXJkIjoi7JWe7Jy866GcIOqwgOyguOyYpOq4sCIsInNlbmRUb0JhY2siOiLrp6gg65Kk66GcIOuztOuCtOq4sCIsImJyaW5nVG9Gcm9udCI6IuunqCDslZ7snLzroZwg6rCA7KC47Jik6riwIiwic2VuZEJhY2t3YXJkIjoi65Kk66GcIOuztOuCtOq4sCIsImRlbGV0ZSI6IuyCreygnCIsImNvcHlTdHlsZXMiOiLsiqTtg4Dsnbwg67O17IKs7ZWY6riwIiwicGFzdGVTdHlsZXMiOiLsiqTtg4Dsnbwg67aZ7Jes64Sj6riwIiwic3Ryb2tlIjoi7ISgIOyDieyDgSIsImJhY2tncm91bmQiOiLrsLDqsr3sg4kiLCJmaWxsIjoi7LGE7Jqw6riwIOyKpO2DgOydvCIsInN0cm9rZVdpZHRoIjoi7ISgIOuRkOq7mCIsInN0cm9rZVN0eWxlIjoiIiwic3Ryb2tlU3R5bGVfc29saWQiOiIiLCJzdHJva2VTdHlsZV9kYXNoZWQiOiIiLCJzdHJva2VTdHlsZV9kb3R0ZWQiOiIiLCJzbG9wcGluZXNzIjoi7ISgIOyKpO2DgOydvCIsIm9wYWNpdHkiOiLrtojtiKzrqoXrj4QiLCJ0ZXh0QWxpZ24iOiLthY3siqTtirgg7KCV66CsIiwiZm9udFNpemUiOiLtj7Dtirgg7YGs6riwIiwiZm9udEZhbWlseSI6Iu2PsO2KuCDsiqTtg4DsnbwiLCJvbmx5U2VsZWN0ZWQiOiLshKDtg53tlZwg7ZWt66qp66eMIiwid2l0aEJhY2tncm91bmQiOiLrsLDqsr0g7Y+s7ZWoIiwiYWRkV2F0ZXJtYXJrIjoiIiwiaGFuZERyYXduIjoi7ZWE6riw7LK0Iiwibm9ybWFsIjoi7J2867CYIiwiY29kZSI6Iuy9lOuTnCIsInNtYWxsIjoi7J6R6rKMIiwibWVkaXVtIjoi67O07Ya1IiwibGFyZ2UiOiLtgazqsowiLCJ2ZXJ5TGFyZ2UiOiLrp6TsmrAg7YGs6rKMIiwic29saWQiOiLri6jsg4kiLCJoYWNodXJlIjoi7Y+J7ZaJ7ISgIiwiY3Jvc3NIYXRjaCI6Iuq1kOywqOyEoCIsInRoaW4iOiLslofqsowiLCJib2xkIjoi6rW16rKMIiwibGVmdCI6IuyZvOyqvSIsImNlbnRlciI6IuqwgOyatOuNsCIsInJpZ2h0Ijoi7Jik66W47Kq9IiwiZXh0cmFCb2xkIjoi66ek7JqwIOq1teqyjCIsImFyY2hpdGVjdCI6IiIsImFydGlzdCI6IiIsImNhcnRvb25pc3QiOiIiLCJmaWxlVGl0bGUiOiLtjIzsnbwg7KCc66qpIiwiY29sb3JQaWNrZXIiOiLsg4nsg4Eg7ISg7YOd6riwIiwiY2FudmFzQmFja2dyb3VuZCI6Iuy6lOuyhOyKpCDrsLDqsr0iLCJkcmF3aW5nQ2FudmFzIjoi7LqU67KE7IqkIOq3uOumrOq4sCIsImxheWVycyI6IuugiOydtOyWtCIsImFjdGlvbnMiOiIiLCJsYW5ndWFnZSI6IuyWuOyWtCIsImNyZWF0ZVJvb20iOiLsi6Tsi5zqsIQg7ZiR7JeFIOyEuOyFmCDqs7XsnKAiLCJkdXBsaWNhdGVTZWxlY3Rpb24iOiLrs7XsoJwiLCJ1bnRpdGxlZCI6IuygnOuqqSDsl4bsnYwiLCJuYW1lIjoiIiwieW91ck5hbWUiOiIiLCJtYWRlV2l0aEV4Y2FsaWRyYXciOiIiLCJncm91cCI6IiIsInVuZ3JvdXAiOiIiLCJjb2xsYWJvcmF0b3JzIjoiIiwidG9nZ2xlR3JpZE1vZGUiOiIiLCJhZGRUb0xpYnJhcnkiOiIiLCJyZW1vdmVGcm9tTGlicmFyeSI6IiIsImxpYnJhcnlMb2FkaW5nTWVzc2FnZSI6IiJ9LCJidXR0b25zIjp7ImNsZWFyUmVzZXQiOiLsupTrsoTsiqQg7LSI6riw7ZmUIiwiZXhwb3J0Ijoi64K067O064K06riwIiwiZXhwb3J0VG9QbmciOiJQTkfroZwg64K067O064K06riwIiwiZXhwb3J0VG9TdmciOiJTVkfroZwg64K067O064K06riwIiwiY29weVRvQ2xpcGJvYXJkIjoi7YG066a967O065Oc66GcIOuzteyCrCIsImNvcHlQbmdUb0NsaXBib2FyZCI6Iu2BtOumveuztOuTnOuhnCBQTkcg7J2066+47KeAIOuzteyCrCIsInNhdmUiOiLsoIDsnqUiLCJzYXZlQXMiOiIiLCJsb2FkIjoi67aI65+s7Jik6riwIiwiZ2V0U2hhcmVhYmxlTGluayI6IuqzteycoCDqsIDriqXtlZwg66eB7YGsIOyDneyEsSIsImNsb3NlIjoi64ur6riwIiwic2VsZWN0TGFuZ3VhZ2UiOiLslrjslrQg7ISg7YOdIiwic2Nyb2xsQmFja1RvQ29udGVudCI6Iuy9mO2FkOy4oCDsmIHsl63snLzroZwg7Iqk7YGs66GkIOydtOuPme2VmOq4sCIsInpvb21JbiI6Iu2ZleuMgCIsInpvb21PdXQiOiLstpXshowiLCJyZXNldFpvb20iOiLspIwg7LSI6riw7ZmUIiwibWVudSI6IuuplOuJtCIsImRvbmUiOiLsmYTro4wiLCJlZGl0Ijoi7IiY7KCVIiwidW5kbyI6IuyLpO2WiSDst6jshowiLCJyZWRvIjoi64uk7IucIOyLpO2WiSIsInJvb21EaWFsb2ciOiLsi6Tsi5zqsIQg7ZiR7JeFIOyLnOyeke2VmOq4sCIsImNyZWF0ZU5ld1Jvb20iOiIiLCJ0b2dnbGVGdWxsU2NyZWVuIjoi7KCE7LK07ZmU66m0IiwidG9nZ2xlWmVuTW9kZSI6IiIsImV4aXRaZW5Nb2RlIjoiIn0sImFsZXJ0cyI6eyJjbGVhclJlc2V0Ijoi66qo65OgIOyekeyXhSDrgrTsmqnsnYQg7LSI6riw7ZmUIO2VqeuLiOuLpC4g6rOE7IaNIOynhO2Wie2VoOq5jOyalD8iLCJjb3VsZE5vdENyZWF0ZVNoYXJlYWJsZUxpbmsiOiLqs7XsnKAg6rCA64ql7ZWcIOunge2BrOulvCDsg53shLHtlaAg7IiYIOyXhuyKteuLiOuLpC4iLCJjb3VsZE5vdExvYWRJbnZhbGlkRmlsZSI6IuycoO2aqO2VmOyngCDslYrsnYAg7YyM7J287J6F64uI64ukLiIsImltcG9ydEJhY2tlbmRGYWlsZWQiOiLshJzrsoTroZzrtoDthLAg67aI65+sIOyYpOyngCDrqrvtlojsirXri4jri6QuIiwiY2Fubm90RXhwb3J0RW1wdHlDYW52YXMiOiLruYgg7LqU67KE7Iqk66W8IOuCtOuztOuCvCDsiJgg7JeG7Iq164uI64ukLiIsImNvdWxkTm90Q29weVRvQ2xpcGJvYXJkIjoi7YG066a9IOuztOuTnOyXkCDrs7Xsgqwg7ZWgIOyImCDsl4bsirXri4jri6QuIENocm9tZSDruIzrnbzsmrDsoIDsl5DshJwg7Iuc64+E7ZW0IOyjvOyEuOyalC4iLCJkZWNyeXB0RmFpbGVkIjoi642w7J207YSw66W8IOuzte2YuO2ZlO2VmOyngCDrqrvtlojsirXri4jri6QuIiwidXBsb2FkZWRTZWN1cmx5Ijoi7JeF66Gc65Oc64qUIOyiheuLqCDqsIQg7JWU7Zi47ZmU66GcIOuztO2YuOuQmOuvgOuhnCBFeGNhbGlkcmF3IOyEnOuyhCDrsI8g7YOA7IKs6rCAIOy9mO2FkOy4oOulvCDsnb3snYQg7IiYIOyXhuyKteuLiOuLpC4iLCJsb2FkU2NlbmVPdmVycmlkZVByb21wdCI6IiJ9LCJ0b29sQmFyIjp7InNlbGVjdGlvbiI6IuyEoO2DnSIsImRyYXciOiIiLCJyZWN0YW5nbGUiOiLsgqzqsIHtmJUiLCJkaWFtb25kIjoi64uk7J207JWE66qs65OcIiwiZWxsaXBzZSI6Iu2DgOybkCIsImFycm93Ijoi7ZmU7IK07ZGcIiwibGluZSI6IuudvOyduCIsInRleHQiOiLthY3siqTtirgiLCJsaWJyYXJ5IjoiIiwibG9jayI6IuyEoO2DneuQnCDrj4Tqtawg7Jyg7KeA7ZWY6riwIn0sImhlYWRpbmdzIjp7ImNhbnZhc0FjdGlvbnMiOiIiLCJzZWxlY3RlZFNoYXBlQWN0aW9ucyI6IiIsInNoYXBlcyI6IiJ9LCJoaW50cyI6eyJsaW5lYXJFbGVtZW50Ijoi7Jes65+sIOygkOydhCDsl7DqsrDtlZjroKTrqbQg7YG066at7ZWY6rOgLCDsp4HshKDsnYQg6re466as66Ck66m0IOuwlOuhnCDrk5zrnpjqt7jtlZjshLjsmpQuIiwiZnJlZURyYXciOiIiLCJsaW5lYXJFbGVtZW50TXVsdGkiOiLrp4jsp4Drp4kg7KeA7KCQ7J2EIO2BtOumre2VmOqxsOuCmCBFc2Mg65iQ64qUIEVudGVyIO2CpOulvCDriIzrn6wg7JmE66OM7ZWY7IS47JqULiIsInJlc2l6ZSI6IiIsInJvdGF0ZSI6IlNISUZUIO2CpOulvCDriITrpbTrqbTshJwg7ZqM7KCE7ZWY66m0IOqwgeuPhOulvCDsoJztlZztlaAg7IiYIOyeiOyKteuLiOuLpC4iLCJsaW5lRWRpdG9yX2luZm8iOiIiLCJsaW5lRWRpdG9yX3BvaW50U2VsZWN0ZWQiOiIiLCJsaW5lRWRpdG9yX25vdGhpbmdTZWxlY3RlZCI6IiJ9LCJlcnJvclNwbGFzaCI6eyJoZWFkaW5nTWFpbl9wcmUiOiIiLCJoZWFkaW5nTWFpbl9idXR0b24iOiLtjpjsnbTsp4Ag7IOI66Gc6rOg7LmoIiwiY2xlYXJDYW52YXNNZXNzYWdlIjoiIiwiY2xlYXJDYW52YXNNZXNzYWdlX2J1dHRvbiI6Iuy6lOuyhOyKpOulvCDstIjquLDtmZQg7KSR7J6F64uI64ukLiIsImNsZWFyQ2FudmFzQ2F2ZWF0IjoiIiwidHJhY2tlZFRvU2VudHJ5X3ByZSI6IiIsInRyYWNrZWRUb1NlbnRyeV9wb3N0IjoiIiwib3Blbklzc3VlTWVzc2FnZV9wcmUiOiIiLCJvcGVuSXNzdWVNZXNzYWdlX2J1dHRvbiI6IiIsIm9wZW5Jc3N1ZU1lc3NhZ2VfcG9zdCI6IiDslYTrnpgg7KCV67O066W8IEdpdEh1YiDsnbTsiojsl5Ag67O17IKsIOuwjyDrtpnsl6zrhKPquLDtlbQg7KO87IS47JqULiIsInNjZW5lQ29udGVudCI6IiJ9LCJyb29tRGlhbG9nIjp7ImRlc2NfaW50cm8iOiLtmITsnqwg7ZmU66m07JeQIOqzteuPmSDsnpHsl4XsnpDrpbwg7LSI64yA7ZW0IO2YkeyXhe2VoCDsiJgg7J6I7Iq164uI64ukLiIsImRlc2NfcHJpdmFjeSI6IuyViOyLrO2VmOyEuOyalCwg7IS47IWY7J2AIOyiheuLqCDqsIQg7JWU7Zi47ZmU66W8IOyCrOyaqe2VmOuvgOuhnCDri7nsi6DsnZgg7J6R7JeF7J2AIOu5hOqzteqwnOuhnCDsnKDsp4DrkJjrqbAg7ISc67KE7KGw7LCo64+EIOyekeyXhSDrgrTsmqnsnYQg7JWMIOyImCDsl4bsirXri4jri6QuIiwiYnV0dG9uX3N0YXJ0U2Vzc2lvbiI6IuyEuOyFmCDsi5zsnpEiLCJidXR0b25fc3RvcFNlc3Npb24iOiLshLjshZgg7KSR64uoIiwiZGVzY19pblByb2dyZXNzSW50cm8iOiLsi6Tsi5zqsIQg7ZiR7JeFIOyEuOyFmOydtCDsp4Ttlokg7KSR7J6F64uI64ukLiIsImRlc2NfcGVyc2lzdGVuY2VXYXJuaW5nIjoiIiwiZGVzY19zaGFyZUxpbmsiOiLqs7Xrj5kg7J6R7JeF7J6Q7JeQ6rKMIOydtCDrp4Htgazrpbwg6rO17Jyg7ZWY7IS47JqULiIsImRlc2NfZXhpdFNlc3Npb24iOiIifSwiZXJyb3JEaWFsb2ciOnsidGl0bGUiOiLsl5Drn6wifSwic2hvcnRjdXRzRGlhbG9nIjp7InRpdGxlIjoi7YKk67O065OcIOuLqOy2le2CpCIsInNoYXBlcyI6Iuq3uOumrOq4sCIsIm9yIjoi65iQ64qUIiwiY2xpY2siOiLtgbTrpq0iLCJkcmFnIjoi65Oc656Y6re4IiwiY3VydmVkQXJyb3ciOiLqs6HshKAg7ZmU7IK07ZGcIiwiY3VydmVkTGluZSI6IuqzoeyEoCIsImVkaXRvciI6Iu2OuOynkSIsInZpZXciOiLrs7TquLAiLCJibG9nIjoi67iU66Gc6re4IOydveyWtOuztOq4sCIsImhvd3RvIjoi6rCA7J2065OcIOywuOqzoO2VmOq4sCIsImdpdGh1YiI6IuydtOyKiCDsoJzrs7TtlZjquLAiLCJ0ZXh0TmV3TGluZSI6IuykhOuwlOq+uOq4sCIsInRleHRGaW5pc2giOiLtjrjsp5Eg7JmE66OMIiwiem9vbVRvRml0IjoiIn0sImVuY3J5cHRlZCI6eyJ0b29sdGlwIjoiIn0sImNoYXJ0cyI6eyJub051bWVyaWNDb2x1bW4iOiIiLCJ0b29NYW55Q29sdW1ucyI6IiJ9fScpfSxmdW5jdGlvbihlKXtlLmV4cG9ydHM9SlNPTi5wYXJzZSgneyJsYWJlbHMiOnsicGFzdGUiOiJMaW0gaW5uIiwic2VsZWN0QWxsIjoiVmVsZyBhbHQiLCJtdWx0aVNlbGVjdCI6IkxlZ2cgdGlsIGVsZW1lbnQgaSB1dHZhbGciLCJtb3ZlQ2FudmFzIjoiRmx5dHQgbGVycmV0ZXQiLCJjb3B5IjoiS29waWVyIiwiY29weUFzUG5nIjoiS29waWVyIHRpbCBQTkciLCJjb3B5QXNTdmciOiJLb3BpZXIgdGlsIHV0a2xpcHBzdGF2bGVuIHNvbSBTVkciLCJicmluZ0ZvcndhcmQiOiJGbHl0dCBmcmFtb3ZlciIsInNlbmRUb0JhY2siOiJTZW5kIGJha2Vyc3QiLCJicmluZ1RvRnJvbnQiOiJGbHl0dCBmb3JyZXN0Iiwic2VuZEJhY2t3YXJkIjoiU2VuZCBiYWtvdmVyIiwiZGVsZXRlIjoiU2xldHQiLCJjb3B5U3R5bGVzIjoiS29waWVyIHN0aWxlciIsInBhc3RlU3R5bGVzIjoiTGltIGlubiBzdGlsZXIiLCJzdHJva2UiOiJTdHJlayIsImJhY2tncm91bmQiOiJCYWtncnVubiIsImZpbGwiOiJGeWxsIiwic3Ryb2tlV2lkdGgiOiJTdHJla3R5a2tlbHNlIiwic3Ryb2tlU3R5bGUiOiJTdHJla3N0aWwiLCJzdHJva2VTdHlsZV9zb2xpZCI6IkhlbHRydWtrZXQiLCJzdHJva2VTdHlsZV9kYXNoZWQiOiJTdGlwbGV0Iiwic3Ryb2tlU3R5bGVfZG90dGVkIjoiUHJpa2tldCIsInNsb3BwaW5lc3MiOiJVamV2bmhldCIsIm9wYWNpdHkiOiJTeW5saWdoZXQiLCJ0ZXh0QWxpZ24iOiJUZWtzdGp1c3RlcmluZyIsImZvbnRTaXplIjoiU2tyaWZ0c3TDuHJyZWxzZSIsImZvbnRGYW1pbHkiOiJGb250ZmFtaWxpZSIsIm9ubHlTZWxlY3RlZCI6Ikt1biB2YWxndGUiLCJ3aXRoQmFja2dyb3VuZCI6Iklua2x1ZGVyIGJha2dydW5uIiwiYWRkV2F0ZXJtYXJrIjoiTGVnZyB0aWwgXFwiTGFnZXQgbWVkIEV4Y2FsaWRyYXdcXCIiLCJoYW5kRHJhd24iOiJIw6VuZHRlZ25ldCIsIm5vcm1hbCI6Ik5vcm1hbCIsImNvZGUiOiJLb2RlIiwic21hbGwiOiJMaXRlbiIsIm1lZGl1bSI6Ik1lZGl1bSIsImxhcmdlIjoiU3RvciIsInZlcnlMYXJnZSI6IlN2w6ZydCBzdG9yIiwic29saWQiOiJIZWxmYXJnZSIsImhhY2h1cmUiOiJTa3JhdmVydCIsImNyb3NzSGF0Y2giOiJLcnlzc2tyYXZlcnQiLCJ0aGluIjoiVHlubiIsImJvbGQiOiJUeWtrIiwibGVmdCI6IlZlbnN0cmUiLCJjZW50ZXIiOiJNaWR0c3RpbGwiLCJyaWdodCI6IkjDuHlyZSIsImV4dHJhQm9sZCI6IkVrc3RyYSB0eWtrIiwiYXJjaGl0ZWN0IjoiQXJraXRla3QiLCJhcnRpc3QiOiJLdW5zdG5lciIsImNhcnRvb25pc3QiOiJUZWduZXIiLCJmaWxlVGl0bGUiOiJGaWxuYXZuIiwiY29sb3JQaWNrZXIiOiJGYXJnZXZlbGdlciIsImNhbnZhc0JhY2tncm91bmQiOiJMZXJyZXRzYmFrZ3J1bm4iLCJkcmF3aW5nQ2FudmFzIjoiTGVycmV0IiwibGF5ZXJzIjoiTGFnIiwiYWN0aW9ucyI6IkhhbmRsaW5nZXIiLCJsYW5ndWFnZSI6IlNwcsOlayIsImNyZWF0ZVJvb20iOiJEZWwgZW4gc2FubnRpZHMtc2FtYXJiZWlkc8O4a3QiLCJkdXBsaWNhdGVTZWxlY3Rpb24iOiJEdXBsaXNlciIsInVudGl0bGVkIjoiVXRlbiBuYXZuIiwibmFtZSI6Ik5hdm4iLCJ5b3VyTmFtZSI6IkRpdHQgbmF2biIsIm1hZGVXaXRoRXhjYWxpZHJhdyI6IkxhZ2V0IG1lZCBFeGNhbGlkcmF3IiwiZ3JvdXAiOiJHcnVwcMOpciB1dHZhbGciLCJ1bmdyb3VwIjoiQXZncnVwcMOpciB1dHZhbGciLCJjb2xsYWJvcmF0b3JzIjoiU2FtYXJiZWlkc3BhcnRuZXJlIiwidG9nZ2xlR3JpZE1vZGUiOiJTbMOlIGF2L3DDpSBydXRlbmV0dCIsImFkZFRvTGlicmFyeSI6IkxlZ2cgdGlsIGkgYmlibGlvdGVrIiwicmVtb3ZlRnJvbUxpYnJhcnkiOiJGamVybiBmcmEgYmlibGlvdGVrIiwibGlicmFyeUxvYWRpbmdNZXNzYWdlIjoiTGFzdGVyIGJpYmxpb3Rlay4uLiJ9LCJidXR0b25zIjp7ImNsZWFyUmVzZXQiOiJUw7htIGxlcnJldGV0IG9nIHRpbGJha2VzdGlsbCBiYWtncnVubnNmYXJnZW4iLCJleHBvcnQiOiJFa3Nwb3J0ZXIiLCJleHBvcnRUb1BuZyI6IkVrc3BvcnRlciB0aWwgUE5HIiwiZXhwb3J0VG9TdmciOiJFa3Nwb3J0ZXIgdGlsIFNWRyIsImNvcHlUb0NsaXBib2FyZCI6IktvcGllciB0aWwgdXRrbGlwcHN0YXZsZSIsImNvcHlQbmdUb0NsaXBib2FyZCI6IktvcGllciBQTkcgdGlsIHV0a2xpcHBzdGF2bGVuIiwic2F2ZSI6IkxhZ3JlIiwic2F2ZUFzIjoiTGFncmUgc29tIiwibG9hZCI6IsOFcG5lIiwiZ2V0U2hhcmVhYmxlTGluayI6IkbDpSBkZWxpbmdzbGVua2UiLCJjbG9zZSI6Ikx1a2siLCJzZWxlY3RMYW5ndWFnZSI6IlZlbGcgc3Byw6VrIiwic2Nyb2xsQmFja1RvQ29udGVudCI6IlNrcm9sbCB0aWxiYWtlIHRpbCBpbm5ob2xkIiwiem9vbUluIjoiWm9vbSBpbm4iLCJ6b29tT3V0IjoiWm9vbSB1dCIsInJlc2V0Wm9vbSI6Ik51bGxzdGlsbCB6b29tIiwibWVudSI6Ik1lbnkiLCJkb25lIjoiRmVyZGlnIiwiZWRpdCI6IlJlZGlnZXIiLCJ1bmRvIjoiQW5ncmUiLCJyZWRvIjoiR2rDuHIgb20iLCJyb29tRGlhbG9nIjoiU3RhcnQgc2FubnRpZHMtc2FtYXJiZWlkIiwiY3JlYXRlTmV3Um9vbSI6Ik9wcHJldHQgZXQgbnl0dCByb20iLCJ0b2dnbGVGdWxsU2NyZWVuIjoiU2tydSBmdWxsc2tqZXJtIGF2L3DDpSIsInRvZ2dsZVplbk1vZGUiOiJTbMOlIGF2L3DDpSB6ZW4tbW9kdXMiLCJleGl0WmVuTW9kZSI6IkF2c2x1dHQgemVuLW1vZHVzIn0sImFsZXJ0cyI6eyJjbGVhclJlc2V0IjoiRGV0dGUgdmlsIHTDuG1tZSBsZXJyZXRldC4gRXIgZHUgc2lra2VyPyIsImNvdWxkTm90Q3JlYXRlU2hhcmVhYmxlTGluayI6Ikt1bm5lIGlra2UgbGFnZSBkZWxiYXIgbGVua2UuIiwiY291bGROb3RMb2FkSW52YWxpZEZpbGUiOiJLdW5uZSBpa2tlIGxhc3RlIGlubiB1Z3lsZGlnIGZpbCIsImltcG9ydEJhY2tlbmRGYWlsZWQiOiJJbXBvcnRlcmluZyBhdiBiYWNrZW5kIGZlaWxldC4iLCJjYW5ub3RFeHBvcnRFbXB0eUNhbnZhcyI6IkthbiBpa2tlIGVrc3BvcnRlcmUgZXQgdG9tdCBsZXJyZXQuIiwiY291bGROb3RDb3B5VG9DbGlwYm9hcmQiOiJLdW5uZSBpa2tlIGtvcGllcmUgdGlsIHV0a2xpcHBzdGF2bGVuLiBQcsO4diBtZWQgbmV0dGxlc2VyZW4gQ2hyb21lLiIsImRlY3J5cHRGYWlsZWQiOiJLdW5uZSBpa2tlIGRla3J5cHRlcmUgZGF0YS4iLCJ1cGxvYWRlZFNlY3VybHkiOiJPcHBsYXN0aW5nZW4gZXIga3J5cHRlcnQgb2cga2FuIGlra2UgbGVzZXMgYXYgRXhjYWxpZHJhdy1zZXJ2ZXJlbiBlbGxlciB0cmVkamVwYXJ0ZXIuIiwibG9hZFNjZW5lT3ZlcnJpZGVQcm9tcHQiOiLDhSBsYXN0ZSBpbm4gZWtzdGVybiB0ZWduaW5nIHZpbCBlcnN0YXR0ZSBkZXQgZWtzaXN0ZXJlbmRlIGlubmhvbGRldC4gw5huc2tlciBkdSDDpSBmb3J0c2V0dGU/In0sInRvb2xCYXIiOnsic2VsZWN0aW9uIjoiVmVsZyIsImRyYXciOiJGcmlow6VuZHN0ZWduaW5nIiwicmVjdGFuZ2xlIjoiUmVrdGFuZ2VsIiwiZGlhbW9uZCI6IkRpYW1hbnQiLCJlbGxpcHNlIjoiRWxsaXBzZSIsImFycm93IjoiUGlsIiwibGluZSI6IkxpbmplIiwidGV4dCI6IlRla3N0IiwibGlicmFyeSI6IkJpYmxpb3RlayIsImxvY2siOiJCZWhvbGQgbWVya2V0IHZlcmt0w7h5IHNvbSBha3RpdnQifSwiaGVhZGluZ3MiOnsiY2FudmFzQWN0aW9ucyI6IkhhbmRsaW5nZXI6IGxlcnJldCIsInNlbGVjdGVkU2hhcGVBY3Rpb25zIjoiSGFuZGxpbmdlcjogdmFsZ3Qgb2JqZWt0Iiwic2hhcGVzIjoiRm9ybWVyIn0sImhpbnRzIjp7ImxpbmVhckVsZW1lbnQiOiJLbGlrayBmb3Igw6Ugc3RhcnRlIGxpbmplIG1lZCBmbGVyZSBwdW5rdGVyLCBlbGxlciBkcmEgZm9yIGVuIGVua2VsIGxpbmplIiwiZnJlZURyYXciOiJLbGlrayBvZyBkcmEsIHNsaXBwIG7DpXIgZHUgZXIgZmVyZGlnIiwibGluZWFyRWxlbWVudE11bHRpIjoiS2xpa2sgcMOlIHNpc3RlIHB1bmt0IGVsbGVyIHRyeWtrIEVzY2FwZSBlbGxlciBFbnRlciBmb3Igw6UgZnVsbGbDuHJlIiwicmVzaXplIjoiRHUga2FuIGJlaG9sZGUgZm9yaG9sZGV0IHZlZCDDpSB0cnlra2UgU0hJRlQgbWVucyBkdSBlbmRyZXIgc3TDuHJyZWxzZSxcXG50cnlrayBBTFQgZm9yIMOlIGVuZHJlIHN0w7hycmVsc2VuIGZyYSBtaWR0ZW4iLCJyb3RhdGUiOiJEdSBrYW4gbMOlc2Ugdmlua2xlbmUgdmVkIMOlIGhvbGRlIFNISUZUIG1lbnMgZHUgcm90ZXJlciIsImxpbmVFZGl0b3JfaW5mbyI6IkRvYmJlbHRrbGlrayBlbGxlciB0cnlrayBFbnRlciBmb3Igw6UgcmVkaWdlcmUgcHVua3RlciIsImxpbmVFZGl0b3JfcG9pbnRTZWxlY3RlZCI6IlRyeWtrIHDDpSBTbGV0dCBmb3Igw6UgZmplcm5lIHB1bmt0ZXQsIEN0cmwgLyBDbWQrRCBmb3Igw6UgZHVwbGlzZXJlLCBlbGxlciBkcmEgZm9yIMOlIGZseXR0ZSIsImxpbmVFZGl0b3Jfbm90aGluZ1NlbGVjdGVkIjoiVmVsZyBldCBwdW5rdCDDpSBmbHl0dGUgZWxsZXIgZmplcm5lLCBlbGxlciBob2xkIEFsdCBvZyBrbGlrayBmb3Igw6UgbGVnZ2UgdGlsIG55ZSBwdW5rdGVyIn0sImVycm9yU3BsYXNoIjp7ImhlYWRpbmdNYWluX3ByZSI6IkVuIGZlaWwgb3Bwc3RvLiBQcsO4diAiLCJoZWFkaW5nTWFpbl9idXR0b24iOiLDpSBsYXN0ZSBzaWRlbiBww6Ugbnl0dC4iLCJjbGVhckNhbnZhc01lc3NhZ2UiOiJPbSBueSBzaWRlbGFzdGluZyBpa2tlIGZ1bmdlcmVyLCBwcsO4diAiLCJjbGVhckNhbnZhc01lc3NhZ2VfYnV0dG9uIjoiw6UgdMO4bW1lIGxlcnJldGV0LiIsImNsZWFyQ2FudmFzQ2F2ZWF0IjoiIERldHRlIHZpbCBmw7hyZSB0aWwgdGFwIGF2IGFyYmVpZCAiLCJ0cmFja2VkVG9TZW50cnlfcHJlIjoiRmVpbGVuIG1lZCBpZGVudGlmaWthdG9yICIsInRyYWNrZWRUb1NlbnRyeV9wb3N0IjoiIGJsZSBsb2dnZXQgaSB2w6VydCBzeXN0ZW0uIiwib3Blbklzc3VlTWVzc2FnZV9wcmUiOiJWaSBlciB2ZWxkaWcgbsO4eWUgbWVkIMOlIGlra2UgaW5rbHVkZXJlIGRpbmUgc2NlbmUtb3BwbHlzbmluZ2VyIGkgZmVpbGVuLiBIdmlzIGRpbiBzY2VuZSBpa2tlIGVyIHByaXZhdCwgdnVyZGVyIMOlIGbDuGxnZSBvcHAgaSB2w6VydCAiLCJvcGVuSXNzdWVNZXNzYWdlX2J1dHRvbiI6ImZlaWxyYXBwb3J0ZXJpbmdzc3lzdGVtLiIsIm9wZW5Jc3N1ZU1lc3NhZ2VfcG9zdCI6IiBUYSBtZWQgb3BwbHlzbmluZ2VuZSBuZWRlbmZvciB2ZWQgw6Uga29waWVyZSBvZyBsaW1lIGlubiBpIEdpdEh1Yi1zYWtlbi4iLCJzY2VuZUNvbnRlbnQiOiJTY2VuZS1pbm5ob2xkOiJ9LCJyb29tRGlhbG9nIjp7ImRlc2NfaW50cm8iOiJEdSBrYW4gaW52aXRlcmUgcGVyc29uZXIgdGlsIHNjZW5lbiBkaW4gZm9yIMOlIHNhbWFyYmVpZGUgbWVkIGRlZy4iLCJkZXNjX3ByaXZhY3kiOiJUYSBkZXQgbWVkIHJvLCBzZXNqb25lbiBicnVrZXIgZW5kZS10aWwtZW5kZS1rcnlwdGVyaW5nLCBzw6UgYWx0IGR1IHRlZ25lciBmb3JibGlyIHByaXZhdC4gSWtrZSBlbiBnYW5nIHNlcnZlcmVuIHbDpXIga2FuIHNlIGh2YSBkdSBsYWdlci4iLCJidXR0b25fc3RhcnRTZXNzaW9uIjoiU3RhcnQgw7hrdCIsImJ1dHRvbl9zdG9wU2Vzc2lvbiI6IlN0b3BwIHNlc2pvbiIsImRlc2NfaW5Qcm9ncmVzc0ludHJvIjoiU2FubnRpZHMtc2FtYXJiZWlkc8O4a3QgZXIgbsOlIGkgZ2FuZy4iLCJkZXNjX3BlcnNpc3RlbmNlV2FybmluZyI6IlbDpnIgb3BwbWVya3NvbSBww6UgYXQgc2NlbmUtZGF0YSBkZWxlcyBww6UgdHZlcnMgYXYgc2FtYXJiZWlkc3BhcnRuZXJlIHDDpSBlbiBQMlAtbcOldGUsIG9nIGVyIGlra2UgbGFncmV0IHDDpSBzZXJ2ZXJlbiB2w6VyLiBEZXR0ZSBiZXR5ciBhdCBodmlzIGFsbGUga29ibGVyIGZyYSwgbWlzdGVyIGR1IGRhdGFlbmUgbWVkIG1pbmRyZSBkdSBla3Nwb3J0ZXJlciBkZW0gdGlsIGVuIGZpbCBlbGxlciBlbiBkZWxiYXIgbGVua2UuIiwiZGVzY19zaGFyZUxpbmsiOiJEZWwgZGVubmUgbGlua2VuIG1lZCBkZSBkdSB2aWwgc2FtYXJiZWlkZSBtZWQ6IiwiZGVzY19leGl0U2Vzc2lvbiI6IkRlcnNvbSBkdSBhdnNsdXR0ZXIgc2Vzam9uZW4gYmxpciBkdSBmcmFrb2JsZXQgcm9tbWV0LCBtZW4gZHUga2FuIGZvcnRzZXR0ZSDDpSBhcmJlaWRlIG1lZCBzY2VuZW4gbG9rYWx0LiBWw6ZyIG9wcG1lcmtzb20gcMOlIGF0IGRldHRlIGlra2UgdmlsIHDDpXZpcmtlIGFuZHJlIHBlcnNvbmVyLCBvZyBkZSB2aWwgZm9ydHNhdHQgaGEgbXVsaWdoZXQgdGlsIMOlIHNhbWFyYmVpZGUgcMOlIGRlcmVzIHZlcnNqb24uIn0sImVycm9yRGlhbG9nIjp7InRpdGxlIjoiRmVpbCJ9LCJzaG9ydGN1dHNEaWFsb2ciOnsidGl0bGUiOiJUYXN0YXR1cnNuYXJ2ZWllciIsInNoYXBlcyI6IkZpZ3VyZXIiLCJvciI6ImVsbGVyIiwiY2xpY2siOiJrbGlrayIsImRyYWciOiJkcmEiLCJjdXJ2ZWRBcnJvdyI6IkJ1ZXQgcGlsIiwiY3VydmVkTGluZSI6IkJ1ZXQgbGluamUiLCJlZGl0b3IiOiJSZWRpZ2VyaW5nIiwidmlldyI6IlZpc25pbmciLCJibG9nIjoiTGVzIGJsb2dnZW4gdsOlciIsImhvd3RvIjoiRsO4bGcgdsOlcmUgdmVpbGVkbmluZ2VyIiwiZ2l0aHViIjoiRnVubmV0IGV0IHByb2JsZW0/IFNlbmQgaW5uIiwidGV4dE5ld0xpbmUiOiJMZWdnIHRpbCBueSBsaW5qZSAodGVrc3QpIiwidGV4dEZpbmlzaCI6IkZ1bGxmw7hyIHJlZGlnZXJpbmcgKHRla3N0KSIsInpvb21Ub0ZpdCI6Ilpvb20gZm9yIMOlIHBhc3NlIGFsbGUgZWxlbWVudGVuZSJ9LCJlbmNyeXB0ZWQiOnsidG9vbHRpcCI6IkRpbmUgdGVnbmluZ2VyIGVyIGVuZGUtdGlsLWVuZGUta3J5cHRlcnRlIHNsaWsgYXQgRXhjYWxpZHJhdyBzaW5lIHNlcnZlcmUgYWxkcmkgdmlsIHNlIGRlbS4ifSwiY2hhcnRzIjp7Im5vTnVtZXJpY0NvbHVtbiI6IkR1IGxpbXRlIGlubiBldCByZWduZWFyayB1dGVuIGVuIG51bWVyaXNrIGtvbG9ubmUuIiwidG9vTWFueUNvbHVtbnMiOiJEdSBsaW10ZSBpbm4gZXQgcmVnbmVhcmsgbWVkIG1lciBlbm4gdG8ga29sb25uZXIuIn19Jyl9LGZ1bmN0aW9uKGUpe2UuZXhwb3J0cz1KU09OLnBhcnNlKCd7ImxhYmVscyI6eyJwYXN0ZSI6IlBsYWtrZW4iLCJzZWxlY3RBbGwiOiJBbGxlcyBzZWxlY3RlcmVuIiwibXVsdGlTZWxlY3QiOiIiLCJtb3ZlQ2FudmFzIjoiIiwiY29weSI6IktvcGnDq3JlbiIsImNvcHlBc1BuZyI6IktvcGllZXIgYWxzIFBORyIsImNvcHlBc1N2ZyI6IktvcGllZXIgYWxzIFNWRyIsImJyaW5nRm9yd2FyZCI6IkJyZW5nIG5hYXIgdm9yZW4iLCJzZW5kVG9CYWNrIjoiQnJlbmcgbmFhciBhY2h0ZXJncm9uZCIsImJyaW5nVG9Gcm9udCI6IkJyZW5nIG5hYXIgdm9vcmdyb25kIiwic2VuZEJhY2t3YXJkIjoiQnJlbmcgbmFhciBhY2h0ZXIiLCJkZWxldGUiOiJWZXJ3aWpkZXJlbiIsImNvcHlTdHlsZXMiOiJTdGlqbCBrb3Bpw6tyZW4iLCJwYXN0ZVN0eWxlcyI6IlN0aWpsIHBsYWtrZW4iLCJzdHJva2UiOiJMaWpuIiwiYmFja2dyb3VuZCI6IkFjaHRlcmdyb25kIiwiZmlsbCI6IkludnVsbGluZyIsInN0cm9rZVdpZHRoIjoiTGlqbmJyZWVkdGUiLCJzdHJva2VTdHlsZSI6IiIsInN0cm9rZVN0eWxlX3NvbGlkIjoiIiwic3Ryb2tlU3R5bGVfZGFzaGVkIjoiIiwic3Ryb2tlU3R5bGVfZG90dGVkIjoiIiwic2xvcHBpbmVzcyI6IlNsb3JkaWdoZWlkIiwib3BhY2l0eSI6IkRvb3J6aWNodGlnaGVpZCIsInRleHRBbGlnbiI6IlVpdGxpam5pbmciLCJmb250U2l6ZSI6IlRla3N0Z3Jvb3R0ZSIsImZvbnRGYW1pbHkiOiJMZXR0ZXJ0eXBlIiwib25seVNlbGVjdGVkIjoiRW5rZWwgZ2VzZWxlY3RlZXJkZSIsIndpdGhCYWNrZ3JvdW5kIjoiTWV0IGFjaHRlcmdyb25kIiwiYWRkV2F0ZXJtYXJrIjoiVm9lZyBcXCJHZW1hYWt0IG1ldCBFeGNhbGlkcmF3XFwiIHRvZSIsImhhbmREcmF3biI6IkhhbmRnZXRla2VuZCIsIm5vcm1hbCI6Ik5vcm1hYWwiLCJjb2RlIjoiQ29kZSIsInNtYWxsIjoiS2xlaW4iLCJtZWRpdW0iOiJNZWRpdW0iLCJsYXJnZSI6Ikdyb290IiwidmVyeUxhcmdlIjoiWmVlciBncm9vdCIsInNvbGlkIjoiSW5nZWtsZXVyZCIsImhhY2h1cmUiOiJBcmNlcmluZyIsImNyb3NzSGF0Y2giOiJUd2VlbWFhbCBnZWFyY2VlcmQiLCJ0aGluIjoiRHVuIiwiYm9sZCI6IlZldCIsImxlZnQiOiJMaW5rcyIsImNlbnRlciI6Ik1pZGRlbiIsInJpZ2h0IjoiUmVjaHRzIiwiZXh0cmFCb2xkIjoiWndhYXIiLCJhcmNoaXRlY3QiOiJBcmNoaXRlY3QiLCJhcnRpc3QiOiJBcnRpZXN0IiwiY2FydG9vbmlzdCI6IkNhcnRvb25pc3QiLCJmaWxlVGl0bGUiOiJCZXN0YW5kc25hYW0iLCJjb2xvclBpY2tlciI6IktsZXVyZW5raWV6ZXIiLCJjYW52YXNCYWNrZ3JvdW5kIjoiQ2FudmFzIGFjaHRlcmdyb25kIiwiZHJhd2luZ0NhbnZhcyI6IkNhbnZhcyIsImxheWVycyI6IkxhZ2VuIiwiYWN0aW9ucyI6IkFjdGllcyIsImxhbmd1YWdlIjoiVGFhbCIsImNyZWF0ZVJvb20iOiJEZWVsIGVlbiBsaXZlLXNhbWVud2Vya2luZ3NzZXNzaWUiLCJkdXBsaWNhdGVTZWxlY3Rpb24iOiJEdXBsaWNlZXIiLCJ1bnRpdGxlZCI6Ik5hYW1sb29zIiwibmFtZSI6Ik5hYW0iLCJ5b3VyTmFtZSI6IkpvdXcgbmFhbSIsIm1hZGVXaXRoRXhjYWxpZHJhdyI6IkdlbWFha3QgbWV0IEV4Y2FsaWRyYXciLCJncm91cCI6IiIsInVuZ3JvdXAiOiIiLCJjb2xsYWJvcmF0b3JzIjoiIiwidG9nZ2xlR3JpZE1vZGUiOiIiLCJhZGRUb0xpYnJhcnkiOiIiLCJyZW1vdmVGcm9tTGlicmFyeSI6IiIsImxpYnJhcnlMb2FkaW5nTWVzc2FnZSI6IiJ9LCJidXR0b25zIjp7ImNsZWFyUmVzZXQiOiJDYW52YXMgb3BuaWV1dyBpbnN0ZWxsZW4iLCJleHBvcnQiOiJFeHBvcnRlcmVuIiwiZXhwb3J0VG9QbmciOiJFeHBvcnRlcmVuIG5hYXIgUE5HIiwiZXhwb3J0VG9TdmciOiJFeHBvcnRlcmVuIG5hYXIgU1ZHIiwiY29weVRvQ2xpcGJvYXJkIjoiS29waWVlciIsImNvcHlQbmdUb0NsaXBib2FyZCI6IktvcGllZXIgYWxzIFBORyIsInNhdmUiOiJPcHNsYWFuIiwic2F2ZUFzIjoiIiwibG9hZCI6Ik9wZW4iLCJnZXRTaGFyZWFibGVMaW5rIjoiTWFhayBlZW4gZGVlbGJhcmUgbGluayIsImNsb3NlIjoiU2x1aXRlbiIsInNlbGVjdExhbmd1YWdlIjoiVGFhbCBzZWxlY3RlcmVuIiwic2Nyb2xsQmFja1RvQ29udGVudCI6IlNjcm9sbCB0ZXJ1ZyBuYWFyIGluaG91ZCIsInpvb21JbiI6Ikluem9vbWVuIiwiem9vbU91dCI6IlVpdHpvb21lbiIsInJlc2V0Wm9vbSI6Ilpvb20gdGVydWd6ZXR0ZW4iLCJtZW51IjoiTWVudSIsImRvbmUiOiJLbGFhciIsImVkaXQiOiJCZXdlcmtlbiIsInVuZG8iOiJPbmdlZGFhbiBtYWtlbiIsInJlZG8iOiJIZXJzdGVsIG9uZ2VkYWFuIG1ha2VuIiwicm9vbURpYWxvZyI6IkxpdmUtc2FtZW53ZXJraW5nc3Nlc3NpZSBzdGFydGVuIiwiY3JlYXRlTmV3Um9vbSI6IkNyZcOrZXIgbGl2ZS1zYW1lbndlcmtpbmdzc2Vzc2llIiwidG9nZ2xlRnVsbFNjcmVlbiI6IlNjaGVybXZ1bGxlbmRlIHdlZXJnYXZlIiwidG9nZ2xlWmVuTW9kZSI6IiIsImV4aXRaZW5Nb2RlIjoiIn0sImFsZXJ0cyI6eyJjbGVhclJlc2V0IjoiRGl0IHphbCBoZXQgaGVsZSBjYW52YXMgdmVyd2lqZGVyZW4uIEJlbiBqZSB6ZWtlcj8iLCJjb3VsZE5vdENyZWF0ZVNoYXJlYWJsZUxpbmsiOiJLb24gZ2VlbiBkZWVsYmFyZSBsaW5rIGFhbm1ha2VuLiIsImNvdWxkTm90TG9hZEludmFsaWRGaWxlIjoiS2FuIG9uZ2VsZGlnIGJlc3RhbmQgbmlldCBsYWRlbiIsImltcG9ydEJhY2tlbmRGYWlsZWQiOiJJbXBvcnRlcmVuIHZhbnVpdCBiYWNrZW5kIG1pc2x1a3QuIiwiY2Fubm90RXhwb3J0RW1wdHlDYW52YXMiOiJLYW4gZ2VlbiBsZWVnIGNhbnZhcyBleHBvcnRlcmVuLiIsImNvdWxkTm90Q29weVRvQ2xpcGJvYXJkIjoiS2FuIG5pZXQga29wacOrcmVuLiBQcm9iZWVyIGluIGRlIENocm9tZS1icm93c2VyLiIsImRlY3J5cHRGYWlsZWQiOiJLYW4gZ2VnZXZlbnMgbmlldCBkZWNvZGVyZW4uIiwidXBsb2FkZWRTZWN1cmx5IjoiRGUgdXBsb2FkIGlzIGJldmVpbGlnZCBtZXQgZW5kLXRvLWVuZCBlbmNyeXB0aWUsIHdhdCBiZXRla2VudCBkYXQgZGUgRXhjYWxpZHJhdyBzZXJ2ZXIgZW4gZGVyZGVuIGRlIGluaG91ZCBuaWV0IGt1bm5lbiBsZXplbi4iLCJsb2FkU2NlbmVPdmVycmlkZVByb21wdCI6IiJ9LCJ0b29sQmFyIjp7InNlbGVjdGlvbiI6IlNlbGVjdGllIiwiZHJhdyI6IiIsInJlY3RhbmdsZSI6IlJlY2h0aG9layIsImRpYW1vbmQiOiJSdWl0IiwiZWxsaXBzZSI6Ik92YWFsIiwiYXJyb3ciOiJQaWpsIiwibGluZSI6Ikxpam4iLCJ0ZXh0IjoiVGVrc3QiLCJsaWJyYXJ5IjoiIiwibG9jayI6Ikdlc2VsZWN0ZWVyZGUgdG9vbCBhY3RpZWYgaG91ZGVuIG5hIHRla2VuZW4ifSwiaGVhZGluZ3MiOnsiY2FudmFzQWN0aW9ucyI6IkNhbnZhc2FjdGllcyIsInNlbGVjdGVkU2hhcGVBY3Rpb25zIjoiQWN0aWVzIHZhbiBnZXNlbGVjdGVlcmRlIHZvcm0iLCJzaGFwZXMiOiJWb3JtZW4ifSwiaGludHMiOnsibGluZWFyRWxlbWVudCI6IktsaWsgb20gbWVlcmRlcmUgcHVudGVuIHRlIHN0YXJ0ZW4sIHNsZWVwIHZvb3Igw6nDqW4gbGlqbiIsImZyZWVEcmF3IjoiIiwibGluZWFyRWxlbWVudE11bHRpIjoiS2xpayBvcCBoZXQgbGFhdHN0ZSBwdW50IG9mIGRydWsgb3AgRXNjYXBlIG9mIEVudGVyIG9tIHRlIHN0b3BwZW4iLCJyZXNpemUiOiIiLCJyb3RhdGUiOiJKZSBrYW4gaG9la2VuIGJlcGVya2VuIGRvb3IgU0hJRlQgaW5nZWRydWt0IHRlIGhvdWRlbiB3YW5uZWVyIGplIGRyYWFpdCIsImxpbmVFZGl0b3JfaW5mbyI6IiIsImxpbmVFZGl0b3JfcG9pbnRTZWxlY3RlZCI6IiIsImxpbmVFZGl0b3Jfbm90aGluZ1NlbGVjdGVkIjoiIn0sImVycm9yU3BsYXNoIjp7ImhlYWRpbmdNYWluX3ByZSI6IkZvdXQgb3BnZXRyZWRlbi4gUHJvYmVlciAiLCJoZWFkaW5nTWFpbl9idXR0b24iOiJkZSBwYWdpbmEgb3BuaWV1dyBsYWRlbi4iLCJjbGVhckNhbnZhc01lc3NhZ2UiOiJBbHMgaGVybGFkZW4gbmlldCB3ZXJrdCwgcHJvYmVlciAiLCJjbGVhckNhbnZhc01lc3NhZ2VfYnV0dG9uIjoiaGV0IGNhbnZhcyB0ZSB3aXNzZW4uIiwiY2xlYXJDYW52YXNDYXZlYXQiOiIgRGl0IHphbCBsZWlkZW4gdG90IHZlcmxpZXMgdmFuIGplIHdlcmsgIiwidHJhY2tlZFRvU2VudHJ5X3ByZSI6IkRlIGZvdXQgbWV0IElEICIsInRyYWNrZWRUb1NlbnRyeV9wb3N0IjoiIHdhcyBnZXZvbGdkIG9wIG9ucyBzeXN0ZWVtLiIsIm9wZW5Jc3N1ZU1lc3NhZ2VfcHJlIjoiV2Ugd2FyZW4gdm9vcnppY2h0aWcgb20gamUgc2PDqG5lLWluZm9ybWF0aWUgbmlldCBpbiBkZSBmb3V0IHRvZSB0ZSB2b2VnZW4uIEFscyBqZSBzY8OobmUgbmlldCBwcml2w6kgaXMsIG92ZXJ3ZWVnIGRhbiBhbHN0dWJsaWVmdCBoZXQgb3B2b2xnZW4gb3Agb256ZSAiLCJvcGVuSXNzdWVNZXNzYWdlX2J1dHRvbiI6ImJ1ZyB0cmFja2VyLiIsIm9wZW5Jc3N1ZU1lc3NhZ2VfcG9zdCI6IiBLb3BpZWVyIGRlIGluZm9ybWF0aWUgaGllcm9uZGVyIHRvZSBpbiBkZSBHaXRIdWIgaXNzdWUuIiwic2NlbmVDb250ZW50IjoiU2PDqG5lLWluaG91ZDoifSwicm9vbURpYWxvZyI6eyJkZXNjX2ludHJvIjoiSmUga3VudCBtZW5zZW4gdWl0bm9kaWdlbiBvbSBtZXQgamUgc2FtZW4gdGUgd2Vya2VuLiIsImRlc2NfcHJpdmFjeSI6IkdlZW4gem9yZ2VuLCBkZSBzZXNzaWUgZ2VicnVpa3QgZW5kLXRvLWVuZCBlbmNyeXB0aWUsIGR1cyB3YXQgamUgdGVrZW50IGJsaWpmdCBwcml2w6kuIFplbGZzIG9uemUgc2VydmVyIHphbCBuaWV0IGt1bm5lbiB6aWVuIHdhdCBqZSB0ZWtlbnQuIiwiYnV0dG9uX3N0YXJ0U2Vzc2lvbiI6IlNlc3NpZSBzdGFydGVuIiwiYnV0dG9uX3N0b3BTZXNzaW9uIjoiU2Vzc2llIGFmYnJla2VuIiwiZGVzY19pblByb2dyZXNzSW50cm8iOiJEZSBsaXZlLXNhbWVud2Vya2luZ3NzZXNzaWUgaXMgbnUgZ2VzdGFydC4iLCJkZXNjX3BlcnNpc3RlbmNlV2FybmluZyI6IiIsImRlc2Nfc2hhcmVMaW5rIjoiRGVlbCBkZXplIGxpbmsgbWV0IGllZGVyZWVuIHdhYXJtZWUgamUgd2lsIHNhbWVud2Vya2VuOiIsImRlc2NfZXhpdFNlc3Npb24iOiIifSwiZXJyb3JEaWFsb2ciOnsidGl0bGUiOiJGb3V0In0sInNob3J0Y3V0c0RpYWxvZyI6eyJ0aXRsZSI6IlNuZWx0b2V0c2VuIiwic2hhcGVzIjoiVm9ybWVuIiwib3IiOiJvZiIsImNsaWNrIjoia2xpayIsImRyYWciOiJzbGVwZW4iLCJjdXJ2ZWRBcnJvdyI6IkdlYm9nZW4gcGlqbCIsImN1cnZlZExpbmUiOiJHZWJvZ2VuIGxpam4iLCJlZGl0b3IiOiJFZGl0b3IiLCJ2aWV3IjoiV2VlcmdhdmUiLCJibG9nIjoiTGVlcyBvbnplIGJsb2ciLCJob3d0byI6IlZvbGcgb256ZSBoYW5kbGVpZGluZ2VuIiwiZ2l0aHViIjoiUHJvYmxlZW0gZ2V2b25kZW4/IFN0dXVyIGVlbiBuaWV1d2UgaXNzdWUiLCJ0ZXh0TmV3TGluZSI6Ik5pZXV3ZSByZWdlbCB0b2V2b2VnZW4gKHRla3N0KSIsInRleHRGaW5pc2giOiJWb2x0b29pIGJld2Vya2VuICh0ZWtzdCkiLCJ6b29tVG9GaXQiOiJab29tIGluIG9wIGFsbGUgZWxlbWVudGVuIn0sImVuY3J5cHRlZCI6eyJ0b29sdGlwIjoiIn0sImNoYXJ0cyI6eyJub051bWVyaWNDb2x1bW4iOiIiLCJ0b29NYW55Q29sdW1ucyI6IiJ9fScpfSxmdW5jdGlvbihlKXtlLmV4cG9ydHM9SlNPTi5wYXJzZSgneyJsYWJlbHMiOnsicGFzdGUiOiJMaW0gaW5uIiwic2VsZWN0QWxsIjoiVmVsIGFsdCIsIm11bHRpU2VsZWN0IjoiTGVnZyB0aWwgZWxlbWVudCBpIHV0dmFsIiwibW92ZUNhbnZhcyI6IkZseXR0IGxlcnJldGV0IiwiY29weSI6IktvcGllciIsImNvcHlBc1BuZyI6IktvcGllciB0aWwgdXRrbGlwcHN0YXZsYSBzb20gUE5HIiwiY29weUFzU3ZnIjoiS29waWVyIHRpbCB1dGtsaXBwc3RhdmxhIHNvbSBTVkciLCJicmluZ0ZvcndhcmQiOiJGbHl0dCBmcmFtb3ZlciIsInNlbmRUb0JhY2siOiJTZW5kIGhlaWx0IGJhayIsImJyaW5nVG9Gcm9udCI6IkZseXR0IGhlaWx0IGZyYW0iLCJzZW5kQmFja3dhcmQiOiJTZW5kIGJha292ZXIiLCJkZWxldGUiOiJTbGV0dCIsImNvcHlTdHlsZXMiOiJLb3BpZXIgc3RpbGFyIiwicGFzdGVTdHlsZXMiOiJMaW0gaW5uIHN0aWxhciIsInN0cm9rZSI6IlN0cmVrIiwiYmFja2dyb3VuZCI6IkJha2dydW5uIiwiZmlsbCI6IkZ5bGwiLCJzdHJva2VXaWR0aCI6IlN0cmVrYnJlaWRkIiwic3Ryb2tlU3R5bGUiOiJTdHJla3N0aWwiLCJzdHJva2VTdHlsZV9zb2xpZCI6IlNvbGlkIiwic3Ryb2tlU3R5bGVfZGFzaGVkIjoiU3RpcGxhIiwic3Ryb2tlU3R5bGVfZG90dGVkIjoiUHJpa2thIiwic2xvcHBpbmVzcyI6IlVqYW1uaGVpdCIsIm9wYWNpdHkiOiJTeW5sZWdoZWl0IiwidGV4dEFsaWduIjoiVGVrc3RqdXN0ZXJpbmciLCJmb250U2l6ZSI6IlNrcmlmdHN0b3JsZWlrIiwiZm9udEZhbWlseSI6IlNrcmlmdHR5cGUiLCJvbmx5U2VsZWN0ZWQiOiJLdW4gdmFsZGUiLCJ3aXRoQmFja2dyb3VuZCI6Iklua2x1ZGVyIGJha2dydW5uIiwiYWRkV2F0ZXJtYXJrIjoiTGVnZyB0aWwgwqtMYWdhIG1lZCBFeGNhbGlkcmF3wrsiLCJoYW5kRHJhd24iOiJIYW5kdGVpa25hIiwibm9ybWFsIjoiTm9ybWFsIiwiY29kZSI6IktvZGUiLCJzbWFsbCI6IkxpdGVuIiwibWVkaXVtIjoiTWVkaXVtIiwibGFyZ2UiOiJTdG9yIiwidmVyeUxhcmdlIjoiU3bDpnJ0IHN0b3IiLCJzb2xpZCI6IlNvbGlkIiwiaGFjaHVyZSI6IlNrcmF2ZXJ0IiwiY3Jvc3NIYXRjaCI6IktyeXNza3JhdmVydCIsInRoaW4iOiJUeW5uIiwiYm9sZCI6IlRqdWtrIiwibGVmdCI6IlZlbnN0cmUiLCJjZW50ZXIiOiJNaWRzdGlsbCIsInJpZ2h0IjoiSMO4Z3JlIiwiZXh0cmFCb2xkIjoiRWtzdHJhIHRqdWtrIiwiYXJjaGl0ZWN0IjoiQXJraXRla3QiLCJhcnRpc3QiOiJLdW5zdG5hciIsImNhcnRvb25pc3QiOiJUZWlrbmFyIiwiZmlsZVRpdGxlIjoiRmlsbmFtbiIsImNvbG9yUGlja2VyIjoiRmFyZ2V2ZWxqYXIiLCJjYW52YXNCYWNrZ3JvdW5kIjoiTGVycmV0c2Jha2dydW5uIiwiZHJhd2luZ0NhbnZhcyI6IkxlcnJldCIsImxheWVycyI6IkxhZyIsImFjdGlvbnMiOiJIYW5kbGluZ2FyIiwibGFuZ3VhZ2UiOiJTcHLDpWsiLCJjcmVhdGVSb29tIjoiRGVsIGVpIHNhbm50aWRzLXNhbWFyYmVpZHPDuGt0IiwiZHVwbGljYXRlU2VsZWN0aW9uIjoiRHVwbGlzZXIiLCJ1bnRpdGxlZCI6IlV0YW4gbmFtbiIsIm5hbWUiOiJOYW1uIiwieW91ck5hbWUiOiJOYW1uZXQgZGl0dCIsIm1hZGVXaXRoRXhjYWxpZHJhdyI6IkxhZ2EgbWVkIEV4Y2FsaWRyYXciLCJncm91cCI6IkdydXBwZXIgdXR2YWwiLCJ1bmdyb3VwIjoiQXZncnVwcGVyIHV0dmFsIiwiY29sbGFib3JhdG9ycyI6IlNhbWFyYmVpZGFyYXIiLCJ0b2dnbGVHcmlkTW9kZSI6IlNsYSBww6UvYXYgcnV0ZW5ldHQiLCJhZGRUb0xpYnJhcnkiOiJMZWdnIHRpbCBpIGJpYmxpb3RlayIsInJlbW92ZUZyb21MaWJyYXJ5IjoiRmplcm4gZnLDpSBiaWJsaW90ZWsiLCJsaWJyYXJ5TG9hZGluZ01lc3NhZ2UiOiJMYXN0ZXIgYmlibGlvdGVrLi4uIn0sImJ1dHRvbnMiOnsiY2xlYXJSZXNldCI6IlRpbGJha2VzdGlsbCBsZXJyZXRldCIsImV4cG9ydCI6IkVrc3BvcnRlciIsImV4cG9ydFRvUG5nIjoiRWtzcG9ydGVyIHRpbCBQTkciLCJleHBvcnRUb1N2ZyI6IkVrc3BvcnRlciB0aWwgU1ZHIiwiY29weVRvQ2xpcGJvYXJkIjoiS29waWVyIHRpbCB1dGtsaXBwc3RhdmxhIiwiY29weVBuZ1RvQ2xpcGJvYXJkIjoiS29waWVyIFBORyB0aWwgdXRrbGlwcHN0YXZsYSIsInNhdmUiOiJMYWdyZSIsInNhdmVBcyI6IkxhZ3JlIHNvbSIsImxvYWQiOiJPcG5lIiwiZ2V0U2hhcmVhYmxlTGluayI6IkhlbnQgZGVsaW5nc2xlbmtlIiwiY2xvc2UiOiJMdWtrIiwic2VsZWN0TGFuZ3VhZ2UiOiJWZWwgc3Byw6VrIiwic2Nyb2xsQmFja1RvQ29udGVudCI6IlNrcm9sbCB0aWxiYWtlIHRpbCBpbm5oYWxkIiwiem9vbUluIjoiWm9vbSBpbm4iLCJ6b29tT3V0IjoiWm9vbSB1dCIsInJlc2V0Wm9vbSI6Ik51bGxzdGlsbCB6b29tIiwibWVudSI6Ik1lbnkiLCJkb25lIjoiRmVyZGlnIiwiZWRpdCI6IlJlZGlnZXIiLCJ1bmRvIjoiQW5ncmUiLCJyZWRvIjoiR2plciBvbSIsInJvb21EaWFsb2ciOiJTdGFydCBzYW5udGlkcy1zYW1hcmJlaWQiLCJjcmVhdGVOZXdSb29tIjoiTGFnIG55dHQgcm9tIiwidG9nZ2xlRnVsbFNjcmVlbiI6IlNsw6UgcMOlL2F2IGZ1bGxza2plcm0iLCJ0b2dnbGVaZW5Nb2RlIjoiU2zDpSBww6UvYXYgemVuLW1vZHVzIiwiZXhpdFplbk1vZGUiOiJBdnNsdXR0IHplbi1tb2R1cyJ9LCJhbGVydHMiOnsiY2xlYXJSZXNldCI6IkRldHRlIHZpbCB0w7htbWUgbGVycmV0ZXQuIEVyIGR1IHNpa2tlcj8iLCJjb3VsZE5vdENyZWF0ZVNoYXJlYWJsZUxpbmsiOiJLdW5uZSBpa2tqZSBsYWdlIGRlbGluZ3NsZW5rZS4iLCJjb3VsZE5vdExvYWRJbnZhbGlkRmlsZSI6Ikt1bm5lIGlra2plIGxhc3RlIGlubiB1Z3lsZGlnIGZpbCIsImltcG9ydEJhY2tlbmRGYWlsZWQiOiJJbXBvcnRlcmluZyBhdiBiYWNrZW5kIGZlaWxhLiIsImNhbm5vdEV4cG9ydEVtcHR5Q2FudmFzIjoiS2FuIGlra2plIGVrc3BvcnRlcmUgZWl0IHRvbXQgbGVycmV0LiIsImNvdWxkTm90Q29weVRvQ2xpcGJvYXJkIjoiS3VubmUgaWtramUga29waWVyZSB0aWwgdXRrbGlwcHN0YXZsYS4gUHLDuHYgbWVkIG5ldHRsZXNhcmVuIENocm9tZS4iLCJkZWNyeXB0RmFpbGVkIjoiS3VubmUgaWtramUgZGVrcnlwdGVyZSBkYXRhLiIsInVwbG9hZGVkU2VjdXJseSI6Ik9wcGxhc3RpbmdhIGVyIGtyeXB0ZXJ0IG9nIGVyIGlra2plIG1vZ2xlZyDDpSBsZXNlIGF2IEV4Y2FsaWRyYXctc2VydmVyZW4gZWxsZXIgdHJlZGplcGFydGFyLiIsImxvYWRTY2VuZU92ZXJyaWRlUHJvbXB0IjoiSW5ubGFzdGluZyBhdiBla3N0ZXJuIHRlaWtuaW5nIGVyc3RhdHRhciBkaXR0IGVrc2lzdGVyYW5kZSBpbm5oYWxkLiBZbnNramVyIGR1IMOlIGZvcnRzZXR0ZT8ifSwidG9vbEJhciI6eyJzZWxlY3Rpb24iOiJWZWwiLCJkcmF3IjoiRnJpaGFuZHN0ZWlrbmluZyIsInJlY3RhbmdsZSI6IlJla3RhbmdlbCIsImRpYW1vbmQiOiJEaWFtYW50IiwiZWxsaXBzZSI6IkVsbGlwc2UiLCJhcnJvdyI6IlBpbCIsImxpbmUiOiJMaW5qZSIsInRleHQiOiJUZWtzdCIsImxpYnJhcnkiOiJCaWJsaW90ZWsiLCJsb2NrIjoiSGFsZCBmcmFtIG1lZCB2YWx0IHZlcmt0w7h5In0sImhlYWRpbmdzIjp7ImNhbnZhc0FjdGlvbnMiOiJIYW5kbGluZ2FyOiBsZXJyZXQiLCJzZWxlY3RlZFNoYXBlQWN0aW9ucyI6IkhhbmRsaW5nYXI6IHZhbHQgb2JqZWt0Iiwic2hhcGVzIjoiRm9ybWFyIn0sImhpbnRzIjp7ImxpbmVhckVsZW1lbnQiOiJLbGlrayBmb3Igw6Ugc3RhcnRlIGxpbmplIG1lZCBmbGVpcmUgcHVua3QsIGVsbGVyIGRyYWcgZm9yIGVpIGVua2VsIGxpbmplIiwiZnJlZURyYXciOiJLbGlrayBvZyBkcmFnLCBzbGVwcCBuw6VyIGR1IGVyIGZlcmRpZyIsImxpbmVhckVsZW1lbnRNdWx0aSI6IktsaWtrIHDDpSBzaXN0ZSBwdW5rdCBlbGxlciB0cnlrayBFc2NhcGUgZWxsZXIgRW50ZXIgZm9yIMOlIGZ1bGxmw7hyZSIsInJlc2l6ZSI6IkR1IGthbiBoYWxkZSBmcmFtIG1lZCBmb3Job2xkZXQgdmVkIMOlIHRyeWtrZSBTSElGVCBtZWRhbiBkdSBlbmRyYXIgc3RvcmxlaWssXFxudHJ5a2sgQUxUIGZvciDDpSBlbmRyZSBzdG9ybGVpa2VuIGZyw6UgbWlkdGVuIiwicm90YXRlIjoiRHUga2FuIGzDpXNlIHZpbmtsYW5lIHZlZCDDpSBoYWxkZSBTSElGVCBtZWRhbiBkdSByb3RlcmVyIiwibGluZUVkaXRvcl9pbmZvIjoiRG9iYmVsdGtsaWtrIGVsbGVyIHRyeWtrIEVudGVyIGZvciDDpSByZWRpZ2VyZSBwdW5rdCIsImxpbmVFZGl0b3JfcG9pbnRTZWxlY3RlZCI6IlRyeWtrIHDDpSBTbGV0dCBmb3Igw6UgZmplcm5lIHB1bmt0ZXQsIEN0cmxPckNtZCtEIGZvciDDpSBkdXBsaXNlcmUsIGVsbGVyIGRyYSBmb3Igw6UgZmx5dHRlIiwibGluZUVkaXRvcl9ub3RoaW5nU2VsZWN0ZWQiOiJWZWwgZWl0IHB1bmt0IMOlIGZseXR0ZSBlbGxlciBmamVybmUsIGVsbGVyIGhhbGQgQWx0IG9nIGtsaWtrIGZvciDDpSBsZWdnZSB0aWwgbnllIHB1bmt0In0sImVycm9yU3BsYXNoIjp7ImhlYWRpbmdNYWluX3ByZSI6IkVpbiBmZWlsIG9wcHN0b2QuIFByw7h2ICIsImhlYWRpbmdNYWluX2J1dHRvbiI6IsOlIGxhc3RlIHNpZGEgcMOlIG55dHQuIiwiY2xlYXJDYW52YXNNZXNzYWdlIjoiT20gbnkgc2lkZWxhc3RpbmcgaWtramUgZnVuZ2VyZXIsIHByw7h2ICIsImNsZWFyQ2FudmFzTWVzc2FnZV9idXR0b24iOiLDpSB0w7htbWUgbGVycmV0ZXQuIiwiY2xlYXJDYW52YXNDYXZlYXQiOiIgRGV0dGUgdmlsIGbDuHJlIHRpbCB0YXAgYXYgYXJiZWlkICIsInRyYWNrZWRUb1NlbnRyeV9wcmUiOiJGZWlsZW4gbWVkIGlkZW50aWZpa2F0b3IgIiwidHJhY2tlZFRvU2VudHJ5X3Bvc3QiOiIgdmFydCBsb2dnYSBpIHN5c3RlbWV0IHbDpXJ0LiIsIm9wZW5Jc3N1ZU1lc3NhZ2VfcHJlIjoiVmkgZXIgdmVsZGlnIG7DuHllIG1lZCDDpSBpa2tqZSBpbmtsdWRlcmUgc2NlbmUtb3BwbHlzaW5nYW5lIGRpbmUgaSBmZWlsbWVsZGluZ2EuIFZpc3Mgc2NlbmEgZGkgaWtramUgZXIgcHJpdmF0IGthbiBkdSB2dXJkZXJlIMOlIGbDuGxnZSBvcHAgaSAiLCJvcGVuSXNzdWVNZXNzYWdlX2J1dHRvbiI6ImZlaWxyYXBwb3J0ZXJpbmdzc3lzdGVtZXQgdsOlcnQuIiwib3Blbklzc3VlTWVzc2FnZV9wb3N0IjoiIFRhIG1lZCBvcHBseXNpbmdhbmUgbmVkYW5mb3IgdmVkIMOlIGtvcGllcmUgb2cgbGltZSBpbm4gaSBHaXRIdWItc2FrYS4iLCJzY2VuZUNvbnRlbnQiOiJTY2VuZS1pbm5oYWxkOiJ9LCJyb29tRGlhbG9nIjp7ImRlc2NfaW50cm8iOiJEdSBrYW4gaW52aXRlcmUgcGVyc29uYXIgdGlsIHNjZW5hIGRpIGZvciDDpSBzYW1hcmJlaWRlIG1lZCBkZWcuIiwiZGVzY19wcml2YWN5IjoiVGEgZGV0IG1lZCBybzsgw7hrdGEgYnJ1a2FyIGVuZGUtdGlsLWVuZGUta3J5cHRlcmluZywgc8OlIGFsdCBkdSB0ZWlrbmFyIGhlbGQgZnJhbSBtZWQgw6UgdmVyZSBwcml2YXQuIElra2plIGVpbiBnb25nIHNlcnZlcmVuIHbDpXIga2FuIHNqw6Uga3ZhIGR1IGxhZ2FyLiIsImJ1dHRvbl9zdGFydFNlc3Npb24iOiJTdGFydCDDuGt0IiwiYnV0dG9uX3N0b3BTZXNzaW9uIjoiU3RvcHAgw7hrdCIsImRlc2NfaW5Qcm9ncmVzc0ludHJvIjoiU2FubnRpZHMtc2FtYXJiZWlkc8O4a3QgZXIgbm8gaSBnYW5nLiIsImRlc2NfcGVyc2lzdGVuY2VXYXJuaW5nIjoiVmVyIG1lcmtzYW0gcMOlIGF0IHNjZW5lLWRhdGEgdmVydCBkZWx0ZSBww6UgdHZlcnMgYXYgc2FtYXJiZWlkc3BhcnRuYXJhciB2ZWQgUDJQLW1ldG9kZW4sIG9nIGVyIGlra2plIGxhZ3JhIHDDpSBzZXJ2ZXJlbiB2w6VyLiBEZXR0ZSBiZXR5ciBhdCB2aXNzIGFsbGUga29wbGFyIGZyw6UsIG1pc3RhciBkdSBkYXRhIG1lZCBtaW5kcmUgZHUgZWtzcG9ydGVyZXIgZGVpIHRpbCBlaSBmaWwgZWxsZXIgZWkgZGVsYmFyIGxlbmtlLiIsImRlc2Nfc2hhcmVMaW5rIjoiRGVsIGRlbm5lIGxlbmthIG1lZCBkZWkgZHUgdmlsIHNhbWFyYmVpZGUgbWVkOiIsImRlc2NfZXhpdFNlc3Npb24iOiJEZXJzb20gZHUgYXZzbHV0dGFyIMO4a3RhIGJsaXIgZHUga29wbGEgZnLDpSByb21tZXQsIG1lbiBkdSBrYW4gaGFsZGUgZnJhbSBtZWQgw6UgYXJiZWlkZSBtZWQgc2NlbmEgbG9rYWx0LiBWZXIgbWVya3NhbSBww6UgYXQgZGV0dGUgaWtramUgdmlsIHDDpXZlcmtlIGFuZHJlIHBlcnNvbmFyLCBvZyBkZXNzZSB2aWwgZnJhbWxlaXMgaGEgbW9nbGVnaGVpdCB0aWwgw6Ugc2FtYXJiZWlkZSBww6UgZGVpcmEgZWlnZW4gdmVyc2pvbi4ifSwiZXJyb3JEaWFsb2ciOnsidGl0bGUiOiJGZWlsIn0sInNob3J0Y3V0c0RpYWxvZyI6eyJ0aXRsZSI6IlRhc3RhdHVyc25hcnZlZ2FyIiwic2hhcGVzIjoiRmlndXJhciIsIm9yIjoiZWxsZXIiLCJjbGljayI6ImtsaWtrIiwiZHJhZyI6ImRyYWciLCJjdXJ2ZWRBcnJvdyI6IkJvZ2EgcGlsIiwiY3VydmVkTGluZSI6IkJvZ2EgbGluamUiLCJlZGl0b3IiOiJSZWRpZ2VyaW5nIiwidmlldyI6IlZpc2luZyIsImJsb2ciOiJMZXMgYmxvZ2dlbiB2w6VyIiwiaG93dG8iOiJGw7hsZyB2ZWdsZWlpbmdhIHbDpXIiLCJnaXRodWIiOiJGdW5uZSBlaXQgcHJvYmxlbT8gU2VuZCBpbm4iLCJ0ZXh0TmV3TGluZSI6IkxlZ2cgdGlsIG55IGxpbmplICh0ZWtzdCkiLCJ0ZXh0RmluaXNoIjoiRnVsbGbDuHIgcmVkaWdlcmluZyAodGVrc3QpIiwiem9vbVRvRml0IjoiWm9vbSBmb3Igw6Ugc2rDpSBhbGxlIGVsZW1lbnRhIn0sImVuY3J5cHRlZCI6eyJ0b29sdGlwIjoiVGVpa25pbmdhbmUgZGluZSBlciBlbmRlLXRpbC1lbmRlLWtyeXB0ZXJ0ZSBzbGlrIGF0IEV4Y2FsaWRyYXcgc2luZSBzZXJ2ZXJhciBhbGRyaSBmw6VyIHNqw6UgZGVpLiJ9LCJjaGFydHMiOnsibm9OdW1lcmljQ29sdW1uIjoiRHUgbGltdGUgaW5uIGVpdCByZWtuZWFyayB1dGFuIGVpIG51bWVyaXNrIGtvbG9ubmUuIiwidG9vTWFueUNvbHVtbnMiOiJEdSBsaW10ZSBpbm4gZWl0IHJla25lYXJrIG1lZCBtZWlyIGVubiB0byBrb2xvbm5hci4ifX0nKX0sZnVuY3Rpb24oZSl7ZS5leHBvcnRzPUpTT04ucGFyc2UoJ3sibGFiZWxzIjp7InBhc3RlIjoiV2tsZWoiLCJzZWxlY3RBbGwiOiJaYXpuYWN6IHdzenlzdGtvIiwibXVsdGlTZWxlY3QiOiIiLCJtb3ZlQ2FudmFzIjoiUHJ6ZXN1xYQgb2JzemFyIHJvYm9jenkiLCJjb3B5IjoiS29waXVqIiwiY29weUFzUG5nIjoiU2tvcGl1aiBkbyBzY2hvd2thIGpha28gcGxpayBQTkciLCJjb3B5QXNTdmciOiJTa29waXVqIGRvIHNjaG93a2EgamFrbyBwbGlrIFNWRyIsImJyaW5nRm9yd2FyZCI6IlByemVuaWXFmyB3ecW8ZWoiLCJzZW5kVG9CYWNrIjoiUHJ6ZW5pZcWbIG5hIHNww7NkIiwiYnJpbmdUb0Zyb250IjoiUHJ6ZW5pZcWbIG5hIHdpZXJ6Y2giLCJzZW5kQmFja3dhcmQiOiJQcnplbmllxZsgbmnFvGVqIiwiZGVsZXRlIjoiVXN1xYQiLCJjb3B5U3R5bGVzIjoiS29waXVqIHN0eWxlIiwicGFzdGVTdHlsZXMiOiJXa2xlaiBzdHlsZSIsInN0cm9rZSI6IktvbG9yIG9icmFtb3dhbmlhIiwiYmFja2dyb3VuZCI6IktvbG9yIHd5cGXFgm5pZW5pYSIsImZpbGwiOiJXeXBlxYJuaWVuaWUiLCJzdHJva2VXaWR0aCI6IkdydWJvxZvEhyBvYnJhbW93YW5pYSIsInN0cm9rZVN0eWxlIjoiU3R5bCBvYnJ5c3UiLCJzdHJva2VTdHlsZV9zb2xpZCI6IlBlxYJueSIsInN0cm9rZVN0eWxlX2Rhc2hlZCI6IktyZXNrb3dhbnkiLCJzdHJva2VTdHlsZV9kb3R0ZWQiOiJLcm9wa293YW55Iiwic2xvcHBpbmVzcyI6IlN0eWwga3Jlc2tpIiwib3BhY2l0eSI6IlByemXFunJvY3p5c3RvxZvEhyIsInRleHRBbGlnbiI6Ild5csOzd25hbmllIHRla3N0dSIsImZvbnRTaXplIjoiUm96bWlhciB0ZWtzdHUiLCJmb250RmFtaWx5IjoiS3LDs2ogcGlzbWEiLCJvbmx5U2VsZWN0ZWQiOiJUeWxrbyB3eWJyYW5lIiwid2l0aEJhY2tncm91bmQiOiJaIHTFgmVtIGRva3VtZW50dSIsImFkZFdhdGVybWFyayI6IkRvZGFqIFxcIlpyb2Jpb25lIHcgRXhjYWxpZHJhd1xcIiIsImhhbmREcmF3biI6Ik9kcsSZY3pueSIsIm5vcm1hbCI6Ik5vcm1hbG55IiwiY29kZSI6IktvZCIsInNtYWxsIjoiTWHFgnkiLCJtZWRpdW0iOiLFmnJlZG5pIiwibGFyZ2UiOiJEdcW8eSIsInZlcnlMYXJnZSI6IkJhcmR6byBkdcW8eSIsInNvbGlkIjoiUGXFgm5lIiwiaGFjaHVyZSI6IkxpbmllIiwiY3Jvc3NIYXRjaCI6Ilpha3JlxZtsb25lIiwidGhpbiI6IkNpZW5raWUiLCJib2xkIjoiUG9ncnViaW9uZSIsImxlZnQiOiJEbyBsZXdlaiIsImNlbnRlciI6IkRvIMWbcm9ka2EiLCJyaWdodCI6IkRvIHByYXdlaiIsImV4dHJhQm9sZCI6IkVrc3RyYSBwb2dydWJpb25lIiwiYXJjaGl0ZWN0IjoiRG9rxYJhZG55IiwiYXJ0aXN0IjoiQXJ0eXN0eWN6bnkiLCJjYXJ0b29uaXN0IjoiUnlzdW5rb3d5IiwiZmlsZVRpdGxlIjoiTmF6d2EgcGxpa3UiLCJjb2xvclBpY2tlciI6IlBhbGV0YSBrb2xvcsOzdyIsImNhbnZhc0JhY2tncm91bmQiOiJLb2xvciBkb2t1bWVudHUiLCJkcmF3aW5nQ2FudmFzIjoiT2JzemFyIHJvYm9jenkiLCJsYXllcnMiOiJXYXJzdHd5IiwiYWN0aW9ucyI6IkFrY2plIiwibGFuZ3VhZ2UiOiJKxJl6eWsiLCJjcmVhdGVSb29tIjoiVWRvc3TEmXBuaWogc2VzasSZIHdzcMOzxYJwcmFjeSBuYSDFvHl3byIsImR1cGxpY2F0ZVNlbGVjdGlvbiI6IlBvd2llbCIsInVudGl0bGVkIjoiQmV6IHR5dHXFgnUiLCJuYW1lIjoiTmF6d2EiLCJ5b3VyTmFtZSI6IlR3b2plIGltacSZIiwibWFkZVdpdGhFeGNhbGlkcmF3IjoiWnJvYmlvbmUgdyBFeGNhbGlkcmF3IiwiZ3JvdXAiOiJaZ3J1cHVqIHd5YnJhbmUiLCJ1bmdyb3VwIjoiUm96Z3J1cHVqIHd5YnJhbmUiLCJjb2xsYWJvcmF0b3JzIjoiV3Nww7PFgnR3w7NyY3kiLCJ0b2dnbGVHcmlkTW9kZSI6IiIsImFkZFRvTGlicmFyeSI6IiIsInJlbW92ZUZyb21MaWJyYXJ5IjoiIiwibGlicmFyeUxvYWRpbmdNZXNzYWdlIjoiIn0sImJ1dHRvbnMiOnsiY2xlYXJSZXNldCI6Ild5Y3p5xZvEhyBkb2t1bWVudCBpIHpyZXNldHVqIGtvbG9yIGRva3VtZW50dSIsImV4cG9ydCI6IlphcGlzeiBqYWtvIiwiZXhwb3J0VG9QbmciOiJaYXBpc3ogamFrbyBQTkciLCJleHBvcnRUb1N2ZyI6IlphcGlzeiBqYWtvIFNWRyIsImNvcHlUb0NsaXBib2FyZCI6IlNrb3BpdWogZG8gc2Nob3drYSIsImNvcHlQbmdUb0NsaXBib2FyZCI6IlNrb3BpdWogZG8gc2Nob3drYSBqYWtvIHBsaWsgUE5HIiwic2F2ZSI6IlphcGlzeiIsInNhdmVBcyI6IlphcGlzeiBqYWtvIiwibG9hZCI6Ik90d8OzcnoiLCJnZXRTaGFyZWFibGVMaW5rIjoiVWRvc3TEmXBuaWoiLCJjbG9zZSI6IlphbWtuaWoiLCJzZWxlY3RMYW5ndWFnZSI6Ild5YmllcnogasSZenlrIiwic2Nyb2xsQmFja1RvQ29udGVudCI6Ildyw7PEhyBkbyBvYnN6YXJ1IHJvYm9jemVnbyIsInpvb21JbiI6IlBvd2nEmWtzeiIsInpvb21PdXQiOiJQb21uaWVqc3oiLCJyZXNldFpvb20iOiJacmVzZXR1aiBwb3dpxJlrc3plbmllIiwibWVudSI6Ik1lbnUiLCJkb25lIjoiR290b3dlIiwiZWRpdCI6IkVkeXR1aiIsInVuZG8iOiJDb2ZuaWoiLCJyZWRvIjoiUHJ6eXdyw7PEhyIsInJvb21EaWFsb2ciOiJVdHfDs3J6IG5vd8SFIHNlc2rEmSB3c3DDs8WCcHJhY3kgbmEgxbx5d28iLCJjcmVhdGVOZXdSb29tIjoiVXR3w7NyeiBub3d5IHBva8OzaiIsInRvZ2dsZUZ1bGxTY3JlZW4iOiJXxYLEhWN6L3d5xYLEhWN6IHRyeWIgcGXFgm5vZWtyYW5vd3kiLCJ0b2dnbGVaZW5Nb2RlIjoiV8WCxIVjeiB0cnliIFplbiIsImV4aXRaZW5Nb2RlIjoiV3lqZMW6IHogdHJ5YnUgWmVuIn0sImFsZXJ0cyI6eyJjbGVhclJlc2V0IjoiVG8gc3Bvd29kdWplIHVzdW5pxJljaWUgd3N6eXN0a2llZ28geiBkb2t1bWVudHUuIEN6eSBjaGNlc3oga29udHludW93YcSHPyIsImNvdWxkTm90Q3JlYXRlU2hhcmVhYmxlTGluayI6Ild5c3TEhXBpxYIgYsWCxIVkIHByenkgZ2VuZXJvd2FuaXUgbGlua2EgZG8gdWRvc3TEmXBuaWFuaWEuIiwiY291bGROb3RMb2FkSW52YWxpZEZpbGUiOiJOaWUgdWRhxYJvIHNpxJkgb3R3b3J6ecSHIHBsaWt1LiBXeWJyYW55IHBsaWsgamVzdCBuaWVwcmF3aWTFgm93eS4iLCJpbXBvcnRCYWNrZW5kRmFpbGVkIjoiV3lzdMSFcGnFgiBixYLEhWQgcG9kY3phcyBpbXBvcnRvd2FuaWEgcGxpa3UuIiwiY2Fubm90RXhwb3J0RW1wdHlDYW52YXMiOiJOYWpwaWVydyBtdXNpc3ogY2/FmyBuYXJ5c293YcSHLCBhYnkgemFwaXNhxIcgZG9rdW1lbnQuIiwiY291bGROb3RDb3B5VG9DbGlwYm9hcmQiOiJCxYLEhWQgcG9kY3phcyBrb3Bpb3dhbmlhLiBTcHLDs2J1aiB1xbx5xIcgR29vZ2xlIENocm9tZS4iLCJkZWNyeXB0RmFpbGVkIjoiTmllIHVkYcWCbyBzacSZIG9kc3p5ZnJvd2HEhyBkYW55Y2guIiwidXBsb2FkZWRTZWN1cmx5IjoiQnkgemFwZXduacSHIENpIHByeXdhdG5vxZvEhywgdWRvc3TEmXBuaWFuaWUgcHJvamVrdHUgamVzdCB6YWJlenBpZWN6b25lIHN6eWZyb3dhbmllbSBlbmQtdG8tZW5kLCBjbyBvem5hY3phLCDFvGUgcG96YSB0b2LEhSBpIG9zb2LEhSB6IGt0w7NyxIUgcG9kemllbGlzeiBzacSZIGxpbmtpZW0sIG5pa3QgbmllIG1hIGRvc3TEmXB1IGRvIHRlZ28gY28gdWRvc3TEmXBuaWFzei4iLCJsb2FkU2NlbmVPdmVycmlkZVByb21wdCI6IiJ9LCJ0b29sQmFyIjp7InNlbGVjdGlvbiI6Ilphem5hY3plbmllIiwiZHJhdyI6IlN3b2JvZG5lIHJ5c293YW5pZSIsInJlY3RhbmdsZSI6IlByb3N0b2vEhXQiLCJkaWFtb25kIjoiUm9tYiIsImVsbGlwc2UiOiJFbGlwc2EiLCJhcnJvdyI6IlN0cnphxYJrYSIsImxpbmUiOiJMaW5pYSIsInRleHQiOiJUZWtzdCIsImxpYnJhcnkiOiIiLCJsb2NrIjoiWmFibG9rdWogd3licmFuZSBuYXJ6xJlkemllIn0sImhlYWRpbmdzIjp7ImNhbnZhc0FjdGlvbnMiOiJOYXJ6xJlkemlhIiwic2VsZWN0ZWRTaGFwZUFjdGlvbnMiOiJXeWJyYW5lIG5hcnrEmWR6aWUiLCJzaGFwZXMiOiJLc3p0YcWCdHkifSwiaGludHMiOnsibGluZWFyRWxlbWVudCI6Ik5hY2nFm25paiwgYWJ5IHpyb2JpxIcgcHVua3QsIHByemVjacSFZ25paiwgYWJ5IG5hcnlzb3dhxIcgbGluacSZIiwiZnJlZURyYXciOiJOYWNpxZtuaWogaSBwcnplY2nEhWduaWogYnkgcnlzb3dhxIcsIHB1xZvEhyBraWVkeSBza2/FhGN6eXN6IiwibGluZWFyRWxlbWVudE11bHRpIjoiQWJ5IHpha2/FhGN6ecSHIGtyenl3xIUsIHBvbm93bmllIGtsaWtuaWogdyBvc3RhdG5pIHB1bmt0LCBixIVkxbogbmFjacWbbmlqIEVzYyBhbGJvIEVudGVyIiwicmVzaXplIjoiTW/FvGVzeiB6YWNob3dhxIcgcHJvcG9yY2rEmSB0cnp5bWFqxIXEhyB3Y2lzbmnEmXR5IFNISUZULCBwcnp5dHJ6eW1haiBBTFQgYnkgem1pZW5pxIcgcm96bWlhciB3emdsxJlkZW0gxZtyb2RrYSIsInJvdGF0ZSI6Ik1vxbxlc3ogb2JyYWNhxIfCoGVsZW1lbnQgdyByw7N3bnljaCBvZHN0xJlwYWNoIHRyenltYWrEhWMgd2NpxZtuacSZdHkgU0hJRlQiLCJsaW5lRWRpdG9yX2luZm8iOiJLbGlrbmlqIGR3dWtyb3RuaWUgbHViIG5hY2nFm25paiBFbnRlciwgYWJ5IGVkeXRvd2HEhyBwdW5rdHkiLCJsaW5lRWRpdG9yX3BvaW50U2VsZWN0ZWQiOiIiLCJsaW5lRWRpdG9yX25vdGhpbmdTZWxlY3RlZCI6Ik5hY2nFm25paiB3IHB1bmt0IGJ5IGdvIGVkeXRvd2HEhywgcHJ6eXRyenltYWogQWx0IGkgbmFjacWbbmlqIGJ5IGRvZGHEhyBub3d5IHB1bmt0In0sImVycm9yU3BsYXNoIjp7ImhlYWRpbmdNYWluX3ByZSI6Ild5c3TEhXBpxYIgYsWCxIVkLiBTcHLDs2J1aiAiLCJoZWFkaW5nTWFpbl9idXR0b24iOiJvZMWbd2llxbx5xIcgc3Ryb27EmS4iLCJjbGVhckNhbnZhc01lc3NhZ2UiOiJKZcWbbGkgb2TFm3dpZcW8ZW5pZSBzdHJvbnkgbmllIHphZHppYcWCYcWCbywgc3Byw7NidWogIiwiY2xlYXJDYW52YXNNZXNzYWdlX2J1dHRvbiI6InVzdW7EhcSHIHdzenlzdGtvIHogZG9rdW1lbnR1LiIsImNsZWFyQ2FudmFzQ2F2ZWF0IjoiIFBhbWnEmXRhaiB0eWxrbywgxbxlIHNwb3dvZHVqZSB0byB1dHJhdMSZIGNhxYJlaiB0d29qZWogcHJhY3kgIiwidHJhY2tlZFRvU2VudHJ5X3ByZSI6IkLFgsSFZCBvIGlkZW50eWZpa2F0b3J6ZSAiLCJ0cmFja2VkVG9TZW50cnlfcG9zdCI6IiB6b3N0YcWCIHphcmFwb3J0b3dhbnkgdyBuYXN6eW0gc3lzdGVtaWUuIiwib3Blbklzc3VlTWVzc2FnZV9wcmUiOiJTemFudWplbXkgdHdvasSFIHByeXdhdG5vxZvEhyBpIHJhcG9ydCBuaWUgemF3aWVyYcWCIMW8YWRueWNoIGRhbnljaCBkb3R5Y3rEhWN5Y2ggdGVnbyBuYWQgY3p5bSBwcmFjb3dhxYJlxZssIG5hdG9taWFzdCBqZcW8ZWxpIGplc3RlxZsgdyBzdGFuaWUgcG9kemllbGnEhyBzacSZIHR5bSBuYWQgY3p5bSBwcmFjb3dhxYJlxZssIHByb3NpbXkgbyBkb2RhdGtvd3kgcmFwb3J0IHBvcHJ6ZXogIiwib3Blbklzc3VlTWVzc2FnZV9idXR0b24iOiJuYXN6ZSBuYXJ6xJlkemllIGRvIHJhcG9ydG93YW5pYSBixYLEmWTDs3cuIiwib3Blbklzc3VlTWVzc2FnZV9wb3N0IjoiIFByb3NpbXkgbyBkb8WCxIVjemVuaWUgcG9uacW8c3plaiBpbmZvcm1hY2ppIHBvcHJ6ZXogc2tvcGlvd2FuaWUgamVqIGkgdW1pZXN6Y3plbmllIGplaiB3IHpnxYJvc3plbml1IG5hIHBvcnRhbHUgR2l0SHViLiIsInNjZW5lQ29udGVudCI6Ilphd2FydG/Fm8SHIGRva3VtZW50dToifSwicm9vbURpYWxvZyI6eyJkZXNjX2ludHJvIjoiQsSZZHppZXN6IHcgc3RhbmllIHByYWNvd2HEh8Kgd3JheiB6IG9zb2JhbWkga3TDs3JlIHphcHJvc2lzeiBkbyB3c3DDs8WCcHJhY3kuIiwiZGVzY19wcml2YWN5IjoiQnkgemFwZXduacSHIENpIHByeXdhdG5vxZvEhywgc2VzamEgd3Nww7PFgnByYWN5IG5hIMW8eXdvIGplc3QgemFiZXpwaWVjem9uYSBzenlmcm93YW5pZW0gZW5kLXRvLWVuZCwgY28gb3puYWN6YSwgxbxlIHBvemEgdG9ixIUgaSBvc29iYW1pIHoga3TDs3J5bWkgcG9kemllbGlzeiBzacSZIGxpbmtpZW0sIG5pa3QgbmllIG1hIGRvc3TEmXB1IGRvIHRlZ28gY28gYsSZZHppZWNpZSB0d29yennEhy4iLCJidXR0b25fc3RhcnRTZXNzaW9uIjoiUm96cG9jem5paiBzZXNqxJkiLCJidXR0b25fc3RvcFNlc3Npb24iOiJaYWtvxYRjeiBzZXNqxJkiLCJkZXNjX2luUHJvZ3Jlc3NJbnRybyI6IlNlc2phIHdzcMOzxYJwcmFjeSBuYSDFvHl3byB3xYJhxZtuaWUgc2nEmSByb3pwb2N6xJnFgmEuIiwiZGVzY19wZXJzaXN0ZW5jZVdhcm5pbmciOiJXYcW8bmUhIFdzenlzdGtvIGNvIGLEmWR6aWVzeiB0d29yennEhyB3cmF6IHogb3NvYmFtaSBrdMOzcmUgemFwcm9zaXN6IGRvIHdzcMOzxYJwcmFjeSBqZXN0IGRvc3TEmXBuZSB0eWxrbyBkbGEgd2FzIChwcm90b2vDs8WCIFAyUCksIGNvIG96bmFjemEsIMW8ZSBuaWUgamVzdCBwcnplY2hvd3l3YW5lIG5hIHNlcndlcmFjaCBFeGNhbGlkcmF3LiBEbGF0ZWdvLCBqZcW8ZWxpIHdzenlzY3kgc2nEmSByb3rFgsSFY3p5Y2llIGkgbmllIHphcGlzemVjaWUgd2N6ZcWbbmllaiBkYW55Y2ggKGFsYm8gbmllIHV0d29yenljaWXCoGxpbmthIGRvIHVkb3N0xJlwbmllbmlhIHByb2pla3R1KSwgd2FzemUgZGFuZSB6b3N0YW7EhSB1dHJhY29uZS4iLCJkZXNjX3NoYXJlTGluayI6IlVkb3N0xJlwbmlqIHRlbiBsaW5rIG9zb2JvbSwgeiBrdMOzcnltaSBjaGNlc3ogd3Nww7PFgnByYWNvd2HEhzoiLCJkZXNjX2V4aXRTZXNzaW9uIjoiWmFrb8WEY3plbmllIHNlc2ppIHNwb3dvZHVqZSBvZMWCxIVjemVuaWUgY2llYmllIG9kIHBva29qdSwgYWxlIG5hZGFsIGLEmWR6aWVzeiBtw7NnxYIgbG9rYWxuaWUga29udHludW93YcSHIHByYWPEmS4gWmF1d2HFvCwgxbxlIG9zb2J5IHoga3TDs3J5bWkgd3Nww7PFgnByYWNvd2HFgmXFmyBuYWRhbCBixJlkxIUgbW9nxYJ5IHdzcMOzxYJwcmFjb3dhxIcuIn0sImVycm9yRGlhbG9nIjp7InRpdGxlIjoiV3lzdMSFcGnFgiBixYLEhWQifSwic2hvcnRjdXRzRGlhbG9nIjp7InRpdGxlIjoiU2tyw7N0eSBrbGF3aXN6b3dlIiwic2hhcGVzIjoiS3N6dGHFgnR5Iiwib3IiOiJsdWIiLCJjbGljayI6ImtsaWsiLCJkcmFnIjoicHJ6ZWNpxIVnbmlqIiwiY3VydmVkQXJyb3ciOiJaYWtyenl3aW9uYSBzdHJ6YcWCa2EiLCJjdXJ2ZWRMaW5lIjoiWmFrcnp5d2lvbmEgbGluaWEiLCJlZGl0b3IiOiJFZHl0b3IiLCJ2aWV3IjoiV2lkb2siLCJibG9nIjoiUHJ6ZWN6eXRhaiBuYXN6ZWdvIGJsb2dhIiwiaG93dG8iOiJTa29yenlzdGFqIHogaW5zdHJ1a2NqaSIsImdpdGh1YiI6IlpuYWxhesWCZcWbIHByb2JsZW0/IFpnxYJvxZvCoGdvIiwidGV4dE5ld0xpbmUiOiJEb2RhaiBub3fEhSBsaW5pxJkgKHRla3N0KSIsInRleHRGaW5pc2giOiJaYWtvxYRjeiBlZHljasSZICh0ZWtzdCkiLCJ6b29tVG9GaXQiOiJQb3dpxJlrc3osIGFieSB3ecWbd2lldGxpxIcgd3N6eXN0a2llIGVsZW1lbnR5In0sImVuY3J5cHRlZCI6eyJ0b29sdGlwIjoiVHdvamUgcnlzdW5raSBzxIUgemFiZXpwaWVjem9uZSBzenlmcm93YW5pZW0gZW5kLXRvLWVuZCwgdGFrIHdpxJljIG5hd2V0IHcgRXhjYWxpZHJhdyBuaWUgamVzdGXFm215IHcgc3RhbmllIHpvYmFjennEhyB0ZWdvIGNvIHR3b3J6eXN6LiJ9LCJjaGFydHMiOnsibm9OdW1lcmljQ29sdW1uIjoiV2tsZWpvbm8gYXJrdXN6IGthbGt1bGFjeWpueSBiZXoga29sdW1ueSBudW1lcnljem5lai4iLCJ0b29NYW55Q29sdW1ucyI6IldrbGVqb25vIGFya3VzeiBrYWxrdWxhY3lqbnkgeiB3acSZY2VqIG5pxbwgZHdvbWEga29sdW1uYW1pLiJ9fScpfSxmdW5jdGlvbihlKXtlLmV4cG9ydHM9SlNPTi5wYXJzZSgneyJsYWJlbHMiOnsicGFzdGUiOiJDb2xhciIsInNlbGVjdEFsbCI6IlNlbGVjaW9uYXIgdHVkbyIsIm11bHRpU2VsZWN0IjoiQWRpY2lvbmFyIGVsZW1lbnRvIMOgIHNlbGXDp8OjbyIsIm1vdmVDYW52YXMiOiJNb3ZlciB0ZWxhIiwiY29weSI6IkNvcGlhciIsImNvcHlBc1BuZyI6IkNvcGlhciBwYXJhIGEgw6FyZWEgZGUgdHJhbnNmZXLDqm5jaWEgY29tbyBQTkciLCJjb3B5QXNTdmciOiJDb3BpYXIgcGFyYSBhIMOhcmVhIGRlIHRyYW5zZmVyw6puY2lhIGNvbW8gU1ZHIiwiYnJpbmdGb3J3YXJkIjoiVHJhemVyIHBhcmEgbyBwcmltZWlybyBwbGFubyIsInNlbmRUb0JhY2siOiJFbnZpYXIgcGFyYSBvIHBsYW5vIGRlIGZ1bmRvIiwiYnJpbmdUb0Zyb250IjoiVHJhemVyIHBhcmEgbyBwcmltZWlybyBwbGFubyIsInNlbmRCYWNrd2FyZCI6IkVudmlhciBwYXJhIHRyw6FzIiwiZGVsZXRlIjoiQXBhZ2FyIiwiY29weVN0eWxlcyI6IkNvcGlhciBvcyBlc3RpbG9zIiwicGFzdGVTdHlsZXMiOiJDb2xhciBvcyBlc3RpbG9zIiwic3Ryb2tlIjoiQ29udG9ybm9zIiwiYmFja2dyb3VuZCI6IkZ1bmRvIiwiZmlsbCI6IlByZWVuY2hpbWVudG8iLCJzdHJva2VXaWR0aCI6IkVzcGVzc3VyYSBkbyB0cmHDp28iLCJzdHJva2VTdHlsZSI6IkVzdGlsbyBkZSB0cmHDp28iLCJzdHJva2VTdHlsZV9zb2xpZCI6IlPDs2xpZG8iLCJzdHJva2VTdHlsZV9kYXNoZWQiOiJUcmFjZWphZG8iLCJzdHJva2VTdHlsZV9kb3R0ZWQiOiJQb250aWxoYWRvIiwic2xvcHBpbmVzcyI6IkRlc2xlaXhvIiwib3BhY2l0eSI6Ik9wYWNpZGFkZSIsInRleHRBbGlnbiI6IkFsaW5oYW1lbnRvIGRvIHRleHRvIiwiZm9udFNpemUiOiJUYW1hbmhvIGRhIGZvbnRlIiwiZm9udEZhbWlseSI6IkZhbcOtbGlhIGRhIGZvbnRlcyIsIm9ubHlTZWxlY3RlZCI6IlNvbWVudGUgYSBzZWxlw6fDo28iLCJ3aXRoQmFja2dyb3VuZCI6IkNvbSBmdW5kbyIsImFkZFdhdGVybWFyayI6IkFkaWNpb25hciBcXCJGZWl0byBjb20gRXhjYWxpZHJhd1xcIiIsImhhbmREcmF3biI6Ik1hbnVzY3JpdG8iLCJub3JtYWwiOiJOb3JtYWwiLCJjb2RlIjoiQ8OzZGlnbyIsInNtYWxsIjoiUGVxdWVubyIsIm1lZGl1bSI6Ik3DqWRpbyIsImxhcmdlIjoiR3JhbmRlIiwidmVyeUxhcmdlIjoiTXVpdG8gZ3JhbmRlIiwic29saWQiOiJTw7NsaWRvIiwiaGFjaHVyZSI6IkVjbG9zw6NvIiwiY3Jvc3NIYXRjaCI6IkhhY2h1cmFkbyIsInRoaW4iOiJGaW5vIiwiYm9sZCI6IkVzcGVzc28iLCJsZWZ0IjoiRXNxdWVyZGEiLCJjZW50ZXIiOiJDZW50cmFsaXphciIsInJpZ2h0IjoiRGlyZWl0YSIsImV4dHJhQm9sZCI6Ik11aXRvIGVzcGVzc28iLCJhcmNoaXRlY3QiOiJBcnF1aXRlY3RvIiwiYXJ0aXN0IjoiQXJ0aXN0YSIsImNhcnRvb25pc3QiOiJDYXJpY2F0dXJpc3RhIiwiZmlsZVRpdGxlIjoiVMOtdHVsbyBkbyBhcnF1aXZvIiwiY29sb3JQaWNrZXIiOiJTZWxldG9yIGRlIGNvcmVzIiwiY2FudmFzQmFja2dyb3VuZCI6IkZ1bmRvIGRhIHRlbGEiLCJkcmF3aW5nQ2FudmFzIjoiVGVsYSBkZSBkZXNlbmhvIiwibGF5ZXJzIjoiQ2FtYWRhcyIsImFjdGlvbnMiOiJBw6fDtWVzIiwibGFuZ3VhZ2UiOiJJZGlvbWEiLCJjcmVhdGVSb29tIjoiQ29tcGFydGlsaGFyIHVtYSBzZXNzw6NvIGRlIGNvbGFib3Jhw6fDo28gYW8gdml2byIsImR1cGxpY2F0ZVNlbGVjdGlvbiI6IkR1cGxpY2FyIiwidW50aXRsZWQiOiJTZW0gdMOtdHVsbyIsIm5hbWUiOiJOb21lIiwieW91ck5hbWUiOiJTZXUgbm9tZSIsIm1hZGVXaXRoRXhjYWxpZHJhdyI6IkZlaXRvIGNvbSBFeGNhbGlkcmF3IiwiZ3JvdXAiOiJBZ3J1cGFyIHNlbGXDp8OjbyIsInVuZ3JvdXAiOiJEZXNhZ3J1cGFyIHNlbGXDp8OjbyIsImNvbGxhYm9yYXRvcnMiOiJDb2xhYm9yYWRvcmVzIiwidG9nZ2xlR3JpZE1vZGUiOiJBbHRlcm5hciBtb2RvIGRlIGdyYWRlIiwiYWRkVG9MaWJyYXJ5IjoiQWRpY2lvbmFyIMOgIGJpYmxpb3RlY2EiLCJyZW1vdmVGcm9tTGlicmFyeSI6IlJlbW92ZXIgZGEgYmlibGlvdGVjYSIsImxpYnJhcnlMb2FkaW5nTWVzc2FnZSI6IkNhcnJlZ2FuZG8gYmlibGlvdGVjYS4uLiJ9LCJidXR0b25zIjp7ImNsZWFyUmVzZXQiOiJMaW1wYXIgbyBjYW52YXMgZSByZWRlZmluaXIgYSBjb3IgZGUgZnVuZG8iLCJleHBvcnQiOiJFeHBvcnRhciIsImV4cG9ydFRvUG5nIjoiRXhwb3J0YXIgZW0gUE5HIiwiZXhwb3J0VG9TdmciOiJFeHBvcnRhciBlbSBTVkciLCJjb3B5VG9DbGlwYm9hcmQiOiJDb3BpYXIgcGFyYSBvIGNsaXBib2FyZCIsImNvcHlQbmdUb0NsaXBib2FyZCI6IkNvcGlhciBQTkcgcGFyYSDDoXJlYSBkZSB0cmFuc2ZlcsOqbmNpYSIsInNhdmUiOiJHdWFyZGFyIiwic2F2ZUFzIjoiU2FsdmFyIGNvbW8iLCJsb2FkIjoiQ2FycmVnYXIiLCJnZXRTaGFyZWFibGVMaW5rIjoiT2J0ZXIgdW0gbGluayBkZSBwYXJ0aWxoYSIsImNsb3NlIjoiRmVjaGFyIiwic2VsZWN0TGFuZ3VhZ2UiOiJTZWxlY2lvbmFyIGlkaW9tYSIsInNjcm9sbEJhY2tUb0NvbnRlbnQiOiJWb2x0YXIgYW8gY29udGXDumRvIiwiem9vbUluIjoiQXVtZW50YXIgem9vbSIsInpvb21PdXQiOiJEaW1pbnVpciB6b29tIiwicmVzZXRab29tIjoiUmVkZWZpbmlyIHpvb20iLCJtZW51IjoiTWVudSIsImRvbmUiOiJDb25jbHXDrWRvIiwiZWRpdCI6IkVkaXRhciIsInVuZG8iOiJEZXNmYXplciIsInJlZG8iOiJSZWZhemVyIiwicm9vbURpYWxvZyI6IkluaWNpYXIgY29sYWJvcmHDp8OjbyBhbyB2aXZvIiwiY3JlYXRlTmV3Um9vbSI6IkNyaWFyIG5vdmEgc2FsYSIsInRvZ2dsZUZ1bGxTY3JlZW4iOiJBbHRlcm5hciB0ZWxhIGNoZWlhIiwidG9nZ2xlWmVuTW9kZSI6IkFsdGVybmFyIG1vZG8gemVuIiwiZXhpdFplbk1vZGUiOiJTYWlyIGRvIG1vZG8gemVuIn0sImFsZXJ0cyI6eyJjbGVhclJlc2V0IjoiSXN0byBpcsOhIGxpbXBhciB0b2RhIGEgdGVsYS4gVm9jw6ogdGVtIGNlcnRlemE/IiwiY291bGROb3RDcmVhdGVTaGFyZWFibGVMaW5rIjoiTsOjbyBmb2kgcG9zc8OtdmVsIGNyaWFyIHVtIGxpbmsgZGUgY29tcGFydGlsaGFtZW50by4iLCJjb3VsZE5vdExvYWRJbnZhbGlkRmlsZSI6Ik7Do28gZm9pIHBvc3PDrXZlbCBjYXJyZWdhciBvIGFycXVpdm8gaW52w6FsaWRvIiwiaW1wb3J0QmFja2VuZEZhaWxlZCI6IkEgaW1wb3J0YcOnw6NvIGRvIHNlcnZpZG9yIGZhbGhvdS4iLCJjYW5ub3RFeHBvcnRFbXB0eUNhbnZhcyI6Ik7Do28gw6kgcG9zc8OtdmVsIGV4cG9ydGFyIHVtIGNhbnZhcyB2YXrDrW8uIiwiY291bGROb3RDb3B5VG9DbGlwYm9hcmQiOiJOw6NvIGZvaSBwb3Nzw612ZWwgY29waWFyIG5vIGNsaXBib2FyZC4gRXhwZXJpbWVudGUgbm8gbmF2ZWdhZG9yIENocm9tZS4iLCJkZWNyeXB0RmFpbGVkIjoiTsOjbyBmb2kgcG9zc8OtdmVsIGRlc2NyaXB0b2dyYWZhciBvcyBkYWRvcy4iLCJ1cGxvYWRlZFNlY3VybHkiOiJPIHVwbG9hZCBmb2kgcHJvdGVnaWRvIGNvbSBjcmlwdG9ncmFmaWEgZGUgcG9udGEgYSBwb250YSwgbyBxdWUgc2lnbmlmaWNhIHF1ZSBvIHNlcnZpZG9yIGRvIEV4Y2FsaWRyYXcgZSB0ZXJjZWlyb3MgbsOjbyBwb2RlbSBsZXIgbyBjb250ZcO6ZG8uIiwibG9hZFNjZW5lT3ZlcnJpZGVQcm9tcHQiOiJDYXJyZWdhciB1bSBkZXNlbmhvIGV4dGVybm8gc3Vic3RpdHVpcsOhIG8gc2V1IGNvbnRlw7pkbyBleGlzdGVudGUuIERlc2VqYSBjb250aW51YXI/In0sInRvb2xCYXIiOnsic2VsZWN0aW9uIjoiU2VsZcOnw6NvIiwiZHJhdyI6IkRlc2VuaG8gbGl2cmUiLCJyZWN0YW5nbGUiOiJSZXTDom5ndWxvIiwiZGlhbW9uZCI6Ikxvc2FuZ28iLCJlbGxpcHNlIjoiRWxpcHNlIiwiYXJyb3ciOiJGbGVjaGEiLCJsaW5lIjoiTGluaGEiLCJ0ZXh0IjoiVGV4dG8iLCJsaWJyYXJ5IjoiQmlibGlvdGVjYSIsImxvY2siOiJNYW50ZXIgYSBmZXJyYW1lbnRhIHNlbGVjaW9uYWRhIGF0aXZhIGFww7NzIGRlc2VuaGFyIn0sImhlYWRpbmdzIjp7ImNhbnZhc0FjdGlvbnMiOiJBw6fDtWVzIGRhIHRlbGEiLCJzZWxlY3RlZFNoYXBlQWN0aW9ucyI6IkHDp8O1ZXMgZGFzIGZvcm1hcyBzZWxlY2lvbmFkYXMiLCJzaGFwZXMiOiJGb3JtYXMifSwiaGludHMiOnsibGluZWFyRWxlbWVudCI6IkNsaXF1ZSBwYXJhIGluaWNpYXIgdsOhcmlvcyBwb250b3MsIGFycmFzdGUgcGFyYSB1bWEgw7puaWNhIGxpbmhhIiwiZnJlZURyYXciOiJUb3F1ZSBlIGFycmFzdGUsIHNvbHRlIHF1YW5kbyB0ZXJtaW5hciIsImxpbmVhckVsZW1lbnRNdWx0aSI6IkNsaXF1ZSBubyDDumx0aW1vIHBvbnRvIG91IHByZXNzaW9uZSBFc2NhcGUgb3UgRW50ZXIgcGFyYSB0ZXJtaW5hciIsInJlc2l6ZSI6IlZvY8OqIHBvZGUgcmVzdHJpbmdpciBwcm9wb3LDp8O1ZXMgc2VndXJhbmRvIFNISUZUIGVucXVhbnRvIHJlZGltZW5zaW9uYSxcXG5zZWd1cmUgQUxUIHBhcmEgcmVkaW1lbnNpb25hciBkbyBjZW50cm8iLCJyb3RhdGUiOiJWb2PDqiBwb2RlIHJlc3RyaW5naXIgb3Mgw6JuZ3Vsb3Mgc2VndXJhbmRvIFNISUZUIGVucXVhbnRvIGdpcmEiLCJsaW5lRWRpdG9yX2luZm8iOiJDbGlxdWUgZHVhcyB2ZXplcyBvdSBwcmVzc2lvbmUgRW50ZXIgcGFyYSBlZGl0YXIgb3MgcG9udG9zIiwibGluZUVkaXRvcl9wb2ludFNlbGVjdGVkIjoiUHJlc3Npb25lIERlbGV0YXIgcGFyYSByZW1vdmVyIHBvbnRvLCBDdHJsT3VDbWQrRCBwYXJhIGR1cGxpY2FyIG91IGFycmFzdGUgcGFyYSBtb3ZlciIsImxpbmVFZGl0b3Jfbm90aGluZ1NlbGVjdGVkIjoiU2VsZWNpb25lIHVtIHBvbnRvIHBhcmEgbW92ZXIgb3UgcmVtb3Zlciwgb3Ugc2VndXJlIEFsdCBlIGNsaXF1ZSBwYXJhIGFkaWNpb25hciBub3ZvcyBwb250b3MifSwiZXJyb3JTcGxhc2giOnsiaGVhZGluZ01haW5fcHJlIjoiRm9pIGVuY29udHJhZG8gdW0gZXJyby4gVGVudGUgIiwiaGVhZGluZ01haW5fYnV0dG9uIjoicmVjYXJyZWdhciBhIHDDoWdpbmEuIiwiY2xlYXJDYW52YXNNZXNzYWdlIjoiU2UgYSByZWNhcmdhIG7Do28gZnVuY2lvbmFyLCB0ZW50ZSAiLCJjbGVhckNhbnZhc01lc3NhZ2VfYnV0dG9uIjoibGltcGFuZG8gYSB0ZWxhLiIsImNsZWFyQ2FudmFzQ2F2ZWF0IjoiIElzc28gcmVzdWx0YXLDoSBlbSBwZXJkYSBkZSB0cmFiYWxobyAiLCJ0cmFja2VkVG9TZW50cnlfcHJlIjoiTyBlcnJvIGNvbSBvIGlkZW50aWZpY2Fkb3IgIiwidHJhY2tlZFRvU2VudHJ5X3Bvc3QiOiIgZm9pIHJhc3RyZWFkbyBubyBub3NzbyBzaXN0ZW1hLiIsIm9wZW5Jc3N1ZU1lc3NhZ2VfcHJlIjoiRm9tb3MgbXVpdG8gY2F1dGVsb3NvcyBwYXJhIG7Do28gaW5jbHVpciBzdWFzIGluZm9ybWHDp8O1ZXMgZGUgY2VuYSBubyBlcnJvLiBTZSBzdWEgY2VuYSBuw6NvIGZvciBwcml2YWRhLCBwb3IgZmF2b3IsIGNvbnNpZGVyZSBzZWd1aXIgbm9zc28gIiwib3Blbklzc3VlTWVzc2FnZV9idXR0b24iOiJyYXN0cmVhZG9yIGRlIGJ1Z3MuIiwib3Blbklzc3VlTWVzc2FnZV9wb3N0IjoiIFBvciBmYXZvciwgaW5jbHVhIGluZm9ybWHDp8O1ZXMgYWJhaXhvLCBjb3BpYW5kbyBlIGNvbGFuZG8gcGFyYSBhIGlzc3VlIGRvIEdpdEh1Yi4iLCJzY2VuZUNvbnRlbnQiOiJDb250ZcO6ZG8gZGEgY2VuYToifSwicm9vbURpYWxvZyI6eyJkZXNjX2ludHJvIjoiVm9jw6ogcG9kZSBjb252aWRhciBwZXNzb2FzIHBhcmEgc3VhIGNlbmEgYXR1YWwgcGFyYSBjb2xhYm9yYXIgY29tIHZvY8OqLiIsImRlc2NfcHJpdmFjeSI6Ik7Do28gc2UgcHJlb2N1cGUsIGEgc2Vzc8OjbyB1c2EgY3JpcHRvZ3JhZmlhIGRlIHBvbnRhIGEgcG9udGE7IHBvcnRhbnRvLCBvIHF1ZSB2b2PDqiBkZXNlbmhhciBwZXJtYW5lY2Vyw6EgcHJpdmFkby4gTmVtIG1lc21vIG5vc3NvIHNlcnZpZG9yIHBvZGVyw6EgdmVyIG8gcXVlIHZvY8OqIGNyaWEuIiwiYnV0dG9uX3N0YXJ0U2Vzc2lvbiI6IkluaWNpYXIgc2Vzc8OjbyIsImJ1dHRvbl9zdG9wU2Vzc2lvbiI6IlBhcmFyIHNlc3PDo28iLCJkZXNjX2luUHJvZ3Jlc3NJbnRybyI6IkEgc2Vzc8OjbyBkZSBjb2xhYm9yYcOnw6NvIGFvIHZpdm8gZXN0w6EgYWdvcmEgZW0gYW5kYW1lbnRvLiIsImRlc2NfcGVyc2lzdGVuY2VXYXJuaW5nIjoiT2JzZXJ2ZSBxdWUgb3MgZGFkb3MgZGEgY2VuYSBzw6NvIGNvbXBhcnRpbGhhZG9zIGVudHJlIG9zIGNvbGFib3JhZG9yZXMgZGUgbWFuZWlyYSBQMlAgZSBuw6NvIHBlcm1hbmVjZW0gbm8gbm9zc28gc2Vydmlkb3IuIFBvcnRhbnRvLCBzZSB0b2RvcyB2b2PDqnMgc2UgZGVzY29uZWN0YXJlbSwgdm9jw6ogcGVyZGVyw6Egb3MgZGFkb3MsIGEgbWVub3MgcXVlIG9zIGV4cG9ydGUgcGFyYSB1bSBhcnF1aXZvIG91IHVtIGxpbmsgZGUgcGFydGlsaGEuIiwiZGVzY19zaGFyZUxpbmsiOiJDb21wYXJ0aWxoZSBlc3RlIGxpbmsgY29tIHF1YWxxdWVyIHBlc3NvYSBjb20gcXVlbSB2b2PDqiBxdWVpcmEgY29sYWJvcmFyOiIsImRlc2NfZXhpdFNlc3Npb24iOiJJbnRlcnJvbXBlbmRvIGEgc2Vzc8OjbyB2b2PDqiBpcsOhIHNlIGRlc2NvbmVjdGFyIGRhIHNhbGEsIG1hcyB2b2PDqiBwb2RlcsOhIGNvbnRpbnVhciB0cmFiYWxoYW5kbyBjb20gYSBjZW5hIGxvY2FsbWVudGUuIE9ic2VydmUgcXVlIGlzc28gbsOjbyBhZmV0YXLDoSBvdXRyYXMgcGVzc29hcywgZSBlbGFzIGFpbmRhIHBvZGVyw6NvIGNvbGFib3JhciBlbSBzdWEgdmVyc8Ojby4ifSwiZXJyb3JEaWFsb2ciOnsidGl0bGUiOiJFcnJvIn0sInNob3J0Y3V0c0RpYWxvZyI6eyJ0aXRsZSI6IkF0YWxob3MgZGUgdGVjbGFkbyIsInNoYXBlcyI6IkZvcm1hcyIsIm9yIjoib3UiLCJjbGljayI6ImNsaWNhciIsImRyYWciOiJhcnJhc3RhciIsImN1cnZlZEFycm93IjoiU2V0YSBjdXJ2YSIsImN1cnZlZExpbmUiOiJMaW5oYSBjdXJ2YSIsImVkaXRvciI6IkVkaXRvciIsInZpZXciOiJWaXN1YWxpemFyIiwiYmxvZyI6IkxlaWEgbyBub3NzbyBibG9nIiwiaG93dG8iOiJTaWdhIG9zIG5vc3NvcyBndWlhcyIsImdpdGh1YiI6IkVuY29udHJvdSBhbGd1bSBwcm9ibGVtYT8gTm9zIGluZm9ybWUiLCJ0ZXh0TmV3TGluZSI6IkFkaWNpb25hciBub3ZhIGxpbmhhICh0ZXh0bykiLCJ0ZXh0RmluaXNoIjoiRmluYWxpemFyIGVkacOnw6NvICh0ZXh0bykiLCJ6b29tVG9GaXQiOiJBanVzdGFyIHBhcmEgY2FiZXIgdG9kb3Mgb3MgZWxlbWVudG9zIn0sImVuY3J5cHRlZCI6eyJ0b29sdGlwIjoiU2V1cyBkZXNlbmhvcyBzw6NvIGNyaXB0b2dyYWZhZG9zIGRlIHBvbnRhIGEgcG9udGEsIGVudMOjbyBvcyBzZXJ2aWRvcmVzIGRvIEV4Y2FsaWRyYXcgbnVuY2Egb3MgdmVyw6NvLiJ9LCJjaGFydHMiOnsibm9OdW1lcmljQ29sdW1uIjoiVm9jw6ogY29sb3UgdW1hIHBsYW5pbGhhIHNlbSB1bWEgY29sdW5hIG51bcOpcmljYS4iLCJ0b29NYW55Q29sdW1ucyI6IlZvY8OqIGNvbG91IHVtYSBwbGFuaWxoYSBjb20gbWFpcyBkZSBkdWFzIGNvbHVuYXMuIn19Jyl9LGZ1bmN0aW9uKGUpe2UuZXhwb3J0cz1KU09OLnBhcnNlKCd7ImxhYmVscyI6eyJwYXN0ZSI6ItCS0YHRgtCw0LLQuNGC0YwiLCJzZWxlY3RBbGwiOiLQktGL0LHRgNCw0YLRjCDQstGB0LUiLCJtdWx0aVNlbGVjdCI6IiIsIm1vdmVDYW52YXMiOiLQn9C10YDQtdC80LXRgdGC0LjRgtGMINGF0L7Qu9GB0YIiLCJjb3B5Ijoi0JrQvtC/0LjRgNC+0LLQsNGC0YwiLCJjb3B5QXNQbmciOiLQodC60L7Qv9C40YDQvtCy0LDRgtGMINCyINCx0YPRhNC10YAg0L7QsdC80LXQvdCwINC60LDQuiBQTkciLCJjb3B5QXNTdmciOiLQodC60L7Qv9C40YDQvtCy0LDRgtGMINCyINCx0YPRhNC10YAg0L7QsdC80LXQvdCwINC60LDQuiBTVkciLCJicmluZ0ZvcndhcmQiOiLQn9C10YDQtdC80LXRgdGC0LjRgtGMINCy0L/QtdGA0LXQtCIsInNlbmRUb0JhY2siOiLQndCwINC30LDQtNC90LjQuSDQv9C70LDQvSIsImJyaW5nVG9Gcm9udCI6ItCd0LAg0L/QtdGA0LXQtNC90LjQuSDQv9C70LDQvSIsInNlbmRCYWNrd2FyZCI6ItCf0LXRgNC10LzQtdGB0YLQuNGC0Ywg0L3QsNC30LDQtCIsImRlbGV0ZSI6ItCj0LTQsNC70LjRgtGMIiwiY29weVN0eWxlcyI6ItCh0LrQvtC/0LjRgNC+0LLQsNGC0Ywg0YHRgtC40LvQuCIsInBhc3RlU3R5bGVzIjoi0JLRgdGC0LDQstC40YLRjCDRgdGC0LjQu9C4Iiwic3Ryb2tlIjoi0J7QsdCy0L7QtNC60LAiLCJiYWNrZ3JvdW5kIjoi0KTQvtC9IiwiZmlsbCI6ItCX0LDQu9C40LLQutCwIiwic3Ryb2tlV2lkdGgiOiLQotC+0LvRidC40L3QsCDRiNGC0YDQuNGF0LAiLCJzdHJva2VTdHlsZSI6IiIsInN0cm9rZVN0eWxlX3NvbGlkIjoiIiwic3Ryb2tlU3R5bGVfZGFzaGVkIjoiIiwic3Ryb2tlU3R5bGVfZG90dGVkIjoiIiwic2xvcHBpbmVzcyI6ItCh0YLQuNC70Ywg0L7QsdCy0L7QtNC60LgiLCJvcGFjaXR5Ijoi0J3QtdC/0YDQvtC30YDQsNGH0L3QvtGB0YLRjCIsInRleHRBbGlnbiI6ItCS0YvRgNCw0LLQvdC40LLQsNC90LjQtSDRgtC10LrRgdGC0LAiLCJmb250U2l6ZSI6ItCg0LDQt9C80LXRgCDRiNGA0LjRhNGC0LAiLCJmb250RmFtaWx5Ijoi0KHQtdC80LXQudGB0YLQstC+INGI0YDQuNGE0YLQvtCyIiwib25seVNlbGVjdGVkIjoi0KLQvtC70YzQutC+INCy0YvQsdGA0LDQvdC90YvQtSIsIndpdGhCYWNrZ3JvdW5kIjoi0KEg0YTQvtC90L7QvCIsImFkZFdhdGVybWFyayI6ItCU0L7QsdCw0LLQuNGC0YwgXFwi0KHQtNC10LvQsNC90L4g0YEgRXhjYWxpZHJhd1xcIiIsImhhbmREcmF3biI6ItCd0LDRgNC40YHQvtCy0LDQvdC90YvQuSDQvtGCINGA0YPQutC4Iiwibm9ybWFsIjoi0J7QsdGL0YfQvdGL0LkiLCJjb2RlIjoi0JrQvtC0Iiwic21hbGwiOiLQnNCw0LvRi9C5IiwibWVkaXVtIjoi0KHRgNC10LTQvdC40LkiLCJsYXJnZSI6ItCR0L7Qu9GM0YjQvtC5IiwidmVyeUxhcmdlIjoi0J7Rh9C10L3RjCDQsdC+0LvRjNGI0L7QuSIsInNvbGlkIjoi0J7QtNC90L7RgtC+0L3QvdCw0Y8iLCJoYWNodXJlIjoi0KjRgtGA0LjRhdC+0LLQsNC90L3QsNGPIiwiY3Jvc3NIYXRjaCI6ItCf0LXRgNC10LrRgNC10YHRgtC90LDRjyIsInRoaW4iOiLQotC+0L3QutCw0Y8iLCJib2xkIjoi0JbQuNGA0L3QsNGPIiwibGVmdCI6ItCh0LvQtdCy0LAiLCJjZW50ZXIiOiLQptC10L3RgtGAIiwicmlnaHQiOiLQodC/0YDQsNCy0LAiLCJleHRyYUJvbGQiOiLQntGH0LXQvdGMINC20LjRgNC90LDRjyDQltC40YDQvdCw0Y8iLCJhcmNoaXRlY3QiOiLQkNGA0YXQuNGC0LXQutGC0L7RgCIsImFydGlzdCI6ItCl0YPQtNC+0LbQvdC40LoiLCJjYXJ0b29uaXN0Ijoi0JrQsNGA0LjQutCw0YLRg9GA0LjRgdGCIiwiZmlsZVRpdGxlIjoi0J3QsNC30LLQsNC90LjQtSDRhNCw0LnQu9CwIiwiY29sb3JQaWNrZXIiOiLQktGL0LHQvtGAINGG0LLQtdGC0LAiLCJjYW52YXNCYWNrZ3JvdW5kIjoi0KTQvtC9INGF0L7Qu9GB0YLQsCIsImRyYXdpbmdDYW52YXMiOiLQpdC+0LvRgdGCINC00LvRjyDRgNC40YHQvtCy0LDQvdC40Y8iLCJsYXllcnMiOiLQodC70L7QuCIsImFjdGlvbnMiOiLQlNC10LnRgdGC0LLQuNGPIiwibGFuZ3VhZ2UiOiLQr9C30YvQuiIsImNyZWF0ZVJvb20iOiLQodC+0LfQtNCw0YLRjCDQvNC90L7Qs9C+0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GM0YHQutGD0Y4g0YHQtdGB0YHQuNGOIiwiZHVwbGljYXRlU2VsZWN0aW9uIjoi0JTRg9Cx0LvQuNC60LDRgiIsInVudGl0bGVkIjoi0JHQtdC3INC90LDQt9Cy0LDQvdC40Y8iLCJuYW1lIjoi0JjQvNGPIiwieW91ck5hbWUiOiLQktCw0YjQtSDQuNC80Y8iLCJtYWRlV2l0aEV4Y2FsaWRyYXciOiLQodC00LXQu9Cw0L3QviDQsiBFeGNhbGlkcmF3IiwiZ3JvdXAiOiLQodCz0YDRg9C/0L/QuNGA0L7QstCw0YLRjCDQstGL0LTQtdC70LXQvdC40LUiLCJ1bmdyb3VwIjoi0KDQsNC30LTQtdC70LjRgtGMINCy0YvQtNC10LvQtdC90LjQtSIsImNvbGxhYm9yYXRvcnMiOiLQodC+0YLRgNGD0LTQvdC40LrQuCIsInRvZ2dsZUdyaWRNb2RlIjoiIiwiYWRkVG9MaWJyYXJ5Ijoi0JTQvtCx0LDQstC40YLRjCDQsiDQsdC40LHQu9C40L7RgtC10LrRgyIsInJlbW92ZUZyb21MaWJyYXJ5Ijoi0KPQtNCw0LvQuNGC0Ywg0LjQtyDQsdC40LHQu9C40L7RgtC10LrQuCIsImxpYnJhcnlMb2FkaW5nTWVzc2FnZSI6IiJ9LCJidXR0b25zIjp7ImNsZWFyUmVzZXQiOiLQntGH0LjRgdGC0LjRgtGMINGF0L7Qu9GB0YIg0Lgg0YHQsdGA0L7RgdC40YLRjCDRhtCy0LXRgiDRhNC+0L3QsCIsImV4cG9ydCI6ItCt0LrRgdC/0L7RgNGC0LjRgNC+0LLQsNGC0YwiLCJleHBvcnRUb1BuZyI6ItCt0LrRgdC/0L7RgNGCINCyIFBORyIsImV4cG9ydFRvU3ZnIjoi0K3QutGB0L/QvtGA0YIg0LIgU1ZHIiwiY29weVRvQ2xpcGJvYXJkIjoi0KHQutC+0L/QuNGA0L7QstCw0YLRjCDQsiDQsdGD0YTQtdGAINC+0LHQvNC10L3QsCIsImNvcHlQbmdUb0NsaXBib2FyZCI6ItCh0LrQvtC/0LjRgNC+0LLQsNGC0YwgUE5HINCyINCx0YPRhNC10YAg0L7QsdC80LXQvdCwIiwic2F2ZSI6ItCh0L7RhdGA0LDQvdC40YLRjCIsInNhdmVBcyI6ItCh0L7RhdGA0LDQvdC40YLRjCDQutCw0LoiLCJsb2FkIjoi0JfQsNCz0YDRg9C30LjRgtGMIiwiZ2V0U2hhcmVhYmxlTGluayI6ItCf0L7Qu9GD0YfQuNGC0Ywg0LTQvtGB0YLRg9C/INC/0L4g0YHRgdGL0LvQutC1IiwiY2xvc2UiOiLQl9Cw0LrRgNGL0YLRjCIsInNlbGVjdExhbmd1YWdlIjoi0JLRi9Cx0YDQsNGC0Ywg0Y/Qt9GL0LoiLCJzY3JvbGxCYWNrVG9Db250ZW50Ijoi0JLQtdGA0L3Rg9GC0YzRgdGPINC6INGB0L7QtNC10YDQttC40LzQvtC80YMiLCJ6b29tSW4iOiLQo9Cy0LXQu9C40YfQuNGC0YwiLCJ6b29tT3V0Ijoi0KPQvNC10L3RjNGI0LjRgtGMIiwicmVzZXRab29tIjoi0KHQsdGA0L7RgdC40YLRjCDQvNCw0YHRiNGC0LDQsSIsIm1lbnUiOiLQnNC10L3RjiIsImRvbmUiOiLQk9C+0YLQvtCy0L4iLCJlZGl0Ijoi0JjQt9C80LXQvdC40YLRjCIsInVuZG8iOiLQqNCw0LMg0L3QsNC30LDQtCIsInJlZG8iOiLQqNCw0LMg0LLQv9C10YDQtdC0Iiwicm9vbURpYWxvZyI6ItCd0LDRh9Cw0YLRjCDRgdC+0LLQvNC10YHRgtC90YPRjiDRgNCw0LHQvtGC0YMiLCJjcmVhdGVOZXdSb29tIjoi0KHQvtC30LTQsNGC0Ywg0L3QvtCy0YPRjiDQutC+0LzQvdCw0YLRgyIsInRvZ2dsZUZ1bGxTY3JlZW4iOiLQn9C10YDQtdC60LvRjtGH0LjRgtGMINC/0L7Qu9C90L7RjdC60YDQsNC90L3Ri9C5INGA0LXQttC40LwiLCJ0b2dnbGVaZW5Nb2RlIjoi0J/QtdGA0LXQutC70Y7Rh9C40YLRjCDRgNC10LbQuNC8INC60L7QvdGG0LXQvdGC0YDQsNGG0LjQuCDQstC90LjQvNCw0L3QuNGPIiwiZXhpdFplbk1vZGUiOiLQktGL0LrQu9GO0YfQuNGC0Ywg0YDQtdC20LjQvCDQutC+0L3RhtC10L3RgtGA0LDRhtC40Lgg0LLQvdC40LzQsNC90LjRjyJ9LCJhbGVydHMiOnsiY2xlYXJSZXNldCI6ItCt0YLQviDQvtGH0LjRgdGC0LjRgiDQstC10YHRjCDRhdC+0LvRgdGCLiDQktGLINGD0LLQtdGA0LXQvdGLPyIsImNvdWxkTm90Q3JlYXRlU2hhcmVhYmxlTGluayI6ItCd0LUg0YPQtNCw0LvQvtGB0Ywg0YHQvtC30LTQsNGC0Ywg0L7QsdGJ0LXQtNC+0YHRgtGD0L/QvdGD0Y4g0YHRgdGL0LvQutGDLiIsImNvdWxkTm90TG9hZEludmFsaWRGaWxlIjoi0J3QtSDRg9C00LDQu9C+0YHRjCDQt9Cw0LPRgNGD0LfQuNGC0Ywg0L3QtdC00L7Qv9GD0YHRgtC40LzRi9C5INGE0LDQudC7IiwiaW1wb3J0QmFja2VuZEZhaWxlZCI6ItCd0LUg0YPQtNCw0LvQvtGB0Ywg0LjQvNC/0L7RgNGC0LjRgNC+0LLQsNGC0Ywg0LjQtyDQsdGN0LrRjdC90LTQsC4iLCJjYW5ub3RFeHBvcnRFbXB0eUNhbnZhcyI6ItCd0LUg0LzQvtC20LXRgiDRjdC60YHQv9C+0YDRgtC40YDQvtCy0LDRgtGMINC/0YPRgdGC0L7QuSDRhdC+0LvRgdGCLiIsImNvdWxkTm90Q29weVRvQ2xpcGJvYXJkIjoi0J3QtSDRg9C00LDQu9C+0YHRjCDRgdC60L7Qv9C40YDQvtCy0LDRgtGMINCyINCx0YPRhNC10YAg0L7QsdC80LXQvdCwLiDQn9C+0L/RgNC+0LHRg9C50YLQtSDQuNGB0L/QvtC70YzQt9C+0LLQsNGC0Ywg0LLQtdCxLdCx0YDQsNGD0LfQtdGAIENocm9tZS4iLCJkZWNyeXB0RmFpbGVkIjoi0J3QtSDRg9C00LDQu9C+0YHRjCDQtNC10LrQvtC00LjRgNC+0LLQsNGC0Ywg0LTQsNC90L3Ri9C1LiIsInVwbG9hZGVkU2VjdXJseSI6ItCX0LDQs9GA0YPQttCw0LXQvNGL0LUg0LTQsNC90L3Ri9C1INC30LDRidC40YnQtdC90LAg0YHQutCy0L7Qt9C90YvQvCDRiNC40YTRgNC+0LLQsNC90LjQtdC8LCDRh9GC0L4g0L7Qt9C90LDRh9Cw0LXRgiwg0YfRgtC+INGB0LXRgNCy0LXRgCBFeGNhbGlkcmF3INC4INGC0YDQtdGC0YzQuCDRgdGC0L7RgNC+0L3RiyDQvdC1INC80L7Qs9GD0YIg0L/RgNC+0YfQuNGC0LDRgtGMINGB0L7QtNC10YDQttC40LzQvtC1LiIsImxvYWRTY2VuZU92ZXJyaWRlUHJvbXB0IjoiIn0sInRvb2xCYXIiOnsic2VsZWN0aW9uIjoi0JLRi9C00LXQu9C10L3QuNC1INC+0LHQu9Cw0YHRgtC4IiwiZHJhdyI6ItCh0LLQvtCx0L7QtNC90L7QtSDRgNC40YHQvtCy0LDQvdC40LUiLCJyZWN0YW5nbGUiOiLQn9GA0Y/QvNC+0YPQs9C+0LvRjNC90LjQuiIsImRpYW1vbmQiOiLQoNC+0LzQsSIsImVsbGlwc2UiOiLQrdC70LvQuNC/0YEiLCJhcnJvdyI6IkPRgtGA0LXQu9C60LAiLCJsaW5lIjoi0JvQuNC90LjRjyIsInRleHQiOiLQotC10LrRgdGCIiwibGlicmFyeSI6ItCR0LjQsdC70LjQvtGC0LXQutCwIiwibG9jayI6ItCh0L7RhdGA0LDQvdGP0YLRjCDQstGL0LHRgNCw0L3QvdGL0Lkg0LjQvdGB0YLRgNGD0LzQtdC90YIg0LDQutGC0LjQstC90YvQvCDQv9C+0YHQu9C1INGA0LjRgdC+0LLQsNC90LjRjyJ9LCJoZWFkaW5ncyI6eyJjYW52YXNBY3Rpb25zIjoi0J7Qv9C10YDQsNGG0LjQuCDRhdC+0LvRgdGC0LAiLCJzZWxlY3RlZFNoYXBlQWN0aW9ucyI6ItCe0L/QtdGA0LDRhtC40Lgg0LLRi9Cx0YDQsNC90L3QvtC5INGE0LjQs9GD0YDRiyIsInNoYXBlcyI6ItCk0LjQs9GD0YDRiyJ9LCJoaW50cyI6eyJsaW5lYXJFbGVtZW50Ijoi0J3QsNC20LzQuNGC0LUsINGH0YLQvtCx0Ysg0L3QsNGH0LDRgtGMINC90LXRgdC60L7Qu9GM0LrQviDRgtC+0YfQtdC6LCDQv9C10YDQtdGC0LDRidC40YLQtSDQtNC70Y8g0L7QtNC90L7QuSDQu9C40L3QuNC4IiwiZnJlZURyYXciOiLQndCw0LbQvNC40YLQtSDQuCDQv9C10YDQtdGC0LDRgdC60LjQstCw0LnRgtC1LCDQvtGC0L/Rg9GB0YLQuNGC0LUg0L/QviDQt9Cw0LLQtdGA0YjQtdC90LjQuCIsImxpbmVhckVsZW1lbnRNdWx0aSI6ItCa0LvQuNC60L3QuNGC0LUg0L3QsCDQv9C+0YHQu9C10LTQvdC10Lkg0YLQvtGH0LrQtSDQuNC70Lgg0L3QsNC20LzQuNGC0LUgRXNjYXBlINC40LvQuCBFbnRlciDRh9GC0L7QsdGLINC30LDQutC+0L3Rh9C40YLRjCIsInJlc2l6ZSI6ItCS0Ysg0LzQvtC20LXRgtC1INC+0LPRgNCw0L3QuNGH0LjRgtGMINC/0YDQvtC/0L7RgNGG0LjQuCwg0YPQtNC10YDQttC40LLQsNGPIFNISUZUINCy0L4g0LLRgNC10LzRjyDQuNC30LzQtdC90LXQvdC40Y8g0YDQsNC30LzQtdGA0L7QsixcXG7Rg9C00LXRgNC20LjQstCw0LnRgtC1IEFMVCDRh9GC0L7QsdGLINC40LfQvNC10L3QuNGC0Ywg0YDQsNC30LzQtdGAINC40Lcg0YbQtdC90YLRgNCwIiwicm90YXRlIjoi0JLRiyDQvNC+0LbQtdGC0LUg0L7Qs9GA0LDQvdC40YfQuNGC0Ywg0YPQs9C70YssINGD0LTQtdGA0LbQuNCy0LDRjyBTSElGVCDQstC+INCy0YDQtdC80Y8g0LLRgNCw0YnQtdC90LjRjyIsImxpbmVFZGl0b3JfaW5mbyI6ItCU0LLQsNC20LTRiyDQutC70LjQutC90LjRgtC1INC40LvQuCDQvdCw0LbQvNC40YLQtSBFbnRlciwg0YfRgtC+0LHRiyDRgNC10LTQsNC60YLQuNGA0L7QstCw0YLRjCDRgtC+0YfQutC4IiwibGluZUVkaXRvcl9wb2ludFNlbGVjdGVkIjoiIiwibGluZUVkaXRvcl9ub3RoaW5nU2VsZWN0ZWQiOiIifSwiZXJyb3JTcGxhc2giOnsiaGVhZGluZ01haW5fcHJlIjoi0JLQvtC30L3QuNC60LvQsCDQvtGI0LjQsdC60LAuINCf0L7Qv9GA0L7QsdGD0LnRgtC1ICIsImhlYWRpbmdNYWluX2J1dHRvbiI6ItC/0LXRgNC10LfQsNCz0YDRg9C30LjRgtGMINGB0YLRgNCw0L3QuNGG0YMuIiwiY2xlYXJDYW52YXNNZXNzYWdlIjoi0JXRgdC70Lgg0L/QtdGA0LXQt9Cw0LPRgNGD0LfQutCwINGB0YLRgNCw0L3QuNGG0Ysg0L3QtSDQv9C+0LzQvtCz0LvQsCwg0L/QvtC/0YDQvtCx0YPQudGC0LUgIiwiY2xlYXJDYW52YXNNZXNzYWdlX2J1dHRvbiI6ItC+0YfQuNGB0YLQuNGC0Ywg0YXQvtC70YHRgi4iLCJjbGVhckNhbnZhc0NhdmVhdCI6IiDQotC10LrRg9GJ0LDRjyDRgNCw0LHQvtGC0LAg0LHRg9C00LXRgiDRg9GC0LXRgNGP0L3QsCAiLCJ0cmFja2VkVG9TZW50cnlfcHJlIjoi0J7RiNC40LHQutCwINGBINC40LTQtdC90YLQuNGE0LjQutCw0YLQvtGA0L7QvCAiLCJ0cmFja2VkVG9TZW50cnlfcG9zdCI6IiDQvtGC0YHQu9C10LbQuNCy0LDQtdGC0YHRjyDQsiDQvdCw0YjQtdC5INGB0LjRgdGC0LXQvNC1LiIsIm9wZW5Jc3N1ZU1lc3NhZ2VfcHJlIjoi0JTQu9GPINCx0LXQt9C+0L/QsNGB0L3QvtGB0YLQuCDQuNC90YTQvtGA0LzQsNGG0LjRjyDQviDQstCw0YjQtdC5INGB0YbQtdC90LUg0L3QtSDQstC60LvRjtGH0LXQvdCwINCyINC+0YjQuNCx0LrRgy4g0JXRgdC70Lgg0LIg0YHRhtC10L3QtSDQvdC10YIg0L3QuNGH0LXQs9C+INC60L7QvdGE0LjQtNC10L3RhtC40LDQu9GM0L3QvtCz0L4sINC/0L7QttCw0LvRg9C50YHRgtCwINGB0LvQtdC00YPQudGC0LUg0L3QsNGI0LjQvCAiLCJvcGVuSXNzdWVNZXNzYWdlX2J1dHRvbiI6ItCx0LDQsyDRgtGA0LXQutC10YDQtS4iLCJvcGVuSXNzdWVNZXNzYWdlX3Bvc3QiOiIg0J/QvtC20LDQu9GD0LnRgdGC0LAsINC/0YDQuNC70L7QttC40YLQtSDQuNC90YTQvtGA0LzQsNGG0LjRjiDQvdC40LbQtSwg0YHQutC+0L/QuNGA0L7QstCw0LIg0Lgg0LLRgdGC0LDQstC40LIg0LXRkSwg0LIgaXNzdWUgR2l0SHViLiIsInNjZW5lQ29udGVudCI6ItCh0L7QtNC10YDQttCw0L3QuNC1INGB0YbQtdC90Ys6In0sInJvb21EaWFsb2ciOnsiZGVzY19pbnRybyI6ItCS0Ysg0LzQvtC20LXRgtC1INC/0YDQuNCz0LvQsNGB0LjRgtGMINC70Y7QtNC10Lkg0LIg0YLQtdC60YPRidGD0Y4g0YHRhtC10L3RgyDQtNC70Y8g0YHQvtCy0LzQtdGB0YLQvdC+0Lkg0YDQsNCx0L7RgtGLLiIsImRlc2NfcHJpdmFjeSI6ItCd0LUg0LHQtdGB0L/QvtC60L7QudGC0LXRgdGMLCDRgdC10YHRgdC40Y8g0LjRgdC/0L7Qu9GM0LfRg9C10YIg0YHQutCy0L7Qt9C90L7QtSDRiNC40YTRgNC+0LLQsNC90LjQtSwg0L/QvtGN0YLQvtC80YMg0LLRgdGRINGH0YLQviDQstGLINC90LDRgNC40YHRg9C10YLQtSDQvtGB0YLQsNC90LXRgtGB0Y8g0L/RgNC40LLQsNGC0L3Ri9C8LiDQktCw0YjQsCDQuNC90YTQvtGA0LzQsNGG0LjRjyDQvdC1INCx0YPQtNC10YIg0LTQvtGB0YLRg9C/0L3QsCDQtNCw0LbQtSDQvdCwINC90LDRiNC40YUg0YHQtdGA0LLQtdGA0LDRhS4iLCJidXR0b25fc3RhcnRTZXNzaW9uIjoi0J3QsNGH0LDRgtGMINGB0LXRgdGB0LjRjiIsImJ1dHRvbl9zdG9wU2Vzc2lvbiI6ItCX0LDQutC+0L3Rh9C40YLRjCDRgdC10YHRgdC40Y4iLCJkZXNjX2luUHJvZ3Jlc3NJbnRybyI6ItCh0L7QstC80LXRgdGC0L3QsNGPINGB0LXRgdGB0LjRjyDRgtC10L/QtdGA0Ywg0LDQutGC0LjQstC90LAuIiwiZGVzY19wZXJzaXN0ZW5jZVdhcm5pbmciOiIiLCJkZXNjX3NoYXJlTGluayI6ItCf0L7QtNC10LvQuNGC0LXRgdGMINGN0YLQvtC5INGB0YHRi9C70LrQvtC5INGB0L4g0LLRgdC10LzQuCDRg9GH0LDRgdGC0L3QuNC60LDQvNC4OiIsImRlc2NfZXhpdFNlc3Npb24iOiIifSwiZXJyb3JEaWFsb2ciOnsidGl0bGUiOiLQntGI0LjQsdC60LAifSwic2hvcnRjdXRzRGlhbG9nIjp7InRpdGxlIjoi0KHQvtGH0LXRgtCw0L3QuNGPINC60LvQsNCy0LjRiCIsInNoYXBlcyI6ItCk0LjQs9GD0YDRiyIsIm9yIjoi0LjQu9C4IiwiY2xpY2siOiLQvdCw0LbQsNGC0YwiLCJkcmFnIjoi0L/QtdGA0LXRgtCw0YnQuNGC0YwiLCJjdXJ2ZWRBcnJvdyI6ItCY0LfQvtCz0L3Rg9GC0LDRjyDRgdGC0YDQtdC70LrQsCIsImN1cnZlZExpbmUiOiLQmNC30L7Qs9C90YPRgtCw0Y8g0LvQuNC90LjRjyIsImVkaXRvciI6ItCg0LXQtNCw0LrRgtC+0YAiLCJ2aWV3Ijoi0J/RgNC+0YHQvNC+0YLRgCIsImJsb2ciOiLQn9GA0L7Rh9C40YLQsNC50YLQtSDQvdCw0Ygg0LHQu9C+0LMiLCJob3d0byI6ItCh0LvQtdC00YPQudGC0LUg0L3QsNGI0LjQvCDQuNC90YHRgtGA0YPQutGG0LjRj9C8IiwiZ2l0aHViIjoi0J3QsNGI0LvQuCDQv9GA0L7QsdC70LXQvNGDPyDQntGC0L/RgNCw0LLRjNGC0LUiLCJ0ZXh0TmV3TGluZSI6ItCU0L7QsdCw0LLQuNGC0Ywg0L3QvtCy0YPRjiDRgdGC0YDQvtC60YMgKNGC0LXQutGB0YIpIiwidGV4dEZpbmlzaCI6ItCX0LDQutC+0L3Rh9C40YLRjCDRgNC10LTQsNC60YLQuNGA0L7QstCw0L3QuNC1ICjRgtC10LrRgdGCKSIsInpvb21Ub0ZpdCI6IiJ9LCJlbmNyeXB0ZWQiOnsidG9vbHRpcCI6IiJ9LCJjaGFydHMiOnsibm9OdW1lcmljQ29sdW1uIjoiIiwidG9vTWFueUNvbHVtbnMiOiLQktGLINCy0YHRgtCw0LLQuNC70Lgg0YLQsNCx0LvQuNGG0YMg0YEg0LHQvtC70LXQtSDRh9C10Lwg0LTQstGD0LzRjyDRgdGC0L7Qu9Cx0YbQsNC80LguIn19Jyl9LGZ1bmN0aW9uKGUpe2UuZXhwb3J0cz1KU09OLnBhcnNlKCd7ImxhYmVscyI6eyJwYXN0ZSI6Ik5naml0Iiwic2VsZWN0QWxsIjoiUMOrcnpnamlkaCB0w6sgZ2ppdGhhIiwibXVsdGlTZWxlY3QiOiIiLCJtb3ZlQ2FudmFzIjoiIiwiY29weSI6IktvcGpvIiwiY29weUFzUG5nIjoiS29wam8gbsOrIGNsaXBib2FyZCBzaSBQTkciLCJjb3B5QXNTdmciOiJLb3BqbyBuw6sgY2xpcGJvYXJkIHNpIFNWRyIsImJyaW5nRm9yd2FyZCI6IiIsInNlbmRUb0JhY2siOiIiLCJicmluZ1RvRnJvbnQiOiIiLCJzZW5kQmFja3dhcmQiOiIiLCJkZWxldGUiOiJGc2hpaiIsImNvcHlTdHlsZXMiOiJLb3BqbyBzdGlsZXQiLCJwYXN0ZVN0eWxlcyI6Ik5naml0IHN0aWxldCIsInN0cm9rZSI6IiIsImJhY2tncm91bmQiOiIiLCJmaWxsIjoiIiwic3Ryb2tlV2lkdGgiOiIiLCJzdHJva2VTdHlsZSI6IiIsInN0cm9rZVN0eWxlX3NvbGlkIjoiSSBwYW5kw6tycHJlcsOrIiwic3Ryb2tlU3R5bGVfZGFzaGVkIjoiTWUgdmlqYSIsInN0cm9rZVN0eWxlX2RvdHRlZCI6Ik1lIHBpa2EiLCJzbG9wcGluZXNzIjoiIiwib3BhY2l0eSI6IlRyYW5zcGFyZW5jYSIsInRleHRBbGlnbiI6IiIsImZvbnRTaXplIjoiTWFkaMOrc2lhIGUgZ8Orcm1hdmUiLCJmb250RmFtaWx5IjoiRmFtaWxqYSBlIGfDq3JtYXZlIiwib25seVNlbGVjdGVkIjoiVmV0w6ttIHTDqyBww6tyemdqZWRodXJhdCIsIndpdGhCYWNrZ3JvdW5kIjoiTWUgc2ZvbmRpbiIsImFkZFdhdGVybWFyayI6IlNodG8gXFwiTWFkZSB3aXRoIEV4Y2FsaWRyYXdcXCIiLCJoYW5kRHJhd24iOiJWaXphdHVhciBtZSBkb3LDqyIsIm5vcm1hbCI6Ik5vcm1hbGUiLCJjb2RlIjoiS29kIiwic21hbGwiOiJFIHZvZ8OrbCIsIm1lZGl1bSI6IkUgbWVzbWUiLCJsYXJnZSI6IkUgbWFkaGUiLCJ2ZXJ5TGFyZ2UiOiJTaHVtw6sgZSBtYWRoZSIsInNvbGlkIjoiTWJ1c2h1ciIsImhhY2h1cmUiOiJFIHZpasOrenVhciIsImNyb3NzSGF0Y2giOiJFIHZpasOrenVhciBrcnlxIiwidGhpbiI6IkhvbGzDqyIsImJvbGQiOiJUcmFzaMOrIiwibGVmdCI6Ik1hanRhcyIsImNlbnRlciI6Ik7DqyBxZW5kw6tyIiwicmlnaHQiOiJEamF0aHRhcyIsImV4dHJhQm9sZCI6IlNodW3DqyB0cmFzaMOrIiwiYXJjaGl0ZWN0IjoiQXJraXRla3QiLCJhcnRpc3QiOiJBcnRpc3QiLCJjYXJ0b29uaXN0IjoiS2FyaWthdHVyaXN0IiwiZmlsZVRpdGxlIjoiVGl0dWxsaSBpIGRva3VtZW50aXQiLCJjb2xvclBpY2tlciI6IlDDq3J6Z2plZGjDq3NpIGkgbmdqeXJhdmUiLCJjYW52YXNCYWNrZ3JvdW5kIjoiU2ZvbmRpIGkga2FuYXZhY8OrcyIsImRyYXdpbmdDYW52YXMiOiJLYW5hdmFjYSBlIHZpemF0aW1pdCIsImxheWVycyI6IlNodHJlc2F0IiwiYWN0aW9ucyI6IlZlcHJpbWV0IiwibGFuZ3VhZ2UiOiJHanVoYSIsImNyZWF0ZVJvb20iOiIiLCJkdXBsaWNhdGVTZWxlY3Rpb24iOiIiLCJ1bnRpdGxlZCI6IiIsIm5hbWUiOiIiLCJ5b3VyTmFtZSI6IiIsIm1hZGVXaXRoRXhjYWxpZHJhdyI6IiIsImdyb3VwIjoiIiwidW5ncm91cCI6IiIsImNvbGxhYm9yYXRvcnMiOiIiLCJ0b2dnbGVHcmlkTW9kZSI6IiIsImFkZFRvTGlicmFyeSI6IiIsInJlbW92ZUZyb21MaWJyYXJ5IjoiIiwibGlicmFyeUxvYWRpbmdNZXNzYWdlIjoiIn0sImJ1dHRvbnMiOnsiY2xlYXJSZXNldCI6IiIsImV4cG9ydCI6IiIsImV4cG9ydFRvUG5nIjoiIiwiZXhwb3J0VG9TdmciOiIiLCJjb3B5VG9DbGlwYm9hcmQiOiIiLCJjb3B5UG5nVG9DbGlwYm9hcmQiOiIiLCJzYXZlIjoiIiwic2F2ZUFzIjoiIiwibG9hZCI6IiIsImdldFNoYXJlYWJsZUxpbmsiOiIiLCJjbG9zZSI6IiIsInNlbGVjdExhbmd1YWdlIjoiIiwic2Nyb2xsQmFja1RvQ29udGVudCI6IiIsInpvb21JbiI6IiIsInpvb21PdXQiOiIiLCJyZXNldFpvb20iOiIiLCJtZW51IjoiIiwiZG9uZSI6IiIsImVkaXQiOiIiLCJ1bmRvIjoiIiwicmVkbyI6IiIsInJvb21EaWFsb2ciOiIiLCJjcmVhdGVOZXdSb29tIjoiIiwidG9nZ2xlRnVsbFNjcmVlbiI6IiIsInRvZ2dsZVplbk1vZGUiOiIiLCJleGl0WmVuTW9kZSI6IiJ9LCJhbGVydHMiOnsiY2xlYXJSZXNldCI6IiIsImNvdWxkTm90Q3JlYXRlU2hhcmVhYmxlTGluayI6IiIsImNvdWxkTm90TG9hZEludmFsaWRGaWxlIjoiIiwiaW1wb3J0QmFja2VuZEZhaWxlZCI6IiIsImNhbm5vdEV4cG9ydEVtcHR5Q2FudmFzIjoiTnVrIGVrc3BvcnRvaGV0IHRlbGFqbyBib3NoLiIsImNvdWxkTm90Q29weVRvQ2xpcGJvYXJkIjoiIiwiZGVjcnlwdEZhaWxlZCI6IlNcJ211bmQgdMOrIGRlc2hpZnJvaiB0w6sgZGjDq25hdC4iLCJ1cGxvYWRlZFNlY3VybHkiOiIiLCJsb2FkU2NlbmVPdmVycmlkZVByb21wdCI6IiJ9LCJ0b29sQmFyIjp7InNlbGVjdGlvbiI6IlDDq3J6Z2plZGhqYSIsImRyYXciOiJWaXphdGltIG1lIGRvcsOrIHTDqyBsaXLDqyIsInJlY3RhbmdsZSI6IkRyZWp0a8OrbmTDq3NoIiwiZGlhbW9uZCI6IlJvbWIiLCJlbGxpcHNlIjoiRWxpcHMiLCJhcnJvdyI6IlNoaWdqZXTDqyIsImxpbmUiOiJWaWrDqyIsInRleHQiOiJUZWtzdCIsImxpYnJhcnkiOiIiLCJsb2NrIjoiIn0sImhlYWRpbmdzIjp7ImNhbnZhc0FjdGlvbnMiOiJWZXByaW1lIG1iaSB0ZWxham9uIiwic2VsZWN0ZWRTaGFwZUFjdGlvbnMiOiJWZXByaW1lIG1iaSBmb3JtYXQgZSBww6tyemdqZWRodXJhIiwic2hhcGVzIjoiRm9ybWF0In0sImhpbnRzIjp7ImxpbmVhckVsZW1lbnQiOiIiLCJmcmVlRHJhdyI6IiIsImxpbmVhckVsZW1lbnRNdWx0aSI6IiIsInJlc2l6ZSI6IiIsInJvdGF0ZSI6IiIsImxpbmVFZGl0b3JfaW5mbyI6IiIsImxpbmVFZGl0b3JfcG9pbnRTZWxlY3RlZCI6IiIsImxpbmVFZGl0b3Jfbm90aGluZ1NlbGVjdGVkIjoiIn0sImVycm9yU3BsYXNoIjp7ImhlYWRpbmdNYWluX3ByZSI6IiIsImhlYWRpbmdNYWluX2J1dHRvbiI6IiIsImNsZWFyQ2FudmFzTWVzc2FnZSI6IiIsImNsZWFyQ2FudmFzTWVzc2FnZV9idXR0b24iOiIiLCJjbGVhckNhbnZhc0NhdmVhdCI6IiIsInRyYWNrZWRUb1NlbnRyeV9wcmUiOiIiLCJ0cmFja2VkVG9TZW50cnlfcG9zdCI6IiIsIm9wZW5Jc3N1ZU1lc3NhZ2VfcHJlIjoiIiwib3Blbklzc3VlTWVzc2FnZV9idXR0b24iOiIiLCJvcGVuSXNzdWVNZXNzYWdlX3Bvc3QiOiIiLCJzY2VuZUNvbnRlbnQiOiJQw6tybWJhanRqYSBlIHNrZW7Dq3M6In0sInJvb21EaWFsb2ciOnsiZGVzY19pbnRybyI6IiIsImRlc2NfcHJpdmFjeSI6IiIsImJ1dHRvbl9zdGFydFNlc3Npb24iOiJOaXMgc2VzaW9uaW4iLCJidXR0b25fc3RvcFNlc3Npb24iOiJOZGFsIHNlc2lvbmluIiwiZGVzY19pblByb2dyZXNzSW50cm8iOiIiLCJkZXNjX3BlcnNpc3RlbmNlV2FybmluZyI6IiIsImRlc2Nfc2hhcmVMaW5rIjoiIiwiZGVzY19leGl0U2Vzc2lvbiI6IiJ9LCJlcnJvckRpYWxvZyI6eyJ0aXRsZSI6IkdhYmltIn0sInNob3J0Y3V0c0RpYWxvZyI6eyJ0aXRsZSI6IlNoa3VydGVzYXQgZSB0YXN0aWVyw6tzIiwic2hhcGVzIjoiRm9ybWF0Iiwib3IiOiJvc2UiLCJjbGljayI6ImtsaWtvIiwiZHJhZyI6InTDq3JoaXEiLCJjdXJ2ZWRBcnJvdyI6IlNoaWdqZXTDqyBlIGxha3VhciIsImN1cnZlZExpbmUiOiJWaWrDqyBlIGxha3VhciIsImVkaXRvciI6IiIsInZpZXciOiJTaGlrbyIsImJsb2ciOiIiLCJob3d0byI6IiIsImdpdGh1YiI6IiIsInRleHROZXdMaW5lIjoiIiwidGV4dEZpbmlzaCI6IiIsInpvb21Ub0ZpdCI6IiJ9LCJlbmNyeXB0ZWQiOnsidG9vbHRpcCI6IiJ9LCJjaGFydHMiOnsibm9OdW1lcmljQ29sdW1uIjoiIiwidG9vTWFueUNvbHVtbnMiOiIifX0nKX0sZnVuY3Rpb24oZSl7ZS5leHBvcnRzPUpTT04ucGFyc2UoJ3sibGFiZWxzIjp7InBhc3RlIjoi4K6S4K6f4K+N4K6f4K+BIiwic2VsZWN0QWxsIjoiU2VsZWN0IGFsbCIsIm11bHRpU2VsZWN0IjoiIiwibW92ZUNhbnZhcyI6IuCupOCuv+CusOCviCDgrqjgrpXgrrDgr43grqTgr43grqTgr4EiLCJjb3B5Ijoi4K6o4K6V4K6y4K+NIiwiY29weUFzUG5nIjoiUE5HIOCuhuCulSDgrqjgrpXgrrLgr4bgrp/gr4EiLCJjb3B5QXNTdmciOiJTVkcg4K6G4K6VIOCuqOCuleCusuCvhuCun+CvgSIsImJyaW5nRm9yd2FyZCI6IuCuruCvgeCuqeCvjSDgrpXgr4rgrqPgr43grp/gr4HgrrXgrr4iLCJzZW5kVG9CYWNrIjoi4K6q4K6/4K6p4K+N4K6p4K+HIOCuheCuqeCvgeCuquCvjeCuquCvgSIsImJyaW5nVG9Gcm9udCI6IuCuruCvgeCuqeCvjSDgrpXgr4rgrqPgr43grp/gr4HgrrXgrr4iLCJzZW5kQmFja3dhcmQiOiLgrqrgrr/grqngr43grqngr4cg4K6F4K6p4K+B4K6q4K+N4K6q4K+BIiwiZGVsZXRlIjoi4K6o4K+A4K6V4K+N4K6V4K+BIiwiY29weVN0eWxlcyI6IiIsInBhc3RlU3R5bGVzIjoiIiwic3Ryb2tlIjoiIiwiYmFja2dyb3VuZCI6IiIsImZpbGwiOiIiLCJzdHJva2VXaWR0aCI6IiIsInN0cm9rZVN0eWxlIjoiIiwic3Ryb2tlU3R5bGVfc29saWQiOiIiLCJzdHJva2VTdHlsZV9kYXNoZWQiOiIiLCJzdHJva2VTdHlsZV9kb3R0ZWQiOiIiLCJzbG9wcGluZXNzIjoiIiwib3BhY2l0eSI6IiIsInRleHRBbGlnbiI6IiIsImZvbnRTaXplIjoiIiwiZm9udEZhbWlseSI6IiIsIm9ubHlTZWxlY3RlZCI6IiIsIndpdGhCYWNrZ3JvdW5kIjoiIiwiYWRkV2F0ZXJtYXJrIjoiIiwiaGFuZERyYXduIjoiIiwibm9ybWFsIjoiIiwiY29kZSI6IiIsInNtYWxsIjoiIiwibWVkaXVtIjoiIiwibGFyZ2UiOiIiLCJ2ZXJ5TGFyZ2UiOiIiLCJzb2xpZCI6IiIsImhhY2h1cmUiOiIiLCJjcm9zc0hhdGNoIjoiIiwidGhpbiI6IiIsImJvbGQiOiIiLCJsZWZ0IjoiIiwiY2VudGVyIjoiIiwicmlnaHQiOiIiLCJleHRyYUJvbGQiOiIiLCJhcmNoaXRlY3QiOiIiLCJhcnRpc3QiOiIiLCJjYXJ0b29uaXN0IjoiIiwiZmlsZVRpdGxlIjoiIiwiY29sb3JQaWNrZXIiOiIiLCJjYW52YXNCYWNrZ3JvdW5kIjoiIiwiZHJhd2luZ0NhbnZhcyI6IiIsImxheWVycyI6IiIsImFjdGlvbnMiOiIiLCJsYW5ndWFnZSI6IiIsImNyZWF0ZVJvb20iOiIiLCJkdXBsaWNhdGVTZWxlY3Rpb24iOiIiLCJ1bnRpdGxlZCI6IiIsIm5hbWUiOiIiLCJ5b3VyTmFtZSI6IiIsIm1hZGVXaXRoRXhjYWxpZHJhdyI6IiIsImdyb3VwIjoiIiwidW5ncm91cCI6IiIsImNvbGxhYm9yYXRvcnMiOiIiLCJ0b2dnbGVHcmlkTW9kZSI6IiIsImFkZFRvTGlicmFyeSI6IiIsInJlbW92ZUZyb21MaWJyYXJ5IjoiIiwibGlicmFyeUxvYWRpbmdNZXNzYWdlIjoiIn0sImJ1dHRvbnMiOnsiY2xlYXJSZXNldCI6IiIsImV4cG9ydCI6IiIsImV4cG9ydFRvUG5nIjoiIiwiZXhwb3J0VG9TdmciOiIiLCJjb3B5VG9DbGlwYm9hcmQiOiIiLCJjb3B5UG5nVG9DbGlwYm9hcmQiOiIiLCJzYXZlIjoiIiwic2F2ZUFzIjoiIiwibG9hZCI6IiIsImdldFNoYXJlYWJsZUxpbmsiOiIiLCJjbG9zZSI6IiIsInNlbGVjdExhbmd1YWdlIjoiIiwic2Nyb2xsQmFja1RvQ29udGVudCI6IiIsInpvb21JbiI6IiIsInpvb21PdXQiOiIiLCJyZXNldFpvb20iOiIiLCJtZW51IjoiIiwiZG9uZSI6IiIsImVkaXQiOiIiLCJ1bmRvIjoiIiwicmVkbyI6IiIsInJvb21EaWFsb2ciOiIiLCJjcmVhdGVOZXdSb29tIjoiIiwidG9nZ2xlRnVsbFNjcmVlbiI6IiIsInRvZ2dsZVplbk1vZGUiOiIiLCJleGl0WmVuTW9kZSI6IiJ9LCJhbGVydHMiOnsiY2xlYXJSZXNldCI6IiIsImNvdWxkTm90Q3JlYXRlU2hhcmVhYmxlTGluayI6IiIsImNvdWxkTm90TG9hZEludmFsaWRGaWxlIjoiIiwiaW1wb3J0QmFja2VuZEZhaWxlZCI6IiIsImNhbm5vdEV4cG9ydEVtcHR5Q2FudmFzIjoiIiwiY291bGROb3RDb3B5VG9DbGlwYm9hcmQiOiIiLCJkZWNyeXB0RmFpbGVkIjoiIiwidXBsb2FkZWRTZWN1cmx5IjoiIiwibG9hZFNjZW5lT3ZlcnJpZGVQcm9tcHQiOiIifSwidG9vbEJhciI6eyJzZWxlY3Rpb24iOiIiLCJkcmF3IjoiIiwicmVjdGFuZ2xlIjoiIiwiZGlhbW9uZCI6IiIsImVsbGlwc2UiOiIiLCJhcnJvdyI6IiIsImxpbmUiOiIiLCJ0ZXh0IjoiIiwibGlicmFyeSI6IiIsImxvY2siOiIifSwiaGVhZGluZ3MiOnsiY2FudmFzQWN0aW9ucyI6IiIsInNlbGVjdGVkU2hhcGVBY3Rpb25zIjoiIiwic2hhcGVzIjoiIn0sImhpbnRzIjp7ImxpbmVhckVsZW1lbnQiOiIiLCJmcmVlRHJhdyI6IiIsImxpbmVhckVsZW1lbnRNdWx0aSI6IiIsInJlc2l6ZSI6IiIsInJvdGF0ZSI6IiIsImxpbmVFZGl0b3JfaW5mbyI6IiIsImxpbmVFZGl0b3JfcG9pbnRTZWxlY3RlZCI6IiIsImxpbmVFZGl0b3Jfbm90aGluZ1NlbGVjdGVkIjoiIn0sImVycm9yU3BsYXNoIjp7ImhlYWRpbmdNYWluX3ByZSI6IiIsImhlYWRpbmdNYWluX2J1dHRvbiI6IiIsImNsZWFyQ2FudmFzTWVzc2FnZSI6IiIsImNsZWFyQ2FudmFzTWVzc2FnZV9idXR0b24iOiIiLCJjbGVhckNhbnZhc0NhdmVhdCI6IiIsInRyYWNrZWRUb1NlbnRyeV9wcmUiOiIiLCJ0cmFja2VkVG9TZW50cnlfcG9zdCI6IiIsIm9wZW5Jc3N1ZU1lc3NhZ2VfcHJlIjoiIiwib3Blbklzc3VlTWVzc2FnZV9idXR0b24iOiIiLCJvcGVuSXNzdWVNZXNzYWdlX3Bvc3QiOiIiLCJzY2VuZUNvbnRlbnQiOiIifSwicm9vbURpYWxvZyI6eyJkZXNjX2ludHJvIjoiIiwiZGVzY19wcml2YWN5IjoiIiwiYnV0dG9uX3N0YXJ0U2Vzc2lvbiI6IiIsImJ1dHRvbl9zdG9wU2Vzc2lvbiI6IiIsImRlc2NfaW5Qcm9ncmVzc0ludHJvIjoiIiwiZGVzY19wZXJzaXN0ZW5jZVdhcm5pbmciOiIiLCJkZXNjX3NoYXJlTGluayI6IiIsImRlc2NfZXhpdFNlc3Npb24iOiIifSwiZXJyb3JEaWFsb2ciOnsidGl0bGUiOiIifSwic2hvcnRjdXRzRGlhbG9nIjp7InRpdGxlIjoiIiwic2hhcGVzIjoiIiwib3IiOiIiLCJjbGljayI6IiIsImRyYWciOiIiLCJjdXJ2ZWRBcnJvdyI6IiIsImN1cnZlZExpbmUiOiIiLCJlZGl0b3IiOiIiLCJ2aWV3IjoiIiwiYmxvZyI6IiIsImhvd3RvIjoiIiwiZ2l0aHViIjoiIiwidGV4dE5ld0xpbmUiOiIiLCJ0ZXh0RmluaXNoIjoiIiwiem9vbVRvRml0IjoiIn0sImVuY3J5cHRlZCI6eyJ0b29sdGlwIjoiIn0sImNoYXJ0cyI6eyJub051bWVyaWNDb2x1bW4iOiIiLCJ0b29NYW55Q29sdW1ucyI6IiJ9fScpfSxmdW5jdGlvbihlKXtlLmV4cG9ydHM9SlNPTi5wYXJzZSgneyJsYWJlbHMiOnsicGFzdGUiOiJZYXDEscWfdMSxciIsInNlbGVjdEFsbCI6IlTDvG3DvG7DvCBzZcOnIiwibXVsdGlTZWxlY3QiOiJTZcOnaW1lIMO2xJ9lIGVrbGUiLCJtb3ZlQ2FudmFzIjoiVHV2YWxpIHRhxZ/EsSIsImNvcHkiOiJLb3B5YWxhIiwiY29weUFzUG5nIjoiUGFub3lhIFBORyBvbGFyYWsga29weWFsYSIsImNvcHlBc1N2ZyI6IlBhbm95YSBTVkcgb2xhcmFrIGtvcHlhbGEiLCJicmluZ0ZvcndhcmQiOiJCaXIgw7ZuZSBnZXRpciIsInNlbmRUb0JhY2siOiJBcmtheWEgZ8O2bmRlciIsImJyaW5nVG9Gcm9udCI6IkVuIMO2bmUgZ2V0aXIiLCJzZW5kQmFja3dhcmQiOiJCaXIgZ2VyaXllIGfDtm5kZXIiLCJkZWxldGUiOiJTaWwiLCJjb3B5U3R5bGVzIjoiU3RpbGxlcmkga29weWFsYSIsInBhc3RlU3R5bGVzIjoiU3RpbGxlcmkgeWFwxLHFn3TEsXIiLCJzdHJva2UiOiJWdXJndSIsImJhY2tncm91bmQiOiJBcmthIHBsYW4iLCJmaWxsIjoiRG9sZHVyIiwic3Ryb2tlV2lkdGgiOiJLb250dXIgZ2VuacWfbGnEn2kiLCJzdHJva2VTdHlsZSI6IktvbnR1ciBzdGlsaSIsInN0cm9rZVN0eWxlX3NvbGlkIjoiRG9sdSIsInN0cm9rZVN0eWxlX2Rhc2hlZCI6Iktlc2lrIMOnaXpnaWxpIiwic3Ryb2tlU3R5bGVfZG90dGVkIjoiTm9rdGFsxLEiLCJzbG9wcGluZXNzIjoiw5xzdMO8biBrw7Zyw7xsw7xrIiwib3BhY2l0eSI6Ik9wYWtsxLFrIiwidGV4dEFsaWduIjoiTWV0aW4gaGl6YWxhIiwiZm9udFNpemUiOiJZYXrEsSB0aXBpIGJveXV0dSIsImZvbnRGYW1pbHkiOiJZYXrEsSB0aXBpIGFpbGVzaSIsIm9ubHlTZWxlY3RlZCI6IlNhZGVjZSBzZcOnaWxlbiIsIndpdGhCYWNrZ3JvdW5kIjoiQXJrYSBQbGFuIMSwbGUgQmVyYWJlciIsImFkZFdhdGVybWFyayI6IlxcIkV4Y2FsaWRyYXcgaWxlIHlhcMSxbGTEsVxcIiB5YXrEsXPEsW7EsSBla2xlIiwiaGFuZERyYXduIjoiRWwteWF6xLFzxLEiLCJub3JtYWwiOiJOb3JtYWwiLCJjb2RlIjoiS29kIiwic21hbGwiOiJLw7zDp8O8ayIsIm1lZGl1bSI6Ik9ydGEiLCJsYXJnZSI6IkLDvHnDvGsiLCJ2ZXJ5TGFyZ2UiOiLDh29rIGdlbmnFnyIsInNvbGlkIjoiRG9sdSIsImhhY2h1cmUiOiJUYXJhbMSxIiwiY3Jvc3NIYXRjaCI6IsOHYXByYXotdGFyYWzEsSIsInRoaW4iOiLEsG5jZSIsImJvbGQiOiJLYWzEsW4iLCJsZWZ0IjoiU29sIiwiY2VudGVyIjoiT3J0YWxhIiwicmlnaHQiOiJTYcSfIiwiZXh0cmFCb2xkIjoiRWtzdHJhIGthbMSxbiIsImFyY2hpdGVjdCI6Ik1pbWFyIiwiYXJ0aXN0IjoiU2FuYXTDp8SxIiwiY2FydG9vbmlzdCI6IkthcmlrYXTDvHJpc3QiLCJmaWxlVGl0bGUiOiJEb3N5YSBiYcWfbMSxxJ/EsSIsImNvbG9yUGlja2VyIjoiUmVuayBzZcOnaWNpIiwiY2FudmFzQmFja2dyb3VuZCI6IlR1dmFsIGFya2EgcGxhbsSxIiwiZHJhd2luZ0NhbnZhcyI6IsOHaXppbSB0dXZhbGkiLCJsYXllcnMiOiJLYXRtYW5sYXIiLCJhY3Rpb25zIjoiRXlsZW1sZXIiLCJsYW5ndWFnZSI6IkRpbCIsImNyZWF0ZVJvb20iOiJPcnRhayDDp2FsxLHFn21hIG9ydGFtxLFuxLEgcGF5bGHFnyIsImR1cGxpY2F0ZVNlbGVjdGlvbiI6IsOHb8SfYWx0IiwidW50aXRsZWQiOiJCYcWfbMSxa3PEsXoiLCJuYW1lIjoixLBzaW0iLCJ5b3VyTmFtZSI6IsSwc21pbml6IiwibWFkZVdpdGhFeGNhbGlkcmF3IjoiRXhjYWxpZHJhdyBpbGUgeWFwxLFsZMSxIiwiZ3JvdXAiOiJTZcOnaW1pIGdydXAgeWFwIiwidW5ncm91cCI6IlNlw6dpbGVuIGdydWJ1IGRhxJ/EsXQiLCJjb2xsYWJvcmF0b3JzIjoiT3J0YWtsYXIiLCJ0b2dnbGVHcmlkTW9kZSI6Ikl6Z2FyYSBtb2R1bnUgYcOnIiwiYWRkVG9MaWJyYXJ5IjoiS8O8dMO8cGhhbmV5ZSBla2xlIiwicmVtb3ZlRnJvbUxpYnJhcnkiOiJLw7x0w7xwaGFuZWRlbiBrYWxkxLFyIiwibGlicmFyeUxvYWRpbmdNZXNzYWdlIjoiS8O8dMO8cGhhbmUgecO8a2xlbml5b3IuLi4ifSwiYnV0dG9ucyI6eyJjbGVhclJlc2V0IjoiVHV2YWxpIHPEsWbEsXJsYSIsImV4cG9ydCI6IkTEscWfYSBha3RhciIsImV4cG9ydFRvUG5nIjoiUE5HIG9sYXJhayBkxLHFn2EgYWt0YXIiLCJleHBvcnRUb1N2ZyI6IlNWRyBvbGFyYWsgZMSxxZ9hIGFrdGFyIiwiY29weVRvQ2xpcGJvYXJkIjoiUGFub3lhIGtvcHlhbGEiLCJjb3B5UG5nVG9DbGlwYm9hcmQiOiJQTkdcJ3lpIHBhbm95YSBrb3B5YWxhIiwic2F2ZSI6IktheWRldCIsInNhdmVBcyI6IkZhcmtsxLEga2F5ZGV0IiwibG9hZCI6IlnDvGtsZSIsImdldFNoYXJlYWJsZUxpbmsiOiJQYXlsYcWfxLFsYWJpbGlyIGJhxJ9sYW50xLEgYWwiLCJjbG9zZSI6IkthcGF0Iiwic2VsZWN0TGFuZ3VhZ2UiOiJEaWwgc2XDp2luIiwic2Nyb2xsQmFja1RvQ29udGVudCI6IsSww6dlcmnEn2UgZ2VyaSBkw7ZuIiwiem9vbUluIjoiWWFrxLFubGHFn3TEsXIiLCJ6b29tT3V0IjoiVXpha2xhxZ90xLFyIiwicmVzZXRab29tIjoiWWFrxLFubGHFn3TEsXJtYXnEsSBzxLFmxLFybGEiLCJtZW51IjoiTWVuw7wiLCJkb25lIjoiVGFtYW0iLCJlZGl0IjoiRMO8emVubGUiLCJ1bmRvIjoiR2VyaSBBbCIsInJlZG8iOiJZZW5pZGVuIHlhcCIsInJvb21EaWFsb2ciOiJPcnRhayDDp2FsxLHFn21hIG9ydGFtxLEgeWFyYXQiLCJjcmVhdGVOZXdSb29tIjoiWWVuaSBvZGEgb2x1xZ90dXIiLCJ0b2dnbGVGdWxsU2NyZWVuIjoiVGFtIGVrcmFuxLEgYcOnL2thcGEiLCJ0b2dnbGVaZW5Nb2RlIjoiWmVuIG1vZHVudSBhw6cva2FwYSIsImV4aXRaZW5Nb2RlIjoiWmVuIG1vZHVuZGFuIMOnxLFrIn0sImFsZXJ0cyI6eyJjbGVhclJlc2V0IjoiVHV2YWxpbiB0YW1hbcSxIHRlbWl6bGVuZWNlay4gRW1pbiBtaXNpbml6PyIsImNvdWxkTm90Q3JlYXRlU2hhcmVhYmxlTGluayI6IlBheWxhxZ/EsWxhYmlsaXIgYmHEn2xhbnTEsSBvbHXFn3R1cnVsYW1hZMSxLiIsImNvdWxkTm90TG9hZEludmFsaWRGaWxlIjoiQmlsaW5tZXllbiBkb3N5YSB5w7xrbGVuZW1peW9yIiwiaW1wb3J0QmFja2VuZEZhaWxlZCI6IlN1bnVjdWRhbiBpw6dlIGFrdGFybWEgYmHFn2FyxLFzxLF6LiIsImNhbm5vdEV4cG9ydEVtcHR5Q2FudmFzIjoiQm/FnyB0dXZhbCBkxLHFn2FyxLF5YSBha3RhcsSxbGFtYXouIiwiY291bGROb3RDb3B5VG9DbGlwYm9hcmQiOiJQYW5veWEga29weWFsYW5hbWFkxLEuIENocm9tZSB0YXJhecSxY8Sxc8SxbsSxIGRlbmV5aW5pei4iLCJkZWNyeXB0RmFpbGVkIjoixZ5pZnJlbGVubWnFnyB2ZXJpIMOnw7Z6w7xtbGVuZW1lZGkuIiwidXBsb2FkZWRTZWN1cmx5IjoiWcO8a2xlbWUgdcOndGFuIHVjYSDFn2lmcmVsZW1lIGlsZSBrb3J1bm1ha3RhZMSxci4gRXhjYWxpZHJhdyBzdW51Y3VzdSB2ZSDDvMOnw7xuY8O8bCDFn2FoxLFzbGFyIGnDp2VyacSfaSBva3V5YW1heWFjYWt0xLFyLiIsImxvYWRTY2VuZU92ZXJyaWRlUHJvbXB0IjoiSGFyaWNpIMOnaXppbWxlciB5w7xrbGVtZWsgbWV2Y3V0IG9sYW4gacOnZXJpxJ9pIGRlxJ9pxZ90aXJlY2VrdGlyLiBEZXZhbSBldG1layBpc3RpeW9yIG11c3VudXo/In0sInRvb2xCYXIiOnsic2VsZWN0aW9uIjoiU2XDp21lIiwiZHJhdyI6IlNlcmJlc3Qgw6dpemltIiwicmVjdGFuZ2xlIjoiRGlrZMO2cnRnZW4iLCJkaWFtb25kIjoiRWxtYXMiLCJlbGxpcHNlIjoiRWxpcHMiLCJhcnJvdyI6Ik9rIiwibGluZSI6IsOHaXpnaSIsInRleHQiOiJZYXrEsSIsImxpYnJhcnkiOiJLw7x0w7xwaGFuZSIsImxvY2siOiJTZcOnaWxlbiBhcmFjxLEgw6dpemltZGVuIHNvbnJhIGFrdGlmIHR1dCJ9LCJoZWFkaW5ncyI6eyJjYW52YXNBY3Rpb25zIjoiVHV2YWwgZXlsZW1sZXJpIiwic2VsZWN0ZWRTaGFwZUFjdGlvbnMiOiJTZcOnaWxlbiDFn2VraWwgYWtzaXlvbmxhcsSxIiwic2hhcGVzIjoixZ5la2lsbGVyIn0sImhpbnRzIjp7ImxpbmVhckVsZW1lbnQiOiJCaXJkZW4gZmF6bGEgbm9rdGEgacOnaW4gdMSxa2xhecSxbiwgdGVrIMOnaXpnaSBpw6dpbiBzw7xyw7xrbGV5aW4iLCJmcmVlRHJhdyI6IlTEsWtsYSB2ZSBzw7xyw7xrbGUsIGJpdGlyZGnEn2luZGUgc2VyYmVzdCBixLFyYWsiLCJsaW5lYXJFbGVtZW50TXVsdGkiOiJUYW1hbWxhbWFrIGnDp2luIHNvbiBub2t0YXnEsSBzZcOnaW4gdmV5YSBFc2NhcGUgdmUgRW50ZXJcJ2RhbiBiaXJpbmUgYmFzxLFuIiwicmVzaXplIjoiWWVuaWRlbiBib3l1dGxhbmTEsXLEsXJrZW4gU0hJRlRcJ2UgYmFzxLFsxLEgdHV0YXJhayBvcmFubGFyxLEga8Sxc8SxdGxheWFiaWxpcnNpbml6LCBtZXJrZXpkZW4geWVuaWRlbiBib3l1dGxhbmTEsXJtYWsgacOnaW4gQUxUXCdhIGJhc8SxbMSxIHR1dHVuIiwicm90YXRlIjoiRMO2bmTDvHLDvHJrZW4gU0hJRlQgdHXFn3VuYSBiYXPEsWzEsSB0dXRhcmFrIGHDp8SxbGFyxLEga29ydXlhYmlsaXJzaW5peiIsImxpbmVFZGl0b3JfaW5mbyI6Ik5va3RhbGFyxLEgZMO8emVubGVtZWsgacOnaW4gw6dpZnQtdMSxa2xhecSxbiB2ZXlhIEVudGVyXCdhIGJhc8SxbiIsImxpbmVFZGl0b3JfcG9pbnRTZWxlY3RlZCI6Ik5va3RhecSxIHNpbG1layBpw6dpbiBEZWxldGVcJ2UsIGtvcHlhbGFtYWsgacOnaW4gQ3RybFZleWFDbWQrRFwneWUsIHZleWEgaGFyZWtldCBldHRpcm1layBpw6dpbiBzw7xyw7xrbGV5aW4iLCJsaW5lRWRpdG9yX25vdGhpbmdTZWxlY3RlZCI6IkthbGTEsXJtYWsgdmV5YSBveW5hdG1hayBpw6dpbiBiaXIgbm9rdGEgc2XDpywgdmV5YSB5ZW5pIG5va3RhbGFyIGVrbGVtZWsgacOnaW4gQWx0XCdhIGJhc8SxbMSxIHR1dCJ9LCJlcnJvclNwbGFzaCI6eyJoZWFkaW5nTWFpbl9wcmUiOiJIYXRhIG9sdcWfdHUuIEzDvHRmZW4gIiwiaGVhZGluZ01haW5fYnV0dG9uIjoic2F5ZmF5xLEgeWVuaWxlbWV5aSBkZW5leWluLiIsImNsZWFyQ2FudmFzTWVzc2FnZSI6IlllbmlsZW1lIHNvbnJhc8SxIHNvcnVuIGRldmFtIGVkaXlvcnNhLCBsw7x0ZmVuICIsImNsZWFyQ2FudmFzTWVzc2FnZV9idXR0b24iOiLDp2l6aW0gYWxhbsSxbsSxIHRlbWl6bGVtZXlpIGRlbmV5aW4uIiwiY2xlYXJDYW52YXNDYXZlYXQiOiIgQnUsIHlhcHTEscSfxLFuxLF6IGRlxJ9pxZ9pa2xpa2xlcmkgc8SxZsSxcmxheWFjYWsgIiwidHJhY2tlZFRvU2VudHJ5X3ByZSI6IlRhbsSxbWxhecSxY8SxIGlsZSBpbGdpbGkgaGF0YSAiLCJ0cmFja2VkVG9TZW50cnlfcG9zdCI6IiBzaXN0ZW1pbWl6ZSB5YWthbGFuZMSxLiIsIm9wZW5Jc3N1ZU1lc3NhZ2VfcHJlIjoiIiwib3Blbklzc3VlTWVzc2FnZV9idXR0b24iOiJoYXRhIHRha2liaW5kZSBiaXIgeWFyZMSxbSBiaWxldGkgb2x1xZ90dXJ1bi4iLCJvcGVuSXNzdWVNZXNzYWdlX3Bvc3QiOiIgTMO8dGZlbiBhxZ9hxJ/EsXlhIEdpdGh1YiBzb3J1bnVuYSBrb3B5YWxheWFyYWsgdmUgeWFwxLHFn3TEsXJhcmFrIGJpbGdpIGVrbGV5aW4uIiwic2NlbmVDb250ZW50IjoiU2FobmUgacOnZXJpxJ9pOiJ9LCJyb29tRGlhbG9nIjp7ImRlc2NfaW50cm8iOiLDh2FsxLHFn21hIGFsYW7EsW7EsXphLCBzaXppbmxlIGJpcmxpa3RlIMOnYWzEscWfYWJpbG1lbGVyaSBpw6dpbiBiYcWfa2FsYXLEsW7EsSBkYSBla2xleWViaWxpcnNpbml6LiIsImRlc2NfcHJpdmFjeSI6IsOHYWzEscWfbWEgb3J0YW3EsW5kYSB5YXB0xLFrbGFyxLFuxLF6IHZlIMOnaXppbWxlcmluaXogdcOndGFuIHVjYSDFn2lmcmVsZW1leWxlIHNha2xhbm1ha3RhZMSxci4gU3VudWN1bGFyxLFtxLF6IGRhaGkgYnUgdmVyaWxlcmkgxZ9pZnJlbGVubWVtacWfIGhhbGl5bGUgZ8O2cmVtZXouIiwiYnV0dG9uX3N0YXJ0U2Vzc2lvbiI6Ik90dXJ1bXUgYmHFn2xhdCIsImJ1dHRvbl9zdG9wU2Vzc2lvbiI6Ik90dXJ1bXUgZHVyZHVyIiwiZGVzY19pblByb2dyZXNzSW50cm8iOiJPcnRhayDDp2FsxLHFn21hIG9ydGFtxLEgb2x1xZ90dXJ1bGR1LiIsImRlc2NfcGVyc2lzdGVuY2VXYXJuaW5nIjoiw4dhbMSxxZ9tYSBvcnRhbcSxbmRhIHlhcHTEsWtsYXLEsW7EsXogc2FkZWNlIG9ydGFtYSBrYXTEsWxtxLHFnyBkacSfZXIga2nFn2lsZXIgaWxlIHBheWxhxZ/EsWxtYWt0YWTEsXIuIEJ1bmRhbiBkb2xhecSxLCBoZXBpbml6aW4gYmHEn2xhbnTEsXPEsSBrZXNpbGlyc2UgdmUgYmlyIGRvc3lheWEgdmV5YSBwYXlsYcWfxLFsYWJpbGlyIGxpbmtcJ2UgZMSxxZ9hIGFrdGFybWFtxLHFn3NhbsSxeiB0w7xtIHZlcmlsZXJpbml6aSBrYXliZWRlYmlsaXJzaW5pei4iLCJkZXNjX3NoYXJlTGluayI6IkJ1IGJhxJ9sYW50xLF5xLEgYmlybGlrdGUgw6dhbMSxxZ9hY2HEn8SxbsSxeiBracWfaWxlcmxlIHBheWxhxZ9hYmlsaXJzaW5pejoiLCJkZXNjX2V4aXRTZXNzaW9uIjoiw4dhbMSxxZ9tYSBvcnRhbcSxbsSxIGthcGF0dMSxxJ/EsW7EsXpkYSBvcnRhayDDp2FsxLHFn21hZGFuIGF5csSxbG3EscWfIG9sdXJzdW51eiBhbmNhayBrZW5kaSB2ZXJzaXlvbnVudXpkYSDDp2FsxLHFn21heWEgZGV2YW0gZWRlYmlsaXJzaW5pei4gQnUgZHVydW1kYSBvcnRhayDDp2FsxLHFn3TEscSfxLFuxLF6IGRpxJ9lciBracWfaWxlciBldGtpbGVubWV5ZWNlaywgw6dhbMSxxZ9tYSBvcnRhbcSxbmRha2kgdmVyc2l5b24gw7x6ZXJpbmRlbiDDp2FsxLHFn21heWEgZGV2YW0gZWRlYmlsZWNla2xlci4ifSwiZXJyb3JEaWFsb2ciOnsidGl0bGUiOiJIYXRhIn0sInNob3J0Y3V0c0RpYWxvZyI6eyJ0aXRsZSI6IktsYXZ5ZSBrxLFzYXlvbGxhcsSxIiwic2hhcGVzIjoixZ5la2lsbGVyIiwib3IiOiJ2ZXlhIiwiY2xpY2siOiJ0xLFrbGEiLCJkcmFnIjoic8O8csO8a2xlIiwiY3VydmVkQXJyb3ciOiJFxJ9yaSBvayIsImN1cnZlZExpbmUiOiJFxJ9yaSDDp2l6Z2kiLCJlZGl0b3IiOiJEw7x6ZW5sZXlpY2kiLCJ2aWV3IjoiR8O2csO8bnTDvGxlIiwiYmxvZyI6IkJsb2dcJ3VtdXp1IG9rdXl1biIsImhvd3RvIjoiUmVoYmVyaW1pemkgdGFraXAgZWRpbiIsImdpdGh1YiI6IkJpciBoYXRhIG3EsSBidWxkdW4/IEJpbGRpciIsInRleHROZXdMaW5lIjoiWWVuaSBzYXTEsXIgZWtsZSAoeWF6xLEpIiwidGV4dEZpbmlzaCI6IihZYXrEsXnEsSkgZMO8emVubGVtZXlpIGJpdGlyIiwiem9vbVRvRml0IjoiVMO8bSDDtsSfZWxlcmkgc8SxxJ9kxLFybWFrIGnDp2luIHlha8SxbmxhxZ90xLFyIn0sImVuY3J5cHRlZCI6eyJ0b29sdGlwIjoiw4dpemltbGVyaW5peiBzb251bmEga2FkYXIgxZ9pZnJlbGVubWnFn3RpciwgRXhjYWxpZHJhd1wnxLFuIHN1bnVjdWxhcsSxIGJpbGUgb25sYXLEsSBnw7ZyZW1lei4ifSwiY2hhcnRzIjp7Im5vTnVtZXJpY0NvbHVtbiI6IlNhecSxc2FsIHPDvHR1bnUgb2xtYXlhbiBiaXIgdGFibG8geWFwxLHFn3TEsXJkxLFuLiIsInRvb01hbnlDb2x1bW5zIjoixLBraWRlbiBkYWhhIGZhemxhIHPDvHR1bmEgc2FoaXAgYmlyIHRhYmxvIHlhcMSxxZ90xLFyZMSxbi4ifX0nKX0sZnVuY3Rpb24oZSl7ZS5leHBvcnRzPUpTT04ucGFyc2UoJ3sibGFiZWxzIjp7InBhc3RlIjoi0JLRgdGC0LDQstC40YLQuCIsInNlbGVjdEFsbCI6ItCS0LjQsdGA0LDRgtC4INCy0YHQtSIsIm11bHRpU2VsZWN0Ijoi0JTQvtC00LDRgtC4INC10LvQtdC80LXQvdGCINC00L4g0LLQuNCx0YDQsNC90L7Qs9C+IiwibW92ZUNhbnZhcyI6ItCf0LXRgNC10LzRltGB0YLQuNGC0Lgg0L/QvtC70L7RgtC90L4iLCJjb3B5Ijoi0JrQvtC/0ZbRjtCy0LDRgtC4IiwiY29weUFzUG5nIjoi0JrQvtC/0ZbRjtCy0LDRgtC4INGP0LogUE5HIiwiY29weUFzU3ZnIjoi0JrQvtC/0ZbRjtCy0LDRgtC4INGP0LogU1ZHIiwiYnJpbmdGb3J3YXJkIjoi0J/QtdGA0LXQvNGW0YHRgtC40YLQuCDQstC/0LXRgNC10LQiLCJzZW5kVG9CYWNrIjoi0J3QsCDQt9Cw0LTQvdGW0Lkg0L/Qu9Cw0L0iLCJicmluZ1RvRnJvbnQiOiLQndCwINC/0LXRgNC10LTQvdGW0Lkg0L/Qu9Cw0L0iLCJzZW5kQmFja3dhcmQiOiLQn9C10YDQtdC80ZbRgdGC0LjRgtC4INC90LDQt9Cw0LQiLCJkZWxldGUiOiLQktC40LTQsNC70LjRgtC4IiwiY29weVN0eWxlcyI6ItCa0L7Qv9GW0Y7QstCw0YLQuCDRgdGC0LjQu9GWIiwicGFzdGVTdHlsZXMiOiLQktGB0YLQsNCy0LjRgtC4INGB0YLQuNC70ZYiLCJzdHJva2UiOiLQmtC+0L3RgtGD0YAiLCJiYWNrZ3JvdW5kIjoi0KLQu9C+IiwiZmlsbCI6ItCX0LDQv9C+0LLQvdC40YLQuCIsInN0cm9rZVdpZHRoIjoi0KLQvtCy0YnQuNC90LAg0LrQvtC90YLRg9GA0YMiLCJzdHJva2VTdHlsZSI6ItCh0YLQuNC70Ywg0LrQvtC90YLRg9GA0YMiLCJzdHJva2VTdHlsZV9zb2xpZCI6ItCh0YPRhtGW0LvRjNC90LjQuSIsInN0cm9rZVN0eWxlX2Rhc2hlZCI6ItCf0YPQvdC60YLQuNGAIiwic3Ryb2tlU3R5bGVfZG90dGVkIjoi0JrRgNCw0L/QutC4Iiwic2xvcHBpbmVzcyI6ItCe0YXQsNC50L3RltGB0YLRjCIsIm9wYWNpdHkiOiLQn9GA0L7Qt9C+0YDRltGB0YLRjCIsInRleHRBbGlnbiI6ItCS0LjRgNGW0LLQvdGO0LLQsNC90L3RjyDRgtC10LrRgdGC0YMiLCJmb250U2l6ZSI6ItCg0L7Qt9C80ZbRgCDRiNGA0LjRhNGC0YMiLCJmb250RmFtaWx5Ijoi0KjRgNC40YTRgiIsIm9ubHlTZWxlY3RlZCI6ItCi0ZbQu9GM0LrQuCDQstC40LHRgNCw0L3QtSIsIndpdGhCYWNrZ3JvdW5kIjoi0Jcg0YLQu9C+0LwiLCJhZGRXYXRlcm1hcmsiOiLQlNC+0LTQsNGC0LggwqvQndCw0LrRgNC10YHQu9C10L3QtSDQsiBFeGNhbGlkcmF3wrsiLCJoYW5kRHJhd24iOiLQoNGD0LrQvtC/0LjRgdC90LjQuSIsIm5vcm1hbCI6ItCX0LLQuNGH0LDQudC90LjQuSIsImNvZGUiOiLQmtC+0LQiLCJzbWFsbCI6ItCc0LDQu9C40LkiLCJtZWRpdW0iOiLQodC10YDQtdC00L3RltC5IiwibGFyZ2UiOiLQktC10LvQuNC60LjQuSIsInZlcnlMYXJnZSI6ItCU0YPQttC1INCy0LXQu9C40LrQuNC5Iiwic29saWQiOiLQodGD0YbRltC70YzQvdCwIiwiaGFjaHVyZSI6ItCo0YLRgNC40YXQvtCy0LrQsCIsImNyb3NzSGF0Y2giOiLQn9C10YDQtdGF0YDQtdGB0L3QsCDRiNGC0YDQuNGF0L7QstC60LAiLCJ0aGluIjoi0KLQvtC90LrQuNC5IiwiYm9sZCI6ItCW0LjRgNC90LjQuSIsImxlZnQiOiLQl9C70ZbQstCwIiwiY2VudGVyIjoi0J/QviDRhtC10L3RgtGA0YMiLCJyaWdodCI6ItCh0L/RgNCw0LLQsCIsImV4dHJhQm9sZCI6ItCi0L7QstGB0YLQuNC5IiwiYXJjaGl0ZWN0Ijoi0JDRgNGF0ZbRgtC10LrRgtC+0YAiLCJhcnRpc3QiOiLQpdGD0LTQvtC20L3QuNC6IiwiY2FydG9vbmlzdCI6ItCa0LDRgNC40LrQsNGC0YPRgNC40YHRgiIsImZpbGVUaXRsZSI6ItCd0LDQt9Cy0LAg0YTQsNC50LvQsCIsImNvbG9yUGlja2VyIjoi0J/QsNC70ZbRgtGA0LAg0LrQvtC70YzQvtGA0ZbQsiIsImNhbnZhc0JhY2tncm91bmQiOiLQotC70L4g0L/QvtC70L7RgtC90LAiLCJkcmF3aW5nQ2FudmFzIjoi0J/QvtC70L7RgtC90L4iLCJsYXllcnMiOiLQqNCw0YDQuCIsImFjdGlvbnMiOiLQlNGW0ZciLCJsYW5ndWFnZSI6ItCc0L7QstCwIiwiY3JlYXRlUm9vbSI6ItCf0L7QtNGW0LvQuNGC0LjRgdGPINGB0LXRgdGW0ZTRjiDQtNC70Y8g0YHQv9GW0LvRjNC90L7RlyDRgNC+0LHQvtGC0LgiLCJkdXBsaWNhdGVTZWxlY3Rpb24iOiLQlNGD0LHQu9GO0LLQsNGC0LgiLCJ1bnRpdGxlZCI6ItCR0LXQty3QvdCw0LfQstC4IiwibmFtZSI6ItCG0LzigJnRjyIsInlvdXJOYW1lIjoi0JLQsNGI0LUg0ZbQvOKAmdGPIiwibWFkZVdpdGhFeGNhbGlkcmF3Ijoi0J3QsNC60YDQtdGB0LvQtdC90LUg0LIgRXhjYWxpZHJhdyIsImdyb3VwIjoi0JPRgNGD0L/Rg9Cy0LDRgtC4INCy0LjQtNGW0LvQtdC90LUiLCJ1bmdyb3VwIjoi0KDQvtC30LPRgNGD0L/Rg9Cy0LDRgtC4INCy0LjQtNGW0LvQtdC90LUiLCJjb2xsYWJvcmF0b3JzIjoi0KHQv9GW0LLQsNCy0YLQvtGA0LgiLCJ0b2dnbGVHcmlkTW9kZSI6ItCg0LXQttC40Lwg0YHRltGC0LrQuCIsImFkZFRvTGlicmFyeSI6ItCU0L7QtNCw0YLQuCDQtNC+INCx0ZbQsdC70ZbQvtGC0LXQutC4IiwicmVtb3ZlRnJvbUxpYnJhcnkiOiLQktC40LTQsNC70LjRgtC4INC3INCx0ZbQsdC70ZbQvtGC0LXQutC4IiwibGlicmFyeUxvYWRpbmdNZXNzYWdlIjoi0JfQsNCy0LDQvdGC0LDQttC40YLQuCDQsdGW0LHQu9GW0L7RgtC10LrRgy4uLiJ9LCJidXR0b25zIjp7ImNsZWFyUmVzZXQiOiLQntGH0LjRgdGC0LjRgtC4INC/0L7Qu9C+0YLQvdC+IiwiZXhwb3J0Ijoi0JXQutGB0L/QvtGA0YLRg9Cy0LDRgtC4IiwiZXhwb3J0VG9QbmciOiLQldC60YHQv9C+0YDRgtGD0LLQsNGC0Lgg0LIgUE5HIiwiZXhwb3J0VG9TdmciOiLQldC60YHQv9C+0YDRgtGD0LLQsNGC0Lgg0LIgU1ZHIiwiY29weVRvQ2xpcGJvYXJkIjoi0KHQutC+0L/RltGO0LLQsNGC0Lgg0LTQviDQsdGD0YTQtdGA0YMg0L7QsdC80ZbQvdGDIiwiY29weVBuZ1RvQ2xpcGJvYXJkIjoi0KHQutC+0L/RltGO0LLQsNGC0LggUE5HINC00L4g0LHRg9GE0LXRgNGDINC+0LHQvNGW0L3RgyIsInNhdmUiOiLQl9Cx0LXRgNC10LPRgtC4Iiwic2F2ZUFzIjoi0JfQsdC10YDQtdCz0YLQuCDRj9C6IiwibG9hZCI6ItCX0LDQstCw0L3RgtCw0LbQuNGC0LgiLCJnZXRTaGFyZWFibGVMaW5rIjoi0J7RgtGA0LjQvNCw0YLQuCDQv9C+0YHQuNC70LDQvdC90Y8iLCJjbG9zZSI6ItCX0LDQutGA0LjRgtC4Iiwic2VsZWN0TGFuZ3VhZ2UiOiLQntCx0YDQsNGC0Lgg0LzQvtCy0YMiLCJzY3JvbGxCYWNrVG9Db250ZW50Ijoi0J/QvtCy0LXRgNC90YPRgtC40YHRjyDQtNC+INCy0LzRltGB0YLRgyIsInpvb21JbiI6ItCX0LHRltC70YzRiNC40YLQuCIsInpvb21PdXQiOiLQl9C80LXQvdGI0LjRgtC4IiwicmVzZXRab29tIjoi0KHQutC40L3Rg9GC0Lgg0LzQsNGB0YjRgtCw0LEiLCJtZW51Ijoi0JzQtdC90Y4iLCJkb25lIjoi0JPQvtGC0L7QstC+IiwiZWRpdCI6ItCg0LXQtNCw0LPRg9Cy0LDRgtC4IiwidW5kbyI6ItCS0ZbQtNC80ZbQvdC40YLQuCIsInJlZG8iOiLQn9C+0LLRgtC+0YDQuNGC0LgiLCJyb29tRGlhbG9nIjoi0JLRltC00LrRgNC40YLQuCDRgdC10YHRltGOINGB0L/RltC70YzQvdC+0Zcg0YDQvtCx0L7RgtC4IiwiY3JlYXRlTmV3Um9vbSI6ItCh0YLQstC+0YDQuNGC0Lgg0L3QvtCy0YMg0LrRltC80L3QsNGC0YMiLCJ0b2dnbGVGdWxsU2NyZWVuIjoi0J/QvtCy0L3QvtC10LrRgNCw0L3QvdC40Lkg0YDQtdC20LjQvCIsInRvZ2dsZVplbk1vZGUiOiLQlNC30LXQvS3RgNC10LbQuNC8IiwiZXhpdFplbk1vZGUiOiLQktC40LnRgtC4INC3INC00LfQtdC9LdGA0LXQttC40LzRgyJ9LCJhbGVydHMiOnsiY2xlYXJSZXNldCI6ItCm0LUg0L7Rh9C40YHRgtC40YLRjCDQstGB0LUg0L/QvtC70L7RgtC90L4uINCS0L/QtdCy0L3QtdC90ZY/IiwiY291bGROb3RDcmVhdGVTaGFyZWFibGVMaW5rIjoi0J3QtSDQstC00LDQu9C+0YHRjyDRgdGC0LLQvtGA0LjRgtC4INC/0L7RgdC40LvQsNC90L3Rjy4iLCJjb3VsZE5vdExvYWRJbnZhbGlkRmlsZSI6ItCk0LDQudC7INC3INC/0L7QvNC40LvQutCw0LzQuCDQvdC1INCy0ZbQtNC60YDQuNCy0YHRjyIsImltcG9ydEJhY2tlbmRGYWlsZWQiOiLQhtC80L/QvtGA0YLRg9Cy0LDQvdC90Y8g0L3QtdCy0LTQsNC70LUuIiwiY2Fubm90RXhwb3J0RW1wdHlDYW52YXMiOiLQndC1INCy0LjQudGI0LvQviDQtdC60YHQv9C+0YDRgtGD0LLQsNGC0Lgg0L/Rg9GB0YLQtSDQv9C+0LvQvtGC0L3Qvi4iLCJjb3VsZE5vdENvcHlUb0NsaXBib2FyZCI6ItCd0LUg0LrQvtC/0ZbRjtGU0YLRjNGB0Y8g0LTQviDQsdGD0YTQtdGA0YMg0L7QsdC80ZbQvdGDLiDQodC/0YDQvtCx0YPQudGC0LUg0LIg0LHRgNCw0YPQt9C10YDRliBDaHJvbWUuIiwiZGVjcnlwdEZhaWxlZCI6ItCd0LUg0LLQtNCw0LvQvtGB0Y8g0YDQvtC30YjQuNGE0YDRg9Cy0LDRgtC4INC00LDQvdGWLiIsInVwbG9hZGVkU2VjdXJseSI6ItCm0LUg0LfQsNCy0LDQvdGC0LDQttC10L3QvdGPINCx0YPQu9C+INC30LDRhdC40YnQtdC90LUg0L3QsNGB0LrRgNGW0LfQvdC40Lwg0YjQuNGE0YDRg9Cy0LDQvdC90Y/QvCwg0LAg0YbQtSDQvtC30L3QsNGH0LDRlCDRidC+INGB0LXRgNCy0LXRgCBFeGNhbGlkcmF3INGC0LAg0ZbQvdGI0ZYg0L3QtSDQt9C80L7QttGD0YLRjCDQv9GA0L7Rh9C40YLQsNGC0Lgg0LLQvNGW0YHRgi4iLCJsb2FkU2NlbmVPdmVycmlkZVByb21wdCI6ItCX0LDQstCw0L3RgtCw0LbQtdC90L3RjyDQt9C+0LLQvdGW0YjQvdGM0L7Qs9C+INC60YDQtdGB0LvQtdC90L3RjyDQt9Cw0LzRltC90LjRgtGMINCy0LDRiCDQvdCw0Y/QstC90LjQuSDQutC+0L3RgtC10L3Rgi4g0J/RgNC+0LTQvtCy0LbQuNGC0Lg/In0sInRvb2xCYXIiOnsic2VsZWN0aW9uIjoi0JLQuNC00ZbQu9C10L3QvdGPIiwiZHJhdyI6ItCS0ZbQu9GM0L3QtSDQutGA0LXRgdC70LXQvdC90Y8iLCJyZWN0YW5nbGUiOiLQn9GA0Y/QvNC+0LrRg9GC0L3QuNC6IiwiZGlhbW9uZCI6ItCg0L7QvNCxIiwiZWxsaXBzZSI6ItCV0LvRltC/0YEiLCJhcnJvdyI6ItCh0YLRgNGW0LvQutCwIiwibGluZSI6ItCb0ZbQvdGW0Y8iLCJ0ZXh0Ijoi0KLQtdC60YHRgiIsImxpYnJhcnkiOiLQkdGW0LHQu9GW0L7RgtC10LrQsCIsImxvY2siOiLQl9Cw0LvQuNGI0LjRgtC4INC+0LHRgNCw0L3QuNC5INGW0L3RgdGC0YDRg9C80LXQvdGCINC/0ZbRgdC70Y8g0LrRgNC10YHQu9C10L3QvdGPIn0sImhlYWRpbmdzIjp7ImNhbnZhc0FjdGlvbnMiOiLQlNGW0Zcg0Lcg0L/QvtC70L7RgtC90L7QvCIsInNlbGVjdGVkU2hhcGVBY3Rpb25zIjoi0JLQuNCx0YDQsNC90ZYg0LTRltGXINC3INGE0ZbQs9GD0YDQvtGOIiwic2hhcGVzIjoi0KTRltCz0YPRgNC4In0sImhpbnRzIjp7ImxpbmVhckVsZW1lbnQiOiLQndCw0YLQuNGB0L3RltGC0Ywg0YnQvtCxINC00L7QtNCw0YLQuCDQutGW0LvRjNC60LAg0YLQvtGH0L7Quiwg0L/QtdGA0LXRgtGP0LPQvdGW0YLRjCDRidC+0LEg0L3QsNC80LDQu9GO0LLQsNGC0Lgg0L7QtNC90YMg0LvRltC90ZbRjiIsImZyZWVEcmF3Ijoi0J3QsNGC0LjRgdC90ZbRgtGMINGWINC/0L7RgtGP0LPQvdGW0YLRjCwg0LLRltC00L/Rg9GB0YLRltGC0Ywg0LrQvtC70Lgg0LfQsNCy0LXRgNGI0LjRgtC1IiwibGluZWFyRWxlbWVudE11bHRpIjoi0J3QsNGC0LjRgdC90ZbRgtGMINC90LAg0L7RgdGC0LDQvdC90Y4g0YLQvtGH0LrRgywg0LrQu9Cw0YbQvdGW0YLRjCBFc2Mg0LDQsdC+IEVudGVyINGJ0L7QsSDQt9Cw0LLQtdGA0YjQuNGC0LgiLCJyZXNpemUiOiLQktC4INC80L7QttC10YLQtSDQt9Cx0LXRgNC10LPRgtC4INC/0YDQvtC/0L7RgNGG0ZbRlywg0YPRgtGA0LjQvNGD0Y7Rh9C4IFNISUZUINC/0ZbQtCDRh9Cw0YEg0LfQvNGW0L3QuCDRgNC+0LfQvNGW0YDRgyxcXG7Rg9GC0YDQuNC80YPQudGC0LUgQUxUINC00LvRjyDQt9C80ZbQvdC10L3QvdGPINGA0L7Qt9C80ZbRgNGDINCy0ZbQtCDRhtC10L3RgtGA0YMiLCJyb3RhdGUiOiLQktC4INC80L7QttC10YLQtSDQvtCx0LzQtdC20LjRgtC4INC60YPRgtC4LCDRg9GC0YDQuNC80YPRjtGH0LggU0hJRlQg0L/RltC0INGH0LDRgSDQvtCx0LXRgNGC0LDQvdC90Y8iLCJsaW5lRWRpdG9yX2luZm8iOiLQlNCy0ZbRh9GWINC60LvQsNGG0L3RltGC0Ywg0LDQsdC+INC90LDRgtC40YHQvdGW0YLRjCBFbnRlciDRidC+0LEg0YDQtdC00LDQs9GD0LLQsNGC0Lgg0YLQvtGH0LrQuCIsImxpbmVFZGl0b3JfcG9pbnRTZWxlY3RlZCI6ItCd0LDRgtC40YHQvdGW0YLRjCDQktC40LTQsNC70LjRgtC4LCDRidC+0LEg0LLQuNC00LDQu9C40YLQuCDRgtC+0YfQutGDLCBDdHJsT3JDbWQrRCDQtNC70Y8g0LTRg9Cx0LvRjtCy0LDQvdC90Y8sINCw0LHQviDQv9C10YDQtdGC0Y/Qs9C90ZbRgtGMLCDRidC+0LEg0L/QtdGA0LXQvNGW0YHRgtC40YLQuNGB0Y8iLCJsaW5lRWRpdG9yX25vdGhpbmdTZWxlY3RlZCI6ItCS0LjQsdC10YDRltGC0Ywg0YLQvtGH0LrRgyDQtNC70Y8g0L/QtdGA0LXQvNGW0YnQtdC90L3RjyDRh9C4INCy0LjQtNCw0LvQtdC90L3Rjywg0LDQsdC+INGD0YLRgNC40LzRg9C50YLQtSBBbHQg0ZYg0L3QsNGC0LjRgdC90ZbRgtGMLCDRidC+0LEg0LTQvtC00LDRgtC4INC90L7QstGWINGC0L7Rh9C60LgifSwiZXJyb3JTcGxhc2giOnsiaGVhZGluZ01haW5fcHJlIjoi0KHRgtCw0LvQsNGB0Y8g0L/QvtC80LjQu9C60LAuINCh0L/RgNC+0LHRg9C50YLQtSAiLCJoZWFkaW5nTWFpbl9idXR0b24iOiLQv9C10YDQtdC30LDQstCw0L3RgtCw0LbQuNGC0Lgg0YHRgtC+0YDRltC90LrRgy4iLCJjbGVhckNhbnZhc01lc3NhZ2UiOiLQr9C60YnQviDQv9C10YDQtdC30LDQstCw0L3RgtCw0LbQtdC90L3RjyDQvdC1INC00L7Qv9C+0LzQvtC20LUsINGB0L/RgNC+0LHRg9C50YLQtSAiLCJjbGVhckNhbnZhc01lc3NhZ2VfYnV0dG9uIjoi0L7Rh9C40YHRgtC40YLQuCDQv9C+0LvQvtGC0L3Qvi4iLCJjbGVhckNhbnZhc0NhdmVhdCI6IiDQptC1INC/0YDQuNC30LLQtdC00LUg0LTQviDQstGC0YDQsNGC0Lgg0YDQvtCx0L7RgtC4ICIsInRyYWNrZWRUb1NlbnRyeV9wcmUiOiLQn9C+0LzQuNC70LrQsCDQtyDRltC00LXQvdGC0LjRhNGW0LrQsNGC0L7RgNC+0LwgIiwidHJhY2tlZFRvU2VudHJ5X3Bvc3QiOiIg0LHRg9C70L4g0LLRltC00YHQu9GW0LTQutC+0LLQsNC90L4g0LIg0L3QsNGI0ZbQuSDRgdC40YHRgtC10LzRli4iLCJvcGVuSXNzdWVNZXNzYWdlX3ByZSI6ItCc0Lgg0LHRg9C70Lgg0LTRg9C20LUg0L7QsdC10YDQtdC20L3Rliwg0YnQvtCxINC90LUg0LLQutC70Y7Rh9Cw0YLQuCDRltC90YTQvtGA0LzQsNGG0ZbRjiDQv9GA0L4g0LLQsNGI0ZYg0YHRhtC10L3QuCDQsiDRgtC10LrRgdGCINC/0L7QvNC40LvQutC4LiDQr9C60YnQviDQstCw0YjQsCDRgdGG0LXQvdCwINC90LUg0LHRg9C70LAg0L/RgNC40LLQsNGC0L3QsCwg0LHRg9C00Ywg0LvQsNGB0LrQsCwg0YDQvtC30LPQu9GP0L3RjNGC0LUg0LzQvtC20LvQuNCy0ZbRgdGC0Ywg0L/RgNC+0LTQvtCy0LbQtdC90L3RjyDQvdCwINC90LDRiNC+0LzRgyAiLCJvcGVuSXNzdWVNZXNzYWdlX2J1dHRvbiI6ItGC0YDQtdC60LXRgCDQv9C+0LzQuNC70L7Qui4iLCJvcGVuSXNzdWVNZXNzYWdlX3Bvc3QiOiIg0JHRg9C00Ywg0LvQsNGB0LrQsCwg0LTQvtC00LDQudGC0LUg0ZbQvdGE0L7RgNC80LDRhtGW0Y4g0L3QuNC20YfQtSwg0YHQutC+0L/RltGO0Y7Rh9C4INGWINCy0YHRgtCw0LLQu9GP0Y7Rh9C4INGDIEdpdEh1YiBpc3N1ZS4iLCJzY2VuZUNvbnRlbnQiOiLQktC80ZbRgdGCINGB0YbQtdC90Lg6In0sInJvb21EaWFsb2ciOnsiZGVzY19pbnRybyI6ItCS0Lgg0LzQvtC20LXRgtC1INC30LDQv9GA0L7RgdC40YLQuCDQu9GO0LTQtdC5INC90LAg0LLQsNGI0YMg0L/QvtGC0L7Rh9C90YMg0YHRhtC10L3RgyDQtNC70Y8g0YHQv9GW0LLQv9GA0LDRhtGWINC3INCy0LDQvNC4LiIsImRlc2NfcHJpdmFjeSI6ItCd0LUg0YXQstC40LvRjtC50YLQtdGB0Y8sINGB0LXRgdGW0Y8g0LfQsNGF0LjRidC10L3QsCDQvdCw0YHQutGA0ZbQt9C90LjQvCDRiNC40YTRgNGD0LLQsNC90L3Rj9C8LCDRgtC+0LzRgyDQstCw0YjQtSDQutGA0LXRgdC70LXQvdC90Y8g0LfQsNC70LjRiNC40YLRjNGB0Y8g0L/RgNC40LLQsNGC0L3QuNC8LiDQndCw0LLRltGC0Ywg0L3QsNGIINGB0LXRgNCy0LXRgCDQvdC1INC/0L7QsdCw0YfQuNGC0Ywg0LLQsNGI0YMg0LzQsNC30LDQvdC40L3Rgy4iLCJidXR0b25fc3RhcnRTZXNzaW9uIjoi0J/QvtGH0LDRgtC4INGB0LXRgdGW0Y4iLCJidXR0b25fc3RvcFNlc3Npb24iOiLQl9Cw0LrRgNC40YLQuCDRgdC10YHRltGOIiwiZGVzY19pblByb2dyZXNzSW50cm8iOiLQodC10YHRltGPINGB0L/RltC70YzQvdC+0Zcg0YDQvtCx0L7RgtC4INC90LDQtCDQutGA0LXRgdC70LXQvdC90Y/QvCDRgtGA0LjQstCw0ZQuIiwiZGVzY19wZXJzaXN0ZW5jZVdhcm5pbmciOiLQl9Cw0YPQstCw0LbRgtC1LCDRidC+INC60YDQtdGB0LvQtdC90L3RjyDQv9C+0YjQuNGA0Y7RjtGC0YzRgdGPINGB0LXRgNC10LQg0YHQv9GW0LLQsNCy0YLQvtGA0ZbQsiDQvNC10YLQvtC00L7QvCBQMlAsINGWINC90LUg0LfQsdC10YDRltCz0LDRjtGC0YzRgdGPINC90LAg0L3QsNGI0L7QvNGDINGB0LXRgNCy0LXRgNGWLiDQr9C6INGC0ZbQu9GM0LrQuCDQstC4INCy0ZbQtOKAmdGU0LTQvdCw0ZTRgtC10YHRjywg0LLQuCDQstGC0YDQsNGC0LjRgtC1INCy0LDRiNGWINC00LDQvdGWLCDRhdGW0LHQsCDRidC+INC/0LXRgNC10LQg0LLQuNGF0L7QtNC+0Lwg0LLQuCDQtdC60YHQv9C+0YDRgtGD0ZTRgtC1INGE0LDQudC7LCDQsNCx0L4g0LfRgNC+0LHQuNGC0LUg0L/QvtGB0LjQu9Cw0L3QvdGPLiIsImRlc2Nfc2hhcmVMaW5rIjoi0J/QvtC00ZbQu9GW0YLRjNGB0Y8g0YbQuNC8INC/0L7RgdC40LvQsNC90L3Rj9C8INC3INCx0YPQtNGMLdC60LjQvCDQtNC70Y8g0YHQv9GW0LvRjNC90L7RlyDRgNC+0LHQvtGC0Lg6IiwiZGVzY19leGl0U2Vzc2lvbiI6ItCX0YPQv9C40L3QutCwINGB0LXRgdGW0Zcg0LLRltC00LrQu9GO0YfQuNGC0Ywg0LLQsNGBINCy0ZbQtCDQutGW0LzQvdCw0YLQuCwg0LDQu9C1INCy0Lgg0LfQvNC+0LbQtdGC0LUg0L/RgNC+0LTQvtCy0LbQuNGC0Lgg0YDQvtCx0L7RgtGDINC3INC/0L7Qu9C+0YLQvdC+0Lwg0LvQvtC60LDQu9GM0L3Qvi4g0JfQstC10YDQvdGW0YLRjCDRg9Cy0LDQs9GDLCDRidC+INGG0LUg0L3QtSDQstC/0LvQuNC90LUg0L3QsCDRltC90YjQuNGFINC70Y7QtNC10LksINGWINCy0L7QvdC4INCy0YHQtSDQvtC00L3QviDQt9C80L7QttGD0YLRjCDQv9GA0LDRhtGO0LLQsNGC0Lgg0L3QsNC0INGX0YUg0LLQtdGA0YHRltGU0Y4uIn0sImVycm9yRGlhbG9nIjp7InRpdGxlIjoi0J/QvtC80LjQu9C60LAifSwic2hvcnRjdXRzRGlhbG9nIjp7InRpdGxlIjoi0JPQsNGA0Y/Rh9GWINC60LvQsNCy0ZbRiNGWIiwic2hhcGVzIjoi0KTRltCz0YPRgNC4Iiwib3IiOiLQsNCx0L4iLCJjbGljayI6ItC90LDRgtC40YHQvdGD0YLQuCIsImRyYWciOiLQv9C10YDQtdGC0Y/Qs9C90YPRgtC4IiwiY3VydmVkQXJyb3ciOiLQktC40LPQvdGD0YLQsCDRgdGC0YDRltC70LrQsCIsImN1cnZlZExpbmUiOiLQktC40LPQvdGD0YLQsCDQu9GW0L3RltGPIiwiZWRpdG9yIjoi0KDQtdC00LDQutGC0L7RgCIsInZpZXciOiLQktC40LPQu9GP0LQiLCJibG9nIjoi0KfQuNGC0LDQudGC0LUg0L3QsNGIINCx0LvQvtCzIiwiaG93dG8iOiLQlNC+0YLRgNC40LzRg9C50YLQtdGB0Ywg0L3QsNGI0LjRhSDRltC90YHRgtGA0YPQutGG0ZbQuSIsImdpdGh1YiI6ItCX0L3QsNC50YjQu9C4INC/0L7QvNC40LvQutGDPyDQn9C+0LLRltC00L7QvNGC0LUhIiwidGV4dE5ld0xpbmUiOiLQlNC+0LTQsNGC0Lgg0L3QvtCy0LjQuSDRgNGP0LTQvtC6ICjRgtC10LrRgdGCKSIsInRleHRGaW5pc2giOiLQl9Cw0LLQtdGA0YjQuNGC0Lgg0YDQtdC00LDQs9GD0LLQsNC90L3RjyAo0YLQtdC60YHRgikiLCJ6b29tVG9GaXQiOiLQl9Cx0ZbQu9GM0YjQuNGC0Lgg0YnQvtCxINGD0LzRltGB0YLQuNGC0Lgg0LLRgdC1In0sImVuY3J5cHRlZCI6eyJ0b29sdGlwIjoi0JLQsNGI0ZYg0LrRgNC10YHQu9C10L3QvdGPINC30LDRhdC40YnQtdC90ZYg0L3QsNGB0LrRgNGW0LfQvdC40Lwg0YjQuNGE0YDRg9Cy0LDQvdC90Y/QvCDigJQg0YHQtdGA0LLQtdGA0LggRXhjYWxpZHJhdyDQvdGW0LrQvtC70Lgg0ZfRhSDQvdC1INC/0L7QsdCw0YfQsNGC0YwuIn0sImNoYXJ0cyI6eyJub051bWVyaWNDb2x1bW4iOiLQktC4INCy0YHRgtCw0LLQuNC70Lgg0YLQsNCx0LvQuNGG0Y4g0LHQtdC3INGH0LjRgdC70L7QstC+0Zcg0LrQvtC70L7QvdC60LguIiwidG9vTWFueUNvbHVtbnMiOiLQktC4INCy0YHRgtCw0LLQu9GP0LvQuCDRgtCw0LHQu9C40YbRjiDQtyDQsdGW0LvRjNGIINC90ZbQtiDQtNCy0L7QvNCwINC60L7Qu9C+0L3QutCw0LzQuC4ifX0nKX0sZnVuY3Rpb24oZSl7ZS5leHBvcnRzPUpTT04ucGFyc2UoJ3sibGFiZWxzIjp7InBhc3RlIjoi57KY6LS0Iiwic2VsZWN0QWxsIjoi6YCJ5oup5omA5pyJIiwibXVsdGlTZWxlY3QiOiLlsIblhYPntKDmt7vliqDoh7PpgInljLoiLCJtb3ZlQ2FudmFzIjoi56e75Yqo55S75biDIiwiY29weSI6IuWkjeWItiIsImNvcHlBc1BuZyI6IuWkjeWItuS4uiBQTkcg5Yiw5Ymq6LS05p2/IiwiY29weUFzU3ZnIjoi5aSN5Yi25Li6IFNWRyDliLDliarotLTmnb8iLCJicmluZ0ZvcndhcmQiOiLkuIrnp7vkuIDlsYIiLCJzZW5kVG9CYWNrIjoi572u5LqO5bqV5bGCIiwiYnJpbmdUb0Zyb250Ijoi572u5LqO6aG25bGCIiwic2VuZEJhY2t3YXJkIjoi5LiL56e75LiA5bGCIiwiZGVsZXRlIjoi5Yig6ZmkIiwiY29weVN0eWxlcyI6IuWkjeWItuagt+W8jyIsInBhc3RlU3R5bGVzIjoi57KY6LS05qC35byPIiwic3Ryb2tlIjoi5o+P6L65IiwiYmFja2dyb3VuZCI6IuiDjOaZryIsImZpbGwiOiLloavlhYUiLCJzdHJva2VXaWR0aCI6IuaPj+i+ueWuveW6piIsInN0cm9rZVN0eWxlIjoi5o+P6L65ICjmoLflvI8pIiwic3Ryb2tlU3R5bGVfc29saWQiOiLlrp7nur8iLCJzdHJva2VTdHlsZV9kYXNoZWQiOiLomZrnur8iLCJzdHJva2VTdHlsZV9kb3R0ZWQiOiLngrnomZrnur8iLCJzbG9wcGluZXNzIjoi6L655qGGIiwib3BhY2l0eSI6IumAj+aYjuW6piIsInRleHRBbGlnbiI6IuaWh+acrOWvuem9kCIsImZvbnRTaXplIjoi5a2X5L2T5aSn5bCPIiwiZm9udEZhbWlseSI6IuWtl+S9kyIsIm9ubHlTZWxlY3RlZCI6IuS7heiiq+mAieS4rSIsIndpdGhCYWNrZ3JvdW5kIjoi5re75Yqg6IOM5pmvIiwiYWRkV2F0ZXJtYXJrIjoi5re75Yqg4oCc5L2/55SoIEV4Y2FsaWRyYXcg5Yib5bu64oCdIiwiaGFuZERyYXduIjoi5omL5YaZIiwibm9ybWFsIjoi5q2j5bi4IiwiY29kZSI6IuS7o+eggSIsInNtYWxsIjoi5bCP5Y+3IiwibWVkaXVtIjoi5Lit562JIiwibGFyZ2UiOiLlpKflj7ciLCJ2ZXJ5TGFyZ2UiOiLmnoHlpKciLCJzb2xpZCI6IuWunuW/gyIsImhhY2h1cmUiOiLnur/mnaEiLCJjcm9zc0hhdGNoIjoi5Lqk5Y+J57q/5p2hIiwidGhpbiI6Iue7hiIsImJvbGQiOiLliqDnspciLCJsZWZ0Ijoi5bem5a+56b2QIiwiY2VudGVyIjoi5bGF5LitIiwicmlnaHQiOiLlj7Plr7npvZAiLCJleHRyYUJvbGQiOiLotoXnspciLCJhcmNoaXRlY3QiOiLmnLTntKAiLCJhcnRpc3QiOiLoibrmnK8iLCJjYXJ0b29uaXN0Ijoi5ryr55S75biIIiwiZmlsZVRpdGxlIjoi5paH5Lu25qCH6aKYIiwiY29sb3JQaWNrZXIiOiLosIPoibLnm5giLCJjYW52YXNCYWNrZ3JvdW5kIjoiQ2FudmFzIOiDjOaZryIsImRyYXdpbmdDYW52YXMiOiLnu5jliLYgQ2FudmFzIiwibGF5ZXJzIjoi5Zu+5bGCIiwiYWN0aW9ucyI6IuaTjeS9nCIsImxhbmd1YWdlIjoi6K+t6KiAIiwiY3JlYXRlUm9vbSI6IuWIhuS6q+WunuaXtuWNj+S9nOS8muiuriIsImR1cGxpY2F0ZVNlbGVjdGlvbiI6IuWkjeWItuaJgOacieW3sumAieaLqeeahOWFg+e0oCIsInVudGl0bGVkIjoi5peg5qCH6aKYIiwibmFtZSI6IuWQjeWtlyIsInlvdXJOYW1lIjoi5oKo55qE5aeT5ZCNIiwibWFkZVdpdGhFeGNhbGlkcmF3Ijoi5L2/55SoIEV4Y2FsaWRyYXcg5Yib5bu6IiwiZ3JvdXAiOiLnu4TpgIkiLCJ1bmdyb3VwIjoi5Y+W5raI57uE6YCJIiwiY29sbGFib3JhdG9ycyI6IuWNj+S9nOiAhSIsInRvZ2dsZUdyaWRNb2RlIjoi5YiH5o2i572R5qC85qih5byPIiwiYWRkVG9MaWJyYXJ5Ijoi5re75Yqg5Yiw5bqT5LitIiwicmVtb3ZlRnJvbUxpYnJhcnkiOiLku47lupPkuK3np7vpmaQiLCJsaWJyYXJ5TG9hZGluZ01lc3NhZ2UiOiLmraPlnKjliqDovb3lupMuLi4ifSwiYnV0dG9ucyI6eyJjbGVhclJlc2V0Ijoi6YeN572u55S75biDIiwiZXhwb3J0Ijoi5a+85Ye6IiwiZXhwb3J0VG9QbmciOiLlr7zlh7rkuLogUE5HIiwiZXhwb3J0VG9TdmciOiLlr7zlh7rkuLogU1ZHIiwiY29weVRvQ2xpcGJvYXJkIjoi5aSN5Yi25Yiw5Ymq6LS05p2/IiwiY29weVBuZ1RvQ2xpcGJvYXJkIjoi5aSN5Yi2IFBORyDliLDliarliIfmnb8iLCJzYXZlIjoi5L+d5a2YIiwic2F2ZUFzIjoi5L+d5a2Y5Li6IiwibG9hZCI6Iui9veWFpeaWh+S7tiIsImdldFNoYXJlYWJsZUxpbmsiOiLojrflj5blhbHkuqvpk77mjqUiLCJjbG9zZSI6IuWFs+mXrSIsInNlbGVjdExhbmd1YWdlIjoi6YCJ5oup6K+t6KiAIiwic2Nyb2xsQmFja1RvQ29udGVudCI6Iua7muWKqOWbnuWIsOWGheWuuSIsInpvb21JbiI6IuaUvuWkpyIsInpvb21PdXQiOiLnvKnlsI8iLCJyZXNldFpvb20iOiLph43nva7nvKnmlL4iLCJtZW51Ijoi6I+c5Y2VIiwiZG9uZSI6IuWujOaIkCIsImVkaXQiOiLnvJbovpEiLCJ1bmRvIjoi5pKk6ZSAIiwicmVkbyI6IumHjeWBmiIsInJvb21EaWFsb2ciOiLlvIDlp4vlrp7ml7bljY/kvZwiLCJjcmVhdGVOZXdSb29tIjoi5paw5bu65Lya6K6u5a6kIiwidG9nZ2xlRnVsbFNjcmVlbiI6IuWIh+aNouWFqOWxj+aYvuekuiIsInRvZ2dsZVplbk1vZGUiOiLliIfmjaLnpoXmqKHlvI8iLCJleGl0WmVuTW9kZSI6IumAgOWHuuemheaooeW8jyJ9LCJhbGVydHMiOnsiY2xlYXJSZXNldCI6Iui/meWwhuS8mua4hemZpOaVtOS4qiDnlLvmnb/jgILmgqjmmK/lkKbopoHnu6fnu60/IiwiY291bGROb3RDcmVhdGVTaGFyZWFibGVMaW5rIjoi5peg5rOV5Yib5bu65YWx5Lqr6ZO+5o6lIiwiY291bGROb3RMb2FkSW52YWxpZEZpbGUiOiLml6Dms5XliqDovb3plJnor6/mlofku7YiLCJpbXBvcnRCYWNrZW5kRmFpbGVkIjoi5LuO5ZCO56uv5a+85YWl5aSx6LSlIiwiY2Fubm90RXhwb3J0RW1wdHlDYW52YXMiOiLml6Dms5Xlr7zlh7rnqbrnlLvluIPjgIIiLCJjb3VsZE5vdENvcHlUb0NsaXBib2FyZCI6IuaXoOazleWkjeWItuWIsOWJqui0tOadv+OAguivt+WwneivleS9v+eUqCBDaHJvbWUg5rWP6KeI5Zmo44CCIiwiZGVjcnlwdEZhaWxlZCI6IuaXoOazleino+WvhuaVsOaNruOAgiIsInVwbG9hZGVkU2VjdXJseSI6IuS4iuS8oOW3suiiq+err+WIsOerr+WKoOWvhuS/neaKpO+8jOi/meaEj+WRs+edgEV4Y2FsaWRyYXcg55qE5pyN5Yqh5Zmo5ZKM56ys5LiJ5pa56YO95peg5rOV6K+75Y+W5YaF5a6544CCIiwibG9hZFNjZW5lT3ZlcnJpZGVQcm9tcHQiOiLliqDovb3lpJbpg6jnu5jlm77lsIblj5bku6PmgqjnjrDmnInnmoTlhoXlrrnjgILmgqjmg7PopoHnu6fnu63lkJfvvJ8ifSwidG9vbEJhciI6eyJzZWxlY3Rpb24iOiLpgInmi6kiLCJkcmF3Ijoi6Ieq55Sx5Lmm5YaZIiwicmVjdGFuZ2xlIjoi55+p5b2iIiwiZGlhbW9uZCI6IuiPseW9oiIsImVsbGlwc2UiOiLmpK3lnIYiLCJhcnJvdyI6IueureWktCIsImxpbmUiOiLnur/mnaEiLCJ0ZXh0Ijoi5paH5a2XIiwibGlicmFyeSI6IuW6kyIsImxvY2siOiLnu5jliLblkI7kv53mjIHmiYDpgInnmoTlt6XlhbfmoI/nirbmgIEifSwiaGVhZGluZ3MiOnsiY2FudmFzQWN0aW9ucyI6IueUu+W4g+WKqOS9nCIsInNlbGVjdGVkU2hhcGVBY3Rpb25zIjoi6YCJ5a6a5b2i54q25pON5L2cIiwic2hhcGVzIjoi5b2i54q2In0sImhpbnRzIjp7ImxpbmVhckVsZW1lbnQiOiLngrnlh7vliJvlu7rlpJrkuKrngrkg5ouW5Yqo5Yib5bu655u057q/IiwiZnJlZURyYXciOiLngrnlh7vlubbmi5bliqjvvIzlrozmiJDlkI7lj5HluIMiLCJsaW5lYXJFbGVtZW50TXVsdGkiOiLngrnlh7vmnIDlkI7kuIDkuKrngrnmiJbmjInkuIsgRXNjL0VudGVyIOadpeWujOaIkCIsInJlc2l6ZSI6IuaCqOWPr+S7peaMieS9j1NISUZU5p2l6ZmQ5Yi25q+U5L6L5aSn5bCP77yMXFxu5oyJ5L2PQUxU5p2l6LCD5pW05Lit5b+D5aSn5bCPIiwicm90YXRlIjoi5peL6L2s5pe25Y+v5Lul5oyJ5L2PIFNoaWZ0IOadpee6puadn+inkuW6piIsImxpbmVFZGl0b3JfaW5mbyI6IuWPjOWHu+aIluaMieWbnui9pumUrue8lui+kSIsImxpbmVFZGl0b3JfcG9pbnRTZWxlY3RlZCI6IuaMieS4iyBEZWxldGUg56e76Zmk54K577yMQ3RybOaIlkNtZCtEIOS7peWkjeWItu+8jOaIluaLluWKqOS7peenu+WKqCIsImxpbmVFZGl0b3Jfbm90aGluZ1NlbGVjdGVkIjoi6YCJ5Lit6KaB56e75Yqo5oiW56e76Zmk55qE54K577yM5oiW5oyJ5L2PQWx05bm254K55Ye75re75Yqg5paw54K5In0sImVycm9yU3BsYXNoIjp7ImhlYWRpbmdNYWluX3ByZSI6IumBh+WIsOW8guW4uOOAguivt+WwneivlSAiLCJoZWFkaW5nTWFpbl9idXR0b24iOiLph43mlrDliqDovb3pobXpnaLjgIIiLCJjbGVhckNhbnZhc01lc3NhZ2UiOiLlpoLmnpzph43mlrDliqDovb3pobXpnaLml6DmlYgsIOivt+WwneivlSAiLCJjbGVhckNhbnZhc01lc3NhZ2VfYnV0dG9uIjoi5riF6Zmk55S75biD44CCIiwiY2xlYXJDYW52YXNDYXZlYXQiOiIg6L+Z5Lya6YCg5oiQ5b2T5YmN5bel5L2c5Lii5aSxICIsInRyYWNrZWRUb1NlbnRyeV9wcmUiOiLluKbmnInmoIfor4bnrKbnmoTplJnor68gIiwidHJhY2tlZFRvU2VudHJ5X3Bvc3QiOiIg5bey5Zyo5oiR5Lus55qE57O757uf5Lit6Lef6LiqIiwib3Blbklzc3VlTWVzc2FnZV9wcmUiOiLmiJHku6zpnZ7luLjosKjmhY7lnLDkuI3lsIbmgqjnmoTlnLrmma/kv6Hmga/ljIXlkKvlnKjplJnor6/kv6Hmga/kuK3jgILlpoLmnpzmgqjnmoTlnLrmma/kuI3mmK/np4Hlr4bnmoTvvIzor7fogIPomZHot5/ov5vmiJHku6znmoQgIiwib3Blbklzc3VlTWVzc2FnZV9idXR0b24iOiLplJnor6/ov73ouKrlmajjgIIiLCJvcGVuSXNzdWVNZXNzYWdlX3Bvc3QiOiIg6K+35aSN5Yi25bm257KY6LS05Lul5LiL5L+h5oGv5YiwIEdpdEh1YiBJc3N1ZSDkuK3jgIIiLCJzY2VuZUNvbnRlbnQiOiLnlLvluIMg5YaF5a65OiJ9LCJyb29tRGlhbG9nIjp7ImRlc2NfaW50cm8iOiLkvaDlj6/ku6XpgoDor7flhbbku5bkurrliLDnm67liY3nmoTnlLvpnaLkuK3kuI7kvaDljY/kvZzjgIIiLCJkZXNjX3ByaXZhY3kiOiLliKvmi4Xlv4MsIOivpeS8muivneS9v+eUqOerr+WIsOerr+WKoOWvhiwg5peg6K6657uY5Yi25LuA5LmI6YO95bCG5L+d5oyB56eB5a+G77yM55Sa6Iez6L+e5oiR5Lus55qE5pyN5Yqh5Zmo5Lmf5peg5rOV5p+l55yL44CCIiwiYnV0dG9uX3N0YXJ0U2Vzc2lvbiI6IuWQr+WKqOS8muiuriIsImJ1dHRvbl9zdG9wU2Vzc2lvbiI6Iue7k+adn+S8muiuriIsImRlc2NfaW5Qcm9ncmVzc0ludHJvIjoi5a6e5pe25Y2P5L2c5Lya6K6u5q2j5Zyo6L+b6KGM44CCIiwiZGVzY19wZXJzaXN0ZW5jZVdhcm5pbmciOiLor7fms6jmhI/vvIzlnLrmma/mlbDmja7mmK/ku6VQMlDmlrnlvI/lnKjlkIjkvZzogIXkuYvpl7TlhbHkuqvnmoTvvIzkuI3kvJrmjIHnu63liLDmiJHku6znmoTmnI3liqHlmajjgIIg5Zug5q2k77yM5aaC5p6c5oKo6YO95pat5byA5LqG6L+e5o6l77yM5oKo5bCG5Lya5Lii5aSx5pWw5o2u77yM6Zmk6Z2e5oKo5bCG5YW25a+85Ye65Yiw5LiA5Liq5paH5Lu25oiW5LiA5Liq5Y+v5YWx5Lqr55qE6ZO+5o6l44CCIiwiZGVzY19zaGFyZUxpbmsiOiLliIbkuqvmraTpk77mjqXnu5nkvaDopoHljY/kvZznmoTnlKjmiLciLCJkZXNjX2V4aXRTZXNzaW9uIjoi5YGc5q2i5Lya6K+d5bCG5Lit5pat5oKo5Zyo5LiO5oi/6Ze055qE6L+e5o6l77yM5L2G5oKo5L6d54S25Y+v5Lul5Zyo5pys5Zyw57un57ut5L2/55So55S75biDLiDor7fms6jmhI/vvIzov5nkuI3kvJrlvbHlk43liLDlhbbku5bnlKjmiLcsIOS7luS7rOS7jeWPr+S7peWcqOS7luS7rOeahOeJiOacrOS4iue7p+e7reWNj+S9nOOAgiJ9LCJlcnJvckRpYWxvZyI6eyJ0aXRsZSI6IumUmeivryJ9LCJzaG9ydGN1dHNEaWFsb2ciOnsidGl0bGUiOiLlv6vmjbfplK7liJfooagiLCJzaGFwZXMiOiLlvaLnirYiLCJvciI6IuaIluiAhSIsImNsaWNrIjoi54K55Ye7IiwiZHJhZyI6IuaLluWKqCIsImN1cnZlZEFycm93Ijoi5puy57q/77yI5bim5pyJ566t5aS077yJIiwiY3VydmVkTGluZSI6Iuabsue6v++8iOaXoOeureWktO+8iSIsImVkaXRvciI6Iue8lui+keWZqCIsInZpZXciOiLop4blm74iLCJibG9nIjoi5rWP6KeI5oiR5Lus55qE5Y2a5a6iIiwiaG93dG8iOiLot5/pmo/miJHku6znmoTmjIfljZciLCJnaXRodWIiOiLlj5HnjrDpl67popjvvJ/mj5DkuqQiLCJ0ZXh0TmV3TGluZSI6IuaWh+acrOaNouihjCIsInRleHRGaW5pc2giOiLlrozmiJDnvJbovpHmlofmnKwiLCJ6b29tVG9GaXQiOiLnvKnmlL7ku6XpgILlupTmiYDmnInlhYPntKAifSwiZW5jcnlwdGVkIjp7InRvb2x0aXAiOiLmgqjnmoTnu5jlm77ph4fnlKjnmoTnq6/liLDnq6/liqDlr4bvvIzlm6DmraRFeGNhbGlkcmF35pyN5Yqh5Zmo5rC46L+c5LiN5Lya5pS26ZuG44CCIn0sImNoYXJ0cyI6eyJub051bWVyaWNDb2x1bW4iOiLmgqjnspjotLTkuobkuIDkuKrmsqHmnInmlbDlrZfliJfnmoTooajmoLzjgIIiLCJ0b29NYW55Q29sdW1ucyI6IuaCqOeymOi0tOS6huS4pOWIl+S7peS4iueahOihqOagvOOAgiJ9fScpfSxmdW5jdGlvbihlKXtlLmV4cG9ydHM9SlNPTi5wYXJzZSgneyJsYWJlbHMiOnsicGFzdGUiOiLosrzkuIoiLCJzZWxlY3RBbGwiOiLlhajpgbgiLCJtdWx0aVNlbGVjdCI6IuWwh+eJqeS7tuWKoOWFpemBuOWPluevhOWcjSIsIm1vdmVDYW52YXMiOiLnp7vli5XnlavluIMiLCJjb3B5Ijoi6KSH6KO9IiwiY29weUFzUG5nIjoi6KSH6KO9IFBORyDoh7PliarosrznsL8iLCJjb3B5QXNTdmciOiLopIfoo70gU1ZHIOiHs+WJquiyvOewvyIsImJyaW5nRm9yd2FyZCI6IuW+gOWJjeenu+S4gOWxpCIsInNlbmRUb0JhY2siOiLnp7vliLDmnIDlvozpnaIiLCJicmluZ1RvRnJvbnQiOiLnp7vliLDmnIDliY3pnaIiLCJzZW5kQmFja3dhcmQiOiLlvoDlvoznp7vkuIDlsaQiLCJkZWxldGUiOiLliKrpmaQiLCJjb3B5U3R5bGVzIjoi6KSH6KO95qij5byPIiwicGFzdGVTdHlsZXMiOiLosrzkuIrmqKPlvI8iLCJzdHJva2UiOiLnrYbnlasiLCJiYWNrZ3JvdW5kIjoi6IOM5pmvIiwiZmlsbCI6IuWhq+WFhSIsInN0cm9rZVdpZHRoIjoi562G5YqD5a+s5bqmIiwic3Ryb2tlU3R5bGUiOiLnrYbnlavmqKPlvI8iLCJzdHJva2VTdHlsZV9zb2xpZCI6IuWvpue3miIsInN0cm9rZVN0eWxlX2Rhc2hlZCI6IuiZm+e3miIsInN0cm9rZVN0eWxlX2RvdHRlZCI6Ium7nue3miIsInNsb3BwaW5lc3MiOiLnt5rmop3poqjmoLwiLCJvcGFjaXR5Ijoi6YCP5piO5bqmIiwidGV4dEFsaWduIjoi5paH5a2X5bCN6b2KIiwiZm9udFNpemUiOiLlrZflnovlpKflsI8iLCJmb250RmFtaWx5Ijoi5a2X6auUIiwib25seVNlbGVjdGVkIjoi5YOF6YG45Y+W54mp5Lu2Iiwid2l0aEJhY2tncm91bmQiOiLljIXlkKvog4zmma8iLCJhZGRXYXRlcm1hcmsiOiLliqDkuIogXFwiTWFkZSB3aXRoIEV4Y2FsaWRyYXdcXCIiLCJoYW5kRHJhd24iOiLmiYvlr6siLCJub3JtYWwiOiLkuIDoiKwiLCJjb2RlIjoi562J5a+sIiwic21hbGwiOiLlsI8iLCJtZWRpdW0iOiLkuK0iLCJsYXJnZSI6IuWkpyIsInZlcnlMYXJnZSI6IueJueWkpyIsInNvbGlkIjoi5a+m5b+DIiwiaGFjaHVyZSI6IuaWnOe3muethuinuCIsImNyb3NzSGF0Y2giOiLkuqTlj4nnrYbop7giLCJ0aGluIjoi57SwIiwiYm9sZCI6IueylyIsImxlZnQiOiLlt6blgbQiLCJjZW50ZXIiOiLnva7kuK0iLCJyaWdodCI6IuWPs+WBtCIsImV4dHJhQm9sZCI6IualteeylyIsImFyY2hpdGVjdCI6IueyvueiuiIsImFydGlzdCI6IuiXneihkyIsImNhcnRvb25pc3QiOiLljaHpgJoiLCJmaWxlVGl0bGUiOiLmqpTmoYjlkI3nqLEiLCJjb2xvclBpY2tlciI6IuiJsuW9qemBuOaTh+W3peWFtyIsImNhbnZhc0JhY2tncm91bmQiOiJDYW52YXMg6IOM5pmvIiwiZHJhd2luZ0NhbnZhcyI6Iue5quWcliBjYW52YXMiLCJsYXllcnMiOiLlnJblsaQiLCJhY3Rpb25zIjoi5YuV5L2cIiwibGFuZ3VhZ2UiOiLoqp7oqIAiLCJjcmVhdGVSb29tIjoi5bu656uL5paw5Y2U5L2c5pyD6K2w5a6kIiwiZHVwbGljYXRlU2VsZWN0aW9uIjoi6KSH6KO9IiwidW50aXRsZWQiOiLnhKHmqJnpoYwiLCJuYW1lIjoi5ZCN56ixIiwieW91ck5hbWUiOiLkvaDnmoTlkI3nqLEiLCJtYWRlV2l0aEV4Y2FsaWRyYXciOiLku6UgRXhjYWxpZHJhdyDoo73kvZwiLCJncm91cCI6IuW7uueri+e+pOe1hCIsInVuZ3JvdXAiOiLlj5bmtojnvqTntYQiLCJjb2xsYWJvcmF0b3JzIjoi5Y2U5L2c6ICFIiwidG9nZ2xlR3JpZE1vZGUiOiLliIfmj5vmoLznt5rmqKHlvI8iLCJhZGRUb0xpYnJhcnkiOiLliqDlhaXos4fmlpnluqsiLCJyZW1vdmVGcm9tTGlicmFyeSI6IuW+nuizh+aWmeW6q+S4reenu+mZpCIsImxpYnJhcnlMb2FkaW5nTWVzc2FnZSI6Iuizh+aWmeW6q+iugOWPluS4reKApiJ9LCJidXR0b25zIjp7ImNsZWFyUmVzZXQiOiLph43nva4gY2FudmFzIiwiZXhwb3J0Ijoi6Ly45Ye6IiwiZXhwb3J0VG9QbmciOiLovLjlh7rmiJAgUE5HIiwiZXhwb3J0VG9TdmciOiLovLjlh7rmiJAgU1ZHIiwiY29weVRvQ2xpcGJvYXJkIjoi6KSH6KO96Iez5Ymq6LK857C/IiwiY29weVBuZ1RvQ2xpcGJvYXJkIjoi6KSH6KO9IFBORyDoh7PliarosrznsL8iLCJzYXZlIjoi5YSy5a2YIiwic2F2ZUFzIjoi5YSy5a2Y54K6IiwibG9hZCI6Iui8ieWFpSIsImdldFNoYXJlYWJsZUxpbmsiOiLlj5blvpflhbHkuqvpgKPntZAiLCJjbG9zZSI6IumXnOmWiSIsInNlbGVjdExhbmd1YWdlIjoi6YG45pOH6Kqe6KiAIiwic2Nyb2xsQmFja1RvQ29udGVudCI6IuaNsuWLleWbnuWIsOWFp+WuuSIsInpvb21JbiI6IuaUvuWkpyIsInpvb21PdXQiOiLnuK7lsI8iLCJyZXNldFpvb20iOiLph43oqK3nuK7mlL4iLCJtZW51Ijoi6YG45ZauIiwiZG9uZSI6IuWujOaIkCIsImVkaXQiOiLnt6jovK8iLCJ1bmRvIjoi5b6p5Y6fIiwicmVkbyI6IumHjeWBmiIsInJvb21EaWFsb2ciOiLplovlp4vljbPmmYLljZTkvZwiLCJjcmVhdGVOZXdSb29tIjoi5bu656uL5paw5Y2U5L2c5pyD6K2w5a6kIiwidG9nZ2xlRnVsbFNjcmVlbiI6IuWIh+aPm+WFqOieouW5lSIsInRvZ2dsZVplbk1vZGUiOiLliIfmj5vlsIjms6jmqKHlvI8iLCJleGl0WmVuTW9kZSI6IumboumWi+WwiOazqOaooeW8jyJ9LCJhbGVydHMiOnsiY2xlYXJSZXNldCI6IumAmeWwh+acg+a4hemZpOaVtOWAiyBjYW52YXPjgILkvaDnorrlrprll47vvJ8iLCJjb3VsZE5vdENyZWF0ZVNoYXJlYWJsZUxpbmsiOiLnhKHms5Xlu7rnq4vlhbHkuqvpgKPntZDjgIIiLCJjb3VsZE5vdExvYWRJbnZhbGlkRmlsZSI6IueEoeazleiugOWPluWkseaViOeahOaqlOahiOOAgiIsImltcG9ydEJhY2tlbmRGYWlsZWQiOiLlvoznq6/oroDlj5blpLHmlZfjgIIiLCJjYW5ub3RFeHBvcnRFbXB0eUNhbnZhcyI6IueEoeazlei8uOWHuuepuueZveeahCBjYW52YXPjgIIiLCJjb3VsZE5vdENvcHlUb0NsaXBib2FyZCI6IueEoeazleikh+ijveiHs+WJquiyvOewv+OAguiri+S9v+eUqCBDaHJvbWUg54CP6Ka95Zmo5YaN6Kmm6Kmm55yL44CCIiwiZGVjcnlwdEZhaWxlZCI6IueEoeazleino+Wvhuizh+aWmeOAgiIsInVwbG9hZGVkU2VjdXJseSI6IuS4iuWCs+W3sumAmumBjiBlbmQtdG8tZW5kIOWKoOWvhu+8jEV4Y2FsaWRyYXcg5Ly65pyN5Zmo5ZKM56ys5LiJ5pa554Sh5rOV55qG6K6A5Y+W5YW25YWn5a6544CCIiwibG9hZFNjZW5lT3ZlcnJpZGVQcm9tcHQiOiLoroDlj5blpJbpg6jlnJbmqKPlsIflj5bku6Pnm67liY3nmoTlhaflrrnjgILmmK/lkKbopoHnubznuozvvJ8ifSwidG9vbEJhciI6eyJzZWxlY3Rpb24iOiLpgbjlj5YiLCJkcmF3Ijoi57mq5ZyWIiwicmVjdGFuZ2xlIjoi6ZW35pa55b2iIiwiZGlhbW9uZCI6IuiPseW9oiIsImVsbGlwc2UiOiLmqaLlnJMiLCJhcnJvdyI6IueuremgrSIsImxpbmUiOiLnt5rmop0iLCJ0ZXh0Ijoi5paH5a2XIiwibGlicmFyeSI6Iuizh+aWmeW6qyIsImxvY2siOiLlj6/pgKPnuozkvb/nlKjpgbjlj5bnmoTlt6XlhbcifSwiaGVhZGluZ3MiOnsiY2FudmFzQWN0aW9ucyI6ImNhbnZhcyDli5XkvZwiLCJzZWxlY3RlZFNoYXBlQWN0aW9ucyI6IumBuOWPluWcluW9ouWLleS9nCIsInNoYXBlcyI6IuW9oueLgCJ9LCJoaW50cyI6eyJsaW5lYXJFbGVtZW50Ijoi6bue5pOK5Lul57mq6KO95aSa6bue5puy57ea77yb5oiW5ouW5puz5Lul57mq6KO955u057eaIiwiZnJlZURyYXciOiLpu57mk4rkuKbmi5bmm7PkvobnuarlnJbvvIzmlL7plovljbPntZDmnZ8iLCJsaW5lYXJFbGVtZW50TXVsdGkiOiLmjInkuIsgRXNjYXBlIOaIliBFbnRlciDku6XntZDmnZ/nuaroo70iLCJyZXNpemUiOiLnuK7mlL7mmYLmjInkvY8gU2hpZnQg5Y+v5L+d5oyB5Y6f5q+U5L6L57iu5pS+77ybXFxcXG7mjInkvY8gQWx0IOWPr+eUseS4reW/g+m7numAsuihjOe4ruaUviIsInJvdGF0ZSI6IuaXi+i9ieaZguaMieS9jyBTaGlmdCDlj6/pmZDliLbml4vovYnop5LluqYiLCJsaW5lRWRpdG9yX2luZm8iOiLpm5nmk4rmu5HpvKDlt6bpjbXmiJbmjIkgRW50ZXIg5L6G57eo6Lyv5o6n5Yi26bueIiwibGluZUVkaXRvcl9wb2ludFNlbGVjdGVkIjoi5oyJ5LiLIERlbGV0ZSDlj6/np7vpmaTpjKjpu57vvJtDdHJsIOaIliBDbWQgKyBEIOWPr+ikh+ijve+8m+aIluWPr+aLluabs+S+huenu+WLlSIsImxpbmVFZGl0b3Jfbm90aGluZ1NlbGVjdGVkIjoi6bue6YG45oOz56e75YuV5oiW5Yiq6Zmk55qE5o6n5Yi26bue77yb5oiW5oyJ5L2PIEFsdCDlho3pu57mk4rku6Xlop7liqDmlrDmjqfliLbpu54ifSwiZXJyb3JTcGxhc2giOnsiaGVhZGluZ01haW5fcHJlIjoi55m855Sf6Yyv6Kqk77yM5ZiX6KmmIiwiaGVhZGluZ01haW5fYnV0dG9uIjoi6YeN5paw6LyJ5YWl6aCB6Z2i44CCIiwiY2xlYXJDYW52YXNNZXNzYWdlIjoi6Iul6YeN5paw6LyJ5YWl5LuN54Sh5rOV6Kej5rG65ZWP6aGM77yM5ZiX6KmmIiwiY2xlYXJDYW52YXNNZXNzYWdlX2J1dHRvbiI6Iua4hemZpCBjYW52YXPjgIIiLCJjbGVhckNhbnZhc0NhdmVhdCI6IuatpOWLleS9nOWwh+mAoOaIkOebruWJjeeahOS9nOWTgeiiq+enu+mZpOOAgiIsInRyYWNrZWRUb1NlbnRyeV9wcmUiOiLmraTpjK/oqqToiIflhbborZjliKXnorwiLCJ0cmFja2VkVG9TZW50cnlfcG9zdCI6IuWwh+eUseezu+e1seiomOmMhOOAgiIsIm9wZW5Jc3N1ZU1lc3NhZ2VfcHJlIjoi5oiR5YCR5bCH6Ky55oWO6JmV55CG77yM5L2g55qE5L2c5ZOB5YWn5a655LiN5pyD6KKr5YyF5ZCr5Zyo6Yyv6Kqk5aCx5ZGK5Lit44CC6Iul5L2g55qE5L2c5ZOB5LiN6ZyA5L+d5oyB56eB5a+G77yM6KuL6ICD5oWu5L2/55So5oiR5YCR55qEIiwib3Blbklzc3VlTWVzc2FnZV9idXR0b24iOiJidWcgdHJhY2tlcuOAgiIsIm9wZW5Jc3N1ZU1lc3NhZ2VfcG9zdCI6Iuiri+Wwh+S4i+WIl+izh+ioiuikh+ijveiyvOS4iuiHsyBHaXRIdWIgaXNzdWUg5Lit44CCIiwic2NlbmVDb250ZW50Ijoi5L2c5ZOB5YWn5a6577yaIn0sInJvb21EaWFsb2ciOnsiZGVzY19pbnRybyI6IuS9oOWPr+S7pemCgOiri+WFtuS7luS6uuS4gOi1t+WNlOS9nOebruWJjeeahOS9nOWTgeOAgiIsImRlc2NfcHJpdmFjeSI6IumAo+e3muS9v+eUqCBlbmQtdG8tZW5kIOWKoOWvhuaVheeEoemgiOaTlOW/g+S9nOWTgeeahOWuieWFqOaAp+OAguWNs+S9v+aYr+aIkeWAkeeahOS8uuacjeWZqOS5n+eEoeazleWPluW+l+WFtuWFp+WuueOAgiIsImJ1dHRvbl9zdGFydFNlc3Npb24iOiLplovlp4vpgKPnt5oiLCJidXR0b25fc3RvcFNlc3Npb24iOiLlgZzmraLpgKPnt5oiLCJkZXNjX2luUHJvZ3Jlc3NJbnRybyI6IuWNs+aZguWNlOS9nOmAo+e3muato+WcqOmAsuihjOS4reOAgiIsImRlc2NfcGVyc2lzdGVuY2VXYXJuaW5nIjoi6KuL5rOo5oSP5q2k5L2c5ZOB55qE6LOH5paZ5piv5LulIFAyUCDnmoTmlrnlvI/liIbkuqvntabmiYDmnInlj4PoiIfogIXvvIzkuKbmnKrlhLLlrZjmlrzmiJHlgJHnmoTkvLrmnI3lmajjgILmlYXoi6XmiYDmnInlj4PliqDogIXnmobmlrfnt5rvvIzmnKrovLjlh7rmiJblu7rnq4vliIbkuqvpgKPntZDnmoTlhaflrrnlsIfmnIPpgbrlpLHjgIIiLCJkZXNjX3NoYXJlTGluayI6IuWwh+atpOmAo+e1kOWIhuS6q+e1puassuWNlOS9nOeahOWwjeixoe+8miIsImRlc2NfZXhpdFNlc3Npb24iOiLlgZzmraLpgKPnt5rlsIfkuK3mlrfkvaDoiIfljZTkvZzmnIPorbDlrqTnmoTpgKPntZDvvIzkvYbkvaDku43lj6/mlrzmnKzmqZ/nt6jovK/mraTkvZzlk4HjgILmhI/mjIflgZzmraLpgKPnt5rlvozkvaDnmoTnt6jovK/kuI3mnIPooqvlhYjliY3lhbHlkIzljZTkvZznmoTkurrnnIvopovvvIzkuJTku5blgJHlj6/nubznuozlhbHlkIzljZTkvZzlj6bkuIDlgIvniYjmnKzjgIIifSwiZXJyb3JEaWFsb2ciOnsidGl0bGUiOiLpjK/oqqQifSwic2hvcnRjdXRzRGlhbG9nIjp7InRpdGxlIjoi6Y2155uk5b+r6YCf6Y21Iiwic2hhcGVzIjoi5b2i54uAIiwib3IiOiLmiJYiLCJjbGljayI6Ium7nuaTiiIsImRyYWciOiLmi5bmm7MiLCJjdXJ2ZWRBcnJvdyI6Iueuremgreabsue3miIsImN1cnZlZExpbmUiOiLmm7Lnt5oiLCJlZGl0b3IiOiLnt6jovK/lmagiLCJ2aWV3Ijoi5qqi6KaWIiwiYmxvZyI6IumWseiugOmDqOiQveagvCIsImhvd3RvIjoi5a6Y5pa55oyH5Y2XIiwiZ2l0aHViIjoi55m854++5ZWP6aGM77yf5Zue5aCxIGlzc3VlIiwidGV4dE5ld0xpbmUiOiLmj5vooYzvvIjmloflrZfvvIkiLCJ0ZXh0RmluaXNoIjoi5a6M5oiQ57eo6Lyv77yI5paH5a2X77yJIiwiem9vbVRvRml0Ijoi5pS+5aSn6Iez5aGr5ru/55Wr6Z2iIn0sImVuY3J5cHRlZCI6eyJ0b29sdGlwIjoi5L2g55qE5L2c5ZOB5bey5L2/55SoIGVuZC10by1lbmQg5pa55byP5Yqg5a+G77yMRXhjYWxpZHJhdyDnmoTkvLrmnI3lmajkuZ/nhKHms5Xlj5blvpflhbblhaflrrnjgIIifSwiY2hhcnRzIjp7Im5vTnVtZXJpY0NvbHVtbiI6IuS9oOiyvOS4iueahCBzcHJlYWRzaGVldCDmspLmnInmlbjlrZfmrITjgIIiLCJ0b29NYW55Q29sdW1ucyI6IuS9oOiyvOS4iueahCBzcHJlYWRzaGVldCDotoXpgY7lhanmrITjgIIifX0nKX0sZnVuY3Rpb24oZSx0LG4pe3ZhciByPW4oNTQpLG89bigyNykoInNvY2tldC5pby1jbGllbnQ6dXJsIik7ZS5leHBvcnRzPWZ1bmN0aW9uKGUsdCl7dmFyIG49ZTt0PXR8fCJ1bmRlZmluZWQiIT10eXBlb2YgbG9jYXRpb24mJmxvY2F0aW9uLG51bGw9PWUmJihlPXQucHJvdG9jb2wrIi8vIit0Lmhvc3QpOyJzdHJpbmciPT10eXBlb2YgZSYmKCIvIj09PWUuY2hhckF0KDApJiYoZT0iLyI9PT1lLmNoYXJBdCgxKT90LnByb3RvY29sK2U6dC5ob3N0K2UpLC9eKGh0dHBzP3x3c3M/KTpcL1wvLy50ZXN0KGUpfHwobygicHJvdG9jb2wtbGVzcyB1cmwgJXMiLGUpLGU9dm9pZCAwIT09dD90LnByb3RvY29sKyIvLyIrZToiaHR0cHM6Ly8iK2UpLG8oInBhcnNlICVzIixlKSxuPXIoZSkpO24ucG9ydHx8KC9eKGh0dHB8d3MpJC8udGVzdChuLnByb3RvY29sKT9uLnBvcnQ9IjgwIjovXihodHRwfHdzKXMkLy50ZXN0KG4ucHJvdG9jb2wpJiYobi5wb3J0PSI0NDMiKSk7bi5wYXRoPW4ucGF0aHx8Ii8iO3ZhciBhPS0xIT09bi5ob3N0LmluZGV4T2YoIjoiKT8iWyIrbi5ob3N0KyJdIjpuLmhvc3Q7cmV0dXJuIG4uaWQ9bi5wcm90b2NvbCsiOi8vIithKyI6IituLnBvcnQsbi5ocmVmPW4ucHJvdG9jb2wrIjovLyIrYSsodCYmdC5wb3J0PT09bi5wb3J0PyIiOiI6IituLnBvcnQpLG59fSxmdW5jdGlvbihlLHQsbil7ZS5leHBvcnRzPWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQoZSl7bGV0IHQ9MDtmb3IobGV0IG49MDtuPGUubGVuZ3RoO24rKyl0PSh0PDw1KS10K2UuY2hhckNvZGVBdChuKSx0fD0wO3JldHVybiByLmNvbG9yc1tNYXRoLmFicyh0KSVyLmNvbG9ycy5sZW5ndGhdfWZ1bmN0aW9uIHIoZSl7bGV0IG47ZnVuY3Rpb24gaSguLi5lKXtpZighaS5lbmFibGVkKXJldHVybjtjb25zdCB0PWksbz1OdW1iZXIobmV3IERhdGUpLGE9by0obnx8byk7dC5kaWZmPWEsdC5wcmV2PW4sdC5jdXJyPW8sbj1vLGVbMF09ci5jb2VyY2UoZVswXSksInN0cmluZyIhPXR5cGVvZiBlWzBdJiZlLnVuc2hpZnQoIiVPIik7bGV0IHM9MDtlWzBdPWVbMF0ucmVwbGFjZSgvJShbYS16QS1aJV0pL2csKG4sbyk9PntpZigiJSUiPT09bilyZXR1cm4gbjtzKys7Y29uc3QgYT1yLmZvcm1hdHRlcnNbb107aWYoImZ1bmN0aW9uIj09dHlwZW9mIGEpe2NvbnN0IHI9ZVtzXTtuPWEuY2FsbCh0LHIpLGUuc3BsaWNlKHMsMSkscy0tfXJldHVybiBufSksci5mb3JtYXRBcmdzLmNhbGwodCxlKSwodC5sb2d8fHIubG9nKS5hcHBseSh0LGUpfXJldHVybiBpLm5hbWVzcGFjZT1lLGkuZW5hYmxlZD1yLmVuYWJsZWQoZSksaS51c2VDb2xvcnM9ci51c2VDb2xvcnMoKSxpLmNvbG9yPXQoZSksaS5kZXN0cm95PW8saS5leHRlbmQ9YSwiZnVuY3Rpb24iPT10eXBlb2Ygci5pbml0JiZyLmluaXQoaSksci5pbnN0YW5jZXMucHVzaChpKSxpfWZ1bmN0aW9uIG8oKXtjb25zdCBlPXIuaW5zdGFuY2VzLmluZGV4T2YodGhpcyk7cmV0dXJuLTEhPT1lJiYoci5pbnN0YW5jZXMuc3BsaWNlKGUsMSksITApfWZ1bmN0aW9uIGEoZSx0KXtjb25zdCBuPXIodGhpcy5uYW1lc3BhY2UrKHZvaWQgMD09PXQ/IjoiOnQpK2UpO3JldHVybiBuLmxvZz10aGlzLmxvZyxufWZ1bmN0aW9uIGkoZSl7cmV0dXJuIGUudG9TdHJpbmcoKS5zdWJzdHJpbmcoMixlLnRvU3RyaW5nKCkubGVuZ3RoLTIpLnJlcGxhY2UoL1wuXCpcPyQvLCIqIil9cmV0dXJuIHIuZGVidWc9cixyLmRlZmF1bHQ9cixyLmNvZXJjZT1mdW5jdGlvbihlKXtpZihlIGluc3RhbmNlb2YgRXJyb3IpcmV0dXJuIGUuc3RhY2t8fGUubWVzc2FnZTtyZXR1cm4gZX0sci5kaXNhYmxlPWZ1bmN0aW9uKCl7Y29uc3QgZT1bLi4uci5uYW1lcy5tYXAoaSksLi4uci5za2lwcy5tYXAoaSkubWFwKGU9PiItIitlKV0uam9pbigiLCIpO3JldHVybiByLmVuYWJsZSgiIiksZX0sci5lbmFibGU9ZnVuY3Rpb24oZSl7bGV0IHQ7ci5zYXZlKGUpLHIubmFtZXM9W10sci5za2lwcz1bXTtjb25zdCBuPSgic3RyaW5nIj09dHlwZW9mIGU/ZToiIikuc3BsaXQoL1tccyxdKy8pLG89bi5sZW5ndGg7Zm9yKHQ9MDt0PG87dCsrKW5bdF0mJigiLSI9PT0oZT1uW3RdLnJlcGxhY2UoL1wqL2csIi4qPyIpKVswXT9yLnNraXBzLnB1c2gobmV3IFJlZ0V4cCgiXiIrZS5zdWJzdHIoMSkrIiQiKSk6ci5uYW1lcy5wdXNoKG5ldyBSZWdFeHAoIl4iK2UrIiQiKSkpO2Zvcih0PTA7dDxyLmluc3RhbmNlcy5sZW5ndGg7dCsrKXtjb25zdCBlPXIuaW5zdGFuY2VzW3RdO2UuZW5hYmxlZD1yLmVuYWJsZWQoZS5uYW1lc3BhY2UpfX0sci5lbmFibGVkPWZ1bmN0aW9uKGUpe2lmKCIqIj09PWVbZS5sZW5ndGgtMV0pcmV0dXJuITA7bGV0IHQsbjtmb3IodD0wLG49ci5za2lwcy5sZW5ndGg7dDxuO3QrKylpZihyLnNraXBzW3RdLnRlc3QoZSkpcmV0dXJuITE7Zm9yKHQ9MCxuPXIubmFtZXMubGVuZ3RoO3Q8bjt0KyspaWYoci5uYW1lc1t0XS50ZXN0KGUpKXJldHVybiEwO3JldHVybiExfSxyLmh1bWFuaXplPW4oMTIwKSxPYmplY3Qua2V5cyhlKS5mb3JFYWNoKHQ9PntyW3RdPWVbdF19KSxyLmluc3RhbmNlcz1bXSxyLm5hbWVzPVtdLHIuc2tpcHM9W10sci5mb3JtYXR0ZXJzPXt9LHIuc2VsZWN0Q29sb3I9dCxyLmVuYWJsZShyLmxvYWQoKSkscn19LGZ1bmN0aW9uKGUsdCl7dmFyIG49MWUzLHI9NmU0LG89NjAqcixhPTI0Km87ZnVuY3Rpb24gaShlLHQsbixyKXt2YXIgbz10Pj0xLjUqbjtyZXR1cm4gTWF0aC5yb3VuZChlL24pKyIgIityKyhvPyJzIjoiIil9ZS5leHBvcnRzPWZ1bmN0aW9uKGUsdCl7dD10fHx7fTt2YXIgcz10eXBlb2YgZTtpZigic3RyaW5nIj09PXMmJmUubGVuZ3RoPjApcmV0dXJuIGZ1bmN0aW9uKGUpe2lmKChlPVN0cmluZyhlKSkubGVuZ3RoPjEwMClyZXR1cm47dmFyIHQ9L14oLT8oPzpcZCspP1wuP1xkKykgKihtaWxsaXNlY29uZHM/fG1zZWNzP3xtc3xzZWNvbmRzP3xzZWNzP3xzfG1pbnV0ZXM/fG1pbnM/fG18aG91cnM/fGhycz98aHxkYXlzP3xkfHdlZWtzP3x3fHllYXJzP3x5cnM/fHkpPyQvaS5leGVjKGUpO2lmKCF0KXJldHVybjt2YXIgaT1wYXJzZUZsb2F0KHRbMV0pO3N3aXRjaCgodFsyXXx8Im1zIikudG9Mb3dlckNhc2UoKSl7Y2FzZSJ5ZWFycyI6Y2FzZSJ5ZWFyIjpjYXNlInlycyI6Y2FzZSJ5ciI6Y2FzZSJ5IjpyZXR1cm4gMzE1NTc2ZTUqaTtjYXNlIndlZWtzIjpjYXNlIndlZWsiOmNhc2UidyI6cmV0dXJuIDYwNDhlNSppO2Nhc2UiZGF5cyI6Y2FzZSJkYXkiOmNhc2UiZCI6cmV0dXJuIGkqYTtjYXNlImhvdXJzIjpjYXNlImhvdXIiOmNhc2UiaHJzIjpjYXNlImhyIjpjYXNlImgiOnJldHVybiBpKm87Y2FzZSJtaW51dGVzIjpjYXNlIm1pbnV0ZSI6Y2FzZSJtaW5zIjpjYXNlIm1pbiI6Y2FzZSJtIjpyZXR1cm4gaSpyO2Nhc2Uic2Vjb25kcyI6Y2FzZSJzZWNvbmQiOmNhc2Uic2VjcyI6Y2FzZSJzZWMiOmNhc2UicyI6cmV0dXJuIGkqbjtjYXNlIm1pbGxpc2Vjb25kcyI6Y2FzZSJtaWxsaXNlY29uZCI6Y2FzZSJtc2VjcyI6Y2FzZSJtc2VjIjpjYXNlIm1zIjpyZXR1cm4gaTtkZWZhdWx0OnJldHVybn19KGUpO2lmKCJudW1iZXIiPT09cyYmaXNGaW5pdGUoZSkpcmV0dXJuIHQubG9uZz9mdW5jdGlvbihlKXt2YXIgdD1NYXRoLmFicyhlKTtpZih0Pj1hKXJldHVybiBpKGUsdCxhLCJkYXkiKTtpZih0Pj1vKXJldHVybiBpKGUsdCxvLCJob3VyIik7aWYodD49cilyZXR1cm4gaShlLHQsciwibWludXRlIik7aWYodD49bilyZXR1cm4gaShlLHQsbiwic2Vjb25kIik7cmV0dXJuIGUrIiBtcyJ9KGUpOmZ1bmN0aW9uKGUpe3ZhciB0PU1hdGguYWJzKGUpO2lmKHQ+PWEpcmV0dXJuIE1hdGgucm91bmQoZS9hKSsiZCI7aWYodD49bylyZXR1cm4gTWF0aC5yb3VuZChlL28pKyJoIjtpZih0Pj1yKXJldHVybiBNYXRoLnJvdW5kKGUvcikrIm0iO2lmKHQ+PW4pcmV0dXJuIE1hdGgucm91bmQoZS9uKSsicyI7cmV0dXJuIGUrIm1zIn0oZSk7dGhyb3cgbmV3IEVycm9yKCJ2YWwgaXMgbm90IGEgbm9uLWVtcHR5IHN0cmluZyBvciBhIHZhbGlkIG51bWJlci4gdmFsPSIrSlNPTi5zdHJpbmdpZnkoZSkpfX0sZnVuY3Rpb24oZSx0LG4peyhmdW5jdGlvbihyKXtmdW5jdGlvbiBvKCl7dmFyIGU7dHJ5e2U9dC5zdG9yYWdlLmRlYnVnfWNhdGNoKGUpe31yZXR1cm4hZSYmdm9pZCAwIT09ciYmImVudiJpbiByJiYoZT1yLmVudi5ERUJVRyksZX0odD1lLmV4cG9ydHM9bigxMjIpKS5sb2c9ZnVuY3Rpb24oKXtyZXR1cm4ib2JqZWN0Ij09dHlwZW9mIGNvbnNvbGUmJmNvbnNvbGUubG9nJiZGdW5jdGlvbi5wcm90b3R5cGUuYXBwbHkuY2FsbChjb25zb2xlLmxvZyxjb25zb2xlLGFyZ3VtZW50cyl9LHQuZm9ybWF0QXJncz1mdW5jdGlvbihlKXt2YXIgbj10aGlzLnVzZUNvbG9ycztpZihlWzBdPShuPyIlYyI6IiIpK3RoaXMubmFtZXNwYWNlKyhuPyIgJWMiOiIgIikrZVswXSsobj8iJWMgIjoiICIpKyIrIit0Lmh1bWFuaXplKHRoaXMuZGlmZiksIW4pcmV0dXJuO3ZhciByPSJjb2xvcjogIit0aGlzLmNvbG9yO2Uuc3BsaWNlKDEsMCxyLCJjb2xvcjogaW5oZXJpdCIpO3ZhciBvPTAsYT0wO2VbMF0ucmVwbGFjZSgvJVthLXpBLVolXS9nLChmdW5jdGlvbihlKXsiJSUiIT09ZSYmKG8rKywiJWMiPT09ZSYmKGE9bykpfSkpLGUuc3BsaWNlKGEsMCxyKX0sdC5zYXZlPWZ1bmN0aW9uKGUpe3RyeXtudWxsPT1lP3Quc3RvcmFnZS5yZW1vdmVJdGVtKCJkZWJ1ZyIpOnQuc3RvcmFnZS5kZWJ1Zz1lfWNhdGNoKGUpe319LHQubG9hZD1vLHQudXNlQ29sb3JzPWZ1bmN0aW9uKCl7aWYoInVuZGVmaW5lZCIhPXR5cGVvZiB3aW5kb3cmJndpbmRvdy5wcm9jZXNzJiYicmVuZGVyZXIiPT09d2luZG93LnByb2Nlc3MudHlwZSlyZXR1cm4hMDtpZigidW5kZWZpbmVkIiE9dHlwZW9mIG5hdmlnYXRvciYmbmF2aWdhdG9yLnVzZXJBZ2VudCYmbmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpLm1hdGNoKC8oZWRnZXx0cmlkZW50KVwvKFxkKykvKSlyZXR1cm4hMTtyZXR1cm4idW5kZWZpbmVkIiE9dHlwZW9mIGRvY3VtZW50JiZkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQmJmRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZSYmZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLldlYmtpdEFwcGVhcmFuY2V8fCJ1bmRlZmluZWQiIT10eXBlb2Ygd2luZG93JiZ3aW5kb3cuY29uc29sZSYmKHdpbmRvdy5jb25zb2xlLmZpcmVidWd8fHdpbmRvdy5jb25zb2xlLmV4Y2VwdGlvbiYmd2luZG93LmNvbnNvbGUudGFibGUpfHwidW5kZWZpbmVkIiE9dHlwZW9mIG5hdmlnYXRvciYmbmF2aWdhdG9yLnVzZXJBZ2VudCYmbmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpLm1hdGNoKC9maXJlZm94XC8oXGQrKS8pJiZwYXJzZUludChSZWdFeHAuJDEsMTApPj0zMXx8InVuZGVmaW5lZCIhPXR5cGVvZiBuYXZpZ2F0b3ImJm5hdmlnYXRvci51c2VyQWdlbnQmJm5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKS5tYXRjaCgvYXBwbGV3ZWJraXRcLyhcZCspLyl9LHQuc3RvcmFnZT0idW5kZWZpbmVkIiE9dHlwZW9mIGNocm9tZSYmdm9pZCAwIT09Y2hyb21lLnN0b3JhZ2U/Y2hyb21lLnN0b3JhZ2UubG9jYWw6ZnVuY3Rpb24oKXt0cnl7cmV0dXJuIHdpbmRvdy5sb2NhbFN0b3JhZ2V9Y2F0Y2goZSl7fX0oKSx0LmNvbG9ycz1bIiMwMDAwQ0MiLCIjMDAwMEZGIiwiIzAwMzNDQyIsIiMwMDMzRkYiLCIjMDA2NkNDIiwiIzAwNjZGRiIsIiMwMDk5Q0MiLCIjMDA5OUZGIiwiIzAwQ0MwMCIsIiMwMENDMzMiLCIjMDBDQzY2IiwiIzAwQ0M5OSIsIiMwMENDQ0MiLCIjMDBDQ0ZGIiwiIzMzMDBDQyIsIiMzMzAwRkYiLCIjMzMzM0NDIiwiIzMzMzNGRiIsIiMzMzY2Q0MiLCIjMzM2NkZGIiwiIzMzOTlDQyIsIiMzMzk5RkYiLCIjMzNDQzAwIiwiIzMzQ0MzMyIsIiMzM0NDNjYiLCIjMzNDQzk5IiwiIzMzQ0NDQyIsIiMzM0NDRkYiLCIjNjYwMENDIiwiIzY2MDBGRiIsIiM2NjMzQ0MiLCIjNjYzM0ZGIiwiIzY2Q0MwMCIsIiM2NkNDMzMiLCIjOTkwMENDIiwiIzk5MDBGRiIsIiM5OTMzQ0MiLCIjOTkzM0ZGIiwiIzk5Q0MwMCIsIiM5OUNDMzMiLCIjQ0MwMDAwIiwiI0NDMDAzMyIsIiNDQzAwNjYiLCIjQ0MwMDk5IiwiI0NDMDBDQyIsIiNDQzAwRkYiLCIjQ0MzMzAwIiwiI0NDMzMzMyIsIiNDQzMzNjYiLCIjQ0MzMzk5IiwiI0NDMzNDQyIsIiNDQzMzRkYiLCIjQ0M2NjAwIiwiI0NDNjYzMyIsIiNDQzk5MDAiLCIjQ0M5OTMzIiwiI0NDQ0MwMCIsIiNDQ0NDMzMiLCIjRkYwMDAwIiwiI0ZGMDAzMyIsIiNGRjAwNjYiLCIjRkYwMDk5IiwiI0ZGMDBDQyIsIiNGRjAwRkYiLCIjRkYzMzAwIiwiI0ZGMzMzMyIsIiNGRjMzNjYiLCIjRkYzMzk5IiwiI0ZGMzNDQyIsIiNGRjMzRkYiLCIjRkY2NjAwIiwiI0ZGNjYzMyIsIiNGRjk5MDAiLCIjRkY5OTMzIiwiI0ZGQ0MwMCIsIiNGRkNDMzMiXSx0LmZvcm1hdHRlcnMuaj1mdW5jdGlvbihlKXt0cnl7cmV0dXJuIEpTT04uc3RyaW5naWZ5KGUpfWNhdGNoKGUpe3JldHVybiJbVW5leHBlY3RlZEpTT05QYXJzZUVycm9yXTogIitlLm1lc3NhZ2V9fSx0LmVuYWJsZShvKCkpfSkuY2FsbCh0aGlzLG4oNDMpKX0sZnVuY3Rpb24oZSx0LG4pe2Z1bmN0aW9uIHIoZSl7dmFyIG47ZnVuY3Rpb24gcigpe2lmKHIuZW5hYmxlZCl7dmFyIGU9cixvPStuZXcgRGF0ZSxhPW8tKG58fG8pO2UuZGlmZj1hLGUucHJldj1uLGUuY3Vycj1vLG49bztmb3IodmFyIGk9bmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGgpLHM9MDtzPGkubGVuZ3RoO3MrKylpW3NdPWFyZ3VtZW50c1tzXTtpWzBdPXQuY29lcmNlKGlbMF0pLCJzdHJpbmciIT10eXBlb2YgaVswXSYmaS51bnNoaWZ0KCIlTyIpO3ZhciBsPTA7aVswXT1pWzBdLnJlcGxhY2UoLyUoW2EtekEtWiVdKS9nLChmdW5jdGlvbihuLHIpe2lmKCIlJSI9PT1uKXJldHVybiBuO2wrKzt2YXIgbz10LmZvcm1hdHRlcnNbcl07aWYoImZ1bmN0aW9uIj09dHlwZW9mIG8pe3ZhciBhPWlbbF07bj1vLmNhbGwoZSxhKSxpLnNwbGljZShsLDEpLGwtLX1yZXR1cm4gbn0pKSx0LmZvcm1hdEFyZ3MuY2FsbChlLGkpO3ZhciBjPXIubG9nfHx0LmxvZ3x8Y29uc29sZS5sb2cuYmluZChjb25zb2xlKTtjLmFwcGx5KGUsaSl9fXJldHVybiByLm5hbWVzcGFjZT1lLHIuZW5hYmxlZD10LmVuYWJsZWQoZSksci51c2VDb2xvcnM9dC51c2VDb2xvcnMoKSxyLmNvbG9yPWZ1bmN0aW9uKGUpe3ZhciBuLHI9MDtmb3IobiBpbiBlKXI9KHI8PDUpLXIrZS5jaGFyQ29kZUF0KG4pLHJ8PTA7cmV0dXJuIHQuY29sb3JzW01hdGguYWJzKHIpJXQuY29sb3JzLmxlbmd0aF19KGUpLHIuZGVzdHJveT1vLCJmdW5jdGlvbiI9PXR5cGVvZiB0LmluaXQmJnQuaW5pdChyKSx0Lmluc3RhbmNlcy5wdXNoKHIpLHJ9ZnVuY3Rpb24gbygpe3ZhciBlPXQuaW5zdGFuY2VzLmluZGV4T2YodGhpcyk7cmV0dXJuLTEhPT1lJiYodC5pbnN0YW5jZXMuc3BsaWNlKGUsMSksITApfSh0PWUuZXhwb3J0cz1yLmRlYnVnPXIuZGVmYXVsdD1yKS5jb2VyY2U9ZnVuY3Rpb24oZSl7cmV0dXJuIGUgaW5zdGFuY2VvZiBFcnJvcj9lLnN0YWNrfHxlLm1lc3NhZ2U6ZX0sdC5kaXNhYmxlPWZ1bmN0aW9uKCl7dC5lbmFibGUoIiIpfSx0LmVuYWJsZT1mdW5jdGlvbihlKXt2YXIgbjt0LnNhdmUoZSksdC5uYW1lcz1bXSx0LnNraXBzPVtdO3ZhciByPSgic3RyaW5nIj09dHlwZW9mIGU/ZToiIikuc3BsaXQoL1tccyxdKy8pLG89ci5sZW5ndGg7Zm9yKG49MDtuPG87bisrKXJbbl0mJigiLSI9PT0oZT1yW25dLnJlcGxhY2UoL1wqL2csIi4qPyIpKVswXT90LnNraXBzLnB1c2gobmV3IFJlZ0V4cCgiXiIrZS5zdWJzdHIoMSkrIiQiKSk6dC5uYW1lcy5wdXNoKG5ldyBSZWdFeHAoIl4iK2UrIiQiKSkpO2ZvcihuPTA7bjx0Lmluc3RhbmNlcy5sZW5ndGg7bisrKXt2YXIgYT10Lmluc3RhbmNlc1tuXTthLmVuYWJsZWQ9dC5lbmFibGVkKGEubmFtZXNwYWNlKX19LHQuZW5hYmxlZD1mdW5jdGlvbihlKXtpZigiKiI9PT1lW2UubGVuZ3RoLTFdKXJldHVybiEwO3ZhciBuLHI7Zm9yKG49MCxyPXQuc2tpcHMubGVuZ3RoO248cjtuKyspaWYodC5za2lwc1tuXS50ZXN0KGUpKXJldHVybiExO2ZvcihuPTAscj10Lm5hbWVzLmxlbmd0aDtuPHI7bisrKWlmKHQubmFtZXNbbl0udGVzdChlKSlyZXR1cm4hMDtyZXR1cm4hMX0sdC5odW1hbml6ZT1uKDEyMyksdC5pbnN0YW5jZXM9W10sdC5uYW1lcz1bXSx0LnNraXBzPVtdLHQuZm9ybWF0dGVycz17fX0sZnVuY3Rpb24oZSx0KXt2YXIgbj0xZTMscj02ZTQsbz02MCpyLGE9MjQqbztmdW5jdGlvbiBpKGUsdCxuKXtpZighKGU8dCkpcmV0dXJuIGU8MS41KnQ/TWF0aC5mbG9vcihlL3QpKyIgIituOk1hdGguY2VpbChlL3QpKyIgIituKyJzIn1lLmV4cG9ydHM9ZnVuY3Rpb24oZSx0KXt0PXR8fHt9O3ZhciBzLGw9dHlwZW9mIGU7aWYoInN0cmluZyI9PT1sJiZlLmxlbmd0aD4wKXJldHVybiBmdW5jdGlvbihlKXtpZigoZT1TdHJpbmcoZSkpLmxlbmd0aD4xMDApcmV0dXJuO3ZhciB0PS9eKCg/OlxkKyk/XC4/XGQrKSAqKG1pbGxpc2Vjb25kcz98bXNlY3M/fG1zfHNlY29uZHM/fHNlY3M/fHN8bWludXRlcz98bWlucz98bXxob3Vycz98aHJzP3xofGRheXM/fGR8eWVhcnM/fHlycz98eSk/JC9pLmV4ZWMoZSk7aWYoIXQpcmV0dXJuO3ZhciBpPXBhcnNlRmxvYXQodFsxXSk7c3dpdGNoKCh0WzJdfHwibXMiKS50b0xvd2VyQ2FzZSgpKXtjYXNlInllYXJzIjpjYXNlInllYXIiOmNhc2UieXJzIjpjYXNlInlyIjpjYXNlInkiOnJldHVybiAzMTU1NzZlNSppO2Nhc2UiZGF5cyI6Y2FzZSJkYXkiOmNhc2UiZCI6cmV0dXJuIGkqYTtjYXNlImhvdXJzIjpjYXNlImhvdXIiOmNhc2UiaHJzIjpjYXNlImhyIjpjYXNlImgiOnJldHVybiBpKm87Y2FzZSJtaW51dGVzIjpjYXNlIm1pbnV0ZSI6Y2FzZSJtaW5zIjpjYXNlIm1pbiI6Y2FzZSJtIjpyZXR1cm4gaSpyO2Nhc2Uic2Vjb25kcyI6Y2FzZSJzZWNvbmQiOmNhc2Uic2VjcyI6Y2FzZSJzZWMiOmNhc2UicyI6cmV0dXJuIGkqbjtjYXNlIm1pbGxpc2Vjb25kcyI6Y2FzZSJtaWxsaXNlY29uZCI6Y2FzZSJtc2VjcyI6Y2FzZSJtc2VjIjpjYXNlIm1zIjpyZXR1cm4gaTtkZWZhdWx0OnJldHVybn19KGUpO2lmKCJudW1iZXIiPT09bCYmITE9PT1pc05hTihlKSlyZXR1cm4gdC5sb25nP2kocz1lLGEsImRheSIpfHxpKHMsbywiaG91ciIpfHxpKHMsciwibWludXRlIil8fGkocyxuLCJzZWNvbmQiKXx8cysiIG1zIjpmdW5jdGlvbihlKXtpZihlPj1hKXJldHVybiBNYXRoLnJvdW5kKGUvYSkrImQiO2lmKGU+PW8pcmV0dXJuIE1hdGgucm91bmQoZS9vKSsiaCI7aWYoZT49cilyZXR1cm4gTWF0aC5yb3VuZChlL3IpKyJtIjtpZihlPj1uKXJldHVybiBNYXRoLnJvdW5kKGUvbikrInMiO3JldHVybiBlKyJtcyJ9KGUpO3Rocm93IG5ldyBFcnJvcigidmFsIGlzIG5vdCBhIG5vbi1lbXB0eSBzdHJpbmcgb3IgYSB2YWxpZCBudW1iZXIuIHZhbD0iK0pTT04uc3RyaW5naWZ5KGUpKX19LGZ1bmN0aW9uKGUsdCxuKXtmdW5jdGlvbiByKGUpe2lmKGUpcmV0dXJuIGZ1bmN0aW9uKGUpe2Zvcih2YXIgdCBpbiByLnByb3RvdHlwZSllW3RdPXIucHJvdG90eXBlW3RdO3JldHVybiBlfShlKX1lLmV4cG9ydHM9cixyLnByb3RvdHlwZS5vbj1yLnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVyPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuX2NhbGxiYWNrcz10aGlzLl9jYWxsYmFja3N8fHt9LCh0aGlzLl9jYWxsYmFja3NbIiQiK2VdPXRoaXMuX2NhbGxiYWNrc1siJCIrZV18fFtdKS5wdXNoKHQpLHRoaXN9LHIucHJvdG90eXBlLm9uY2U9ZnVuY3Rpb24oZSx0KXtmdW5jdGlvbiBuKCl7dGhpcy5vZmYoZSxuKSx0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX1yZXR1cm4gbi5mbj10LHRoaXMub24oZSxuKSx0aGlzfSxyLnByb3RvdHlwZS5vZmY9ci5wcm90b3R5cGUucmVtb3ZlTGlzdGVuZXI9ci5wcm90b3R5cGUucmVtb3ZlQWxsTGlzdGVuZXJzPXIucHJvdG90eXBlLnJlbW92ZUV2ZW50TGlzdGVuZXI9ZnVuY3Rpb24oZSx0KXtpZih0aGlzLl9jYWxsYmFja3M9dGhpcy5fY2FsbGJhY2tzfHx7fSwwPT1hcmd1bWVudHMubGVuZ3RoKXJldHVybiB0aGlzLl9jYWxsYmFja3M9e30sdGhpczt2YXIgbixyPXRoaXMuX2NhbGxiYWNrc1siJCIrZV07aWYoIXIpcmV0dXJuIHRoaXM7aWYoMT09YXJndW1lbnRzLmxlbmd0aClyZXR1cm4gZGVsZXRlIHRoaXMuX2NhbGxiYWNrc1siJCIrZV0sdGhpcztmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylpZigobj1yW29dKT09PXR8fG4uZm49PT10KXtyLnNwbGljZShvLDEpO2JyZWFrfXJldHVybiB0aGlzfSxyLnByb3RvdHlwZS5lbWl0PWZ1bmN0aW9uKGUpe3RoaXMuX2NhbGxiYWNrcz10aGlzLl9jYWxsYmFja3N8fHt9O3ZhciB0PVtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpLG49dGhpcy5fY2FsbGJhY2tzWyIkIitlXTtpZihuKWZvcih2YXIgcj0wLG89KG49bi5zbGljZSgwKSkubGVuZ3RoO3I8bzsrK3IpbltyXS5hcHBseSh0aGlzLHQpO3JldHVybiB0aGlzfSxyLnByb3RvdHlwZS5saXN0ZW5lcnM9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2NhbGxiYWNrcz10aGlzLl9jYWxsYmFja3N8fHt9LHRoaXMuX2NhbGxiYWNrc1siJCIrZV18fFtdfSxyLnByb3RvdHlwZS5oYXNMaXN0ZW5lcnM9ZnVuY3Rpb24oZSl7cmV0dXJuISF0aGlzLmxpc3RlbmVycyhlKS5sZW5ndGh9fSxmdW5jdGlvbihlLHQsbil7dmFyIHI9big1NSksbz1uKDU2KSxhPU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcsaT0iZnVuY3Rpb24iPT10eXBlb2YgQmxvYnx8InVuZGVmaW5lZCIhPXR5cGVvZiBCbG9iJiYiW29iamVjdCBCbG9iQ29uc3RydWN0b3JdIj09PWEuY2FsbChCbG9iKSxzPSJmdW5jdGlvbiI9PXR5cGVvZiBGaWxlfHwidW5kZWZpbmVkIiE9dHlwZW9mIEZpbGUmJiJbb2JqZWN0IEZpbGVDb25zdHJ1Y3Rvcl0iPT09YS5jYWxsKEZpbGUpO3QuZGVjb25zdHJ1Y3RQYWNrZXQ9ZnVuY3Rpb24oZSl7dmFyIHQ9W10sbj1lLmRhdGEsYT1lO3JldHVybiBhLmRhdGE9ZnVuY3Rpb24gZSh0LG4pe2lmKCF0KXJldHVybiB0O2lmKG8odCkpe3ZhciBhPXtfcGxhY2Vob2xkZXI6ITAsbnVtOm4ubGVuZ3RofTtyZXR1cm4gbi5wdXNoKHQpLGF9aWYocih0KSl7Zm9yKHZhciBpPW5ldyBBcnJheSh0Lmxlbmd0aCkscz0wO3M8dC5sZW5ndGg7cysrKWlbc109ZSh0W3NdLG4pO3JldHVybiBpfWlmKCJvYmplY3QiPT10eXBlb2YgdCYmISh0IGluc3RhbmNlb2YgRGF0ZSkpe2k9e307Zm9yKHZhciBsIGluIHQpaVtsXT1lKHRbbF0sbik7cmV0dXJuIGl9cmV0dXJuIHR9KG4sdCksYS5hdHRhY2htZW50cz10Lmxlbmd0aCx7cGFja2V0OmEsYnVmZmVyczp0fX0sdC5yZWNvbnN0cnVjdFBhY2tldD1mdW5jdGlvbihlLHQpe3JldHVybiBlLmRhdGE9ZnVuY3Rpb24gZSh0LG4pe2lmKCF0KXJldHVybiB0O2lmKHQmJnQuX3BsYWNlaG9sZGVyKXJldHVybiBuW3QubnVtXTtpZihyKHQpKWZvcih2YXIgbz0wO288dC5sZW5ndGg7bysrKXRbb109ZSh0W29dLG4pO2Vsc2UgaWYoIm9iamVjdCI9PXR5cGVvZiB0KWZvcih2YXIgYSBpbiB0KXRbYV09ZSh0W2FdLG4pO3JldHVybiB0fShlLmRhdGEsdCksZS5hdHRhY2htZW50cz12b2lkIDAsZX0sdC5yZW1vdmVCbG9icz1mdW5jdGlvbihlLHQpe3ZhciBuPTAsYT1lOyFmdW5jdGlvbiBlKGwsYyx1KXtpZighbClyZXR1cm4gbDtpZihpJiZsIGluc3RhbmNlb2YgQmxvYnx8cyYmbCBpbnN0YW5jZW9mIEZpbGUpe24rKzt2YXIgZD1uZXcgRmlsZVJlYWRlcjtkLm9ubG9hZD1mdW5jdGlvbigpe3U/dVtjXT10aGlzLnJlc3VsdDphPXRoaXMucmVzdWx0LC0tbnx8dChhKX0sZC5yZWFkQXNBcnJheUJ1ZmZlcihsKX1lbHNlIGlmKHIobCkpZm9yKHZhciBwPTA7cDxsLmxlbmd0aDtwKyspZShsW3BdLHAsbCk7ZWxzZSBpZigib2JqZWN0Ij09dHlwZW9mIGwmJiFvKGwpKWZvcih2YXIgaCBpbiBsKWUobFtoXSxoLGwpfShhKSxufHx0KGEpfX0sZnVuY3Rpb24oZSx0LG4peyJ1c2Ugc3RyaWN0Ijt0LmJ5dGVMZW5ndGg9ZnVuY3Rpb24oZSl7dmFyIHQ9YyhlKSxuPXRbMF0scj10WzFdO3JldHVybiAzKihuK3IpLzQtcn0sdC50b0J5dGVBcnJheT1mdW5jdGlvbihlKXt2YXIgdCxuLHI9YyhlKSxpPXJbMF0scz1yWzFdLGw9bmV3IGEoZnVuY3Rpb24oZSx0LG4pe3JldHVybiAzKih0K24pLzQtbn0oMCxpLHMpKSx1PTAsZD1zPjA/aS00Omk7Zm9yKG49MDtuPGQ7bis9NCl0PW9bZS5jaGFyQ29kZUF0KG4pXTw8MTh8b1tlLmNoYXJDb2RlQXQobisxKV08PDEyfG9bZS5jaGFyQ29kZUF0KG4rMildPDw2fG9bZS5jaGFyQ29kZUF0KG4rMyldLGxbdSsrXT10Pj4xNiYyNTUsbFt1KytdPXQ+PjgmMjU1LGxbdSsrXT0yNTUmdDsyPT09cyYmKHQ9b1tlLmNoYXJDb2RlQXQobildPDwyfG9bZS5jaGFyQ29kZUF0KG4rMSldPj40LGxbdSsrXT0yNTUmdCk7MT09PXMmJih0PW9bZS5jaGFyQ29kZUF0KG4pXTw8MTB8b1tlLmNoYXJDb2RlQXQobisxKV08PDR8b1tlLmNoYXJDb2RlQXQobisyKV0+PjIsbFt1KytdPXQ+PjgmMjU1LGxbdSsrXT0yNTUmdCk7cmV0dXJuIGx9LHQuZnJvbUJ5dGVBcnJheT1mdW5jdGlvbihlKXtmb3IodmFyIHQsbj1lLmxlbmd0aCxvPW4lMyxhPVtdLGk9MCxzPW4tbztpPHM7aSs9MTYzODMpYS5wdXNoKHUoZSxpLGkrMTYzODM+cz9zOmkrMTYzODMpKTsxPT09bz8odD1lW24tMV0sYS5wdXNoKHJbdD4+Ml0rclt0PDw0JjYzXSsiPT0iKSk6Mj09PW8mJih0PShlW24tMl08PDgpK2Vbbi0xXSxhLnB1c2goclt0Pj4xMF0rclt0Pj40JjYzXStyW3Q8PDImNjNdKyI9IikpO3JldHVybiBhLmpvaW4oIiIpfTtmb3IodmFyIHI9W10sbz1bXSxhPSJ1bmRlZmluZWQiIT10eXBlb2YgVWludDhBcnJheT9VaW50OEFycmF5OkFycmF5LGk9IkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky8iLHM9MCxsPWkubGVuZ3RoO3M8bDsrK3MpcltzXT1pW3NdLG9baS5jaGFyQ29kZUF0KHMpXT1zO2Z1bmN0aW9uIGMoZSl7dmFyIHQ9ZS5sZW5ndGg7aWYodCU0PjApdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIHN0cmluZy4gTGVuZ3RoIG11c3QgYmUgYSBtdWx0aXBsZSBvZiA0Iik7dmFyIG49ZS5pbmRleE9mKCI9Iik7cmV0dXJuLTE9PT1uJiYobj10KSxbbixuPT09dD8wOjQtbiU0XX1mdW5jdGlvbiB1KGUsdCxuKXtmb3IodmFyIG8sYSxpPVtdLHM9dDtzPG47cys9MylvPShlW3NdPDwxNiYxNjcxMTY4MCkrKGVbcysxXTw8OCY2NTI4MCkrKDI1NSZlW3MrMl0pLGkucHVzaChyWyhhPW8pPj4xOCY2M10rclthPj4xMiY2M10rclthPj42JjYzXStyWzYzJmFdKTtyZXR1cm4gaS5qb2luKCIiKX1vWyItIi5jaGFyQ29kZUF0KDApXT02MixvWyJfIi5jaGFyQ29kZUF0KDApXT02M30sZnVuY3Rpb24oZSx0KXt0LnJlYWQ9ZnVuY3Rpb24oZSx0LG4scixvKXt2YXIgYSxpLHM9OCpvLXItMSxsPSgxPDxzKS0xLGM9bD4+MSx1PS03LGQ9bj9vLTE6MCxwPW4/LTE6MSxoPWVbdCtkXTtmb3IoZCs9cCxhPWgmKDE8PC11KS0xLGg+Pj0tdSx1Kz1zO3U+MDthPTI1NiphK2VbdCtkXSxkKz1wLHUtPTgpO2ZvcihpPWEmKDE8PC11KS0xLGE+Pj0tdSx1Kz1yO3U+MDtpPTI1NippK2VbdCtkXSxkKz1wLHUtPTgpO2lmKDA9PT1hKWE9MS1jO2Vsc2V7aWYoYT09PWwpcmV0dXJuIGk/TmFOOjEvMCooaD8tMToxKTtpKz1NYXRoLnBvdygyLHIpLGEtPWN9cmV0dXJuKGg/LTE6MSkqaSpNYXRoLnBvdygyLGEtcil9LHQud3JpdGU9ZnVuY3Rpb24oZSx0LG4scixvLGEpe3ZhciBpLHMsbCxjPTgqYS1vLTEsdT0oMTw8YyktMSxkPXU+PjEscD0yMz09PW8/TWF0aC5wb3coMiwtMjQpLU1hdGgucG93KDIsLTc3KTowLGg9cj8wOmEtMSxmPXI/MTotMSxtPXQ8MHx8MD09PXQmJjEvdDwwPzE6MDtmb3IodD1NYXRoLmFicyh0KSxpc05hTih0KXx8dD09PTEvMD8ocz1pc05hTih0KT8xOjAsaT11KTooaT1NYXRoLmZsb29yKE1hdGgubG9nKHQpL01hdGguTE4yKSx0KihsPU1hdGgucG93KDIsLWkpKTwxJiYoaS0tLGwqPTIpLCh0Kz1pK2Q+PTE/cC9sOnAqTWF0aC5wb3coMiwxLWQpKSpsPj0yJiYoaSsrLGwvPTIpLGkrZD49dT8ocz0wLGk9dSk6aStkPj0xPyhzPSh0KmwtMSkqTWF0aC5wb3coMixvKSxpKz1kKToocz10Kk1hdGgucG93KDIsZC0xKSpNYXRoLnBvdygyLG8pLGk9MCkpO28+PTg7ZVtuK2hdPTI1NSZzLGgrPWYscy89MjU2LG8tPTgpO2ZvcihpPWk8PG98cyxjKz1vO2M+MDtlW24raF09MjU1JmksaCs9ZixpLz0yNTYsYy09OCk7ZVtuK2gtZl18PTEyOCptfX0sZnVuY3Rpb24oZSx0KXt2YXIgbj17fS50b1N0cmluZztlLmV4cG9ydHM9QXJyYXkuaXNBcnJheXx8ZnVuY3Rpb24oZSl7cmV0dXJuIltvYmplY3QgQXJyYXldIj09bi5jYWxsKGUpfX0sZnVuY3Rpb24oZSx0LG4pe2UuZXhwb3J0cz1uKDEzMCksZS5leHBvcnRzLnBhcnNlcj1uKDM0KX0sZnVuY3Rpb24oZSx0LG4pe3ZhciByPW4oNTgpLG89big0OSksYT1uKDI3KSgiZW5naW5lLmlvLWNsaWVudDpzb2NrZXQiKSxpPW4oNjIpLHM9bigzNCksbD1uKDU0KSxjPW4oNDApO2Z1bmN0aW9uIHUoZSx0KXtpZighKHRoaXMgaW5zdGFuY2VvZiB1KSlyZXR1cm4gbmV3IHUoZSx0KTt0PXR8fHt9LGUmJiJvYmplY3QiPT10eXBlb2YgZSYmKHQ9ZSxlPW51bGwpLGU/KGU9bChlKSx0Lmhvc3RuYW1lPWUuaG9zdCx0LnNlY3VyZT0iaHR0cHMiPT09ZS5wcm90b2NvbHx8IndzcyI9PT1lLnByb3RvY29sLHQucG9ydD1lLnBvcnQsZS5xdWVyeSYmKHQucXVlcnk9ZS5xdWVyeSkpOnQuaG9zdCYmKHQuaG9zdG5hbWU9bCh0Lmhvc3QpLmhvc3QpLHRoaXMuc2VjdXJlPW51bGwhPXQuc2VjdXJlP3Quc2VjdXJlOiJ1bmRlZmluZWQiIT10eXBlb2YgbG9jYXRpb24mJiJodHRwczoiPT09bG9jYXRpb24ucHJvdG9jb2wsdC5ob3N0bmFtZSYmIXQucG9ydCYmKHQucG9ydD10aGlzLnNlY3VyZT8iNDQzIjoiODAiKSx0aGlzLmFnZW50PXQuYWdlbnR8fCExLHRoaXMuaG9zdG5hbWU9dC5ob3N0bmFtZXx8KCJ1bmRlZmluZWQiIT10eXBlb2YgbG9jYXRpb24/bG9jYXRpb24uaG9zdG5hbWU6ImxvY2FsaG9zdCIpLHRoaXMucG9ydD10LnBvcnR8fCgidW5kZWZpbmVkIiE9dHlwZW9mIGxvY2F0aW9uJiZsb2NhdGlvbi5wb3J0P2xvY2F0aW9uLnBvcnQ6dGhpcy5zZWN1cmU/NDQzOjgwKSx0aGlzLnF1ZXJ5PXQucXVlcnl8fHt9LCJzdHJpbmciPT10eXBlb2YgdGhpcy5xdWVyeSYmKHRoaXMucXVlcnk9Yy5kZWNvZGUodGhpcy5xdWVyeSkpLHRoaXMudXBncmFkZT0hMSE9PXQudXBncmFkZSx0aGlzLnBhdGg9KHQucGF0aHx8Ii9lbmdpbmUuaW8iKS5yZXBsYWNlKC9cLyQvLCIiKSsiLyIsdGhpcy5mb3JjZUpTT05QPSEhdC5mb3JjZUpTT05QLHRoaXMuanNvbnA9ITEhPT10Lmpzb25wLHRoaXMuZm9yY2VCYXNlNjQ9ISF0LmZvcmNlQmFzZTY0LHRoaXMuZW5hYmxlc1hEUj0hIXQuZW5hYmxlc1hEUix0aGlzLndpdGhDcmVkZW50aWFscz0hMSE9PXQud2l0aENyZWRlbnRpYWxzLHRoaXMudGltZXN0YW1wUGFyYW09dC50aW1lc3RhbXBQYXJhbXx8InQiLHRoaXMudGltZXN0YW1wUmVxdWVzdHM9dC50aW1lc3RhbXBSZXF1ZXN0cyx0aGlzLnRyYW5zcG9ydHM9dC50cmFuc3BvcnRzfHxbInBvbGxpbmciLCJ3ZWJzb2NrZXQiXSx0aGlzLnRyYW5zcG9ydE9wdGlvbnM9dC50cmFuc3BvcnRPcHRpb25zfHx7fSx0aGlzLnJlYWR5U3RhdGU9IiIsdGhpcy53cml0ZUJ1ZmZlcj1bXSx0aGlzLnByZXZCdWZmZXJMZW49MCx0aGlzLnBvbGljeVBvcnQ9dC5wb2xpY3lQb3J0fHw4NDMsdGhpcy5yZW1lbWJlclVwZ3JhZGU9dC5yZW1lbWJlclVwZ3JhZGV8fCExLHRoaXMuYmluYXJ5VHlwZT1udWxsLHRoaXMub25seUJpbmFyeVVwZ3JhZGVzPXQub25seUJpbmFyeVVwZ3JhZGVzLHRoaXMucGVyTWVzc2FnZURlZmxhdGU9ITEhPT10LnBlck1lc3NhZ2VEZWZsYXRlJiYodC5wZXJNZXNzYWdlRGVmbGF0ZXx8e30pLCEwPT09dGhpcy5wZXJNZXNzYWdlRGVmbGF0ZSYmKHRoaXMucGVyTWVzc2FnZURlZmxhdGU9e30pLHRoaXMucGVyTWVzc2FnZURlZmxhdGUmJm51bGw9PXRoaXMucGVyTWVzc2FnZURlZmxhdGUudGhyZXNob2xkJiYodGhpcy5wZXJNZXNzYWdlRGVmbGF0ZS50aHJlc2hvbGQ9MTAyNCksdGhpcy5wZng9dC5wZnh8fG51bGwsdGhpcy5rZXk9dC5rZXl8fG51bGwsdGhpcy5wYXNzcGhyYXNlPXQucGFzc3BocmFzZXx8bnVsbCx0aGlzLmNlcnQ9dC5jZXJ0fHxudWxsLHRoaXMuY2E9dC5jYXx8bnVsbCx0aGlzLmNpcGhlcnM9dC5jaXBoZXJzfHxudWxsLHRoaXMucmVqZWN0VW5hdXRob3JpemVkPXZvaWQgMD09PXQucmVqZWN0VW5hdXRob3JpemVkfHx0LnJlamVjdFVuYXV0aG9yaXplZCx0aGlzLmZvcmNlTm9kZT0hIXQuZm9yY2VOb2RlLHRoaXMuaXNSZWFjdE5hdGl2ZT0idW5kZWZpbmVkIiE9dHlwZW9mIG5hdmlnYXRvciYmInN0cmluZyI9PXR5cGVvZiBuYXZpZ2F0b3IucHJvZHVjdCYmInJlYWN0bmF0aXZlIj09PW5hdmlnYXRvci5wcm9kdWN0LnRvTG93ZXJDYXNlKCksKCJ1bmRlZmluZWQiPT10eXBlb2Ygc2VsZnx8dGhpcy5pc1JlYWN0TmF0aXZlKSYmKHQuZXh0cmFIZWFkZXJzJiZPYmplY3Qua2V5cyh0LmV4dHJhSGVhZGVycykubGVuZ3RoPjAmJih0aGlzLmV4dHJhSGVhZGVycz10LmV4dHJhSGVhZGVycyksdC5sb2NhbEFkZHJlc3MmJih0aGlzLmxvY2FsQWRkcmVzcz10LmxvY2FsQWRkcmVzcykpLHRoaXMuaWQ9bnVsbCx0aGlzLnVwZ3JhZGVzPW51bGwsdGhpcy5waW5nSW50ZXJ2YWw9bnVsbCx0aGlzLnBpbmdUaW1lb3V0PW51bGwsdGhpcy5waW5nSW50ZXJ2YWxUaW1lcj1udWxsLHRoaXMucGluZ1RpbWVvdXRUaW1lcj1udWxsLHRoaXMub3BlbigpfWUuZXhwb3J0cz11LHUucHJpb3JXZWJzb2NrZXRTdWNjZXNzPSExLG8odS5wcm90b3R5cGUpLHUucHJvdG9jb2w9cy5wcm90b2NvbCx1LlNvY2tldD11LHUuVHJhbnNwb3J0PW4oNDgpLHUudHJhbnNwb3J0cz1uKDU4KSx1LnBhcnNlcj1uKDM0KSx1LnByb3RvdHlwZS5jcmVhdGVUcmFuc3BvcnQ9ZnVuY3Rpb24oZSl7YSgnY3JlYXRpbmcgdHJhbnNwb3J0ICIlcyInLGUpO3ZhciB0PWZ1bmN0aW9uKGUpe3ZhciB0PXt9O2Zvcih2YXIgbiBpbiBlKWUuaGFzT3duUHJvcGVydHkobikmJih0W25dPWVbbl0pO3JldHVybiB0fSh0aGlzLnF1ZXJ5KTt0LkVJTz1zLnByb3RvY29sLHQudHJhbnNwb3J0PWU7dmFyIG49dGhpcy50cmFuc3BvcnRPcHRpb25zW2VdfHx7fTtyZXR1cm4gdGhpcy5pZCYmKHQuc2lkPXRoaXMuaWQpLG5ldyByW2VdKHtxdWVyeTp0LHNvY2tldDp0aGlzLGFnZW50Om4uYWdlbnR8fHRoaXMuYWdlbnQsaG9zdG5hbWU6bi5ob3N0bmFtZXx8dGhpcy5ob3N0bmFtZSxwb3J0Om4ucG9ydHx8dGhpcy5wb3J0LHNlY3VyZTpuLnNlY3VyZXx8dGhpcy5zZWN1cmUscGF0aDpuLnBhdGh8fHRoaXMucGF0aCxmb3JjZUpTT05QOm4uZm9yY2VKU09OUHx8dGhpcy5mb3JjZUpTT05QLGpzb25wOm4uanNvbnB8fHRoaXMuanNvbnAsZm9yY2VCYXNlNjQ6bi5mb3JjZUJhc2U2NHx8dGhpcy5mb3JjZUJhc2U2NCxlbmFibGVzWERSOm4uZW5hYmxlc1hEUnx8dGhpcy5lbmFibGVzWERSLHdpdGhDcmVkZW50aWFsczpuLndpdGhDcmVkZW50aWFsc3x8dGhpcy53aXRoQ3JlZGVudGlhbHMsdGltZXN0YW1wUmVxdWVzdHM6bi50aW1lc3RhbXBSZXF1ZXN0c3x8dGhpcy50aW1lc3RhbXBSZXF1ZXN0cyx0aW1lc3RhbXBQYXJhbTpuLnRpbWVzdGFtcFBhcmFtfHx0aGlzLnRpbWVzdGFtcFBhcmFtLHBvbGljeVBvcnQ6bi5wb2xpY3lQb3J0fHx0aGlzLnBvbGljeVBvcnQscGZ4Om4ucGZ4fHx0aGlzLnBmeCxrZXk6bi5rZXl8fHRoaXMua2V5LHBhc3NwaHJhc2U6bi5wYXNzcGhyYXNlfHx0aGlzLnBhc3NwaHJhc2UsY2VydDpuLmNlcnR8fHRoaXMuY2VydCxjYTpuLmNhfHx0aGlzLmNhLGNpcGhlcnM6bi5jaXBoZXJzfHx0aGlzLmNpcGhlcnMscmVqZWN0VW5hdXRob3JpemVkOm4ucmVqZWN0VW5hdXRob3JpemVkfHx0aGlzLnJlamVjdFVuYXV0aG9yaXplZCxwZXJNZXNzYWdlRGVmbGF0ZTpuLnBlck1lc3NhZ2VEZWZsYXRlfHx0aGlzLnBlck1lc3NhZ2VEZWZsYXRlLGV4dHJhSGVhZGVyczpuLmV4dHJhSGVhZGVyc3x8dGhpcy5leHRyYUhlYWRlcnMsZm9yY2VOb2RlOm4uZm9yY2VOb2RlfHx0aGlzLmZvcmNlTm9kZSxsb2NhbEFkZHJlc3M6bi5sb2NhbEFkZHJlc3N8fHRoaXMubG9jYWxBZGRyZXNzLHJlcXVlc3RUaW1lb3V0Om4ucmVxdWVzdFRpbWVvdXR8fHRoaXMucmVxdWVzdFRpbWVvdXQscHJvdG9jb2xzOm4ucHJvdG9jb2xzfHx2b2lkIDAsaXNSZWFjdE5hdGl2ZTp0aGlzLmlzUmVhY3ROYXRpdmV9KX0sdS5wcm90b3R5cGUub3Blbj1mdW5jdGlvbigpe3ZhciBlO2lmKHRoaXMucmVtZW1iZXJVcGdyYWRlJiZ1LnByaW9yV2Vic29ja2V0U3VjY2VzcyYmLTEhPT10aGlzLnRyYW5zcG9ydHMuaW5kZXhPZigid2Vic29ja2V0IikpZT0id2Vic29ja2V0IjtlbHNle2lmKDA9PT10aGlzLnRyYW5zcG9ydHMubGVuZ3RoKXt2YXIgdD10aGlzO3JldHVybiB2b2lkIHNldFRpbWVvdXQoKGZ1bmN0aW9uKCl7dC5lbWl0KCJlcnJvciIsIk5vIHRyYW5zcG9ydHMgYXZhaWxhYmxlIil9KSwwKX1lPXRoaXMudHJhbnNwb3J0c1swXX10aGlzLnJlYWR5U3RhdGU9Im9wZW5pbmciO3RyeXtlPXRoaXMuY3JlYXRlVHJhbnNwb3J0KGUpfWNhdGNoKGUpe3JldHVybiB0aGlzLnRyYW5zcG9ydHMuc2hpZnQoKSx2b2lkIHRoaXMub3BlbigpfWUub3BlbigpLHRoaXMuc2V0VHJhbnNwb3J0KGUpfSx1LnByb3RvdHlwZS5zZXRUcmFuc3BvcnQ9ZnVuY3Rpb24oZSl7YSgic2V0dGluZyB0cmFuc3BvcnQgJXMiLGUubmFtZSk7dmFyIHQ9dGhpczt0aGlzLnRyYW5zcG9ydCYmKGEoImNsZWFyaW5nIGV4aXN0aW5nIHRyYW5zcG9ydCAlcyIsdGhpcy50cmFuc3BvcnQubmFtZSksdGhpcy50cmFuc3BvcnQucmVtb3ZlQWxsTGlzdGVuZXJzKCkpLHRoaXMudHJhbnNwb3J0PWUsZS5vbigiZHJhaW4iLChmdW5jdGlvbigpe3Qub25EcmFpbigpfSkpLm9uKCJwYWNrZXQiLChmdW5jdGlvbihlKXt0Lm9uUGFja2V0KGUpfSkpLm9uKCJlcnJvciIsKGZ1bmN0aW9uKGUpe3Qub25FcnJvcihlKX0pKS5vbigiY2xvc2UiLChmdW5jdGlvbigpe3Qub25DbG9zZSgidHJhbnNwb3J0IGNsb3NlIil9KSl9LHUucHJvdG90eXBlLnByb2JlPWZ1bmN0aW9uKGUpe2EoJ3Byb2JpbmcgdHJhbnNwb3J0ICIlcyInLGUpO3ZhciB0PXRoaXMuY3JlYXRlVHJhbnNwb3J0KGUse3Byb2JlOjF9KSxuPSExLHI9dGhpcztmdW5jdGlvbiBvKCl7aWYoci5vbmx5QmluYXJ5VXBncmFkZXMpe3ZhciBvPSF0aGlzLnN1cHBvcnRzQmluYXJ5JiZyLnRyYW5zcG9ydC5zdXBwb3J0c0JpbmFyeTtuPW58fG99bnx8KGEoJ3Byb2JlIHRyYW5zcG9ydCAiJXMiIG9wZW5lZCcsZSksdC5zZW5kKFt7dHlwZToicGluZyIsZGF0YToicHJvYmUifV0pLHQub25jZSgicGFja2V0IiwoZnVuY3Rpb24obyl7aWYoIW4paWYoInBvbmciPT09by50eXBlJiYicHJvYmUiPT09by5kYXRhKXtpZihhKCdwcm9iZSB0cmFuc3BvcnQgIiVzIiBwb25nJyxlKSxyLnVwZ3JhZGluZz0hMCxyLmVtaXQoInVwZ3JhZGluZyIsdCksIXQpcmV0dXJuO3UucHJpb3JXZWJzb2NrZXRTdWNjZXNzPSJ3ZWJzb2NrZXQiPT09dC5uYW1lLGEoJ3BhdXNpbmcgY3VycmVudCB0cmFuc3BvcnQgIiVzIicsci50cmFuc3BvcnQubmFtZSksci50cmFuc3BvcnQucGF1c2UoKGZ1bmN0aW9uKCl7bnx8ImNsb3NlZCIhPT1yLnJlYWR5U3RhdGUmJihhKCJjaGFuZ2luZyB0cmFuc3BvcnQgYW5kIHNlbmRpbmcgdXBncmFkZSBwYWNrZXQiKSxwKCksci5zZXRUcmFuc3BvcnQodCksdC5zZW5kKFt7dHlwZToidXBncmFkZSJ9XSksci5lbWl0KCJ1cGdyYWRlIix0KSx0PW51bGwsci51cGdyYWRpbmc9ITEsci5mbHVzaCgpKX0pKX1lbHNle2EoJ3Byb2JlIHRyYW5zcG9ydCAiJXMiIGZhaWxlZCcsZSk7dmFyIGk9bmV3IEVycm9yKCJwcm9iZSBlcnJvciIpO2kudHJhbnNwb3J0PXQubmFtZSxyLmVtaXQoInVwZ3JhZGVFcnJvciIsaSl9fSkpKX1mdW5jdGlvbiBpKCl7bnx8KG49ITAscCgpLHQuY2xvc2UoKSx0PW51bGwpfWZ1bmN0aW9uIHMobil7dmFyIG89bmV3IEVycm9yKCJwcm9iZSBlcnJvcjogIituKTtvLnRyYW5zcG9ydD10Lm5hbWUsaSgpLGEoJ3Byb2JlIHRyYW5zcG9ydCAiJXMiIGZhaWxlZCBiZWNhdXNlIG9mIGVycm9yOiAlcycsZSxuKSxyLmVtaXQoInVwZ3JhZGVFcnJvciIsbyl9ZnVuY3Rpb24gbCgpe3MoInRyYW5zcG9ydCBjbG9zZWQiKX1mdW5jdGlvbiBjKCl7cygic29ja2V0IGNsb3NlZCIpfWZ1bmN0aW9uIGQoZSl7dCYmZS5uYW1lIT09dC5uYW1lJiYoYSgnIiVzIiB3b3JrcyAtIGFib3J0aW5nICIlcyInLGUubmFtZSx0Lm5hbWUpLGkoKSl9ZnVuY3Rpb24gcCgpe3QucmVtb3ZlTGlzdGVuZXIoIm9wZW4iLG8pLHQucmVtb3ZlTGlzdGVuZXIoImVycm9yIixzKSx0LnJlbW92ZUxpc3RlbmVyKCJjbG9zZSIsbCksci5yZW1vdmVMaXN0ZW5lcigiY2xvc2UiLGMpLHIucmVtb3ZlTGlzdGVuZXIoInVwZ3JhZGluZyIsZCl9dS5wcmlvcldlYnNvY2tldFN1Y2Nlc3M9ITEsdC5vbmNlKCJvcGVuIixvKSx0Lm9uY2UoImVycm9yIixzKSx0Lm9uY2UoImNsb3NlIixsKSx0aGlzLm9uY2UoImNsb3NlIixjKSx0aGlzLm9uY2UoInVwZ3JhZGluZyIsZCksdC5vcGVuKCl9LHUucHJvdG90eXBlLm9uT3Blbj1mdW5jdGlvbigpe2lmKGEoInNvY2tldCBvcGVuIiksdGhpcy5yZWFkeVN0YXRlPSJvcGVuIix1LnByaW9yV2Vic29ja2V0U3VjY2Vzcz0id2Vic29ja2V0Ij09PXRoaXMudHJhbnNwb3J0Lm5hbWUsdGhpcy5lbWl0KCJvcGVuIiksdGhpcy5mbHVzaCgpLCJvcGVuIj09PXRoaXMucmVhZHlTdGF0ZSYmdGhpcy51cGdyYWRlJiZ0aGlzLnRyYW5zcG9ydC5wYXVzZSl7YSgic3RhcnRpbmcgdXBncmFkZSBwcm9iZXMiKTtmb3IodmFyIGU9MCx0PXRoaXMudXBncmFkZXMubGVuZ3RoO2U8dDtlKyspdGhpcy5wcm9iZSh0aGlzLnVwZ3JhZGVzW2VdKX19LHUucHJvdG90eXBlLm9uUGFja2V0PWZ1bmN0aW9uKGUpe2lmKCJvcGVuaW5nIj09PXRoaXMucmVhZHlTdGF0ZXx8Im9wZW4iPT09dGhpcy5yZWFkeVN0YXRlfHwiY2xvc2luZyI9PT10aGlzLnJlYWR5U3RhdGUpc3dpdGNoKGEoJ3NvY2tldCByZWNlaXZlOiB0eXBlICIlcyIsIGRhdGEgIiVzIicsZS50eXBlLGUuZGF0YSksdGhpcy5lbWl0KCJwYWNrZXQiLGUpLHRoaXMuZW1pdCgiaGVhcnRiZWF0IiksZS50eXBlKXtjYXNlIm9wZW4iOnRoaXMub25IYW5kc2hha2UoSlNPTi5wYXJzZShlLmRhdGEpKTticmVhaztjYXNlInBvbmciOnRoaXMuc2V0UGluZygpLHRoaXMuZW1pdCgicG9uZyIpO2JyZWFrO2Nhc2UiZXJyb3IiOnZhciB0PW5ldyBFcnJvcigic2VydmVyIGVycm9yIik7dC5jb2RlPWUuZGF0YSx0aGlzLm9uRXJyb3IodCk7YnJlYWs7Y2FzZSJtZXNzYWdlIjp0aGlzLmVtaXQoImRhdGEiLGUuZGF0YSksdGhpcy5lbWl0KCJtZXNzYWdlIixlLmRhdGEpfWVsc2UgYSgncGFja2V0IHJlY2VpdmVkIHdpdGggc29ja2V0IHJlYWR5U3RhdGUgIiVzIicsdGhpcy5yZWFkeVN0YXRlKX0sdS5wcm90b3R5cGUub25IYW5kc2hha2U9ZnVuY3Rpb24oZSl7dGhpcy5lbWl0KCJoYW5kc2hha2UiLGUpLHRoaXMuaWQ9ZS5zaWQsdGhpcy50cmFuc3BvcnQucXVlcnkuc2lkPWUuc2lkLHRoaXMudXBncmFkZXM9dGhpcy5maWx0ZXJVcGdyYWRlcyhlLnVwZ3JhZGVzKSx0aGlzLnBpbmdJbnRlcnZhbD1lLnBpbmdJbnRlcnZhbCx0aGlzLnBpbmdUaW1lb3V0PWUucGluZ1RpbWVvdXQsdGhpcy5vbk9wZW4oKSwiY2xvc2VkIiE9PXRoaXMucmVhZHlTdGF0ZSYmKHRoaXMuc2V0UGluZygpLHRoaXMucmVtb3ZlTGlzdGVuZXIoImhlYXJ0YmVhdCIsdGhpcy5vbkhlYXJ0YmVhdCksdGhpcy5vbigiaGVhcnRiZWF0Iix0aGlzLm9uSGVhcnRiZWF0KSl9LHUucHJvdG90eXBlLm9uSGVhcnRiZWF0PWZ1bmN0aW9uKGUpe2NsZWFyVGltZW91dCh0aGlzLnBpbmdUaW1lb3V0VGltZXIpO3ZhciB0PXRoaXM7dC5waW5nVGltZW91dFRpbWVyPXNldFRpbWVvdXQoKGZ1bmN0aW9uKCl7ImNsb3NlZCIhPT10LnJlYWR5U3RhdGUmJnQub25DbG9zZSgicGluZyB0aW1lb3V0Iil9KSxlfHx0LnBpbmdJbnRlcnZhbCt0LnBpbmdUaW1lb3V0KX0sdS5wcm90b3R5cGUuc2V0UGluZz1mdW5jdGlvbigpe3ZhciBlPXRoaXM7Y2xlYXJUaW1lb3V0KGUucGluZ0ludGVydmFsVGltZXIpLGUucGluZ0ludGVydmFsVGltZXI9c2V0VGltZW91dCgoZnVuY3Rpb24oKXthKCJ3cml0aW5nIHBpbmcgcGFja2V0IC0gZXhwZWN0aW5nIHBvbmcgd2l0aGluICVzbXMiLGUucGluZ1RpbWVvdXQpLGUucGluZygpLGUub25IZWFydGJlYXQoZS5waW5nVGltZW91dCl9KSxlLnBpbmdJbnRlcnZhbCl9LHUucHJvdG90eXBlLnBpbmc9ZnVuY3Rpb24oKXt2YXIgZT10aGlzO3RoaXMuc2VuZFBhY2tldCgicGluZyIsKGZ1bmN0aW9uKCl7ZS5lbWl0KCJwaW5nIil9KSl9LHUucHJvdG90eXBlLm9uRHJhaW49ZnVuY3Rpb24oKXt0aGlzLndyaXRlQnVmZmVyLnNwbGljZSgwLHRoaXMucHJldkJ1ZmZlckxlbiksdGhpcy5wcmV2QnVmZmVyTGVuPTAsMD09PXRoaXMud3JpdGVCdWZmZXIubGVuZ3RoP3RoaXMuZW1pdCgiZHJhaW4iKTp0aGlzLmZsdXNoKCl9LHUucHJvdG90eXBlLmZsdXNoPWZ1bmN0aW9uKCl7ImNsb3NlZCIhPT10aGlzLnJlYWR5U3RhdGUmJnRoaXMudHJhbnNwb3J0LndyaXRhYmxlJiYhdGhpcy51cGdyYWRpbmcmJnRoaXMud3JpdGVCdWZmZXIubGVuZ3RoJiYoYSgiZmx1c2hpbmcgJWQgcGFja2V0cyBpbiBzb2NrZXQiLHRoaXMud3JpdGVCdWZmZXIubGVuZ3RoKSx0aGlzLnRyYW5zcG9ydC5zZW5kKHRoaXMud3JpdGVCdWZmZXIpLHRoaXMucHJldkJ1ZmZlckxlbj10aGlzLndyaXRlQnVmZmVyLmxlbmd0aCx0aGlzLmVtaXQoImZsdXNoIikpfSx1LnByb3RvdHlwZS53cml0ZT11LnByb3RvdHlwZS5zZW5kPWZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gdGhpcy5zZW5kUGFja2V0KCJtZXNzYWdlIixlLHQsbiksdGhpc30sdS5wcm90b3R5cGUuc2VuZFBhY2tldD1mdW5jdGlvbihlLHQsbixyKXtpZigiZnVuY3Rpb24iPT10eXBlb2YgdCYmKHI9dCx0PXZvaWQgMCksImZ1bmN0aW9uIj09dHlwZW9mIG4mJihyPW4sbj1udWxsKSwiY2xvc2luZyIhPT10aGlzLnJlYWR5U3RhdGUmJiJjbG9zZWQiIT09dGhpcy5yZWFkeVN0YXRlKXsobj1ufHx7fSkuY29tcHJlc3M9ITEhPT1uLmNvbXByZXNzO3ZhciBvPXt0eXBlOmUsZGF0YTp0LG9wdGlvbnM6bn07dGhpcy5lbWl0KCJwYWNrZXRDcmVhdGUiLG8pLHRoaXMud3JpdGVCdWZmZXIucHVzaChvKSxyJiZ0aGlzLm9uY2UoImZsdXNoIixyKSx0aGlzLmZsdXNoKCl9fSx1LnByb3RvdHlwZS5jbG9zZT1mdW5jdGlvbigpe2lmKCJvcGVuaW5nIj09PXRoaXMucmVhZHlTdGF0ZXx8Im9wZW4iPT09dGhpcy5yZWFkeVN0YXRlKXt0aGlzLnJlYWR5U3RhdGU9ImNsb3NpbmciO3ZhciBlPXRoaXM7dGhpcy53cml0ZUJ1ZmZlci5sZW5ndGg/dGhpcy5vbmNlKCJkcmFpbiIsKGZ1bmN0aW9uKCl7dGhpcy51cGdyYWRpbmc/cigpOnQoKX0pKTp0aGlzLnVwZ3JhZGluZz9yKCk6dCgpfWZ1bmN0aW9uIHQoKXtlLm9uQ2xvc2UoImZvcmNlZCBjbG9zZSIpLGEoInNvY2tldCBjbG9zaW5nIC0gdGVsbGluZyB0cmFuc3BvcnQgdG8gY2xvc2UiKSxlLnRyYW5zcG9ydC5jbG9zZSgpfWZ1bmN0aW9uIG4oKXtlLnJlbW92ZUxpc3RlbmVyKCJ1cGdyYWRlIixuKSxlLnJlbW92ZUxpc3RlbmVyKCJ1cGdyYWRlRXJyb3IiLG4pLHQoKX1mdW5jdGlvbiByKCl7ZS5vbmNlKCJ1cGdyYWRlIixuKSxlLm9uY2UoInVwZ3JhZGVFcnJvciIsbil9cmV0dXJuIHRoaXN9LHUucHJvdG90eXBlLm9uRXJyb3I9ZnVuY3Rpb24oZSl7YSgic29ja2V0IGVycm9yICVqIixlKSx1LnByaW9yV2Vic29ja2V0U3VjY2Vzcz0hMSx0aGlzLmVtaXQoImVycm9yIixlKSx0aGlzLm9uQ2xvc2UoInRyYW5zcG9ydCBlcnJvciIsZSl9LHUucHJvdG90eXBlLm9uQ2xvc2U9ZnVuY3Rpb24oZSx0KXtpZigib3BlbmluZyI9PT10aGlzLnJlYWR5U3RhdGV8fCJvcGVuIj09PXRoaXMucmVhZHlTdGF0ZXx8ImNsb3NpbmciPT09dGhpcy5yZWFkeVN0YXRlKXthKCdzb2NrZXQgY2xvc2Ugd2l0aCByZWFzb246ICIlcyInLGUpO2NsZWFyVGltZW91dCh0aGlzLnBpbmdJbnRlcnZhbFRpbWVyKSxjbGVhclRpbWVvdXQodGhpcy5waW5nVGltZW91dFRpbWVyKSx0aGlzLnRyYW5zcG9ydC5yZW1vdmVBbGxMaXN0ZW5lcnMoImNsb3NlIiksdGhpcy50cmFuc3BvcnQuY2xvc2UoKSx0aGlzLnRyYW5zcG9ydC5yZW1vdmVBbGxMaXN0ZW5lcnMoKSx0aGlzLnJlYWR5U3RhdGU9ImNsb3NlZCIsdGhpcy5pZD1udWxsLHRoaXMuZW1pdCgiY2xvc2UiLGUsdCksdGhpcy53cml0ZUJ1ZmZlcj1bXSx0aGlzLnByZXZCdWZmZXJMZW49MH19LHUucHJvdG90eXBlLmZpbHRlclVwZ3JhZGVzPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1bXSxuPTAscj1lLmxlbmd0aDtuPHI7bisrKX5pKHRoaXMudHJhbnNwb3J0cyxlW25dKSYmdC5wdXNoKGVbbl0pO3JldHVybiB0fX0sZnVuY3Rpb24oZSx0KXt0cnl7ZS5leHBvcnRzPSJ1bmRlZmluZWQiIT10eXBlb2YgWE1MSHR0cFJlcXVlc3QmJiJ3aXRoQ3JlZGVudGlhbHMiaW4gbmV3IFhNTEh0dHBSZXF1ZXN0fWNhdGNoKHQpe2UuZXhwb3J0cz0hMX19LGZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1uKDQ3KSxvPW4oNTkpLGE9big0OSksaT1uKDQxKSxzPW4oMjcpKCJlbmdpbmUuaW8tY2xpZW50OnBvbGxpbmcteGhyIik7ZnVuY3Rpb24gbCgpe31mdW5jdGlvbiBjKGUpe2lmKG8uY2FsbCh0aGlzLGUpLHRoaXMucmVxdWVzdFRpbWVvdXQ9ZS5yZXF1ZXN0VGltZW91dCx0aGlzLmV4dHJhSGVhZGVycz1lLmV4dHJhSGVhZGVycywidW5kZWZpbmVkIiE9dHlwZW9mIGxvY2F0aW9uKXt2YXIgdD0iaHR0cHM6Ij09PWxvY2F0aW9uLnByb3RvY29sLG49bG9jYXRpb24ucG9ydDtufHwobj10PzQ0Mzo4MCksdGhpcy54ZD0idW5kZWZpbmVkIiE9dHlwZW9mIGxvY2F0aW9uJiZlLmhvc3RuYW1lIT09bG9jYXRpb24uaG9zdG5hbWV8fG4hPT1lLnBvcnQsdGhpcy54cz1lLnNlY3VyZSE9PXR9fWZ1bmN0aW9uIHUoZSl7dGhpcy5tZXRob2Q9ZS5tZXRob2R8fCJHRVQiLHRoaXMudXJpPWUudXJpLHRoaXMueGQ9ISFlLnhkLHRoaXMueHM9ISFlLnhzLHRoaXMuYXN5bmM9ITEhPT1lLmFzeW5jLHRoaXMuZGF0YT12b2lkIDAhPT1lLmRhdGE/ZS5kYXRhOm51bGwsdGhpcy5hZ2VudD1lLmFnZW50LHRoaXMuaXNCaW5hcnk9ZS5pc0JpbmFyeSx0aGlzLnN1cHBvcnRzQmluYXJ5PWUuc3VwcG9ydHNCaW5hcnksdGhpcy5lbmFibGVzWERSPWUuZW5hYmxlc1hEUix0aGlzLndpdGhDcmVkZW50aWFscz1lLndpdGhDcmVkZW50aWFscyx0aGlzLnJlcXVlc3RUaW1lb3V0PWUucmVxdWVzdFRpbWVvdXQsdGhpcy5wZng9ZS5wZngsdGhpcy5rZXk9ZS5rZXksdGhpcy5wYXNzcGhyYXNlPWUucGFzc3BocmFzZSx0aGlzLmNlcnQ9ZS5jZXJ0LHRoaXMuY2E9ZS5jYSx0aGlzLmNpcGhlcnM9ZS5jaXBoZXJzLHRoaXMucmVqZWN0VW5hdXRob3JpemVkPWUucmVqZWN0VW5hdXRob3JpemVkLHRoaXMuZXh0cmFIZWFkZXJzPWUuZXh0cmFIZWFkZXJzLHRoaXMuY3JlYXRlKCl9aWYoZS5leHBvcnRzPWMsZS5leHBvcnRzLlJlcXVlc3Q9dSxpKGMsbyksYy5wcm90b3R5cGUuc3VwcG9ydHNCaW5hcnk9ITAsYy5wcm90b3R5cGUucmVxdWVzdD1mdW5jdGlvbihlKXtyZXR1cm4oZT1lfHx7fSkudXJpPXRoaXMudXJpKCksZS54ZD10aGlzLnhkLGUueHM9dGhpcy54cyxlLmFnZW50PXRoaXMuYWdlbnR8fCExLGUuc3VwcG9ydHNCaW5hcnk9dGhpcy5zdXBwb3J0c0JpbmFyeSxlLmVuYWJsZXNYRFI9dGhpcy5lbmFibGVzWERSLGUud2l0aENyZWRlbnRpYWxzPXRoaXMud2l0aENyZWRlbnRpYWxzLGUucGZ4PXRoaXMucGZ4LGUua2V5PXRoaXMua2V5LGUucGFzc3BocmFzZT10aGlzLnBhc3NwaHJhc2UsZS5jZXJ0PXRoaXMuY2VydCxlLmNhPXRoaXMuY2EsZS5jaXBoZXJzPXRoaXMuY2lwaGVycyxlLnJlamVjdFVuYXV0aG9yaXplZD10aGlzLnJlamVjdFVuYXV0aG9yaXplZCxlLnJlcXVlc3RUaW1lb3V0PXRoaXMucmVxdWVzdFRpbWVvdXQsZS5leHRyYUhlYWRlcnM9dGhpcy5leHRyYUhlYWRlcnMsbmV3IHUoZSl9LGMucHJvdG90eXBlLmRvV3JpdGU9ZnVuY3Rpb24oZSx0KXt2YXIgbj0ic3RyaW5nIiE9dHlwZW9mIGUmJnZvaWQgMCE9PWUscj10aGlzLnJlcXVlc3Qoe21ldGhvZDoiUE9TVCIsZGF0YTplLGlzQmluYXJ5Om59KSxvPXRoaXM7ci5vbigic3VjY2VzcyIsdCksci5vbigiZXJyb3IiLChmdW5jdGlvbihlKXtvLm9uRXJyb3IoInhociBwb3N0IGVycm9yIixlKX0pKSx0aGlzLnNlbmRYaHI9cn0sYy5wcm90b3R5cGUuZG9Qb2xsPWZ1bmN0aW9uKCl7cygieGhyIHBvbGwiKTt2YXIgZT10aGlzLnJlcXVlc3QoKSx0PXRoaXM7ZS5vbigiZGF0YSIsKGZ1bmN0aW9uKGUpe3Qub25EYXRhKGUpfSkpLGUub24oImVycm9yIiwoZnVuY3Rpb24oZSl7dC5vbkVycm9yKCJ4aHIgcG9sbCBlcnJvciIsZSl9KSksdGhpcy5wb2xsWGhyPWV9LGEodS5wcm90b3R5cGUpLHUucHJvdG90eXBlLmNyZWF0ZT1mdW5jdGlvbigpe3ZhciBlPXthZ2VudDp0aGlzLmFnZW50LHhkb21haW46dGhpcy54ZCx4c2NoZW1lOnRoaXMueHMsZW5hYmxlc1hEUjp0aGlzLmVuYWJsZXNYRFJ9O2UucGZ4PXRoaXMucGZ4LGUua2V5PXRoaXMua2V5LGUucGFzc3BocmFzZT10aGlzLnBhc3NwaHJhc2UsZS5jZXJ0PXRoaXMuY2VydCxlLmNhPXRoaXMuY2EsZS5jaXBoZXJzPXRoaXMuY2lwaGVycyxlLnJlamVjdFVuYXV0aG9yaXplZD10aGlzLnJlamVjdFVuYXV0aG9yaXplZDt2YXIgdD10aGlzLnhocj1uZXcgcihlKSxuPXRoaXM7dHJ5e3MoInhociBvcGVuICVzOiAlcyIsdGhpcy5tZXRob2QsdGhpcy51cmkpLHQub3Blbih0aGlzLm1ldGhvZCx0aGlzLnVyaSx0aGlzLmFzeW5jKTt0cnl7aWYodGhpcy5leHRyYUhlYWRlcnMpZm9yKHZhciBvIGluIHQuc2V0RGlzYWJsZUhlYWRlckNoZWNrJiZ0LnNldERpc2FibGVIZWFkZXJDaGVjayghMCksdGhpcy5leHRyYUhlYWRlcnMpdGhpcy5leHRyYUhlYWRlcnMuaGFzT3duUHJvcGVydHkobykmJnQuc2V0UmVxdWVzdEhlYWRlcihvLHRoaXMuZXh0cmFIZWFkZXJzW29dKX1jYXRjaChlKXt9aWYoIlBPU1QiPT09dGhpcy5tZXRob2QpdHJ5e3RoaXMuaXNCaW5hcnk/dC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LXR5cGUiLCJhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0iKTp0LnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtdHlwZSIsInRleHQvcGxhaW47Y2hhcnNldD1VVEYtOCIpfWNhdGNoKGUpe310cnl7dC5zZXRSZXF1ZXN0SGVhZGVyKCJBY2NlcHQiLCIqLyoiKX1jYXRjaChlKXt9IndpdGhDcmVkZW50aWFscyJpbiB0JiYodC53aXRoQ3JlZGVudGlhbHM9dGhpcy53aXRoQ3JlZGVudGlhbHMpLHRoaXMucmVxdWVzdFRpbWVvdXQmJih0LnRpbWVvdXQ9dGhpcy5yZXF1ZXN0VGltZW91dCksdGhpcy5oYXNYRFIoKT8odC5vbmxvYWQ9ZnVuY3Rpb24oKXtuLm9uTG9hZCgpfSx0Lm9uZXJyb3I9ZnVuY3Rpb24oKXtuLm9uRXJyb3IodC5yZXNwb25zZVRleHQpfSk6dC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKXtpZigyPT09dC5yZWFkeVN0YXRlKXRyeXt2YXIgZT10LmdldFJlc3BvbnNlSGVhZGVyKCJDb250ZW50LVR5cGUiKTsobi5zdXBwb3J0c0JpbmFyeSYmImFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbSI9PT1lfHwiYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtOyBjaGFyc2V0PVVURi04Ij09PWUpJiYodC5yZXNwb25zZVR5cGU9ImFycmF5YnVmZmVyIil9Y2F0Y2goZSl7fTQ9PT10LnJlYWR5U3RhdGUmJigyMDA9PT10LnN0YXR1c3x8MTIyMz09PXQuc3RhdHVzP24ub25Mb2FkKCk6c2V0VGltZW91dCgoZnVuY3Rpb24oKXtuLm9uRXJyb3IoIm51bWJlciI9PXR5cGVvZiB0LnN0YXR1cz90LnN0YXR1czowKX0pLDApKX0scygieGhyIGRhdGEgJXMiLHRoaXMuZGF0YSksdC5zZW5kKHRoaXMuZGF0YSl9Y2F0Y2goZSl7cmV0dXJuIHZvaWQgc2V0VGltZW91dCgoZnVuY3Rpb24oKXtuLm9uRXJyb3IoZSl9KSwwKX0idW5kZWZpbmVkIiE9dHlwZW9mIGRvY3VtZW50JiYodGhpcy5pbmRleD11LnJlcXVlc3RzQ291bnQrKyx1LnJlcXVlc3RzW3RoaXMuaW5kZXhdPXRoaXMpfSx1LnByb3RvdHlwZS5vblN1Y2Nlc3M9ZnVuY3Rpb24oKXt0aGlzLmVtaXQoInN1Y2Nlc3MiKSx0aGlzLmNsZWFudXAoKX0sdS5wcm90b3R5cGUub25EYXRhPWZ1bmN0aW9uKGUpe3RoaXMuZW1pdCgiZGF0YSIsZSksdGhpcy5vblN1Y2Nlc3MoKX0sdS5wcm90b3R5cGUub25FcnJvcj1mdW5jdGlvbihlKXt0aGlzLmVtaXQoImVycm9yIixlKSx0aGlzLmNsZWFudXAoITApfSx1LnByb3RvdHlwZS5jbGVhbnVwPWZ1bmN0aW9uKGUpe2lmKHZvaWQgMCE9PXRoaXMueGhyJiZudWxsIT09dGhpcy54aHIpe2lmKHRoaXMuaGFzWERSKCk/dGhpcy54aHIub25sb2FkPXRoaXMueGhyLm9uZXJyb3I9bDp0aGlzLnhoci5vbnJlYWR5c3RhdGVjaGFuZ2U9bCxlKXRyeXt0aGlzLnhoci5hYm9ydCgpfWNhdGNoKGUpe30idW5kZWZpbmVkIiE9dHlwZW9mIGRvY3VtZW50JiZkZWxldGUgdS5yZXF1ZXN0c1t0aGlzLmluZGV4XSx0aGlzLnhocj1udWxsfX0sdS5wcm90b3R5cGUub25Mb2FkPWZ1bmN0aW9uKCl7dmFyIGU7dHJ5e3ZhciB0O3RyeXt0PXRoaXMueGhyLmdldFJlc3BvbnNlSGVhZGVyKCJDb250ZW50LVR5cGUiKX1jYXRjaChlKXt9ZT0oImFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbSI9PT10fHwiYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtOyBjaGFyc2V0PVVURi04Ij09PXQpJiZ0aGlzLnhoci5yZXNwb25zZXx8dGhpcy54aHIucmVzcG9uc2VUZXh0fWNhdGNoKGUpe3RoaXMub25FcnJvcihlKX1udWxsIT1lJiZ0aGlzLm9uRGF0YShlKX0sdS5wcm90b3R5cGUuaGFzWERSPWZ1bmN0aW9uKCl7cmV0dXJuInVuZGVmaW5lZCIhPXR5cGVvZiBYRG9tYWluUmVxdWVzdCYmIXRoaXMueHMmJnRoaXMuZW5hYmxlc1hEUn0sdS5wcm90b3R5cGUuYWJvcnQ9ZnVuY3Rpb24oKXt0aGlzLmNsZWFudXAoKX0sdS5yZXF1ZXN0c0NvdW50PTAsdS5yZXF1ZXN0cz17fSwidW5kZWZpbmVkIiE9dHlwZW9mIGRvY3VtZW50KWlmKCJmdW5jdGlvbiI9PXR5cGVvZiBhdHRhY2hFdmVudClhdHRhY2hFdmVudCgib251bmxvYWQiLHApO2Vsc2UgaWYoImZ1bmN0aW9uIj09dHlwZW9mIGFkZEV2ZW50TGlzdGVuZXIpe3ZhciBkPSJvbnBhZ2VoaWRlImluIHNlbGY/InBhZ2VoaWRlIjoidW5sb2FkIjthZGRFdmVudExpc3RlbmVyKGQscCwhMSl9ZnVuY3Rpb24gcCgpe2Zvcih2YXIgZSBpbiB1LnJlcXVlc3RzKXUucmVxdWVzdHMuaGFzT3duUHJvcGVydHkoZSkmJnUucmVxdWVzdHNbZV0uYWJvcnQoKX19LGZ1bmN0aW9uKGUsdCl7ZS5leHBvcnRzPU9iamVjdC5rZXlzfHxmdW5jdGlvbihlKXt2YXIgdD1bXSxuPU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7Zm9yKHZhciByIGluIGUpbi5jYWxsKGUscikmJnQucHVzaChyKTtyZXR1cm4gdH19LGZ1bmN0aW9uKGUsdCl7dmFyIG49e30udG9TdHJpbmc7ZS5leHBvcnRzPUFycmF5LmlzQXJyYXl8fGZ1bmN0aW9uKGUpe3JldHVybiJbb2JqZWN0IEFycmF5XSI9PW4uY2FsbChlKX19LGZ1bmN0aW9uKGUsdCl7ZS5leHBvcnRzPWZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1lLmJ5dGVMZW5ndGg7aWYodD10fHwwLG49bnx8cixlLnNsaWNlKXJldHVybiBlLnNsaWNlKHQsbik7aWYodDwwJiYodCs9ciksbjwwJiYobis9ciksbj5yJiYobj1yKSx0Pj1yfHx0Pj1ufHwwPT09cilyZXR1cm4gbmV3IEFycmF5QnVmZmVyKDApO2Zvcih2YXIgbz1uZXcgVWludDhBcnJheShlKSxhPW5ldyBVaW50OEFycmF5KG4tdCksaT10LHM9MDtpPG47aSsrLHMrKylhW3NdPW9baV07cmV0dXJuIGEuYnVmZmVyfX0sZnVuY3Rpb24oZSx0KXtmdW5jdGlvbiBuKCl7fWUuZXhwb3J0cz1mdW5jdGlvbihlLHQscil7dmFyIG89ITE7cmV0dXJuIHI9cnx8bixhLmNvdW50PWUsMD09PWU/dCgpOmE7ZnVuY3Rpb24gYShlLG4pe2lmKGEuY291bnQ8PTApdGhyb3cgbmV3IEVycm9yKCJhZnRlciBjYWxsZWQgdG9vIG1hbnkgdGltZXMiKTstLWEuY291bnQsZT8obz0hMCx0KGUpLHQ9cik6MCE9PWEuY291bnR8fG98fHQobnVsbCxuKX19fSxmdW5jdGlvbihlLHQpe3ZhciBuLHIsbyxhPVN0cmluZy5mcm9tQ2hhckNvZGU7ZnVuY3Rpb24gaShlKXtmb3IodmFyIHQsbixyPVtdLG89MCxhPWUubGVuZ3RoO288YTspKHQ9ZS5jaGFyQ29kZUF0KG8rKykpPj01NTI5NiYmdDw9NTYzMTkmJm88YT81NjMyMD09KDY0NTEyJihuPWUuY2hhckNvZGVBdChvKyspKSk/ci5wdXNoKCgoMTAyMyZ0KTw8MTApKygxMDIzJm4pKzY1NTM2KTooci5wdXNoKHQpLG8tLSk6ci5wdXNoKHQpO3JldHVybiByfWZ1bmN0aW9uIHMoZSx0KXtpZihlPj01NTI5NiYmZTw9NTczNDMpe2lmKHQpdGhyb3cgRXJyb3IoIkxvbmUgc3Vycm9nYXRlIFUrIitlLnRvU3RyaW5nKDE2KS50b1VwcGVyQ2FzZSgpKyIgaXMgbm90IGEgc2NhbGFyIHZhbHVlIik7cmV0dXJuITF9cmV0dXJuITB9ZnVuY3Rpb24gbChlLHQpe3JldHVybiBhKGU+PnQmNjN8MTI4KX1mdW5jdGlvbiBjKGUsdCl7aWYoMD09KDQyOTQ5NjcxNjgmZSkpcmV0dXJuIGEoZSk7dmFyIG49IiI7cmV0dXJuIDA9PSg0Mjk0OTY1MjQ4JmUpP249YShlPj42JjMxfDE5Mik6MD09KDQyOTQ5MDE3NjAmZSk/KHMoZSx0KXx8KGU9NjU1MzMpLG49YShlPj4xMiYxNXwyMjQpLG4rPWwoZSw2KSk6MD09KDQyOTI4NzAxNDQmZSkmJihuPWEoZT4+MTgmN3wyNDApLG4rPWwoZSwxMiksbis9bChlLDYpKSxuKz1hKDYzJmV8MTI4KX1mdW5jdGlvbiB1KCl7aWYobz49cil0aHJvdyBFcnJvcigiSW52YWxpZCBieXRlIGluZGV4Iik7dmFyIGU9MjU1Jm5bb107aWYobysrLDEyOD09KDE5MiZlKSlyZXR1cm4gNjMmZTt0aHJvdyBFcnJvcigiSW52YWxpZCBjb250aW51YXRpb24gYnl0ZSIpfWZ1bmN0aW9uIGQoZSl7dmFyIHQsYTtpZihvPnIpdGhyb3cgRXJyb3IoIkludmFsaWQgYnl0ZSBpbmRleCIpO2lmKG89PXIpcmV0dXJuITE7aWYodD0yNTUmbltvXSxvKyssMD09KDEyOCZ0KSlyZXR1cm4gdDtpZigxOTI9PSgyMjQmdCkpe2lmKChhPSgzMSZ0KTw8Nnx1KCkpPj0xMjgpcmV0dXJuIGE7dGhyb3cgRXJyb3IoIkludmFsaWQgY29udGludWF0aW9uIGJ5dGUiKX1pZigyMjQ9PSgyNDAmdCkpe2lmKChhPSgxNSZ0KTw8MTJ8dSgpPDw2fHUoKSk+PTIwNDgpcmV0dXJuIHMoYSxlKT9hOjY1NTMzO3Rocm93IEVycm9yKCJJbnZhbGlkIGNvbnRpbnVhdGlvbiBieXRlIil9aWYoMjQwPT0oMjQ4JnQpJiYoYT0oNyZ0KTw8MTh8dSgpPDwxMnx1KCk8PDZ8dSgpKT49NjU1MzYmJmE8PTExMTQxMTEpcmV0dXJuIGE7dGhyb3cgRXJyb3IoIkludmFsaWQgVVRGLTggZGV0ZWN0ZWQiKX1lLmV4cG9ydHM9e3ZlcnNpb246IjIuMS4yIixlbmNvZGU6ZnVuY3Rpb24oZSx0KXtmb3IodmFyIG49ITEhPT0odD10fHx7fSkuc3RyaWN0LHI9aShlKSxvPXIubGVuZ3RoLGE9LTEscz0iIjsrK2E8bzspcys9YyhyW2FdLG4pO3JldHVybiBzfSxkZWNvZGU6ZnVuY3Rpb24oZSx0KXt2YXIgcz0hMSE9PSh0PXR8fHt9KS5zdHJpY3Q7bj1pKGUpLHI9bi5sZW5ndGgsbz0wO2Zvcih2YXIgbCxjPVtdOyExIT09KGw9ZChzKSk7KWMucHVzaChsKTtyZXR1cm4gZnVuY3Rpb24oZSl7Zm9yKHZhciB0LG49ZS5sZW5ndGgscj0tMSxvPSIiOysrcjxuOykodD1lW3JdKT42NTUzNSYmKG8rPWEoKHQtPTY1NTM2KT4+PjEwJjEwMjN8NTUyOTYpLHQ9NTYzMjB8MTAyMyZ0KSxvKz1hKHQpO3JldHVybiBvfShjKX19fSxmdW5jdGlvbihlLHQpeyFmdW5jdGlvbigpeyJ1c2Ugc3RyaWN0Ijtmb3IodmFyIGU9IkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky8iLG49bmV3IFVpbnQ4QXJyYXkoMjU2KSxyPTA7cjxlLmxlbmd0aDtyKyspbltlLmNoYXJDb2RlQXQocildPXI7dC5lbmNvZGU9ZnVuY3Rpb24odCl7dmFyIG4scj1uZXcgVWludDhBcnJheSh0KSxvPXIubGVuZ3RoLGE9IiI7Zm9yKG49MDtuPG87bis9MylhKz1lW3Jbbl0+PjJdLGErPWVbKDMmcltuXSk8PDR8cltuKzFdPj40XSxhKz1lWygxNSZyW24rMV0pPDwyfHJbbisyXT4+Nl0sYSs9ZVs2MyZyW24rMl1dO3JldHVybiBvJTM9PTI/YT1hLnN1YnN0cmluZygwLGEubGVuZ3RoLTEpKyI9IjpvJTM9PTEmJihhPWEuc3Vic3RyaW5nKDAsYS5sZW5ndGgtMikrIj09IiksYX0sdC5kZWNvZGU9ZnVuY3Rpb24oZSl7dmFyIHQscixvLGEsaSxzPS43NSplLmxlbmd0aCxsPWUubGVuZ3RoLGM9MDsiPSI9PT1lW2UubGVuZ3RoLTFdJiYocy0tLCI9Ij09PWVbZS5sZW5ndGgtMl0mJnMtLSk7dmFyIHU9bmV3IEFycmF5QnVmZmVyKHMpLGQ9bmV3IFVpbnQ4QXJyYXkodSk7Zm9yKHQ9MDt0PGw7dCs9NClyPW5bZS5jaGFyQ29kZUF0KHQpXSxvPW5bZS5jaGFyQ29kZUF0KHQrMSldLGE9bltlLmNoYXJDb2RlQXQodCsyKV0saT1uW2UuY2hhckNvZGVBdCh0KzMpXSxkW2MrK109cjw8MnxvPj40LGRbYysrXT0oMTUmbyk8PDR8YT4+MixkW2MrK109KDMmYSk8PDZ8NjMmaTtyZXR1cm4gdX19KCl9LGZ1bmN0aW9uKGUsdCl7dmFyIG49dm9pZCAwIT09bj9uOiJ1bmRlZmluZWQiIT10eXBlb2YgV2ViS2l0QmxvYkJ1aWxkZXI/V2ViS2l0QmxvYkJ1aWxkZXI6InVuZGVmaW5lZCIhPXR5cGVvZiBNU0Jsb2JCdWlsZGVyP01TQmxvYkJ1aWxkZXI6InVuZGVmaW5lZCIhPXR5cGVvZiBNb3pCbG9iQnVpbGRlciYmTW96QmxvYkJ1aWxkZXIscj1mdW5jdGlvbigpe3RyeXtyZXR1cm4gMj09PW5ldyBCbG9iKFsiaGkiXSkuc2l6ZX1jYXRjaChlKXtyZXR1cm4hMX19KCksbz1yJiZmdW5jdGlvbigpe3RyeXtyZXR1cm4gMj09PW5ldyBCbG9iKFtuZXcgVWludDhBcnJheShbMSwyXSldKS5zaXplfWNhdGNoKGUpe3JldHVybiExfX0oKSxhPW4mJm4ucHJvdG90eXBlLmFwcGVuZCYmbi5wcm90b3R5cGUuZ2V0QmxvYjtmdW5jdGlvbiBpKGUpe3JldHVybiBlLm1hcCgoZnVuY3Rpb24oZSl7aWYoZS5idWZmZXIgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcil7dmFyIHQ9ZS5idWZmZXI7aWYoZS5ieXRlTGVuZ3RoIT09dC5ieXRlTGVuZ3RoKXt2YXIgbj1uZXcgVWludDhBcnJheShlLmJ5dGVMZW5ndGgpO24uc2V0KG5ldyBVaW50OEFycmF5KHQsZS5ieXRlT2Zmc2V0LGUuYnl0ZUxlbmd0aCkpLHQ9bi5idWZmZXJ9cmV0dXJuIHR9cmV0dXJuIGV9KSl9ZnVuY3Rpb24gcyhlLHQpe3Q9dHx8e307dmFyIHI9bmV3IG47cmV0dXJuIGkoZSkuZm9yRWFjaCgoZnVuY3Rpb24oZSl7ci5hcHBlbmQoZSl9KSksdC50eXBlP3IuZ2V0QmxvYih0LnR5cGUpOnIuZ2V0QmxvYigpfWZ1bmN0aW9uIGwoZSx0KXtyZXR1cm4gbmV3IEJsb2IoaShlKSx0fHx7fSl9InVuZGVmaW5lZCIhPXR5cGVvZiBCbG9iJiYocy5wcm90b3R5cGU9QmxvYi5wcm90b3R5cGUsbC5wcm90b3R5cGU9QmxvYi5wcm90b3R5cGUpLGUuZXhwb3J0cz1yP28/QmxvYjpsOmE/czp2b2lkIDB9LGZ1bmN0aW9uKGUsdCxuKXsoZnVuY3Rpb24odCl7dmFyIHI9big1OSksbz1uKDQxKTtlLmV4cG9ydHM9dTt2YXIgYSxpPS9cbi9nLHM9L1xcbi9nO2Z1bmN0aW9uIGwoKXt9ZnVuY3Rpb24gYygpe3JldHVybiJ1bmRlZmluZWQiIT10eXBlb2Ygc2VsZj9zZWxmOiJ1bmRlZmluZWQiIT10eXBlb2Ygd2luZG93P3dpbmRvdzp2b2lkIDAhPT10P3Q6e319ZnVuY3Rpb24gdShlKXtpZihyLmNhbGwodGhpcyxlKSx0aGlzLnF1ZXJ5PXRoaXMucXVlcnl8fHt9LCFhKXt2YXIgdD1jKCk7YT10Ll9fX2Vpbz10Ll9fX2Vpb3x8W119dGhpcy5pbmRleD1hLmxlbmd0aDt2YXIgbj10aGlzO2EucHVzaCgoZnVuY3Rpb24oZSl7bi5vbkRhdGEoZSl9KSksdGhpcy5xdWVyeS5qPXRoaXMuaW5kZXgsImZ1bmN0aW9uIj09dHlwZW9mIGFkZEV2ZW50TGlzdGVuZXImJmFkZEV2ZW50TGlzdGVuZXIoImJlZm9yZXVubG9hZCIsKGZ1bmN0aW9uKCl7bi5zY3JpcHQmJihuLnNjcmlwdC5vbmVycm9yPWwpfSksITEpfW8odSxyKSx1LnByb3RvdHlwZS5zdXBwb3J0c0JpbmFyeT0hMSx1LnByb3RvdHlwZS5kb0Nsb3NlPWZ1bmN0aW9uKCl7dGhpcy5zY3JpcHQmJih0aGlzLnNjcmlwdC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuc2NyaXB0KSx0aGlzLnNjcmlwdD1udWxsKSx0aGlzLmZvcm0mJih0aGlzLmZvcm0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLmZvcm0pLHRoaXMuZm9ybT1udWxsLHRoaXMuaWZyYW1lPW51bGwpLHIucHJvdG90eXBlLmRvQ2xvc2UuY2FsbCh0aGlzKX0sdS5wcm90b3R5cGUuZG9Qb2xsPWZ1bmN0aW9uKCl7dmFyIGU9dGhpcyx0PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInNjcmlwdCIpO3RoaXMuc2NyaXB0JiYodGhpcy5zY3JpcHQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLnNjcmlwdCksdGhpcy5zY3JpcHQ9bnVsbCksdC5hc3luYz0hMCx0LnNyYz10aGlzLnVyaSgpLHQub25lcnJvcj1mdW5jdGlvbih0KXtlLm9uRXJyb3IoImpzb25wIHBvbGwgZXJyb3IiLHQpfTt2YXIgbj1kb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgic2NyaXB0IilbMF07bj9uLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHQsbik6KGRvY3VtZW50LmhlYWR8fGRvY3VtZW50LmJvZHkpLmFwcGVuZENoaWxkKHQpLHRoaXMuc2NyaXB0PXQsInVuZGVmaW5lZCIhPXR5cGVvZiBuYXZpZ2F0b3ImJi9nZWNrby9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkmJnNldFRpbWVvdXQoKGZ1bmN0aW9uKCl7dmFyIGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiaWZyYW1lIik7ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlKSxkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGUpfSksMTAwKX0sdS5wcm90b3R5cGUuZG9Xcml0ZT1mdW5jdGlvbihlLHQpe3ZhciBuPXRoaXM7aWYoIXRoaXMuZm9ybSl7dmFyIHIsbz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJmb3JtIiksYT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ0ZXh0YXJlYSIpLGw9dGhpcy5pZnJhbWVJZD0iZWlvX2lmcmFtZV8iK3RoaXMuaW5kZXg7by5jbGFzc05hbWU9InNvY2tldGlvIixvLnN0eWxlLnBvc2l0aW9uPSJhYnNvbHV0ZSIsby5zdHlsZS50b3A9Ii0xMDAwcHgiLG8uc3R5bGUubGVmdD0iLTEwMDBweCIsby50YXJnZXQ9bCxvLm1ldGhvZD0iUE9TVCIsby5zZXRBdHRyaWJ1dGUoImFjY2VwdC1jaGFyc2V0IiwidXRmLTgiKSxhLm5hbWU9ImQiLG8uYXBwZW5kQ2hpbGQoYSksZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChvKSx0aGlzLmZvcm09byx0aGlzLmFyZWE9YX1mdW5jdGlvbiBjKCl7dSgpLHQoKX1mdW5jdGlvbiB1KCl7aWYobi5pZnJhbWUpdHJ5e24uZm9ybS5yZW1vdmVDaGlsZChuLmlmcmFtZSl9Y2F0Y2goZSl7bi5vbkVycm9yKCJqc29ucCBwb2xsaW5nIGlmcmFtZSByZW1vdmFsIGVycm9yIixlKX10cnl7dmFyIGU9JzxpZnJhbWUgc3JjPSJqYXZhc2NyaXB0OjAiIG5hbWU9Iicrbi5pZnJhbWVJZCsnIj4nO3I9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChlKX1jYXRjaChlKXsocj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpZnJhbWUiKSkubmFtZT1uLmlmcmFtZUlkLHIuc3JjPSJqYXZhc2NyaXB0OjAifXIuaWQ9bi5pZnJhbWVJZCxuLmZvcm0uYXBwZW5kQ2hpbGQociksbi5pZnJhbWU9cn10aGlzLmZvcm0uYWN0aW9uPXRoaXMudXJpKCksdSgpLGU9ZS5yZXBsYWNlKHMsIlxcXG4iKSx0aGlzLmFyZWEudmFsdWU9ZS5yZXBsYWNlKGksIlxcbiIpO3RyeXt0aGlzLmZvcm0uc3VibWl0KCl9Y2F0Y2goZSl7fXRoaXMuaWZyYW1lLmF0dGFjaEV2ZW50P3RoaXMuaWZyYW1lLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpeyJjb21wbGV0ZSI9PT1uLmlmcmFtZS5yZWFkeVN0YXRlJiZjKCl9OnRoaXMuaWZyYW1lLm9ubG9hZD1jfX0pLmNhbGwodGhpcyxuKDQ0KSl9LGZ1bmN0aW9uKGUsdCxuKXsoZnVuY3Rpb24odCl7dmFyIHIsbyxhPW4oNDgpLGk9bigzNCkscz1uKDQwKSxsPW4oNDEpLGM9big2MSksdT1uKDI3KSgiZW5naW5lLmlvLWNsaWVudDp3ZWJzb2NrZXQiKTtpZigidW5kZWZpbmVkIiE9dHlwZW9mIFdlYlNvY2tldD9yPVdlYlNvY2tldDoidW5kZWZpbmVkIiE9dHlwZW9mIHNlbGYmJihyPXNlbGYuV2ViU29ja2V0fHxzZWxmLk1veldlYlNvY2tldCksInVuZGVmaW5lZCI9PXR5cGVvZiB3aW5kb3cpdHJ5e289bigxNDIpfWNhdGNoKGUpe312YXIgZD1yfHxvO2Z1bmN0aW9uIHAoZSl7ZSYmZS5mb3JjZUJhc2U2NCYmKHRoaXMuc3VwcG9ydHNCaW5hcnk9ITEpLHRoaXMucGVyTWVzc2FnZURlZmxhdGU9ZS5wZXJNZXNzYWdlRGVmbGF0ZSx0aGlzLnVzaW5nQnJvd3NlcldlYlNvY2tldD1yJiYhZS5mb3JjZU5vZGUsdGhpcy5wcm90b2NvbHM9ZS5wcm90b2NvbHMsdGhpcy51c2luZ0Jyb3dzZXJXZWJTb2NrZXR8fChkPW8pLGEuY2FsbCh0aGlzLGUpfWUuZXhwb3J0cz1wLGwocCxhKSxwLnByb3RvdHlwZS5uYW1lPSJ3ZWJzb2NrZXQiLHAucHJvdG90eXBlLnN1cHBvcnRzQmluYXJ5PSEwLHAucHJvdG90eXBlLmRvT3Blbj1mdW5jdGlvbigpe2lmKHRoaXMuY2hlY2soKSl7dmFyIGU9dGhpcy51cmkoKSx0PXRoaXMucHJvdG9jb2xzLG49e2FnZW50OnRoaXMuYWdlbnQscGVyTWVzc2FnZURlZmxhdGU6dGhpcy5wZXJNZXNzYWdlRGVmbGF0ZX07bi5wZng9dGhpcy5wZngsbi5rZXk9dGhpcy5rZXksbi5wYXNzcGhyYXNlPXRoaXMucGFzc3BocmFzZSxuLmNlcnQ9dGhpcy5jZXJ0LG4uY2E9dGhpcy5jYSxuLmNpcGhlcnM9dGhpcy5jaXBoZXJzLG4ucmVqZWN0VW5hdXRob3JpemVkPXRoaXMucmVqZWN0VW5hdXRob3JpemVkLHRoaXMuZXh0cmFIZWFkZXJzJiYobi5oZWFkZXJzPXRoaXMuZXh0cmFIZWFkZXJzKSx0aGlzLmxvY2FsQWRkcmVzcyYmKG4ubG9jYWxBZGRyZXNzPXRoaXMubG9jYWxBZGRyZXNzKTt0cnl7dGhpcy53cz10aGlzLnVzaW5nQnJvd3NlcldlYlNvY2tldCYmIXRoaXMuaXNSZWFjdE5hdGl2ZT90P25ldyBkKGUsdCk6bmV3IGQoZSk6bmV3IGQoZSx0LG4pfWNhdGNoKGUpe3JldHVybiB0aGlzLmVtaXQoImVycm9yIixlKX12b2lkIDA9PT10aGlzLndzLmJpbmFyeVR5cGUmJih0aGlzLnN1cHBvcnRzQmluYXJ5PSExKSx0aGlzLndzLnN1cHBvcnRzJiZ0aGlzLndzLnN1cHBvcnRzLmJpbmFyeT8odGhpcy5zdXBwb3J0c0JpbmFyeT0hMCx0aGlzLndzLmJpbmFyeVR5cGU9Im5vZGVidWZmZXIiKTp0aGlzLndzLmJpbmFyeVR5cGU9ImFycmF5YnVmZmVyIix0aGlzLmFkZEV2ZW50TGlzdGVuZXJzKCl9fSxwLnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVycz1mdW5jdGlvbigpe3ZhciBlPXRoaXM7dGhpcy53cy5vbm9wZW49ZnVuY3Rpb24oKXtlLm9uT3BlbigpfSx0aGlzLndzLm9uY2xvc2U9ZnVuY3Rpb24oKXtlLm9uQ2xvc2UoKX0sdGhpcy53cy5vbm1lc3NhZ2U9ZnVuY3Rpb24odCl7ZS5vbkRhdGEodC5kYXRhKX0sdGhpcy53cy5vbmVycm9yPWZ1bmN0aW9uKHQpe2Uub25FcnJvcigid2Vic29ja2V0IGVycm9yIix0KX19LHAucHJvdG90eXBlLndyaXRlPWZ1bmN0aW9uKGUpe3ZhciBuPXRoaXM7dGhpcy53cml0YWJsZT0hMTtmb3IodmFyIHI9ZS5sZW5ndGgsbz0wLGE9cjtvPGE7bysrKSFmdW5jdGlvbihlKXtpLmVuY29kZVBhY2tldChlLG4uc3VwcG9ydHNCaW5hcnksKGZ1bmN0aW9uKG8pe2lmKCFuLnVzaW5nQnJvd3NlcldlYlNvY2tldCl7dmFyIGE9e307aWYoZS5vcHRpb25zJiYoYS5jb21wcmVzcz1lLm9wdGlvbnMuY29tcHJlc3MpLG4ucGVyTWVzc2FnZURlZmxhdGUpKCJzdHJpbmciPT10eXBlb2Ygbz90LmJ5dGVMZW5ndGgobyk6by5sZW5ndGgpPG4ucGVyTWVzc2FnZURlZmxhdGUudGhyZXNob2xkJiYoYS5jb21wcmVzcz0hMSl9dHJ5e24udXNpbmdCcm93c2VyV2ViU29ja2V0P24ud3Muc2VuZChvKTpuLndzLnNlbmQobyxhKX1jYXRjaChlKXt1KCJ3ZWJzb2NrZXQgY2xvc2VkIGJlZm9yZSBvbmNsb3NlIGV2ZW50Iil9LS1yfHxzKCl9KSl9KGVbb10pO2Z1bmN0aW9uIHMoKXtuLmVtaXQoImZsdXNoIiksc2V0VGltZW91dCgoZnVuY3Rpb24oKXtuLndyaXRhYmxlPSEwLG4uZW1pdCgiZHJhaW4iKX0pLDApfX0scC5wcm90b3R5cGUub25DbG9zZT1mdW5jdGlvbigpe2EucHJvdG90eXBlLm9uQ2xvc2UuY2FsbCh0aGlzKX0scC5wcm90b3R5cGUuZG9DbG9zZT1mdW5jdGlvbigpe3ZvaWQgMCE9PXRoaXMud3MmJnRoaXMud3MuY2xvc2UoKX0scC5wcm90b3R5cGUudXJpPWZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5xdWVyeXx8e30sdD10aGlzLnNlY3VyZT8id3NzIjoid3MiLG49IiI7cmV0dXJuIHRoaXMucG9ydCYmKCJ3c3MiPT09dCYmNDQzIT09TnVtYmVyKHRoaXMucG9ydCl8fCJ3cyI9PT10JiY4MCE9PU51bWJlcih0aGlzLnBvcnQpKSYmKG49IjoiK3RoaXMucG9ydCksdGhpcy50aW1lc3RhbXBSZXF1ZXN0cyYmKGVbdGhpcy50aW1lc3RhbXBQYXJhbV09YygpKSx0aGlzLnN1cHBvcnRzQmluYXJ5fHwoZS5iNjQ9MSksKGU9cy5lbmNvZGUoZSkpLmxlbmd0aCYmKGU9Ij8iK2UpLHQrIjovLyIrKC0xIT09dGhpcy5ob3N0bmFtZS5pbmRleE9mKCI6Iik/IlsiK3RoaXMuaG9zdG5hbWUrIl0iOnRoaXMuaG9zdG5hbWUpK24rdGhpcy5wYXRoK2V9LHAucHJvdG90eXBlLmNoZWNrPWZ1bmN0aW9uKCl7cmV0dXJuISghZHx8Il9faW5pdGlhbGl6ZSJpbiBkJiZ0aGlzLm5hbWU9PT1wLnByb3RvdHlwZS5uYW1lKX19KS5jYWxsKHRoaXMsbig0NikuQnVmZmVyKX0sZnVuY3Rpb24oZSx0KXt9LGZ1bmN0aW9uKGUsdCl7ZS5leHBvcnRzPWZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBuPVtdLHI9KHQ9dHx8MCl8fDA7cjxlLmxlbmd0aDtyKyspbltyLXRdPWVbcl07cmV0dXJuIG59fSxmdW5jdGlvbihlLHQpe2Z1bmN0aW9uIG4oZSl7ZT1lfHx7fSx0aGlzLm1zPWUubWlufHwxMDAsdGhpcy5tYXg9ZS5tYXh8fDFlNCx0aGlzLmZhY3Rvcj1lLmZhY3Rvcnx8Mix0aGlzLmppdHRlcj1lLmppdHRlcj4wJiZlLmppdHRlcjw9MT9lLmppdHRlcjowLHRoaXMuYXR0ZW1wdHM9MH1lLmV4cG9ydHM9bixuLnByb3RvdHlwZS5kdXJhdGlvbj1mdW5jdGlvbigpe3ZhciBlPXRoaXMubXMqTWF0aC5wb3codGhpcy5mYWN0b3IsdGhpcy5hdHRlbXB0cysrKTtpZih0aGlzLmppdHRlcil7dmFyIHQ9TWF0aC5yYW5kb20oKSxuPU1hdGguZmxvb3IodCp0aGlzLmppdHRlciplKTtlPTA9PSgxJk1hdGguZmxvb3IoMTAqdCkpP2UtbjplK259cmV0dXJuIDB8TWF0aC5taW4oZSx0aGlzLm1heCl9LG4ucHJvdG90eXBlLnJlc2V0PWZ1bmN0aW9uKCl7dGhpcy5hdHRlbXB0cz0wfSxuLnByb3RvdHlwZS5zZXRNaW49ZnVuY3Rpb24oZSl7dGhpcy5tcz1lfSxuLnByb3RvdHlwZS5zZXRNYXg9ZnVuY3Rpb24oZSl7dGhpcy5tYXg9ZX0sbi5wcm90b3R5cGUuc2V0Sml0dGVyPWZ1bmN0aW9uKGUpe3RoaXMuaml0dGVyPWV9fSxmdW5jdGlvbihlLHQsbil7InVzZSBzdHJpY3QiO24ucih0KTt2YXIgcixvPW4oMCksYT1uLm4obyksaT1mdW5jdGlvbigpe3JldHVybiBhLmEuY3JlYXRlRWxlbWVudCgiZGl2Iix7Y2xhc3NOYW1lOiJMb2FkaW5nTWVzc2FnZSJ9LGEuYS5jcmVhdGVFbGVtZW50KCJzcGFuIixudWxsLCJMb2FkaW5nIHNjZW5lLi4uIikpfSxzPW4oMSksbD0ocj1mdW5jdGlvbihlLHQpe3JldHVybihyPU9iamVjdC5zZXRQcm90b3R5cGVPZnx8e19fcHJvdG9fXzpbXX1pbnN0YW5jZW9mIEFycmF5JiZmdW5jdGlvbihlLHQpe2UuX19wcm90b19fPXR9fHxmdW5jdGlvbihlLHQpe2Zvcih2YXIgbiBpbiB0KXQuaGFzT3duUHJvcGVydHkobikmJihlW25dPXRbbl0pfSkoZSx0KX0sZnVuY3Rpb24oZSx0KXtmdW5jdGlvbiBuKCl7dGhpcy5jb25zdHJ1Y3Rvcj1lfXIoZSx0KSxlLnByb3RvdHlwZT1udWxsPT09dD9PYmplY3QuY3JlYXRlKHQpOihuLnByb3RvdHlwZT10LnByb3RvdHlwZSxuZXcgbil9KSxjPWZ1bmN0aW9uKGUsdCl7dmFyIG4scixvLGEsaT17bGFiZWw6MCxzZW50OmZ1bmN0aW9uKCl7aWYoMSZvWzBdKXRocm93IG9bMV07cmV0dXJuIG9bMV19LHRyeXM6W10sb3BzOltdfTtyZXR1cm4gYT17bmV4dDpzKDApLHRocm93OnMoMSkscmV0dXJuOnMoMil9LCJmdW5jdGlvbiI9PXR5cGVvZiBTeW1ib2wmJihhW1N5bWJvbC5pdGVyYXRvcl09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30pLGE7ZnVuY3Rpb24gcyhhKXtyZXR1cm4gZnVuY3Rpb24ocyl7cmV0dXJuIGZ1bmN0aW9uKGEpe2lmKG4pdGhyb3cgbmV3IFR5cGVFcnJvcigiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLiIpO2Zvcig7aTspdHJ5e2lmKG49MSxyJiYobz0yJmFbMF0/ci5yZXR1cm46YVswXT9yLnRocm93fHwoKG89ci5yZXR1cm4pJiZvLmNhbGwociksMCk6ci5uZXh0KSYmIShvPW8uY2FsbChyLGFbMV0pKS5kb25lKXJldHVybiBvO3N3aXRjaChyPTAsbyYmKGE9WzImYVswXSxvLnZhbHVlXSksYVswXSl7Y2FzZSAwOmNhc2UgMTpvPWE7YnJlYWs7Y2FzZSA0OnJldHVybiBpLmxhYmVsKysse3ZhbHVlOmFbMV0sZG9uZTohMX07Y2FzZSA1OmkubGFiZWwrKyxyPWFbMV0sYT1bMF07Y29udGludWU7Y2FzZSA3OmE9aS5vcHMucG9wKCksaS50cnlzLnBvcCgpO2NvbnRpbnVlO2RlZmF1bHQ6aWYoIShvPWkudHJ5cywobz1vLmxlbmd0aD4wJiZvW28ubGVuZ3RoLTFdKXx8NiE9PWFbMF0mJjIhPT1hWzBdKSl7aT0wO2NvbnRpbnVlfWlmKDM9PT1hWzBdJiYoIW98fGFbMV0+b1swXSYmYVsxXTxvWzNdKSl7aS5sYWJlbD1hWzFdO2JyZWFrfWlmKDY9PT1hWzBdJiZpLmxhYmVsPG9bMV0pe2kubGFiZWw9b1sxXSxvPWE7YnJlYWt9aWYobyYmaS5sYWJlbDxvWzJdKXtpLmxhYmVsPW9bMl0saS5vcHMucHVzaChhKTticmVha31vWzJdJiZpLm9wcy5wb3AoKSxpLnRyeXMucG9wKCk7Y29udGludWV9YT10LmNhbGwoZSxpKX1jYXRjaChlKXthPVs2LGVdLHI9MH1maW5hbGx5e249bz0wfWlmKDUmYVswXSl0aHJvdyBhWzFdO3JldHVybnt2YWx1ZTphWzBdP2FbMV06dm9pZCAwLGRvbmU6ITB9fShbYSxzXSl9fX07ZnVuY3Rpb24gdShlLHQsbixyLG8sYSxpKXt0cnl7dmFyIHM9ZVthXShpKSxsPXMudmFsdWV9Y2F0Y2goZSl7cmV0dXJuIHZvaWQgbihlKX1zLmRvbmU/dChsKTpQcm9taXNlLnJlc29sdmUobCkudGhlbihyLG8pfXZhciBkPWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQoKXtmb3IodmFyIHQ9W10sbj0wO248YXJndW1lbnRzLmxlbmd0aDtuKyspdFtuXT1hcmd1bWVudHNbbl07dmFyIHIsbz10aGlzO3JldHVybiByPW89ZS5hcHBseSh0aGlzLHQpfHx0aGlzLG8uc3RhdGU9e2lzTG9hZGluZzohMH0scn1yZXR1cm4gbCh0LGUpLHQucHJvdG90eXBlLmNvbXBvbmVudERpZE1vdW50PWZ1bmN0aW9uKCl7dmFyIGUsdD10aGlzO3JldHVybihlPWZ1bmN0aW9uKCl7cmV0dXJuIGModGhpcywoZnVuY3Rpb24oZSl7c3dpdGNoKGUubGFiZWwpe2Nhc2UgMDpyZXR1cm5bNCxPYmplY3Qocy5kKSgpXTtjYXNlIDE6cmV0dXJuIGUuc2VudCgpLHQuc2V0U3RhdGUoe2lzTG9hZGluZzohMX0pLFsyXX19KSl9LGZ1bmN0aW9uKCl7dmFyIHQ9dGhpcyxuPWFyZ3VtZW50cztyZXR1cm4gbmV3IFByb21pc2UoKGZ1bmN0aW9uKHIsbyl7dmFyIGE9ZS5hcHBseSh0LG4pO2Z1bmN0aW9uIGkoZSl7dShhLHIsbyxpLHMsIm5leHQiLGUpfWZ1bmN0aW9uIHMoZSl7dShhLHIsbyxpLHMsInRocm93IixlKX1pKHZvaWQgMCl9KSl9KSgpfSx0LnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zdGF0ZS5pc0xvYWRpbmc/YS5hLmNyZWF0ZUVsZW1lbnQoaSxudWxsKTp0aGlzLnByb3BzLmNoaWxkcmVufSx0fShhLmEuQ29tcG9uZW50KSxwPW4oMjMpLGg9bigyNCksZj1uKDQpLG09big2KSxnPW4oMTMpLGI9bigzKSx5PWZ1bmN0aW9uKGUsdCl7dmFyIG4scixvLGEsaT17bGFiZWw6MCxzZW50OmZ1bmN0aW9uKCl7aWYoMSZvWzBdKXRocm93IG9bMV07cmV0dXJuIG9bMV19LHRyeXM6W10sb3BzOltdfTtyZXR1cm4gYT17bmV4dDpzKDApLHRocm93OnMoMSkscmV0dXJuOnMoMil9LCJmdW5jdGlvbiI9PXR5cGVvZiBTeW1ib2wmJihhW1N5bWJvbC5pdGVyYXRvcl09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30pLGE7ZnVuY3Rpb24gcyhhKXtyZXR1cm4gZnVuY3Rpb24ocyl7cmV0dXJuIGZ1bmN0aW9uKGEpe2lmKG4pdGhyb3cgbmV3IFR5cGVFcnJvcigiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLiIpO2Zvcig7aTspdHJ5e2lmKG49MSxyJiYobz0yJmFbMF0/ci5yZXR1cm46YVswXT9yLnRocm93fHwoKG89ci5yZXR1cm4pJiZvLmNhbGwociksMCk6ci5uZXh0KSYmIShvPW8uY2FsbChyLGFbMV0pKS5kb25lKXJldHVybiBvO3N3aXRjaChyPTAsbyYmKGE9WzImYVswXSxvLnZhbHVlXSksYVswXSl7Y2FzZSAwOmNhc2UgMTpvPWE7YnJlYWs7Y2FzZSA0OnJldHVybiBpLmxhYmVsKysse3ZhbHVlOmFbMV0sZG9uZTohMX07Y2FzZSA1OmkubGFiZWwrKyxyPWFbMV0sYT1bMF07Y29udGludWU7Y2FzZSA3OmE9aS5vcHMucG9wKCksaS50cnlzLnBvcCgpO2NvbnRpbnVlO2RlZmF1bHQ6aWYoIShvPWkudHJ5cywobz1vLmxlbmd0aD4wJiZvW28ubGVuZ3RoLTFdKXx8NiE9PWFbMF0mJjIhPT1hWzBdKSl7aT0wO2NvbnRpbnVlfWlmKDM9PT1hWzBdJiYoIW98fGFbMV0+b1swXSYmYVsxXTxvWzNdKSl7aS5sYWJlbD1hWzFdO2JyZWFrfWlmKDY9PT1hWzBdJiZpLmxhYmVsPG9bMV0pe2kubGFiZWw9b1sxXSxvPWE7YnJlYWt9aWYobyYmaS5sYWJlbDxvWzJdKXtpLmxhYmVsPW9bMl0saS5vcHMucHVzaChhKTticmVha31vWzJdJiZpLm9wcy5wb3AoKSxpLnRyeXMucG9wKCk7Y29udGludWV9YT10LmNhbGwoZSxpKX1jYXRjaChlKXthPVs2LGVdLHI9MH1maW5hbGx5e249bz0wfWlmKDUmYVswXSl0aHJvdyBhWzFdO3JldHVybnt2YWx1ZTphWzBdP2FbMV06dm9pZCAwLGRvbmU6ITB9fShbYSxzXSl9fX07ZnVuY3Rpb24gdihlLHQsbixyLG8sYSxpKXt0cnl7dmFyIHM9ZVthXShpKSxsPXMudmFsdWV9Y2F0Y2goZSl7cmV0dXJuIHZvaWQgbihlKX1zLmRvbmU/dChsKTpQcm9taXNlLnJlc29sdmUobCkudGhlbihyLG8pfWZ1bmN0aW9uIGsoZSl7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIHQ9dGhpcyxuPWFyZ3VtZW50cztyZXR1cm4gbmV3IFByb21pc2UoKGZ1bmN0aW9uKHIsbyl7dmFyIGE9ZS5hcHBseSh0LG4pO2Z1bmN0aW9uIGkoZSl7dihhLHIsbyxpLHMsIm5leHQiLGUpfWZ1bmN0aW9uIHMoZSl7dihhLHIsbyxpLHMsInRocm93IixlKX1pKHZvaWQgMCl9KSl9fXZhciB3PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlKXt0aGlzLnNvY2tldD1udWxsLHRoaXMuc29ja2V0SW5pdGlhbGl6ZWQ9ITEsdGhpcy5yb29tSUQ9bnVsbCx0aGlzLnJvb21LZXk9bnVsbCx0aGlzLmFwcD1lfXJldHVybiBlLnByb3RvdHlwZS5vcGVuPWZ1bmN0aW9uKGUsdCxuKXt2YXIgcj10aGlzO3RoaXMuc29ja2V0PWUsdGhpcy5yb29tSUQ9dCx0aGlzLnJvb21LZXk9bix0aGlzLnNvY2tldC5vbigiaW5pdC1yb29tIiwoZnVuY3Rpb24oKXtyLnNvY2tldCYmci5zb2NrZXQuZW1pdCgiam9pbi1yb29tIixyLnJvb21JRCl9KSksdGhpcy5zb2NrZXQub24oIm5ldy11c2VyIixmdW5jdGlvbigpe3ZhciBlPWsoKGZ1bmN0aW9uKGUpe3JldHVybiB5KHRoaXMsKGZ1bmN0aW9uKGUpe3JldHVybiByLmFwcC5icm9hZGNhc3RTY2VuZShiLnMuSU5JVCwhMCksWzJdfSkpfSkpO3JldHVybiBmdW5jdGlvbih0KXtyZXR1cm4gZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fSgpKSx0aGlzLnNvY2tldC5vbigicm9vbS11c2VyLWNoYW5nZSIsKGZ1bmN0aW9uKGUpe3IuYXBwLnNldENvbGxhYm9yYXRvcnMoZSl9KSl9LGUucHJvdG90eXBlLmNsb3NlPWZ1bmN0aW9uKCl7dGhpcy5zb2NrZXQmJih0aGlzLnNvY2tldC5jbG9zZSgpLHRoaXMuc29ja2V0PW51bGwsdGhpcy5yb29tSUQ9bnVsbCx0aGlzLnJvb21LZXk9bnVsbCl9LGUucHJvdG90eXBlLmlzT3Blbj1mdW5jdGlvbigpe3JldHVybiEhKHRoaXMuc29ja2V0SW5pdGlhbGl6ZWQmJnRoaXMuc29ja2V0JiZ0aGlzLnJvb21JRCYmdGhpcy5yb29tS2V5KX0sZS5wcm90b3R5cGUuX2Jyb2FkY2FzdFNvY2tldERhdGE9ZnVuY3Rpb24oZSx0KXt2b2lkIDA9PT10JiYodD0hMSk7dmFyIG49dGhpcztyZXR1cm4gaygoZnVuY3Rpb24oKXt2YXIgcixvLGE7cmV0dXJuIHkodGhpcywoZnVuY3Rpb24oaSl7c3dpdGNoKGkubGFiZWwpe2Nhc2UgMDpyZXR1cm4gbi5pc09wZW4oKT8ocj1KU09OLnN0cmluZ2lmeShlKSxvPShuZXcgVGV4dEVuY29kZXIpLmVuY29kZShyKSxbNCxPYmplY3QoZy5jKShvLG4ucm9vbUtleSldKTpbMywyXTtjYXNlIDE6YT1pLnNlbnQoKSxuLnNvY2tldC5lbWl0KHQ/Yi5hLlNFUlZFUl9WT0xBVElMRTpiLmEuU0VSVkVSLG4ucm9vbUlELGEuZGF0YSxhLml2KSxpLmxhYmVsPTI7Y2FzZSAyOnJldHVyblsyXX19KSl9KSkoKX0sZX0oKSxTPW4oMzgpLEU9big5KSxPPW4oMiksQz1uKDUpLHg9big3KSxqPVt7aWNvbjphLmEuY3JlYXRlRWxlbWVudCgic3ZnIix7dmlld0JveDoiMCAwIDMyMCA1MTIiLGNsYXNzTmFtZToiIn0sYS5hLmNyZWF0ZUVsZW1lbnQoInBhdGgiLHtkOiJNMzAyLjE4OSAzMjkuMTI2SDE5Ni4xMDVsNTUuODMxIDEzNS45OTNjMy44ODkgOS40MjgtLjU1NSAxOS45OTktOS40NDQgMjMuOTk5bC00OS4xNjUgMjEuNDI3Yy05LjE2NSA0LTE5LjQ0My0uNTcxLTIzLjMzMi05LjcxNGwtNTMuMDUzLTEyOS4xMzYtODYuNjY0IDg5LjEzOEMxOC43MjkgNDcyLjcxIDAgNDYzLjU1NCAwIDQ0Ny45NzdWMTguMjk5QzAgMS44OTkgMTkuOTIxLTYuMDk2IDMwLjI3NyA1LjQ0M2wyODQuNDEyIDI5Mi41NDJjMTEuNDcyIDExLjE3OSAzLjAwNyAzMS4xNDEtMTIuNSAzMS4xNDF6In0pKSx2YWx1ZToic2VsZWN0aW9uIixrZXk6WyJ2IiwicyJdfSx7aWNvbjphLmEuY3JlYXRlRWxlbWVudCgic3ZnIix7dmlld0JveDoiMCAwIDQ0OCA1MTIifSxhLmEuY3JlYXRlRWxlbWVudCgicGF0aCIse2Q6Ik00MDAgMzJINDhDMjEuNSAzMiAwIDUzLjUgMCA4MHYzNTJjMCAyNi41IDIxLjUgNDggNDggNDhoMzUyYzI2LjUgMCA0OC0yMS41IDQ4LTQ4VjgwYzAtMjYuNS0yMS41LTQ4LTQ4LTQ4eiJ9KSksdmFsdWU6InJlY3RhbmdsZSIsa2V5OiJyIn0se2ljb246YS5hLmNyZWF0ZUVsZW1lbnQoInN2ZyIse3ZpZXdCb3g6IjAgMCAyMjMuNjQ2IDIyMy42NDYifSxhLmEuY3JlYXRlRWxlbWVudCgicGF0aCIse2Q6Ik0xMTEuODIzIDBMMTYuNjIyIDExMS44MjMgMTExLjgyMyAyMjMuNjQ2IDIwNy4wMjUgMTExLjgyM3oifSkpLHZhbHVlOiJkaWFtb25kIixrZXk6ImQifSx7aWNvbjphLmEuY3JlYXRlRWxlbWVudCgic3ZnIix7dmlld0JveDoiMCAwIDUxMiA1MTIifSxhLmEuY3JlYXRlRWxlbWVudCgicGF0aCIse2Q6Ik0yNTYgOEMxMTkgOCA4IDExOSA4IDI1NnMxMTEgMjQ4IDI0OCAyNDggMjQ4LTExMSAyNDgtMjQ4UzM5MyA4IDI1NiA4eiJ9KSksdmFsdWU6ImVsbGlwc2UiLGtleToiZSJ9LHtpY29uOmEuYS5jcmVhdGVFbGVtZW50KCJzdmciLHt2aWV3Qm94OiIwIDAgNDQ4IDUxMiIsY2xhc3NOYW1lOiJydGwtbWlycm9yIn0sYS5hLmNyZWF0ZUVsZW1lbnQoInBhdGgiLHtkOiJNMzEzLjk0MSAyMTZIMTJjLTYuNjI3IDAtMTIgNS4zNzMtMTIgMTJ2NTZjMCA2LjYyNyA1LjM3MyAxMiAxMiAxMmgzMDEuOTQxdjQ2LjA1OWMwIDIxLjM4MiAyNS44NTEgMzIuMDkgNDAuOTcxIDE2Ljk3MWw4Ni4wNTktODYuMDU5YzkuMzczLTkuMzczIDkuMzczLTI0LjU2OSAwLTMzLjk0MWwtODYuMDU5LTg2LjA1OWMtMTUuMTE5LTE1LjExOS00MC45NzEtNC40MTEtNDAuOTcxIDE2Ljk3MVYyMTZ6In0pKSx2YWx1ZToiYXJyb3ciLGtleToiYSJ9LHtpY29uOmEuYS5jcmVhdGVFbGVtZW50KCJzdmciLHt2aWV3Qm94OiIwIDAgNiA2In0sYS5hLmNyZWF0ZUVsZW1lbnQoImxpbmUiLHt4MToiMCIseTE6IjMiLHgyOiI2Iix5MjoiMyIsc3Ryb2tlOnguYmxhY2ssc3Ryb2tlTGluZWNhcDoicm91bmQifSkpLHZhbHVlOiJsaW5lIixrZXk6WyJwIiwibCJdfSx7aWNvbjphLmEuY3JlYXRlRWxlbWVudCgic3ZnIix7dmlld0JveDoiMCAwIDUxMiA1MTIifSxhLmEuY3JlYXRlRWxlbWVudCgicGF0aCIse2ZpbGw6ImN1cnJlbnRDb2xvciIsZDoiTTI5MC43NCA5My4yNGwxMjguMDIgMTI4LjAyLTI3Ny45OSAyNzcuOTktMTE0LjE0IDEyLjZDMTEuMzUgNTEzLjU0LTEuNTYgNTAwLjYyLjE0IDQ4NS4zNGwxMi43LTExNC4yMiAyNzcuOS0yNzcuODh6bTIwNy4yLTE5LjA2bC02MC4xMS02MC4xMWMtMTguNzUtMTguNzUtNDkuMTYtMTguNzUtNjcuOTEgMGwtNTYuNTUgNTYuNTUgMTI4LjAyIDEyOC4wMiA1Ni41NS01Ni41NWMxOC43NS0xOC43NiAxOC43NS00OS4xNiAwLTY3LjkxeiJ9KSksdmFsdWU6ImRyYXciLGtleTpbIlAiLCJ4Il19LHtpY29uOmEuYS5jcmVhdGVFbGVtZW50KCJzdmciLHt2aWV3Qm94OiIwIDAgNDQ4IDUxMiJ9LGEuYS5jcmVhdGVFbGVtZW50KCJwYXRoIix7ZDoiTTQzMiA0MTZoLTIzLjQxTDI3Ny44OCA1My42OUEzMiAzMiAwIDAgMCAyNDcuNTggMzJoLTQ3LjE2YTMyIDMyIDAgMCAwLTMwLjMgMjEuNjlMMzkuNDEgNDE2SDE2YTE2IDE2IDAgMCAwLTE2IDE2djMyYTE2IDE2IDAgMCAwIDE2IDE2aDEyOGExNiAxNiAwIDAgMCAxNi0xNnYtMzJhMTYgMTYgMCAwIDAtMTYtMTZoLTE5LjU4bDIzLjMtNjRoMTUyLjU2bDIzLjMgNjRIMzA0YTE2IDE2IDAgMCAwLTE2IDE2djMyYTE2IDE2IDAgMCAwIDE2IDE2aDEyOGExNiAxNiAwIDAgMCAxNi0xNnYtMzJhMTYgMTYgMCAwIDAtMTYtMTZ6TTE3Ni44NSAyNzJMMjI0IDE0Mi41MSAyNzEuMTUgMjcyeiJ9KSksdmFsdWU6InRleHQiLGtleToidCJ9XSxUPW4oMTEpLFA9bigyMSk7ZnVuY3Rpb24gQShlLHQpe3ZhciBuPU9iamVjdC5rZXlzKGUpO2lmKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpe3ZhciByPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7dCYmKHI9ci5maWx0ZXIoKGZ1bmN0aW9uKHQpe3JldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGUsdCkuZW51bWVyYWJsZX0pKSksbi5wdXNoLmFwcGx5KG4scil9cmV0dXJuIG59ZnVuY3Rpb24gTShlKXtmb3IodmFyIHQ9MTt0PGFyZ3VtZW50cy5sZW5ndGg7dCsrKXt2YXIgbj1udWxsIT1hcmd1bWVudHNbdF0/YXJndW1lbnRzW3RdOnt9O3QlMj9BKE9iamVjdChuKSwhMCkuZm9yRWFjaCgoZnVuY3Rpb24odCl7XyhlLHQsblt0XSl9KSk6T2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnM/T2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZSxPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhuKSk6QShPYmplY3QobikpLmZvckVhY2goKGZ1bmN0aW9uKHQpe09iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHQsT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihuLHQpKX0pKX1yZXR1cm4gZX1mdW5jdGlvbiBfKGUsdCxuKXtyZXR1cm4gdCBpbiBlP09iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHQse3ZhbHVlOm4sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITAsd3JpdGFibGU6ITB9KTplW3RdPW4sZX12YXIgeixMPWZ1bmN0aW9uKGUpe3JldHVybntzZWxlY3RlZEVsZW1lbnRJZHM6ZS5zZWxlY3RlZEVsZW1lbnRJZHMsdmlld0JhY2tncm91bmRDb2xvcjplLnZpZXdCYWNrZ3JvdW5kQ29sb3IsZWRpdGluZ0xpbmVhckVsZW1lbnQ6ZS5lZGl0aW5nTGluZWFyRWxlbWVudCxlZGl0aW5nR3JvdXBJZDplLmVkaXRpbmdHcm91cElkLG5hbWU6ZS5uYW1lfX0sST1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoKXt2YXIgZT10aGlzO3RoaXMuZWxlbWVudENhY2hlPW5ldyBNYXAsdGhpcy5yZWNvcmRpbmc9ITAsdGhpcy5zdGF0ZUhpc3Rvcnk9W10sdGhpcy5yZWRvU3RhY2s9W10sdGhpcy5sYXN0RW50cnk9bnVsbCx0aGlzLmdlbmVyYXRlRW50cnk9ZnVuY3Rpb24odCxuKXtyZXR1cm4gZS5kZWh5ZHJhdGVIaXN0b3J5RW50cnkoe2FwcFN0YXRlOkwodCksZWxlbWVudHM6bi5yZWR1Y2UoKGZ1bmN0aW9uKGUsbil7aWYoT2JqZWN0KFQuYikobikmJnQubXVsdGlFbGVtZW50JiZ0Lm11bHRpRWxlbWVudC5pZD09PW4uaWQpe2lmKHQubXVsdGlFbGVtZW50JiZ0Lm11bHRpRWxlbWVudC5pZD09PW4uaWQmJm4ucG9pbnRzLmxlbmd0aDwyKXJldHVybiBlO2UucHVzaChNKE0oe30sbikse30se3BvaW50czpuLmxhc3RDb21taXR0ZWRQb2ludCE9PW4ucG9pbnRzW24ucG9pbnRzLmxlbmd0aC0xXT9uLnBvaW50cy5zbGljZSgwLC0xKTpuLnBvaW50c30pKX1lbHNlIGUucHVzaChuKTtyZXR1cm4gZX0pLFtdKX0pfX1yZXR1cm4gZS5wcm90b3R5cGUuaHlkcmF0ZUhpc3RvcnlFbnRyeT1mdW5jdGlvbihlKXt2YXIgdD1lLmFwcFN0YXRlLG49ZS5lbGVtZW50cyxyPXRoaXM7cmV0dXJue2FwcFN0YXRlOkpTT04ucGFyc2UodCksZWxlbWVudHM6bi5tYXAoKGZ1bmN0aW9uKGUpe3ZhciB0LG49bnVsbD09PSh0PXIuZWxlbWVudENhY2hlLmdldChlLmlkKSl8fHZvaWQgMD09PXQ/dm9pZCAwOnQuZ2V0KGUudmVyc2lvbk5vbmNlKTtpZighbil0aHJvdyBuZXcgRXJyb3IoIkVsZW1lbnQgbm90IGZvdW5kOiAiLmNvbmNhdChlLmlkLCI6IikuY29uY2F0KGUudmVyc2lvbk5vbmNlKSk7cmV0dXJuIG59KSl9fSxlLnByb3RvdHlwZS5kZWh5ZHJhdGVIaXN0b3J5RW50cnk9ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5hcHBTdGF0ZSxuPWUuZWxlbWVudHMscj10aGlzO3JldHVybnthcHBTdGF0ZTpKU09OLnN0cmluZ2lmeSh0KSxlbGVtZW50czpuLm1hcCgoZnVuY3Rpb24oZSl7ci5lbGVtZW50Q2FjaGUuaGFzKGUuaWQpfHxyLmVsZW1lbnRDYWNoZS5zZXQoZS5pZCxuZXcgTWFwKTt2YXIgdD1yLmVsZW1lbnRDYWNoZS5nZXQoZS5pZCk7cmV0dXJuIHQuaGFzKGUudmVyc2lvbk5vbmNlKXx8dC5zZXQoZS52ZXJzaW9uTm9uY2UsT2JqZWN0KFAuYSkoZSkpLHtpZDplLmlkLHZlcnNpb25Ob25jZTplLnZlcnNpb25Ob25jZX19KSl9fSxlLnByb3RvdHlwZS5nZXRTbmFwc2hvdEZvclRlc3Q9ZnVuY3Rpb24oKXt2YXIgZT10aGlzO3JldHVybntyZWNvcmRpbmc6dGhpcy5yZWNvcmRpbmcsc3RhdGVIaXN0b3J5OnRoaXMuc3RhdGVIaXN0b3J5Lm1hcCgoZnVuY3Rpb24odCl7cmV0dXJuIGUuaHlkcmF0ZUhpc3RvcnlFbnRyeSh0KX0pKSxyZWRvU3RhY2s6dGhpcy5yZWRvU3RhY2subWFwKChmdW5jdGlvbih0KXtyZXR1cm4gZS5oeWRyYXRlSGlzdG9yeUVudHJ5KHQpfSkpfX0sZS5wcm90b3R5cGUuY2xlYXI9ZnVuY3Rpb24oKXt0aGlzLnN0YXRlSGlzdG9yeS5sZW5ndGg9MCx0aGlzLnJlZG9TdGFjay5sZW5ndGg9MCx0aGlzLmxhc3RFbnRyeT1udWxsLHRoaXMuZWxlbWVudENhY2hlLmNsZWFyKCl9LGUucHJvdG90eXBlLnNob3VsZENyZWF0ZUVudHJ5PWZ1bmN0aW9uKGUpe3ZhciB0LG49dGhpcy5sYXN0RW50cnk7aWYoIW4pcmV0dXJuITA7aWYoZS5lbGVtZW50cy5sZW5ndGghPT1uLmVsZW1lbnRzLmxlbmd0aClyZXR1cm4hMDtmb3IodmFyIHI9ZS5lbGVtZW50cy5sZW5ndGgtMTtyPi0xO3ItLSl7dmFyIG89ZS5lbGVtZW50c1tyXSxhPW4uZWxlbWVudHNbcl07aWYoIW98fCFhfHxvLmlkIT09YS5pZHx8by52ZXJzaW9uTm9uY2UhPT1hLnZlcnNpb25Ob25jZSlyZXR1cm4hMH1mb3IodCBpbiBlLmFwcFN0YXRlKXt2YXIgaSxzO2lmKCJlZGl0aW5nTGluZWFyRWxlbWVudCI9PT10KWlmKChudWxsPT09KGk9ZS5hcHBTdGF0ZVt0XSl8fHZvaWQgMD09PWk/dm9pZCAwOmkuZWxlbWVudElkKT09PShudWxsPT09KHM9bi5hcHBTdGF0ZVt0XSl8fHZvaWQgMD09PXM/dm9pZCAwOnMuZWxlbWVudElkKSljb250aW51ZTtpZigic2VsZWN0ZWRFbGVtZW50SWRzIiE9PXQmJmUuYXBwU3RhdGVbdF0hPT1uLmFwcFN0YXRlW3RdKXJldHVybiEwfXJldHVybiExfSxlLnByb3RvdHlwZS5wdXNoRW50cnk9ZnVuY3Rpb24oZSx0KXt2YXIgbj10aGlzLmdlbmVyYXRlRW50cnkoZSx0KSxyPXRoaXMuaHlkcmF0ZUhpc3RvcnlFbnRyeShuKTtpZihyKXtpZighdGhpcy5zaG91bGRDcmVhdGVFbnRyeShyKSlyZXR1cm47dGhpcy5zdGF0ZUhpc3RvcnkucHVzaChuKSx0aGlzLmxhc3RFbnRyeT1yLHRoaXMuY2xlYXJSZWRvU3RhY2soKX19LGUucHJvdG90eXBlLmNsZWFyUmVkb1N0YWNrPWZ1bmN0aW9uKCl7dGhpcy5yZWRvU3RhY2suc3BsaWNlKDAsdGhpcy5yZWRvU3RhY2subGVuZ3RoKX0sZS5wcm90b3R5cGUucmVkb09uY2U9ZnVuY3Rpb24oKXtpZigwPT09dGhpcy5yZWRvU3RhY2subGVuZ3RoKXJldHVybiBudWxsO3ZhciBlPXRoaXMucmVkb1N0YWNrLnBvcCgpO3JldHVybiB2b2lkIDAhPT1lPyh0aGlzLnN0YXRlSGlzdG9yeS5wdXNoKGUpLHRoaXMuaHlkcmF0ZUhpc3RvcnlFbnRyeShlKSk6bnVsbH0sZS5wcm90b3R5cGUudW5kb09uY2U9ZnVuY3Rpb24oKXtpZigxPT09dGhpcy5zdGF0ZUhpc3RvcnkubGVuZ3RoKXJldHVybiBudWxsO3ZhciBlPXRoaXMuc3RhdGVIaXN0b3J5LnBvcCgpLHQ9dGhpcy5zdGF0ZUhpc3RvcnlbdGhpcy5zdGF0ZUhpc3RvcnkubGVuZ3RoLTFdO3JldHVybiB2b2lkIDAhPT1lPyh0aGlzLnJlZG9TdGFjay5wdXNoKGUpLHRoaXMuaHlkcmF0ZUhpc3RvcnlFbnRyeSh0KSk6bnVsbH0sZS5wcm90b3R5cGUuc2V0Q3VycmVudFN0YXRlPWZ1bmN0aW9uKGUsdCl7dGhpcy5sYXN0RW50cnk9dGhpcy5oeWRyYXRlSGlzdG9yeUVudHJ5KHRoaXMuZ2VuZXJhdGVFbnRyeShlLHQpKX0sZS5wcm90b3R5cGUucmVzdW1lUmVjb3JkaW5nPWZ1bmN0aW9uKCl7dGhpcy5yZWNvcmRpbmc9ITB9LGUucHJvdG90eXBlLnJlY29yZD1mdW5jdGlvbihlLHQpe3RoaXMucmVjb3JkaW5nJiYodGhpcy5wdXNoRW50cnkoZSx0KSx0aGlzLnJlY29yZGluZz0hMSl9LGV9KCksRD0obig2OSksbigyNikpLE49ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5jaGlsZHJlbixuPWUubGVmdCxyPWUudG9wLGk9ZS5vbkNsb3NlUmVxdWVzdCxzPWUuZml0SW5WaWV3cG9ydCxsPXZvaWQgMCE9PXMmJnMsYz1PYmplY3Qoby51c2VSZWYpKG51bGwpO3JldHVybiBPYmplY3Qoby51c2VMYXlvdXRFZmZlY3QpKChmdW5jdGlvbigpe2lmKGwmJmMuY3VycmVudCl7dmFyIGU9Yy5jdXJyZW50LHQ9ZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxuPXQueCxyPXQueSxvPXQud2lkdGgsYT10LmhlaWdodCxpPXdpbmRvdy5pbm5lcldpZHRoO24rbz5pJiYoZS5zdHlsZS5sZWZ0PSIiLmNvbmNhdChpLW8sInB4IikpO3ZhciBzPXdpbmRvdy5pbm5lckhlaWdodDtyK2E+cyYmKGUuc3R5bGUudG9wPSIiLmNvbmNhdChzLWEsInB4IikpfX0pLFtsXSksT2JqZWN0KG8udXNlRWZmZWN0KSgoZnVuY3Rpb24oKXtpZihpKXt2YXIgZT1mdW5jdGlvbihlKXt2YXIgdDsobnVsbD09PSh0PWMuY3VycmVudCl8fHZvaWQgMD09PXQ/dm9pZCAwOnQuY29udGFpbnMoZS50YXJnZXQpKXx8T2JqZWN0KEQudW5zdGFibGVfYmF0Y2hlZFVwZGF0ZXMpKChmdW5jdGlvbigpe3JldHVybiBpKGUpfSkpfTtyZXR1cm4gZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigicG9pbnRlcmRvd24iLGUsITEpLGZ1bmN0aW9uKCl7cmV0dXJuIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoInBvaW50ZXJkb3duIixlLCExKX19fSksW2ldKSxhLmEuY3JlYXRlRWxlbWVudCgiZGl2Iix7Y2xhc3NOYW1lOiJwb3BvdmVyIixzdHlsZTp7dG9wOnIsbGVmdDpufSxyZWY6Y30sdCl9LEY9KG4oNzApLGZ1bmN0aW9uKGUpe3ZhciB0PWUub3B0aW9ucyxuPWUub25DbG9zZVJlcXVlc3Qscj1lLnRvcCxvPWUubGVmdDtyZXR1cm4gYS5hLmNyZWF0ZUVsZW1lbnQoTix7b25DbG9zZVJlcXVlc3Q6bix0b3A6cixsZWZ0Om8sZml0SW5WaWV3cG9ydDohMH0sYS5hLmNyZWF0ZUVsZW1lbnQoInVsIix7Y2xhc3NOYW1lOiJjb250ZXh0LW1lbnUiLG9uQ29udGV4dE1lbnU6ZnVuY3Rpb24oZSl7cmV0dXJuIGUucHJldmVudERlZmF1bHQoKX19LHQubWFwKChmdW5jdGlvbihlLHQpe3JldHVybiBhLmEuY3JlYXRlRWxlbWVudCgibGkiLHtrZXk6dCxvbkNsaWNrOm59LGEuYS5jcmVhdGVFbGVtZW50KFIsZSkpfSkpKSl9KSxSPWZ1bmN0aW9uKGUpe3ZhciB0PWUubGFiZWwsbj1lLmFjdGlvbjtyZXR1cm4gYS5hLmNyZWF0ZUVsZW1lbnQoImJ1dHRvbiIse2NsYXNzTmFtZToiY29udGV4dC1tZW51LW9wdGlvbiIsb25DbGljazpufSx0KX0sQj1mdW5jdGlvbigpe2lmKHopcmV0dXJuIHo7dmFyIGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7cmV0dXJuIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZSksej1lfSxIPWZ1bmN0aW9uKCl7T2JqZWN0KEQudW5tb3VudENvbXBvbmVudEF0Tm9kZSkoQigpKX0sRz1mdW5jdGlvbihlKXt2YXIgdD1BcnJheS5vZigpO2Uub3B0aW9ucy5mb3JFYWNoKChmdW5jdGlvbihlKXtlJiZ0LnB1c2goZSl9KSksdC5sZW5ndGgmJk9iamVjdChELnJlbmRlcikoYS5hLmNyZWF0ZUVsZW1lbnQoRix7dG9wOmUudG9wLGxlZnQ6ZS5sZWZ0LG9wdGlvbnM6dCxvbkNsb3NlUmVxdWVzdDpIfSksQigpKX0sVz1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSx0LG4pe3ZhciByPXRoaXM7dGhpcy5hY3Rpb25zPXt9LHRoaXMucmVuZGVyQWN0aW9uPWZ1bmN0aW9uKGUsdCl7aWYoci5hY3Rpb25zW2VdJiYiUGFuZWxDb21wb25lbnQiaW4gci5hY3Rpb25zW2VdKXt2YXIgbj1yLmFjdGlvbnNbZV0sbz1uLlBhbmVsQ29tcG9uZW50O3JldHVybiBhLmEuY3JlYXRlRWxlbWVudChvLHtlbGVtZW50czpyLmdldEVsZW1lbnRzSW5jbHVkaW5nRGVsZXRlZCgpLGFwcFN0YXRlOnIuZ2V0QXBwU3RhdGUoKSx1cGRhdGVEYXRhOmZ1bmN0aW9uKGUpe3IudXBkYXRlcihuLnBlcmZvcm0oci5nZXRFbGVtZW50c0luY2x1ZGluZ0RlbGV0ZWQoKSxyLmdldEFwcFN0YXRlKCksZSkpfSxpZDp0fSl9cmV0dXJuIG51bGx9LHRoaXMudXBkYXRlcj1lLHRoaXMuZ2V0QXBwU3RhdGU9dCx0aGlzLmdldEVsZW1lbnRzSW5jbHVkaW5nRGVsZXRlZD1ufXJldHVybiBlLnByb3RvdHlwZS5yZWdpc3RlckFjdGlvbj1mdW5jdGlvbihlKXt0aGlzLmFjdGlvbnNbZS5uYW1lXT1lfSxlLnByb3RvdHlwZS5yZWdpc3RlckFsbD1mdW5jdGlvbihlKXt2YXIgdD10aGlzO2UuZm9yRWFjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIHQucmVnaXN0ZXJBY3Rpb24oZSl9KSl9LGUucHJvdG90eXBlLmhhbmRsZUtleURvd249ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxuPU9iamVjdC52YWx1ZXModGhpcy5hY3Rpb25zKS5zb3J0KChmdW5jdGlvbihlLHQpe3JldHVybih0LmtleVByaW9yaXR5fHwwKS0oZS5rZXlQcmlvcml0eXx8MCl9KSkuZmlsdGVyKChmdW5jdGlvbihuKXtyZXR1cm4gbi5rZXlUZXN0JiZuLmtleVRlc3QoZSx0LmdldEFwcFN0YXRlKCksdC5nZXRFbGVtZW50c0luY2x1ZGluZ0RlbGV0ZWQoKSl9KSk7cmV0dXJuIDAhPT1uLmxlbmd0aCYmKGUucHJldmVudERlZmF1bHQoKSx0aGlzLnVwZGF0ZXIoblswXS5wZXJmb3JtKHRoaXMuZ2V0RWxlbWVudHNJbmNsdWRpbmdEZWxldGVkKCksdGhpcy5nZXRBcHBTdGF0ZSgpLG51bGwpKSwhMCl9LGUucHJvdG90eXBlLmV4ZWN1dGVBY3Rpb249ZnVuY3Rpb24oZSl7dGhpcy51cGRhdGVyKGUucGVyZm9ybSh0aGlzLmdldEVsZW1lbnRzSW5jbHVkaW5nRGVsZXRlZCgpLHRoaXMuZ2V0QXBwU3RhdGUoKSxudWxsKSl9LGUucHJvdG90eXBlLmdldENvbnRleHRNZW51SXRlbXM9ZnVuY3Rpb24oZSl7dm9pZCAwPT09ZSYmKGU9ZnVuY3Rpb24oZSl7cmV0dXJuIGV9KTt2YXIgdD10aGlzO3JldHVybiBPYmplY3QudmFsdWVzKHRoaXMuYWN0aW9ucykuZmlsdGVyKGUpLmZpbHRlcigoZnVuY3Rpb24oZSl7cmV0dXJuImNvbnRleHRJdGVtTGFiZWwiaW4gZX0pKS5maWx0ZXIoKGZ1bmN0aW9uKGUpe3JldHVybiFlLmNvbnRleHRJdGVtUHJlZGljYXRlfHxlLmNvbnRleHRJdGVtUHJlZGljYXRlKHQuZ2V0RWxlbWVudHNJbmNsdWRpbmdEZWxldGVkKCksdC5nZXRBcHBTdGF0ZSgpKX0pKS5zb3J0KChmdW5jdGlvbihlLHQpe3JldHVybih2b2lkIDAhPT1lLmNvbnRleHRNZW51T3JkZXI/ZS5jb250ZXh0TWVudU9yZGVyOjk5OSktKHZvaWQgMCE9PXQuY29udGV4dE1lbnVPcmRlcj90LmNvbnRleHRNZW51T3JkZXI6OTk5KX0pKS5tYXAoKGZ1bmN0aW9uKGUpe3JldHVybntsYWJlbDplLmNvbnRleHRJdGVtTGFiZWw/T2JqZWN0KHMuZSkoZS5jb250ZXh0SXRlbUxhYmVsKToiIixhY3Rpb246ZnVuY3Rpb24oKXt0LnVwZGF0ZXIoZS5wZXJmb3JtKHQuZ2V0RWxlbWVudHNJbmNsdWRpbmdEZWxldGVkKCksdC5nZXRBcHBTdGF0ZSgpLG51bGwpKX19fSkpfSxlfSgpLFU9KG4oNTMpLGEuYS5mb3J3YXJkUmVmKChmdW5jdGlvbihlLHQpe3ZhciBuLHI9YS5hLnVzZVJlZihudWxsKTthLmEudXNlSW1wZXJhdGl2ZUhhbmRsZSh0LChmdW5jdGlvbigpe3JldHVybiByLmN1cnJlbnR9KSk7dmFyIG89IlRvb2xJY29uX3NpemVfIi5jb25jYXQoZS5zaXplfHwibSIpO3JldHVybiJidXR0b24iPT09ZS50eXBlP2EuYS5jcmVhdGVFbGVtZW50KCJidXR0b24iLHtjbGFzc05hbWU6IlRvb2xJY29uX3R5cGVfYnV0dG9uICIuY29uY2F0KGUuaGlkZGVuPyIiOiJUb29sSWNvbiIsIiAiKS5jb25jYXQobykuY29uY2F0KGUuc2VsZWN0ZWQ/IiBUb29sSWNvbi0tc2VsZWN0ZWQiOiIiLCIgIikuY29uY2F0KGUuY2xhc3NOYW1lLCIgIikuY29uY2F0KGUudmlzaWJsZSYmIWUuaGlkZGVuPyJUb29sSWNvbl90eXBlX2J1dHRvbi0tc2hvdyI6IlRvb2xJY29uX3R5cGVfYnV0dG9uLS1oaWRlIiksaGlkZGVuOmUuaGlkZGVuLHRpdGxlOmUudGl0bGUsImFyaWEtbGFiZWwiOmVbImFyaWEtbGFiZWwiXSx0eXBlOiJidXR0b24iLG9uQ2xpY2s6ZS5vbkNsaWNrLHJlZjpyfSxhLmEuY3JlYXRlRWxlbWVudCgiZGl2Iix7Y2xhc3NOYW1lOiJUb29sSWNvbl9faWNvbiIsImFyaWEtaGlkZGVuIjoidHJ1ZSJ9LGUuaWNvbnx8ZS5sYWJlbCxlLmtleUJpbmRpbmdMYWJlbCYmYS5hLmNyZWF0ZUVsZW1lbnQoInNwYW4iLHtjbGFzc05hbWU6IlRvb2xJY29uX19rZXliaW5kaW5nIn0sZS5rZXlCaW5kaW5nTGFiZWwpKSxlLnNob3dBcmlhTGFiZWwmJmEuYS5jcmVhdGVFbGVtZW50KCJkaXYiLHtjbGFzc05hbWU6IlRvb2xJY29uX19sYWJlbCJ9LGVbImFyaWEtbGFiZWwiXSksZS5jaGlsZHJlbik6YS5hLmNyZWF0ZUVsZW1lbnQoImxhYmVsIix7Y2xhc3NOYW1lOiJUb29sSWNvbiAiLmNvbmNhdChudWxsIT09KG49ZS5jbGFzc05hbWUpJiZ2b2lkIDAhPT1uP246IiIpLHRpdGxlOmUudGl0bGV9LGEuYS5jcmVhdGVFbGVtZW50KCJpbnB1dCIse2NsYXNzTmFtZToiVG9vbEljb25fdHlwZV9yYWRpbyAiLmNvbmNhdChvKSx0eXBlOiJyYWRpbyIsbmFtZTplLm5hbWUsImFyaWEtbGFiZWwiOmVbImFyaWEtbGFiZWwiXSwiYXJpYS1rZXlzaG9ydGN1dHMiOmVbImFyaWEta2V5c2hvcnRjdXRzIl0sImRhdGEtdGVzdGlkIjplWyJkYXRhLXRlc3RpZCJdLGlkOmUuaWQsb25DaGFuZ2U6ZS5vbkNoYW5nZSxjaGVja2VkOmUuY2hlY2tlZCxyZWY6cn0pLGEuYS5jcmVhdGVFbGVtZW50KCJkaXYiLHtjbGFzc05hbWU6IlRvb2xJY29uX19pY29uIn0sZS5pY29uLGUua2V5QmluZGluZ0xhYmVsJiZhLmEuY3JlYXRlRWxlbWVudCgic3BhbiIse2NsYXNzTmFtZToiVG9vbEljb25fX2tleWJpbmRpbmcifSxlLmtleUJpbmRpbmdMYWJlbCkpKX0pKSk7VS5kZWZhdWx0UHJvcHM9e3Zpc2libGU6ITAsY2xhc3NOYW1lOiIifTt2YXIgVj14Lm9yYW5nZVs0XSxLPWZ1bmN0aW9uKGUsdCl7dm9pZCAwPT09dCYmKHQ9NTEyKTt2YXIgbj0ibnVtYmVyIj09dHlwZW9mIHQ/e3dpZHRoOnR9OnQscj1uLndpZHRoLG89dm9pZCAwPT09cj81MTI6cixpPW4uaGVpZ2h0LHM9dm9pZCAwPT09aT9vOmksbD1uLm1pcnJvcixjPW4uc3R5bGU7cmV0dXJuIGEuYS5jcmVhdGVFbGVtZW50KCJzdmciLHsiYXJpYS1oaWRkZW4iOiJ0cnVlIixmb2N1c2FibGU6ImZhbHNlIixyb2xlOiJpbWciLHZpZXdCb3g6IjAgMCAiLmNvbmNhdChvLCIgIikuY29uY2F0KHMpLGNsYXNzTmFtZTpsJiYicnRsLW1pcnJvciIsc3R5bGU6Y30sInN0cmluZyI9PXR5cGVvZiBlP2EuYS5jcmVhdGVFbGVtZW50KCJwYXRoIix7ZmlsbDoiY3VycmVudENvbG9yIixkOmV9KTplKX0sWj1LKCJNMzI2LjYxMiAxODUuMzkxYzU5Ljc0NyA1OS44MDkgNTguOTI3IDE1NS42OTguMzYgMjE0LjU5LS4xMS4xMi0uMjQuMjUtLjM2LjM3bC02Ny4yIDY3LjJjLTU5LjI3IDU5LjI3LTE1NS42OTkgNTkuMjYyLTIxNC45NiAwLTU5LjI3LTU5LjI2LTU5LjI3LTE1NS43IDAtMjE0Ljk2bDM3LjEwNi0zNy4xMDZjOS44NC05Ljg0IDI2Ljc4Ni0zLjMgMjcuMjk0IDEwLjYwNi42NDggMTcuNzIyIDMuODI2IDM1LjUyNyA5LjY5IDUyLjcyMSAxLjk4NiA1LjgyMi41NjcgMTIuMjYyLTMuNzgzIDE2LjYxMmwtMTMuMDg3IDEzLjA4N2MtMjguMDI2IDI4LjAyNi0yOC45MDUgNzMuNjYtMS4xNTUgMTAxLjk2IDI4LjAyNCAyOC41NzkgNzQuMDg2IDI4Ljc0OSAxMDIuMzI1LjUxbDY3LjItNjcuMTljMjguMTkxLTI4LjE5MSAyOC4wNzMtNzMuNzU3IDAtMTAxLjgzLTMuNzAxLTMuNjk0LTcuNDI5LTYuNTY0LTEwLjM0MS04LjU2OWExNi4wMzcgMTYuMDM3IDAgMCAxLTYuOTQ3LTEyLjYwNmMtLjM5Ni0xMC41NjcgMy4zNDgtMjEuNDU2IDExLjY5OC0yOS44MDZsMjEuMDU0LTIxLjA1NWM1LjUyMS01LjUyMSAxNC4xODItNi4xOTkgMjAuNTg0LTEuNzMxYTE1Mi40ODIgMTUyLjQ4MiAwIDAgMSAyMC41MjIgMTcuMTk3ek00NjcuNTQ3IDQ0LjQ0OWMtNTkuMjYxLTU5LjI2Mi0xNTUuNjktNTkuMjctMjE0Ljk2IDBsLTY3LjIgNjcuMmMtLjEyLjEyLS4yNS4yNS0uMzYuMzctNTguNTY2IDU4Ljg5Mi01OS4zODcgMTU0Ljc4MS4zNiAyMTQuNTlhMTUyLjQ1NCAxNTIuNDU0IDAgMCAwIDIwLjUyMSAxNy4xOTZjNi40MDIgNC40NjggMTUuMDY0IDMuNzg5IDIwLjU4NC0xLjczMWwyMS4wNTQtMjEuMDU1YzguMzUtOC4zNSAxMi4wOTQtMTkuMjM5IDExLjY5OC0yOS44MDZhMTYuMDM3IDE2LjAzNyAwIDAgMC02Ljk0Ny0xMi42MDZjLTIuOTEyLTIuMDA1LTYuNjQtNC44NzUtMTAuMzQxLTguNTY5LTI4LjA3My0yOC4wNzMtMjguMTkxLTczLjYzOSAwLTEwMS44M2w2Ny4yLTY3LjE5YzI4LjIzOS0yOC4yMzkgNzQuMy0yOC4wNjkgMTAyLjMyNS41MSAyNy43NSAyOC4zIDI2Ljg3MiA3My45MzQtMS4xNTUgMTAxLjk2bC0xMy4wODcgMTMuMDg3Yy00LjM1IDQuMzUtNS43NjkgMTAuNzktMy43ODMgMTYuNjEyIDUuODY0IDE3LjE5NCA5LjA0MiAzNC45OTkgOS42OSA1Mi43MjEuNTA5IDEzLjkwNiAxNy40NTQgMjAuNDQ2IDI3LjI5NCAxMC42MDZsMzcuMTA2LTM3LjEwNmM1OS4yNzEtNTkuMjU5IDU5LjI3MS0xNTUuNjk5LjAwMS0yMTQuOTU5eiIse21pcnJvcjohMH0pLHE9SygiTTQzMy45NDEgMTI5Ljk0MWwtODMuODgyLTgzLjg4MkE0OCA0OCAwIDAgMCAzMTYuMTE4IDMySDQ4QzIxLjQ5IDMyIDAgNTMuNDkgMCA4MHYzNTJjMCAyNi41MSAyMS40OSA0OCA0OCA0OGgzNTJjMjYuNTEgMCA0OC0yMS40OSA0OC00OFYxNjMuODgyYTQ4IDQ4IDAgMCAwLTE0LjA1OS0zMy45NDF6TTIyNCA0MTZjLTM1LjM0NiAwLTY0LTI4LjY1NC02NC02NCAwLTM1LjM0NiAyOC42NTQtNjQgNjQtNjRzNjQgMjguNjU0IDY0IDY0YzAgMzUuMzQ2LTI4LjY1NCA2NC02NCA2NHptOTYtMzA0LjUyVjIxMmMwIDYuNjI3LTUuMzczIDEyLTEyIDEySDc2Yy02LjYyNyAwLTEyLTUuMzczLTEyLTEyVjEwOGMwLTYuNjI3IDUuMzczLTEyIDEyLTEyaDIyOC41MmMzLjE4MyAwIDYuMjM1IDEuMjY0IDguNDg1IDMuNTE1bDMuNDggMy40OEExMS45OTYgMTEuOTk2IDAgMCAxIDMyMCAxMTEuNDh6Iix7d2lkdGg6NDQ4LGhlaWdodDo1MTJ9KSxZPUsoIk0yNTIgNTRMMjAzIDhhMjggMjcgMCAwMC0yMC04SDI4QzEyIDAgMCAxMiAwIDI3djE5NWMwIDE1IDEyIDI2IDI4IDI2aDIwNGMxNSAwIDI4LTExIDI4LTI2VjczYTI4IDI3IDAgMDAtOC0xOXpNMTMwIDIxM2MtMjEgMC0zNy0xNi0zNy0zNiAwLTE5IDE2LTM1IDM3LTM1IDIwIDAgMzcgMTYgMzcgMzUgMCAyMC0xNyAzNi0zNyAzNnptNTYtMTY5djU2YzAgNC00IDYtNyA2SDQ0Yy00IDAtNy0yLTctNlY0MmMwLTQgMy03IDctN2gxMzNsNCAyIDMgMmE3IDcgMCAwMTIgNXogTTI5NiAyMDFsODcgOTUtMTg4IDIwNS03OCA5Yy0xMCAxLTE5LTgtMTgtMjBsOS04NHptMTQxLTE0bC00MS00NGEzMSAzMSAwIDAwLTQ2IDBsLTM4IDQxIDg3IDk1IDM4LTQyYzEzLTE0IDEzLTM2IDAtNTB6Iix7d2lkdGg6NDQ4LGhlaWdodDo1MTJ9KSxYPUsoIk01NzIuNjk0IDI5Mi4wOTNMNTAwLjI3IDQxNi4yNDhBNjMuOTk3IDYzLjk5NyAwIDAgMSA0NDQuOTg5IDQ0OEg0NS4wMjVjLTE4LjUyMyAwLTMwLjA2NC0yMC4wOTMtMjAuNzMxLTM2LjA5M2w3Mi40MjQtMTI0LjE1NUE2NCA2NCAwIDAgMSAxNTIgMjU2aDM5OS45NjRjMTguNTIzIDAgMzAuMDY0IDIwLjA5MyAyMC43MyAzNi4wOTN6TTE1MiAyMjRoMzI4di00OGMwLTI2LjUxLTIxLjQ5LTQ4LTQ4LTQ4SDI3MmwtNjQtNjRINDhDMjEuNDkgNjQgMCA4NS40OSAwIDExMnYyNzguMDQ2bDY5LjA3Ny0xMTguNDE4Qzg2LjIxNCAyNDIuMjUgMTE3Ljk4OSAyMjQgMTUyIDIyNHoiLHt3aWR0aDo1NzYsaGVpZ2h0OjUxMixtaXJyb3I6ITB9KSxKPUsoIk0zODQgMTEydjM1MmMwIDI2LjUxLTIxLjQ5IDQ4LTQ4IDQ4SDQ4Yy0yNi41MSAwLTQ4LTIxLjQ5LTQ4LTQ4VjExMmMwLTI2LjUxIDIxLjQ5LTQ4IDQ4LTQ4aDgwYzAtMzUuMjkgMjguNzEtNjQgNjQtNjRzNjQgMjguNzEgNjQgNjRoODBjMjYuNTEgMCA0OCAyMS40OSA0OCA0OHpNMTkyIDQwYy0xMy4yNTUgMC0yNCAxMC43NDUtMjQgMjRzMTAuNzQ1IDI0IDI0IDI0IDI0LTEwLjc0NSAyNC0yNC0xMC43NDUtMjQtMjQtMjRtOTYgMTE0di0yMGE2IDYgMCAwIDAtNi02SDEwMmE2IDYgMCAwIDAtNiA2djIwYTYgNiAwIDAgMCA2IDZoMTgwYTYgNiAwIDAgMCA2LTZ6Iix7d2lkdGg6Mzg0LGhlaWdodDo1MTJ9KSwkPUsoIk0zMiA0NjRhNDggNDggMCAwIDAgNDggNDhoMjg4YTQ4IDQ4IDAgMCAwIDQ4LTQ4VjEyOEgzMnptMjcyLTI1NmExNiAxNiAwIDAgMSAzMiAwdjIyNGExNiAxNiAwIDAgMS0zMiAwem0tOTYgMGExNiAxNiAwIDAgMSAzMiAwdjIyNGExNiAxNiAwIDAgMS0zMiAwem0tOTYgMGExNiAxNiAwIDAgMSAzMiAwdjIyNGExNiAxNiAwIDAgMS0zMiAwek00MzIgMzJIMzEybC05LjQtMTguN0EyNCAyNCAwIDAgMCAyODEuMSAwSDE2Ni44YTIzLjcyIDIzLjcyIDAgMCAwLTIxLjQgMTMuM0wxMzYgMzJIMTZBMTYgMTYgMCAwIDAgMCA0OHYzMmExNiAxNiAwIDAgMCAxNiAxNmg0MTZhMTYgMTYgMCAwIDAgMTYtMTZWNDhhMTYgMTYgMCAwIDAtMTYtMTZ6Iix7d2lkdGg6NDQ4LGhlaWdodDo1MTJ9KSxRPUsoIk0yMDQuMyA1QzEwNC45IDI0LjQgMjQuOCAxMDQuMyA1LjIgMjAzLjRjLTM3IDE4NyAxMzEuNyAzMjYuNCAyNTguOCAzMDYuNyA0MS4yLTYuNCA2MS40LTU0LjYgNDIuNS05MS43LTIzLjEtNDUuNCA5LjktOTguNCA2MC45LTk4LjRoNzkuN2MzNS44IDAgNjQuOC0yOS42IDY0LjktNjUuM0M1MTEuNSA5Ny4xIDM2OC4xLTI2LjkgMjA0LjMgNXpNOTYgMzIwYy0xNy43IDAtMzItMTQuMy0zMi0zMnMxNC4zLTMyIDMyLTMyIDMyIDE0LjMgMzIgMzItMTQuMyAzMi0zMiAzMnptMzItMTI4Yy0xNy43IDAtMzItMTQuMy0zMi0zMnMxNC4zLTMyIDMyLTMyIDMyIDE0LjMgMzIgMzItMTQuMyAzMi0zMiAzMnptMTI4LTY0Yy0xNy43IDAtMzItMTQuMy0zMi0zMnMxNC4zLTMyIDMyLTMyIDMyIDE0LjMgMzIgMzItMTQuMyAzMi0zMiAzMnptMTI4IDY0Yy0xNy43IDAtMzItMTQuMy0zMi0zMnMxNC4zLTMyIDMyLTMyIDMyIDE0LjMgMzIgMzItMTQuMyAzMi0zMiAzMnoiKSxlZT1LKCJNMzg0IDEyMS45YzAtNi4zLTIuNS0xMi40LTctMTYuOUwyNzkuMSA3Yy00LjUtNC41LTEwLjYtNy0xNy03SDI1NnYxMjhoMTI4ek01NzEgMzA4bC05NS43LTk2LjRjLTEwLjEtMTAuMS0yNy40LTMtMjcuNCAxMS4zVjI4OGgtNjR2NjRoNjR2NjUuMmMwIDE0LjMgMTcuMyAyMS40IDI3LjQgMTEuM0w1NzEgMzMyYzYuNi02LjYgNi42LTE3LjQgMC0yNHptLTM3OSAyOHYtMzJjMC04LjggNy4yLTE2IDE2LTE2aDE3NlYxNjBIMjQ4Yy0xMy4yIDAtMjQtMTAuOC0yNC0yNFYwSDI0QzEwLjcgMCAwIDEwLjcgMCAyNHY0NjRjMCAxMy4zIDEwLjcgMjQgMjQgMjRoMzM2YzEzLjMgMCAyNC0xMC43IDI0LTI0VjM1MkgyMDhjLTguOCAwLTE2LTcuMi0xNi0xNnoiLHt3aWR0aDo1NzYsaGVpZ2h0OjUxMixtaXJyb3I6ITB9KSx0ZT1LKCJNNDE2IDIwOEgyNzJWNjRjMC0xNy42Ny0xNC4zMy0zMi0zMi0zMmgtMzJjLTE3LjY3IDAtMzIgMTQuMzMtMzIgMzJ2MTQ0SDMyYy0xNy42NyAwLTMyIDE0LjMzLTMyIDMydjMyYzAgMTcuNjcgMTQuMzMgMzIgMzIgMzJoMTQ0djE0NGMwIDE3LjY3IDE0LjMzIDMyIDMyIDMyaDMyYzE3LjY3IDAgMzItMTQuMzMgMzItMzJWMzA0aDE0NGMxNy42NyAwIDMyLTE0LjMzIDMyLTMydi0zMmMwLTE3LjY3LTE0LjMzLTMyLTMyLTMyeiIse3dpZHRoOjQ0OCxoZWlnaHQ6NTEyfSksbmU9SygiTTQxNiAyMDhIMzJjLTE3LjY3IDAtMzIgMTQuMzMtMzIgMzJ2MzJjMCAxNy42NyAxNC4zMyAzMiAzMiAzMmgzODRjMTcuNjcgMCAzMi0xNC4zMyAzMi0zMnYtMzJjMC0xNy42Ny0xNC4zMy0zMi0zMi0zMnoiLHt3aWR0aDo0NDgsaGVpZ2h0OjUxMn0pLHJlPUsoIk0xNzMuODk4IDQzOS40MDRsLTE2Ni40LTE2Ni40Yy05Ljk5Ny05Ljk5Ny05Ljk5Ny0yNi4yMDYgMC0zNi4yMDRsMzYuMjAzLTM2LjIwNGM5Ljk5Ny05Ljk5OCAyNi4yMDctOS45OTggMzYuMjA0IDBMMTkyIDMxMi42OSA0MzIuMDk1IDcyLjU5NmM5Ljk5Ny05Ljk5NyAyNi4yMDctOS45OTcgMzYuMjA0IDBsMzYuMjAzIDM2LjIwNGM5Ljk5NyA5Ljk5NyA5Ljk5NyAyNi4yMDYgMCAzNi4yMDRsLTI5NC40IDI5NC40MDFjLTkuOTk4IDkuOTk3LTI2LjIwNyA5Ljk5Ny0zNi4yMDQtLjAwMXoiLHttaXJyb3I6ITB9KSxvZT1LKCJNMTYgMTMyaDQxNmM4LjgzNyAwIDE2LTcuMTYzIDE2LTE2Vjc2YzAtOC44MzctNy4xNjMtMTYtMTYtMTZIMTZDNy4xNjMgNjAgMCA2Ny4xNjMgMCA3NnY0MGMwIDguODM3IDcuMTYzIDE2IDE2IDE2em0wIDE2MGg0MTZjOC44MzcgMCAxNi03LjE2MyAxNi0xNnYtNDBjMC04LjgzNy03LjE2My0xNi0xNi0xNkgxNmMtOC44MzcgMC0xNiA3LjE2My0xNiAxNnY0MGMwIDguODM3IDcuMTYzIDE2IDE2IDE2em0wIDE2MGg0MTZjOC44MzcgMCAxNi03LjE2MyAxNi0xNnYtNDBjMC04LjgzNy03LjE2My0xNi0xNi0xNkgxNmMtOC44MzcgMC0xNiA3LjE2My0xNiAxNnY0MGMwIDguODM3IDcuMTYzIDE2IDE2IDE2eiIpLGFlPUsoIk0yNTUuNTQ1IDhjLTY2LjI2OS4xMTktMTI2LjQzOCAyNi4yMzMtMTcwLjg2IDY4LjY4NUw0OC45NzEgNDAuOTcxQzMzLjg1MSAyNS44NTEgOCAzNi41NTkgOCA1Ny45NDFWMTkyYzAgMTMuMjU1IDEwLjc0NSAyNCAyNCAyNGgxMzQuMDU5YzIxLjM4MiAwIDMyLjA5LTI1Ljg1MSAxNi45NzEtNDAuOTcxbC00MS43NS00MS43NWMzMC44NjQtMjguODk5IDcwLjgwMS00NC45MDcgMTEzLjIzLTQ1LjI3MyA5Mi4zOTgtLjc5OCAxNzAuMjgzIDczLjk3NyAxNjkuNDg0IDE2OS40NDJDNDIzLjIzNiAzNDguMDA5IDM0OS44MTYgNDI0IDI1NiA0MjRjLTQxLjEyNyAwLTc5Ljk5Ny0xNC42NzgtMTEwLjYzLTQxLjU1Ni00Ljc0My00LjE2MS0xMS45MDYtMy45MDgtMTYuMzY4LjU1M0w4OS4zNCA0MjIuNjU5Yy00Ljg3MiA0Ljg3Mi00LjYzMSAxMi44MTUuNDgyIDE3LjQzM0MxMzMuNzk4IDQ3OS44MTMgMTkyLjA3NCA1MDQgMjU2IDUwNGMxMzYuOTY2IDAgMjQ3Ljk5OS0xMTEuMDMzIDI0OC0yNDcuOTk4QzUwNC4wMDEgMTE5LjE5MyAzOTIuMzU0IDcuNzU1IDI1NS41NDUgOHoiLHttaXJyb3I6ITB9KSxpZT1LKCJNMjU2LjQ1NSA4YzY2LjI2OS4xMTkgMTI2LjQzNyAyNi4yMzMgMTcwLjg1OSA2OC42ODVsMzUuNzE1LTM1LjcxNUM0NzguMTQ5IDI1Ljg1MSA1MDQgMzYuNTU5IDUwNCA1Ny45NDFWMTkyYzAgMTMuMjU1LTEwLjc0NSAyNC0yNCAyNEgzNDUuOTQxYy0yMS4zODIgMC0zMi4wOS0yNS44NTEtMTYuOTcxLTQwLjk3MWw0MS43NS00MS43NWMtMzAuODY0LTI4Ljg5OS03MC44MDEtNDQuOTA3LTExMy4yMy00NS4yNzMtOTIuMzk4LS43OTgtMTcwLjI4MyA3My45NzctMTY5LjQ4NCAxNjkuNDQyQzg4Ljc2NCAzNDguMDA5IDE2Mi4xODQgNDI0IDI1NiA0MjRjNDEuMTI3IDAgNzkuOTk3LTE0LjY3OCAxMTAuNjI5LTQxLjU1NiA0Ljc0My00LjE2MSAxMS45MDYtMy45MDggMTYuMzY4LjU1M2wzOS42NjIgMzkuNjYyYzQuODcyIDQuODcyIDQuNjMxIDEyLjgxNS0uNDgyIDE3LjQzM0MzNzguMjAyIDQ3OS44MTMgMzE5LjkyNiA1MDQgMjU2IDUwNCAxMTkuMDM0IDUwNCA4LjAwMSAzOTIuOTY3IDggMjU2LjAwMiA3Ljk5OSAxMTkuMTkzIDExOS42NDYgNy43NTUgMjU2LjQ1NSA4eiIse21pcnJvcjohMH0pLHNlPUsoYS5hLmNyZWF0ZUVsZW1lbnQoInBhdGgiLHtzdHJva2U6ImN1cnJlbnRDb2xvciIsc3Ryb2tlV2lkdGg6IjQwIixmaWxsOiJjdXJyZW50Q29sb3IiLGQ6Ik0xNDggNTYwYTMxOCAzMTggMCAwIDAgNTIyIDExMCAzMTYgMzE2IDAgMCAwIDAtNDUwIDMxNiAzMTYgMCAwIDAtNDUwIDBjLTExIDExLTIxIDIyLTMwIDM0djRoNDdjMjUgMCA0NiAyMSA0NiA0NnMtMjEgNDUtNDYgNDVIOTBjLTEzIDAtMjUtNi0zMy0xNC05LTktMTQtMjAtMTQtMzNWMTU2YzAtMjUgMjAtNDUgNDUtNDVzNDUgMjAgNDUgNDV2MzJsMSAxYTQwMSA0MDEgMCAwIDEgNjIzIDUwOWwyMTIgMjEyYTQyIDQyIDAgMCAxLTU5IDU5TDY5OCA3NTdBNDAxIDQwMSAwIDAgMSA2NSA1NzBhNDIgNDIgMCAwIDEgODMtMTB6In0pLHt3aWR0aDoxMDI0fSksbGU9SyhhLmEuY3JlYXRlRWxlbWVudChhLmEuRnJhZ21lbnQsbnVsbCxhLmEuY3JlYXRlRWxlbWVudCgicGF0aCIse2Q6Ik0yMiA5LjU1NkMyMiA4LjY5NiAyMS4zMDMgOCAyMC40NDQgOEgxNnY4SDh2NC40NDRDOCAyMS4zMDQgOC42OTcgMjIgOS41NTYgMjJoMTAuODg4Yy44NiAwIDEuNTU2LS42OTcgMS41NTYtMS41NTZWOS41NTZ6IixzdHJva2U6eC5ibGFjayxzdHJva2VXaWR0aDoiMiJ9KSxhLmEuY3JlYXRlRWxlbWVudCgicGF0aCIse2Q6Ik0xNiAzLjU1NkMxNiAyLjY5NiAxNS4zMDMgMiAxNC40NDQgMkgzLjU1NkMyLjY5NiAyIDIgMi42OTcgMiAzLjU1NnYxMC44ODhDMiAxNS4zMDQgMi42OTcgMTYgMy41NTYgMTZoMTAuODg4Yy44NiAwIDEuNTU2LS42OTcgMS41NTYtMS41NTZWMy41NTZ6IixmaWxsOlYsc3Ryb2tlOlYsc3Ryb2tlV2lkdGg6IjIifSkpLHt3aWR0aDoyNH0pLGNlPUsoYS5hLmNyZWF0ZUVsZW1lbnQoYS5hLkZyYWdtZW50LG51bGwsYS5hLmNyZWF0ZUVsZW1lbnQoInBhdGgiLHtkOiJNMTYgMy41NTZDMTYgMi42OTYgMTUuMzAzIDIgMTQuNDQ0IDJIMy41NTZDMi42OTYgMiAyIDIuNjk3IDIgMy41NTZ2MTAuODg4QzIgMTUuMzA0IDIuNjk3IDE2IDMuNTU2IDE2aDEwLjg4OGMuODYgMCAxLjU1Ni0uNjk3IDEuNTU2LTEuNTU2VjMuNTU2eiIsZmlsbDpWLHN0cm9rZTpWLHN0cm9rZVdpZHRoOiIyIn0pLGEuYS5jcmVhdGVFbGVtZW50KCJwYXRoIix7ZDoiTTIyIDkuNTU2QzIyIDguNjk2IDIxLjMwMyA4IDIwLjQ0NCA4SDkuNTU2QzguNjk2IDggOCA4LjY5NyA4IDkuNTU2djEwLjg4OEM4IDIxLjMwNCA4LjY5NyAyMiA5LjU1NiAyMmgxMC44ODhjLjg2IDAgMS41NTYtLjY5NyAxLjU1Ni0xLjU1NlY5LjU1NnoiLHN0cm9rZTp4LmJsYWNrLHN0cm9rZVdpZHRoOiIyIn0pKSx7d2lkdGg6MjR9KSx1ZT1LKGEuYS5jcmVhdGVFbGVtZW50KGEuYS5GcmFnbWVudCxudWxsLGEuYS5jcmVhdGVFbGVtZW50KCJwYXRoIix7ZDoiTTEzIDIxYTEgMSAwIDAwMSAxaDdhMSAxIDAgMDAxLTF2LTdhMSAxIDAgMDAtMS0xaC0zdjVoLTV2M3pNMTEgM2ExIDEgMCAwMC0xLTFIM2ExIDEgMCAwMC0xIDF2N2ExIDEgMCAwMDEgMWgzVjZoNVYzeiIsc3Ryb2tlOnguYmxhY2ssc3Ryb2tlV2lkdGg6IjIifSksYS5hLmNyZWF0ZUVsZW1lbnQoInBhdGgiLHtkOiJNMTggNy4zMzNDMTggNi41OTcgMTcuNDAzIDYgMTYuNjY3IDZINy4zMzNDNi41OTcgNiA2IDYuNTk3IDYgNy4zMzN2OS4zMzRDNiAxNy40MDMgNi41OTcgMTggNy4zMzMgMThoOS4zMzRjLjczNiAwIDEuMzMzLS41OTcgMS4zMzMtMS4zMzNWNy4zMzN6IixmaWxsOlYsc3Ryb2tlOlYsc3Ryb2tlV2lkdGg6IjIifSkpLHt3aWR0aDoyNH0pLGRlPUsoYS5hLmNyZWF0ZUVsZW1lbnQoYS5hLkZyYWdtZW50LG51bGwsYS5hLmNyZWF0ZUVsZW1lbnQoInBhdGgiLHtkOiJNMTggNy4zMzNDMTggNi41OTcgMTcuNDAzIDYgMTYuNjY3IDZINy4zMzNDNi41OTcgNiA2IDYuNTk3IDYgNy4zMzN2OS4zMzRDNiAxNy40MDMgNi41OTcgMTggNy4zMzMgMThoOS4zMzRjLjczNiAwIDEuMzMzLS41OTcgMS4zMzMtMS4zMzNWNy4zMzN6IixmaWxsOlYsc3Ryb2tlOlYsc3Ryb2tlTGluZWpvaW46InJvdW5kIixzdHJva2VXaWR0aDoiMiJ9KSxhLmEuY3JlYXRlRWxlbWVudCgicGF0aCIse2Q6Ik0xMSAzYTEgMSAwIDAwLTEtMUgzYTEgMSAwIDAwLTEgMXY3YTEgMSAwIDAwMSAxaDhWM3pNMjIgMTRhMSAxIDAgMDAtMS0xaC03YTEgMSAwIDAwLTEgMXY3YTEgMSAwIDAwMSAxaDh2LTh6IixzdHJva2U6eC5ibGFjayxzdHJva2VMaW5lam9pbjoicm91bmQiLHN0cm9rZVdpZHRoOiIyIn0pKSx7d2lkdGg6MjR9KSxwZT1LKCJNMTkyIDI1NmM2MS45IDAgMTEyLTUwLjEgMTEyLTExMlMyNTMuOSAzMiAxOTIgMzIgODAgODIuMSA4MCAxNDRzNTAuMSAxMTIgMTEyIDExMnptNzYuOCAzMmgtOC4zYy0yMC44IDEwLTQzLjkgMTYtNjguNSAxNnMtNDcuNi02LTY4LjUtMTZoLTguM0M1MS42IDI4OCAwIDMzOS42IDAgNDAzLjJWNDMyYzAgMjYuNSAyMS41IDQ4IDQ4IDQ4aDI4OGMyNi41IDAgNDgtMjEuNSA0OC00OHYtMjguOGMwLTYzLjYtNTEuNi0xMTUuMi0xMTUuMi0xMTUuMnpNNDgwIDI1NmM1MyAwIDk2LTQzIDk2LTk2cy00My05Ni05Ni05Ni05NiA0My05NiA5NiA0MyA5NiA5NiA5NnptNDggMzJoLTMuOGMtMTMuOSA0LjgtMjguNiA4LTQ0LjIgOHMtMzAuMy0zLjItNDQuMi04SDQzMmMtMjAuNCAwLTM5LjIgNS45LTU1LjcgMTUuNCAyNC40IDI2LjMgMzkuNyA2MS4yIDM5LjcgOTkuOHYzOC40YzAgMi4yLS41IDQuMy0uNiA2LjRINTkyYzI2LjUgMCA0OC0yMS41IDQ4LTQ4IDAtNjEuOS01MC4xLTExMi0xMTItMTEyeiIse3dpZHRoOjY0MCxoZWlnaHQ6NTEyLG1pcnJvcjohMH0pLGhlPUsoIk0yNTYgOEMxMTkgOCA4IDExOSA4IDI1NnMxMTEgMjQ4IDI0OCAyNDggMjQ4LTExMSAyNDgtMjQ4UzM5MyA4IDI1NiA4em0xMTUuNyAyNzJsLTE3NiAxMDFjLTE1LjggOC44LTM1LjctMi41LTM1LjctMjFWMTUyYzAtMTguNCAxOS44LTI5LjggMzUuNy0yMWwxNzYgMTA3YzE2LjQgOS4yIDE2LjQgMzIuOSAwIDQyeiIpLGZlPUsoIk0yNTYgOEMxMTkgOCA4IDExOSA4IDI1NnMxMTEgMjQ4IDI0OCAyNDggMjQ4LTExMSAyNDgtMjQ4UzM5MyA4IDI1NiA4em05NiAzMjhjMCA4LjgtNy4yIDE2LTE2IDE2SDE3NmMtOC44IDAtMTYtNy4yLTE2LTE2VjE3NmMwLTguOCA3LjItMTYgMTYtMTZoMTYwYzguOCAwIDE2IDcuMiAxNiAxNnYxNjB6IiksbWU9SygiTTI0Mi43MiAyNTZsMTAwLjA3LTEwMC4wN2MxMi4yOC0xMi4yOCAxMi4yOC0zMi4xOSAwLTQ0LjQ4bC0yMi4yNC0yMi4yNGMtMTIuMjgtMTIuMjgtMzIuMTktMTIuMjgtNDQuNDggMEwxNzYgMTg5LjI4IDc1LjkzIDg5LjIxYy0xMi4yOC0xMi4yOC0zMi4xOS0xMi4yOC00NC40OCAwTDkuMjEgMTExLjQ1Yy0xMi4yOCAxMi4yOC0xMi4yOCAzMi4xOSAwIDQ0LjQ4TDEwOS4yOCAyNTYgOS4yMSAzNTYuMDdjLTEyLjI4IDEyLjI4LTEyLjI4IDMyLjE5IDAgNDQuNDhsMjIuMjQgMjIuMjRjMTIuMjggMTIuMjggMzIuMiAxMi4yOCA0NC40OCAwTDE3NiAzMjIuNzJsMTAwLjA3IDEwMC4wN2MxMi4yOCAxMi4yOCAzMi4yIDEyLjI4IDQ0LjQ4IDBsMjIuMjQtMjIuMjRjMTIuMjgtMTIuMjggMTIuMjgtMzIuMTkgMC00NC40OEwyNDIuNzIgMjU2eiIse3dpZHRoOjM1MixoZWlnaHQ6NTEyfSksZ2U9SygiTTM0LjUyIDIzOS4wM0wyMjguODcgNDQuNjljOS4zNy05LjM3IDI0LjU3LTkuMzcgMzMuOTQgMGwyMi42NyAyMi42N2M5LjM2IDkuMzYgOS4zNyAyNC41Mi4wNCAzMy45TDEzMS40OSAyNTZsMTU0LjAyIDE1NC43NWM5LjM0IDkuMzggOS4zMiAyNC41NC0uMDQgMzMuOWwtMjIuNjcgMjIuNjdjLTkuMzcgOS4zNy0yNC41NyA5LjM3LTMzLjk0IDBMMzQuNTIgMjcyLjk3Yy05LjM3LTkuMzctOS4zNy0yNC41NyAwLTMzLjk0eiIse3dpZHRoOjMyMCxoZWlnaHQ6NTEyLHN0eWxlOnttYXJnaW5MZWZ0OiItMC4ycmVtIn0sbWlycm9yOiEwfSksYmU9SygiTTQ2NCAwYzI2LjUxIDAgNDggMjEuNDkgNDggNDh2Mjg4YzAgMjYuNTEtMjEuNDkgNDgtNDggNDhIMTc2Yy0yNi41MSAwLTQ4LTIxLjQ5LTQ4LTQ4VjQ4YzAtMjYuNTEgMjEuNDktNDggNDgtNDhoMjg4TTE3NiA0MTZjLTQ0LjExMiAwLTgwLTM1Ljg4OC04MC04MFYxMjhINDhjLTI2LjUxIDAtNDggMjEuNDktNDggNDh2Mjg4YzAgMjYuNTEgMjEuNDkgNDggNDggNDhoMjg4YzI2LjUxIDAgNDgtMjEuNDkgNDgtNDh2LTQ4SDE3NnoiLHttaXJyb3I6ITB9KSx5ZT1LKCJNMTEuNTUzIDIyLjg5NGEuOTk4Ljk5OCAwIDAwLjg5NCAwczMuMDM3LTEuNTE2IDUuNDY1LTQuMDk3QzE5LjYxNiAxNi45ODcgMjEgMTQuNjYzIDIxIDEyVjVhMSAxIDAgMDAtLjY0OS0uOTM2bC04LTNhLjk5OC45OTggMCAwMC0uNzAyIDBsLTggM0ExIDEgMCAwMDMgNXY3YzAgMi42NjMgMS4zODQgNC45ODcgMy4wODggNi43OTcgMi40MjggMi41ODEgNS40NjUgNC4wOTcgNS40NjUgNC4wOTd6bS0xLjMwMy04LjQ4MWw2LjY0NC02LjY0NGEuODU2Ljg1NiAwIDExMS4yMTIgMS4yMTJsLTcuMjUgNy4yNWEuODU2Ljg1NiAwIDAxLTEuMjEyIDBsLTMuNzUtMy43NWEuODU2Ljg1NiAwIDExMS4yMTItMS4yMTJsMy4xNDQgMy4xNDR6Iix7d2lkdGg6MjR9KSx2ZT1LKGEuYS5jcmVhdGVFbGVtZW50KGEuYS5GcmFnbWVudCxudWxsLGEuYS5jcmVhdGVFbGVtZW50KCJwYXRoIix7ZDoiTTI1IDI2SDExMVYxMTFIMjUiLGZpbGw6eC5ibGFja30pLGEuYS5jcmVhdGVFbGVtZW50KCJwYXRoIix7ZDoiTTI1IDExMUMyNSA4MC4yMDY4IDI1IDQ5LjQxMzUgMjUgMjZNMjUgMjZDNDguNjE3NCAyNiA3Mi4yMzQ4IDI2IDExMSAyNkgyNVpNMjUgMjZDNTMuMzY3MSAyNiA4MS43MzQzIDI2IDExMSAyNkgyNVpNMTExIDI2QzExMSA1Mi4zMDMgMTExIDc4LjYwNiAxMTEgMTExVjI2Wk0xMTEgMjZDMTExIDUxLjI5NDcgMTExIDc2LjU4OTMgMTExIDExMVYyNlpNMTExIDExMUM4Ny4wNzkyIDExMSA2My4xNTg1IDExMSAyNSAxMTFIMTExWk0xMTEgMTExQzg3LjQ2NDYgMTExIDYzLjkyOTMgMTExIDI1IDExMUgxMTFaTTI1IDExMUMyNSA4MS4xNTE0IDI1IDUxLjMwMjggMjUgMjZWMTExWiIsc3Ryb2tlOnguYmxhY2ssc3Ryb2tlV2lkdGg6IjIifSksYS5hLmNyZWF0ZUVsZW1lbnQoInBhdGgiLHtkOiJNMTAwIDEwMEgxNjBWMTYwSDEwMCIsZmlsbDp4LmJsYWNrfSksYS5hLmNyZWF0ZUVsZW1lbnQoInBhdGgiLHtkOiJNMTAwIDE2MEMxMDAgMTQ0LjEwNiAxMDAgMTI4LjIxMSAxMDAgMTAwTTEwMCAxMDBDMTE3LjcwNiAxMDAgMTM1LjQxMiAxMDAgMTYwIDEwMEgxMDBaTTEwMCAxMDBDMTE0LjIxNCAxMDAgMTI4LjQyOCAxMDAgMTYwIDEwMEgxMDBaTTE2MCAxMDBDMTYwIDEyMC4xODQgMTYwIDE0MC4zNjkgMTYwIDE2MFYxMDBaTTE2MCAxMDBDMTYwIDExMy4yMTkgMTYwIDEyNi40MzcgMTYwIDE2MFYxMDBaTTE2MCAxNjBDMTQ1LjUzNCAxNjAgMTMxLjA2OCAxNjAgMTAwIDE2MEgxNjBaTTE2MCAxNjBDMTQzLjQ2NyAxNjAgMTI2LjkzNCAxNjAgMTAwIDE2MEgxNjBaTTEwMCAxNjBDMTAwIDE0My42NjEgMTAwIDEyNy4zMjEgMTAwIDEwMFYxNjBaIixzdHJva2U6eC5ibGFjayxzdHJva2VXaWR0aDoiMiJ9KSxhLmEuY3JlYXRlRWxlbWVudCgicmVjdCIse3g6IjIuNSIseToiMi41Iix3aWR0aDoiMzAiLGhlaWdodDoiMzAiLGZpbGw6eC53aGl0ZSxzdHJva2U6eC5ibGFjayxzdHJva2VXaWR0aDoiNiJ9KSxhLmEuY3JlYXRlRWxlbWVudCgicmVjdCIse3g6IjIuNSIseToiMTQ5LjUiLHdpZHRoOiIzMCIsaGVpZ2h0OiIzMCIsZmlsbDp4LndoaXRlLHN0cm9rZTp4LmJsYWNrLHN0cm9rZVdpZHRoOiI2In0pLGEuYS5jcmVhdGVFbGVtZW50KCJyZWN0Iix7eDoiMTQ3LjUiLHk6IjE0OS41Iix3aWR0aDoiMzAiLGhlaWdodDoiMzAiLGZpbGw6eC53aGl0ZSxzdHJva2U6eC5ibGFjayxzdHJva2VXaWR0aDoiNiJ9KSxhLmEuY3JlYXRlRWxlbWVudCgicmVjdCIse3g6IjE0Ny41Iix5OiIyLjUiLHdpZHRoOiIzMCIsaGVpZ2h0OiIzMCIsZmlsbDp4LndoaXRlLHN0cm9rZTp4LmJsYWNrLHN0cm9rZVdpZHRoOiI2In0pKSx7d2lkdGg6MTgyLGhlaWdodDoxODJ9KSxrZT1LKGEuYS5jcmVhdGVFbGVtZW50KGEuYS5GcmFnbWVudCxudWxsLGEuYS5jcmVhdGVFbGVtZW50KCJwYXRoIix7ZDoiTTI1IDI2SDExMVYxMTFIMjUiLGZpbGw6eC5ibGFja30pLGEuYS5jcmVhdGVFbGVtZW50KCJwYXRoIix7ZDoiTTI1IDExMUMyNSA4MC4yMDY4IDI1IDQ5LjQxMzUgMjUgMjZNMjUgMjZDNDguNjE3NCAyNiA3Mi4yMzQ4IDI2IDExMSAyNkgyNVpNMjUgMjZDNTMuMzY3MSAyNiA4MS43MzQzIDI2IDExMSAyNkgyNVpNMTExIDI2QzExMSA1Mi4zMDMgMTExIDc4LjYwNiAxMTEgMTExVjI2Wk0xMTEgMjZDMTExIDUxLjI5NDcgMTExIDc2LjU4OTMgMTExIDExMVYyNlpNMTExIDExMUM4Ny4wNzkyIDExMSA2My4xNTg1IDExMSAyNSAxMTFIMTExWk0xMTEgMTExQzg3LjQ2NDYgMTExIDYzLjkyOTMgMTExIDI1IDExMUgxMTFaTTI1IDExMUMyNSA4MS4xNTE0IDI1IDUxLjMwMjggMjUgMjZWMTExWiIsc3Ryb2tlOnguYmxhY2ssc3Ryb2tlV2lkdGg6IjIifSksYS5hLmNyZWF0ZUVsZW1lbnQoInBhdGgiLHtkOiJNMTAwIDEwMEgxNjBWMTYwSDEwMCIsZmlsbDp4LmJsYWNrfSksYS5hLmNyZWF0ZUVsZW1lbnQoInBhdGgiLHtkOiJNMTAwIDE2MEMxMDAgMTQ0LjEwNiAxMDAgMTI4LjIxMSAxMDAgMTAwTTEwMCAxMDBDMTE3LjcwNiAxMDAgMTM1LjQxMiAxMDAgMTYwIDEwMEgxMDBaTTEwMCAxMDBDMTE0LjIxNCAxMDAgMTI4LjQyOCAxMDAgMTYwIDEwMEgxMDBaTTE2MCAxMDBDMTYwIDEyMC4xODQgMTYwIDE0MC4zNjkgMTYwIDE2MFYxMDBaTTE2MCAxMDBDMTYwIDExMy4yMTkgMTYwIDEyNi40MzcgMTYwIDE2MFYxMDBaTTE2MCAxNjBDMTQ1LjUzNCAxNjAgMTMxLjA2OCAxNjAgMTAwIDE2MEgxNjBaTTE2MCAxNjBDMTQzLjQ2NyAxNjAgMTI2LjkzNCAxNjAgMTAwIDE2MEgxNjBaTTEwMCAxNjBDMTAwIDE0My42NjEgMTAwIDEyNy4zMjEgMTAwIDEwMFYxNjBaIixzdHJva2U6eC5ibGFjayxzdHJva2VXaWR0aDoiMiJ9KSxhLmEuY3JlYXRlRWxlbWVudCgicmVjdCIse3g6IjIuNSIseToiMi41Iix3aWR0aDoiMzAiLGhlaWdodDoiMzAiLGZpbGw6eC53aGl0ZSxzdHJva2U6eC5ibGFjayxzdHJva2VXaWR0aDoiNiJ9KSxhLmEuY3JlYXRlRWxlbWVudCgicmVjdCIse3g6Ijc4LjUiLHk6IjE0OS41Iix3aWR0aDoiMzAiLGhlaWdodDoiMzAiLGZpbGw6eC53aGl0ZSxzdHJva2U6eC5ibGFjayxzdHJva2VXaWR0aDoiNiJ9KSxhLmEuY3JlYXRlRWxlbWVudCgicmVjdCIse3g6IjE0Ny41Iix5OiIxNDkuNSIsd2lkdGg6IjMwIixoZWlnaHQ6IjMwIixmaWxsOngud2hpdGUsc3Ryb2tlOnguYmxhY2ssc3Ryb2tlV2lkdGg6IjYifSksYS5hLmNyZWF0ZUVsZW1lbnQoInJlY3QiLHt4OiIxNDcuNSIseToiNzguNSIsd2lkdGg6IjMwIixoZWlnaHQ6IjMwIixmaWxsOngud2hpdGUsc3Ryb2tlOnguYmxhY2ssc3Ryb2tlV2lkdGg6IjYifSksYS5hLmNyZWF0ZUVsZW1lbnQoInJlY3QiLHt4OiIxMDUuNSIseToiMi41Iix3aWR0aDoiMzAiLGhlaWdodDoiMzAiLGZpbGw6eC53aGl0ZSxzdHJva2U6eC5ibGFjayxzdHJva2VXaWR0aDoiNiJ9KSxhLmEuY3JlYXRlRWxlbWVudCgicmVjdCIse3g6IjIuNSIseToiMTAyLjUiLHdpZHRoOiIzMCIsaGVpZ2h0OiIzMCIsZmlsbDp4LndoaXRlLHN0cm9rZTp4LmJsYWNrLHN0cm9rZVdpZHRoOiI2In0pKSx7d2lkdGg6MTgyLGhlaWdodDoxODJ9KSx3ZT1bXSxTZT1mdW5jdGlvbihlKXtyZXR1cm4gd2U9d2UuY29uY2F0KGUpLGV9LEVlPW4oOCksT2U9bigxMiksQ2U9bigxNik7ZnVuY3Rpb24geGUoZSx0KXt2YXIgbj1PYmplY3Qua2V5cyhlKTtpZihPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgcj1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO3QmJihyPXIuZmlsdGVyKChmdW5jdGlvbih0KXtyZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihlLHQpLmVudW1lcmFibGV9KSkpLG4ucHVzaC5hcHBseShuLHIpfXJldHVybiBufWZ1bmN0aW9uIGplKGUpe2Zvcih2YXIgdD0xO3Q8YXJndW1lbnRzLmxlbmd0aDt0Kyspe3ZhciBuPW51bGwhPWFyZ3VtZW50c1t0XT9hcmd1bWVudHNbdF06e307dCUyP3hlKE9iamVjdChuKSwhMCkuZm9yRWFjaCgoZnVuY3Rpb24odCl7VGUoZSx0LG5bdF0pfSkpOk9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzP09iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGUsT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMobikpOnhlKE9iamVjdChuKSkuZm9yRWFjaCgoZnVuY3Rpb24odCl7T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsdCxPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG4sdCkpfSkpfXJldHVybiBlfWZ1bmN0aW9uIFRlKGUsdCxuKXtyZXR1cm4gdCBpbiBlP09iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHQse3ZhbHVlOm4sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITAsd3JpdGFibGU6ITB9KTplW3RdPW4sZX1mdW5jdGlvbiBQZShlLHQpe3ZhciBuO2lmKGUuZWRpdGluZ0dyb3VwSWQpe3ZhciByPU9iamVjdChPZS5iKShPYmplY3QoZi5uKSh0KSxlLmVkaXRpbmdHcm91cElkKTtpZihyLmxlbmd0aClyZXR1cm4gamUoamUoe30sZSkse30se3NlbGVjdGVkRWxlbWVudElkczoobj17fSxuW3JbMF0uaWRdPSEwLG4pfSl9cmV0dXJuIGV9dmFyIEFlPVNlKHtuYW1lOiJkZWxldGVTZWxlY3RlZEVsZW1lbnRzIixwZXJmb3JtOmZ1bmN0aW9uKGUsdCl7aWYodC5lZGl0aW5nTGluZWFyRWxlbWVudCl7dmFyIG49dC5lZGl0aW5nTGluZWFyRWxlbWVudCxyPW4uZWxlbWVudElkLG89bi5hY3RpdmVQb2ludEluZGV4LGE9Q2UuYS5nZXRFbGVtZW50KHIpO2lmKCFhKXJldHVybiExO2lmKG51bGw9PW98fC0xPT09b3x8YS5wb2ludHMubGVuZ3RoPDIpe3ZhciBpPWUuZmlsdGVyKChmdW5jdGlvbihlKXtyZXR1cm4gZS5pZCE9PWEuaWR9KSk7cmV0dXJue2VsZW1lbnRzOmksYXBwU3RhdGU6amUoamUoe30sUGUodCxpKSkse30se2VkaXRpbmdMaW5lYXJFbGVtZW50Om51bGx9KSxjb21taXRUb0hpc3Rvcnk6ITF9fXJldHVybiBDZS5hLm1vdmVQb2ludChhLG8sImRlbGV0ZSIpLHtlbGVtZW50czplLGFwcFN0YXRlOmplKGplKHt9LHQpLHt9LHtlZGl0aW5nTGluZWFyRWxlbWVudDpqZShqZSh7fSx0LmVkaXRpbmdMaW5lYXJFbGVtZW50KSx7fSx7YWN0aXZlUG9pbnRJbmRleDpvPjA/by0xOjB9KX0pLGNvbW1pdFRvSGlzdG9yeTohMH19dmFyIHM9ZnVuY3Rpb24oZSx0KXtyZXR1cm57ZWxlbWVudHM6ZS5tYXAoKGZ1bmN0aW9uKGUpe3JldHVybiB0LnNlbGVjdGVkRWxlbWVudElkc1tlLmlkXT9PYmplY3QoRWUuYikoZSx7aXNEZWxldGVkOiEwfSk6ZX0pKSxhcHBTdGF0ZTpqZShqZSh7fSx0KSx7fSx7c2VsZWN0ZWRFbGVtZW50SWRzOnt9fSl9fShlLHQpLGw9cy5lbGVtZW50cyxjPXMuYXBwU3RhdGU7cmV0dXJue2VsZW1lbnRzOmwsYXBwU3RhdGU6amUoamUoe30sYz1QZShjLGwpKSx7fSx7ZWxlbWVudFR5cGU6InNlbGVjdGlvbiIsbXVsdGlFbGVtZW50Om51bGx9KSxjb21taXRUb0hpc3Rvcnk6T2JqZWN0KG0ubikoT2JqZWN0KGYubikoZSksdCl9fSxjb250ZXh0SXRlbUxhYmVsOiJsYWJlbHMuZGVsZXRlIixjb250ZXh0TWVudU9yZGVyOjMsa2V5VGVzdDpmdW5jdGlvbihlKXtyZXR1cm4gZS5rZXk9PT1DLmEuQkFDS1NQQUNFfHxlLmtleT09PUMuYS5ERUxFVEV9LFBhbmVsQ29tcG9uZW50OmZ1bmN0aW9uKGUpe3ZhciB0PWUuZWxlbWVudHMsbj1lLmFwcFN0YXRlLHI9ZS51cGRhdGVEYXRhO3JldHVybiBhLmEuY3JlYXRlRWxlbWVudChVLHt0eXBlOiJidXR0b24iLGljb246JCx0aXRsZTpPYmplY3Qocy5lKSgibGFiZWxzLmRlbGV0ZSIpLCJhcmlhLWxhYmVsIjpPYmplY3Qocy5lKSgibGFiZWxzLmRlbGV0ZSIpLG9uQ2xpY2s6ZnVuY3Rpb24oKXtyZXR1cm4gcihudWxsKX0sdmlzaWJsZTpPYmplY3QobS5uKShPYmplY3QoZi5uKSh0KSxuKX0pfX0pLE1lPWZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1lW3RdO2VbdF09ZVtuXSxlW25dPXJ9LF9lPWZ1bmN0aW9uKGUsdCl7dC5zb3J0KChmdW5jdGlvbihlLHQpe3JldHVybiBlLXR9KSk7dmFyIG49ITA7cmV0dXJuIHQuZm9yRWFjaCgoZnVuY3Rpb24odCxyKXsobj1uJiZ0PT09cil8fE1lKGUsdC0xLHQpfSkpLGV9LHplPWZ1bmN0aW9uKGUsdCl7dmFyIG49dC5zb3J0KChmdW5jdGlvbihlLHQpe3JldHVybiB0LWV9KSkscj0hMDtyZXR1cm4gbi5mb3JFYWNoKChmdW5jdGlvbih0LG4peyhyPXImJnQ9PT1lLmxlbmd0aC1uLTEpfHxNZShlLHQrMSx0KX0pKSxlfSxMZT1mdW5jdGlvbihlLHQpe3Quc29ydCgoZnVuY3Rpb24oZSx0KXtyZXR1cm4gZS10fSkpO3ZhciBuPXQubWFwKChmdW5jdGlvbih0KXtyZXR1cm4gZVt0XX0pKSxyPXQucmV2ZXJzZSgpLmNvbmNhdChbMF0pO3JldHVybiByLmZvckVhY2goKGZ1bmN0aW9uKHQsbil7aWYoMCE9PW4pZm9yKHZhciBvPXJbbi0xXS0xO28+PXQ7LS1vKWVbbytuXT1lW29dfSkpLG4uZm9yRWFjaCgoZnVuY3Rpb24odCxuKXtlW25dPXR9KSksZX0sSWU9ZnVuY3Rpb24oZSx0KXt2YXIgbj10LnNvcnQoKGZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQtZX0pKSxyPW4ubWFwKChmdW5jdGlvbih0KXtyZXR1cm4gZVt0XX0pKTtyZXR1cm4odD1uLnJldmVyc2UoKS5jb25jYXQoW2UubGVuZ3RoXSkpLmZvckVhY2goKGZ1bmN0aW9uKG4scil7aWYoMCE9PXIpZm9yKHZhciBvPXRbci0xXSsxO288bjsrK28pZVtvLXJdPWVbb119KSksci5mb3JFYWNoKChmdW5jdGlvbih0LG4pe2VbZS5sZW5ndGgtbi0xXT10fSkpLGV9LERlPWZ1bmN0aW9uKCl7Zm9yKHZhciBlPTAsdD0wLG49YXJndW1lbnRzLmxlbmd0aDt0PG47dCsrKWUrPWFyZ3VtZW50c1t0XS5sZW5ndGg7dmFyIHI9QXJyYXkoZSksbz0wO2Zvcih0PTA7dDxuO3QrKylmb3IodmFyIGE9YXJndW1lbnRzW3RdLGk9MCxzPWEubGVuZ3RoO2k8cztpKyssbysrKXJbb109YVtpXTtyZXR1cm4gcn0sTmU9ZnVuY3Rpb24oZSx0LG4pe3ZhciByPXQuc2xpY2UoKTtyZXR1cm4gZShyLGZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1bXSxvPVtdLGE9ZnVuY3Rpb24oZSx0KXtlLmlzRGVsZXRlZD9vLnB1c2godCk6KG4uc2VsZWN0ZWRFbGVtZW50SWRzW2UuaWRdJiZyLnB1c2guYXBwbHkocixEZShvLFt0XSkpLG89W10pfTtpZigibGVmdCI9PT1lKWZvcih2YXIgaT0tMSxzPXQubGVuZ3RoOysraTxzOylhKHRbaV0saSk7ZWxzZSBmb3IoaT10Lmxlbmd0aDstLWk+LTE7KWEodFtpXSxpKTtyZXR1cm4gci5zb3J0KCl9KGU9PT1fZXx8ZT09PUxlPyJsZWZ0IjoicmlnaHQiLHIsbikpfTtTZSh7bmFtZToic2VuZEJhY2t3YXJkIixwZXJmb3JtOmZ1bmN0aW9uKGUsdCl7cmV0dXJue2VsZW1lbnRzOk5lKF9lLGUsdCksYXBwU3RhdGU6dCxjb21taXRUb0hpc3Rvcnk6ITB9fSxjb250ZXh0SXRlbUxhYmVsOiJsYWJlbHMuc2VuZEJhY2t3YXJkIixrZXlQcmlvcml0eTo0MCxrZXlUZXN0OmZ1bmN0aW9uKGUpe3JldHVybiBlW0MuYS5DVFJMX09SX0NNRF0mJiFlLnNoaWZ0S2V5JiYiQnJhY2tldExlZnQiPT09ZS5jb2RlfSxQYW5lbENvbXBvbmVudDpmdW5jdGlvbihlKXt2YXIgdD1lLnVwZGF0ZURhdGE7cmV0dXJuIGEuYS5jcmVhdGVFbGVtZW50KCJidXR0b24iLHt0eXBlOiJidXR0b24iLGNsYXNzTmFtZToiekluZGV4QnV0dG9uIixvbkNsaWNrOmZ1bmN0aW9uKCl7cmV0dXJuIHQobnVsbCl9LHRpdGxlOiIiLmNvbmNhdChPYmplY3Qocy5lKSgibGFiZWxzLnNlbmRCYWNrd2FyZCIpLCIg4oCUICIpLmNvbmNhdChPYmplY3QoTy5rKSgiQ3RybE9yQ21kK1siKSl9LGNlKX19KSxTZSh7bmFtZToiYnJpbmdGb3J3YXJkIixwZXJmb3JtOmZ1bmN0aW9uKGUsdCl7cmV0dXJue2VsZW1lbnRzOk5lKHplLGUsdCksYXBwU3RhdGU6dCxjb21taXRUb0hpc3Rvcnk6ITB9fSxjb250ZXh0SXRlbUxhYmVsOiJsYWJlbHMuYnJpbmdGb3J3YXJkIixrZXlQcmlvcml0eTo0MCxrZXlUZXN0OmZ1bmN0aW9uKGUpe3JldHVybiBlW0MuYS5DVFJMX09SX0NNRF0mJiFlLnNoaWZ0S2V5JiYiQnJhY2tldFJpZ2h0Ij09PWUuY29kZX0sUGFuZWxDb21wb25lbnQ6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS51cGRhdGVEYXRhO3JldHVybiBhLmEuY3JlYXRlRWxlbWVudCgiYnV0dG9uIix7dHlwZToiYnV0dG9uIixjbGFzc05hbWU6InpJbmRleEJ1dHRvbiIsb25DbGljazpmdW5jdGlvbigpe3JldHVybiB0KG51bGwpfSx0aXRsZToiIi5jb25jYXQoT2JqZWN0KHMuZSkoImxhYmVscy5icmluZ0ZvcndhcmQiKSwiIOKAlCAiKS5jb25jYXQoT2JqZWN0KE8uaykoIkN0cmxPckNtZCtdIikpfSxsZSl9fSksU2Uoe25hbWU6InNlbmRUb0JhY2siLHBlcmZvcm06ZnVuY3Rpb24oZSx0KXtyZXR1cm57ZWxlbWVudHM6TmUoTGUsZSx0KSxhcHBTdGF0ZTp0LGNvbW1pdFRvSGlzdG9yeTohMH19LGNvbnRleHRJdGVtTGFiZWw6ImxhYmVscy5zZW5kVG9CYWNrIixrZXlUZXN0OmZ1bmN0aW9uKGUpe3JldHVybiBDLmY/ZVtDLmEuQ1RSTF9PUl9DTURdJiZlLmFsdEtleSYmIkJyYWNrZXRMZWZ0Ij09PWUuY29kZTplW0MuYS5DVFJMX09SX0NNRF0mJmUuc2hpZnRLZXkmJiJCcmFja2V0TGVmdCI9PT1lLmNvZGV9LFBhbmVsQ29tcG9uZW50OmZ1bmN0aW9uKGUpe3ZhciB0PWUudXBkYXRlRGF0YTtyZXR1cm4gYS5hLmNyZWF0ZUVsZW1lbnQoImJ1dHRvbiIse3R5cGU6ImJ1dHRvbiIsY2xhc3NOYW1lOiJ6SW5kZXhCdXR0b24iLG9uQ2xpY2s6ZnVuY3Rpb24oKXtyZXR1cm4gdChudWxsKX0sdGl0bGU6IiIuY29uY2F0KE9iamVjdChzLmUpKCJsYWJlbHMuc2VuZFRvQmFjayIpLCIg4oCUICIpLmNvbmNhdChDLmY/T2JqZWN0KE8uaykoIkN0cmxPckNtZCtBbHQrWyIpOk9iamVjdChPLmspKCJDdHJsT3JDbWQrU2hpZnQrWyIpKX0sZGUpfX0pLFNlKHtuYW1lOiJicmluZ1RvRnJvbnQiLHBlcmZvcm06ZnVuY3Rpb24oZSx0KXtyZXR1cm57ZWxlbWVudHM6TmUoSWUsZSx0KSxhcHBTdGF0ZTp0LGNvbW1pdFRvSGlzdG9yeTohMH19LGNvbnRleHRJdGVtTGFiZWw6ImxhYmVscy5icmluZ1RvRnJvbnQiLGtleVRlc3Q6ZnVuY3Rpb24oZSl7cmV0dXJuIEMuZj9lW0MuYS5DVFJMX09SX0NNRF0mJmUuYWx0S2V5JiYiQnJhY2tldFJpZ2h0Ij09PWUuY29kZTplW0MuYS5DVFJMX09SX0NNRF0mJmUuc2hpZnRLZXkmJiJCcmFja2V0UmlnaHQiPT09ZS5jb2RlfSxQYW5lbENvbXBvbmVudDpmdW5jdGlvbihlKXt2YXIgdD1lLnVwZGF0ZURhdGE7cmV0dXJuIGEuYS5jcmVhdGVFbGVtZW50KCJidXR0b24iLHt0eXBlOiJidXR0b24iLGNsYXNzTmFtZToiekluZGV4QnV0dG9uIixvbkNsaWNrOmZ1bmN0aW9uKGUpe3JldHVybiB0KG51bGwpfSx0aXRsZToiIi5jb25jYXQoT2JqZWN0KHMuZSkoImxhYmVscy5icmluZ1RvRnJvbnQiKSwiIOKAlCAiKS5jb25jYXQoQy5mP09iamVjdChPLmspKCJDdHJsT3JDbWQrQWx0K10iKTpPYmplY3QoTy5rKSgiQ3RybE9yQ21kK1NoaWZ0K10iKSl9LHVlKX19KTtmdW5jdGlvbiBGZShlLHQpe3ZhciBuPU9iamVjdC5rZXlzKGUpO2lmKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpe3ZhciByPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7dCYmKHI9ci5maWx0ZXIoKGZ1bmN0aW9uKHQpe3JldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGUsdCkuZW51bWVyYWJsZX0pKSksbi5wdXNoLmFwcGx5KG4scil9cmV0dXJuIG59ZnVuY3Rpb24gUmUoZSl7Zm9yKHZhciB0PTE7dDxhcmd1bWVudHMubGVuZ3RoO3QrKyl7dmFyIG49bnVsbCE9YXJndW1lbnRzW3RdP2FyZ3VtZW50c1t0XTp7fTt0JTI/RmUoT2JqZWN0KG4pLCEwKS5mb3JFYWNoKChmdW5jdGlvbih0KXtCZShlLHQsblt0XSl9KSk6T2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnM/T2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZSxPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhuKSk6RmUoT2JqZWN0KG4pKS5mb3JFYWNoKChmdW5jdGlvbih0KXtPYmplY3QuZGVmaW5lUHJvcGVydHkoZSx0LE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iobix0KSl9KSl9cmV0dXJuIGV9ZnVuY3Rpb24gQmUoZSx0LG4pe3JldHVybiB0IGluIGU/T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsdCx7dmFsdWU6bixlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMCx3cml0YWJsZTohMH0pOmVbdF09bixlfVNlKHtuYW1lOiJzZWxlY3RBbGwiLHBlcmZvcm06ZnVuY3Rpb24oZSx0KXtyZXR1cm4hdC5lZGl0aW5nTGluZWFyRWxlbWVudCYme2FwcFN0YXRlOk9iamVjdChPZS5qKShSZShSZSh7fSx0KSx7fSx7ZWRpdGluZ0dyb3VwSWQ6bnVsbCxzZWxlY3RlZEVsZW1lbnRJZHM6ZS5yZWR1Y2UoKGZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQuaXNEZWxldGVkfHwoZVt0LmlkXT0hMCksZX0pLHt9KX0pLE9iamVjdChmLm4pKGUpKSxjb21taXRUb0hpc3Rvcnk6ITB9fSxjb250ZXh0SXRlbUxhYmVsOiJsYWJlbHMuc2VsZWN0QWxsIixrZXlUZXN0OmZ1bmN0aW9uKGUpe3JldHVybiBlW0MuYS5DVFJMX09SX0NNRF0mJiJhIj09PWUua2V5fX0pO3ZhciBIZT1mdW5jdGlvbigpe2Zvcih2YXIgZT0wLHQ9MCxuPWFyZ3VtZW50cy5sZW5ndGg7dDxuO3QrKyllKz1hcmd1bWVudHNbdF0ubGVuZ3RoO3ZhciByPUFycmF5KGUpLG89MDtmb3IodD0wO3Q8bjt0KyspZm9yKHZhciBhPWFyZ3VtZW50c1t0XSxpPTAscz1hLmxlbmd0aDtpPHM7aSsrLG8rKylyW29dPWFbaV07cmV0dXJuIHJ9O2Z1bmN0aW9uIEdlKGUsdCl7dmFyIG49T2JqZWN0LmtleXMoZSk7aWYoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyl7dmFyIHI9T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhlKTt0JiYocj1yLmZpbHRlcigoZnVuY3Rpb24odCl7cmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoZSx0KS5lbnVtZXJhYmxlfSkpKSxuLnB1c2guYXBwbHkobixyKX1yZXR1cm4gbn1mdW5jdGlvbiBXZShlKXtmb3IodmFyIHQ9MTt0PGFyZ3VtZW50cy5sZW5ndGg7dCsrKXt2YXIgbj1udWxsIT1hcmd1bWVudHNbdF0/YXJndW1lbnRzW3RdOnt9O3QlMj9HZShPYmplY3QobiksITApLmZvckVhY2goKGZ1bmN0aW9uKHQpe1VlKGUsdCxuW3RdKX0pKTpPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycz9PYmplY3QuZGVmaW5lUHJvcGVydGllcyhlLE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKG4pKTpHZShPYmplY3QobikpLmZvckVhY2goKGZ1bmN0aW9uKHQpe09iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHQsT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihuLHQpKX0pKX1yZXR1cm4gZX1mdW5jdGlvbiBVZShlLHQsbil7cmV0dXJuIHQgaW4gZT9PYmplY3QuZGVmaW5lUHJvcGVydHkoZSx0LHt2YWx1ZTpuLGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwLHdyaXRhYmxlOiEwfSk6ZVt0XT1uLGV9U2Uoe25hbWU6ImR1cGxpY2F0ZVNlbGVjdGlvbiIscGVyZm9ybTpmdW5jdGlvbihlLHQpe2lmKHQuZWRpdGluZ0xpbmVhckVsZW1lbnQpe3ZhciBuPXQuZWRpdGluZ0xpbmVhckVsZW1lbnQscj1uLmFjdGl2ZVBvaW50SW5kZXgsbz1uLmVsZW1lbnRJZCxhPUNlLmEuZ2V0RWxlbWVudChvKTtpZighYXx8bnVsbD09PXIpcmV0dXJuITE7dmFyIGk9YS5wb2ludHMscz1pW3JdLGw9aVtyKzFdO3JldHVybiBPYmplY3QoRWUuYSkoYSx7cG9pbnRzOkhlKGkuc2xpY2UoMCxyKzEpLFtsP1soc1swXStsWzBdKS8yLChzWzFdK2xbMV0pLzJdOltzWzBdKzMwLHNbMV0rMzBdXSxpLnNsaWNlKHIrMSkpfSkse2FwcFN0YXRlOldlKFdlKHt9LHQpLHt9LHtlZGl0aW5nTGluZWFyRWxlbWVudDpXZShXZSh7fSx0LmVkaXRpbmdMaW5lYXJFbGVtZW50KSx7fSx7YWN0aXZlUG9pbnRJbmRleDpyKzF9KX0pLGVsZW1lbnRzOmUsY29tbWl0VG9IaXN0b3J5OiEwfX12YXIgYz1uZXcgTWFwO3JldHVybnthcHBTdGF0ZTp0LGVsZW1lbnRzOmUucmVkdWNlKChmdW5jdGlvbihlLG4pe2lmKHQuc2VsZWN0ZWRFbGVtZW50SWRzW24uaWRdKXt2YXIgcj1PYmplY3QoZi5kKSh0LmVkaXRpbmdHcm91cElkLGMsbix7eDpuLngrMTAseTpuLnkrMTB9KTtyZXR1cm4gdC5zZWxlY3RlZEVsZW1lbnRJZHNbci5pZF09ITAsZGVsZXRlIHQuc2VsZWN0ZWRFbGVtZW50SWRzW24uaWRdLGUuY29uY2F0KFtuLHJdKX1yZXR1cm4gZS5jb25jYXQobil9KSxbXSksY29tbWl0VG9IaXN0b3J5OiEwfX0sY29udGV4dEl0ZW1MYWJlbDoibGFiZWxzLmR1cGxpY2F0ZVNlbGVjdGlvbiIsa2V5VGVzdDpmdW5jdGlvbihlKXtyZXR1cm4gZVtDLmEuQ1RSTF9PUl9DTURdJiYiZCI9PT1lLmtleX0sUGFuZWxDb21wb25lbnQ6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5lbGVtZW50cyxuPWUuYXBwU3RhdGUscj1lLnVwZGF0ZURhdGE7cmV0dXJuIGEuYS5jcmVhdGVFbGVtZW50KFUse3R5cGU6ImJ1dHRvbiIsaWNvbjpiZSx0aXRsZToiIi5jb25jYXQoT2JqZWN0KHMuZSkoImxhYmVscy5kdXBsaWNhdGVTZWxlY3Rpb24iKSwiIOKAlCAiKS5jb25jYXQoT2JqZWN0KE8uaykoIkN0cmxPckNtZCtEIikpLCJhcmlhLWxhYmVsIjpPYmplY3Qocy5lKSgibGFiZWxzLmR1cGxpY2F0ZVNlbGVjdGlvbiIpLG9uQ2xpY2s6ZnVuY3Rpb24oKXtyZXR1cm4gcihudWxsKX0sdmlzaWJsZTpPYmplY3QobS5uKShPYmplY3QoZi5uKSh0KSxuKX0pfX0pO3ZhciBWZT1mdW5jdGlvbihlKXt2YXIgdD1lLm9wdGlvbnMsbj1lLnZhbHVlLHI9ZS5vbkNoYW5nZSxvPWUuZ3JvdXA7cmV0dXJuIGEuYS5jcmVhdGVFbGVtZW50KCJkaXYiLHtjbGFzc05hbWU6ImJ1dHRvbkxpc3QifSx0Lm1hcCgoZnVuY3Rpb24oZSl7cmV0dXJuIGEuYS5jcmVhdGVFbGVtZW50KCJsYWJlbCIse2tleTplLnRleHQsY2xhc3NOYW1lOm49PT1lLnZhbHVlPyJhY3RpdmUiOiIifSxhLmEuY3JlYXRlRWxlbWVudCgiaW5wdXQiLHt0eXBlOiJyYWRpbyIsbmFtZTpvLG9uQ2hhbmdlOmZ1bmN0aW9uKCl7cmV0dXJuIHIoZS52YWx1ZSl9LGNoZWNrZWQ6bj09PWUudmFsdWV9KSxlLnRleHQpfSkpKX0sS2U9KG4oNzEpLG4oMzkpKSxaZT1mdW5jdGlvbihlKXt2YXIgdD0obmV3IE9wdGlvbikuc3R5bGU7cmV0dXJuIHQuY29sb3I9ZSwhIXQuY29sb3J9LHFlPVtbIjEiLCIyIiwiMyIsIjQiLCI1Il0sWyJxIiwidyIsImUiLCJyIiwidCJdLFsiYSIsInMiLCJkIiwiZiIsImciXV0uZmxhdCgpLFllPWZ1bmN0aW9uKGUpe3ZhciB0PWUuY29sb3JzLG49ZS5jb2xvcixyPWUub25DaGFuZ2Usbz1lLm9uQ2xvc2UsaT1lLmxhYmVsLGw9ZS5zaG93SW5wdXQsYz12b2lkIDA9PT1sfHxsLHU9YS5hLnVzZVJlZigpLGQ9YS5hLnVzZVJlZigpLHA9YS5hLnVzZVJlZigpLGg9YS5hLnVzZVJlZigpO2EuYS51c2VFZmZlY3QoKGZ1bmN0aW9uKCl7ZC5jdXJyZW50P2QuY3VycmVudC5mb2N1cygpOmguY3VycmVudCYmaC5jdXJyZW50LmZvY3VzKCl9KSxbXSk7cmV0dXJuIGEuYS5jcmVhdGVFbGVtZW50KCJkaXYiLHtjbGFzc05hbWU6ImNvbG9yLXBpY2tlciIscm9sZToiZGlhbG9nIiwiYXJpYS1tb2RhbCI6InRydWUiLCJhcmlhLWxhYmVsIjpPYmplY3Qocy5lKSgibGFiZWxzLmNvbG9yUGlja2VyIiksb25LZXlEb3duOmZ1bmN0aW9uKGUpe2lmKGUua2V5PT09Qy5hLlRBQil7dmFyIHQsbixyPWRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7aWYoZS5zaGlmdEtleSl7aWYocj09PXUuY3VycmVudCludWxsPT09KHQ9aC5jdXJyZW50KXx8dm9pZCAwPT09dHx8dC5mb2N1cygpLGUucHJldmVudERlZmF1bHQoKX1lbHNlIGlmKHI9PT1oLmN1cnJlbnQpbnVsbD09PShuPXUuY3VycmVudCl8fHZvaWQgMD09PW58fG4uZm9jdXMoKSxlLnByZXZlbnREZWZhdWx0KCl9ZWxzZSBpZihlLmtleT09PUMuYS5BUlJPV19SSUdIVHx8ZS5rZXk9PT1DLmEuQVJST1dfTEVGVHx8ZS5rZXk9PT1DLmEuQVJST1dfVVB8fGUua2V5PT09Qy5hLkFSUk9XX0RPV04pe3I9ZG9jdW1lbnQuYWN0aXZlRWxlbWVudDt2YXIgYT1PYmplY3Qocy5hKSgpLnJ0bDtpZigtMSE9PShkPUFycmF5LnByb3RvdHlwZS5pbmRleE9mLmNhbGwocC5jdXJyZW50LmNoaWxkcmVuLHIpKSl7dmFyIGk9cC5jdXJyZW50LmNoaWxkcmVuLmxlbmd0aC0oYz8xOjApLGw9ZS5rZXk9PT0oYT9DLmEuQVJST1dfTEVGVDpDLmEuQVJST1dfUklHSFQpPyhkKzEpJWk6ZS5rZXk9PT0oYT9DLmEuQVJST1dfUklHSFQ6Qy5hLkFSUk9XX0xFRlQpPyhpK2QtMSklaTplLmtleT09PUMuYS5BUlJPV19ET1dOPyhkKzUpJWk6ZS5rZXk9PT1DLmEuQVJST1dfVVA/KGkrZC01KSVpOmQ7cC5jdXJyZW50LmNoaWxkcmVuW2xdLmZvY3VzKCl9ZS5wcmV2ZW50RGVmYXVsdCgpfWVsc2UgaWYocWUuaW5jbHVkZXMoZS5rZXkudG9Mb3dlckNhc2UoKSkmJiFPYmplY3QoTy5wKShlLnRhcmdldCkpe3ZhciBkPXFlLmluZGV4T2YoZS5rZXkudG9Mb3dlckNhc2UoKSk7cC5jdXJyZW50LmNoaWxkcmVuW2RdLmZvY3VzKCksZS5wcmV2ZW50RGVmYXVsdCgpfWVsc2UgZS5rZXkhPT1DLmEuRVNDQVBFJiZlLmtleSE9PUMuYS5FTlRFUnx8KGUucHJldmVudERlZmF1bHQoKSxvKCkpO2UubmF0aXZlRXZlbnQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCl9fSxhLmEuY3JlYXRlRWxlbWVudCgiZGl2Iix7Y2xhc3NOYW1lOiJjb2xvci1waWNrZXItdHJpYW5nbGUgY29sb3ItcGlja2VyLXRyaWFuZ2xlLXNoYWRvdyJ9KSxhLmEuY3JlYXRlRWxlbWVudCgiZGl2Iix7Y2xhc3NOYW1lOiJjb2xvci1waWNrZXItdHJpYW5nbGUifSksYS5hLmNyZWF0ZUVsZW1lbnQoImRpdiIse2NsYXNzTmFtZToiY29sb3ItcGlja2VyLWNvbnRlbnQiLHJlZjpmdW5jdGlvbihlKXtlJiYocC5jdXJyZW50PWUpfX0sdC5tYXAoKGZ1bmN0aW9uKGUsdCl7cmV0dXJuIGEuYS5jcmVhdGVFbGVtZW50KCJidXR0b24iLHtjbGFzc05hbWU6ImNvbG9yLXBpY2tlci1zd2F0Y2giLG9uQ2xpY2s6ZnVuY3Rpb24odCl7dC5jdXJyZW50VGFyZ2V0LmZvY3VzKCkscihlKX0sdGl0bGU6IiIuY29uY2F0KGUsIiDigJQgIikuY29uY2F0KHFlW3RdLnRvVXBwZXJDYXNlKCkpLCJhcmlhLWxhYmVsIjplLCJhcmlhLWtleXNob3J0Y3V0cyI6cWVbdF0sc3R5bGU6e2NvbG9yOmV9LGtleTplLHJlZjpmdW5jdGlvbihyKXtyJiYwPT09dCYmKHUuY3VycmVudD1yKSxyJiZlPT09biYmKGQuY3VycmVudD1yKX0sb25Gb2N1czpmdW5jdGlvbigpe3IoZSl9fSwidHJhbnNwYXJlbnQiPT09ZT9hLmEuY3JlYXRlRWxlbWVudCgiZGl2Iix7Y2xhc3NOYW1lOiJjb2xvci1waWNrZXItdHJhbnNwYXJlbnQifSk6dm9pZCAwLGEuYS5jcmVhdGVFbGVtZW50KCJzcGFuIix7Y2xhc3NOYW1lOiJjb2xvci1waWNrZXIta2V5YmluZGluZyJ9LHFlW3RdKSl9KSksYyYmYS5hLmNyZWF0ZUVsZW1lbnQoWGUse2NvbG9yOm4sbGFiZWw6aSxvbkNoYW5nZTpmdW5jdGlvbihlKXtyKGUpfSxyZWY6aH0pKSl9LFhlPWEuYS5mb3J3YXJkUmVmKChmdW5jdGlvbihlLHQpe3ZhciBuPWUuY29sb3Iscj1lLm9uQ2hhbmdlLG89ZS5sYWJlbCxpPWEuYS51c2VTdGF0ZShuKSxzPWlbMF0sbD1pWzFdLGM9YS5hLnVzZVJlZihudWxsKTthLmEudXNlRWZmZWN0KChmdW5jdGlvbigpe2wobil9KSxbbl0pLGEuYS51c2VJbXBlcmF0aXZlSGFuZGxlKHQsKGZ1bmN0aW9uKCl7cmV0dXJuIGMuY3VycmVudH0pKTt2YXIgdT1hLmEudXNlQ2FsbGJhY2soKGZ1bmN0aW9uKGUpe3ZhciB0PWUudG9Mb3dlckNhc2UoKSxuPWZ1bmN0aW9uKGUpe3JldHVybiJ0cmFuc3BhcmVudCI9PT1lfHxaZShlKT9lOlplKCIjIi5jb25jYXQoZSkpPyIjIi5jb25jYXQoZSk6bnVsbH0odCk7biYmcihuKSxsKHQpfSksW3JdKTtyZXR1cm4gYS5hLmNyZWF0ZUVsZW1lbnQoImxhYmVsIix7Y2xhc3NOYW1lOiJjb2xvci1pbnB1dC1jb250YWluZXIifSxhLmEuY3JlYXRlRWxlbWVudCgiZGl2Iix7Y2xhc3NOYW1lOiJjb2xvci1waWNrZXItaGFzaCJ9LCIjIiksYS5hLmNyZWF0ZUVsZW1lbnQoImlucHV0Iix7c3BlbGxDaGVjazohMSxjbGFzc05hbWU6ImNvbG9yLXBpY2tlci1pbnB1dCIsImFyaWEtbGFiZWwiOm8sb25DaGFuZ2U6ZnVuY3Rpb24oZSl7cmV0dXJuIHUoZS50YXJnZXQudmFsdWUpfSx2YWx1ZTooc3x8IiIpLnJlcGxhY2UoL14jLywiIiksb25CbHVyOmZ1bmN0aW9uKCl7cmV0dXJuIGwobil9LHJlZjpjfSkpfSkpLEplPWZ1bmN0aW9uKGUpe3ZhciB0PWUudHlwZSxuPWUuY29sb3Iscj1lLm9uQ2hhbmdlLG89ZS5sYWJlbCxpPWEuYS51c2VTdGF0ZSghMSkscz1pWzBdLGw9aVsxXSxjPWEuYS51c2VSZWYobnVsbCk7cmV0dXJuIGEuYS5jcmVhdGVFbGVtZW50KCJkaXYiLG51bGwsYS5hLmNyZWF0ZUVsZW1lbnQoImRpdiIse2NsYXNzTmFtZToiY29sb3ItcGlja2VyLWNvbnRyb2wtY29udGFpbmVyIn0sYS5hLmNyZWF0ZUVsZW1lbnQoImJ1dHRvbiIse2NsYXNzTmFtZToiY29sb3ItcGlja2VyLWxhYmVsLXN3YXRjaCIsImFyaWEtbGFiZWwiOm8sc3R5bGU6bj97Ii0tc3dhdGNoLWNvbG9yIjpufTp2b2lkIDAsb25DbGljazpmdW5jdGlvbigpe3JldHVybiBsKCFzKX0scmVmOmN9KSxhLmEuY3JlYXRlRWxlbWVudChYZSx7Y29sb3I6bixsYWJlbDpvLG9uQ2hhbmdlOmZ1bmN0aW9uKGUpe3IoZSl9fSkpLGEuYS5jcmVhdGVFbGVtZW50KGEuYS5TdXNwZW5zZSx7ZmFsbGJhY2s6IiJ9LHM/YS5hLmNyZWF0ZUVsZW1lbnQoTix7b25DbG9zZVJlcXVlc3Q6ZnVuY3Rpb24oZSl7cmV0dXJuIGUudGFyZ2V0IT09Yy5jdXJyZW50JiZsKCExKX19LGEuYS5jcmVhdGVFbGVtZW50KFllLHtjb2xvcnM6S2UuYVt0XSxjb2xvcjpufHxudWxsLG9uQ2hhbmdlOmZ1bmN0aW9uKGUpe3IoZSl9LG9uQ2xvc2U6ZnVuY3Rpb24oKXt2YXIgZTtsKCExKSxudWxsPT09KGU9Yy5jdXJyZW50KXx8dm9pZCAwPT09ZXx8ZS5mb2N1cygpfSxsYWJlbDpvLHNob3dJbnB1dDohMX0pKTpudWxsKSl9O2Z1bmN0aW9uICRlKGUsdCl7dmFyIG49T2JqZWN0LmtleXMoZSk7aWYoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyl7dmFyIHI9T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhlKTt0JiYocj1yLmZpbHRlcigoZnVuY3Rpb24odCl7cmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoZSx0KS5lbnVtZXJhYmxlfSkpKSxuLnB1c2guYXBwbHkobixyKX1yZXR1cm4gbn1mdW5jdGlvbiBRZShlKXtmb3IodmFyIHQ9MTt0PGFyZ3VtZW50cy5sZW5ndGg7dCsrKXt2YXIgbj1udWxsIT1hcmd1bWVudHNbdF0/YXJndW1lbnRzW3RdOnt9O3QlMj8kZShPYmplY3QobiksITApLmZvckVhY2goKGZ1bmN0aW9uKHQpe2V0KGUsdCxuW3RdKX0pKTpPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycz9PYmplY3QuZGVmaW5lUHJvcGVydGllcyhlLE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKG4pKTokZShPYmplY3QobikpLmZvckVhY2goKGZ1bmN0aW9uKHQpe09iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHQsT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihuLHQpKX0pKX1yZXR1cm4gZX1mdW5jdGlvbiBldChlLHQsbil7cmV0dXJuIHQgaW4gZT9PYmplY3QuZGVmaW5lUHJvcGVydHkoZSx0LHt2YWx1ZTpuLGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwLHdyaXRhYmxlOiEwfSk6ZVt0XT1uLGV9dmFyIHR0PWZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gZS5tYXAoKGZ1bmN0aW9uKGUpe3ZhciByO3JldHVybiB0LnNlbGVjdGVkRWxlbWVudElkc1tlLmlkXXx8ZS5pZD09PShudWxsPT09KHI9dC5lZGl0aW5nRWxlbWVudCl8fHZvaWQgMD09PXI/dm9pZCAwOnIuaWQpP24oZSk6ZX0pKX0sbnQ9ZnVuY3Rpb24oZSx0LG4scil7dmFyIG8sYSxpPXQuZWRpdGluZ0VsZW1lbnQscz1PYmplY3QoZi5uKShlKTtyZXR1cm4gbnVsbCE9PShvPW51bGwhPT0oYT1pJiZuKGkpKSYmdm9pZCAwIT09YT9hOk9iamVjdChtLm4pKHMsdCk/T2JqZWN0KG0uYikocyx0LG4pOnIpJiZ2b2lkIDAhPT1vP286bnVsbH0scnQ9KFNlKHtuYW1lOiJjaGFuZ2VTdHJva2VDb2xvciIscGVyZm9ybTpmdW5jdGlvbihlLHQsbil7cmV0dXJue2VsZW1lbnRzOnR0KGUsdCwoZnVuY3Rpb24oZSl7cmV0dXJuIE9iamVjdChFZS5iKShlLHtzdHJva2VDb2xvcjpufSl9KSksYXBwU3RhdGU6UWUoUWUoe30sdCkse30se2N1cnJlbnRJdGVtU3Ryb2tlQ29sb3I6bn0pLGNvbW1pdFRvSGlzdG9yeTohMH19LFBhbmVsQ29tcG9uZW50OmZ1bmN0aW9uKGUpe3ZhciB0PWUuZWxlbWVudHMsbj1lLmFwcFN0YXRlLHI9ZS51cGRhdGVEYXRhO3JldHVybiBhLmEuY3JlYXRlRWxlbWVudChhLmEuRnJhZ21lbnQsbnVsbCxhLmEuY3JlYXRlRWxlbWVudCgiaDMiLHsiYXJpYS1oaWRkZW4iOiJ0cnVlIn0sT2JqZWN0KHMuZSkoImxhYmVscy5zdHJva2UiKSksYS5hLmNyZWF0ZUVsZW1lbnQoSmUse3R5cGU6ImVsZW1lbnRTdHJva2UiLGxhYmVsOk9iamVjdChzLmUpKCJsYWJlbHMuc3Ryb2tlIiksY29sb3I6bnQodCxuLChmdW5jdGlvbihlKXtyZXR1cm4gZS5zdHJva2VDb2xvcn0pLG4uY3VycmVudEl0ZW1TdHJva2VDb2xvciksb25DaGFuZ2U6cn0pKX19KSxTZSh7bmFtZToiY2hhbmdlQmFja2dyb3VuZENvbG9yIixwZXJmb3JtOmZ1bmN0aW9uKGUsdCxuKXtyZXR1cm57ZWxlbWVudHM6dHQoZSx0LChmdW5jdGlvbihlKXtyZXR1cm4gT2JqZWN0KEVlLmIpKGUse2JhY2tncm91bmRDb2xvcjpufSl9KSksYXBwU3RhdGU6UWUoUWUoe30sdCkse30se2N1cnJlbnRJdGVtQmFja2dyb3VuZENvbG9yOm59KSxjb21taXRUb0hpc3Rvcnk6ITB9fSxQYW5lbENvbXBvbmVudDpmdW5jdGlvbihlKXt2YXIgdD1lLmVsZW1lbnRzLG49ZS5hcHBTdGF0ZSxyPWUudXBkYXRlRGF0YTtyZXR1cm4gYS5hLmNyZWF0ZUVsZW1lbnQoYS5hLkZyYWdtZW50LG51bGwsYS5hLmNyZWF0ZUVsZW1lbnQoImgzIix7ImFyaWEtaGlkZGVuIjoidHJ1ZSJ9LE9iamVjdChzLmUpKCJsYWJlbHMuYmFja2dyb3VuZCIpKSxhLmEuY3JlYXRlRWxlbWVudChKZSx7dHlwZToiZWxlbWVudEJhY2tncm91bmQiLGxhYmVsOk9iamVjdChzLmUpKCJsYWJlbHMuYmFja2dyb3VuZCIpLGNvbG9yOm50KHQsbiwoZnVuY3Rpb24oZSl7cmV0dXJuIGUuYmFja2dyb3VuZENvbG9yfSksbi5jdXJyZW50SXRlbUJhY2tncm91bmRDb2xvciksb25DaGFuZ2U6cn0pKX19KSxTZSh7bmFtZToiY2hhbmdlRmlsbFN0eWxlIixwZXJmb3JtOmZ1bmN0aW9uKGUsdCxuKXtyZXR1cm57ZWxlbWVudHM6dHQoZSx0LChmdW5jdGlvbihlKXtyZXR1cm4gT2JqZWN0KEVlLmIpKGUse2ZpbGxTdHlsZTpufSl9KSksYXBwU3RhdGU6UWUoUWUoe30sdCkse30se2N1cnJlbnRJdGVtRmlsbFN0eWxlOm59KSxjb21taXRUb0hpc3Rvcnk6ITB9fSxQYW5lbENvbXBvbmVudDpmdW5jdGlvbihlKXt2YXIgdD1lLmVsZW1lbnRzLG49ZS5hcHBTdGF0ZSxyPWUudXBkYXRlRGF0YTtyZXR1cm4gYS5hLmNyZWF0ZUVsZW1lbnQoImZpZWxkc2V0IixudWxsLGEuYS5jcmVhdGVFbGVtZW50KCJsZWdlbmQiLG51bGwsT2JqZWN0KHMuZSkoImxhYmVscy5maWxsIikpLGEuYS5jcmVhdGVFbGVtZW50KFZlLHtvcHRpb25zOlt7dmFsdWU6ImhhY2h1cmUiLHRleHQ6T2JqZWN0KHMuZSkoImxhYmVscy5oYWNodXJlIil9LHt2YWx1ZToiY3Jvc3MtaGF0Y2giLHRleHQ6T2JqZWN0KHMuZSkoImxhYmVscy5jcm9zc0hhdGNoIil9LHt2YWx1ZToic29saWQiLHRleHQ6T2JqZWN0KHMuZSkoImxhYmVscy5zb2xpZCIpfV0sZ3JvdXA6ImZpbGwiLHZhbHVlOm50KHQsbiwoZnVuY3Rpb24oZSl7cmV0dXJuIGUuZmlsbFN0eWxlfSksbi5jdXJyZW50SXRlbUZpbGxTdHlsZSksb25DaGFuZ2U6ZnVuY3Rpb24oZSl7cihlKX19KSl9fSksU2Uoe25hbWU6ImNoYW5nZVN0cm9rZVdpZHRoIixwZXJmb3JtOmZ1bmN0aW9uKGUsdCxuKXtyZXR1cm57ZWxlbWVudHM6dHQoZSx0LChmdW5jdGlvbihlKXtyZXR1cm4gT2JqZWN0KEVlLmIpKGUse3N0cm9rZVdpZHRoOm59KX0pKSxhcHBTdGF0ZTpRZShRZSh7fSx0KSx7fSx7Y3VycmVudEl0ZW1TdHJva2VXaWR0aDpufSksY29tbWl0VG9IaXN0b3J5OiEwfX0sUGFuZWxDb21wb25lbnQ6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5lbGVtZW50cyxuPWUuYXBwU3RhdGUscj1lLnVwZGF0ZURhdGE7cmV0dXJuIGEuYS5jcmVhdGVFbGVtZW50KCJmaWVsZHNldCIsbnVsbCxhLmEuY3JlYXRlRWxlbWVudCgibGVnZW5kIixudWxsLE9iamVjdChzLmUpKCJsYWJlbHMuc3Ryb2tlV2lkdGgiKSksYS5hLmNyZWF0ZUVsZW1lbnQoVmUse2dyb3VwOiJzdHJva2Utd2lkdGgiLG9wdGlvbnM6W3t2YWx1ZToxLHRleHQ6T2JqZWN0KHMuZSkoImxhYmVscy50aGluIil9LHt2YWx1ZToyLHRleHQ6T2JqZWN0KHMuZSkoImxhYmVscy5ib2xkIil9LHt2YWx1ZTo0LHRleHQ6T2JqZWN0KHMuZSkoImxhYmVscy5leHRyYUJvbGQiKX1dLHZhbHVlOm50KHQsbiwoZnVuY3Rpb24oZSl7cmV0dXJuIGUuc3Ryb2tlV2lkdGh9KSxuLmN1cnJlbnRJdGVtU3Ryb2tlV2lkdGgpLG9uQ2hhbmdlOmZ1bmN0aW9uKGUpe3JldHVybiByKGUpfX0pKX19KSxTZSh7bmFtZToiY2hhbmdlU2xvcHBpbmVzcyIscGVyZm9ybTpmdW5jdGlvbihlLHQsbil7cmV0dXJue2VsZW1lbnRzOnR0KGUsdCwoZnVuY3Rpb24oZSl7cmV0dXJuIE9iamVjdChFZS5iKShlLHtyb3VnaG5lc3M6bn0pfSkpLGFwcFN0YXRlOlFlKFFlKHt9LHQpLHt9LHtjdXJyZW50SXRlbVJvdWdobmVzczpufSksY29tbWl0VG9IaXN0b3J5OiEwfX0sUGFuZWxDb21wb25lbnQ6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5lbGVtZW50cyxuPWUuYXBwU3RhdGUscj1lLnVwZGF0ZURhdGE7cmV0dXJuIGEuYS5jcmVhdGVFbGVtZW50KCJmaWVsZHNldCIsbnVsbCxhLmEuY3JlYXRlRWxlbWVudCgibGVnZW5kIixudWxsLE9iamVjdChzLmUpKCJsYWJlbHMuc2xvcHBpbmVzcyIpKSxhLmEuY3JlYXRlRWxlbWVudChWZSx7Z3JvdXA6InNsb3BwaW5lc3MiLG9wdGlvbnM6W3t2YWx1ZTowLHRleHQ6T2JqZWN0KHMuZSkoImxhYmVscy5hcmNoaXRlY3QiKX0se3ZhbHVlOjEsdGV4dDpPYmplY3Qocy5lKSgibGFiZWxzLmFydGlzdCIpfSx7dmFsdWU6Mix0ZXh0Ok9iamVjdChzLmUpKCJsYWJlbHMuY2FydG9vbmlzdCIpfV0sdmFsdWU6bnQodCxuLChmdW5jdGlvbihlKXtyZXR1cm4gZS5yb3VnaG5lc3N9KSxuLmN1cnJlbnRJdGVtUm91Z2huZXNzKSxvbkNoYW5nZTpmdW5jdGlvbihlKXtyZXR1cm4gcihlKX19KSl9fSksU2Uoe25hbWU6ImNoYW5nZVN0cm9rZVN0eWxlIixwZXJmb3JtOmZ1bmN0aW9uKGUsdCxuKXtyZXR1cm57ZWxlbWVudHM6dHQoZSx0LChmdW5jdGlvbihlKXtyZXR1cm4gT2JqZWN0KEVlLmIpKGUse3N0cm9rZVN0eWxlOm59KX0pKSxhcHBTdGF0ZTpRZShRZSh7fSx0KSx7fSx7Y3VycmVudEl0ZW1TdHJva2VTdHlsZTpufSksY29tbWl0VG9IaXN0b3J5OiEwfX0sUGFuZWxDb21wb25lbnQ6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5lbGVtZW50cyxuPWUuYXBwU3RhdGUscj1lLnVwZGF0ZURhdGE7cmV0dXJuIGEuYS5jcmVhdGVFbGVtZW50KCJmaWVsZHNldCIsbnVsbCxhLmEuY3JlYXRlRWxlbWVudCgibGVnZW5kIixudWxsLE9iamVjdChzLmUpKCJsYWJlbHMuc3Ryb2tlU3R5bGUiKSksYS5hLmNyZWF0ZUVsZW1lbnQoVmUse2dyb3VwOiJzdHJva2VTdHlsZSIsb3B0aW9uczpbe3ZhbHVlOiJzb2xpZCIsdGV4dDpPYmplY3Qocy5lKSgibGFiZWxzLnN0cm9rZVN0eWxlX3NvbGlkIil9LHt2YWx1ZToiZGFzaGVkIix0ZXh0Ok9iamVjdChzLmUpKCJsYWJlbHMuc3Ryb2tlU3R5bGVfZGFzaGVkIil9LHt2YWx1ZToiZG90dGVkIix0ZXh0Ok9iamVjdChzLmUpKCJsYWJlbHMuc3Ryb2tlU3R5bGVfZG90dGVkIil9XSx2YWx1ZTpudCh0LG4sKGZ1bmN0aW9uKGUpe3JldHVybiBlLnN0cm9rZVN0eWxlfSksbi5jdXJyZW50SXRlbVN0cm9rZVN0eWxlKSxvbkNoYW5nZTpmdW5jdGlvbihlKXtyZXR1cm4gcihlKX19KSl9fSksU2Uoe25hbWU6ImNoYW5nZU9wYWNpdHkiLHBlcmZvcm06ZnVuY3Rpb24oZSx0LG4pe3JldHVybntlbGVtZW50czp0dChlLHQsKGZ1bmN0aW9uKGUpe3JldHVybiBPYmplY3QoRWUuYikoZSx7b3BhY2l0eTpufSl9KSksYXBwU3RhdGU6UWUoUWUoe30sdCkse30se2N1cnJlbnRJdGVtT3BhY2l0eTpufSksY29tbWl0VG9IaXN0b3J5OiEwfX0sUGFuZWxDb21wb25lbnQ6ZnVuY3Rpb24oZSl7dmFyIHQsbj1lLmVsZW1lbnRzLHI9ZS5hcHBTdGF0ZSxvPWUudXBkYXRlRGF0YTtyZXR1cm4gYS5hLmNyZWF0ZUVsZW1lbnQoImxhYmVsIix7Y2xhc3NOYW1lOiJjb250cm9sLWxhYmVsIn0sT2JqZWN0KHMuZSkoImxhYmVscy5vcGFjaXR5IiksYS5hLmNyZWF0ZUVsZW1lbnQoImlucHV0Iix7dHlwZToicmFuZ2UiLG1pbjoiMCIsbWF4OiIxMDAiLHN0ZXA6IjEwIixvbkNoYW5nZTpmdW5jdGlvbihlKXtyZXR1cm4gbygrZS50YXJnZXQudmFsdWUpfSxvbldoZWVsOmZ1bmN0aW9uKGUpe2Uuc3RvcFByb3BhZ2F0aW9uKCk7dmFyIHQ9K2UudGFyZ2V0LnZhbHVlO2UuZGVsdGFZPDAmJnQ8MTAwP28odCsxMCk6ZS5kZWx0YVk+MCYmdD4wJiZvKHQtMTApfSx2YWx1ZTpudWxsIT09KHQ9bnQobixyLChmdW5jdGlvbihlKXtyZXR1cm4gZS5vcGFjaXR5fSksci5jdXJyZW50SXRlbU9wYWNpdHkpKSYmdm9pZCAwIT09dD90OnZvaWQgMH0pKX19KSxTZSh7bmFtZToiY2hhbmdlRm9udFNpemUiLHBlcmZvcm06ZnVuY3Rpb24oZSx0LG4pe3JldHVybntlbGVtZW50czp0dChlLHQsKGZ1bmN0aW9uKGUpe2lmKE9iamVjdChmLkEpKGUpKXt2YXIgdD1PYmplY3QoRWUuYikoZSx7Zm9udFNpemU6bn0pO3JldHVybiBPYmplY3QoZi5FKSh0KSx0fXJldHVybiBlfSkpLGFwcFN0YXRlOlFlKFFlKHt9LHQpLHt9LHtjdXJyZW50SXRlbUZvbnRTaXplOm59KSxjb21taXRUb0hpc3Rvcnk6ITB9fSxQYW5lbENvbXBvbmVudDpmdW5jdGlvbihlKXt2YXIgdD1lLmVsZW1lbnRzLG49ZS5hcHBTdGF0ZSxyPWUudXBkYXRlRGF0YTtyZXR1cm4gYS5hLmNyZWF0ZUVsZW1lbnQoImZpZWxkc2V0IixudWxsLGEuYS5jcmVhdGVFbGVtZW50KCJsZWdlbmQiLG51bGwsT2JqZWN0KHMuZSkoImxhYmVscy5mb250U2l6ZSIpKSxhLmEuY3JlYXRlRWxlbWVudChWZSx7Z3JvdXA6ImZvbnQtc2l6ZSIsb3B0aW9uczpbe3ZhbHVlOjE2LHRleHQ6T2JqZWN0KHMuZSkoImxhYmVscy5zbWFsbCIpfSx7dmFsdWU6MjAsdGV4dDpPYmplY3Qocy5lKSgibGFiZWxzLm1lZGl1bSIpfSx7dmFsdWU6MjgsdGV4dDpPYmplY3Qocy5lKSgibGFiZWxzLmxhcmdlIil9LHt2YWx1ZTozNix0ZXh0Ok9iamVjdChzLmUpKCJsYWJlbHMudmVyeUxhcmdlIil9XSx2YWx1ZTpudCh0LG4sKGZ1bmN0aW9uKGUpe3JldHVybiBPYmplY3QoZi5BKShlKSYmZS5mb250U2l6ZX0pLG4uY3VycmVudEl0ZW1Gb250U2l6ZXx8Yi5mKSxvbkNoYW5nZTpmdW5jdGlvbihlKXtyZXR1cm4gcihlKX19KSl9fSksU2Uoe25hbWU6ImNoYW5nZUZvbnRGYW1pbHkiLHBlcmZvcm06ZnVuY3Rpb24oZSx0LG4pe3JldHVybntlbGVtZW50czp0dChlLHQsKGZ1bmN0aW9uKGUpe2lmKE9iamVjdChmLkEpKGUpKXt2YXIgdD1PYmplY3QoRWUuYikoZSx7Zm9udEZhbWlseTpufSk7cmV0dXJuIE9iamVjdChmLkUpKHQpLHR9cmV0dXJuIGV9KSksYXBwU3RhdGU6UWUoUWUoe30sdCkse30se2N1cnJlbnRJdGVtRm9udEZhbWlseTpufSksY29tbWl0VG9IaXN0b3J5OiEwfX0sUGFuZWxDb21wb25lbnQ6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5lbGVtZW50cyxuPWUuYXBwU3RhdGUscj1lLnVwZGF0ZURhdGEsbz1be3ZhbHVlOjEsdGV4dDpPYmplY3Qocy5lKSgibGFiZWxzLmhhbmREcmF3biIpfSx7dmFsdWU6Mix0ZXh0Ok9iamVjdChzLmUpKCJsYWJlbHMubm9ybWFsIil9LHt2YWx1ZTozLHRleHQ6T2JqZWN0KHMuZSkoImxhYmVscy5jb2RlIil9XTtyZXR1cm4gYS5hLmNyZWF0ZUVsZW1lbnQoImZpZWxkc2V0IixudWxsLGEuYS5jcmVhdGVFbGVtZW50KCJsZWdlbmQiLG51bGwsT2JqZWN0KHMuZSkoImxhYmVscy5mb250RmFtaWx5IikpLGEuYS5jcmVhdGVFbGVtZW50KFZlLHtncm91cDoiZm9udC1mYW1pbHkiLG9wdGlvbnM6byx2YWx1ZTpudCh0LG4sKGZ1bmN0aW9uKGUpe3JldHVybiBPYmplY3QoZi5BKShlKSYmZS5mb250RmFtaWx5fSksbi5jdXJyZW50SXRlbUZvbnRGYW1pbHl8fGIuZSksb25DaGFuZ2U6ZnVuY3Rpb24oZSl7cmV0dXJuIHIoZSl9fSkpfX0pLFNlKHtuYW1lOiJjaGFuZ2VUZXh0QWxpZ24iLHBlcmZvcm06ZnVuY3Rpb24oZSx0LG4pe3JldHVybntlbGVtZW50czp0dChlLHQsKGZ1bmN0aW9uKGUpe2lmKE9iamVjdChmLkEpKGUpKXt2YXIgdD1PYmplY3QoRWUuYikoZSx7dGV4dEFsaWduOm59KTtyZXR1cm4gT2JqZWN0KGYuRSkodCksdH1yZXR1cm4gZX0pKSxhcHBTdGF0ZTpRZShRZSh7fSx0KSx7fSx7Y3VycmVudEl0ZW1UZXh0QWxpZ246bn0pLGNvbW1pdFRvSGlzdG9yeTohMH19LFBhbmVsQ29tcG9uZW50OmZ1bmN0aW9uKGUpe3ZhciB0PWUuZWxlbWVudHMsbj1lLmFwcFN0YXRlLHI9ZS51cGRhdGVEYXRhO3JldHVybiBhLmEuY3JlYXRlRWxlbWVudCgiZmllbGRzZXQiLG51bGwsYS5hLmNyZWF0ZUVsZW1lbnQoImxlZ2VuZCIsbnVsbCxPYmplY3Qocy5lKSgibGFiZWxzLnRleHRBbGlnbiIpKSxhLmEuY3JlYXRlRWxlbWVudChWZSx7Z3JvdXA6InRleHQtYWxpZ24iLG9wdGlvbnM6W3t2YWx1ZToibGVmdCIsdGV4dDpPYmplY3Qocy5lKSgibGFiZWxzLmxlZnQiKX0se3ZhbHVlOiJjZW50ZXIiLHRleHQ6T2JqZWN0KHMuZSkoImxhYmVscy5jZW50ZXIiKX0se3ZhbHVlOiJyaWdodCIsdGV4dDpPYmplY3Qocy5lKSgibGFiZWxzLnJpZ2h0Iil9XSx2YWx1ZTpudCh0LG4sKGZ1bmN0aW9uKGUpe3JldHVybiBPYmplY3QoZi5BKShlKSYmZS50ZXh0QWxpZ259KSxuLmN1cnJlbnRJdGVtVGV4dEFsaWduKSxvbkNoYW5nZTpmdW5jdGlvbihlKXtyZXR1cm4gcihlKX19KSl9fSksbigxNykpLG90PWEuYS5jcmVhdGVDb250ZXh0KCExKTtmdW5jdGlvbiBhdCgpe3JldHVybiBPYmplY3Qoby51c2VDb250ZXh0KShvdCl9ZnVuY3Rpb24gaXQoZSx0KXt2YXIgbj1PYmplY3Qua2V5cyhlKTtpZihPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgcj1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO3QmJihyPXIuZmlsdGVyKChmdW5jdGlvbih0KXtyZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihlLHQpLmVudW1lcmFibGV9KSkpLG4ucHVzaC5hcHBseShuLHIpfXJldHVybiBufWZ1bmN0aW9uIHN0KGUpe2Zvcih2YXIgdD0xO3Q8YXJndW1lbnRzLmxlbmd0aDt0Kyspe3ZhciBuPW51bGwhPWFyZ3VtZW50c1t0XT9hcmd1bWVudHNbdF06e307dCUyP2l0KE9iamVjdChuKSwhMCkuZm9yRWFjaCgoZnVuY3Rpb24odCl7bHQoZSx0LG5bdF0pfSkpOk9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzP09iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGUsT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMobikpOml0KE9iamVjdChuKSkuZm9yRWFjaCgoZnVuY3Rpb24odCl7T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsdCxPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG4sdCkpfSkpfXJldHVybiBlfWZ1bmN0aW9uIGx0KGUsdCxuKXtyZXR1cm4gdCBpbiBlP09iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHQse3ZhbHVlOm4sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITAsd3JpdGFibGU6ITB9KTplW3RdPW4sZX1TZSh7bmFtZToiY2hhbmdlVmlld0JhY2tncm91bmRDb2xvciIscGVyZm9ybTpmdW5jdGlvbihlLHQsbil7cmV0dXJue2FwcFN0YXRlOnN0KHN0KHt9LHQpLHt9LHt2aWV3QmFja2dyb3VuZENvbG9yOm59KSxjb21taXRUb0hpc3Rvcnk6ITB9fSxQYW5lbENvbXBvbmVudDpmdW5jdGlvbihlKXt2YXIgdD1lLmFwcFN0YXRlLG49ZS51cGRhdGVEYXRhO3JldHVybiBhLmEuY3JlYXRlRWxlbWVudCgiZGl2Iix7c3R5bGU6e3Bvc2l0aW9uOiJyZWxhdGl2ZSJ9fSxhLmEuY3JlYXRlRWxlbWVudChKZSx7bGFiZWw6T2JqZWN0KHMuZSkoImxhYmVscy5jYW52YXNCYWNrZ3JvdW5kIiksdHlwZToiY2FudmFzQmFja2dyb3VuZCIsY29sb3I6dC52aWV3QmFja2dyb3VuZENvbG9yLG9uQ2hhbmdlOmZ1bmN0aW9uKGUpe3JldHVybiBuKGUpfX0pKX19KSxTZSh7bmFtZToiY2xlYXJDYW52YXMiLHBlcmZvcm06ZnVuY3Rpb24oZSx0KXtyZXR1cm57ZWxlbWVudHM6ZS5tYXAoKGZ1bmN0aW9uKGUpe3JldHVybiBPYmplY3QoRWUuYikoZSx7aXNEZWxldGVkOiEwfSl9KSksYXBwU3RhdGU6c3Qoc3Qoe30sT2JqZWN0KHJ0LmMpKCkpLHt9LHt1c2VybmFtZTp0LnVzZXJuYW1lfSksY29tbWl0VG9IaXN0b3J5OiEwfX0sUGFuZWxDb21wb25lbnQ6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS51cGRhdGVEYXRhO3JldHVybiBhLmEuY3JlYXRlRWxlbWVudChVLHt0eXBlOiJidXR0b24iLGljb246JCx0aXRsZTpPYmplY3Qocy5lKSgiYnV0dG9ucy5jbGVhclJlc2V0IiksImFyaWEtbGFiZWwiOk9iamVjdChzLmUpKCJidXR0b25zLmNsZWFyUmVzZXQiKSxzaG93QXJpYUxhYmVsOmF0KCksb25DbGljazpmdW5jdGlvbigpe3dpbmRvdy5jb25maXJtKE9iamVjdChzLmUpKCJhbGVydHMuY2xlYXJSZXNldCIpKSYmKHdpbmRvdy5oYW5kbGU9bnVsbCx0KG51bGwpKX19KX19KTt2YXIgY3Q9Ik1pbnVzIix1dD0iRXF1YWwiLGR0PSJEaWdpdDEiLHB0PSJEaWdpdDAiLGh0PSJOdW1wYWRTdWJ0cmFjdCIsZnQ9Ik51bXBhZEFkZCIsbXQ9Ik51bXBhZDAiO1NlKHtuYW1lOiJ6b29tSW4iLHBlcmZvcm06ZnVuY3Rpb24oZSx0KXtyZXR1cm57YXBwU3RhdGU6c3Qoc3Qoe30sdCkse30se3pvb206T2JqZWN0KG0uZikodC56b29tKy4xKX0pLGNvbW1pdFRvSGlzdG9yeTohMX19LFBhbmVsQ29tcG9uZW50OmZ1bmN0aW9uKGUpe3ZhciB0PWUudXBkYXRlRGF0YTtyZXR1cm4gYS5hLmNyZWF0ZUVsZW1lbnQoVSx7dHlwZToiYnV0dG9uIixpY29uOnRlLHRpdGxlOiIiLmNvbmNhdChPYmplY3Qocy5lKSgiYnV0dG9ucy56b29tSW4iKSwiIOKAlCAiKS5jb25jYXQoT2JqZWN0KE8uaykoIkN0cmxPckNtZCsrIikpLCJhcmlhLWxhYmVsIjpPYmplY3Qocy5lKSgiYnV0dG9ucy56b29tSW4iKSxvbkNsaWNrOmZ1bmN0aW9uKCl7dChudWxsKX19KX0sa2V5VGVzdDpmdW5jdGlvbihlKXtyZXR1cm4oZS5jb2RlPT09dXR8fGUuY29kZT09PWZ0KSYmKGVbQy5hLkNUUkxfT1JfQ01EXXx8ZS5zaGlmdEtleSl9fSksU2Uoe25hbWU6Inpvb21PdXQiLHBlcmZvcm06ZnVuY3Rpb24oZSx0KXtyZXR1cm57YXBwU3RhdGU6c3Qoc3Qoe30sdCkse30se3pvb206T2JqZWN0KG0uZikodC56b29tLS4xKX0pLGNvbW1pdFRvSGlzdG9yeTohMX19LFBhbmVsQ29tcG9uZW50OmZ1bmN0aW9uKGUpe3ZhciB0PWUudXBkYXRlRGF0YTtyZXR1cm4gYS5hLmNyZWF0ZUVsZW1lbnQoVSx7dHlwZToiYnV0dG9uIixpY29uOm5lLHRpdGxlOiIiLmNvbmNhdChPYmplY3Qocy5lKSgiYnV0dG9ucy56b29tT3V0IiksIiDigJQgIikuY29uY2F0KE9iamVjdChPLmspKCJDdHJsT3JDbWQrLSIpKSwiYXJpYS1sYWJlbCI6T2JqZWN0KHMuZSkoImJ1dHRvbnMuem9vbU91dCIpLG9uQ2xpY2s6ZnVuY3Rpb24oKXt0KG51bGwpfX0pfSxrZXlUZXN0OmZ1bmN0aW9uKGUpe3JldHVybihlLmNvZGU9PT1jdHx8ZS5jb2RlPT09aHQpJiYoZVtDLmEuQ1RSTF9PUl9DTURdfHxlLnNoaWZ0S2V5KX19KSxTZSh7bmFtZToicmVzZXRab29tIixwZXJmb3JtOmZ1bmN0aW9uKGUsdCl7cmV0dXJue2FwcFN0YXRlOnN0KHN0KHt9LHQpLHt9LHt6b29tOjF9KSxjb21taXRUb0hpc3Rvcnk6ITF9fSxQYW5lbENvbXBvbmVudDpmdW5jdGlvbihlKXt2YXIgdD1lLnVwZGF0ZURhdGE7cmV0dXJuIGEuYS5jcmVhdGVFbGVtZW50KFUse3R5cGU6ImJ1dHRvbiIsaWNvbjpzZSx0aXRsZTpPYmplY3Qocy5lKSgiYnV0dG9ucy5yZXNldFpvb20iKSwiYXJpYS1sYWJlbCI6T2JqZWN0KHMuZSkoImJ1dHRvbnMucmVzZXRab29tIiksb25DbGljazpmdW5jdGlvbigpe3QobnVsbCl9fSl9LGtleVRlc3Q6ZnVuY3Rpb24oZSl7cmV0dXJuKGUuY29kZT09PXB0fHxlLmNvZGU9PT1tdCkmJihlW0MuYS5DVFJMX09SX0NNRF18fGUuc2hpZnRLZXkpfX0pLFNlKHtuYW1lOiJ6b29tVG9GaXQiLHBlcmZvcm06ZnVuY3Rpb24oZSx0KXt2YXIgbj1lLmZpbHRlcigoZnVuY3Rpb24oZSl7cmV0dXJuIWUuaXNEZWxldGVkfSkpLHI9T2JqZWN0KGYuZikobiksbz1yWzBdLGE9clsxXSxpPShvK3JbMl0pLzIscz0oYStyWzNdKS8yLGw9T2JqZWN0KG0ubykodC53aWR0aC8yLWkpLGM9T2JqZWN0KG0ubykodC5oZWlnaHQvMi1zKSx1PWZ1bmN0aW9uKGUsdCxuKXt2YXIgcixvPW4uc2Nyb2xsWCxhPW4uc2Nyb2xsWSxpPXdpbmRvdy5pbm5lcldpZHRoLHM9d2luZG93LmlubmVySGVpZ2h0LGw9LWkvKDIqbysyKmVbMF0taSksYz0tcy8oMiphKzIqZVsxXS1zKTtyZXR1cm4ocj1sPGM/bC0uMDE6Yzw9bD9jLS4wMTp0KTw9LjE/LjE6cj49MT8xOnJ9KHIsdC56b29tLHtzY3JvbGxYOmwsc2Nyb2xsWTpjfSk7cmV0dXJue2FwcFN0YXRlOnN0KHN0KHt9LHQpLHt9LHtzY3JvbGxYOmwsc2Nyb2xsWTpjLHpvb206dX0pLGNvbW1pdFRvSGlzdG9yeTohMX19LGtleVRlc3Q6ZnVuY3Rpb24oZSl7cmV0dXJuIGUuY29kZT09PWR0JiZlLnNoaWZ0S2V5JiYhZS5hbHRLZXkmJiFlW0MuYS5DVFJMX09SX0NNRF19fSk7ZnVuY3Rpb24gZ3QoZSx0KXt2YXIgbj1PYmplY3Qua2V5cyhlKTtpZihPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgcj1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO3QmJihyPXIuZmlsdGVyKChmdW5jdGlvbih0KXtyZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihlLHQpLmVudW1lcmFibGV9KSkpLG4ucHVzaC5hcHBseShuLHIpfXJldHVybiBufWZ1bmN0aW9uIGJ0KGUpe2Zvcih2YXIgdD0xO3Q8YXJndW1lbnRzLmxlbmd0aDt0Kyspe3ZhciBuPW51bGwhPWFyZ3VtZW50c1t0XT9hcmd1bWVudHNbdF06e307dCUyP2d0KE9iamVjdChuKSwhMCkuZm9yRWFjaCgoZnVuY3Rpb24odCl7eXQoZSx0LG5bdF0pfSkpOk9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzP09iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGUsT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMobikpOmd0KE9iamVjdChuKSkuZm9yRWFjaCgoZnVuY3Rpb24odCl7T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsdCxPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG4sdCkpfSkpfXJldHVybiBlfWZ1bmN0aW9uIHl0KGUsdCxuKXtyZXR1cm4gdCBpbiBlP09iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHQse3ZhbHVlOm4sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITAsd3JpdGFibGU6ITB9KTplW3RdPW4sZX12YXIgdnQ9U2Uoe25hbWU6ImZpbmFsaXplIixwZXJmb3JtOmZ1bmN0aW9uKGUsdCl7dmFyIG4scjtpZih0LmVkaXRpbmdMaW5lYXJFbGVtZW50KXt2YXIgbz10LmVkaXRpbmdMaW5lYXJFbGVtZW50LmVsZW1lbnRJZCxhPUNlLmEuZ2V0RWxlbWVudChvKTtpZihhKXJldHVybntlbGVtZW50czphLnBvaW50cy5sZW5ndGg8Mnx8T2JqZWN0KGYueSkoYSk/ZS5maWx0ZXIoKGZ1bmN0aW9uKGUpe3JldHVybiBlLmlkIT09YS5pZH0pKTp2b2lkIDAsYXBwU3RhdGU6YnQoYnQoe30sdCkse30se2VkaXRpbmdMaW5lYXJFbGVtZW50Om51bGx9KSxjb21taXRUb0hpc3Rvcnk6ITB9fXZhciBpPWU7d2luZG93LmRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCYmd2luZG93LmRvY3VtZW50LmFjdGl2ZUVsZW1lbnQuYmx1cigpO3ZhciBzPXQubXVsdGlFbGVtZW50P3QubXVsdGlFbGVtZW50OiJkcmF3Ij09PShudWxsPT09KHI9dC5lZGl0aW5nRWxlbWVudCl8fHZvaWQgMD09PXI/dm9pZCAwOnIudHlwZSk/dC5lZGl0aW5nRWxlbWVudDpudWxsO2lmKHMpe2lmKCJkcmF3IiE9PXMudHlwZSYmInRvdWNoIiE9PXQubGFzdFBvaW50ZXJEb3duV2l0aCl7dmFyIGw9cy5wb2ludHMsYz1zLmxhc3RDb21taXR0ZWRQb2ludDtjJiZsW2wubGVuZ3RoLTFdPT09Y3x8T2JqZWN0KEVlLmEpKHMse3BvaW50czpzLnBvaW50cy5zbGljZSgwLC0xKX0pfWlmKE9iamVjdChmLnkpKHMpJiYoaT1pLnNsaWNlKDAsLTEpKSwoImxpbmUiPT09cy50eXBlfHwiZHJhdyI9PT1zLnR5cGUpJiZPYmplY3QoRS5mKShzLnBvaW50cykpe3ZhciB1PXMucG9pbnRzLGQ9dVswXTtPYmplY3QoRWUuYSkocyx7cG9pbnRzOnUubWFwKChmdW5jdGlvbihlLHQpe3JldHVybiB0PT09dS5sZW5ndGgtMT9bZFswXSxkWzFdXTplfSkpfSl9dC5lbGVtZW50TG9ja2VkfHwodC5zZWxlY3RlZEVsZW1lbnRJZHNbcy5pZF09ITApfXJldHVybiB0LmVsZW1lbnRMb2NrZWQmJnN8fE9iamVjdChPLnQpKCkse2VsZW1lbnRzOmksYXBwU3RhdGU6YnQoYnQoe30sdCkse30se2VsZW1lbnRUeXBlOnQuZWxlbWVudExvY2tlZCYmcz90LmVsZW1lbnRUeXBlOiJzZWxlY3Rpb24iLGRyYWdnaW5nRWxlbWVudDpudWxsLG11bHRpRWxlbWVudDpudWxsLGVkaXRpbmdFbGVtZW50Om51bGwsc2VsZWN0ZWRFbGVtZW50SWRzOnMmJiF0LmVsZW1lbnRMb2NrZWQ/YnQoYnQoe30sdC5zZWxlY3RlZEVsZW1lbnRJZHMpLHt9LChuPXt9LG5bcy5pZF09ITAsbikpOnQuc2VsZWN0ZWRFbGVtZW50SWRzfSksY29tbWl0VG9IaXN0b3J5OiJkcmF3Ij09PXQuZWxlbWVudFR5cGV9fSxrZXlUZXN0OmZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUua2V5PT09Qy5hLkVTQ0FQRSYmKG51bGwhPT10LmVkaXRpbmdMaW5lYXJFbGVtZW50fHwhdC5kcmFnZ2luZ0VsZW1lbnQmJm51bGw9PT10Lm11bHRpRWxlbWVudCl8fChlLmtleT09PUMuYS5FU0NBUEV8fGUua2V5PT09Qy5hLkVOVEVSKSYmbnVsbCE9PXQubXVsdGlFbGVtZW50fSxQYW5lbENvbXBvbmVudDpmdW5jdGlvbihlKXt2YXIgdD1lLmFwcFN0YXRlLG49ZS51cGRhdGVEYXRhO3JldHVybiBhLmEuY3JlYXRlRWxlbWVudChVLHt0eXBlOiJidXR0b24iLGljb246cmUsdGl0bGU6T2JqZWN0KHMuZSkoImJ1dHRvbnMuZG9uZSIpLCJhcmlhLWxhYmVsIjpPYmplY3Qocy5lKSgiYnV0dG9ucy5kb25lIiksb25DbGljazpuLHZpc2libGU6bnVsbCE9dC5tdWx0aUVsZW1lbnR9KX19KSxrdD0obig3MiksZnVuY3Rpb24oKXt2YXIgZT1mdW5jdGlvbih0LG4pe3JldHVybihlPU9iamVjdC5zZXRQcm90b3R5cGVPZnx8e19fcHJvdG9fXzpbXX1pbnN0YW5jZW9mIEFycmF5JiZmdW5jdGlvbihlLHQpe2UuX19wcm90b19fPXR9fHxmdW5jdGlvbihlLHQpe2Zvcih2YXIgbiBpbiB0KXQuaGFzT3duUHJvcGVydHkobikmJihlW25dPXRbbl0pfSkodCxuKX07cmV0dXJuIGZ1bmN0aW9uKHQsbil7ZnVuY3Rpb24gcigpe3RoaXMuY29uc3RydWN0b3I9dH1lKHQsbiksdC5wcm90b3R5cGU9bnVsbD09PW4/T2JqZWN0LmNyZWF0ZShuKTooci5wcm90b3R5cGU9bi5wcm90b3R5cGUsbmV3IHIpfX0oKSksd3Q9ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdCgpe2Zvcih2YXIgdD1bXSxuPTA7bjxhcmd1bWVudHMubGVuZ3RoO24rKyl0W25dPWFyZ3VtZW50c1tuXTt2YXIgcixvLGE9dGhpcztyZXR1cm4gYT1lLmFwcGx5KHRoaXMsdCl8fHRoaXMscj1vPWEsYS5oYW5kbGVGb2N1cz1mdW5jdGlvbihlKXtPYmplY3QoTy52KShlLmN1cnJlbnRUYXJnZXQpfSxhLmhhbmRsZUJsdXI9ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5jdXJyZW50VGFyZ2V0LmlubmVyVGV4dC50cmltKCk7dCE9PW8ucHJvcHMudmFsdWUmJm8ucHJvcHMub25DaGFuZ2UodCksT2JqZWN0KE8ucykoKX0sYS5oYW5kbGVLZXlEb3duPWZ1bmN0aW9uKGUpe2lmKCJFbnRlciI9PT1lLmtleSl7aWYoZS5wcmV2ZW50RGVmYXVsdCgpLGUubmF0aXZlRXZlbnQuaXNDb21wb3Npbmd8fDIyOT09PWUua2V5Q29kZSlyZXR1cm47ZS5jdXJyZW50VGFyZ2V0LmJsdXIoKX19LGEubWFrZUVkaXRhYmxlPWZ1bmN0aW9uKGUpe2lmKGUpdHJ5e2UuY29udGVudEVkaXRhYmxlPSJwbGFpbnRleHQtb25seSJ9Y2F0Y2godCl7ZS5jb250ZW50RWRpdGFibGU9InRydWUifX0scn1yZXR1cm4ga3QodCxlKSx0LnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24oKXtyZXR1cm4gYS5hLmNyZWF0ZUVsZW1lbnQoInNwYW4iLHtzdXBwcmVzc0NvbnRlbnRFZGl0YWJsZVdhcm5pbmc6ITAscmVmOnRoaXMubWFrZUVkaXRhYmxlLCJkYXRhLXR5cGUiOiJ3eXNpd3lnIixjbGFzc05hbWU6IlRleHRJbnB1dCIscm9sZToidGV4dGJveCIsImFyaWEtbGFiZWwiOnRoaXMucHJvcHMubGFiZWwsb25CbHVyOnRoaXMuaGFuZGxlQmx1cixvbktleURvd246dGhpcy5oYW5kbGVLZXlEb3duLG9uRm9jdXM6dGhpcy5oYW5kbGVGb2N1c30sdGhpcy5wcm9wcy52YWx1ZSl9LHR9KG8uQ29tcG9uZW50KTtmdW5jdGlvbiBTdChlLHQpe3ZhciBuPU9iamVjdC5rZXlzKGUpO2lmKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpe3ZhciByPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7dCYmKHI9ci5maWx0ZXIoKGZ1bmN0aW9uKHQpe3JldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGUsdCkuZW51bWVyYWJsZX0pKSksbi5wdXNoLmFwcGx5KG4scil9cmV0dXJuIG59ZnVuY3Rpb24gRXQoZSl7Zm9yKHZhciB0PTE7dDxhcmd1bWVudHMubGVuZ3RoO3QrKyl7dmFyIG49bnVsbCE9YXJndW1lbnRzW3RdP2FyZ3VtZW50c1t0XTp7fTt0JTI/U3QoT2JqZWN0KG4pLCEwKS5mb3JFYWNoKChmdW5jdGlvbih0KXtPdChlLHQsblt0XSl9KSk6T2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnM/T2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZSxPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhuKSk6U3QoT2JqZWN0KG4pKS5mb3JFYWNoKChmdW5jdGlvbih0KXtPYmplY3QuZGVmaW5lUHJvcGVydHkoZSx0LE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iobix0KSl9KSl9cmV0dXJuIGV9ZnVuY3Rpb24gT3QoZSx0LG4pe3JldHVybiB0IGluIGU/T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsdCx7dmFsdWU6bixlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMCx3cml0YWJsZTohMH0pOmVbdF09bixlfVNlKHtuYW1lOiJjaGFuZ2VQcm9qZWN0TmFtZSIscGVyZm9ybTpmdW5jdGlvbihlLHQsbil7cmV0dXJue2FwcFN0YXRlOkV0KEV0KHt9LHQpLHt9LHtuYW1lOm59KSxjb21taXRUb0hpc3Rvcnk6ITF9fSxQYW5lbENvbXBvbmVudDpmdW5jdGlvbihlKXt2YXIgdD1lLmFwcFN0YXRlLG49ZS51cGRhdGVEYXRhO3JldHVybiBhLmEuY3JlYXRlRWxlbWVudCh3dCx7bGFiZWw6T2JqZWN0KHMuZSkoImxhYmVscy5maWxlVGl0bGUiKSx2YWx1ZTp0Lm5hbWV8fCJVbm5hbWVkIixvbkNoYW5nZTpmdW5jdGlvbihlKXtyZXR1cm4gbihlKX19KX19KSxTZSh7bmFtZToiY2hhbmdlRXhwb3J0QmFja2dyb3VuZCIscGVyZm9ybTpmdW5jdGlvbihlLHQsbil7cmV0dXJue2FwcFN0YXRlOkV0KEV0KHt9LHQpLHt9LHtleHBvcnRCYWNrZ3JvdW5kOm59KSxjb21taXRUb0hpc3Rvcnk6ITF9fSxQYW5lbENvbXBvbmVudDpmdW5jdGlvbihlKXt2YXIgdD1lLmFwcFN0YXRlLG49ZS51cGRhdGVEYXRhO3JldHVybiBhLmEuY3JlYXRlRWxlbWVudCgibGFiZWwiLG51bGwsYS5hLmNyZWF0ZUVsZW1lbnQoImlucHV0Iix7dHlwZToiY2hlY2tib3giLGNoZWNrZWQ6dC5leHBvcnRCYWNrZ3JvdW5kLG9uQ2hhbmdlOmZ1bmN0aW9uKGUpe3JldHVybiBuKGUudGFyZ2V0LmNoZWNrZWQpfX0pLCIgIixPYmplY3Qocy5lKSgibGFiZWxzLndpdGhCYWNrZ3JvdW5kIikpfX0pLFNlKHtuYW1lOiJjaGFuZ2VTaG91bGRBZGRXYXRlcm1hcmsiLHBlcmZvcm06ZnVuY3Rpb24oZSx0LG4pe3JldHVybnthcHBTdGF0ZTpFdChFdCh7fSx0KSx7fSx7c2hvdWxkQWRkV2F0ZXJtYXJrOm59KSxjb21taXRUb0hpc3Rvcnk6ITF9fSxQYW5lbENvbXBvbmVudDpmdW5jdGlvbihlKXt2YXIgdD1lLmFwcFN0YXRlLG49ZS51cGRhdGVEYXRhO3JldHVybiBhLmEuY3JlYXRlRWxlbWVudCgibGFiZWwiLG51bGwsYS5hLmNyZWF0ZUVsZW1lbnQoImlucHV0Iix7dHlwZToiY2hlY2tib3giLGNoZWNrZWQ6dC5zaG91bGRBZGRXYXRlcm1hcmssb25DaGFuZ2U6ZnVuY3Rpb24oZSl7cmV0dXJuIG4oZS50YXJnZXQuY2hlY2tlZCl9fSksIiAiLE9iamVjdChzLmUpKCJsYWJlbHMuYWRkV2F0ZXJtYXJrIikpfX0pLFNlKHtuYW1lOiJzYXZlU2NlbmUiLHBlcmZvcm06ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBPYmplY3QoZy5qKShlLHQsd2luZG93LmhhbmRsZSkuY2F0Y2goTy5yKS5jYXRjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIGNvbnNvbGUuZXJyb3IoZSl9KSkse2NvbW1pdFRvSGlzdG9yeTohMX19LGtleVRlc3Q6ZnVuY3Rpb24oZSl7cmV0dXJuInMiPT09ZS5rZXkmJmVbQy5hLkNUUkxfT1JfQ01EXSYmIWUuc2hpZnRLZXl9LFBhbmVsQ29tcG9uZW50OmZ1bmN0aW9uKGUpe3ZhciB0PWUudXBkYXRlRGF0YTtyZXR1cm4gYS5hLmNyZWF0ZUVsZW1lbnQoVSx7dHlwZToiYnV0dG9uIixpY29uOnEsdGl0bGU6T2JqZWN0KHMuZSkoImJ1dHRvbnMuc2F2ZSIpLCJhcmlhLWxhYmVsIjpPYmplY3Qocy5lKSgiYnV0dG9ucy5zYXZlIiksc2hvd0FyaWFMYWJlbDphdCgpLG9uQ2xpY2s6ZnVuY3Rpb24oKXtyZXR1cm4gdChudWxsKX19KX19KSxTZSh7bmFtZToic2F2ZUFzU2NlbmUiLHBlcmZvcm06ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBPYmplY3QoZy5qKShlLHQsbnVsbCkuY2F0Y2goTy5yKS5jYXRjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIGNvbnNvbGUuZXJyb3IoZSl9KSkse2NvbW1pdFRvSGlzdG9yeTohMX19LGtleVRlc3Q6ZnVuY3Rpb24oZSl7cmV0dXJuInMiPT09ZS5rZXkmJmUuc2hpZnRLZXkmJmVbQy5hLkNUUkxfT1JfQ01EXX0sUGFuZWxDb21wb25lbnQ6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS51cGRhdGVEYXRhO3JldHVybiBhLmEuY3JlYXRlRWxlbWVudChVLHt0eXBlOiJidXR0b24iLGljb246WSx0aXRsZTpPYmplY3Qocy5lKSgiYnV0dG9ucy5zYXZlQXMiKSwiYXJpYS1sYWJlbCI6T2JqZWN0KHMuZSkoImJ1dHRvbnMuc2F2ZUFzIiksc2hvd0FyaWFMYWJlbDphdCgpLGhpZGRlbjohKCJjaG9vc2VGaWxlU3lzdGVtRW50cmllcyJpbiB3aW5kb3d8fCJzaG93T3BlbkZpbGVQaWNrZXIiaW4gd2luZG93KSxvbkNsaWNrOmZ1bmN0aW9uKCl7cmV0dXJuIHQobnVsbCl9fSl9fSksU2Uoe25hbWU6ImxvYWRTY2VuZSIscGVyZm9ybTpmdW5jdGlvbihlLHQsbil7dmFyIHI9bi5lbGVtZW50cyxvPW4uYXBwU3RhdGUsYT1uLmVycm9yO3JldHVybntlbGVtZW50czpyLGFwcFN0YXRlOkV0KEV0KHt9LG8pLHt9LHtlcnJvck1lc3NhZ2U6YX0pLGNvbW1pdFRvSGlzdG9yeTohMX19LFBhbmVsQ29tcG9uZW50OmZ1bmN0aW9uKGUpe3ZhciB0PWUudXBkYXRlRGF0YSxuPWUuYXBwU3RhdGU7cmV0dXJuIGEuYS5jcmVhdGVFbGVtZW50KFUse3R5cGU6ImJ1dHRvbiIsaWNvbjpYLHRpdGxlOk9iamVjdChzLmUpKCJidXR0b25zLmxvYWQiKSwiYXJpYS1sYWJlbCI6T2JqZWN0KHMuZSkoImJ1dHRvbnMubG9hZCIpLHNob3dBcmlhTGFiZWw6YXQoKSxvbkNsaWNrOmZ1bmN0aW9uKCl7T2JqZWN0KGcuaCkobikudGhlbigoZnVuY3Rpb24oZSl7dmFyIG49ZS5lbGVtZW50cyxyPWUuYXBwU3RhdGU7dCh7ZWxlbWVudHM6bixhcHBTdGF0ZTpyfSl9KSkuY2F0Y2goTy5yKS5jYXRjaCgoZnVuY3Rpb24oZSl7dCh7ZXJyb3I6ZS5tZXNzYWdlfSl9KSl9fSl9fSk7dmFyIEN0PSJ7fSIseHQ9KFNlKHtuYW1lOiJjb3B5U3R5bGVzIixwZXJmb3JtOmZ1bmN0aW9uKGUsdCl7dmFyIG49ZS5maW5kKChmdW5jdGlvbihlKXtyZXR1cm4gdC5zZWxlY3RlZEVsZW1lbnRJZHNbZS5pZF19KSk7cmV0dXJuIG4mJihDdD1KU09OLnN0cmluZ2lmeShuKSkse2NvbW1pdFRvSGlzdG9yeTohMX19LGNvbnRleHRJdGVtTGFiZWw6ImxhYmVscy5jb3B5U3R5bGVzIixrZXlUZXN0OmZ1bmN0aW9uKGUpe3JldHVybiBlW0MuYS5DVFJMX09SX0NNRF0mJmUuYWx0S2V5JiZlLmtleUNvZGU9PT1DLmEuQ19LRVlfQ09ERX0sY29udGV4dE1lbnVPcmRlcjowfSksU2Uoe25hbWU6InBhc3RlU3R5bGVzIixwZXJmb3JtOmZ1bmN0aW9uKGUsdCl7dmFyIG49SlNPTi5wYXJzZShDdCk7cmV0dXJuIE9iamVjdChmLngpKG4pP3tlbGVtZW50czplLm1hcCgoZnVuY3Rpb24oZSl7aWYodC5zZWxlY3RlZEVsZW1lbnRJZHNbZS5pZF0pe3ZhciByPU9iamVjdChFZS5iKShlLHtiYWNrZ3JvdW5kQ29sb3I6bnVsbD09bj92b2lkIDA6bi5iYWNrZ3JvdW5kQ29sb3Isc3Ryb2tlV2lkdGg6bnVsbD09bj92b2lkIDA6bi5zdHJva2VXaWR0aCxzdHJva2VDb2xvcjpudWxsPT1uP3ZvaWQgMDpuLnN0cm9rZUNvbG9yLHN0cm9rZVN0eWxlOm51bGw9PW4/dm9pZCAwOm4uc3Ryb2tlU3R5bGUsZmlsbFN0eWxlOm51bGw9PW4/dm9pZCAwOm4uZmlsbFN0eWxlLG9wYWNpdHk6bnVsbD09bj92b2lkIDA6bi5vcGFjaXR5LHJvdWdobmVzczpudWxsPT1uP3ZvaWQgMDpuLnJvdWdobmVzc30pO3JldHVybiBPYmplY3QoZi5BKShyKSYmKE9iamVjdChFZS5hKShyLHtmb250U2l6ZToobnVsbD09bj92b2lkIDA6bi5mb250U2l6ZSl8fGIuZixmb250RmFtaWx5OihudWxsPT1uP3ZvaWQgMDpuLmZvbnRGYW1pbHkpfHxiLmUsdGV4dEFsaWduOihudWxsPT1uP3ZvaWQgMDpuLnRleHRBbGlnbil8fGIuZ30pLE9iamVjdChmLkUpKHIpKSxyfXJldHVybiBlfSkpLGNvbW1pdFRvSGlzdG9yeTohMH06e2VsZW1lbnRzOmUsY29tbWl0VG9IaXN0b3J5OiExfX0sY29udGV4dEl0ZW1MYWJlbDoibGFiZWxzLnBhc3RlU3R5bGVzIixrZXlUZXN0OmZ1bmN0aW9uKGUpe3JldHVybiBlW0MuYS5DVFJMX09SX0NNRF0mJmUuYWx0S2V5JiZlLmtleUNvZGU9PT1DLmEuVl9LRVlfQ09ERX0sY29udGV4dE1lbnVPcmRlcjoxfSksYS5hLmNyZWF0ZUVsZW1lbnQoInN2ZyIse3dpZHRoOiIzMCIsaGVpZ2h0OiIyMiIsdmlld0JveDoiMCAwIDUxMiA1MTIiLHhtbG5zOiJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyJ9LGEuYS5jcmVhdGVFbGVtZW50KCJwYXRoIix7ZDoiTTUyOCA0NDhINDhjLTI2LjUxIDAtNDgtMjEuNDktNDgtNDhWMTEyYzAtMjYuNTEgMjEuNDktNDggNDgtNDhoNDgwYzI2LjUxIDAgNDggMjEuNDkgNDggNDh2Mjg4YzAgMjYuNTEtMjEuNDkgNDgtNDggNDh6TTEyOCAxODB2LTQwYzAtNi42MjctNS4zNzMtMTItMTItMTJINzZjLTYuNjI3IDAtMTIgNS4zNzMtMTIgMTJ2NDBjMCA2LjYyNyA1LjM3MyAxMiAxMiAxMmg0MGM2LjYyNyAwIDEyLTUuMzczIDEyLTEyem05NiAwdi00MGMwLTYuNjI3LTUuMzczLTEyLTEyLTEyaC00MGMtNi42MjcgMC0xMiA1LjM3My0xMiAxMnY0MGMwIDYuNjI3IDUuMzczIDEyIDEyIDEyaDQwYzYuNjI3IDAgMTItNS4zNzMgMTItMTJ6bTk2IDB2LTQwYzAtNi42MjctNS4zNzMtMTItMTItMTJoLTQwYy02LjYyNyAwLTEyIDUuMzczLTEyIDEydjQwYzAgNi42MjcgNS4zNzMgMTIgMTIgMTJoNDBjNi42MjcgMCAxMi01LjM3MyAxMi0xMnptOTYgMHYtNDBjMC02LjYyNy01LjM3My0xMi0xMi0xMmgtNDBjLTYuNjI3IDAtMTIgNS4zNzMtMTIgMTJ2NDBjMCA2LjYyNyA1LjM3MyAxMiAxMiAxMmg0MGM2LjYyNyAwIDEyLTUuMzczIDEyLTEyem05NiAwdi00MGMwLTYuNjI3LTUuMzczLTEyLTEyLTEyaC00MGMtNi42MjcgMC0xMiA1LjM3My0xMiAxMnY0MGMwIDYuNjI3IDUuMzczIDEyIDEyIDEyaDQwYzYuNjI3IDAgMTItNS4zNzMgMTItMTJ6bS0zMzYgOTZ2LTQwYzAtNi42MjctNS4zNzMtMTItMTItMTJoLTQwYy02LjYyNyAwLTEyIDUuMzczLTEyIDEydjQwYzAgNi42MjcgNS4zNzMgMTIgMTIgMTJoNDBjNi42MjcgMCAxMi01LjM3MyAxMi0xMnptOTYgMHYtNDBjMC02LjYyNy01LjM3My0xMi0xMi0xMmgtNDBjLTYuNjI3IDAtMTIgNS4zNzMtMTIgMTJ2NDBjMCA2LjYyNyA1LjM3MyAxMiAxMiAxMmg0MGM2LjYyNyAwIDEyLTUuMzczIDEyLTEyem05NiAwdi00MGMwLTYuNjI3LTUuMzczLTEyLTEyLTEyaC00MGMtNi42MjcgMC0xMiA1LjM3My0xMiAxMnY0MGMwIDYuNjI3IDUuMzczIDEyIDEyIDEyaDQwYzYuNjI3IDAgMTItNS4zNzMgMTItMTJ6bTk2IDB2LTQwYzAtNi42MjctNS4zNzMtMTItMTItMTJoLTQwYy02LjYyNyAwLTEyIDUuMzczLTEyIDEydjQwYzAgNi42MjcgNS4zNzMgMTIgMTIgMTJoNDBjNi42MjcgMCAxMi01LjM3MyAxMi0xMnptLTMzNiA5NnYtNDBjMC02LjYyNy01LjM3My0xMi0xMi0xMkg3NmMtNi42MjcgMC0xMiA1LjM3My0xMiAxMnY0MGMwIDYuNjI3IDUuMzczIDEyIDEyIDEyaDQwYzYuNjI3IDAgMTItNS4zNzMgMTItMTJ6bTI4OCAwdi00MGMwLTYuNjI3LTUuMzczLTEyLTEyLTEySDE3MmMtNi42MjcgMC0xMiA1LjM3My0xMiAxMnY0MGMwIDYuNjI3IDUuMzczIDEyIDEyIDEyaDIzMmM2LjYyNyAwIDEyLTUuMzczIDEyLTEyem05NiAwdi00MGMwLTYuNjI3LTUuMzczLTEyLTEyLTEyaC00MGMtNi42MjcgMC0xMiA1LjM3My0xMiAxMnY0MGMwIDYuNjI3IDUuMzczIDEyIDEyIDEyaDQwYzYuNjI3IDAgMTItNS4zNzMgMTItMTJ6In0pKSksanQ9ZnVuY3Rpb24oZSl7cmV0dXJuIGEuYS5jcmVhdGVFbGVtZW50KCJsYWJlbCIse3RpdGxlOiIiLmNvbmNhdChlLnRpdGxlLCIg4oCUID8iKSxjbGFzc05hbWU6ImhlbHAtaWNvbiJ9LGEuYS5jcmVhdGVFbGVtZW50KCJkaXYiLHtvbkNsaWNrOmUub25DbGlja30seHQpKX07ZnVuY3Rpb24gVHQoZSx0KXt2YXIgbj1PYmplY3Qua2V5cyhlKTtpZihPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgcj1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO3QmJihyPXIuZmlsdGVyKChmdW5jdGlvbih0KXtyZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihlLHQpLmVudW1lcmFibGV9KSkpLG4ucHVzaC5hcHBseShuLHIpfXJldHVybiBufWZ1bmN0aW9uIFB0KGUpe2Zvcih2YXIgdD0xO3Q8YXJndW1lbnRzLmxlbmd0aDt0Kyspe3ZhciBuPW51bGwhPWFyZ3VtZW50c1t0XT9hcmd1bWVudHNbdF06e307dCUyP1R0KE9iamVjdChuKSwhMCkuZm9yRWFjaCgoZnVuY3Rpb24odCl7QXQoZSx0LG5bdF0pfSkpOk9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzP09iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGUsT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMobikpOlR0KE9iamVjdChuKSkuZm9yRWFjaCgoZnVuY3Rpb24odCl7T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsdCxPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG4sdCkpfSkpfXJldHVybiBlfWZ1bmN0aW9uIEF0KGUsdCxuKXtyZXR1cm4gdCBpbiBlP09iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHQse3ZhbHVlOm4sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITAsd3JpdGFibGU6ITB9KTplW3RdPW4sZX1TZSh7bmFtZToidG9nZ2xlQ2FudmFzTWVudSIscGVyZm9ybTpmdW5jdGlvbihlLHQpe3JldHVybnthcHBTdGF0ZTpQdChQdCh7fSx0KSx7fSx7b3Blbk1lbnU6ImNhbnZhcyI9PT10Lm9wZW5NZW51P251bGw6ImNhbnZhcyJ9KSxjb21taXRUb0hpc3Rvcnk6ITF9fSxQYW5lbENvbXBvbmVudDpmdW5jdGlvbihlKXt2YXIgdD1lLmFwcFN0YXRlLG49ZS51cGRhdGVEYXRhO3JldHVybiBhLmEuY3JlYXRlRWxlbWVudChVLHt0eXBlOiJidXR0b24iLGljb246b2UsImFyaWEtbGFiZWwiOk9iamVjdChzLmUpKCJidXR0b25zLm1lbnUiKSxvbkNsaWNrOm4sc2VsZWN0ZWQ6ImNhbnZhcyI9PT10Lm9wZW5NZW51fSl9fSksU2Uoe25hbWU6InRvZ2dsZUVkaXRNZW51IixwZXJmb3JtOmZ1bmN0aW9uKGUsdCl7cmV0dXJue2FwcFN0YXRlOlB0KFB0KHt9LHQpLHt9LHtvcGVuTWVudToic2hhcGUiPT09dC5vcGVuTWVudT9udWxsOiJzaGFwZSJ9KSxjb21taXRUb0hpc3Rvcnk6ITF9fSxQYW5lbENvbXBvbmVudDpmdW5jdGlvbihlKXt2YXIgdD1lLmVsZW1lbnRzLG49ZS5hcHBTdGF0ZSxyPWUudXBkYXRlRGF0YTtyZXR1cm4gYS5hLmNyZWF0ZUVsZW1lbnQoVSx7dmlzaWJsZTpPYmplY3QoZi5HKShuLE9iamVjdChmLm4pKHQpKSx0eXBlOiJidXR0b24iLGljb246USwiYXJpYS1sYWJlbCI6T2JqZWN0KHMuZSkoImJ1dHRvbnMuZWRpdCIpLG9uQ2xpY2s6cixzZWxlY3RlZDoic2hhcGUiPT09bi5vcGVuTWVudX0pfX0pLFNlKHtuYW1lOiJ0b2dnbGVGdWxsU2NyZWVuIixwZXJmb3JtOmZ1bmN0aW9uKCl7cmV0dXJuIE9iamVjdChPLmwpKCl8fE9iamVjdChPLmIpKCksT2JqZWN0KE8ubCkoKSYmT2JqZWN0KE8uZikoKSx7Y29tbWl0VG9IaXN0b3J5OiExfX0sa2V5VGVzdDpmdW5jdGlvbihlKXtyZXR1cm4gZS5rZXlDb2RlPT09Qy5hLkZfS0VZX0NPREV9fSksU2Uoe25hbWU6InRvZ2dsZVNob3J0Y3V0cyIscGVyZm9ybTpmdW5jdGlvbihlLHQpe3JldHVybnthcHBTdGF0ZTpQdChQdCh7fSx0KSx7fSx7c2hvd1Nob3J0Y3V0c0RpYWxvZzohMH0pLGNvbW1pdFRvSGlzdG9yeTohMX19LFBhbmVsQ29tcG9uZW50OmZ1bmN0aW9uKGUpe3ZhciB0PWUudXBkYXRlRGF0YTtyZXR1cm4gYS5hLmNyZWF0ZUVsZW1lbnQoanQse3RpdGxlOk9iamVjdChzLmUpKCJzaG9ydGN1dHNEaWFsb2cudGl0bGUiKSxvbkNsaWNrOnR9KX0sa2V5VGVzdDpmdW5jdGlvbihlKXtyZXR1cm4gZS5rZXk9PT1DLmEuUVVFU1RJT05fTUFSS319KTt2YXIgTXQ9bigyMCksX3Q9ZnVuY3Rpb24oKXtmb3IodmFyIGU9MCx0PTAsbj1hcmd1bWVudHMubGVuZ3RoO3Q8bjt0KyspZSs9YXJndW1lbnRzW3RdLmxlbmd0aDt2YXIgcj1BcnJheShlKSxvPTA7Zm9yKHQ9MDt0PG47dCsrKWZvcih2YXIgYT1hcmd1bWVudHNbdF0saT0wLHM9YS5sZW5ndGg7aTxzO2krKyxvKyspcltvXT1hW2ldO3JldHVybiByfTtmdW5jdGlvbiB6dChlLHQpe3ZhciBuPU9iamVjdC5rZXlzKGUpO2lmKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpe3ZhciByPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7dCYmKHI9ci5maWx0ZXIoKGZ1bmN0aW9uKHQpe3JldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGUsdCkuZW51bWVyYWJsZX0pKSksbi5wdXNoLmFwcGx5KG4scil9cmV0dXJuIG59ZnVuY3Rpb24gTHQoZSl7Zm9yKHZhciB0PTE7dDxhcmd1bWVudHMubGVuZ3RoO3QrKyl7dmFyIG49bnVsbCE9YXJndW1lbnRzW3RdP2FyZ3VtZW50c1t0XTp7fTt0JTI/enQoT2JqZWN0KG4pLCEwKS5mb3JFYWNoKChmdW5jdGlvbih0KXtJdChlLHQsblt0XSl9KSk6T2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnM/T2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZSxPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhuKSk6enQoT2JqZWN0KG4pKS5mb3JFYWNoKChmdW5jdGlvbih0KXtPYmplY3QuZGVmaW5lUHJvcGVydHkoZSx0LE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iobix0KSl9KSl9cmV0dXJuIGV9ZnVuY3Rpb24gSXQoZSx0LG4pe3JldHVybiB0IGluIGU/T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsdCx7dmFsdWU6bixlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMCx3cml0YWJsZTohMH0pOmVbdF09bixlfXZhciBEdD1mdW5jdGlvbihlLHQpe3ZhciBuPU9iamVjdChtLmcpKE9iamVjdChmLm4pKGUpLHQpO3JldHVybiBuLmxlbmd0aD49MiYmIWZ1bmN0aW9uKGUpe2lmKGUubGVuZ3RoPj0yKWZvcih2YXIgdD1mdW5jdGlvbih0KXtpZihlLnJlZHVjZSgoZnVuY3Rpb24oZSxuKXtyZXR1cm4gZSYmT2JqZWN0KE9lLmYpKG4sdCl9KSwhMCkpcmV0dXJue3ZhbHVlOiEwfX0sbj0wLHI9ZVswXS5ncm91cElkcztuPHIubGVuZ3RoO24rKyl7dmFyIG89dChyW25dKTtpZigib2JqZWN0Ij09dHlwZW9mIG8pcmV0dXJuIG8udmFsdWV9cmV0dXJuITF9KG4pfSxOdD0oU2Uoe25hbWU6Imdyb3VwIixwZXJmb3JtOmZ1bmN0aW9uKGUsdCl7dmFyIG49T2JqZWN0KG0uZykoT2JqZWN0KGYubikoZSksdCk7aWYobi5sZW5ndGg8MilyZXR1cm57YXBwU3RhdGU6dCxlbGVtZW50czplLGNvbW1pdFRvSGlzdG9yeTohMX07dmFyIHI9T2JqZWN0KE9lLmUpKHQpO2lmKDE9PT1yLmxlbmd0aCl7dmFyIG89clswXSxhPW5ldyBTZXQoT2JqZWN0KE9lLmIpKGUsbykubWFwKChmdW5jdGlvbihlKXtyZXR1cm4gZS5pZH0pKSksaT1uZXcgU2V0KG4ubWFwKChmdW5jdGlvbihlKXtyZXR1cm4gZS5pZH0pKSk7aWYobmV3IFNldChfdChBcnJheS5mcm9tKGEpLEFycmF5LmZyb20oaSkpKS5zaXplPT09YS5zaXplKXJldHVybnthcHBTdGF0ZTp0LGVsZW1lbnRzOmUsY29tbWl0VG9IaXN0b3J5OiExfX12YXIgcz1PYmplY3QoTXQuYSkoKSxsPWUubWFwKChmdW5jdGlvbihlKXtyZXR1cm4gdC5zZWxlY3RlZEVsZW1lbnRJZHNbZS5pZF0/T2JqZWN0KEVlLmIpKGUse2dyb3VwSWRzOk9iamVjdChPZS5hKShlLmdyb3VwSWRzLHMsdC5lZGl0aW5nR3JvdXBJZCl9KTplfSkpLGM9T2JqZWN0KE9lLmIpKGwscyksdT1jW2MubGVuZ3RoLTFdLGQ9bC5sYXN0SW5kZXhPZih1KSxwPWwuc2xpY2UoZCsxKSxoPWwuc2xpY2UoMCxkKS5maWx0ZXIoKGZ1bmN0aW9uKGUpe3JldHVybiFPYmplY3QoT2UuZikoZSxzKX0pKSxnPV90KGgsYyxwKTtyZXR1cm57YXBwU3RhdGU6T2JqZWN0KE9lLmkpKHMsTHQoTHQoe30sdCkse30se3NlbGVjdGVkR3JvdXBJZHM6e319KSxPYmplY3QoZi5uKShnKSksZWxlbWVudHM6Zyxjb21taXRUb0hpc3Rvcnk6ITB9fSxjb250ZXh0TWVudU9yZGVyOjQsY29udGV4dEl0ZW1MYWJlbDoibGFiZWxzLmdyb3VwIixjb250ZXh0SXRlbVByZWRpY2F0ZTpmdW5jdGlvbihlLHQpe3JldHVybiBEdChlLHQpfSxrZXlUZXN0OmZ1bmN0aW9uKGUpe3JldHVybiFlLnNoaWZ0S2V5JiZlW0MuYS5DVFJMX09SX0NNRF0mJmUua2V5Q29kZT09PUMuYS5HX0tFWV9DT0RFfSxQYW5lbENvbXBvbmVudDpmdW5jdGlvbihlKXt2YXIgdD1lLmVsZW1lbnRzLG49ZS5hcHBTdGF0ZSxyPWUudXBkYXRlRGF0YTtyZXR1cm4gYS5hLmNyZWF0ZUVsZW1lbnQoVSx7aGlkZGVuOiFEdCh0LG4pLHR5cGU6ImJ1dHRvbiIsaWNvbjp2ZSxvbkNsaWNrOmZ1bmN0aW9uKCl7cmV0dXJuIHIobnVsbCl9LHRpdGxlOiIiLmNvbmNhdChPYmplY3Qocy5lKSgibGFiZWxzLmdyb3VwIiksIiDigJQgIikuY29uY2F0KE9iamVjdChPLmspKCJDdHJsT3JDbWQrRyIpKSwiYXJpYS1sYWJlbCI6T2JqZWN0KHMuZSkoImxhYmVscy5ncm91cCIpLHZpc2libGU6T2JqZWN0KG0ubikoT2JqZWN0KGYubikodCksbil9KX19KSxTZSh7bmFtZToidW5ncm91cCIscGVyZm9ybTpmdW5jdGlvbihlLHQpe2lmKDA9PT1PYmplY3QoT2UuZSkodCkubGVuZ3RoKXJldHVybnthcHBTdGF0ZTp0LGVsZW1lbnRzOmUsY29tbWl0VG9IaXN0b3J5OiExfTt2YXIgbj1lLm1hcCgoZnVuY3Rpb24oZSl7dmFyIG49T2JqZWN0KE9lLmgpKGUuZ3JvdXBJZHMsdC5zZWxlY3RlZEdyb3VwSWRzKTtyZXR1cm4gbi5sZW5ndGg9PT1lLmdyb3VwSWRzLmxlbmd0aD9lOk9iamVjdChFZS5iKShlLHtncm91cElkczpufSl9KSk7cmV0dXJue2FwcFN0YXRlOk9iamVjdChPZS5qKShMdChMdCh7fSx0KSx7fSx7c2VsZWN0ZWRHcm91cElkczp7fX0pLE9iamVjdChmLm4pKG4pKSxlbGVtZW50czpuLGNvbW1pdFRvSGlzdG9yeTohMH19LGtleVRlc3Q6ZnVuY3Rpb24oZSl7cmV0dXJuIGUuc2hpZnRLZXkmJmVbQy5hLkNUUkxfT1JfQ01EXSYmZS5rZXlDb2RlPT09Qy5hLkdfS0VZX0NPREV9LGNvbnRleHRNZW51T3JkZXI6NSxjb250ZXh0SXRlbUxhYmVsOiJsYWJlbHMudW5ncm91cCIsY29udGV4dEl0ZW1QcmVkaWNhdGU6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gT2JqZWN0KE9lLmUpKHQpLmxlbmd0aD4wfSxQYW5lbENvbXBvbmVudDpmdW5jdGlvbihlKXt2YXIgdD1lLmVsZW1lbnRzLG49ZS5hcHBTdGF0ZSxyPWUudXBkYXRlRGF0YTtyZXR1cm4gYS5hLmNyZWF0ZUVsZW1lbnQoVSx7dHlwZToiYnV0dG9uIixoaWRkZW46MD09PU9iamVjdChPZS5lKShuKS5sZW5ndGgsaWNvbjprZSxvbkNsaWNrOmZ1bmN0aW9uKCl7cmV0dXJuIHIobnVsbCl9LHRpdGxlOiIiLmNvbmNhdChPYmplY3Qocy5lKSgibGFiZWxzLnVuZ3JvdXAiKSwiIOKAlCAiKS5jb25jYXQoT2JqZWN0KE8uaykoIkN0cmxPckNtZCtTaGlmdCtHIikpLCJhcmlhLWxhYmVsIjpPYmplY3Qocy5lKSgibGFiZWxzLnVuZ3JvdXAiKSx2aXNpYmxlOk9iamVjdChtLm4pKE9iamVjdChmLm4pKHQpLG4pfSl9fSksbig3MyksZnVuY3Rpb24oZSl7dmFyIHQ9ZS5jaGlsZHJlbixuPWUuY2xhc3NOYW1lLHI9ZS5jb2xvcixvPWUub25DbGljaztyZXR1cm4gYS5hLmNyZWF0ZUVsZW1lbnQoImRpdiIse2NsYXNzTmFtZToiQXZhdGFyICIuY29uY2F0KG4pLHN0eWxlOntiYWNrZ3JvdW5kOnJ9LG9uQ2xpY2s6b30sdCl9KSxGdD1uKDM3KTtmdW5jdGlvbiBSdChlLHQpe3ZhciBuPU9iamVjdC5rZXlzKGUpO2lmKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpe3ZhciByPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7dCYmKHI9ci5maWx0ZXIoKGZ1bmN0aW9uKHQpe3JldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGUsdCkuZW51bWVyYWJsZX0pKSksbi5wdXNoLmFwcGx5KG4scil9cmV0dXJuIG59ZnVuY3Rpb24gQnQoZSl7Zm9yKHZhciB0PTE7dDxhcmd1bWVudHMubGVuZ3RoO3QrKyl7dmFyIG49bnVsbCE9YXJndW1lbnRzW3RdP2FyZ3VtZW50c1t0XTp7fTt0JTI/UnQoT2JqZWN0KG4pLCEwKS5mb3JFYWNoKChmdW5jdGlvbih0KXtIdChlLHQsblt0XSl9KSk6T2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnM/T2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZSxPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhuKSk6UnQoT2JqZWN0KG4pKS5mb3JFYWNoKChmdW5jdGlvbih0KXtPYmplY3QuZGVmaW5lUHJvcGVydHkoZSx0LE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iobix0KSl9KSl9cmV0dXJuIGV9ZnVuY3Rpb24gSHQoZSx0LG4pe3JldHVybiB0IGluIGU/T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsdCx7dmFsdWU6bixlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMCx3cml0YWJsZTohMH0pOmVbdF09bixlfVNlKHtuYW1lOiJnb1RvQ29sbGFib3JhdG9yIixwZXJmb3JtOmZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1uO3JldHVybiByP3thcHBTdGF0ZTpCdChCdCh7fSx0KSx7fSx7c2Nyb2xsWDpPYmplY3QobS5vKSh0LndpZHRoLzItci54KSxzY3JvbGxZOk9iamVjdChtLm8pKHQuaGVpZ2h0LzItci55KSxvcGVuTWVudToiY2FudmFzIj09PXQub3Blbk1lbnU/bnVsbDp0Lm9wZW5NZW51fSksY29tbWl0VG9IaXN0b3J5OiExfTp7YXBwU3RhdGU6dCxjb21taXRUb0hpc3Rvcnk6ITF9fSxQYW5lbENvbXBvbmVudDpmdW5jdGlvbihlKXt2YXIgdD1lLmFwcFN0YXRlLG49ZS51cGRhdGVEYXRhLHI9ZS5pZDtpZighcilyZXR1cm4gbnVsbDt2YXIgbz10LmNvbGxhYm9yYXRvcnMuZ2V0KHIpO2lmKCFvKXJldHVybiBudWxsO3ZhciBpPU9iamVjdChGdC5hKShyKS5iYWNrZ3JvdW5kLHM9T2JqZWN0KEZ0LmIpKG8udXNlcm5hbWUpO3JldHVybiBhLmEuY3JlYXRlRWxlbWVudChOdCx7Y29sb3I6aSxvbkNsaWNrOmZ1bmN0aW9uKCl7cmV0dXJuIG4oby5wb2ludGVyKX19LHMpfX0pO3ZhciBHdD1uKDE1KSxXdD1mdW5jdGlvbigpe2Zvcih2YXIgZT0wLHQ9MCxuPWFyZ3VtZW50cy5sZW5ndGg7dDxuO3QrKyllKz1hcmd1bWVudHNbdF0ubGVuZ3RoO3ZhciByPUFycmF5KGUpLG89MDtmb3IodD0wO3Q8bjt0KyspZm9yKHZhciBhPWFyZ3VtZW50c1t0XSxpPTAscz1hLmxlbmd0aDtpPHM7aSsrLG8rKylyW29dPWFbaV07cmV0dXJuIHJ9LFV0PShTZSh7bmFtZToiYWRkVG9MaWJyYXJ5IixwZXJmb3JtOmZ1bmN0aW9uKGUsdCl7dmFyIG49T2JqZWN0KG0uZykoT2JqZWN0KGYubikoZSksdCk7cmV0dXJuIE9iamVjdChHdC5hKSgpLnRoZW4oKGZ1bmN0aW9uKGUpe09iamVjdChHdC5iKShXdChlLFtuLm1hcChQLmEpXSkpfSkpLCExfSxjb250ZXh0TWVudU9yZGVyOjYsY29udGV4dEl0ZW1MYWJlbDoibGFiZWxzLmFkZFRvTGlicmFyeSJ9KSxuKDE4KSksVnQ9ZnVuY3Rpb24oZSl7dmFyIHQ9QXJyYXkuZnJvbShlLnZhbHVlcygpKTtyZXR1cm57eDpPYmplY3QobS5vKShadCh0LChmdW5jdGlvbihlKXtyZXR1cm4gZS54fSkpL3QubGVuZ3RoKSx5Ok9iamVjdChtLm8pKFp0KHQsKGZ1bmN0aW9uKGUpe3JldHVybiBlLnl9KSkvdC5sZW5ndGgpfX0sS3Q9ZnVuY3Rpb24oZSl7dmFyIHQ9ZVswXSxuPWVbMV07cmV0dXJuIE1hdGguaHlwb3QodC54LW4ueCx0Lnktbi55KX0sWnQ9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZS5yZWR1Y2UoKGZ1bmN0aW9uKGUsbil7cmV0dXJuIGUrdChuKX0pLDApfTtmdW5jdGlvbiBxdChlLHQpe3ZhciBuPU9iamVjdC5rZXlzKGUpO2lmKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpe3ZhciByPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7dCYmKHI9ci5maWx0ZXIoKGZ1bmN0aW9uKHQpe3JldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGUsdCkuZW51bWVyYWJsZX0pKSksbi5wdXNoLmFwcGx5KG4scil9cmV0dXJuIG59ZnVuY3Rpb24gWXQoZSl7Zm9yKHZhciB0PTE7dDxhcmd1bWVudHMubGVuZ3RoO3QrKyl7dmFyIG49bnVsbCE9YXJndW1lbnRzW3RdP2FyZ3VtZW50c1t0XTp7fTt0JTI/cXQoT2JqZWN0KG4pLCEwKS5mb3JFYWNoKChmdW5jdGlvbih0KXtYdChlLHQsblt0XSl9KSk6T2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnM/T2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZSxPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhuKSk6cXQoT2JqZWN0KG4pKS5mb3JFYWNoKChmdW5jdGlvbih0KXtPYmplY3QuZGVmaW5lUHJvcGVydHkoZSx0LE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iobix0KSl9KSl9cmV0dXJuIGV9ZnVuY3Rpb24gWHQoZSx0LG4pe3JldHVybiB0IGluIGU/T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsdCx7dmFsdWU6bixlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMCx3cml0YWJsZTohMH0pOmVbdF09bixlfXZhciBKdD1mdW5jdGlvbihlLHQsbil7aWYoISh0Lm11bHRpRWxlbWVudHx8dC5yZXNpemluZ0VsZW1lbnR8fHQuZWRpdGluZ0VsZW1lbnR8fHQuZHJhZ2dpbmdFbGVtZW50KSl7dmFyIHI9bigpO2lmKG51bGw9PT1yKXJldHVybntjb21taXRUb0hpc3Rvcnk6ITF9O3ZhciBvPU9iamVjdChmLmwpKGUpLGE9ci5lbGVtZW50cyxpPU9iamVjdChmLmwpKGEpO3JldHVybntlbGVtZW50czphLm1hcCgoZnVuY3Rpb24oZSl7cmV0dXJuIE9iamVjdChFZS5iKShvW2UuaWRdfHxlLGUpfSkpLmNvbmNhdChlLmZpbHRlcigoZnVuY3Rpb24oZSl7cmV0dXJuIWkuaGFzT3duUHJvcGVydHkoZS5pZCl9KSkubWFwKChmdW5jdGlvbihlKXtyZXR1cm4gT2JqZWN0KEVlLmIpKGUse2lzRGVsZXRlZDohMH0pfSkpKSxhcHBTdGF0ZTpZdChZdCh7fSx0KSxyLmFwcFN0YXRlKSxjb21taXRUb0hpc3Rvcnk6ITEsc3luY0hpc3Rvcnk6ITB9fXJldHVybntjb21taXRUb0hpc3Rvcnk6ITF9fSwkdD1mdW5jdGlvbihlKXtyZXR1cm4gZnVuY3Rpb24odCl7cmV0dXJuIHRbQy5hLkNUUkxfT1JfQ01EXSYmL3ovaS50ZXN0KHQua2V5KSYmdC5zaGlmdEtleT09PWV9fTtuKDc0KTtmdW5jdGlvbiBRdChlLHQpe3ZhciBuPU9iamVjdC5rZXlzKGUpO2lmKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpe3ZhciByPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7dCYmKHI9ci5maWx0ZXIoKGZ1bmN0aW9uKHQpe3JldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGUsdCkuZW51bWVyYWJsZX0pKSksbi5wdXNoLmFwcGx5KG4scil9cmV0dXJuIG59ZnVuY3Rpb24gZW4oZSl7Zm9yKHZhciB0PTE7dDxhcmd1bWVudHMubGVuZ3RoO3QrKyl7dmFyIG49bnVsbCE9YXJndW1lbnRzW3RdP2FyZ3VtZW50c1t0XTp7fTt0JTI/UXQoT2JqZWN0KG4pLCEwKS5mb3JFYWNoKChmdW5jdGlvbih0KXt0bihlLHQsblt0XSl9KSk6T2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnM/T2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZSxPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhuKSk6UXQoT2JqZWN0KG4pKS5mb3JFYWNoKChmdW5jdGlvbih0KXtPYmplY3QuZGVmaW5lUHJvcGVydHkoZSx0LE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iobix0KSl9KSl9cmV0dXJuIGV9ZnVuY3Rpb24gdG4oZSx0LG4pe3JldHVybiB0IGluIGU/T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsdCx7dmFsdWU6bixlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMCx3cml0YWJsZTohMH0pOmVbdF09bixlfXZhciBubj1hLmEuZm9yd2FyZFJlZigoZnVuY3Rpb24oZSx0KXt2YXIgbj1lLmNoaWxkcmVuLHI9ZS5wYWRkaW5nLG89ZS5jbGFzc05hbWUsaT1lLnN0eWxlO3JldHVybiBhLmEuY3JlYXRlRWxlbWVudCgiZGl2Iix7Y2xhc3NOYW1lOiIiLmNvbmNhdChudWxsIT1vP286IiIsIiBJc2xhbmQiKSxzdHlsZTplbih7Ii0tcGFkZGluZyI6cn0saSkscmVmOnR9LG4pfSkpLHJuPShuKDc1KSxmdW5jdGlvbihlKXt2YXIgdD1lLmNoaWxkcmVuLG49ZS5nYXAscj1lLmFsaWduLG89ZS5qdXN0aWZ5Q29udGVudCxpPWUuY2xhc3NOYW1lO3JldHVybiBhLmEuY3JlYXRlRWxlbWVudCgiZGl2Iix7Y2xhc3NOYW1lOiJTdGFjayBTdGFja19ob3Jpem9udGFsICIuY29uY2F0KGl8fCIiKSxzdHlsZTp7Ii0tZ2FwIjpuLGFsaWduSXRlbXM6cixqdXN0aWZ5Q29udGVudDpvfX0sdCl9KSxvbj1mdW5jdGlvbihlKXt2YXIgdD1lLmNoaWxkcmVuLG49ZS5nYXAscj1lLmFsaWduLG89ZS5qdXN0aWZ5Q29udGVudCxpPWUuY2xhc3NOYW1lO3JldHVybiBhLmEuY3JlYXRlRWxlbWVudCgiZGl2Iix7Y2xhc3NOYW1lOiJTdGFjayBTdGFja192ZXJ0aWNhbCAiLmNvbmNhdChpfHwiIiksc3R5bGU6eyItLWdhcCI6bixqdXN0aWZ5SXRlbXM6cixqdXN0aWZ5Q29udGVudDpvfX0sdCl9LGFuPShuKDc2KSxmdW5jdGlvbihlKXt2YXIgdD1lLmNoaWxkcmVuLG49ZS5zaWRlLHI9ZS5jbGFzc05hbWU7cmV0dXJuIGEuYS5jcmVhdGVFbGVtZW50KCJkaXYiLHtjbGFzc05hbWU6IkZpeGVkU2lkZUNvbnRhaW5lciBGaXhlZFNpZGVDb250YWluZXJfc2lkZV8iLmNvbmNhdChuLCIgIikuY29uY2F0KHIpfSx0KX0pLHNuPShuKDc3KSxmdW5jdGlvbihlKXt2YXIgdD1lLmNoaWxkcmVuLG49ZS5jbGFzc05hbWUscj1lLm1vYmlsZSxvPSJVc2VyTGlzdCI7cmV0dXJuIG4mJihvKz0iICIuY29uY2F0KG4pKSxyJiYobys9IiBVc2VyTGlzdF9tb2JpbGUiKSxhLmEuY3JlYXRlRWxlbWVudCgiZGl2Iix7Y2xhc3NOYW1lOm99LHQpfSksbG49e0NIRUNLRUQ6YS5hLmNyZWF0ZUVsZW1lbnQoInN2ZyIse3dpZHRoOiIxNzkyIixoZWlnaHQ6IjE3OTIiLHZpZXdCb3g6IjAgMCAxNzkyIDE3OTIiLHhtbG5zOiJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyJ9LGEuYS5jcmVhdGVFbGVtZW50KCJwYXRoIix7ZDoiTTY0MCA3NjhoNTEydi0xOTJxMC0xMDYtNzUtMTgxdC0xODEtNzUtMTgxIDc1LTc1IDE4MXYxOTJ6bTgzMiA5NnY1NzZxMCA0MC0yOCA2OHQtNjggMjhoLTk2MHEtNDAgMC02OC0yOHQtMjgtNjh2LTU3NnEwLTQwIDI4LTY4dDY4LTI4aDMydi0xOTJxMC0xODQgMTMyLTMxNnQzMTYtMTMyIDMxNiAxMzIgMTMyIDMxNnYxOTJoMzJxNDAgMCA2OCAyOHQyOCA2OHoifSkpLFVOQ0hFQ0tFRDphLmEuY3JlYXRlRWxlbWVudCgic3ZnIix7d2lkdGg6IjE3OTIiLGhlaWdodDoiMTc5MiIsdmlld0JveDoiMCAwIDE3OTIgMTc5MiIseG1sbnM6Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIixjbGFzc05hbWU6InVubG9ja2VkLWljb24gcnRsLW1pcnJvciJ9LGEuYS5jcmVhdGVFbGVtZW50KCJwYXRoIix7ZDoiTTE3MjggNTc2djI1NnEwIDI2LTE5IDQ1dC00NSAxOWgtNjRxLTI2IDAtNDUtMTl0LTE5LTQ1di0yNTZxMC0xMDYtNzUtMTgxdC0xODEtNzUtMTgxIDc1LTc1IDE4MXYxOTJoOTZxNDAgMCA2OCAyOHQyOCA2OHY1NzZxMCA0MC0yOCA2OHQtNjggMjhoLTk2MHEtNDAgMC02OC0yOHQtMjgtNjh2LTU3NnEwLTQwIDI4LTY4dDY4LTI4aDY3MnYtMTkycTAtMTg1IDEzMS41LTMxNi41dDMxNi41LTEzMS41IDMxNi41IDEzMS41IDEzMS41IDMxNi41eiJ9KSl9LGNuPWZ1bmN0aW9uKGUpe3ZhciB0PSJUb29sSWNvbl9zaXplXyIuY29uY2F0KGUuc2l6ZXx8Im0iKTtyZXR1cm4gYS5hLmNyZWF0ZUVsZW1lbnQoImxhYmVsIix7Y2xhc3NOYW1lOiJUb29sSWNvbiBUb29sSWNvbl9fbG9jayBUb29sSWNvbl90eXBlX2Zsb2F0aW5nICIuY29uY2F0KHQsIiB6ZW4tbW9kZS12aXNpYmlsaXR5ICIpLmNvbmNhdChlLnplbk1vZGVFbmFibGVkPyJ6ZW4tbW9kZS12aXNpYmlsaXR5LS1oaWRkZW4iOiIiKSx0aXRsZToiIi5jb25jYXQoZS50aXRsZSwiIOKAlCBRIil9LGEuYS5jcmVhdGVFbGVtZW50KCJpbnB1dCIse2NsYXNzTmFtZToiVG9vbEljb25fdHlwZV9jaGVja2JveCIsdHlwZToiY2hlY2tib3giLG5hbWU6ZS5uYW1lLGlkOmUuaWQsb25DaGFuZ2U6ZS5vbkNoYW5nZSxjaGVja2VkOmUuY2hlY2tlZCwiYXJpYS1sYWJlbCI6ZS50aXRsZX0pLGEuYS5jcmVhdGVFbGVtZW50KCJkaXYiLHtjbGFzc05hbWU6IlRvb2xJY29uX19pY29uIn0sZS5jaGVja2VkP2xuLkNIRUNLRUQ6bG4uVU5DSEVDS0VEKSl9LHVuPShuKDc4KSxuKDI1KSksZG49KG4oNzkpLGZ1bmN0aW9uKGUpe3ZhciB0LG49cG4oKTtyZXR1cm4gT2JqZWN0KEQuY3JlYXRlUG9ydGFsKShhLmEuY3JlYXRlRWxlbWVudCgiZGl2Iix7Y2xhc3NOYW1lOiJNb2RhbCAiLmNvbmNhdChudWxsIT09KHQ9ZS5jbGFzc05hbWUpJiZ2b2lkIDAhPT10P3Q6IiIpLHJvbGU6ImRpYWxvZyIsImFyaWEtbW9kYWwiOiJ0cnVlIixvbktleURvd246ZnVuY3Rpb24odCl7dC5rZXk9PT1DLmEuRVNDQVBFJiYodC5uYXRpdmVFdmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKSxlLm9uQ2xvc2VSZXF1ZXN0KCkpfSwiYXJpYS1sYWJlbGxlZGJ5IjplLmxhYmVsbGVkQnl9LGEuYS5jcmVhdGVFbGVtZW50KCJkaXYiLHtjbGFzc05hbWU6Ik1vZGFsX19iYWNrZ3JvdW5kIixvbkNsaWNrOmUub25DbG9zZVJlcXVlc3R9KSxhLmEuY3JlYXRlRWxlbWVudCgiZGl2Iix7Y2xhc3NOYW1lOiJNb2RhbF9fY29udGVudCIsc3R5bGU6eyItLW1heC13aWR0aCI6IiIuY29uY2F0KGUubWF4V2lkdGgsInB4IiksbWF4SGVpZ2h0OiIxMDAlIixvdmVyZmxvd1k6InNjcm9sbCJ9fSxlLmNoaWxkcmVuKSksbil9KSxwbj1mdW5jdGlvbigpe3ZhciBlPU9iamVjdChvLnVzZVN0YXRlKSgoZnVuY3Rpb24oKXt2YXIgZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTtyZXR1cm4gZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlKSxlfSkpWzBdO3JldHVybiBPYmplY3Qoby51c2VFZmZlY3QpKChmdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbigpe2RvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoZSl9fSksW2VdKSxlfSxobj0obig4MCksZnVuY3Rpb24oZSl7dmFyIHQsbj1PYmplY3Qoby51c2VSZWYpKG51bGwpO09iamVjdChvLnVzZUVmZmVjdCkoKGZ1bmN0aW9uKCl7dmFyIGU9cigpO2UubGVuZ3RoPjAmJihlWzFdfHxlWzBdKS5mb2N1cygpfSksW10pLE9iamVjdChvLnVzZUVmZmVjdCkoKGZ1bmN0aW9uKCl7aWYobi5jdXJyZW50KXt2YXIgZT1mdW5jdGlvbihlKXtpZihlLmtleT09PUMuYS5UQUIpe3ZhciB0PXIoKSxuPWRvY3VtZW50LmFjdGl2ZUVsZW1lbnQsbz10LmZpbmRJbmRleCgoZnVuY3Rpb24oZSl7cmV0dXJuIGU9PT1ufSkpOzA9PT1vJiZlLnNoaWZ0S2V5Pyh0W3QubGVuZ3RoLTFdLmZvY3VzKCksZS5wcmV2ZW50RGVmYXVsdCgpKTpvIT09dC5sZW5ndGgtMXx8ZS5zaGlmdEtleXx8KHRbMF0uZm9jdXMoKSxlLnByZXZlbnREZWZhdWx0KCkpfX0sdD1uLmN1cnJlbnQ7cmV0dXJuIHQuYWRkRXZlbnRMaXN0ZW5lcigia2V5ZG93biIsZSksZnVuY3Rpb24oKXtyZXR1cm4gdC5yZW1vdmVFdmVudExpc3RlbmVyKCJrZXlkb3duIixlKX19fSksW10pO3ZhciByPWZ1bmN0aW9uKCl7dmFyIGUsdD1udWxsPT09KGU9bi5jdXJyZW50KXx8dm9pZCAwPT09ZT92b2lkIDA6ZS5xdWVyeVNlbGVjdG9yQWxsKCJidXR0b24sIGEsIGlucHV0LCBzZWxlY3QsIHRleHRhcmVhLCBkaXZbdGFiaW5kZXhdIik7cmV0dXJuIHQ/QXJyYXkuZnJvbSh0KTpbXX07cmV0dXJuIGEuYS5jcmVhdGVFbGVtZW50KGRuLHtjbGFzc05hbWU6IiIuY29uY2F0KG51bGwhPT0odD1lLmNsYXNzTmFtZSkmJnZvaWQgMCE9PXQ/dDoiIiwiIERpYWxvZyIpLGxhYmVsbGVkQnk6ImRpYWxvZy10aXRsZSIsbWF4V2lkdGg6ZS5tYXhXaWR0aCxvbkNsb3NlUmVxdWVzdDplLm9uQ2xvc2VSZXF1ZXN0fSxhLmEuY3JlYXRlRWxlbWVudChubix7cGFkZGluZzo0LHJlZjpufSxhLmEuY3JlYXRlRWxlbWVudCgiaDIiLHtpZDoiZGlhbG9nLXRpdGxlIixjbGFzc05hbWU6IkRpYWxvZ19fdGl0bGUifSxhLmEuY3JlYXRlRWxlbWVudCgic3BhbiIse2NsYXNzTmFtZToiRGlhbG9nX190aXRsZUNvbnRlbnQifSxlLnRpdGxlKSxhLmEuY3JlYXRlRWxlbWVudCgiYnV0dG9uIix7Y2xhc3NOYW1lOiJNb2RhbF9fY2xvc2UiLG9uQ2xpY2s6ZS5vbkNsb3NlUmVxdWVzdCwiYXJpYS1sYWJlbCI6T2JqZWN0KHMuZSkoImJ1dHRvbnMuY2xvc2UiKX0sYXQoKT9nZTptZSkpLGUuY2hpbGRyZW4pKX0pLGZuPVsxLDIsM10sbW49Zm4uaW5jbHVkZXMoZGV2aWNlUGl4ZWxSYXRpbyk/ZGV2aWNlUGl4ZWxSYXRpbzoxLGduPWZ1bmN0aW9uKGUpe3ZhciB0PWUuZWxlbWVudHMsbj1lLmFwcFN0YXRlLHI9ZS5leHBvcnRQYWRkaW5nLGk9dm9pZCAwPT09cj8xMDpyLGw9ZS5hY3Rpb25NYW5hZ2VyLGM9ZS5vbkV4cG9ydFRvUG5nLHU9ZS5vbkV4cG9ydFRvU3ZnLGQ9ZS5vbkV4cG9ydFRvQ2xpcGJvYXJkLHA9ZS5vbkV4cG9ydFRvQmFja2VuZCxoPU9iamVjdChtLm4pKHQsbiksZj1PYmplY3Qoby51c2VTdGF0ZSkobW4pLGc9ZlswXSxiPWZbMV0seT1PYmplY3Qoby51c2VTdGF0ZSkoaCksdj15WzBdLGs9eVsxXSx3PU9iamVjdChvLnVzZVJlZikobnVsbCksUz1uLmV4cG9ydEJhY2tncm91bmQsRT1uLnZpZXdCYWNrZ3JvdW5kQ29sb3IsTz1uLnNob3VsZEFkZFdhdGVybWFyayxDPXY/T2JqZWN0KG0uZykodCxuKTp0O3JldHVybiBPYmplY3Qoby51c2VFZmZlY3QpKChmdW5jdGlvbigpe2soaCl9KSxbaF0pLE9iamVjdChvLnVzZUVmZmVjdCkoKGZ1bmN0aW9uKCl7dmFyIGU9dy5jdXJyZW50LHQ9T2JqZWN0KHVuLmIpKEMsbix7ZXhwb3J0QmFja2dyb3VuZDpTLHZpZXdCYWNrZ3JvdW5kQ29sb3I6RSxleHBvcnRQYWRkaW5nOmksc2NhbGU6ZyxzaG91bGRBZGRXYXRlcm1hcms6T30pO3JldHVybiBudWxsPT1lfHxlLmFwcGVuZENoaWxkKHQpLGZ1bmN0aW9uKCl7bnVsbD09ZXx8ZS5yZW1vdmVDaGlsZCh0KX19KSxbbixDLFMsaSxFLGcsT10pLGEuYS5jcmVhdGVFbGVtZW50KCJkaXYiLHtjbGFzc05hbWU6IkV4cG9ydERpYWxvZyJ9LGEuYS5jcmVhdGVFbGVtZW50KCJkaXYiLHtjbGFzc05hbWU6IkV4cG9ydERpYWxvZ19fcHJldmlldyIscmVmOnd9KSxhLmEuY3JlYXRlRWxlbWVudChvbix7Z2FwOjIsYWxpZ246ImNlbnRlciJ9LGEuYS5jcmVhdGVFbGVtZW50KCJkaXYiLHtjbGFzc05hbWU6IkV4cG9ydERpYWxvZ19fYWN0aW9ucyJ9LGEuYS5jcmVhdGVFbGVtZW50KHJuLHtnYXA6Mn0sYS5hLmNyZWF0ZUVsZW1lbnQoVSx7dHlwZToiYnV0dG9uIixsYWJlbDoiUE5HIix0aXRsZTpPYmplY3Qocy5lKSgiYnV0dG9ucy5leHBvcnRUb1BuZyIpLCJhcmlhLWxhYmVsIjpPYmplY3Qocy5lKSgiYnV0dG9ucy5leHBvcnRUb1BuZyIpLG9uQ2xpY2s6ZnVuY3Rpb24oKXtyZXR1cm4gYyhDLGcpfX0pLGEuYS5jcmVhdGVFbGVtZW50KFUse3R5cGU6ImJ1dHRvbiIsbGFiZWw6IlNWRyIsdGl0bGU6T2JqZWN0KHMuZSkoImJ1dHRvbnMuZXhwb3J0VG9TdmciKSwiYXJpYS1sYWJlbCI6T2JqZWN0KHMuZSkoImJ1dHRvbnMuZXhwb3J0VG9TdmciKSxvbkNsaWNrOmZ1bmN0aW9uKCl7cmV0dXJuIHUoQyxnKX19KSxVdC5mJiZhLmEuY3JlYXRlRWxlbWVudChVLHt0eXBlOiJidXR0b24iLGljb246Six0aXRsZTpPYmplY3Qocy5lKSgiYnV0dG9ucy5jb3B5UG5nVG9DbGlwYm9hcmQiKSwiYXJpYS1sYWJlbCI6T2JqZWN0KHMuZSkoImJ1dHRvbnMuY29weVBuZ1RvQ2xpcGJvYXJkIiksb25DbGljazpmdW5jdGlvbigpe3JldHVybiBkKEMsZyl9fSksYS5hLmNyZWF0ZUVsZW1lbnQoVSx7dHlwZToiYnV0dG9uIixpY29uOlosdGl0bGU6T2JqZWN0KHMuZSkoImJ1dHRvbnMuZ2V0U2hhcmVhYmxlTGluayIpLCJhcmlhLWxhYmVsIjpPYmplY3Qocy5lKSgiYnV0dG9ucy5nZXRTaGFyZWFibGVMaW5rIiksb25DbGljazpmdW5jdGlvbigpe3JldHVybiBwKEMpfX0pKSxhLmEuY3JlYXRlRWxlbWVudCgiZGl2Iix7Y2xhc3NOYW1lOiJFeHBvcnREaWFsb2dfX25hbWUifSxsLnJlbmRlckFjdGlvbigiY2hhbmdlUHJvamVjdE5hbWUiKSksYS5hLmNyZWF0ZUVsZW1lbnQocm4se2dhcDoyfSxmbi5tYXAoKGZ1bmN0aW9uKGUpe3JldHVybiBhLmEuY3JlYXRlRWxlbWVudChVLHtrZXk6ZSxzaXplOiJzIix0eXBlOiJyYWRpbyIsaWNvbjoieCIuY29uY2F0KGUpLG5hbWU6ImV4cG9ydC1jYW52YXMtc2NhbGUiLCJhcmlhLWxhYmVsIjoiU2NhbGUgIi5jb25jYXQoZSwiIHgiKSxpZDoiZXhwb3J0LWNhbnZhcy1zY2FsZSIsY2hlY2tlZDplPT09ZyxvbkNoYW5nZTpmdW5jdGlvbigpe3JldHVybiBiKGUpfX0pfSkpKSksbC5yZW5kZXJBY3Rpb24oImNoYW5nZUV4cG9ydEJhY2tncm91bmQiKSxoJiZhLmEuY3JlYXRlRWxlbWVudCgiZGl2IixudWxsLGEuYS5jcmVhdGVFbGVtZW50KCJsYWJlbCIsbnVsbCxhLmEuY3JlYXRlRWxlbWVudCgiaW5wdXQiLHt0eXBlOiJjaGVja2JveCIsY2hlY2tlZDp2LG9uQ2hhbmdlOmZ1bmN0aW9uKGUpe3JldHVybiBrKGUuY3VycmVudFRhcmdldC5jaGVja2VkKX19KSwiICIsT2JqZWN0KHMuZSkoImxhYmVscy5vbmx5U2VsZWN0ZWQiKSkpLGwucmVuZGVyQWN0aW9uKCJjaGFuZ2VTaG91bGRBZGRXYXRlcm1hcmsiKSkpfSxibj1mdW5jdGlvbihlKXt2YXIgdD1lLmVsZW1lbnRzLG49ZS5hcHBTdGF0ZSxyPWUuZXhwb3J0UGFkZGluZyxpPXZvaWQgMD09PXI/MTA6cixsPWUuYWN0aW9uTWFuYWdlcixjPWUub25FeHBvcnRUb1BuZyx1PWUub25FeHBvcnRUb1N2ZyxkPWUub25FeHBvcnRUb0NsaXBib2FyZCxwPWUub25FeHBvcnRUb0JhY2tlbmQsaD1PYmplY3Qoby51c2VTdGF0ZSkoITEpLGY9aFswXSxtPWhbMV0sZz1PYmplY3Qoby51c2VSZWYpKG51bGwpLGI9YS5hLnVzZUNhbGxiYWNrKChmdW5jdGlvbigpe3ZhciBlO20oITEpLG51bGw9PT0oZT1nLmN1cnJlbnQpfHx2b2lkIDA9PT1lfHxlLmZvY3VzKCl9KSxbXSk7cmV0dXJuIGEuYS5jcmVhdGVFbGVtZW50KGEuYS5GcmFnbWVudCxudWxsLGEuYS5jcmVhdGVFbGVtZW50KFUse29uQ2xpY2s6ZnVuY3Rpb24oKXtyZXR1cm4gbSghMCl9LGljb246ZWUsdHlwZToiYnV0dG9uIiwiYXJpYS1sYWJlbCI6T2JqZWN0KHMuZSkoImJ1dHRvbnMuZXhwb3J0Iiksc2hvd0FyaWFMYWJlbDphdCgpLHRpdGxlOk9iamVjdChzLmUpKCJidXR0b25zLmV4cG9ydCIpLHJlZjpnfSksZiYmYS5hLmNyZWF0ZUVsZW1lbnQoaG4se21heFdpZHRoOjgwMCxvbkNsb3NlUmVxdWVzdDpiLHRpdGxlOk9iamVjdChzLmUpKCJidXR0b25zLmV4cG9ydCIpfSxhLmEuY3JlYXRlRWxlbWVudChnbix7ZWxlbWVudHM6dCxhcHBTdGF0ZTpuLGV4cG9ydFBhZGRpbmc6aSxhY3Rpb25NYW5hZ2VyOmwsb25FeHBvcnRUb1BuZzpjLG9uRXhwb3J0VG9Tdmc6dSxvbkV4cG9ydFRvQ2xpcGJvYXJkOmQsb25FeHBvcnRUb0JhY2tlbmQ6cCxvbkNsb3NlUmVxdWVzdDpifSkpKX0seW49ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5vbkNoYW5nZSxuPWUubGFuZ3VhZ2VzLHI9dm9pZCAwPT09bj9zLmI6bixvPWUuY3VycmVudExhbmd1YWdlLGk9dm9pZCAwPT09bz9zLmEoKS5sbmc6byxsPWUuZmxvYXRpbmc7cmV0dXJuIGEuYS5jcmVhdGVFbGVtZW50KGEuYS5GcmFnbWVudCxudWxsLGEuYS5jcmVhdGVFbGVtZW50KCJzZWxlY3QiLHtjbGFzc05hbWU6ImRyb3Bkb3duLXNlbGVjdCBkcm9wZG93bi1zZWxlY3RfX2xhbmd1YWdlIi5jb25jYXQobD8iIGRyb3Bkb3duLXNlbGVjdC0tZmxvYXRpbmciOiIiKSxvbkNoYW5nZTpmdW5jdGlvbihlKXt2YXIgbj1lLnRhcmdldDtyZXR1cm4gdChuLnZhbHVlKX0sdmFsdWU6aSwiYXJpYS1sYWJlbCI6cy5lKCJidXR0b25zLnNlbGVjdExhbmd1YWdlIil9LHIubWFwKChmdW5jdGlvbihlKXtyZXR1cm4gYS5hLmNyZWF0ZUVsZW1lbnQoIm9wdGlvbiIse2tleTplLmxuZyx2YWx1ZTplLmxuZ30sZS5sYWJlbCl9KSkpKX0sdm49KG4oODEpLGZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKGUpe3ZhciB0PWUuYXBwU3RhdGUsbj1lLmVsZW1lbnRzLHI9dC5lbGVtZW50VHlwZSxvPXQuaXNSZXNpemluZyxhPXQuaXNSb3RhdGluZyxpPXQubGFzdFBvaW50ZXJEb3duV2l0aCxsPW51bGwhPT10Lm11bHRpRWxlbWVudDtpZigiYXJyb3ciPT09cnx8ImxpbmUiPT09cilyZXR1cm4gbD9PYmplY3Qocy5lKSgiaGludHMubGluZWFyRWxlbWVudE11bHRpIik6T2JqZWN0KHMuZSkoImhpbnRzLmxpbmVhckVsZW1lbnQiKTtpZigiZHJhdyI9PT1yKXJldHVybiBPYmplY3Qocy5lKSgiaGludHMuZnJlZURyYXciKTt2YXIgYz1PYmplY3QobS5nKShuLHQpO2lmKG8mJiJtb3VzZSI9PT1pJiYxPT09Yy5sZW5ndGgpe3ZhciB1PWNbMF07cmV0dXJuIE9iamVjdChULmIpKHUpJiZ1LnBvaW50cy5sZW5ndGg+Mj9udWxsOk9iamVjdChzLmUpKCJoaW50cy5yZXNpemUiKX1yZXR1cm4gYSYmIm1vdXNlIj09PWk/T2JqZWN0KHMuZSkoImhpbnRzLnJvdGF0ZSIpOjE9PT1jLmxlbmd0aCYmT2JqZWN0KFQuYikoY1swXSk/dC5lZGl0aW5nTGluZWFyRWxlbWVudD90LmVkaXRpbmdMaW5lYXJFbGVtZW50LmFjdGl2ZVBvaW50SW5kZXg/T2JqZWN0KHMuZSkoImhpbnRzLmxpbmVFZGl0b3JfcG9pbnRTZWxlY3RlZCIpOk9iamVjdChzLmUpKCJoaW50cy5saW5lRWRpdG9yX25vdGhpbmdTZWxlY3RlZCIpOk9iamVjdChzLmUpKCJoaW50cy5saW5lRWRpdG9yX2luZm8iKTpudWxsfSh7YXBwU3RhdGU6ZS5hcHBTdGF0ZSxlbGVtZW50czplLmVsZW1lbnRzfSk7cmV0dXJuIHQ/KHQ9T2JqZWN0KE8uaykodCksYS5hLmNyZWF0ZUVsZW1lbnQoImRpdiIse2NsYXNzTmFtZToiSGludFZpZXdlciJ9LGEuYS5jcmVhdGVFbGVtZW50KCJzcGFuIixudWxsLHQpKSk6bnVsbH0pLGtuPWZ1bmN0aW9uKGUpe3ZhciB0PWUuYXBwU3RhdGUsbj1lLmVsZW1lbnRzLHI9ZS5yZW5kZXJBY3Rpb24sbz1lLmVsZW1lbnRUeXBlLGk9T2JqZWN0KG0uaCkoT2JqZWN0KGYubikobiksdCksbD1Cb29sZWFuKHQuZWRpdGluZ0VsZW1lbnQpLGM9YXQoKTtyZXR1cm4gYS5hLmNyZWF0ZUVsZW1lbnQoImRpdiIse2NsYXNzTmFtZToicGFuZWxDb2x1bW4ifSxyKCJjaGFuZ2VTdHJva2VDb2xvciIpLChPYmplY3QobS5qKShvKXx8aS5zb21lKChmdW5jdGlvbihlKXtyZXR1cm4gT2JqZWN0KG0uaikoZS50eXBlKX0pKSkmJmEuYS5jcmVhdGVFbGVtZW50KGEuYS5GcmFnbWVudCxudWxsLHIoImNoYW5nZUJhY2tncm91bmRDb2xvciIpLHIoImNoYW5nZUZpbGxTdHlsZSIpKSwoT2JqZWN0KG0uaykobyl8fGkuc29tZSgoZnVuY3Rpb24oZSl7cmV0dXJuIE9iamVjdChtLmspKGUudHlwZSl9KSkpJiZhLmEuY3JlYXRlRWxlbWVudChhLmEuRnJhZ21lbnQsbnVsbCxyKCJjaGFuZ2VTdHJva2VXaWR0aCIpLHIoImNoYW5nZVN0cm9rZVN0eWxlIikscigiY2hhbmdlU2xvcHBpbmVzcyIpKSwoT2JqZWN0KG0ubCkobyl8fGkuc29tZSgoZnVuY3Rpb24oZSl7cmV0dXJuIE9iamVjdChtLmwpKGUudHlwZSl9KSkpJiZhLmEuY3JlYXRlRWxlbWVudChhLmEuRnJhZ21lbnQsbnVsbCxyKCJjaGFuZ2VGb250U2l6ZSIpLHIoImNoYW5nZUZvbnRGYW1pbHkiKSxyKCJjaGFuZ2VUZXh0QWxpZ24iKSkscigiY2hhbmdlT3BhY2l0eSIpLGEuYS5jcmVhdGVFbGVtZW50KCJmaWVsZHNldCIsbnVsbCxhLmEuY3JlYXRlRWxlbWVudCgibGVnZW5kIixudWxsLE9iamVjdChzLmUpKCJsYWJlbHMubGF5ZXJzIikpLGEuYS5jcmVhdGVFbGVtZW50KCJkaXYiLHtjbGFzc05hbWU6ImJ1dHRvbkxpc3QifSxyKCJzZW5kVG9CYWNrIikscigic2VuZEJhY2t3YXJkIikscigiYnJpbmdUb0Zyb250IikscigiYnJpbmdGb3J3YXJkIikpKSwhYyYmIWwmJmkubGVuZ3RoPjAmJmEuYS5jcmVhdGVFbGVtZW50KCJmaWVsZHNldCIsbnVsbCxhLmEuY3JlYXRlRWxlbWVudCgibGVnZW5kIixudWxsLE9iamVjdChzLmUpKCJsYWJlbHMuYWN0aW9ucyIpKSxhLmEuY3JlYXRlRWxlbWVudCgiZGl2Iix7Y2xhc3NOYW1lOiJidXR0b25MaXN0In0scigiZHVwbGljYXRlU2VsZWN0aW9uIikscigiZGVsZXRlU2VsZWN0ZWRFbGVtZW50cyIpLHIoImdyb3VwIikscigidW5ncm91cCIpKSkpfSx3bj1hLmEuY3JlYXRlRWxlbWVudCgic3ZnIix7dmlld0JveDoiMCAwIDUxMiA1MTIifSxhLmEuY3JlYXRlRWxlbWVudCgicGF0aCIse2Q6Ik0yOTYgMzJoMTkyYzEzLjI1NSAwIDI0IDEwLjc0NSAyNCAyNHYxNjBjMCAxMy4yNTUtMTAuNzQ1IDI0LTI0IDI0SDI5NmMtMTMuMjU1IDAtMjQtMTAuNzQ1LTI0LTI0VjU2YzAtMTMuMjU1IDEwLjc0NS0yNCAyNC0yNHptLTgwIDBIMjRDMTAuNzQ1IDMyIDAgNDIuNzQ1IDAgNTZ2MTYwYzAgMTMuMjU1IDEwLjc0NSAyNCAyNCAyNGgxOTJjMTMuMjU1IDAgMjQtMTAuNzQ1IDI0LTI0VjU2YzAtMTMuMjU1LTEwLjc0NS0yNC0yNC0yNHpNMCAyOTZ2MTYwYzAgMTMuMjU1IDEwLjc0NSAyNCAyNCAyNGgxOTJjMTMuMjU1IDAgMjQtMTAuNzQ1IDI0LTI0VjI5NmMwLTEzLjI1NS0xMC43NDUtMjQtMjQtMjRIMjRjLTEzLjI1NSAwLTI0IDEwLjc0NS0yNCAyNHptMjk2IDE4NGgxOTJjMTMuMjU1IDAgMjQtMTAuNzQ1IDI0LTI0VjI5NmMwLTEzLjI1NS0xMC43NDUtMjQtMjQtMjRIMjk2Yy0xMy4yNTUgMC0yNCAxMC43NDUtMjQgMjR2MTYwYzAgMTMuMjU1IDEwLjc0NSAyNCAyNCAyNHoifSkpLFNuPWZ1bmN0aW9uKGUpe3ZhciB0PWUuZWxlbWVudFR5cGUsbj1lLnNldEFwcFN0YXRlLHI9ZS5pc0xpYnJhcnlPcGVuO3JldHVybiBhLmEuY3JlYXRlRWxlbWVudChhLmEuRnJhZ21lbnQsbnVsbCxqLm1hcCgoZnVuY3Rpb24oZSxyKXt2YXIgbz1lLnZhbHVlLGk9ZS5pY29uLGw9ZS5rZXksYz1PYmplY3Qocy5lKSgidG9vbEJhci4iLmNvbmNhdChvKSksdT0ic3RyaW5nIj09dHlwZW9mIGw/bDpsWzBdLGQ9L1thLXpdLy50ZXN0KHUpP3U6IlNoaWZ0KyIuY29uY2F0KHUpLHA9IiIuY29uY2F0KE9iamVjdChPLmMpKGQpLCIgIikuY29uY2F0KE9iamVjdChzLmUpKCJzaG9ydGN1dHNEaWFsb2cub3IiKSwiICIpLmNvbmNhdChyKzEpO3JldHVybiBhLmEuY3JlYXRlRWxlbWVudChVLHtjbGFzc05hbWU6IlNoYXBlIixrZXk6byx0eXBlOiJyYWRpbyIsaWNvbjppLGNoZWNrZWQ6dD09PW8sbmFtZToiZWRpdG9yLWN1cnJlbnQtc2hhcGUiLHRpdGxlOiIiLmNvbmNhdChPYmplY3QoTy5jKShjKSwiIOKAlCAiKS5jb25jYXQocCksa2V5QmluZGluZ0xhYmVsOiIiLmNvbmNhdChyKzEpLCJhcmlhLWxhYmVsIjpPYmplY3QoTy5jKShjKSwiYXJpYS1rZXlzaG9ydGN1dHMiOiIiLmNvbmNhdChsLCIgIikuY29uY2F0KHIrMSksImRhdGEtdGVzdGlkIjpvLG9uQ2hhbmdlOmZ1bmN0aW9uKCl7bih7ZWxlbWVudFR5cGU6byxtdWx0aUVsZW1lbnQ6bnVsbCxzZWxlY3RlZEVsZW1lbnRJZHM6e319KSxPYmplY3QoTy53KShvKSxuKHt9KX19KX0pKSxhLmEuY3JlYXRlRWxlbWVudChVLHtjbGFzc05hbWU6IlNoYXBlIix0eXBlOiJidXR0b24iLGljb246d24sbmFtZToiZWRpdG9yLWxpYnJhcnkiLGtleUJpbmRpbmdMYWJlbDoiOSIsImFyaWEta2V5c2hvcnRjdXRzIjoiOSIsdGl0bGU6IiIuY29uY2F0KE9iamVjdChPLmMpKE9iamVjdChzLmUpKCJ0b29sQmFyLmxpYnJhcnkiKSksIiDigJQgOSIpLCJhcmlhLWxhYmVsIjpPYmplY3QoTy5jKShPYmplY3Qocy5lKSgidG9vbEJhci5saWJyYXJ5IikpLG9uQ2xpY2s6ZnVuY3Rpb24oKXtuKHtpc0xpYnJhcnlPcGVuOiFyfSl9fSkpfSxFbj1mdW5jdGlvbihlKXt2YXIgdD1lLnJlbmRlckFjdGlvbixuPWUuem9vbTtyZXR1cm4gYS5hLmNyZWF0ZUVsZW1lbnQob24se2dhcDoxfSxhLmEuY3JlYXRlRWxlbWVudChybix7Z2FwOjEsYWxpZ246ImNlbnRlciJ9LHQoInpvb21JbiIpLHQoInpvb21PdXQiKSx0KCJyZXNldFpvb20iKSxhLmEuY3JlYXRlRWxlbWVudCgiZGl2Iix7c3R5bGU6e21hcmdpbklubGluZVN0YXJ0OjR9fSwoMTAwKm4pLnRvRml4ZWQoMCksIiUiKSkpfTtmdW5jdGlvbiBPbigpe3JldHVybihPbj1PYmplY3QuYXNzaWdufHxmdW5jdGlvbihlKXtmb3IodmFyIHQ9MTt0PGFyZ3VtZW50cy5sZW5ndGg7dCsrKXt2YXIgbj1hcmd1bWVudHNbdF07Zm9yKHZhciByIGluIG4pT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG4scikmJihlW3JdPW5bcl0pfXJldHVybiBlfSkuYXBwbHkodGhpcyxhcmd1bWVudHMpfWZ1bmN0aW9uIENuKGUsdCl7aWYobnVsbD09ZSlyZXR1cm57fTt2YXIgbixyLG89ZnVuY3Rpb24oZSx0KXtpZihudWxsPT1lKXJldHVybnt9O3ZhciBuLHIsbz17fSxhPU9iamVjdC5rZXlzKGUpO2ZvcihyPTA7cjxhLmxlbmd0aDtyKyspbj1hW3JdLHQuaW5kZXhPZihuKT49MHx8KG9bbl09ZVtuXSk7cmV0dXJuIG99KGUsdCk7aWYoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyl7dmFyIGE9T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhlKTtmb3Iocj0wO3I8YS5sZW5ndGg7cisrKW49YVtyXSx0LmluZGV4T2Yobik+PTB8fE9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChlLG4pJiYob1tuXT1lW25dKX1yZXR1cm4gb312YXIgeG49ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5oZWFkaW5nLG49ZS5jaGlsZHJlbixyPUNuKGUsWyJoZWFkaW5nIiwiY2hpbGRyZW4iXSksbz1hLmEuY3JlYXRlRWxlbWVudCgiaDIiLHtjbGFzc05hbWU6InZpc3VhbGx5LWhpZGRlbiIsaWQ6IiIuY29uY2F0KHQsIi10aXRsZSIpfSxPYmplY3Qocy5lKSgiaGVhZGluZ3MuIi5jb25jYXQodCkpKTtyZXR1cm4gYS5hLmNyZWF0ZUVsZW1lbnQoInNlY3Rpb24iLE9uKHt9LHIseyJhcmlhLWxhYmVsbGVkYnkiOiIiLmNvbmNhdCh0LCItdGl0bGUiKX0pLCJmdW5jdGlvbiI9PXR5cGVvZiBuP24obyk6YS5hLmNyZWF0ZUVsZW1lbnQoYS5hLkZyYWdtZW50LG51bGwsbyxuKSl9LGpuPShuKDgyKSxmdW5jdGlvbihlKXt2YXIgdD1lLmFjdGl2ZVJvb21MaW5rLG49ZS51c2VybmFtZSxyPWUub25Vc2VybmFtZUNoYW5nZSxpPWUub25Sb29tQ3JlYXRlLGw9ZS5vblJvb21EZXN0cm95LGM9ZS5vblByZXNzaW5nRW50ZXIsdT1PYmplY3Qoby51c2VSZWYpKG51bGwpO3JldHVybiBhLmEuY3JlYXRlRWxlbWVudCgiZGl2Iix7Y2xhc3NOYW1lOiJSb29tRGlhbG9nLW1vZGFsIn0sIXQmJmEuYS5jcmVhdGVFbGVtZW50KGEuYS5GcmFnbWVudCxudWxsLGEuYS5jcmVhdGVFbGVtZW50KCJwIixudWxsLE9iamVjdChzLmUpKCJyb29tRGlhbG9nLmRlc2NfaW50cm8iKSksYS5hLmNyZWF0ZUVsZW1lbnQoInAiLG51bGwsIvCflJIgIi5jb25jYXQoT2JqZWN0KHMuZSkoInJvb21EaWFsb2cuZGVzY19wcml2YWN5IikpKSxhLmEuY3JlYXRlRWxlbWVudCgiZGl2Iix7Y2xhc3NOYW1lOiJSb29tRGlhbG9nLXNlc3Npb25TdGFydEJ1dHRvbkNvbnRhaW5lciJ9LGEuYS5jcmVhdGVFbGVtZW50KFUse2NsYXNzTmFtZToiUm9vbURpYWxvZy1zdGFydFNlc3Npb24iLHR5cGU6ImJ1dHRvbiIsaWNvbjpoZSx0aXRsZTpPYmplY3Qocy5lKSgicm9vbURpYWxvZy5idXR0b25fc3RhcnRTZXNzaW9uIiksImFyaWEtbGFiZWwiOk9iamVjdChzLmUpKCJyb29tRGlhbG9nLmJ1dHRvbl9zdGFydFNlc3Npb24iKSxzaG93QXJpYUxhYmVsOiEwLG9uQ2xpY2s6aX0pKSksdCYmYS5hLmNyZWF0ZUVsZW1lbnQoYS5hLkZyYWdtZW50LG51bGwsYS5hLmNyZWF0ZUVsZW1lbnQoInAiLG51bGwsT2JqZWN0KHMuZSkoInJvb21EaWFsb2cuZGVzY19pblByb2dyZXNzSW50cm8iKSksYS5hLmNyZWF0ZUVsZW1lbnQoInAiLG51bGwsT2JqZWN0KHMuZSkoInJvb21EaWFsb2cuZGVzY19zaGFyZUxpbmsiKSksYS5hLmNyZWF0ZUVsZW1lbnQoImRpdiIse2NsYXNzTmFtZToiUm9vbURpYWxvZy1saW5rQ29udGFpbmVyIn0sYS5hLmNyZWF0ZUVsZW1lbnQoVSx7dHlwZToiYnV0dG9uIixpY29uOkosdGl0bGU6T2JqZWN0KHMuZSkoImxhYmVscy5jb3B5IiksImFyaWEtbGFiZWwiOk9iamVjdChzLmUpKCJsYWJlbHMuY29weSIpLG9uQ2xpY2s6ZnVuY3Rpb24oKXtPYmplY3QoVXQuYykodCksdS5jdXJyZW50JiZ1LmN1cnJlbnQuc2VsZWN0KCl9fSksYS5hLmNyZWF0ZUVsZW1lbnQoImlucHV0Iix7dmFsdWU6dCxyZWFkT25seTohMCxjbGFzc05hbWU6IlJvb21EaWFsb2ctbGluayIscmVmOnUsb25Qb2ludGVyRG93bjpmdW5jdGlvbihlKXtlLnRhcmdldCE9PWRvY3VtZW50LmFjdGl2ZUVsZW1lbnQmJihlLnByZXZlbnREZWZhdWx0KCksZS50YXJnZXQuc2VsZWN0KCkpfX0pKSxhLmEuY3JlYXRlRWxlbWVudCgiZGl2Iix7Y2xhc3NOYW1lOiJSb29tRGlhbG9nLXVzZXJuYW1lQ29udGFpbmVyIn0sYS5hLmNyZWF0ZUVsZW1lbnQoImxhYmVsIix7Y2xhc3NOYW1lOiJSb29tRGlhbG9nLXVzZXJuYW1lTGFiZWwiLGh0bWxGb3I6InVzZXJuYW1lIn0sT2JqZWN0KHMuZSkoImxhYmVscy55b3VyTmFtZSIpKSxhLmEuY3JlYXRlRWxlbWVudCgiaW5wdXQiLHtpZDoidXNlcm5hbWUiLHZhbHVlOm58fCIiLGNsYXNzTmFtZToiUm9vbURpYWxvZy11c2VybmFtZSBUZXh0SW5wdXQiLG9uQ2hhbmdlOmZ1bmN0aW9uKGUpe3JldHVybiByKGUudGFyZ2V0LnZhbHVlKX0sb25LZXlQcmVzczpmdW5jdGlvbihlKXtyZXR1cm4iRW50ZXIiPT09ZS5rZXkmJmMoKX19KSksYS5hLmNyZWF0ZUVsZW1lbnQoInAiLG51bGwsIvCflJIgIi5jb25jYXQoT2JqZWN0KHMuZSkoInJvb21EaWFsb2cuZGVzY19wcml2YWN5IikpKSxhLmEuY3JlYXRlRWxlbWVudCgicCIsbnVsbCxhLmEuY3JlYXRlRWxlbWVudCgic3BhbiIse3JvbGU6ImltZyIsImFyaWEtaGlkZGVuIjoidHJ1ZSJ9LCLimqDvuI8iKSwiICIsT2JqZWN0KHMuZSkoInJvb21EaWFsb2cuZGVzY19wZXJzaXN0ZW5jZVdhcm5pbmciKSksYS5hLmNyZWF0ZUVsZW1lbnQoInAiLG51bGwsT2JqZWN0KHMuZSkoInJvb21EaWFsb2cuZGVzY19leGl0U2Vzc2lvbiIpKSxhLmEuY3JlYXRlRWxlbWVudCgiZGl2Iix7Y2xhc3NOYW1lOiJSb29tRGlhbG9nLXNlc3Npb25TdGFydEJ1dHRvbkNvbnRhaW5lciJ9LGEuYS5jcmVhdGVFbGVtZW50KFUse2NsYXNzTmFtZToiUm9vbURpYWxvZy1zdG9wU2Vzc2lvbiIsdHlwZToiYnV0dG9uIixpY29uOmZlLHRpdGxlOk9iamVjdChzLmUpKCJyb29tRGlhbG9nLmJ1dHRvbl9zdG9wU2Vzc2lvbiIpLCJhcmlhLWxhYmVsIjpPYmplY3Qocy5lKSgicm9vbURpYWxvZy5idXR0b25fc3RvcFNlc3Npb24iKSxzaG93QXJpYUxhYmVsOiEwLG9uQ2xpY2s6bH0pKSkpfSksVG49ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5pc0NvbGxhYm9yYXRpbmcsbj1lLmNvbGxhYm9yYXRvckNvdW50LHI9ZS51c2VybmFtZSxpPWUub25Vc2VybmFtZUNoYW5nZSxsPWUub25Sb29tQ3JlYXRlLGM9ZS5vblJvb21EZXN0cm95LHU9T2JqZWN0KG8udXNlU3RhdGUpKCExKSxkPXVbMF0scD11WzFdLGg9T2JqZWN0KG8udXNlU3RhdGUpKCIiKSxmPWhbMF0sbT1oWzFdLGc9T2JqZWN0KG8udXNlUmVmKShudWxsKSxiPWEuYS51c2VDYWxsYmFjaygoZnVuY3Rpb24oKXt2YXIgZTtwKCExKSxudWxsPT09KGU9Zy5jdXJyZW50KXx8dm9pZCAwPT09ZXx8ZS5mb2N1cygpfSksW10pO3JldHVybiBPYmplY3Qoby51c2VFZmZlY3QpKChmdW5jdGlvbigpe20odD93aW5kb3cubG9jYXRpb24uaHJlZjoiIil9KSxbdF0pLGEuYS5jcmVhdGVFbGVtZW50KGEuYS5GcmFnbWVudCxudWxsLGEuYS5jcmVhdGVFbGVtZW50KFUse2NsYXNzTmFtZToiUm9vbURpYWxvZy1tb2RhbEJ1dHRvbiAiLmNvbmNhdCh0PyJpcy1jb2xsYWJvcmF0aW5nIjoiIiksb25DbGljazpmdW5jdGlvbigpe3JldHVybiBwKCEwKX0saWNvbjpwZSx0eXBlOiJidXR0b24iLHRpdGxlOk9iamVjdChzLmUpKCJidXR0b25zLnJvb21EaWFsb2ciKSwiYXJpYS1sYWJlbCI6T2JqZWN0KHMuZSkoImJ1dHRvbnMucm9vbURpYWxvZyIpLHNob3dBcmlhTGFiZWw6YXQoKSxyZWY6Z30sbj4wJiZhLmEuY3JlYXRlRWxlbWVudCgiZGl2Iix7Y2xhc3NOYW1lOiJSb29tRGlhbG9nLW1vZGFsQnV0dG9uLWNvbGxhYm9yYXRvcnMifSxuKSksZCYmYS5hLmNyZWF0ZUVsZW1lbnQoaG4se21heFdpZHRoOjgwMCxvbkNsb3NlUmVxdWVzdDpiLHRpdGxlOk9iamVjdChzLmUpKCJsYWJlbHMuY3JlYXRlUm9vbSIpfSxhLmEuY3JlYXRlRWxlbWVudChqbix7YWN0aXZlUm9vbUxpbms6Zix1c2VybmFtZTpyLG9uVXNlcm5hbWVDaGFuZ2U6aSxvblJvb21DcmVhdGU6bCxvblJvb21EZXN0cm95OmMsb25QcmVzc2luZ0VudGVyOmJ9KSkpfSxQbj1uKDE5KSxBbj1mdW5jdGlvbihlLHQpe3ZhciBuLHIsbyxhLGk9e2xhYmVsOjAsc2VudDpmdW5jdGlvbigpe2lmKDEmb1swXSl0aHJvdyBvWzFdO3JldHVybiBvWzFdfSx0cnlzOltdLG9wczpbXX07cmV0dXJuIGE9e25leHQ6cygwKSx0aHJvdzpzKDEpLHJldHVybjpzKDIpfSwiZnVuY3Rpb24iPT10eXBlb2YgU3ltYm9sJiYoYVtTeW1ib2wuaXRlcmF0b3JdPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9KSxhO2Z1bmN0aW9uIHMoYSl7cmV0dXJuIGZ1bmN0aW9uKHMpe3JldHVybiBmdW5jdGlvbihhKXtpZihuKXRocm93IG5ldyBUeXBlRXJyb3IoIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy4iKTtmb3IoO2k7KXRyeXtpZihuPTEsciYmKG89MiZhWzBdP3IucmV0dXJuOmFbMF0/ci50aHJvd3x8KChvPXIucmV0dXJuKSYmby5jYWxsKHIpLDApOnIubmV4dCkmJiEobz1vLmNhbGwocixhWzFdKSkuZG9uZSlyZXR1cm4gbztzd2l0Y2gocj0wLG8mJihhPVsyJmFbMF0sby52YWx1ZV0pLGFbMF0pe2Nhc2UgMDpjYXNlIDE6bz1hO2JyZWFrO2Nhc2UgNDpyZXR1cm4gaS5sYWJlbCsrLHt2YWx1ZTphWzFdLGRvbmU6ITF9O2Nhc2UgNTppLmxhYmVsKysscj1hWzFdLGE9WzBdO2NvbnRpbnVlO2Nhc2UgNzphPWkub3BzLnBvcCgpLGkudHJ5cy5wb3AoKTtjb250aW51ZTtkZWZhdWx0OmlmKCEobz1pLnRyeXMsKG89by5sZW5ndGg+MCYmb1tvLmxlbmd0aC0xXSl8fDYhPT1hWzBdJiYyIT09YVswXSkpe2k9MDtjb250aW51ZX1pZigzPT09YVswXSYmKCFvfHxhWzFdPm9bMF0mJmFbMV08b1szXSkpe2kubGFiZWw9YVsxXTticmVha31pZig2PT09YVswXSYmaS5sYWJlbDxvWzFdKXtpLmxhYmVsPW9bMV0sbz1hO2JyZWFrfWlmKG8mJmkubGFiZWw8b1syXSl7aS5sYWJlbD1vWzJdLGkub3BzLnB1c2goYSk7YnJlYWt9b1syXSYmaS5vcHMucG9wKCksaS50cnlzLnBvcCgpO2NvbnRpbnVlfWE9dC5jYWxsKGUsaSl9Y2F0Y2goZSl7YT1bNixlXSxyPTB9ZmluYWxseXtuPW89MH1pZig1JmFbMF0pdGhyb3cgYVsxXTtyZXR1cm57dmFsdWU6YVswXT9hWzFdOnZvaWQgMCxkb25lOiEwfX0oW2Esc10pfX19O2Z1bmN0aW9uIE1uKGUsdCl7dmFyIG49T2JqZWN0LmtleXMoZSk7aWYoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyl7dmFyIHI9T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhlKTt0JiYocj1yLmZpbHRlcigoZnVuY3Rpb24odCl7cmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoZSx0KS5lbnVtZXJhYmxlfSkpKSxuLnB1c2guYXBwbHkobixyKX1yZXR1cm4gbn1mdW5jdGlvbiBfbihlLHQsbil7cmV0dXJuIHQgaW4gZT9PYmplY3QuZGVmaW5lUHJvcGVydHkoZSx0LHt2YWx1ZTpuLGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwLHdyaXRhYmxlOiEwfSk6ZVt0XT1uLGV9ZnVuY3Rpb24gem4oZSx0LG4scixvLGEsaSl7dHJ5e3ZhciBzPWVbYV0oaSksbD1zLnZhbHVlfWNhdGNoKGUpe3JldHVybiB2b2lkIG4oZSl9cy5kb25lP3QobCk6UHJvbWlzZS5yZXNvbHZlKGwpLnRoZW4ocixvKX12YXIgTG49ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5hcHBTdGF0ZSxuPWUuZWxlbWVudHMscj1lLmxpYnJhcnlNZW51LG89ZS5hY3Rpb25NYW5hZ2VyLGw9ZS5leHBvcnRCdXR0b24sYz1lLnNldEFwcFN0YXRlLHU9ZS5vblJvb21DcmVhdGUsZD1lLm9uVXNlcm5hbWVDaGFuZ2UscD1lLm9uUm9vbURlc3Ryb3ksaD1lLm9uTG9ja1RvZ2dsZSxnPWUuY2FudmFzO3JldHVybiBhLmEuY3JlYXRlRWxlbWVudChhLmEuRnJhZ21lbnQsbnVsbCx0LmlzTG9hZGluZyYmYS5hLmNyZWF0ZUVsZW1lbnQoaSxudWxsKSxhLmEuY3JlYXRlRWxlbWVudChhbix7c2lkZToidG9wIn0sYS5hLmNyZWF0ZUVsZW1lbnQoeG4se2hlYWRpbmc6InNoYXBlcyJ9LChmdW5jdGlvbihlKXtyZXR1cm4gYS5hLmNyZWF0ZUVsZW1lbnQob24se2dhcDo0LGFsaWduOiJjZW50ZXIifSxhLmEuY3JlYXRlRWxlbWVudChybix7Z2FwOjF9LGEuYS5jcmVhdGVFbGVtZW50KG5uLHtwYWRkaW5nOjF9LGUsYS5hLmNyZWF0ZUVsZW1lbnQocm4se2dhcDoxfSxhLmEuY3JlYXRlRWxlbWVudChTbix7ZWxlbWVudFR5cGU6dC5lbGVtZW50VHlwZSxzZXRBcHBTdGF0ZTpjLGlzTGlicmFyeU9wZW46dC5pc0xpYnJhcnlPcGVufSkpKSxhLmEuY3JlYXRlRWxlbWVudChjbix7Y2hlY2tlZDp0LmVsZW1lbnRMb2NrZWQsb25DaGFuZ2U6aCx0aXRsZTpPYmplY3Qocy5lKSgidG9vbEJhci5sb2NrIil9KSkscil9KSksYS5hLmNyZWF0ZUVsZW1lbnQodm4se2FwcFN0YXRlOnQsZWxlbWVudHM6bn0pKSxhLmEuY3JlYXRlRWxlbWVudCgiZGl2Iix7Y2xhc3NOYW1lOiJBcHAtYm90dG9tLWJhciIsc3R5bGU6e21hcmdpbkJvdHRvbTpQbi5jKzIqUG4uYixtYXJnaW5MZWZ0OlBuLmMrMipQbi5iLG1hcmdpblJpZ2h0OlBuLmMrMipQbi5ifX0sYS5hLmNyZWF0ZUVsZW1lbnQobm4se3BhZGRpbmc6M30sImNhbnZhcyI9PT10Lm9wZW5NZW51P2EuYS5jcmVhdGVFbGVtZW50KHhuLHtjbGFzc05hbWU6IkFwcC1tb2JpbGUtbWVudSIsaGVhZGluZzoiY2FudmFzQWN0aW9ucyJ9LGEuYS5jcmVhdGVFbGVtZW50KCJkaXYiLHtjbGFzc05hbWU6InBhbmVsQ29sdW1uIn0sYS5hLmNyZWF0ZUVsZW1lbnQob24se2dhcDo0fSxvLnJlbmRlckFjdGlvbigibG9hZFNjZW5lIiksby5yZW5kZXJBY3Rpb24oInNhdmVTY2VuZSIpLG8ucmVuZGVyQWN0aW9uKCJzYXZlQXNTY2VuZSIpLGwsby5yZW5kZXJBY3Rpb24oImNsZWFyQ2FudmFzIiksYS5hLmNyZWF0ZUVsZW1lbnQoVG4se2lzQ29sbGFib3JhdGluZzp0LmlzQ29sbGFib3JhdGluZyxjb2xsYWJvcmF0b3JDb3VudDp0LmNvbGxhYm9yYXRvcnMuc2l6ZSx1c2VybmFtZTp0LnVzZXJuYW1lLG9uVXNlcm5hbWVDaGFuZ2U6ZCxvblJvb21DcmVhdGU6dSxvblJvb21EZXN0cm95OnB9KSxvLnJlbmRlckFjdGlvbigiY2hhbmdlVmlld0JhY2tncm91bmRDb2xvciIpLGEuYS5jcmVhdGVFbGVtZW50KCJmaWVsZHNldCIsbnVsbCxhLmEuY3JlYXRlRWxlbWVudCgibGVnZW5kIixudWxsLE9iamVjdChzLmUpKCJsYWJlbHMubGFuZ3VhZ2UiKSksYS5hLmNyZWF0ZUVsZW1lbnQoeW4se29uQ2hhbmdlOmZ1bmN0aW9uKCl7dmFyIGUsdD0oZT1mdW5jdGlvbihlKXtyZXR1cm4gQW4odGhpcywoZnVuY3Rpb24odCl7c3dpdGNoKHQubGFiZWwpe2Nhc2UgMDpyZXR1cm5bNCxPYmplY3Qocy5jKShlKV07Y2FzZSAxOnJldHVybiB0LnNlbnQoKSxjKHt9KSxbMl19fSkpfSxmdW5jdGlvbigpe3ZhciB0PXRoaXMsbj1hcmd1bWVudHM7cmV0dXJuIG5ldyBQcm9taXNlKChmdW5jdGlvbihyLG8pe3ZhciBhPWUuYXBwbHkodCxuKTtmdW5jdGlvbiBpKGUpe3puKGEscixvLGkscywibmV4dCIsZSl9ZnVuY3Rpb24gcyhlKXt6bihhLHIsbyxpLHMsInRocm93IixlKX1pKHZvaWQgMCl9KSl9KTtyZXR1cm4gZnVuY3Rpb24oZSl7cmV0dXJuIHQuYXBwbHkodGhpcyxhcmd1bWVudHMpfX0oKX0pKSxhLmEuY3JlYXRlRWxlbWVudCgiZmllbGRzZXQiLG51bGwsYS5hLmNyZWF0ZUVsZW1lbnQoImxlZ2VuZCIsbnVsbCxPYmplY3Qocy5lKSgibGFiZWxzLmNvbGxhYm9yYXRvcnMiKSksYS5hLmNyZWF0ZUVsZW1lbnQoc24se21vYmlsZTohMH0sQXJyYXkuZnJvbSh0LmNvbGxhYm9yYXRvcnMpLmZpbHRlcigoZnVuY3Rpb24oZSl7ZVswXTt2YXIgdD1lWzFdO3JldHVybiAwIT09T2JqZWN0LmtleXModCkubGVuZ3RofSkpLm1hcCgoZnVuY3Rpb24oZSl7dmFyIHQ9ZVswXTtlWzFdO3JldHVybiBhLmEuY3JlYXRlRWxlbWVudChhLmEuRnJhZ21lbnQse2tleTp0fSxvLnJlbmRlckFjdGlvbigiZ29Ub0NvbGxhYm9yYXRvciIsdCkpfSkpKSkpKSk6InNoYXBlIj09PXQub3Blbk1lbnUmJk9iamVjdChmLkcpKHQsbik/YS5hLmNyZWF0ZUVsZW1lbnQoeG4se2NsYXNzTmFtZToiQXBwLW1vYmlsZS1tZW51IixoZWFkaW5nOiJzZWxlY3RlZFNoYXBlQWN0aW9ucyJ9LGEuYS5jcmVhdGVFbGVtZW50KGtuLHthcHBTdGF0ZTp0LGVsZW1lbnRzOm4scmVuZGVyQWN0aW9uOm8ucmVuZGVyQWN0aW9uLGVsZW1lbnRUeXBlOnQuZWxlbWVudFR5cGV9KSk6bnVsbCxhLmEuY3JlYXRlRWxlbWVudCgiZm9vdGVyIix7Y2xhc3NOYW1lOiJBcHAtdG9vbGJhciJ9LGEuYS5jcmVhdGVFbGVtZW50KCJkaXYiLHtjbGFzc05hbWU6IkFwcC10b29sYmFyLWNvbnRlbnQifSxvLnJlbmRlckFjdGlvbigidG9nZ2xlQ2FudmFzTWVudSIpLG8ucmVuZGVyQWN0aW9uKCJ0b2dnbGVFZGl0TWVudSIpLG8ucmVuZGVyQWN0aW9uKCJ1bmRvIiksby5yZW5kZXJBY3Rpb24oInJlZG8iKSxvLnJlbmRlckFjdGlvbih0Lm11bHRpRWxlbWVudD8iZmluYWxpemUiOiJkdXBsaWNhdGVTZWxlY3Rpb24iKSxvLnJlbmRlckFjdGlvbigiZGVsZXRlU2VsZWN0ZWRFbGVtZW50cyIpKSx0LnNjcm9sbGVkT3V0c2lkZSYmYS5hLmNyZWF0ZUVsZW1lbnQoImJ1dHRvbiIse2NsYXNzTmFtZToic2Nyb2xsLWJhY2stdG8tY29udGVudCIsb25DbGljazpmdW5jdGlvbigpe2MoZnVuY3Rpb24oZSl7Zm9yKHZhciB0PTE7dDxhcmd1bWVudHMubGVuZ3RoO3QrKyl7dmFyIG49bnVsbCE9YXJndW1lbnRzW3RdP2FyZ3VtZW50c1t0XTp7fTt0JTI/TW4oT2JqZWN0KG4pLCEwKS5mb3JFYWNoKChmdW5jdGlvbih0KXtfbihlLHQsblt0XSl9KSk6T2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnM/T2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZSxPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhuKSk6TW4oT2JqZWN0KG4pKS5mb3JFYWNoKChmdW5jdGlvbih0KXtPYmplY3QuZGVmaW5lUHJvcGVydHkoZSx0LE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iobix0KSl9KSl9cmV0dXJuIGV9KHt9LE9iamVjdChtLmEpKG4sdCxnKSkpfX0sT2JqZWN0KHMuZSkoImJ1dHRvbnMuc2Nyb2xsQmFja1RvQ29udGVudCIpKSkpKSl9LEluPWZ1bmN0aW9uKGUpe3ZhciB0PWUubWVzc2FnZSxuPWUub25DbG9zZSxyPU9iamVjdChvLnVzZVN0YXRlKSghIXQpLGk9clswXSxsPXJbMV0sYz1hLmEudXNlQ2FsbGJhY2soKGZ1bmN0aW9uKCl7bCghMSksbiYmbigpfSksW25dKTtyZXR1cm4gYS5hLmNyZWF0ZUVsZW1lbnQoYS5hLkZyYWdtZW50LG51bGwsaSYmYS5hLmNyZWF0ZUVsZW1lbnQoaG4se21heFdpZHRoOjUwMCxvbkNsb3NlUmVxdWVzdDpjLHRpdGxlOk9iamVjdChzLmUpKCJlcnJvckRpYWxvZy50aXRsZSIpfSxhLmEuY3JlYXRlRWxlbWVudCgiZGl2IixudWxsLHQpKSl9O2Z1bmN0aW9uIERuKCl7cmV0dXJuKERuPU9iamVjdC5hc3NpZ258fGZ1bmN0aW9uKGUpe2Zvcih2YXIgdD0xO3Q8YXJndW1lbnRzLmxlbmd0aDt0Kyspe3ZhciBuPWFyZ3VtZW50c1t0XTtmb3IodmFyIHIgaW4gbilPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobixyKSYmKGVbcl09bltyXSl9cmV0dXJuIGV9KS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9dmFyIE5uPWZ1bmN0aW9uKGUpe3JldHVybiBhLmEuY3JlYXRlRWxlbWVudCgiZGl2Iix7c3R5bGU6e2Rpc3BsYXk6ImZsZXgiLGZsZXhEaXJlY3Rpb246InJvdyIsZmxleFdyYXA6IndyYXAiLGp1c3RpZnlDb250ZW50OiJzcGFjZS1iZXR3ZWVuIn19LGUuY2hpbGRyZW4pfSxGbj1mdW5jdGlvbihlKXtyZXR1cm4gYS5hLmNyZWF0ZUVsZW1lbnQoImRpdiIse3N0eWxlOnt3aWR0aDoiNDklIn19LGUuY2hpbGRyZW4pfSxSbj1mdW5jdGlvbihlKXtyZXR1cm4gYS5hLmNyZWF0ZUVsZW1lbnQoImRpdiIse3N0eWxlOntib3JkZXI6IjFweCBzb2xpZCAiLmNvbmNhdCh4LmdyYXlbNF0pLG1hcmdpbkJvdHRvbToiMTZweCJ9fSxhLmEuY3JlYXRlRWxlbWVudCgiaDMiLHtzdHlsZTp7bWFyZ2luOiIwIixwYWRkaW5nOiI0cHgiLGJhY2tncm91bmRDb2xvcjp4LmdyYXlbMl0sdGV4dEFsaWduOiJjZW50ZXIifX0sZS5jYXB0aW9uKSxlLmNoaWxkcmVuKX0sQm49ZnVuY3Rpb24oZSl7dmFyIHQ9InJ0bCI9PT1kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKCJkaXIiKTtyZXR1cm4gYS5hLmNyZWF0ZUVsZW1lbnQoImRpdiIse3N0eWxlOntib3JkZXJUb3A6IjFweCBzb2xpZCAiLmNvbmNhdCh4LmdyYXlbNF0pfX0sYS5hLmNyZWF0ZUVsZW1lbnQoImRpdiIse3N0eWxlOntkaXNwbGF5OiJmbGV4IixtYXJnaW46IjAiLHBhZGRpbmc6IjRweCA4cHgiLGFsaWduSXRlbXM6ImNlbnRlciJ9fSxhLmEuY3JlYXRlRWxlbWVudCgiZGl2Iix7c3R5bGU6e2xpbmVIZWlnaHQ6MS40fX0sZS5sYWJlbCksYS5hLmNyZWF0ZUVsZW1lbnQoImRpdiIse3N0eWxlOntkaXNwbGF5OiJmbGV4IixmbGV4OiIwIDAgYXV0byIsanVzdGlmeUNvbnRlbnQ6ImZsZXgtZW5kIixtYXJnaW5MZWZ0OnQ/IjBlbSI6ImF1dG8iLG1hcmdpblJpZ2h0OnQ/ImF1dG8iOiIwZW0iLG1pbldpZHRoOiIzMCUifX0sZS5zaG9ydGN1dHMubWFwKChmdW5jdGlvbih0LG4pe3JldHVybiBhLmEuY3JlYXRlRWxlbWVudChhLmEuRnJhZ21lbnQse2tleTpufSxhLmEuY3JlYXRlRWxlbWVudChIbixudWxsLHQpLGUuaXNPciYmbiE9PWUuc2hvcnRjdXRzLmxlbmd0aC0xJiZPYmplY3Qocy5lKSgic2hvcnRjdXRzRGlhbG9nLm9yIikpfSkpKSkpfTtCbi5kZWZhdWx0UHJvcHM9e2lzT3I6ITB9O3ZhciBIbj1mdW5jdGlvbihlKXtyZXR1cm4gYS5hLmNyZWF0ZUVsZW1lbnQoInNwYW4iLERuKHtzdHlsZTp7d29yZEJyZWFrOiJrZWVwLWFsbCIsYm9yZGVyOiIxcHggc29saWQgIi5jb25jYXQoeC5ncmF5WzRdKSxwYWRkaW5nOiIycHggOHB4IixtYXJnaW46ImF1dG8gNHB4IixiYWNrZ3JvdW5kQ29sb3I6eC5ncmF5WzJdLGJvcmRlclJhZGl1czoiMnB4Iixmb250U2l6ZToiMC44ZW0iLG1pbkhlaWdodDoiMjZweCIsYm94U2l6aW5nOiJib3JkZXItYm94IixkaXNwbGF5OiJmbGV4IixhbGlnbkl0ZW1zOiJjZW50ZXIifX0sZSkpfSxHbj1mdW5jdGlvbigpe3JldHVybiBhLmEuY3JlYXRlRWxlbWVudCgiZGl2Iix7c3R5bGU6e2Rpc3BsYXk6ImZsZXgiLGZsZXhEaXJlY3Rpb246InJvdyIsanVzdGlmeUNvbnRlbnQ6InNwYWNlLWV2ZW5seSIsYm9yZGVyVG9wOiIxcHggc29saWQgIi5jb25jYXQoeC5ncmF5WzRdKSxtYXJnaW5Ub3A6OCxwYWRkaW5nVG9wOjE2fX0sYS5hLmNyZWF0ZUVsZW1lbnQoImEiLHtocmVmOiJodHRwczovL2Jsb2cuZXhjYWxpZHJhdy5jb20iLHRhcmdldDoiX2JsYW5rIixyZWw6Im5vb3BlbmVyIG5vcmVmZXJyZXIifSxPYmplY3Qocy5lKSgic2hvcnRjdXRzRGlhbG9nLmJsb2ciKSksYS5hLmNyZWF0ZUVsZW1lbnQoImEiLHtocmVmOiJodHRwczovL2hvd3RvLmV4Y2FsaWRyYXcuY29tIix0YXJnZXQ6Il9ibGFuayIscmVsOiJub29wZW5lciBub3JlZmVycmVyIn0sT2JqZWN0KHMuZSkoInNob3J0Y3V0c0RpYWxvZy5ob3d0byIpKSxhLmEuY3JlYXRlRWxlbWVudCgiYSIse2hyZWY6Imh0dHBzOi8vZ2l0aHViLmNvbS9leGNhbGlkcmF3L2V4Y2FsaWRyYXcvaXNzdWVzIix0YXJnZXQ6Il9ibGFuayIscmVsOiJub29wZW5lciBub3JlZmVycmVyIn0sT2JqZWN0KHMuZSkoInNob3J0Y3V0c0RpYWxvZy5naXRodWIiKSkpfSxXbj1mdW5jdGlvbihlKXt2YXIgdD1lLm9uQ2xvc2Usbj1hLmEudXNlQ2FsbGJhY2soKGZ1bmN0aW9uKCl7dCYmdCgpfSksW3RdKTtyZXR1cm4gYS5hLmNyZWF0ZUVsZW1lbnQoYS5hLkZyYWdtZW50LG51bGwsYS5hLmNyZWF0ZUVsZW1lbnQoaG4se21heFdpZHRoOjkwMCxvbkNsb3NlUmVxdWVzdDpuLHRpdGxlOk9iamVjdChzLmUpKCJzaG9ydGN1dHNEaWFsb2cudGl0bGUiKX0sYS5hLmNyZWF0ZUVsZW1lbnQoTm4sbnVsbCxhLmEuY3JlYXRlRWxlbWVudChGbixudWxsLGEuYS5jcmVhdGVFbGVtZW50KFJuLHtjYXB0aW9uOk9iamVjdChzLmUpKCJzaG9ydGN1dHNEaWFsb2cuc2hhcGVzIil9LGEuYS5jcmVhdGVFbGVtZW50KEJuLHtsYWJlbDpPYmplY3Qocy5lKSgidG9vbEJhci5zZWxlY3Rpb24iKSxzaG9ydGN1dHM6WyJWIiwiMSJdfSksYS5hLmNyZWF0ZUVsZW1lbnQoQm4se2xhYmVsOk9iamVjdChzLmUpKCJ0b29sQmFyLnJlY3RhbmdsZSIpLHNob3J0Y3V0czpbIlIiLCIyIl19KSxhLmEuY3JlYXRlRWxlbWVudChCbix7bGFiZWw6T2JqZWN0KHMuZSkoInRvb2xCYXIuZGlhbW9uZCIpLHNob3J0Y3V0czpbIkQiLCIzIl19KSxhLmEuY3JlYXRlRWxlbWVudChCbix7bGFiZWw6T2JqZWN0KHMuZSkoInRvb2xCYXIuZWxsaXBzZSIpLHNob3J0Y3V0czpbIkUiLCI0Il19KSxhLmEuY3JlYXRlRWxlbWVudChCbix7bGFiZWw6T2JqZWN0KHMuZSkoInRvb2xCYXIuYXJyb3ciKSxzaG9ydGN1dHM6WyJBIiwiNSJdfSksYS5hLmNyZWF0ZUVsZW1lbnQoQm4se2xhYmVsOk9iamVjdChzLmUpKCJ0b29sQmFyLmxpbmUiKSxzaG9ydGN1dHM6WyJQIiwiNiJdfSksYS5hLmNyZWF0ZUVsZW1lbnQoQm4se2xhYmVsOk9iamVjdChzLmUpKCJ0b29sQmFyLmRyYXciKSxzaG9ydGN1dHM6WyJTaGlmdCtQIiwiNyJdfSksYS5hLmNyZWF0ZUVsZW1lbnQoQm4se2xhYmVsOk9iamVjdChzLmUpKCJ0b29sQmFyLnRleHQiKSxzaG9ydGN1dHM6WyJUIiwiOCJdfSksYS5hLmNyZWF0ZUVsZW1lbnQoQm4se2xhYmVsOk9iamVjdChzLmUpKCJzaG9ydGN1dHNEaWFsb2cudGV4dE5ld0xpbmUiKSxzaG9ydGN1dHM6W09iamVjdChPLmspKCJFbnRlciIpLE9iamVjdChPLmspKCJTaGlmdCtFbnRlciIpXX0pLGEuYS5jcmVhdGVFbGVtZW50KEJuLHtsYWJlbDpPYmplY3Qocy5lKSgic2hvcnRjdXRzRGlhbG9nLnRleHRGaW5pc2giKSxzaG9ydGN1dHM6W09iamVjdChPLmspKCJFc2MiKSxPYmplY3QoTy5rKSgiQ3RybE9yQ21kK0VudGVyIildfSksYS5hLmNyZWF0ZUVsZW1lbnQoQm4se2xhYmVsOk9iamVjdChzLmUpKCJzaG9ydGN1dHNEaWFsb2cuY3VydmVkQXJyb3ciKSxzaG9ydGN1dHM6WyJBIixPYmplY3Qocy5lKSgic2hvcnRjdXRzRGlhbG9nLmNsaWNrIiksT2JqZWN0KHMuZSkoInNob3J0Y3V0c0RpYWxvZy5jbGljayIpLE9iamVjdChzLmUpKCJzaG9ydGN1dHNEaWFsb2cuY2xpY2siKV0saXNPcjohMX0pLGEuYS5jcmVhdGVFbGVtZW50KEJuLHtsYWJlbDpPYmplY3Qocy5lKSgic2hvcnRjdXRzRGlhbG9nLmN1cnZlZExpbmUiKSxzaG9ydGN1dHM6WyJMIixPYmplY3Qocy5lKSgic2hvcnRjdXRzRGlhbG9nLmNsaWNrIiksT2JqZWN0KHMuZSkoInNob3J0Y3V0c0RpYWxvZy5jbGljayIpLE9iamVjdChzLmUpKCJzaG9ydGN1dHNEaWFsb2cuY2xpY2siKV0saXNPcjohMX0pLGEuYS5jcmVhdGVFbGVtZW50KEJuLHtsYWJlbDpPYmplY3Qocy5lKSgidG9vbEJhci5sb2NrIiksc2hvcnRjdXRzOlsiUSJdfSkpLGEuYS5jcmVhdGVFbGVtZW50KFJuLHtjYXB0aW9uOk9iamVjdChzLmUpKCJzaG9ydGN1dHNEaWFsb2cudmlldyIpfSxhLmEuY3JlYXRlRWxlbWVudChCbix7bGFiZWw6T2JqZWN0KHMuZSkoImJ1dHRvbnMuem9vbUluIiksc2hvcnRjdXRzOltPYmplY3QoTy5rKSgiQ3RybE9yQ21kKysiKV19KSxhLmEuY3JlYXRlRWxlbWVudChCbix7bGFiZWw6T2JqZWN0KHMuZSkoImJ1dHRvbnMuem9vbU91dCIpLHNob3J0Y3V0czpbT2JqZWN0KE8uaykoIkN0cmxPckNtZCstIildfSksYS5hLmNyZWF0ZUVsZW1lbnQoQm4se2xhYmVsOk9iamVjdChzLmUpKCJidXR0b25zLnJlc2V0Wm9vbSIpLHNob3J0Y3V0czpbT2JqZWN0KE8uaykoIkN0cmxPckNtZCswIildfSksYS5hLmNyZWF0ZUVsZW1lbnQoQm4se2xhYmVsOk9iamVjdChzLmUpKCJzaG9ydGN1dHNEaWFsb2cuem9vbVRvRml0Iiksc2hvcnRjdXRzOlsiU2hpZnQrMSJdfSksYS5hLmNyZWF0ZUVsZW1lbnQoQm4se2xhYmVsOk9iamVjdChzLmUpKCJidXR0b25zLnRvZ2dsZUZ1bGxTY3JlZW4iKSxzaG9ydGN1dHM6WyJGIl19KSxhLmEuY3JlYXRlRWxlbWVudChCbix7bGFiZWw6T2JqZWN0KHMuZSkoImJ1dHRvbnMudG9nZ2xlWmVuTW9kZSIpLHNob3J0Y3V0czpbT2JqZWN0KE8uaykoIkFsdCtaIildfSksYS5hLmNyZWF0ZUVsZW1lbnQoQm4se2xhYmVsOk9iamVjdChzLmUpKCJsYWJlbHMudG9nZ2xlR3JpZE1vZGUiKSxzaG9ydGN1dHM6W09iamVjdChPLmspKCJDdHJsT3JDbWQrJyIpXX0pKSksYS5hLmNyZWF0ZUVsZW1lbnQoRm4sbnVsbCxhLmEuY3JlYXRlRWxlbWVudChSbix7Y2FwdGlvbjpPYmplY3Qocy5lKSgic2hvcnRjdXRzRGlhbG9nLmVkaXRvciIpfSxhLmEuY3JlYXRlRWxlbWVudChCbix7bGFiZWw6T2JqZWN0KHMuZSkoImxhYmVscy5zZWxlY3RBbGwiKSxzaG9ydGN1dHM6W09iamVjdChPLmspKCJDdHJsT3JDbWQrQSIpXX0pLGEuYS5jcmVhdGVFbGVtZW50KEJuLHtsYWJlbDpPYmplY3Qocy5lKSgibGFiZWxzLm11bHRpU2VsZWN0Iiksc2hvcnRjdXRzOltPYmplY3QoTy5rKSgiU2hpZnQrIi5jb25jYXQoT2JqZWN0KHMuZSkoInNob3J0Y3V0c0RpYWxvZy5jbGljayIpKSldfSksYS5hLmNyZWF0ZUVsZW1lbnQoQm4se2xhYmVsOk9iamVjdChzLmUpKCJsYWJlbHMubW92ZUNhbnZhcyIpLHNob3J0Y3V0czpbT2JqZWN0KE8uaykoIlNwYWNlKyIuY29uY2F0KE9iamVjdChzLmUpKCJzaG9ydGN1dHNEaWFsb2cuZHJhZyIpKSksT2JqZWN0KE8uaykoIldoZWVsKyIuY29uY2F0KE9iamVjdChzLmUpKCJzaG9ydGN1dHNEaWFsb2cuZHJhZyIpKSldLGlzT3I6ITB9KSxhLmEuY3JlYXRlRWxlbWVudChCbix7bGFiZWw6T2JqZWN0KHMuZSkoImxhYmVscy5jb3B5Iiksc2hvcnRjdXRzOltPYmplY3QoTy5rKSgiQ3RybE9yQ21kK0MiKV19KSxhLmEuY3JlYXRlRWxlbWVudChCbix7bGFiZWw6T2JqZWN0KHMuZSkoImxhYmVscy5wYXN0ZSIpLHNob3J0Y3V0czpbT2JqZWN0KE8uaykoIkN0cmxPckNtZCtWIildfSksYS5hLmNyZWF0ZUVsZW1lbnQoQm4se2xhYmVsOk9iamVjdChzLmUpKCJsYWJlbHMuY29weUFzUG5nIiksc2hvcnRjdXRzOltPYmplY3QoTy5rKSgiU2hpZnQrQWx0K0MiKV19KSxhLmEuY3JlYXRlRWxlbWVudChCbix7bGFiZWw6T2JqZWN0KHMuZSkoImxhYmVscy5jb3B5U3R5bGVzIiksc2hvcnRjdXRzOltPYmplY3QoTy5rKSgiQ3RybE9yQ21kK0FsdCtDIildfSksYS5hLmNyZWF0ZUVsZW1lbnQoQm4se2xhYmVsOk9iamVjdChzLmUpKCJsYWJlbHMucGFzdGVTdHlsZXMiKSxzaG9ydGN1dHM6W09iamVjdChPLmspKCJDdHJsT3JDbWQrQWx0K1YiKV19KSxhLmEuY3JlYXRlRWxlbWVudChCbix7bGFiZWw6T2JqZWN0KHMuZSkoImxhYmVscy5kZWxldGUiKSxzaG9ydGN1dHM6W09iamVjdChPLmspKCJEZWwiKV19KSxhLmEuY3JlYXRlRWxlbWVudChCbix7bGFiZWw6T2JqZWN0KHMuZSkoImxhYmVscy5zZW5kVG9CYWNrIiksc2hvcnRjdXRzOltDLmY/T2JqZWN0KE8uaykoIkN0cmxPckNtZCtBbHQrWyIpOk9iamVjdChPLmspKCJDdHJsT3JDbWQrU2hpZnQrWyIpXX0pLGEuYS5jcmVhdGVFbGVtZW50KEJuLHtsYWJlbDpPYmplY3Qocy5lKSgibGFiZWxzLmJyaW5nVG9Gcm9udCIpLHNob3J0Y3V0czpbQy5mP09iamVjdChPLmspKCJDdHJsT3JDbWQrQWx0K10iKTpPYmplY3QoTy5rKSgiQ3RybE9yQ21kK1NoaWZ0K10iKV19KSxhLmEuY3JlYXRlRWxlbWVudChCbix7bGFiZWw6T2JqZWN0KHMuZSkoImxhYmVscy5zZW5kQmFja3dhcmQiKSxzaG9ydGN1dHM6W09iamVjdChPLmspKCJDdHJsT3JDbWQrWyIpXX0pLGEuYS5jcmVhdGVFbGVtZW50KEJuLHtsYWJlbDpPYmplY3Qocy5lKSgibGFiZWxzLmJyaW5nRm9yd2FyZCIpLHNob3J0Y3V0czpbT2JqZWN0KE8uaykoIkN0cmxPckNtZCtdIildfSksYS5hLmNyZWF0ZUVsZW1lbnQoQm4se2xhYmVsOk9iamVjdChzLmUpKCJsYWJlbHMuZHVwbGljYXRlU2VsZWN0aW9uIiksc2hvcnRjdXRzOltPYmplY3QoTy5rKSgiQ3RybE9yQ21kK0QiKSxPYmplY3QoTy5rKSgiQWx0KyIuY29uY2F0KE9iamVjdChzLmUpKCJzaG9ydGN1dHNEaWFsb2cuZHJhZyIpKSldfSksYS5hLmNyZWF0ZUVsZW1lbnQoQm4se2xhYmVsOk9iamVjdChzLmUpKCJidXR0b25zLnVuZG8iKSxzaG9ydGN1dHM6W09iamVjdChPLmspKCJDdHJsT3JDbWQrWiIpXX0pLGEuYS5jcmVhdGVFbGVtZW50KEJuLHtsYWJlbDpPYmplY3Qocy5lKSgiYnV0dG9ucy5yZWRvIiksc2hvcnRjdXRzOltPYmplY3QoTy5rKSgiQ3RybE9yQ21kK1NoaWZ0K1oiKV19KSxhLmEuY3JlYXRlRWxlbWVudChCbix7bGFiZWw6T2JqZWN0KHMuZSkoImxhYmVscy5ncm91cCIpLHNob3J0Y3V0czpbT2JqZWN0KE8uaykoIkN0cmxPckNtZCtHIildfSksYS5hLmNyZWF0ZUVsZW1lbnQoQm4se2xhYmVsOk9iamVjdChzLmUpKCJsYWJlbHMudW5ncm91cCIpLHNob3J0Y3V0czpbT2JqZWN0KE8uaykoIkN0cmxPckNtZCtTaGlmdCtHIildfSkpKSksYS5hLmNyZWF0ZUVsZW1lbnQoR24sbnVsbCkpKX0sVW49YS5hLm1lbW8oKGZ1bmN0aW9uKCl7cmV0dXJuIGEuYS5jcmVhdGVFbGVtZW50KCJzdmciLHt4bWxuczoiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciLHdpZHRoOiI0MCIsaGVpZ2h0OiI0MCIsdmlld0JveDoiMCAwIDI1MCAyNTAiLGNsYXNzTmFtZToiZ2l0aHViLWNvcm5lciBydGwtbWlycm9yIn0sYS5hLmNyZWF0ZUVsZW1lbnQoImEiLHtocmVmOiJodHRwczovL2dpdGh1Yi5jb20vZXhjYWxpZHJhdy9leGNhbGlkcmF3Iix0YXJnZXQ6Il9ibGFuayIscmVsOiJub29wZW5lciBub3JlZmVycmVyIiwiYXJpYS1sYWJlbCI6IkdpdEh1YiByZXBvc2l0b3J5In0sYS5hLmNyZWF0ZUVsZW1lbnQoInBhdGgiLHtkOiJNMCAwbDExNSAxMTVoMTVsMTIgMjcgMTA4IDEwOFYweiIsZmlsbDp4LmdyYXlbNl19KSxhLmEuY3JlYXRlRWxlbWVudCgicGF0aCIse2NsYXNzTmFtZToib2N0by1hcm0iLGQ6Ik0xMjggMTA5Yy0xNS05LTktMTktOS0xOSAzLTcgMi0xMSAyLTExLTEtNyAzLTIgMy0yIDQgNSAyIDExIDIgMTEtMyAxMCA1IDE1IDkgMTYiLHN0eWxlOnt0cmFuc2Zvcm1PcmlnaW46IjEzMHB4IDEwNnB4In0sZmlsbDp4LndoaXRlfSksYS5hLmNyZWF0ZUVsZW1lbnQoInBhdGgiLHtjbGFzc05hbWU6Im9jdG8tYm9keSIsZDoiTTExNSAxMTVzNCAyIDUgMGwxNC0xNGMzLTIgNi0zIDgtMy04LTExLTE1LTI0IDItNDEgNS01IDEwLTcgMTYtNyAxLTIgMy03IDEyLTExIDAgMCA1IDMgNyAxNiA0IDIgOCA1IDEyIDlzNyA4IDkgMTJjMTQgMyAxNyA3IDE3IDctNCA4LTkgMTEtMTEgMTEgMCA2LTIgMTEtNyAxNi0xNiAxNi0zMCAxMC00MSAyIDAgMy0xIDctNSAxMWwtMTIgMTFjLTEgMSAxIDUgMSA1eiIsZmlsbDp4LndoaXRlfSkpKX0pKSxWbj0obig4MyksZnVuY3Rpb24oZSl7dmFyIHQ9ZS5jaGlsZHJlbixuPWUubGFiZWw7cmV0dXJuIGEuYS5jcmVhdGVFbGVtZW50KCJkaXYiLHtjbGFzc05hbWU6IlRvb2x0aXAifSxhLmEuY3JlYXRlRWxlbWVudCgic3BhbiIse2NsYXNzTmFtZToiVG9vbHRpcF9fbGFiZWwifSxuKSx0KX0pLEtuPShuKDg0KSxuKDg1KSxhLmEuY3JlYXRlRWxlbWVudCgic3ZnIix7dmlld0JveDoiMCAwIDE3OTIgMTc5MiJ9LGEuYS5jcmVhdGVFbGVtZW50KCJwYXRoIix7ZDoiTTE2MDAgNzM2djE5MnEwIDQwLTI4IDY4dC02OCAyOGgtNDE2djQxNnEwIDQwLTI4IDY4dC02OCAyOGgtMTkycS00MCAwLTY4LTI4dC0yOC02OHYtNDE2aC00MTZxLTQwIDAtNjgtMjh0LTI4LTY4di0xOTJxMC00MCAyOC02OHQ2OC0yOGg0MTZ2LTQxNnEwLTQwIDI4LTY4dDY4LTI4aDE5MnE0MCAwIDY4IDI4dDI4IDY4djQxNmg0MTZxNDAgMCA2OCAyOHQyOCA2OHoifSkpKSxabj1mdW5jdGlvbihlKXt2YXIgdD1lLmVsZW1lbnRzLG49ZS5wZW5kaW5nRWxlbWVudHMscj1lLm9uUmVtb3ZlRnJvbUxpYnJhcnksaT1lLm9uQ2xpY2ssbD1PYmplY3Qoby51c2VSZWYpKG51bGwpO09iamVjdChvLnVzZUVmZmVjdCkoKGZ1bmN0aW9uKCl7dmFyIGU9dHx8bjtpZihlKXtmb3IodmFyIHI9T2JqZWN0KHVuLmMpKGUse2V4cG9ydEJhY2tncm91bmQ6ITEsdmlld0JhY2tncm91bmRDb2xvcjoiI2ZmZiIsc2hvdWxkQWRkV2F0ZXJtYXJrOiExfSksbz0wLGE9bC5jdXJyZW50LmNoaWxkcmVuO288YS5sZW5ndGg7bysrKXt2YXIgaT1hW29dOyJzdmciPT09aS50YWdOYW1lJiZsLmN1cnJlbnQucmVtb3ZlQ2hpbGQoaSl9bC5jdXJyZW50LmFwcGVuZENoaWxkKHIpO3ZhciBzPWwuY3VycmVudDtyZXR1cm4gZnVuY3Rpb24oKXtzLnJlbW92ZUNoaWxkKHIpfX19KSxbdCxuXSk7dmFyIGM9T2JqZWN0KG8udXNlU3RhdGUpKCExKSx1PWNbMF0sZD1jWzFdLHA9YXQoKSxoPSh1fHxwKSYmbiYmYS5hLmNyZWF0ZUVsZW1lbnQoImRpdiIse2NsYXNzTmFtZToibGlicmFyeS11bml0X19hZGRlciJ9LEtuKTtyZXR1cm4gYS5hLmNyZWF0ZUVsZW1lbnQoImRpdiIse2NsYXNzTmFtZToibGlicmFyeS11bml0ICIuY29uY2F0KHR8fG4/ImxpYnJhcnktdW5pdF9fYWN0aXZlIjoiIiksb25Nb3VzZUVudGVyOmZ1bmN0aW9uKCl7cmV0dXJuIGQoITApfSxvbk1vdXNlTGVhdmU6ZnVuY3Rpb24oKXtyZXR1cm4gZCghMSl9fSxhLmEuY3JlYXRlRWxlbWVudCgiZGl2Iix7Y2xhc3NOYW1lOiJsaWJyYXJ5LXVuaXRfX2RyYWdnZXIgIi5jb25jYXQobj8ibGlicmFyeS11bml0X19wdWxzZSI6IiIpLHJlZjpsLGRyYWdnYWJsZTohIXQsb25DbGljazp0fHxuP2k6dm9pZCAwLG9uRHJhZ1N0YXJ0OmZ1bmN0aW9uKGUpe2QoITEpLGUuZGF0YVRyYW5zZmVyLnNldERhdGEoImFwcGxpY2F0aW9uL3ZuZC5leGNhbGlkcmF3bGliK2pzb24iLEpTT04uc3RyaW5naWZ5KHQpKX19KSxoLHQmJih1fHxwKSYmYS5hLmNyZWF0ZUVsZW1lbnQoImJ1dHRvbiIse2NsYXNzTmFtZToibGlicmFyeS11bml0X19yZW1vdmVGcm9tTGlicmFyeSIsImFyaWEtbGFiZWwiOk9iamVjdChzLmUpKCJsYWJlbHMucmVtb3ZlRnJvbUxpYnJhcnkiKSxvbkNsaWNrOnJ9LG1lKSl9LHFuPW4oMjkpLFluPWZ1bmN0aW9uKGUsdCl7dmFyIG4scixvLGEsaT17bGFiZWw6MCxzZW50OmZ1bmN0aW9uKCl7aWYoMSZvWzBdKXRocm93IG9bMV07cmV0dXJuIG9bMV19LHRyeXM6W10sb3BzOltdfTtyZXR1cm4gYT17bmV4dDpzKDApLHRocm93OnMoMSkscmV0dXJuOnMoMil9LCJmdW5jdGlvbiI9PXR5cGVvZiBTeW1ib2wmJihhW1N5bWJvbC5pdGVyYXRvcl09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30pLGE7ZnVuY3Rpb24gcyhhKXtyZXR1cm4gZnVuY3Rpb24ocyl7cmV0dXJuIGZ1bmN0aW9uKGEpe2lmKG4pdGhyb3cgbmV3IFR5cGVFcnJvcigiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLiIpO2Zvcig7aTspdHJ5e2lmKG49MSxyJiYobz0yJmFbMF0/ci5yZXR1cm46YVswXT9yLnRocm93fHwoKG89ci5yZXR1cm4pJiZvLmNhbGwociksMCk6ci5uZXh0KSYmIShvPW8uY2FsbChyLGFbMV0pKS5kb25lKXJldHVybiBvO3N3aXRjaChyPTAsbyYmKGE9WzImYVswXSxvLnZhbHVlXSksYVswXSl7Y2FzZSAwOmNhc2UgMTpvPWE7YnJlYWs7Y2FzZSA0OnJldHVybiBpLmxhYmVsKysse3ZhbHVlOmFbMV0sZG9uZTohMX07Y2FzZSA1OmkubGFiZWwrKyxyPWFbMV0sYT1bMF07Y29udGludWU7Y2FzZSA3OmE9aS5vcHMucG9wKCksaS50cnlzLnBvcCgpO2NvbnRpbnVlO2RlZmF1bHQ6aWYoIShvPWkudHJ5cywobz1vLmxlbmd0aD4wJiZvW28ubGVuZ3RoLTFdKXx8NiE9PWFbMF0mJjIhPT1hWzBdKSl7aT0wO2NvbnRpbnVlfWlmKDM9PT1hWzBdJiYoIW98fGFbMV0+b1swXSYmYVsxXTxvWzNdKSl7aS5sYWJlbD1hWzFdO2JyZWFrfWlmKDY9PT1hWzBdJiZpLmxhYmVsPG9bMV0pe2kubGFiZWw9b1sxXSxvPWE7YnJlYWt9aWYobyYmaS5sYWJlbDxvWzJdKXtpLmxhYmVsPW9bMl0saS5vcHMucHVzaChhKTticmVha31vWzJdJiZpLm9wcy5wb3AoKSxpLnRyeXMucG9wKCk7Y29udGludWV9YT10LmNhbGwoZSxpKX1jYXRjaChlKXthPVs2LGVdLHI9MH1maW5hbGx5e249bz0wfWlmKDUmYVswXSl0aHJvdyBhWzFdO3JldHVybnt2YWx1ZTphWzBdP2FbMV06dm9pZCAwLGRvbmU6ITB9fShbYSxzXSl9fX0sWG49ZnVuY3Rpb24oKXtmb3IodmFyIGU9MCx0PTAsbj1hcmd1bWVudHMubGVuZ3RoO3Q8bjt0KyspZSs9YXJndW1lbnRzW3RdLmxlbmd0aDt2YXIgcj1BcnJheShlKSxvPTA7Zm9yKHQ9MDt0PG47dCsrKWZvcih2YXIgYT1hcmd1bWVudHNbdF0saT0wLHM9YS5sZW5ndGg7aTxzO2krKyxvKyspcltvXT1hW2ldO3JldHVybiByfTtmdW5jdGlvbiBKbihlLHQpe2lmKG51bGw9PWUpcmV0dXJue307dmFyIG4scixvPWZ1bmN0aW9uKGUsdCl7aWYobnVsbD09ZSlyZXR1cm57fTt2YXIgbixyLG89e30sYT1PYmplY3Qua2V5cyhlKTtmb3Iocj0wO3I8YS5sZW5ndGg7cisrKW49YVtyXSx0LmluZGV4T2Yobik+PTB8fChvW25dPWVbbl0pO3JldHVybiBvfShlLHQpO2lmKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpe3ZhciBhPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7Zm9yKHI9MDtyPGEubGVuZ3RoO3IrKyluPWFbcl0sdC5pbmRleE9mKG4pPj0wfHxPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoZSxuKSYmKG9bbl09ZVtuXSl9cmV0dXJuIG99ZnVuY3Rpb24gJG4oZSx0KXt2YXIgbj1PYmplY3Qua2V5cyhlKTtpZihPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgcj1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO3QmJihyPXIuZmlsdGVyKChmdW5jdGlvbih0KXtyZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihlLHQpLmVudW1lcmFibGV9KSkpLG4ucHVzaC5hcHBseShuLHIpfXJldHVybiBufWZ1bmN0aW9uIFFuKGUpe2Zvcih2YXIgdD0xO3Q8YXJndW1lbnRzLmxlbmd0aDt0Kyspe3ZhciBuPW51bGwhPWFyZ3VtZW50c1t0XT9hcmd1bWVudHNbdF06e307dCUyPyRuKE9iamVjdChuKSwhMCkuZm9yRWFjaCgoZnVuY3Rpb24odCl7ZXIoZSx0LG5bdF0pfSkpOk9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzP09iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGUsT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMobikpOiRuKE9iamVjdChuKSkuZm9yRWFjaCgoZnVuY3Rpb24odCl7T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsdCxPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG4sdCkpfSkpfXJldHVybiBlfWZ1bmN0aW9uIGVyKGUsdCxuKXtyZXR1cm4gdCBpbiBlP09iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHQse3ZhbHVlOm4sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITAsd3JpdGFibGU6ITB9KTplW3RdPW4sZX1mdW5jdGlvbiB0cihlLHQsbixyLG8sYSxpKXt0cnl7dmFyIHM9ZVthXShpKSxsPXMudmFsdWV9Y2F0Y2goZSl7cmV0dXJuIHZvaWQgbihlKX1zLmRvbmU/dChsKTpQcm9taXNlLnJlc29sdmUobCkudGhlbihyLG8pfWZ1bmN0aW9uIG5yKGUpe3JldHVybiBmdW5jdGlvbigpe3ZhciB0PXRoaXMsbj1hcmd1bWVudHM7cmV0dXJuIG5ldyBQcm9taXNlKChmdW5jdGlvbihyLG8pe3ZhciBhPWUuYXBwbHkodCxuKTtmdW5jdGlvbiBpKGUpe3RyKGEscixvLGkscywibmV4dCIsZSl9ZnVuY3Rpb24gcyhlKXt0cihhLHIsbyxpLHMsInRocm93IixlKX1pKHZvaWQgMCl9KSl9fXZhciBycj1mdW5jdGlvbihlKXt2YXIgdD1lLmxpYnJhcnksbj1lLm9uUmVtb3ZlRnJvbUxpYnJhcnkscj1lLm9uQWRkVG9MaWJyYXJ5LG89ZS5vbkluc2VydFNoYXBlLGk9ZS5wZW5kaW5nRWxlbWVudHMsbD1lLnNldEFwcFN0YXRlLGM9YXQoKSx1PXQubGVuZ3RoKyhpLmxlbmd0aD4wPzE6MCksZD1jPzQ6NixwPU1hdGgubWF4KDEsTWF0aC5jZWlsKHUvZCkpLGg9W10sZj0hMTtoLnB1c2goYS5hLmNyZWF0ZUVsZW1lbnQocm4se2FsaWduOiJjZW50ZXIiLGdhcDoxLGtleToiYWN0aW9ucyJ9LGEuYS5jcmVhdGVFbGVtZW50KFUse2tleToiaW1wb3J0Iix0eXBlOiJidXR0b24iLHRpdGxlOk9iamVjdChzLmUpKCJidXR0b25zLmxvYWQiKSwiYXJpYS1sYWJlbCI6T2JqZWN0KHMuZSkoImJ1dHRvbnMubG9hZCIpLGljb246WCxvbkNsaWNrOmZ1bmN0aW9uKCl7T2JqZWN0KHFuLmEpKCkudGhlbigoZnVuY3Rpb24oKXtsKHtpc0xpYnJhcnlPcGVuOiExfSl9KSkuY2F0Y2goTy5yKS5jYXRjaCgoZnVuY3Rpb24oZSl7bCh7ZXJyb3JNZXNzYWdlOmUubWVzc2FnZX0pfSkpfX0pLGEuYS5jcmVhdGVFbGVtZW50KFUse2tleToiZXhwb3J0Iix0eXBlOiJidXR0b24iLHRpdGxlOk9iamVjdChzLmUpKCJidXR0b25zLmV4cG9ydCIpLCJhcmlhLWxhYmVsIjpPYmplY3Qocy5lKSgiYnV0dG9ucy5leHBvcnQiKSxpY29uOmVlLG9uQ2xpY2s6ZnVuY3Rpb24oKXtPYmplY3QocW4uZCkoKS5jYXRjaChPLnIpLmNhdGNoKChmdW5jdGlvbihlKXtsKHtlcnJvck1lc3NhZ2U6ZS5tZXNzYWdlfSl9KSl9fSkpKTtmb3IodmFyIG09MDttPHA7bSsrKXtmb3IodmFyIGc9ZCptLGI9W10seT0wO3k8ZDt5Kyspe3ZhciB2PWkubGVuZ3RoPjAmJiFmJiZnK3k+PXQubGVuZ3RoO2Y9Znx8dixiLnB1c2goYS5hLmNyZWF0ZUVsZW1lbnQob24se2tleTp5fSxhLmEuY3JlYXRlRWxlbWVudChabix7ZWxlbWVudHM6dFtnK3ldLHBlbmRpbmdFbGVtZW50czp2P2k6dm9pZCAwLG9uUmVtb3ZlRnJvbUxpYnJhcnk6bi5iaW5kKG51bGwsZyt5KSxvbkNsaWNrOnY/ci5iaW5kKG51bGwsaSk6by5iaW5kKG51bGwsdFtnK3ldKX0pKSl9aC5wdXNoKGEuYS5jcmVhdGVFbGVtZW50KHJuLHthbGlnbjoiY2VudGVyIixnYXA6MSxrZXk6bX0sYikpfXJldHVybiBhLmEuY3JlYXRlRWxlbWVudChvbix7YWxpZ246ImNlbnRlciIsZ2FwOjEsY2xhc3NOYW1lOiJsYXllci11aV9fbGlicmFyeS1pdGVtcyJ9LGgpfSxvcj1mdW5jdGlvbihlKXt2YXIgdD1lLm9uQ2xpY2tPdXRzaWRlLG49ZS5vbkluc2VydFNoYXBlLHI9ZS5wZW5kaW5nRWxlbWVudHMsaT1lLm9uQWRkVG9MaWJyYXJ5LGw9ZS5zZXRBcHBTdGF0ZSxjPU9iamVjdChvLnVzZVJlZikobnVsbCk7IWZ1bmN0aW9uKGUsdCl7T2JqZWN0KG8udXNlRWZmZWN0KSgoZnVuY3Rpb24oKXt2YXIgbj1mdW5jdGlvbihuKXtlLmN1cnJlbnQmJihuLnRhcmdldCBpbnN0YW5jZW9mIEVsZW1lbnQmJihlLmN1cnJlbnQuY29udGFpbnMobi50YXJnZXQpfHwhZG9jdW1lbnQuYm9keS5jb250YWlucyhuLnRhcmdldCkpfHx0KG4pKX07cmV0dXJuIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoInBvaW50ZXJkb3duIixuLCExKSxmdW5jdGlvbigpe2RvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoInBvaW50ZXJkb3duIixuKX19KSxbZSx0XSl9KGMsdCk7dmFyIHU9T2JqZWN0KG8udXNlU3RhdGUpKFtdKSxkPXVbMF0scD11WzFdLGg9T2JqZWN0KG8udXNlU3RhdGUpKCJwcmVsb2FkaW5nIiksZj1oWzBdLG09aFsxXSxnPU9iamVjdChvLnVzZVJlZikobnVsbCk7T2JqZWN0KG8udXNlRWZmZWN0KSgoZnVuY3Rpb24oKXtyZXR1cm4gUHJvbWlzZS5yYWNlKFtuZXcgUHJvbWlzZSgoZnVuY3Rpb24oZSl7Zy5jdXJyZW50PXNldFRpbWVvdXQoKGZ1bmN0aW9uKCl7ZSgibG9hZGluZyIpfSksMTAwKX0pKSxPYmplY3QoR3QuYSkoKS50aGVuKChmdW5jdGlvbihlKXtwKGUpLG0oInJlYWR5Iil9KSldKS50aGVuKChmdW5jdGlvbihlKXsibG9hZGluZyI9PT1lJiZtKCJsb2FkaW5nIil9KSksZnVuY3Rpb24oKXtjbGVhclRpbWVvdXQoZy5jdXJyZW50KX19KSxbXSk7dmFyIGI9T2JqZWN0KG8udXNlQ2FsbGJhY2spKGZ1bmN0aW9uKCl7dmFyIGU9bnIoKGZ1bmN0aW9uKGUpe3ZhciB0LG47cmV0dXJuIFluKHRoaXMsKGZ1bmN0aW9uKHIpe3N3aXRjaChyLmxhYmVsKXtjYXNlIDA6cmV0dXJuWzQsT2JqZWN0KEd0LmEpKCldO2Nhc2UgMTpyZXR1cm4gdD1yLnNlbnQoKSxuPXQuZmlsdGVyKChmdW5jdGlvbih0LG4pe3JldHVybiBuIT09ZX0pKSxPYmplY3QoR3QuYikobikscChuKSxbMl19fSkpfSkpO3JldHVybiBmdW5jdGlvbih0KXtyZXR1cm4gZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fSgpLFtdKSx5PU9iamVjdChvLnVzZUNhbGxiYWNrKShmdW5jdGlvbigpe3ZhciBlPW5yKChmdW5jdGlvbihlKXt2YXIgdCxuO3JldHVybiBZbih0aGlzLChmdW5jdGlvbihyKXtzd2l0Y2goci5sYWJlbCl7Y2FzZSAwOnJldHVybls0LE9iamVjdChHdC5hKSgpXTtjYXNlIDE6cmV0dXJuIHQ9ci5zZW50KCksbj1Ybih0LFtlXSksaSgpLE9iamVjdChHdC5iKShuKSxwKG4pLFsyXX19KSl9KSk7cmV0dXJuIGZ1bmN0aW9uKHQpe3JldHVybiBlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX19KCksW2ldKTtyZXR1cm4icHJlbG9hZGluZyI9PT1mP251bGw6YS5hLmNyZWF0ZUVsZW1lbnQobm4se3BhZGRpbmc6MSxyZWY6YyxjbGFzc05hbWU6ImxheWVyLXVpX19saWJyYXJ5In0sImxvYWRpbmciPT09Zj9hLmEuY3JlYXRlRWxlbWVudCgiZGl2Iix7Y2xhc3NOYW1lOiJsYXllci11aV9fbGlicmFyeS1tZXNzYWdlIn0sT2JqZWN0KHMuZSkoImxhYmVscy5saWJyYXJ5TG9hZGluZ01lc3NhZ2UiKSk6YS5hLmNyZWF0ZUVsZW1lbnQocnIse2xpYnJhcnk6ZCxvbkNsaWNrT3V0c2lkZTp0LG9uUmVtb3ZlRnJvbUxpYnJhcnk6YixvbkFkZFRvTGlicmFyeTp5LG9uSW5zZXJ0U2hhcGU6bixwZW5kaW5nRWxlbWVudHM6cixzZXRBcHBTdGF0ZTpsfSkpfSxhcj1hLmEubWVtbygoZnVuY3Rpb24oZSl7dmFyIHQsbj1lLmFjdGlvbk1hbmFnZXIscj1lLmFwcFN0YXRlLGw9ZS5zZXRBcHBTdGF0ZSxjPWUuY2FudmFzLHU9ZS5lbGVtZW50cyxkPWUub25Sb29tQ3JlYXRlLHA9ZS5vblVzZXJuYW1lQ2hhbmdlLGg9ZS5vblJvb21EZXN0cm95LHk9ZS5vbkxvY2tUb2dnbGUsdj1lLm9uSW5zZXJ0U2hhcGUsaz1lLnplbk1vZGVFbmFibGVkLHc9ZS50b2dnbGVaZW5Nb2RlLFM9YXQoKSxFPWZ1bmN0aW9uKCl7dmFyIGU9ZnVuY3Rpb24oZSl7cmV0dXJuIGZ1bmN0aW9uKHQsbil7YyYmT2JqZWN0KGcuZCkoZSx0LHIsYyx7ZXhwb3J0QmFja2dyb3VuZDpyLmV4cG9ydEJhY2tncm91bmQsbmFtZTpyLm5hbWUsdmlld0JhY2tncm91bmRDb2xvcjpyLnZpZXdCYWNrZ3JvdW5kQ29sb3Isc2NhbGU6bixzaG91bGRBZGRXYXRlcm1hcms6ci5zaG91bGRBZGRXYXRlcm1hcmt9KX19O3JldHVybiBhLmEuY3JlYXRlRWxlbWVudChibix7ZWxlbWVudHM6dSxhcHBTdGF0ZTpyLGFjdGlvbk1hbmFnZXI6bixvbkV4cG9ydFRvUG5nOmUoInBuZyIpLG9uRXhwb3J0VG9Tdmc6ZSgic3ZnIiksb25FeHBvcnRUb0NsaXBib2FyZDplKCJjbGlwYm9hcmQiKSxvbkV4cG9ydFRvQmFja2VuZDpmdW5jdGlvbihlKXtjJiZPYmplY3QoZy5kKSgiYmFja2VuZCIsZSxRbihRbih7fSxyKSx7fSx7c2VsZWN0ZWRFbGVtZW50SWRzOnt9fSksYyxyKX19KX0sTz1PYmplY3Qoby51c2VDYWxsYmFjaykoKGZ1bmN0aW9uKGUpe2woe2lzTGlicmFyeU9wZW46ITF9KX0pLFtsXSksQz1PYmplY3Qoby51c2VDYWxsYmFjaykoKGZ1bmN0aW9uKCl7bCh7c2VsZWN0ZWRFbGVtZW50SWRzOnt9LHNlbGVjdGVkR3JvdXBJZHM6e319KX0pLFtsXSkseD1yLmlzTGlicmFyeU9wZW4/YS5hLmNyZWF0ZUVsZW1lbnQob3Ise3BlbmRpbmdFbGVtZW50czpPYmplY3QobS5nKSh1LHIpLG9uQ2xpY2tPdXRzaWRlOk8sb25JbnNlcnRTaGFwZTp2LG9uQWRkVG9MaWJyYXJ5OkMsc2V0QXBwU3RhdGU6bH0pOm51bGw7cmV0dXJuIFM/YS5hLmNyZWF0ZUVsZW1lbnQoTG4se2FwcFN0YXRlOnIsZWxlbWVudHM6dSxhY3Rpb25NYW5hZ2VyOm4sbGlicmFyeU1lbnU6eCxleHBvcnRCdXR0b246RSgpLHNldEFwcFN0YXRlOmwsb25Vc2VybmFtZUNoYW5nZTpwLG9uUm9vbUNyZWF0ZTpkLG9uUm9vbURlc3Ryb3k6aCxvbkxvY2tUb2dnbGU6eSxjYW52YXM6Y30pOmEuYS5jcmVhdGVFbGVtZW50KCJkaXYiLHtjbGFzc05hbWU6ImxheWVyLXVpX193cmFwcGVyIn0sci5pc0xvYWRpbmcmJmEuYS5jcmVhdGVFbGVtZW50KGksbnVsbCksci5lcnJvck1lc3NhZ2UmJmEuYS5jcmVhdGVFbGVtZW50KEluLHttZXNzYWdlOnIuZXJyb3JNZXNzYWdlLG9uQ2xvc2U6ZnVuY3Rpb24oKXtyZXR1cm4gbCh7ZXJyb3JNZXNzYWdlOm51bGx9KX19KSxyLnNob3dTaG9ydGN1dHNEaWFsb2cmJmEuYS5jcmVhdGVFbGVtZW50KFduLHtvbkNsb3NlOmZ1bmN0aW9uKCl7cmV0dXJuIGwoe3Nob3dTaG9ydGN1dHNEaWFsb2c6bnVsbH0pfX0pLCh0PU9iamVjdChmLkcpKHIsdSksYS5hLmNyZWF0ZUVsZW1lbnQoYW4se3NpZGU6InRvcCJ9LGEuYS5jcmVhdGVFbGVtZW50KHZuLHthcHBTdGF0ZTpyLGVsZW1lbnRzOnV9KSxhLmEuY3JlYXRlRWxlbWVudCgiZGl2Iix7Y2xhc3NOYW1lOiJBcHAtbWVudSBBcHAtbWVudV90b3AifSxhLmEuY3JlYXRlRWxlbWVudChvbix7Z2FwOjQsY2xhc3NOYW1lOmsmJiJkaXNhYmxlLXBvaW50ZXJFdmVudHMifSxhLmEuY3JlYXRlRWxlbWVudCh4bix7aGVhZGluZzoiY2FudmFzQWN0aW9ucyIsY2xhc3NOYW1lOiJ6ZW4tbW9kZS10cmFuc2l0aW9uICIuY29uY2F0KGsmJiJ0cmFuc2l0aW9uLWxlZnQiKX0sYS5hLmNyZWF0ZUVsZW1lbnQobm4se3BhZGRpbmc6NCxzdHlsZTp7ekluZGV4OjF9fSxhLmEuY3JlYXRlRWxlbWVudChvbix7Z2FwOjR9LGEuYS5jcmVhdGVFbGVtZW50KHJuLHtnYXA6MSxqdXN0aWZ5Q29udGVudDoic3BhY2UtYmV0d2VlbiJ9LG4ucmVuZGVyQWN0aW9uKCJsb2FkU2NlbmUiKSxuLnJlbmRlckFjdGlvbigic2F2ZVNjZW5lIiksbi5yZW5kZXJBY3Rpb24oInNhdmVBc1NjZW5lIiksRSgpLG4ucmVuZGVyQWN0aW9uKCJjbGVhckNhbnZhcyIpLGEuYS5jcmVhdGVFbGVtZW50KFRuLHtpc0NvbGxhYm9yYXRpbmc6ci5pc0NvbGxhYm9yYXRpbmcsY29sbGFib3JhdG9yQ291bnQ6ci5jb2xsYWJvcmF0b3JzLnNpemUsdXNlcm5hbWU6ci51c2VybmFtZSxvblVzZXJuYW1lQ2hhbmdlOnAsb25Sb29tQ3JlYXRlOmQsb25Sb29tRGVzdHJveTpofSkpLG4ucmVuZGVyQWN0aW9uKCJjaGFuZ2VWaWV3QmFja2dyb3VuZENvbG9yIikpKSksdCYmYS5hLmNyZWF0ZUVsZW1lbnQoeG4se2hlYWRpbmc6InNlbGVjdGVkU2hhcGVBY3Rpb25zIixjbGFzc05hbWU6Inplbi1tb2RlLXRyYW5zaXRpb24gIi5jb25jYXQoayYmInRyYW5zaXRpb24tbGVmdCIpfSxhLmEuY3JlYXRlRWxlbWVudChubix7Y2xhc3NOYW1lOmIuYy5TSEFQRV9BQ1RJT05TX01FTlUscGFkZGluZzo0fSxhLmEuY3JlYXRlRWxlbWVudChrbix7YXBwU3RhdGU6cixlbGVtZW50czp1LHJlbmRlckFjdGlvbjpuLnJlbmRlckFjdGlvbixlbGVtZW50VHlwZTpyLmVsZW1lbnRUeXBlfSkpKSksYS5hLmNyZWF0ZUVsZW1lbnQoeG4se2hlYWRpbmc6InNoYXBlcyJ9LChmdW5jdGlvbihlKXtyZXR1cm4gYS5hLmNyZWF0ZUVsZW1lbnQob24se2dhcDo0LGFsaWduOiJzdGFydCJ9LGEuYS5jcmVhdGVFbGVtZW50KHJuLHtnYXA6MX0sYS5hLmNyZWF0ZUVsZW1lbnQobm4se3BhZGRpbmc6MSxjbGFzc05hbWU6ayYmInplbi1tb2RlIn0sZSxhLmEuY3JlYXRlRWxlbWVudChybix7Z2FwOjF9LGEuYS5jcmVhdGVFbGVtZW50KFNuLHtlbGVtZW50VHlwZTpyLmVsZW1lbnRUeXBlLHNldEFwcFN0YXRlOmwsaXNMaWJyYXJ5T3BlbjpyLmlzTGlicmFyeU9wZW59KSkpLGEuYS5jcmVhdGVFbGVtZW50KGNuLHt6ZW5Nb2RlRW5hYmxlZDprLGNoZWNrZWQ6ci5lbGVtZW50TG9ja2VkLG9uQ2hhbmdlOnksdGl0bGU6T2JqZWN0KHMuZSkoInRvb2xCYXIubG9jayIpfSkpLHgpfSkpLGEuYS5jcmVhdGVFbGVtZW50KHNuLHtjbGFzc05hbWU6Inplbi1tb2RlLXRyYW5zaXRpb24gIi5jb25jYXQoayYmInRyYW5zaXRpb24tcmlnaHQiKX0sQXJyYXkuZnJvbShyLmNvbGxhYm9yYXRvcnMpLmZpbHRlcigoZnVuY3Rpb24oZSl7ZVswXTt2YXIgdD1lWzFdO3JldHVybiAwIT09T2JqZWN0LmtleXModCkubGVuZ3RofSkpLm1hcCgoZnVuY3Rpb24oZSl7dmFyIHQ9ZVswXSxyPWVbMV07cmV0dXJuIGEuYS5jcmVhdGVFbGVtZW50KFZuLHtsYWJlbDpyLnVzZXJuYW1lfHwiVW5rbm93biB1c2VyIixrZXk6dH0sbi5yZW5kZXJBY3Rpb24oImdvVG9Db2xsYWJvcmF0b3IiLHQpKX0pKSkpKSksYS5hLmNyZWF0ZUVsZW1lbnQoImRpdiIse2NsYXNzTmFtZToiQXBwLW1lbnUgQXBwLW1lbnVfYm90dG9tIHplbi1tb2RlLXRyYW5zaXRpb24gIi5jb25jYXQoayYmIkFwcC1tZW51X2JvdHRvbS0tdHJhbnNpdGlvbi1sZWZ0Iil9LGEuYS5jcmVhdGVFbGVtZW50KG9uLHtnYXA6Mn0sYS5hLmNyZWF0ZUVsZW1lbnQoeG4se2hlYWRpbmc6ImNhbnZhc0FjdGlvbnMifSxhLmEuY3JlYXRlRWxlbWVudChubix7cGFkZGluZzoxfSxhLmEuY3JlYXRlRWxlbWVudChFbix7cmVuZGVyQWN0aW9uOm4ucmVuZGVyQWN0aW9uLHpvb206ci56b29tfSkpLGEuYS5jcmVhdGVFbGVtZW50KCJhIix7Y2xhc3NOYW1lOiJlbmNyeXB0ZWQtaWNvbiB0b29sdGlwIHplbi1tb2RlLXZpc2liaWxpdHkgIi5jb25jYXQoaz8iemVuLW1vZGUtdmlzaWJpbGl0eS0taGlkZGVuIjoiIiksaHJlZjoiaHR0cHM6Ly9ibG9nLmV4Y2FsaWRyYXcuY29tL2VuZC10by1lbmQtZW5jcnlwdGlvbi8iLHRhcmdldDoiX2JsYW5rIixyZWw6Im5vb3BlbmVyIG5vcmVmZXJyZXIifSxhLmEuY3JlYXRlRWxlbWVudCgic3BhbiIse2NsYXNzTmFtZToidG9vbHRpcC10ZXh0IixkaXI6ImF1dG8ifSxPYmplY3Qocy5lKSgiZW5jcnlwdGVkLnRvb2x0aXAiKSkseWUpKSkpLGEuYS5jcmVhdGVFbGVtZW50KCJhc2lkZSIse2NsYXNzTmFtZToibGF5ZXItdWlfX3dyYXBwZXJfX2dpdGh1Yi1jb3JuZXIgemVuLW1vZGUtdHJhbnNpdGlvbiAiLmNvbmNhdChrJiYidHJhbnNpdGlvbi1yaWdodCIpfSxhLmEuY3JlYXRlRWxlbWVudChVbixudWxsKSksYS5hLmNyZWF0ZUVsZW1lbnQoImZvb3RlciIse3JvbGU6ImNvbnRlbnRpbmZvIixjbGFzc05hbWU6ImxheWVyLXVpX193cmFwcGVyX19mb290ZXIifSxhLmEuY3JlYXRlRWxlbWVudCgiZGl2Iix7Y2xhc3NOYW1lOiJ6ZW4tbW9kZS10cmFuc2l0aW9uICIuY29uY2F0KGsmJiJ0cmFuc2l0aW9uLXJpZ2h0IGRpc2FibGUtcG9pbnRlckV2ZW50cyIpfSxhLmEuY3JlYXRlRWxlbWVudCh5bix7b25DaGFuZ2U6ZnVuY3Rpb24oKXt2YXIgZT1ucigoZnVuY3Rpb24oZSl7cmV0dXJuIFluKHRoaXMsKGZ1bmN0aW9uKHQpe3N3aXRjaCh0LmxhYmVsKXtjYXNlIDA6cmV0dXJuWzQsT2JqZWN0KHMuYykoZSldO2Nhc2UgMTpyZXR1cm4gdC5zZW50KCksbCh7fSksWzJdfX0pKX0pKTtyZXR1cm4gZnVuY3Rpb24odCl7cmV0dXJuIGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfX0oKSxsYW5ndWFnZXM6cy5iLGZsb2F0aW5nOiEwfSksbi5yZW5kZXJBY3Rpb24oInRvZ2dsZVNob3J0Y3V0cyIpKSxhLmEuY3JlYXRlRWxlbWVudCgiYnV0dG9uIix7Y2xhc3NOYW1lOiJkaXNhYmxlLXplbi1tb2RlICIuY29uY2F0KGsmJiJkaXNhYmxlLXplbi1tb2RlLS12aXNpYmxlIiksb25DbGljazp3fSxPYmplY3Qocy5lKSgiYnV0dG9ucy5leGl0WmVuTW9kZSIpKSxyLnNjcm9sbGVkT3V0c2lkZSYmYS5hLmNyZWF0ZUVsZW1lbnQoImJ1dHRvbiIse2NsYXNzTmFtZToic2Nyb2xsLWJhY2stdG8tY29udGVudCIsb25DbGljazpmdW5jdGlvbigpe2woUW4oe30sT2JqZWN0KG0uYSkodSxyLGMpKSl9fSxPYmplY3Qocy5lKSgiYnV0dG9ucy5zY3JvbGxCYWNrVG9Db250ZW50IikpKSl9KSwoZnVuY3Rpb24oZSx0KXt2YXIgbj1mdW5jdGlvbihlKXtlLmN1cnNvclgsZS5jdXJzb3JZO3JldHVybiBKbihlLFsiY3Vyc29yWCIsImN1cnNvclkiXSl9LHI9bihlLmFwcFN0YXRlKSxvPW4odC5hcHBTdGF0ZSksYT1PYmplY3Qua2V5cyhyKTtyZXR1cm4gZS5sbmc9PT10LmxuZyYmZS5lbGVtZW50cz09PXQuZWxlbWVudHMmJmEuZXZlcnkoKGZ1bmN0aW9uKGUpe3JldHVybiByW2VdPT09b1tlXX0pKX0pKSxpcj1uKDE0KSxzcj1uKDY4KSxscj1uLm4oc3IpLGNyPW4oNDIpLHVyPW4oMjIpLGRyPWZ1bmN0aW9uKCl7dmFyIGU9ZnVuY3Rpb24odCxuKXtyZXR1cm4oZT1PYmplY3Quc2V0UHJvdG90eXBlT2Z8fHtfX3Byb3RvX186W119aW5zdGFuY2VvZiBBcnJheSYmZnVuY3Rpb24oZSx0KXtlLl9fcHJvdG9fXz10fXx8ZnVuY3Rpb24oZSx0KXtmb3IodmFyIG4gaW4gdCl0Lmhhc093blByb3BlcnR5KG4pJiYoZVtuXT10W25dKX0pKHQsbil9O3JldHVybiBmdW5jdGlvbih0LG4pe2Z1bmN0aW9uIHIoKXt0aGlzLmNvbnN0cnVjdG9yPXR9ZSh0LG4pLHQucHJvdG90eXBlPW51bGw9PT1uP09iamVjdC5jcmVhdGUobik6KHIucHJvdG90eXBlPW4ucHJvdG90eXBlLG5ldyByKX19KCkscHI9ZnVuY3Rpb24oZSx0KXt2YXIgbixyLG8sYSxpPXtsYWJlbDowLHNlbnQ6ZnVuY3Rpb24oKXtpZigxJm9bMF0pdGhyb3cgb1sxXTtyZXR1cm4gb1sxXX0sdHJ5czpbXSxvcHM6W119O3JldHVybiBhPXtuZXh0OnMoMCksdGhyb3c6cygxKSxyZXR1cm46cygyKX0sImZ1bmN0aW9uIj09dHlwZW9mIFN5bWJvbCYmKGFbU3ltYm9sLml0ZXJhdG9yXT1mdW5jdGlvbigpe3JldHVybiB0aGlzfSksYTtmdW5jdGlvbiBzKGEpe3JldHVybiBmdW5jdGlvbihzKXtyZXR1cm4gZnVuY3Rpb24oYSl7aWYobil0aHJvdyBuZXcgVHlwZUVycm9yKCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuIik7Zm9yKDtpOyl0cnl7aWYobj0xLHImJihvPTImYVswXT9yLnJldHVybjphWzBdP3IudGhyb3d8fCgobz1yLnJldHVybikmJm8uY2FsbChyKSwwKTpyLm5leHQpJiYhKG89by5jYWxsKHIsYVsxXSkpLmRvbmUpcmV0dXJuIG87c3dpdGNoKHI9MCxvJiYoYT1bMiZhWzBdLG8udmFsdWVdKSxhWzBdKXtjYXNlIDA6Y2FzZSAxOm89YTticmVhaztjYXNlIDQ6cmV0dXJuIGkubGFiZWwrKyx7dmFsdWU6YVsxXSxkb25lOiExfTtjYXNlIDU6aS5sYWJlbCsrLHI9YVsxXSxhPVswXTtjb250aW51ZTtjYXNlIDc6YT1pLm9wcy5wb3AoKSxpLnRyeXMucG9wKCk7Y29udGludWU7ZGVmYXVsdDppZighKG89aS50cnlzLChvPW8ubGVuZ3RoPjAmJm9bby5sZW5ndGgtMV0pfHw2IT09YVswXSYmMiE9PWFbMF0pKXtpPTA7Y29udGludWV9aWYoMz09PWFbMF0mJighb3x8YVsxXT5vWzBdJiZhWzFdPG9bM10pKXtpLmxhYmVsPWFbMV07YnJlYWt9aWYoNj09PWFbMF0mJmkubGFiZWw8b1sxXSl7aS5sYWJlbD1vWzFdLG89YTticmVha31pZihvJiZpLmxhYmVsPG9bMl0pe2kubGFiZWw9b1syXSxpLm9wcy5wdXNoKGEpO2JyZWFrfW9bMl0mJmkub3BzLnBvcCgpLGkudHJ5cy5wb3AoKTtjb250aW51ZX1hPXQuY2FsbChlLGkpfWNhdGNoKGUpe2E9WzYsZV0scj0wfWZpbmFsbHl7bj1vPTB9aWYoNSZhWzBdKXRocm93IGFbMV07cmV0dXJue3ZhbHVlOmFbMF0/YVsxXTp2b2lkIDAsZG9uZTohMH19KFthLHNdKX19fSxocj1mdW5jdGlvbigpe2Zvcih2YXIgZT0wLHQ9MCxuPWFyZ3VtZW50cy5sZW5ndGg7dDxuO3QrKyllKz1hcmd1bWVudHNbdF0ubGVuZ3RoO3ZhciByPUFycmF5KGUpLG89MDtmb3IodD0wO3Q8bjt0KyspZm9yKHZhciBhPWFyZ3VtZW50c1t0XSxpPTAscz1hLmxlbmd0aDtpPHM7aSsrLG8rKylyW29dPWFbaV07cmV0dXJuIHJ9O2Z1bmN0aW9uIGZyKGUsdCxuLHIsbyxhLGkpe3RyeXt2YXIgcz1lW2FdKGkpLGw9cy52YWx1ZX1jYXRjaChlKXtyZXR1cm4gdm9pZCBuKGUpfXMuZG9uZT90KGwpOlByb21pc2UucmVzb2x2ZShsKS50aGVuKHIsbyl9ZnVuY3Rpb24gbXIoZSl7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIHQ9dGhpcyxuPWFyZ3VtZW50cztyZXR1cm4gbmV3IFByb21pc2UoKGZ1bmN0aW9uKHIsbyl7dmFyIGE9ZS5hcHBseSh0LG4pO2Z1bmN0aW9uIGkoZSl7ZnIoYSxyLG8saSxzLCJuZXh0IixlKX1mdW5jdGlvbiBzKGUpe2ZyKGEscixvLGkscywidGhyb3ciLGUpfWkodm9pZCAwKX0pKX19ZnVuY3Rpb24gZ3IoZSx0KXt2YXIgbj1PYmplY3Qua2V5cyhlKTtpZihPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgcj1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO3QmJihyPXIuZmlsdGVyKChmdW5jdGlvbih0KXtyZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihlLHQpLmVudW1lcmFibGV9KSkpLG4ucHVzaC5hcHBseShuLHIpfXJldHVybiBufWZ1bmN0aW9uIGJyKGUpe2Zvcih2YXIgdD0xO3Q8YXJndW1lbnRzLmxlbmd0aDt0Kyspe3ZhciBuPW51bGwhPWFyZ3VtZW50c1t0XT9hcmd1bWVudHNbdF06e307dCUyP2dyKE9iamVjdChuKSwhMCkuZm9yRWFjaCgoZnVuY3Rpb24odCl7eXIoZSx0LG5bdF0pfSkpOk9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzP09iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGUsT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMobikpOmdyKE9iamVjdChuKSkuZm9yRWFjaCgoZnVuY3Rpb24odCl7T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsdCxPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG4sdCkpfSkpfXJldHVybiBlfWZ1bmN0aW9uIHlyKGUsdCxuKXtyZXR1cm4gdCBpbiBlP09iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHQse3ZhbHVlOm4sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITAsd3JpdGFibGU6ITB9KTplW3RdPW4sZX12YXIgdnI9ZnVuY3Rpb24oZSl7cmV0dXJuIGZ1bmN0aW9uKHQpe09iamVjdChELnVuc3RhYmxlX2JhdGNoZWRVcGRhdGVzKShlLHQpfX0sa3I9bmV3IEksd3I9ITEsU3I9MCxFcj0wLE9yPTAsQ3I9ITEseHI9ITEsanI9ITEsVHI9e2hvcml6b250YWw6bnVsbCx2ZXJ0aWNhbDpudWxsfSxQcj0wLEFyPSExLE1yPW51bGwsX3I9e3BvaW50ZXJzOm5ldyBNYXAsbGFzdENlbnRlcjpudWxsLGluaXRpYWxEaXN0YW5jZTpudWxsLGluaXRpYWxTY2FsZTpudWxsfSx6cj1mdW5jdGlvbihlKXtmdW5jdGlvbiB0KHQpe3ZhciBuLHI9dGhpcztyPWUuY2FsbCh0aGlzLHQpfHx0aGlzLG49cixMci5jYWxsKHIpO3ZhciBvLGk9T2JqZWN0KHJ0LmMpKCksbD10LndpZHRoLGM9dC5oZWlnaHQsdT10Lm9wdGlvbnMsZD11Lnplbk1vZGVFbmFibGVkLHA9dS52aWV3QmFja2dyb3VuZENvbG9yLGg9dC51c2VyO3JldHVybiByLnN0YXRlPWJyKGJyKHt9LGkpLHt9LHtpc0xvYWRpbmc6ITAsd2lkdGg6bCxoZWlnaHQ6Yyx6ZW5Nb2RlRW5hYmxlZDpkLHZpZXdCYWNrZ3JvdW5kQ29sb3I6cCx1c2VybmFtZTpoLm5hbWV8fCIifSxyLmdldENhbnZhc09mZnNldHMoKSksci5zY2VuZT1uZXcgdXIuYSxyLmV4Y2FsaWRyYXdSZWY9YS5hLmNyZWF0ZVJlZigpLHIuYWN0aW9uTWFuYWdlcj1uZXcgVyhyLnN5bmNBY3Rpb25SZXN1bHQsKGZ1bmN0aW9uKCl7cmV0dXJuIG4uc3RhdGV9KSwoZnVuY3Rpb24oKXtyZXR1cm4gbi5zY2VuZS5nZXRFbGVtZW50c0luY2x1ZGluZ0RlbGV0ZWQoKX0pKSxyLmFjdGlvbk1hbmFnZXIucmVnaXN0ZXJBbGwod2UpLHIuYWN0aW9uTWFuYWdlci5yZWdpc3RlckFjdGlvbigobz1rcix7bmFtZToidW5kbyIscGVyZm9ybTpmdW5jdGlvbihlLHQpe3JldHVybiBKdChlLHQsKGZ1bmN0aW9uKCl7cmV0dXJuIG8udW5kb09uY2UoKX0pKX0sa2V5VGVzdDokdCghMSksUGFuZWxDb21wb25lbnQ6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS51cGRhdGVEYXRhO3JldHVybiBhLmEuY3JlYXRlRWxlbWVudChVLHt0eXBlOiJidXR0b24iLGljb246YWUsImFyaWEtbGFiZWwiOk9iamVjdChzLmUpKCJidXR0b25zLnVuZG8iKSxvbkNsaWNrOnR9KX0sY29tbWl0VG9IaXN0b3J5OmZ1bmN0aW9uKCl7cmV0dXJuITF9fSkpLHIuYWN0aW9uTWFuYWdlci5yZWdpc3RlckFjdGlvbihmdW5jdGlvbihlKXtyZXR1cm57bmFtZToicmVkbyIscGVyZm9ybTpmdW5jdGlvbih0LG4pe3JldHVybiBKdCh0LG4sKGZ1bmN0aW9uKCl7cmV0dXJuIGUucmVkb09uY2UoKX0pKX0sa2V5VGVzdDokdCghMCksUGFuZWxDb21wb25lbnQ6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS51cGRhdGVEYXRhO3JldHVybiBhLmEuY3JlYXRlRWxlbWVudChVLHt0eXBlOiJidXR0b24iLGljb246aWUsImFyaWEtbGFiZWwiOk9iamVjdChzLmUpKCJidXR0b25zLnJlZG8iKSxvbkNsaWNrOnR9KX0sY29tbWl0VG9IaXN0b3J5OmZ1bmN0aW9uKCl7cmV0dXJuITF9fX0oa3IpKSxyfXJldHVybiBkcih0LGUpLHQucHJvdG90eXBlLnJlbmRlcj1mdW5jdGlvbigpe3ZhciBlPXRoaXMsdD10aGlzLnN0YXRlLG49dC56ZW5Nb2RlRW5hYmxlZCxyPXQud2lkdGgsbz10LmhlaWdodCxpPXQub2Zmc2V0VG9wLGw9dC5vZmZzZXRMZWZ0LGM9dGhpcy5wcm9wcy5vblVzZXJuYW1lQ2hhbmdlLHU9d2luZG93LmRldmljZVBpeGVsUmF0aW8sZD1yKnUscD1vKnU7cmV0dXJuIGEuYS5jcmVhdGVFbGVtZW50KCJkaXYiLHtjbGFzc05hbWU6ImV4Y2FsaWRyYXciLHJlZjp0aGlzLmV4Y2FsaWRyYXdSZWYsc3R5bGU6e3dpZHRoOnIsaGVpZ2h0Om8sdG9wOmksbGVmdDpsfX0sYS5hLmNyZWF0ZUVsZW1lbnQoYXIse2NhbnZhczp0aGlzLmNhbnZhcyxhcHBTdGF0ZTp0aGlzLnN0YXRlLHNldEFwcFN0YXRlOnRoaXMuc2V0QXBwU3RhdGUsYWN0aW9uTWFuYWdlcjp0aGlzLmFjdGlvbk1hbmFnZXIsZWxlbWVudHM6dGhpcy5zY2VuZS5nZXRFbGVtZW50cygpLG9uUm9vbUNyZWF0ZTp0aGlzLm9wZW5Qb3J0YWwsb25Sb29tRGVzdHJveTp0aGlzLmNsb3NlUG9ydGFsLG9uVXNlcm5hbWVDaGFuZ2U6ZnVuY3Rpb24odCl7YyYmYyh0KSxlLnNldFN0YXRlKHt1c2VybmFtZTp0fSl9LG9uTG9ja1RvZ2dsZTp0aGlzLnRvZ2dsZUxvY2ssb25JbnNlcnRTaGFwZTpmdW5jdGlvbih0KXtyZXR1cm4gZS5hZGRFbGVtZW50c0Zyb21QYXN0ZU9yTGlicmFyeSh0KX0semVuTW9kZUVuYWJsZWQ6bix0b2dnbGVaZW5Nb2RlOnRoaXMudG9nZ2xlWmVuTW9kZSxsbmc6T2JqZWN0KHMuYSkoKS5sbmd9KSxhLmEuY3JlYXRlRWxlbWVudCgibWFpbiIsbnVsbCxhLmEuY3JlYXRlRWxlbWVudCgiY2FudmFzIix7aWQ6ImNhbnZhcyIsc3R5bGU6e3dpZHRoOnIsaGVpZ2h0Om99LHdpZHRoOmQsaGVpZ2h0OnAscmVmOnRoaXMuaGFuZGxlQ2FudmFzUmVmLG9uQ29udGV4dE1lbnU6dGhpcy5oYW5kbGVDYW52YXNDb250ZXh0TWVudSxvblBvaW50ZXJEb3duOnRoaXMuaGFuZGxlQ2FudmFzUG9pbnRlckRvd24sb25Eb3VibGVDbGljazp0aGlzLmhhbmRsZUNhbnZhc0RvdWJsZUNsaWNrLG9uUG9pbnRlck1vdmU6dGhpcy5oYW5kbGVDYW52YXNQb2ludGVyTW92ZSxvblBvaW50ZXJVcDp0aGlzLnJlbW92ZVBvaW50ZXIsb25Qb2ludGVyQ2FuY2VsOnRoaXMucmVtb3ZlUG9pbnRlcixvblRvdWNoTW92ZTp0aGlzLmhhbmRsZVRvdWNoTW92ZSxvbkRyb3A6dGhpcy5oYW5kbGVDYW52YXNPbkRyb3B9LE9iamVjdChzLmUpKCJsYWJlbHMuZHJhd2luZ0NhbnZhcyIpKSkpfSx0LnByb3RvdHlwZS5zaG91bGRGb3JjZUxvYWRTY2VuZT1mdW5jdGlvbihlKXtpZighZS5lbGVtZW50cy5sZW5ndGgpcmV0dXJuITA7dmFyIHQsbj1PYmplY3QoZy5mKSh3aW5kb3cubG9jYXRpb24uaHJlZik7aWYoIW4pcmV0dXJuITE7dHJ5e3ZhciByO3Q9bnVsbD09PShyPWxvY2FsU3RvcmFnZSl8fHZvaWQgMD09PXI/dm9pZCAwOnIuZ2V0SXRlbShiLnEpfWNhdGNoKGUpe31pZih0KXRyeXt2YXIgbz1KU09OLnBhcnNlKHQpLGE9by5yb29tLGk9by50aW1lc3RhbXA7aWYoYT09PW5bMV0mJkRhdGUubm93KCktaTwxNWUzKXJldHVybiEwfWNhdGNoKGUpe31yZXR1cm4hMX0sdC5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQ9ZnVuY3Rpb24oKXt2YXIgZT10aGlzO3JldHVybiBtcigoZnVuY3Rpb24oKXtyZXR1cm4gcHIodGhpcywoZnVuY3Rpb24odCl7cmV0dXJuInByb2R1Y3Rpb24iIT09Yi5sLlRFU1QmJiJwcm9kdWN0aW9uIiE9PWIubC5ERVZFTE9QTUVOVHx8KGUuc2V0U3RhdGUuYmluZChlKSxPYmplY3QuZGVmaW5lUHJvcGVydGllcyh3aW5kb3cuaCx7c3RhdGU6e2NvbmZpZ3VyYWJsZTohMCxnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gZS5zdGF0ZX19LHNldFN0YXRlOntjb25maWd1cmFibGU6ITAsdmFsdWU6ZnVuY3Rpb24oKXtmb3IodmFyIHQ9W10sbj0wO248YXJndW1lbnRzLmxlbmd0aDtuKyspdFtuXT1hcmd1bWVudHNbbl07cmV0dXJuIGUuc2V0U3RhdGUuYXBwbHkoZSx0KX19LGFwcDp7Y29uZmlndXJhYmxlOiEwLHZhbHVlOmV9fSkpLGUuc2NlbmUuYWRkQ2FsbGJhY2soZS5vblNjZW5lVXBkYXRlZCksZS5hZGRFdmVudExpc3RlbmVycygpLGUuc2V0U3RhdGUoZS5nZXRDYW52YXNPZmZzZXRzKCksKGZ1bmN0aW9uKCl7ZS5pbml0aWFsaXplU2NlbmUoKX0pKSxbMl19KSl9KSkoKX0sdC5wcm90b3R5cGUuY29tcG9uZW50V2lsbFVubW91bnQ9ZnVuY3Rpb24oKXt0aGlzLnVubW91bnRlZD0hMCx0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXJzKCksdGhpcy5zY2VuZS5kZXN0cm95KCksY2xlYXJUaW1lb3V0KFByKX0sdC5wcm90b3R5cGUucmVtb3ZlRXZlbnRMaXN0ZW5lcnM9ZnVuY3Rpb24oKXtkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKGIubS5DT1BZLHRoaXMub25Db3B5KSxkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKGIubS5QQVNURSx0aGlzLnBhc3RlRnJvbUNsaXBib2FyZCksZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihiLm0uQ1VULHRoaXMub25DdXQpLGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoYi5tLktFWURPV04sdGhpcy5vbktleURvd24sITEpLGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoYi5tLk1PVVNFX01PVkUsdGhpcy51cGRhdGVDdXJyZW50Q3Vyc29yUG9zaXRpb24sITEpLGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoYi5tLktFWVVQLHRoaXMub25LZXlVcCksd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoYi5tLlJFU0laRSx0aGlzLm9uUmVzaXplLCExKSx3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihiLm0uVU5MT0FELHRoaXMub25VbmxvYWQsITEpLHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKGIubS5CTFVSLHRoaXMub25CbHVyLCExKSx3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihiLm0uRFJBR19PVkVSLHRoaXMuZGlzYWJsZUV2ZW50LCExKSx3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihiLm0uRFJPUCx0aGlzLmRpc2FibGVFdmVudCwhMSksd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoYi5tLkhBU0hDSEFOR0UsdGhpcy5vbkhhc2hDaGFuZ2UsITEpLGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoYi5tLkdFU1RVUkVfU1RBUlQsdGhpcy5vbkdlc3R1cmVTdGFydCwhMSksZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihiLm0uR0VTVFVSRV9DSEFOR0UsdGhpcy5vbkdlc3R1cmVDaGFuZ2UsITEpLGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoYi5tLkdFU1RVUkVfRU5ELHRoaXMub25HZXN0dXJlRW5kLCExKSx3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihiLm0uQkVGT1JFX1VOTE9BRCx0aGlzLmJlZm9yZVVubG9hZCl9LHQucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXJzPWZ1bmN0aW9uKCl7dmFyIGUsdDtkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKGIubS5DT1BZLHRoaXMub25Db3B5KSxkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKGIubS5QQVNURSx0aGlzLnBhc3RlRnJvbUNsaXBib2FyZCksZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihiLm0uQ1VULHRoaXMub25DdXQpLGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoYi5tLktFWURPV04sdGhpcy5vbktleURvd24sITEpLGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoYi5tLktFWVVQLHRoaXMub25LZXlVcCx7cGFzc2l2ZTohMH0pLGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoYi5tLk1PVVNFX01PVkUsdGhpcy51cGRhdGVDdXJyZW50Q3Vyc29yUG9zaXRpb24pLHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKGIubS5SRVNJWkUsdGhpcy5vblJlc2l6ZSwhMSksd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoYi5tLlVOTE9BRCx0aGlzLm9uVW5sb2FkLCExKSx3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihiLm0uQkxVUix0aGlzLm9uQmx1ciwhMSksd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoYi5tLkRSQUdfT1ZFUix0aGlzLmRpc2FibGVFdmVudCwhMSksd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoYi5tLkRST1AsdGhpcy5kaXNhYmxlRXZlbnQsITEpLHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKGIubS5IQVNIQ0hBTkdFLHRoaXMub25IYXNoQ2hhbmdlLCExKSxudWxsPT09KGU9ZG9jdW1lbnQuZm9udHMpfHx2b2lkIDA9PT1lfHxudWxsPT09KHQ9ZS5hZGRFdmVudExpc3RlbmVyKXx8dm9pZCAwPT09dHx8dC5jYWxsKGUsImxvYWRpbmdkb25lIix0aGlzLm9uRm9udExvYWRlZCksZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihiLm0uR0VTVFVSRV9TVEFSVCx0aGlzLm9uR2VzdHVyZVN0YXJ0LCExKSxkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKGIubS5HRVNUVVJFX0NIQU5HRSx0aGlzLm9uR2VzdHVyZUNoYW5nZSwhMSksZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihiLm0uR0VTVFVSRV9FTkQsdGhpcy5vbkdlc3R1cmVFbmQsITEpLHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKGIubS5CRUZPUkVfVU5MT0FELHRoaXMuYmVmb3JlVW5sb2FkKX0sdC5wcm90b3R5cGUuY29tcG9uZW50RGlkVXBkYXRlPWZ1bmN0aW9uKGUpe3ZhciB0LG49dGhpcyxyPWUud2lkdGgsbz1lLmhlaWdodCxhPXRoaXMucHJvcHMsaT1hLndpZHRoLHM9YS5oZWlnaHQsbD1hLm9uQ2hhbmdlO3I9PT1pJiZvPT09c3x8dGhpcy5zZXRTdGF0ZShicih7d2lkdGg6aSxoZWlnaHQ6c30sdGhpcy5nZXRDYW52YXNPZmZzZXRzKCkpKSx0aGlzLnN0YXRlLmlzQ29sbGFib3JhdGluZyYmIXRoaXMucG9ydGFsLnNvY2tldCYmdGhpcy5pbml0aWFsaXplU29ja2V0Q2xpZW50KHtzaG93TG9hZGluZ1N0YXRlOiEwfSksdGhpcy5zdGF0ZS5lZGl0aW5nTGluZWFyRWxlbWVudCYmIXRoaXMuc3RhdGUuc2VsZWN0ZWRFbGVtZW50SWRzW3RoaXMuc3RhdGUuZWRpdGluZ0xpbmVhckVsZW1lbnQuZWxlbWVudElkXSYmc2V0VGltZW91dCgoZnVuY3Rpb24oKXtuLmFjdGlvbk1hbmFnZXIuZXhlY3V0ZUFjdGlvbih2dCl9KSk7dmFyIGM9e30sdT17fSxkPXt9LHA9e307dGhpcy5zdGF0ZS5jb2xsYWJvcmF0b3JzLmZvckVhY2goKGZ1bmN0aW9uKGUsdCl7aWYoZS5zZWxlY3RlZEVsZW1lbnRJZHMpZm9yKHZhciByPTAsbz1PYmplY3Qua2V5cyhlLnNlbGVjdGVkRWxlbWVudElkcyk7cjxvLmxlbmd0aDtyKyspe3ZhciBhPW9bcl07YSBpbiBkfHwoZFthXT1bXSksZFthXS5wdXNoKHQpfWUucG9pbnRlciYmKGUudXNlcm5hbWUmJihwW3RdPWUudXNlcm5hbWUpLHVbdF09T2JqZWN0KE8udSkoe3NjZW5lWDplLnBvaW50ZXIueCxzY2VuZVk6ZS5wb2ludGVyLnl9LG4uc3RhdGUsbi5jYW52YXMsd2luZG93LmRldmljZVBpeGVsUmF0aW8pLGNbdF09ZS5idXR0b24pfSkpO3ZhciBoPXRoaXMuc2NlbmUuZ2V0RWxlbWVudHMoKSxtPU9iamVjdChTLmEpKGguZmlsdGVyKChmdW5jdGlvbihlKXtyZXR1cm4hbi5zdGF0ZS5lZGl0aW5nRWxlbWVudHx8InRleHQiIT09bi5zdGF0ZS5lZGl0aW5nRWxlbWVudC50eXBlfHxlLmlkIT09bi5zdGF0ZS5lZGl0aW5nRWxlbWVudC5pZH0pKSx0aGlzLnN0YXRlLHRoaXMuc3RhdGUuc2VsZWN0aW9uRWxlbWVudCx3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyx0aGlzLnJjLHRoaXMuY2FudmFzLHtzY3JvbGxYOnRoaXMuc3RhdGUuc2Nyb2xsWCxzY3JvbGxZOnRoaXMuc3RhdGUuc2Nyb2xsWSx2aWV3QmFja2dyb3VuZENvbG9yOnRoaXMuc3RhdGUudmlld0JhY2tncm91bmRDb2xvcix6b29tOnRoaXMuc3RhdGUuem9vbSxyZW1vdGVQb2ludGVyVmlld3BvcnRDb29yZHM6dSxyZW1vdGVQb2ludGVyQnV0dG9uOmMscmVtb3RlU2VsZWN0ZWRFbGVtZW50SWRzOmQscmVtb3RlUG9pbnRlclVzZXJuYW1lczpwLHNob3VsZENhY2hlSWdub3JlWm9vbTp0aGlzLnN0YXRlLnNob3VsZENhY2hlSWdub3JlWm9vbX0se3JlbmRlck9wdGltaXphdGlvbnM6ITB9KSxnPW0uYXRMZWFzdE9uZVZpc2libGVFbGVtZW50LHk9bS5zY3JvbGxCYXJzO3kmJihUcj15KTt2YXIgdj0idGV4dCIhPT0obnVsbD09PSh0PXRoaXMuc3RhdGUuZWRpdGluZ0VsZW1lbnQpfHx2b2lkIDA9PT10P3ZvaWQgMDp0LnR5cGUpJiYoIWcmJmgubGVuZ3RoPjApO3RoaXMuc3RhdGUuc2Nyb2xsZWRPdXRzaWRlIT09diYmdGhpcy5zZXRTdGF0ZSh7c2Nyb2xsZWRPdXRzaWRlOnZ9KSxsJiZsKHRoaXMuc2NlbmUuZ2V0RWxlbWVudHNJbmNsdWRpbmdEZWxldGVkKCksdGhpcy5zdGF0ZSksT2JqZWN0KGYuaSkodGhpcy5zY2VuZS5nZXRFbGVtZW50c0luY2x1ZGluZ0RlbGV0ZWQoKSk+dGhpcy5sYXN0QnJvYWRjYXN0ZWRPclJlY2VpdmVkU2NlbmVWZXJzaW9uJiYodGhpcy5icm9hZGNhc3RTY2VuZShiLnMuVVBEQVRFLCExKSx0aGlzLnF1ZXVlQnJvYWRjYXN0QWxsRWxlbWVudHMoKSksa3IucmVjb3JkKHRoaXMuc3RhdGUsdGhpcy5zY2VuZS5nZXRFbGVtZW50c0luY2x1ZGluZ0RlbGV0ZWQoKSl9LHQucmVzZXRUYXBUd2ljZT1mdW5jdGlvbigpe3dyPSExfSx0LnByb3RvdHlwZS5hZGRUZXh0RnJvbVBhc3RlPWZ1bmN0aW9uKGUpe3ZhciB0LG49T2JqZWN0KE8ueSkoe2NsaWVudFg6RXIsY2xpZW50WTpPcn0sdGhpcy5zdGF0ZSx0aGlzLmNhbnZhcyx3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbykscj1uLngsbz1uLnksYT1PYmplY3QoZi5EKSh7eDpyLHk6byxzdHJva2VDb2xvcjp0aGlzLnN0YXRlLmN1cnJlbnRJdGVtU3Ryb2tlQ29sb3IsYmFja2dyb3VuZENvbG9yOnRoaXMuc3RhdGUuY3VycmVudEl0ZW1CYWNrZ3JvdW5kQ29sb3IsZmlsbFN0eWxlOnRoaXMuc3RhdGUuY3VycmVudEl0ZW1GaWxsU3R5bGUsc3Ryb2tlV2lkdGg6dGhpcy5zdGF0ZS5jdXJyZW50SXRlbVN0cm9rZVdpZHRoLHN0cm9rZVN0eWxlOnRoaXMuc3RhdGUuY3VycmVudEl0ZW1TdHJva2VTdHlsZSxyb3VnaG5lc3M6dGhpcy5zdGF0ZS5jdXJyZW50SXRlbVJvdWdobmVzcyxvcGFjaXR5OnRoaXMuc3RhdGUuY3VycmVudEl0ZW1PcGFjaXR5LHRleHQ6ZSxmb250U2l6ZTp0aGlzLnN0YXRlLmN1cnJlbnRJdGVtRm9udFNpemUsZm9udEZhbWlseTp0aGlzLnN0YXRlLmN1cnJlbnRJdGVtRm9udEZhbWlseSx0ZXh0QWxpZ246dGhpcy5zdGF0ZS5jdXJyZW50SXRlbVRleHRBbGlnbix2ZXJ0aWNhbEFsaWduOmIuaH0pO3RoaXMuc2NlbmUucmVwbGFjZUFsbEVsZW1lbnRzKGhyKHRoaXMuc2NlbmUuZ2V0RWxlbWVudHNJbmNsdWRpbmdEZWxldGVkKCksW2FdKSksdGhpcy5zZXRTdGF0ZSh7c2VsZWN0ZWRFbGVtZW50SWRzOih0PXt9LHRbYS5pZF09ITAsdCl9KSxrci5yZXN1bWVSZWNvcmRpbmcoKX0sdC5wcm90b3R5cGUuc2V0Q29sbGFib3JhdG9ycz1mdW5jdGlvbihlKXt0aGlzLnNldFN0YXRlKChmdW5jdGlvbih0KXtmb3IodmFyIG49bmV3IE1hcCxyPTAsbz1lO3I8by5sZW5ndGg7cisrKXt2YXIgYT1vW3JdO3QuY29sbGFib3JhdG9ycy5oYXMoYSk/bi5zZXQoYSx0LmNvbGxhYm9yYXRvcnMuZ2V0KGEpKTpuLnNldChhLHt9KX1yZXR1cm4gYnIoYnIoe30sdCkse30se2NvbGxhYm9yYXRvcnM6bn0pfSkpfSx0LnByb3RvdHlwZS5zZWxlY3RTaGFwZVRvb2w9ZnVuY3Rpb24oZSl7Q3J8fE9iamVjdChPLncpKGUpLE9iamVjdChPLm8pKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQpJiZkb2N1bWVudC5hY3RpdmVFbGVtZW50LmJsdXIoKSwic2VsZWN0aW9uIiE9PWU/dGhpcy5zZXRTdGF0ZSh7ZWxlbWVudFR5cGU6ZSxzZWxlY3RlZEVsZW1lbnRJZHM6e30sc2VsZWN0ZWRHcm91cElkczp7fSxlZGl0aW5nR3JvdXBJZDpudWxsfSk6dGhpcy5zZXRTdGF0ZSh7ZWxlbWVudFR5cGU6ZX0pfSx0LnByb3RvdHlwZS5oYW5kbGVUZXh0V3lzaXd5Zz1mdW5jdGlvbihlLHQpe3ZhciBuPXQuaXNFeGlzdGluZ0VsZW1lbnQscj12b2lkIDAhPT1uJiZuLG89dGhpcyxhPWZ1bmN0aW9uKHQsbil7dm9pZCAwPT09biYmKG49ITEpLG8uc2NlbmUucmVwbGFjZUFsbEVsZW1lbnRzKGhyKG8uc2NlbmUuZ2V0RWxlbWVudHNJbmNsdWRpbmdEZWxldGVkKCkubWFwKChmdW5jdGlvbihyKXtyZXR1cm4gci5pZD09PWUuaWQmJk9iamVjdChmLkEpKHIpP09iamVjdChmLkkpKHIse3RleHQ6dCxpc0RlbGV0ZWQ6bn0pOnJ9KSkpKX07T2JqZWN0KGYuSCkoe2lkOmUuaWQsYXBwU3RhdGU6dGhpcy5zdGF0ZSxnZXRWaWV3cG9ydENvb3JkczpmdW5jdGlvbihlLHQpe3ZhciBuPU9iamVjdChPLnUpKHtzY2VuZVg6ZSxzY2VuZVk6dH0sby5zdGF0ZSxvLmNhbnZhcyx3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyk7cmV0dXJuW24ueCxuLnldfSxvbkNoYW5nZTp2cigoZnVuY3Rpb24oZSl7YShlKX0pKSxvblN1Ym1pdDp2cigoZnVuY3Rpb24odCl7dmFyIG49IXQudHJpbSgpO2EodCxuKSxufHxvLnNldFN0YXRlKChmdW5jdGlvbih0KXt2YXIgbjtyZXR1cm57c2VsZWN0ZWRFbGVtZW50SWRzOmJyKGJyKHt9LHQuc2VsZWN0ZWRFbGVtZW50SWRzKSx7fSwobj17fSxuW2UuaWRdPSEwLG4pKX19KSksbiYmIXJ8fGtyLnJlc3VtZVJlY29yZGluZygpLG8uc2V0U3RhdGUoe2RyYWdnaW5nRWxlbWVudDpudWxsLGVkaXRpbmdFbGVtZW50Om51bGx9KSxvLnN0YXRlLmVsZW1lbnRMb2NrZWQmJk9iamVjdChPLncpKG8uc3RhdGUuZWxlbWVudFR5cGUpfSkpLGVsZW1lbnQ6ZX0pLHRoaXMuc2V0U3RhdGUoe3NlbGVjdGVkRWxlbWVudElkczp7fSxzZWxlY3RlZEdyb3VwSWRzOnt9LGVkaXRpbmdHcm91cElkOm51bGx9KSxhKGUudGV4dCl9LHQucHJvdG90eXBlLmdldFRleHRFbGVtZW50QXRQb3NpdGlvbj1mdW5jdGlvbihlLHQpe3ZhciBuPU9iamVjdChtLmMpKHRoaXMuc2NlbmUuZ2V0RWxlbWVudHMoKSx0aGlzLnN0YXRlLGUsdCx0aGlzLnN0YXRlLnpvb20pO3JldHVybiBuJiZPYmplY3QoZi5BKShuKSYmIW4uaXNEZWxldGVkP246bnVsbH0sdC5wcm90b3R5cGUubWF5YmVDbGVhbnVwQWZ0ZXJNaXNzaW5nUG9pbnRlclVwPWZ1bmN0aW9uKGUpe251bGwhPT1NciYmTXIoZSl9LHQucHJvdG90eXBlLnVwZGF0ZUdlc3R1cmVPblBvaW50ZXJEb3duPWZ1bmN0aW9uKGUpe19yLnBvaW50ZXJzLnNldChlLnBvaW50ZXJJZCx7eDplLmNsaWVudFgseTplLmNsaWVudFl9KSwyPT09X3IucG9pbnRlcnMuc2l6ZSYmKF9yLmxhc3RDZW50ZXI9VnQoX3IucG9pbnRlcnMpLF9yLmluaXRpYWxTY2FsZT10aGlzLnN0YXRlLnpvb20sX3IuaW5pdGlhbERpc3RhbmNlPUt0KEFycmF5LmZyb20oX3IucG9pbnRlcnMudmFsdWVzKCkpKSl9LHQucHJvdG90eXBlLmluaXRpYWxQb2ludGVyRG93blN0YXRlPWZ1bmN0aW9uKGUpe3ZhciB0PU9iamVjdChPLnkpKGUsdGhpcy5zdGF0ZSx0aGlzLmNhbnZhcyx3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyksbj1PYmplY3QobS5nKSh0aGlzLnNjZW5lLmdldEVsZW1lbnRzKCksdGhpcy5zdGF0ZSkscj1PYmplY3QoZi5mKShuKSxvPXJbMF0sYT1yWzFdLGk9clsyXSxzPXJbM107cmV0dXJue29yaWdpbjp0LG9yaWdpbkluR3JpZDpPYmplY3QoTy54KShPYmplY3QoRS5lKSh0LngsdC55LHRoaXMuc3RhdGUuZ3JpZFNpemUpKSxzY3JvbGxiYXJzOk9iamVjdChtLm0pKFRyLGUuY2xpZW50WCxlLmNsaWVudFkpLGxhc3RDb29yZHM6YnIoe30sdCkscmVzaXplOntoYW5kbGU6ITEsaXNSZXNpemluZzohMSxvZmZzZXQ6e3g6MCx5OjB9LGFycm93RGlyZWN0aW9uOiJvcmlnaW4iLGNlbnRlcjp7eDooaStvKS8yLHk6KHMrYSkvMn0sb3JpZ2luYWxFbGVtZW50czpuLm1hcCgoZnVuY3Rpb24oZSl7cmV0dXJuIGJyKHt9LGUpfSkpfSxoaXQ6e2VsZW1lbnQ6bnVsbCx3YXNBZGRlZFRvU2VsZWN0aW9uOiExLGhhc0JlZW5EdXBsaWNhdGVkOiExfSxkcmFnOntoYXNPY2N1cnJlZDohMSxvZmZzZXQ6bnVsbH0sZXZlbnRMaXN0ZW5lcnM6e29uTW92ZTpudWxsLG9uVXA6bnVsbH19fSx0LnByb3RvdHlwZS5oYW5kbGVEcmFnZ2luZ1Njcm9sbEJhcj1mdW5jdGlvbihlLHQpe3ZhciBuPXRoaXM7aWYoIXQuc2Nyb2xsYmFycy5pc092ZXJFaXRoZXJ8fHRoaXMuc3RhdGUubXVsdGlFbGVtZW50KXJldHVybiExO2pyPSEwLHQubGFzdENvb3Jkcy54PWUuY2xpZW50WCx0Lmxhc3RDb29yZHMueT1lLmNsaWVudFk7dmFyIHI9dnIoKGZ1bmN0aW9uKGUpe2lmKGUudGFyZ2V0IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpe2lmKHQuc2Nyb2xsYmFycy5pc092ZXJIb3Jpem9udGFsKXt2YXIgcj1lLmNsaWVudFgsbz1yLXQubGFzdENvb3Jkcy54O3JldHVybiBuLnNldFN0YXRlKHtzY3JvbGxYOk9iamVjdChtLm8pKG4uc3RhdGUuc2Nyb2xsWC1vL24uc3RhdGUuem9vbSl9KSx2b2lkKHQubGFzdENvb3Jkcy54PXIpfWlmKHQuc2Nyb2xsYmFycy5pc092ZXJWZXJ0aWNhbCl7dmFyIGE9ZS5jbGllbnRZLGk9YS10Lmxhc3RDb29yZHMueTtuLnNldFN0YXRlKHtzY3JvbGxZOk9iamVjdChtLm8pKG4uc3RhdGUuc2Nyb2xsWS1pL24uc3RhdGUuem9vbSl9KSx0Lmxhc3RDb29yZHMueT1hfX19KSksbz12cigoZnVuY3Rpb24oKXtqcj0hMSxPYmplY3QoTy53KShuLnN0YXRlLmVsZW1lbnRUeXBlKSxNcj1udWxsLG4uc2V0U3RhdGUoe2N1cnNvckJ1dHRvbjoidXAifSksbi5zYXZlUG9pbnRlcihlLmNsaWVudFgsZS5jbGllbnRZLCJ1cCIpLHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKGIubS5QT0lOVEVSX01PVkUsciksd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoYi5tLlBPSU5URVJfVVAsbyl9KSk7cmV0dXJuIE1yPW8sd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoYi5tLlBPSU5URVJfTU9WRSxyKSx3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihiLm0uUE9JTlRFUl9VUCxvKSwhMH0sdC5wcm90b3R5cGUub25Qb2ludGVyTW92ZUZyb21Qb2ludGVyRG93bkhhbmRsZXI9ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcztyZXR1cm4gdnIoKGZ1bmN0aW9uKG4pe3ZhciByO2lmKG51bGw9PT1lLmRyYWcub2Zmc2V0JiYoZS5kcmFnLm9mZnNldD1PYmplY3QoTy54KShPYmplY3QoZi5oKShPYmplY3QobS5nKSh0LnNjZW5lLmdldEVsZW1lbnRzKCksdC5zdGF0ZSksZS5vcmlnaW4ueCxlLm9yaWdpbi55KSkpLG4udGFyZ2V0IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpe2lmKGUuc2Nyb2xsYmFycy5pc092ZXJIb3Jpem9udGFsKXt2YXIgbz1uLmNsaWVudFgsYT1vLWUubGFzdENvb3Jkcy54O3JldHVybiB0LnNldFN0YXRlKHtzY3JvbGxYOk9iamVjdChtLm8pKHQuc3RhdGUuc2Nyb2xsWC1hL3Quc3RhdGUuem9vbSl9KSx2b2lkKGUubGFzdENvb3Jkcy54PW8pfWlmKGUuc2Nyb2xsYmFycy5pc092ZXJWZXJ0aWNhbCl7dmFyIGk9bi5jbGllbnRZLHM9aS1lLmxhc3RDb29yZHMueTtyZXR1cm4gdC5zZXRTdGF0ZSh7c2Nyb2xsWTpPYmplY3QobS5vKSh0LnN0YXRlLnNjcm9sbFktcy90LnN0YXRlLnpvb20pfSksdm9pZChlLmxhc3RDb29yZHMueT1pKX12YXIgbD1PYmplY3QoTy55KShuLHQuc3RhdGUsdC5jYW52YXMsd2luZG93LmRldmljZVBpeGVsUmF0aW8pLGM9bC54LHU9bC55LGQ9T2JqZWN0KEUuZSkoYyx1LHQuc3RhdGUuZ3JpZFNpemUpLHA9ZFswXSxnPWRbMV07aWYoZS5kcmFnLmhhc09jY3VycmVkfHwiYXJyb3ciIT09dC5zdGF0ZS5lbGVtZW50VHlwZSYmImxpbmUiIT09dC5zdGF0ZS5lbGVtZW50VHlwZXx8IShPYmplY3QoRS5iKShjLHUsZS5vcmlnaW4ueCxlLm9yaWdpbi55KTxiLmkpKXtpZihlLnJlc2l6ZS5pc1Jlc2l6aW5nKXt2YXIgeT1PYmplY3QobS5nKSh0LnNjZW5lLmdldEVsZW1lbnRzKCksdC5zdGF0ZSksdj1lLnJlc2l6ZS5oYW5kbGU7dC5zZXRTdGF0ZSh7aXNSZXNpemluZzp2JiYicm90YXRpb24iIT09dixpc1JvdGF0aW5nOiJyb3RhdGlvbiI9PT12fSk7dmFyIGs9T2JqZWN0KEUuZSkoYy1lLnJlc2l6ZS5vZmZzZXQueCx1LWUucmVzaXplLm9mZnNldC55LHQuc3RhdGUuZ3JpZFNpemUpLHc9a1swXSxTPWtbMV07aWYoT2JqZWN0KGYuRikodiwoZnVuY3Rpb24odCl7ZS5yZXNpemUuaGFuZGxlPXR9KSx5LGUucmVzaXplLmFycm93RGlyZWN0aW9uLE9iamVjdChDLmQpKG4pLE9iamVjdChDLmMpKG4pLE9iamVjdChDLmIpKG4pLHcsUyxlLnJlc2l6ZS5jZW50ZXIueCxlLnJlc2l6ZS5jZW50ZXIueSxlLnJlc2l6ZS5vcmlnaW5hbEVsZW1lbnRzKSlyZXR1cm59aWYodC5zdGF0ZS5lZGl0aW5nTGluZWFyRWxlbWVudClpZihDZS5hLmhhbmRsZVBvaW50RHJhZ2dpbmcodC5zdGF0ZSwoZnVuY3Rpb24oZSl7cmV0dXJuIHQuc2V0U3RhdGUoZSl9KSxjLHUsZS5sYXN0Q29vcmRzLngsZS5sYXN0Q29vcmRzLnkpKXJldHVybiBlLmxhc3RDb29yZHMueD1jLHZvaWQoZS5sYXN0Q29vcmRzLnk9dSk7dmFyIHg9ZS5oaXQuZWxlbWVudDtpZih4JiZ0LnN0YXRlLnNlbGVjdGVkRWxlbWVudElkc1t4LmlkXSlpZihlLmRyYWcuaGFzT2NjdXJyZWQ9ITAsKHk9T2JqZWN0KG0uZykodC5zY2VuZS5nZXRFbGVtZW50cygpLHQuc3RhdGUpKS5sZW5ndGg+MCl7dmFyIGo9T2JqZWN0KEUuZSkoYy1lLmRyYWcub2Zmc2V0LngsdS1lLmRyYWcub2Zmc2V0LnksdC5zdGF0ZS5ncmlkU2l6ZSksUD1qWzBdLEE9alsxXTtpZihPYmplY3QoZi5jKSh5LFAsQSksbi5hbHRLZXkmJiFlLmhpdC5oYXNCZWVuRHVwbGljYXRlZCl7ZS5oaXQuaGFzQmVlbkR1cGxpY2F0ZWQ9ITA7Zm9yKHZhciBNPVtdLF89W10sej1uZXcgTWFwLEw9MCxJPXQuc2NlbmUuZ2V0RWxlbWVudHNJbmNsdWRpbmdEZWxldGVkKCk7TDxJLmxlbmd0aDtMKyspe3ZhciBEPUlbTF07aWYodC5zdGF0ZS5zZWxlY3RlZEVsZW1lbnRJZHNbRC5pZF18fEQuaWQ9PT14LmlkJiZlLmhpdC53YXNBZGRlZFRvU2VsZWN0aW9uKXt2YXIgTj1PYmplY3QoZi5kKSh0LnN0YXRlLmVkaXRpbmdHcm91cElkLHosRCksRj1PYmplY3QoRS5lKShlLm9yaWdpbi54LWUuZHJhZy5vZmZzZXQueCxlLm9yaWdpbi55LWUuZHJhZy5vZmZzZXQueSx0LnN0YXRlLmdyaWRTaXplKSxSPUZbMF0sQj1GWzFdO09iamVjdChFZS5hKShOLHt4Ok4ueCsoUi1QKSx5Ok4ueSsoQi1BKX0pLE0ucHVzaChOKSxfLnB1c2goRCl9ZWxzZSBNLnB1c2goRCl9dC5zY2VuZS5yZXBsYWNlQWxsRWxlbWVudHMoaHIoTSxfKSl9cmV0dXJufXZhciBIPXQuc3RhdGUuZHJhZ2dpbmdFbGVtZW50O2lmKEgpe2lmKE9iamVjdChULmIpKEgpKXtlLmRyYWcuaGFzT2NjdXJyZWQ9ITA7dmFyIEc9SC5wb2ludHM7YT12b2lkIDAscz12b2lkIDA7ImRyYXciPT09SC50eXBlPyhhPWMtSC54LHM9dS1ILnkpOihhPXAtSC54LHM9Zy1ILnkpLE9iamVjdChDLmQpKG4pJiYyPT09Ry5sZW5ndGgmJihhPShyPU9iamVjdChmLnApKHQuc3RhdGUuZWxlbWVudFR5cGUsYSxzKSkud2lkdGgscz1yLmhlaWdodCksMT09PUcubGVuZ3RoP09iamVjdChFZS5hKShILHtwb2ludHM6aHIoRyxbW2Esc11dKX0pOkcubGVuZ3RoPjEmJigiZHJhdyI9PT1ILnR5cGU/T2JqZWN0KEVlLmEpKEgse3BvaW50czpPYmplY3QoaC5iKShocihHLFtbYSxzXV0pLC43KX0pOk9iamVjdChFZS5hKShILHtwb2ludHM6aHIoRy5zbGljZSgwLC0xKSxbW2Esc11dKX0pKX1lbHNlInNlbGVjdGlvbiI9PT1ILnR5cGU/T2JqZWN0KGYuYikoSCx0LnN0YXRlLmVsZW1lbnRUeXBlLGUub3JpZ2luLngsZS5vcmlnaW4ueSxjLHUsT2JqZWN0KE8uZSkoZS5vcmlnaW4ueCxjKSxPYmplY3QoTy5lKShlLm9yaWdpbi55LHUpLE9iamVjdChDLmMpKG4pLE9iamVjdChDLmIpKG4pKTpPYmplY3QoZi5iKShILHQuc3RhdGUuZWxlbWVudFR5cGUsZS5vcmlnaW5JbkdyaWQueCxlLm9yaWdpbkluR3JpZC55LHAsZyxPYmplY3QoTy5lKShlLm9yaWdpbkluR3JpZC54LHApLE9iamVjdChPLmUpKGUub3JpZ2luSW5HcmlkLnksZyksT2JqZWN0KEMuYykobiksT2JqZWN0KEMuYikobikpO2lmKCJzZWxlY3Rpb24iPT09dC5zdGF0ZS5lbGVtZW50VHlwZSl7dmFyIFc9dC5zY2VuZS5nZXRFbGVtZW50cygpOyFuLnNoaWZ0S2V5JiZPYmplY3QobS5uKShXLHQuc3RhdGUpJiZ0LnNldFN0YXRlKHtzZWxlY3RlZEVsZW1lbnRJZHM6e30sc2VsZWN0ZWRHcm91cElkczp7fSxlZGl0aW5nR3JvdXBJZDpudWxsfSk7dmFyIFU9T2JqZWN0KG0uZSkoVyxIKTt0LnNldFN0YXRlKChmdW5jdGlvbihlKXtyZXR1cm4gT2JqZWN0KE9lLmopKGJyKGJyKHt9LGUpLHt9LHtzZWxlY3RlZEVsZW1lbnRJZHM6YnIoYnIoe30sZS5zZWxlY3RlZEVsZW1lbnRJZHMpLFUucmVkdWNlKChmdW5jdGlvbihlLHQpe3JldHVybiBlW3QuaWRdPSEwLGV9KSx7fSkpfSksdC5zY2VuZS5nZXRFbGVtZW50cygpKX0pKX19fX19KSl9LHQucHJvdG90eXBlLm9uUG9pbnRlclVwRnJvbVBvaW50ZXJEb3duSGFuZGxlcj1mdW5jdGlvbihlKXt2YXIgdD10aGlzO3JldHVybiB2cigoZnVuY3Rpb24obil7dmFyIHI9dC5zdGF0ZSxvPXIuZHJhZ2dpbmdFbGVtZW50LGE9ci5yZXNpemluZ0VsZW1lbnQsaT1yLm11bHRpRWxlbWVudCxzPXIuZWxlbWVudFR5cGUsbD1yLmVsZW1lbnRMb2NrZWQ7aWYodC5zZXRTdGF0ZSh7aXNSZXNpemluZzohMSxpc1JvdGF0aW5nOiExLHJlc2l6aW5nRWxlbWVudDpudWxsLHNlbGVjdGlvbkVsZW1lbnQ6bnVsbCxjdXJzb3JCdXR0b246InVwIixlZGl0aW5nRWxlbWVudDppfHxPYmplY3QoZi5BKSh0LnN0YXRlLmVkaXRpbmdFbGVtZW50KT90LnN0YXRlLmVkaXRpbmdFbGVtZW50Om51bGx9KSx0LnNhdmVQb2ludGVyKG4uY2xpZW50WCxuLmNsaWVudFksInVwIiksdC5zdGF0ZS5lZGl0aW5nTGluZWFyRWxlbWVudCl7dmFyIGM9Q2UuYS5oYW5kbGVQb2ludGVyVXAodC5zdGF0ZS5lZGl0aW5nTGluZWFyRWxlbWVudCk7YyE9PXQuc3RhdGUuZWRpdGluZ0xpbmVhckVsZW1lbnQmJnQuc2V0U3RhdGUoe2VkaXRpbmdMaW5lYXJFbGVtZW50OmN9KX1pZihNcj1udWxsLHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKGIubS5QT0lOVEVSX01PVkUsZS5ldmVudExpc3RlbmVycy5vbk1vdmUpLHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKGIubS5QT0lOVEVSX1VQLGUuZXZlbnRMaXN0ZW5lcnMub25VcCksImRyYXciIT09KG51bGw9PW8/dm9pZCAwOm8udHlwZSkpaWYoT2JqZWN0KFQuYikobykpaWYoby5wb2ludHMubGVuZ3RoPjEmJmtyLnJlc3VtZVJlY29yZGluZygpLGUuZHJhZy5oYXNPY2N1cnJlZHx8IW98fGkpZS5kcmFnLmhhc09jY3VycmVkJiYhaSYmKGw/dC5zZXRTdGF0ZSgoZnVuY3Rpb24oZSl7dmFyIG47cmV0dXJue2RyYWdnaW5nRWxlbWVudDpudWxsLHNlbGVjdGVkRWxlbWVudElkczpicihicih7fSxlLnNlbGVjdGVkRWxlbWVudElkcykse30sKG49e30sblt0LnN0YXRlLmRyYWdnaW5nRWxlbWVudC5pZF09ITAsbikpfX0pKTooT2JqZWN0KE8udCkoKSx0LnNldFN0YXRlKChmdW5jdGlvbihlKXt2YXIgbjtyZXR1cm57ZHJhZ2dpbmdFbGVtZW50Om51bGwsZWxlbWVudFR5cGU6InNlbGVjdGlvbiIsc2VsZWN0ZWRFbGVtZW50SWRzOmJyKGJyKHt9LGUuc2VsZWN0ZWRFbGVtZW50SWRzKSx7fSwobj17fSxuW3Quc3RhdGUuZHJhZ2dpbmdFbGVtZW50LmlkXT0hMCxuKSl9fSkpKSk7ZWxzZXt2YXIgdT1PYmplY3QoTy55KShuLHQuc3RhdGUsdC5jYW52YXMsd2luZG93LmRldmljZVBpeGVsUmF0aW8pLGQ9dS54LHA9dS55O09iamVjdChFZS5hKShvLHtwb2ludHM6aHIoby5wb2ludHMsW1tkLW8ueCxwLW8ueV1dKX0pLHQuc2V0U3RhdGUoe211bHRpRWxlbWVudDpvLGVkaXRpbmdFbGVtZW50OnQuc3RhdGUuZHJhZ2dpbmdFbGVtZW50fSl9ZWxzZXtpZigic2VsZWN0aW9uIiE9PXMmJm8mJk9iamVjdChmLnkpKG8pKXJldHVybiB0LnNjZW5lLnJlcGxhY2VBbGxFbGVtZW50cyh0LnNjZW5lLmdldEVsZW1lbnRzSW5jbHVkaW5nRGVsZXRlZCgpLnNsaWNlKDAsLTEpKSx2b2lkIHQuc2V0U3RhdGUoe2RyYWdnaW5nRWxlbWVudDpudWxsfSk7byYmT2JqZWN0KEVlLmEpKG8sT2JqZWN0KGYubykobykpLGEmJmtyLnJlc3VtZVJlY29yZGluZygpLGEmJk9iamVjdChmLnkpKGEpJiZ0LnNjZW5lLnJlcGxhY2VBbGxFbGVtZW50cyh0LnNjZW5lLmdldEVsZW1lbnRzSW5jbHVkaW5nRGVsZXRlZCgpLmZpbHRlcigoZnVuY3Rpb24oZSl7cmV0dXJuIGUuaWQhPT1hLmlkfSkpKTt2YXIgaD1lLmhpdC5lbGVtZW50OzAhPT1PYmplY3QoT2UuZSkodC5zdGF0ZSkubGVuZ3RofHwhaHx8ZS5kcmFnLmhhc09jY3VycmVkfHxlLmhpdC53YXNBZGRlZFRvU2VsZWN0aW9ufHwobi5zaGlmdEtleT90LnNldFN0YXRlKChmdW5jdGlvbihlKXt2YXIgdDtyZXR1cm57c2VsZWN0ZWRFbGVtZW50SWRzOmJyKGJyKHt9LGUuc2VsZWN0ZWRFbGVtZW50SWRzKSx7fSwodD17fSx0W2guaWRdPSExLHQpKX19KSk6dC5zZXRTdGF0ZSgoZnVuY3Rpb24oZSl7dmFyIHQ7cmV0dXJue3NlbGVjdGVkRWxlbWVudElkczoodD17fSx0W2guaWRdPSEwLHQpfX0pKSksbnVsbCE9PW8/KGx8fHQuc2V0U3RhdGUoKGZ1bmN0aW9uKGUpe3ZhciB0O3JldHVybntzZWxlY3RlZEVsZW1lbnRJZHM6YnIoYnIoe30sZS5zZWxlY3RlZEVsZW1lbnRJZHMpLHt9LCh0PXt9LHRbby5pZF09ITAsdCkpfX0pKSwoInNlbGVjdGlvbiIhPT1zfHxPYmplY3QobS5uKSh0LnNjZW5lLmdldEVsZW1lbnRzKCksdC5zdGF0ZSkpJiZrci5yZXN1bWVSZWNvcmRpbmcoKSxsP3Quc2V0U3RhdGUoe2RyYWdnaW5nRWxlbWVudDpudWxsfSk6KE9iamVjdChPLnQpKCksdC5zZXRTdGF0ZSh7ZHJhZ2dpbmdFbGVtZW50Om51bGwsZWxlbWVudFR5cGU6InNlbGVjdGlvbiJ9KSkpOnQuc2V0U3RhdGUoe3NlbGVjdGVkRWxlbWVudElkczp7fSxzZWxlY3RlZEdyb3VwSWRzOnt9LGVkaXRpbmdHcm91cElkOm51bGx9KX1lbHNlIHQuYWN0aW9uTWFuYWdlci5leGVjdXRlQWN0aW9uKHZ0KX0pKX0sdC5wcm90b3R5cGUubWF5YmVDbGVhclNlbGVjdGlvbldoZW5IaXR0aW5nRWxlbWVudD1mdW5jdGlvbihlLHQpe2lmKCEobnVsbCE9dCYmdGhpcy5zdGF0ZS5zZWxlY3RlZEVsZW1lbnRJZHNbdC5pZF0pJiYhZS5zaGlmdEtleSl7dGhpcy5zZXRTdGF0ZSgoZnVuY3Rpb24oZSl7cmV0dXJue3NlbGVjdGVkRWxlbWVudElkczp7fSxzZWxlY3RlZEdyb3VwSWRzOnt9LGVkaXRpbmdHcm91cElkOmUuZWRpdGluZ0dyb3VwSWQmJm51bGwhPXQmJk9iamVjdChPZS5mKSh0LGUuZWRpdGluZ0dyb3VwSWQpP2UuZWRpdGluZ0dyb3VwSWQ6bnVsbH19KSk7dmFyIG49dGhpcy5zdGF0ZS5zZWxlY3RlZEVsZW1lbnRJZHM7dGhpcy5zZXRTdGF0ZSh7c2VsZWN0ZWRFbGVtZW50SWRzOnt9LHByZXZpb3VzU2VsZWN0ZWRFbGVtZW50SWRzOm59KX19LHQucHJvdG90eXBlLmdldFRleHRXeXNpd3lnU25hcHBlZFRvQ2VudGVyUG9zaXRpb249ZnVuY3Rpb24oZSx0LG4scixvKXt2YXIgYT1PYmplY3QobS5kKSh0aGlzLnNjZW5lLmdldEVsZW1lbnRzSW5jbHVkaW5nRGVsZXRlZCgpLmZpbHRlcigoZnVuY3Rpb24oZSl7cmV0dXJuIU9iamVjdChmLkEpKGUpfSkpLGUsdCk7aWYoYSl7dmFyIGk9YS54K2Eud2lkdGgvMixzPWEueSthLmhlaWdodC8yO2lmKE1hdGguaHlwb3QoZS1pLHQtcyk8Yi51KXt2YXIgbD1PYmplY3QoTy51KSh7c2NlbmVYOmksc2NlbmVZOnN9LG4scixvKTtyZXR1cm57dmlld3BvcnRYOmwueCx2aWV3cG9ydFk6bC55LGVsZW1lbnRDZW50ZXJYOmksZWxlbWVudENlbnRlclk6c319fX0sdC5wcm90b3R5cGUuZ2V0Q2FudmFzT2Zmc2V0cz1mdW5jdGlvbigpe3ZhciBlO2lmKG51bGw9PT0oZT10aGlzLmV4Y2FsaWRyYXdSZWYpfHx2b2lkIDA9PT1lP3ZvaWQgMDplLmN1cnJlbnQpe3ZhciB0PXRoaXMuZXhjYWxpZHJhd1JlZi5jdXJyZW50LnBhcmVudEVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7cmV0dXJue29mZnNldExlZnQ6dC5sZWZ0LG9mZnNldFRvcDp0LnRvcH19cmV0dXJue29mZnNldExlZnQ6MCxvZmZzZXRUb3A6MH19LHR9KGEuYS5Db21wb25lbnQpO3pyLmRlZmF1bHRQcm9wcz17d2lkdGg6d2luZG93LmlubmVyV2lkdGgsaGVpZ2h0OndpbmRvdy5pbm5lckhlaWdodCxvcHRpb25zOnt6ZW5Nb2RlRW5hYmxlZDohMSx2aWV3QmFja2dyb3VuZENvbG9yOngud2hpdGV9LGluaXRpYWxEYXRhOltdLHVzZXI6e319O3ZhciBMcj1mdW5jdGlvbigpe3ZhciBlPXRoaXM7dGhpcy5jYW52YXM9bnVsbCx0aGlzLnJjPW51bGwsdGhpcy5wb3J0YWw9bmV3IHcodGhpcyksdGhpcy5sYXN0QnJvYWRjYXN0ZWRPclJlY2VpdmVkU2NlbmVWZXJzaW9uPS0xLHRoaXMuYnJvYWRjYXN0ZWRFbGVtZW50VmVyc2lvbnM9bmV3IE1hcCx0aGlzLnVubW91bnRlZD0hMSx0aGlzLnN5bmNBY3Rpb25SZXN1bHQ9dnIoKGZ1bmN0aW9uKHQpe2lmKCFlLnVubW91bnRlZCYmITEhPT10KXt2YXIgbj1udWxsO3QuZWxlbWVudHMmJih0LmVsZW1lbnRzLmZvckVhY2goKGZ1bmN0aW9uKHQpe3ZhciByOyhudWxsPT09KHI9ZS5zdGF0ZS5lZGl0aW5nRWxlbWVudCl8fHZvaWQgMD09PXI/dm9pZCAwOnIuaWQpPT09dC5pZCYmZS5zdGF0ZS5lZGl0aW5nRWxlbWVudCE9PXQmJk9iamVjdChmLnopKHQpJiYobj10KX0pKSxlLnNjZW5lLnJlcGxhY2VBbGxFbGVtZW50cyh0LmVsZW1lbnRzKSx0LmNvbW1pdFRvSGlzdG9yeSYma3IucmVzdW1lUmVjb3JkaW5nKCkpLCh0LmFwcFN0YXRlfHxuKSYmKHQuY29tbWl0VG9IaXN0b3J5JiZrci5yZXN1bWVSZWNvcmRpbmcoKSxlLnNldFN0YXRlKChmdW5jdGlvbihlKXt2YXIgcjtyZXR1cm4gYnIoYnIoe30sdC5hcHBTdGF0ZSkse30se2VkaXRpbmdFbGVtZW50Om58fChudWxsPT09KHI9dC5hcHBTdGF0ZSl8fHZvaWQgMD09PXI/dm9pZCAwOnIuZWRpdGluZ0VsZW1lbnQpfHxudWxsLGlzQ29sbGFib3JhdGluZzplLmlzQ29sbGFib3JhdGluZyxjb2xsYWJvcmF0b3JzOmUuY29sbGFib3JhdG9ycyx3aWR0aDplLndpZHRoLGhlaWdodDplLmhlaWdodCxvZmZzZXRUb3A6ZS5vZmZzZXRUb3Asb2Zmc2V0TGVmdDplLm9mZnNldExlZnQsemVuTW9kZUVuYWJsZWQ6ZS56ZW5Nb2RlRW5hYmxlZCx2aWV3QmFja2dyb3VuZENvbG9yOmUudmlld0JhY2tncm91bmRDb2xvcn0pfSksKGZ1bmN0aW9uKCl7dC5zeW5jSGlzdG9yeSYma3Iuc2V0Q3VycmVudFN0YXRlKGUuc3RhdGUsZS5zY2VuZS5nZXRFbGVtZW50c0luY2x1ZGluZ0RlbGV0ZWQoKSl9KSkpfX0pKSx0aGlzLm9uQmx1cj12cigoZnVuY3Rpb24oKXtDcj0hMTt2YXIgdD1lLnByb3BzLm9uQmx1cjt0JiZ0KGUuc2NlbmUuZ2V0RWxlbWVudHNJbmNsdWRpbmdEZWxldGVkKCksZS5zdGF0ZSl9KSksdGhpcy5vblVubG9hZD1mdW5jdGlvbigpe2UuZGVzdHJveVNvY2tldENsaWVudCgpLGUub25CbHVyKCl9LHRoaXMuZGlzYWJsZUV2ZW50PWZ1bmN0aW9uKGUpe2UucHJldmVudERlZmF1bHQoKX0sdGhpcy5vbkZvbnRMb2FkZWQ9ZnVuY3Rpb24oKXtlLnNjZW5lLmdldEVsZW1lbnRzSW5jbHVkaW5nRGVsZXRlZCgpLmZvckVhY2goKGZ1bmN0aW9uKGUpe09iamVjdChmLkEpKGUpJiZPYmplY3QoaXIuYykoZSl9KSksZS5vblNjZW5lVXBkYXRlZCgpfSx0aGlzLmluaXRpYWxpemVTY2VuZT1tcigoZnVuY3Rpb24oKXt2YXIgdCxuLHIsbyxhLGk7cmV0dXJuIHByKHRoaXMsKGZ1bmN0aW9uKGwpe3N3aXRjaChsLmxhYmVsKXtjYXNlIDA6cmV0dXJuIHQ9bmV3IFVSTFNlYXJjaFBhcmFtcyh3aW5kb3cubG9jYXRpb24uc2VhcmNoKSxuPXQuZ2V0KCJpZCIpLHI9d2luZG93LmxvY2F0aW9uLmhhc2gubWF0Y2goL14janNvbj0oWzAtOV0rKSwoW2EtekEtWjAtOV8tXSspJC8pLGUuc3RhdGUuaXNMb2FkaW5nfHxlLnNldFN0YXRlKHtpc0xvYWRpbmc6ITB9KSxvPWUucHJvcHMuaW5pdGlhbERhdGEsWzQsT2JqZWN0KGcuaSkobnVsbCxvKV07Y2FzZSAxOnJldHVybiBhPWwuc2VudCgpLGk9ISFPYmplY3QoZy5mKSh3aW5kb3cubG9jYXRpb24uaHJlZiksISEobnx8cnx8aSk/ZS5zaG91bGRGb3JjZUxvYWRTY2VuZShhKXx8d2luZG93LmNvbmZpcm0oT2JqZWN0KHMuZSkoImFsZXJ0cy5sb2FkU2NlbmVPdmVycmlkZVByb21wdCIpKT9uP1s0LE9iamVjdChnLmkpKG4sbyldOlszLDNdOlszLDZdOlszLDddO2Nhc2UgMjpyZXR1cm4gYT1sLnNlbnQoKSxbMyw1XTtjYXNlIDM6cmV0dXJuIHI/WzQsT2JqZWN0KGcuaSkoclsxXSxvLHJbMl0pXTpbMyw1XTtjYXNlIDQ6YT1sLnNlbnQoKSxsLmxhYmVsPTU7Y2FzZSA1OnJldHVybiBpfHx3aW5kb3cuaGlzdG9yeS5yZXBsYWNlU3RhdGUoe30sIkV4Y2FsaWRyYXciLHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4pLFszLDddO2Nhc2UgNjppZihkb2N1bWVudC5oaWRkZW4pcmV0dXJuIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJmb2N1cyIsKGZ1bmN0aW9uKCl7cmV0dXJuIGUuaW5pdGlhbGl6ZVNjZW5lKCl9KSx7b25jZTohMH0pLFsyXTtpPSExLHdpbmRvdy5oaXN0b3J5LnJlcGxhY2VTdGF0ZSh7fSwiRXhjYWxpZHJhdyIsd2luZG93LmxvY2F0aW9uLm9yaWdpbiksbC5sYWJlbD03O2Nhc2UgNzpyZXR1cm4gZS5zdGF0ZS5pc0xvYWRpbmcmJmUuc2V0U3RhdGUoe2lzTG9hZGluZzohMX0pLGk/ZS5pbml0aWFsaXplU29ja2V0Q2xpZW50KHtzaG93TG9hZGluZ1N0YXRlOiEwfSk6YSYmKGEuYXBwU3RhdGUmJihhLmFwcFN0YXRlPWJyKGJyKHt9LGEuYXBwU3RhdGUpLE9iamVjdChtLmEpKGEuZWxlbWVudHMsYnIoYnIoe30sYS5hcHBTdGF0ZSkse30se3dpZHRoOmUuc3RhdGUud2lkdGgsaGVpZ2h0OmUuc3RhdGUuaGVpZ2h0LG9mZnNldFRvcDplLnN0YXRlLm9mZnNldFRvcCxvZmZzZXRMZWZ0OmUuc3RhdGUub2Zmc2V0TGVmdH0pLG51bGwpKSksZS5zeW5jQWN0aW9uUmVzdWx0KGEpKSxbMl19fSkpfSkpLHRoaXMub25SZXNpemU9dnIoKGZ1bmN0aW9uKCl7ZS5zY2VuZS5nZXRFbGVtZW50c0luY2x1ZGluZ0RlbGV0ZWQoKS5mb3JFYWNoKChmdW5jdGlvbihlKXtyZXR1cm4gT2JqZWN0KGlyLmMpKGUpfSkpLGUuc2V0U3RhdGUoe30pfSkpLHRoaXMub25IYXNoQ2hhbmdlPWZ1bmN0aW9uKHQpe3dpbmRvdy5sb2NhdGlvbi5oYXNoLmxlbmd0aD4xJiZlLmluaXRpYWxpemVTY2VuZSgpfSx0aGlzLmJlZm9yZVVubG9hZD12cigoZnVuY3Rpb24odCl7aWYoZS5zdGF0ZS5pc0NvbGxhYm9yYXRpbmcmJmUucG9ydGFsLnJvb21JRCl0cnl7dmFyIG47bnVsbD09PShuPWxvY2FsU3RvcmFnZSl8fHZvaWQgMD09PW58fG4uc2V0SXRlbShiLnEsSlNPTi5zdHJpbmdpZnkoe3RpbWVzdGFtcDpEYXRlLm5vdygpLHJvb206ZS5wb3J0YWwucm9vbUlEfSkpfWNhdGNoKGUpe31lLnN0YXRlLmlzQ29sbGFib3JhdGluZyYmZS5zY2VuZS5nZXRFbGVtZW50cygpLmxlbmd0aD4wJiYodC5wcmV2ZW50RGVmYXVsdCgpLHQucmV0dXJuVmFsdWU9IiIpfSkpLHRoaXMucXVldWVCcm9hZGNhc3RBbGxFbGVtZW50cz1scigpKChmdW5jdGlvbigpe2UuYnJvYWRjYXN0U2NlbmUoYi5zLlVQREFURSwhMCl9KSwyZTQpLHRoaXMub25DdXQ9dnIoKGZ1bmN0aW9uKHQpe09iamVjdChPLnApKHQudGFyZ2V0KXx8KGUuY29weUFsbCgpLGUuYWN0aW9uTWFuYWdlci5leGVjdXRlQWN0aW9uKEFlKSx0LnByZXZlbnREZWZhdWx0KCkpfSkpLHRoaXMub25Db3B5PXZyKChmdW5jdGlvbih0KXtPYmplY3QoTy5wKSh0LnRhcmdldCl8fChlLmNvcHlBbGwoKSx0LnByZXZlbnREZWZhdWx0KCkpfSkpLHRoaXMuY29weUFsbD1mdW5jdGlvbigpe09iamVjdChVdC5kKShlLnNjZW5lLmdldEVsZW1lbnRzKCksZS5zdGF0ZSl9LHRoaXMuY29weVRvQ2xpcGJvYXJkQXNQbmc9ZnVuY3Rpb24oKXt2YXIgdD1lLnNjZW5lLmdldEVsZW1lbnRzKCksbj1PYmplY3QobS5nKSh0LGUuc3RhdGUpO09iamVjdChnLmQpKCJjbGlwYm9hcmQiLG4ubGVuZ3RoP246dCxlLnN0YXRlLGUuY2FudmFzLGUuc3RhdGUpfSx0aGlzLmNvcHlUb0NsaXBib2FyZEFzU3ZnPWZ1bmN0aW9uKCl7dmFyIHQ9T2JqZWN0KG0uZykoZS5zY2VuZS5nZXRFbGVtZW50cygpLGUuc3RhdGUpO09iamVjdChnLmQpKCJjbGlwYm9hcmQtc3ZnIix0Lmxlbmd0aD90OmUuc2NlbmUuZ2V0RWxlbWVudHMoKSxlLnN0YXRlLGUuY2FudmFzLGUuc3RhdGUpfSx0aGlzLm9uVGFwU3RhcnQ9ZnVuY3Rpb24odCl7aWYoIXdyKXJldHVybiB3cj0hMCxjbGVhclRpbWVvdXQoU3IpLHZvaWQoU3I9d2luZG93LnNldFRpbWVvdXQoenIucmVzZXRUYXBUd2ljZSwzMDApKTtpZih3ciYmMT09PXQudG91Y2hlcy5sZW5ndGgpe3ZhciBuPXQudG91Y2hlc1swXTtlLmhhbmRsZUNhbnZhc0RvdWJsZUNsaWNrKHtjbGllbnRYOm4uY2xpZW50WCxjbGllbnRZOm4uY2xpZW50WX0pLHdyPSExLGNsZWFyVGltZW91dChTcil9dC5wcmV2ZW50RGVmYXVsdCgpLDI9PT10LnRvdWNoZXMubGVuZ3RoJiZlLnNldFN0YXRlKHtzZWxlY3RlZEVsZW1lbnRJZHM6e319KX0sdGhpcy5vblRhcEVuZD1mdW5jdGlvbih0KXtpZih0LnByZXZlbnREZWZhdWx0KCksdC50b3VjaGVzLmxlbmd0aD4wKXt2YXIgbj1lLnN0YXRlLnByZXZpb3VzU2VsZWN0ZWRFbGVtZW50SWRzO2Uuc2V0U3RhdGUoe3ByZXZpb3VzU2VsZWN0ZWRFbGVtZW50SWRzOnt9LHNlbGVjdGVkRWxlbWVudElkczpufSl9fSx0aGlzLnBhc3RlRnJvbUNsaXBib2FyZD12cihmdW5jdGlvbigpe3ZhciB0PW1yKChmdW5jdGlvbih0KXt2YXIgbixyLG87cmV0dXJuIHByKHRoaXMsKGZ1bmN0aW9uKGEpe3N3aXRjaChhLmxhYmVsKXtjYXNlIDA6cmV0dXJuIG49ZG9jdW1lbnQuYWN0aXZlRWxlbWVudCxyPWRvY3VtZW50LmVsZW1lbnRGcm9tUG9pbnQoRXIsT3IpLCF0fHxyIGluc3RhbmNlb2YgSFRNTENhbnZhc0VsZW1lbnQmJiFPYmplY3QoTy5wKShuKT9bNCxPYmplY3QoVXQuZSkoZS5zdGF0ZSxFcixPcix0KV06WzJdO2Nhc2UgMTpyZXR1cm4obz1hLnNlbnQoKSkuZXJyb3I/YWxlcnQoby5lcnJvcik6by5lbGVtZW50cz9lLmFkZEVsZW1lbnRzRnJvbVBhc3RlT3JMaWJyYXJ5KG8uZWxlbWVudHMpOm8udGV4dCYmZS5hZGRUZXh0RnJvbVBhc3RlKG8udGV4dCksZS5zZWxlY3RTaGFwZVRvb2woInNlbGVjdGlvbiIpLG51bGw9PXR8fHQucHJldmVudERlZmF1bHQoKSxbMl19fSkpfSkpO3JldHVybiBmdW5jdGlvbihlKXtyZXR1cm4gdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fSgpKSx0aGlzLmFkZEVsZW1lbnRzRnJvbVBhc3RlT3JMaWJyYXJ5PWZ1bmN0aW9uKHQsbixyKXt2b2lkIDA9PT1uJiYobj1Fciksdm9pZCAwPT09ciYmKHI9T3IpO3ZhciBvPU9iamVjdChmLmYpKHQpLGE9b1swXSxpPW9bMV0scz1vWzJdLGw9b1szXSxjPU9iamVjdChPLmUpKGEscykvMix1PU9iamVjdChPLmUpKGksbCkvMixkPU9iamVjdChPLnkpKHtjbGllbnRYOm4sY2xpZW50WTpyfSxlLnN0YXRlLGUuY2FudmFzLHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvKSxwPWQueCxoPWQueSxtPXAtYyxnPWgtdSxiPW5ldyBNYXAseT10Lm1hcCgoZnVuY3Rpb24odCl7cmV0dXJuIE9iamVjdChmLmQpKGUuc3RhdGUuZWRpdGluZ0dyb3VwSWQsYix0LHt4OnQueCttLWEseTp0LnkrZy1pfSl9KSk7ZS5zY2VuZS5yZXBsYWNlQWxsRWxlbWVudHMoaHIoZS5zY2VuZS5nZXRFbGVtZW50c0luY2x1ZGluZ0RlbGV0ZWQoKSx5KSksa3IucmVzdW1lUmVjb3JkaW5nKCksZS5zZXRTdGF0ZSh7aXNMaWJyYXJ5T3BlbjohMSxzZWxlY3RlZEVsZW1lbnRJZHM6eS5yZWR1Y2UoKGZ1bmN0aW9uKGUsdCl7cmV0dXJuIGVbdC5pZF09ITAsZX0pLHt9KX0pfSx0aGlzLnNldEFwcFN0YXRlPWZ1bmN0aW9uKHQpe2Uuc2V0U3RhdGUodCl9LHRoaXMucmVtb3ZlUG9pbnRlcj1mdW5jdGlvbihlKXsidG91Y2giPT09ZS5wb2ludGVyVHlwZSYmUHImJihjbGVhclRpbWVvdXQoUHIpLEFyPSExKSxfci5wb2ludGVycy5kZWxldGUoZS5wb2ludGVySWQpfSx0aGlzLm9wZW5Qb3J0YWw9bXIoKGZ1bmN0aW9uKCl7dmFyIHQsbixyO3JldHVybiBwcih0aGlzLChmdW5jdGlvbihvKXtzd2l0Y2goby5sYWJlbCl7Y2FzZSAwOnJldHVybiBuPSh0PXdpbmRvdy5oaXN0b3J5KS5wdXNoU3RhdGUscj1be30sIkV4Y2FsaWRyYXciXSxbNCxPYmplY3QoZy5lKSgpXTtjYXNlIDE6cmV0dXJuIG4uYXBwbHkodCxyLmNvbmNhdChbby5zZW50KCldKSksZS5pbml0aWFsaXplU29ja2V0Q2xpZW50KHtzaG93TG9hZGluZ1N0YXRlOiExfSksWzJdfX0pKX0pKSx0aGlzLmNsb3NlUG9ydGFsPWZ1bmN0aW9uKCl7d2luZG93Lmhpc3RvcnkucHVzaFN0YXRlKHt9LCJFeGNhbGlkcmF3Iix3aW5kb3cubG9jYXRpb24ub3JpZ2luKSxlLmRlc3Ryb3lTb2NrZXRDbGllbnQoKX0sdGhpcy50b2dnbGVMb2NrPWZ1bmN0aW9uKCl7ZS5zZXRTdGF0ZSgoZnVuY3Rpb24oZSl7cmV0dXJue2VsZW1lbnRMb2NrZWQ6IWUuZWxlbWVudExvY2tlZCxlbGVtZW50VHlwZTplLmVsZW1lbnRMb2NrZWQ/InNlbGVjdGlvbiI6ZS5lbGVtZW50VHlwZX19KSl9LHRoaXMudG9nZ2xlWmVuTW9kZT1mdW5jdGlvbigpe2Uuc2V0U3RhdGUoe3plbk1vZGVFbmFibGVkOiFlLnN0YXRlLnplbk1vZGVFbmFibGVkfSl9LHRoaXMudG9nZ2xlR3JpZE1vZGU9ZnVuY3Rpb24oKXtlLnNldFN0YXRlKHtncmlkU2l6ZTplLnN0YXRlLmdyaWRTaXplP251bGw6Yi5vfSl9LHRoaXMuZGVzdHJveVNvY2tldENsaWVudD1mdW5jdGlvbigpe2Uuc2V0U3RhdGUoe2lzQ29sbGFib3JhdGluZzohMSxjb2xsYWJvcmF0b3JzOm5ldyBNYXB9KSxlLnBvcnRhbC5jbG9zZSgpfSx0aGlzLmluaXRpYWxpemVTb2NrZXRDbGllbnQ9ZnVuY3Rpb24oKXt2YXIgdD1tcigoZnVuY3Rpb24odCl7dmFyIHIsbyxhLGkscztyZXR1cm4gcHIodGhpcywoZnVuY3Rpb24obCl7c3dpdGNoKGwubGFiZWwpe2Nhc2UgMDpyZXR1cm4gZS5wb3J0YWwuc29ja2V0P1syXToocj1PYmplY3QoZy5mKSh3aW5kb3cubG9jYXRpb24uaHJlZikpPyhvPWZ1bmN0aW9uKCl7ZS5wb3J0YWwuc29ja2V0SW5pdGlhbGl6ZWQ9ITAsY2xlYXJUaW1lb3V0KGEpLGUuc3RhdGUuaXNMb2FkaW5nJiYhZS51bm1vdW50ZWQmJmUuc2V0U3RhdGUoe2lzTG9hZGluZzohMX0pfSxhPXNldFRpbWVvdXQobyw1ZTMpLGk9ZnVuY3Rpb24odCxuKXt2YXIgcixhPSh2b2lkIDA9PT1uP3t9Om4pLnNjcm9sbFRvQ29udGVudCxpPXZvaWQgMCE9PWEmJmEscz10LnBheWxvYWQuZWxlbWVudHM7aWYoaSYmZS5zZXRTdGF0ZShicihicih7fSxlLnN0YXRlKSxPYmplY3QobS5hKShzLmZpbHRlcigoZnVuY3Rpb24oZSl7cmV0dXJuIWUuaXNEZWxldGVkfSkpLGUuc3RhdGUsZS5jYW52YXMpKSksbnVsbD09ZS5zY2VuZS5nZXRFbGVtZW50c0luY2x1ZGluZ0RlbGV0ZWQoKXx8MD09PWUuc2NlbmUuZ2V0RWxlbWVudHNJbmNsdWRpbmdEZWxldGVkKCkubGVuZ3RoKWUuc2NlbmUucmVwbGFjZUFsbEVsZW1lbnRzKHMpO2Vsc2V7dmFyIGw9T2JqZWN0KGYubCkoZS5zY2VuZS5nZXRFbGVtZW50c0luY2x1ZGluZ0RlbGV0ZWQoKSksYz0ocj1zLnJlZHVjZSgoZnVuY3Rpb24odCxuKXt2YXIgcixvLGE7cmV0dXJuIG4uaWQ9PT0obnVsbD09PShyPWUuc3RhdGUuZWRpdGluZ0VsZW1lbnQpfHx2b2lkIDA9PT1yP3ZvaWQgMDpyLmlkKXx8bi5pZD09PShudWxsPT09KG89ZS5zdGF0ZS5yZXNpemluZ0VsZW1lbnQpfHx2b2lkIDA9PT1vP3ZvaWQgMDpvLmlkKXx8bi5pZD09PShudWxsPT09KGE9ZS5zdGF0ZS5kcmFnZ2luZ0VsZW1lbnQpfHx2b2lkIDA9PT1hP3ZvaWQgMDphLmlkKXx8KGwuaGFzT3duUHJvcGVydHkobi5pZCkmJmxbbi5pZF0udmVyc2lvbj5uLnZlcnNpb24/KHQucHVzaChsW24uaWRdKSxkZWxldGUgbFtuLmlkXSk6bC5oYXNPd25Qcm9wZXJ0eShuLmlkKSYmbFtuLmlkXS52ZXJzaW9uPT09bi52ZXJzaW9uJiZsW24uaWRdLnZlcnNpb25Ob25jZSE9PW4udmVyc2lvbk5vbmNlPyhsW24uaWRdLnZlcnNpb25Ob25jZTxuLnZlcnNpb25Ob25jZT90LnB1c2gobFtuLmlkXSk6dC5wdXNoKG4pLGRlbGV0ZSBsW24uaWRdKToodC5wdXNoKG4pLGRlbGV0ZSBsW24uaWRdKSksdH0pLFtdKSkuY29uY2F0LmFwcGx5KHIsT2JqZWN0LnZhbHVlcyhsKSk7ZS5sYXN0QnJvYWRjYXN0ZWRPclJlY2VpdmVkU2NlbmVWZXJzaW9uPU9iamVjdChmLmkpKGMpLGUuc2NlbmUucmVwbGFjZUFsbEVsZW1lbnRzKGMpfWtyLmNsZWFyKCksZS5wb3J0YWwuc29ja2V0SW5pdGlhbGl6ZWR8fG8oKX0sWzQsUHJvbWlzZS5yZXNvbHZlKCkudGhlbihuLnQuYmluZChudWxsLDE0Niw3KSldKTpbMywyXTtjYXNlIDE6cz1sLnNlbnQoKS5kZWZhdWx0LGUucG9ydGFsLm9wZW4ocyhnLmEpLHJbMV0sclsyXSksZS5wb3J0YWwuc29ja2V0Lm9uKCJjbGllbnQtYnJvYWRjYXN0IixmdW5jdGlvbigpe3ZhciB0PW1yKChmdW5jdGlvbih0LG4pe3ZhciByLG8sYSxzLGwsYyx1O3JldHVybiBwcih0aGlzLChmdW5jdGlvbihkKXtzd2l0Y2goZC5sYWJlbCl7Y2FzZSAwOnJldHVybiBlLnBvcnRhbC5yb29tS2V5P1s0LE9iamVjdChnLmIpKHQsZS5wb3J0YWwucm9vbUtleSxuKV06WzJdO2Nhc2UgMTpzd2l0Y2goKHI9ZC5zZW50KCkpLnR5cGUpe2Nhc2UiSU5WQUxJRF9SRVNQT05TRSI6cmV0dXJuWzJdO2Nhc2UgYi5zLklOSVQ6ZS5wb3J0YWwuc29ja2V0SW5pdGlhbGl6ZWR8fGkocix7c2Nyb2xsVG9Db250ZW50OiEwfSk7YnJlYWs7Y2FzZSBiLnMuVVBEQVRFOmkocik7YnJlYWs7Y2FzZSJNT1VTRV9MT0NBVElPTiI6bz1yLnBheWxvYWQsYT1vLnNvY2tldElELHM9by5wb2ludGVyQ29vcmRzLGw9by5idXR0b24sYz1vLnVzZXJuYW1lLHU9by5zZWxlY3RlZEVsZW1lbnRJZHMsZS5zZXRTdGF0ZSgoZnVuY3Rpb24oZSl7ZS5jb2xsYWJvcmF0b3JzLmhhcyhhKXx8ZS5jb2xsYWJvcmF0b3JzLnNldChhLHt9KTt2YXIgdD1lLmNvbGxhYm9yYXRvcnMuZ2V0KGEpO3JldHVybiB0LnBvaW50ZXI9cyx0LmJ1dHRvbj1sLHQuc2VsZWN0ZWRFbGVtZW50SWRzPXUsdC51c2VybmFtZT1jLGUuY29sbGFib3JhdG9ycy5zZXQoYSx0KSxlfSkpfXJldHVyblsyXX19KSl9KSk7cmV0dXJuIGZ1bmN0aW9uKGUsbil7cmV0dXJuIHQuYXBwbHkodGhpcyxhcmd1bWVudHMpfX0oKSksZS5wb3J0YWwuc29ja2V0Lm9uKCJmaXJzdC1pbi1yb29tIiwoZnVuY3Rpb24oKXtlLnBvcnRhbC5zb2NrZXQmJmUucG9ydGFsLnNvY2tldC5vZmYoImZpcnN0LWluLXJvb20iKSxvKCl9KSksZS5zZXRTdGF0ZSh7aXNDb2xsYWJvcmF0aW5nOiEwLGlzTG9hZGluZzohIXQuc2hvd0xvYWRpbmdTdGF0ZXx8ZS5zdGF0ZS5pc0xvYWRpbmd9KSxsLmxhYmVsPTI7Y2FzZSAyOnJldHVyblsyXX19KSl9KSk7cmV0dXJuIGZ1bmN0aW9uKGUpe3JldHVybiB0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX19KCksdGhpcy5icm9hZGNhc3RNb3VzZUxvY2F0aW9uPWZ1bmN0aW9uKHQpe3ZhciBuO2lmKG51bGw9PT0obj1lLnBvcnRhbC5zb2NrZXQpfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLmlkKXt2YXIgcj17dHlwZToiTU9VU0VfTE9DQVRJT04iLHBheWxvYWQ6e3NvY2tldElEOmUucG9ydGFsLnNvY2tldC5pZCxwb2ludGVyQ29vcmRzOnQucG9pbnRlckNvb3JkcyxidXR0b246dC5idXR0b258fCJ1cCIsc2VsZWN0ZWRFbGVtZW50SWRzOmUuc3RhdGUuc2VsZWN0ZWRFbGVtZW50SWRzLHVzZXJuYW1lOmUuc3RhdGUudXNlcm5hbWV9fTtyZXR1cm4gZS5wb3J0YWwuX2Jyb2FkY2FzdFNvY2tldERhdGEociwhMCl9fSx0aGlzLmJyb2FkY2FzdFNjZW5lPWZ1bmN0aW9uKHQsbil7aWYodD09PWIucy5JTklUJiYhbil0aHJvdyBuZXcgRXJyb3IoInN5bmNBbGwgbXVzdCBiZSB0cnVlIHdoZW4gc2VuZGluZyBTQ0VORS5JTklUIik7dmFyIHI9T2JqZWN0KGYudCkoZS5zY2VuZS5nZXRFbGVtZW50c0luY2x1ZGluZ0RlbGV0ZWQoKSk7bnx8KHI9ci5maWx0ZXIoKGZ1bmN0aW9uKHQpe3JldHVybiFlLmJyb2FkY2FzdGVkRWxlbWVudFZlcnNpb25zLmhhcyh0LmlkKXx8dC52ZXJzaW9uPmUuYnJvYWRjYXN0ZWRFbGVtZW50VmVyc2lvbnMuZ2V0KHQuaWQpfSkpKTt2YXIgbz17dHlwZTp0LHBheWxvYWQ6e2VsZW1lbnRzOnJ9fTtlLmxhc3RCcm9hZGNhc3RlZE9yUmVjZWl2ZWRTY2VuZVZlcnNpb249TWF0aC5tYXgoZS5sYXN0QnJvYWRjYXN0ZWRPclJlY2VpdmVkU2NlbmVWZXJzaW9uLE9iamVjdChmLmkpKGUuc2NlbmUuZ2V0RWxlbWVudHNJbmNsdWRpbmdEZWxldGVkKCkpKTtmb3IodmFyIGE9MCxpPXI7YTxpLmxlbmd0aDthKyspe3ZhciBzPWlbYV07ZS5icm9hZGNhc3RlZEVsZW1lbnRWZXJzaW9ucy5zZXQocy5pZCxzLnZlcnNpb24pfXJldHVybiBlLnBvcnRhbC5fYnJvYWRjYXN0U29ja2V0RGF0YShvKX0sdGhpcy5vblNjZW5lVXBkYXRlZD1mdW5jdGlvbigpe2Uuc2V0U3RhdGUoe30pfSx0aGlzLnVwZGF0ZUN1cnJlbnRDdXJzb3JQb3NpdGlvbj12cigoZnVuY3Rpb24oZSl7RXI9ZS54LE9yPWUueX0pKSx0aGlzLm9uS2V5RG93bj12cigoZnVuY3Rpb24odCl7aWYoISh0W0MuYS5DVFJMX09SX0NNRF0mJnQuc2hpZnRLZXkmJiJDIj09PXQua2V5fHxPYmplY3QoTy5wKSh0LnRhcmdldCkmJnQua2V5IT09Qy5hLkVTQ0FQRXx8T2JqZWN0KEMuZSkodC5rZXkpJiZPYmplY3QoTy5tKSh0LnRhcmdldCkpKXtpZih0LmtleT09PUMuYS5RVUVTVElPTl9NQVJLJiZlLnNldFN0YXRlKHtzaG93U2hvcnRjdXRzRGlhbG9nOiEwfSksIXRbQy5hLkNUUkxfT1JfQ01EXSYmdC5hbHRLZXkmJnQua2V5Q29kZT09PUMuYS5aX0tFWV9DT0RFJiZlLnRvZ2dsZVplbk1vZGUoKSx0W0MuYS5DVFJMX09SX0NNRF0mJnQua2V5Q29kZT09PUMuYS5HUklEX0tFWV9DT0RFJiZlLnRvZ2dsZUdyaWRNb2RlKCksIktleUMiPT09dC5jb2RlJiZ0LmFsdEtleSYmdC5zaGlmdEtleSlyZXR1cm4gZS5jb3B5VG9DbGlwYm9hcmRBc1BuZygpLHZvaWQgdC5wcmV2ZW50RGVmYXVsdCgpO2lmKCFlLmFjdGlvbk1hbmFnZXIuaGFuZGxlS2V5RG93bih0KSl7aWYoIkRpZ2l0OSI9PT10LmNvZGUmJmUuc2V0U3RhdGUoe2lzTGlicmFyeU9wZW46IWUuc3RhdGUuaXNMaWJyYXJ5T3Blbn0pLE9iamVjdChDLmUpKHQua2V5KSl7dmFyIG49ZS5zdGF0ZS5ncmlkU2l6ZSYmKHQuc2hpZnRLZXk/Yi5rOmUuc3RhdGUuZ3JpZFNpemUpfHwodC5zaGlmdEtleT9iLmo6Yi5rKTtlLnNjZW5lLnJlcGxhY2VBbGxFbGVtZW50cyhlLnNjZW5lLmdldEVsZW1lbnRzSW5jbHVkaW5nRGVsZXRlZCgpLm1hcCgoZnVuY3Rpb24ocil7aWYoZS5zdGF0ZS5zZWxlY3RlZEVsZW1lbnRJZHNbci5pZF0pe3ZhciBvPXt9O3JldHVybiB0LmtleT09PUMuYS5BUlJPV19MRUZUP28ueD1yLngtbjp0LmtleT09PUMuYS5BUlJPV19SSUdIVD9vLng9ci54K246dC5rZXk9PT1DLmEuQVJST1dfVVA/by55PXIueS1uOnQua2V5PT09Qy5hLkFSUk9XX0RPV04mJihvLnk9ci55K24pLE9iamVjdChFZS5iKShyLG8pfXJldHVybiByfSkpKSx0LnByZXZlbnREZWZhdWx0KCl9ZWxzZSBpZih0LmtleT09PUMuYS5FTlRFUil7dmFyIHI9T2JqZWN0KG0uZykoZS5zY2VuZS5nZXRFbGVtZW50cygpLGUuc3RhdGUpO2lmKDE9PT1yLmxlbmd0aCYmT2JqZWN0KFQuYikoclswXSkpZS5zdGF0ZS5lZGl0aW5nTGluZWFyRWxlbWVudCYmZS5zdGF0ZS5lZGl0aW5nTGluZWFyRWxlbWVudC5lbGVtZW50SWQ9PT1yWzBdLmlkfHwoa3IucmVzdW1lUmVjb3JkaW5nKCksZS5zZXRTdGF0ZSh7ZWRpdGluZ0xpbmVhckVsZW1lbnQ6bmV3IENlLmEoclswXSxlLnNjZW5lKX0pKTtlbHNlIGlmKDE9PT1yLmxlbmd0aCYmIU9iamVjdChULmIpKHJbMF0pKXt2YXIgbz1yWzBdO3JldHVybiBlLnN0YXJ0VGV4dEVkaXRpbmcoe3NjZW5lWDpvLngrby53aWR0aC8yLHNjZW5lWTpvLnkrby5oZWlnaHQvMn0pLHZvaWQgdC5wcmV2ZW50RGVmYXVsdCgpfX1lbHNlIGlmKCF0LmN0cmxLZXkmJiF0LmFsdEtleSYmIXQubWV0YUtleSYmbnVsbD09PWUuc3RhdGUuZHJhZ2dpbmdFbGVtZW50KXt2YXIgYT1mdW5jdGlvbihlKXt2YXIgdD1qLmZpbmQoKGZ1bmN0aW9uKHQsbil7cmV0dXJuIGU9PT0obisxKS50b1N0cmluZygpfHwoInN0cmluZyI9PXR5cGVvZiB0LmtleT90LmtleT09PWU6dC5rZXkuaW5jbHVkZXMoZSkpfSkpO3JldHVybihudWxsPT10P3ZvaWQgMDp0LnZhbHVlKXx8bnVsbH0odC5rZXkpO2E/ZS5zZWxlY3RTaGFwZVRvb2woYSk6InEiPT09dC5rZXkmJmUudG9nZ2xlTG9jaygpfXQua2V5PT09Qy5hLlNQQUNFJiYwPT09X3IucG9pbnRlcnMuc2l6ZSYmKENyPSEwLGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5jdXJzb3I9Yi5kLkdSQUJCSU5HKX19fSkpLHRoaXMub25LZXlVcD12cigoZnVuY3Rpb24odCl7dC5rZXk9PT1DLmEuU1BBQ0UmJigic2VsZWN0aW9uIj09PWUuc3RhdGUuZWxlbWVudFR5cGU/T2JqZWN0KE8udCkoKTooT2JqZWN0KE8udykoZS5zdGF0ZS5lbGVtZW50VHlwZSksZS5zZXRTdGF0ZSh7c2VsZWN0ZWRFbGVtZW50SWRzOnt9LHNlbGVjdGVkR3JvdXBJZHM6e30sZWRpdGluZ0dyb3VwSWQ6bnVsbH0pKSxDcj0hMSl9KSksdGhpcy5vbkdlc3R1cmVTdGFydD12cigoZnVuY3Rpb24odCl7dC5wcmV2ZW50RGVmYXVsdCgpLGUuc2V0U3RhdGUoe3NlbGVjdGVkRWxlbWVudElkczp7fX0pLF9yLmluaXRpYWxTY2FsZT1lLnN0YXRlLnpvb219KSksdGhpcy5vbkdlc3R1cmVDaGFuZ2U9dnIoKGZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSxlLnNldFN0YXRlKHt6b29tOk9iamVjdChtLmYpKF9yLmluaXRpYWxTY2FsZSp0LnNjYWxlKX0pfSkpLHRoaXMub25HZXN0dXJlRW5kPXZyKChmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCk7dmFyIG49ZS5zdGF0ZS5wcmV2aW91c1NlbGVjdGVkRWxlbWVudElkcztlLnNldFN0YXRlKHtwcmV2aW91c1NlbGVjdGVkRWxlbWVudElkczp7fSxzZWxlY3RlZEVsZW1lbnRJZHM6bn0pLF9yLmluaXRpYWxTY2FsZT1udWxsfSkpLHRoaXMuc2V0RWxlbWVudHM9ZnVuY3Rpb24odCl7ZS5zY2VuZS5yZXBsYWNlQWxsRWxlbWVudHModCl9LHRoaXMuc3RhcnRUZXh0RWRpdGluZz1mdW5jdGlvbih0KXt2YXIgbj10LnNjZW5lWCxyPXQuc2NlbmVZLG89dC5pbnNlcnRBdFBhcmVudENlbnRlcixhPXZvaWQgMD09PW98fG8saT1lLmdldFRleHRFbGVtZW50QXRQb3NpdGlvbihuLHIpLHM9YSYmZS5nZXRUZXh0V3lzaXd5Z1NuYXBwZWRUb0NlbnRlclBvc2l0aW9uKG4scixlLnN0YXRlLGUuY2FudmFzLHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvKSxsPWl8fE9iamVjdChmLkQpKHt4OnM/cy5lbGVtZW50Q2VudGVyWDpuLHk6cz9zLmVsZW1lbnRDZW50ZXJZOnIsc3Ryb2tlQ29sb3I6ZS5zdGF0ZS5jdXJyZW50SXRlbVN0cm9rZUNvbG9yLGJhY2tncm91bmRDb2xvcjplLnN0YXRlLmN1cnJlbnRJdGVtQmFja2dyb3VuZENvbG9yLGZpbGxTdHlsZTplLnN0YXRlLmN1cnJlbnRJdGVtRmlsbFN0eWxlLHN0cm9rZVdpZHRoOmUuc3RhdGUuY3VycmVudEl0ZW1TdHJva2VXaWR0aCxzdHJva2VTdHlsZTplLnN0YXRlLmN1cnJlbnRJdGVtU3Ryb2tlU3R5bGUscm91Z2huZXNzOmUuc3RhdGUuY3VycmVudEl0ZW1Sb3VnaG5lc3Msb3BhY2l0eTplLnN0YXRlLmN1cnJlbnRJdGVtT3BhY2l0eSx0ZXh0OiIiLGZvbnRTaXplOmUuc3RhdGUuY3VycmVudEl0ZW1Gb250U2l6ZSxmb250RmFtaWx5OmUuc3RhdGUuY3VycmVudEl0ZW1Gb250RmFtaWx5LHRleHRBbGlnbjpzPyJjZW50ZXIiOmUuc3RhdGUuY3VycmVudEl0ZW1UZXh0QWxpZ24sdmVydGljYWxBbGlnbjpzPyJtaWRkbGUiOmIuaH0pO2Uuc2V0U3RhdGUoe2VkaXRpbmdFbGVtZW50Omx9KSxpP3MmJiJjZW50ZXIiPT09bC50ZXh0QWxpZ258fE9iamVjdChFZS5hKShsLHt2ZXJ0aWNhbEFsaWduOmIuaH0pOihlLnNjZW5lLnJlcGxhY2VBbGxFbGVtZW50cyhocihlLnNjZW5lLmdldEVsZW1lbnRzSW5jbHVkaW5nRGVsZXRlZCgpLFtsXSkpLHN8fE9iamVjdChFZS5hKShsLHt5OmwueS1sLmJhc2VsaW5lLzJ9KSksZS5zZXRTdGF0ZSh7ZWRpdGluZ0VsZW1lbnQ6bH0pLGUuaGFuZGxlVGV4dFd5c2l3eWcobCx7aXNFeGlzdGluZ0VsZW1lbnQ6ISFpfSl9LHRoaXMuaGFuZGxlQ2FudmFzRG91YmxlQ2xpY2s9ZnVuY3Rpb24odCl7aWYoIWUuc3RhdGUubXVsdGlFbGVtZW50JiYic2VsZWN0aW9uIj09PWUuc3RhdGUuZWxlbWVudFR5cGUpe3ZhciBuPU9iamVjdChtLmcpKGUuc2NlbmUuZ2V0RWxlbWVudHMoKSxlLnN0YXRlKTtpZigxPT09bi5sZW5ndGgmJk9iamVjdChULmIpKG5bMF0pKWUuc3RhdGUuZWRpdGluZ0xpbmVhckVsZW1lbnQmJmUuc3RhdGUuZWRpdGluZ0xpbmVhckVsZW1lbnQuZWxlbWVudElkPT09blswXS5pZHx8KGtyLnJlc3VtZVJlY29yZGluZygpLGUuc2V0U3RhdGUoe2VkaXRpbmdMaW5lYXJFbGVtZW50Om5ldyBDZS5hKG5bMF0sZS5zY2VuZSl9KSk7ZWxzZXtPYmplY3QoTy50KSgpO3ZhciByPU9iamVjdChPLnkpKHQsZS5zdGF0ZSxlLmNhbnZhcyx3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyksbz1yLngsYT1yLnk7aWYoT2JqZWN0KE9lLmUpKGUuc3RhdGUpLmxlbmd0aD4wKXt2YXIgaT1lLnNjZW5lLmdldEVsZW1lbnRzKCkscz1PYmplY3QobS5jKShpLGUuc3RhdGUsbyxhLGUuc3RhdGUuem9vbSksbD1zJiZPYmplY3QoT2UuZCkocyxlLnN0YXRlLnNlbGVjdGVkR3JvdXBJZHMpO2lmKGwpcmV0dXJuIHZvaWQgZS5zZXRTdGF0ZSgoZnVuY3Rpb24odCl7dmFyIG47cmV0dXJuIE9iamVjdChPZS5qKShicihicih7fSx0KSx7fSx7ZWRpdGluZ0dyb3VwSWQ6bCxzZWxlY3RlZEVsZW1lbnRJZHM6KG49e30sbltzLmlkXT0hMCxuKSxzZWxlY3RlZEdyb3VwSWRzOnt9fSksZS5zY2VuZS5nZXRFbGVtZW50cygpKX0pKX1PYmplY3QoTy50KSgpLGUuc3RhcnRUZXh0RWRpdGluZyh7c2NlbmVYOm8sc2NlbmVZOmEsaW5zZXJ0QXRQYXJlbnRDZW50ZXI6IXQuYWx0S2V5fSl9fX0sdGhpcy5oYW5kbGVDYW52YXNQb2ludGVyTW92ZT1mdW5jdGlvbih0KXtpZihlLnNhdmVQb2ludGVyKHQuY2xpZW50WCx0LmNsaWVudFksZS5zdGF0ZS5jdXJzb3JCdXR0b24pLF9yLnBvaW50ZXJzLmhhcyh0LnBvaW50ZXJJZCkmJl9yLnBvaW50ZXJzLnNldCh0LnBvaW50ZXJJZCx7eDp0LmNsaWVudFgseTp0LmNsaWVudFl9KSwyPT09X3IucG9pbnRlcnMuc2l6ZSl7dmFyIG49VnQoX3IucG9pbnRlcnMpLHI9bi54LV9yLmxhc3RDZW50ZXIueCxvPW4ueS1fci5sYXN0Q2VudGVyLnk7X3IubGFzdENlbnRlcj1uO3ZhciBhPUt0KEFycmF5LmZyb20oX3IucG9pbnRlcnMudmFsdWVzKCkpKS9fci5pbml0aWFsRGlzdGFuY2U7ZS5zZXRTdGF0ZSh7c2Nyb2xsWDpPYmplY3QobS5vKShlLnN0YXRlLnNjcm9sbFgrci9lLnN0YXRlLnpvb20pLHNjcm9sbFk6T2JqZWN0KG0ubykoZS5zdGF0ZS5zY3JvbGxZK28vZS5zdGF0ZS56b29tKSx6b29tOk9iamVjdChtLmYpKF9yLmluaXRpYWxTY2FsZSphKSxzaG91bGRDYWNoZUlnbm9yZVpvb206ITB9KSxlLnJlc2V0U2hvdWxkQ2FjaGVJZ25vcmVab29tRGVib3VuY2VkKCl9ZWxzZSBfci5sYXN0Q2VudGVyPV9yLmluaXRpYWxEaXN0YW5jZT1fci5pbml0aWFsU2NhbGU9bnVsbDtpZighKENyfHx4cnx8anIpKXt2YXIgaT1PYmplY3QobS5tKShUcix0LmNsaWVudFgsdC5jbGllbnRZKS5pc092ZXJFaXRoZXI7ZS5zdGF0ZS5kcmFnZ2luZ0VsZW1lbnR8fGUuc3RhdGUubXVsdGlFbGVtZW50fHwoaT9PYmplY3QoTy50KSgpOk9iamVjdChPLncpKGUuc3RhdGUuZWxlbWVudFR5cGUpKTt2YXIgcz1PYmplY3QoTy55KSh0LGUuc3RhdGUsZS5jYW52YXMsd2luZG93LmRldmljZVBpeGVsUmF0aW8pLGw9cy54LGM9cy55O2lmKGUuc3RhdGUuZWRpdGluZ0xpbmVhckVsZW1lbnQmJm51bGw9PT1lLnN0YXRlLmVkaXRpbmdMaW5lYXJFbGVtZW50LmRyYWdnaW5nRWxlbWVudFBvaW50SW5kZXgpe3ZhciB1PUNlLmEuaGFuZGxlUG9pbnRlck1vdmUodCxsLGMsZS5zdGF0ZS5lZGl0aW5nTGluZWFyRWxlbWVudCk7dSE9PWUuc3RhdGUuZWRpdGluZ0xpbmVhckVsZW1lbnQmJmUuc2V0U3RhdGUoe2VkaXRpbmdMaW5lYXJFbGVtZW50OnV9KX1pZihlLnN0YXRlLm11bHRpRWxlbWVudCl7dmFyIGQ9ZS5zdGF0ZS5tdWx0aUVsZW1lbnQscD1kLngsaD1kLnksZz1kLnBvaW50cyx5PWQubGFzdENvbW1pdHRlZFBvaW50LHY9Z1tnLmxlbmd0aC0xXTtyZXR1cm4gT2JqZWN0KE8udykoZS5zdGF0ZS5lbGVtZW50VHlwZSksdm9pZCh2PT09eT9PYmplY3QoRS5iKShsLXAsYy1oLHZbMF0sdlsxXSk+PWIucD9PYmplY3QoRWUuYSkoZCx7cG9pbnRzOmhyKGcsW1tsLXAsYy1oXV0pfSk6ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLmN1cnNvcj1iLmQuUE9JTlRFUjpnLmxlbmd0aD4yJiZ5JiZPYmplY3QoRS5iKShsLXAsYy1oLHlbMF0seVsxXSk8Yi5wPyhkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuY3Vyc29yPWIuZC5QT0lOVEVSLE9iamVjdChFZS5hKShkLHtwb2ludHM6Zy5zbGljZSgwLC0xKX0pKTooT2JqZWN0KEUuZikoZykmJihkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuY3Vyc29yPWIuZC5QT0lOVEVSKSxPYmplY3QoRWUuYSkoZCx7cG9pbnRzOmhyKGcuc2xpY2UoMCwtMSksW1tsLXAsYy1oXV0pfSkpKX1pZighKEJvb2xlYW4odC5idXR0b25zKXx8InNlbGVjdGlvbiIhPT1lLnN0YXRlLmVsZW1lbnRUeXBlJiYidGV4dCIhPT1lLnN0YXRlLmVsZW1lbnRUeXBlKSl7dmFyIGs9ZS5zY2VuZS5nZXRFbGVtZW50cygpLHc9T2JqZWN0KG0uZykoayxlLnN0YXRlKTtpZigxIT09dy5sZW5ndGh8fGl8fGUuc3RhdGUuZWRpdGluZ0xpbmVhckVsZW1lbnQpe2lmKHcubGVuZ3RoPjEmJiFpKXt2YXIgUz1PYmplY3QoZi5yKShPYmplY3QoZi5mKSh3KSxsLGMsZS5zdGF0ZS56b29tLHQucG9pbnRlclR5cGUpO2lmKFMpcmV0dXJuIHZvaWQoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLmN1cnNvcj1PYmplY3QoZi5nKSh7cmVzaXplSGFuZGxlOlN9KSl9fWVsc2V7dmFyIEM9T2JqZWN0KGYubSkoayxlLnN0YXRlLGwsYyxlLnN0YXRlLnpvb20sdC5wb2ludGVyVHlwZSk7aWYoQyYmQy5yZXNpemVIYW5kbGUpcmV0dXJuIHZvaWQoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLmN1cnNvcj1PYmplY3QoZi5nKShDKSl9dmFyIHg9T2JqZWN0KG0uYykoayxlLnN0YXRlLGwsYyxlLnN0YXRlLnpvb20pOyJ0ZXh0Ij09PWUuc3RhdGUuZWxlbWVudFR5cGU/ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLmN1cnNvcj1PYmplY3QoZi5BKSh4KT9iLmQuVEVYVDpiLmQuQ1JPU1NIQUlSOmRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5jdXJzb3I9eCYmIWk/Im1vdmUiOiIifX19LHRoaXMuaGFuZGxlVG91Y2hNb3ZlPWZ1bmN0aW9uKGUpe0FyPSEwfSx0aGlzLmhhbmRsZUNhbnZhc1BvaW50ZXJEb3duPWZ1bmN0aW9uKHQpe2lmKHQucGVyc2lzdCgpLGUubWF5YmVPcGVuQ29udGV4dE1lbnVBZnRlclBvaW50ZXJEb3duT25Ub3VjaERldmljZXModCksZS5tYXliZUNsZWFudXBBZnRlck1pc3NpbmdQb2ludGVyVXAodCksIXhyJiYoZS5zZXRTdGF0ZSh7bGFzdFBvaW50ZXJEb3duV2l0aDp0LnBvaW50ZXJUeXBlLGN1cnNvckJ1dHRvbjoiZG93biJ9KSxlLnNhdmVQb2ludGVyKHQuY2xpZW50WCx0LmNsaWVudFksImRvd24iKSwhZS5oYW5kbGVDYW52YXNQYW5Vc2luZ1doZWVsT3JTcGFjZURyYWcodCkmJiEodC5idXR0b24hPT1iLnIuTUFJTiYmdC5idXR0b24hPT1iLnIuVE9VQ0h8fChlLnVwZGF0ZUdlc3R1cmVPblBvaW50ZXJEb3duKHQpLHQucHJldmVudERlZmF1bHQoKSxkb2N1bWVudC5hY3RpdmVFbGVtZW50IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQmJmRvY3VtZW50LmFjdGl2ZUVsZW1lbnQuYmx1cigpLF9yLnBvaW50ZXJzLnNpemU+MSkpKSl7dmFyIG49ZS5pbml0aWFsUG9pbnRlckRvd25TdGF0ZSh0KTtpZighZS5oYW5kbGVEcmFnZ2luZ1Njcm9sbEJhcih0LG4pJiYoZS5jbGVhclNlbGVjdGlvbklmTm90VXNpbmdTZWxlY3Rpb24oKSwhZS5oYW5kbGVTZWxlY3Rpb25PblBvaW50ZXJEb3duKHQsbikpKWlmKCJ0ZXh0IiE9PWUuc3RhdGUuZWxlbWVudFR5cGUpeyJhcnJvdyI9PT1lLnN0YXRlLmVsZW1lbnRUeXBlfHwiZHJhdyI9PT1lLnN0YXRlLmVsZW1lbnRUeXBlfHwibGluZSI9PT1lLnN0YXRlLmVsZW1lbnRUeXBlP2UuaGFuZGxlTGluZWFyRWxlbWVudE9uUG9pbnRlckRvd24odCxlLnN0YXRlLmVsZW1lbnRUeXBlLG4pOmUuY3JlYXRlR2VuZXJpY0VsZW1lbnRPblBvaW50ZXJEb3duKGUuc3RhdGUuZWxlbWVudFR5cGUsbik7dmFyIHI9ZS5vblBvaW50ZXJNb3ZlRnJvbVBvaW50ZXJEb3duSGFuZGxlcihuKSxvPWUub25Qb2ludGVyVXBGcm9tUG9pbnRlckRvd25IYW5kbGVyKG4pO01yPW8sd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoYi5tLlBPSU5URVJfTU9WRSxyKSx3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihiLm0uUE9JTlRFUl9VUCxvKSxuLmV2ZW50TGlzdGVuZXJzLm9uTW92ZT1yLG4uZXZlbnRMaXN0ZW5lcnMub25VcD1vfWVsc2UgZS5oYW5kbGVUZXh0T25Qb2ludGVyRG93bih0LG4pfX0sdGhpcy5tYXliZU9wZW5Db250ZXh0TWVudUFmdGVyUG9pbnRlckRvd25PblRvdWNoRGV2aWNlcz1mdW5jdGlvbih0KXsidG91Y2giPT09dC5wb2ludGVyVHlwZSYmKEFyPSExLFByPXdpbmRvdy5zZXRUaW1lb3V0KChmdW5jdGlvbigpe0FyfHxlLm9wZW5Db250ZXh0TWVudSh7Y2xpZW50WDp0LmNsaWVudFgsY2xpZW50WTp0LmNsaWVudFl9KX0pLDUwMCkpfSx0aGlzLmhhbmRsZUNhbnZhc1BhblVzaW5nV2hlZWxPclNwYWNlRHJhZz1mdW5jdGlvbih0KXtpZigwIT09X3IucG9pbnRlcnMuc2l6ZXx8ISh0LmJ1dHRvbj09PWIuci5XSEVFTHx8dC5idXR0b249PT1iLnIuTUFJTiYmQ3IpKXJldHVybiExO3hyPSEwO3ZhciBuPSExLHI9L0xpbnV4Ly50ZXN0KHdpbmRvdy5uYXZpZ2F0b3IucGxhdGZvcm0pO2RvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5jdXJzb3I9Yi5kLkdSQUJCSU5HO3ZhciBvPXQuY2xpZW50WCxhPXQuY2xpZW50WSxpPXZyKChmdW5jdGlvbih0KXt2YXIgaT1vLXQuY2xpZW50WCxzPWEtdC5jbGllbnRZO2lmKG89dC5jbGllbnRYLGE9dC5jbGllbnRZLHImJiFuJiYoTWF0aC5hYnMoaSk+MXx8TWF0aC5hYnMocyk+MSkpe249ITA7dmFyIGw9ZnVuY3Rpb24oZSl7ZG9jdW1lbnQuYm9keS5yZW1vdmVFdmVudExpc3RlbmVyKGIubS5QQVNURSxsKSxlLnN0b3BQcm9wYWdhdGlvbigpfSxjPWZ1bmN0aW9uKCl7c2V0VGltZW91dCgoZnVuY3Rpb24oKXtkb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIoYi5tLlBBU1RFLGwpLHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKGIubS5QT0lOVEVSX1VQLGMpfSksMTAwKX07ZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKGIubS5QQVNURSxsKSx3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihiLm0uUE9JTlRFUl9VUCxjKX1lLnNldFN0YXRlKHtzY3JvbGxYOk9iamVjdChtLm8pKGUuc3RhdGUuc2Nyb2xsWC1pL2Uuc3RhdGUuem9vbSksc2Nyb2xsWTpPYmplY3QobS5vKShlLnN0YXRlLnNjcm9sbFktcy9lLnN0YXRlLnpvb20pfSl9KSkscz12cihNcj1mdW5jdGlvbigpe01yPW51bGwseHI9ITEsQ3J8fE9iamVjdChPLncpKGUuc3RhdGUuZWxlbWVudFR5cGUpLGUuc2V0U3RhdGUoe2N1cnNvckJ1dHRvbjoidXAifSksZS5zYXZlUG9pbnRlcih0LmNsaWVudFgsdC5jbGllbnRZLCJ1cCIpLHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKGIubS5QT0lOVEVSX01PVkUsaSksd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoYi5tLlBPSU5URVJfVVAscyksd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoYi5tLkJMVVIscyl9KTtyZXR1cm4gd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoYi5tLkJMVVIscyksd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoYi5tLlBPSU5URVJfTU9WRSxpLHtwYXNzaXZlOiEwfSksd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoYi5tLlBPSU5URVJfVVAscyksITB9LHRoaXMuY2xlYXJTZWxlY3Rpb25JZk5vdFVzaW5nU2VsZWN0aW9uPWZ1bmN0aW9uKCl7InNlbGVjdGlvbiIhPT1lLnN0YXRlLmVsZW1lbnRUeXBlJiZlLnNldFN0YXRlKHtzZWxlY3RlZEVsZW1lbnRJZHM6e30sc2VsZWN0ZWRHcm91cElkczp7fSxlZGl0aW5nR3JvdXBJZDpudWxsfSl9LHRoaXMuaGFuZGxlU2VsZWN0aW9uT25Qb2ludGVyRG93bj1mdW5jdGlvbih0LG4pe2lmKCJzZWxlY3Rpb24iPT09ZS5zdGF0ZS5lbGVtZW50VHlwZSl7dmFyIHI9ZS5zY2VuZS5nZXRFbGVtZW50cygpLG89T2JqZWN0KG0uZykocixlLnN0YXRlKTtpZigxIT09by5sZW5ndGh8fGUuc3RhdGUuZWRpdGluZ0xpbmVhckVsZW1lbnQpby5sZW5ndGg+MSYmKG4ucmVzaXplLmhhbmRsZT1PYmplY3QoZi5yKShPYmplY3QoZi5mKShvKSxuLm9yaWdpbi54LG4ub3JpZ2luLnksZS5zdGF0ZS56b29tLHQucG9pbnRlclR5cGUpKTtlbHNle3ZhciBhPU9iamVjdChmLm0pKHIsZS5zdGF0ZSxuLm9yaWdpbi54LG4ub3JpZ2luLnksZS5zdGF0ZS56b29tLHQucG9pbnRlclR5cGUpO251bGwhPWEmJihlLnNldFN0YXRlKHtyZXNpemluZ0VsZW1lbnQ6YS5lbGVtZW50fSksbi5yZXNpemUuaGFuZGxlPWEucmVzaXplSGFuZGxlKX1pZihuLnJlc2l6ZS5oYW5kbGUpZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLmN1cnNvcj1PYmplY3QoZi5nKSh7cmVzaXplSGFuZGxlOm4ucmVzaXplLmhhbmRsZX0pLG4ucmVzaXplLmlzUmVzaXppbmc9ITAsbi5yZXNpemUub2Zmc2V0PU9iamVjdChPLngpKE9iamVjdChmLnMpKG4ucmVzaXplLmhhbmRsZSxvLG4ub3JpZ2luLngsbi5vcmlnaW4ueSkpLDE9PT1vLmxlbmd0aCYmT2JqZWN0KFQuYikob1swXSkmJjI9PT1vWzBdLnBvaW50cy5sZW5ndGgmJihuLnJlc2l6ZS5hcnJvd0RpcmVjdGlvbj1PYmplY3QoZi5xKShuLnJlc2l6ZS5oYW5kbGUsb1swXSkpO2Vsc2V7dmFyIGk7aWYoZS5zdGF0ZS5lZGl0aW5nTGluZWFyRWxlbWVudCl7dmFyIHM9Q2UuYS5oYW5kbGVQb2ludGVyRG93bih0LGUuc3RhdGUsKGZ1bmN0aW9uKHQpe3JldHVybiBlLnNldFN0YXRlKHQpfSksa3Isbi5vcmlnaW4ueCxuLm9yaWdpbi55KTtpZihzLmhpdEVsZW1lbnQmJihuLmhpdC5lbGVtZW50PXMuaGl0RWxlbWVudCkscy5kaWRBZGRQb2ludClyZXR1cm4hMH1uLmhpdC5lbGVtZW50PW51bGwhPT0oaT1uLmhpdC5lbGVtZW50KSYmdm9pZCAwIT09aT9pOk9iamVjdChtLmMpKHIsZS5zdGF0ZSxuLm9yaWdpbi54LG4ub3JpZ2luLnksZS5zdGF0ZS56b29tKSxlLm1heWJlQ2xlYXJTZWxlY3Rpb25XaGVuSGl0dGluZ0VsZW1lbnQodCxuLmhpdC5lbGVtZW50KTt2YXIgbD1uLmhpdC5lbGVtZW50O2lmKG51bGwhPWwmJiFlLnN0YXRlLnNlbGVjdGVkRWxlbWVudElkc1tsLmlkXSl7aWYoZS5zdGF0ZS5lZGl0aW5nR3JvdXBJZCYmIU9iamVjdChPZS5mKShsLGUuc3RhdGUuZWRpdGluZ0dyb3VwSWQpKXJldHVybiBlLnNldFN0YXRlKHtzZWxlY3RlZEVsZW1lbnRJZHM6e30sc2VsZWN0ZWRHcm91cElkczp7fSxlZGl0aW5nR3JvdXBJZDpudWxsfSksITA7ZS5zZXRTdGF0ZSgoZnVuY3Rpb24odCl7dmFyIG47cmV0dXJuIE9iamVjdChPZS5qKShicihicih7fSx0KSx7fSx7c2VsZWN0ZWRFbGVtZW50SWRzOmJyKGJyKHt9LHQuc2VsZWN0ZWRFbGVtZW50SWRzKSx7fSwobj17fSxuW2wuaWRdPSEwLG4pKX0pLGUuc2NlbmUuZ2V0RWxlbWVudHMoKSl9KSksZS5zY2VuZS5yZXBsYWNlQWxsRWxlbWVudHMoZS5zY2VuZS5nZXRFbGVtZW50c0luY2x1ZGluZ0RlbGV0ZWQoKSksbi5oaXQud2FzQWRkZWRUb1NlbGVjdGlvbj0hMH12YXIgYz1lLnN0YXRlLnNlbGVjdGVkRWxlbWVudElkcztlLnNldFN0YXRlKHtwcmV2aW91c1NlbGVjdGVkRWxlbWVudElkczpjfSl9fXJldHVybiExfSx0aGlzLmhhbmRsZVRleHRPblBvaW50ZXJEb3duPWZ1bmN0aW9uKHQsbil7dmFyIHI7InRleHQiIT09KG51bGw9PT0ocj1lLnN0YXRlLmVkaXRpbmdFbGVtZW50KXx8dm9pZCAwPT09cj92b2lkIDA6ci50eXBlKSYmKGUuc3RhcnRUZXh0RWRpdGluZyh7c2NlbmVYOm4ub3JpZ2luLngsc2NlbmVZOm4ub3JpZ2luLnksaW5zZXJ0QXRQYXJlbnRDZW50ZXI6IXQuYWx0S2V5fSksT2JqZWN0KE8udCkoKSxlLnN0YXRlLmVsZW1lbnRMb2NrZWR8fGUuc2V0U3RhdGUoe2VsZW1lbnRUeXBlOiJzZWxlY3Rpb24ifSkpfSx0aGlzLmhhbmRsZUxpbmVhckVsZW1lbnRPblBvaW50ZXJEb3duPWZ1bmN0aW9uKHQsbixyKXtpZihlLnN0YXRlLm11bHRpRWxlbWVudCl7dmFyIG89ZS5zdGF0ZS5tdWx0aUVsZW1lbnQ7aWYoImxpbmUiPT09by50eXBlJiZPYmplY3QoRS5mKShvLnBvaW50cykpcmV0dXJuIE9iamVjdChFZS5hKShvLHtsYXN0Q29tbWl0dGVkUG9pbnQ6by5wb2ludHNbby5wb2ludHMubGVuZ3RoLTFdfSksdm9pZCBlLmFjdGlvbk1hbmFnZXIuZXhlY3V0ZUFjdGlvbih2dCk7dmFyIGE9by54LGk9by55LHM9by5sYXN0Q29tbWl0dGVkUG9pbnQ7aWYoby5wb2ludHMubGVuZ3RoPjEmJnMmJk9iamVjdChFLmIpKHIub3JpZ2luLngtYSxyLm9yaWdpbi55LWksc1swXSxzWzFdKTxiLnApcmV0dXJuIHZvaWQgZS5hY3Rpb25NYW5hZ2VyLmV4ZWN1dGVBY3Rpb24odnQpO2Uuc2V0U3RhdGUoKGZ1bmN0aW9uKGUpe3ZhciB0O3JldHVybntzZWxlY3RlZEVsZW1lbnRJZHM6YnIoYnIoe30sZS5zZWxlY3RlZEVsZW1lbnRJZHMpLHt9LCh0PXt9LHRbby5pZF09ITAsdCkpfX0pKSxPYmplY3QoRWUuYSkobyx7bGFzdENvbW1pdHRlZFBvaW50Om8ucG9pbnRzW28ucG9pbnRzLmxlbmd0aC0xXX0pLGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5jdXJzb3I9Yi5kLlBPSU5URVJ9ZWxzZXt2YXIgbD1PYmplY3QoRS5lKShyLm9yaWdpbi54LHIub3JpZ2luLnksImRyYXciPT09bj9udWxsOmUuc3RhdGUuZ3JpZFNpemUpLGM9bFswXSx1PWxbMV0sZD1PYmplY3QoZi5DKSh7dHlwZTpuLHg6Yyx5OnUsc3Ryb2tlQ29sb3I6ZS5zdGF0ZS5jdXJyZW50SXRlbVN0cm9rZUNvbG9yLGJhY2tncm91bmRDb2xvcjplLnN0YXRlLmN1cnJlbnRJdGVtQmFja2dyb3VuZENvbG9yLGZpbGxTdHlsZTplLnN0YXRlLmN1cnJlbnRJdGVtRmlsbFN0eWxlLHN0cm9rZVdpZHRoOmUuc3RhdGUuY3VycmVudEl0ZW1TdHJva2VXaWR0aCxzdHJva2VTdHlsZTplLnN0YXRlLmN1cnJlbnRJdGVtU3Ryb2tlU3R5bGUscm91Z2huZXNzOmUuc3RhdGUuY3VycmVudEl0ZW1Sb3VnaG5lc3Msb3BhY2l0eTplLnN0YXRlLmN1cnJlbnRJdGVtT3BhY2l0eX0pO2Uuc2V0U3RhdGUoKGZ1bmN0aW9uKGUpe3ZhciB0O3JldHVybntzZWxlY3RlZEVsZW1lbnRJZHM6YnIoYnIoe30sZS5zZWxlY3RlZEVsZW1lbnRJZHMpLHt9LCh0PXt9LHRbZC5pZF09ITEsdCkpfX0pKSxPYmplY3QoRWUuYSkoZCx7cG9pbnRzOmhyKGQucG9pbnRzLFtbMCwwXV0pfSksZS5zY2VuZS5yZXBsYWNlQWxsRWxlbWVudHMoaHIoZS5zY2VuZS5nZXRFbGVtZW50c0luY2x1ZGluZ0RlbGV0ZWQoKSxbZF0pKSxlLnNldFN0YXRlKHtkcmFnZ2luZ0VsZW1lbnQ6ZCxlZGl0aW5nRWxlbWVudDpkfSl9fSx0aGlzLmNyZWF0ZUdlbmVyaWNFbGVtZW50T25Qb2ludGVyRG93bj1mdW5jdGlvbih0LG4pe3ZhciByPU9iamVjdChFLmUpKG4ub3JpZ2luLngsbi5vcmlnaW4ueSxlLnN0YXRlLmdyaWRTaXplKSxvPXJbMF0sYT1yWzFdLGk9T2JqZWN0KGYuQikoe3R5cGU6dCx4Om8seTphLHN0cm9rZUNvbG9yOmUuc3RhdGUuY3VycmVudEl0ZW1TdHJva2VDb2xvcixiYWNrZ3JvdW5kQ29sb3I6ZS5zdGF0ZS5jdXJyZW50SXRlbUJhY2tncm91bmRDb2xvcixmaWxsU3R5bGU6ZS5zdGF0ZS5jdXJyZW50SXRlbUZpbGxTdHlsZSxzdHJva2VXaWR0aDplLnN0YXRlLmN1cnJlbnRJdGVtU3Ryb2tlV2lkdGgsc3Ryb2tlU3R5bGU6ZS5zdGF0ZS5jdXJyZW50SXRlbVN0cm9rZVN0eWxlLHJvdWdobmVzczplLnN0YXRlLmN1cnJlbnRJdGVtUm91Z2huZXNzLG9wYWNpdHk6ZS5zdGF0ZS5jdXJyZW50SXRlbU9wYWNpdHl9KTsic2VsZWN0aW9uIj09PWkudHlwZT9lLnNldFN0YXRlKHtzZWxlY3Rpb25FbGVtZW50OmksZHJhZ2dpbmdFbGVtZW50Oml9KTooZS5zY2VuZS5yZXBsYWNlQWxsRWxlbWVudHMoaHIoZS5zY2VuZS5nZXRFbGVtZW50c0luY2x1ZGluZ0RlbGV0ZWQoKSxbaV0pKSxlLnNldFN0YXRlKHttdWx0aUVsZW1lbnQ6bnVsbCxkcmFnZ2luZ0VsZW1lbnQ6aSxlZGl0aW5nRWxlbWVudDppfSkpfSx0aGlzLmhhbmRsZUNhbnZhc1JlZj1mdW5jdGlvbih0KXt2YXIgbixyLG87bnVsbCE9PXQ/KGUuY2FudmFzPXQsZS5yYz1wLmEuY2FudmFzKGUuY2FudmFzKSxlLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKGIubS5XSEVFTCxlLmhhbmRsZVdoZWVsLHtwYXNzaXZlOiExfSksZS5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcihiLm0uVE9VQ0hfU1RBUlQsZS5vblRhcFN0YXJ0KSxlLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKGIubS5UT1VDSF9FTkQsZS5vblRhcEVuZCkpOihudWxsPT09KG49ZS5jYW52YXMpfHx2b2lkIDA9PT1ufHxuLnJlbW92ZUV2ZW50TGlzdGVuZXIoYi5tLldIRUVMLGUuaGFuZGxlV2hlZWwpLG51bGw9PT0ocj1lLmNhbnZhcyl8fHZvaWQgMD09PXJ8fHIucmVtb3ZlRXZlbnRMaXN0ZW5lcihiLm0uVE9VQ0hfU1RBUlQsZS5vblRhcFN0YXJ0KSxudWxsPT09KG89ZS5jYW52YXMpfHx2b2lkIDA9PT1vfHxvLnJlbW92ZUV2ZW50TGlzdGVuZXIoYi5tLlRPVUNIX0VORCxlLm9uVGFwRW5kKSl9LHRoaXMuaGFuZGxlQ2FudmFzT25Ecm9wPWZ1bmN0aW9uKHQpe3ZhciBuLHI9dC5kYXRhVHJhbnNmZXIuZ2V0RGF0YSgiYXBwbGljYXRpb24vdm5kLmV4Y2FsaWRyYXdsaWIranNvbiIpO2lmKCIiPT09cil7dmFyIG89bnVsbD09PShuPXQuZGF0YVRyYW5zZmVyKXx8dm9pZCAwPT09bj92b2lkIDA6bi5maWxlc1swXTsiYXBwbGljYXRpb24vanNvbiI9PT0obnVsbD09bz92b2lkIDA6by50eXBlKXx8KG51bGw9PW8/dm9pZCAwOm8ubmFtZS5lbmRzV2l0aCgiLmV4Y2FsaWRyYXciKSk/KGUuc2V0U3RhdGUoe2lzTG9hZGluZzohMH0pLE9iamVjdChnLmcpKG8sZS5zdGF0ZSkudGhlbigoZnVuY3Rpb24odCl7dmFyIG49dC5lbGVtZW50cyxyPXQuYXBwU3RhdGU7cmV0dXJuIGUuc3luY0FjdGlvblJlc3VsdCh7ZWxlbWVudHM6bixhcHBTdGF0ZTpicihicih7fSxyfHxlLnN0YXRlKSx7fSx7aXNMb2FkaW5nOiExfSksY29tbWl0VG9IaXN0b3J5OiExfSl9KSkuY2F0Y2goKGZ1bmN0aW9uKHQpe2Uuc2V0U3RhdGUoe2lzTG9hZGluZzohMSxlcnJvck1lc3NhZ2U6dC5tZXNzYWdlfSl9KSkpOiJhcHBsaWNhdGlvbi92bmQuZXhjYWxpZHJhd2xpYitqc29uIj09PShudWxsPT1vP3ZvaWQgMDpvLnR5cGUpfHwobnVsbD09bz92b2lkIDA6by5uYW1lLmVuZHNXaXRoKCIuZXhjYWxpZHJhd2xpYiIpKT9jci5hLmltcG9ydExpYnJhcnkobykudGhlbigoZnVuY3Rpb24oKXtlLnNldFN0YXRlKHtpc0xpYnJhcnlPcGVuOiExfSl9KSkuY2F0Y2goKGZ1bmN0aW9uKHQpe3JldHVybiBlLnNldFN0YXRlKHtpc0xvYWRpbmc6ITEsZXJyb3JNZXNzYWdlOnQubWVzc2FnZX0pfSkpOmUuc2V0U3RhdGUoe2lzTG9hZGluZzohMSxlcnJvck1lc3NhZ2U6T2JqZWN0KHMuZSkoImFsZXJ0cy5jb3VsZE5vdExvYWRJbnZhbGlkRmlsZSIpfSl9ZWxzZSBlLmFkZEVsZW1lbnRzRnJvbVBhc3RlT3JMaWJyYXJ5KEpTT04ucGFyc2UociksdC5jbGllbnRYLHQuY2xpZW50WSl9LHRoaXMuaGFuZGxlQ2FudmFzQ29udGV4dE1lbnU9ZnVuY3Rpb24odCl7dC5wcmV2ZW50RGVmYXVsdCgpLGUub3BlbkNvbnRleHRNZW51KHQpfSx0aGlzLm9wZW5Db250ZXh0TWVudT1mdW5jdGlvbih0KXt2YXIgbixyPXQuY2xpZW50WCxvPXQuY2xpZW50WSxhPU9iamVjdChPLnkpKHtjbGllbnRYOnIsY2xpZW50WTpvfSxlLnN0YXRlLGUuY2FudmFzLHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvKSxpPWEueCxsPWEueSxjPWUuc2NlbmUuZ2V0RWxlbWVudHMoKSx1PU9iamVjdChtLmMpKGMsZS5zdGF0ZSxpLGwsZS5zdGF0ZS56b29tKTt1PyhlLnN0YXRlLnNlbGVjdGVkRWxlbWVudElkc1t1LmlkXXx8ZS5zZXRTdGF0ZSh7c2VsZWN0ZWRFbGVtZW50SWRzOihuPXt9LG5bdS5pZF09ITAsbil9KSxHKHtvcHRpb25zOmhyKFtuYXZpZ2F0b3IuY2xpcGJvYXJkJiZ7bGFiZWw6T2JqZWN0KHMuZSkoImxhYmVscy5jb3B5IiksYWN0aW9uOmUuY29weUFsbH0sbmF2aWdhdG9yLmNsaXBib2FyZCYme2xhYmVsOk9iamVjdChzLmUpKCJsYWJlbHMucGFzdGUiKSxhY3Rpb246ZnVuY3Rpb24oKXtyZXR1cm4gZS5wYXN0ZUZyb21DbGlwYm9hcmQobnVsbCl9fSxVdC5mJiZ7bGFiZWw6T2JqZWN0KHMuZSkoImxhYmVscy5jb3B5QXNQbmciKSxhY3Rpb246ZS5jb3B5VG9DbGlwYm9hcmRBc1BuZ30sVXQuZyYme2xhYmVsOk9iamVjdChzLmUpKCJsYWJlbHMuY29weUFzU3ZnIiksYWN0aW9uOmUuY29weVRvQ2xpcGJvYXJkQXNTdmd9XSxlLmFjdGlvbk1hbmFnZXIuZ2V0Q29udGV4dE1lbnVJdGVtcygoZnVuY3Rpb24oZSl7cmV0dXJuIWIuYi5pbmNsdWRlcyhlLm5hbWUpfSkpKSx0b3A6byxsZWZ0OnJ9KSk6Ryh7b3B0aW9uczpocihbbmF2aWdhdG9yLmNsaXBib2FyZCYme2xhYmVsOk9iamVjdChzLmUpKCJsYWJlbHMucGFzdGUiKSxhY3Rpb246ZnVuY3Rpb24oKXtyZXR1cm4gZS5wYXN0ZUZyb21DbGlwYm9hcmQobnVsbCl9fSxVdC5mJiZjLmxlbmd0aD4wJiZ7bGFiZWw6T2JqZWN0KHMuZSkoImxhYmVscy5jb3B5QXNQbmciKSxhY3Rpb246ZS5jb3B5VG9DbGlwYm9hcmRBc1BuZ30sVXQuZyYmYy5sZW5ndGg+MCYme2xhYmVsOk9iamVjdChzLmUpKCJsYWJlbHMuY29weUFzU3ZnIiksYWN0aW9uOmUuY29weVRvQ2xpcGJvYXJkQXNTdmd9XSxlLmFjdGlvbk1hbmFnZXIuZ2V0Q29udGV4dE1lbnVJdGVtcygoZnVuY3Rpb24oZSl7cmV0dXJuIGIuYi5pbmNsdWRlcyhlLm5hbWUpfSkpLFt7bGFiZWw6T2JqZWN0KHMuZSkoImxhYmVscy50b2dnbGVHcmlkTW9kZSIpLGFjdGlvbjplLnRvZ2dsZUdyaWRNb2RlfV0pLHRvcDpvLGxlZnQ6cn0pfSx0aGlzLmhhbmRsZVdoZWVsPXZyKChmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCk7dmFyIG49dC5kZWx0YVgscj10LmRlbHRhWSxvPWUuc3RhdGUsYT1vLnNlbGVjdGVkRWxlbWVudElkcyxpPW8ucHJldmlvdXNTZWxlY3RlZEVsZW1lbnRJZHM7aWYodC5tZXRhS2V5fHx0LmN0cmxLZXkpe3ZhciBzPU1hdGguc2lnbihyKSxsPU1hdGguYWJzKHIpO3JldHVybiBsPjEwJiYobD0xMCksbCo9cywwIT09T2JqZWN0LmtleXMoaSkubGVuZ3RoJiZzZXRUaW1lb3V0KChmdW5jdGlvbigpe2Uuc2V0U3RhdGUoe3NlbGVjdGVkRWxlbWVudElkczppLHByZXZpb3VzU2VsZWN0ZWRFbGVtZW50SWRzOnt9fSl9KSwxZTMpLHZvaWQgZS5zZXRTdGF0ZSgoZnVuY3Rpb24oZSl7dmFyIHQ9ZS56b29tO3JldHVybnt6b29tOk9iamVjdChtLmYpKHQtbC8xMDApLHNlbGVjdGVkRWxlbWVudElkczp7fSxwcmV2aW91c1NlbGVjdGVkRWxlbWVudElkczowIT09T2JqZWN0LmtleXMoYSkubGVuZ3RoP2E6aX19KSl9dC5zaGlmdEtleT9lLnNldFN0YXRlKChmdW5jdGlvbihlKXt2YXIgdD1lLnpvb20sbz1lLnNjcm9sbFg7cmV0dXJue3Njcm9sbFg6T2JqZWN0KG0ubykoby0ocnx8bikvdCl9fSkpOmUuc2V0U3RhdGUoKGZ1bmN0aW9uKGUpe3ZhciB0PWUuem9vbSxvPWUuc2Nyb2xsWCxhPWUuc2Nyb2xsWTtyZXR1cm57c2Nyb2xsWDpPYmplY3QobS5vKShvLW4vdCksc2Nyb2xsWTpPYmplY3QobS5vKShhLXIvdCl9fSkpfSkpLHRoaXMuc2F2ZVBvaW50ZXI9ZnVuY3Rpb24odCxuLHIpe2lmKHQmJm4pe3ZhciBvPU9iamVjdChPLnkpKHtjbGllbnRYOnQsY2xpZW50WTpufSxlLnN0YXRlLGUuY2FudmFzLHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvKTtpc05hTihvLngpfHxpc05hTihvLnkpfHxlLnBvcnRhbC5zb2NrZXQmJl9yLnBvaW50ZXJzLnNpemU8MiYmZS5icm9hZGNhc3RNb3VzZUxvY2F0aW9uKHtwb2ludGVyQ29vcmRzOm8sYnV0dG9uOnJ9KX19LHRoaXMucmVzZXRTaG91bGRDYWNoZUlnbm9yZVpvb21EZWJvdW5jZWQ9T2JqZWN0KE8uZCkoKGZ1bmN0aW9uKCl7ZS5zZXRTdGF0ZSh7c2hvdWxkQ2FjaGVJZ25vcmVab29tOiExfSl9KSwzMDApfTsicHJvZHVjdGlvbiIhPT1iLmwuVEVTVCYmInByb2R1Y3Rpb24iIT09Yi5sLkRFVkVMT1BNRU5UfHwod2luZG93Lmg9e30sT2JqZWN0LmRlZmluZVByb3BlcnRpZXMod2luZG93Lmgse2VsZW1lbnRzOntnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hcHAuc2NlbmUuZ2V0RWxlbWVudHNJbmNsdWRpbmdEZWxldGVkKCl9LHNldDpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5hcHAuc2NlbmUucmVwbGFjZUFsbEVsZW1lbnRzKGUpfX0saGlzdG9yeTp7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGtyfX0sbGlicmFyeTp7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIE9iamVjdChHdC5hKSgpfX19KSk7dmFyIElyPXpyO24oODYpLG4oODcpLG4oODgpLHQuZGVmYXVsdD1mdW5jdGlvbihlKXt2YXIgdD1lLndpZHRoLG49ZS5oZWlnaHQscj1lLm9uQ2hhbmdlLGk9ZS5vbkJsdXIscz1lLmluaXRpYWxEYXRhLGw9ZS51c2VyLGM9ZS5vblVzZXJuYW1lQ2hhbmdlLHU9ZS5vcHRpb25zO3JldHVybiBPYmplY3Qoby51c2VFZmZlY3QpKChmdW5jdGlvbigpe3ZhciBlPWZ1bmN0aW9uKGUpezEhPT1lLnNjYWxlJiZlLnByZXZlbnREZWZhdWx0KCl9O3JldHVybiBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJ0b3VjaG1vdmUiLGUse3Bhc3NpdmU6ITF9KSxmdW5jdGlvbigpe2RvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoInRvdWNoTW92ZSIsZSl9fSksW10pLGEuYS5jcmVhdGVFbGVtZW50KGQsbnVsbCxhLmEuY3JlYXRlRWxlbWVudChJcix7d2lkdGg6dCxoZWlnaHQ6bixvbkNoYW5nZTpyLG9uQmx1cjppLGluaXRpYWxEYXRhOnMsdXNlcjpsLG9uVXNlcm5hbWVDaGFuZ2U6YyxvcHRpb25zOnV9KSl9fSxmdW5jdGlvbihlLHQsbil7dmFyIHI9bigxMTgpLG89big0NSksYT1uKDU3KSxpPW4oMjcpKCJzb2NrZXQuaW8tY2xpZW50Iik7ZS5leHBvcnRzPXQ9bDt2YXIgcz10Lm1hbmFnZXJzPXt9O2Z1bmN0aW9uIGwoZSx0KXsib2JqZWN0Ij09dHlwZW9mIGUmJih0PWUsZT12b2lkIDApLHQ9dHx8e307dmFyIG4sbz1yKGUpLGw9by5zb3VyY2UsYz1vLmlkLHU9by5wYXRoLGQ9c1tjXSYmdSBpbiBzW2NdLm5zcHM7cmV0dXJuIHQuZm9yY2VOZXd8fHRbImZvcmNlIG5ldyBjb25uZWN0aW9uIl18fCExPT09dC5tdWx0aXBsZXh8fGQ/KGkoImlnbm9yaW5nIHNvY2tldCBjYWNoZSBmb3IgJXMiLGwpLG49YShsLHQpKTooc1tjXXx8KGkoIm5ldyBpbyBpbnN0YW5jZSBmb3IgJXMiLGwpLHNbY109YShsLHQpKSxuPXNbY10pLG8ucXVlcnkmJiF0LnF1ZXJ5JiYodC5xdWVyeT1vLnF1ZXJ5KSxuLnNvY2tldChvLnBhdGgsdCl9dC5wcm90b2NvbD1vLnByb3RvY29sLHQuY29ubmVjdD1sLHQuTWFuYWdlcj1uKDU3KSx0LlNvY2tldD1uKDYzKX0sZnVuY3Rpb24oZSx0LG4peyJ1c2Ugc3RyaWN0IjtuLnIodCk7dmFyIHI9ZnVuY3Rpb24oZSx0KXt2YXIgbixyLG8sYSxpPXtsYWJlbDowLHNlbnQ6ZnVuY3Rpb24oKXtpZigxJm9bMF0pdGhyb3cgb1sxXTtyZXR1cm4gb1sxXX0sdHJ5czpbXSxvcHM6W119O3JldHVybiBhPXtuZXh0OnMoMCksdGhyb3c6cygxKSxyZXR1cm46cygyKX0sImZ1bmN0aW9uIj09dHlwZW9mIFN5bWJvbCYmKGFbU3ltYm9sLml0ZXJhdG9yXT1mdW5jdGlvbigpe3JldHVybiB0aGlzfSksYTtmdW5jdGlvbiBzKGEpe3JldHVybiBmdW5jdGlvbihzKXtyZXR1cm4gZnVuY3Rpb24oYSl7aWYobil0aHJvdyBuZXcgVHlwZUVycm9yKCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuIik7Zm9yKDtpOyl0cnl7aWYobj0xLHImJihvPTImYVswXT9yLnJldHVybjphWzBdP3IudGhyb3d8fCgobz1yLnJldHVybikmJm8uY2FsbChyKSwwKTpyLm5leHQpJiYhKG89by5jYWxsKHIsYVsxXSkpLmRvbmUpcmV0dXJuIG87c3dpdGNoKHI9MCxvJiYoYT1bMiZhWzBdLG8udmFsdWVdKSxhWzBdKXtjYXNlIDA6Y2FzZSAxOm89YTticmVhaztjYXNlIDQ6cmV0dXJuIGkubGFiZWwrKyx7dmFsdWU6YVsxXSxkb25lOiExfTtjYXNlIDU6aS5sYWJlbCsrLHI9YVsxXSxhPVswXTtjb250aW51ZTtjYXNlIDc6YT1pLm9wcy5wb3AoKSxpLnRyeXMucG9wKCk7Y29udGludWU7ZGVmYXVsdDppZighKG89aS50cnlzLChvPW8ubGVuZ3RoPjAmJm9bby5sZW5ndGgtMV0pfHw2IT09YVswXSYmMiE9PWFbMF0pKXtpPTA7Y29udGludWV9aWYoMz09PWFbMF0mJighb3x8YVsxXT5vWzBdJiZhWzFdPG9bM10pKXtpLmxhYmVsPWFbMV07YnJlYWt9aWYoNj09PWFbMF0mJmkubGFiZWw8b1sxXSl7aS5sYWJlbD1vWzFdLG89YTticmVha31pZihvJiZpLmxhYmVsPG9bMl0pe2kubGFiZWw9b1syXSxpLm9wcy5wdXNoKGEpO2JyZWFrfW9bMl0mJmkub3BzLnBvcCgpLGkudHJ5cy5wb3AoKTtjb250aW51ZX1hPXQuY2FsbChlLGkpfWNhdGNoKGUpe2E9WzYsZV0scj0wfWZpbmFsbHl7bj1vPTB9aWYoNSZhWzBdKXRocm93IGFbMV07cmV0dXJue3ZhbHVlOmFbMF0/YVsxXTp2b2lkIDAsZG9uZTohMH19KFthLHNdKX19fTtmdW5jdGlvbiBvKGUsdCxuLHIsbyxhLGkpe3RyeXt2YXIgcz1lW2FdKGkpLGw9cy52YWx1ZX1jYXRjaChlKXtyZXR1cm4gdm9pZCBuKGUpfXMuZG9uZT90KGwpOlByb21pc2UucmVzb2x2ZShsKS50aGVuKHIsbyl9ZnVuY3Rpb24gYShlKXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgdD10aGlzLG49YXJndW1lbnRzO3JldHVybiBuZXcgUHJvbWlzZSgoZnVuY3Rpb24ocixhKXt2YXIgaT1lLmFwcGx5KHQsbik7ZnVuY3Rpb24gcyhlKXtvKGkscixhLHMsbCwibmV4dCIsZSl9ZnVuY3Rpb24gbChlKXtvKGkscixhLHMsbCwidGhyb3ciLGUpfXModm9pZCAwKX0pKX19dmFyIGk9ZnVuY3Rpb24oKXt2YXIgZT1hKChmdW5jdGlvbihlKXt2YXIgdDtyZXR1cm4gcih0aGlzLChmdW5jdGlvbihuKXtzd2l0Y2gobi5sYWJlbCl7Y2FzZSAwOnJldHVybls0LGUuZ2V0RmlsZSgpXTtjYXNlIDE6cmV0dXJuWzIsKCh0PW4uc2VudCgpKS5oYW5kbGU9ZSx0KV19fSkpfSkpO3JldHVybiBmdW5jdGlvbih0KXtyZXR1cm4gZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fSgpO3QuZGVmYXVsdD1mdW5jdGlvbigpe3ZhciBlPWEoKGZ1bmN0aW9uKGUpe3ZhciB0O3JldHVybiB2b2lkIDA9PT1lJiYoZT17fSkscih0aGlzLChmdW5jdGlvbihuKXtzd2l0Y2gobi5sYWJlbCl7Y2FzZSAwOnJldHVybls0LHdpbmRvdy5jaG9vc2VGaWxlU3lzdGVtRW50cmllcyh7YWNjZXB0czpbe2Rlc2NyaXB0aW9uOmUuZGVzY3JpcHRpb258fCIiLG1pbWVUeXBlczplLm1pbWVUeXBlc3x8WyIqLyoiXSxleHRlbnNpb25zOmUuZXh0ZW5zaW9uc3x8WyIiXX1dLG11bHRpcGxlOmUubXVsdGlwbGV8fCExfSldO2Nhc2UgMTpyZXR1cm4gdD1uLnNlbnQoKSxbMixlLm11bHRpcGxlP1Byb21pc2UuYWxsKHQubWFwKGkpKTppKHQpXX19KSl9KSk7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfX0oKX0sZnVuY3Rpb24oZSx0LG4peyJ1c2Ugc3RyaWN0IjtuLnIodCk7dmFyIHI9ZnVuY3Rpb24oZSx0KXt2YXIgbixyLG8sYSxpPXtsYWJlbDowLHNlbnQ6ZnVuY3Rpb24oKXtpZigxJm9bMF0pdGhyb3cgb1sxXTtyZXR1cm4gb1sxXX0sdHJ5czpbXSxvcHM6W119O3JldHVybiBhPXtuZXh0OnMoMCksdGhyb3c6cygxKSxyZXR1cm46cygyKX0sImZ1bmN0aW9uIj09dHlwZW9mIFN5bWJvbCYmKGFbU3ltYm9sLml0ZXJhdG9yXT1mdW5jdGlvbigpe3JldHVybiB0aGlzfSksYTtmdW5jdGlvbiBzKGEpe3JldHVybiBmdW5jdGlvbihzKXtyZXR1cm4gZnVuY3Rpb24oYSl7aWYobil0aHJvdyBuZXcgVHlwZUVycm9yKCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuIik7Zm9yKDtpOyl0cnl7aWYobj0xLHImJihvPTImYVswXT9yLnJldHVybjphWzBdP3IudGhyb3d8fCgobz1yLnJldHVybikmJm8uY2FsbChyKSwwKTpyLm5leHQpJiYhKG89by5jYWxsKHIsYVsxXSkpLmRvbmUpcmV0dXJuIG87c3dpdGNoKHI9MCxvJiYoYT1bMiZhWzBdLG8udmFsdWVdKSxhWzBdKXtjYXNlIDA6Y2FzZSAxOm89YTticmVhaztjYXNlIDQ6cmV0dXJuIGkubGFiZWwrKyx7dmFsdWU6YVsxXSxkb25lOiExfTtjYXNlIDU6aS5sYWJlbCsrLHI9YVsxXSxhPVswXTtjb250aW51ZTtjYXNlIDc6YT1pLm9wcy5wb3AoKSxpLnRyeXMucG9wKCk7Y29udGludWU7ZGVmYXVsdDppZighKG89aS50cnlzLChvPW8ubGVuZ3RoPjAmJm9bby5sZW5ndGgtMV0pfHw2IT09YVswXSYmMiE9PWFbMF0pKXtpPTA7Y29udGludWV9aWYoMz09PWFbMF0mJighb3x8YVsxXT5vWzBdJiZhWzFdPG9bM10pKXtpLmxhYmVsPWFbMV07YnJlYWt9aWYoNj09PWFbMF0mJmkubGFiZWw8b1sxXSl7aS5sYWJlbD1vWzFdLG89YTticmVha31pZihvJiZpLmxhYmVsPG9bMl0pe2kubGFiZWw9b1syXSxpLm9wcy5wdXNoKGEpO2JyZWFrfW9bMl0mJmkub3BzLnBvcCgpLGkudHJ5cy5wb3AoKTtjb250aW51ZX1hPXQuY2FsbChlLGkpfWNhdGNoKGUpe2E9WzYsZV0scj0wfWZpbmFsbHl7bj1vPTB9aWYoNSZhWzBdKXRocm93IGFbMV07cmV0dXJue3ZhbHVlOmFbMF0/YVsxXTp2b2lkIDAsZG9uZTohMH19KFthLHNdKX19fTtmdW5jdGlvbiBvKGUsdCxuLHIsbyxhLGkpe3RyeXt2YXIgcz1lW2FdKGkpLGw9cy52YWx1ZX1jYXRjaChlKXtyZXR1cm4gdm9pZCBuKGUpfXMuZG9uZT90KGwpOlByb21pc2UucmVzb2x2ZShsKS50aGVuKHIsbyl9ZnVuY3Rpb24gYShlKXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgdD10aGlzLG49YXJndW1lbnRzO3JldHVybiBuZXcgUHJvbWlzZSgoZnVuY3Rpb24ocixhKXt2YXIgaT1lLmFwcGx5KHQsbik7ZnVuY3Rpb24gcyhlKXtvKGkscixhLHMsbCwibmV4dCIsZSl9ZnVuY3Rpb24gbChlKXtvKGkscixhLHMsbCwidGhyb3ciLGUpfXModm9pZCAwKX0pKX19dmFyIGk9ZnVuY3Rpb24oKXt2YXIgZT1hKChmdW5jdGlvbihlKXt2YXIgdDtyZXR1cm4gcih0aGlzLChmdW5jdGlvbihuKXtzd2l0Y2gobi5sYWJlbCl7Y2FzZSAwOnJldHVybls0LGUuZ2V0RmlsZSgpXTtjYXNlIDE6cmV0dXJuWzIsKCh0PW4uc2VudCgpKS5oYW5kbGU9ZSx0KV19fSkpfSkpO3JldHVybiBmdW5jdGlvbih0KXtyZXR1cm4gZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fSgpO3QuZGVmYXVsdD1mdW5jdGlvbigpe3ZhciBlPWEoKGZ1bmN0aW9uKGUpe3ZhciB0LG4sbztyZXR1cm4gdm9pZCAwPT09ZSYmKGU9e30pLHIodGhpcywoZnVuY3Rpb24ocil7c3dpdGNoKHIubGFiZWwpe2Nhc2UgMDpyZXR1cm4gdD17fSxlLm1pbWVUeXBlcz9lLm1pbWVUeXBlcy5tYXAoKGZ1bmN0aW9uKG4pe3Rbbl09ZS5leHRlbnNpb25zfHxbXX0pKTp0WyIqLioiXT1lLmV4dGVuc2lvbnN8fFtdLFs0LHdpbmRvdy5zaG93T3BlbkZpbGVQaWNrZXIoe3R5cGVzOlt7ZGVzY3JpcHRpb246ZS5kZXNjcmlwdGlvbnx8IiIsYWNjZXB0OnR9XSxtdWx0aXBsZTplLm11bHRpcGxlfHwhMX0pXTtjYXNlIDE6cmV0dXJuIG49ci5zZW50KCksWzQsUHJvbWlzZS5hbGwobi5tYXAoaSkpXTtjYXNlIDI6cmV0dXJuIG89ci5zZW50KCksWzIsZS5tdWx0aXBsZT9vOm9bMF1dfX0pKX0pKTtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fSgpfSxmdW5jdGlvbihlLHQsbil7InVzZSBzdHJpY3QiO24ucih0KTt2YXIgcj1mdW5jdGlvbihlLHQpe3ZhciBuLHIsbyxhLGk9e2xhYmVsOjAsc2VudDpmdW5jdGlvbigpe2lmKDEmb1swXSl0aHJvdyBvWzFdO3JldHVybiBvWzFdfSx0cnlzOltdLG9wczpbXX07cmV0dXJuIGE9e25leHQ6cygwKSx0aHJvdzpzKDEpLHJldHVybjpzKDIpfSwiZnVuY3Rpb24iPT10eXBlb2YgU3ltYm9sJiYoYVtTeW1ib2wuaXRlcmF0b3JdPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9KSxhO2Z1bmN0aW9uIHMoYSl7cmV0dXJuIGZ1bmN0aW9uKHMpe3JldHVybiBmdW5jdGlvbihhKXtpZihuKXRocm93IG5ldyBUeXBlRXJyb3IoIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy4iKTtmb3IoO2k7KXRyeXtpZihuPTEsciYmKG89MiZhWzBdP3IucmV0dXJuOmFbMF0/ci50aHJvd3x8KChvPXIucmV0dXJuKSYmby5jYWxsKHIpLDApOnIubmV4dCkmJiEobz1vLmNhbGwocixhWzFdKSkuZG9uZSlyZXR1cm4gbztzd2l0Y2gocj0wLG8mJihhPVsyJmFbMF0sby52YWx1ZV0pLGFbMF0pe2Nhc2UgMDpjYXNlIDE6bz1hO2JyZWFrO2Nhc2UgNDpyZXR1cm4gaS5sYWJlbCsrLHt2YWx1ZTphWzFdLGRvbmU6ITF9O2Nhc2UgNTppLmxhYmVsKysscj1hWzFdLGE9WzBdO2NvbnRpbnVlO2Nhc2UgNzphPWkub3BzLnBvcCgpLGkudHJ5cy5wb3AoKTtjb250aW51ZTtkZWZhdWx0OmlmKCEobz1pLnRyeXMsKG89by5sZW5ndGg+MCYmb1tvLmxlbmd0aC0xXSl8fDYhPT1hWzBdJiYyIT09YVswXSkpe2k9MDtjb250aW51ZX1pZigzPT09YVswXSYmKCFvfHxhWzFdPm9bMF0mJmFbMV08b1szXSkpe2kubGFiZWw9YVsxXTticmVha31pZig2PT09YVswXSYmaS5sYWJlbDxvWzFdKXtpLmxhYmVsPW9bMV0sbz1hO2JyZWFrfWlmKG8mJmkubGFiZWw8b1syXSl7aS5sYWJlbD1vWzJdLGkub3BzLnB1c2goYSk7YnJlYWt9b1syXSYmaS5vcHMucG9wKCksaS50cnlzLnBvcCgpO2NvbnRpbnVlfWE9dC5jYWxsKGUsaSl9Y2F0Y2goZSl7YT1bNixlXSxyPTB9ZmluYWxseXtuPW89MH1pZig1JmFbMF0pdGhyb3cgYVsxXTtyZXR1cm57dmFsdWU6YVswXT9hWzFdOnZvaWQgMCxkb25lOiEwfX0oW2Esc10pfX19LG89ZnVuY3Rpb24oKXtmb3IodmFyIGU9MCx0PTAsbj1hcmd1bWVudHMubGVuZ3RoO3Q8bjt0KyspZSs9YXJndW1lbnRzW3RdLmxlbmd0aDt2YXIgcj1BcnJheShlKSxvPTA7Zm9yKHQ9MDt0PG47dCsrKWZvcih2YXIgYT1hcmd1bWVudHNbdF0saT0wLHM9YS5sZW5ndGg7aTxzO2krKyxvKyspcltvXT1hW2ldO3JldHVybiByfTtmdW5jdGlvbiBhKGUsdCxuLHIsbyxhLGkpe3RyeXt2YXIgcz1lW2FdKGkpLGw9cy52YWx1ZX1jYXRjaChlKXtyZXR1cm4gdm9pZCBuKGUpfXMuZG9uZT90KGwpOlByb21pc2UucmVzb2x2ZShsKS50aGVuKHIsbyl9dC5kZWZhdWx0PWZ1bmN0aW9uKCl7dmFyIGUsdD0oZT1mdW5jdGlvbihlKXtyZXR1cm4gdm9pZCAwPT09ZSYmKGU9e30pLHIodGhpcywoZnVuY3Rpb24odCl7cmV0dXJuWzIsbmV3IFByb21pc2UoKGZ1bmN0aW9uKHQpe3ZhciBuPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImlucHV0Iik7bi50eXBlPSJmaWxlIjt2YXIgcj1vKGUubWltZVR5cGVzP2UubWltZVR5cGVzOltdLFtlLmV4dGVuc2lvbnM/ZS5leHRlbnNpb25zLm1hcCgoZnVuY3Rpb24oZSl7cmV0dXJuIi4iK2V9KSk6W11dKS5qb2luKCk7bi5tdWx0aXBsZT1lLm11bHRpcGxlfHwhMSxuLmFjY2VwdD1yfHwiKi8qIixuLmFkZEV2ZW50TGlzdGVuZXIoImNoYW5nZSIsKGZ1bmN0aW9uKCl7dChuLm11bHRpcGxlP24uZmlsZXM6bi5maWxlc1swXSl9KSksbi5jbGljaygpfSkpXX0pKX0sZnVuY3Rpb24oKXt2YXIgdD10aGlzLG49YXJndW1lbnRzO3JldHVybiBuZXcgUHJvbWlzZSgoZnVuY3Rpb24ocixvKXt2YXIgaT1lLmFwcGx5KHQsbik7ZnVuY3Rpb24gcyhlKXthKGkscixvLHMsbCwibmV4dCIsZSl9ZnVuY3Rpb24gbChlKXthKGkscixvLHMsbCwidGhyb3ciLGUpfXModm9pZCAwKX0pKX0pO3JldHVybiBmdW5jdGlvbigpe3JldHVybiB0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX19KCl9LGZ1bmN0aW9uKGUsdCxuKXsidXNlIHN0cmljdCI7bi5yKHQpO3ZhciByPWZ1bmN0aW9uKGUsdCl7dmFyIG4scixvLGEsaT17bGFiZWw6MCxzZW50OmZ1bmN0aW9uKCl7aWYoMSZvWzBdKXRocm93IG9bMV07cmV0dXJuIG9bMV19LHRyeXM6W10sb3BzOltdfTtyZXR1cm4gYT17bmV4dDpzKDApLHRocm93OnMoMSkscmV0dXJuOnMoMil9LCJmdW5jdGlvbiI9PXR5cGVvZiBTeW1ib2wmJihhW1N5bWJvbC5pdGVyYXRvcl09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30pLGE7ZnVuY3Rpb24gcyhhKXtyZXR1cm4gZnVuY3Rpb24ocyl7cmV0dXJuIGZ1bmN0aW9uKGEpe2lmKG4pdGhyb3cgbmV3IFR5cGVFcnJvcigiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLiIpO2Zvcig7aTspdHJ5e2lmKG49MSxyJiYobz0yJmFbMF0/ci5yZXR1cm46YVswXT9yLnRocm93fHwoKG89ci5yZXR1cm4pJiZvLmNhbGwociksMCk6ci5uZXh0KSYmIShvPW8uY2FsbChyLGFbMV0pKS5kb25lKXJldHVybiBvO3N3aXRjaChyPTAsbyYmKGE9WzImYVswXSxvLnZhbHVlXSksYVswXSl7Y2FzZSAwOmNhc2UgMTpvPWE7YnJlYWs7Y2FzZSA0OnJldHVybiBpLmxhYmVsKysse3ZhbHVlOmFbMV0sZG9uZTohMX07Y2FzZSA1OmkubGFiZWwrKyxyPWFbMV0sYT1bMF07Y29udGludWU7Y2FzZSA3OmE9aS5vcHMucG9wKCksaS50cnlzLnBvcCgpO2NvbnRpbnVlO2RlZmF1bHQ6aWYoIShvPWkudHJ5cywobz1vLmxlbmd0aD4wJiZvW28ubGVuZ3RoLTFdKXx8NiE9PWFbMF0mJjIhPT1hWzBdKSl7aT0wO2NvbnRpbnVlfWlmKDM9PT1hWzBdJiYoIW98fGFbMV0+b1swXSYmYVsxXTxvWzNdKSl7aS5sYWJlbD1hWzFdO2JyZWFrfWlmKDY9PT1hWzBdJiZpLmxhYmVsPG9bMV0pe2kubGFiZWw9b1sxXSxvPWE7YnJlYWt9aWYobyYmaS5sYWJlbDxvWzJdKXtpLmxhYmVsPW9bMl0saS5vcHMucHVzaChhKTticmVha31vWzJdJiZpLm9wcy5wb3AoKSxpLnRyeXMucG9wKCk7Y29udGludWV9YT10LmNhbGwoZSxpKX1jYXRjaChlKXthPVs2LGVdLHI9MH1maW5hbGx5e249bz0wfWlmKDUmYVswXSl0aHJvdyBhWzFdO3JldHVybnt2YWx1ZTphWzBdP2FbMV06dm9pZCAwLGRvbmU6ITB9fShbYSxzXSl9fX0sbz1mdW5jdGlvbihlKXtpZighU3ltYm9sLmFzeW5jSXRlcmF0b3IpdGhyb3cgbmV3IFR5cGVFcnJvcigiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7dmFyIHQsbj1lW1N5bWJvbC5hc3luY0l0ZXJhdG9yXTtyZXR1cm4gbj9uLmNhbGwoZSk6KGU9ImZ1bmN0aW9uIj09dHlwZW9mIF9fdmFsdWVzP19fdmFsdWVzKGUpOmVbU3ltYm9sLml0ZXJhdG9yXSgpLHQ9e30scigibmV4dCIpLHIoInRocm93IikscigicmV0dXJuIiksdFtTeW1ib2wuYXN5bmNJdGVyYXRvcl09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30sdCk7ZnVuY3Rpb24gcihuKXt0W25dPWVbbl0mJmZ1bmN0aW9uKHQpe3JldHVybiBuZXcgUHJvbWlzZSgoZnVuY3Rpb24ocixvKXsoZnVuY3Rpb24oZSx0LG4scil7UHJvbWlzZS5yZXNvbHZlKHIpLnRoZW4oKGZ1bmN0aW9uKHQpe2Uoe3ZhbHVlOnQsZG9uZTpufSl9KSx0KX0pKHIsbywodD1lW25dKHQpKS5kb25lLHQudmFsdWUpfSkpfX19LGE9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBhPyh0aGlzLnY9ZSx0aGlzKTpuZXcgYShlKX0saT1mdW5jdGlvbigpe2Zvcih2YXIgZT0wLHQ9MCxuPWFyZ3VtZW50cy5sZW5ndGg7dDxuO3QrKyllKz1hcmd1bWVudHNbdF0ubGVuZ3RoO3ZhciByPUFycmF5KGUpLG89MDtmb3IodD0wO3Q8bjt0KyspZm9yKHZhciBhPWFyZ3VtZW50c1t0XSxpPTAscz1hLmxlbmd0aDtpPHM7aSsrLG8rKylyW29dPWFbaV07cmV0dXJuIHJ9O2Z1bmN0aW9uIHMoZSx0LG4scixvLGEsaSl7dHJ5e3ZhciBzPWVbYV0oaSksbD1zLnZhbHVlfWNhdGNoKGUpe3JldHVybiB2b2lkIG4oZSl9cy5kb25lP3QobCk6UHJvbWlzZS5yZXNvbHZlKGwpLnRoZW4ocixvKX1mdW5jdGlvbiBsKGUpe3JldHVybiBmdW5jdGlvbigpe3ZhciB0PXRoaXMsbj1hcmd1bWVudHM7cmV0dXJuIG5ldyBQcm9taXNlKChmdW5jdGlvbihyLG8pe3ZhciBhPWUuYXBwbHkodCxuKTtmdW5jdGlvbiBpKGUpe3MoYSxyLG8saSxsLCJuZXh0IixlKX1mdW5jdGlvbiBsKGUpe3MoYSxyLG8saSxsLCJ0aHJvdyIsZSl9aSh2b2lkIDApfSkpfX12YXIgYz1mdW5jdGlvbigpe3ZhciBlPWwoKGZ1bmN0aW9uKGUsdCxuKXt2YXIgcyxsLHUsZCxwLGgsZixtLGcsYjtyZXR1cm4gdm9pZCAwPT09biYmKG49ZS5uYW1lKSxyKHRoaXMsKGZ1bmN0aW9uKHIpe3N3aXRjaChyLmxhYmVsKXtjYXNlIDA6cz1bXSxsPVtdLHIubGFiZWw9MTtjYXNlIDE6ci50cnlzLnB1c2goWzEsNiw3LDEyXSksdT1vKGUuZ2V0RW50cmllcygpKSxyLmxhYmVsPTI7Y2FzZSAyOnJldHVybls0LGEodS5uZXh0KCkpXTtjYXNlIDM6aWYoKGQ9ci5zZW50KCkpLmRvbmUpcmV0dXJuWzMsNV07cD1kLnZhbHVlLGg9IiIuY29uY2F0KG4sIi8iKS5jb25jYXQocC5uYW1lKSxwLmlzRmlsZT9sLnB1c2gocC5nZXRGaWxlKCkudGhlbigoZnVuY3Rpb24oZSl7cmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLCJ3ZWJraXRSZWxhdGl2ZVBhdGgiLHtjb25maWd1cmFibGU6ITAsZW51bWVyYWJsZTohMCxnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gaH19KX0pKSk6cC5pc0RpcmVjdG9yeSYmdCYmcy5wdXNoKGMocCx0LGgpKSxyLmxhYmVsPTQ7Y2FzZSA0OnJldHVyblszLDJdO2Nhc2UgNTpyZXR1cm5bMywxMl07Y2FzZSA2OnJldHVybiBmPXIuc2VudCgpLGc9e2Vycm9yOmZ9LFszLDEyXTtjYXNlIDc6cmV0dXJuIHIudHJ5cy5wdXNoKFs3LCwxMCwxMV0pLGQmJiFkLmRvbmUmJihiPXUucmV0dXJuKT9bNCxhKGIuY2FsbCh1KSldOlszLDldO2Nhc2UgODpyLnNlbnQoKSxyLmxhYmVsPTk7Y2FzZSA5OnJldHVyblszLDExXTtjYXNlIDEwOmlmKGcpdGhyb3cgZy5lcnJvcjtyZXR1cm5bN107Y2FzZSAxMTpyZXR1cm5bN107Y2FzZSAxMjpyZXR1cm5bNCxQcm9taXNlLmFsbChzKV07Y2FzZSAxMzpyZXR1cm4gbT1bci5zZW50KCkuZmxhdCgpXSxbNCxQcm9taXNlLmFsbChsKV07Y2FzZSAxNDpyZXR1cm5bMixpLmFwcGx5KHZvaWQgMCxtLmNvbmNhdChbci5zZW50KCldKSldfX0pKX0pKTtyZXR1cm4gZnVuY3Rpb24odCxuKXtyZXR1cm4gZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fSgpO3QuZGVmYXVsdD1mdW5jdGlvbigpe3ZhciBlPWwoKGZ1bmN0aW9uKGUpe3ZhciB0O3JldHVybiB2b2lkIDA9PT1lJiYoZT17fSkscih0aGlzLChmdW5jdGlvbihuKXtzd2l0Y2gobi5sYWJlbCl7Y2FzZSAwOnJldHVybiBlLnJlY3Vyc2l2ZT1lLnJlY3Vyc2l2ZXx8ITEsWzQsd2luZG93LmNob29zZUZpbGVTeXN0ZW1FbnRyaWVzKHt0eXBlOiJvcGVuLWRpcmVjdG9yeSJ9KV07Y2FzZSAxOnJldHVybiB0PW4uc2VudCgpLFsyLGModCxlLnJlY3Vyc2l2ZSldfX0pKX0pKTtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fSgpfSxmdW5jdGlvbihlLHQsbil7InVzZSBzdHJpY3QiO24ucih0KTt2YXIgcj1mdW5jdGlvbihlLHQpe3ZhciBuLHIsbyxhLGk9e2xhYmVsOjAsc2VudDpmdW5jdGlvbigpe2lmKDEmb1swXSl0aHJvdyBvWzFdO3JldHVybiBvWzFdfSx0cnlzOltdLG9wczpbXX07cmV0dXJuIGE9e25leHQ6cygwKSx0aHJvdzpzKDEpLHJldHVybjpzKDIpfSwiZnVuY3Rpb24iPT10eXBlb2YgU3ltYm9sJiYoYVtTeW1ib2wuaXRlcmF0b3JdPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9KSxhO2Z1bmN0aW9uIHMoYSl7cmV0dXJuIGZ1bmN0aW9uKHMpe3JldHVybiBmdW5jdGlvbihhKXtpZihuKXRocm93IG5ldyBUeXBlRXJyb3IoIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy4iKTtmb3IoO2k7KXRyeXtpZihuPTEsciYmKG89MiZhWzBdP3IucmV0dXJuOmFbMF0/ci50aHJvd3x8KChvPXIucmV0dXJuKSYmby5jYWxsKHIpLDApOnIubmV4dCkmJiEobz1vLmNhbGwocixhWzFdKSkuZG9uZSlyZXR1cm4gbztzd2l0Y2gocj0wLG8mJihhPVsyJmFbMF0sby52YWx1ZV0pLGFbMF0pe2Nhc2UgMDpjYXNlIDE6bz1hO2JyZWFrO2Nhc2UgNDpyZXR1cm4gaS5sYWJlbCsrLHt2YWx1ZTphWzFdLGRvbmU6ITF9O2Nhc2UgNTppLmxhYmVsKysscj1hWzFdLGE9WzBdO2NvbnRpbnVlO2Nhc2UgNzphPWkub3BzLnBvcCgpLGkudHJ5cy5wb3AoKTtjb250aW51ZTtkZWZhdWx0OmlmKCEobz1pLnRyeXMsKG89by5sZW5ndGg+MCYmb1tvLmxlbmd0aC0xXSl8fDYhPT1hWzBdJiYyIT09YVswXSkpe2k9MDtjb250aW51ZX1pZigzPT09YVswXSYmKCFvfHxhWzFdPm9bMF0mJmFbMV08b1szXSkpe2kubGFiZWw9YVsxXTticmVha31pZig2PT09YVswXSYmaS5sYWJlbDxvWzFdKXtpLmxhYmVsPW9bMV0sbz1hO2JyZWFrfWlmKG8mJmkubGFiZWw8b1syXSl7aS5sYWJlbD1vWzJdLGkub3BzLnB1c2goYSk7YnJlYWt9b1syXSYmaS5vcHMucG9wKCksaS50cnlzLnBvcCgpO2NvbnRpbnVlfWE9dC5jYWxsKGUsaSl9Y2F0Y2goZSl7YT1bNixlXSxyPTB9ZmluYWxseXtuPW89MH1pZig1JmFbMF0pdGhyb3cgYVsxXTtyZXR1cm57dmFsdWU6YVswXT9hWzFdOnZvaWQgMCxkb25lOiEwfX0oW2Esc10pfX19LG89ZnVuY3Rpb24oZSl7aWYoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKXRocm93IG5ldyBUeXBlRXJyb3IoIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLiIpO3ZhciB0LG49ZVtTeW1ib2wuYXN5bmNJdGVyYXRvcl07cmV0dXJuIG4/bi5jYWxsKGUpOihlPSJmdW5jdGlvbiI9PXR5cGVvZiBfX3ZhbHVlcz9fX3ZhbHVlcyhlKTplW1N5bWJvbC5pdGVyYXRvcl0oKSx0PXt9LHIoIm5leHQiKSxyKCJ0aHJvdyIpLHIoInJldHVybiIpLHRbU3ltYm9sLmFzeW5jSXRlcmF0b3JdPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9LHQpO2Z1bmN0aW9uIHIobil7dFtuXT1lW25dJiZmdW5jdGlvbih0KXtyZXR1cm4gbmV3IFByb21pc2UoKGZ1bmN0aW9uKHIsbyl7KGZ1bmN0aW9uKGUsdCxuLHIpe1Byb21pc2UucmVzb2x2ZShyKS50aGVuKChmdW5jdGlvbih0KXtlKHt2YWx1ZTp0LGRvbmU6bn0pfSksdCl9KShyLG8sKHQ9ZVtuXSh0KSkuZG9uZSx0LnZhbHVlKX0pKX19fSxhPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzIGluc3RhbmNlb2YgYT8odGhpcy52PWUsdGhpcyk6bmV3IGEoZSl9LGk9ZnVuY3Rpb24oKXtmb3IodmFyIGU9MCx0PTAsbj1hcmd1bWVudHMubGVuZ3RoO3Q8bjt0KyspZSs9YXJndW1lbnRzW3RdLmxlbmd0aDt2YXIgcj1BcnJheShlKSxvPTA7Zm9yKHQ9MDt0PG47dCsrKWZvcih2YXIgYT1hcmd1bWVudHNbdF0saT0wLHM9YS5sZW5ndGg7aTxzO2krKyxvKyspcltvXT1hW2ldO3JldHVybiByfTtmdW5jdGlvbiBzKGUsdCxuLHIsbyxhLGkpe3RyeXt2YXIgcz1lW2FdKGkpLGw9cy52YWx1ZX1jYXRjaChlKXtyZXR1cm4gdm9pZCBuKGUpfXMuZG9uZT90KGwpOlByb21pc2UucmVzb2x2ZShsKS50aGVuKHIsbyl9ZnVuY3Rpb24gbChlKXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgdD10aGlzLG49YXJndW1lbnRzO3JldHVybiBuZXcgUHJvbWlzZSgoZnVuY3Rpb24ocixvKXt2YXIgYT1lLmFwcGx5KHQsbik7ZnVuY3Rpb24gaShlKXtzKGEscixvLGksbCwibmV4dCIsZSl9ZnVuY3Rpb24gbChlKXtzKGEscixvLGksbCwidGhyb3ciLGUpfWkodm9pZCAwKX0pKX19dmFyIGM9ZnVuY3Rpb24oKXt2YXIgZT1sKChmdW5jdGlvbihlLHQsbil7dmFyIHMsbCx1LGQscCxoLGYsbSxnLGI7cmV0dXJuIHZvaWQgMD09PW4mJihuPWUubmFtZSkscih0aGlzLChmdW5jdGlvbihyKXtzd2l0Y2goci5sYWJlbCl7Y2FzZSAwOnM9W10sbD1bXSxyLmxhYmVsPTE7Y2FzZSAxOnIudHJ5cy5wdXNoKFsxLDYsNywxMl0pLHU9byhlLnZhbHVlcygpKSxyLmxhYmVsPTI7Y2FzZSAyOnJldHVybls0LGEodS5uZXh0KCkpXTtjYXNlIDM6aWYoKGQ9ci5zZW50KCkpLmRvbmUpcmV0dXJuWzMsNV07cD1kLnZhbHVlLGg9IiIuY29uY2F0KG4sIi8iKS5jb25jYXQocC5uYW1lKSwiZmlsZSI9PT1wLmtpbmQ/bC5wdXNoKHAuZ2V0RmlsZSgpLnRoZW4oKGZ1bmN0aW9uKGUpe3JldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkoZSwid2Via2l0UmVsYXRpdmVQYXRoIix7Y29uZmlndXJhYmxlOiEwLGVudW1lcmFibGU6ITAsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGh9fSl9KSkpOiJkaXJlY3RvcnkiPT09cC5raW5kJiZ0JiZzLnB1c2goYyhwLHQsaCkpLHIubGFiZWw9NDtjYXNlIDQ6cmV0dXJuWzMsMl07Y2FzZSA1OnJldHVyblszLDEyXTtjYXNlIDY6cmV0dXJuIGY9ci5zZW50KCksZz17ZXJyb3I6Zn0sWzMsMTJdO2Nhc2UgNzpyZXR1cm4gci50cnlzLnB1c2goWzcsLDEwLDExXSksZCYmIWQuZG9uZSYmKGI9dS5yZXR1cm4pP1s0LGEoYi5jYWxsKHUpKV06WzMsOV07Y2FzZSA4OnIuc2VudCgpLHIubGFiZWw9OTtjYXNlIDk6cmV0dXJuWzMsMTFdO2Nhc2UgMTA6aWYoZyl0aHJvdyBnLmVycm9yO3JldHVybls3XTtjYXNlIDExOnJldHVybls3XTtjYXNlIDEyOnJldHVybls0LFByb21pc2UuYWxsKHMpXTtjYXNlIDEzOnJldHVybiBtPVtyLnNlbnQoKS5mbGF0KCldLFs0LFByb21pc2UuYWxsKGwpXTtjYXNlIDE0OnJldHVyblsyLGkuYXBwbHkodm9pZCAwLG0uY29uY2F0KFtyLnNlbnQoKV0pKV19fSkpfSkpO3JldHVybiBmdW5jdGlvbih0LG4pe3JldHVybiBlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX19KCk7dC5kZWZhdWx0PWZ1bmN0aW9uKCl7dmFyIGU9bCgoZnVuY3Rpb24oZSl7dmFyIHQ7cmV0dXJuIHZvaWQgMD09PWUmJihlPXt9KSxyKHRoaXMsKGZ1bmN0aW9uKG4pe3N3aXRjaChuLmxhYmVsKXtjYXNlIDA6cmV0dXJuIGUucmVjdXJzaXZlPWUucmVjdXJzaXZlfHwhMSxbNCx3aW5kb3cuc2hvd0RpcmVjdG9yeVBpY2tlcigpXTtjYXNlIDE6cmV0dXJuIHQ9bi5zZW50KCksWzIsYyh0LGUucmVjdXJzaXZlKV19fSkpfSkpO3JldHVybiBmdW5jdGlvbigpe3JldHVybiBlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX19KCl9LGZ1bmN0aW9uKGUsdCxuKXsidXNlIHN0cmljdCI7bi5yKHQpO3ZhciByPWZ1bmN0aW9uKGUsdCl7dmFyIG4scixvLGEsaT17bGFiZWw6MCxzZW50OmZ1bmN0aW9uKCl7aWYoMSZvWzBdKXRocm93IG9bMV07cmV0dXJuIG9bMV19LHRyeXM6W10sb3BzOltdfTtyZXR1cm4gYT17bmV4dDpzKDApLHRocm93OnMoMSkscmV0dXJuOnMoMil9LCJmdW5jdGlvbiI9PXR5cGVvZiBTeW1ib2wmJihhW1N5bWJvbC5pdGVyYXRvcl09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30pLGE7ZnVuY3Rpb24gcyhhKXtyZXR1cm4gZnVuY3Rpb24ocyl7cmV0dXJuIGZ1bmN0aW9uKGEpe2lmKG4pdGhyb3cgbmV3IFR5cGVFcnJvcigiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLiIpO2Zvcig7aTspdHJ5e2lmKG49MSxyJiYobz0yJmFbMF0/ci5yZXR1cm46YVswXT9yLnRocm93fHwoKG89ci5yZXR1cm4pJiZvLmNhbGwociksMCk6ci5uZXh0KSYmIShvPW8uY2FsbChyLGFbMV0pKS5kb25lKXJldHVybiBvO3N3aXRjaChyPTAsbyYmKGE9WzImYVswXSxvLnZhbHVlXSksYVswXSl7Y2FzZSAwOmNhc2UgMTpvPWE7YnJlYWs7Y2FzZSA0OnJldHVybiBpLmxhYmVsKysse3ZhbHVlOmFbMV0sZG9uZTohMX07Y2FzZSA1OmkubGFiZWwrKyxyPWFbMV0sYT1bMF07Y29udGludWU7Y2FzZSA3OmE9aS5vcHMucG9wKCksaS50cnlzLnBvcCgpO2NvbnRpbnVlO2RlZmF1bHQ6aWYoIShvPWkudHJ5cywobz1vLmxlbmd0aD4wJiZvW28ubGVuZ3RoLTFdKXx8NiE9PWFbMF0mJjIhPT1hWzBdKSl7aT0wO2NvbnRpbnVlfWlmKDM9PT1hWzBdJiYoIW98fGFbMV0+b1swXSYmYVsxXTxvWzNdKSl7aS5sYWJlbD1hWzFdO2JyZWFrfWlmKDY9PT1hWzBdJiZpLmxhYmVsPG9bMV0pe2kubGFiZWw9b1sxXSxvPWE7YnJlYWt9aWYobyYmaS5sYWJlbDxvWzJdKXtpLmxhYmVsPW9bMl0saS5vcHMucHVzaChhKTticmVha31vWzJdJiZpLm9wcy5wb3AoKSxpLnRyeXMucG9wKCk7Y29udGludWV9YT10LmNhbGwoZSxpKX1jYXRjaChlKXthPVs2LGVdLHI9MH1maW5hbGx5e249bz0wfWlmKDUmYVswXSl0aHJvdyBhWzFdO3JldHVybnt2YWx1ZTphWzBdP2FbMV06dm9pZCAwLGRvbmU6ITB9fShbYSxzXSl9fX07ZnVuY3Rpb24gbyhlLHQsbixyLG8sYSxpKXt0cnl7dmFyIHM9ZVthXShpKSxsPXMudmFsdWV9Y2F0Y2goZSl7cmV0dXJuIHZvaWQgbihlKX1zLmRvbmU/dChsKTpQcm9taXNlLnJlc29sdmUobCkudGhlbihyLG8pfXQuZGVmYXVsdD1mdW5jdGlvbigpe3ZhciBlLHQ9KGU9ZnVuY3Rpb24oZSl7cmV0dXJuIHZvaWQgMD09PWUmJihlPXt9KSxyKHRoaXMsKGZ1bmN0aW9uKHQpe3JldHVyblsyLChlLnJlY3Vyc2l2ZT1lLnJlY3Vyc2l2ZXx8ITEsbmV3IFByb21pc2UoKGZ1bmN0aW9uKHQpe3ZhciBuPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImlucHV0Iik7bi50eXBlPSJmaWxlIixuLndlYmtpdGRpcmVjdG9yeT0hMCxuLmFkZEV2ZW50TGlzdGVuZXIoImNoYW5nZSIsKGZ1bmN0aW9uKCl7dmFyIHI9QXJyYXkuZnJvbShuLmZpbGVzKTtlLnJlY3Vyc2l2ZXx8KHI9ci5maWx0ZXIoKGZ1bmN0aW9uKGUpe3JldHVybiAyPT09ZS53ZWJraXRSZWxhdGl2ZVBhdGguc3BsaXQoIi8iKS5sZW5ndGh9KSkpLHQocil9KSksbi5jbGljaygpfSkpKV19KSl9LGZ1bmN0aW9uKCl7dmFyIHQ9dGhpcyxuPWFyZ3VtZW50cztyZXR1cm4gbmV3IFByb21pc2UoKGZ1bmN0aW9uKHIsYSl7dmFyIGk9ZS5hcHBseSh0LG4pO2Z1bmN0aW9uIHMoZSl7byhpLHIsYSxzLGwsIm5leHQiLGUpfWZ1bmN0aW9uIGwoZSl7byhpLHIsYSxzLGwsInRocm93IixlKX1zKHZvaWQgMCl9KSl9KTtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fSgpfSxmdW5jdGlvbihlLHQsbil7InVzZSBzdHJpY3QiO24ucih0KTt2YXIgcj1mdW5jdGlvbihlLHQpe3ZhciBuLHIsbyxhLGk9e2xhYmVsOjAsc2VudDpmdW5jdGlvbigpe2lmKDEmb1swXSl0aHJvdyBvWzFdO3JldHVybiBvWzFdfSx0cnlzOltdLG9wczpbXX07cmV0dXJuIGE9e25leHQ6cygwKSx0aHJvdzpzKDEpLHJldHVybjpzKDIpfSwiZnVuY3Rpb24iPT10eXBlb2YgU3ltYm9sJiYoYVtTeW1ib2wuaXRlcmF0b3JdPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9KSxhO2Z1bmN0aW9uIHMoYSl7cmV0dXJuIGZ1bmN0aW9uKHMpe3JldHVybiBmdW5jdGlvbihhKXtpZihuKXRocm93IG5ldyBUeXBlRXJyb3IoIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy4iKTtmb3IoO2k7KXRyeXtpZihuPTEsciYmKG89MiZhWzBdP3IucmV0dXJuOmFbMF0/ci50aHJvd3x8KChvPXIucmV0dXJuKSYmby5jYWxsKHIpLDApOnIubmV4dCkmJiEobz1vLmNhbGwocixhWzFdKSkuZG9uZSlyZXR1cm4gbztzd2l0Y2gocj0wLG8mJihhPVsyJmFbMF0sby52YWx1ZV0pLGFbMF0pe2Nhc2UgMDpjYXNlIDE6bz1hO2JyZWFrO2Nhc2UgNDpyZXR1cm4gaS5sYWJlbCsrLHt2YWx1ZTphWzFdLGRvbmU6ITF9O2Nhc2UgNTppLmxhYmVsKysscj1hWzFdLGE9WzBdO2NvbnRpbnVlO2Nhc2UgNzphPWkub3BzLnBvcCgpLGkudHJ5cy5wb3AoKTtjb250aW51ZTtkZWZhdWx0OmlmKCEobz1pLnRyeXMsKG89by5sZW5ndGg+MCYmb1tvLmxlbmd0aC0xXSl8fDYhPT1hWzBdJiYyIT09YVswXSkpe2k9MDtjb250aW51ZX1pZigzPT09YVswXSYmKCFvfHxhWzFdPm9bMF0mJmFbMV08b1szXSkpe2kubGFiZWw9YVsxXTticmVha31pZig2PT09YVswXSYmaS5sYWJlbDxvWzFdKXtpLmxhYmVsPW9bMV0sbz1hO2JyZWFrfWlmKG8mJmkubGFiZWw8b1syXSl7aS5sYWJlbD1vWzJdLGkub3BzLnB1c2goYSk7YnJlYWt9b1syXSYmaS5vcHMucG9wKCksaS50cnlzLnBvcCgpO2NvbnRpbnVlfWE9dC5jYWxsKGUsaSl9Y2F0Y2goZSl7YT1bNixlXSxyPTB9ZmluYWxseXtuPW89MH1pZig1JmFbMF0pdGhyb3cgYVsxXTtyZXR1cm57dmFsdWU6YVswXT9hWzFdOnZvaWQgMCxkb25lOiEwfX0oW2Esc10pfX19O2Z1bmN0aW9uIG8oZSx0LG4scixvLGEsaSl7dHJ5e3ZhciBzPWVbYV0oaSksbD1zLnZhbHVlfWNhdGNoKGUpe3JldHVybiB2b2lkIG4oZSl9cy5kb25lP3QobCk6UHJvbWlzZS5yZXNvbHZlKGwpLnRoZW4ocixvKX10LmRlZmF1bHQ9ZnVuY3Rpb24oKXt2YXIgZSx0PShlPWZ1bmN0aW9uKGUsdCxuKXt2YXIgbyxhO3JldHVybiB2b2lkIDA9PT10JiYodD17fSksdm9pZCAwPT09biYmKG49bnVsbCkscih0aGlzLChmdW5jdGlvbihyKXtzd2l0Y2goci5sYWJlbCl7Y2FzZSAwOnJldHVybiB0LmZpbGVOYW1lPXQuZmlsZU5hbWV8fCJVbnRpdGxlZCIsKG89bik/WzMsMl06WzQsd2luZG93LmNob29zZUZpbGVTeXN0ZW1FbnRyaWVzKHt0eXBlOiJzYXZlLWZpbGUiLGFjY2VwdHM6W3tkZXNjcmlwdGlvbjp0LmRlc2NyaXB0aW9ufHwiIixtaW1lVHlwZXM6W2UudHlwZV0sZXh0ZW5zaW9uczp0LmV4dGVuc2lvbnN8fFsiIl19XX0pXTtjYXNlIDE6bz1yLnNlbnQoKSxyLmxhYmVsPTI7Y2FzZSAyOnJldHVybls0LChuPW8pLmNyZWF0ZVdyaXRhYmxlKCldO2Nhc2UgMzpyZXR1cm5bNCwoYT1yLnNlbnQoKSkud3JpdGUoZSldO2Nhc2UgNDpyZXR1cm4gci5zZW50KCksWzQsYS5jbG9zZSgpXTtjYXNlIDU6cmV0dXJuWzIsKHIuc2VudCgpLG4pXX19KSl9LGZ1bmN0aW9uKCl7dmFyIHQ9dGhpcyxuPWFyZ3VtZW50cztyZXR1cm4gbmV3IFByb21pc2UoKGZ1bmN0aW9uKHIsYSl7dmFyIGk9ZS5hcHBseSh0LG4pO2Z1bmN0aW9uIHMoZSl7byhpLHIsYSxzLGwsIm5leHQiLGUpfWZ1bmN0aW9uIGwoZSl7byhpLHIsYSxzLGwsInRocm93IixlKX1zKHZvaWQgMCl9KSl9KTtyZXR1cm4gZnVuY3Rpb24oZSl7cmV0dXJuIHQuYXBwbHkodGhpcyxhcmd1bWVudHMpfX0oKX0sZnVuY3Rpb24oZSx0LG4peyJ1c2Ugc3RyaWN0IjtuLnIodCk7dmFyIHI9ZnVuY3Rpb24oZSx0KXt2YXIgbixyLG8sYSxpPXtsYWJlbDowLHNlbnQ6ZnVuY3Rpb24oKXtpZigxJm9bMF0pdGhyb3cgb1sxXTtyZXR1cm4gb1sxXX0sdHJ5czpbXSxvcHM6W119O3JldHVybiBhPXtuZXh0OnMoMCksdGhyb3c6cygxKSxyZXR1cm46cygyKX0sImZ1bmN0aW9uIj09dHlwZW9mIFN5bWJvbCYmKGFbU3ltYm9sLml0ZXJhdG9yXT1mdW5jdGlvbigpe3JldHVybiB0aGlzfSksYTtmdW5jdGlvbiBzKGEpe3JldHVybiBmdW5jdGlvbihzKXtyZXR1cm4gZnVuY3Rpb24oYSl7aWYobil0aHJvdyBuZXcgVHlwZUVycm9yKCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuIik7Zm9yKDtpOyl0cnl7aWYobj0xLHImJihvPTImYVswXT9yLnJldHVybjphWzBdP3IudGhyb3d8fCgobz1yLnJldHVybikmJm8uY2FsbChyKSwwKTpyLm5leHQpJiYhKG89by5jYWxsKHIsYVsxXSkpLmRvbmUpcmV0dXJuIG87c3dpdGNoKHI9MCxvJiYoYT1bMiZhWzBdLG8udmFsdWVdKSxhWzBdKXtjYXNlIDA6Y2FzZSAxOm89YTticmVhaztjYXNlIDQ6cmV0dXJuIGkubGFiZWwrKyx7dmFsdWU6YVsxXSxkb25lOiExfTtjYXNlIDU6aS5sYWJlbCsrLHI9YVsxXSxhPVswXTtjb250aW51ZTtjYXNlIDc6YT1pLm9wcy5wb3AoKSxpLnRyeXMucG9wKCk7Y29udGludWU7ZGVmYXVsdDppZighKG89aS50cnlzLChvPW8ubGVuZ3RoPjAmJm9bby5sZW5ndGgtMV0pfHw2IT09YVswXSYmMiE9PWFbMF0pKXtpPTA7Y29udGludWV9aWYoMz09PWFbMF0mJighb3x8YVsxXT5vWzBdJiZhWzFdPG9bM10pKXtpLmxhYmVsPWFbMV07YnJlYWt9aWYoNj09PWFbMF0mJmkubGFiZWw8b1sxXSl7aS5sYWJlbD1vWzFdLG89YTticmVha31pZihvJiZpLmxhYmVsPG9bMl0pe2kubGFiZWw9b1syXSxpLm9wcy5wdXNoKGEpO2JyZWFrfW9bMl0mJmkub3BzLnBvcCgpLGkudHJ5cy5wb3AoKTtjb250aW51ZX1hPXQuY2FsbChlLGkpfWNhdGNoKGUpe2E9WzYsZV0scj0wfWZpbmFsbHl7bj1vPTB9aWYoNSZhWzBdKXRocm93IGFbMV07cmV0dXJue3ZhbHVlOmFbMF0/YVsxXTp2b2lkIDAsZG9uZTohMH19KFthLHNdKX19fTtmdW5jdGlvbiBvKGUsdCxuLHIsbyxhLGkpe3RyeXt2YXIgcz1lW2FdKGkpLGw9cy52YWx1ZX1jYXRjaChlKXtyZXR1cm4gdm9pZCBuKGUpfXMuZG9uZT90KGwpOlByb21pc2UucmVzb2x2ZShsKS50aGVuKHIsbyl9dC5kZWZhdWx0PWZ1bmN0aW9uKCl7dmFyIGUsdD0oZT1mdW5jdGlvbihlLHQsbil7dmFyIG8sYSxpO3JldHVybiB2b2lkIDA9PT10JiYodD17fSksdm9pZCAwPT09biYmKG49bnVsbCkscih0aGlzLChmdW5jdGlvbihyKXtzd2l0Y2goci5sYWJlbCl7Y2FzZSAwOnJldHVybiB0LmZpbGVOYW1lPXQuZmlsZU5hbWV8fCJVbnRpdGxlZCIsKG89bik/WzMsMl06WzQsd2luZG93LnNob3dTYXZlRmlsZVBpY2tlcih7dHlwZXM6W3tkZXNjcmlwdGlvbjp0LmRlc2NyaXB0aW9ufHwiIixhY2NlcHQ6KGk9e30saVtlLnR5cGVdPXQuZXh0ZW5zaW9uc3x8WyIiXSxpKX1dfSldO2Nhc2UgMTpvPXIuc2VudCgpLHIubGFiZWw9MjtjYXNlIDI6cmV0dXJuWzQsKG49bykuY3JlYXRlV3JpdGFibGUoKV07Y2FzZSAzOnJldHVybls0LChhPXIuc2VudCgpKS53cml0ZShlKV07Y2FzZSA0OnJldHVybiByLnNlbnQoKSxbNCxhLmNsb3NlKCldO2Nhc2UgNTpyZXR1cm5bMiwoci5zZW50KCksbildfX0pKX0sZnVuY3Rpb24oKXt2YXIgdD10aGlzLG49YXJndW1lbnRzO3JldHVybiBuZXcgUHJvbWlzZSgoZnVuY3Rpb24ocixhKXt2YXIgaT1lLmFwcGx5KHQsbik7ZnVuY3Rpb24gcyhlKXtvKGkscixhLHMsbCwibmV4dCIsZSl9ZnVuY3Rpb24gbChlKXtvKGkscixhLHMsbCwidGhyb3ciLGUpfXModm9pZCAwKX0pKX0pO3JldHVybiBmdW5jdGlvbihlKXtyZXR1cm4gdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fSgpfSxmdW5jdGlvbihlLHQsbil7InVzZSBzdHJpY3QiO24ucih0KTt2YXIgcj1mdW5jdGlvbihlLHQpe3ZhciBuLHIsbyxhLGk9e2xhYmVsOjAsc2VudDpmdW5jdGlvbigpe2lmKDEmb1swXSl0aHJvdyBvWzFdO3JldHVybiBvWzFdfSx0cnlzOltdLG9wczpbXX07cmV0dXJuIGE9e25leHQ6cygwKSx0aHJvdzpzKDEpLHJldHVybjpzKDIpfSwiZnVuY3Rpb24iPT10eXBlb2YgU3ltYm9sJiYoYVtTeW1ib2wuaXRlcmF0b3JdPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9KSxhO2Z1bmN0aW9uIHMoYSl7cmV0dXJuIGZ1bmN0aW9uKHMpe3JldHVybiBmdW5jdGlvbihhKXtpZihuKXRocm93IG5ldyBUeXBlRXJyb3IoIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy4iKTtmb3IoO2k7KXRyeXtpZihuPTEsciYmKG89MiZhWzBdP3IucmV0dXJuOmFbMF0/ci50aHJvd3x8KChvPXIucmV0dXJuKSYmby5jYWxsKHIpLDApOnIubmV4dCkmJiEobz1vLmNhbGwocixhWzFdKSkuZG9uZSlyZXR1cm4gbztzd2l0Y2gocj0wLG8mJihhPVsyJmFbMF0sby52YWx1ZV0pLGFbMF0pe2Nhc2UgMDpjYXNlIDE6bz1hO2JyZWFrO2Nhc2UgNDpyZXR1cm4gaS5sYWJlbCsrLHt2YWx1ZTphWzFdLGRvbmU6ITF9O2Nhc2UgNTppLmxhYmVsKysscj1hWzFdLGE9WzBdO2NvbnRpbnVlO2Nhc2UgNzphPWkub3BzLnBvcCgpLGkudHJ5cy5wb3AoKTtjb250aW51ZTtkZWZhdWx0OmlmKCEobz1pLnRyeXMsKG89by5sZW5ndGg+MCYmb1tvLmxlbmd0aC0xXSl8fDYhPT1hWzBdJiYyIT09YVswXSkpe2k9MDtjb250aW51ZX1pZigzPT09YVswXSYmKCFvfHxhWzFdPm9bMF0mJmFbMV08b1szXSkpe2kubGFiZWw9YVsxXTticmVha31pZig2PT09YVswXSYmaS5sYWJlbDxvWzFdKXtpLmxhYmVsPW9bMV0sbz1hO2JyZWFrfWlmKG8mJmkubGFiZWw8b1syXSl7aS5sYWJlbD1vWzJdLGkub3BzLnB1c2goYSk7YnJlYWt9b1syXSYmaS5vcHMucG9wKCksaS50cnlzLnBvcCgpO2NvbnRpbnVlfWE9dC5jYWxsKGUsaSl9Y2F0Y2goZSl7YT1bNixlXSxyPTB9ZmluYWxseXtuPW89MH1pZig1JmFbMF0pdGhyb3cgYVsxXTtyZXR1cm57dmFsdWU6YVswXT9hWzFdOnZvaWQgMCxkb25lOiEwfX0oW2Esc10pfX19O2Z1bmN0aW9uIG8oZSx0LG4scixvLGEsaSl7dHJ5e3ZhciBzPWVbYV0oaSksbD1zLnZhbHVlfWNhdGNoKGUpe3JldHVybiB2b2lkIG4oZSl9cy5kb25lP3QobCk6UHJvbWlzZS5yZXNvbHZlKGwpLnRoZW4ocixvKX10LmRlZmF1bHQ9ZnVuY3Rpb24oKXt2YXIgZSx0PShlPWZ1bmN0aW9uKGUsdCl7dmFyIG47cmV0dXJuIHZvaWQgMD09PXQmJih0PXt9KSxyKHRoaXMsKGZ1bmN0aW9uKHIpe3JldHVybihuPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImEiKSkuZG93bmxvYWQ9dC5maWxlTmFtZXx8IlVudGl0bGVkIixuLmhyZWY9VVJMLmNyZWF0ZU9iamVjdFVSTChlKSxuLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwoZnVuY3Rpb24oKXtzZXRUaW1lb3V0KChmdW5jdGlvbigpe3JldHVybiBVUkwucmV2b2tlT2JqZWN0VVJMKG4uaHJlZil9KSwzZTQpfSkpLG4uY2xpY2soKSxbMl19KSl9LGZ1bmN0aW9uKCl7dmFyIHQ9dGhpcyxuPWFyZ3VtZW50cztyZXR1cm4gbmV3IFByb21pc2UoKGZ1bmN0aW9uKHIsYSl7dmFyIGk9ZS5hcHBseSh0LG4pO2Z1bmN0aW9uIHMoZSl7byhpLHIsYSxzLGwsIm5leHQiLGUpfWZ1bmN0aW9uIGwoZSl7byhpLHIsYSxzLGwsInRocm93IixlKX1zKHZvaWQgMCl9KSl9KTtyZXR1cm4gZnVuY3Rpb24oZSl7cmV0dXJuIHQuYXBwbHkodGhpcyxhcmd1bWVudHMpfX0oKX1dKX0pKTs=",mtime:1744325324165},"assets/main.js":{data:"data:application/javascript;base64,bGV0IGFwcFN0YXRlOwpsZXQgZWxlbWVudHM7CgpmdW5jdGlvbiBvbkNoYW5nZShlbGVtZW50cywgc3RhdGUpIHsKICBjb25zb2xlLmxvZygib25DaGFuZ2UiLHtlbGVtZW50cyxzdGF0ZX0pCn0KCmNvbnN0IEFwcCA9ICh7IGRvYyB9KSA9PiB7CiAgY29uc3QgdGhlbWUgPSBkb2MuYXBwU3RhdGU/LnRoZW1lIHx8ICJsaWdodCI7CiAgY29uc29sZS5sb2coe0V4Y2FsaWRyYXcsIEV4Y2FsaWRyYXdMaWJ9KQoKICByZXR1cm4gUmVhY3QuY3JlYXRlRWxlbWVudCgKICAgIFJlYWN0LkZyYWdtZW50LAogICAgbnVsbCwKICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoCiAgICAgICJkaXYiLCB7CiAgICAgICAgc3R5bGU6IHsgaGVpZ2h0OiAiNTAwcHgiIH0sCiAgICAgIH0sCiAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoRXhjYWxpZHJhd0xpYi5kZWZhdWx0LCB7CiAgICAgICAgb25DaGFuZ2UsIAogICAgICAgIGluaXRpYWxEYXRhOiBkb2MsIAogICAgICAgIFVJT3B0aW9uczogeyBjYW52YXNBY3Rpb25zOiB7IHRvZ2dsZVRoZW1lOiB0cnVlIH19LAogICAgICAgIHRoZW1lCiAgICAgIH0pLAogICAgKSwKICApOwp9OwoKYXN5bmMgZnVuY3Rpb24gb3BlbihkYXRhLCBleHRlbnNpb24pewogIGNvbnN0IGV4Y2FsaWRyYXdDb250ZW50ID0gbmV3IFRleHREZWNvZGVyKCkuZGVjb2RlKGRhdGEpOwogIGNvbnN0IGRvYyA9IEpTT04ucGFyc2UoZXhjYWxpZHJhd0NvbnRlbnQpOwoKICBjb25zdCBleGNhbGlkcmF3V3JhcHBlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJhcHAiKTsKICBjb25zdCByb290ID0gUmVhY3RET00uY3JlYXRlUm9vdChleGNhbGlkcmF3V3JhcHBlcik7CiAgcm9vdC5yZW5kZXIoUmVhY3QuY3JlYXRlRWxlbWVudChBcHAsIHtkb2N9KSk7Cn0KCmdsb2JhbFRoaXMuc2lsdmVyYnVsbGV0LmFkZEV2ZW50TGlzdGVuZXIoImZpbGUtb3BlbiIsIChldmVudCkgPT4gb3BlbihldmVudC5kZXRhaWwuZGF0YSwgZXZlbnQuZGV0YWlsLm1ldGEuZXh0ZW5zaW9uKSk7Ci8vIGdsb2JhbFRoaXMuc2lsdmVyYnVsbGV0LmFkZEV2ZW50TGlzdGVuZXIoImZpbGUtdXBkYXRlIiwgKGV2ZW50KSA9PiBjb25zb2xlLmxvZygidXBkYXRlIiwgZXZlbnQuZGV0YWlsLmRhdGEsIGV2ZW50LmRldGFpbC5tZXRhLmV4dGVuc2lvbikpOwo=",mtime:1744325324207},"assets/react-dom.development.js":{data:"data:application/javascript;base64,LyoqCiAqIEBsaWNlbnNlIFJlYWN0CiAqIHJlYWN0LWRvbS5kZXZlbG9wbWVudC5qcwogKgogKiBDb3B5cmlnaHQgKGMpIEZhY2Vib29rLCBJbmMuIGFuZCBpdHMgYWZmaWxpYXRlcy4KICoKICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgZm91bmQgaW4gdGhlCiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS4KICovCihmdW5jdGlvbiAoZ2xvYmFsLCBmYWN0b3J5KSB7CiAgdHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnID8gZmFjdG9yeShleHBvcnRzLCByZXF1aXJlKCdyZWFjdCcpKSA6CiAgdHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kID8gZGVmaW5lKFsnZXhwb3J0cycsICdyZWFjdCddLCBmYWN0b3J5KSA6CiAgKGdsb2JhbCA9IGdsb2JhbCB8fCBzZWxmLCBmYWN0b3J5KGdsb2JhbC5SZWFjdERPTSA9IHt9LCBnbG9iYWwuUmVhY3QpKTsKfSh0aGlzLCAoZnVuY3Rpb24gKGV4cG9ydHMsIFJlYWN0KSB7ICd1c2Ugc3RyaWN0JzsKCiAgdmFyIFJlYWN0U2hhcmVkSW50ZXJuYWxzID0gUmVhY3QuX19TRUNSRVRfSU5URVJOQUxTX0RPX05PVF9VU0VfT1JfWU9VX1dJTExfQkVfRklSRUQ7CgogIHZhciBzdXBwcmVzc1dhcm5pbmcgPSBmYWxzZTsKICBmdW5jdGlvbiBzZXRTdXBwcmVzc1dhcm5pbmcobmV3U3VwcHJlc3NXYXJuaW5nKSB7CiAgICB7CiAgICAgIHN1cHByZXNzV2FybmluZyA9IG5ld1N1cHByZXNzV2FybmluZzsKICAgIH0KICB9IC8vIEluIERFViwgY2FsbHMgdG8gY29uc29sZS53YXJuIGFuZCBjb25zb2xlLmVycm9yIGdldCByZXBsYWNlZAogIC8vIGJ5IGNhbGxzIHRvIHRoZXNlIG1ldGhvZHMgYnkgYSBCYWJlbCBwbHVnaW4uCiAgLy8KICAvLyBJbiBQUk9EIChvciBpbiBwYWNrYWdlcyB3aXRob3V0IGFjY2VzcyB0byBSZWFjdCBpbnRlcm5hbHMpLAogIC8vIHRoZXkgYXJlIGxlZnQgYXMgdGhleSBhcmUgaW5zdGVhZC4KCiAgZnVuY3Rpb24gd2Fybihmb3JtYXQpIHsKICAgIHsKICAgICAgaWYgKCFzdXBwcmVzc1dhcm5pbmcpIHsKICAgICAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuID4gMSA/IF9sZW4gLSAxIDogMCksIF9rZXkgPSAxOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7CiAgICAgICAgICBhcmdzW19rZXkgLSAxXSA9IGFyZ3VtZW50c1tfa2V5XTsKICAgICAgICB9CgogICAgICAgIHByaW50V2FybmluZygnd2FybicsIGZvcm1hdCwgYXJncyk7CiAgICAgIH0KICAgIH0KICB9CiAgZnVuY3Rpb24gZXJyb3IoZm9ybWF0KSB7CiAgICB7CiAgICAgIGlmICghc3VwcHJlc3NXYXJuaW5nKSB7CiAgICAgICAgZm9yICh2YXIgX2xlbjIgPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4yID4gMSA/IF9sZW4yIC0gMSA6IDApLCBfa2V5MiA9IDE7IF9rZXkyIDwgX2xlbjI7IF9rZXkyKyspIHsKICAgICAgICAgIGFyZ3NbX2tleTIgLSAxXSA9IGFyZ3VtZW50c1tfa2V5Ml07CiAgICAgICAgfQoKICAgICAgICBwcmludFdhcm5pbmcoJ2Vycm9yJywgZm9ybWF0LCBhcmdzKTsKICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gcHJpbnRXYXJuaW5nKGxldmVsLCBmb3JtYXQsIGFyZ3MpIHsKICAgIC8vIFdoZW4gY2hhbmdpbmcgdGhpcyBsb2dpYywgeW91IG1pZ2h0IHdhbnQgdG8gYWxzbwogICAgLy8gdXBkYXRlIGNvbnNvbGVXaXRoU3RhY2tEZXYud3d3LmpzIGFzIHdlbGwuCiAgICB7CiAgICAgIHZhciBSZWFjdERlYnVnQ3VycmVudEZyYW1lID0gUmVhY3RTaGFyZWRJbnRlcm5hbHMuUmVhY3REZWJ1Z0N1cnJlbnRGcmFtZTsKICAgICAgdmFyIHN0YWNrID0gUmVhY3REZWJ1Z0N1cnJlbnRGcmFtZS5nZXRTdGFja0FkZGVuZHVtKCk7CgogICAgICBpZiAoc3RhY2sgIT09ICcnKSB7CiAgICAgICAgZm9ybWF0ICs9ICclcyc7CiAgICAgICAgYXJncyA9IGFyZ3MuY29uY2F0KFtzdGFja10pOwogICAgICB9IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC1pbnRlcm5hbC9zYWZlLXN0cmluZy1jb2VyY2lvbgoKCiAgICAgIHZhciBhcmdzV2l0aEZvcm1hdCA9IGFyZ3MubWFwKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgcmV0dXJuIFN0cmluZyhpdGVtKTsKICAgICAgfSk7IC8vIENhcmVmdWw6IFJOIGN1cnJlbnRseSBkZXBlbmRzIG9uIHRoaXMgcHJlZml4CgogICAgICBhcmdzV2l0aEZvcm1hdC51bnNoaWZ0KCdXYXJuaW5nOiAnICsgZm9ybWF0KTsgLy8gV2UgaW50ZW50aW9uYWxseSBkb24ndCB1c2Ugc3ByZWFkIChvciAuYXBwbHkpIGRpcmVjdGx5IGJlY2F1c2UgaXQKICAgICAgLy8gYnJlYWtzIElFOTogaHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL3JlYWN0L2lzc3Vlcy8xMzYxMAogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaW50ZXJuYWwvbm8tcHJvZHVjdGlvbi1sb2dnaW5nCgogICAgICBGdW5jdGlvbi5wcm90b3R5cGUuYXBwbHkuY2FsbChjb25zb2xlW2xldmVsXSwgY29uc29sZSwgYXJnc1dpdGhGb3JtYXQpOwogICAgfQogIH0KCiAgdmFyIEZ1bmN0aW9uQ29tcG9uZW50ID0gMDsKICB2YXIgQ2xhc3NDb21wb25lbnQgPSAxOwogIHZhciBJbmRldGVybWluYXRlQ29tcG9uZW50ID0gMjsgLy8gQmVmb3JlIHdlIGtub3cgd2hldGhlciBpdCBpcyBmdW5jdGlvbiBvciBjbGFzcwoKICB2YXIgSG9zdFJvb3QgPSAzOyAvLyBSb290IG9mIGEgaG9zdCB0cmVlLiBDb3VsZCBiZSBuZXN0ZWQgaW5zaWRlIGFub3RoZXIgbm9kZS4KCiAgdmFyIEhvc3RQb3J0YWwgPSA0OyAvLyBBIHN1YnRyZWUuIENvdWxkIGJlIGFuIGVudHJ5IHBvaW50IHRvIGEgZGlmZmVyZW50IHJlbmRlcmVyLgoKICB2YXIgSG9zdENvbXBvbmVudCA9IDU7CiAgdmFyIEhvc3RUZXh0ID0gNjsKICB2YXIgRnJhZ21lbnQgPSA3OwogIHZhciBNb2RlID0gODsKICB2YXIgQ29udGV4dENvbnN1bWVyID0gOTsKICB2YXIgQ29udGV4dFByb3ZpZGVyID0gMTA7CiAgdmFyIEZvcndhcmRSZWYgPSAxMTsKICB2YXIgUHJvZmlsZXIgPSAxMjsKICB2YXIgU3VzcGVuc2VDb21wb25lbnQgPSAxMzsKICB2YXIgTWVtb0NvbXBvbmVudCA9IDE0OwogIHZhciBTaW1wbGVNZW1vQ29tcG9uZW50ID0gMTU7CiAgdmFyIExhenlDb21wb25lbnQgPSAxNjsKICB2YXIgSW5jb21wbGV0ZUNsYXNzQ29tcG9uZW50ID0gMTc7CiAgdmFyIERlaHlkcmF0ZWRGcmFnbWVudCA9IDE4OwogIHZhciBTdXNwZW5zZUxpc3RDb21wb25lbnQgPSAxOTsKICB2YXIgU2NvcGVDb21wb25lbnQgPSAyMTsKICB2YXIgT2Zmc2NyZWVuQ29tcG9uZW50ID0gMjI7CiAgdmFyIExlZ2FjeUhpZGRlbkNvbXBvbmVudCA9IDIzOwogIHZhciBDYWNoZUNvbXBvbmVudCA9IDI0OwogIHZhciBUcmFjaW5nTWFya2VyQ29tcG9uZW50ID0gMjU7CgogIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgogIHZhciBlbmFibGVDbGllbnRSZW5kZXJGYWxsYmFja09uVGV4dE1pc21hdGNoID0gdHJ1ZTsgLy8gVE9ETzogTmVlZCB0byByZXZpZXcgdGhpcyBjb2RlIG9uZSBtb3JlIHRpbWUgYmVmb3JlIGxhbmRpbmcKICAvLyB0aGUgcmVhY3QtcmVjb25jaWxlciBwYWNrYWdlLgoKICB2YXIgZW5hYmxlTmV3UmVjb25jaWxlciA9IGZhbHNlOyAvLyBTdXBwb3J0IGxlZ2FjeSBQcmltZXIgc3VwcG9ydCBvbiBpbnRlcm5hbCBGQiB3d3cKCiAgdmFyIGVuYWJsZUxhenlDb250ZXh0UHJvcGFnYXRpb24gPSBmYWxzZTsgLy8gRkItb25seSB1c2FnZS4gVGhlIG5ldyBBUEkgaGFzIGRpZmZlcmVudCBzZW1hbnRpY3MuCgogIHZhciBlbmFibGVMZWdhY3lIaWRkZW4gPSBmYWxzZTsgLy8gRW5hYmxlcyB1bnN0YWJsZV9hdm9pZFRoaXNGYWxsYmFjayBmZWF0dXJlIGluIEZpYmVyCgogIHZhciBlbmFibGVTdXNwZW5zZUF2b2lkVGhpc0ZhbGxiYWNrID0gZmFsc2U7IC8vIEVuYWJsZXMgdW5zdGFibGVfYXZvaWRUaGlzRmFsbGJhY2sgZmVhdHVyZSBpbiBGaXp6CiAgLy8gUmVhY3QgRE9NIENob3BwaW5nIEJsb2NrCiAgLy8KICAvLyBTaW1pbGFyIHRvIG1haW4gQ2hvcHBpbmcgQmxvY2sgYnV0IG9ubHkgZmxhZ3MgcmVsYXRlZCB0byBSZWFjdCBET00uIFRoZXNlIGFyZQogIC8vIGdyb3VwZWQgYmVjYXVzZSB3ZSB3aWxsIGxpa2VseSBiYXRjaCBhbGwgb2YgdGhlbSBpbnRvIGEgc2luZ2xlIG1ham9yIHJlbGVhc2UuCiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAvLyBEaXNhYmxlIHN1cHBvcnQgZm9yIGNvbW1lbnQgbm9kZXMgYXMgUmVhY3QgRE9NIGNvbnRhaW5lcnMuIEFscmVhZHkgZGlzYWJsZWQKICAvLyBpbiBvcGVuIHNvdXJjZSwgYnV0IHd3dyBjb2RlYmFzZSBzdGlsbCByZWxpZXMgb24gaXQuIE5lZWQgdG8gcmVtb3ZlLgoKICB2YXIgZGlzYWJsZUNvbW1lbnRzQXNET01Db250YWluZXJzID0gdHJ1ZTsgLy8gRGlzYWJsZSBqYXZhc2NyaXB0OiBVUkwgc3RyaW5ncyBpbiBocmVmIGZvciBYU1MgcHJvdGVjdGlvbi4KICAvLyBhbmQgY2xpZW50IHJlbmRlcmluZywgbW9zdGx5IHRvIGFsbG93IEpTWCBhdHRyaWJ1dGVzIHRvIGFwcGx5IHRvIHRoZSBjdXN0b20KICAvLyBlbGVtZW50J3Mgb2JqZWN0IHByb3BlcnRpZXMgaW5zdGVhZCBvZiBvbmx5IEhUTUwgYXR0cmlidXRlcy4KICAvLyBodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2svcmVhY3QvaXNzdWVzLzExMzQ3CgogIHZhciBlbmFibGVDdXN0b21FbGVtZW50UHJvcGVydHlTdXBwb3J0ID0gZmFsc2U7IC8vIERpc2FibGVzIGNoaWxkcmVuIGZvciA8dGV4dGFyZWE+IGVsZW1lbnRzCiAgdmFyIHdhcm5BYm91dFN0cmluZ1JlZnMgPSB0cnVlOyAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogIC8vIERlYnVnZ2luZyBhbmQgRGV2VG9vbHMKICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogIC8vIEFkZHMgdXNlciB0aW1pbmcgbWFya3MgZm9yIGUuZy4gc3RhdGUgdXBkYXRlcywgc3VzcGVuc2UsIGFuZCB3b3JrIGxvb3Agc3R1ZmYsCiAgLy8gZm9yIGFuIGV4cGVyaW1lbnRhbCB0aW1lbGluZSB0b29sLgoKICB2YXIgZW5hYmxlU2NoZWR1bGluZ1Byb2ZpbGVyID0gdHJ1ZTsgLy8gSGVscHMgaWRlbnRpZnkgc2lkZSBlZmZlY3RzIGluIHJlbmRlci1waGFzZSBsaWZlY3ljbGUgaG9va3MgYW5kIHNldFN0YXRlCgogIHZhciBlbmFibGVQcm9maWxlclRpbWVyID0gdHJ1ZTsgLy8gUmVjb3JkIGR1cmF0aW9ucyBmb3IgY29tbWl0IGFuZCBwYXNzaXZlIGVmZmVjdHMgcGhhc2VzLgoKICB2YXIgZW5hYmxlUHJvZmlsZXJDb21taXRIb29rcyA9IHRydWU7IC8vIFBoYXNlIHBhcmFtIHBhc3NlZCB0byBvblJlbmRlciBjYWxsYmFjayBkaWZmZXJlbnRpYXRlcyBiZXR3ZWVuIGFuICJ1cGRhdGUiIGFuZCBhICJjYXNjYWRpbmctdXBkYXRlIi4KCiAgdmFyIGFsbE5hdGl2ZUV2ZW50cyA9IG5ldyBTZXQoKTsKICAvKioKICAgKiBNYXBwaW5nIGZyb20gcmVnaXN0cmF0aW9uIG5hbWUgdG8gZXZlbnQgbmFtZQogICAqLwoKCiAgdmFyIHJlZ2lzdHJhdGlvbk5hbWVEZXBlbmRlbmNpZXMgPSB7fTsKICAvKioKICAgKiBNYXBwaW5nIGZyb20gbG93ZXJjYXNlIHJlZ2lzdHJhdGlvbiBuYW1lcyB0byB0aGUgcHJvcGVybHkgY2FzZWQgdmVyc2lvbiwKICAgKiB1c2VkIHRvIHdhcm4gaW4gdGhlIGNhc2Ugb2YgbWlzc2luZyBldmVudCBoYW5kbGVycy4gQXZhaWxhYmxlCiAgICogb25seSBpbiB0cnVlLgogICAqIEB0eXBlIHtPYmplY3R9CiAgICovCgogIHZhciBwb3NzaWJsZVJlZ2lzdHJhdGlvbk5hbWVzID0gIHt9IDsgLy8gVHJ1c3QgdGhlIGRldmVsb3BlciB0byBvbmx5IHVzZSBwb3NzaWJsZVJlZ2lzdHJhdGlvbk5hbWVzIGluIHRydWUKCiAgZnVuY3Rpb24gcmVnaXN0ZXJUd29QaGFzZUV2ZW50KHJlZ2lzdHJhdGlvbk5hbWUsIGRlcGVuZGVuY2llcykgewogICAgcmVnaXN0ZXJEaXJlY3RFdmVudChyZWdpc3RyYXRpb25OYW1lLCBkZXBlbmRlbmNpZXMpOwogICAgcmVnaXN0ZXJEaXJlY3RFdmVudChyZWdpc3RyYXRpb25OYW1lICsgJ0NhcHR1cmUnLCBkZXBlbmRlbmNpZXMpOwogIH0KICBmdW5jdGlvbiByZWdpc3RlckRpcmVjdEV2ZW50KHJlZ2lzdHJhdGlvbk5hbWUsIGRlcGVuZGVuY2llcykgewogICAgewogICAgICBpZiAocmVnaXN0cmF0aW9uTmFtZURlcGVuZGVuY2llc1tyZWdpc3RyYXRpb25OYW1lXSkgewogICAgICAgIGVycm9yKCdFdmVudFJlZ2lzdHJ5OiBNb3JlIHRoYW4gb25lIHBsdWdpbiBhdHRlbXB0ZWQgdG8gcHVibGlzaCB0aGUgc2FtZSAnICsgJ3JlZ2lzdHJhdGlvbiBuYW1lLCBgJXNgLicsIHJlZ2lzdHJhdGlvbk5hbWUpOwogICAgICB9CiAgICB9CgogICAgcmVnaXN0cmF0aW9uTmFtZURlcGVuZGVuY2llc1tyZWdpc3RyYXRpb25OYW1lXSA9IGRlcGVuZGVuY2llczsKCiAgICB7CiAgICAgIHZhciBsb3dlckNhc2VkTmFtZSA9IHJlZ2lzdHJhdGlvbk5hbWUudG9Mb3dlckNhc2UoKTsKICAgICAgcG9zc2libGVSZWdpc3RyYXRpb25OYW1lc1tsb3dlckNhc2VkTmFtZV0gPSByZWdpc3RyYXRpb25OYW1lOwoKICAgICAgaWYgKHJlZ2lzdHJhdGlvbk5hbWUgPT09ICdvbkRvdWJsZUNsaWNrJykgewogICAgICAgIHBvc3NpYmxlUmVnaXN0cmF0aW9uTmFtZXMub25kYmxjbGljayA9IHJlZ2lzdHJhdGlvbk5hbWU7CiAgICAgIH0KICAgIH0KCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRlcGVuZGVuY2llcy5sZW5ndGg7IGkrKykgewogICAgICBhbGxOYXRpdmVFdmVudHMuYWRkKGRlcGVuZGVuY2llc1tpXSk7CiAgICB9CiAgfQoKICB2YXIgY2FuVXNlRE9NID0gISEodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIHdpbmRvdy5kb2N1bWVudCAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIHdpbmRvdy5kb2N1bWVudC5jcmVhdGVFbGVtZW50ICE9PSAndW5kZWZpbmVkJyk7CgogIHZhciBoYXNPd25Qcm9wZXJ0eSA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7CgogIC8qCiAgICogVGhlIGAnJyArIHZhbHVlYCBwYXR0ZXJuICh1c2VkIGluIGluIHBlcmYtc2Vuc2l0aXZlIGNvZGUpIHRocm93cyBmb3IgU3ltYm9sCiAgICogYW5kIFRlbXBvcmFsLiogdHlwZXMuIFNlZSBodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2svcmVhY3QvcHVsbC8yMjA2NC4KICAgKgogICAqIFRoZSBmdW5jdGlvbnMgaW4gdGhpcyBtb2R1bGUgd2lsbCB0aHJvdyBhbiBlYXNpZXItdG8tdW5kZXJzdGFuZCwKICAgKiBlYXNpZXItdG8tZGVidWcgZXhjZXB0aW9uIHdpdGggYSBjbGVhciBlcnJvcnMgbWVzc2FnZSBtZXNzYWdlIGV4cGxhaW5pbmcgdGhlCiAgICogcHJvYmxlbS4gKEluc3RlYWQgb2YgYSBjb25mdXNpbmcgZXhjZXB0aW9uIHRocm93biBpbnNpZGUgdGhlIGltcGxlbWVudGF0aW9uCiAgICogb2YgdGhlIGB2YWx1ZWAgb2JqZWN0KS4KICAgKi8KICAvLyAkRmxvd0ZpeE1lIG9ubHkgY2FsbGVkIGluIERFViwgc28gdm9pZCByZXR1cm4gaXMgbm90IHBvc3NpYmxlLgogIGZ1bmN0aW9uIHR5cGVOYW1lKHZhbHVlKSB7CiAgICB7CiAgICAgIC8vIHRvU3RyaW5nVGFnIGlzIG5lZWRlZCBmb3IgbmFtZXNwYWNlZCB0eXBlcyBsaWtlIFRlbXBvcmFsLkluc3RhbnQKICAgICAgdmFyIGhhc1RvU3RyaW5nVGFnID0gdHlwZW9mIFN5bWJvbCA9PT0gJ2Z1bmN0aW9uJyAmJiBTeW1ib2wudG9TdHJpbmdUYWc7CiAgICAgIHZhciB0eXBlID0gaGFzVG9TdHJpbmdUYWcgJiYgdmFsdWVbU3ltYm9sLnRvU3RyaW5nVGFnXSB8fCB2YWx1ZS5jb25zdHJ1Y3Rvci5uYW1lIHx8ICdPYmplY3QnOwogICAgICByZXR1cm4gdHlwZTsKICAgIH0KICB9IC8vICRGbG93Rml4TWUgb25seSBjYWxsZWQgaW4gREVWLCBzbyB2b2lkIHJldHVybiBpcyBub3QgcG9zc2libGUuCgoKICBmdW5jdGlvbiB3aWxsQ29lcmNpb25UaHJvdyh2YWx1ZSkgewogICAgewogICAgICB0cnkgewogICAgICAgIHRlc3RTdHJpbmdDb2VyY2lvbih2YWx1ZSk7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIHRlc3RTdHJpbmdDb2VyY2lvbih2YWx1ZSkgewogICAgLy8gSWYgeW91IGVuZGVkIHVwIGhlcmUgYnkgZm9sbG93aW5nIGFuIGV4Y2VwdGlvbiBjYWxsIHN0YWNrLCBoZXJlJ3Mgd2hhdCdzCiAgICAvLyBoYXBwZW5lZDogeW91IHN1cHBsaWVkIGFuIG9iamVjdCBvciBzeW1ib2wgdmFsdWUgdG8gUmVhY3QgKGFzIGEgcHJvcCwga2V5LAogICAgLy8gRE9NIGF0dHJpYnV0ZSwgQ1NTIHByb3BlcnR5LCBzdHJpbmcgcmVmLCBldGMuKSBhbmQgd2hlbiBSZWFjdCB0cmllZCB0bwogICAgLy8gY29lcmNlIGl0IHRvIGEgc3RyaW5nIHVzaW5nIGAnJyArIHZhbHVlYCwgYW4gZXhjZXB0aW9uIHdhcyB0aHJvd24uCiAgICAvLwogICAgLy8gVGhlIG1vc3QgY29tbW9uIHR5cGVzIHRoYXQgd2lsbCBjYXVzZSB0aGlzIGV4Y2VwdGlvbiBhcmUgYFN5bWJvbGAgaW5zdGFuY2VzCiAgICAvLyBhbmQgVGVtcG9yYWwgb2JqZWN0cyBsaWtlIGBUZW1wb3JhbC5JbnN0YW50YC4gQnV0IGFueSBvYmplY3QgdGhhdCBoYXMgYQogICAgLy8gYHZhbHVlT2ZgIG9yIGBbU3ltYm9sLnRvUHJpbWl0aXZlXWAgbWV0aG9kIHRoYXQgdGhyb3dzIHdpbGwgYWxzbyBjYXVzZSB0aGlzCiAgICAvLyBleGNlcHRpb24uIChMaWJyYXJ5IGF1dGhvcnMgZG8gdGhpcyB0byBwcmV2ZW50IHVzZXJzIGZyb20gdXNpbmcgYnVpbHQtaW4KICAgIC8vIG51bWVyaWMgb3BlcmF0b3JzIGxpa2UgYCtgIG9yIGNvbXBhcmlzb24gb3BlcmF0b3JzIGxpa2UgYD49YCBiZWNhdXNlIGN1c3RvbQogICAgLy8gbWV0aG9kcyBhcmUgbmVlZGVkIHRvIHBlcmZvcm0gYWNjdXJhdGUgYXJpdGhtZXRpYyBvciBjb21wYXJpc29uLikKICAgIC8vCiAgICAvLyBUbyBmaXggdGhlIHByb2JsZW0sIGNvZXJjZSB0aGlzIG9iamVjdCBvciBzeW1ib2wgdmFsdWUgdG8gYSBzdHJpbmcgYmVmb3JlCiAgICAvLyBwYXNzaW5nIGl0IHRvIFJlYWN0LiBUaGUgbW9zdCByZWxpYWJsZSB3YXkgaXMgdXN1YWxseSBgU3RyaW5nKHZhbHVlKWAuCiAgICAvLwogICAgLy8gVG8gZmluZCB3aGljaCB2YWx1ZSBpcyB0aHJvd2luZywgY2hlY2sgdGhlIGJyb3dzZXIgb3IgZGVidWdnZXIgY29uc29sZS4KICAgIC8vIEJlZm9yZSB0aGlzIGV4Y2VwdGlvbiB3YXMgdGhyb3duLCB0aGVyZSBzaG91bGQgYmUgYGNvbnNvbGUuZXJyb3JgIG91dHB1dAogICAgLy8gdGhhdCBzaG93cyB0aGUgdHlwZSAoU3ltYm9sLCBUZW1wb3JhbC5QbGFpbkRhdGUsIGV0Yy4pIHRoYXQgY2F1c2VkIHRoZQogICAgLy8gcHJvYmxlbSBhbmQgaG93IHRoYXQgdHlwZSB3YXMgdXNlZDoga2V5LCBhdHJyaWJ1dGUsIGlucHV0IHZhbHVlIHByb3AsIGV0Yy4KICAgIC8vIEluIG1vc3QgY2FzZXMsIHRoaXMgY29uc29sZSBvdXRwdXQgYWxzbyBzaG93cyB0aGUgY29tcG9uZW50IGFuZCBpdHMKICAgIC8vIGFuY2VzdG9yIGNvbXBvbmVudHMgd2hlcmUgdGhlIGV4Y2VwdGlvbiBoYXBwZW5lZC4KICAgIC8vCiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaW50ZXJuYWwvc2FmZS1zdHJpbmctY29lcmNpb24KICAgIHJldHVybiAnJyArIHZhbHVlOwogIH0KCiAgZnVuY3Rpb24gY2hlY2tBdHRyaWJ1dGVTdHJpbmdDb2VyY2lvbih2YWx1ZSwgYXR0cmlidXRlTmFtZSkgewogICAgewogICAgICBpZiAod2lsbENvZXJjaW9uVGhyb3codmFsdWUpKSB7CiAgICAgICAgZXJyb3IoJ1RoZSBwcm92aWRlZCBgJXNgIGF0dHJpYnV0ZSBpcyBhbiB1bnN1cHBvcnRlZCB0eXBlICVzLicgKyAnIFRoaXMgdmFsdWUgbXVzdCBiZSBjb2VyY2VkIHRvIGEgc3RyaW5nIGJlZm9yZSBiZWZvcmUgdXNpbmcgaXQgaGVyZS4nLCBhdHRyaWJ1dGVOYW1lLCB0eXBlTmFtZSh2YWx1ZSkpOwoKICAgICAgICByZXR1cm4gdGVzdFN0cmluZ0NvZXJjaW9uKHZhbHVlKTsgLy8gdGhyb3cgKHRvIGhlbHAgY2FsbGVycyBmaW5kIHRyb3VibGVzaG9vdGluZyBjb21tZW50cykKICAgICAgfQogICAgfQogIH0KICBmdW5jdGlvbiBjaGVja0tleVN0cmluZ0NvZXJjaW9uKHZhbHVlKSB7CiAgICB7CiAgICAgIGlmICh3aWxsQ29lcmNpb25UaHJvdyh2YWx1ZSkpIHsKICAgICAgICBlcnJvcignVGhlIHByb3ZpZGVkIGtleSBpcyBhbiB1bnN1cHBvcnRlZCB0eXBlICVzLicgKyAnIFRoaXMgdmFsdWUgbXVzdCBiZSBjb2VyY2VkIHRvIGEgc3RyaW5nIGJlZm9yZSBiZWZvcmUgdXNpbmcgaXQgaGVyZS4nLCB0eXBlTmFtZSh2YWx1ZSkpOwoKICAgICAgICByZXR1cm4gdGVzdFN0cmluZ0NvZXJjaW9uKHZhbHVlKTsgLy8gdGhyb3cgKHRvIGhlbHAgY2FsbGVycyBmaW5kIHRyb3VibGVzaG9vdGluZyBjb21tZW50cykKICAgICAgfQogICAgfQogIH0KICBmdW5jdGlvbiBjaGVja1Byb3BTdHJpbmdDb2VyY2lvbih2YWx1ZSwgcHJvcE5hbWUpIHsKICAgIHsKICAgICAgaWYgKHdpbGxDb2VyY2lvblRocm93KHZhbHVlKSkgewogICAgICAgIGVycm9yKCdUaGUgcHJvdmlkZWQgYCVzYCBwcm9wIGlzIGFuIHVuc3VwcG9ydGVkIHR5cGUgJXMuJyArICcgVGhpcyB2YWx1ZSBtdXN0IGJlIGNvZXJjZWQgdG8gYSBzdHJpbmcgYmVmb3JlIGJlZm9yZSB1c2luZyBpdCBoZXJlLicsIHByb3BOYW1lLCB0eXBlTmFtZSh2YWx1ZSkpOwoKICAgICAgICByZXR1cm4gdGVzdFN0cmluZ0NvZXJjaW9uKHZhbHVlKTsgLy8gdGhyb3cgKHRvIGhlbHAgY2FsbGVycyBmaW5kIHRyb3VibGVzaG9vdGluZyBjb21tZW50cykKICAgICAgfQogICAgfQogIH0KICBmdW5jdGlvbiBjaGVja0NTU1Byb3BlcnR5U3RyaW5nQ29lcmNpb24odmFsdWUsIHByb3BOYW1lKSB7CiAgICB7CiAgICAgIGlmICh3aWxsQ29lcmNpb25UaHJvdyh2YWx1ZSkpIHsKICAgICAgICBlcnJvcignVGhlIHByb3ZpZGVkIGAlc2AgQ1NTIHByb3BlcnR5IGlzIGFuIHVuc3VwcG9ydGVkIHR5cGUgJXMuJyArICcgVGhpcyB2YWx1ZSBtdXN0IGJlIGNvZXJjZWQgdG8gYSBzdHJpbmcgYmVmb3JlIGJlZm9yZSB1c2luZyBpdCBoZXJlLicsIHByb3BOYW1lLCB0eXBlTmFtZSh2YWx1ZSkpOwoKICAgICAgICByZXR1cm4gdGVzdFN0cmluZ0NvZXJjaW9uKHZhbHVlKTsgLy8gdGhyb3cgKHRvIGhlbHAgY2FsbGVycyBmaW5kIHRyb3VibGVzaG9vdGluZyBjb21tZW50cykKICAgICAgfQogICAgfQogIH0KICBmdW5jdGlvbiBjaGVja0h0bWxTdHJpbmdDb2VyY2lvbih2YWx1ZSkgewogICAgewogICAgICBpZiAod2lsbENvZXJjaW9uVGhyb3codmFsdWUpKSB7CiAgICAgICAgZXJyb3IoJ1RoZSBwcm92aWRlZCBIVE1MIG1hcmt1cCB1c2VzIGEgdmFsdWUgb2YgdW5zdXBwb3J0ZWQgdHlwZSAlcy4nICsgJyBUaGlzIHZhbHVlIG11c3QgYmUgY29lcmNlZCB0byBhIHN0cmluZyBiZWZvcmUgYmVmb3JlIHVzaW5nIGl0IGhlcmUuJywgdHlwZU5hbWUodmFsdWUpKTsKCiAgICAgICAgcmV0dXJuIHRlc3RTdHJpbmdDb2VyY2lvbih2YWx1ZSk7IC8vIHRocm93ICh0byBoZWxwIGNhbGxlcnMgZmluZCB0cm91Ymxlc2hvb3RpbmcgY29tbWVudHMpCiAgICAgIH0KICAgIH0KICB9CiAgZnVuY3Rpb24gY2hlY2tGb3JtRmllbGRWYWx1ZVN0cmluZ0NvZXJjaW9uKHZhbHVlKSB7CiAgICB7CiAgICAgIGlmICh3aWxsQ29lcmNpb25UaHJvdyh2YWx1ZSkpIHsKICAgICAgICBlcnJvcignRm9ybSBmaWVsZCB2YWx1ZXMgKHZhbHVlLCBjaGVja2VkLCBkZWZhdWx0VmFsdWUsIG9yIGRlZmF1bHRDaGVja2VkIHByb3BzKScgKyAnIG11c3QgYmUgc3RyaW5ncywgbm90ICVzLicgKyAnIFRoaXMgdmFsdWUgbXVzdCBiZSBjb2VyY2VkIHRvIGEgc3RyaW5nIGJlZm9yZSBiZWZvcmUgdXNpbmcgaXQgaGVyZS4nLCB0eXBlTmFtZSh2YWx1ZSkpOwoKICAgICAgICByZXR1cm4gdGVzdFN0cmluZ0NvZXJjaW9uKHZhbHVlKTsgLy8gdGhyb3cgKHRvIGhlbHAgY2FsbGVycyBmaW5kIHRyb3VibGVzaG9vdGluZyBjb21tZW50cykKICAgICAgfQogICAgfQogIH0KCiAgLy8gQSByZXNlcnZlZCBhdHRyaWJ1dGUuCiAgLy8gSXQgaXMgaGFuZGxlZCBieSBSZWFjdCBzZXBhcmF0ZWx5IGFuZCBzaG91bGRuJ3QgYmUgd3JpdHRlbiB0byB0aGUgRE9NLgogIHZhciBSRVNFUlZFRCA9IDA7IC8vIEEgc2ltcGxlIHN0cmluZyBhdHRyaWJ1dGUuCiAgLy8gQXR0cmlidXRlcyB0aGF0IGFyZW4ndCBpbiB0aGUgZmlsdGVyIGFyZSBwcmVzdW1lZCB0byBoYXZlIHRoaXMgdHlwZS4KCiAgdmFyIFNUUklORyA9IDE7IC8vIEEgc3RyaW5nIGF0dHJpYnV0ZSB0aGF0IGFjY2VwdHMgYm9vbGVhbnMgaW4gUmVhY3QuIEluIEhUTUwsIHRoZXNlIGFyZSBjYWxsZWQKICAvLyAiZW51bWVyYXRlZCIgYXR0cmlidXRlcyB3aXRoICJ0cnVlIiBhbmQgImZhbHNlIiBhcyBwb3NzaWJsZSB2YWx1ZXMuCiAgLy8gV2hlbiB0cnVlLCBpdCBzaG91bGQgYmUgc2V0IHRvIGEgInRydWUiIHN0cmluZy4KICAvLyBXaGVuIGZhbHNlLCBpdCBzaG91bGQgYmUgc2V0IHRvIGEgImZhbHNlIiBzdHJpbmcuCgogIHZhciBCT09MRUFOSVNIX1NUUklORyA9IDI7IC8vIEEgcmVhbCBib29sZWFuIGF0dHJpYnV0ZS4KICAvLyBXaGVuIHRydWUsIGl0IHNob3VsZCBiZSBwcmVzZW50IChzZXQgZWl0aGVyIHRvIGFuIGVtcHR5IHN0cmluZyBvciBpdHMgbmFtZSkuCiAgLy8gV2hlbiBmYWxzZSwgaXQgc2hvdWxkIGJlIG9taXR0ZWQuCgogIHZhciBCT09MRUFOID0gMzsgLy8gQW4gYXR0cmlidXRlIHRoYXQgY2FuIGJlIHVzZWQgYXMgYSBmbGFnIGFzIHdlbGwgYXMgd2l0aCBhIHZhbHVlLgogIC8vIFdoZW4gdHJ1ZSwgaXQgc2hvdWxkIGJlIHByZXNlbnQgKHNldCBlaXRoZXIgdG8gYW4gZW1wdHkgc3RyaW5nIG9yIGl0cyBuYW1lKS4KICAvLyBXaGVuIGZhbHNlLCBpdCBzaG91bGQgYmUgb21pdHRlZC4KICAvLyBGb3IgYW55IG90aGVyIHZhbHVlLCBzaG91bGQgYmUgcHJlc2VudCB3aXRoIHRoYXQgdmFsdWUuCgogIHZhciBPVkVSTE9BREVEX0JPT0xFQU4gPSA0OyAvLyBBbiBhdHRyaWJ1dGUgdGhhdCBtdXN0IGJlIG51bWVyaWMgb3IgcGFyc2UgYXMgYSBudW1lcmljLgogIC8vIFdoZW4gZmFsc3ksIGl0IHNob3VsZCBiZSByZW1vdmVkLgoKICB2YXIgTlVNRVJJQyA9IDU7IC8vIEFuIGF0dHJpYnV0ZSB0aGF0IG11c3QgYmUgcG9zaXRpdmUgbnVtZXJpYyBvciBwYXJzZSBhcyBhIHBvc2l0aXZlIG51bWVyaWMuCiAgLy8gV2hlbiBmYWxzeSwgaXQgc2hvdWxkIGJlIHJlbW92ZWQuCgogIHZhciBQT1NJVElWRV9OVU1FUklDID0gNjsKCiAgLyogZXNsaW50LWRpc2FibGUgbWF4LWxlbiAqLwogIHZhciBBVFRSSUJVVEVfTkFNRV9TVEFSVF9DSEFSID0gIjpBLVpfYS16XFx1MDBDMC1cXHUwMEQ2XFx1MDBEOC1cXHUwMEY2XFx1MDBGOC1cXHUwMkZGXFx1MDM3MC1cXHUwMzdEXFx1MDM3Ri1cXHUxRkZGXFx1MjAwQy1cXHUyMDBEXFx1MjA3MC1cXHUyMThGXFx1MkMwMC1cXHUyRkVGXFx1MzAwMS1cXHVEN0ZGXFx1RjkwMC1cXHVGRENGXFx1RkRGMC1cXHVGRkZEIjsKICAvKiBlc2xpbnQtZW5hYmxlIG1heC1sZW4gKi8KCiAgdmFyIEFUVFJJQlVURV9OQU1FX0NIQVIgPSBBVFRSSUJVVEVfTkFNRV9TVEFSVF9DSEFSICsgIlxcLS4wLTlcXHUwMEI3XFx1MDMwMC1cXHUwMzZGXFx1MjAzRi1cXHUyMDQwIjsKICB2YXIgVkFMSURfQVRUUklCVVRFX05BTUVfUkVHRVggPSBuZXcgUmVnRXhwKCdeWycgKyBBVFRSSUJVVEVfTkFNRV9TVEFSVF9DSEFSICsgJ11bJyArIEFUVFJJQlVURV9OQU1FX0NIQVIgKyAnXSokJyk7CiAgdmFyIGlsbGVnYWxBdHRyaWJ1dGVOYW1lQ2FjaGUgPSB7fTsKICB2YXIgdmFsaWRhdGVkQXR0cmlidXRlTmFtZUNhY2hlID0ge307CiAgZnVuY3Rpb24gaXNBdHRyaWJ1dGVOYW1lU2FmZShhdHRyaWJ1dGVOYW1lKSB7CiAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbCh2YWxpZGF0ZWRBdHRyaWJ1dGVOYW1lQ2FjaGUsIGF0dHJpYnV0ZU5hbWUpKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKGlsbGVnYWxBdHRyaWJ1dGVOYW1lQ2FjaGUsIGF0dHJpYnV0ZU5hbWUpKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBpZiAoVkFMSURfQVRUUklCVVRFX05BTUVfUkVHRVgudGVzdChhdHRyaWJ1dGVOYW1lKSkgewogICAgICB2YWxpZGF0ZWRBdHRyaWJ1dGVOYW1lQ2FjaGVbYXR0cmlidXRlTmFtZV0gPSB0cnVlOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBpbGxlZ2FsQXR0cmlidXRlTmFtZUNhY2hlW2F0dHJpYnV0ZU5hbWVdID0gdHJ1ZTsKCiAgICB7CiAgICAgIGVycm9yKCdJbnZhbGlkIGF0dHJpYnV0ZSBuYW1lOiBgJXNgJywgYXR0cmlidXRlTmFtZSk7CiAgICB9CgogICAgcmV0dXJuIGZhbHNlOwogIH0KICBmdW5jdGlvbiBzaG91bGRJZ25vcmVBdHRyaWJ1dGUobmFtZSwgcHJvcGVydHlJbmZvLCBpc0N1c3RvbUNvbXBvbmVudFRhZykgewogICAgaWYgKHByb3BlcnR5SW5mbyAhPT0gbnVsbCkgewogICAgICByZXR1cm4gcHJvcGVydHlJbmZvLnR5cGUgPT09IFJFU0VSVkVEOwogICAgfQoKICAgIGlmIChpc0N1c3RvbUNvbXBvbmVudFRhZykgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgaWYgKG5hbWUubGVuZ3RoID4gMiAmJiAobmFtZVswXSA9PT0gJ28nIHx8IG5hbWVbMF0gPT09ICdPJykgJiYgKG5hbWVbMV0gPT09ICduJyB8fCBuYW1lWzFdID09PSAnTicpKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHJldHVybiBmYWxzZTsKICB9CiAgZnVuY3Rpb24gc2hvdWxkUmVtb3ZlQXR0cmlidXRlV2l0aFdhcm5pbmcobmFtZSwgdmFsdWUsIHByb3BlcnR5SW5mbywgaXNDdXN0b21Db21wb25lbnRUYWcpIHsKICAgIGlmIChwcm9wZXJ0eUluZm8gIT09IG51bGwgJiYgcHJvcGVydHlJbmZvLnR5cGUgPT09IFJFU0VSVkVEKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBzd2l0Y2ggKHR5cGVvZiB2YWx1ZSkgewogICAgICBjYXNlICdmdW5jdGlvbic6IC8vICRGbG93SXNzdWUgc3ltYm9sIGlzIHBlcmZlY3RseSB2YWxpZCBoZXJlCgogICAgICBjYXNlICdzeW1ib2wnOgogICAgICAgIC8vIGVzbGludC1kaXNhYmxlLWxpbmUKICAgICAgICByZXR1cm4gdHJ1ZTsKCiAgICAgIGNhc2UgJ2Jvb2xlYW4nOgogICAgICAgIHsKICAgICAgICAgIGlmIChpc0N1c3RvbUNvbXBvbmVudFRhZykgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHByb3BlcnR5SW5mbyAhPT0gbnVsbCkgewogICAgICAgICAgICByZXR1cm4gIXByb3BlcnR5SW5mby5hY2NlcHRzQm9vbGVhbnM7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB2YXIgcHJlZml4ID0gbmFtZS50b0xvd2VyQ2FzZSgpLnNsaWNlKDAsIDUpOwogICAgICAgICAgICByZXR1cm4gcHJlZml4ICE9PSAnZGF0YS0nICYmIHByZWZpeCAhPT0gJ2FyaWEtJzsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICBkZWZhdWx0OgogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9CiAgZnVuY3Rpb24gc2hvdWxkUmVtb3ZlQXR0cmlidXRlKG5hbWUsIHZhbHVlLCBwcm9wZXJ0eUluZm8sIGlzQ3VzdG9tQ29tcG9uZW50VGFnKSB7CiAgICBpZiAodmFsdWUgPT09IG51bGwgfHwgdHlwZW9mIHZhbHVlID09PSAndW5kZWZpbmVkJykgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBpZiAoc2hvdWxkUmVtb3ZlQXR0cmlidXRlV2l0aFdhcm5pbmcobmFtZSwgdmFsdWUsIHByb3BlcnR5SW5mbywgaXNDdXN0b21Db21wb25lbnRUYWcpKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGlmIChpc0N1c3RvbUNvbXBvbmVudFRhZykgewoKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIGlmIChwcm9wZXJ0eUluZm8gIT09IG51bGwpIHsKCiAgICAgIHN3aXRjaCAocHJvcGVydHlJbmZvLnR5cGUpIHsKICAgICAgICBjYXNlIEJPT0xFQU46CiAgICAgICAgICByZXR1cm4gIXZhbHVlOwoKICAgICAgICBjYXNlIE9WRVJMT0FERURfQk9PTEVBTjoKICAgICAgICAgIHJldHVybiB2YWx1ZSA9PT0gZmFsc2U7CgogICAgICAgIGNhc2UgTlVNRVJJQzoKICAgICAgICAgIHJldHVybiBpc05hTih2YWx1ZSk7CgogICAgICAgIGNhc2UgUE9TSVRJVkVfTlVNRVJJQzoKICAgICAgICAgIHJldHVybiBpc05hTih2YWx1ZSkgfHwgdmFsdWUgPCAxOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIGZhbHNlOwogIH0KICBmdW5jdGlvbiBnZXRQcm9wZXJ0eUluZm8obmFtZSkgewogICAgcmV0dXJuIHByb3BlcnRpZXMuaGFzT3duUHJvcGVydHkobmFtZSkgPyBwcm9wZXJ0aWVzW25hbWVdIDogbnVsbDsKICB9CgogIGZ1bmN0aW9uIFByb3BlcnR5SW5mb1JlY29yZChuYW1lLCB0eXBlLCBtdXN0VXNlUHJvcGVydHksIGF0dHJpYnV0ZU5hbWUsIGF0dHJpYnV0ZU5hbWVzcGFjZSwgc2FuaXRpemVVUkwsIHJlbW92ZUVtcHR5U3RyaW5nKSB7CiAgICB0aGlzLmFjY2VwdHNCb29sZWFucyA9IHR5cGUgPT09IEJPT0xFQU5JU0hfU1RSSU5HIHx8IHR5cGUgPT09IEJPT0xFQU4gfHwgdHlwZSA9PT0gT1ZFUkxPQURFRF9CT09MRUFOOwogICAgdGhpcy5hdHRyaWJ1dGVOYW1lID0gYXR0cmlidXRlTmFtZTsKICAgIHRoaXMuYXR0cmlidXRlTmFtZXNwYWNlID0gYXR0cmlidXRlTmFtZXNwYWNlOwogICAgdGhpcy5tdXN0VXNlUHJvcGVydHkgPSBtdXN0VXNlUHJvcGVydHk7CiAgICB0aGlzLnByb3BlcnR5TmFtZSA9IG5hbWU7CiAgICB0aGlzLnR5cGUgPSB0eXBlOwogICAgdGhpcy5zYW5pdGl6ZVVSTCA9IHNhbml0aXplVVJMOwogICAgdGhpcy5yZW1vdmVFbXB0eVN0cmluZyA9IHJlbW92ZUVtcHR5U3RyaW5nOwogIH0gLy8gV2hlbiBhZGRpbmcgYXR0cmlidXRlcyB0byB0aGlzIGxpc3QsIGJlIHN1cmUgdG8gYWxzbyBhZGQgdGhlbSB0bwogIC8vIHRoZSBgcG9zc2libGVTdGFuZGFyZE5hbWVzYCBtb2R1bGUgdG8gZW5zdXJlIGNhc2luZyBhbmQgaW5jb3JyZWN0CiAgLy8gbmFtZSB3YXJuaW5ncy4KCgogIHZhciBwcm9wZXJ0aWVzID0ge307IC8vIFRoZXNlIHByb3BzIGFyZSByZXNlcnZlZCBieSBSZWFjdC4gVGhleSBzaG91bGRuJ3QgYmUgd3JpdHRlbiB0byB0aGUgRE9NLgoKICB2YXIgcmVzZXJ2ZWRQcm9wcyA9IFsnY2hpbGRyZW4nLCAnZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUwnLCAvLyBUT0RPOiBUaGlzIHByZXZlbnRzIHRoZSBhc3NpZ25tZW50IG9mIGRlZmF1bHRWYWx1ZSB0byByZWd1bGFyCiAgLy8gZWxlbWVudHMgKG5vdCBqdXN0IGlucHV0cykuIE5vdyB0aGF0IFJlYWN0RE9NSW5wdXQgYXNzaWducyB0byB0aGUKICAvLyBkZWZhdWx0VmFsdWUgcHJvcGVydHkgLS0gZG8gd2UgbmVlZCB0aGlzPwogICdkZWZhdWx0VmFsdWUnLCAnZGVmYXVsdENoZWNrZWQnLCAnaW5uZXJIVE1MJywgJ3N1cHByZXNzQ29udGVudEVkaXRhYmxlV2FybmluZycsICdzdXBwcmVzc0h5ZHJhdGlvbldhcm5pbmcnLCAnc3R5bGUnXTsKCiAgcmVzZXJ2ZWRQcm9wcy5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7CiAgICBwcm9wZXJ0aWVzW25hbWVdID0gbmV3IFByb3BlcnR5SW5mb1JlY29yZChuYW1lLCBSRVNFUlZFRCwgZmFsc2UsIC8vIG11c3RVc2VQcm9wZXJ0eQogICAgbmFtZSwgLy8gYXR0cmlidXRlTmFtZQogICAgbnVsbCwgLy8gYXR0cmlidXRlTmFtZXNwYWNlCiAgICBmYWxzZSwgLy8gc2FuaXRpemVVUkwKICAgIGZhbHNlKTsKICB9KTsgLy8gQSBmZXcgUmVhY3Qgc3RyaW5nIGF0dHJpYnV0ZXMgaGF2ZSBhIGRpZmZlcmVudCBuYW1lLgogIC8vIFRoaXMgaXMgYSBtYXBwaW5nIGZyb20gUmVhY3QgcHJvcCBuYW1lcyB0byB0aGUgYXR0cmlidXRlIG5hbWVzLgoKICBbWydhY2NlcHRDaGFyc2V0JywgJ2FjY2VwdC1jaGFyc2V0J10sIFsnY2xhc3NOYW1lJywgJ2NsYXNzJ10sIFsnaHRtbEZvcicsICdmb3InXSwgWydodHRwRXF1aXYnLCAnaHR0cC1lcXVpdiddXS5mb3JFYWNoKGZ1bmN0aW9uIChfcmVmKSB7CiAgICB2YXIgbmFtZSA9IF9yZWZbMF0sCiAgICAgICAgYXR0cmlidXRlTmFtZSA9IF9yZWZbMV07CiAgICBwcm9wZXJ0aWVzW25hbWVdID0gbmV3IFByb3BlcnR5SW5mb1JlY29yZChuYW1lLCBTVFJJTkcsIGZhbHNlLCAvLyBtdXN0VXNlUHJvcGVydHkKICAgIGF0dHJpYnV0ZU5hbWUsIC8vIGF0dHJpYnV0ZU5hbWUKICAgIG51bGwsIC8vIGF0dHJpYnV0ZU5hbWVzcGFjZQogICAgZmFsc2UsIC8vIHNhbml0aXplVVJMCiAgICBmYWxzZSk7CiAgfSk7IC8vIFRoZXNlIGFyZSAiZW51bWVyYXRlZCIgSFRNTCBhdHRyaWJ1dGVzIHRoYXQgYWNjZXB0ICJ0cnVlIiBhbmQgImZhbHNlIi4KICAvLyBJbiBSZWFjdCwgd2UgbGV0IHVzZXJzIHBhc3MgYHRydWVgIGFuZCBgZmFsc2VgIGV2ZW4gdGhvdWdoIHRlY2huaWNhbGx5CiAgLy8gdGhlc2UgYXJlbid0IGJvb2xlYW4gYXR0cmlidXRlcyAodGhleSBhcmUgY29lcmNlZCB0byBzdHJpbmdzKS4KCiAgWydjb250ZW50RWRpdGFibGUnLCAnZHJhZ2dhYmxlJywgJ3NwZWxsQ2hlY2snLCAndmFsdWUnXS5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7CiAgICBwcm9wZXJ0aWVzW25hbWVdID0gbmV3IFByb3BlcnR5SW5mb1JlY29yZChuYW1lLCBCT09MRUFOSVNIX1NUUklORywgZmFsc2UsIC8vIG11c3RVc2VQcm9wZXJ0eQogICAgbmFtZS50b0xvd2VyQ2FzZSgpLCAvLyBhdHRyaWJ1dGVOYW1lCiAgICBudWxsLCAvLyBhdHRyaWJ1dGVOYW1lc3BhY2UKICAgIGZhbHNlLCAvLyBzYW5pdGl6ZVVSTAogICAgZmFsc2UpOwogIH0pOyAvLyBUaGVzZSBhcmUgImVudW1lcmF0ZWQiIFNWRyBhdHRyaWJ1dGVzIHRoYXQgYWNjZXB0ICJ0cnVlIiBhbmQgImZhbHNlIi4KICAvLyBJbiBSZWFjdCwgd2UgbGV0IHVzZXJzIHBhc3MgYHRydWVgIGFuZCBgZmFsc2VgIGV2ZW4gdGhvdWdoIHRlY2huaWNhbGx5CiAgLy8gdGhlc2UgYXJlbid0IGJvb2xlYW4gYXR0cmlidXRlcyAodGhleSBhcmUgY29lcmNlZCB0byBzdHJpbmdzKS4KICAvLyBTaW5jZSB0aGVzZSBhcmUgU1ZHIGF0dHJpYnV0ZXMsIHRoZWlyIGF0dHJpYnV0ZSBuYW1lcyBhcmUgY2FzZS1zZW5zaXRpdmUuCgogIFsnYXV0b1JldmVyc2UnLCAnZXh0ZXJuYWxSZXNvdXJjZXNSZXF1aXJlZCcsICdmb2N1c2FibGUnLCAncHJlc2VydmVBbHBoYSddLmZvckVhY2goZnVuY3Rpb24gKG5hbWUpIHsKICAgIHByb3BlcnRpZXNbbmFtZV0gPSBuZXcgUHJvcGVydHlJbmZvUmVjb3JkKG5hbWUsIEJPT0xFQU5JU0hfU1RSSU5HLCBmYWxzZSwgLy8gbXVzdFVzZVByb3BlcnR5CiAgICBuYW1lLCAvLyBhdHRyaWJ1dGVOYW1lCiAgICBudWxsLCAvLyBhdHRyaWJ1dGVOYW1lc3BhY2UKICAgIGZhbHNlLCAvLyBzYW5pdGl6ZVVSTAogICAgZmFsc2UpOwogIH0pOyAvLyBUaGVzZSBhcmUgSFRNTCBib29sZWFuIGF0dHJpYnV0ZXMuCgogIFsnYWxsb3dGdWxsU2NyZWVuJywgJ2FzeW5jJywgLy8gTm90ZTogdGhlcmUgaXMgYSBzcGVjaWFsIGNhc2UgdGhhdCBwcmV2ZW50cyBpdCBmcm9tIGJlaW5nIHdyaXR0ZW4gdG8gdGhlIERPTQogIC8vIG9uIHRoZSBjbGllbnQgc2lkZSBiZWNhdXNlIHRoZSBicm93c2VycyBhcmUgaW5jb25zaXN0ZW50LiBJbnN0ZWFkIHdlIGNhbGwgZm9jdXMoKS4KICAnYXV0b0ZvY3VzJywgJ2F1dG9QbGF5JywgJ2NvbnRyb2xzJywgJ2RlZmF1bHQnLCAnZGVmZXInLCAnZGlzYWJsZWQnLCAnZGlzYWJsZVBpY3R1cmVJblBpY3R1cmUnLCAnZGlzYWJsZVJlbW90ZVBsYXliYWNrJywgJ2Zvcm1Ob1ZhbGlkYXRlJywgJ2hpZGRlbicsICdsb29wJywgJ25vTW9kdWxlJywgJ25vVmFsaWRhdGUnLCAnb3BlbicsICdwbGF5c0lubGluZScsICdyZWFkT25seScsICdyZXF1aXJlZCcsICdyZXZlcnNlZCcsICdzY29wZWQnLCAnc2VhbWxlc3MnLCAvLyBNaWNyb2RhdGEKICAnaXRlbVNjb3BlJ10uZm9yRWFjaChmdW5jdGlvbiAobmFtZSkgewogICAgcHJvcGVydGllc1tuYW1lXSA9IG5ldyBQcm9wZXJ0eUluZm9SZWNvcmQobmFtZSwgQk9PTEVBTiwgZmFsc2UsIC8vIG11c3RVc2VQcm9wZXJ0eQogICAgbmFtZS50b0xvd2VyQ2FzZSgpLCAvLyBhdHRyaWJ1dGVOYW1lCiAgICBudWxsLCAvLyBhdHRyaWJ1dGVOYW1lc3BhY2UKICAgIGZhbHNlLCAvLyBzYW5pdGl6ZVVSTAogICAgZmFsc2UpOwogIH0pOyAvLyBUaGVzZSBhcmUgdGhlIGZldyBSZWFjdCBwcm9wcyB0aGF0IHdlIHNldCBhcyBET00gcHJvcGVydGllcwogIC8vIHJhdGhlciB0aGFuIGF0dHJpYnV0ZXMuIFRoZXNlIGFyZSBhbGwgYm9vbGVhbnMuCgogIFsnY2hlY2tlZCcsIC8vIE5vdGU6IGBvcHRpb24uc2VsZWN0ZWRgIGlzIG5vdCB1cGRhdGVkIGlmIGBzZWxlY3QubXVsdGlwbGVgIGlzCiAgLy8gZGlzYWJsZWQgd2l0aCBgcmVtb3ZlQXR0cmlidXRlYC4gV2UgaGF2ZSBzcGVjaWFsIGxvZ2ljIGZvciBoYW5kbGluZyB0aGlzLgogICdtdWx0aXBsZScsICdtdXRlZCcsICdzZWxlY3RlZCcgLy8gTk9URTogaWYgeW91IGFkZCBhIGNhbWVsQ2FzZWQgcHJvcCB0byB0aGlzIGxpc3QsCiAgLy8geW91J2xsIG5lZWQgdG8gc2V0IGF0dHJpYnV0ZU5hbWUgdG8gbmFtZS50b0xvd2VyQ2FzZSgpCiAgLy8gaW5zdGVhZCBpbiB0aGUgYXNzaWdubWVudCBiZWxvdy4KICBdLmZvckVhY2goZnVuY3Rpb24gKG5hbWUpIHsKICAgIHByb3BlcnRpZXNbbmFtZV0gPSBuZXcgUHJvcGVydHlJbmZvUmVjb3JkKG5hbWUsIEJPT0xFQU4sIHRydWUsIC8vIG11c3RVc2VQcm9wZXJ0eQogICAgbmFtZSwgLy8gYXR0cmlidXRlTmFtZQogICAgbnVsbCwgLy8gYXR0cmlidXRlTmFtZXNwYWNlCiAgICBmYWxzZSwgLy8gc2FuaXRpemVVUkwKICAgIGZhbHNlKTsKICB9KTsgLy8gVGhlc2UgYXJlIEhUTUwgYXR0cmlidXRlcyB0aGF0IGFyZSAib3ZlcmxvYWRlZCBib29sZWFucyI6IHRoZXkgYmVoYXZlIGxpa2UKICAvLyBib29sZWFucywgYnV0IGNhbiBhbHNvIGFjY2VwdCBhIHN0cmluZyB2YWx1ZS4KCiAgWydjYXB0dXJlJywgJ2Rvd25sb2FkJyAvLyBOT1RFOiBpZiB5b3UgYWRkIGEgY2FtZWxDYXNlZCBwcm9wIHRvIHRoaXMgbGlzdCwKICAvLyB5b3UnbGwgbmVlZCB0byBzZXQgYXR0cmlidXRlTmFtZSB0byBuYW1lLnRvTG93ZXJDYXNlKCkKICAvLyBpbnN0ZWFkIGluIHRoZSBhc3NpZ25tZW50IGJlbG93LgogIF0uZm9yRWFjaChmdW5jdGlvbiAobmFtZSkgewogICAgcHJvcGVydGllc1tuYW1lXSA9IG5ldyBQcm9wZXJ0eUluZm9SZWNvcmQobmFtZSwgT1ZFUkxPQURFRF9CT09MRUFOLCBmYWxzZSwgLy8gbXVzdFVzZVByb3BlcnR5CiAgICBuYW1lLCAvLyBhdHRyaWJ1dGVOYW1lCiAgICBudWxsLCAvLyBhdHRyaWJ1dGVOYW1lc3BhY2UKICAgIGZhbHNlLCAvLyBzYW5pdGl6ZVVSTAogICAgZmFsc2UpOwogIH0pOyAvLyBUaGVzZSBhcmUgSFRNTCBhdHRyaWJ1dGVzIHRoYXQgbXVzdCBiZSBwb3NpdGl2ZSBudW1iZXJzLgoKICBbJ2NvbHMnLCAncm93cycsICdzaXplJywgJ3NwYW4nIC8vIE5PVEU6IGlmIHlvdSBhZGQgYSBjYW1lbENhc2VkIHByb3AgdG8gdGhpcyBsaXN0LAogIC8vIHlvdSdsbCBuZWVkIHRvIHNldCBhdHRyaWJ1dGVOYW1lIHRvIG5hbWUudG9Mb3dlckNhc2UoKQogIC8vIGluc3RlYWQgaW4gdGhlIGFzc2lnbm1lbnQgYmVsb3cuCiAgXS5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7CiAgICBwcm9wZXJ0aWVzW25hbWVdID0gbmV3IFByb3BlcnR5SW5mb1JlY29yZChuYW1lLCBQT1NJVElWRV9OVU1FUklDLCBmYWxzZSwgLy8gbXVzdFVzZVByb3BlcnR5CiAgICBuYW1lLCAvLyBhdHRyaWJ1dGVOYW1lCiAgICBudWxsLCAvLyBhdHRyaWJ1dGVOYW1lc3BhY2UKICAgIGZhbHNlLCAvLyBzYW5pdGl6ZVVSTAogICAgZmFsc2UpOwogIH0pOyAvLyBUaGVzZSBhcmUgSFRNTCBhdHRyaWJ1dGVzIHRoYXQgbXVzdCBiZSBudW1iZXJzLgoKICBbJ3Jvd1NwYW4nLCAnc3RhcnQnXS5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7CiAgICBwcm9wZXJ0aWVzW25hbWVdID0gbmV3IFByb3BlcnR5SW5mb1JlY29yZChuYW1lLCBOVU1FUklDLCBmYWxzZSwgLy8gbXVzdFVzZVByb3BlcnR5CiAgICBuYW1lLnRvTG93ZXJDYXNlKCksIC8vIGF0dHJpYnV0ZU5hbWUKICAgIG51bGwsIC8vIGF0dHJpYnV0ZU5hbWVzcGFjZQogICAgZmFsc2UsIC8vIHNhbml0aXplVVJMCiAgICBmYWxzZSk7CiAgfSk7CiAgdmFyIENBTUVMSVpFID0gL1tcLVw6XShbYS16XSkvZzsKCiAgdmFyIGNhcGl0YWxpemUgPSBmdW5jdGlvbiAodG9rZW4pIHsKICAgIHJldHVybiB0b2tlblsxXS50b1VwcGVyQ2FzZSgpOwogIH07IC8vIFRoaXMgaXMgYSBsaXN0IG9mIGFsbCBTVkcgYXR0cmlidXRlcyB0aGF0IG5lZWQgc3BlY2lhbCBjYXNpbmcsIG5hbWVzcGFjaW5nLAogIC8vIG9yIGJvb2xlYW4gdmFsdWUgYXNzaWdubWVudC4gUmVndWxhciBhdHRyaWJ1dGVzIHRoYXQganVzdCBhY2NlcHQgc3RyaW5ncwogIC8vIGFuZCBoYXZlIHRoZSBzYW1lIG5hbWVzIGFyZSBvbWl0dGVkLCBqdXN0IGxpa2UgaW4gdGhlIEhUTUwgYXR0cmlidXRlIGZpbHRlci4KICAvLyBTb21lIG9mIHRoZXNlIGF0dHJpYnV0ZXMgY2FuIGJlIGhhcmQgdG8gZmluZC4gVGhpcyBsaXN0IHdhcyBjcmVhdGVkIGJ5CiAgLy8gc2NyYXBpbmcgdGhlIE1ETiBkb2N1bWVudGF0aW9uLgoKCiAgWydhY2NlbnQtaGVpZ2h0JywgJ2FsaWdubWVudC1iYXNlbGluZScsICdhcmFiaWMtZm9ybScsICdiYXNlbGluZS1zaGlmdCcsICdjYXAtaGVpZ2h0JywgJ2NsaXAtcGF0aCcsICdjbGlwLXJ1bGUnLCAnY29sb3ItaW50ZXJwb2xhdGlvbicsICdjb2xvci1pbnRlcnBvbGF0aW9uLWZpbHRlcnMnLCAnY29sb3ItcHJvZmlsZScsICdjb2xvci1yZW5kZXJpbmcnLCAnZG9taW5hbnQtYmFzZWxpbmUnLCAnZW5hYmxlLWJhY2tncm91bmQnLCAnZmlsbC1vcGFjaXR5JywgJ2ZpbGwtcnVsZScsICdmbG9vZC1jb2xvcicsICdmbG9vZC1vcGFjaXR5JywgJ2ZvbnQtZmFtaWx5JywgJ2ZvbnQtc2l6ZScsICdmb250LXNpemUtYWRqdXN0JywgJ2ZvbnQtc3RyZXRjaCcsICdmb250LXN0eWxlJywgJ2ZvbnQtdmFyaWFudCcsICdmb250LXdlaWdodCcsICdnbHlwaC1uYW1lJywgJ2dseXBoLW9yaWVudGF0aW9uLWhvcml6b250YWwnLCAnZ2x5cGgtb3JpZW50YXRpb24tdmVydGljYWwnLCAnaG9yaXotYWR2LXgnLCAnaG9yaXotb3JpZ2luLXgnLCAnaW1hZ2UtcmVuZGVyaW5nJywgJ2xldHRlci1zcGFjaW5nJywgJ2xpZ2h0aW5nLWNvbG9yJywgJ21hcmtlci1lbmQnLCAnbWFya2VyLW1pZCcsICdtYXJrZXItc3RhcnQnLCAnb3ZlcmxpbmUtcG9zaXRpb24nLCAnb3ZlcmxpbmUtdGhpY2tuZXNzJywgJ3BhaW50LW9yZGVyJywgJ3Bhbm9zZS0xJywgJ3BvaW50ZXItZXZlbnRzJywgJ3JlbmRlcmluZy1pbnRlbnQnLCAnc2hhcGUtcmVuZGVyaW5nJywgJ3N0b3AtY29sb3InLCAnc3RvcC1vcGFjaXR5JywgJ3N0cmlrZXRocm91Z2gtcG9zaXRpb24nLCAnc3RyaWtldGhyb3VnaC10aGlja25lc3MnLCAnc3Ryb2tlLWRhc2hhcnJheScsICdzdHJva2UtZGFzaG9mZnNldCcsICdzdHJva2UtbGluZWNhcCcsICdzdHJva2UtbGluZWpvaW4nLCAnc3Ryb2tlLW1pdGVybGltaXQnLCAnc3Ryb2tlLW9wYWNpdHknLCAnc3Ryb2tlLXdpZHRoJywgJ3RleHQtYW5jaG9yJywgJ3RleHQtZGVjb3JhdGlvbicsICd0ZXh0LXJlbmRlcmluZycsICd1bmRlcmxpbmUtcG9zaXRpb24nLCAndW5kZXJsaW5lLXRoaWNrbmVzcycsICd1bmljb2RlLWJpZGknLCAndW5pY29kZS1yYW5nZScsICd1bml0cy1wZXItZW0nLCAndi1hbHBoYWJldGljJywgJ3YtaGFuZ2luZycsICd2LWlkZW9ncmFwaGljJywgJ3YtbWF0aGVtYXRpY2FsJywgJ3ZlY3Rvci1lZmZlY3QnLCAndmVydC1hZHYteScsICd2ZXJ0LW9yaWdpbi14JywgJ3ZlcnQtb3JpZ2luLXknLCAnd29yZC1zcGFjaW5nJywgJ3dyaXRpbmctbW9kZScsICd4bWxuczp4bGluaycsICd4LWhlaWdodCcgLy8gTk9URTogaWYgeW91IGFkZCBhIGNhbWVsQ2FzZWQgcHJvcCB0byB0aGlzIGxpc3QsCiAgLy8geW91J2xsIG5lZWQgdG8gc2V0IGF0dHJpYnV0ZU5hbWUgdG8gbmFtZS50b0xvd2VyQ2FzZSgpCiAgLy8gaW5zdGVhZCBpbiB0aGUgYXNzaWdubWVudCBiZWxvdy4KICBdLmZvckVhY2goZnVuY3Rpb24gKGF0dHJpYnV0ZU5hbWUpIHsKICAgIHZhciBuYW1lID0gYXR0cmlidXRlTmFtZS5yZXBsYWNlKENBTUVMSVpFLCBjYXBpdGFsaXplKTsKICAgIHByb3BlcnRpZXNbbmFtZV0gPSBuZXcgUHJvcGVydHlJbmZvUmVjb3JkKG5hbWUsIFNUUklORywgZmFsc2UsIC8vIG11c3RVc2VQcm9wZXJ0eQogICAgYXR0cmlidXRlTmFtZSwgbnVsbCwgLy8gYXR0cmlidXRlTmFtZXNwYWNlCiAgICBmYWxzZSwgLy8gc2FuaXRpemVVUkwKICAgIGZhbHNlKTsKICB9KTsgLy8gU3RyaW5nIFNWRyBhdHRyaWJ1dGVzIHdpdGggdGhlIHhsaW5rIG5hbWVzcGFjZS4KCiAgWyd4bGluazphY3R1YXRlJywgJ3hsaW5rOmFyY3JvbGUnLCAneGxpbms6cm9sZScsICd4bGluazpzaG93JywgJ3hsaW5rOnRpdGxlJywgJ3hsaW5rOnR5cGUnIC8vIE5PVEU6IGlmIHlvdSBhZGQgYSBjYW1lbENhc2VkIHByb3AgdG8gdGhpcyBsaXN0LAogIC8vIHlvdSdsbCBuZWVkIHRvIHNldCBhdHRyaWJ1dGVOYW1lIHRvIG5hbWUudG9Mb3dlckNhc2UoKQogIC8vIGluc3RlYWQgaW4gdGhlIGFzc2lnbm1lbnQgYmVsb3cuCiAgXS5mb3JFYWNoKGZ1bmN0aW9uIChhdHRyaWJ1dGVOYW1lKSB7CiAgICB2YXIgbmFtZSA9IGF0dHJpYnV0ZU5hbWUucmVwbGFjZShDQU1FTElaRSwgY2FwaXRhbGl6ZSk7CiAgICBwcm9wZXJ0aWVzW25hbWVdID0gbmV3IFByb3BlcnR5SW5mb1JlY29yZChuYW1lLCBTVFJJTkcsIGZhbHNlLCAvLyBtdXN0VXNlUHJvcGVydHkKICAgIGF0dHJpYnV0ZU5hbWUsICdodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rJywgZmFsc2UsIC8vIHNhbml0aXplVVJMCiAgICBmYWxzZSk7CiAgfSk7IC8vIFN0cmluZyBTVkcgYXR0cmlidXRlcyB3aXRoIHRoZSB4bWwgbmFtZXNwYWNlLgoKICBbJ3htbDpiYXNlJywgJ3htbDpsYW5nJywgJ3htbDpzcGFjZScgLy8gTk9URTogaWYgeW91IGFkZCBhIGNhbWVsQ2FzZWQgcHJvcCB0byB0aGlzIGxpc3QsCiAgLy8geW91J2xsIG5lZWQgdG8gc2V0IGF0dHJpYnV0ZU5hbWUgdG8gbmFtZS50b0xvd2VyQ2FzZSgpCiAgLy8gaW5zdGVhZCBpbiB0aGUgYXNzaWdubWVudCBiZWxvdy4KICBdLmZvckVhY2goZnVuY3Rpb24gKGF0dHJpYnV0ZU5hbWUpIHsKICAgIHZhciBuYW1lID0gYXR0cmlidXRlTmFtZS5yZXBsYWNlKENBTUVMSVpFLCBjYXBpdGFsaXplKTsKICAgIHByb3BlcnRpZXNbbmFtZV0gPSBuZXcgUHJvcGVydHlJbmZvUmVjb3JkKG5hbWUsIFNUUklORywgZmFsc2UsIC8vIG11c3RVc2VQcm9wZXJ0eQogICAgYXR0cmlidXRlTmFtZSwgJ2h0dHA6Ly93d3cudzMub3JnL1hNTC8xOTk4L25hbWVzcGFjZScsIGZhbHNlLCAvLyBzYW5pdGl6ZVVSTAogICAgZmFsc2UpOwogIH0pOyAvLyBUaGVzZSBhdHRyaWJ1dGUgZXhpc3RzIGJvdGggaW4gSFRNTCBhbmQgU1ZHLgogIC8vIFRoZSBhdHRyaWJ1dGUgbmFtZSBpcyBjYXNlLXNlbnNpdGl2ZSBpbiBTVkcgc28gd2UgY2FuJ3QganVzdCB1c2UKICAvLyB0aGUgUmVhY3QgbmFtZSBsaWtlIHdlIGRvIGZvciBhdHRyaWJ1dGVzIHRoYXQgZXhpc3Qgb25seSBpbiBIVE1MLgoKICBbJ3RhYkluZGV4JywgJ2Nyb3NzT3JpZ2luJ10uZm9yRWFjaChmdW5jdGlvbiAoYXR0cmlidXRlTmFtZSkgewogICAgcHJvcGVydGllc1thdHRyaWJ1dGVOYW1lXSA9IG5ldyBQcm9wZXJ0eUluZm9SZWNvcmQoYXR0cmlidXRlTmFtZSwgU1RSSU5HLCBmYWxzZSwgLy8gbXVzdFVzZVByb3BlcnR5CiAgICBhdHRyaWJ1dGVOYW1lLnRvTG93ZXJDYXNlKCksIC8vIGF0dHJpYnV0ZU5hbWUKICAgIG51bGwsIC8vIGF0dHJpYnV0ZU5hbWVzcGFjZQogICAgZmFsc2UsIC8vIHNhbml0aXplVVJMCiAgICBmYWxzZSk7CiAgfSk7IC8vIFRoZXNlIGF0dHJpYnV0ZXMgYWNjZXB0IFVSTHMuIFRoZXNlIG11c3Qgbm90IGFsbG93IGphdmFzY3JpcHQ6IFVSTFMuCiAgLy8gVGhlc2Ugd2lsbCBhbHNvIG5lZWQgdG8gYWNjZXB0IFRydXN0ZWQgVHlwZXMgb2JqZWN0IGluIHRoZSBmdXR1cmUuCgogIHZhciB4bGlua0hyZWYgPSAneGxpbmtIcmVmJzsKICBwcm9wZXJ0aWVzW3hsaW5rSHJlZl0gPSBuZXcgUHJvcGVydHlJbmZvUmVjb3JkKCd4bGlua0hyZWYnLCBTVFJJTkcsIGZhbHNlLCAvLyBtdXN0VXNlUHJvcGVydHkKICAneGxpbms6aHJlZicsICdodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rJywgdHJ1ZSwgLy8gc2FuaXRpemVVUkwKICBmYWxzZSk7CiAgWydzcmMnLCAnaHJlZicsICdhY3Rpb24nLCAnZm9ybUFjdGlvbiddLmZvckVhY2goZnVuY3Rpb24gKGF0dHJpYnV0ZU5hbWUpIHsKICAgIHByb3BlcnRpZXNbYXR0cmlidXRlTmFtZV0gPSBuZXcgUHJvcGVydHlJbmZvUmVjb3JkKGF0dHJpYnV0ZU5hbWUsIFNUUklORywgZmFsc2UsIC8vIG11c3RVc2VQcm9wZXJ0eQogICAgYXR0cmlidXRlTmFtZS50b0xvd2VyQ2FzZSgpLCAvLyBhdHRyaWJ1dGVOYW1lCiAgICBudWxsLCAvLyBhdHRyaWJ1dGVOYW1lc3BhY2UKICAgIHRydWUsIC8vIHNhbml0aXplVVJMCiAgICB0cnVlKTsKICB9KTsKCiAgLy8gYW5kIGFueSBuZXdsaW5lIG9yIHRhYiBhcmUgZmlsdGVyZWQgb3V0IGFzIGlmIHRoZXkncmUgbm90IHBhcnQgb2YgdGhlIFVSTC4KICAvLyBodHRwczovL3VybC5zcGVjLndoYXR3Zy5vcmcvI3VybC1wYXJzaW5nCiAgLy8gVGFiIG9yIG5ld2xpbmUgYXJlIGRlZmluZWQgYXMgXHJcblx0OgogIC8vIGh0dHBzOi8vaW5mcmEuc3BlYy53aGF0d2cub3JnLyNhc2NpaS10YWItb3ItbmV3bGluZQogIC8vIEEgQzAgY29udHJvbCBpcyBhIGNvZGUgcG9pbnQgaW4gdGhlIHJhbmdlIFx1MDAwMCBOVUxMIHRvIFx1MDAxRgogIC8vIElORk9STUFUSU9OIFNFUEFSQVRPUiBPTkUsIGluY2x1c2l2ZToKICAvLyBodHRwczovL2luZnJhLnNwZWMud2hhdHdnLm9yZy8jYzAtY29udHJvbC1vci1zcGFjZQoKICAvKiBlc2xpbnQtZGlzYWJsZSBtYXgtbGVuICovCgogIHZhciBpc0phdmFTY3JpcHRQcm90b2NvbCA9IC9eW1x1MDAwMC1cdTAwMUYgXSpqW1xyXG5cdF0qYVtcclxuXHRdKnZbXHJcblx0XSphW1xyXG5cdF0qc1tcclxuXHRdKmNbXHJcblx0XSpyW1xyXG5cdF0qaVtcclxuXHRdKnBbXHJcblx0XSp0W1xyXG5cdF0qXDovaTsKICB2YXIgZGlkV2FybiA9IGZhbHNlOwoKICBmdW5jdGlvbiBzYW5pdGl6ZVVSTCh1cmwpIHsKICAgIHsKICAgICAgaWYgKCFkaWRXYXJuICYmIGlzSmF2YVNjcmlwdFByb3RvY29sLnRlc3QodXJsKSkgewogICAgICAgIGRpZFdhcm4gPSB0cnVlOwoKICAgICAgICBlcnJvcignQSBmdXR1cmUgdmVyc2lvbiBvZiBSZWFjdCB3aWxsIGJsb2NrIGphdmFzY3JpcHQ6IFVSTHMgYXMgYSBzZWN1cml0eSBwcmVjYXV0aW9uLiAnICsgJ1VzZSBldmVudCBoYW5kbGVycyBpbnN0ZWFkIGlmIHlvdSBjYW4uIElmIHlvdSBuZWVkIHRvIGdlbmVyYXRlIHVuc2FmZSBIVE1MIHRyeSAnICsgJ3VzaW5nIGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MIGluc3RlYWQuIFJlYWN0IHdhcyBwYXNzZWQgJXMuJywgSlNPTi5zdHJpbmdpZnkodXJsKSk7CiAgICAgIH0KICAgIH0KICB9CgogIC8qKgogICAqIEdldCB0aGUgdmFsdWUgZm9yIGEgcHJvcGVydHkgb24gYSBub2RlLiBPbmx5IHVzZWQgaW4gREVWIGZvciBTU1IgdmFsaWRhdGlvbi4KICAgKiBUaGUgImV4cGVjdGVkIiBhcmd1bWVudCBpcyB1c2VkIGFzIGEgaGludCBvZiB3aGF0IHRoZSBleHBlY3RlZCB2YWx1ZSBpcy4KICAgKiBTb21lIHByb3BlcnRpZXMgaGF2ZSBtdWx0aXBsZSBlcXVpdmFsZW50IHZhbHVlcy4KICAgKi8KICBmdW5jdGlvbiBnZXRWYWx1ZUZvclByb3BlcnR5KG5vZGUsIG5hbWUsIGV4cGVjdGVkLCBwcm9wZXJ0eUluZm8pIHsKICAgIHsKICAgICAgaWYgKHByb3BlcnR5SW5mby5tdXN0VXNlUHJvcGVydHkpIHsKICAgICAgICB2YXIgcHJvcGVydHlOYW1lID0gcHJvcGVydHlJbmZvLnByb3BlcnR5TmFtZTsKICAgICAgICByZXR1cm4gbm9kZVtwcm9wZXJ0eU5hbWVdOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIFRoaXMgY2hlY2sgcHJvdGVjdHMgbXVsdGlwbGUgdXNlcyBvZiBgZXhwZWN0ZWRgLCB3aGljaCBpcyB3aHkgdGhlCiAgICAgICAgLy8gcmVhY3QtaW50ZXJuYWwvc2FmZS1zdHJpbmctY29lcmNpb24gcnVsZSBpcyBkaXNhYmxlZCBpbiBzZXZlcmFsIHNwb3RzCiAgICAgICAgLy8gYmVsb3cuCiAgICAgICAgewogICAgICAgICAgY2hlY2tBdHRyaWJ1dGVTdHJpbmdDb2VyY2lvbihleHBlY3RlZCwgbmFtZSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoIHByb3BlcnR5SW5mby5zYW5pdGl6ZVVSTCkgewogICAgICAgICAgLy8gSWYgd2UgaGF2ZW4ndCBmdWxseSBkaXNhYmxlZCBqYXZhc2NyaXB0OiBVUkxzLCBhbmQgaWYKICAgICAgICAgIC8vIHRoZSBoeWRyYXRpb24gaXMgc3VjY2Vzc2Z1bCBvZiBhIGphdmFzY3JpcHQ6IFVSTCwgd2UKICAgICAgICAgIC8vIHN0aWxsIHdhbnQgdG8gd2FybiBvbiB0aGUgY2xpZW50LgogICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0LWludGVybmFsL3NhZmUtc3RyaW5nLWNvZXJjaW9uCiAgICAgICAgICBzYW5pdGl6ZVVSTCgnJyArIGV4cGVjdGVkKTsKICAgICAgICB9CgogICAgICAgIHZhciBhdHRyaWJ1dGVOYW1lID0gcHJvcGVydHlJbmZvLmF0dHJpYnV0ZU5hbWU7CiAgICAgICAgdmFyIHN0cmluZ1ZhbHVlID0gbnVsbDsKCiAgICAgICAgaWYgKHByb3BlcnR5SW5mby50eXBlID09PSBPVkVSTE9BREVEX0JPT0xFQU4pIHsKICAgICAgICAgIGlmIChub2RlLmhhc0F0dHJpYnV0ZShhdHRyaWJ1dGVOYW1lKSkgewogICAgICAgICAgICB2YXIgdmFsdWUgPSBub2RlLmdldEF0dHJpYnV0ZShhdHRyaWJ1dGVOYW1lKTsKCiAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gJycpIHsKICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKHNob3VsZFJlbW92ZUF0dHJpYnV0ZShuYW1lLCBleHBlY3RlZCwgcHJvcGVydHlJbmZvLCBmYWxzZSkpIHsKICAgICAgICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgICAgICAgIH0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0LWludGVybmFsL3NhZmUtc3RyaW5nLWNvZXJjaW9uCgoKICAgICAgICAgICAgaWYgKHZhbHVlID09PSAnJyArIGV4cGVjdGVkKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGV4cGVjdGVkOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChub2RlLmhhc0F0dHJpYnV0ZShhdHRyaWJ1dGVOYW1lKSkgewogICAgICAgICAgaWYgKHNob3VsZFJlbW92ZUF0dHJpYnV0ZShuYW1lLCBleHBlY3RlZCwgcHJvcGVydHlJbmZvLCBmYWxzZSkpIHsKICAgICAgICAgICAgLy8gV2UgaGFkIGFuIGF0dHJpYnV0ZSBidXQgc2hvdWxkbid0IGhhdmUgaGFkIG9uZSwgc28gcmVhZCBpdAogICAgICAgICAgICAvLyBmb3IgdGhlIGVycm9yIG1lc3NhZ2UuCiAgICAgICAgICAgIHJldHVybiBub2RlLmdldEF0dHJpYnV0ZShhdHRyaWJ1dGVOYW1lKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAocHJvcGVydHlJbmZvLnR5cGUgPT09IEJPT0xFQU4pIHsKICAgICAgICAgICAgLy8gSWYgdGhpcyB3YXMgYSBib29sZWFuLCBpdCBkb2Vzbid0IG1hdHRlciB3aGF0IHRoZSB2YWx1ZSBpcwogICAgICAgICAgICAvLyB0aGUgZmFjdCB0aGF0IHdlIGhhdmUgaXQgaXMgdGhlIHNhbWUgYXMgdGhlIGV4cGVjdGVkLgogICAgICAgICAgICByZXR1cm4gZXhwZWN0ZWQ7CiAgICAgICAgICB9IC8vIEV2ZW4gaWYgdGhpcyBwcm9wZXJ0eSB1c2VzIGEgbmFtZXNwYWNlIHdlIHVzZSBnZXRBdHRyaWJ1dGUKICAgICAgICAgIC8vIGJlY2F1c2Ugd2UgYXNzdW1lIGl0cyBuYW1lc3BhY2VkIG5hbWUgaXMgdGhlIHNhbWUgYXMgb3VyIGNvbmZpZy4KICAgICAgICAgIC8vIFRvIHVzZSBnZXRBdHRyaWJ1dGVOUyB3ZSBuZWVkIHRoZSBsb2NhbCBuYW1lIHdoaWNoIHdlIGRvbid0IGhhdmUKICAgICAgICAgIC8vIGluIG91ciBjb25maWcgYXRtLgoKCiAgICAgICAgICBzdHJpbmdWYWx1ZSA9IG5vZGUuZ2V0QXR0cmlidXRlKGF0dHJpYnV0ZU5hbWUpOwogICAgICAgIH0KCiAgICAgICAgaWYgKHNob3VsZFJlbW92ZUF0dHJpYnV0ZShuYW1lLCBleHBlY3RlZCwgcHJvcGVydHlJbmZvLCBmYWxzZSkpIHsKICAgICAgICAgIHJldHVybiBzdHJpbmdWYWx1ZSA9PT0gbnVsbCA/IGV4cGVjdGVkIDogc3RyaW5nVmFsdWU7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC1pbnRlcm5hbC9zYWZlLXN0cmluZy1jb2VyY2lvbgogICAgICAgIH0gZWxzZSBpZiAoc3RyaW5nVmFsdWUgPT09ICcnICsgZXhwZWN0ZWQpIHsKICAgICAgICAgIHJldHVybiBleHBlY3RlZDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuIHN0cmluZ1ZhbHVlOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KICAvKioKICAgKiBHZXQgdGhlIHZhbHVlIGZvciBhIGF0dHJpYnV0ZSBvbiBhIG5vZGUuIE9ubHkgdXNlZCBpbiBERVYgZm9yIFNTUiB2YWxpZGF0aW9uLgogICAqIFRoZSB0aGlyZCBhcmd1bWVudCBpcyB1c2VkIGFzIGEgaGludCBvZiB3aGF0IHRoZSBleHBlY3RlZCB2YWx1ZSBpcy4gU29tZQogICAqIGF0dHJpYnV0ZXMgaGF2ZSBtdWx0aXBsZSBlcXVpdmFsZW50IHZhbHVlcy4KICAgKi8KCiAgZnVuY3Rpb24gZ2V0VmFsdWVGb3JBdHRyaWJ1dGUobm9kZSwgbmFtZSwgZXhwZWN0ZWQsIGlzQ3VzdG9tQ29tcG9uZW50VGFnKSB7CiAgICB7CiAgICAgIGlmICghaXNBdHRyaWJ1dGVOYW1lU2FmZShuYW1lKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKCFub2RlLmhhc0F0dHJpYnV0ZShuYW1lKSkgewogICAgICAgIHJldHVybiBleHBlY3RlZCA9PT0gdW5kZWZpbmVkID8gdW5kZWZpbmVkIDogbnVsbDsKICAgICAgfQoKICAgICAgdmFyIHZhbHVlID0gbm9kZS5nZXRBdHRyaWJ1dGUobmFtZSk7CgogICAgICB7CiAgICAgICAgY2hlY2tBdHRyaWJ1dGVTdHJpbmdDb2VyY2lvbihleHBlY3RlZCwgbmFtZSk7CiAgICAgIH0KCiAgICAgIGlmICh2YWx1ZSA9PT0gJycgKyBleHBlY3RlZCkgewogICAgICAgIHJldHVybiBleHBlY3RlZDsKICAgICAgfQoKICAgICAgcmV0dXJuIHZhbHVlOwogICAgfQogIH0KICAvKioKICAgKiBTZXRzIHRoZSB2YWx1ZSBmb3IgYSBwcm9wZXJ0eSBvbiBhIG5vZGUuCiAgICoKICAgKiBAcGFyYW0ge0RPTUVsZW1lbnR9IG5vZGUKICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZQogICAqIEBwYXJhbSB7Kn0gdmFsdWUKICAgKi8KCiAgZnVuY3Rpb24gc2V0VmFsdWVGb3JQcm9wZXJ0eShub2RlLCBuYW1lLCB2YWx1ZSwgaXNDdXN0b21Db21wb25lbnRUYWcpIHsKICAgIHZhciBwcm9wZXJ0eUluZm8gPSBnZXRQcm9wZXJ0eUluZm8obmFtZSk7CgogICAgaWYgKHNob3VsZElnbm9yZUF0dHJpYnV0ZShuYW1lLCBwcm9wZXJ0eUluZm8sIGlzQ3VzdG9tQ29tcG9uZW50VGFnKSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKHNob3VsZFJlbW92ZUF0dHJpYnV0ZShuYW1lLCB2YWx1ZSwgcHJvcGVydHlJbmZvLCBpc0N1c3RvbUNvbXBvbmVudFRhZykpIHsKICAgICAgdmFsdWUgPSBudWxsOwogICAgfQoKCiAgICBpZiAoaXNDdXN0b21Db21wb25lbnRUYWcgfHwgcHJvcGVydHlJbmZvID09PSBudWxsKSB7CiAgICAgIGlmIChpc0F0dHJpYnV0ZU5hbWVTYWZlKG5hbWUpKSB7CiAgICAgICAgdmFyIF9hdHRyaWJ1dGVOYW1lID0gbmFtZTsKCiAgICAgICAgaWYgKHZhbHVlID09PSBudWxsKSB7CiAgICAgICAgICBub2RlLnJlbW92ZUF0dHJpYnV0ZShfYXR0cmlidXRlTmFtZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHsKICAgICAgICAgICAgY2hlY2tBdHRyaWJ1dGVTdHJpbmdDb2VyY2lvbih2YWx1ZSwgbmFtZSk7CiAgICAgICAgICB9CgogICAgICAgICAgbm9kZS5zZXRBdHRyaWJ1dGUoX2F0dHJpYnV0ZU5hbWUsICAnJyArIHZhbHVlKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybjsKICAgIH0KCiAgICB2YXIgbXVzdFVzZVByb3BlcnR5ID0gcHJvcGVydHlJbmZvLm11c3RVc2VQcm9wZXJ0eTsKCiAgICBpZiAobXVzdFVzZVByb3BlcnR5KSB7CiAgICAgIHZhciBwcm9wZXJ0eU5hbWUgPSBwcm9wZXJ0eUluZm8ucHJvcGVydHlOYW1lOwoKICAgICAgaWYgKHZhbHVlID09PSBudWxsKSB7CiAgICAgICAgdmFyIHR5cGUgPSBwcm9wZXJ0eUluZm8udHlwZTsKICAgICAgICBub2RlW3Byb3BlcnR5TmFtZV0gPSB0eXBlID09PSBCT09MRUFOID8gZmFsc2UgOiAnJzsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBDb250cmFyeSB0byBgc2V0QXR0cmlidXRlYCwgb2JqZWN0IHByb3BlcnRpZXMgYXJlIHByb3Blcmx5CiAgICAgICAgLy8gYHRvU3RyaW5nYGVkIGJ5IElFOC85LgogICAgICAgIG5vZGVbcHJvcGVydHlOYW1lXSA9IHZhbHVlOwogICAgICB9CgogICAgICByZXR1cm47CiAgICB9IC8vIFRoZSByZXN0IGFyZSB0cmVhdGVkIGFzIGF0dHJpYnV0ZXMgd2l0aCBzcGVjaWFsIGNhc2VzLgoKCiAgICB2YXIgYXR0cmlidXRlTmFtZSA9IHByb3BlcnR5SW5mby5hdHRyaWJ1dGVOYW1lLAogICAgICAgIGF0dHJpYnV0ZU5hbWVzcGFjZSA9IHByb3BlcnR5SW5mby5hdHRyaWJ1dGVOYW1lc3BhY2U7CgogICAgaWYgKHZhbHVlID09PSBudWxsKSB7CiAgICAgIG5vZGUucmVtb3ZlQXR0cmlidXRlKGF0dHJpYnV0ZU5hbWUpOwogICAgfSBlbHNlIHsKICAgICAgdmFyIF90eXBlID0gcHJvcGVydHlJbmZvLnR5cGU7CiAgICAgIHZhciBhdHRyaWJ1dGVWYWx1ZTsKCiAgICAgIGlmIChfdHlwZSA9PT0gQk9PTEVBTiB8fCBfdHlwZSA9PT0gT1ZFUkxPQURFRF9CT09MRUFOICYmIHZhbHVlID09PSB0cnVlKSB7CiAgICAgICAgLy8gSWYgYXR0cmlidXRlIHR5cGUgaXMgYm9vbGVhbiwgd2Uga25vdyBmb3Igc3VyZSBpdCB3b24ndCBiZSBhbiBleGVjdXRpb24gc2luawogICAgICAgIC8vIGFuZCB3ZSB3b24ndCByZXF1aXJlIFRydXN0ZWQgVHlwZSBoZXJlLgogICAgICAgIGF0dHJpYnV0ZVZhbHVlID0gJyc7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gYHNldEF0dHJpYnV0ZWAgd2l0aCBvYmplY3RzIGJlY29tZXMgb25seSBgW29iamVjdF1gIGluIElFOC85LAogICAgICAgIC8vICgnJyArIHZhbHVlKSBtYWtlcyBpdCBvdXRwdXQgdGhlIGNvcnJlY3QgdG9TdHJpbmcoKS12YWx1ZS4KICAgICAgICB7CiAgICAgICAgICB7CiAgICAgICAgICAgIGNoZWNrQXR0cmlidXRlU3RyaW5nQ29lcmNpb24odmFsdWUsIGF0dHJpYnV0ZU5hbWUpOwogICAgICAgICAgfQoKICAgICAgICAgIGF0dHJpYnV0ZVZhbHVlID0gJycgKyB2YWx1ZTsKICAgICAgICB9CgogICAgICAgIGlmIChwcm9wZXJ0eUluZm8uc2FuaXRpemVVUkwpIHsKICAgICAgICAgIHNhbml0aXplVVJMKGF0dHJpYnV0ZVZhbHVlLnRvU3RyaW5nKCkpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGF0dHJpYnV0ZU5hbWVzcGFjZSkgewogICAgICAgIG5vZGUuc2V0QXR0cmlidXRlTlMoYXR0cmlidXRlTmFtZXNwYWNlLCBhdHRyaWJ1dGVOYW1lLCBhdHRyaWJ1dGVWYWx1ZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbm9kZS5zZXRBdHRyaWJ1dGUoYXR0cmlidXRlTmFtZSwgYXR0cmlidXRlVmFsdWUpOwogICAgICB9CiAgICB9CiAgfQoKICAvLyBBVFRFTlRJT04KICAvLyBXaGVuIGFkZGluZyBuZXcgc3ltYm9scyB0byB0aGlzIGZpbGUsCiAgLy8gUGxlYXNlIGNvbnNpZGVyIGFsc28gYWRkaW5nIHRvICdyZWFjdC1kZXZ0b29scy1zaGFyZWQvc3JjL2JhY2tlbmQvUmVhY3RTeW1ib2xzJwogIC8vIFRoZSBTeW1ib2wgdXNlZCB0byB0YWcgdGhlIFJlYWN0RWxlbWVudC1saWtlIHR5cGVzLgogIHZhciBSRUFDVF9FTEVNRU5UX1RZUEUgPSBTeW1ib2wuZm9yKCdyZWFjdC5lbGVtZW50Jyk7CiAgdmFyIFJFQUNUX1BPUlRBTF9UWVBFID0gU3ltYm9sLmZvcigncmVhY3QucG9ydGFsJyk7CiAgdmFyIFJFQUNUX0ZSQUdNRU5UX1RZUEUgPSBTeW1ib2wuZm9yKCdyZWFjdC5mcmFnbWVudCcpOwogIHZhciBSRUFDVF9TVFJJQ1RfTU9ERV9UWVBFID0gU3ltYm9sLmZvcigncmVhY3Quc3RyaWN0X21vZGUnKTsKICB2YXIgUkVBQ1RfUFJPRklMRVJfVFlQRSA9IFN5bWJvbC5mb3IoJ3JlYWN0LnByb2ZpbGVyJyk7CiAgdmFyIFJFQUNUX1BST1ZJREVSX1RZUEUgPSBTeW1ib2wuZm9yKCdyZWFjdC5wcm92aWRlcicpOwogIHZhciBSRUFDVF9DT05URVhUX1RZUEUgPSBTeW1ib2wuZm9yKCdyZWFjdC5jb250ZXh0Jyk7CiAgdmFyIFJFQUNUX0ZPUldBUkRfUkVGX1RZUEUgPSBTeW1ib2wuZm9yKCdyZWFjdC5mb3J3YXJkX3JlZicpOwogIHZhciBSRUFDVF9TVVNQRU5TRV9UWVBFID0gU3ltYm9sLmZvcigncmVhY3Quc3VzcGVuc2UnKTsKICB2YXIgUkVBQ1RfU1VTUEVOU0VfTElTVF9UWVBFID0gU3ltYm9sLmZvcigncmVhY3Quc3VzcGVuc2VfbGlzdCcpOwogIHZhciBSRUFDVF9NRU1PX1RZUEUgPSBTeW1ib2wuZm9yKCdyZWFjdC5tZW1vJyk7CiAgdmFyIFJFQUNUX0xBWllfVFlQRSA9IFN5bWJvbC5mb3IoJ3JlYWN0LmxhenknKTsKICB2YXIgUkVBQ1RfU0NPUEVfVFlQRSA9IFN5bWJvbC5mb3IoJ3JlYWN0LnNjb3BlJyk7CiAgdmFyIFJFQUNUX0RFQlVHX1RSQUNJTkdfTU9ERV9UWVBFID0gU3ltYm9sLmZvcigncmVhY3QuZGVidWdfdHJhY2VfbW9kZScpOwogIHZhciBSRUFDVF9PRkZTQ1JFRU5fVFlQRSA9IFN5bWJvbC5mb3IoJ3JlYWN0Lm9mZnNjcmVlbicpOwogIHZhciBSRUFDVF9MRUdBQ1lfSElEREVOX1RZUEUgPSBTeW1ib2wuZm9yKCdyZWFjdC5sZWdhY3lfaGlkZGVuJyk7CiAgdmFyIFJFQUNUX0NBQ0hFX1RZUEUgPSBTeW1ib2wuZm9yKCdyZWFjdC5jYWNoZScpOwogIHZhciBSRUFDVF9UUkFDSU5HX01BUktFUl9UWVBFID0gU3ltYm9sLmZvcigncmVhY3QudHJhY2luZ19tYXJrZXInKTsKICB2YXIgTUFZQkVfSVRFUkFUT1JfU1lNQk9MID0gU3ltYm9sLml0ZXJhdG9yOwogIHZhciBGQVVYX0lURVJBVE9SX1NZTUJPTCA9ICdAQGl0ZXJhdG9yJzsKICBmdW5jdGlvbiBnZXRJdGVyYXRvckZuKG1heWJlSXRlcmFibGUpIHsKICAgIGlmIChtYXliZUl0ZXJhYmxlID09PSBudWxsIHx8IHR5cGVvZiBtYXliZUl0ZXJhYmxlICE9PSAnb2JqZWN0JykgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICB2YXIgbWF5YmVJdGVyYXRvciA9IE1BWUJFX0lURVJBVE9SX1NZTUJPTCAmJiBtYXliZUl0ZXJhYmxlW01BWUJFX0lURVJBVE9SX1NZTUJPTF0gfHwgbWF5YmVJdGVyYWJsZVtGQVVYX0lURVJBVE9SX1NZTUJPTF07CgogICAgaWYgKHR5cGVvZiBtYXliZUl0ZXJhdG9yID09PSAnZnVuY3Rpb24nKSB7CiAgICAgIHJldHVybiBtYXliZUl0ZXJhdG9yOwogICAgfQoKICAgIHJldHVybiBudWxsOwogIH0KCiAgdmFyIGFzc2lnbiA9IE9iamVjdC5hc3NpZ247CgogIC8vIEhlbHBlcnMgdG8gcGF0Y2ggY29uc29sZS5sb2dzIHRvIGF2b2lkIGxvZ2dpbmcgZHVyaW5nIHNpZGUtZWZmZWN0IGZyZWUKICAvLyByZXBsYXlpbmcgb24gcmVuZGVyIGZ1bmN0aW9uLiBUaGlzIGN1cnJlbnRseSBvbmx5IHBhdGNoZXMgdGhlIG9iamVjdAogIC8vIGxhemlseSB3aGljaCB3b24ndCBjb3ZlciBpZiB0aGUgbG9nIGZ1bmN0aW9uIHdhcyBleHRyYWN0ZWQgZWFnZXJseS4KICAvLyBXZSBjb3VsZCBhbHNvIGVhZ2VybHkgcGF0Y2ggdGhlIG1ldGhvZC4KICB2YXIgZGlzYWJsZWREZXB0aCA9IDA7CiAgdmFyIHByZXZMb2c7CiAgdmFyIHByZXZJbmZvOwogIHZhciBwcmV2V2FybjsKICB2YXIgcHJldkVycm9yOwogIHZhciBwcmV2R3JvdXA7CiAgdmFyIHByZXZHcm91cENvbGxhcHNlZDsKICB2YXIgcHJldkdyb3VwRW5kOwoKICBmdW5jdGlvbiBkaXNhYmxlZExvZygpIHt9CgogIGRpc2FibGVkTG9nLl9fcmVhY3REaXNhYmxlZExvZyA9IHRydWU7CiAgZnVuY3Rpb24gZGlzYWJsZUxvZ3MoKSB7CiAgICB7CiAgICAgIGlmIChkaXNhYmxlZERlcHRoID09PSAwKSB7CiAgICAgICAgLyogZXNsaW50LWRpc2FibGUgcmVhY3QtaW50ZXJuYWwvbm8tcHJvZHVjdGlvbi1sb2dnaW5nICovCiAgICAgICAgcHJldkxvZyA9IGNvbnNvbGUubG9nOwogICAgICAgIHByZXZJbmZvID0gY29uc29sZS5pbmZvOwogICAgICAgIHByZXZXYXJuID0gY29uc29sZS53YXJuOwogICAgICAgIHByZXZFcnJvciA9IGNvbnNvbGUuZXJyb3I7CiAgICAgICAgcHJldkdyb3VwID0gY29uc29sZS5ncm91cDsKICAgICAgICBwcmV2R3JvdXBDb2xsYXBzZWQgPSBjb25zb2xlLmdyb3VwQ29sbGFwc2VkOwogICAgICAgIHByZXZHcm91cEVuZCA9IGNvbnNvbGUuZ3JvdXBFbmQ7IC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9mYWNlYm9vay9yZWFjdC9pc3N1ZXMvMTkwOTkKCiAgICAgICAgdmFyIHByb3BzID0gewogICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgIHZhbHVlOiBkaXNhYmxlZExvZywKICAgICAgICAgIHdyaXRhYmxlOiB0cnVlCiAgICAgICAgfTsgLy8gJEZsb3dGaXhNZSBGbG93IHRoaW5rcyBjb25zb2xlIGlzIGltbXV0YWJsZS4KCiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoY29uc29sZSwgewogICAgICAgICAgaW5mbzogcHJvcHMsCiAgICAgICAgICBsb2c6IHByb3BzLAogICAgICAgICAgd2FybjogcHJvcHMsCiAgICAgICAgICBlcnJvcjogcHJvcHMsCiAgICAgICAgICBncm91cDogcHJvcHMsCiAgICAgICAgICBncm91cENvbGxhcHNlZDogcHJvcHMsCiAgICAgICAgICBncm91cEVuZDogcHJvcHMKICAgICAgICB9KTsKICAgICAgICAvKiBlc2xpbnQtZW5hYmxlIHJlYWN0LWludGVybmFsL25vLXByb2R1Y3Rpb24tbG9nZ2luZyAqLwogICAgICB9CgogICAgICBkaXNhYmxlZERlcHRoKys7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHJlZW5hYmxlTG9ncygpIHsKICAgIHsKICAgICAgZGlzYWJsZWREZXB0aC0tOwoKICAgICAgaWYgKGRpc2FibGVkRGVwdGggPT09IDApIHsKICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSByZWFjdC1pbnRlcm5hbC9uby1wcm9kdWN0aW9uLWxvZ2dpbmcgKi8KICAgICAgICB2YXIgcHJvcHMgPSB7CiAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgd3JpdGFibGU6IHRydWUKICAgICAgICB9OyAvLyAkRmxvd0ZpeE1lIEZsb3cgdGhpbmtzIGNvbnNvbGUgaXMgaW1tdXRhYmxlLgoKICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhjb25zb2xlLCB7CiAgICAgICAgICBsb2c6IGFzc2lnbih7fSwgcHJvcHMsIHsKICAgICAgICAgICAgdmFsdWU6IHByZXZMb2cKICAgICAgICAgIH0pLAogICAgICAgICAgaW5mbzogYXNzaWduKHt9LCBwcm9wcywgewogICAgICAgICAgICB2YWx1ZTogcHJldkluZm8KICAgICAgICAgIH0pLAogICAgICAgICAgd2FybjogYXNzaWduKHt9LCBwcm9wcywgewogICAgICAgICAgICB2YWx1ZTogcHJldldhcm4KICAgICAgICAgIH0pLAogICAgICAgICAgZXJyb3I6IGFzc2lnbih7fSwgcHJvcHMsIHsKICAgICAgICAgICAgdmFsdWU6IHByZXZFcnJvcgogICAgICAgICAgfSksCiAgICAgICAgICBncm91cDogYXNzaWduKHt9LCBwcm9wcywgewogICAgICAgICAgICB2YWx1ZTogcHJldkdyb3VwCiAgICAgICAgICB9KSwKICAgICAgICAgIGdyb3VwQ29sbGFwc2VkOiBhc3NpZ24oe30sIHByb3BzLCB7CiAgICAgICAgICAgIHZhbHVlOiBwcmV2R3JvdXBDb2xsYXBzZWQKICAgICAgICAgIH0pLAogICAgICAgICAgZ3JvdXBFbmQ6IGFzc2lnbih7fSwgcHJvcHMsIHsKICAgICAgICAgICAgdmFsdWU6IHByZXZHcm91cEVuZAogICAgICAgICAgfSkKICAgICAgICB9KTsKICAgICAgICAvKiBlc2xpbnQtZW5hYmxlIHJlYWN0LWludGVybmFsL25vLXByb2R1Y3Rpb24tbG9nZ2luZyAqLwogICAgICB9CgogICAgICBpZiAoZGlzYWJsZWREZXB0aCA8IDApIHsKICAgICAgICBlcnJvcignZGlzYWJsZWREZXB0aCBmZWxsIGJlbG93IHplcm8uICcgKyAnVGhpcyBpcyBhIGJ1ZyBpbiBSZWFjdC4gUGxlYXNlIGZpbGUgYW4gaXNzdWUuJyk7CiAgICAgIH0KICAgIH0KICB9CgogIHZhciBSZWFjdEN1cnJlbnREaXNwYXRjaGVyID0gUmVhY3RTaGFyZWRJbnRlcm5hbHMuUmVhY3RDdXJyZW50RGlzcGF0Y2hlcjsKICB2YXIgcHJlZml4OwogIGZ1bmN0aW9uIGRlc2NyaWJlQnVpbHRJbkNvbXBvbmVudEZyYW1lKG5hbWUsIHNvdXJjZSwgb3duZXJGbikgewogICAgewogICAgICBpZiAocHJlZml4ID09PSB1bmRlZmluZWQpIHsKICAgICAgICAvLyBFeHRyYWN0IHRoZSBWTSBzcGVjaWZpYyBwcmVmaXggdXNlZCBieSBlYWNoIGxpbmUuCiAgICAgICAgdHJ5IHsKICAgICAgICAgIHRocm93IEVycm9yKCk7CiAgICAgICAgfSBjYXRjaCAoeCkgewogICAgICAgICAgdmFyIG1hdGNoID0geC5zdGFjay50cmltKCkubWF0Y2goL1xuKCAqKGF0ICk/KS8pOwogICAgICAgICAgcHJlZml4ID0gbWF0Y2ggJiYgbWF0Y2hbMV0gfHwgJyc7CiAgICAgICAgfQogICAgICB9IC8vIFdlIHVzZSB0aGUgcHJlZml4IHRvIGVuc3VyZSBvdXIgc3RhY2tzIGxpbmUgdXAgd2l0aCBuYXRpdmUgc3RhY2sgZnJhbWVzLgoKCiAgICAgIHJldHVybiAnXG4nICsgcHJlZml4ICsgbmFtZTsKICAgIH0KICB9CiAgdmFyIHJlZW50cnkgPSBmYWxzZTsKICB2YXIgY29tcG9uZW50RnJhbWVDYWNoZTsKCiAgewogICAgdmFyIFBvc3NpYmx5V2Vha01hcCA9IHR5cGVvZiBXZWFrTWFwID09PSAnZnVuY3Rpb24nID8gV2Vha01hcCA6IE1hcDsKICAgIGNvbXBvbmVudEZyYW1lQ2FjaGUgPSBuZXcgUG9zc2libHlXZWFrTWFwKCk7CiAgfQoKICBmdW5jdGlvbiBkZXNjcmliZU5hdGl2ZUNvbXBvbmVudEZyYW1lKGZuLCBjb25zdHJ1Y3QpIHsKICAgIC8vIElmIHNvbWV0aGluZyBhc2tlZCBmb3IgYSBzdGFjayBpbnNpZGUgYSBmYWtlIHJlbmRlciwgaXQgc2hvdWxkIGdldCBpZ25vcmVkLgogICAgaWYgKCAhZm4gfHwgcmVlbnRyeSkgewogICAgICByZXR1cm4gJyc7CiAgICB9CgogICAgewogICAgICB2YXIgZnJhbWUgPSBjb21wb25lbnRGcmFtZUNhY2hlLmdldChmbik7CgogICAgICBpZiAoZnJhbWUgIT09IHVuZGVmaW5lZCkgewogICAgICAgIHJldHVybiBmcmFtZTsKICAgICAgfQogICAgfQoKICAgIHZhciBjb250cm9sOwogICAgcmVlbnRyeSA9IHRydWU7CiAgICB2YXIgcHJldmlvdXNQcmVwYXJlU3RhY2tUcmFjZSA9IEVycm9yLnByZXBhcmVTdGFja1RyYWNlOyAvLyAkRmxvd0ZpeE1lIEl0IGRvZXMgYWNjZXB0IHVuZGVmaW5lZC4KCiAgICBFcnJvci5wcmVwYXJlU3RhY2tUcmFjZSA9IHVuZGVmaW5lZDsKICAgIHZhciBwcmV2aW91c0Rpc3BhdGNoZXI7CgogICAgewogICAgICBwcmV2aW91c0Rpc3BhdGNoZXIgPSBSZWFjdEN1cnJlbnREaXNwYXRjaGVyLmN1cnJlbnQ7IC8vIFNldCB0aGUgZGlzcGF0Y2hlciBpbiBERVYgYmVjYXVzZSB0aGlzIG1pZ2h0IGJlIGNhbGwgaW4gdGhlIHJlbmRlciBmdW5jdGlvbgogICAgICAvLyBmb3Igd2FybmluZ3MuCgogICAgICBSZWFjdEN1cnJlbnREaXNwYXRjaGVyLmN1cnJlbnQgPSBudWxsOwogICAgICBkaXNhYmxlTG9ncygpOwogICAgfQoKICAgIHRyeSB7CiAgICAgIC8vIFRoaXMgc2hvdWxkIHRocm93LgogICAgICBpZiAoY29uc3RydWN0KSB7CiAgICAgICAgLy8gU29tZXRoaW5nIHNob3VsZCBiZSBzZXR0aW5nIHRoZSBwcm9wcyBpbiB0aGUgY29uc3RydWN0b3IuCiAgICAgICAgdmFyIEZha2UgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB0aHJvdyBFcnJvcigpOwogICAgICAgIH07IC8vICRGbG93Rml4TWUKCgogICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGYWtlLnByb3RvdHlwZSwgJ3Byb3BzJywgewogICAgICAgICAgc2V0OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIC8vIFdlIHVzZSBhIHRocm93aW5nIHNldHRlciBpbnN0ZWFkIG9mIGZyb3plbiBvciBub24td3JpdGFibGUgcHJvcHMKICAgICAgICAgICAgLy8gYmVjYXVzZSB0aGF0IHdvbid0IHRocm93IGluIGEgbm9uLXN0cmljdCBtb2RlIGZ1bmN0aW9uLgogICAgICAgICAgICB0aHJvdyBFcnJvcigpOwogICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09ICdvYmplY3QnICYmIFJlZmxlY3QuY29uc3RydWN0KSB7CiAgICAgICAgICAvLyBXZSBjb25zdHJ1Y3QgYSBkaWZmZXJlbnQgY29udHJvbCBmb3IgdGhpcyBjYXNlIHRvIGluY2x1ZGUgYW55IGV4dHJhCiAgICAgICAgICAvLyBmcmFtZXMgYWRkZWQgYnkgdGhlIGNvbnN0cnVjdCBjYWxsLgogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgUmVmbGVjdC5jb25zdHJ1Y3QoRmFrZSwgW10pOwogICAgICAgICAgfSBjYXRjaCAoeCkgewogICAgICAgICAgICBjb250cm9sID0geDsKICAgICAgICAgIH0KCiAgICAgICAgICBSZWZsZWN0LmNvbnN0cnVjdChmbiwgW10sIEZha2UpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0cnkgewogICAgICAgICAgICBGYWtlLmNhbGwoKTsKICAgICAgICAgIH0gY2F0Y2ggKHgpIHsKICAgICAgICAgICAgY29udHJvbCA9IHg7CiAgICAgICAgICB9CgogICAgICAgICAgZm4uY2FsbChGYWtlLnByb3RvdHlwZSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHRyeSB7CiAgICAgICAgICB0aHJvdyBFcnJvcigpOwogICAgICAgIH0gY2F0Y2ggKHgpIHsKICAgICAgICAgIGNvbnRyb2wgPSB4OwogICAgICAgIH0KCiAgICAgICAgZm4oKTsKICAgICAgfQogICAgfSBjYXRjaCAoc2FtcGxlKSB7CiAgICAgIC8vIFRoaXMgaXMgaW5saW5lZCBtYW51YWxseSBiZWNhdXNlIGNsb3N1cmUgZG9lc24ndCBkbyBpdCBmb3IgdXMuCiAgICAgIGlmIChzYW1wbGUgJiYgY29udHJvbCAmJiB0eXBlb2Ygc2FtcGxlLnN0YWNrID09PSAnc3RyaW5nJykgewogICAgICAgIC8vIFRoaXMgZXh0cmFjdHMgdGhlIGZpcnN0IGZyYW1lIGZyb20gdGhlIHNhbXBsZSB0aGF0IGlzbid0IGFsc28gaW4gdGhlIGNvbnRyb2wuCiAgICAgICAgLy8gU2tpcHBpbmcgb25lIGZyYW1lIHRoYXQgd2UgYXNzdW1lIGlzIHRoZSBmcmFtZSB0aGF0IGNhbGxzIHRoZSB0d28uCiAgICAgICAgdmFyIHNhbXBsZUxpbmVzID0gc2FtcGxlLnN0YWNrLnNwbGl0KCdcbicpOwogICAgICAgIHZhciBjb250cm9sTGluZXMgPSBjb250cm9sLnN0YWNrLnNwbGl0KCdcbicpOwogICAgICAgIHZhciBzID0gc2FtcGxlTGluZXMubGVuZ3RoIC0gMTsKICAgICAgICB2YXIgYyA9IGNvbnRyb2xMaW5lcy5sZW5ndGggLSAxOwoKICAgICAgICB3aGlsZSAocyA+PSAxICYmIGMgPj0gMCAmJiBzYW1wbGVMaW5lc1tzXSAhPT0gY29udHJvbExpbmVzW2NdKSB7CiAgICAgICAgICAvLyBXZSBleHBlY3QgYXQgbGVhc3Qgb25lIHN0YWNrIGZyYW1lIHRvIGJlIHNoYXJlZC4KICAgICAgICAgIC8vIFR5cGljYWxseSB0aGlzIHdpbGwgYmUgdGhlIHJvb3QgbW9zdCBvbmUuIEhvd2V2ZXIsIHN0YWNrIGZyYW1lcyBtYXkgYmUKICAgICAgICAgIC8vIGN1dCBvZmYgZHVlIHRvIG1heGltdW0gc3RhY2sgbGltaXRzLiBJbiB0aGlzIGNhc2UsIG9uZSBtYXliZSBjdXQgb2ZmCiAgICAgICAgICAvLyBlYXJsaWVyIHRoYW4gdGhlIG90aGVyLiBXZSBhc3N1bWUgdGhhdCB0aGUgc2FtcGxlIGlzIGxvbmdlciBvciB0aGUgc2FtZQogICAgICAgICAgLy8gYW5kIHRoZXJlIGZvciBjdXQgb2ZmIGVhcmxpZXIuIFNvIHdlIHNob3VsZCBmaW5kIHRoZSByb290IG1vc3QgZnJhbWUgaW4KICAgICAgICAgIC8vIHRoZSBzYW1wbGUgc29tZXdoZXJlIGluIHRoZSBjb250cm9sLgogICAgICAgICAgYy0tOwogICAgICAgIH0KCiAgICAgICAgZm9yICg7IHMgPj0gMSAmJiBjID49IDA7IHMtLSwgYy0tKSB7CiAgICAgICAgICAvLyBOZXh0IHdlIGZpbmQgdGhlIGZpcnN0IG9uZSB0aGF0IGlzbid0IHRoZSBzYW1lIHdoaWNoIHNob3VsZCBiZSB0aGUKICAgICAgICAgIC8vIGZyYW1lIHRoYXQgY2FsbGVkIG91ciBzYW1wbGUgZnVuY3Rpb24gYW5kIHRoZSBjb250cm9sLgogICAgICAgICAgaWYgKHNhbXBsZUxpbmVzW3NdICE9PSBjb250cm9sTGluZXNbY10pIHsKICAgICAgICAgICAgLy8gSW4gVjgsIHRoZSBmaXJzdCBsaW5lIGlzIGRlc2NyaWJpbmcgdGhlIG1lc3NhZ2UgYnV0IG90aGVyIFZNcyBkb24ndC4KICAgICAgICAgICAgLy8gSWYgd2UncmUgYWJvdXQgdG8gcmV0dXJuIHRoZSBmaXJzdCBsaW5lLCBhbmQgdGhlIGNvbnRyb2wgaXMgYWxzbyBvbiB0aGUgc2FtZQogICAgICAgICAgICAvLyBsaW5lLCB0aGF0J3MgYSBwcmV0dHkgZ29vZCBpbmRpY2F0b3IgdGhhdCBvdXIgc2FtcGxlIHRocmV3IGF0IHNhbWUgbGluZSBhcwogICAgICAgICAgICAvLyB0aGUgY29udHJvbC4gSS5lLiBiZWZvcmUgd2UgZW50ZXJlZCB0aGUgc2FtcGxlIGZyYW1lLiBTbyB3ZSBpZ25vcmUgdGhpcyByZXN1bHQuCiAgICAgICAgICAgIC8vIFRoaXMgY2FuIGhhcHBlbiBpZiB5b3UgcGFzc2VkIGEgY2xhc3MgdG8gZnVuY3Rpb24gY29tcG9uZW50LCBvciBub24tZnVuY3Rpb24uCiAgICAgICAgICAgIGlmIChzICE9PSAxIHx8IGMgIT09IDEpIHsKICAgICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgICBzLS07CiAgICAgICAgICAgICAgICBjLS07IC8vIFdlIG1heSBzdGlsbCBoYXZlIHNpbWlsYXIgaW50ZXJtZWRpYXRlIGZyYW1lcyBmcm9tIHRoZSBjb25zdHJ1Y3QgY2FsbC4KICAgICAgICAgICAgICAgIC8vIFRoZSBuZXh0IG9uZSB0aGF0IGlzbid0IHRoZSBzYW1lIHNob3VsZCBiZSBvdXIgbWF0Y2ggdGhvdWdoLgoKICAgICAgICAgICAgICAgIGlmIChjIDwgMCB8fCBzYW1wbGVMaW5lc1tzXSAhPT0gY29udHJvbExpbmVzW2NdKSB7CiAgICAgICAgICAgICAgICAgIC8vIFY4IGFkZHMgYSAibmV3IiBwcmVmaXggZm9yIG5hdGl2ZSBjbGFzc2VzLiBMZXQncyByZW1vdmUgaXQgdG8gbWFrZSBpdCBwcmV0dGllci4KICAgICAgICAgICAgICAgICAgdmFyIF9mcmFtZSA9ICdcbicgKyBzYW1wbGVMaW5lc1tzXS5yZXBsYWNlKCcgYXQgbmV3ICcsICcgYXQgJyk7IC8vIElmIG91ciBjb21wb25lbnQgZnJhbWUgaXMgbGFiZWxlZCAiPGFub255bW91cz4iCiAgICAgICAgICAgICAgICAgIC8vIGJ1dCB3ZSBoYXZlIGEgdXNlci1wcm92aWRlZCAiZGlzcGxheU5hbWUiCiAgICAgICAgICAgICAgICAgIC8vIHNwbGljZSBpdCBpbiB0byBtYWtlIHRoZSBzdGFjayBtb3JlIHJlYWRhYmxlLgoKCiAgICAgICAgICAgICAgICAgIGlmIChmbi5kaXNwbGF5TmFtZSAmJiBfZnJhbWUuaW5jbHVkZXMoJzxhbm9ueW1vdXM+JykpIHsKICAgICAgICAgICAgICAgICAgICBfZnJhbWUgPSBfZnJhbWUucmVwbGFjZSgnPGFub255bW91cz4nLCBmbi5kaXNwbGF5TmFtZSk7CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGZuID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnRGcmFtZUNhY2hlLnNldChmbiwgX2ZyYW1lKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0gLy8gUmV0dXJuIHRoZSBsaW5lIHdlIGZvdW5kLgoKCiAgICAgICAgICAgICAgICAgIHJldHVybiBfZnJhbWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSB3aGlsZSAocyA+PSAxICYmIGMgPj0gMCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfSBmaW5hbGx5IHsKICAgICAgcmVlbnRyeSA9IGZhbHNlOwoKICAgICAgewogICAgICAgIFJlYWN0Q3VycmVudERpc3BhdGNoZXIuY3VycmVudCA9IHByZXZpb3VzRGlzcGF0Y2hlcjsKICAgICAgICByZWVuYWJsZUxvZ3MoKTsKICAgICAgfQoKICAgICAgRXJyb3IucHJlcGFyZVN0YWNrVHJhY2UgPSBwcmV2aW91c1ByZXBhcmVTdGFja1RyYWNlOwogICAgfSAvLyBGYWxsYmFjayB0byBqdXN0IHVzaW5nIHRoZSBuYW1lIGlmIHdlIGNvdWxkbid0IG1ha2UgaXQgdGhyb3cuCgoKICAgIHZhciBuYW1lID0gZm4gPyBmbi5kaXNwbGF5TmFtZSB8fCBmbi5uYW1lIDogJyc7CiAgICB2YXIgc3ludGhldGljRnJhbWUgPSBuYW1lID8gZGVzY3JpYmVCdWlsdEluQ29tcG9uZW50RnJhbWUobmFtZSkgOiAnJzsKCiAgICB7CiAgICAgIGlmICh0eXBlb2YgZm4gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICBjb21wb25lbnRGcmFtZUNhY2hlLnNldChmbiwgc3ludGhldGljRnJhbWUpOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHN5bnRoZXRpY0ZyYW1lOwogIH0KCiAgZnVuY3Rpb24gZGVzY3JpYmVDbGFzc0NvbXBvbmVudEZyYW1lKGN0b3IsIHNvdXJjZSwgb3duZXJGbikgewogICAgewogICAgICByZXR1cm4gZGVzY3JpYmVOYXRpdmVDb21wb25lbnRGcmFtZShjdG9yLCB0cnVlKTsKICAgIH0KICB9CiAgZnVuY3Rpb24gZGVzY3JpYmVGdW5jdGlvbkNvbXBvbmVudEZyYW1lKGZuLCBzb3VyY2UsIG93bmVyRm4pIHsKICAgIHsKICAgICAgcmV0dXJuIGRlc2NyaWJlTmF0aXZlQ29tcG9uZW50RnJhbWUoZm4sIGZhbHNlKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHNob3VsZENvbnN0cnVjdChDb21wb25lbnQpIHsKICAgIHZhciBwcm90b3R5cGUgPSBDb21wb25lbnQucHJvdG90eXBlOwogICAgcmV0dXJuICEhKHByb3RvdHlwZSAmJiBwcm90b3R5cGUuaXNSZWFjdENvbXBvbmVudCk7CiAgfQoKICBmdW5jdGlvbiBkZXNjcmliZVVua25vd25FbGVtZW50VHlwZUZyYW1lSW5ERVYodHlwZSwgc291cmNlLCBvd25lckZuKSB7CgogICAgaWYgKHR5cGUgPT0gbnVsbCkgewogICAgICByZXR1cm4gJyc7CiAgICB9CgogICAgaWYgKHR5cGVvZiB0eXBlID09PSAnZnVuY3Rpb24nKSB7CiAgICAgIHsKICAgICAgICByZXR1cm4gZGVzY3JpYmVOYXRpdmVDb21wb25lbnRGcmFtZSh0eXBlLCBzaG91bGRDb25zdHJ1Y3QodHlwZSkpOwogICAgICB9CiAgICB9CgogICAgaWYgKHR5cGVvZiB0eXBlID09PSAnc3RyaW5nJykgewogICAgICByZXR1cm4gZGVzY3JpYmVCdWlsdEluQ29tcG9uZW50RnJhbWUodHlwZSk7CiAgICB9CgogICAgc3dpdGNoICh0eXBlKSB7CiAgICAgIGNhc2UgUkVBQ1RfU1VTUEVOU0VfVFlQRToKICAgICAgICByZXR1cm4gZGVzY3JpYmVCdWlsdEluQ29tcG9uZW50RnJhbWUoJ1N1c3BlbnNlJyk7CgogICAgICBjYXNlIFJFQUNUX1NVU1BFTlNFX0xJU1RfVFlQRToKICAgICAgICByZXR1cm4gZGVzY3JpYmVCdWlsdEluQ29tcG9uZW50RnJhbWUoJ1N1c3BlbnNlTGlzdCcpOwogICAgfQoKICAgIGlmICh0eXBlb2YgdHlwZSA9PT0gJ29iamVjdCcpIHsKICAgICAgc3dpdGNoICh0eXBlLiQkdHlwZW9mKSB7CiAgICAgICAgY2FzZSBSRUFDVF9GT1JXQVJEX1JFRl9UWVBFOgogICAgICAgICAgcmV0dXJuIGRlc2NyaWJlRnVuY3Rpb25Db21wb25lbnRGcmFtZSh0eXBlLnJlbmRlcik7CgogICAgICAgIGNhc2UgUkVBQ1RfTUVNT19UWVBFOgogICAgICAgICAgLy8gTWVtbyBtYXkgY29udGFpbiBhbnkgY29tcG9uZW50IHR5cGUgc28gd2UgcmVjdXJzaXZlbHkgcmVzb2x2ZSBpdC4KICAgICAgICAgIHJldHVybiBkZXNjcmliZVVua25vd25FbGVtZW50VHlwZUZyYW1lSW5ERVYodHlwZS50eXBlLCBzb3VyY2UsIG93bmVyRm4pOwoKICAgICAgICBjYXNlIFJFQUNUX0xBWllfVFlQRToKICAgICAgICAgIHsKICAgICAgICAgICAgdmFyIGxhenlDb21wb25lbnQgPSB0eXBlOwogICAgICAgICAgICB2YXIgcGF5bG9hZCA9IGxhenlDb21wb25lbnQuX3BheWxvYWQ7CiAgICAgICAgICAgIHZhciBpbml0ID0gbGF6eUNvbXBvbmVudC5faW5pdDsKCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgLy8gTGF6eSBtYXkgY29udGFpbiBhbnkgY29tcG9uZW50IHR5cGUgc28gd2UgcmVjdXJzaXZlbHkgcmVzb2x2ZSBpdC4KICAgICAgICAgICAgICByZXR1cm4gZGVzY3JpYmVVbmtub3duRWxlbWVudFR5cGVGcmFtZUluREVWKGluaXQocGF5bG9hZCksIHNvdXJjZSwgb3duZXJGbik7CiAgICAgICAgICAgIH0gY2F0Y2ggKHgpIHt9CiAgICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gJyc7CiAgfQoKICBmdW5jdGlvbiBkZXNjcmliZUZpYmVyKGZpYmVyKSB7CiAgICB2YXIgb3duZXIgPSAgZmliZXIuX2RlYnVnT3duZXIgPyBmaWJlci5fZGVidWdPd25lci50eXBlIDogbnVsbCA7CiAgICB2YXIgc291cmNlID0gIGZpYmVyLl9kZWJ1Z1NvdXJjZSA7CgogICAgc3dpdGNoIChmaWJlci50YWcpIHsKICAgICAgY2FzZSBIb3N0Q29tcG9uZW50OgogICAgICAgIHJldHVybiBkZXNjcmliZUJ1aWx0SW5Db21wb25lbnRGcmFtZShmaWJlci50eXBlKTsKCiAgICAgIGNhc2UgTGF6eUNvbXBvbmVudDoKICAgICAgICByZXR1cm4gZGVzY3JpYmVCdWlsdEluQ29tcG9uZW50RnJhbWUoJ0xhenknKTsKCiAgICAgIGNhc2UgU3VzcGVuc2VDb21wb25lbnQ6CiAgICAgICAgcmV0dXJuIGRlc2NyaWJlQnVpbHRJbkNvbXBvbmVudEZyYW1lKCdTdXNwZW5zZScpOwoKICAgICAgY2FzZSBTdXNwZW5zZUxpc3RDb21wb25lbnQ6CiAgICAgICAgcmV0dXJuIGRlc2NyaWJlQnVpbHRJbkNvbXBvbmVudEZyYW1lKCdTdXNwZW5zZUxpc3QnKTsKCiAgICAgIGNhc2UgRnVuY3Rpb25Db21wb25lbnQ6CiAgICAgIGNhc2UgSW5kZXRlcm1pbmF0ZUNvbXBvbmVudDoKICAgICAgY2FzZSBTaW1wbGVNZW1vQ29tcG9uZW50OgogICAgICAgIHJldHVybiBkZXNjcmliZUZ1bmN0aW9uQ29tcG9uZW50RnJhbWUoZmliZXIudHlwZSk7CgogICAgICBjYXNlIEZvcndhcmRSZWY6CiAgICAgICAgcmV0dXJuIGRlc2NyaWJlRnVuY3Rpb25Db21wb25lbnRGcmFtZShmaWJlci50eXBlLnJlbmRlcik7CgogICAgICBjYXNlIENsYXNzQ29tcG9uZW50OgogICAgICAgIHJldHVybiBkZXNjcmliZUNsYXNzQ29tcG9uZW50RnJhbWUoZmliZXIudHlwZSk7CgogICAgICBkZWZhdWx0OgogICAgICAgIHJldHVybiAnJzsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGdldFN0YWNrQnlGaWJlckluRGV2QW5kUHJvZCh3b3JrSW5Qcm9ncmVzcykgewogICAgdHJ5IHsKICAgICAgdmFyIGluZm8gPSAnJzsKICAgICAgdmFyIG5vZGUgPSB3b3JrSW5Qcm9ncmVzczsKCiAgICAgIGRvIHsKICAgICAgICBpbmZvICs9IGRlc2NyaWJlRmliZXIobm9kZSk7CiAgICAgICAgbm9kZSA9IG5vZGUucmV0dXJuOwogICAgICB9IHdoaWxlIChub2RlKTsKCiAgICAgIHJldHVybiBpbmZvOwogICAgfSBjYXRjaCAoeCkgewogICAgICByZXR1cm4gJ1xuRXJyb3IgZ2VuZXJhdGluZyBzdGFjazogJyArIHgubWVzc2FnZSArICdcbicgKyB4LnN0YWNrOwogICAgfQogIH0KCiAgZnVuY3Rpb24gZ2V0V3JhcHBlZE5hbWUob3V0ZXJUeXBlLCBpbm5lclR5cGUsIHdyYXBwZXJOYW1lKSB7CiAgICB2YXIgZGlzcGxheU5hbWUgPSBvdXRlclR5cGUuZGlzcGxheU5hbWU7CgogICAgaWYgKGRpc3BsYXlOYW1lKSB7CiAgICAgIHJldHVybiBkaXNwbGF5TmFtZTsKICAgIH0KCiAgICB2YXIgZnVuY3Rpb25OYW1lID0gaW5uZXJUeXBlLmRpc3BsYXlOYW1lIHx8IGlubmVyVHlwZS5uYW1lIHx8ICcnOwogICAgcmV0dXJuIGZ1bmN0aW9uTmFtZSAhPT0gJycgPyB3cmFwcGVyTmFtZSArICIoIiArIGZ1bmN0aW9uTmFtZSArICIpIiA6IHdyYXBwZXJOYW1lOwogIH0gLy8gS2VlcCBpbiBzeW5jIHdpdGggcmVhY3QtcmVjb25jaWxlci9nZXRDb21wb25lbnROYW1lRnJvbUZpYmVyCgoKICBmdW5jdGlvbiBnZXRDb250ZXh0TmFtZSh0eXBlKSB7CiAgICByZXR1cm4gdHlwZS5kaXNwbGF5TmFtZSB8fCAnQ29udGV4dCc7CiAgfSAvLyBOb3RlIHRoYXQgdGhlIHJlY29uY2lsZXIgcGFja2FnZSBzaG91bGQgZ2VuZXJhbGx5IHByZWZlciB0byB1c2UgZ2V0Q29tcG9uZW50TmFtZUZyb21GaWJlcigpIGluc3RlYWQuCgoKICBmdW5jdGlvbiBnZXRDb21wb25lbnROYW1lRnJvbVR5cGUodHlwZSkgewogICAgaWYgKHR5cGUgPT0gbnVsbCkgewogICAgICAvLyBIb3N0IHJvb3QsIHRleHQgbm9kZSBvciBqdXN0IGludmFsaWQgdHlwZS4KICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgewogICAgICBpZiAodHlwZW9mIHR5cGUudGFnID09PSAnbnVtYmVyJykgewogICAgICAgIGVycm9yKCdSZWNlaXZlZCBhbiB1bmV4cGVjdGVkIG9iamVjdCBpbiBnZXRDb21wb25lbnROYW1lRnJvbVR5cGUoKS4gJyArICdUaGlzIGlzIGxpa2VseSBhIGJ1ZyBpbiBSZWFjdC4gUGxlYXNlIGZpbGUgYW4gaXNzdWUuJyk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAodHlwZW9mIHR5cGUgPT09ICdmdW5jdGlvbicpIHsKICAgICAgcmV0dXJuIHR5cGUuZGlzcGxheU5hbWUgfHwgdHlwZS5uYW1lIHx8IG51bGw7CiAgICB9CgogICAgaWYgKHR5cGVvZiB0eXBlID09PSAnc3RyaW5nJykgewogICAgICByZXR1cm4gdHlwZTsKICAgIH0KCiAgICBzd2l0Y2ggKHR5cGUpIHsKICAgICAgY2FzZSBSRUFDVF9GUkFHTUVOVF9UWVBFOgogICAgICAgIHJldHVybiAnRnJhZ21lbnQnOwoKICAgICAgY2FzZSBSRUFDVF9QT1JUQUxfVFlQRToKICAgICAgICByZXR1cm4gJ1BvcnRhbCc7CgogICAgICBjYXNlIFJFQUNUX1BST0ZJTEVSX1RZUEU6CiAgICAgICAgcmV0dXJuICdQcm9maWxlcic7CgogICAgICBjYXNlIFJFQUNUX1NUUklDVF9NT0RFX1RZUEU6CiAgICAgICAgcmV0dXJuICdTdHJpY3RNb2RlJzsKCiAgICAgIGNhc2UgUkVBQ1RfU1VTUEVOU0VfVFlQRToKICAgICAgICByZXR1cm4gJ1N1c3BlbnNlJzsKCiAgICAgIGNhc2UgUkVBQ1RfU1VTUEVOU0VfTElTVF9UWVBFOgogICAgICAgIHJldHVybiAnU3VzcGVuc2VMaXN0JzsKCiAgICB9CgogICAgaWYgKHR5cGVvZiB0eXBlID09PSAnb2JqZWN0JykgewogICAgICBzd2l0Y2ggKHR5cGUuJCR0eXBlb2YpIHsKICAgICAgICBjYXNlIFJFQUNUX0NPTlRFWFRfVFlQRToKICAgICAgICAgIHZhciBjb250ZXh0ID0gdHlwZTsKICAgICAgICAgIHJldHVybiBnZXRDb250ZXh0TmFtZShjb250ZXh0KSArICcuQ29uc3VtZXInOwoKICAgICAgICBjYXNlIFJFQUNUX1BST1ZJREVSX1RZUEU6CiAgICAgICAgICB2YXIgcHJvdmlkZXIgPSB0eXBlOwogICAgICAgICAgcmV0dXJuIGdldENvbnRleHROYW1lKHByb3ZpZGVyLl9jb250ZXh0KSArICcuUHJvdmlkZXInOwoKICAgICAgICBjYXNlIFJFQUNUX0ZPUldBUkRfUkVGX1RZUEU6CiAgICAgICAgICByZXR1cm4gZ2V0V3JhcHBlZE5hbWUodHlwZSwgdHlwZS5yZW5kZXIsICdGb3J3YXJkUmVmJyk7CgogICAgICAgIGNhc2UgUkVBQ1RfTUVNT19UWVBFOgogICAgICAgICAgdmFyIG91dGVyTmFtZSA9IHR5cGUuZGlzcGxheU5hbWUgfHwgbnVsbDsKCiAgICAgICAgICBpZiAob3V0ZXJOYW1lICE9PSBudWxsKSB7CiAgICAgICAgICAgIHJldHVybiBvdXRlck5hbWU7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIGdldENvbXBvbmVudE5hbWVGcm9tVHlwZSh0eXBlLnR5cGUpIHx8ICdNZW1vJzsKCiAgICAgICAgY2FzZSBSRUFDVF9MQVpZX1RZUEU6CiAgICAgICAgICB7CiAgICAgICAgICAgIHZhciBsYXp5Q29tcG9uZW50ID0gdHlwZTsKICAgICAgICAgICAgdmFyIHBheWxvYWQgPSBsYXp5Q29tcG9uZW50Ll9wYXlsb2FkOwogICAgICAgICAgICB2YXIgaW5pdCA9IGxhenlDb21wb25lbnQuX2luaXQ7CgogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIHJldHVybiBnZXRDb21wb25lbnROYW1lRnJvbVR5cGUoaW5pdChwYXlsb2FkKSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKHgpIHsKICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tZmFsbHRocm91Z2gKICAgICAgfQogICAgfQoKICAgIHJldHVybiBudWxsOwogIH0KCiAgZnVuY3Rpb24gZ2V0V3JhcHBlZE5hbWUkMShvdXRlclR5cGUsIGlubmVyVHlwZSwgd3JhcHBlck5hbWUpIHsKICAgIHZhciBmdW5jdGlvbk5hbWUgPSBpbm5lclR5cGUuZGlzcGxheU5hbWUgfHwgaW5uZXJUeXBlLm5hbWUgfHwgJyc7CiAgICByZXR1cm4gb3V0ZXJUeXBlLmRpc3BsYXlOYW1lIHx8IChmdW5jdGlvbk5hbWUgIT09ICcnID8gd3JhcHBlck5hbWUgKyAiKCIgKyBmdW5jdGlvbk5hbWUgKyAiKSIgOiB3cmFwcGVyTmFtZSk7CiAgfSAvLyBLZWVwIGluIHN5bmMgd2l0aCBzaGFyZWQvZ2V0Q29tcG9uZW50TmFtZUZyb21UeXBlCgoKICBmdW5jdGlvbiBnZXRDb250ZXh0TmFtZSQxKHR5cGUpIHsKICAgIHJldHVybiB0eXBlLmRpc3BsYXlOYW1lIHx8ICdDb250ZXh0JzsKICB9CgogIGZ1bmN0aW9uIGdldENvbXBvbmVudE5hbWVGcm9tRmliZXIoZmliZXIpIHsKICAgIHZhciB0YWcgPSBmaWJlci50YWcsCiAgICAgICAgdHlwZSA9IGZpYmVyLnR5cGU7CgogICAgc3dpdGNoICh0YWcpIHsKICAgICAgY2FzZSBDYWNoZUNvbXBvbmVudDoKICAgICAgICByZXR1cm4gJ0NhY2hlJzsKCiAgICAgIGNhc2UgQ29udGV4dENvbnN1bWVyOgogICAgICAgIHZhciBjb250ZXh0ID0gdHlwZTsKICAgICAgICByZXR1cm4gZ2V0Q29udGV4dE5hbWUkMShjb250ZXh0KSArICcuQ29uc3VtZXInOwoKICAgICAgY2FzZSBDb250ZXh0UHJvdmlkZXI6CiAgICAgICAgdmFyIHByb3ZpZGVyID0gdHlwZTsKICAgICAgICByZXR1cm4gZ2V0Q29udGV4dE5hbWUkMShwcm92aWRlci5fY29udGV4dCkgKyAnLlByb3ZpZGVyJzsKCiAgICAgIGNhc2UgRGVoeWRyYXRlZEZyYWdtZW50OgogICAgICAgIHJldHVybiAnRGVoeWRyYXRlZEZyYWdtZW50JzsKCiAgICAgIGNhc2UgRm9yd2FyZFJlZjoKICAgICAgICByZXR1cm4gZ2V0V3JhcHBlZE5hbWUkMSh0eXBlLCB0eXBlLnJlbmRlciwgJ0ZvcndhcmRSZWYnKTsKCiAgICAgIGNhc2UgRnJhZ21lbnQ6CiAgICAgICAgcmV0dXJuICdGcmFnbWVudCc7CgogICAgICBjYXNlIEhvc3RDb21wb25lbnQ6CiAgICAgICAgLy8gSG9zdCBjb21wb25lbnQgdHlwZSBpcyB0aGUgZGlzcGxheSBuYW1lIChlLmcuICJkaXYiLCAiVmlldyIpCiAgICAgICAgcmV0dXJuIHR5cGU7CgogICAgICBjYXNlIEhvc3RQb3J0YWw6CiAgICAgICAgcmV0dXJuICdQb3J0YWwnOwoKICAgICAgY2FzZSBIb3N0Um9vdDoKICAgICAgICByZXR1cm4gJ1Jvb3QnOwoKICAgICAgY2FzZSBIb3N0VGV4dDoKICAgICAgICByZXR1cm4gJ1RleHQnOwoKICAgICAgY2FzZSBMYXp5Q29tcG9uZW50OgogICAgICAgIC8vIE5hbWUgY29tZXMgZnJvbSB0aGUgdHlwZSBpbiB0aGlzIGNhc2U7IHdlIGRvbid0IGhhdmUgYSB0YWcuCiAgICAgICAgcmV0dXJuIGdldENvbXBvbmVudE5hbWVGcm9tVHlwZSh0eXBlKTsKCiAgICAgIGNhc2UgTW9kZToKICAgICAgICBpZiAodHlwZSA9PT0gUkVBQ1RfU1RSSUNUX01PREVfVFlQRSkgewogICAgICAgICAgLy8gRG9uJ3QgYmUgbGVzcyBzcGVjaWZpYyB0aGFuIHNoYXJlZC9nZXRDb21wb25lbnROYW1lRnJvbVR5cGUKICAgICAgICAgIHJldHVybiAnU3RyaWN0TW9kZSc7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gJ01vZGUnOwoKICAgICAgY2FzZSBPZmZzY3JlZW5Db21wb25lbnQ6CiAgICAgICAgcmV0dXJuICdPZmZzY3JlZW4nOwoKICAgICAgY2FzZSBQcm9maWxlcjoKICAgICAgICByZXR1cm4gJ1Byb2ZpbGVyJzsKCiAgICAgIGNhc2UgU2NvcGVDb21wb25lbnQ6CiAgICAgICAgcmV0dXJuICdTY29wZSc7CgogICAgICBjYXNlIFN1c3BlbnNlQ29tcG9uZW50OgogICAgICAgIHJldHVybiAnU3VzcGVuc2UnOwoKICAgICAgY2FzZSBTdXNwZW5zZUxpc3RDb21wb25lbnQ6CiAgICAgICAgcmV0dXJuICdTdXNwZW5zZUxpc3QnOwoKICAgICAgY2FzZSBUcmFjaW5nTWFya2VyQ29tcG9uZW50OgogICAgICAgIHJldHVybiAnVHJhY2luZ01hcmtlcic7CiAgICAgIC8vIFRoZSBkaXNwbGF5IG5hbWUgZm9yIHRoaXMgdGFncyBjb21lIGZyb20gdGhlIHVzZXItcHJvdmlkZWQgdHlwZToKCiAgICAgIGNhc2UgQ2xhc3NDb21wb25lbnQ6CiAgICAgIGNhc2UgRnVuY3Rpb25Db21wb25lbnQ6CiAgICAgIGNhc2UgSW5jb21wbGV0ZUNsYXNzQ29tcG9uZW50OgogICAgICBjYXNlIEluZGV0ZXJtaW5hdGVDb21wb25lbnQ6CiAgICAgIGNhc2UgTWVtb0NvbXBvbmVudDoKICAgICAgY2FzZSBTaW1wbGVNZW1vQ29tcG9uZW50OgogICAgICAgIGlmICh0eXBlb2YgdHlwZSA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgcmV0dXJuIHR5cGUuZGlzcGxheU5hbWUgfHwgdHlwZS5uYW1lIHx8IG51bGw7CiAgICAgICAgfQoKICAgICAgICBpZiAodHlwZW9mIHR5cGUgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgICByZXR1cm4gdHlwZTsKICAgICAgICB9CgogICAgICAgIGJyZWFrOwoKICAgIH0KCiAgICByZXR1cm4gbnVsbDsKICB9CgogIHZhciBSZWFjdERlYnVnQ3VycmVudEZyYW1lID0gUmVhY3RTaGFyZWRJbnRlcm5hbHMuUmVhY3REZWJ1Z0N1cnJlbnRGcmFtZTsKICB2YXIgY3VycmVudCA9IG51bGw7CiAgdmFyIGlzUmVuZGVyaW5nID0gZmFsc2U7CiAgZnVuY3Rpb24gZ2V0Q3VycmVudEZpYmVyT3duZXJOYW1lSW5EZXZPck51bGwoKSB7CiAgICB7CiAgICAgIGlmIChjdXJyZW50ID09PSBudWxsKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIHZhciBvd25lciA9IGN1cnJlbnQuX2RlYnVnT3duZXI7CgogICAgICBpZiAob3duZXIgIT09IG51bGwgJiYgdHlwZW9mIG93bmVyICE9PSAndW5kZWZpbmVkJykgewogICAgICAgIHJldHVybiBnZXRDb21wb25lbnROYW1lRnJvbUZpYmVyKG93bmVyKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBudWxsOwogIH0KCiAgZnVuY3Rpb24gZ2V0Q3VycmVudEZpYmVyU3RhY2tJbkRldigpIHsKICAgIHsKICAgICAgaWYgKGN1cnJlbnQgPT09IG51bGwpIHsKICAgICAgICByZXR1cm4gJyc7CiAgICAgIH0gLy8gU2FmZSBiZWNhdXNlIGlmIGN1cnJlbnQgZmliZXIgZXhpc3RzLCB3ZSBhcmUgcmVjb25jaWxpbmcsCiAgICAgIC8vIGFuZCBpdCBpcyBndWFyYW50ZWVkIHRvIGJlIHRoZSB3b3JrLWluLXByb2dyZXNzIHZlcnNpb24uCgoKICAgICAgcmV0dXJuIGdldFN0YWNrQnlGaWJlckluRGV2QW5kUHJvZChjdXJyZW50KTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHJlc2V0Q3VycmVudEZpYmVyKCkgewogICAgewogICAgICBSZWFjdERlYnVnQ3VycmVudEZyYW1lLmdldEN1cnJlbnRTdGFjayA9IG51bGw7CiAgICAgIGN1cnJlbnQgPSBudWxsOwogICAgICBpc1JlbmRlcmluZyA9IGZhbHNlOwogICAgfQogIH0KICBmdW5jdGlvbiBzZXRDdXJyZW50RmliZXIoZmliZXIpIHsKICAgIHsKICAgICAgUmVhY3REZWJ1Z0N1cnJlbnRGcmFtZS5nZXRDdXJyZW50U3RhY2sgPSBmaWJlciA9PT0gbnVsbCA/IG51bGwgOiBnZXRDdXJyZW50RmliZXJTdGFja0luRGV2OwogICAgICBjdXJyZW50ID0gZmliZXI7CiAgICAgIGlzUmVuZGVyaW5nID0gZmFsc2U7CiAgICB9CiAgfQogIGZ1bmN0aW9uIGdldEN1cnJlbnRGaWJlcigpIHsKICAgIHsKICAgICAgcmV0dXJuIGN1cnJlbnQ7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHNldElzUmVuZGVyaW5nKHJlbmRlcmluZykgewogICAgewogICAgICBpc1JlbmRlcmluZyA9IHJlbmRlcmluZzsKICAgIH0KICB9CgogIC8vIEZsb3cgZG9lcyBub3QgYWxsb3cgc3RyaW5nIGNvbmNhdGVuYXRpb24gb2YgbW9zdCBub24tc3RyaW5nIHR5cGVzLiBUbyB3b3JrCiAgLy8gYXJvdW5kIHRoaXMgbGltaXRhdGlvbiwgd2UgdXNlIGFuIG9wYXF1ZSB0eXBlIHRoYXQgY2FuIG9ubHkgYmUgb2J0YWluZWQgYnkKICAvLyBwYXNzaW5nIHRoZSB2YWx1ZSB0aHJvdWdoIGdldFRvU3RyaW5nVmFsdWUgZmlyc3QuCiAgZnVuY3Rpb24gdG9TdHJpbmcodmFsdWUpIHsKICAgIC8vIFRoZSBjb2VyY2lvbiBzYWZldHkgY2hlY2sgaXMgcGVyZm9ybWVkIGluIGdldFRvU3RyaW5nVmFsdWUoKS4KICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC1pbnRlcm5hbC9zYWZlLXN0cmluZy1jb2VyY2lvbgogICAgcmV0dXJuICcnICsgdmFsdWU7CiAgfQogIGZ1bmN0aW9uIGdldFRvU3RyaW5nVmFsdWUodmFsdWUpIHsKICAgIHN3aXRjaCAodHlwZW9mIHZhbHVlKSB7CiAgICAgIGNhc2UgJ2Jvb2xlYW4nOgogICAgICBjYXNlICdudW1iZXInOgogICAgICBjYXNlICdzdHJpbmcnOgogICAgICBjYXNlICd1bmRlZmluZWQnOgogICAgICAgIHJldHVybiB2YWx1ZTsKCiAgICAgIGNhc2UgJ29iamVjdCc6CiAgICAgICAgewogICAgICAgICAgY2hlY2tGb3JtRmllbGRWYWx1ZVN0cmluZ0NvZXJjaW9uKHZhbHVlKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiB2YWx1ZTsKCiAgICAgIGRlZmF1bHQ6CiAgICAgICAgLy8gZnVuY3Rpb24sIHN5bWJvbCBhcmUgYXNzaWduZWQgYXMgZW1wdHkgc3RyaW5ncwogICAgICAgIHJldHVybiAnJzsKICAgIH0KICB9CgogIHZhciBoYXNSZWFkT25seVZhbHVlID0gewogICAgYnV0dG9uOiB0cnVlLAogICAgY2hlY2tib3g6IHRydWUsCiAgICBpbWFnZTogdHJ1ZSwKICAgIGhpZGRlbjogdHJ1ZSwKICAgIHJhZGlvOiB0cnVlLAogICAgcmVzZXQ6IHRydWUsCiAgICBzdWJtaXQ6IHRydWUKICB9OwogIGZ1bmN0aW9uIGNoZWNrQ29udHJvbGxlZFZhbHVlUHJvcHModGFnTmFtZSwgcHJvcHMpIHsKICAgIHsKICAgICAgaWYgKCEoaGFzUmVhZE9ubHlWYWx1ZVtwcm9wcy50eXBlXSB8fCBwcm9wcy5vbkNoYW5nZSB8fCBwcm9wcy5vbklucHV0IHx8IHByb3BzLnJlYWRPbmx5IHx8IHByb3BzLmRpc2FibGVkIHx8IHByb3BzLnZhbHVlID09IG51bGwpKSB7CiAgICAgICAgZXJyb3IoJ1lvdSBwcm92aWRlZCBhIGB2YWx1ZWAgcHJvcCB0byBhIGZvcm0gZmllbGQgd2l0aG91dCBhbiAnICsgJ2BvbkNoYW5nZWAgaGFuZGxlci4gVGhpcyB3aWxsIHJlbmRlciBhIHJlYWQtb25seSBmaWVsZC4gSWYgJyArICd0aGUgZmllbGQgc2hvdWxkIGJlIG11dGFibGUgdXNlIGBkZWZhdWx0VmFsdWVgLiBPdGhlcndpc2UsICcgKyAnc2V0IGVpdGhlciBgb25DaGFuZ2VgIG9yIGByZWFkT25seWAuJyk7CiAgICAgIH0KCiAgICAgIGlmICghKHByb3BzLm9uQ2hhbmdlIHx8IHByb3BzLnJlYWRPbmx5IHx8IHByb3BzLmRpc2FibGVkIHx8IHByb3BzLmNoZWNrZWQgPT0gbnVsbCkpIHsKICAgICAgICBlcnJvcignWW91IHByb3ZpZGVkIGEgYGNoZWNrZWRgIHByb3AgdG8gYSBmb3JtIGZpZWxkIHdpdGhvdXQgYW4gJyArICdgb25DaGFuZ2VgIGhhbmRsZXIuIFRoaXMgd2lsbCByZW5kZXIgYSByZWFkLW9ubHkgZmllbGQuIElmICcgKyAndGhlIGZpZWxkIHNob3VsZCBiZSBtdXRhYmxlIHVzZSBgZGVmYXVsdENoZWNrZWRgLiBPdGhlcndpc2UsICcgKyAnc2V0IGVpdGhlciBgb25DaGFuZ2VgIG9yIGByZWFkT25seWAuJyk7CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIGlzQ2hlY2thYmxlKGVsZW0pIHsKICAgIHZhciB0eXBlID0gZWxlbS50eXBlOwogICAgdmFyIG5vZGVOYW1lID0gZWxlbS5ub2RlTmFtZTsKICAgIHJldHVybiBub2RlTmFtZSAmJiBub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSAnaW5wdXQnICYmICh0eXBlID09PSAnY2hlY2tib3gnIHx8IHR5cGUgPT09ICdyYWRpbycpOwogIH0KCiAgZnVuY3Rpb24gZ2V0VHJhY2tlcihub2RlKSB7CiAgICByZXR1cm4gbm9kZS5fdmFsdWVUcmFja2VyOwogIH0KCiAgZnVuY3Rpb24gZGV0YWNoVHJhY2tlcihub2RlKSB7CiAgICBub2RlLl92YWx1ZVRyYWNrZXIgPSBudWxsOwogIH0KCiAgZnVuY3Rpb24gZ2V0VmFsdWVGcm9tTm9kZShub2RlKSB7CiAgICB2YXIgdmFsdWUgPSAnJzsKCiAgICBpZiAoIW5vZGUpIHsKICAgICAgcmV0dXJuIHZhbHVlOwogICAgfQoKICAgIGlmIChpc0NoZWNrYWJsZShub2RlKSkgewogICAgICB2YWx1ZSA9IG5vZGUuY2hlY2tlZCA/ICd0cnVlJyA6ICdmYWxzZSc7CiAgICB9IGVsc2UgewogICAgICB2YWx1ZSA9IG5vZGUudmFsdWU7CiAgICB9CgogICAgcmV0dXJuIHZhbHVlOwogIH0KCiAgZnVuY3Rpb24gdHJhY2tWYWx1ZU9uTm9kZShub2RlKSB7CiAgICB2YXIgdmFsdWVGaWVsZCA9IGlzQ2hlY2thYmxlKG5vZGUpID8gJ2NoZWNrZWQnIDogJ3ZhbHVlJzsKICAgIHZhciBkZXNjcmlwdG9yID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihub2RlLmNvbnN0cnVjdG9yLnByb3RvdHlwZSwgdmFsdWVGaWVsZCk7CgogICAgewogICAgICBjaGVja0Zvcm1GaWVsZFZhbHVlU3RyaW5nQ29lcmNpb24obm9kZVt2YWx1ZUZpZWxkXSk7CiAgICB9CgogICAgdmFyIGN1cnJlbnRWYWx1ZSA9ICcnICsgbm9kZVt2YWx1ZUZpZWxkXTsgLy8gaWYgc29tZW9uZSBoYXMgYWxyZWFkeSBkZWZpbmVkIGEgdmFsdWUgb3IgU2FmYXJpLCB0aGVuIGJhaWwKICAgIC8vIGFuZCBkb24ndCB0cmFjayB2YWx1ZSB3aWxsIGNhdXNlIG92ZXIgcmVwb3J0aW5nIG9mIGNoYW5nZXMsCiAgICAvLyBidXQgaXQncyBiZXR0ZXIgdGhlbiBhIGhhcmQgZmFpbHVyZQogICAgLy8gKG5lZWRlZCBmb3IgY2VydGFpbiB0ZXN0cyB0aGF0IHNweU9uIGlucHV0IHZhbHVlcyBhbmQgU2FmYXJpKQoKICAgIGlmIChub2RlLmhhc093blByb3BlcnR5KHZhbHVlRmllbGQpIHx8IHR5cGVvZiBkZXNjcmlwdG9yID09PSAndW5kZWZpbmVkJyB8fCB0eXBlb2YgZGVzY3JpcHRvci5nZXQgIT09ICdmdW5jdGlvbicgfHwgdHlwZW9mIGRlc2NyaXB0b3Iuc2V0ICE9PSAnZnVuY3Rpb24nKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB2YXIgZ2V0ID0gZGVzY3JpcHRvci5nZXQsCiAgICAgICAgc2V0ID0gZGVzY3JpcHRvci5zZXQ7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobm9kZSwgdmFsdWVGaWVsZCwgewogICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgIGdldDogZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBnZXQuY2FsbCh0aGlzKTsKICAgICAgfSwKICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICB7CiAgICAgICAgICBjaGVja0Zvcm1GaWVsZFZhbHVlU3RyaW5nQ29lcmNpb24odmFsdWUpOwogICAgICAgIH0KCiAgICAgICAgY3VycmVudFZhbHVlID0gJycgKyB2YWx1ZTsKICAgICAgICBzZXQuY2FsbCh0aGlzLCB2YWx1ZSk7CiAgICAgIH0KICAgIH0pOyAvLyBXZSBjb3VsZCd2ZSBwYXNzZWQgdGhpcyB0aGUgZmlyc3QgdGltZQogICAgLy8gYnV0IGl0IHRyaWdnZXJzIGEgYnVnIGluIElFMTEgYW5kIEVkZ2UgMTQvMTUuCiAgICAvLyBDYWxsaW5nIGRlZmluZVByb3BlcnR5KCkgYWdhaW4gc2hvdWxkIGJlIGVxdWl2YWxlbnQuCiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2svcmVhY3QvaXNzdWVzLzExNzY4CgogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5vZGUsIHZhbHVlRmllbGQsIHsKICAgICAgZW51bWVyYWJsZTogZGVzY3JpcHRvci5lbnVtZXJhYmxlCiAgICB9KTsKICAgIHZhciB0cmFja2VyID0gewogICAgICBnZXRWYWx1ZTogZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBjdXJyZW50VmFsdWU7CiAgICAgIH0sCiAgICAgIHNldFZhbHVlOiBmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICB7CiAgICAgICAgICBjaGVja0Zvcm1GaWVsZFZhbHVlU3RyaW5nQ29lcmNpb24odmFsdWUpOwogICAgICAgIH0KCiAgICAgICAgY3VycmVudFZhbHVlID0gJycgKyB2YWx1ZTsKICAgICAgfSwKICAgICAgc3RvcFRyYWNraW5nOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgZGV0YWNoVHJhY2tlcihub2RlKTsKICAgICAgICBkZWxldGUgbm9kZVt2YWx1ZUZpZWxkXTsKICAgICAgfQogICAgfTsKICAgIHJldHVybiB0cmFja2VyOwogIH0KCiAgZnVuY3Rpb24gdHJhY2sobm9kZSkgewogICAgaWYgKGdldFRyYWNrZXIobm9kZSkpIHsKICAgICAgcmV0dXJuOwogICAgfSAvLyBUT0RPOiBPbmNlIGl0J3MganVzdCBGaWJlciB3ZSBjYW4gbW92ZSB0aGlzIHRvIG5vZGUuX3dyYXBwZXJTdGF0ZQoKCiAgICBub2RlLl92YWx1ZVRyYWNrZXIgPSB0cmFja1ZhbHVlT25Ob2RlKG5vZGUpOwogIH0KICBmdW5jdGlvbiB1cGRhdGVWYWx1ZUlmQ2hhbmdlZChub2RlKSB7CiAgICBpZiAoIW5vZGUpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIHZhciB0cmFja2VyID0gZ2V0VHJhY2tlcihub2RlKTsgLy8gaWYgdGhlcmUgaXMgbm8gdHJhY2tlciBhdCB0aGlzIHBvaW50IGl0J3MgdW5saWtlbHkKICAgIC8vIHRoYXQgdHJ5aW5nIGFnYWluIHdpbGwgc3VjY2VlZAoKICAgIGlmICghdHJhY2tlcikgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICB2YXIgbGFzdFZhbHVlID0gdHJhY2tlci5nZXRWYWx1ZSgpOwogICAgdmFyIG5leHRWYWx1ZSA9IGdldFZhbHVlRnJvbU5vZGUobm9kZSk7CgogICAgaWYgKG5leHRWYWx1ZSAhPT0gbGFzdFZhbHVlKSB7CiAgICAgIHRyYWNrZXIuc2V0VmFsdWUobmV4dFZhbHVlKTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgZnVuY3Rpb24gZ2V0QWN0aXZlRWxlbWVudChkb2MpIHsKICAgIGRvYyA9IGRvYyB8fCAodHlwZW9mIGRvY3VtZW50ICE9PSAndW5kZWZpbmVkJyA/IGRvY3VtZW50IDogdW5kZWZpbmVkKTsKCiAgICBpZiAodHlwZW9mIGRvYyA9PT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgdHJ5IHsKICAgICAgcmV0dXJuIGRvYy5hY3RpdmVFbGVtZW50IHx8IGRvYy5ib2R5OwogICAgfSBjYXRjaCAoZSkgewogICAgICByZXR1cm4gZG9jLmJvZHk7CiAgICB9CiAgfQoKICB2YXIgZGlkV2FyblZhbHVlRGVmYXVsdFZhbHVlID0gZmFsc2U7CiAgdmFyIGRpZFdhcm5DaGVja2VkRGVmYXVsdENoZWNrZWQgPSBmYWxzZTsKICB2YXIgZGlkV2FybkNvbnRyb2xsZWRUb1VuY29udHJvbGxlZCA9IGZhbHNlOwogIHZhciBkaWRXYXJuVW5jb250cm9sbGVkVG9Db250cm9sbGVkID0gZmFsc2U7CgogIGZ1bmN0aW9uIGlzQ29udHJvbGxlZChwcm9wcykgewogICAgdmFyIHVzZXNDaGVja2VkID0gcHJvcHMudHlwZSA9PT0gJ2NoZWNrYm94JyB8fCBwcm9wcy50eXBlID09PSAncmFkaW8nOwogICAgcmV0dXJuIHVzZXNDaGVja2VkID8gcHJvcHMuY2hlY2tlZCAhPSBudWxsIDogcHJvcHMudmFsdWUgIT0gbnVsbDsKICB9CiAgLyoqCiAgICogSW1wbGVtZW50cyBhbiA8aW5wdXQ+IGhvc3QgY29tcG9uZW50IHRoYXQgYWxsb3dzIHNldHRpbmcgdGhlc2Ugb3B0aW9uYWwKICAgKiBwcm9wczogYGNoZWNrZWRgLCBgdmFsdWVgLCBgZGVmYXVsdENoZWNrZWRgLCBhbmQgYGRlZmF1bHRWYWx1ZWAuCiAgICoKICAgKiBJZiBgY2hlY2tlZGAgb3IgYHZhbHVlYCBhcmUgbm90IHN1cHBsaWVkIChvciBudWxsL3VuZGVmaW5lZCksIHVzZXIgYWN0aW9ucwogICAqIHRoYXQgYWZmZWN0IHRoZSBjaGVja2VkIHN0YXRlIG9yIHZhbHVlIHdpbGwgdHJpZ2dlciB1cGRhdGVzIHRvIHRoZSBlbGVtZW50LgogICAqCiAgICogSWYgdGhleSBhcmUgc3VwcGxpZWQgKGFuZCBub3QgbnVsbC91bmRlZmluZWQpLCB0aGUgcmVuZGVyZWQgZWxlbWVudCB3aWxsIG5vdAogICAqIHRyaWdnZXIgdXBkYXRlcyB0byB0aGUgZWxlbWVudC4gSW5zdGVhZCwgdGhlIHByb3BzIG11c3QgY2hhbmdlIGluIG9yZGVyIGZvcgogICAqIHRoZSByZW5kZXJlZCBlbGVtZW50IHRvIGJlIHVwZGF0ZWQuCiAgICoKICAgKiBUaGUgcmVuZGVyZWQgZWxlbWVudCB3aWxsIGJlIGluaXRpYWxpemVkIGFzIHVuY2hlY2tlZCAob3IgYGRlZmF1bHRDaGVja2VkYCkKICAgKiB3aXRoIGFuIGVtcHR5IHZhbHVlIChvciBgZGVmYXVsdFZhbHVlYCkuCiAgICoKICAgKiBTZWUgaHR0cDovL3d3dy53My5vcmcvVFIvMjAxMi9XRC1odG1sNS0yMDEyMTAyNS90aGUtaW5wdXQtZWxlbWVudC5odG1sCiAgICovCgoKICBmdW5jdGlvbiBnZXRIb3N0UHJvcHMoZWxlbWVudCwgcHJvcHMpIHsKICAgIHZhciBub2RlID0gZWxlbWVudDsKICAgIHZhciBjaGVja2VkID0gcHJvcHMuY2hlY2tlZDsKICAgIHZhciBob3N0UHJvcHMgPSBhc3NpZ24oe30sIHByb3BzLCB7CiAgICAgIGRlZmF1bHRDaGVja2VkOiB1bmRlZmluZWQsCiAgICAgIGRlZmF1bHRWYWx1ZTogdW5kZWZpbmVkLAogICAgICB2YWx1ZTogdW5kZWZpbmVkLAogICAgICBjaGVja2VkOiBjaGVja2VkICE9IG51bGwgPyBjaGVja2VkIDogbm9kZS5fd3JhcHBlclN0YXRlLmluaXRpYWxDaGVja2VkCiAgICB9KTsKICAgIHJldHVybiBob3N0UHJvcHM7CiAgfQogIGZ1bmN0aW9uIGluaXRXcmFwcGVyU3RhdGUoZWxlbWVudCwgcHJvcHMpIHsKICAgIHsKICAgICAgY2hlY2tDb250cm9sbGVkVmFsdWVQcm9wcygnaW5wdXQnLCBwcm9wcyk7CgogICAgICBpZiAocHJvcHMuY2hlY2tlZCAhPT0gdW5kZWZpbmVkICYmIHByb3BzLmRlZmF1bHRDaGVja2VkICE9PSB1bmRlZmluZWQgJiYgIWRpZFdhcm5DaGVja2VkRGVmYXVsdENoZWNrZWQpIHsKICAgICAgICBlcnJvcignJXMgY29udGFpbnMgYW4gaW5wdXQgb2YgdHlwZSAlcyB3aXRoIGJvdGggY2hlY2tlZCBhbmQgZGVmYXVsdENoZWNrZWQgcHJvcHMuICcgKyAnSW5wdXQgZWxlbWVudHMgbXVzdCBiZSBlaXRoZXIgY29udHJvbGxlZCBvciB1bmNvbnRyb2xsZWQgJyArICcoc3BlY2lmeSBlaXRoZXIgdGhlIGNoZWNrZWQgcHJvcCwgb3IgdGhlIGRlZmF1bHRDaGVja2VkIHByb3AsIGJ1dCBub3QgJyArICdib3RoKS4gRGVjaWRlIGJldHdlZW4gdXNpbmcgYSBjb250cm9sbGVkIG9yIHVuY29udHJvbGxlZCBpbnB1dCAnICsgJ2VsZW1lbnQgYW5kIHJlbW92ZSBvbmUgb2YgdGhlc2UgcHJvcHMuIE1vcmUgaW5mbzogJyArICdodHRwczovL3JlYWN0anMub3JnL2xpbmsvY29udHJvbGxlZC1jb21wb25lbnRzJywgZ2V0Q3VycmVudEZpYmVyT3duZXJOYW1lSW5EZXZPck51bGwoKSB8fCAnQSBjb21wb25lbnQnLCBwcm9wcy50eXBlKTsKCiAgICAgICAgZGlkV2FybkNoZWNrZWREZWZhdWx0Q2hlY2tlZCA9IHRydWU7CiAgICAgIH0KCiAgICAgIGlmIChwcm9wcy52YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHByb3BzLmRlZmF1bHRWYWx1ZSAhPT0gdW5kZWZpbmVkICYmICFkaWRXYXJuVmFsdWVEZWZhdWx0VmFsdWUpIHsKICAgICAgICBlcnJvcignJXMgY29udGFpbnMgYW4gaW5wdXQgb2YgdHlwZSAlcyB3aXRoIGJvdGggdmFsdWUgYW5kIGRlZmF1bHRWYWx1ZSBwcm9wcy4gJyArICdJbnB1dCBlbGVtZW50cyBtdXN0IGJlIGVpdGhlciBjb250cm9sbGVkIG9yIHVuY29udHJvbGxlZCAnICsgJyhzcGVjaWZ5IGVpdGhlciB0aGUgdmFsdWUgcHJvcCwgb3IgdGhlIGRlZmF1bHRWYWx1ZSBwcm9wLCBidXQgbm90ICcgKyAnYm90aCkuIERlY2lkZSBiZXR3ZWVuIHVzaW5nIGEgY29udHJvbGxlZCBvciB1bmNvbnRyb2xsZWQgaW5wdXQgJyArICdlbGVtZW50IGFuZCByZW1vdmUgb25lIG9mIHRoZXNlIHByb3BzLiBNb3JlIGluZm86ICcgKyAnaHR0cHM6Ly9yZWFjdGpzLm9yZy9saW5rL2NvbnRyb2xsZWQtY29tcG9uZW50cycsIGdldEN1cnJlbnRGaWJlck93bmVyTmFtZUluRGV2T3JOdWxsKCkgfHwgJ0EgY29tcG9uZW50JywgcHJvcHMudHlwZSk7CgogICAgICAgIGRpZFdhcm5WYWx1ZURlZmF1bHRWYWx1ZSA9IHRydWU7CiAgICAgIH0KICAgIH0KCiAgICB2YXIgbm9kZSA9IGVsZW1lbnQ7CiAgICB2YXIgZGVmYXVsdFZhbHVlID0gcHJvcHMuZGVmYXVsdFZhbHVlID09IG51bGwgPyAnJyA6IHByb3BzLmRlZmF1bHRWYWx1ZTsKICAgIG5vZGUuX3dyYXBwZXJTdGF0ZSA9IHsKICAgICAgaW5pdGlhbENoZWNrZWQ6IHByb3BzLmNoZWNrZWQgIT0gbnVsbCA/IHByb3BzLmNoZWNrZWQgOiBwcm9wcy5kZWZhdWx0Q2hlY2tlZCwKICAgICAgaW5pdGlhbFZhbHVlOiBnZXRUb1N0cmluZ1ZhbHVlKHByb3BzLnZhbHVlICE9IG51bGwgPyBwcm9wcy52YWx1ZSA6IGRlZmF1bHRWYWx1ZSksCiAgICAgIGNvbnRyb2xsZWQ6IGlzQ29udHJvbGxlZChwcm9wcykKICAgIH07CiAgfQogIGZ1bmN0aW9uIHVwZGF0ZUNoZWNrZWQoZWxlbWVudCwgcHJvcHMpIHsKICAgIHZhciBub2RlID0gZWxlbWVudDsKICAgIHZhciBjaGVja2VkID0gcHJvcHMuY2hlY2tlZDsKCiAgICBpZiAoY2hlY2tlZCAhPSBudWxsKSB7CiAgICAgIHNldFZhbHVlRm9yUHJvcGVydHkobm9kZSwgJ2NoZWNrZWQnLCBjaGVja2VkLCBmYWxzZSk7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHVwZGF0ZVdyYXBwZXIoZWxlbWVudCwgcHJvcHMpIHsKICAgIHZhciBub2RlID0gZWxlbWVudDsKCiAgICB7CiAgICAgIHZhciBjb250cm9sbGVkID0gaXNDb250cm9sbGVkKHByb3BzKTsKCiAgICAgIGlmICghbm9kZS5fd3JhcHBlclN0YXRlLmNvbnRyb2xsZWQgJiYgY29udHJvbGxlZCAmJiAhZGlkV2FyblVuY29udHJvbGxlZFRvQ29udHJvbGxlZCkgewogICAgICAgIGVycm9yKCdBIGNvbXBvbmVudCBpcyBjaGFuZ2luZyBhbiB1bmNvbnRyb2xsZWQgaW5wdXQgdG8gYmUgY29udHJvbGxlZC4gJyArICdUaGlzIGlzIGxpa2VseSBjYXVzZWQgYnkgdGhlIHZhbHVlIGNoYW5naW5nIGZyb20gdW5kZWZpbmVkIHRvICcgKyAnYSBkZWZpbmVkIHZhbHVlLCB3aGljaCBzaG91bGQgbm90IGhhcHBlbi4gJyArICdEZWNpZGUgYmV0d2VlbiB1c2luZyBhIGNvbnRyb2xsZWQgb3IgdW5jb250cm9sbGVkIGlucHV0ICcgKyAnZWxlbWVudCBmb3IgdGhlIGxpZmV0aW1lIG9mIHRoZSBjb21wb25lbnQuIE1vcmUgaW5mbzogaHR0cHM6Ly9yZWFjdGpzLm9yZy9saW5rL2NvbnRyb2xsZWQtY29tcG9uZW50cycpOwoKICAgICAgICBkaWRXYXJuVW5jb250cm9sbGVkVG9Db250cm9sbGVkID0gdHJ1ZTsKICAgICAgfQoKICAgICAgaWYgKG5vZGUuX3dyYXBwZXJTdGF0ZS5jb250cm9sbGVkICYmICFjb250cm9sbGVkICYmICFkaWRXYXJuQ29udHJvbGxlZFRvVW5jb250cm9sbGVkKSB7CiAgICAgICAgZXJyb3IoJ0EgY29tcG9uZW50IGlzIGNoYW5naW5nIGEgY29udHJvbGxlZCBpbnB1dCB0byBiZSB1bmNvbnRyb2xsZWQuICcgKyAnVGhpcyBpcyBsaWtlbHkgY2F1c2VkIGJ5IHRoZSB2YWx1ZSBjaGFuZ2luZyBmcm9tIGEgZGVmaW5lZCB0byAnICsgJ3VuZGVmaW5lZCwgd2hpY2ggc2hvdWxkIG5vdCBoYXBwZW4uICcgKyAnRGVjaWRlIGJldHdlZW4gdXNpbmcgYSBjb250cm9sbGVkIG9yIHVuY29udHJvbGxlZCBpbnB1dCAnICsgJ2VsZW1lbnQgZm9yIHRoZSBsaWZldGltZSBvZiB0aGUgY29tcG9uZW50LiBNb3JlIGluZm86IGh0dHBzOi8vcmVhY3Rqcy5vcmcvbGluay9jb250cm9sbGVkLWNvbXBvbmVudHMnKTsKCiAgICAgICAgZGlkV2FybkNvbnRyb2xsZWRUb1VuY29udHJvbGxlZCA9IHRydWU7CiAgICAgIH0KICAgIH0KCiAgICB1cGRhdGVDaGVja2VkKGVsZW1lbnQsIHByb3BzKTsKICAgIHZhciB2YWx1ZSA9IGdldFRvU3RyaW5nVmFsdWUocHJvcHMudmFsdWUpOwogICAgdmFyIHR5cGUgPSBwcm9wcy50eXBlOwoKICAgIGlmICh2YWx1ZSAhPSBudWxsKSB7CiAgICAgIGlmICh0eXBlID09PSAnbnVtYmVyJykgewogICAgICAgIGlmICh2YWx1ZSA9PT0gMCAmJiBub2RlLnZhbHVlID09PSAnJyB8fCAvLyBXZSBleHBsaWNpdGx5IHdhbnQgdG8gY29lcmNlIHRvIG51bWJlciBoZXJlIGlmIHBvc3NpYmxlLgogICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZQogICAgICAgIG5vZGUudmFsdWUgIT0gdmFsdWUpIHsKICAgICAgICAgIG5vZGUudmFsdWUgPSB0b1N0cmluZyh2YWx1ZSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKG5vZGUudmFsdWUgIT09IHRvU3RyaW5nKHZhbHVlKSkgewogICAgICAgIG5vZGUudmFsdWUgPSB0b1N0cmluZyh2YWx1ZSk7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ3N1Ym1pdCcgfHwgdHlwZSA9PT0gJ3Jlc2V0JykgewogICAgICAvLyBTdWJtaXQvcmVzZXQgaW5wdXRzIG5lZWQgdGhlIGF0dHJpYnV0ZSByZW1vdmVkIGNvbXBsZXRlbHkgdG8gYXZvaWQKICAgICAgLy8gYmxhbmstdGV4dCBidXR0b25zLgogICAgICBub2RlLnJlbW92ZUF0dHJpYnV0ZSgndmFsdWUnKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHsKICAgICAgLy8gV2hlbiBzeW5jaW5nIHRoZSB2YWx1ZSBhdHRyaWJ1dGUsIHRoZSB2YWx1ZSBjb21lcyBmcm9tIGEgY2FzY2FkZSBvZgogICAgICAvLyBwcm9wZXJ0aWVzOgogICAgICAvLyAgMS4gVGhlIHZhbHVlIFJlYWN0IHByb3BlcnR5CiAgICAgIC8vICAyLiBUaGUgZGVmYXVsdFZhbHVlIFJlYWN0IHByb3BlcnR5CiAgICAgIC8vICAzLiBPdGhlcndpc2UgdGhlcmUgc2hvdWxkIGJlIG5vIGNoYW5nZQogICAgICBpZiAocHJvcHMuaGFzT3duUHJvcGVydHkoJ3ZhbHVlJykpIHsKICAgICAgICBzZXREZWZhdWx0VmFsdWUobm9kZSwgcHJvcHMudHlwZSwgdmFsdWUpOwogICAgICB9IGVsc2UgaWYgKHByb3BzLmhhc093blByb3BlcnR5KCdkZWZhdWx0VmFsdWUnKSkgewogICAgICAgIHNldERlZmF1bHRWYWx1ZShub2RlLCBwcm9wcy50eXBlLCBnZXRUb1N0cmluZ1ZhbHVlKHByb3BzLmRlZmF1bHRWYWx1ZSkpOwogICAgICB9CiAgICB9CgogICAgewogICAgICAvLyBXaGVuIHN5bmNpbmcgdGhlIGNoZWNrZWQgYXR0cmlidXRlLCBpdCBvbmx5IGNoYW5nZXMgd2hlbiBpdCBuZWVkcwogICAgICAvLyB0byBiZSByZW1vdmVkLCBzdWNoIGFzIHRyYW5zaXRpb25pbmcgZnJvbSBhIGNoZWNrYm94IGludG8gYSB0ZXh0IGlucHV0CiAgICAgIGlmIChwcm9wcy5jaGVja2VkID09IG51bGwgJiYgcHJvcHMuZGVmYXVsdENoZWNrZWQgIT0gbnVsbCkgewogICAgICAgIG5vZGUuZGVmYXVsdENoZWNrZWQgPSAhIXByb3BzLmRlZmF1bHRDaGVja2VkOwogICAgICB9CiAgICB9CiAgfQogIGZ1bmN0aW9uIHBvc3RNb3VudFdyYXBwZXIoZWxlbWVudCwgcHJvcHMsIGlzSHlkcmF0aW5nKSB7CiAgICB2YXIgbm9kZSA9IGVsZW1lbnQ7IC8vIERvIG5vdCBhc3NpZ24gdmFsdWUgaWYgaXQgaXMgYWxyZWFkeSBzZXQuIFRoaXMgcHJldmVudHMgdXNlciB0ZXh0IGlucHV0CiAgICAvLyBmcm9tIGJlaW5nIGxvc3QgZHVyaW5nIFNTUiBoeWRyYXRpb24uCgogICAgaWYgKHByb3BzLmhhc093blByb3BlcnR5KCd2YWx1ZScpIHx8IHByb3BzLmhhc093blByb3BlcnR5KCdkZWZhdWx0VmFsdWUnKSkgewogICAgICB2YXIgdHlwZSA9IHByb3BzLnR5cGU7CiAgICAgIHZhciBpc0J1dHRvbiA9IHR5cGUgPT09ICdzdWJtaXQnIHx8IHR5cGUgPT09ICdyZXNldCc7IC8vIEF2b2lkIHNldHRpbmcgdmFsdWUgYXR0cmlidXRlIG9uIHN1Ym1pdC9yZXNldCBpbnB1dHMgYXMgaXQgb3ZlcnJpZGVzIHRoZQogICAgICAvLyBkZWZhdWx0IHZhbHVlIHByb3ZpZGVkIGJ5IHRoZSBicm93c2VyLiBTZWU6ICMxMjg3MgoKICAgICAgaWYgKGlzQnV0dG9uICYmIChwcm9wcy52YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHByb3BzLnZhbHVlID09PSBudWxsKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGluaXRpYWxWYWx1ZSA9IHRvU3RyaW5nKG5vZGUuX3dyYXBwZXJTdGF0ZS5pbml0aWFsVmFsdWUpOyAvLyBEbyBub3QgYXNzaWduIHZhbHVlIGlmIGl0IGlzIGFscmVhZHkgc2V0LiBUaGlzIHByZXZlbnRzIHVzZXIgdGV4dCBpbnB1dAogICAgICAvLyBmcm9tIGJlaW5nIGxvc3QgZHVyaW5nIFNTUiBoeWRyYXRpb24uCgogICAgICBpZiAoIWlzSHlkcmF0aW5nKSB7CiAgICAgICAgewogICAgICAgICAgLy8gV2hlbiBzeW5jaW5nIHRoZSB2YWx1ZSBhdHRyaWJ1dGUsIHRoZSB2YWx1ZSBwcm9wZXJ0eSBzaG91bGQgdXNlCiAgICAgICAgICAvLyB0aGUgd3JhcHBlclN0YXRlLl9pbml0aWFsVmFsdWUgcHJvcGVydHkuIFRoaXMgdXNlczoKICAgICAgICAgIC8vCiAgICAgICAgICAvLyAgIDEuIFRoZSB2YWx1ZSBSZWFjdCBwcm9wZXJ0eSB3aGVuIHByZXNlbnQKICAgICAgICAgIC8vICAgMi4gVGhlIGRlZmF1bHRWYWx1ZSBSZWFjdCBwcm9wZXJ0eSB3aGVuIHByZXNlbnQKICAgICAgICAgIC8vICAgMy4gQW4gZW1wdHkgc3RyaW5nCiAgICAgICAgICBpZiAoaW5pdGlhbFZhbHVlICE9PSBub2RlLnZhbHVlKSB7CiAgICAgICAgICAgIG5vZGUudmFsdWUgPSBpbml0aWFsVmFsdWU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICB7CiAgICAgICAgLy8gT3RoZXJ3aXNlLCB0aGUgdmFsdWUgYXR0cmlidXRlIGlzIHN5bmNocm9uaXplZCB0byB0aGUgcHJvcGVydHksCiAgICAgICAgLy8gc28gd2UgYXNzaWduIGRlZmF1bHRWYWx1ZSB0byB0aGUgc2FtZSB0aGluZyBhcyB0aGUgdmFsdWUgcHJvcGVydHkKICAgICAgICAvLyBhc3NpZ25tZW50IHN0ZXAgYWJvdmUuCiAgICAgICAgbm9kZS5kZWZhdWx0VmFsdWUgPSBpbml0aWFsVmFsdWU7CiAgICAgIH0KICAgIH0gLy8gTm9ybWFsbHksIHdlJ2QganVzdCBkbyBgbm9kZS5jaGVja2VkID0gbm9kZS5jaGVja2VkYCB1cG9uIGluaXRpYWwgbW91bnQsIGxlc3MgdGhpcyBidWcKICAgIC8vIHRoaXMgaXMgbmVlZGVkIHRvIHdvcmsgYXJvdW5kIGEgY2hyb21lIGJ1ZyB3aGVyZSBzZXR0aW5nIGRlZmF1bHRDaGVja2VkCiAgICAvLyB3aWxsIHNvbWV0aW1lcyBpbmZsdWVuY2UgdGhlIHZhbHVlIG9mIGNoZWNrZWQgKGV2ZW4gYWZ0ZXIgZGV0YWNobWVudCkuCiAgICAvLyBSZWZlcmVuY2U6IGh0dHBzOi8vYnVncy5jaHJvbWl1bS5vcmcvcC9jaHJvbWl1bS9pc3N1ZXMvZGV0YWlsP2lkPTYwODQxNgogICAgLy8gV2UgbmVlZCB0byB0ZW1wb3JhcmlseSB1bnNldCBuYW1lIHRvIGF2b2lkIGRpc3J1cHRpbmcgcmFkaW8gYnV0dG9uIGdyb3Vwcy4KCgogICAgdmFyIG5hbWUgPSBub2RlLm5hbWU7CgogICAgaWYgKG5hbWUgIT09ICcnKSB7CiAgICAgIG5vZGUubmFtZSA9ICcnOwogICAgfQoKICAgIHsKICAgICAgLy8gV2hlbiBzeW5jaW5nIHRoZSBjaGVja2VkIGF0dHJpYnV0ZSwgYm90aCB0aGUgY2hlY2tlZCBwcm9wZXJ0eSBhbmQKICAgICAgLy8gYXR0cmlidXRlIGFyZSBhc3NpZ25lZCBhdCB0aGUgc2FtZSB0aW1lIHVzaW5nIGRlZmF1bHRDaGVja2VkLiBUaGlzIHVzZXM6CiAgICAgIC8vCiAgICAgIC8vICAgMS4gVGhlIGNoZWNrZWQgUmVhY3QgcHJvcGVydHkgd2hlbiBwcmVzZW50CiAgICAgIC8vICAgMi4gVGhlIGRlZmF1bHRDaGVja2VkIFJlYWN0IHByb3BlcnR5IHdoZW4gcHJlc2VudAogICAgICAvLyAgIDMuIE90aGVyd2lzZSwgZmFsc2UKICAgICAgbm9kZS5kZWZhdWx0Q2hlY2tlZCA9ICFub2RlLmRlZmF1bHRDaGVja2VkOwogICAgICBub2RlLmRlZmF1bHRDaGVja2VkID0gISFub2RlLl93cmFwcGVyU3RhdGUuaW5pdGlhbENoZWNrZWQ7CiAgICB9CgogICAgaWYgKG5hbWUgIT09ICcnKSB7CiAgICAgIG5vZGUubmFtZSA9IG5hbWU7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHJlc3RvcmVDb250cm9sbGVkU3RhdGUoZWxlbWVudCwgcHJvcHMpIHsKICAgIHZhciBub2RlID0gZWxlbWVudDsKICAgIHVwZGF0ZVdyYXBwZXIobm9kZSwgcHJvcHMpOwogICAgdXBkYXRlTmFtZWRDb3VzaW5zKG5vZGUsIHByb3BzKTsKICB9CgogIGZ1bmN0aW9uIHVwZGF0ZU5hbWVkQ291c2lucyhyb290Tm9kZSwgcHJvcHMpIHsKICAgIHZhciBuYW1lID0gcHJvcHMubmFtZTsKCiAgICBpZiAocHJvcHMudHlwZSA9PT0gJ3JhZGlvJyAmJiBuYW1lICE9IG51bGwpIHsKICAgICAgdmFyIHF1ZXJ5Um9vdCA9IHJvb3ROb2RlOwoKICAgICAgd2hpbGUgKHF1ZXJ5Um9vdC5wYXJlbnROb2RlKSB7CiAgICAgICAgcXVlcnlSb290ID0gcXVlcnlSb290LnBhcmVudE5vZGU7CiAgICAgIH0gLy8gSWYgYHJvb3ROb2RlLmZvcm1gIHdhcyBub24tbnVsbCwgdGhlbiB3ZSBjb3VsZCB0cnkgYGZvcm0uZWxlbWVudHNgLAogICAgICAvLyBidXQgdGhhdCBzb21ldGltZXMgYmVoYXZlcyBzdHJhbmdlbHkgaW4gSUU4LiBXZSBjb3VsZCBhbHNvIHRyeSB1c2luZwogICAgICAvLyBgZm9ybS5nZXRFbGVtZW50c0J5TmFtZWAsIGJ1dCB0aGF0IHdpbGwgb25seSByZXR1cm4gZGlyZWN0IGNoaWxkcmVuCiAgICAgIC8vIGFuZCB3b24ndCBpbmNsdWRlIGlucHV0cyB0aGF0IHVzZSB0aGUgSFRNTDUgYGZvcm09YCBhdHRyaWJ1dGUuIFNpbmNlCiAgICAgIC8vIHRoZSBpbnB1dCBtaWdodCBub3QgZXZlbiBiZSBpbiBhIGZvcm0uIEl0IG1pZ2h0IG5vdCBldmVuIGJlIGluIHRoZQogICAgICAvLyBkb2N1bWVudC4gTGV0J3MganVzdCB1c2UgdGhlIGxvY2FsIGBxdWVyeVNlbGVjdG9yQWxsYCB0byBlbnN1cmUgd2UgZG9uJ3QKICAgICAgLy8gbWlzcyBhbnl0aGluZy4KCgogICAgICB7CiAgICAgICAgY2hlY2tBdHRyaWJ1dGVTdHJpbmdDb2VyY2lvbihuYW1lLCAnbmFtZScpOwogICAgICB9CgogICAgICB2YXIgZ3JvdXAgPSBxdWVyeVJvb3QucXVlcnlTZWxlY3RvckFsbCgnaW5wdXRbbmFtZT0nICsgSlNPTi5zdHJpbmdpZnkoJycgKyBuYW1lKSArICddW3R5cGU9InJhZGlvIl0nKTsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZ3JvdXAubGVuZ3RoOyBpKyspIHsKICAgICAgICB2YXIgb3RoZXJOb2RlID0gZ3JvdXBbaV07CgogICAgICAgIGlmIChvdGhlck5vZGUgPT09IHJvb3ROb2RlIHx8IG90aGVyTm9kZS5mb3JtICE9PSByb290Tm9kZS5mb3JtKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9IC8vIFRoaXMgd2lsbCB0aHJvdyBpZiByYWRpbyBidXR0b25zIHJlbmRlcmVkIGJ5IGRpZmZlcmVudCBjb3BpZXMgb2YgUmVhY3QKICAgICAgICAvLyBhbmQgdGhlIHNhbWUgbmFtZSBhcmUgcmVuZGVyZWQgaW50byB0aGUgc2FtZSBmb3JtIChzYW1lIGFzICMxOTM5KS4KICAgICAgICAvLyBUaGF0J3MgcHJvYmFibHkgb2theTsgd2UgZG9uJ3Qgc3VwcG9ydCBpdCBqdXN0IGFzIHdlIGRvbid0IHN1cHBvcnQKICAgICAgICAvLyBtaXhpbmcgUmVhY3QgcmFkaW8gYnV0dG9ucyB3aXRoIG5vbi1SZWFjdCBvbmVzLgoKCiAgICAgICAgdmFyIG90aGVyUHJvcHMgPSBnZXRGaWJlckN1cnJlbnRQcm9wc0Zyb21Ob2RlKG90aGVyTm9kZSk7CgogICAgICAgIGlmICghb3RoZXJQcm9wcykgewogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZWFjdERPTUlucHV0OiBNaXhpbmcgUmVhY3QgYW5kIG5vbi1SZWFjdCByYWRpbyBpbnB1dHMgd2l0aCB0aGUgJyArICdzYW1lIGBuYW1lYCBpcyBub3Qgc3VwcG9ydGVkLicpOwogICAgICAgIH0gLy8gV2UgbmVlZCB1cGRhdGUgdGhlIHRyYWNrZWQgdmFsdWUgb24gdGhlIG5hbWVkIGNvdXNpbiBzaW5jZSB0aGUgdmFsdWUKICAgICAgICAvLyB3YXMgY2hhbmdlZCBidXQgdGhlIGlucHV0IHNhdyBubyBldmVudCBvciB2YWx1ZSBzZXQKCgogICAgICAgIHVwZGF0ZVZhbHVlSWZDaGFuZ2VkKG90aGVyTm9kZSk7IC8vIElmIHRoaXMgaXMgYSBjb250cm9sbGVkIHJhZGlvIGJ1dHRvbiBncm91cCwgZm9yY2luZyB0aGUgaW5wdXQgdGhhdAogICAgICAgIC8vIHdhcyBwcmV2aW91c2x5IGNoZWNrZWQgdG8gdXBkYXRlIHdpbGwgY2F1c2UgaXQgdG8gYmUgY29tZSByZS1jaGVja2VkCiAgICAgICAgLy8gYXMgYXBwcm9wcmlhdGUuCgogICAgICAgIHVwZGF0ZVdyYXBwZXIob3RoZXJOb2RlLCBvdGhlclByb3BzKTsKICAgICAgfQogICAgfQogIH0gLy8gSW4gQ2hyb21lLCBhc3NpZ25pbmcgZGVmYXVsdFZhbHVlIHRvIGNlcnRhaW4gaW5wdXQgdHlwZXMgdHJpZ2dlcnMgaW5wdXQgdmFsaWRhdGlvbi4KICAvLyBGb3IgbnVtYmVyIGlucHV0cywgdGhlIGRpc3BsYXkgdmFsdWUgbG9zZXMgdHJhaWxpbmcgZGVjaW1hbCBwb2ludHMuIEZvciBlbWFpbCBpbnB1dHMsCiAgLy8gQ2hyb21lIHJhaXNlcyAiVGhlIHNwZWNpZmllZCB2YWx1ZSA8eD4gaXMgbm90IGEgdmFsaWQgZW1haWwgYWRkcmVzcyIuCiAgLy8KICAvLyBIZXJlIHdlIGNoZWNrIHRvIHNlZSBpZiB0aGUgZGVmYXVsdFZhbHVlIGhhcyBhY3R1YWxseSBjaGFuZ2VkLCBhdm9pZGluZyB0aGVzZSBwcm9ibGVtcwogIC8vIHdoZW4gdGhlIHVzZXIgaXMgaW5wdXR0aW5nIHRleHQKICAvLwogIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9mYWNlYm9vay9yZWFjdC9pc3N1ZXMvNzI1MwoKCiAgZnVuY3Rpb24gc2V0RGVmYXVsdFZhbHVlKG5vZGUsIHR5cGUsIHZhbHVlKSB7CiAgICBpZiAoIC8vIEZvY3VzZWQgbnVtYmVyIGlucHV0cyBzeW5jaHJvbml6ZSBvbiBibHVyLiBTZWUgQ2hhbmdlRXZlbnRQbHVnaW4uanMKICAgIHR5cGUgIT09ICdudW1iZXInIHx8IGdldEFjdGl2ZUVsZW1lbnQobm9kZS5vd25lckRvY3VtZW50KSAhPT0gbm9kZSkgewogICAgICBpZiAodmFsdWUgPT0gbnVsbCkgewogICAgICAgIG5vZGUuZGVmYXVsdFZhbHVlID0gdG9TdHJpbmcobm9kZS5fd3JhcHBlclN0YXRlLmluaXRpYWxWYWx1ZSk7CiAgICAgIH0gZWxzZSBpZiAobm9kZS5kZWZhdWx0VmFsdWUgIT09IHRvU3RyaW5nKHZhbHVlKSkgewogICAgICAgIG5vZGUuZGVmYXVsdFZhbHVlID0gdG9TdHJpbmcodmFsdWUpOwogICAgICB9CiAgICB9CiAgfQoKICB2YXIgZGlkV2FyblNlbGVjdGVkU2V0T25PcHRpb24gPSBmYWxzZTsKICB2YXIgZGlkV2FybkludmFsaWRDaGlsZCA9IGZhbHNlOwogIHZhciBkaWRXYXJuSW52YWxpZElubmVySFRNTCA9IGZhbHNlOwogIC8qKgogICAqIEltcGxlbWVudHMgYW4gPG9wdGlvbj4gaG9zdCBjb21wb25lbnQgdGhhdCB3YXJucyB3aGVuIGBzZWxlY3RlZGAgaXMgc2V0LgogICAqLwoKICBmdW5jdGlvbiB2YWxpZGF0ZVByb3BzKGVsZW1lbnQsIHByb3BzKSB7CiAgICB7CiAgICAgIC8vIElmIGEgdmFsdWUgaXMgbm90IHByb3ZpZGVkLCB0aGVuIHRoZSBjaGlsZHJlbiBtdXN0IGJlIHNpbXBsZS4KICAgICAgaWYgKHByb3BzLnZhbHVlID09IG51bGwpIHsKICAgICAgICBpZiAodHlwZW9mIHByb3BzLmNoaWxkcmVuID09PSAnb2JqZWN0JyAmJiBwcm9wcy5jaGlsZHJlbiAhPT0gbnVsbCkgewogICAgICAgICAgUmVhY3QuQ2hpbGRyZW4uZm9yRWFjaChwcm9wcy5jaGlsZHJlbiwgZnVuY3Rpb24gKGNoaWxkKSB7CiAgICAgICAgICAgIGlmIChjaGlsZCA9PSBudWxsKSB7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAodHlwZW9mIGNoaWxkID09PSAnc3RyaW5nJyB8fCB0eXBlb2YgY2hpbGQgPT09ICdudW1iZXInKSB7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoIWRpZFdhcm5JbnZhbGlkQ2hpbGQpIHsKICAgICAgICAgICAgICBkaWRXYXJuSW52YWxpZENoaWxkID0gdHJ1ZTsKCiAgICAgICAgICAgICAgZXJyb3IoJ0Nhbm5vdCBpbmZlciB0aGUgb3B0aW9uIHZhbHVlIG9mIGNvbXBsZXggY2hpbGRyZW4uICcgKyAnUGFzcyBhIGB2YWx1ZWAgcHJvcCBvciB1c2UgYSBwbGFpbiBzdHJpbmcgYXMgY2hpbGRyZW4gdG8gPG9wdGlvbj4uJyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSBpZiAocHJvcHMuZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUwgIT0gbnVsbCkgewogICAgICAgICAgaWYgKCFkaWRXYXJuSW52YWxpZElubmVySFRNTCkgewogICAgICAgICAgICBkaWRXYXJuSW52YWxpZElubmVySFRNTCA9IHRydWU7CgogICAgICAgICAgICBlcnJvcignUGFzcyBhIGB2YWx1ZWAgcHJvcCBpZiB5b3Ugc2V0IGRhbmdlcm91c2x5SW5uZXJIVE1MIHNvIFJlYWN0IGtub3dzICcgKyAnd2hpY2ggdmFsdWUgc2hvdWxkIGJlIHNlbGVjdGVkLicpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSAvLyBUT0RPOiBSZW1vdmUgc3VwcG9ydCBmb3IgYHNlbGVjdGVkYCBpbiA8b3B0aW9uPi4KCgogICAgICBpZiAocHJvcHMuc2VsZWN0ZWQgIT0gbnVsbCAmJiAhZGlkV2FyblNlbGVjdGVkU2V0T25PcHRpb24pIHsKICAgICAgICBlcnJvcignVXNlIHRoZSBgZGVmYXVsdFZhbHVlYCBvciBgdmFsdWVgIHByb3BzIG9uIDxzZWxlY3Q+IGluc3RlYWQgb2YgJyArICdzZXR0aW5nIGBzZWxlY3RlZGAgb24gPG9wdGlvbj4uJyk7CgogICAgICAgIGRpZFdhcm5TZWxlY3RlZFNldE9uT3B0aW9uID0gdHJ1ZTsKICAgICAgfQogICAgfQogIH0KICBmdW5jdGlvbiBwb3N0TW91bnRXcmFwcGVyJDEoZWxlbWVudCwgcHJvcHMpIHsKICAgIC8vIHZhbHVlPSIiIHNob3VsZCBtYWtlIGEgdmFsdWUgYXR0cmlidXRlICgjNjIxOSkKICAgIGlmIChwcm9wcy52YWx1ZSAhPSBudWxsKSB7CiAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCd2YWx1ZScsIHRvU3RyaW5nKGdldFRvU3RyaW5nVmFsdWUocHJvcHMudmFsdWUpKSk7CiAgICB9CiAgfQoKICB2YXIgaXNBcnJheUltcGwgPSBBcnJheS5pc0FycmF5OyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcmVkZWNsYXJlCgogIGZ1bmN0aW9uIGlzQXJyYXkoYSkgewogICAgcmV0dXJuIGlzQXJyYXlJbXBsKGEpOwogIH0KCiAgdmFyIGRpZFdhcm5WYWx1ZURlZmF1bHRWYWx1ZSQxOwoKICB7CiAgICBkaWRXYXJuVmFsdWVEZWZhdWx0VmFsdWUkMSA9IGZhbHNlOwogIH0KCiAgZnVuY3Rpb24gZ2V0RGVjbGFyYXRpb25FcnJvckFkZGVuZHVtKCkgewogICAgdmFyIG93bmVyTmFtZSA9IGdldEN1cnJlbnRGaWJlck93bmVyTmFtZUluRGV2T3JOdWxsKCk7CgogICAgaWYgKG93bmVyTmFtZSkgewogICAgICByZXR1cm4gJ1xuXG5DaGVjayB0aGUgcmVuZGVyIG1ldGhvZCBvZiBgJyArIG93bmVyTmFtZSArICdgLic7CiAgICB9CgogICAgcmV0dXJuICcnOwogIH0KCiAgdmFyIHZhbHVlUHJvcE5hbWVzID0gWyd2YWx1ZScsICdkZWZhdWx0VmFsdWUnXTsKICAvKioKICAgKiBWYWxpZGF0aW9uIGZ1bmN0aW9uIGZvciBgdmFsdWVgIGFuZCBgZGVmYXVsdFZhbHVlYC4KICAgKi8KCiAgZnVuY3Rpb24gY2hlY2tTZWxlY3RQcm9wVHlwZXMocHJvcHMpIHsKICAgIHsKICAgICAgY2hlY2tDb250cm9sbGVkVmFsdWVQcm9wcygnc2VsZWN0JywgcHJvcHMpOwoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2YWx1ZVByb3BOYW1lcy5sZW5ndGg7IGkrKykgewogICAgICAgIHZhciBwcm9wTmFtZSA9IHZhbHVlUHJvcE5hbWVzW2ldOwoKICAgICAgICBpZiAocHJvcHNbcHJvcE5hbWVdID09IG51bGwpIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgdmFyIHByb3BOYW1lSXNBcnJheSA9IGlzQXJyYXkocHJvcHNbcHJvcE5hbWVdKTsKCiAgICAgICAgaWYgKHByb3BzLm11bHRpcGxlICYmICFwcm9wTmFtZUlzQXJyYXkpIHsKICAgICAgICAgIGVycm9yKCdUaGUgYCVzYCBwcm9wIHN1cHBsaWVkIHRvIDxzZWxlY3Q+IG11c3QgYmUgYW4gYXJyYXkgaWYgJyArICdgbXVsdGlwbGVgIGlzIHRydWUuJXMnLCBwcm9wTmFtZSwgZ2V0RGVjbGFyYXRpb25FcnJvckFkZGVuZHVtKCkpOwogICAgICAgIH0gZWxzZSBpZiAoIXByb3BzLm11bHRpcGxlICYmIHByb3BOYW1lSXNBcnJheSkgewogICAgICAgICAgZXJyb3IoJ1RoZSBgJXNgIHByb3Agc3VwcGxpZWQgdG8gPHNlbGVjdD4gbXVzdCBiZSBhIHNjYWxhciAnICsgJ3ZhbHVlIGlmIGBtdWx0aXBsZWAgaXMgZmFsc2UuJXMnLCBwcm9wTmFtZSwgZ2V0RGVjbGFyYXRpb25FcnJvckFkZGVuZHVtKCkpOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gdXBkYXRlT3B0aW9ucyhub2RlLCBtdWx0aXBsZSwgcHJvcFZhbHVlLCBzZXREZWZhdWx0U2VsZWN0ZWQpIHsKICAgIHZhciBvcHRpb25zID0gbm9kZS5vcHRpb25zOwoKICAgIGlmIChtdWx0aXBsZSkgewogICAgICB2YXIgc2VsZWN0ZWRWYWx1ZXMgPSBwcm9wVmFsdWU7CiAgICAgIHZhciBzZWxlY3RlZFZhbHVlID0ge307CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGVjdGVkVmFsdWVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgLy8gUHJlZml4IHRvIGF2b2lkIGNoYW9zIHdpdGggc3BlY2lhbCBrZXlzLgogICAgICAgIHNlbGVjdGVkVmFsdWVbJyQnICsgc2VsZWN0ZWRWYWx1ZXNbaV1dID0gdHJ1ZTsKICAgICAgfQoKICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IG9wdGlvbnMubGVuZ3RoOyBfaSsrKSB7CiAgICAgICAgdmFyIHNlbGVjdGVkID0gc2VsZWN0ZWRWYWx1ZS5oYXNPd25Qcm9wZXJ0eSgnJCcgKyBvcHRpb25zW19pXS52YWx1ZSk7CgogICAgICAgIGlmIChvcHRpb25zW19pXS5zZWxlY3RlZCAhPT0gc2VsZWN0ZWQpIHsKICAgICAgICAgIG9wdGlvbnNbX2ldLnNlbGVjdGVkID0gc2VsZWN0ZWQ7CiAgICAgICAgfQoKICAgICAgICBpZiAoc2VsZWN0ZWQgJiYgc2V0RGVmYXVsdFNlbGVjdGVkKSB7CiAgICAgICAgICBvcHRpb25zW19pXS5kZWZhdWx0U2VsZWN0ZWQgPSB0cnVlOwogICAgICAgIH0KICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgLy8gRG8gbm90IHNldCBgc2VsZWN0LnZhbHVlYCBhcyBleGFjdCBiZWhhdmlvciBpc24ndCBjb25zaXN0ZW50IGFjcm9zcyBhbGwKICAgICAgLy8gYnJvd3NlcnMgZm9yIGFsbCBjYXNlcy4KICAgICAgdmFyIF9zZWxlY3RlZFZhbHVlID0gdG9TdHJpbmcoZ2V0VG9TdHJpbmdWYWx1ZShwcm9wVmFsdWUpKTsKCiAgICAgIHZhciBkZWZhdWx0U2VsZWN0ZWQgPSBudWxsOwoKICAgICAgZm9yICh2YXIgX2kyID0gMDsgX2kyIDwgb3B0aW9ucy5sZW5ndGg7IF9pMisrKSB7CiAgICAgICAgaWYgKG9wdGlvbnNbX2kyXS52YWx1ZSA9PT0gX3NlbGVjdGVkVmFsdWUpIHsKICAgICAgICAgIG9wdGlvbnNbX2kyXS5zZWxlY3RlZCA9IHRydWU7CgogICAgICAgICAgaWYgKHNldERlZmF1bHRTZWxlY3RlZCkgewogICAgICAgICAgICBvcHRpb25zW19pMl0uZGVmYXVsdFNlbGVjdGVkID0gdHJ1ZTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAoZGVmYXVsdFNlbGVjdGVkID09PSBudWxsICYmICFvcHRpb25zW19pMl0uZGlzYWJsZWQpIHsKICAgICAgICAgIGRlZmF1bHRTZWxlY3RlZCA9IG9wdGlvbnNbX2kyXTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChkZWZhdWx0U2VsZWN0ZWQgIT09IG51bGwpIHsKICAgICAgICBkZWZhdWx0U2VsZWN0ZWQuc2VsZWN0ZWQgPSB0cnVlOwogICAgICB9CiAgICB9CiAgfQogIC8qKgogICAqIEltcGxlbWVudHMgYSA8c2VsZWN0PiBob3N0IGNvbXBvbmVudCB0aGF0IGFsbG93cyBvcHRpb25hbGx5IHNldHRpbmcgdGhlCiAgICogcHJvcHMgYHZhbHVlYCBhbmQgYGRlZmF1bHRWYWx1ZWAuIElmIGBtdWx0aXBsZWAgaXMgZmFsc2UsIHRoZSBwcm9wIG11c3QgYmUgYQogICAqIHN0cmluZ2FibGUuIElmIGBtdWx0aXBsZWAgaXMgdHJ1ZSwgdGhlIHByb3AgbXVzdCBiZSBhbiBhcnJheSBvZiBzdHJpbmdhYmxlcy4KICAgKgogICAqIElmIGB2YWx1ZWAgaXMgbm90IHN1cHBsaWVkIChvciBudWxsL3VuZGVmaW5lZCksIHVzZXIgYWN0aW9ucyB0aGF0IGNoYW5nZSB0aGUKICAgKiBzZWxlY3RlZCBvcHRpb24gd2lsbCB0cmlnZ2VyIHVwZGF0ZXMgdG8gdGhlIHJlbmRlcmVkIG9wdGlvbnMuCiAgICoKICAgKiBJZiBpdCBpcyBzdXBwbGllZCAoYW5kIG5vdCBudWxsL3VuZGVmaW5lZCksIHRoZSByZW5kZXJlZCBvcHRpb25zIHdpbGwgbm90CiAgICogdXBkYXRlIGluIHJlc3BvbnNlIHRvIHVzZXIgYWN0aW9ucy4gSW5zdGVhZCwgdGhlIGB2YWx1ZWAgcHJvcCBtdXN0IGNoYW5nZSBpbgogICAqIG9yZGVyIGZvciB0aGUgcmVuZGVyZWQgb3B0aW9ucyB0byB1cGRhdGUuCiAgICoKICAgKiBJZiBgZGVmYXVsdFZhbHVlYCBpcyBwcm92aWRlZCwgYW55IG9wdGlvbnMgd2l0aCB0aGUgc3VwcGxpZWQgdmFsdWVzIHdpbGwgYmUKICAgKiBzZWxlY3RlZC4KICAgKi8KCgogIGZ1bmN0aW9uIGdldEhvc3RQcm9wcyQxKGVsZW1lbnQsIHByb3BzKSB7CiAgICByZXR1cm4gYXNzaWduKHt9LCBwcm9wcywgewogICAgICB2YWx1ZTogdW5kZWZpbmVkCiAgICB9KTsKICB9CiAgZnVuY3Rpb24gaW5pdFdyYXBwZXJTdGF0ZSQxKGVsZW1lbnQsIHByb3BzKSB7CiAgICB2YXIgbm9kZSA9IGVsZW1lbnQ7CgogICAgewogICAgICBjaGVja1NlbGVjdFByb3BUeXBlcyhwcm9wcyk7CiAgICB9CgogICAgbm9kZS5fd3JhcHBlclN0YXRlID0gewogICAgICB3YXNNdWx0aXBsZTogISFwcm9wcy5tdWx0aXBsZQogICAgfTsKCiAgICB7CiAgICAgIGlmIChwcm9wcy52YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHByb3BzLmRlZmF1bHRWYWx1ZSAhPT0gdW5kZWZpbmVkICYmICFkaWRXYXJuVmFsdWVEZWZhdWx0VmFsdWUkMSkgewogICAgICAgIGVycm9yKCdTZWxlY3QgZWxlbWVudHMgbXVzdCBiZSBlaXRoZXIgY29udHJvbGxlZCBvciB1bmNvbnRyb2xsZWQgJyArICcoc3BlY2lmeSBlaXRoZXIgdGhlIHZhbHVlIHByb3AsIG9yIHRoZSBkZWZhdWx0VmFsdWUgcHJvcCwgYnV0IG5vdCAnICsgJ2JvdGgpLiBEZWNpZGUgYmV0d2VlbiB1c2luZyBhIGNvbnRyb2xsZWQgb3IgdW5jb250cm9sbGVkIHNlbGVjdCAnICsgJ2VsZW1lbnQgYW5kIHJlbW92ZSBvbmUgb2YgdGhlc2UgcHJvcHMuIE1vcmUgaW5mbzogJyArICdodHRwczovL3JlYWN0anMub3JnL2xpbmsvY29udHJvbGxlZC1jb21wb25lbnRzJyk7CgogICAgICAgIGRpZFdhcm5WYWx1ZURlZmF1bHRWYWx1ZSQxID0gdHJ1ZTsKICAgICAgfQogICAgfQogIH0KICBmdW5jdGlvbiBwb3N0TW91bnRXcmFwcGVyJDIoZWxlbWVudCwgcHJvcHMpIHsKICAgIHZhciBub2RlID0gZWxlbWVudDsKICAgIG5vZGUubXVsdGlwbGUgPSAhIXByb3BzLm11bHRpcGxlOwogICAgdmFyIHZhbHVlID0gcHJvcHMudmFsdWU7CgogICAgaWYgKHZhbHVlICE9IG51bGwpIHsKICAgICAgdXBkYXRlT3B0aW9ucyhub2RlLCAhIXByb3BzLm11bHRpcGxlLCB2YWx1ZSwgZmFsc2UpOwogICAgfSBlbHNlIGlmIChwcm9wcy5kZWZhdWx0VmFsdWUgIT0gbnVsbCkgewogICAgICB1cGRhdGVPcHRpb25zKG5vZGUsICEhcHJvcHMubXVsdGlwbGUsIHByb3BzLmRlZmF1bHRWYWx1ZSwgdHJ1ZSk7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHBvc3RVcGRhdGVXcmFwcGVyKGVsZW1lbnQsIHByb3BzKSB7CiAgICB2YXIgbm9kZSA9IGVsZW1lbnQ7CiAgICB2YXIgd2FzTXVsdGlwbGUgPSBub2RlLl93cmFwcGVyU3RhdGUud2FzTXVsdGlwbGU7CiAgICBub2RlLl93cmFwcGVyU3RhdGUud2FzTXVsdGlwbGUgPSAhIXByb3BzLm11bHRpcGxlOwogICAgdmFyIHZhbHVlID0gcHJvcHMudmFsdWU7CgogICAgaWYgKHZhbHVlICE9IG51bGwpIHsKICAgICAgdXBkYXRlT3B0aW9ucyhub2RlLCAhIXByb3BzLm11bHRpcGxlLCB2YWx1ZSwgZmFsc2UpOwogICAgfSBlbHNlIGlmICh3YXNNdWx0aXBsZSAhPT0gISFwcm9wcy5tdWx0aXBsZSkgewogICAgICAvLyBGb3Igc2ltcGxpY2l0eSwgcmVhcHBseSBgZGVmYXVsdFZhbHVlYCBpZiBgbXVsdGlwbGVgIGlzIHRvZ2dsZWQuCiAgICAgIGlmIChwcm9wcy5kZWZhdWx0VmFsdWUgIT0gbnVsbCkgewogICAgICAgIHVwZGF0ZU9wdGlvbnMobm9kZSwgISFwcm9wcy5tdWx0aXBsZSwgcHJvcHMuZGVmYXVsdFZhbHVlLCB0cnVlKTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBSZXZlcnQgdGhlIHNlbGVjdCBiYWNrIHRvIGl0cyBkZWZhdWx0IHVuc2VsZWN0ZWQgc3RhdGUuCiAgICAgICAgdXBkYXRlT3B0aW9ucyhub2RlLCAhIXByb3BzLm11bHRpcGxlLCBwcm9wcy5tdWx0aXBsZSA/IFtdIDogJycsIGZhbHNlKTsKICAgICAgfQogICAgfQogIH0KICBmdW5jdGlvbiByZXN0b3JlQ29udHJvbGxlZFN0YXRlJDEoZWxlbWVudCwgcHJvcHMpIHsKICAgIHZhciBub2RlID0gZWxlbWVudDsKICAgIHZhciB2YWx1ZSA9IHByb3BzLnZhbHVlOwoKICAgIGlmICh2YWx1ZSAhPSBudWxsKSB7CiAgICAgIHVwZGF0ZU9wdGlvbnMobm9kZSwgISFwcm9wcy5tdWx0aXBsZSwgdmFsdWUsIGZhbHNlKTsKICAgIH0KICB9CgogIHZhciBkaWRXYXJuVmFsRGVmYXVsdFZhbCA9IGZhbHNlOwoKICAvKioKICAgKiBJbXBsZW1lbnRzIGEgPHRleHRhcmVhPiBob3N0IGNvbXBvbmVudCB0aGF0IGFsbG93cyBzZXR0aW5nIGB2YWx1ZWAsIGFuZAogICAqIGBkZWZhdWx0VmFsdWVgLiBUaGlzIGRpZmZlcnMgZnJvbSB0aGUgdHJhZGl0aW9uYWwgRE9NIEFQSSBiZWNhdXNlIHZhbHVlIGlzCiAgICogdXN1YWxseSBzZXQgYXMgUENEQVRBIGNoaWxkcmVuLgogICAqCiAgICogSWYgYHZhbHVlYCBpcyBub3Qgc3VwcGxpZWQgKG9yIG51bGwvdW5kZWZpbmVkKSwgdXNlciBhY3Rpb25zIHRoYXQgYWZmZWN0IHRoZQogICAqIHZhbHVlIHdpbGwgdHJpZ2dlciB1cGRhdGVzIHRvIHRoZSBlbGVtZW50LgogICAqCiAgICogSWYgYHZhbHVlYCBpcyBzdXBwbGllZCAoYW5kIG5vdCBudWxsL3VuZGVmaW5lZCksIHRoZSByZW5kZXJlZCBlbGVtZW50IHdpbGwKICAgKiBub3QgdHJpZ2dlciB1cGRhdGVzIHRvIHRoZSBlbGVtZW50LiBJbnN0ZWFkLCB0aGUgYHZhbHVlYCBwcm9wIG11c3QgY2hhbmdlIGluCiAgICogb3JkZXIgZm9yIHRoZSByZW5kZXJlZCBlbGVtZW50IHRvIGJlIHVwZGF0ZWQuCiAgICoKICAgKiBUaGUgcmVuZGVyZWQgZWxlbWVudCB3aWxsIGJlIGluaXRpYWxpemVkIHdpdGggYW4gZW1wdHkgdmFsdWUsIHRoZSBwcm9wCiAgICogYGRlZmF1bHRWYWx1ZWAgaWYgc3BlY2lmaWVkLCBvciB0aGUgY2hpbGRyZW4gY29udGVudCAoZGVwcmVjYXRlZCkuCiAgICovCiAgZnVuY3Rpb24gZ2V0SG9zdFByb3BzJDIoZWxlbWVudCwgcHJvcHMpIHsKICAgIHZhciBub2RlID0gZWxlbWVudDsKCiAgICBpZiAocHJvcHMuZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUwgIT0gbnVsbCkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ2BkYW5nZXJvdXNseVNldElubmVySFRNTGAgZG9lcyBub3QgbWFrZSBzZW5zZSBvbiA8dGV4dGFyZWE+LicpOwogICAgfSAvLyBBbHdheXMgc2V0IGNoaWxkcmVuIHRvIHRoZSBzYW1lIHRoaW5nLiBJbiBJRTksIHRoZSBzZWxlY3Rpb24gcmFuZ2Ugd2lsbAogICAgLy8gZ2V0IHJlc2V0IGlmIGB0ZXh0Q29udGVudGAgaXMgbXV0YXRlZC4gIFdlIGNvdWxkIGFkZCBhIGNoZWNrIGluIHNldFRleHRDb250ZW50CiAgICAvLyB0byBvbmx5IHNldCB0aGUgdmFsdWUgaWYvd2hlbiB0aGUgdmFsdWUgZGlmZmVycyBmcm9tIHRoZSBub2RlIHZhbHVlICh3aGljaCB3b3VsZAogICAgLy8gY29tcGxldGVseSBzb2x2ZSB0aGlzIElFOSBidWcpLCBidXQgU2ViYXN0aWFuK1NvcGhpZSBzZWVtZWQgdG8gbGlrZSB0aGlzCiAgICAvLyBzb2x1dGlvbi4gVGhlIHZhbHVlIGNhbiBiZSBhIGJvb2xlYW4gb3Igb2JqZWN0IHNvIHRoYXQncyB3aHkgaXQncyBmb3JjZWQKICAgIC8vIHRvIGJlIGEgc3RyaW5nLgoKCiAgICB2YXIgaG9zdFByb3BzID0gYXNzaWduKHt9LCBwcm9wcywgewogICAgICB2YWx1ZTogdW5kZWZpbmVkLAogICAgICBkZWZhdWx0VmFsdWU6IHVuZGVmaW5lZCwKICAgICAgY2hpbGRyZW46IHRvU3RyaW5nKG5vZGUuX3dyYXBwZXJTdGF0ZS5pbml0aWFsVmFsdWUpCiAgICB9KTsKCiAgICByZXR1cm4gaG9zdFByb3BzOwogIH0KICBmdW5jdGlvbiBpbml0V3JhcHBlclN0YXRlJDIoZWxlbWVudCwgcHJvcHMpIHsKICAgIHZhciBub2RlID0gZWxlbWVudDsKCiAgICB7CiAgICAgIGNoZWNrQ29udHJvbGxlZFZhbHVlUHJvcHMoJ3RleHRhcmVhJywgcHJvcHMpOwoKICAgICAgaWYgKHByb3BzLnZhbHVlICE9PSB1bmRlZmluZWQgJiYgcHJvcHMuZGVmYXVsdFZhbHVlICE9PSB1bmRlZmluZWQgJiYgIWRpZFdhcm5WYWxEZWZhdWx0VmFsKSB7CiAgICAgICAgZXJyb3IoJyVzIGNvbnRhaW5zIGEgdGV4dGFyZWEgd2l0aCBib3RoIHZhbHVlIGFuZCBkZWZhdWx0VmFsdWUgcHJvcHMuICcgKyAnVGV4dGFyZWEgZWxlbWVudHMgbXVzdCBiZSBlaXRoZXIgY29udHJvbGxlZCBvciB1bmNvbnRyb2xsZWQgJyArICcoc3BlY2lmeSBlaXRoZXIgdGhlIHZhbHVlIHByb3AsIG9yIHRoZSBkZWZhdWx0VmFsdWUgcHJvcCwgYnV0IG5vdCAnICsgJ2JvdGgpLiBEZWNpZGUgYmV0d2VlbiB1c2luZyBhIGNvbnRyb2xsZWQgb3IgdW5jb250cm9sbGVkIHRleHRhcmVhICcgKyAnYW5kIHJlbW92ZSBvbmUgb2YgdGhlc2UgcHJvcHMuIE1vcmUgaW5mbzogJyArICdodHRwczovL3JlYWN0anMub3JnL2xpbmsvY29udHJvbGxlZC1jb21wb25lbnRzJywgZ2V0Q3VycmVudEZpYmVyT3duZXJOYW1lSW5EZXZPck51bGwoKSB8fCAnQSBjb21wb25lbnQnKTsKCiAgICAgICAgZGlkV2FyblZhbERlZmF1bHRWYWwgPSB0cnVlOwogICAgICB9CiAgICB9CgogICAgdmFyIGluaXRpYWxWYWx1ZSA9IHByb3BzLnZhbHVlOyAvLyBPbmx5IGJvdGhlciBmZXRjaGluZyBkZWZhdWx0IHZhbHVlIGlmIHdlJ3JlIGdvaW5nIHRvIHVzZSBpdAoKICAgIGlmIChpbml0aWFsVmFsdWUgPT0gbnVsbCkgewogICAgICB2YXIgY2hpbGRyZW4gPSBwcm9wcy5jaGlsZHJlbiwKICAgICAgICAgIGRlZmF1bHRWYWx1ZSA9IHByb3BzLmRlZmF1bHRWYWx1ZTsKCiAgICAgIGlmIChjaGlsZHJlbiAhPSBudWxsKSB7CiAgICAgICAgewogICAgICAgICAgZXJyb3IoJ1VzZSB0aGUgYGRlZmF1bHRWYWx1ZWAgb3IgYHZhbHVlYCBwcm9wcyBpbnN0ZWFkIG9mIHNldHRpbmcgJyArICdjaGlsZHJlbiBvbiA8dGV4dGFyZWE+LicpOwogICAgICAgIH0KCiAgICAgICAgewogICAgICAgICAgaWYgKGRlZmF1bHRWYWx1ZSAhPSBudWxsKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSWYgeW91IHN1cHBseSBgZGVmYXVsdFZhbHVlYCBvbiBhIDx0ZXh0YXJlYT4sIGRvIG5vdCBwYXNzIGNoaWxkcmVuLicpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChpc0FycmF5KGNoaWxkcmVuKSkgewogICAgICAgICAgICBpZiAoY2hpbGRyZW4ubGVuZ3RoID4gMSkgewogICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignPHRleHRhcmVhPiBjYW4gb25seSBoYXZlIGF0IG1vc3Qgb25lIGNoaWxkLicpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjaGlsZHJlbiA9IGNoaWxkcmVuWzBdOwogICAgICAgICAgfQoKICAgICAgICAgIGRlZmF1bHRWYWx1ZSA9IGNoaWxkcmVuOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGRlZmF1bHRWYWx1ZSA9PSBudWxsKSB7CiAgICAgICAgZGVmYXVsdFZhbHVlID0gJyc7CiAgICAgIH0KCiAgICAgIGluaXRpYWxWYWx1ZSA9IGRlZmF1bHRWYWx1ZTsKICAgIH0KCiAgICBub2RlLl93cmFwcGVyU3RhdGUgPSB7CiAgICAgIGluaXRpYWxWYWx1ZTogZ2V0VG9TdHJpbmdWYWx1ZShpbml0aWFsVmFsdWUpCiAgICB9OwogIH0KICBmdW5jdGlvbiB1cGRhdGVXcmFwcGVyJDEoZWxlbWVudCwgcHJvcHMpIHsKICAgIHZhciBub2RlID0gZWxlbWVudDsKICAgIHZhciB2YWx1ZSA9IGdldFRvU3RyaW5nVmFsdWUocHJvcHMudmFsdWUpOwogICAgdmFyIGRlZmF1bHRWYWx1ZSA9IGdldFRvU3RyaW5nVmFsdWUocHJvcHMuZGVmYXVsdFZhbHVlKTsKCiAgICBpZiAodmFsdWUgIT0gbnVsbCkgewogICAgICAvLyBDYXN0IGB2YWx1ZWAgdG8gYSBzdHJpbmcgdG8gZW5zdXJlIHRoZSB2YWx1ZSBpcyBzZXQgY29ycmVjdGx5LiBXaGlsZQogICAgICAvLyBicm93c2VycyB0eXBpY2FsbHkgZG8gdGhpcyBhcyBuZWNlc3NhcnksIGpzZG9tIGRvZXNuJ3QuCiAgICAgIHZhciBuZXdWYWx1ZSA9IHRvU3RyaW5nKHZhbHVlKTsgLy8gVG8gYXZvaWQgc2lkZSBlZmZlY3RzIChzdWNoIGFzIGxvc2luZyB0ZXh0IHNlbGVjdGlvbiksIG9ubHkgc2V0IHZhbHVlIGlmIGNoYW5nZWQKCiAgICAgIGlmIChuZXdWYWx1ZSAhPT0gbm9kZS52YWx1ZSkgewogICAgICAgIG5vZGUudmFsdWUgPSBuZXdWYWx1ZTsKICAgICAgfQoKICAgICAgaWYgKHByb3BzLmRlZmF1bHRWYWx1ZSA9PSBudWxsICYmIG5vZGUuZGVmYXVsdFZhbHVlICE9PSBuZXdWYWx1ZSkgewogICAgICAgIG5vZGUuZGVmYXVsdFZhbHVlID0gbmV3VmFsdWU7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoZGVmYXVsdFZhbHVlICE9IG51bGwpIHsKICAgICAgbm9kZS5kZWZhdWx0VmFsdWUgPSB0b1N0cmluZyhkZWZhdWx0VmFsdWUpOwogICAgfQogIH0KICBmdW5jdGlvbiBwb3N0TW91bnRXcmFwcGVyJDMoZWxlbWVudCwgcHJvcHMpIHsKICAgIHZhciBub2RlID0gZWxlbWVudDsgLy8gVGhpcyBpcyBpbiBwb3N0TW91bnQgYmVjYXVzZSB3ZSBuZWVkIGFjY2VzcyB0byB0aGUgRE9NIG5vZGUsIHdoaWNoIGlzIG5vdAogICAgLy8gYXZhaWxhYmxlIHVudGlsIGFmdGVyIHRoZSBjb21wb25lbnQgaGFzIG1vdW50ZWQuCgogICAgdmFyIHRleHRDb250ZW50ID0gbm9kZS50ZXh0Q29udGVudDsgLy8gT25seSBzZXQgbm9kZS52YWx1ZSBpZiB0ZXh0Q29udGVudCBpcyBlcXVhbCB0byB0aGUgZXhwZWN0ZWQKICAgIC8vIGluaXRpYWwgdmFsdWUuIEluIElFMTAvSUUxMSB0aGVyZSBpcyBhIGJ1ZyB3aGVyZSB0aGUgcGxhY2Vob2xkZXIgYXR0cmlidXRlCiAgICAvLyB3aWxsIHBvcHVsYXRlIHRleHRDb250ZW50IGFzIHdlbGwuCiAgICAvLyBodHRwczovL2RldmVsb3Blci5taWNyb3NvZnQuY29tL21pY3Jvc29mdC1lZGdlL3BsYXRmb3JtL2lzc3Vlcy8xMDE1MjUvCgogICAgaWYgKHRleHRDb250ZW50ID09PSBub2RlLl93cmFwcGVyU3RhdGUuaW5pdGlhbFZhbHVlKSB7CiAgICAgIGlmICh0ZXh0Q29udGVudCAhPT0gJycgJiYgdGV4dENvbnRlbnQgIT09IG51bGwpIHsKICAgICAgICBub2RlLnZhbHVlID0gdGV4dENvbnRlbnQ7CiAgICAgIH0KICAgIH0KICB9CiAgZnVuY3Rpb24gcmVzdG9yZUNvbnRyb2xsZWRTdGF0ZSQyKGVsZW1lbnQsIHByb3BzKSB7CiAgICAvLyBET00gY29tcG9uZW50IGlzIHN0aWxsIG1vdW50ZWQ7IHVwZGF0ZQogICAgdXBkYXRlV3JhcHBlciQxKGVsZW1lbnQsIHByb3BzKTsKICB9CgogIHZhciBIVE1MX05BTUVTUEFDRSA9ICdodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sJzsKICB2YXIgTUFUSF9OQU1FU1BBQ0UgPSAnaHR0cDovL3d3dy53My5vcmcvMTk5OC9NYXRoL01hdGhNTCc7CiAgdmFyIFNWR19OQU1FU1BBQ0UgPSAnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnOyAvLyBBc3N1bWVzIHRoZXJlIGlzIG5vIHBhcmVudCBuYW1lc3BhY2UuCgogIGZ1bmN0aW9uIGdldEludHJpbnNpY05hbWVzcGFjZSh0eXBlKSB7CiAgICBzd2l0Y2ggKHR5cGUpIHsKICAgICAgY2FzZSAnc3ZnJzoKICAgICAgICByZXR1cm4gU1ZHX05BTUVTUEFDRTsKCiAgICAgIGNhc2UgJ21hdGgnOgogICAgICAgIHJldHVybiBNQVRIX05BTUVTUEFDRTsKCiAgICAgIGRlZmF1bHQ6CiAgICAgICAgcmV0dXJuIEhUTUxfTkFNRVNQQUNFOwogICAgfQogIH0KICBmdW5jdGlvbiBnZXRDaGlsZE5hbWVzcGFjZShwYXJlbnROYW1lc3BhY2UsIHR5cGUpIHsKICAgIGlmIChwYXJlbnROYW1lc3BhY2UgPT0gbnVsbCB8fCBwYXJlbnROYW1lc3BhY2UgPT09IEhUTUxfTkFNRVNQQUNFKSB7CiAgICAgIC8vIE5vIChvciBkZWZhdWx0KSBwYXJlbnQgbmFtZXNwYWNlOiBwb3RlbnRpYWwgZW50cnkgcG9pbnQuCiAgICAgIHJldHVybiBnZXRJbnRyaW5zaWNOYW1lc3BhY2UodHlwZSk7CiAgICB9CgogICAgaWYgKHBhcmVudE5hbWVzcGFjZSA9PT0gU1ZHX05BTUVTUEFDRSAmJiB0eXBlID09PSAnZm9yZWlnbk9iamVjdCcpIHsKICAgICAgLy8gV2UncmUgbGVhdmluZyBTVkcuCiAgICAgIHJldHVybiBIVE1MX05BTUVTUEFDRTsKICAgIH0gLy8gQnkgZGVmYXVsdCwgcGFzcyBuYW1lc3BhY2UgYmVsb3cuCgoKICAgIHJldHVybiBwYXJlbnROYW1lc3BhY2U7CiAgfQoKICAvKiBnbG9iYWxzIE1TQXBwICovCgogIC8qKgogICAqIENyZWF0ZSBhIGZ1bmN0aW9uIHdoaWNoIGhhcyAndW5zYWZlJyBwcml2aWxlZ2VzIChyZXF1aXJlZCBieSB3aW5kb3dzOCBhcHBzKQogICAqLwogIHZhciBjcmVhdGVNaWNyb3NvZnRVbnNhZmVMb2NhbEZ1bmN0aW9uID0gZnVuY3Rpb24gKGZ1bmMpIHsKICAgIGlmICh0eXBlb2YgTVNBcHAgIT09ICd1bmRlZmluZWQnICYmIE1TQXBwLmV4ZWNVbnNhZmVMb2NhbEZ1bmN0aW9uKSB7CiAgICAgIHJldHVybiBmdW5jdGlvbiAoYXJnMCwgYXJnMSwgYXJnMiwgYXJnMykgewogICAgICAgIE1TQXBwLmV4ZWNVbnNhZmVMb2NhbEZ1bmN0aW9uKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBmdW5jKGFyZzAsIGFyZzEsIGFyZzIsIGFyZzMpOwogICAgICAgIH0pOwogICAgICB9OwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIGZ1bmM7CiAgICB9CiAgfTsKCiAgdmFyIHJldXNhYmxlU1ZHQ29udGFpbmVyOwogIC8qKgogICAqIFNldCB0aGUgaW5uZXJIVE1MIHByb3BlcnR5IG9mIGEgbm9kZQogICAqCiAgICogQHBhcmFtIHtET01FbGVtZW50fSBub2RlCiAgICogQHBhcmFtIHtzdHJpbmd9IGh0bWwKICAgKiBAaW50ZXJuYWwKICAgKi8KCiAgdmFyIHNldElubmVySFRNTCA9IGNyZWF0ZU1pY3Jvc29mdFVuc2FmZUxvY2FsRnVuY3Rpb24oZnVuY3Rpb24gKG5vZGUsIGh0bWwpIHsKICAgIGlmIChub2RlLm5hbWVzcGFjZVVSSSA9PT0gU1ZHX05BTUVTUEFDRSkgewoKICAgICAgaWYgKCEoJ2lubmVySFRNTCcgaW4gbm9kZSkpIHsKICAgICAgICAvLyBJRSBkb2VzIG5vdCBoYXZlIGlubmVySFRNTCBmb3IgU1ZHIG5vZGVzLCBzbyBpbnN0ZWFkIHdlIGluamVjdCB0aGUKICAgICAgICAvLyBuZXcgbWFya3VwIGluIGEgdGVtcCBub2RlIGFuZCB0aGVuIG1vdmUgdGhlIGNoaWxkIG5vZGVzIGFjcm9zcyBpbnRvCiAgICAgICAgLy8gdGhlIHRhcmdldCBub2RlCiAgICAgICAgcmV1c2FibGVTVkdDb250YWluZXIgPSByZXVzYWJsZVNWR0NvbnRhaW5lciB8fCBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICByZXVzYWJsZVNWR0NvbnRhaW5lci5pbm5lckhUTUwgPSAnPHN2Zz4nICsgaHRtbC52YWx1ZU9mKCkudG9TdHJpbmcoKSArICc8L3N2Zz4nOwogICAgICAgIHZhciBzdmdOb2RlID0gcmV1c2FibGVTVkdDb250YWluZXIuZmlyc3RDaGlsZDsKCiAgICAgICAgd2hpbGUgKG5vZGUuZmlyc3RDaGlsZCkgewogICAgICAgICAgbm9kZS5yZW1vdmVDaGlsZChub2RlLmZpcnN0Q2hpbGQpOwogICAgICAgIH0KCiAgICAgICAgd2hpbGUgKHN2Z05vZGUuZmlyc3RDaGlsZCkgewogICAgICAgICAgbm9kZS5hcHBlbmRDaGlsZChzdmdOb2RlLmZpcnN0Q2hpbGQpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICB9CgogICAgbm9kZS5pbm5lckhUTUwgPSBodG1sOwogIH0pOwoKICAvKioKICAgKiBIVE1MIG5vZGVUeXBlIHZhbHVlcyB0aGF0IHJlcHJlc2VudCB0aGUgdHlwZSBvZiB0aGUgbm9kZQogICAqLwogIHZhciBFTEVNRU5UX05PREUgPSAxOwogIHZhciBURVhUX05PREUgPSAzOwogIHZhciBDT01NRU5UX05PREUgPSA4OwogIHZhciBET0NVTUVOVF9OT0RFID0gOTsKICB2YXIgRE9DVU1FTlRfRlJBR01FTlRfTk9ERSA9IDExOwoKICAvKioKICAgKiBTZXQgdGhlIHRleHRDb250ZW50IHByb3BlcnR5IG9mIGEgbm9kZS4gRm9yIHRleHQgdXBkYXRlcywgaXQncyBmYXN0ZXIKICAgKiB0byBzZXQgdGhlIGBub2RlVmFsdWVgIG9mIHRoZSBUZXh0IG5vZGUgZGlyZWN0bHkgaW5zdGVhZCBvZiB1c2luZwogICAqIGAudGV4dENvbnRlbnRgIHdoaWNoIHdpbGwgcmVtb3ZlIHRoZSBleGlzdGluZyBub2RlIGFuZCBjcmVhdGUgYSBuZXcgb25lLgogICAqCiAgICogQHBhcmFtIHtET01FbGVtZW50fSBub2RlCiAgICogQHBhcmFtIHtzdHJpbmd9IHRleHQKICAgKiBAaW50ZXJuYWwKICAgKi8KCiAgdmFyIHNldFRleHRDb250ZW50ID0gZnVuY3Rpb24gKG5vZGUsIHRleHQpIHsKICAgIGlmICh0ZXh0KSB7CiAgICAgIHZhciBmaXJzdENoaWxkID0gbm9kZS5maXJzdENoaWxkOwoKICAgICAgaWYgKGZpcnN0Q2hpbGQgJiYgZmlyc3RDaGlsZCA9PT0gbm9kZS5sYXN0Q2hpbGQgJiYgZmlyc3RDaGlsZC5ub2RlVHlwZSA9PT0gVEVYVF9OT0RFKSB7CiAgICAgICAgZmlyc3RDaGlsZC5ub2RlVmFsdWUgPSB0ZXh0OwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgfQoKICAgIG5vZGUudGV4dENvbnRlbnQgPSB0ZXh0OwogIH07CgogIC8vIExpc3QgZGVyaXZlZCBmcm9tIEdlY2tvIHNvdXJjZSBjb2RlOgogIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9tb3ppbGxhL2dlY2tvLWRldi9ibG9iLzRlNjM4ZWZjNzEvbGF5b3V0L3N0eWxlL3Rlc3QvcHJvcGVydHlfZGF0YWJhc2UuanMKICB2YXIgc2hvcnRoYW5kVG9Mb25naGFuZCA9IHsKICAgIGFuaW1hdGlvbjogWydhbmltYXRpb25EZWxheScsICdhbmltYXRpb25EaXJlY3Rpb24nLCAnYW5pbWF0aW9uRHVyYXRpb24nLCAnYW5pbWF0aW9uRmlsbE1vZGUnLCAnYW5pbWF0aW9uSXRlcmF0aW9uQ291bnQnLCAnYW5pbWF0aW9uTmFtZScsICdhbmltYXRpb25QbGF5U3RhdGUnLCAnYW5pbWF0aW9uVGltaW5nRnVuY3Rpb24nXSwKICAgIGJhY2tncm91bmQ6IFsnYmFja2dyb3VuZEF0dGFjaG1lbnQnLCAnYmFja2dyb3VuZENsaXAnLCAnYmFja2dyb3VuZENvbG9yJywgJ2JhY2tncm91bmRJbWFnZScsICdiYWNrZ3JvdW5kT3JpZ2luJywgJ2JhY2tncm91bmRQb3NpdGlvblgnLCAnYmFja2dyb3VuZFBvc2l0aW9uWScsICdiYWNrZ3JvdW5kUmVwZWF0JywgJ2JhY2tncm91bmRTaXplJ10sCiAgICBiYWNrZ3JvdW5kUG9zaXRpb246IFsnYmFja2dyb3VuZFBvc2l0aW9uWCcsICdiYWNrZ3JvdW5kUG9zaXRpb25ZJ10sCiAgICBib3JkZXI6IFsnYm9yZGVyQm90dG9tQ29sb3InLCAnYm9yZGVyQm90dG9tU3R5bGUnLCAnYm9yZGVyQm90dG9tV2lkdGgnLCAnYm9yZGVySW1hZ2VPdXRzZXQnLCAnYm9yZGVySW1hZ2VSZXBlYXQnLCAnYm9yZGVySW1hZ2VTbGljZScsICdib3JkZXJJbWFnZVNvdXJjZScsICdib3JkZXJJbWFnZVdpZHRoJywgJ2JvcmRlckxlZnRDb2xvcicsICdib3JkZXJMZWZ0U3R5bGUnLCAnYm9yZGVyTGVmdFdpZHRoJywgJ2JvcmRlclJpZ2h0Q29sb3InLCAnYm9yZGVyUmlnaHRTdHlsZScsICdib3JkZXJSaWdodFdpZHRoJywgJ2JvcmRlclRvcENvbG9yJywgJ2JvcmRlclRvcFN0eWxlJywgJ2JvcmRlclRvcFdpZHRoJ10sCiAgICBib3JkZXJCbG9ja0VuZDogWydib3JkZXJCbG9ja0VuZENvbG9yJywgJ2JvcmRlckJsb2NrRW5kU3R5bGUnLCAnYm9yZGVyQmxvY2tFbmRXaWR0aCddLAogICAgYm9yZGVyQmxvY2tTdGFydDogWydib3JkZXJCbG9ja1N0YXJ0Q29sb3InLCAnYm9yZGVyQmxvY2tTdGFydFN0eWxlJywgJ2JvcmRlckJsb2NrU3RhcnRXaWR0aCddLAogICAgYm9yZGVyQm90dG9tOiBbJ2JvcmRlckJvdHRvbUNvbG9yJywgJ2JvcmRlckJvdHRvbVN0eWxlJywgJ2JvcmRlckJvdHRvbVdpZHRoJ10sCiAgICBib3JkZXJDb2xvcjogWydib3JkZXJCb3R0b21Db2xvcicsICdib3JkZXJMZWZ0Q29sb3InLCAnYm9yZGVyUmlnaHRDb2xvcicsICdib3JkZXJUb3BDb2xvciddLAogICAgYm9yZGVySW1hZ2U6IFsnYm9yZGVySW1hZ2VPdXRzZXQnLCAnYm9yZGVySW1hZ2VSZXBlYXQnLCAnYm9yZGVySW1hZ2VTbGljZScsICdib3JkZXJJbWFnZVNvdXJjZScsICdib3JkZXJJbWFnZVdpZHRoJ10sCiAgICBib3JkZXJJbmxpbmVFbmQ6IFsnYm9yZGVySW5saW5lRW5kQ29sb3InLCAnYm9yZGVySW5saW5lRW5kU3R5bGUnLCAnYm9yZGVySW5saW5lRW5kV2lkdGgnXSwKICAgIGJvcmRlcklubGluZVN0YXJ0OiBbJ2JvcmRlcklubGluZVN0YXJ0Q29sb3InLCAnYm9yZGVySW5saW5lU3RhcnRTdHlsZScsICdib3JkZXJJbmxpbmVTdGFydFdpZHRoJ10sCiAgICBib3JkZXJMZWZ0OiBbJ2JvcmRlckxlZnRDb2xvcicsICdib3JkZXJMZWZ0U3R5bGUnLCAnYm9yZGVyTGVmdFdpZHRoJ10sCiAgICBib3JkZXJSYWRpdXM6IFsnYm9yZGVyQm90dG9tTGVmdFJhZGl1cycsICdib3JkZXJCb3R0b21SaWdodFJhZGl1cycsICdib3JkZXJUb3BMZWZ0UmFkaXVzJywgJ2JvcmRlclRvcFJpZ2h0UmFkaXVzJ10sCiAgICBib3JkZXJSaWdodDogWydib3JkZXJSaWdodENvbG9yJywgJ2JvcmRlclJpZ2h0U3R5bGUnLCAnYm9yZGVyUmlnaHRXaWR0aCddLAogICAgYm9yZGVyU3R5bGU6IFsnYm9yZGVyQm90dG9tU3R5bGUnLCAnYm9yZGVyTGVmdFN0eWxlJywgJ2JvcmRlclJpZ2h0U3R5bGUnLCAnYm9yZGVyVG9wU3R5bGUnXSwKICAgIGJvcmRlclRvcDogWydib3JkZXJUb3BDb2xvcicsICdib3JkZXJUb3BTdHlsZScsICdib3JkZXJUb3BXaWR0aCddLAogICAgYm9yZGVyV2lkdGg6IFsnYm9yZGVyQm90dG9tV2lkdGgnLCAnYm9yZGVyTGVmdFdpZHRoJywgJ2JvcmRlclJpZ2h0V2lkdGgnLCAnYm9yZGVyVG9wV2lkdGgnXSwKICAgIGNvbHVtblJ1bGU6IFsnY29sdW1uUnVsZUNvbG9yJywgJ2NvbHVtblJ1bGVTdHlsZScsICdjb2x1bW5SdWxlV2lkdGgnXSwKICAgIGNvbHVtbnM6IFsnY29sdW1uQ291bnQnLCAnY29sdW1uV2lkdGgnXSwKICAgIGZsZXg6IFsnZmxleEJhc2lzJywgJ2ZsZXhHcm93JywgJ2ZsZXhTaHJpbmsnXSwKICAgIGZsZXhGbG93OiBbJ2ZsZXhEaXJlY3Rpb24nLCAnZmxleFdyYXAnXSwKICAgIGZvbnQ6IFsnZm9udEZhbWlseScsICdmb250RmVhdHVyZVNldHRpbmdzJywgJ2ZvbnRLZXJuaW5nJywgJ2ZvbnRMYW5ndWFnZU92ZXJyaWRlJywgJ2ZvbnRTaXplJywgJ2ZvbnRTaXplQWRqdXN0JywgJ2ZvbnRTdHJldGNoJywgJ2ZvbnRTdHlsZScsICdmb250VmFyaWFudCcsICdmb250VmFyaWFudEFsdGVybmF0ZXMnLCAnZm9udFZhcmlhbnRDYXBzJywgJ2ZvbnRWYXJpYW50RWFzdEFzaWFuJywgJ2ZvbnRWYXJpYW50TGlnYXR1cmVzJywgJ2ZvbnRWYXJpYW50TnVtZXJpYycsICdmb250VmFyaWFudFBvc2l0aW9uJywgJ2ZvbnRXZWlnaHQnLCAnbGluZUhlaWdodCddLAogICAgZm9udFZhcmlhbnQ6IFsnZm9udFZhcmlhbnRBbHRlcm5hdGVzJywgJ2ZvbnRWYXJpYW50Q2FwcycsICdmb250VmFyaWFudEVhc3RBc2lhbicsICdmb250VmFyaWFudExpZ2F0dXJlcycsICdmb250VmFyaWFudE51bWVyaWMnLCAnZm9udFZhcmlhbnRQb3NpdGlvbiddLAogICAgZ2FwOiBbJ2NvbHVtbkdhcCcsICdyb3dHYXAnXSwKICAgIGdyaWQ6IFsnZ3JpZEF1dG9Db2x1bW5zJywgJ2dyaWRBdXRvRmxvdycsICdncmlkQXV0b1Jvd3MnLCAnZ3JpZFRlbXBsYXRlQXJlYXMnLCAnZ3JpZFRlbXBsYXRlQ29sdW1ucycsICdncmlkVGVtcGxhdGVSb3dzJ10sCiAgICBncmlkQXJlYTogWydncmlkQ29sdW1uRW5kJywgJ2dyaWRDb2x1bW5TdGFydCcsICdncmlkUm93RW5kJywgJ2dyaWRSb3dTdGFydCddLAogICAgZ3JpZENvbHVtbjogWydncmlkQ29sdW1uRW5kJywgJ2dyaWRDb2x1bW5TdGFydCddLAogICAgZ3JpZENvbHVtbkdhcDogWydjb2x1bW5HYXAnXSwKICAgIGdyaWRHYXA6IFsnY29sdW1uR2FwJywgJ3Jvd0dhcCddLAogICAgZ3JpZFJvdzogWydncmlkUm93RW5kJywgJ2dyaWRSb3dTdGFydCddLAogICAgZ3JpZFJvd0dhcDogWydyb3dHYXAnXSwKICAgIGdyaWRUZW1wbGF0ZTogWydncmlkVGVtcGxhdGVBcmVhcycsICdncmlkVGVtcGxhdGVDb2x1bW5zJywgJ2dyaWRUZW1wbGF0ZVJvd3MnXSwKICAgIGxpc3RTdHlsZTogWydsaXN0U3R5bGVJbWFnZScsICdsaXN0U3R5bGVQb3NpdGlvbicsICdsaXN0U3R5bGVUeXBlJ10sCiAgICBtYXJnaW46IFsnbWFyZ2luQm90dG9tJywgJ21hcmdpbkxlZnQnLCAnbWFyZ2luUmlnaHQnLCAnbWFyZ2luVG9wJ10sCiAgICBtYXJrZXI6IFsnbWFya2VyRW5kJywgJ21hcmtlck1pZCcsICdtYXJrZXJTdGFydCddLAogICAgbWFzazogWydtYXNrQ2xpcCcsICdtYXNrQ29tcG9zaXRlJywgJ21hc2tJbWFnZScsICdtYXNrTW9kZScsICdtYXNrT3JpZ2luJywgJ21hc2tQb3NpdGlvblgnLCAnbWFza1Bvc2l0aW9uWScsICdtYXNrUmVwZWF0JywgJ21hc2tTaXplJ10sCiAgICBtYXNrUG9zaXRpb246IFsnbWFza1Bvc2l0aW9uWCcsICdtYXNrUG9zaXRpb25ZJ10sCiAgICBvdXRsaW5lOiBbJ291dGxpbmVDb2xvcicsICdvdXRsaW5lU3R5bGUnLCAnb3V0bGluZVdpZHRoJ10sCiAgICBvdmVyZmxvdzogWydvdmVyZmxvd1gnLCAnb3ZlcmZsb3dZJ10sCiAgICBwYWRkaW5nOiBbJ3BhZGRpbmdCb3R0b20nLCAncGFkZGluZ0xlZnQnLCAncGFkZGluZ1JpZ2h0JywgJ3BhZGRpbmdUb3AnXSwKICAgIHBsYWNlQ29udGVudDogWydhbGlnbkNvbnRlbnQnLCAnanVzdGlmeUNvbnRlbnQnXSwKICAgIHBsYWNlSXRlbXM6IFsnYWxpZ25JdGVtcycsICdqdXN0aWZ5SXRlbXMnXSwKICAgIHBsYWNlU2VsZjogWydhbGlnblNlbGYnLCAnanVzdGlmeVNlbGYnXSwKICAgIHRleHREZWNvcmF0aW9uOiBbJ3RleHREZWNvcmF0aW9uQ29sb3InLCAndGV4dERlY29yYXRpb25MaW5lJywgJ3RleHREZWNvcmF0aW9uU3R5bGUnXSwKICAgIHRleHRFbXBoYXNpczogWyd0ZXh0RW1waGFzaXNDb2xvcicsICd0ZXh0RW1waGFzaXNTdHlsZSddLAogICAgdHJhbnNpdGlvbjogWyd0cmFuc2l0aW9uRGVsYXknLCAndHJhbnNpdGlvbkR1cmF0aW9uJywgJ3RyYW5zaXRpb25Qcm9wZXJ0eScsICd0cmFuc2l0aW9uVGltaW5nRnVuY3Rpb24nXSwKICAgIHdvcmRXcmFwOiBbJ292ZXJmbG93V3JhcCddCiAgfTsKCiAgLyoqCiAgICogQ1NTIHByb3BlcnRpZXMgd2hpY2ggYWNjZXB0IG51bWJlcnMgYnV0IGFyZSBub3QgaW4gdW5pdHMgb2YgInB4Ii4KICAgKi8KICB2YXIgaXNVbml0bGVzc051bWJlciA9IHsKICAgIGFuaW1hdGlvbkl0ZXJhdGlvbkNvdW50OiB0cnVlLAogICAgYXNwZWN0UmF0aW86IHRydWUsCiAgICBib3JkZXJJbWFnZU91dHNldDogdHJ1ZSwKICAgIGJvcmRlckltYWdlU2xpY2U6IHRydWUsCiAgICBib3JkZXJJbWFnZVdpZHRoOiB0cnVlLAogICAgYm94RmxleDogdHJ1ZSwKICAgIGJveEZsZXhHcm91cDogdHJ1ZSwKICAgIGJveE9yZGluYWxHcm91cDogdHJ1ZSwKICAgIGNvbHVtbkNvdW50OiB0cnVlLAogICAgY29sdW1uczogdHJ1ZSwKICAgIGZsZXg6IHRydWUsCiAgICBmbGV4R3JvdzogdHJ1ZSwKICAgIGZsZXhQb3NpdGl2ZTogdHJ1ZSwKICAgIGZsZXhTaHJpbms6IHRydWUsCiAgICBmbGV4TmVnYXRpdmU6IHRydWUsCiAgICBmbGV4T3JkZXI6IHRydWUsCiAgICBncmlkQXJlYTogdHJ1ZSwKICAgIGdyaWRSb3c6IHRydWUsCiAgICBncmlkUm93RW5kOiB0cnVlLAogICAgZ3JpZFJvd1NwYW46IHRydWUsCiAgICBncmlkUm93U3RhcnQ6IHRydWUsCiAgICBncmlkQ29sdW1uOiB0cnVlLAogICAgZ3JpZENvbHVtbkVuZDogdHJ1ZSwKICAgIGdyaWRDb2x1bW5TcGFuOiB0cnVlLAogICAgZ3JpZENvbHVtblN0YXJ0OiB0cnVlLAogICAgZm9udFdlaWdodDogdHJ1ZSwKICAgIGxpbmVDbGFtcDogdHJ1ZSwKICAgIGxpbmVIZWlnaHQ6IHRydWUsCiAgICBvcGFjaXR5OiB0cnVlLAogICAgb3JkZXI6IHRydWUsCiAgICBvcnBoYW5zOiB0cnVlLAogICAgdGFiU2l6ZTogdHJ1ZSwKICAgIHdpZG93czogdHJ1ZSwKICAgIHpJbmRleDogdHJ1ZSwKICAgIHpvb206IHRydWUsCiAgICAvLyBTVkctcmVsYXRlZCBwcm9wZXJ0aWVzCiAgICBmaWxsT3BhY2l0eTogdHJ1ZSwKICAgIGZsb29kT3BhY2l0eTogdHJ1ZSwKICAgIHN0b3BPcGFjaXR5OiB0cnVlLAogICAgc3Ryb2tlRGFzaGFycmF5OiB0cnVlLAogICAgc3Ryb2tlRGFzaG9mZnNldDogdHJ1ZSwKICAgIHN0cm9rZU1pdGVybGltaXQ6IHRydWUsCiAgICBzdHJva2VPcGFjaXR5OiB0cnVlLAogICAgc3Ryb2tlV2lkdGg6IHRydWUKICB9OwogIC8qKgogICAqIEBwYXJhbSB7c3RyaW5nfSBwcmVmaXggdmVuZG9yLXNwZWNpZmljIHByZWZpeCwgZWc6IFdlYmtpdAogICAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgc3R5bGUgbmFtZSwgZWc6IHRyYW5zaXRpb25EdXJhdGlvbgogICAqIEByZXR1cm4ge3N0cmluZ30gc3R5bGUgbmFtZSBwcmVmaXhlZCB3aXRoIGBwcmVmaXhgLCBwcm9wZXJseSBjYW1lbENhc2VkLCBlZzoKICAgKiBXZWJraXRUcmFuc2l0aW9uRHVyYXRpb24KICAgKi8KCiAgZnVuY3Rpb24gcHJlZml4S2V5KHByZWZpeCwga2V5KSB7CiAgICByZXR1cm4gcHJlZml4ICsga2V5LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsga2V5LnN1YnN0cmluZygxKTsKICB9CiAgLyoqCiAgICogU3VwcG9ydCBzdHlsZSBuYW1lcyB0aGF0IG1heSBjb21lIHBhc3NlZCBpbiBwcmVmaXhlZCBieSBhZGRpbmcgcGVybXV0YXRpb25zCiAgICogb2YgdmVuZG9yIHByZWZpeGVzLgogICAqLwoKCiAgdmFyIHByZWZpeGVzID0gWydXZWJraXQnLCAnbXMnLCAnTW96JywgJ08nXTsgLy8gVXNpbmcgT2JqZWN0LmtleXMgaGVyZSwgb3IgZWxzZSB0aGUgdmFuaWxsYSBmb3ItaW4gbG9vcCBtYWtlcyBJRTggZ28gaW50byBhbgogIC8vIGluZmluaXRlIGxvb3AsIGJlY2F1c2UgaXQgaXRlcmF0ZXMgb3ZlciB0aGUgbmV3bHkgYWRkZWQgcHJvcHMgdG9vLgoKICBPYmplY3Qua2V5cyhpc1VuaXRsZXNzTnVtYmVyKS5mb3JFYWNoKGZ1bmN0aW9uIChwcm9wKSB7CiAgICBwcmVmaXhlcy5mb3JFYWNoKGZ1bmN0aW9uIChwcmVmaXgpIHsKICAgICAgaXNVbml0bGVzc051bWJlcltwcmVmaXhLZXkocHJlZml4LCBwcm9wKV0gPSBpc1VuaXRsZXNzTnVtYmVyW3Byb3BdOwogICAgfSk7CiAgfSk7CgogIC8qKgogICAqIENvbnZlcnQgYSB2YWx1ZSBpbnRvIHRoZSBwcm9wZXIgY3NzIHdyaXRhYmxlIHZhbHVlLiBUaGUgc3R5bGUgbmFtZSBgbmFtZWAKICAgKiBzaG91bGQgYmUgbG9naWNhbCAobm8gaHlwaGVucyksIGFzIHNwZWNpZmllZAogICAqIGluIGBDU1NQcm9wZXJ0eS5pc1VuaXRsZXNzTnVtYmVyYC4KICAgKgogICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIENTUyBwcm9wZXJ0eSBuYW1lIHN1Y2ggYXMgYHRvcE1hcmdpbmAuCiAgICogQHBhcmFtIHsqfSB2YWx1ZSBDU1MgcHJvcGVydHkgdmFsdWUgc3VjaCBhcyBgMTBweGAuCiAgICogQHJldHVybiB7c3RyaW5nfSBOb3JtYWxpemVkIHN0eWxlIHZhbHVlIHdpdGggZGltZW5zaW9ucyBhcHBsaWVkLgogICAqLwoKICBmdW5jdGlvbiBkYW5nZXJvdXNTdHlsZVZhbHVlKG5hbWUsIHZhbHVlLCBpc0N1c3RvbVByb3BlcnR5KSB7CiAgICAvLyBOb3RlIHRoYXQgd2UndmUgcmVtb3ZlZCBlc2NhcGVUZXh0Rm9yQnJvd3NlcigpIGNhbGxzIGhlcmUgc2luY2UgdGhlCiAgICAvLyB3aG9sZSBzdHJpbmcgd2lsbCBiZSBlc2NhcGVkIHdoZW4gdGhlIGF0dHJpYnV0ZSBpcyBpbmplY3RlZCBpbnRvCiAgICAvLyB0aGUgbWFya3VwLiBJZiB5b3UgcHJvdmlkZSB1bnNhZmUgdXNlciBkYXRhIGhlcmUgdGhleSBjYW4gaW5qZWN0CiAgICAvLyBhcmJpdHJhcnkgQ1NTIHdoaWNoIG1heSBiZSBwcm9ibGVtYXRpYyAoSSBjb3VsZG4ndCByZXBybyB0aGlzKToKICAgIC8vIGh0dHBzOi8vd3d3Lm93YXNwLm9yZy9pbmRleC5waHAvWFNTX0ZpbHRlcl9FdmFzaW9uX0NoZWF0X1NoZWV0CiAgICAvLyBodHRwOi8vd3d3LnRoZXNwYW5uZXIuY28udWsvMjAwNy8xMS8yNi91bHRpbWF0ZS14c3MtY3NzLWluamVjdGlvbi8KICAgIC8vIFRoaXMgaXMgbm90IGFuIFhTUyBob2xlIGJ1dCBpbnN0ZWFkIGEgcG90ZW50aWFsIENTUyBpbmplY3Rpb24gaXNzdWUKICAgIC8vIHdoaWNoIGhhcyBsZWFkIHRvIGEgZ3JlYXRlciBkaXNjdXNzaW9uIGFib3V0IGhvdyB3ZSdyZSBnb2luZyB0bwogICAgLy8gdHJ1c3QgVVJMcyBtb3ZpbmcgZm9yd2FyZC4gU2VlICMyMTE1OTAxCiAgICB2YXIgaXNFbXB0eSA9IHZhbHVlID09IG51bGwgfHwgdHlwZW9mIHZhbHVlID09PSAnYm9vbGVhbicgfHwgdmFsdWUgPT09ICcnOwoKICAgIGlmIChpc0VtcHR5KSB7CiAgICAgIHJldHVybiAnJzsKICAgIH0KCiAgICBpZiAoIWlzQ3VzdG9tUHJvcGVydHkgJiYgdHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJyAmJiB2YWx1ZSAhPT0gMCAmJiAhKGlzVW5pdGxlc3NOdW1iZXIuaGFzT3duUHJvcGVydHkobmFtZSkgJiYgaXNVbml0bGVzc051bWJlcltuYW1lXSkpIHsKICAgICAgcmV0dXJuIHZhbHVlICsgJ3B4JzsgLy8gUHJlc3VtZXMgaW1wbGljaXQgJ3B4JyBzdWZmaXggZm9yIHVuaXRsZXNzIG51bWJlcnMKICAgIH0KCiAgICB7CiAgICAgIGNoZWNrQ1NTUHJvcGVydHlTdHJpbmdDb2VyY2lvbih2YWx1ZSwgbmFtZSk7CiAgICB9CgogICAgcmV0dXJuICgnJyArIHZhbHVlKS50cmltKCk7CiAgfQoKICB2YXIgdXBwZXJjYXNlUGF0dGVybiA9IC8oW0EtWl0pL2c7CiAgdmFyIG1zUGF0dGVybiA9IC9ebXMtLzsKICAvKioKICAgKiBIeXBoZW5hdGVzIGEgY2FtZWxjYXNlZCBDU1MgcHJvcGVydHkgbmFtZSwgZm9yIGV4YW1wbGU6CiAgICoKICAgKiAgID4gaHlwaGVuYXRlU3R5bGVOYW1lKCdiYWNrZ3JvdW5kQ29sb3InKQogICAqICAgPCAiYmFja2dyb3VuZC1jb2xvciIKICAgKiAgID4gaHlwaGVuYXRlU3R5bGVOYW1lKCdNb3pUcmFuc2l0aW9uJykKICAgKiAgIDwgIi1tb3otdHJhbnNpdGlvbiIKICAgKiAgID4gaHlwaGVuYXRlU3R5bGVOYW1lKCdtc1RyYW5zaXRpb24nKQogICAqICAgPCAiLW1zLXRyYW5zaXRpb24iCiAgICoKICAgKiBBcyBNb2Rlcm5penIgc3VnZ2VzdHMgKGh0dHA6Ly9tb2Rlcm5penIuY29tL2RvY3MvI3ByZWZpeGVkKSwgYW4gYG1zYCBwcmVmaXgKICAgKiBpcyBjb252ZXJ0ZWQgdG8gYC1tcy1gLgogICAqLwoKICBmdW5jdGlvbiBoeXBoZW5hdGVTdHlsZU5hbWUobmFtZSkgewogICAgcmV0dXJuIG5hbWUucmVwbGFjZSh1cHBlcmNhc2VQYXR0ZXJuLCAnLSQxJykudG9Mb3dlckNhc2UoKS5yZXBsYWNlKG1zUGF0dGVybiwgJy1tcy0nKTsKICB9CgogIHZhciB3YXJuVmFsaWRTdHlsZSA9IGZ1bmN0aW9uICgpIHt9OwoKICB7CiAgICAvLyAnbXNUcmFuc2Zvcm0nIGlzIGNvcnJlY3QsIGJ1dCB0aGUgb3RoZXIgcHJlZml4ZXMgc2hvdWxkIGJlIGNhcGl0YWxpemVkCiAgICB2YXIgYmFkVmVuZG9yZWRTdHlsZU5hbWVQYXR0ZXJuID0gL14oPzp3ZWJraXR8bW96fG8pW0EtWl0vOwogICAgdmFyIG1zUGF0dGVybiQxID0gL14tbXMtLzsKICAgIHZhciBoeXBoZW5QYXR0ZXJuID0gLy0oLikvZzsgLy8gc3R5bGUgdmFsdWVzIHNob3VsZG4ndCBjb250YWluIGEgc2VtaWNvbG9uCgogICAgdmFyIGJhZFN0eWxlVmFsdWVXaXRoU2VtaWNvbG9uUGF0dGVybiA9IC87XHMqJC87CiAgICB2YXIgd2FybmVkU3R5bGVOYW1lcyA9IHt9OwogICAgdmFyIHdhcm5lZFN0eWxlVmFsdWVzID0ge307CiAgICB2YXIgd2FybmVkRm9yTmFOVmFsdWUgPSBmYWxzZTsKICAgIHZhciB3YXJuZWRGb3JJbmZpbml0eVZhbHVlID0gZmFsc2U7CgogICAgdmFyIGNhbWVsaXplID0gZnVuY3Rpb24gKHN0cmluZykgewogICAgICByZXR1cm4gc3RyaW5nLnJlcGxhY2UoaHlwaGVuUGF0dGVybiwgZnVuY3Rpb24gKF8sIGNoYXJhY3RlcikgewogICAgICAgIHJldHVybiBjaGFyYWN0ZXIudG9VcHBlckNhc2UoKTsKICAgICAgfSk7CiAgICB9OwoKICAgIHZhciB3YXJuSHlwaGVuYXRlZFN0eWxlTmFtZSA9IGZ1bmN0aW9uIChuYW1lKSB7CiAgICAgIGlmICh3YXJuZWRTdHlsZU5hbWVzLmhhc093blByb3BlcnR5KG5hbWUpICYmIHdhcm5lZFN0eWxlTmFtZXNbbmFtZV0pIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHdhcm5lZFN0eWxlTmFtZXNbbmFtZV0gPSB0cnVlOwoKICAgICAgZXJyb3IoJ1Vuc3VwcG9ydGVkIHN0eWxlIHByb3BlcnR5ICVzLiBEaWQgeW91IG1lYW4gJXM/JywgbmFtZSwgLy8gQXMgQW5kaSBTbWl0aCBzdWdnZXN0cwogICAgICAvLyAoaHR0cDovL3d3dy5hbmRpc21pdGguY29tL2Jsb2cvMjAxMi8wMi9tb2Rlcm5penItcHJlZml4ZWQvKSwgYW4gYC1tc2AgcHJlZml4CiAgICAgIC8vIGlzIGNvbnZlcnRlZCB0byBsb3dlcmNhc2UgYG1zYC4KICAgICAgY2FtZWxpemUobmFtZS5yZXBsYWNlKG1zUGF0dGVybiQxLCAnbXMtJykpKTsKICAgIH07CgogICAgdmFyIHdhcm5CYWRWZW5kb3JlZFN0eWxlTmFtZSA9IGZ1bmN0aW9uIChuYW1lKSB7CiAgICAgIGlmICh3YXJuZWRTdHlsZU5hbWVzLmhhc093blByb3BlcnR5KG5hbWUpICYmIHdhcm5lZFN0eWxlTmFtZXNbbmFtZV0pIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHdhcm5lZFN0eWxlTmFtZXNbbmFtZV0gPSB0cnVlOwoKICAgICAgZXJyb3IoJ1Vuc3VwcG9ydGVkIHZlbmRvci1wcmVmaXhlZCBzdHlsZSBwcm9wZXJ0eSAlcy4gRGlkIHlvdSBtZWFuICVzPycsIG5hbWUsIG5hbWUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBuYW1lLnNsaWNlKDEpKTsKICAgIH07CgogICAgdmFyIHdhcm5TdHlsZVZhbHVlV2l0aFNlbWljb2xvbiA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkgewogICAgICBpZiAod2FybmVkU3R5bGVWYWx1ZXMuaGFzT3duUHJvcGVydHkodmFsdWUpICYmIHdhcm5lZFN0eWxlVmFsdWVzW3ZhbHVlXSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgd2FybmVkU3R5bGVWYWx1ZXNbdmFsdWVdID0gdHJ1ZTsKCiAgICAgIGVycm9yKCJTdHlsZSBwcm9wZXJ0eSB2YWx1ZXMgc2hvdWxkbid0IGNvbnRhaW4gYSBzZW1pY29sb24uICIgKyAnVHJ5ICIlczogJXMiIGluc3RlYWQuJywgbmFtZSwgdmFsdWUucmVwbGFjZShiYWRTdHlsZVZhbHVlV2l0aFNlbWljb2xvblBhdHRlcm4sICcnKSk7CiAgICB9OwoKICAgIHZhciB3YXJuU3R5bGVWYWx1ZUlzTmFOID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7CiAgICAgIGlmICh3YXJuZWRGb3JOYU5WYWx1ZSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgd2FybmVkRm9yTmFOVmFsdWUgPSB0cnVlOwoKICAgICAgZXJyb3IoJ2BOYU5gIGlzIGFuIGludmFsaWQgdmFsdWUgZm9yIHRoZSBgJXNgIGNzcyBzdHlsZSBwcm9wZXJ0eS4nLCBuYW1lKTsKICAgIH07CgogICAgdmFyIHdhcm5TdHlsZVZhbHVlSXNJbmZpbml0eSA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkgewogICAgICBpZiAod2FybmVkRm9ySW5maW5pdHlWYWx1ZSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgd2FybmVkRm9ySW5maW5pdHlWYWx1ZSA9IHRydWU7CgogICAgICBlcnJvcignYEluZmluaXR5YCBpcyBhbiBpbnZhbGlkIHZhbHVlIGZvciB0aGUgYCVzYCBjc3Mgc3R5bGUgcHJvcGVydHkuJywgbmFtZSk7CiAgICB9OwoKICAgIHdhcm5WYWxpZFN0eWxlID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7CiAgICAgIGlmIChuYW1lLmluZGV4T2YoJy0nKSA+IC0xKSB7CiAgICAgICAgd2Fybkh5cGhlbmF0ZWRTdHlsZU5hbWUobmFtZSk7CiAgICAgIH0gZWxzZSBpZiAoYmFkVmVuZG9yZWRTdHlsZU5hbWVQYXR0ZXJuLnRlc3QobmFtZSkpIHsKICAgICAgICB3YXJuQmFkVmVuZG9yZWRTdHlsZU5hbWUobmFtZSk7CiAgICAgIH0gZWxzZSBpZiAoYmFkU3R5bGVWYWx1ZVdpdGhTZW1pY29sb25QYXR0ZXJuLnRlc3QodmFsdWUpKSB7CiAgICAgICAgd2FyblN0eWxlVmFsdWVXaXRoU2VtaWNvbG9uKG5hbWUsIHZhbHVlKTsKICAgICAgfQoKICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpIHsKICAgICAgICBpZiAoaXNOYU4odmFsdWUpKSB7CiAgICAgICAgICB3YXJuU3R5bGVWYWx1ZUlzTmFOKG5hbWUsIHZhbHVlKTsKICAgICAgICB9IGVsc2UgaWYgKCFpc0Zpbml0ZSh2YWx1ZSkpIHsKICAgICAgICAgIHdhcm5TdHlsZVZhbHVlSXNJbmZpbml0eShuYW1lLCB2YWx1ZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9OwogIH0KCiAgdmFyIHdhcm5WYWxpZFN0eWxlJDEgPSB3YXJuVmFsaWRTdHlsZTsKCiAgLyoqCiAgICogT3BlcmF0aW9ucyBmb3IgZGVhbGluZyB3aXRoIENTUyBwcm9wZXJ0aWVzLgogICAqLwoKICAvKioKICAgKiBUaGlzIGNyZWF0ZXMgYSBzdHJpbmcgdGhhdCBpcyBleHBlY3RlZCB0byBiZSBlcXVpdmFsZW50IHRvIHRoZSBzdHlsZQogICAqIGF0dHJpYnV0ZSBnZW5lcmF0ZWQgYnkgc2VydmVyLXNpZGUgcmVuZGVyaW5nLiBJdCBieS1wYXNzZXMgd2FybmluZ3MgYW5kCiAgICogc2VjdXJpdHkgY2hlY2tzIHNvIGl0J3Mgbm90IHNhZmUgdG8gdXNlIHRoaXMgdmFsdWUgZm9yIGFueXRoaW5nIG90aGVyIHRoYW4KICAgKiBjb21wYXJpc29uLiBJdCBpcyBvbmx5IHVzZWQgaW4gREVWIGZvciBTU1IgdmFsaWRhdGlvbi4KICAgKi8KCiAgZnVuY3Rpb24gY3JlYXRlRGFuZ2Vyb3VzU3RyaW5nRm9yU3R5bGVzKHN0eWxlcykgewogICAgewogICAgICB2YXIgc2VyaWFsaXplZCA9ICcnOwogICAgICB2YXIgZGVsaW1pdGVyID0gJyc7CgogICAgICBmb3IgKHZhciBzdHlsZU5hbWUgaW4gc3R5bGVzKSB7CiAgICAgICAgaWYgKCFzdHlsZXMuaGFzT3duUHJvcGVydHkoc3R5bGVOYW1lKSkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICB2YXIgc3R5bGVWYWx1ZSA9IHN0eWxlc1tzdHlsZU5hbWVdOwoKICAgICAgICBpZiAoc3R5bGVWYWx1ZSAhPSBudWxsKSB7CiAgICAgICAgICB2YXIgaXNDdXN0b21Qcm9wZXJ0eSA9IHN0eWxlTmFtZS5pbmRleE9mKCctLScpID09PSAwOwogICAgICAgICAgc2VyaWFsaXplZCArPSBkZWxpbWl0ZXIgKyAoaXNDdXN0b21Qcm9wZXJ0eSA/IHN0eWxlTmFtZSA6IGh5cGhlbmF0ZVN0eWxlTmFtZShzdHlsZU5hbWUpKSArICc6JzsKICAgICAgICAgIHNlcmlhbGl6ZWQgKz0gZGFuZ2Vyb3VzU3R5bGVWYWx1ZShzdHlsZU5hbWUsIHN0eWxlVmFsdWUsIGlzQ3VzdG9tUHJvcGVydHkpOwogICAgICAgICAgZGVsaW1pdGVyID0gJzsnOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHNlcmlhbGl6ZWQgfHwgbnVsbDsKICAgIH0KICB9CiAgLyoqCiAgICogU2V0cyB0aGUgdmFsdWUgZm9yIG11bHRpcGxlIHN0eWxlcyBvbiBhIG5vZGUuICBJZiBhIHZhbHVlIGlzIHNwZWNpZmllZCBhcwogICAqICcnIChlbXB0eSBzdHJpbmcpLCB0aGUgY29ycmVzcG9uZGluZyBzdHlsZSBwcm9wZXJ0eSB3aWxsIGJlIHVuc2V0LgogICAqCiAgICogQHBhcmFtIHtET01FbGVtZW50fSBub2RlCiAgICogQHBhcmFtIHtvYmplY3R9IHN0eWxlcwogICAqLwoKICBmdW5jdGlvbiBzZXRWYWx1ZUZvclN0eWxlcyhub2RlLCBzdHlsZXMpIHsKICAgIHZhciBzdHlsZSA9IG5vZGUuc3R5bGU7CgogICAgZm9yICh2YXIgc3R5bGVOYW1lIGluIHN0eWxlcykgewogICAgICBpZiAoIXN0eWxlcy5oYXNPd25Qcm9wZXJ0eShzdHlsZU5hbWUpKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIHZhciBpc0N1c3RvbVByb3BlcnR5ID0gc3R5bGVOYW1lLmluZGV4T2YoJy0tJykgPT09IDA7CgogICAgICB7CiAgICAgICAgaWYgKCFpc0N1c3RvbVByb3BlcnR5KSB7CiAgICAgICAgICB3YXJuVmFsaWRTdHlsZSQxKHN0eWxlTmFtZSwgc3R5bGVzW3N0eWxlTmFtZV0pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdmFyIHN0eWxlVmFsdWUgPSBkYW5nZXJvdXNTdHlsZVZhbHVlKHN0eWxlTmFtZSwgc3R5bGVzW3N0eWxlTmFtZV0sIGlzQ3VzdG9tUHJvcGVydHkpOwoKICAgICAgaWYgKHN0eWxlTmFtZSA9PT0gJ2Zsb2F0JykgewogICAgICAgIHN0eWxlTmFtZSA9ICdjc3NGbG9hdCc7CiAgICAgIH0KCiAgICAgIGlmIChpc0N1c3RvbVByb3BlcnR5KSB7CiAgICAgICAgc3R5bGUuc2V0UHJvcGVydHkoc3R5bGVOYW1lLCBzdHlsZVZhbHVlKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBzdHlsZVtzdHlsZU5hbWVdID0gc3R5bGVWYWx1ZTsKICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gaXNWYWx1ZUVtcHR5KHZhbHVlKSB7CiAgICByZXR1cm4gdmFsdWUgPT0gbnVsbCB8fCB0eXBlb2YgdmFsdWUgPT09ICdib29sZWFuJyB8fCB2YWx1ZSA9PT0gJyc7CiAgfQogIC8qKgogICAqIEdpdmVuIHtjb2xvcjogJ3JlZCcsIG92ZXJmbG93OiAnaGlkZGVuJ30gcmV0dXJucyB7CiAgICogICBjb2xvcjogJ2NvbG9yJywKICAgKiAgIG92ZXJmbG93WDogJ292ZXJmbG93JywKICAgKiAgIG92ZXJmbG93WTogJ292ZXJmbG93JywKICAgKiB9LiBUaGlzIGNhbiBiZSByZWFkIGFzICJ0aGUgb3ZlcmZsb3dZIHByb3BlcnR5IHdhcyBzZXQgYnkgdGhlIG92ZXJmbG93CiAgICogc2hvcnRoYW5kIi4gVGhhdCBpcywgdGhlIHZhbHVlcyBhcmUgdGhlIHByb3BlcnR5IHRoYXQgZWFjaCB3YXMgZGVyaXZlZCBmcm9tLgogICAqLwoKCiAgZnVuY3Rpb24gZXhwYW5kU2hvcnRoYW5kTWFwKHN0eWxlcykgewogICAgdmFyIGV4cGFuZGVkID0ge307CgogICAgZm9yICh2YXIga2V5IGluIHN0eWxlcykgewogICAgICB2YXIgbG9uZ2hhbmRzID0gc2hvcnRoYW5kVG9Mb25naGFuZFtrZXldIHx8IFtrZXldOwoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsb25naGFuZHMubGVuZ3RoOyBpKyspIHsKICAgICAgICBleHBhbmRlZFtsb25naGFuZHNbaV1dID0ga2V5OwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIGV4cGFuZGVkOwogIH0KICAvKioKICAgKiBXaGVuIG1peGluZyBzaG9ydGhhbmQgYW5kIGxvbmdoYW5kIHByb3BlcnR5IG5hbWVzLCB3ZSB3YXJuIGR1cmluZyB1cGRhdGVzIGlmCiAgICogd2UgZXhwZWN0IGFuIGluY29ycmVjdCByZXN1bHQgdG8gb2NjdXIuIEluIHBhcnRpY3VsYXIsIHdlIHdhcm4gZm9yOgogICAqCiAgICogVXBkYXRpbmcgYSBzaG9ydGhhbmQgcHJvcGVydHkgKGxvbmdoYW5kIGdldHMgb3ZlcndyaXR0ZW4pOgogICAqICAge2ZvbnQ6ICdmb28nLCBmb250VmFyaWFudDogJ2Jhcid9IC0+IHtmb250OiAnYmF6JywgZm9udFZhcmlhbnQ6ICdiYXInfQogICAqICAgYmVjb21lcyAuc3R5bGUuZm9udCA9ICdiYXonCiAgICogUmVtb3ZpbmcgYSBzaG9ydGhhbmQgcHJvcGVydHkgKGxvbmdoYW5kIGdldHMgbG9zdCB0b28pOgogICAqICAge2ZvbnQ6ICdmb28nLCBmb250VmFyaWFudDogJ2Jhcid9IC0+IHtmb250VmFyaWFudDogJ2Jhcid9CiAgICogICBiZWNvbWVzIC5zdHlsZS5mb250ID0gJycKICAgKiBSZW1vdmluZyBhIGxvbmdoYW5kIHByb3BlcnR5IChzaG91bGQgcmV2ZXJ0IHRvIHNob3J0aGFuZDsgZG9lc24ndCk6CiAgICogICB7Zm9udDogJ2ZvbycsIGZvbnRWYXJpYW50OiAnYmFyJ30gLT4ge2ZvbnQ6ICdmb28nfQogICAqICAgYmVjb21lcyAuc3R5bGUuZm9udFZhcmlhbnQgPSAnJwogICAqLwoKCiAgZnVuY3Rpb24gdmFsaWRhdGVTaG9ydGhhbmRQcm9wZXJ0eUNvbGxpc2lvbkluRGV2KHN0eWxlVXBkYXRlcywgbmV4dFN0eWxlcykgewogICAgewogICAgICBpZiAoIW5leHRTdHlsZXMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBleHBhbmRlZFVwZGF0ZXMgPSBleHBhbmRTaG9ydGhhbmRNYXAoc3R5bGVVcGRhdGVzKTsKICAgICAgdmFyIGV4cGFuZGVkU3R5bGVzID0gZXhwYW5kU2hvcnRoYW5kTWFwKG5leHRTdHlsZXMpOwogICAgICB2YXIgd2FybmVkQWJvdXQgPSB7fTsKCiAgICAgIGZvciAodmFyIGtleSBpbiBleHBhbmRlZFVwZGF0ZXMpIHsKICAgICAgICB2YXIgb3JpZ2luYWxLZXkgPSBleHBhbmRlZFVwZGF0ZXNba2V5XTsKICAgICAgICB2YXIgY29ycmVjdE9yaWdpbmFsS2V5ID0gZXhwYW5kZWRTdHlsZXNba2V5XTsKCiAgICAgICAgaWYgKGNvcnJlY3RPcmlnaW5hbEtleSAmJiBvcmlnaW5hbEtleSAhPT0gY29ycmVjdE9yaWdpbmFsS2V5KSB7CiAgICAgICAgICB2YXIgd2FybmluZ0tleSA9IG9yaWdpbmFsS2V5ICsgJywnICsgY29ycmVjdE9yaWdpbmFsS2V5OwoKICAgICAgICAgIGlmICh3YXJuZWRBYm91dFt3YXJuaW5nS2V5XSkgewogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICB3YXJuZWRBYm91dFt3YXJuaW5nS2V5XSA9IHRydWU7CgogICAgICAgICAgZXJyb3IoJyVzIGEgc3R5bGUgcHJvcGVydHkgZHVyaW5nIHJlcmVuZGVyICglcykgd2hlbiBhICcgKyAnY29uZmxpY3RpbmcgcHJvcGVydHkgaXMgc2V0ICglcykgY2FuIGxlYWQgdG8gc3R5bGluZyBidWdzLiBUbyAnICsgImF2b2lkIHRoaXMsIGRvbid0IG1peCBzaG9ydGhhbmQgYW5kIG5vbi1zaG9ydGhhbmQgcHJvcGVydGllcyAiICsgJ2ZvciB0aGUgc2FtZSB2YWx1ZTsgaW5zdGVhZCwgcmVwbGFjZSB0aGUgc2hvcnRoYW5kIHdpdGggJyArICdzZXBhcmF0ZSB2YWx1ZXMuJywgaXNWYWx1ZUVtcHR5KHN0eWxlVXBkYXRlc1tvcmlnaW5hbEtleV0pID8gJ1JlbW92aW5nJyA6ICdVcGRhdGluZycsIG9yaWdpbmFsS2V5LCBjb3JyZWN0T3JpZ2luYWxLZXkpOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KCiAgLy8gRm9yIEhUTUwsIGNlcnRhaW4gdGFncyBzaG91bGQgb21pdCB0aGVpciBjbG9zZSB0YWcuIFdlIGtlZXAgYSBsaXN0IGZvcgogIC8vIHRob3NlIHNwZWNpYWwtY2FzZSB0YWdzLgogIHZhciBvbWl0dGVkQ2xvc2VUYWdzID0gewogICAgYXJlYTogdHJ1ZSwKICAgIGJhc2U6IHRydWUsCiAgICBicjogdHJ1ZSwKICAgIGNvbDogdHJ1ZSwKICAgIGVtYmVkOiB0cnVlLAogICAgaHI6IHRydWUsCiAgICBpbWc6IHRydWUsCiAgICBpbnB1dDogdHJ1ZSwKICAgIGtleWdlbjogdHJ1ZSwKICAgIGxpbms6IHRydWUsCiAgICBtZXRhOiB0cnVlLAogICAgcGFyYW06IHRydWUsCiAgICBzb3VyY2U6IHRydWUsCiAgICB0cmFjazogdHJ1ZSwKICAgIHdicjogdHJ1ZSAvLyBOT1RFOiBtZW51aXRlbSdzIGNsb3NlIHRhZyBzaG91bGQgYmUgb21pdHRlZCwgYnV0IHRoYXQgY2F1c2VzIHByb2JsZW1zLgoKICB9OwoKICAvLyBgb21pdHRlZENsb3NlVGFnc2AgZXhjZXB0IHRoYXQgYG1lbnVpdGVtYCBzaG91bGQgc3RpbGwgaGF2ZSBpdHMgY2xvc2luZyB0YWcuCgogIHZhciB2b2lkRWxlbWVudFRhZ3MgPSBhc3NpZ24oewogICAgbWVudWl0ZW06IHRydWUKICB9LCBvbWl0dGVkQ2xvc2VUYWdzKTsKCiAgdmFyIEhUTUwgPSAnX19odG1sJzsKCiAgZnVuY3Rpb24gYXNzZXJ0VmFsaWRQcm9wcyh0YWcsIHByb3BzKSB7CiAgICBpZiAoIXByb3BzKSB7CiAgICAgIHJldHVybjsKICAgIH0gLy8gTm90ZSB0aGUgdXNlIG9mIGA9PWAgd2hpY2ggY2hlY2tzIGZvciBudWxsIG9yIHVuZGVmaW5lZC4KCgogICAgaWYgKHZvaWRFbGVtZW50VGFnc1t0YWddKSB7CiAgICAgIGlmIChwcm9wcy5jaGlsZHJlbiAhPSBudWxsIHx8IHByb3BzLmRhbmdlcm91c2x5U2V0SW5uZXJIVE1MICE9IG51bGwpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IodGFnICsgIiBpcyBhIHZvaWQgZWxlbWVudCB0YWcgYW5kIG11c3QgbmVpdGhlciBoYXZlIGBjaGlsZHJlbmAgbm9yICIgKyAndXNlIGBkYW5nZXJvdXNseVNldElubmVySFRNTGAuJyk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAocHJvcHMuZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUwgIT0gbnVsbCkgewogICAgICBpZiAocHJvcHMuY2hpbGRyZW4gIT0gbnVsbCkgewogICAgICAgIHRocm93IG5ldyBFcnJvcignQ2FuIG9ubHkgc2V0IG9uZSBvZiBgY2hpbGRyZW5gIG9yIGBwcm9wcy5kYW5nZXJvdXNseVNldElubmVySFRNTGAuJyk7CiAgICAgIH0KCiAgICAgIGlmICh0eXBlb2YgcHJvcHMuZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUwgIT09ICdvYmplY3QnIHx8ICEoSFRNTCBpbiBwcm9wcy5kYW5nZXJvdXNseVNldElubmVySFRNTCkpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2Bwcm9wcy5kYW5nZXJvdXNseVNldElubmVySFRNTGAgbXVzdCBiZSBpbiB0aGUgZm9ybSBge19faHRtbDogLi4ufWAuICcgKyAnUGxlYXNlIHZpc2l0IGh0dHBzOi8vcmVhY3Rqcy5vcmcvbGluay9kYW5nZXJvdXNseS1zZXQtaW5uZXItaHRtbCAnICsgJ2ZvciBtb3JlIGluZm9ybWF0aW9uLicpOwogICAgICB9CiAgICB9CgogICAgewogICAgICBpZiAoIXByb3BzLnN1cHByZXNzQ29udGVudEVkaXRhYmxlV2FybmluZyAmJiBwcm9wcy5jb250ZW50RWRpdGFibGUgJiYgcHJvcHMuY2hpbGRyZW4gIT0gbnVsbCkgewogICAgICAgIGVycm9yKCdBIGNvbXBvbmVudCBpcyBgY29udGVudEVkaXRhYmxlYCBhbmQgY29udGFpbnMgYGNoaWxkcmVuYCBtYW5hZ2VkIGJ5ICcgKyAnUmVhY3QuIEl0IGlzIG5vdyB5b3VyIHJlc3BvbnNpYmlsaXR5IHRvIGd1YXJhbnRlZSB0aGF0IG5vbmUgb2YgJyArICd0aG9zZSBub2RlcyBhcmUgdW5leHBlY3RlZGx5IG1vZGlmaWVkIG9yIGR1cGxpY2F0ZWQuIFRoaXMgaXMgJyArICdwcm9iYWJseSBub3QgaW50ZW50aW9uYWwuJyk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAocHJvcHMuc3R5bGUgIT0gbnVsbCAmJiB0eXBlb2YgcHJvcHMuc3R5bGUgIT09ICdvYmplY3QnKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignVGhlIGBzdHlsZWAgcHJvcCBleHBlY3RzIGEgbWFwcGluZyBmcm9tIHN0eWxlIHByb3BlcnRpZXMgdG8gdmFsdWVzLCAnICsgIm5vdCBhIHN0cmluZy4gRm9yIGV4YW1wbGUsIHN0eWxlPXt7bWFyZ2luUmlnaHQ6IHNwYWNpbmcgKyAnZW0nfX0gd2hlbiAiICsgJ3VzaW5nIEpTWC4nKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGlzQ3VzdG9tQ29tcG9uZW50KHRhZ05hbWUsIHByb3BzKSB7CiAgICBpZiAodGFnTmFtZS5pbmRleE9mKCctJykgPT09IC0xKSB7CiAgICAgIHJldHVybiB0eXBlb2YgcHJvcHMuaXMgPT09ICdzdHJpbmcnOwogICAgfQoKICAgIHN3aXRjaCAodGFnTmFtZSkgewogICAgICAvLyBUaGVzZSBhcmUgcmVzZXJ2ZWQgU1ZHIGFuZCBNYXRoTUwgZWxlbWVudHMuCiAgICAgIC8vIFdlIGRvbid0IG1pbmQgdGhpcyBsaXN0IHRvbyBtdWNoIGJlY2F1c2Ugd2UgZXhwZWN0IGl0IHRvIG5ldmVyIGdyb3cuCiAgICAgIC8vIFRoZSBhbHRlcm5hdGl2ZSBpcyB0byB0cmFjayB0aGUgbmFtZXNwYWNlIGluIGEgZmV3IHBsYWNlcyB3aGljaCBpcyBjb252b2x1dGVkLgogICAgICAvLyBodHRwczovL3czYy5naXRodWIuaW8vd2ViY29tcG9uZW50cy9zcGVjL2N1c3RvbS8jY3VzdG9tLWVsZW1lbnRzLWNvcmUtY29uY2VwdHMKICAgICAgY2FzZSAnYW5ub3RhdGlvbi14bWwnOgogICAgICBjYXNlICdjb2xvci1wcm9maWxlJzoKICAgICAgY2FzZSAnZm9udC1mYWNlJzoKICAgICAgY2FzZSAnZm9udC1mYWNlLXNyYyc6CiAgICAgIGNhc2UgJ2ZvbnQtZmFjZS11cmknOgogICAgICBjYXNlICdmb250LWZhY2UtZm9ybWF0JzoKICAgICAgY2FzZSAnZm9udC1mYWNlLW5hbWUnOgogICAgICBjYXNlICdtaXNzaW5nLWdseXBoJzoKICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICBkZWZhdWx0OgogICAgICAgIHJldHVybiB0cnVlOwogICAgfQogIH0KCiAgLy8gV2hlbiBhZGRpbmcgYXR0cmlidXRlcyB0byB0aGUgSFRNTCBvciBTVkcgYWxsb3dlZCBhdHRyaWJ1dGUgbGlzdCwgYmUgc3VyZSB0bwogIC8vIGFsc28gYWRkIHRoZW0gdG8gdGhpcyBtb2R1bGUgdG8gZW5zdXJlIGNhc2luZyBhbmQgaW5jb3JyZWN0IG5hbWUKICAvLyB3YXJuaW5ncy4KICB2YXIgcG9zc2libGVTdGFuZGFyZE5hbWVzID0gewogICAgLy8gSFRNTAogICAgYWNjZXB0OiAnYWNjZXB0JywKICAgIGFjY2VwdGNoYXJzZXQ6ICdhY2NlcHRDaGFyc2V0JywKICAgICdhY2NlcHQtY2hhcnNldCc6ICdhY2NlcHRDaGFyc2V0JywKICAgIGFjY2Vzc2tleTogJ2FjY2Vzc0tleScsCiAgICBhY3Rpb246ICdhY3Rpb24nLAogICAgYWxsb3dmdWxsc2NyZWVuOiAnYWxsb3dGdWxsU2NyZWVuJywKICAgIGFsdDogJ2FsdCcsCiAgICBhczogJ2FzJywKICAgIGFzeW5jOiAnYXN5bmMnLAogICAgYXV0b2NhcGl0YWxpemU6ICdhdXRvQ2FwaXRhbGl6ZScsCiAgICBhdXRvY29tcGxldGU6ICdhdXRvQ29tcGxldGUnLAogICAgYXV0b2NvcnJlY3Q6ICdhdXRvQ29ycmVjdCcsCiAgICBhdXRvZm9jdXM6ICdhdXRvRm9jdXMnLAogICAgYXV0b3BsYXk6ICdhdXRvUGxheScsCiAgICBhdXRvc2F2ZTogJ2F1dG9TYXZlJywKICAgIGNhcHR1cmU6ICdjYXB0dXJlJywKICAgIGNlbGxwYWRkaW5nOiAnY2VsbFBhZGRpbmcnLAogICAgY2VsbHNwYWNpbmc6ICdjZWxsU3BhY2luZycsCiAgICBjaGFsbGVuZ2U6ICdjaGFsbGVuZ2UnLAogICAgY2hhcnNldDogJ2NoYXJTZXQnLAogICAgY2hlY2tlZDogJ2NoZWNrZWQnLAogICAgY2hpbGRyZW46ICdjaGlsZHJlbicsCiAgICBjaXRlOiAnY2l0ZScsCiAgICBjbGFzczogJ2NsYXNzTmFtZScsCiAgICBjbGFzc2lkOiAnY2xhc3NJRCcsCiAgICBjbGFzc25hbWU6ICdjbGFzc05hbWUnLAogICAgY29sczogJ2NvbHMnLAogICAgY29sc3BhbjogJ2NvbFNwYW4nLAogICAgY29udGVudDogJ2NvbnRlbnQnLAogICAgY29udGVudGVkaXRhYmxlOiAnY29udGVudEVkaXRhYmxlJywKICAgIGNvbnRleHRtZW51OiAnY29udGV4dE1lbnUnLAogICAgY29udHJvbHM6ICdjb250cm9scycsCiAgICBjb250cm9sc2xpc3Q6ICdjb250cm9sc0xpc3QnLAogICAgY29vcmRzOiAnY29vcmRzJywKICAgIGNyb3Nzb3JpZ2luOiAnY3Jvc3NPcmlnaW4nLAogICAgZGFuZ2Vyb3VzbHlzZXRpbm5lcmh0bWw6ICdkYW5nZXJvdXNseVNldElubmVySFRNTCcsCiAgICBkYXRhOiAnZGF0YScsCiAgICBkYXRldGltZTogJ2RhdGVUaW1lJywKICAgIGRlZmF1bHQ6ICdkZWZhdWx0JywKICAgIGRlZmF1bHRjaGVja2VkOiAnZGVmYXVsdENoZWNrZWQnLAogICAgZGVmYXVsdHZhbHVlOiAnZGVmYXVsdFZhbHVlJywKICAgIGRlZmVyOiAnZGVmZXInLAogICAgZGlyOiAnZGlyJywKICAgIGRpc2FibGVkOiAnZGlzYWJsZWQnLAogICAgZGlzYWJsZXBpY3R1cmVpbnBpY3R1cmU6ICdkaXNhYmxlUGljdHVyZUluUGljdHVyZScsCiAgICBkaXNhYmxlcmVtb3RlcGxheWJhY2s6ICdkaXNhYmxlUmVtb3RlUGxheWJhY2snLAogICAgZG93bmxvYWQ6ICdkb3dubG9hZCcsCiAgICBkcmFnZ2FibGU6ICdkcmFnZ2FibGUnLAogICAgZW5jdHlwZTogJ2VuY1R5cGUnLAogICAgZW50ZXJrZXloaW50OiAnZW50ZXJLZXlIaW50JywKICAgIGZvcjogJ2h0bWxGb3InLAogICAgZm9ybTogJ2Zvcm0nLAogICAgZm9ybW1ldGhvZDogJ2Zvcm1NZXRob2QnLAogICAgZm9ybWFjdGlvbjogJ2Zvcm1BY3Rpb24nLAogICAgZm9ybWVuY3R5cGU6ICdmb3JtRW5jVHlwZScsCiAgICBmb3Jtbm92YWxpZGF0ZTogJ2Zvcm1Ob1ZhbGlkYXRlJywKICAgIGZvcm10YXJnZXQ6ICdmb3JtVGFyZ2V0JywKICAgIGZyYW1lYm9yZGVyOiAnZnJhbWVCb3JkZXInLAogICAgaGVhZGVyczogJ2hlYWRlcnMnLAogICAgaGVpZ2h0OiAnaGVpZ2h0JywKICAgIGhpZGRlbjogJ2hpZGRlbicsCiAgICBoaWdoOiAnaGlnaCcsCiAgICBocmVmOiAnaHJlZicsCiAgICBocmVmbGFuZzogJ2hyZWZMYW5nJywKICAgIGh0bWxmb3I6ICdodG1sRm9yJywKICAgIGh0dHBlcXVpdjogJ2h0dHBFcXVpdicsCiAgICAnaHR0cC1lcXVpdic6ICdodHRwRXF1aXYnLAogICAgaWNvbjogJ2ljb24nLAogICAgaWQ6ICdpZCcsCiAgICBpbWFnZXNpemVzOiAnaW1hZ2VTaXplcycsCiAgICBpbWFnZXNyY3NldDogJ2ltYWdlU3JjU2V0JywKICAgIGlubmVyaHRtbDogJ2lubmVySFRNTCcsCiAgICBpbnB1dG1vZGU6ICdpbnB1dE1vZGUnLAogICAgaW50ZWdyaXR5OiAnaW50ZWdyaXR5JywKICAgIGlzOiAnaXMnLAogICAgaXRlbWlkOiAnaXRlbUlEJywKICAgIGl0ZW1wcm9wOiAnaXRlbVByb3AnLAogICAgaXRlbXJlZjogJ2l0ZW1SZWYnLAogICAgaXRlbXNjb3BlOiAnaXRlbVNjb3BlJywKICAgIGl0ZW10eXBlOiAnaXRlbVR5cGUnLAogICAga2V5cGFyYW1zOiAna2V5UGFyYW1zJywKICAgIGtleXR5cGU6ICdrZXlUeXBlJywKICAgIGtpbmQ6ICdraW5kJywKICAgIGxhYmVsOiAnbGFiZWwnLAogICAgbGFuZzogJ2xhbmcnLAogICAgbGlzdDogJ2xpc3QnLAogICAgbG9vcDogJ2xvb3AnLAogICAgbG93OiAnbG93JywKICAgIG1hbmlmZXN0OiAnbWFuaWZlc3QnLAogICAgbWFyZ2lud2lkdGg6ICdtYXJnaW5XaWR0aCcsCiAgICBtYXJnaW5oZWlnaHQ6ICdtYXJnaW5IZWlnaHQnLAogICAgbWF4OiAnbWF4JywKICAgIG1heGxlbmd0aDogJ21heExlbmd0aCcsCiAgICBtZWRpYTogJ21lZGlhJywKICAgIG1lZGlhZ3JvdXA6ICdtZWRpYUdyb3VwJywKICAgIG1ldGhvZDogJ21ldGhvZCcsCiAgICBtaW46ICdtaW4nLAogICAgbWlubGVuZ3RoOiAnbWluTGVuZ3RoJywKICAgIG11bHRpcGxlOiAnbXVsdGlwbGUnLAogICAgbXV0ZWQ6ICdtdXRlZCcsCiAgICBuYW1lOiAnbmFtZScsCiAgICBub21vZHVsZTogJ25vTW9kdWxlJywKICAgIG5vbmNlOiAnbm9uY2UnLAogICAgbm92YWxpZGF0ZTogJ25vVmFsaWRhdGUnLAogICAgb3BlbjogJ29wZW4nLAogICAgb3B0aW11bTogJ29wdGltdW0nLAogICAgcGF0dGVybjogJ3BhdHRlcm4nLAogICAgcGxhY2Vob2xkZXI6ICdwbGFjZWhvbGRlcicsCiAgICBwbGF5c2lubGluZTogJ3BsYXlzSW5saW5lJywKICAgIHBvc3RlcjogJ3Bvc3RlcicsCiAgICBwcmVsb2FkOiAncHJlbG9hZCcsCiAgICBwcm9maWxlOiAncHJvZmlsZScsCiAgICByYWRpb2dyb3VwOiAncmFkaW9Hcm91cCcsCiAgICByZWFkb25seTogJ3JlYWRPbmx5JywKICAgIHJlZmVycmVycG9saWN5OiAncmVmZXJyZXJQb2xpY3knLAogICAgcmVsOiAncmVsJywKICAgIHJlcXVpcmVkOiAncmVxdWlyZWQnLAogICAgcmV2ZXJzZWQ6ICdyZXZlcnNlZCcsCiAgICByb2xlOiAncm9sZScsCiAgICByb3dzOiAncm93cycsCiAgICByb3dzcGFuOiAncm93U3BhbicsCiAgICBzYW5kYm94OiAnc2FuZGJveCcsCiAgICBzY29wZTogJ3Njb3BlJywKICAgIHNjb3BlZDogJ3Njb3BlZCcsCiAgICBzY3JvbGxpbmc6ICdzY3JvbGxpbmcnLAogICAgc2VhbWxlc3M6ICdzZWFtbGVzcycsCiAgICBzZWxlY3RlZDogJ3NlbGVjdGVkJywKICAgIHNoYXBlOiAnc2hhcGUnLAogICAgc2l6ZTogJ3NpemUnLAogICAgc2l6ZXM6ICdzaXplcycsCiAgICBzcGFuOiAnc3BhbicsCiAgICBzcGVsbGNoZWNrOiAnc3BlbGxDaGVjaycsCiAgICBzcmM6ICdzcmMnLAogICAgc3JjZG9jOiAnc3JjRG9jJywKICAgIHNyY2xhbmc6ICdzcmNMYW5nJywKICAgIHNyY3NldDogJ3NyY1NldCcsCiAgICBzdGFydDogJ3N0YXJ0JywKICAgIHN0ZXA6ICdzdGVwJywKICAgIHN0eWxlOiAnc3R5bGUnLAogICAgc3VtbWFyeTogJ3N1bW1hcnknLAogICAgdGFiaW5kZXg6ICd0YWJJbmRleCcsCiAgICB0YXJnZXQ6ICd0YXJnZXQnLAogICAgdGl0bGU6ICd0aXRsZScsCiAgICB0eXBlOiAndHlwZScsCiAgICB1c2VtYXA6ICd1c2VNYXAnLAogICAgdmFsdWU6ICd2YWx1ZScsCiAgICB3aWR0aDogJ3dpZHRoJywKICAgIHdtb2RlOiAnd21vZGUnLAogICAgd3JhcDogJ3dyYXAnLAogICAgLy8gU1ZHCiAgICBhYm91dDogJ2Fib3V0JywKICAgIGFjY2VudGhlaWdodDogJ2FjY2VudEhlaWdodCcsCiAgICAnYWNjZW50LWhlaWdodCc6ICdhY2NlbnRIZWlnaHQnLAogICAgYWNjdW11bGF0ZTogJ2FjY3VtdWxhdGUnLAogICAgYWRkaXRpdmU6ICdhZGRpdGl2ZScsCiAgICBhbGlnbm1lbnRiYXNlbGluZTogJ2FsaWdubWVudEJhc2VsaW5lJywKICAgICdhbGlnbm1lbnQtYmFzZWxpbmUnOiAnYWxpZ25tZW50QmFzZWxpbmUnLAogICAgYWxsb3dyZW9yZGVyOiAnYWxsb3dSZW9yZGVyJywKICAgIGFscGhhYmV0aWM6ICdhbHBoYWJldGljJywKICAgIGFtcGxpdHVkZTogJ2FtcGxpdHVkZScsCiAgICBhcmFiaWNmb3JtOiAnYXJhYmljRm9ybScsCiAgICAnYXJhYmljLWZvcm0nOiAnYXJhYmljRm9ybScsCiAgICBhc2NlbnQ6ICdhc2NlbnQnLAogICAgYXR0cmlidXRlbmFtZTogJ2F0dHJpYnV0ZU5hbWUnLAogICAgYXR0cmlidXRldHlwZTogJ2F0dHJpYnV0ZVR5cGUnLAogICAgYXV0b3JldmVyc2U6ICdhdXRvUmV2ZXJzZScsCiAgICBhemltdXRoOiAnYXppbXV0aCcsCiAgICBiYXNlZnJlcXVlbmN5OiAnYmFzZUZyZXF1ZW5jeScsCiAgICBiYXNlbGluZXNoaWZ0OiAnYmFzZWxpbmVTaGlmdCcsCiAgICAnYmFzZWxpbmUtc2hpZnQnOiAnYmFzZWxpbmVTaGlmdCcsCiAgICBiYXNlcHJvZmlsZTogJ2Jhc2VQcm9maWxlJywKICAgIGJib3g6ICdiYm94JywKICAgIGJlZ2luOiAnYmVnaW4nLAogICAgYmlhczogJ2JpYXMnLAogICAgYnk6ICdieScsCiAgICBjYWxjbW9kZTogJ2NhbGNNb2RlJywKICAgIGNhcGhlaWdodDogJ2NhcEhlaWdodCcsCiAgICAnY2FwLWhlaWdodCc6ICdjYXBIZWlnaHQnLAogICAgY2xpcDogJ2NsaXAnLAogICAgY2xpcHBhdGg6ICdjbGlwUGF0aCcsCiAgICAnY2xpcC1wYXRoJzogJ2NsaXBQYXRoJywKICAgIGNsaXBwYXRodW5pdHM6ICdjbGlwUGF0aFVuaXRzJywKICAgIGNsaXBydWxlOiAnY2xpcFJ1bGUnLAogICAgJ2NsaXAtcnVsZSc6ICdjbGlwUnVsZScsCiAgICBjb2xvcjogJ2NvbG9yJywKICAgIGNvbG9yaW50ZXJwb2xhdGlvbjogJ2NvbG9ySW50ZXJwb2xhdGlvbicsCiAgICAnY29sb3ItaW50ZXJwb2xhdGlvbic6ICdjb2xvckludGVycG9sYXRpb24nLAogICAgY29sb3JpbnRlcnBvbGF0aW9uZmlsdGVyczogJ2NvbG9ySW50ZXJwb2xhdGlvbkZpbHRlcnMnLAogICAgJ2NvbG9yLWludGVycG9sYXRpb24tZmlsdGVycyc6ICdjb2xvckludGVycG9sYXRpb25GaWx0ZXJzJywKICAgIGNvbG9ycHJvZmlsZTogJ2NvbG9yUHJvZmlsZScsCiAgICAnY29sb3ItcHJvZmlsZSc6ICdjb2xvclByb2ZpbGUnLAogICAgY29sb3JyZW5kZXJpbmc6ICdjb2xvclJlbmRlcmluZycsCiAgICAnY29sb3ItcmVuZGVyaW5nJzogJ2NvbG9yUmVuZGVyaW5nJywKICAgIGNvbnRlbnRzY3JpcHR0eXBlOiAnY29udGVudFNjcmlwdFR5cGUnLAogICAgY29udGVudHN0eWxldHlwZTogJ2NvbnRlbnRTdHlsZVR5cGUnLAogICAgY3Vyc29yOiAnY3Vyc29yJywKICAgIGN4OiAnY3gnLAogICAgY3k6ICdjeScsCiAgICBkOiAnZCcsCiAgICBkYXRhdHlwZTogJ2RhdGF0eXBlJywKICAgIGRlY2VsZXJhdGU6ICdkZWNlbGVyYXRlJywKICAgIGRlc2NlbnQ6ICdkZXNjZW50JywKICAgIGRpZmZ1c2Vjb25zdGFudDogJ2RpZmZ1c2VDb25zdGFudCcsCiAgICBkaXJlY3Rpb246ICdkaXJlY3Rpb24nLAogICAgZGlzcGxheTogJ2Rpc3BsYXknLAogICAgZGl2aXNvcjogJ2Rpdmlzb3InLAogICAgZG9taW5hbnRiYXNlbGluZTogJ2RvbWluYW50QmFzZWxpbmUnLAogICAgJ2RvbWluYW50LWJhc2VsaW5lJzogJ2RvbWluYW50QmFzZWxpbmUnLAogICAgZHVyOiAnZHVyJywKICAgIGR4OiAnZHgnLAogICAgZHk6ICdkeScsCiAgICBlZGdlbW9kZTogJ2VkZ2VNb2RlJywKICAgIGVsZXZhdGlvbjogJ2VsZXZhdGlvbicsCiAgICBlbmFibGViYWNrZ3JvdW5kOiAnZW5hYmxlQmFja2dyb3VuZCcsCiAgICAnZW5hYmxlLWJhY2tncm91bmQnOiAnZW5hYmxlQmFja2dyb3VuZCcsCiAgICBlbmQ6ICdlbmQnLAogICAgZXhwb25lbnQ6ICdleHBvbmVudCcsCiAgICBleHRlcm5hbHJlc291cmNlc3JlcXVpcmVkOiAnZXh0ZXJuYWxSZXNvdXJjZXNSZXF1aXJlZCcsCiAgICBmaWxsOiAnZmlsbCcsCiAgICBmaWxsb3BhY2l0eTogJ2ZpbGxPcGFjaXR5JywKICAgICdmaWxsLW9wYWNpdHknOiAnZmlsbE9wYWNpdHknLAogICAgZmlsbHJ1bGU6ICdmaWxsUnVsZScsCiAgICAnZmlsbC1ydWxlJzogJ2ZpbGxSdWxlJywKICAgIGZpbHRlcjogJ2ZpbHRlcicsCiAgICBmaWx0ZXJyZXM6ICdmaWx0ZXJSZXMnLAogICAgZmlsdGVydW5pdHM6ICdmaWx0ZXJVbml0cycsCiAgICBmbG9vZG9wYWNpdHk6ICdmbG9vZE9wYWNpdHknLAogICAgJ2Zsb29kLW9wYWNpdHknOiAnZmxvb2RPcGFjaXR5JywKICAgIGZsb29kY29sb3I6ICdmbG9vZENvbG9yJywKICAgICdmbG9vZC1jb2xvcic6ICdmbG9vZENvbG9yJywKICAgIGZvY3VzYWJsZTogJ2ZvY3VzYWJsZScsCiAgICBmb250ZmFtaWx5OiAnZm9udEZhbWlseScsCiAgICAnZm9udC1mYW1pbHknOiAnZm9udEZhbWlseScsCiAgICBmb250c2l6ZTogJ2ZvbnRTaXplJywKICAgICdmb250LXNpemUnOiAnZm9udFNpemUnLAogICAgZm9udHNpemVhZGp1c3Q6ICdmb250U2l6ZUFkanVzdCcsCiAgICAnZm9udC1zaXplLWFkanVzdCc6ICdmb250U2l6ZUFkanVzdCcsCiAgICBmb250c3RyZXRjaDogJ2ZvbnRTdHJldGNoJywKICAgICdmb250LXN0cmV0Y2gnOiAnZm9udFN0cmV0Y2gnLAogICAgZm9udHN0eWxlOiAnZm9udFN0eWxlJywKICAgICdmb250LXN0eWxlJzogJ2ZvbnRTdHlsZScsCiAgICBmb250dmFyaWFudDogJ2ZvbnRWYXJpYW50JywKICAgICdmb250LXZhcmlhbnQnOiAnZm9udFZhcmlhbnQnLAogICAgZm9udHdlaWdodDogJ2ZvbnRXZWlnaHQnLAogICAgJ2ZvbnQtd2VpZ2h0JzogJ2ZvbnRXZWlnaHQnLAogICAgZm9ybWF0OiAnZm9ybWF0JywKICAgIGZyb206ICdmcm9tJywKICAgIGZ4OiAnZngnLAogICAgZnk6ICdmeScsCiAgICBnMTogJ2cxJywKICAgIGcyOiAnZzInLAogICAgZ2x5cGhuYW1lOiAnZ2x5cGhOYW1lJywKICAgICdnbHlwaC1uYW1lJzogJ2dseXBoTmFtZScsCiAgICBnbHlwaG9yaWVudGF0aW9uaG9yaXpvbnRhbDogJ2dseXBoT3JpZW50YXRpb25Ib3Jpem9udGFsJywKICAgICdnbHlwaC1vcmllbnRhdGlvbi1ob3Jpem9udGFsJzogJ2dseXBoT3JpZW50YXRpb25Ib3Jpem9udGFsJywKICAgIGdseXBob3JpZW50YXRpb252ZXJ0aWNhbDogJ2dseXBoT3JpZW50YXRpb25WZXJ0aWNhbCcsCiAgICAnZ2x5cGgtb3JpZW50YXRpb24tdmVydGljYWwnOiAnZ2x5cGhPcmllbnRhdGlvblZlcnRpY2FsJywKICAgIGdseXBocmVmOiAnZ2x5cGhSZWYnLAogICAgZ3JhZGllbnR0cmFuc2Zvcm06ICdncmFkaWVudFRyYW5zZm9ybScsCiAgICBncmFkaWVudHVuaXRzOiAnZ3JhZGllbnRVbml0cycsCiAgICBoYW5naW5nOiAnaGFuZ2luZycsCiAgICBob3JpemFkdng6ICdob3JpekFkdlgnLAogICAgJ2hvcml6LWFkdi14JzogJ2hvcml6QWR2WCcsCiAgICBob3Jpem9yaWdpbng6ICdob3Jpek9yaWdpblgnLAogICAgJ2hvcml6LW9yaWdpbi14JzogJ2hvcml6T3JpZ2luWCcsCiAgICBpZGVvZ3JhcGhpYzogJ2lkZW9ncmFwaGljJywKICAgIGltYWdlcmVuZGVyaW5nOiAnaW1hZ2VSZW5kZXJpbmcnLAogICAgJ2ltYWdlLXJlbmRlcmluZyc6ICdpbWFnZVJlbmRlcmluZycsCiAgICBpbjI6ICdpbjInLAogICAgaW46ICdpbicsCiAgICBpbmxpc3Q6ICdpbmxpc3QnLAogICAgaW50ZXJjZXB0OiAnaW50ZXJjZXB0JywKICAgIGsxOiAnazEnLAogICAgazI6ICdrMicsCiAgICBrMzogJ2szJywKICAgIGs0OiAnazQnLAogICAgazogJ2snLAogICAga2VybmVsbWF0cml4OiAna2VybmVsTWF0cml4JywKICAgIGtlcm5lbHVuaXRsZW5ndGg6ICdrZXJuZWxVbml0TGVuZ3RoJywKICAgIGtlcm5pbmc6ICdrZXJuaW5nJywKICAgIGtleXBvaW50czogJ2tleVBvaW50cycsCiAgICBrZXlzcGxpbmVzOiAna2V5U3BsaW5lcycsCiAgICBrZXl0aW1lczogJ2tleVRpbWVzJywKICAgIGxlbmd0aGFkanVzdDogJ2xlbmd0aEFkanVzdCcsCiAgICBsZXR0ZXJzcGFjaW5nOiAnbGV0dGVyU3BhY2luZycsCiAgICAnbGV0dGVyLXNwYWNpbmcnOiAnbGV0dGVyU3BhY2luZycsCiAgICBsaWdodGluZ2NvbG9yOiAnbGlnaHRpbmdDb2xvcicsCiAgICAnbGlnaHRpbmctY29sb3InOiAnbGlnaHRpbmdDb2xvcicsCiAgICBsaW1pdGluZ2NvbmVhbmdsZTogJ2xpbWl0aW5nQ29uZUFuZ2xlJywKICAgIGxvY2FsOiAnbG9jYWwnLAogICAgbWFya2VyZW5kOiAnbWFya2VyRW5kJywKICAgICdtYXJrZXItZW5kJzogJ21hcmtlckVuZCcsCiAgICBtYXJrZXJoZWlnaHQ6ICdtYXJrZXJIZWlnaHQnLAogICAgbWFya2VybWlkOiAnbWFya2VyTWlkJywKICAgICdtYXJrZXItbWlkJzogJ21hcmtlck1pZCcsCiAgICBtYXJrZXJzdGFydDogJ21hcmtlclN0YXJ0JywKICAgICdtYXJrZXItc3RhcnQnOiAnbWFya2VyU3RhcnQnLAogICAgbWFya2VydW5pdHM6ICdtYXJrZXJVbml0cycsCiAgICBtYXJrZXJ3aWR0aDogJ21hcmtlcldpZHRoJywKICAgIG1hc2s6ICdtYXNrJywKICAgIG1hc2tjb250ZW50dW5pdHM6ICdtYXNrQ29udGVudFVuaXRzJywKICAgIG1hc2t1bml0czogJ21hc2tVbml0cycsCiAgICBtYXRoZW1hdGljYWw6ICdtYXRoZW1hdGljYWwnLAogICAgbW9kZTogJ21vZGUnLAogICAgbnVtb2N0YXZlczogJ251bU9jdGF2ZXMnLAogICAgb2Zmc2V0OiAnb2Zmc2V0JywKICAgIG9wYWNpdHk6ICdvcGFjaXR5JywKICAgIG9wZXJhdG9yOiAnb3BlcmF0b3InLAogICAgb3JkZXI6ICdvcmRlcicsCiAgICBvcmllbnQ6ICdvcmllbnQnLAogICAgb3JpZW50YXRpb246ICdvcmllbnRhdGlvbicsCiAgICBvcmlnaW46ICdvcmlnaW4nLAogICAgb3ZlcmZsb3c6ICdvdmVyZmxvdycsCiAgICBvdmVybGluZXBvc2l0aW9uOiAnb3ZlcmxpbmVQb3NpdGlvbicsCiAgICAnb3ZlcmxpbmUtcG9zaXRpb24nOiAnb3ZlcmxpbmVQb3NpdGlvbicsCiAgICBvdmVybGluZXRoaWNrbmVzczogJ292ZXJsaW5lVGhpY2tuZXNzJywKICAgICdvdmVybGluZS10aGlja25lc3MnOiAnb3ZlcmxpbmVUaGlja25lc3MnLAogICAgcGFpbnRvcmRlcjogJ3BhaW50T3JkZXInLAogICAgJ3BhaW50LW9yZGVyJzogJ3BhaW50T3JkZXInLAogICAgcGFub3NlMTogJ3Bhbm9zZTEnLAogICAgJ3Bhbm9zZS0xJzogJ3Bhbm9zZTEnLAogICAgcGF0aGxlbmd0aDogJ3BhdGhMZW5ndGgnLAogICAgcGF0dGVybmNvbnRlbnR1bml0czogJ3BhdHRlcm5Db250ZW50VW5pdHMnLAogICAgcGF0dGVybnRyYW5zZm9ybTogJ3BhdHRlcm5UcmFuc2Zvcm0nLAogICAgcGF0dGVybnVuaXRzOiAncGF0dGVyblVuaXRzJywKICAgIHBvaW50ZXJldmVudHM6ICdwb2ludGVyRXZlbnRzJywKICAgICdwb2ludGVyLWV2ZW50cyc6ICdwb2ludGVyRXZlbnRzJywKICAgIHBvaW50czogJ3BvaW50cycsCiAgICBwb2ludHNhdHg6ICdwb2ludHNBdFgnLAogICAgcG9pbnRzYXR5OiAncG9pbnRzQXRZJywKICAgIHBvaW50c2F0ejogJ3BvaW50c0F0WicsCiAgICBwcmVmaXg6ICdwcmVmaXgnLAogICAgcHJlc2VydmVhbHBoYTogJ3ByZXNlcnZlQWxwaGEnLAogICAgcHJlc2VydmVhc3BlY3RyYXRpbzogJ3ByZXNlcnZlQXNwZWN0UmF0aW8nLAogICAgcHJpbWl0aXZldW5pdHM6ICdwcmltaXRpdmVVbml0cycsCiAgICBwcm9wZXJ0eTogJ3Byb3BlcnR5JywKICAgIHI6ICdyJywKICAgIHJhZGl1czogJ3JhZGl1cycsCiAgICByZWZ4OiAncmVmWCcsCiAgICByZWZ5OiAncmVmWScsCiAgICByZW5kZXJpbmdpbnRlbnQ6ICdyZW5kZXJpbmdJbnRlbnQnLAogICAgJ3JlbmRlcmluZy1pbnRlbnQnOiAncmVuZGVyaW5nSW50ZW50JywKICAgIHJlcGVhdGNvdW50OiAncmVwZWF0Q291bnQnLAogICAgcmVwZWF0ZHVyOiAncmVwZWF0RHVyJywKICAgIHJlcXVpcmVkZXh0ZW5zaW9uczogJ3JlcXVpcmVkRXh0ZW5zaW9ucycsCiAgICByZXF1aXJlZGZlYXR1cmVzOiAncmVxdWlyZWRGZWF0dXJlcycsCiAgICByZXNvdXJjZTogJ3Jlc291cmNlJywKICAgIHJlc3RhcnQ6ICdyZXN0YXJ0JywKICAgIHJlc3VsdDogJ3Jlc3VsdCcsCiAgICByZXN1bHRzOiAncmVzdWx0cycsCiAgICByb3RhdGU6ICdyb3RhdGUnLAogICAgcng6ICdyeCcsCiAgICByeTogJ3J5JywKICAgIHNjYWxlOiAnc2NhbGUnLAogICAgc2VjdXJpdHk6ICdzZWN1cml0eScsCiAgICBzZWVkOiAnc2VlZCcsCiAgICBzaGFwZXJlbmRlcmluZzogJ3NoYXBlUmVuZGVyaW5nJywKICAgICdzaGFwZS1yZW5kZXJpbmcnOiAnc2hhcGVSZW5kZXJpbmcnLAogICAgc2xvcGU6ICdzbG9wZScsCiAgICBzcGFjaW5nOiAnc3BhY2luZycsCiAgICBzcGVjdWxhcmNvbnN0YW50OiAnc3BlY3VsYXJDb25zdGFudCcsCiAgICBzcGVjdWxhcmV4cG9uZW50OiAnc3BlY3VsYXJFeHBvbmVudCcsCiAgICBzcGVlZDogJ3NwZWVkJywKICAgIHNwcmVhZG1ldGhvZDogJ3NwcmVhZE1ldGhvZCcsCiAgICBzdGFydG9mZnNldDogJ3N0YXJ0T2Zmc2V0JywKICAgIHN0ZGRldmlhdGlvbjogJ3N0ZERldmlhdGlvbicsCiAgICBzdGVtaDogJ3N0ZW1oJywKICAgIHN0ZW12OiAnc3RlbXYnLAogICAgc3RpdGNodGlsZXM6ICdzdGl0Y2hUaWxlcycsCiAgICBzdG9wY29sb3I6ICdzdG9wQ29sb3InLAogICAgJ3N0b3AtY29sb3InOiAnc3RvcENvbG9yJywKICAgIHN0b3BvcGFjaXR5OiAnc3RvcE9wYWNpdHknLAogICAgJ3N0b3Atb3BhY2l0eSc6ICdzdG9wT3BhY2l0eScsCiAgICBzdHJpa2V0aHJvdWdocG9zaXRpb246ICdzdHJpa2V0aHJvdWdoUG9zaXRpb24nLAogICAgJ3N0cmlrZXRocm91Z2gtcG9zaXRpb24nOiAnc3RyaWtldGhyb3VnaFBvc2l0aW9uJywKICAgIHN0cmlrZXRocm91Z2h0aGlja25lc3M6ICdzdHJpa2V0aHJvdWdoVGhpY2tuZXNzJywKICAgICdzdHJpa2V0aHJvdWdoLXRoaWNrbmVzcyc6ICdzdHJpa2V0aHJvdWdoVGhpY2tuZXNzJywKICAgIHN0cmluZzogJ3N0cmluZycsCiAgICBzdHJva2U6ICdzdHJva2UnLAogICAgc3Ryb2tlZGFzaGFycmF5OiAnc3Ryb2tlRGFzaGFycmF5JywKICAgICdzdHJva2UtZGFzaGFycmF5JzogJ3N0cm9rZURhc2hhcnJheScsCiAgICBzdHJva2VkYXNob2Zmc2V0OiAnc3Ryb2tlRGFzaG9mZnNldCcsCiAgICAnc3Ryb2tlLWRhc2hvZmZzZXQnOiAnc3Ryb2tlRGFzaG9mZnNldCcsCiAgICBzdHJva2VsaW5lY2FwOiAnc3Ryb2tlTGluZWNhcCcsCiAgICAnc3Ryb2tlLWxpbmVjYXAnOiAnc3Ryb2tlTGluZWNhcCcsCiAgICBzdHJva2VsaW5lam9pbjogJ3N0cm9rZUxpbmVqb2luJywKICAgICdzdHJva2UtbGluZWpvaW4nOiAnc3Ryb2tlTGluZWpvaW4nLAogICAgc3Ryb2tlbWl0ZXJsaW1pdDogJ3N0cm9rZU1pdGVybGltaXQnLAogICAgJ3N0cm9rZS1taXRlcmxpbWl0JzogJ3N0cm9rZU1pdGVybGltaXQnLAogICAgc3Ryb2tld2lkdGg6ICdzdHJva2VXaWR0aCcsCiAgICAnc3Ryb2tlLXdpZHRoJzogJ3N0cm9rZVdpZHRoJywKICAgIHN0cm9rZW9wYWNpdHk6ICdzdHJva2VPcGFjaXR5JywKICAgICdzdHJva2Utb3BhY2l0eSc6ICdzdHJva2VPcGFjaXR5JywKICAgIHN1cHByZXNzY29udGVudGVkaXRhYmxld2FybmluZzogJ3N1cHByZXNzQ29udGVudEVkaXRhYmxlV2FybmluZycsCiAgICBzdXBwcmVzc2h5ZHJhdGlvbndhcm5pbmc6ICdzdXBwcmVzc0h5ZHJhdGlvbldhcm5pbmcnLAogICAgc3VyZmFjZXNjYWxlOiAnc3VyZmFjZVNjYWxlJywKICAgIHN5c3RlbWxhbmd1YWdlOiAnc3lzdGVtTGFuZ3VhZ2UnLAogICAgdGFibGV2YWx1ZXM6ICd0YWJsZVZhbHVlcycsCiAgICB0YXJnZXR4OiAndGFyZ2V0WCcsCiAgICB0YXJnZXR5OiAndGFyZ2V0WScsCiAgICB0ZXh0YW5jaG9yOiAndGV4dEFuY2hvcicsCiAgICAndGV4dC1hbmNob3InOiAndGV4dEFuY2hvcicsCiAgICB0ZXh0ZGVjb3JhdGlvbjogJ3RleHREZWNvcmF0aW9uJywKICAgICd0ZXh0LWRlY29yYXRpb24nOiAndGV4dERlY29yYXRpb24nLAogICAgdGV4dGxlbmd0aDogJ3RleHRMZW5ndGgnLAogICAgdGV4dHJlbmRlcmluZzogJ3RleHRSZW5kZXJpbmcnLAogICAgJ3RleHQtcmVuZGVyaW5nJzogJ3RleHRSZW5kZXJpbmcnLAogICAgdG86ICd0bycsCiAgICB0cmFuc2Zvcm06ICd0cmFuc2Zvcm0nLAogICAgdHlwZW9mOiAndHlwZW9mJywKICAgIHUxOiAndTEnLAogICAgdTI6ICd1MicsCiAgICB1bmRlcmxpbmVwb3NpdGlvbjogJ3VuZGVybGluZVBvc2l0aW9uJywKICAgICd1bmRlcmxpbmUtcG9zaXRpb24nOiAndW5kZXJsaW5lUG9zaXRpb24nLAogICAgdW5kZXJsaW5ldGhpY2tuZXNzOiAndW5kZXJsaW5lVGhpY2tuZXNzJywKICAgICd1bmRlcmxpbmUtdGhpY2tuZXNzJzogJ3VuZGVybGluZVRoaWNrbmVzcycsCiAgICB1bmljb2RlOiAndW5pY29kZScsCiAgICB1bmljb2RlYmlkaTogJ3VuaWNvZGVCaWRpJywKICAgICd1bmljb2RlLWJpZGknOiAndW5pY29kZUJpZGknLAogICAgdW5pY29kZXJhbmdlOiAndW5pY29kZVJhbmdlJywKICAgICd1bmljb2RlLXJhbmdlJzogJ3VuaWNvZGVSYW5nZScsCiAgICB1bml0c3BlcmVtOiAndW5pdHNQZXJFbScsCiAgICAndW5pdHMtcGVyLWVtJzogJ3VuaXRzUGVyRW0nLAogICAgdW5zZWxlY3RhYmxlOiAndW5zZWxlY3RhYmxlJywKICAgIHZhbHBoYWJldGljOiAndkFscGhhYmV0aWMnLAogICAgJ3YtYWxwaGFiZXRpYyc6ICd2QWxwaGFiZXRpYycsCiAgICB2YWx1ZXM6ICd2YWx1ZXMnLAogICAgdmVjdG9yZWZmZWN0OiAndmVjdG9yRWZmZWN0JywKICAgICd2ZWN0b3ItZWZmZWN0JzogJ3ZlY3RvckVmZmVjdCcsCiAgICB2ZXJzaW9uOiAndmVyc2lvbicsCiAgICB2ZXJ0YWR2eTogJ3ZlcnRBZHZZJywKICAgICd2ZXJ0LWFkdi15JzogJ3ZlcnRBZHZZJywKICAgIHZlcnRvcmlnaW54OiAndmVydE9yaWdpblgnLAogICAgJ3ZlcnQtb3JpZ2luLXgnOiAndmVydE9yaWdpblgnLAogICAgdmVydG9yaWdpbnk6ICd2ZXJ0T3JpZ2luWScsCiAgICAndmVydC1vcmlnaW4teSc6ICd2ZXJ0T3JpZ2luWScsCiAgICB2aGFuZ2luZzogJ3ZIYW5naW5nJywKICAgICd2LWhhbmdpbmcnOiAndkhhbmdpbmcnLAogICAgdmlkZW9ncmFwaGljOiAndklkZW9ncmFwaGljJywKICAgICd2LWlkZW9ncmFwaGljJzogJ3ZJZGVvZ3JhcGhpYycsCiAgICB2aWV3Ym94OiAndmlld0JveCcsCiAgICB2aWV3dGFyZ2V0OiAndmlld1RhcmdldCcsCiAgICB2aXNpYmlsaXR5OiAndmlzaWJpbGl0eScsCiAgICB2bWF0aGVtYXRpY2FsOiAndk1hdGhlbWF0aWNhbCcsCiAgICAndi1tYXRoZW1hdGljYWwnOiAndk1hdGhlbWF0aWNhbCcsCiAgICB2b2NhYjogJ3ZvY2FiJywKICAgIHdpZHRoczogJ3dpZHRocycsCiAgICB3b3Jkc3BhY2luZzogJ3dvcmRTcGFjaW5nJywKICAgICd3b3JkLXNwYWNpbmcnOiAnd29yZFNwYWNpbmcnLAogICAgd3JpdGluZ21vZGU6ICd3cml0aW5nTW9kZScsCiAgICAnd3JpdGluZy1tb2RlJzogJ3dyaXRpbmdNb2RlJywKICAgIHgxOiAneDEnLAogICAgeDI6ICd4MicsCiAgICB4OiAneCcsCiAgICB4Y2hhbm5lbHNlbGVjdG9yOiAneENoYW5uZWxTZWxlY3RvcicsCiAgICB4aGVpZ2h0OiAneEhlaWdodCcsCiAgICAneC1oZWlnaHQnOiAneEhlaWdodCcsCiAgICB4bGlua2FjdHVhdGU6ICd4bGlua0FjdHVhdGUnLAogICAgJ3hsaW5rOmFjdHVhdGUnOiAneGxpbmtBY3R1YXRlJywKICAgIHhsaW5rYXJjcm9sZTogJ3hsaW5rQXJjcm9sZScsCiAgICAneGxpbms6YXJjcm9sZSc6ICd4bGlua0FyY3JvbGUnLAogICAgeGxpbmtocmVmOiAneGxpbmtIcmVmJywKICAgICd4bGluazpocmVmJzogJ3hsaW5rSHJlZicsCiAgICB4bGlua3JvbGU6ICd4bGlua1JvbGUnLAogICAgJ3hsaW5rOnJvbGUnOiAneGxpbmtSb2xlJywKICAgIHhsaW5rc2hvdzogJ3hsaW5rU2hvdycsCiAgICAneGxpbms6c2hvdyc6ICd4bGlua1Nob3cnLAogICAgeGxpbmt0aXRsZTogJ3hsaW5rVGl0bGUnLAogICAgJ3hsaW5rOnRpdGxlJzogJ3hsaW5rVGl0bGUnLAogICAgeGxpbmt0eXBlOiAneGxpbmtUeXBlJywKICAgICd4bGluazp0eXBlJzogJ3hsaW5rVHlwZScsCiAgICB4bWxiYXNlOiAneG1sQmFzZScsCiAgICAneG1sOmJhc2UnOiAneG1sQmFzZScsCiAgICB4bWxsYW5nOiAneG1sTGFuZycsCiAgICAneG1sOmxhbmcnOiAneG1sTGFuZycsCiAgICB4bWxuczogJ3htbG5zJywKICAgICd4bWw6c3BhY2UnOiAneG1sU3BhY2UnLAogICAgeG1sbnN4bGluazogJ3htbG5zWGxpbmsnLAogICAgJ3htbG5zOnhsaW5rJzogJ3htbG5zWGxpbmsnLAogICAgeG1sc3BhY2U6ICd4bWxTcGFjZScsCiAgICB5MTogJ3kxJywKICAgIHkyOiAneTInLAogICAgeTogJ3knLAogICAgeWNoYW5uZWxzZWxlY3RvcjogJ3lDaGFubmVsU2VsZWN0b3InLAogICAgejogJ3onLAogICAgem9vbWFuZHBhbjogJ3pvb21BbmRQYW4nCiAgfTsKCiAgdmFyIGFyaWFQcm9wZXJ0aWVzID0gewogICAgJ2FyaWEtY3VycmVudCc6IDAsCiAgICAvLyBzdGF0ZQogICAgJ2FyaWEtZGVzY3JpcHRpb24nOiAwLAogICAgJ2FyaWEtZGV0YWlscyc6IDAsCiAgICAnYXJpYS1kaXNhYmxlZCc6IDAsCiAgICAvLyBzdGF0ZQogICAgJ2FyaWEtaGlkZGVuJzogMCwKICAgIC8vIHN0YXRlCiAgICAnYXJpYS1pbnZhbGlkJzogMCwKICAgIC8vIHN0YXRlCiAgICAnYXJpYS1rZXlzaG9ydGN1dHMnOiAwLAogICAgJ2FyaWEtbGFiZWwnOiAwLAogICAgJ2FyaWEtcm9sZWRlc2NyaXB0aW9uJzogMCwKICAgIC8vIFdpZGdldCBBdHRyaWJ1dGVzCiAgICAnYXJpYS1hdXRvY29tcGxldGUnOiAwLAogICAgJ2FyaWEtY2hlY2tlZCc6IDAsCiAgICAnYXJpYS1leHBhbmRlZCc6IDAsCiAgICAnYXJpYS1oYXNwb3B1cCc6IDAsCiAgICAnYXJpYS1sZXZlbCc6IDAsCiAgICAnYXJpYS1tb2RhbCc6IDAsCiAgICAnYXJpYS1tdWx0aWxpbmUnOiAwLAogICAgJ2FyaWEtbXVsdGlzZWxlY3RhYmxlJzogMCwKICAgICdhcmlhLW9yaWVudGF0aW9uJzogMCwKICAgICdhcmlhLXBsYWNlaG9sZGVyJzogMCwKICAgICdhcmlhLXByZXNzZWQnOiAwLAogICAgJ2FyaWEtcmVhZG9ubHknOiAwLAogICAgJ2FyaWEtcmVxdWlyZWQnOiAwLAogICAgJ2FyaWEtc2VsZWN0ZWQnOiAwLAogICAgJ2FyaWEtc29ydCc6IDAsCiAgICAnYXJpYS12YWx1ZW1heCc6IDAsCiAgICAnYXJpYS12YWx1ZW1pbic6IDAsCiAgICAnYXJpYS12YWx1ZW5vdyc6IDAsCiAgICAnYXJpYS12YWx1ZXRleHQnOiAwLAogICAgLy8gTGl2ZSBSZWdpb24gQXR0cmlidXRlcwogICAgJ2FyaWEtYXRvbWljJzogMCwKICAgICdhcmlhLWJ1c3knOiAwLAogICAgJ2FyaWEtbGl2ZSc6IDAsCiAgICAnYXJpYS1yZWxldmFudCc6IDAsCiAgICAvLyBEcmFnLWFuZC1Ecm9wIEF0dHJpYnV0ZXMKICAgICdhcmlhLWRyb3BlZmZlY3QnOiAwLAogICAgJ2FyaWEtZ3JhYmJlZCc6IDAsCiAgICAvLyBSZWxhdGlvbnNoaXAgQXR0cmlidXRlcwogICAgJ2FyaWEtYWN0aXZlZGVzY2VuZGFudCc6IDAsCiAgICAnYXJpYS1jb2xjb3VudCc6IDAsCiAgICAnYXJpYS1jb2xpbmRleCc6IDAsCiAgICAnYXJpYS1jb2xzcGFuJzogMCwKICAgICdhcmlhLWNvbnRyb2xzJzogMCwKICAgICdhcmlhLWRlc2NyaWJlZGJ5JzogMCwKICAgICdhcmlhLWVycm9ybWVzc2FnZSc6IDAsCiAgICAnYXJpYS1mbG93dG8nOiAwLAogICAgJ2FyaWEtbGFiZWxsZWRieSc6IDAsCiAgICAnYXJpYS1vd25zJzogMCwKICAgICdhcmlhLXBvc2luc2V0JzogMCwKICAgICdhcmlhLXJvd2NvdW50JzogMCwKICAgICdhcmlhLXJvd2luZGV4JzogMCwKICAgICdhcmlhLXJvd3NwYW4nOiAwLAogICAgJ2FyaWEtc2V0c2l6ZSc6IDAKICB9OwoKICB2YXIgd2FybmVkUHJvcGVydGllcyA9IHt9OwogIHZhciByQVJJQSA9IG5ldyBSZWdFeHAoJ14oYXJpYSktWycgKyBBVFRSSUJVVEVfTkFNRV9DSEFSICsgJ10qJCcpOwogIHZhciByQVJJQUNhbWVsID0gbmV3IFJlZ0V4cCgnXihhcmlhKVtBLVpdWycgKyBBVFRSSUJVVEVfTkFNRV9DSEFSICsgJ10qJCcpOwoKICBmdW5jdGlvbiB2YWxpZGF0ZVByb3BlcnR5KHRhZ05hbWUsIG5hbWUpIHsKICAgIHsKICAgICAgaWYgKGhhc093blByb3BlcnR5LmNhbGwod2FybmVkUHJvcGVydGllcywgbmFtZSkgJiYgd2FybmVkUHJvcGVydGllc1tuYW1lXSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICBpZiAockFSSUFDYW1lbC50ZXN0KG5hbWUpKSB7CiAgICAgICAgdmFyIGFyaWFOYW1lID0gJ2FyaWEtJyArIG5hbWUuc2xpY2UoNCkudG9Mb3dlckNhc2UoKTsKICAgICAgICB2YXIgY29ycmVjdE5hbWUgPSBhcmlhUHJvcGVydGllcy5oYXNPd25Qcm9wZXJ0eShhcmlhTmFtZSkgPyBhcmlhTmFtZSA6IG51bGw7IC8vIElmIHRoaXMgaXMgYW4gYXJpYS0qIGF0dHJpYnV0ZSwgYnV0IGlzIG5vdCBsaXN0ZWQgaW4gdGhlIGtub3duIERPTQogICAgICAgIC8vIERPTSBwcm9wZXJ0aWVzLCB0aGVuIGl0IGlzIGFuIGludmFsaWQgYXJpYS0qIGF0dHJpYnV0ZS4KCiAgICAgICAgaWYgKGNvcnJlY3ROYW1lID09IG51bGwpIHsKICAgICAgICAgIGVycm9yKCdJbnZhbGlkIEFSSUEgYXR0cmlidXRlIGAlc2AuIEFSSUEgYXR0cmlidXRlcyBmb2xsb3cgdGhlIHBhdHRlcm4gYXJpYS0qIGFuZCBtdXN0IGJlIGxvd2VyY2FzZS4nLCBuYW1lKTsKCiAgICAgICAgICB3YXJuZWRQcm9wZXJ0aWVzW25hbWVdID0gdHJ1ZTsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gLy8gYXJpYS0qIGF0dHJpYnV0ZXMgc2hvdWxkIGJlIGxvd2VyY2FzZTsgc3VnZ2VzdCB0aGUgbG93ZXJjYXNlIHZlcnNpb24uCgoKICAgICAgICBpZiAobmFtZSAhPT0gY29ycmVjdE5hbWUpIHsKICAgICAgICAgIGVycm9yKCdJbnZhbGlkIEFSSUEgYXR0cmlidXRlIGAlc2AuIERpZCB5b3UgbWVhbiBgJXNgPycsIG5hbWUsIGNvcnJlY3ROYW1lKTsKCiAgICAgICAgICB3YXJuZWRQcm9wZXJ0aWVzW25hbWVdID0gdHJ1ZTsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHJBUklBLnRlc3QobmFtZSkpIHsKICAgICAgICB2YXIgbG93ZXJDYXNlZE5hbWUgPSBuYW1lLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgdmFyIHN0YW5kYXJkTmFtZSA9IGFyaWFQcm9wZXJ0aWVzLmhhc093blByb3BlcnR5KGxvd2VyQ2FzZWROYW1lKSA/IGxvd2VyQ2FzZWROYW1lIDogbnVsbDsgLy8gSWYgdGhpcyBpcyBhbiBhcmlhLSogYXR0cmlidXRlLCBidXQgaXMgbm90IGxpc3RlZCBpbiB0aGUga25vd24gRE9NCiAgICAgICAgLy8gRE9NIHByb3BlcnRpZXMsIHRoZW4gaXQgaXMgYW4gaW52YWxpZCBhcmlhLSogYXR0cmlidXRlLgoKICAgICAgICBpZiAoc3RhbmRhcmROYW1lID09IG51bGwpIHsKICAgICAgICAgIHdhcm5lZFByb3BlcnRpZXNbbmFtZV0gPSB0cnVlOwogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0gLy8gYXJpYS0qIGF0dHJpYnV0ZXMgc2hvdWxkIGJlIGxvd2VyY2FzZTsgc3VnZ2VzdCB0aGUgbG93ZXJjYXNlIHZlcnNpb24uCgoKICAgICAgICBpZiAobmFtZSAhPT0gc3RhbmRhcmROYW1lKSB7CiAgICAgICAgICBlcnJvcignVW5rbm93biBBUklBIGF0dHJpYnV0ZSBgJXNgLiBEaWQgeW91IG1lYW4gYCVzYD8nLCBuYW1lLCBzdGFuZGFyZE5hbWUpOwoKICAgICAgICAgIHdhcm5lZFByb3BlcnRpZXNbbmFtZV0gPSB0cnVlOwogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiB3YXJuSW52YWxpZEFSSUFQcm9wcyh0eXBlLCBwcm9wcykgewogICAgewogICAgICB2YXIgaW52YWxpZFByb3BzID0gW107CgogICAgICBmb3IgKHZhciBrZXkgaW4gcHJvcHMpIHsKICAgICAgICB2YXIgaXNWYWxpZCA9IHZhbGlkYXRlUHJvcGVydHkodHlwZSwga2V5KTsKCiAgICAgICAgaWYgKCFpc1ZhbGlkKSB7CiAgICAgICAgICBpbnZhbGlkUHJvcHMucHVzaChrZXkpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdmFyIHVua25vd25Qcm9wU3RyaW5nID0gaW52YWxpZFByb3BzLm1hcChmdW5jdGlvbiAocHJvcCkgewogICAgICAgIHJldHVybiAnYCcgKyBwcm9wICsgJ2AnOwogICAgICB9KS5qb2luKCcsICcpOwoKICAgICAgaWYgKGludmFsaWRQcm9wcy5sZW5ndGggPT09IDEpIHsKICAgICAgICBlcnJvcignSW52YWxpZCBhcmlhIHByb3AgJXMgb24gPCVzPiB0YWcuICcgKyAnRm9yIGRldGFpbHMsIHNlZSBodHRwczovL3JlYWN0anMub3JnL2xpbmsvaW52YWxpZC1hcmlhLXByb3BzJywgdW5rbm93blByb3BTdHJpbmcsIHR5cGUpOwogICAgICB9IGVsc2UgaWYgKGludmFsaWRQcm9wcy5sZW5ndGggPiAxKSB7CiAgICAgICAgZXJyb3IoJ0ludmFsaWQgYXJpYSBwcm9wcyAlcyBvbiA8JXM+IHRhZy4gJyArICdGb3IgZGV0YWlscywgc2VlIGh0dHBzOi8vcmVhY3Rqcy5vcmcvbGluay9pbnZhbGlkLWFyaWEtcHJvcHMnLCB1bmtub3duUHJvcFN0cmluZywgdHlwZSk7CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIHZhbGlkYXRlUHJvcGVydGllcyh0eXBlLCBwcm9wcykgewogICAgaWYgKGlzQ3VzdG9tQ29tcG9uZW50KHR5cGUsIHByb3BzKSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgd2FybkludmFsaWRBUklBUHJvcHModHlwZSwgcHJvcHMpOwogIH0KCiAgdmFyIGRpZFdhcm5WYWx1ZU51bGwgPSBmYWxzZTsKICBmdW5jdGlvbiB2YWxpZGF0ZVByb3BlcnRpZXMkMSh0eXBlLCBwcm9wcykgewogICAgewogICAgICBpZiAodHlwZSAhPT0gJ2lucHV0JyAmJiB0eXBlICE9PSAndGV4dGFyZWEnICYmIHR5cGUgIT09ICdzZWxlY3QnKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAocHJvcHMgIT0gbnVsbCAmJiBwcm9wcy52YWx1ZSA9PT0gbnVsbCAmJiAhZGlkV2FyblZhbHVlTnVsbCkgewogICAgICAgIGRpZFdhcm5WYWx1ZU51bGwgPSB0cnVlOwoKICAgICAgICBpZiAodHlwZSA9PT0gJ3NlbGVjdCcgJiYgcHJvcHMubXVsdGlwbGUpIHsKICAgICAgICAgIGVycm9yKCdgdmFsdWVgIHByb3Agb24gYCVzYCBzaG91bGQgbm90IGJlIG51bGwuICcgKyAnQ29uc2lkZXIgdXNpbmcgYW4gZW1wdHkgYXJyYXkgd2hlbiBgbXVsdGlwbGVgIGlzIHNldCB0byBgdHJ1ZWAgJyArICd0byBjbGVhciB0aGUgY29tcG9uZW50IG9yIGB1bmRlZmluZWRgIGZvciB1bmNvbnRyb2xsZWQgY29tcG9uZW50cy4nLCB0eXBlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZXJyb3IoJ2B2YWx1ZWAgcHJvcCBvbiBgJXNgIHNob3VsZCBub3QgYmUgbnVsbC4gJyArICdDb25zaWRlciB1c2luZyBhbiBlbXB0eSBzdHJpbmcgdG8gY2xlYXIgdGhlIGNvbXBvbmVudCBvciBgdW5kZWZpbmVkYCAnICsgJ2ZvciB1bmNvbnRyb2xsZWQgY29tcG9uZW50cy4nLCB0eXBlKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CgogIHZhciB2YWxpZGF0ZVByb3BlcnR5JDEgPSBmdW5jdGlvbiAoKSB7fTsKCiAgewogICAgdmFyIHdhcm5lZFByb3BlcnRpZXMkMSA9IHt9OwogICAgdmFyIEVWRU5UX05BTUVfUkVHRVggPSAvXm9uLi87CiAgICB2YXIgSU5WQUxJRF9FVkVOVF9OQU1FX1JFR0VYID0gL15vblteQS1aXS87CiAgICB2YXIgckFSSUEkMSA9IG5ldyBSZWdFeHAoJ14oYXJpYSktWycgKyBBVFRSSUJVVEVfTkFNRV9DSEFSICsgJ10qJCcpOwogICAgdmFyIHJBUklBQ2FtZWwkMSA9IG5ldyBSZWdFeHAoJ14oYXJpYSlbQS1aXVsnICsgQVRUUklCVVRFX05BTUVfQ0hBUiArICddKiQnKTsKCiAgICB2YWxpZGF0ZVByb3BlcnR5JDEgPSBmdW5jdGlvbiAodGFnTmFtZSwgbmFtZSwgdmFsdWUsIGV2ZW50UmVnaXN0cnkpIHsKICAgICAgaWYgKGhhc093blByb3BlcnR5LmNhbGwod2FybmVkUHJvcGVydGllcyQxLCBuYW1lKSAmJiB3YXJuZWRQcm9wZXJ0aWVzJDFbbmFtZV0pIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgdmFyIGxvd2VyQ2FzZWROYW1lID0gbmFtZS50b0xvd2VyQ2FzZSgpOwoKICAgICAgaWYgKGxvd2VyQ2FzZWROYW1lID09PSAnb25mb2N1c2luJyB8fCBsb3dlckNhc2VkTmFtZSA9PT0gJ29uZm9jdXNvdXQnKSB7CiAgICAgICAgZXJyb3IoJ1JlYWN0IHVzZXMgb25Gb2N1cyBhbmQgb25CbHVyIGluc3RlYWQgb2Ygb25Gb2N1c0luIGFuZCBvbkZvY3VzT3V0LiAnICsgJ0FsbCBSZWFjdCBldmVudHMgYXJlIG5vcm1hbGl6ZWQgdG8gYnViYmxlLCBzbyBvbkZvY3VzSW4gYW5kIG9uRm9jdXNPdXQgJyArICdhcmUgbm90IG5lZWRlZC9zdXBwb3J0ZWQgYnkgUmVhY3QuJyk7CgogICAgICAgIHdhcm5lZFByb3BlcnRpZXMkMVtuYW1lXSA9IHRydWU7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0gLy8gV2UgY2FuJ3QgcmVseSBvbiB0aGUgZXZlbnQgc3lzdGVtIGJlaW5nIGluamVjdGVkIG9uIHRoZSBzZXJ2ZXIuCgoKICAgICAgaWYgKGV2ZW50UmVnaXN0cnkgIT0gbnVsbCkgewogICAgICAgIHZhciByZWdpc3RyYXRpb25OYW1lRGVwZW5kZW5jaWVzID0gZXZlbnRSZWdpc3RyeS5yZWdpc3RyYXRpb25OYW1lRGVwZW5kZW5jaWVzLAogICAgICAgICAgICBwb3NzaWJsZVJlZ2lzdHJhdGlvbk5hbWVzID0gZXZlbnRSZWdpc3RyeS5wb3NzaWJsZVJlZ2lzdHJhdGlvbk5hbWVzOwoKICAgICAgICBpZiAocmVnaXN0cmF0aW9uTmFtZURlcGVuZGVuY2llcy5oYXNPd25Qcm9wZXJ0eShuYW1lKSkgewogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAgICB2YXIgcmVnaXN0cmF0aW9uTmFtZSA9IHBvc3NpYmxlUmVnaXN0cmF0aW9uTmFtZXMuaGFzT3duUHJvcGVydHkobG93ZXJDYXNlZE5hbWUpID8gcG9zc2libGVSZWdpc3RyYXRpb25OYW1lc1tsb3dlckNhc2VkTmFtZV0gOiBudWxsOwoKICAgICAgICBpZiAocmVnaXN0cmF0aW9uTmFtZSAhPSBudWxsKSB7CiAgICAgICAgICBlcnJvcignSW52YWxpZCBldmVudCBoYW5kbGVyIHByb3BlcnR5IGAlc2AuIERpZCB5b3UgbWVhbiBgJXNgPycsIG5hbWUsIHJlZ2lzdHJhdGlvbk5hbWUpOwoKICAgICAgICAgIHdhcm5lZFByb3BlcnRpZXMkMVtuYW1lXSA9IHRydWU7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIGlmIChFVkVOVF9OQU1FX1JFR0VYLnRlc3QobmFtZSkpIHsKICAgICAgICAgIGVycm9yKCdVbmtub3duIGV2ZW50IGhhbmRsZXIgcHJvcGVydHkgYCVzYC4gSXQgd2lsbCBiZSBpZ25vcmVkLicsIG5hbWUpOwoKICAgICAgICAgIHdhcm5lZFByb3BlcnRpZXMkMVtuYW1lXSA9IHRydWU7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoRVZFTlRfTkFNRV9SRUdFWC50ZXN0KG5hbWUpKSB7CiAgICAgICAgLy8gSWYgbm8gZXZlbnQgcGx1Z2lucyBoYXZlIGJlZW4gaW5qZWN0ZWQsIHdlIGFyZSBpbiBhIHNlcnZlciBlbnZpcm9ubWVudC4KICAgICAgICAvLyBTbyB3ZSBjYW4ndCB0ZWxsIGlmIHRoZSBldmVudCBuYW1lIGlzIGNvcnJlY3QgZm9yIHN1cmUsIGJ1dCB3ZSBjYW4gZmlsdGVyCiAgICAgICAgLy8gb3V0IGtub3duIGJhZCBvbmVzIGxpa2UgYG9uY2xpY2tgLiBXZSBjYW4ndCBzdWdnZXN0IGEgc3BlY2lmaWMgcmVwbGFjZW1lbnQgdGhvdWdoLgogICAgICAgIGlmIChJTlZBTElEX0VWRU5UX05BTUVfUkVHRVgudGVzdChuYW1lKSkgewogICAgICAgICAgZXJyb3IoJ0ludmFsaWQgZXZlbnQgaGFuZGxlciBwcm9wZXJ0eSBgJXNgLiAnICsgJ1JlYWN0IGV2ZW50cyB1c2UgdGhlIGNhbWVsQ2FzZSBuYW1pbmcgY29udmVudGlvbiwgZm9yIGV4YW1wbGUgYG9uQ2xpY2tgLicsIG5hbWUpOwogICAgICAgIH0KCiAgICAgICAgd2FybmVkUHJvcGVydGllcyQxW25hbWVdID0gdHJ1ZTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfSAvLyBMZXQgdGhlIEFSSUEgYXR0cmlidXRlIGhvb2sgdmFsaWRhdGUgQVJJQSBhdHRyaWJ1dGVzCgoKICAgICAgaWYgKHJBUklBJDEudGVzdChuYW1lKSB8fCByQVJJQUNhbWVsJDEudGVzdChuYW1lKSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICBpZiAobG93ZXJDYXNlZE5hbWUgPT09ICdpbm5lcmh0bWwnKSB7CiAgICAgICAgZXJyb3IoJ0RpcmVjdGx5IHNldHRpbmcgcHJvcGVydHkgYGlubmVySFRNTGAgaXMgbm90IHBlcm1pdHRlZC4gJyArICdGb3IgbW9yZSBpbmZvcm1hdGlvbiwgbG9va3VwIGRvY3VtZW50YXRpb24gb24gYGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MYC4nKTsKCiAgICAgICAgd2FybmVkUHJvcGVydGllcyQxW25hbWVdID0gdHJ1ZTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgaWYgKGxvd2VyQ2FzZWROYW1lID09PSAnYXJpYScpIHsKICAgICAgICBlcnJvcignVGhlIGBhcmlhYCBhdHRyaWJ1dGUgaXMgcmVzZXJ2ZWQgZm9yIGZ1dHVyZSB1c2UgaW4gUmVhY3QuICcgKyAnUGFzcyBpbmRpdmlkdWFsIGBhcmlhLWAgYXR0cmlidXRlcyBpbnN0ZWFkLicpOwoKICAgICAgICB3YXJuZWRQcm9wZXJ0aWVzJDFbbmFtZV0gPSB0cnVlOwogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICBpZiAobG93ZXJDYXNlZE5hbWUgPT09ICdpcycgJiYgdmFsdWUgIT09IG51bGwgJiYgdmFsdWUgIT09IHVuZGVmaW5lZCAmJiB0eXBlb2YgdmFsdWUgIT09ICdzdHJpbmcnKSB7CiAgICAgICAgZXJyb3IoJ1JlY2VpdmVkIGEgYCVzYCBmb3IgYSBzdHJpbmcgYXR0cmlidXRlIGBpc2AuIElmIHRoaXMgaXMgZXhwZWN0ZWQsIGNhc3QgJyArICd0aGUgdmFsdWUgdG8gYSBzdHJpbmcuJywgdHlwZW9mIHZhbHVlKTsKCiAgICAgICAgd2FybmVkUHJvcGVydGllcyQxW25hbWVdID0gdHJ1ZTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicgJiYgaXNOYU4odmFsdWUpKSB7CiAgICAgICAgZXJyb3IoJ1JlY2VpdmVkIE5hTiBmb3IgdGhlIGAlc2AgYXR0cmlidXRlLiBJZiB0aGlzIGlzIGV4cGVjdGVkLCBjYXN0ICcgKyAndGhlIHZhbHVlIHRvIGEgc3RyaW5nLicsIG5hbWUpOwoKICAgICAgICB3YXJuZWRQcm9wZXJ0aWVzJDFbbmFtZV0gPSB0cnVlOwogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICB2YXIgcHJvcGVydHlJbmZvID0gZ2V0UHJvcGVydHlJbmZvKG5hbWUpOwogICAgICB2YXIgaXNSZXNlcnZlZCA9IHByb3BlcnR5SW5mbyAhPT0gbnVsbCAmJiBwcm9wZXJ0eUluZm8udHlwZSA9PT0gUkVTRVJWRUQ7IC8vIEtub3duIGF0dHJpYnV0ZXMgc2hvdWxkIG1hdGNoIHRoZSBjYXNpbmcgc3BlY2lmaWVkIGluIHRoZSBwcm9wZXJ0eSBjb25maWcuCgogICAgICBpZiAocG9zc2libGVTdGFuZGFyZE5hbWVzLmhhc093blByb3BlcnR5KGxvd2VyQ2FzZWROYW1lKSkgewogICAgICAgIHZhciBzdGFuZGFyZE5hbWUgPSBwb3NzaWJsZVN0YW5kYXJkTmFtZXNbbG93ZXJDYXNlZE5hbWVdOwoKICAgICAgICBpZiAoc3RhbmRhcmROYW1lICE9PSBuYW1lKSB7CiAgICAgICAgICBlcnJvcignSW52YWxpZCBET00gcHJvcGVydHkgYCVzYC4gRGlkIHlvdSBtZWFuIGAlc2A/JywgbmFtZSwgc3RhbmRhcmROYW1lKTsKCiAgICAgICAgICB3YXJuZWRQcm9wZXJ0aWVzJDFbbmFtZV0gPSB0cnVlOwogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKCFpc1Jlc2VydmVkICYmIG5hbWUgIT09IGxvd2VyQ2FzZWROYW1lKSB7CiAgICAgICAgLy8gVW5rbm93biBhdHRyaWJ1dGVzIHNob3VsZCBoYXZlIGxvd2VyY2FzZSBjYXNpbmcgc2luY2UgdGhhdCdzIGhvdyB0aGV5CiAgICAgICAgLy8gd2lsbCBiZSBjYXNlZCBhbnl3YXkgd2l0aCBzZXJ2ZXIgcmVuZGVyaW5nLgogICAgICAgIGVycm9yKCdSZWFjdCBkb2VzIG5vdCByZWNvZ25pemUgdGhlIGAlc2AgcHJvcCBvbiBhIERPTSBlbGVtZW50LiBJZiB5b3UgJyArICdpbnRlbnRpb25hbGx5IHdhbnQgaXQgdG8gYXBwZWFyIGluIHRoZSBET00gYXMgYSBjdXN0b20gJyArICdhdHRyaWJ1dGUsIHNwZWxsIGl0IGFzIGxvd2VyY2FzZSBgJXNgIGluc3RlYWQuICcgKyAnSWYgeW91IGFjY2lkZW50YWxseSBwYXNzZWQgaXQgZnJvbSBhIHBhcmVudCBjb21wb25lbnQsIHJlbW92ZSAnICsgJ2l0IGZyb20gdGhlIERPTSBlbGVtZW50LicsIG5hbWUsIGxvd2VyQ2FzZWROYW1lKTsKCiAgICAgICAgd2FybmVkUHJvcGVydGllcyQxW25hbWVdID0gdHJ1ZTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ2Jvb2xlYW4nICYmIHNob3VsZFJlbW92ZUF0dHJpYnV0ZVdpdGhXYXJuaW5nKG5hbWUsIHZhbHVlLCBwcm9wZXJ0eUluZm8sIGZhbHNlKSkgewogICAgICAgIGlmICh2YWx1ZSkgewogICAgICAgICAgZXJyb3IoJ1JlY2VpdmVkIGAlc2AgZm9yIGEgbm9uLWJvb2xlYW4gYXR0cmlidXRlIGAlc2AuXG5cbicgKyAnSWYgeW91IHdhbnQgdG8gd3JpdGUgaXQgdG8gdGhlIERPTSwgcGFzcyBhIHN0cmluZyBpbnN0ZWFkOiAnICsgJyVzPSIlcyIgb3IgJXM9e3ZhbHVlLnRvU3RyaW5nKCl9LicsIHZhbHVlLCBuYW1lLCBuYW1lLCB2YWx1ZSwgbmFtZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGVycm9yKCdSZWNlaXZlZCBgJXNgIGZvciBhIG5vbi1ib29sZWFuIGF0dHJpYnV0ZSBgJXNgLlxuXG4nICsgJ0lmIHlvdSB3YW50IHRvIHdyaXRlIGl0IHRvIHRoZSBET00sIHBhc3MgYSBzdHJpbmcgaW5zdGVhZDogJyArICclcz0iJXMiIG9yICVzPXt2YWx1ZS50b1N0cmluZygpfS5cblxuJyArICdJZiB5b3UgdXNlZCB0byBjb25kaXRpb25hbGx5IG9taXQgaXQgd2l0aCAlcz17Y29uZGl0aW9uICYmIHZhbHVlfSwgJyArICdwYXNzICVzPXtjb25kaXRpb24gPyB2YWx1ZSA6IHVuZGVmaW5lZH0gaW5zdGVhZC4nLCB2YWx1ZSwgbmFtZSwgbmFtZSwgdmFsdWUsIG5hbWUsIG5hbWUsIG5hbWUpOwogICAgICAgIH0KCiAgICAgICAgd2FybmVkUHJvcGVydGllcyQxW25hbWVdID0gdHJ1ZTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfSAvLyBOb3cgdGhhdCB3ZSd2ZSB2YWxpZGF0ZWQgY2FzaW5nLCBkbyBub3QgdmFsaWRhdGUKICAgICAgLy8gZGF0YSB0eXBlcyBmb3IgcmVzZXJ2ZWQgcHJvcHMKCgogICAgICBpZiAoaXNSZXNlcnZlZCkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9IC8vIFdhcm4gd2hlbiBhIGtub3duIGF0dHJpYnV0ZSBpcyBhIGJhZCB0eXBlCgoKICAgICAgaWYgKHNob3VsZFJlbW92ZUF0dHJpYnV0ZVdpdGhXYXJuaW5nKG5hbWUsIHZhbHVlLCBwcm9wZXJ0eUluZm8sIGZhbHNlKSkgewogICAgICAgIHdhcm5lZFByb3BlcnRpZXMkMVtuYW1lXSA9IHRydWU7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9IC8vIFdhcm4gd2hlbiBwYXNzaW5nIHRoZSBzdHJpbmdzICdmYWxzZScgb3IgJ3RydWUnIGludG8gYSBib29sZWFuIHByb3AKCgogICAgICBpZiAoKHZhbHVlID09PSAnZmFsc2UnIHx8IHZhbHVlID09PSAndHJ1ZScpICYmIHByb3BlcnR5SW5mbyAhPT0gbnVsbCAmJiBwcm9wZXJ0eUluZm8udHlwZSA9PT0gQk9PTEVBTikgewogICAgICAgIGVycm9yKCdSZWNlaXZlZCB0aGUgc3RyaW5nIGAlc2AgZm9yIHRoZSBib29sZWFuIGF0dHJpYnV0ZSBgJXNgLiAnICsgJyVzICcgKyAnRGlkIHlvdSBtZWFuICVzPXslc30/JywgdmFsdWUsIG5hbWUsIHZhbHVlID09PSAnZmFsc2UnID8gJ1RoZSBicm93c2VyIHdpbGwgaW50ZXJwcmV0IGl0IGFzIGEgdHJ1dGh5IHZhbHVlLicgOiAnQWx0aG91Z2ggdGhpcyB3b3JrcywgaXQgd2lsbCBub3Qgd29yayBhcyBleHBlY3RlZCBpZiB5b3UgcGFzcyB0aGUgc3RyaW5nICJmYWxzZSIuJywgbmFtZSwgdmFsdWUpOwoKICAgICAgICB3YXJuZWRQcm9wZXJ0aWVzJDFbbmFtZV0gPSB0cnVlOwogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICByZXR1cm4gdHJ1ZTsKICAgIH07CiAgfQoKICB2YXIgd2FyblVua25vd25Qcm9wZXJ0aWVzID0gZnVuY3Rpb24gKHR5cGUsIHByb3BzLCBldmVudFJlZ2lzdHJ5KSB7CiAgICB7CiAgICAgIHZhciB1bmtub3duUHJvcHMgPSBbXTsKCiAgICAgIGZvciAodmFyIGtleSBpbiBwcm9wcykgewogICAgICAgIHZhciBpc1ZhbGlkID0gdmFsaWRhdGVQcm9wZXJ0eSQxKHR5cGUsIGtleSwgcHJvcHNba2V5XSwgZXZlbnRSZWdpc3RyeSk7CgogICAgICAgIGlmICghaXNWYWxpZCkgewogICAgICAgICAgdW5rbm93blByb3BzLnB1c2goa2V5KTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHZhciB1bmtub3duUHJvcFN0cmluZyA9IHVua25vd25Qcm9wcy5tYXAoZnVuY3Rpb24gKHByb3ApIHsKICAgICAgICByZXR1cm4gJ2AnICsgcHJvcCArICdgJzsKICAgICAgfSkuam9pbignLCAnKTsKCiAgICAgIGlmICh1bmtub3duUHJvcHMubGVuZ3RoID09PSAxKSB7CiAgICAgICAgZXJyb3IoJ0ludmFsaWQgdmFsdWUgZm9yIHByb3AgJXMgb24gPCVzPiB0YWcuIEVpdGhlciByZW1vdmUgaXQgZnJvbSB0aGUgZWxlbWVudCwgJyArICdvciBwYXNzIGEgc3RyaW5nIG9yIG51bWJlciB2YWx1ZSB0byBrZWVwIGl0IGluIHRoZSBET00uICcgKyAnRm9yIGRldGFpbHMsIHNlZSBodHRwczovL3JlYWN0anMub3JnL2xpbmsvYXR0cmlidXRlLWJlaGF2aW9yICcsIHVua25vd25Qcm9wU3RyaW5nLCB0eXBlKTsKICAgICAgfSBlbHNlIGlmICh1bmtub3duUHJvcHMubGVuZ3RoID4gMSkgewogICAgICAgIGVycm9yKCdJbnZhbGlkIHZhbHVlcyBmb3IgcHJvcHMgJXMgb24gPCVzPiB0YWcuIEVpdGhlciByZW1vdmUgdGhlbSBmcm9tIHRoZSBlbGVtZW50LCAnICsgJ29yIHBhc3MgYSBzdHJpbmcgb3IgbnVtYmVyIHZhbHVlIHRvIGtlZXAgdGhlbSBpbiB0aGUgRE9NLiAnICsgJ0ZvciBkZXRhaWxzLCBzZWUgaHR0cHM6Ly9yZWFjdGpzLm9yZy9saW5rL2F0dHJpYnV0ZS1iZWhhdmlvciAnLCB1bmtub3duUHJvcFN0cmluZywgdHlwZSk7CiAgICAgIH0KICAgIH0KICB9OwoKICBmdW5jdGlvbiB2YWxpZGF0ZVByb3BlcnRpZXMkMih0eXBlLCBwcm9wcywgZXZlbnRSZWdpc3RyeSkgewogICAgaWYgKGlzQ3VzdG9tQ29tcG9uZW50KHR5cGUsIHByb3BzKSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgd2FyblVua25vd25Qcm9wZXJ0aWVzKHR5cGUsIHByb3BzLCBldmVudFJlZ2lzdHJ5KTsKICB9CgogIHZhciBJU19FVkVOVF9IQU5ETEVfTk9OX01BTkFHRURfTk9ERSA9IDE7CiAgdmFyIElTX05PTl9ERUxFR0FURUQgPSAxIDw8IDE7CiAgdmFyIElTX0NBUFRVUkVfUEhBU0UgPSAxIDw8IDI7CiAgLy8gc2V0IHRvIExFR0FDWV9GQl9TVVBQT1JULiBMRUdBQ1lfRkJfU1VQUE9SVCBvbmx5IGdldHMgc2V0IHdoZW4KICAvLyB3ZSBjYWxsIHdpbGxEZWZlckxhdGVyRm9yTGVnYWN5RkJTdXBwb3J0LCB0aHVzIG5vdCBiYWlsaW5nIG91dAogIC8vIHdpbGwgcmVzdWx0IGluIGVuZGxlc3MgY3ljbGVzIGxpa2UgYW4gaW5maW5pdGUgbG9vcC4KICAvLyBXZSBhbHNvIGRvbid0IHdhbnQgdG8gZGVmZXIgZHVyaW5nIGV2ZW50IHJlcGxheWluZy4KCiAgdmFyIFNIT1VMRF9OT1RfUFJPQ0VTU19QT0xZRklMTF9FVkVOVF9QTFVHSU5TID0gSVNfRVZFTlRfSEFORExFX05PTl9NQU5BR0VEX05PREUgfCBJU19OT05fREVMRUdBVEVEIHwgSVNfQ0FQVFVSRV9QSEFTRTsKCiAgLy8gVGhpcyBleGlzdHMgdG8gYXZvaWQgY2lyY3VsYXIgZGVwZW5kZW5jeSBiZXR3ZWVuIFJlYWN0RE9NRXZlbnRSZXBsYXlpbmcKICAvLyBhbmQgRE9NUGx1Z2luRXZlbnRTeXN0ZW0uCiAgdmFyIGN1cnJlbnRSZXBsYXlpbmdFdmVudCA9IG51bGw7CiAgZnVuY3Rpb24gc2V0UmVwbGF5aW5nRXZlbnQoZXZlbnQpIHsKICAgIHsKICAgICAgaWYgKGN1cnJlbnRSZXBsYXlpbmdFdmVudCAhPT0gbnVsbCkgewogICAgICAgIGVycm9yKCdFeHBlY3RlZCBjdXJyZW50bHkgcmVwbGF5aW5nIGV2ZW50IHRvIGJlIG51bGwuIFRoaXMgZXJyb3IgJyArICdpcyBsaWtlbHkgY2F1c2VkIGJ5IGEgYnVnIGluIFJlYWN0LiBQbGVhc2UgZmlsZSBhbiBpc3N1ZS4nKTsKICAgICAgfQogICAgfQoKICAgIGN1cnJlbnRSZXBsYXlpbmdFdmVudCA9IGV2ZW50OwogIH0KICBmdW5jdGlvbiByZXNldFJlcGxheWluZ0V2ZW50KCkgewogICAgewogICAgICBpZiAoY3VycmVudFJlcGxheWluZ0V2ZW50ID09PSBudWxsKSB7CiAgICAgICAgZXJyb3IoJ0V4cGVjdGVkIGN1cnJlbnRseSByZXBsYXlpbmcgZXZlbnQgdG8gbm90IGJlIG51bGwuIFRoaXMgZXJyb3IgJyArICdpcyBsaWtlbHkgY2F1c2VkIGJ5IGEgYnVnIGluIFJlYWN0LiBQbGVhc2UgZmlsZSBhbiBpc3N1ZS4nKTsKICAgICAgfQogICAgfQoKICAgIGN1cnJlbnRSZXBsYXlpbmdFdmVudCA9IG51bGw7CiAgfQogIGZ1bmN0aW9uIGlzUmVwbGF5aW5nRXZlbnQoZXZlbnQpIHsKICAgIHJldHVybiBldmVudCA9PT0gY3VycmVudFJlcGxheWluZ0V2ZW50OwogIH0KCiAgLyoqCiAgICogR2V0cyB0aGUgdGFyZ2V0IG5vZGUgZnJvbSBhIG5hdGl2ZSBicm93c2VyIGV2ZW50IGJ5IGFjY291bnRpbmcgZm9yCiAgICogaW5jb25zaXN0ZW5jaWVzIGluIGJyb3dzZXIgRE9NIEFQSXMuCiAgICoKICAgKiBAcGFyYW0ge29iamVjdH0gbmF0aXZlRXZlbnQgTmF0aXZlIGJyb3dzZXIgZXZlbnQuCiAgICogQHJldHVybiB7RE9NRXZlbnRUYXJnZXR9IFRhcmdldCBub2RlLgogICAqLwoKICBmdW5jdGlvbiBnZXRFdmVudFRhcmdldChuYXRpdmVFdmVudCkgewogICAgLy8gRmFsbGJhY2sgdG8gbmF0aXZlRXZlbnQuc3JjRWxlbWVudCBmb3IgSUU5CiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2svcmVhY3QvaXNzdWVzLzEyNTA2CiAgICB2YXIgdGFyZ2V0ID0gbmF0aXZlRXZlbnQudGFyZ2V0IHx8IG5hdGl2ZUV2ZW50LnNyY0VsZW1lbnQgfHwgd2luZG93OyAvLyBOb3JtYWxpemUgU1ZHIDx1c2U+IGVsZW1lbnQgZXZlbnRzICM0OTYzCgogICAgaWYgKHRhcmdldC5jb3JyZXNwb25kaW5nVXNlRWxlbWVudCkgewogICAgICB0YXJnZXQgPSB0YXJnZXQuY29ycmVzcG9uZGluZ1VzZUVsZW1lbnQ7CiAgICB9IC8vIFNhZmFyaSBtYXkgZmlyZSBldmVudHMgb24gdGV4dCBub2RlcyAoTm9kZS5URVhUX05PREUgaXMgMykuCiAgICAvLyBAc2VlIGh0dHA6Ly93d3cucXVpcmtzbW9kZS5vcmcvanMvZXZlbnRzX3Byb3BlcnRpZXMuaHRtbAoKCiAgICByZXR1cm4gdGFyZ2V0Lm5vZGVUeXBlID09PSBURVhUX05PREUgPyB0YXJnZXQucGFyZW50Tm9kZSA6IHRhcmdldDsKICB9CgogIHZhciByZXN0b3JlSW1wbCA9IG51bGw7CiAgdmFyIHJlc3RvcmVUYXJnZXQgPSBudWxsOwogIHZhciByZXN0b3JlUXVldWUgPSBudWxsOwoKICBmdW5jdGlvbiByZXN0b3JlU3RhdGVPZlRhcmdldCh0YXJnZXQpIHsKICAgIC8vIFdlIHBlcmZvcm0gdGhpcyB0cmFuc2xhdGlvbiBhdCB0aGUgZW5kIG9mIHRoZSBldmVudCBsb29wIHNvIHRoYXQgd2UKICAgIC8vIGFsd2F5cyByZWNlaXZlIHRoZSBjb3JyZWN0IGZpYmVyIGhlcmUKICAgIHZhciBpbnRlcm5hbEluc3RhbmNlID0gZ2V0SW5zdGFuY2VGcm9tTm9kZSh0YXJnZXQpOwoKICAgIGlmICghaW50ZXJuYWxJbnN0YW5jZSkgewogICAgICAvLyBVbm1vdW50ZWQKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmICh0eXBlb2YgcmVzdG9yZUltcGwgIT09ICdmdW5jdGlvbicpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdzZXRSZXN0b3JlSW1wbGVtZW50YXRpb24oKSBuZWVkcyB0byBiZSBjYWxsZWQgdG8gaGFuZGxlIGEgdGFyZ2V0IGZvciBjb250cm9sbGVkICcgKyAnZXZlbnRzLiBUaGlzIGVycm9yIGlzIGxpa2VseSBjYXVzZWQgYnkgYSBidWcgaW4gUmVhY3QuIFBsZWFzZSBmaWxlIGFuIGlzc3VlLicpOwogICAgfQoKICAgIHZhciBzdGF0ZU5vZGUgPSBpbnRlcm5hbEluc3RhbmNlLnN0YXRlTm9kZTsgLy8gR3VhcmQgYWdhaW5zdCBGaWJlciBiZWluZyB1bm1vdW50ZWQuCgogICAgaWYgKHN0YXRlTm9kZSkgewogICAgICB2YXIgX3Byb3BzID0gZ2V0RmliZXJDdXJyZW50UHJvcHNGcm9tTm9kZShzdGF0ZU5vZGUpOwoKICAgICAgcmVzdG9yZUltcGwoaW50ZXJuYWxJbnN0YW5jZS5zdGF0ZU5vZGUsIGludGVybmFsSW5zdGFuY2UudHlwZSwgX3Byb3BzKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHNldFJlc3RvcmVJbXBsZW1lbnRhdGlvbihpbXBsKSB7CiAgICByZXN0b3JlSW1wbCA9IGltcGw7CiAgfQogIGZ1bmN0aW9uIGVucXVldWVTdGF0ZVJlc3RvcmUodGFyZ2V0KSB7CiAgICBpZiAocmVzdG9yZVRhcmdldCkgewogICAgICBpZiAocmVzdG9yZVF1ZXVlKSB7CiAgICAgICAgcmVzdG9yZVF1ZXVlLnB1c2godGFyZ2V0KTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXN0b3JlUXVldWUgPSBbdGFyZ2V0XTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgcmVzdG9yZVRhcmdldCA9IHRhcmdldDsKICAgIH0KICB9CiAgZnVuY3Rpb24gbmVlZHNTdGF0ZVJlc3RvcmUoKSB7CiAgICByZXR1cm4gcmVzdG9yZVRhcmdldCAhPT0gbnVsbCB8fCByZXN0b3JlUXVldWUgIT09IG51bGw7CiAgfQogIGZ1bmN0aW9uIHJlc3RvcmVTdGF0ZUlmTmVlZGVkKCkgewogICAgaWYgKCFyZXN0b3JlVGFyZ2V0KSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB2YXIgdGFyZ2V0ID0gcmVzdG9yZVRhcmdldDsKICAgIHZhciBxdWV1ZWRUYXJnZXRzID0gcmVzdG9yZVF1ZXVlOwogICAgcmVzdG9yZVRhcmdldCA9IG51bGw7CiAgICByZXN0b3JlUXVldWUgPSBudWxsOwogICAgcmVzdG9yZVN0YXRlT2ZUYXJnZXQodGFyZ2V0KTsKCiAgICBpZiAocXVldWVkVGFyZ2V0cykgewogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHF1ZXVlZFRhcmdldHMubGVuZ3RoOyBpKyspIHsKICAgICAgICByZXN0b3JlU3RhdGVPZlRhcmdldChxdWV1ZWRUYXJnZXRzW2ldKTsKICAgICAgfQogICAgfQogIH0KCiAgLy8gdGhlIHJlbmRlcmVyLiBTdWNoIGFzIHdoZW4gd2UncmUgZGlzcGF0Y2hpbmcgZXZlbnRzIG9yIGlmIHRoaXJkIHBhcnR5CiAgLy8gbGlicmFyaWVzIG5lZWQgdG8gY2FsbCBiYXRjaGVkVXBkYXRlcy4gRXZlbnR1YWxseSwgdGhpcyBBUEkgd2lsbCBnbyBhd2F5IHdoZW4KICAvLyBldmVyeXRoaW5nIGlzIGJhdGNoZWQgYnkgZGVmYXVsdC4gV2UnbGwgdGhlbiBoYXZlIGEgc2ltaWxhciBBUEkgdG8gb3B0LW91dCBvZgogIC8vIHNjaGVkdWxlZCB3b3JrIGFuZCBpbnN0ZWFkIGRvIHN5bmNocm9ub3VzIHdvcmsuCiAgLy8gRGVmYXVsdHMKCiAgdmFyIGJhdGNoZWRVcGRhdGVzSW1wbCA9IGZ1bmN0aW9uIChmbiwgYm9va2tlZXBpbmcpIHsKICAgIHJldHVybiBmbihib29ra2VlcGluZyk7CiAgfTsKCiAgdmFyIGZsdXNoU3luY0ltcGwgPSBmdW5jdGlvbiAoKSB7fTsKCiAgdmFyIGlzSW5zaWRlRXZlbnRIYW5kbGVyID0gZmFsc2U7CgogIGZ1bmN0aW9uIGZpbmlzaEV2ZW50SGFuZGxlcigpIHsKICAgIC8vIEhlcmUgd2Ugd2FpdCB1bnRpbCBhbGwgdXBkYXRlcyBoYXZlIHByb3BhZ2F0ZWQsIHdoaWNoIGlzIGltcG9ydGFudAogICAgLy8gd2hlbiB1c2luZyBjb250cm9sbGVkIGNvbXBvbmVudHMgd2l0aGluIGxheWVyczoKICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9mYWNlYm9vay9yZWFjdC9pc3N1ZXMvMTY5OAogICAgLy8gVGhlbiB3ZSByZXN0b3JlIHN0YXRlIG9mIGFueSBjb250cm9sbGVkIGNvbXBvbmVudC4KICAgIHZhciBjb250cm9sbGVkQ29tcG9uZW50c0hhdmVQZW5kaW5nVXBkYXRlcyA9IG5lZWRzU3RhdGVSZXN0b3JlKCk7CgogICAgaWYgKGNvbnRyb2xsZWRDb21wb25lbnRzSGF2ZVBlbmRpbmdVcGRhdGVzKSB7CiAgICAgIC8vIElmIGEgY29udHJvbGxlZCBldmVudCB3YXMgZmlyZWQsIHdlIG1heSBuZWVkIHRvIHJlc3RvcmUgdGhlIHN0YXRlIG9mCiAgICAgIC8vIHRoZSBET00gbm9kZSBiYWNrIHRvIHRoZSBjb250cm9sbGVkIHZhbHVlLiBUaGlzIGlzIG5lY2Vzc2FyeSB3aGVuIFJlYWN0CiAgICAgIC8vIGJhaWxzIG91dCBvZiB0aGUgdXBkYXRlIHdpdGhvdXQgdG91Y2hpbmcgdGhlIERPTS4KICAgICAgLy8gVE9ETzogUmVzdG9yZSBzdGF0ZSBpbiB0aGUgbWljcm90YXNrLCBhZnRlciB0aGUgZGlzY3JldGUgdXBkYXRlcyBmbHVzaCwKICAgICAgLy8gaW5zdGVhZCBvZiBlYXJseSBmbHVzaGluZyB0aGVtIGhlcmUuCiAgICAgIGZsdXNoU3luY0ltcGwoKTsKICAgICAgcmVzdG9yZVN0YXRlSWZOZWVkZWQoKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGJhdGNoZWRVcGRhdGVzKGZuLCBhLCBiKSB7CiAgICBpZiAoaXNJbnNpZGVFdmVudEhhbmRsZXIpIHsKICAgICAgLy8gSWYgd2UgYXJlIGN1cnJlbnRseSBpbnNpZGUgYW5vdGhlciBiYXRjaCwgd2UgbmVlZCB0byB3YWl0IHVudGlsIGl0CiAgICAgIC8vIGZ1bGx5IGNvbXBsZXRlcyBiZWZvcmUgcmVzdG9yaW5nIHN0YXRlLgogICAgICByZXR1cm4gZm4oYSwgYik7CiAgICB9CgogICAgaXNJbnNpZGVFdmVudEhhbmRsZXIgPSB0cnVlOwoKICAgIHRyeSB7CiAgICAgIHJldHVybiBiYXRjaGVkVXBkYXRlc0ltcGwoZm4sIGEsIGIpOwogICAgfSBmaW5hbGx5IHsKICAgICAgaXNJbnNpZGVFdmVudEhhbmRsZXIgPSBmYWxzZTsKICAgICAgZmluaXNoRXZlbnRIYW5kbGVyKCk7CiAgICB9CiAgfSAvLyBUT0RPOiBSZXBsYWNlIHdpdGggZmx1c2hTeW5jCiAgZnVuY3Rpb24gc2V0QmF0Y2hpbmdJbXBsZW1lbnRhdGlvbihfYmF0Y2hlZFVwZGF0ZXNJbXBsLCBfZGlzY3JldGVVcGRhdGVzSW1wbCwgX2ZsdXNoU3luY0ltcGwpIHsKICAgIGJhdGNoZWRVcGRhdGVzSW1wbCA9IF9iYXRjaGVkVXBkYXRlc0ltcGw7CiAgICBmbHVzaFN5bmNJbXBsID0gX2ZsdXNoU3luY0ltcGw7CiAgfQoKICBmdW5jdGlvbiBpc0ludGVyYWN0aXZlKHRhZykgewogICAgcmV0dXJuIHRhZyA9PT0gJ2J1dHRvbicgfHwgdGFnID09PSAnaW5wdXQnIHx8IHRhZyA9PT0gJ3NlbGVjdCcgfHwgdGFnID09PSAndGV4dGFyZWEnOwogIH0KCiAgZnVuY3Rpb24gc2hvdWxkUHJldmVudE1vdXNlRXZlbnQobmFtZSwgdHlwZSwgcHJvcHMpIHsKICAgIHN3aXRjaCAobmFtZSkgewogICAgICBjYXNlICdvbkNsaWNrJzoKICAgICAgY2FzZSAnb25DbGlja0NhcHR1cmUnOgogICAgICBjYXNlICdvbkRvdWJsZUNsaWNrJzoKICAgICAgY2FzZSAnb25Eb3VibGVDbGlja0NhcHR1cmUnOgogICAgICBjYXNlICdvbk1vdXNlRG93bic6CiAgICAgIGNhc2UgJ29uTW91c2VEb3duQ2FwdHVyZSc6CiAgICAgIGNhc2UgJ29uTW91c2VNb3ZlJzoKICAgICAgY2FzZSAnb25Nb3VzZU1vdmVDYXB0dXJlJzoKICAgICAgY2FzZSAnb25Nb3VzZVVwJzoKICAgICAgY2FzZSAnb25Nb3VzZVVwQ2FwdHVyZSc6CiAgICAgIGNhc2UgJ29uTW91c2VFbnRlcic6CiAgICAgICAgcmV0dXJuICEhKHByb3BzLmRpc2FibGVkICYmIGlzSW50ZXJhY3RpdmUodHlwZSkpOwoKICAgICAgZGVmYXVsdDoKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfQogIC8qKgogICAqIEBwYXJhbSB7b2JqZWN0fSBpbnN0IFRoZSBpbnN0YW5jZSwgd2hpY2ggaXMgdGhlIHNvdXJjZSBvZiBldmVudHMuCiAgICogQHBhcmFtIHtzdHJpbmd9IHJlZ2lzdHJhdGlvbk5hbWUgTmFtZSBvZiBsaXN0ZW5lciAoZS5nLiBgb25DbGlja2ApLgogICAqIEByZXR1cm4gez9mdW5jdGlvbn0gVGhlIHN0b3JlZCBjYWxsYmFjay4KICAgKi8KCgogIGZ1bmN0aW9uIGdldExpc3RlbmVyKGluc3QsIHJlZ2lzdHJhdGlvbk5hbWUpIHsKICAgIHZhciBzdGF0ZU5vZGUgPSBpbnN0LnN0YXRlTm9kZTsKCiAgICBpZiAoc3RhdGVOb2RlID09PSBudWxsKSB7CiAgICAgIC8vIFdvcmsgaW4gcHJvZ3Jlc3MgKGV4OiBvbmxvYWQgZXZlbnRzIGluIGluY3JlbWVudGFsIG1vZGUpLgogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICB2YXIgcHJvcHMgPSBnZXRGaWJlckN1cnJlbnRQcm9wc0Zyb21Ob2RlKHN0YXRlTm9kZSk7CgogICAgaWYgKHByb3BzID09PSBudWxsKSB7CiAgICAgIC8vIFdvcmsgaW4gcHJvZ3Jlc3MuCiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIHZhciBsaXN0ZW5lciA9IHByb3BzW3JlZ2lzdHJhdGlvbk5hbWVdOwoKICAgIGlmIChzaG91bGRQcmV2ZW50TW91c2VFdmVudChyZWdpc3RyYXRpb25OYW1lLCBpbnN0LnR5cGUsIHByb3BzKSkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBpZiAobGlzdGVuZXIgJiYgdHlwZW9mIGxpc3RlbmVyICE9PSAnZnVuY3Rpb24nKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigiRXhwZWN0ZWQgYCIgKyByZWdpc3RyYXRpb25OYW1lICsgImAgbGlzdGVuZXIgdG8gYmUgYSBmdW5jdGlvbiwgaW5zdGVhZCBnb3QgYSB2YWx1ZSBvZiBgIiArIHR5cGVvZiBsaXN0ZW5lciArICJgIHR5cGUuIik7CiAgICB9CgogICAgcmV0dXJuIGxpc3RlbmVyOwogIH0KCiAgdmFyIHBhc3NpdmVCcm93c2VyRXZlbnRzU3VwcG9ydGVkID0gZmFsc2U7IC8vIENoZWNrIGlmIGJyb3dzZXIgc3VwcG9ydCBldmVudHMgd2l0aCBwYXNzaXZlIGxpc3RlbmVycwogIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9FdmVudFRhcmdldC9hZGRFdmVudExpc3RlbmVyI1NhZmVseV9kZXRlY3Rpbmdfb3B0aW9uX3N1cHBvcnQKCiAgaWYgKGNhblVzZURPTSkgewogICAgdHJ5IHsKICAgICAgdmFyIG9wdGlvbnMgPSB7fTsgLy8gJEZsb3dGaXhNZTogSWdub3JlIEZsb3cgY29tcGxhaW5pbmcgYWJvdXQgbmVlZGluZyBhIHZhbHVlCgogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob3B0aW9ucywgJ3Bhc3NpdmUnLCB7CiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBwYXNzaXZlQnJvd3NlckV2ZW50c1N1cHBvcnRlZCA9IHRydWU7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Rlc3QnLCBvcHRpb25zLCBvcHRpb25zKTsKICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Rlc3QnLCBvcHRpb25zLCBvcHRpb25zKTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgcGFzc2l2ZUJyb3dzZXJFdmVudHNTdXBwb3J0ZWQgPSBmYWxzZTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGludm9rZUd1YXJkZWRDYWxsYmFja1Byb2QobmFtZSwgZnVuYywgY29udGV4dCwgYSwgYiwgYywgZCwgZSwgZikgewogICAgdmFyIGZ1bmNBcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAzKTsKCiAgICB0cnkgewogICAgICBmdW5jLmFwcGx5KGNvbnRleHQsIGZ1bmNBcmdzKTsKICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgIHRoaXMub25FcnJvcihlcnJvcik7CiAgICB9CiAgfQoKICB2YXIgaW52b2tlR3VhcmRlZENhbGxiYWNrSW1wbCA9IGludm9rZUd1YXJkZWRDYWxsYmFja1Byb2Q7CgogIHsKICAgIC8vIEluIERFViBtb2RlLCB3ZSBzd2FwIG91dCBpbnZva2VHdWFyZGVkQ2FsbGJhY2sgZm9yIGEgc3BlY2lhbCB2ZXJzaW9uCiAgICAvLyB0aGF0IHBsYXlzIG1vcmUgbmljZWx5IHdpdGggdGhlIGJyb3dzZXIncyBEZXZUb29scy4gVGhlIGlkZWEgaXMgdG8gcHJlc2VydmUKICAgIC8vICJQYXVzZSBvbiBleGNlcHRpb25zIiBiZWhhdmlvci4gQmVjYXVzZSBSZWFjdCB3cmFwcyBhbGwgdXNlci1wcm92aWRlZAogICAgLy8gZnVuY3Rpb25zIGluIGludm9rZUd1YXJkZWRDYWxsYmFjaywgYW5kIHRoZSBwcm9kdWN0aW9uIHZlcnNpb24gb2YKICAgIC8vIGludm9rZUd1YXJkZWRDYWxsYmFjayB1c2VzIGEgdHJ5LWNhdGNoLCBhbGwgdXNlciBleGNlcHRpb25zIGFyZSB0cmVhdGVkCiAgICAvLyBsaWtlIGNhdWdodCBleGNlcHRpb25zLCBhbmQgdGhlIERldlRvb2xzIHdvbid0IHBhdXNlIHVubGVzcyB0aGUgZGV2ZWxvcGVyCiAgICAvLyB0YWtlcyB0aGUgZXh0cmEgc3RlcCBvZiBlbmFibGluZyBwYXVzZSBvbiBjYXVnaHQgZXhjZXB0aW9ucy4gVGhpcyBpcwogICAgLy8gdW5pbnR1aXRpdmUsIHRob3VnaCwgYmVjYXVzZSBldmVuIHRob3VnaCBSZWFjdCBoYXMgY2F1Z2h0IHRoZSBlcnJvciwgZnJvbQogICAgLy8gdGhlIGRldmVsb3BlcidzIHBlcnNwZWN0aXZlLCB0aGUgZXJyb3IgaXMgdW5jYXVnaHQuCiAgICAvLwogICAgLy8gVG8gcHJlc2VydmUgdGhlIGV4cGVjdGVkICJQYXVzZSBvbiBleGNlcHRpb25zIiBiZWhhdmlvciwgd2UgZG9uJ3QgdXNlIGEKICAgIC8vIHRyeS1jYXRjaCBpbiBERVYuIEluc3RlYWQsIHdlIHN5bmNocm9ub3VzbHkgZGlzcGF0Y2ggYSBmYWtlIGV2ZW50IHRvIGEgZmFrZQogICAgLy8gRE9NIG5vZGUsIGFuZCBjYWxsIHRoZSB1c2VyLXByb3ZpZGVkIGNhbGxiYWNrIGZyb20gaW5zaWRlIGFuIGV2ZW50IGhhbmRsZXIKICAgIC8vIGZvciB0aGF0IGZha2UgZXZlbnQuIElmIHRoZSBjYWxsYmFjayB0aHJvd3MsIHRoZSBlcnJvciBpcyAiY2FwdHVyZWQiIHVzaW5nCiAgICAvLyBhIGdsb2JhbCBldmVudCBoYW5kbGVyLiBCdXQgYmVjYXVzZSB0aGUgZXJyb3IgaGFwcGVucyBpbiBhIGRpZmZlcmVudAogICAgLy8gZXZlbnQgbG9vcCBjb250ZXh0LCBpdCBkb2VzIG5vdCBpbnRlcnJ1cHQgdGhlIG5vcm1hbCBwcm9ncmFtIGZsb3cuCiAgICAvLyBFZmZlY3RpdmVseSwgdGhpcyBnaXZlcyB1cyB0cnktY2F0Y2ggYmVoYXZpb3Igd2l0aG91dCBhY3R1YWxseSB1c2luZwogICAgLy8gdHJ5LWNhdGNoLiBOZWF0IQogICAgLy8gQ2hlY2sgdGhhdCB0aGUgYnJvd3NlciBzdXBwb3J0cyB0aGUgQVBJcyB3ZSBuZWVkIHRvIGltcGxlbWVudCBvdXIgc3BlY2lhbAogICAgLy8gREVWIHZlcnNpb24gb2YgaW52b2tlR3VhcmRlZENhbGxiYWNrCiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIHdpbmRvdy5kaXNwYXRjaEV2ZW50ID09PSAnZnVuY3Rpb24nICYmIHR5cGVvZiBkb2N1bWVudCAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIGRvY3VtZW50LmNyZWF0ZUV2ZW50ID09PSAnZnVuY3Rpb24nKSB7CiAgICAgIHZhciBmYWtlTm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3JlYWN0Jyk7CgogICAgICBpbnZva2VHdWFyZGVkQ2FsbGJhY2tJbXBsID0gZnVuY3Rpb24gaW52b2tlR3VhcmRlZENhbGxiYWNrRGV2KG5hbWUsIGZ1bmMsIGNvbnRleHQsIGEsIGIsIGMsIGQsIGUsIGYpIHsKICAgICAgICAvLyBJZiBkb2N1bWVudCBkb2Vzbid0IGV4aXN0IHdlIGtub3cgZm9yIHN1cmUgd2Ugd2lsbCBjcmFzaCBpbiB0aGlzIG1ldGhvZAogICAgICAgIC8vIHdoZW4gd2UgY2FsbCBkb2N1bWVudC5jcmVhdGVFdmVudCgpLiBIb3dldmVyIHRoaXMgY2FuIGNhdXNlIGNvbmZ1c2luZwogICAgICAgIC8vIGVycm9yczogaHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL2NyZWF0ZS1yZWFjdC1hcHAvaXNzdWVzLzM0ODIKICAgICAgICAvLyBTbyB3ZSBwcmVlbXB0aXZlbHkgdGhyb3cgd2l0aCBhIGJldHRlciBtZXNzYWdlIGluc3RlYWQuCiAgICAgICAgaWYgKHR5cGVvZiBkb2N1bWVudCA9PT0gJ3VuZGVmaW5lZCcgfHwgZG9jdW1lbnQgPT09IG51bGwpIHsKICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVGhlIGBkb2N1bWVudGAgZ2xvYmFsIHdhcyBkZWZpbmVkIHdoZW4gUmVhY3Qgd2FzIGluaXRpYWxpemVkLCBidXQgaXMgbm90ICcgKyAnZGVmaW5lZCBhbnltb3JlLiBUaGlzIGNhbiBoYXBwZW4gaW4gYSB0ZXN0IGVudmlyb25tZW50IGlmIGEgY29tcG9uZW50ICcgKyAnc2NoZWR1bGVzIGFuIHVwZGF0ZSBmcm9tIGFuIGFzeW5jaHJvbm91cyBjYWxsYmFjaywgYnV0IHRoZSB0ZXN0IGhhcyBhbHJlYWR5ICcgKyAnZmluaXNoZWQgcnVubmluZy4gVG8gc29sdmUgdGhpcywgeW91IGNhbiBlaXRoZXIgdW5tb3VudCB0aGUgY29tcG9uZW50IGF0ICcgKyAndGhlIGVuZCBvZiB5b3VyIHRlc3QgKGFuZCBlbnN1cmUgdGhhdCBhbnkgYXN5bmNocm9ub3VzIG9wZXJhdGlvbnMgZ2V0ICcgKyAnY2FuY2VsZWQgaW4gYGNvbXBvbmVudFdpbGxVbm1vdW50YCksIG9yIHlvdSBjYW4gY2hhbmdlIHRoZSB0ZXN0IGl0c2VsZiAnICsgJ3RvIGJlIGFzeW5jaHJvbm91cy4nKTsKICAgICAgICB9CgogICAgICAgIHZhciBldnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnRXZlbnQnKTsKICAgICAgICB2YXIgZGlkQ2FsbCA9IGZhbHNlOyAvLyBLZWVwcyB0cmFjayBvZiB3aGV0aGVyIHRoZSB1c2VyLXByb3ZpZGVkIGNhbGxiYWNrIHRocmV3IGFuIGVycm9yLiBXZQogICAgICAgIC8vIHNldCB0aGlzIHRvIHRydWUgYXQgdGhlIGJlZ2lubmluZywgdGhlbiBzZXQgaXQgdG8gZmFsc2UgcmlnaHQgYWZ0ZXIKICAgICAgICAvLyBjYWxsaW5nIHRoZSBmdW5jdGlvbi4gSWYgdGhlIGZ1bmN0aW9uIGVycm9ycywgYGRpZEVycm9yYCB3aWxsIG5ldmVyIGJlCiAgICAgICAgLy8gc2V0IHRvIGZhbHNlLiBUaGlzIHN0cmF0ZWd5IHdvcmtzIGV2ZW4gaWYgdGhlIGJyb3dzZXIgaXMgZmxha3kgYW5kCiAgICAgICAgLy8gZmFpbHMgdG8gY2FsbCBvdXIgZ2xvYmFsIGVycm9yIGhhbmRsZXIsIGJlY2F1c2UgaXQgZG9lc24ndCByZWx5IG9uCiAgICAgICAgLy8gdGhlIGVycm9yIGV2ZW50IGF0IGFsbC4KCiAgICAgICAgdmFyIGRpZEVycm9yID0gdHJ1ZTsgLy8gS2VlcHMgdHJhY2sgb2YgdGhlIHZhbHVlIG9mIHdpbmRvdy5ldmVudCBzbyB0aGF0IHdlIGNhbiByZXNldCBpdAogICAgICAgIC8vIGR1cmluZyB0aGUgY2FsbGJhY2sgdG8gbGV0IHVzZXIgY29kZSBhY2Nlc3Mgd2luZG93LmV2ZW50IGluIHRoZQogICAgICAgIC8vIGJyb3dzZXJzIHRoYXQgc3VwcG9ydCBpdC4KCiAgICAgICAgdmFyIHdpbmRvd0V2ZW50ID0gd2luZG93LmV2ZW50OyAvLyBLZWVwcyB0cmFjayBvZiB0aGUgZGVzY3JpcHRvciBvZiB3aW5kb3cuZXZlbnQgdG8gcmVzdG9yZSBpdCBhZnRlciBldmVudAogICAgICAgIC8vIGRpc3BhdGNoaW5nOiBodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2svcmVhY3QvaXNzdWVzLzEzNjg4CgogICAgICAgIHZhciB3aW5kb3dFdmVudERlc2NyaXB0b3IgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHdpbmRvdywgJ2V2ZW50Jyk7CgogICAgICAgIGZ1bmN0aW9uIHJlc3RvcmVBZnRlckRpc3BhdGNoKCkgewogICAgICAgICAgLy8gV2UgaW1tZWRpYXRlbHkgcmVtb3ZlIHRoZSBjYWxsYmFjayBmcm9tIGV2ZW50IGxpc3RlbmVycyBzbyB0aGF0CiAgICAgICAgICAvLyBuZXN0ZWQgYGludm9rZUd1YXJkZWRDYWxsYmFja2AgY2FsbHMgZG8gbm90IGNsYXNoLiBPdGhlcndpc2UsIGEKICAgICAgICAgIC8vIG5lc3RlZCBjYWxsIHdvdWxkIHRyaWdnZXIgdGhlIGZha2UgZXZlbnQgaGFuZGxlcnMgb2YgYW55IGNhbGwgaGlnaGVyCiAgICAgICAgICAvLyBpbiB0aGUgc3RhY2suCiAgICAgICAgICBmYWtlTm9kZS5yZW1vdmVFdmVudExpc3RlbmVyKGV2dFR5cGUsIGNhbGxDYWxsYmFjaywgZmFsc2UpOyAvLyBXZSBjaGVjayBmb3Igd2luZG93Lmhhc093blByb3BlcnR5KCdldmVudCcpIHRvIHByZXZlbnQgdGhlCiAgICAgICAgICAvLyB3aW5kb3cuZXZlbnQgYXNzaWdubWVudCBpbiBib3RoIElFIDw9IDEwIGFzIHRoZXkgdGhyb3cgYW4gZXJyb3IKICAgICAgICAgIC8vICJNZW1iZXIgbm90IGZvdW5kIiBpbiBzdHJpY3QgbW9kZSwgYW5kIGluIEZpcmVmb3ggd2hpY2ggZG9lcyBub3QKICAgICAgICAgIC8vIHN1cHBvcnQgd2luZG93LmV2ZW50LgoKICAgICAgICAgIGlmICh0eXBlb2Ygd2luZG93LmV2ZW50ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cuaGFzT3duUHJvcGVydHkoJ2V2ZW50JykpIHsKICAgICAgICAgICAgd2luZG93LmV2ZW50ID0gd2luZG93RXZlbnQ7CiAgICAgICAgICB9CiAgICAgICAgfSAvLyBDcmVhdGUgYW4gZXZlbnQgaGFuZGxlciBmb3Igb3VyIGZha2UgZXZlbnQuIFdlIHdpbGwgc3luY2hyb25vdXNseQogICAgICAgIC8vIGRpc3BhdGNoIG91ciBmYWtlIGV2ZW50IHVzaW5nIGBkaXNwYXRjaEV2ZW50YC4gSW5zaWRlIHRoZSBoYW5kbGVyLCB3ZQogICAgICAgIC8vIGNhbGwgdGhlIHVzZXItcHJvdmlkZWQgY2FsbGJhY2suCgoKICAgICAgICB2YXIgZnVuY0FyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDMpOwoKICAgICAgICBmdW5jdGlvbiBjYWxsQ2FsbGJhY2soKSB7CiAgICAgICAgICBkaWRDYWxsID0gdHJ1ZTsKICAgICAgICAgIHJlc3RvcmVBZnRlckRpc3BhdGNoKCk7CiAgICAgICAgICBmdW5jLmFwcGx5KGNvbnRleHQsIGZ1bmNBcmdzKTsKICAgICAgICAgIGRpZEVycm9yID0gZmFsc2U7CiAgICAgICAgfSAvLyBDcmVhdGUgYSBnbG9iYWwgZXJyb3IgZXZlbnQgaGFuZGxlci4gV2UgdXNlIHRoaXMgdG8gY2FwdHVyZSB0aGUgdmFsdWUKICAgICAgICAvLyB0aGF0IHdhcyB0aHJvd24uIEl0J3MgcG9zc2libGUgdGhhdCB0aGlzIGVycm9yIGhhbmRsZXIgd2lsbCBmaXJlIG1vcmUKICAgICAgICAvLyB0aGFuIG9uY2U7IGZvciBleGFtcGxlLCBpZiBub24tUmVhY3QgY29kZSBhbHNvIGNhbGxzIGBkaXNwYXRjaEV2ZW50YAogICAgICAgIC8vIGFuZCBhIGhhbmRsZXIgZm9yIHRoYXQgZXZlbnQgdGhyb3dzLiBXZSBzaG91bGQgYmUgcmVzaWxpZW50IHRvIG1vc3Qgb2YKICAgICAgICAvLyB0aG9zZSBjYXNlcy4gRXZlbiBpZiBvdXIgZXJyb3IgZXZlbnQgaGFuZGxlciBmaXJlcyBtb3JlIHRoYW4gb25jZSwgdGhlCiAgICAgICAgLy8gbGFzdCBlcnJvciBldmVudCBpcyBhbHdheXMgdXNlZC4gSWYgdGhlIGNhbGxiYWNrIGFjdHVhbGx5IGRvZXMgZXJyb3IsCiAgICAgICAgLy8gd2Uga25vdyB0aGF0IHRoZSBsYXN0IGVycm9yIGV2ZW50IGlzIHRoZSBjb3JyZWN0IG9uZSwgYmVjYXVzZSBpdCdzIG5vdAogICAgICAgIC8vIHBvc3NpYmxlIGZvciBhbnl0aGluZyBlbHNlIHRvIGhhdmUgaGFwcGVuZWQgaW4gYmV0d2VlbiBvdXIgY2FsbGJhY2sKICAgICAgICAvLyBlcnJvcmluZyBhbmQgdGhlIGNvZGUgdGhhdCBmb2xsb3dzIHRoZSBgZGlzcGF0Y2hFdmVudGAgY2FsbCBiZWxvdy4gSWYKICAgICAgICAvLyB0aGUgY2FsbGJhY2sgZG9lc24ndCBlcnJvciwgYnV0IHRoZSBlcnJvciBldmVudCB3YXMgZmlyZWQsIHdlIGtub3cgdG8KICAgICAgICAvLyBpZ25vcmUgaXQgYmVjYXVzZSBgZGlkRXJyb3JgIHdpbGwgYmUgZmFsc2UsIGFzIGRlc2NyaWJlZCBhYm92ZS4KCgogICAgICAgIHZhciBlcnJvcjsgLy8gVXNlIHRoaXMgdG8gdHJhY2sgd2hldGhlciB0aGUgZXJyb3IgZXZlbnQgaXMgZXZlciBjYWxsZWQuCgogICAgICAgIHZhciBkaWRTZXRFcnJvciA9IGZhbHNlOwogICAgICAgIHZhciBpc0Nyb3NzT3JpZ2luRXJyb3IgPSBmYWxzZTsKCiAgICAgICAgZnVuY3Rpb24gaGFuZGxlV2luZG93RXJyb3IoZXZlbnQpIHsKICAgICAgICAgIGVycm9yID0gZXZlbnQuZXJyb3I7CiAgICAgICAgICBkaWRTZXRFcnJvciA9IHRydWU7CgogICAgICAgICAgaWYgKGVycm9yID09PSBudWxsICYmIGV2ZW50LmNvbG5vID09PSAwICYmIGV2ZW50LmxpbmVubyA9PT0gMCkgewogICAgICAgICAgICBpc0Nyb3NzT3JpZ2luRXJyb3IgPSB0cnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChldmVudC5kZWZhdWx0UHJldmVudGVkKSB7CiAgICAgICAgICAgIC8vIFNvbWUgb3RoZXIgZXJyb3IgaGFuZGxlciBoYXMgcHJldmVudGVkIGRlZmF1bHQuCiAgICAgICAgICAgIC8vIEJyb3dzZXJzIHNpbGVuY2UgdGhlIGVycm9yIHJlcG9ydCBpZiB0aGlzIGhhcHBlbnMuCiAgICAgICAgICAgIC8vIFdlJ2xsIHJlbWVtYmVyIHRoaXMgdG8gbGF0ZXIgZGVjaWRlIHdoZXRoZXIgdG8gbG9nIGl0IG9yIG5vdC4KICAgICAgICAgICAgaWYgKGVycm9yICE9IG51bGwgJiYgdHlwZW9mIGVycm9yID09PSAnb2JqZWN0JykgewogICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBlcnJvci5fc3VwcHJlc3NMb2dnaW5nID0gdHJ1ZTsKICAgICAgICAgICAgICB9IGNhdGNoIChpbm5lcikgey8vIElnbm9yZS4KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IC8vIENyZWF0ZSBhIGZha2UgZXZlbnQgdHlwZS4KCgogICAgICAgIHZhciBldnRUeXBlID0gInJlYWN0LSIgKyAobmFtZSA/IG5hbWUgOiAnaW52b2tlZ3VhcmRlZGNhbGxiYWNrJyk7IC8vIEF0dGFjaCBvdXIgZXZlbnQgaGFuZGxlcnMKCiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgaGFuZGxlV2luZG93RXJyb3IpOwogICAgICAgIGZha2VOb2RlLmFkZEV2ZW50TGlzdGVuZXIoZXZ0VHlwZSwgY2FsbENhbGxiYWNrLCBmYWxzZSk7IC8vIFN5bmNocm9ub3VzbHkgZGlzcGF0Y2ggb3VyIGZha2UgZXZlbnQuIElmIHRoZSB1c2VyLXByb3ZpZGVkIGZ1bmN0aW9uCiAgICAgICAgLy8gZXJyb3JzLCBpdCB3aWxsIHRyaWdnZXIgb3VyIGdsb2JhbCBlcnJvciBoYW5kbGVyLgoKICAgICAgICBldnQuaW5pdEV2ZW50KGV2dFR5cGUsIGZhbHNlLCBmYWxzZSk7CiAgICAgICAgZmFrZU5vZGUuZGlzcGF0Y2hFdmVudChldnQpOwoKICAgICAgICBpZiAod2luZG93RXZlbnREZXNjcmlwdG9yKSB7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkod2luZG93LCAnZXZlbnQnLCB3aW5kb3dFdmVudERlc2NyaXB0b3IpOwogICAgICAgIH0KCiAgICAgICAgaWYgKGRpZENhbGwgJiYgZGlkRXJyb3IpIHsKICAgICAgICAgIGlmICghZGlkU2V0RXJyb3IpIHsKICAgICAgICAgICAgLy8gVGhlIGNhbGxiYWNrIGVycm9yZWQsIGJ1dCB0aGUgZXJyb3IgZXZlbnQgbmV2ZXIgZmlyZWQuCiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC1pbnRlcm5hbC9wcm9kLWVycm9yLWNvZGVzCiAgICAgICAgICAgIGVycm9yID0gbmV3IEVycm9yKCdBbiBlcnJvciB3YXMgdGhyb3duIGluc2lkZSBvbmUgb2YgeW91ciBjb21wb25lbnRzLCBidXQgUmVhY3QgJyArICJkb2Vzbid0IGtub3cgd2hhdCBpdCB3YXMuIFRoaXMgaXMgbGlrZWx5IGR1ZSB0byBicm93c2VyICIgKyAnZmxha2luZXNzLiBSZWFjdCBkb2VzIGl0cyBiZXN0IHRvIHByZXNlcnZlIHRoZSAiUGF1c2Ugb24gJyArICdleGNlcHRpb25zIiBiZWhhdmlvciBvZiB0aGUgRGV2VG9vbHMsIHdoaWNoIHJlcXVpcmVzIHNvbWUgJyArICJERVYtbW9kZSBvbmx5IHRyaWNrcy4gSXQncyBwb3NzaWJsZSB0aGF0IHRoZXNlIGRvbid0IHdvcmsgaW4gIiArICd5b3VyIGJyb3dzZXIuIFRyeSB0cmlnZ2VyaW5nIHRoZSBlcnJvciBpbiBwcm9kdWN0aW9uIG1vZGUsICcgKyAnb3Igc3dpdGNoaW5nIHRvIGEgbW9kZXJuIGJyb3dzZXIuIElmIHlvdSBzdXNwZWN0IHRoYXQgdGhpcyBpcyAnICsgJ2FjdHVhbGx5IGFuIGlzc3VlIHdpdGggUmVhY3QsIHBsZWFzZSBmaWxlIGFuIGlzc3VlLicpOwogICAgICAgICAgfSBlbHNlIGlmIChpc0Nyb3NzT3JpZ2luRXJyb3IpIHsKICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0LWludGVybmFsL3Byb2QtZXJyb3ItY29kZXMKICAgICAgICAgICAgZXJyb3IgPSBuZXcgRXJyb3IoIkEgY3Jvc3Mtb3JpZ2luIGVycm9yIHdhcyB0aHJvd24uIFJlYWN0IGRvZXNuJ3QgaGF2ZSBhY2Nlc3MgdG8gIiArICd0aGUgYWN0dWFsIGVycm9yIG9iamVjdCBpbiBkZXZlbG9wbWVudC4gJyArICdTZWUgaHR0cHM6Ly9yZWFjdGpzLm9yZy9saW5rL2Nyb3Nzb3JpZ2luLWVycm9yIGZvciBtb3JlIGluZm9ybWF0aW9uLicpOwogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMub25FcnJvcihlcnJvcik7CiAgICAgICAgfSAvLyBSZW1vdmUgb3VyIGV2ZW50IGxpc3RlbmVycwoKCiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgaGFuZGxlV2luZG93RXJyb3IpOwoKICAgICAgICBpZiAoIWRpZENhbGwpIHsKICAgICAgICAgIC8vIFNvbWV0aGluZyB3ZW50IHJlYWxseSB3cm9uZywgYW5kIG91ciBldmVudCB3YXMgbm90IGRpc3BhdGNoZWQuCiAgICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2svcmVhY3QvaXNzdWVzLzE2NzM0CiAgICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2svcmVhY3QvaXNzdWVzLzE2NTg1CiAgICAgICAgICAvLyBGYWxsIGJhY2sgdG8gdGhlIHByb2R1Y3Rpb24gaW1wbGVtZW50YXRpb24uCiAgICAgICAgICByZXN0b3JlQWZ0ZXJEaXNwYXRjaCgpOwogICAgICAgICAgcmV0dXJuIGludm9rZUd1YXJkZWRDYWxsYmFja1Byb2QuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICB9CiAgICAgIH07CiAgICB9CiAgfQoKICB2YXIgaW52b2tlR3VhcmRlZENhbGxiYWNrSW1wbCQxID0gaW52b2tlR3VhcmRlZENhbGxiYWNrSW1wbDsKCiAgdmFyIGhhc0Vycm9yID0gZmFsc2U7CiAgdmFyIGNhdWdodEVycm9yID0gbnVsbDsgLy8gVXNlZCBieSBldmVudCBzeXN0ZW0gdG8gY2FwdHVyZS9yZXRocm93IHRoZSBmaXJzdCBlcnJvci4KCiAgdmFyIGhhc1JldGhyb3dFcnJvciA9IGZhbHNlOwogIHZhciByZXRocm93RXJyb3IgPSBudWxsOwogIHZhciByZXBvcnRlciA9IHsKICAgIG9uRXJyb3I6IGZ1bmN0aW9uIChlcnJvcikgewogICAgICBoYXNFcnJvciA9IHRydWU7CiAgICAgIGNhdWdodEVycm9yID0gZXJyb3I7CiAgICB9CiAgfTsKICAvKioKICAgKiBDYWxsIGEgZnVuY3Rpb24gd2hpbGUgZ3VhcmRpbmcgYWdhaW5zdCBlcnJvcnMgdGhhdCBoYXBwZW5zIHdpdGhpbiBpdC4KICAgKiBSZXR1cm5zIGFuIGVycm9yIGlmIGl0IHRocm93cywgb3RoZXJ3aXNlIG51bGwuCiAgICoKICAgKiBJbiBwcm9kdWN0aW9uLCB0aGlzIGlzIGltcGxlbWVudGVkIHVzaW5nIGEgdHJ5LWNhdGNoLiBUaGUgcmVhc29uIHdlIGRvbid0CiAgICogdXNlIGEgdHJ5LWNhdGNoIGRpcmVjdGx5IGlzIHNvIHRoYXQgd2UgY2FuIHN3YXAgb3V0IGEgZGlmZmVyZW50CiAgICogaW1wbGVtZW50YXRpb24gaW4gREVWIG1vZGUuCiAgICoKICAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZSBvZiB0aGUgZ3VhcmQgdG8gdXNlIGZvciBsb2dnaW5nIG9yIGRlYnVnZ2luZwogICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMgVGhlIGZ1bmN0aW9uIHRvIGludm9rZQogICAqIEBwYXJhbSB7Kn0gY29udGV4dCBUaGUgY29udGV4dCB0byB1c2Ugd2hlbiBjYWxsaW5nIHRoZSBmdW5jdGlvbgogICAqIEBwYXJhbSB7Li4uKn0gYXJncyBBcmd1bWVudHMgZm9yIGZ1bmN0aW9uCiAgICovCgogIGZ1bmN0aW9uIGludm9rZUd1YXJkZWRDYWxsYmFjayhuYW1lLCBmdW5jLCBjb250ZXh0LCBhLCBiLCBjLCBkLCBlLCBmKSB7CiAgICBoYXNFcnJvciA9IGZhbHNlOwogICAgY2F1Z2h0RXJyb3IgPSBudWxsOwogICAgaW52b2tlR3VhcmRlZENhbGxiYWNrSW1wbCQxLmFwcGx5KHJlcG9ydGVyLCBhcmd1bWVudHMpOwogIH0KICAvKioKICAgKiBTYW1lIGFzIGludm9rZUd1YXJkZWRDYWxsYmFjaywgYnV0IGluc3RlYWQgb2YgcmV0dXJuaW5nIGFuIGVycm9yLCBpdCBzdG9yZXMKICAgKiBpdCBpbiBhIGdsb2JhbCBzbyBpdCBjYW4gYmUgcmV0aHJvd24gYnkgYHJldGhyb3dDYXVnaHRFcnJvcmAgbGF0ZXIuCiAgICogVE9ETzogU2VlIGlmIGNhdWdodEVycm9yIGFuZCByZXRocm93RXJyb3IgY2FuIGJlIHVuaWZpZWQuCiAgICoKICAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZSBvZiB0aGUgZ3VhcmQgdG8gdXNlIGZvciBsb2dnaW5nIG9yIGRlYnVnZ2luZwogICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMgVGhlIGZ1bmN0aW9uIHRvIGludm9rZQogICAqIEBwYXJhbSB7Kn0gY29udGV4dCBUaGUgY29udGV4dCB0byB1c2Ugd2hlbiBjYWxsaW5nIHRoZSBmdW5jdGlvbgogICAqIEBwYXJhbSB7Li4uKn0gYXJncyBBcmd1bWVudHMgZm9yIGZ1bmN0aW9uCiAgICovCgogIGZ1bmN0aW9uIGludm9rZUd1YXJkZWRDYWxsYmFja0FuZENhdGNoRmlyc3RFcnJvcihuYW1lLCBmdW5jLCBjb250ZXh0LCBhLCBiLCBjLCBkLCBlLCBmKSB7CiAgICBpbnZva2VHdWFyZGVkQ2FsbGJhY2suYXBwbHkodGhpcywgYXJndW1lbnRzKTsKCiAgICBpZiAoaGFzRXJyb3IpIHsKICAgICAgdmFyIGVycm9yID0gY2xlYXJDYXVnaHRFcnJvcigpOwoKICAgICAgaWYgKCFoYXNSZXRocm93RXJyb3IpIHsKICAgICAgICBoYXNSZXRocm93RXJyb3IgPSB0cnVlOwogICAgICAgIHJldGhyb3dFcnJvciA9IGVycm9yOwogICAgICB9CiAgICB9CiAgfQogIC8qKgogICAqIER1cmluZyBleGVjdXRpb24gb2YgZ3VhcmRlZCBmdW5jdGlvbnMgd2Ugd2lsbCBjYXB0dXJlIHRoZSBmaXJzdCBlcnJvciB3aGljaAogICAqIHdlIHdpbGwgcmV0aHJvdyB0byBiZSBoYW5kbGVkIGJ5IHRoZSB0b3AgbGV2ZWwgZXJyb3IgaGFuZGxlci4KICAgKi8KCiAgZnVuY3Rpb24gcmV0aHJvd0NhdWdodEVycm9yKCkgewogICAgaWYgKGhhc1JldGhyb3dFcnJvcikgewogICAgICB2YXIgZXJyb3IgPSByZXRocm93RXJyb3I7CiAgICAgIGhhc1JldGhyb3dFcnJvciA9IGZhbHNlOwogICAgICByZXRocm93RXJyb3IgPSBudWxsOwogICAgICB0aHJvdyBlcnJvcjsKICAgIH0KICB9CiAgZnVuY3Rpb24gaGFzQ2F1Z2h0RXJyb3IoKSB7CiAgICByZXR1cm4gaGFzRXJyb3I7CiAgfQogIGZ1bmN0aW9uIGNsZWFyQ2F1Z2h0RXJyb3IoKSB7CiAgICBpZiAoaGFzRXJyb3IpIHsKICAgICAgdmFyIGVycm9yID0gY2F1Z2h0RXJyb3I7CiAgICAgIGhhc0Vycm9yID0gZmFsc2U7CiAgICAgIGNhdWdodEVycm9yID0gbnVsbDsKICAgICAgcmV0dXJuIGVycm9yOwogICAgfSBlbHNlIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdjbGVhckNhdWdodEVycm9yIHdhcyBjYWxsZWQgYnV0IG5vIGVycm9yIHdhcyBjYXB0dXJlZC4gVGhpcyBlcnJvciAnICsgJ2lzIGxpa2VseSBjYXVzZWQgYnkgYSBidWcgaW4gUmVhY3QuIFBsZWFzZSBmaWxlIGFuIGlzc3VlLicpOwogICAgfQogIH0KCiAgdmFyIFJlYWN0SW50ZXJuYWxzID0gUmVhY3QuX19TRUNSRVRfSU5URVJOQUxTX0RPX05PVF9VU0VfT1JfWU9VX1dJTExfQkVfRklSRUQ7CiAgdmFyIF9SZWFjdEludGVybmFscyRTY2hlZCA9IFJlYWN0SW50ZXJuYWxzLlNjaGVkdWxlciwKICAgICAgdW5zdGFibGVfY2FuY2VsQ2FsbGJhY2sgPSBfUmVhY3RJbnRlcm5hbHMkU2NoZWQudW5zdGFibGVfY2FuY2VsQ2FsbGJhY2ssCiAgICAgIHVuc3RhYmxlX25vdyA9IF9SZWFjdEludGVybmFscyRTY2hlZC51bnN0YWJsZV9ub3csCiAgICAgIHVuc3RhYmxlX3NjaGVkdWxlQ2FsbGJhY2sgPSBfUmVhY3RJbnRlcm5hbHMkU2NoZWQudW5zdGFibGVfc2NoZWR1bGVDYWxsYmFjaywKICAgICAgdW5zdGFibGVfc2hvdWxkWWllbGQgPSBfUmVhY3RJbnRlcm5hbHMkU2NoZWQudW5zdGFibGVfc2hvdWxkWWllbGQsCiAgICAgIHVuc3RhYmxlX3JlcXVlc3RQYWludCA9IF9SZWFjdEludGVybmFscyRTY2hlZC51bnN0YWJsZV9yZXF1ZXN0UGFpbnQsCiAgICAgIHVuc3RhYmxlX2dldEZpcnN0Q2FsbGJhY2tOb2RlID0gX1JlYWN0SW50ZXJuYWxzJFNjaGVkLnVuc3RhYmxlX2dldEZpcnN0Q2FsbGJhY2tOb2RlLAogICAgICB1bnN0YWJsZV9ydW5XaXRoUHJpb3JpdHkgPSBfUmVhY3RJbnRlcm5hbHMkU2NoZWQudW5zdGFibGVfcnVuV2l0aFByaW9yaXR5LAogICAgICB1bnN0YWJsZV9uZXh0ID0gX1JlYWN0SW50ZXJuYWxzJFNjaGVkLnVuc3RhYmxlX25leHQsCiAgICAgIHVuc3RhYmxlX2NvbnRpbnVlRXhlY3V0aW9uID0gX1JlYWN0SW50ZXJuYWxzJFNjaGVkLnVuc3RhYmxlX2NvbnRpbnVlRXhlY3V0aW9uLAogICAgICB1bnN0YWJsZV9wYXVzZUV4ZWN1dGlvbiA9IF9SZWFjdEludGVybmFscyRTY2hlZC51bnN0YWJsZV9wYXVzZUV4ZWN1dGlvbiwKICAgICAgdW5zdGFibGVfZ2V0Q3VycmVudFByaW9yaXR5TGV2ZWwgPSBfUmVhY3RJbnRlcm5hbHMkU2NoZWQudW5zdGFibGVfZ2V0Q3VycmVudFByaW9yaXR5TGV2ZWwsCiAgICAgIHVuc3RhYmxlX0ltbWVkaWF0ZVByaW9yaXR5ID0gX1JlYWN0SW50ZXJuYWxzJFNjaGVkLnVuc3RhYmxlX0ltbWVkaWF0ZVByaW9yaXR5LAogICAgICB1bnN0YWJsZV9Vc2VyQmxvY2tpbmdQcmlvcml0eSA9IF9SZWFjdEludGVybmFscyRTY2hlZC51bnN0YWJsZV9Vc2VyQmxvY2tpbmdQcmlvcml0eSwKICAgICAgdW5zdGFibGVfTm9ybWFsUHJpb3JpdHkgPSBfUmVhY3RJbnRlcm5hbHMkU2NoZWQudW5zdGFibGVfTm9ybWFsUHJpb3JpdHksCiAgICAgIHVuc3RhYmxlX0xvd1ByaW9yaXR5ID0gX1JlYWN0SW50ZXJuYWxzJFNjaGVkLnVuc3RhYmxlX0xvd1ByaW9yaXR5LAogICAgICB1bnN0YWJsZV9JZGxlUHJpb3JpdHkgPSBfUmVhY3RJbnRlcm5hbHMkU2NoZWQudW5zdGFibGVfSWRsZVByaW9yaXR5LAogICAgICB1bnN0YWJsZV9mb3JjZUZyYW1lUmF0ZSA9IF9SZWFjdEludGVybmFscyRTY2hlZC51bnN0YWJsZV9mb3JjZUZyYW1lUmF0ZSwKICAgICAgdW5zdGFibGVfZmx1c2hBbGxXaXRob3V0QXNzZXJ0aW5nID0gX1JlYWN0SW50ZXJuYWxzJFNjaGVkLnVuc3RhYmxlX2ZsdXNoQWxsV2l0aG91dEFzc2VydGluZywKICAgICAgdW5zdGFibGVfeWllbGRWYWx1ZSA9IF9SZWFjdEludGVybmFscyRTY2hlZC51bnN0YWJsZV95aWVsZFZhbHVlLAogICAgICB1bnN0YWJsZV9zZXREaXNhYmxlWWllbGRWYWx1ZSA9IF9SZWFjdEludGVybmFscyRTY2hlZC51bnN0YWJsZV9zZXREaXNhYmxlWWllbGRWYWx1ZTsKCiAgLyoqCiAgICogYFJlYWN0SW5zdGFuY2VNYXBgIG1haW50YWlucyBhIG1hcHBpbmcgZnJvbSBhIHB1YmxpYyBmYWNpbmcgc3RhdGVmdWwKICAgKiBpbnN0YW5jZSAoa2V5KSBhbmQgdGhlIGludGVybmFsIHJlcHJlc2VudGF0aW9uICh2YWx1ZSkuIFRoaXMgYWxsb3dzIHB1YmxpYwogICAqIG1ldGhvZHMgdG8gYWNjZXB0IHRoZSB1c2VyIGZhY2luZyBpbnN0YW5jZSBhcyBhbiBhcmd1bWVudCBhbmQgbWFwIHRoZW0gYmFjawogICAqIHRvIGludGVybmFsIG1ldGhvZHMuCiAgICoKICAgKiBOb3RlIHRoYXQgdGhpcyBtb2R1bGUgaXMgY3VycmVudGx5IHNoYXJlZCBhbmQgYXNzdW1lZCB0byBiZSBzdGF0ZWxlc3MuCiAgICogSWYgdGhpcyBiZWNvbWVzIGFuIGFjdHVhbCBNYXAsIHRoYXQgd2lsbCBicmVhay4KICAgKi8KICBmdW5jdGlvbiBnZXQoa2V5KSB7CiAgICByZXR1cm4ga2V5Ll9yZWFjdEludGVybmFsczsKICB9CiAgZnVuY3Rpb24gaGFzKGtleSkgewogICAgcmV0dXJuIGtleS5fcmVhY3RJbnRlcm5hbHMgIT09IHVuZGVmaW5lZDsKICB9CiAgZnVuY3Rpb24gc2V0KGtleSwgdmFsdWUpIHsKICAgIGtleS5fcmVhY3RJbnRlcm5hbHMgPSB2YWx1ZTsKICB9CgogIC8vIERvbid0IGNoYW5nZSB0aGVzZSB0d28gdmFsdWVzLiBUaGV5J3JlIHVzZWQgYnkgUmVhY3QgRGV2IFRvb2xzLgogIHZhciBOb0ZsYWdzID0KICAvKiAgICAgICAgICAgICAgICAgICAgICAqLwogIDA7CiAgdmFyIFBlcmZvcm1lZFdvcmsgPQogIC8qICAgICAgICAgICAgICAgICovCiAgMTsgLy8gWW91IGNhbiBjaGFuZ2UgdGhlIHJlc3QgKGFuZCBhZGQgbW9yZSkuCgogIHZhciBQbGFjZW1lbnQgPQogIC8qICAgICAgICAgICAgICAgICAgICAqLwogIDI7CiAgdmFyIFVwZGF0ZSA9CiAgLyogICAgICAgICAgICAgICAgICAgICAgICovCiAgNDsKICB2YXIgQ2hpbGREZWxldGlvbiA9CiAgLyogICAgICAgICAgICAgICAgKi8KICAxNjsKICB2YXIgQ29udGVudFJlc2V0ID0KICAvKiAgICAgICAgICAgICAgICAgKi8KICAzMjsKICB2YXIgQ2FsbGJhY2sgPQogIC8qICAgICAgICAgICAgICAgICAgICAgKi8KICA2NDsKICB2YXIgRGlkQ2FwdHVyZSA9CiAgLyogICAgICAgICAgICAgICAgICAgKi8KICAxMjg7CiAgdmFyIEZvcmNlQ2xpZW50UmVuZGVyID0KICAvKiAgICAgICAgICAgICovCiAgMjU2OwogIHZhciBSZWYgPQogIC8qICAgICAgICAgICAgICAgICAgICAgICAgICAqLwogIDUxMjsKICB2YXIgU25hcHNob3QgPQogIC8qICAgICAgICAgICAgICAgICAgICAgKi8KICAxMDI0OwogIHZhciBQYXNzaXZlID0KICAvKiAgICAgICAgICAgICAgICAgICAgICAqLwogIDIwNDg7CiAgdmFyIEh5ZHJhdGluZyA9CiAgLyogICAgICAgICAgICAgICAgICAgICovCiAgNDA5NjsKICB2YXIgVmlzaWJpbGl0eSA9CiAgLyogICAgICAgICAgICAgICAgICAgKi8KICA4MTkyOwogIHZhciBTdG9yZUNvbnNpc3RlbmN5ID0KICAvKiAgICAgICAgICAgICAqLwogIDE2Mzg0OwogIHZhciBMaWZlY3ljbGVFZmZlY3RNYXNrID0gUGFzc2l2ZSB8IFVwZGF0ZSB8IENhbGxiYWNrIHwgUmVmIHwgU25hcHNob3QgfCBTdG9yZUNvbnNpc3RlbmN5OyAvLyBVbmlvbiBvZiBhbGwgY29tbWl0IGZsYWdzIChmbGFncyB3aXRoIHRoZSBsaWZldGltZSBvZiBhIHBhcnRpY3VsYXIgY29tbWl0KQoKICB2YXIgSG9zdEVmZmVjdE1hc2sgPQogIC8qICAgICAgICAgICAgICAgKi8KICAzMjc2NzsgLy8gVGhlc2UgYXJlIG5vdCByZWFsbHkgc2lkZSBlZmZlY3RzLCBidXQgd2Ugc3RpbGwgcmV1c2UgdGhpcyBmaWVsZC4KCiAgdmFyIEluY29tcGxldGUgPQogIC8qICAgICAgICAgICAgICAgICAgICovCiAgMzI3Njg7CiAgdmFyIFNob3VsZENhcHR1cmUgPQogIC8qICAgICAgICAgICAgICAgICovCiAgNjU1MzY7CiAgdmFyIEZvcmNlVXBkYXRlRm9yTGVnYWN5U3VzcGVuc2UgPQogIC8qICovCiAgMTMxMDcyOwogIHZhciBGb3JrZWQgPQogIC8qICAgICAgICAgICAgICAgICAgICAgICAqLwogIDEwNDg1NzY7IC8vIFN0YXRpYyB0YWdzIGRlc2NyaWJlIGFzcGVjdHMgb2YgYSBmaWJlciB0aGF0IGFyZSBub3Qgc3BlY2lmaWMgdG8gYSByZW5kZXIsCiAgLy8gZS5nLiBhIGZpYmVyIHVzZXMgYSBwYXNzaXZlIGVmZmVjdCAoZXZlbiBpZiB0aGVyZSBhcmUgbm8gdXBkYXRlcyBvbiB0aGlzIHBhcnRpY3VsYXIgcmVuZGVyKS4KICAvLyBUaGlzIGVuYWJsZXMgdXMgdG8gZGVmZXIgbW9yZSB3b3JrIGluIHRoZSB1bm1vdW50IGNhc2UsCiAgLy8gc2luY2Ugd2UgY2FuIGRlZmVyIHRyYXZlcnNpbmcgdGhlIHRyZWUgZHVyaW5nIGxheW91dCB0byBsb29rIGZvciBQYXNzaXZlIGVmZmVjdHMsCiAgLy8gYW5kIGluc3RlYWQgcmVseSBvbiB0aGUgc3RhdGljIGZsYWcgYXMgYSBzaWduYWwgdGhhdCB0aGVyZSBtYXkgYmUgY2xlYW51cCB3b3JrLgoKICB2YXIgUmVmU3RhdGljID0KICAvKiAgICAgICAgICAgICAgICAgICAgKi8KICAyMDk3MTUyOwogIHZhciBMYXlvdXRTdGF0aWMgPQogIC8qICAgICAgICAgICAgICAgICAqLwogIDQxOTQzMDQ7CiAgdmFyIFBhc3NpdmVTdGF0aWMgPQogIC8qICAgICAgICAgICAgICAgICovCiAgODM4ODYwODsgLy8gVGhlc2UgZmxhZ3MgYWxsb3cgdXMgdG8gdHJhdmVyc2UgdG8gZmliZXJzIHRoYXQgaGF2ZSBlZmZlY3RzIG9uIG1vdW50CiAgLy8gd2l0aG91dCB0cmF2ZXJzaW5nIHRoZSBlbnRpcmUgdHJlZSBhZnRlciBldmVyeSBjb21taXQgZm9yCiAgLy8gZG91YmxlIGludm9raW5nCgogIHZhciBNb3VudExheW91dERldiA9CiAgLyogICAgICAgICAgICAgICAqLwogIDE2Nzc3MjE2OwogIHZhciBNb3VudFBhc3NpdmVEZXYgPQogIC8qICAgICAgICAgICAgICAqLwogIDMzNTU0NDMyOyAvLyBHcm91cHMgb2YgZmxhZ3MgdGhhdCBhcmUgdXNlZCBpbiB0aGUgY29tbWl0IHBoYXNlIHRvIHNraXAgb3ZlciB0cmVlcyB0aGF0CiAgLy8gZG9uJ3QgY29udGFpbiBlZmZlY3RzLCBieSBjaGVja2luZyBzdWJ0cmVlRmxhZ3MuCgogIHZhciBCZWZvcmVNdXRhdGlvbk1hc2sgPSAvLyBUT0RPOiBSZW1vdmUgVXBkYXRlIGZsYWcgZnJvbSBiZWZvcmUgbXV0YXRpb24gcGhhc2UgYnkgcmUtbGFuZGluZyBWaXNpYmlsaXR5CiAgLy8gZmxhZyBsb2dpYyAoc2VlICMyMDA0MykKICBVcGRhdGUgfCBTbmFwc2hvdCB8ICggMCk7CiAgdmFyIE11dGF0aW9uTWFzayA9IFBsYWNlbWVudCB8IFVwZGF0ZSB8IENoaWxkRGVsZXRpb24gfCBDb250ZW50UmVzZXQgfCBSZWYgfCBIeWRyYXRpbmcgfCBWaXNpYmlsaXR5OwogIHZhciBMYXlvdXRNYXNrID0gVXBkYXRlIHwgQ2FsbGJhY2sgfCBSZWYgfCBWaXNpYmlsaXR5OyAvLyBUT0RPOiBTcGxpdCBpbnRvIFBhc3NpdmVNb3VudE1hc2sgYW5kIFBhc3NpdmVVbm1vdW50TWFzawoKICB2YXIgUGFzc2l2ZU1hc2sgPSBQYXNzaXZlIHwgQ2hpbGREZWxldGlvbjsgLy8gVW5pb24gb2YgdGFncyB0aGF0IGRvbid0IGdldCByZXNldCBvbiBjbG9uZXMuCiAgLy8gVGhpcyBhbGxvd3MgY2VydGFpbiBjb25jZXB0cyB0byBwZXJzaXN0IHdpdGhvdXQgcmVjYWxjdWxhdGluZyB0aGVtLAogIC8vIGUuZy4gd2hldGhlciBhIHN1YnRyZWUgY29udGFpbnMgcGFzc2l2ZSBlZmZlY3RzIG9yIHBvcnRhbHMuCgogIHZhciBTdGF0aWNNYXNrID0gTGF5b3V0U3RhdGljIHwgUGFzc2l2ZVN0YXRpYyB8IFJlZlN0YXRpYzsKCiAgdmFyIFJlYWN0Q3VycmVudE93bmVyID0gUmVhY3RTaGFyZWRJbnRlcm5hbHMuUmVhY3RDdXJyZW50T3duZXI7CiAgZnVuY3Rpb24gZ2V0TmVhcmVzdE1vdW50ZWRGaWJlcihmaWJlcikgewogICAgdmFyIG5vZGUgPSBmaWJlcjsKICAgIHZhciBuZWFyZXN0TW91bnRlZCA9IGZpYmVyOwoKICAgIGlmICghZmliZXIuYWx0ZXJuYXRlKSB7CiAgICAgIC8vIElmIHRoZXJlIGlzIG5vIGFsdGVybmF0ZSwgdGhpcyBtaWdodCBiZSBhIG5ldyB0cmVlIHRoYXQgaXNuJ3QgaW5zZXJ0ZWQKICAgICAgLy8geWV0LiBJZiBpdCBpcywgdGhlbiBpdCB3aWxsIGhhdmUgYSBwZW5kaW5nIGluc2VydGlvbiBlZmZlY3Qgb24gaXQuCiAgICAgIHZhciBuZXh0Tm9kZSA9IG5vZGU7CgogICAgICBkbyB7CiAgICAgICAgbm9kZSA9IG5leHROb2RlOwoKICAgICAgICBpZiAoKG5vZGUuZmxhZ3MgJiAoUGxhY2VtZW50IHwgSHlkcmF0aW5nKSkgIT09IE5vRmxhZ3MpIHsKICAgICAgICAgIC8vIFRoaXMgaXMgYW4gaW5zZXJ0aW9uIG9yIGluLXByb2dyZXNzIGh5ZHJhdGlvbi4gVGhlIG5lYXJlc3QgcG9zc2libGUKICAgICAgICAgIC8vIG1vdW50ZWQgZmliZXIgaXMgdGhlIHBhcmVudCBidXQgd2UgbmVlZCB0byBjb250aW51ZSB0byBmaWd1cmUgb3V0CiAgICAgICAgICAvLyBpZiB0aGF0IG9uZSBpcyBzdGlsbCBtb3VudGVkLgogICAgICAgICAgbmVhcmVzdE1vdW50ZWQgPSBub2RlLnJldHVybjsKICAgICAgICB9CgogICAgICAgIG5leHROb2RlID0gbm9kZS5yZXR1cm47CiAgICAgIH0gd2hpbGUgKG5leHROb2RlKTsKICAgIH0gZWxzZSB7CiAgICAgIHdoaWxlIChub2RlLnJldHVybikgewogICAgICAgIG5vZGUgPSBub2RlLnJldHVybjsKICAgICAgfQogICAgfQoKICAgIGlmIChub2RlLnRhZyA9PT0gSG9zdFJvb3QpIHsKICAgICAgLy8gVE9ETzogQ2hlY2sgaWYgdGhpcyB3YXMgYSBuZXN0ZWQgSG9zdFJvb3Qgd2hlbiB1c2VkIHdpdGgKICAgICAgLy8gcmVuZGVyQ29udGFpbmVySW50b1N1YnRyZWUuCiAgICAgIHJldHVybiBuZWFyZXN0TW91bnRlZDsKICAgIH0gLy8gSWYgd2UgZGlkbid0IGhpdCB0aGUgcm9vdCwgdGhhdCBtZWFucyB0aGF0IHdlJ3JlIGluIGFuIGRpc2Nvbm5lY3RlZCB0cmVlCiAgICAvLyB0aGF0IGhhcyBiZWVuIHVubW91bnRlZC4KCgogICAgcmV0dXJuIG51bGw7CiAgfQogIGZ1bmN0aW9uIGdldFN1c3BlbnNlSW5zdGFuY2VGcm9tRmliZXIoZmliZXIpIHsKICAgIGlmIChmaWJlci50YWcgPT09IFN1c3BlbnNlQ29tcG9uZW50KSB7CiAgICAgIHZhciBzdXNwZW5zZVN0YXRlID0gZmliZXIubWVtb2l6ZWRTdGF0ZTsKCiAgICAgIGlmIChzdXNwZW5zZVN0YXRlID09PSBudWxsKSB7CiAgICAgICAgdmFyIGN1cnJlbnQgPSBmaWJlci5hbHRlcm5hdGU7CgogICAgICAgIGlmIChjdXJyZW50ICE9PSBudWxsKSB7CiAgICAgICAgICBzdXNwZW5zZVN0YXRlID0gY3VycmVudC5tZW1vaXplZFN0YXRlOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHN1c3BlbnNlU3RhdGUgIT09IG51bGwpIHsKICAgICAgICByZXR1cm4gc3VzcGVuc2VTdGF0ZS5kZWh5ZHJhdGVkOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIG51bGw7CiAgfQogIGZ1bmN0aW9uIGdldENvbnRhaW5lckZyb21GaWJlcihmaWJlcikgewogICAgcmV0dXJuIGZpYmVyLnRhZyA9PT0gSG9zdFJvb3QgPyBmaWJlci5zdGF0ZU5vZGUuY29udGFpbmVySW5mbyA6IG51bGw7CiAgfQogIGZ1bmN0aW9uIGlzRmliZXJNb3VudGVkKGZpYmVyKSB7CiAgICByZXR1cm4gZ2V0TmVhcmVzdE1vdW50ZWRGaWJlcihmaWJlcikgPT09IGZpYmVyOwogIH0KICBmdW5jdGlvbiBpc01vdW50ZWQoY29tcG9uZW50KSB7CiAgICB7CiAgICAgIHZhciBvd25lciA9IFJlYWN0Q3VycmVudE93bmVyLmN1cnJlbnQ7CgogICAgICBpZiAob3duZXIgIT09IG51bGwgJiYgb3duZXIudGFnID09PSBDbGFzc0NvbXBvbmVudCkgewogICAgICAgIHZhciBvd25lckZpYmVyID0gb3duZXI7CiAgICAgICAgdmFyIGluc3RhbmNlID0gb3duZXJGaWJlci5zdGF0ZU5vZGU7CgogICAgICAgIGlmICghaW5zdGFuY2UuX3dhcm5lZEFib3V0UmVmc0luUmVuZGVyKSB7CiAgICAgICAgICBlcnJvcignJXMgaXMgYWNjZXNzaW5nIGlzTW91bnRlZCBpbnNpZGUgaXRzIHJlbmRlcigpIGZ1bmN0aW9uLiAnICsgJ3JlbmRlcigpIHNob3VsZCBiZSBhIHB1cmUgZnVuY3Rpb24gb2YgcHJvcHMgYW5kIHN0YXRlLiBJdCBzaG91bGQgJyArICduZXZlciBhY2Nlc3Mgc29tZXRoaW5nIHRoYXQgcmVxdWlyZXMgc3RhbGUgZGF0YSBmcm9tIHRoZSBwcmV2aW91cyAnICsgJ3JlbmRlciwgc3VjaCBhcyByZWZzLiBNb3ZlIHRoaXMgbG9naWMgdG8gY29tcG9uZW50RGlkTW91bnQgYW5kICcgKyAnY29tcG9uZW50RGlkVXBkYXRlIGluc3RlYWQuJywgZ2V0Q29tcG9uZW50TmFtZUZyb21GaWJlcihvd25lckZpYmVyKSB8fCAnQSBjb21wb25lbnQnKTsKICAgICAgICB9CgogICAgICAgIGluc3RhbmNlLl93YXJuZWRBYm91dFJlZnNJblJlbmRlciA9IHRydWU7CiAgICAgIH0KICAgIH0KCiAgICB2YXIgZmliZXIgPSBnZXQoY29tcG9uZW50KTsKCiAgICBpZiAoIWZpYmVyKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICByZXR1cm4gZ2V0TmVhcmVzdE1vdW50ZWRGaWJlcihmaWJlcikgPT09IGZpYmVyOwogIH0KCiAgZnVuY3Rpb24gYXNzZXJ0SXNNb3VudGVkKGZpYmVyKSB7CiAgICBpZiAoZ2V0TmVhcmVzdE1vdW50ZWRGaWJlcihmaWJlcikgIT09IGZpYmVyKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignVW5hYmxlIHRvIGZpbmQgbm9kZSBvbiBhbiB1bm1vdW50ZWQgY29tcG9uZW50LicpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gZmluZEN1cnJlbnRGaWJlclVzaW5nU2xvd1BhdGgoZmliZXIpIHsKICAgIHZhciBhbHRlcm5hdGUgPSBmaWJlci5hbHRlcm5hdGU7CgogICAgaWYgKCFhbHRlcm5hdGUpIHsKICAgICAgLy8gSWYgdGhlcmUgaXMgbm8gYWx0ZXJuYXRlLCB0aGVuIHdlIG9ubHkgbmVlZCB0byBjaGVjayBpZiBpdCBpcyBtb3VudGVkLgogICAgICB2YXIgbmVhcmVzdE1vdW50ZWQgPSBnZXROZWFyZXN0TW91bnRlZEZpYmVyKGZpYmVyKTsKCiAgICAgIGlmIChuZWFyZXN0TW91bnRlZCA9PT0gbnVsbCkgewogICAgICAgIHRocm93IG5ldyBFcnJvcignVW5hYmxlIHRvIGZpbmQgbm9kZSBvbiBhbiB1bm1vdW50ZWQgY29tcG9uZW50LicpOwogICAgICB9CgogICAgICBpZiAobmVhcmVzdE1vdW50ZWQgIT09IGZpYmVyKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIHJldHVybiBmaWJlcjsKICAgIH0gLy8gSWYgd2UgaGF2ZSB0d28gcG9zc2libGUgYnJhbmNoZXMsIHdlJ2xsIHdhbGsgYmFja3dhcmRzIHVwIHRvIHRoZSByb290CiAgICAvLyB0byBzZWUgd2hhdCBwYXRoIHRoZSByb290IHBvaW50cyB0by4gT24gdGhlIHdheSB3ZSBtYXkgaGl0IG9uZSBvZiB0aGUKICAgIC8vIHNwZWNpYWwgY2FzZXMgYW5kIHdlJ2xsIGRlYWwgd2l0aCB0aGVtLgoKCiAgICB2YXIgYSA9IGZpYmVyOwogICAgdmFyIGIgPSBhbHRlcm5hdGU7CgogICAgd2hpbGUgKHRydWUpIHsKICAgICAgdmFyIHBhcmVudEEgPSBhLnJldHVybjsKCiAgICAgIGlmIChwYXJlbnRBID09PSBudWxsKSB7CiAgICAgICAgLy8gV2UncmUgYXQgdGhlIHJvb3QuCiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIHZhciBwYXJlbnRCID0gcGFyZW50QS5hbHRlcm5hdGU7CgogICAgICBpZiAocGFyZW50QiA9PT0gbnVsbCkgewogICAgICAgIC8vIFRoZXJlIGlzIG5vIGFsdGVybmF0ZS4gVGhpcyBpcyBhbiB1bnVzdWFsIGNhc2UuIEN1cnJlbnRseSwgaXQgb25seQogICAgICAgIC8vIGhhcHBlbnMgd2hlbiBhIFN1c3BlbnNlIGNvbXBvbmVudCBpcyBoaWRkZW4uIEFuIGV4dHJhIGZyYWdtZW50IGZpYmVyCiAgICAgICAgLy8gaXMgaW5zZXJ0ZWQgaW4gYmV0d2VlbiB0aGUgU3VzcGVuc2UgZmliZXIgYW5kIGl0cyBjaGlsZHJlbi4gU2tpcAogICAgICAgIC8vIG92ZXIgdGhpcyBleHRyYSBmcmFnbWVudCBmaWJlciBhbmQgcHJvY2VlZCB0byB0aGUgbmV4dCBwYXJlbnQuCiAgICAgICAgdmFyIG5leHRQYXJlbnQgPSBwYXJlbnRBLnJldHVybjsKCiAgICAgICAgaWYgKG5leHRQYXJlbnQgIT09IG51bGwpIHsKICAgICAgICAgIGEgPSBiID0gbmV4dFBhcmVudDsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0gLy8gSWYgdGhlcmUncyBubyBwYXJlbnQsIHdlJ3JlIGF0IHRoZSByb290LgoKCiAgICAgICAgYnJlYWs7CiAgICAgIH0gLy8gSWYgYm90aCBjb3BpZXMgb2YgdGhlIHBhcmVudCBmaWJlciBwb2ludCB0byB0aGUgc2FtZSBjaGlsZCwgd2UgY2FuCiAgICAgIC8vIGFzc3VtZSB0aGF0IHRoZSBjaGlsZCBpcyBjdXJyZW50LiBUaGlzIGhhcHBlbnMgd2hlbiB3ZSBiYWlsb3V0IG9uIGxvdwogICAgICAvLyBwcmlvcml0eTogdGhlIGJhaWxlZCBvdXQgZmliZXIncyBjaGlsZCByZXVzZXMgdGhlIGN1cnJlbnQgY2hpbGQuCgoKICAgICAgaWYgKHBhcmVudEEuY2hpbGQgPT09IHBhcmVudEIuY2hpbGQpIHsKICAgICAgICB2YXIgY2hpbGQgPSBwYXJlbnRBLmNoaWxkOwoKICAgICAgICB3aGlsZSAoY2hpbGQpIHsKICAgICAgICAgIGlmIChjaGlsZCA9PT0gYSkgewogICAgICAgICAgICAvLyBXZSd2ZSBkZXRlcm1pbmVkIHRoYXQgQSBpcyB0aGUgY3VycmVudCBicmFuY2guCiAgICAgICAgICAgIGFzc2VydElzTW91bnRlZChwYXJlbnRBKTsKICAgICAgICAgICAgcmV0dXJuIGZpYmVyOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChjaGlsZCA9PT0gYikgewogICAgICAgICAgICAvLyBXZSd2ZSBkZXRlcm1pbmVkIHRoYXQgQiBpcyB0aGUgY3VycmVudCBicmFuY2guCiAgICAgICAgICAgIGFzc2VydElzTW91bnRlZChwYXJlbnRBKTsKICAgICAgICAgICAgcmV0dXJuIGFsdGVybmF0ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBjaGlsZCA9IGNoaWxkLnNpYmxpbmc7CiAgICAgICAgfSAvLyBXZSBzaG91bGQgbmV2ZXIgaGF2ZSBhbiBhbHRlcm5hdGUgZm9yIGFueSBtb3VudGluZyBub2RlLiBTbyB0aGUgb25seQogICAgICAgIC8vIHdheSB0aGlzIGNvdWxkIHBvc3NpYmx5IGhhcHBlbiBpcyBpZiB0aGlzIHdhcyB1bm1vdW50ZWQsIGlmIGF0IGFsbC4KCgogICAgICAgIHRocm93IG5ldyBFcnJvcignVW5hYmxlIHRvIGZpbmQgbm9kZSBvbiBhbiB1bm1vdW50ZWQgY29tcG9uZW50LicpOwogICAgICB9CgogICAgICBpZiAoYS5yZXR1cm4gIT09IGIucmV0dXJuKSB7CiAgICAgICAgLy8gVGhlIHJldHVybiBwb2ludGVyIG9mIEEgYW5kIHRoZSByZXR1cm4gcG9pbnRlciBvZiBCIHBvaW50IHRvIGRpZmZlcmVudAogICAgICAgIC8vIGZpYmVycy4gV2UgYXNzdW1lIHRoYXQgcmV0dXJuIHBvaW50ZXJzIG5ldmVyIGNyaXNzLWNyb3NzLCBzbyBBIG11c3QKICAgICAgICAvLyBiZWxvbmcgdG8gdGhlIGNoaWxkIHNldCBvZiBBLnJldHVybiwgYW5kIEIgbXVzdCBiZWxvbmcgdG8gdGhlIGNoaWxkCiAgICAgICAgLy8gc2V0IG9mIEIucmV0dXJuLgogICAgICAgIGEgPSBwYXJlbnRBOwogICAgICAgIGIgPSBwYXJlbnRCOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIFRoZSByZXR1cm4gcG9pbnRlcnMgcG9pbnQgdG8gdGhlIHNhbWUgZmliZXIuIFdlJ2xsIGhhdmUgdG8gdXNlIHRoZQogICAgICAgIC8vIGRlZmF1bHQsIHNsb3cgcGF0aDogc2NhbiB0aGUgY2hpbGQgc2V0cyBvZiBlYWNoIHBhcmVudCBhbHRlcm5hdGUgdG8gc2VlCiAgICAgICAgLy8gd2hpY2ggY2hpbGQgYmVsb25ncyB0byB3aGljaCBzZXQuCiAgICAgICAgLy8KICAgICAgICAvLyBTZWFyY2ggcGFyZW50IEEncyBjaGlsZCBzZXQKICAgICAgICB2YXIgZGlkRmluZENoaWxkID0gZmFsc2U7CiAgICAgICAgdmFyIF9jaGlsZCA9IHBhcmVudEEuY2hpbGQ7CgogICAgICAgIHdoaWxlIChfY2hpbGQpIHsKICAgICAgICAgIGlmIChfY2hpbGQgPT09IGEpIHsKICAgICAgICAgICAgZGlkRmluZENoaWxkID0gdHJ1ZTsKICAgICAgICAgICAgYSA9IHBhcmVudEE7CiAgICAgICAgICAgIGIgPSBwYXJlbnRCOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoX2NoaWxkID09PSBiKSB7CiAgICAgICAgICAgIGRpZEZpbmRDaGlsZCA9IHRydWU7CiAgICAgICAgICAgIGIgPSBwYXJlbnRBOwogICAgICAgICAgICBhID0gcGFyZW50QjsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgX2NoaWxkID0gX2NoaWxkLnNpYmxpbmc7CiAgICAgICAgfQoKICAgICAgICBpZiAoIWRpZEZpbmRDaGlsZCkgewogICAgICAgICAgLy8gU2VhcmNoIHBhcmVudCBCJ3MgY2hpbGQgc2V0CiAgICAgICAgICBfY2hpbGQgPSBwYXJlbnRCLmNoaWxkOwoKICAgICAgICAgIHdoaWxlIChfY2hpbGQpIHsKICAgICAgICAgICAgaWYgKF9jaGlsZCA9PT0gYSkgewogICAgICAgICAgICAgIGRpZEZpbmRDaGlsZCA9IHRydWU7CiAgICAgICAgICAgICAgYSA9IHBhcmVudEI7CiAgICAgICAgICAgICAgYiA9IHBhcmVudEE7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChfY2hpbGQgPT09IGIpIHsKICAgICAgICAgICAgICBkaWRGaW5kQ2hpbGQgPSB0cnVlOwogICAgICAgICAgICAgIGIgPSBwYXJlbnRCOwogICAgICAgICAgICAgIGEgPSBwYXJlbnRBOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBfY2hpbGQgPSBfY2hpbGQuc2libGluZzsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoIWRpZEZpbmRDaGlsZCkgewogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NoaWxkIHdhcyBub3QgZm91bmQgaW4gZWl0aGVyIHBhcmVudCBzZXQuIFRoaXMgaW5kaWNhdGVzIGEgYnVnICcgKyAnaW4gUmVhY3QgcmVsYXRlZCB0byB0aGUgcmV0dXJuIHBvaW50ZXIuIFBsZWFzZSBmaWxlIGFuIGlzc3VlLicpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGEuYWx0ZXJuYXRlICE9PSBiKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJSZXR1cm4gZmliZXJzIHNob3VsZCBhbHdheXMgYmUgZWFjaCBvdGhlcnMnIGFsdGVybmF0ZXMuICIgKyAnVGhpcyBlcnJvciBpcyBsaWtlbHkgY2F1c2VkIGJ5IGEgYnVnIGluIFJlYWN0LiBQbGVhc2UgZmlsZSBhbiBpc3N1ZS4nKTsKICAgICAgfQogICAgfSAvLyBJZiB0aGUgcm9vdCBpcyBub3QgYSBob3N0IGNvbnRhaW5lciwgd2UncmUgaW4gYSBkaXNjb25uZWN0ZWQgdHJlZS4gSS5lLgogICAgLy8gdW5tb3VudGVkLgoKCiAgICBpZiAoYS50YWcgIT09IEhvc3RSb290KSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignVW5hYmxlIHRvIGZpbmQgbm9kZSBvbiBhbiB1bm1vdW50ZWQgY29tcG9uZW50LicpOwogICAgfQoKICAgIGlmIChhLnN0YXRlTm9kZS5jdXJyZW50ID09PSBhKSB7CiAgICAgIC8vIFdlJ3ZlIGRldGVybWluZWQgdGhhdCBBIGlzIHRoZSBjdXJyZW50IGJyYW5jaC4KICAgICAgcmV0dXJuIGZpYmVyOwogICAgfSAvLyBPdGhlcndpc2UgQiBoYXMgdG8gYmUgY3VycmVudCBicmFuY2guCgoKICAgIHJldHVybiBhbHRlcm5hdGU7CiAgfQogIGZ1bmN0aW9uIGZpbmRDdXJyZW50SG9zdEZpYmVyKHBhcmVudCkgewogICAgdmFyIGN1cnJlbnRQYXJlbnQgPSBmaW5kQ3VycmVudEZpYmVyVXNpbmdTbG93UGF0aChwYXJlbnQpOwogICAgcmV0dXJuIGN1cnJlbnRQYXJlbnQgIT09IG51bGwgPyBmaW5kQ3VycmVudEhvc3RGaWJlckltcGwoY3VycmVudFBhcmVudCkgOiBudWxsOwogIH0KCiAgZnVuY3Rpb24gZmluZEN1cnJlbnRIb3N0RmliZXJJbXBsKG5vZGUpIHsKICAgIC8vIE5leHQgd2UnbGwgZHJpbGwgZG93biB0aGlzIGNvbXBvbmVudCB0byBmaW5kIHRoZSBmaXJzdCBIb3N0Q29tcG9uZW50L1RleHQuCiAgICBpZiAobm9kZS50YWcgPT09IEhvc3RDb21wb25lbnQgfHwgbm9kZS50YWcgPT09IEhvc3RUZXh0KSB7CiAgICAgIHJldHVybiBub2RlOwogICAgfQoKICAgIHZhciBjaGlsZCA9IG5vZGUuY2hpbGQ7CgogICAgd2hpbGUgKGNoaWxkICE9PSBudWxsKSB7CiAgICAgIHZhciBtYXRjaCA9IGZpbmRDdXJyZW50SG9zdEZpYmVySW1wbChjaGlsZCk7CgogICAgICBpZiAobWF0Y2ggIT09IG51bGwpIHsKICAgICAgICByZXR1cm4gbWF0Y2g7CiAgICAgIH0KCiAgICAgIGNoaWxkID0gY2hpbGQuc2libGluZzsKICAgIH0KCiAgICByZXR1cm4gbnVsbDsKICB9CgogIGZ1bmN0aW9uIGZpbmRDdXJyZW50SG9zdEZpYmVyV2l0aE5vUG9ydGFscyhwYXJlbnQpIHsKICAgIHZhciBjdXJyZW50UGFyZW50ID0gZmluZEN1cnJlbnRGaWJlclVzaW5nU2xvd1BhdGgocGFyZW50KTsKICAgIHJldHVybiBjdXJyZW50UGFyZW50ICE9PSBudWxsID8gZmluZEN1cnJlbnRIb3N0RmliZXJXaXRoTm9Qb3J0YWxzSW1wbChjdXJyZW50UGFyZW50KSA6IG51bGw7CiAgfQoKICBmdW5jdGlvbiBmaW5kQ3VycmVudEhvc3RGaWJlcldpdGhOb1BvcnRhbHNJbXBsKG5vZGUpIHsKICAgIC8vIE5leHQgd2UnbGwgZHJpbGwgZG93biB0aGlzIGNvbXBvbmVudCB0byBmaW5kIHRoZSBmaXJzdCBIb3N0Q29tcG9uZW50L1RleHQuCiAgICBpZiAobm9kZS50YWcgPT09IEhvc3RDb21wb25lbnQgfHwgbm9kZS50YWcgPT09IEhvc3RUZXh0KSB7CiAgICAgIHJldHVybiBub2RlOwogICAgfQoKICAgIHZhciBjaGlsZCA9IG5vZGUuY2hpbGQ7CgogICAgd2hpbGUgKGNoaWxkICE9PSBudWxsKSB7CiAgICAgIGlmIChjaGlsZC50YWcgIT09IEhvc3RQb3J0YWwpIHsKICAgICAgICB2YXIgbWF0Y2ggPSBmaW5kQ3VycmVudEhvc3RGaWJlcldpdGhOb1BvcnRhbHNJbXBsKGNoaWxkKTsKCiAgICAgICAgaWYgKG1hdGNoICE9PSBudWxsKSB7CiAgICAgICAgICByZXR1cm4gbWF0Y2g7CiAgICAgICAgfQogICAgICB9CgogICAgICBjaGlsZCA9IGNoaWxkLnNpYmxpbmc7CiAgICB9CgogICAgcmV0dXJuIG51bGw7CiAgfQoKICAvLyBUaGlzIG1vZHVsZSBvbmx5IGV4aXN0cyBhcyBhbiBFU00gd3JhcHBlciBhcm91bmQgdGhlIGV4dGVybmFsIENvbW1vbkpTCiAgdmFyIHNjaGVkdWxlQ2FsbGJhY2sgPSB1bnN0YWJsZV9zY2hlZHVsZUNhbGxiYWNrOwogIHZhciBjYW5jZWxDYWxsYmFjayA9IHVuc3RhYmxlX2NhbmNlbENhbGxiYWNrOwogIHZhciBzaG91bGRZaWVsZCA9IHVuc3RhYmxlX3Nob3VsZFlpZWxkOwogIHZhciByZXF1ZXN0UGFpbnQgPSB1bnN0YWJsZV9yZXF1ZXN0UGFpbnQ7CiAgdmFyIG5vdyA9IHVuc3RhYmxlX25vdzsKICB2YXIgZ2V0Q3VycmVudFByaW9yaXR5TGV2ZWwgPSB1bnN0YWJsZV9nZXRDdXJyZW50UHJpb3JpdHlMZXZlbDsKICB2YXIgSW1tZWRpYXRlUHJpb3JpdHkgPSB1bnN0YWJsZV9JbW1lZGlhdGVQcmlvcml0eTsKICB2YXIgVXNlckJsb2NraW5nUHJpb3JpdHkgPSB1bnN0YWJsZV9Vc2VyQmxvY2tpbmdQcmlvcml0eTsKICB2YXIgTm9ybWFsUHJpb3JpdHkgPSB1bnN0YWJsZV9Ob3JtYWxQcmlvcml0eTsKICB2YXIgTG93UHJpb3JpdHkgPSB1bnN0YWJsZV9Mb3dQcmlvcml0eTsKICB2YXIgSWRsZVByaW9yaXR5ID0gdW5zdGFibGVfSWRsZVByaW9yaXR5OwogIC8vIHRoaXMgZG9lc24ndCBhY3R1YWxseSBleGlzdCBvbiB0aGUgc2NoZWR1bGVyLCBidXQgaXQgKmRvZXMqCiAgLy8gb24gc2NoZWR1bGVyL3Vuc3RhYmxlX21vY2ssIHdoaWNoIHdlJ2xsIG5lZWQgZm9yIGludGVybmFsIHRlc3RpbmcKICB2YXIgdW5zdGFibGVfeWllbGRWYWx1ZSQxID0gdW5zdGFibGVfeWllbGRWYWx1ZTsKICB2YXIgdW5zdGFibGVfc2V0RGlzYWJsZVlpZWxkVmFsdWUkMSA9IHVuc3RhYmxlX3NldERpc2FibGVZaWVsZFZhbHVlOwoKICB2YXIgcmVuZGVyZXJJRCA9IG51bGw7CiAgdmFyIGluamVjdGVkSG9vayA9IG51bGw7CiAgdmFyIGluamVjdGVkUHJvZmlsaW5nSG9va3MgPSBudWxsOwogIHZhciBoYXNMb2dnZWRFcnJvciA9IGZhbHNlOwogIHZhciBpc0RldlRvb2xzUHJlc2VudCA9IHR5cGVvZiBfX1JFQUNUX0RFVlRPT0xTX0dMT0JBTF9IT09LX18gIT09ICd1bmRlZmluZWQnOwogIGZ1bmN0aW9uIGluamVjdEludGVybmFscyhpbnRlcm5hbHMpIHsKICAgIGlmICh0eXBlb2YgX19SRUFDVF9ERVZUT09MU19HTE9CQUxfSE9PS19fID09PSAndW5kZWZpbmVkJykgewogICAgICAvLyBObyBEZXZUb29scwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgdmFyIGhvb2sgPSBfX1JFQUNUX0RFVlRPT0xTX0dMT0JBTF9IT09LX187CgogICAgaWYgKGhvb2suaXNEaXNhYmxlZCkgewogICAgICAvLyBUaGlzIGlzbid0IGEgcmVhbCBwcm9wZXJ0eSBvbiB0aGUgaG9vaywgYnV0IGl0IGNhbiBiZSBzZXQgdG8gb3B0IG91dAogICAgICAvLyBvZiBEZXZUb29scyBpbnRlZ3JhdGlvbiBhbmQgYXNzb2NpYXRlZCB3YXJuaW5ncyBhbmQgbG9ncy4KICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL3JlYWN0L2lzc3Vlcy8zODc3CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGlmICghaG9vay5zdXBwb3J0c0ZpYmVyKSB7CiAgICAgIHsKICAgICAgICBlcnJvcignVGhlIGluc3RhbGxlZCB2ZXJzaW9uIG9mIFJlYWN0IERldlRvb2xzIGlzIHRvbyBvbGQgYW5kIHdpbGwgbm90IHdvcmsgJyArICd3aXRoIHRoZSBjdXJyZW50IHZlcnNpb24gb2YgUmVhY3QuIFBsZWFzZSB1cGRhdGUgUmVhY3QgRGV2VG9vbHMuICcgKyAnaHR0cHM6Ly9yZWFjdGpzLm9yZy9saW5rL3JlYWN0LWRldnRvb2xzJyk7CiAgICAgIH0gLy8gRGV2VG9vbHMgZXhpc3RzLCBldmVuIHRob3VnaCBpdCBkb2Vzbid0IHN1cHBvcnQgRmliZXIuCgoKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgdHJ5IHsKICAgICAgaWYgKGVuYWJsZVNjaGVkdWxpbmdQcm9maWxlcikgewogICAgICAgIC8vIENvbmRpdGlvbmFsbHkgaW5qZWN0IHRoZXNlIGhvb2tzIG9ubHkgaWYgVGltZWxpbmUgcHJvZmlsZXIgaXMgc3VwcG9ydGVkIGJ5IHRoaXMgYnVpbGQuCiAgICAgICAgLy8gVGhpcyBnaXZlcyBEZXZUb29scyBhIHdheSB0byBmZWF0dXJlIGRldGVjdCB0aGF0IGlzbid0IHRpZWQgdG8gdmVyc2lvbiBudW1iZXIKICAgICAgICAvLyAoc2luY2UgcHJvZmlsaW5nIGFuZCB0aW1lbGluZSBhcmUgY29udHJvbGxlZCBieSBkaWZmZXJlbnQgZmVhdHVyZSBmbGFncykuCiAgICAgICAgaW50ZXJuYWxzID0gYXNzaWduKHt9LCBpbnRlcm5hbHMsIHsKICAgICAgICAgIGdldExhbmVMYWJlbE1hcDogZ2V0TGFuZUxhYmVsTWFwLAogICAgICAgICAgaW5qZWN0UHJvZmlsaW5nSG9va3M6IGluamVjdFByb2ZpbGluZ0hvb2tzCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHJlbmRlcmVySUQgPSBob29rLmluamVjdChpbnRlcm5hbHMpOyAvLyBXZSBoYXZlIHN1Y2Nlc3NmdWxseSBpbmplY3RlZCwgc28gbm93IGl0IGlzIHNhZmUgdG8gc2V0IHVwIGhvb2tzLgoKICAgICAgaW5qZWN0ZWRIb29rID0gaG9vazsKICAgIH0gY2F0Y2ggKGVycikgewogICAgICAvLyBDYXRjaCBhbGwgZXJyb3JzIGJlY2F1c2UgaXQgaXMgdW5zYWZlIHRvIHRocm93IGR1cmluZyBpbml0aWFsaXphdGlvbi4KICAgICAgewogICAgICAgIGVycm9yKCdSZWFjdCBpbnN0cnVtZW50YXRpb24gZW5jb3VudGVyZWQgYW4gZXJyb3I6ICVzLicsIGVycik7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoaG9vay5jaGVja0RDRSkgewogICAgICAvLyBUaGlzIGlzIHRoZSByZWFsIERldlRvb2xzLgogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0gZWxzZSB7CiAgICAgIC8vIFRoaXMgaXMgbGlrZWx5IGEgaG9vayBpbnN0YWxsZWQgYnkgRmFzdCBSZWZyZXNoIHJ1bnRpbWUuCiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9CiAgZnVuY3Rpb24gb25TY2hlZHVsZVJvb3Qocm9vdCwgY2hpbGRyZW4pIHsKICAgIHsKICAgICAgaWYgKGluamVjdGVkSG9vayAmJiB0eXBlb2YgaW5qZWN0ZWRIb29rLm9uU2NoZWR1bGVGaWJlclJvb3QgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICB0cnkgewogICAgICAgICAgaW5qZWN0ZWRIb29rLm9uU2NoZWR1bGVGaWJlclJvb3QocmVuZGVyZXJJRCwgcm9vdCwgY2hpbGRyZW4pOwogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgaWYgKCAhaGFzTG9nZ2VkRXJyb3IpIHsKICAgICAgICAgICAgaGFzTG9nZ2VkRXJyb3IgPSB0cnVlOwoKICAgICAgICAgICAgZXJyb3IoJ1JlYWN0IGluc3RydW1lbnRhdGlvbiBlbmNvdW50ZXJlZCBhbiBlcnJvcjogJXMnLCBlcnIpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KICBmdW5jdGlvbiBvbkNvbW1pdFJvb3Qocm9vdCwgZXZlbnRQcmlvcml0eSkgewogICAgaWYgKGluamVjdGVkSG9vayAmJiB0eXBlb2YgaW5qZWN0ZWRIb29rLm9uQ29tbWl0RmliZXJSb290ID09PSAnZnVuY3Rpb24nKSB7CiAgICAgIHRyeSB7CiAgICAgICAgdmFyIGRpZEVycm9yID0gKHJvb3QuY3VycmVudC5mbGFncyAmIERpZENhcHR1cmUpID09PSBEaWRDYXB0dXJlOwoKICAgICAgICBpZiAoZW5hYmxlUHJvZmlsZXJUaW1lcikgewogICAgICAgICAgdmFyIHNjaGVkdWxlclByaW9yaXR5OwoKICAgICAgICAgIHN3aXRjaCAoZXZlbnRQcmlvcml0eSkgewogICAgICAgICAgICBjYXNlIERpc2NyZXRlRXZlbnRQcmlvcml0eToKICAgICAgICAgICAgICBzY2hlZHVsZXJQcmlvcml0eSA9IEltbWVkaWF0ZVByaW9yaXR5OwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSBDb250aW51b3VzRXZlbnRQcmlvcml0eToKICAgICAgICAgICAgICBzY2hlZHVsZXJQcmlvcml0eSA9IFVzZXJCbG9ja2luZ1ByaW9yaXR5OwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSBEZWZhdWx0RXZlbnRQcmlvcml0eToKICAgICAgICAgICAgICBzY2hlZHVsZXJQcmlvcml0eSA9IE5vcm1hbFByaW9yaXR5OwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSBJZGxlRXZlbnRQcmlvcml0eToKICAgICAgICAgICAgICBzY2hlZHVsZXJQcmlvcml0eSA9IElkbGVQcmlvcml0eTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgc2NoZWR1bGVyUHJpb3JpdHkgPSBOb3JtYWxQcmlvcml0eTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICBpbmplY3RlZEhvb2sub25Db21taXRGaWJlclJvb3QocmVuZGVyZXJJRCwgcm9vdCwgc2NoZWR1bGVyUHJpb3JpdHksIGRpZEVycm9yKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaW5qZWN0ZWRIb29rLm9uQ29tbWl0RmliZXJSb290KHJlbmRlcmVySUQsIHJvb3QsIHVuZGVmaW5lZCwgZGlkRXJyb3IpOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgewogICAgICAgICAgaWYgKCFoYXNMb2dnZWRFcnJvcikgewogICAgICAgICAgICBoYXNMb2dnZWRFcnJvciA9IHRydWU7CgogICAgICAgICAgICBlcnJvcignUmVhY3QgaW5zdHJ1bWVudGF0aW9uIGVuY291bnRlcmVkIGFuIGVycm9yOiAlcycsIGVycik7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQogIGZ1bmN0aW9uIG9uUG9zdENvbW1pdFJvb3Qocm9vdCkgewogICAgaWYgKGluamVjdGVkSG9vayAmJiB0eXBlb2YgaW5qZWN0ZWRIb29rLm9uUG9zdENvbW1pdEZpYmVyUm9vdCA9PT0gJ2Z1bmN0aW9uJykgewogICAgICB0cnkgewogICAgICAgIGluamVjdGVkSG9vay5vblBvc3RDb21taXRGaWJlclJvb3QocmVuZGVyZXJJRCwgcm9vdCk7CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIHsKICAgICAgICAgIGlmICghaGFzTG9nZ2VkRXJyb3IpIHsKICAgICAgICAgICAgaGFzTG9nZ2VkRXJyb3IgPSB0cnVlOwoKICAgICAgICAgICAgZXJyb3IoJ1JlYWN0IGluc3RydW1lbnRhdGlvbiBlbmNvdW50ZXJlZCBhbiBlcnJvcjogJXMnLCBlcnIpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KICBmdW5jdGlvbiBvbkNvbW1pdFVubW91bnQoZmliZXIpIHsKICAgIGlmIChpbmplY3RlZEhvb2sgJiYgdHlwZW9mIGluamVjdGVkSG9vay5vbkNvbW1pdEZpYmVyVW5tb3VudCA9PT0gJ2Z1bmN0aW9uJykgewogICAgICB0cnkgewogICAgICAgIGluamVjdGVkSG9vay5vbkNvbW1pdEZpYmVyVW5tb3VudChyZW5kZXJlcklELCBmaWJlcik7CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIHsKICAgICAgICAgIGlmICghaGFzTG9nZ2VkRXJyb3IpIHsKICAgICAgICAgICAgaGFzTG9nZ2VkRXJyb3IgPSB0cnVlOwoKICAgICAgICAgICAgZXJyb3IoJ1JlYWN0IGluc3RydW1lbnRhdGlvbiBlbmNvdW50ZXJlZCBhbiBlcnJvcjogJXMnLCBlcnIpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KICBmdW5jdGlvbiBzZXRJc1N0cmljdE1vZGVGb3JEZXZ0b29scyhuZXdJc1N0cmljdE1vZGUpIHsKICAgIHsKICAgICAgaWYgKHR5cGVvZiB1bnN0YWJsZV95aWVsZFZhbHVlJDEgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAvLyBXZSdyZSBpbiBhIHRlc3QgYmVjYXVzZSBTY2hlZHVsZXIudW5zdGFibGVfeWllbGRWYWx1ZSBvbmx5IGV4aXN0cwogICAgICAgIC8vIGluIFNjaGVkdWxlck1vY2suIFRvIHJlZHVjZSB0aGUgbm9pc2UgaW4gc3RyaWN0IG1vZGUgdGVzdHMsCiAgICAgICAgLy8gc3VwcHJlc3Mgd2FybmluZ3MgYW5kIGRpc2FibGUgc2NoZWR1bGVyIHlpZWxkaW5nIGR1cmluZyB0aGUgZG91YmxlIHJlbmRlcgogICAgICAgIHVuc3RhYmxlX3NldERpc2FibGVZaWVsZFZhbHVlJDEobmV3SXNTdHJpY3RNb2RlKTsKICAgICAgICBzZXRTdXBwcmVzc1dhcm5pbmcobmV3SXNTdHJpY3RNb2RlKTsKICAgICAgfQoKICAgICAgaWYgKGluamVjdGVkSG9vayAmJiB0eXBlb2YgaW5qZWN0ZWRIb29rLnNldFN0cmljdE1vZGUgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICB0cnkgewogICAgICAgICAgaW5qZWN0ZWRIb29rLnNldFN0cmljdE1vZGUocmVuZGVyZXJJRCwgbmV3SXNTdHJpY3RNb2RlKTsKICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgIHsKICAgICAgICAgICAgaWYgKCFoYXNMb2dnZWRFcnJvcikgewogICAgICAgICAgICAgIGhhc0xvZ2dlZEVycm9yID0gdHJ1ZTsKCiAgICAgICAgICAgICAgZXJyb3IoJ1JlYWN0IGluc3RydW1lbnRhdGlvbiBlbmNvdW50ZXJlZCBhbiBlcnJvcjogJXMnLCBlcnIpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSAvLyBQcm9maWxlciBBUEkgaG9va3MKCiAgZnVuY3Rpb24gaW5qZWN0UHJvZmlsaW5nSG9va3MocHJvZmlsaW5nSG9va3MpIHsKICAgIGluamVjdGVkUHJvZmlsaW5nSG9va3MgPSBwcm9maWxpbmdIb29rczsKICB9CgogIGZ1bmN0aW9uIGdldExhbmVMYWJlbE1hcCgpIHsKICAgIHsKICAgICAgdmFyIG1hcCA9IG5ldyBNYXAoKTsKICAgICAgdmFyIGxhbmUgPSAxOwoKICAgICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IFRvdGFsTGFuZXM7IGluZGV4KyspIHsKICAgICAgICB2YXIgbGFiZWwgPSBnZXRMYWJlbEZvckxhbmUobGFuZSk7CiAgICAgICAgbWFwLnNldChsYW5lLCBsYWJlbCk7CiAgICAgICAgbGFuZSAqPSAyOwogICAgICB9CgogICAgICByZXR1cm4gbWFwOwogICAgfQogIH0KCiAgZnVuY3Rpb24gbWFya0NvbW1pdFN0YXJ0ZWQobGFuZXMpIHsKICAgIHsKICAgICAgaWYgKGluamVjdGVkUHJvZmlsaW5nSG9va3MgIT09IG51bGwgJiYgdHlwZW9mIGluamVjdGVkUHJvZmlsaW5nSG9va3MubWFya0NvbW1pdFN0YXJ0ZWQgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICBpbmplY3RlZFByb2ZpbGluZ0hvb2tzLm1hcmtDb21taXRTdGFydGVkKGxhbmVzKTsKICAgICAgfQogICAgfQogIH0KICBmdW5jdGlvbiBtYXJrQ29tbWl0U3RvcHBlZCgpIHsKICAgIHsKICAgICAgaWYgKGluamVjdGVkUHJvZmlsaW5nSG9va3MgIT09IG51bGwgJiYgdHlwZW9mIGluamVjdGVkUHJvZmlsaW5nSG9va3MubWFya0NvbW1pdFN0b3BwZWQgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICBpbmplY3RlZFByb2ZpbGluZ0hvb2tzLm1hcmtDb21taXRTdG9wcGVkKCk7CiAgICAgIH0KICAgIH0KICB9CiAgZnVuY3Rpb24gbWFya0NvbXBvbmVudFJlbmRlclN0YXJ0ZWQoZmliZXIpIHsKICAgIHsKICAgICAgaWYgKGluamVjdGVkUHJvZmlsaW5nSG9va3MgIT09IG51bGwgJiYgdHlwZW9mIGluamVjdGVkUHJvZmlsaW5nSG9va3MubWFya0NvbXBvbmVudFJlbmRlclN0YXJ0ZWQgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICBpbmplY3RlZFByb2ZpbGluZ0hvb2tzLm1hcmtDb21wb25lbnRSZW5kZXJTdGFydGVkKGZpYmVyKTsKICAgICAgfQogICAgfQogIH0KICBmdW5jdGlvbiBtYXJrQ29tcG9uZW50UmVuZGVyU3RvcHBlZCgpIHsKICAgIHsKICAgICAgaWYgKGluamVjdGVkUHJvZmlsaW5nSG9va3MgIT09IG51bGwgJiYgdHlwZW9mIGluamVjdGVkUHJvZmlsaW5nSG9va3MubWFya0NvbXBvbmVudFJlbmRlclN0b3BwZWQgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICBpbmplY3RlZFByb2ZpbGluZ0hvb2tzLm1hcmtDb21wb25lbnRSZW5kZXJTdG9wcGVkKCk7CiAgICAgIH0KICAgIH0KICB9CiAgZnVuY3Rpb24gbWFya0NvbXBvbmVudFBhc3NpdmVFZmZlY3RNb3VudFN0YXJ0ZWQoZmliZXIpIHsKICAgIHsKICAgICAgaWYgKGluamVjdGVkUHJvZmlsaW5nSG9va3MgIT09IG51bGwgJiYgdHlwZW9mIGluamVjdGVkUHJvZmlsaW5nSG9va3MubWFya0NvbXBvbmVudFBhc3NpdmVFZmZlY3RNb3VudFN0YXJ0ZWQgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICBpbmplY3RlZFByb2ZpbGluZ0hvb2tzLm1hcmtDb21wb25lbnRQYXNzaXZlRWZmZWN0TW91bnRTdGFydGVkKGZpYmVyKTsKICAgICAgfQogICAgfQogIH0KICBmdW5jdGlvbiBtYXJrQ29tcG9uZW50UGFzc2l2ZUVmZmVjdE1vdW50U3RvcHBlZCgpIHsKICAgIHsKICAgICAgaWYgKGluamVjdGVkUHJvZmlsaW5nSG9va3MgIT09IG51bGwgJiYgdHlwZW9mIGluamVjdGVkUHJvZmlsaW5nSG9va3MubWFya0NvbXBvbmVudFBhc3NpdmVFZmZlY3RNb3VudFN0b3BwZWQgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICBpbmplY3RlZFByb2ZpbGluZ0hvb2tzLm1hcmtDb21wb25lbnRQYXNzaXZlRWZmZWN0TW91bnRTdG9wcGVkKCk7CiAgICAgIH0KICAgIH0KICB9CiAgZnVuY3Rpb24gbWFya0NvbXBvbmVudFBhc3NpdmVFZmZlY3RVbm1vdW50U3RhcnRlZChmaWJlcikgewogICAgewogICAgICBpZiAoaW5qZWN0ZWRQcm9maWxpbmdIb29rcyAhPT0gbnVsbCAmJiB0eXBlb2YgaW5qZWN0ZWRQcm9maWxpbmdIb29rcy5tYXJrQ29tcG9uZW50UGFzc2l2ZUVmZmVjdFVubW91bnRTdGFydGVkID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgaW5qZWN0ZWRQcm9maWxpbmdIb29rcy5tYXJrQ29tcG9uZW50UGFzc2l2ZUVmZmVjdFVubW91bnRTdGFydGVkKGZpYmVyKTsKICAgICAgfQogICAgfQogIH0KICBmdW5jdGlvbiBtYXJrQ29tcG9uZW50UGFzc2l2ZUVmZmVjdFVubW91bnRTdG9wcGVkKCkgewogICAgewogICAgICBpZiAoaW5qZWN0ZWRQcm9maWxpbmdIb29rcyAhPT0gbnVsbCAmJiB0eXBlb2YgaW5qZWN0ZWRQcm9maWxpbmdIb29rcy5tYXJrQ29tcG9uZW50UGFzc2l2ZUVmZmVjdFVubW91bnRTdG9wcGVkID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgaW5qZWN0ZWRQcm9maWxpbmdIb29rcy5tYXJrQ29tcG9uZW50UGFzc2l2ZUVmZmVjdFVubW91bnRTdG9wcGVkKCk7CiAgICAgIH0KICAgIH0KICB9CiAgZnVuY3Rpb24gbWFya0NvbXBvbmVudExheW91dEVmZmVjdE1vdW50U3RhcnRlZChmaWJlcikgewogICAgewogICAgICBpZiAoaW5qZWN0ZWRQcm9maWxpbmdIb29rcyAhPT0gbnVsbCAmJiB0eXBlb2YgaW5qZWN0ZWRQcm9maWxpbmdIb29rcy5tYXJrQ29tcG9uZW50TGF5b3V0RWZmZWN0TW91bnRTdGFydGVkID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgaW5qZWN0ZWRQcm9maWxpbmdIb29rcy5tYXJrQ29tcG9uZW50TGF5b3V0RWZmZWN0TW91bnRTdGFydGVkKGZpYmVyKTsKICAgICAgfQogICAgfQogIH0KICBmdW5jdGlvbiBtYXJrQ29tcG9uZW50TGF5b3V0RWZmZWN0TW91bnRTdG9wcGVkKCkgewogICAgewogICAgICBpZiAoaW5qZWN0ZWRQcm9maWxpbmdIb29rcyAhPT0gbnVsbCAmJiB0eXBlb2YgaW5qZWN0ZWRQcm9maWxpbmdIb29rcy5tYXJrQ29tcG9uZW50TGF5b3V0RWZmZWN0TW91bnRTdG9wcGVkID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgaW5qZWN0ZWRQcm9maWxpbmdIb29rcy5tYXJrQ29tcG9uZW50TGF5b3V0RWZmZWN0TW91bnRTdG9wcGVkKCk7CiAgICAgIH0KICAgIH0KICB9CiAgZnVuY3Rpb24gbWFya0NvbXBvbmVudExheW91dEVmZmVjdFVubW91bnRTdGFydGVkKGZpYmVyKSB7CiAgICB7CiAgICAgIGlmIChpbmplY3RlZFByb2ZpbGluZ0hvb2tzICE9PSBudWxsICYmIHR5cGVvZiBpbmplY3RlZFByb2ZpbGluZ0hvb2tzLm1hcmtDb21wb25lbnRMYXlvdXRFZmZlY3RVbm1vdW50U3RhcnRlZCA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIGluamVjdGVkUHJvZmlsaW5nSG9va3MubWFya0NvbXBvbmVudExheW91dEVmZmVjdFVubW91bnRTdGFydGVkKGZpYmVyKTsKICAgICAgfQogICAgfQogIH0KICBmdW5jdGlvbiBtYXJrQ29tcG9uZW50TGF5b3V0RWZmZWN0VW5tb3VudFN0b3BwZWQoKSB7CiAgICB7CiAgICAgIGlmIChpbmplY3RlZFByb2ZpbGluZ0hvb2tzICE9PSBudWxsICYmIHR5cGVvZiBpbmplY3RlZFByb2ZpbGluZ0hvb2tzLm1hcmtDb21wb25lbnRMYXlvdXRFZmZlY3RVbm1vdW50U3RvcHBlZCA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIGluamVjdGVkUHJvZmlsaW5nSG9va3MubWFya0NvbXBvbmVudExheW91dEVmZmVjdFVubW91bnRTdG9wcGVkKCk7CiAgICAgIH0KICAgIH0KICB9CiAgZnVuY3Rpb24gbWFya0NvbXBvbmVudEVycm9yZWQoZmliZXIsIHRocm93blZhbHVlLCBsYW5lcykgewogICAgewogICAgICBpZiAoaW5qZWN0ZWRQcm9maWxpbmdIb29rcyAhPT0gbnVsbCAmJiB0eXBlb2YgaW5qZWN0ZWRQcm9maWxpbmdIb29rcy5tYXJrQ29tcG9uZW50RXJyb3JlZCA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIGluamVjdGVkUHJvZmlsaW5nSG9va3MubWFya0NvbXBvbmVudEVycm9yZWQoZmliZXIsIHRocm93blZhbHVlLCBsYW5lcyk7CiAgICAgIH0KICAgIH0KICB9CiAgZnVuY3Rpb24gbWFya0NvbXBvbmVudFN1c3BlbmRlZChmaWJlciwgd2FrZWFibGUsIGxhbmVzKSB7CiAgICB7CiAgICAgIGlmIChpbmplY3RlZFByb2ZpbGluZ0hvb2tzICE9PSBudWxsICYmIHR5cGVvZiBpbmplY3RlZFByb2ZpbGluZ0hvb2tzLm1hcmtDb21wb25lbnRTdXNwZW5kZWQgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICBpbmplY3RlZFByb2ZpbGluZ0hvb2tzLm1hcmtDb21wb25lbnRTdXNwZW5kZWQoZmliZXIsIHdha2VhYmxlLCBsYW5lcyk7CiAgICAgIH0KICAgIH0KICB9CiAgZnVuY3Rpb24gbWFya0xheW91dEVmZmVjdHNTdGFydGVkKGxhbmVzKSB7CiAgICB7CiAgICAgIGlmIChpbmplY3RlZFByb2ZpbGluZ0hvb2tzICE9PSBudWxsICYmIHR5cGVvZiBpbmplY3RlZFByb2ZpbGluZ0hvb2tzLm1hcmtMYXlvdXRFZmZlY3RzU3RhcnRlZCA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIGluamVjdGVkUHJvZmlsaW5nSG9va3MubWFya0xheW91dEVmZmVjdHNTdGFydGVkKGxhbmVzKTsKICAgICAgfQogICAgfQogIH0KICBmdW5jdGlvbiBtYXJrTGF5b3V0RWZmZWN0c1N0b3BwZWQoKSB7CiAgICB7CiAgICAgIGlmIChpbmplY3RlZFByb2ZpbGluZ0hvb2tzICE9PSBudWxsICYmIHR5cGVvZiBpbmplY3RlZFByb2ZpbGluZ0hvb2tzLm1hcmtMYXlvdXRFZmZlY3RzU3RvcHBlZCA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIGluamVjdGVkUHJvZmlsaW5nSG9va3MubWFya0xheW91dEVmZmVjdHNTdG9wcGVkKCk7CiAgICAgIH0KICAgIH0KICB9CiAgZnVuY3Rpb24gbWFya1Bhc3NpdmVFZmZlY3RzU3RhcnRlZChsYW5lcykgewogICAgewogICAgICBpZiAoaW5qZWN0ZWRQcm9maWxpbmdIb29rcyAhPT0gbnVsbCAmJiB0eXBlb2YgaW5qZWN0ZWRQcm9maWxpbmdIb29rcy5tYXJrUGFzc2l2ZUVmZmVjdHNTdGFydGVkID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgaW5qZWN0ZWRQcm9maWxpbmdIb29rcy5tYXJrUGFzc2l2ZUVmZmVjdHNTdGFydGVkKGxhbmVzKTsKICAgICAgfQogICAgfQogIH0KICBmdW5jdGlvbiBtYXJrUGFzc2l2ZUVmZmVjdHNTdG9wcGVkKCkgewogICAgewogICAgICBpZiAoaW5qZWN0ZWRQcm9maWxpbmdIb29rcyAhPT0gbnVsbCAmJiB0eXBlb2YgaW5qZWN0ZWRQcm9maWxpbmdIb29rcy5tYXJrUGFzc2l2ZUVmZmVjdHNTdG9wcGVkID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgaW5qZWN0ZWRQcm9maWxpbmdIb29rcy5tYXJrUGFzc2l2ZUVmZmVjdHNTdG9wcGVkKCk7CiAgICAgIH0KICAgIH0KICB9CiAgZnVuY3Rpb24gbWFya1JlbmRlclN0YXJ0ZWQobGFuZXMpIHsKICAgIHsKICAgICAgaWYgKGluamVjdGVkUHJvZmlsaW5nSG9va3MgIT09IG51bGwgJiYgdHlwZW9mIGluamVjdGVkUHJvZmlsaW5nSG9va3MubWFya1JlbmRlclN0YXJ0ZWQgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICBpbmplY3RlZFByb2ZpbGluZ0hvb2tzLm1hcmtSZW5kZXJTdGFydGVkKGxhbmVzKTsKICAgICAgfQogICAgfQogIH0KICBmdW5jdGlvbiBtYXJrUmVuZGVyWWllbGRlZCgpIHsKICAgIHsKICAgICAgaWYgKGluamVjdGVkUHJvZmlsaW5nSG9va3MgIT09IG51bGwgJiYgdHlwZW9mIGluamVjdGVkUHJvZmlsaW5nSG9va3MubWFya1JlbmRlcllpZWxkZWQgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICBpbmplY3RlZFByb2ZpbGluZ0hvb2tzLm1hcmtSZW5kZXJZaWVsZGVkKCk7CiAgICAgIH0KICAgIH0KICB9CiAgZnVuY3Rpb24gbWFya1JlbmRlclN0b3BwZWQoKSB7CiAgICB7CiAgICAgIGlmIChpbmplY3RlZFByb2ZpbGluZ0hvb2tzICE9PSBudWxsICYmIHR5cGVvZiBpbmplY3RlZFByb2ZpbGluZ0hvb2tzLm1hcmtSZW5kZXJTdG9wcGVkID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgaW5qZWN0ZWRQcm9maWxpbmdIb29rcy5tYXJrUmVuZGVyU3RvcHBlZCgpOwogICAgICB9CiAgICB9CiAgfQogIGZ1bmN0aW9uIG1hcmtSZW5kZXJTY2hlZHVsZWQobGFuZSkgewogICAgewogICAgICBpZiAoaW5qZWN0ZWRQcm9maWxpbmdIb29rcyAhPT0gbnVsbCAmJiB0eXBlb2YgaW5qZWN0ZWRQcm9maWxpbmdIb29rcy5tYXJrUmVuZGVyU2NoZWR1bGVkID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgaW5qZWN0ZWRQcm9maWxpbmdIb29rcy5tYXJrUmVuZGVyU2NoZWR1bGVkKGxhbmUpOwogICAgICB9CiAgICB9CiAgfQogIGZ1bmN0aW9uIG1hcmtGb3JjZVVwZGF0ZVNjaGVkdWxlZChmaWJlciwgbGFuZSkgewogICAgewogICAgICBpZiAoaW5qZWN0ZWRQcm9maWxpbmdIb29rcyAhPT0gbnVsbCAmJiB0eXBlb2YgaW5qZWN0ZWRQcm9maWxpbmdIb29rcy5tYXJrRm9yY2VVcGRhdGVTY2hlZHVsZWQgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICBpbmplY3RlZFByb2ZpbGluZ0hvb2tzLm1hcmtGb3JjZVVwZGF0ZVNjaGVkdWxlZChmaWJlciwgbGFuZSk7CiAgICAgIH0KICAgIH0KICB9CiAgZnVuY3Rpb24gbWFya1N0YXRlVXBkYXRlU2NoZWR1bGVkKGZpYmVyLCBsYW5lKSB7CiAgICB7CiAgICAgIGlmIChpbmplY3RlZFByb2ZpbGluZ0hvb2tzICE9PSBudWxsICYmIHR5cGVvZiBpbmplY3RlZFByb2ZpbGluZ0hvb2tzLm1hcmtTdGF0ZVVwZGF0ZVNjaGVkdWxlZCA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIGluamVjdGVkUHJvZmlsaW5nSG9va3MubWFya1N0YXRlVXBkYXRlU2NoZWR1bGVkKGZpYmVyLCBsYW5lKTsKICAgICAgfQogICAgfQogIH0KCiAgdmFyIE5vTW9kZSA9CiAgLyogICAgICAgICAgICAgICAgICAgICAgICAgKi8KICAwOyAvLyBUT0RPOiBSZW1vdmUgQ29uY3VycmVudE1vZGUgYnkgcmVhZGluZyBmcm9tIHRoZSByb290IHRhZyBpbnN0ZWFkCgogIHZhciBDb25jdXJyZW50TW9kZSA9CiAgLyogICAgICAgICAgICAgICAgICovCiAgMTsKICB2YXIgUHJvZmlsZU1vZGUgPQogIC8qICAgICAgICAgICAgICAgICAgICAqLwogIDI7CiAgdmFyIFN0cmljdExlZ2FjeU1vZGUgPQogIC8qICAgICAgICAgICAgICAgKi8KICA4OwogIHZhciBTdHJpY3RFZmZlY3RzTW9kZSA9CiAgLyogICAgICAgICAgICAgICovCiAgMTY7CgogIC8vIFRPRE86IFRoaXMgaXMgcHJldHR5IHdlbGwgc3VwcG9ydGVkIGJ5IGJyb3dzZXJzLiBNYXliZSB3ZSBjYW4gZHJvcCBpdC4KICB2YXIgY2x6MzIgPSBNYXRoLmNsejMyID8gTWF0aC5jbHozMiA6IGNsejMyRmFsbGJhY2s7IC8vIENvdW50IGxlYWRpbmcgemVyb3MuCiAgLy8gQmFzZWQgb246CiAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvTWF0aC9jbHozMgoKICB2YXIgbG9nID0gTWF0aC5sb2c7CiAgdmFyIExOMiA9IE1hdGguTE4yOwoKICBmdW5jdGlvbiBjbHozMkZhbGxiYWNrKHgpIHsKICAgIHZhciBhc1VpbnQgPSB4ID4+PiAwOwoKICAgIGlmIChhc1VpbnQgPT09IDApIHsKICAgICAgcmV0dXJuIDMyOwogICAgfQoKICAgIHJldHVybiAzMSAtIChsb2coYXNVaW50KSAvIExOMiB8IDApIHwgMDsKICB9CgogIC8vIElmIHRob3NlIHZhbHVlcyBhcmUgY2hhbmdlZCB0aGF0IHBhY2thZ2Ugc2hvdWxkIGJlIHJlYnVpbHQgYW5kIHJlZGVwbG95ZWQuCgogIHZhciBUb3RhbExhbmVzID0gMzE7CiAgdmFyIE5vTGFuZXMgPQogIC8qICAgICAgICAgICAgICAgICAgICAgICAgKi8KICAwOwogIHZhciBOb0xhbmUgPQogIC8qICAgICAgICAgICAgICAgICAgICAgICAgICAqLwogIDA7CiAgdmFyIFN5bmNMYW5lID0KICAvKiAgICAgICAgICAgICAgICAgICAgICAgICovCiAgMTsKICB2YXIgSW5wdXRDb250aW51b3VzSHlkcmF0aW9uTGFuZSA9CiAgLyogICAgKi8KICAyOwogIHZhciBJbnB1dENvbnRpbnVvdXNMYW5lID0KICAvKiAgICAgICAgICAgICAqLwogIDQ7CiAgdmFyIERlZmF1bHRIeWRyYXRpb25MYW5lID0KICAvKiAgICAgICAgICAgICovCiAgODsKICB2YXIgRGVmYXVsdExhbmUgPQogIC8qICAgICAgICAgICAgICAgICAgICAgKi8KICAxNjsKICB2YXIgVHJhbnNpdGlvbkh5ZHJhdGlvbkxhbmUgPQogIC8qICAgICAgICAgICAgICAgICovCiAgMzI7CiAgdmFyIFRyYW5zaXRpb25MYW5lcyA9CiAgLyogICAgICAgICAgICAgICAgICAgICAgICovCiAgNDE5NDI0MDsKICB2YXIgVHJhbnNpdGlvbkxhbmUxID0KICAvKiAgICAgICAgICAgICAgICAgICAgICAgICovCiAgNjQ7CiAgdmFyIFRyYW5zaXRpb25MYW5lMiA9CiAgLyogICAgICAgICAgICAgICAgICAgICAgICAqLwogIDEyODsKICB2YXIgVHJhbnNpdGlvbkxhbmUzID0KICAvKiAgICAgICAgICAgICAgICAgICAgICAgICovCiAgMjU2OwogIHZhciBUcmFuc2l0aW9uTGFuZTQgPQogIC8qICAgICAgICAgICAgICAgICAgICAgICAgKi8KICA1MTI7CiAgdmFyIFRyYW5zaXRpb25MYW5lNSA9CiAgLyogICAgICAgICAgICAgICAgICAgICAgICAqLwogIDEwMjQ7CiAgdmFyIFRyYW5zaXRpb25MYW5lNiA9CiAgLyogICAgICAgICAgICAgICAgICAgICAgICAqLwogIDIwNDg7CiAgdmFyIFRyYW5zaXRpb25MYW5lNyA9CiAgLyogICAgICAgICAgICAgICAgICAgICAgICAqLwogIDQwOTY7CiAgdmFyIFRyYW5zaXRpb25MYW5lOCA9CiAgLyogICAgICAgICAgICAgICAgICAgICAgICAqLwogIDgxOTI7CiAgdmFyIFRyYW5zaXRpb25MYW5lOSA9CiAgLyogICAgICAgICAgICAgICAgICAgICAgICAqLwogIDE2Mzg0OwogIHZhciBUcmFuc2l0aW9uTGFuZTEwID0KICAvKiAgICAgICAgICAgICAgICAgICAgICAgKi8KICAzMjc2ODsKICB2YXIgVHJhbnNpdGlvbkxhbmUxMSA9CiAgLyogICAgICAgICAgICAgICAgICAgICAgICovCiAgNjU1MzY7CiAgdmFyIFRyYW5zaXRpb25MYW5lMTIgPQogIC8qICAgICAgICAgICAgICAgICAgICAgICAqLwogIDEzMTA3MjsKICB2YXIgVHJhbnNpdGlvbkxhbmUxMyA9CiAgLyogICAgICAgICAgICAgICAgICAgICAgICovCiAgMjYyMTQ0OwogIHZhciBUcmFuc2l0aW9uTGFuZTE0ID0KICAvKiAgICAgICAgICAgICAgICAgICAgICAgKi8KICA1MjQyODg7CiAgdmFyIFRyYW5zaXRpb25MYW5lMTUgPQogIC8qICAgICAgICAgICAgICAgICAgICAgICAqLwogIDEwNDg1NzY7CiAgdmFyIFRyYW5zaXRpb25MYW5lMTYgPQogIC8qICAgICAgICAgICAgICAgICAgICAgICAqLwogIDIwOTcxNTI7CiAgdmFyIFJldHJ5TGFuZXMgPQogIC8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICovCiAgMTMwMDIzNDI0OwogIHZhciBSZXRyeUxhbmUxID0KICAvKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi8KICA0MTk0MzA0OwogIHZhciBSZXRyeUxhbmUyID0KICAvKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi8KICA4Mzg4NjA4OwogIHZhciBSZXRyeUxhbmUzID0KICAvKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi8KICAxNjc3NzIxNjsKICB2YXIgUmV0cnlMYW5lNCA9CiAgLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICovCiAgMzM1NTQ0MzI7CiAgdmFyIFJldHJ5TGFuZTUgPQogIC8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqLwogIDY3MTA4ODY0OwogIHZhciBTb21lUmV0cnlMYW5lID0gUmV0cnlMYW5lMTsKICB2YXIgU2VsZWN0aXZlSHlkcmF0aW9uTGFuZSA9CiAgLyogICAgICAgICAgKi8KICAxMzQyMTc3Mjg7CiAgdmFyIE5vbklkbGVMYW5lcyA9CiAgLyogICAgICAgICAgICAgICAgICAgICAgICAgICovCiAgMjY4NDM1NDU1OwogIHZhciBJZGxlSHlkcmF0aW9uTGFuZSA9CiAgLyogICAgICAgICAgICAgICAqLwogIDI2ODQzNTQ1NjsKICB2YXIgSWRsZUxhbmUgPQogIC8qICAgICAgICAgICAgICAgICAgICAgICAgKi8KICA1MzY4NzA5MTI7CiAgdmFyIE9mZnNjcmVlbkxhbmUgPQogIC8qICAgICAgICAgICAgICAgICAgICovCiAgMTA3Mzc0MTgyNDsgLy8gVGhpcyBmdW5jdGlvbiBpcyB1c2VkIGZvciB0aGUgZXhwZXJpbWVudGFsIHRpbWVsaW5lIChyZWFjdC1kZXZ0b29scy10aW1lbGluZSkKICAvLyBJdCBzaG91bGQgYmUga2VwdCBpbiBzeW5jIHdpdGggdGhlIExhbmVzIHZhbHVlcyBhYm92ZS4KCiAgZnVuY3Rpb24gZ2V0TGFiZWxGb3JMYW5lKGxhbmUpIHsKICAgIHsKICAgICAgaWYgKGxhbmUgJiBTeW5jTGFuZSkgewogICAgICAgIHJldHVybiAnU3luYyc7CiAgICAgIH0KCiAgICAgIGlmIChsYW5lICYgSW5wdXRDb250aW51b3VzSHlkcmF0aW9uTGFuZSkgewogICAgICAgIHJldHVybiAnSW5wdXRDb250aW51b3VzSHlkcmF0aW9uJzsKICAgICAgfQoKICAgICAgaWYgKGxhbmUgJiBJbnB1dENvbnRpbnVvdXNMYW5lKSB7CiAgICAgICAgcmV0dXJuICdJbnB1dENvbnRpbnVvdXMnOwogICAgICB9CgogICAgICBpZiAobGFuZSAmIERlZmF1bHRIeWRyYXRpb25MYW5lKSB7CiAgICAgICAgcmV0dXJuICdEZWZhdWx0SHlkcmF0aW9uJzsKICAgICAgfQoKICAgICAgaWYgKGxhbmUgJiBEZWZhdWx0TGFuZSkgewogICAgICAgIHJldHVybiAnRGVmYXVsdCc7CiAgICAgIH0KCiAgICAgIGlmIChsYW5lICYgVHJhbnNpdGlvbkh5ZHJhdGlvbkxhbmUpIHsKICAgICAgICByZXR1cm4gJ1RyYW5zaXRpb25IeWRyYXRpb24nOwogICAgICB9CgogICAgICBpZiAobGFuZSAmIFRyYW5zaXRpb25MYW5lcykgewogICAgICAgIHJldHVybiAnVHJhbnNpdGlvbic7CiAgICAgIH0KCiAgICAgIGlmIChsYW5lICYgUmV0cnlMYW5lcykgewogICAgICAgIHJldHVybiAnUmV0cnknOwogICAgICB9CgogICAgICBpZiAobGFuZSAmIFNlbGVjdGl2ZUh5ZHJhdGlvbkxhbmUpIHsKICAgICAgICByZXR1cm4gJ1NlbGVjdGl2ZUh5ZHJhdGlvbic7CiAgICAgIH0KCiAgICAgIGlmIChsYW5lICYgSWRsZUh5ZHJhdGlvbkxhbmUpIHsKICAgICAgICByZXR1cm4gJ0lkbGVIeWRyYXRpb24nOwogICAgICB9CgogICAgICBpZiAobGFuZSAmIElkbGVMYW5lKSB7CiAgICAgICAgcmV0dXJuICdJZGxlJzsKICAgICAgfQoKICAgICAgaWYgKGxhbmUgJiBPZmZzY3JlZW5MYW5lKSB7CiAgICAgICAgcmV0dXJuICdPZmZzY3JlZW4nOwogICAgICB9CiAgICB9CiAgfQogIHZhciBOb1RpbWVzdGFtcCA9IC0xOwogIHZhciBuZXh0VHJhbnNpdGlvbkxhbmUgPSBUcmFuc2l0aW9uTGFuZTE7CiAgdmFyIG5leHRSZXRyeUxhbmUgPSBSZXRyeUxhbmUxOwoKICBmdW5jdGlvbiBnZXRIaWdoZXN0UHJpb3JpdHlMYW5lcyhsYW5lcykgewogICAgc3dpdGNoIChnZXRIaWdoZXN0UHJpb3JpdHlMYW5lKGxhbmVzKSkgewogICAgICBjYXNlIFN5bmNMYW5lOgogICAgICAgIHJldHVybiBTeW5jTGFuZTsKCiAgICAgIGNhc2UgSW5wdXRDb250aW51b3VzSHlkcmF0aW9uTGFuZToKICAgICAgICByZXR1cm4gSW5wdXRDb250aW51b3VzSHlkcmF0aW9uTGFuZTsKCiAgICAgIGNhc2UgSW5wdXRDb250aW51b3VzTGFuZToKICAgICAgICByZXR1cm4gSW5wdXRDb250aW51b3VzTGFuZTsKCiAgICAgIGNhc2UgRGVmYXVsdEh5ZHJhdGlvbkxhbmU6CiAgICAgICAgcmV0dXJuIERlZmF1bHRIeWRyYXRpb25MYW5lOwoKICAgICAgY2FzZSBEZWZhdWx0TGFuZToKICAgICAgICByZXR1cm4gRGVmYXVsdExhbmU7CgogICAgICBjYXNlIFRyYW5zaXRpb25IeWRyYXRpb25MYW5lOgogICAgICAgIHJldHVybiBUcmFuc2l0aW9uSHlkcmF0aW9uTGFuZTsKCiAgICAgIGNhc2UgVHJhbnNpdGlvbkxhbmUxOgogICAgICBjYXNlIFRyYW5zaXRpb25MYW5lMjoKICAgICAgY2FzZSBUcmFuc2l0aW9uTGFuZTM6CiAgICAgIGNhc2UgVHJhbnNpdGlvbkxhbmU0OgogICAgICBjYXNlIFRyYW5zaXRpb25MYW5lNToKICAgICAgY2FzZSBUcmFuc2l0aW9uTGFuZTY6CiAgICAgIGNhc2UgVHJhbnNpdGlvbkxhbmU3OgogICAgICBjYXNlIFRyYW5zaXRpb25MYW5lODoKICAgICAgY2FzZSBUcmFuc2l0aW9uTGFuZTk6CiAgICAgIGNhc2UgVHJhbnNpdGlvbkxhbmUxMDoKICAgICAgY2FzZSBUcmFuc2l0aW9uTGFuZTExOgogICAgICBjYXNlIFRyYW5zaXRpb25MYW5lMTI6CiAgICAgIGNhc2UgVHJhbnNpdGlvbkxhbmUxMzoKICAgICAgY2FzZSBUcmFuc2l0aW9uTGFuZTE0OgogICAgICBjYXNlIFRyYW5zaXRpb25MYW5lMTU6CiAgICAgIGNhc2UgVHJhbnNpdGlvbkxhbmUxNjoKICAgICAgICByZXR1cm4gbGFuZXMgJiBUcmFuc2l0aW9uTGFuZXM7CgogICAgICBjYXNlIFJldHJ5TGFuZTE6CiAgICAgIGNhc2UgUmV0cnlMYW5lMjoKICAgICAgY2FzZSBSZXRyeUxhbmUzOgogICAgICBjYXNlIFJldHJ5TGFuZTQ6CiAgICAgIGNhc2UgUmV0cnlMYW5lNToKICAgICAgICByZXR1cm4gbGFuZXMgJiBSZXRyeUxhbmVzOwoKICAgICAgY2FzZSBTZWxlY3RpdmVIeWRyYXRpb25MYW5lOgogICAgICAgIHJldHVybiBTZWxlY3RpdmVIeWRyYXRpb25MYW5lOwoKICAgICAgY2FzZSBJZGxlSHlkcmF0aW9uTGFuZToKICAgICAgICByZXR1cm4gSWRsZUh5ZHJhdGlvbkxhbmU7CgogICAgICBjYXNlIElkbGVMYW5lOgogICAgICAgIHJldHVybiBJZGxlTGFuZTsKCiAgICAgIGNhc2UgT2Zmc2NyZWVuTGFuZToKICAgICAgICByZXR1cm4gT2Zmc2NyZWVuTGFuZTsKCiAgICAgIGRlZmF1bHQ6CiAgICAgICAgewogICAgICAgICAgZXJyb3IoJ1Nob3VsZCBoYXZlIGZvdW5kIG1hdGNoaW5nIGxhbmVzLiBUaGlzIGlzIGEgYnVnIGluIFJlYWN0LicpOwogICAgICAgIH0gLy8gVGhpcyBzaG91bGRuJ3QgYmUgcmVhY2hhYmxlLCBidXQgYXMgYSBmYWxsYmFjaywgcmV0dXJuIHRoZSBlbnRpcmUgYml0bWFzay4KCgogICAgICAgIHJldHVybiBsYW5lczsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGdldE5leHRMYW5lcyhyb290LCB3aXBMYW5lcykgewogICAgLy8gRWFybHkgYmFpbG91dCBpZiB0aGVyZSdzIG5vIHBlbmRpbmcgd29yayBsZWZ0LgogICAgdmFyIHBlbmRpbmdMYW5lcyA9IHJvb3QucGVuZGluZ0xhbmVzOwoKICAgIGlmIChwZW5kaW5nTGFuZXMgPT09IE5vTGFuZXMpIHsKICAgICAgcmV0dXJuIE5vTGFuZXM7CiAgICB9CgogICAgdmFyIG5leHRMYW5lcyA9IE5vTGFuZXM7CiAgICB2YXIgc3VzcGVuZGVkTGFuZXMgPSByb290LnN1c3BlbmRlZExhbmVzOwogICAgdmFyIHBpbmdlZExhbmVzID0gcm9vdC5waW5nZWRMYW5lczsgLy8gRG8gbm90IHdvcmsgb24gYW55IGlkbGUgd29yayB1bnRpbCBhbGwgdGhlIG5vbi1pZGxlIHdvcmsgaGFzIGZpbmlzaGVkLAogICAgLy8gZXZlbiBpZiB0aGUgd29yayBpcyBzdXNwZW5kZWQuCgogICAgdmFyIG5vbklkbGVQZW5kaW5nTGFuZXMgPSBwZW5kaW5nTGFuZXMgJiBOb25JZGxlTGFuZXM7CgogICAgaWYgKG5vbklkbGVQZW5kaW5nTGFuZXMgIT09IE5vTGFuZXMpIHsKICAgICAgdmFyIG5vbklkbGVVbmJsb2NrZWRMYW5lcyA9IG5vbklkbGVQZW5kaW5nTGFuZXMgJiB+c3VzcGVuZGVkTGFuZXM7CgogICAgICBpZiAobm9uSWRsZVVuYmxvY2tlZExhbmVzICE9PSBOb0xhbmVzKSB7CiAgICAgICAgbmV4dExhbmVzID0gZ2V0SGlnaGVzdFByaW9yaXR5TGFuZXMobm9uSWRsZVVuYmxvY2tlZExhbmVzKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgbm9uSWRsZVBpbmdlZExhbmVzID0gbm9uSWRsZVBlbmRpbmdMYW5lcyAmIHBpbmdlZExhbmVzOwoKICAgICAgICBpZiAobm9uSWRsZVBpbmdlZExhbmVzICE9PSBOb0xhbmVzKSB7CiAgICAgICAgICBuZXh0TGFuZXMgPSBnZXRIaWdoZXN0UHJpb3JpdHlMYW5lcyhub25JZGxlUGluZ2VkTGFuZXMpOwogICAgICAgIH0KICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgLy8gVGhlIG9ubHkgcmVtYWluaW5nIHdvcmsgaXMgSWRsZS4KICAgICAgdmFyIHVuYmxvY2tlZExhbmVzID0gcGVuZGluZ0xhbmVzICYgfnN1c3BlbmRlZExhbmVzOwoKICAgICAgaWYgKHVuYmxvY2tlZExhbmVzICE9PSBOb0xhbmVzKSB7CiAgICAgICAgbmV4dExhbmVzID0gZ2V0SGlnaGVzdFByaW9yaXR5TGFuZXModW5ibG9ja2VkTGFuZXMpOwogICAgICB9IGVsc2UgewogICAgICAgIGlmIChwaW5nZWRMYW5lcyAhPT0gTm9MYW5lcykgewogICAgICAgICAgbmV4dExhbmVzID0gZ2V0SGlnaGVzdFByaW9yaXR5TGFuZXMocGluZ2VkTGFuZXMpOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGlmIChuZXh0TGFuZXMgPT09IE5vTGFuZXMpIHsKICAgICAgLy8gVGhpcyBzaG91bGQgb25seSBiZSByZWFjaGFibGUgaWYgd2UncmUgc3VzcGVuZGVkCiAgICAgIC8vIFRPRE86IENvbnNpZGVyIHdhcm5pbmcgaW4gdGhpcyBwYXRoIGlmIGEgZmFsbGJhY2sgdGltZXIgaXMgbm90IHNjaGVkdWxlZC4KICAgICAgcmV0dXJuIE5vTGFuZXM7CiAgICB9IC8vIElmIHdlJ3JlIGFscmVhZHkgaW4gdGhlIG1pZGRsZSBvZiBhIHJlbmRlciwgc3dpdGNoaW5nIGxhbmVzIHdpbGwgaW50ZXJydXB0CiAgICAvLyBpdCBhbmQgd2UnbGwgbG9zZSBvdXIgcHJvZ3Jlc3MuIFdlIHNob3VsZCBvbmx5IGRvIHRoaXMgaWYgdGhlIG5ldyBsYW5lcyBhcmUKICAgIC8vIGhpZ2hlciBwcmlvcml0eS4KCgogICAgaWYgKHdpcExhbmVzICE9PSBOb0xhbmVzICYmIHdpcExhbmVzICE9PSBuZXh0TGFuZXMgJiYgLy8gSWYgd2UgYWxyZWFkeSBzdXNwZW5kZWQgd2l0aCBhIGRlbGF5LCB0aGVuIGludGVycnVwdGluZyBpcyBmaW5lLiBEb24ndAogICAgLy8gYm90aGVyIHdhaXRpbmcgdW50aWwgdGhlIHJvb3QgaXMgY29tcGxldGUuCiAgICAod2lwTGFuZXMgJiBzdXNwZW5kZWRMYW5lcykgPT09IE5vTGFuZXMpIHsKICAgICAgdmFyIG5leHRMYW5lID0gZ2V0SGlnaGVzdFByaW9yaXR5TGFuZShuZXh0TGFuZXMpOwogICAgICB2YXIgd2lwTGFuZSA9IGdldEhpZ2hlc3RQcmlvcml0eUxhbmUod2lwTGFuZXMpOwoKICAgICAgaWYgKCAvLyBUZXN0cyB3aGV0aGVyIHRoZSBuZXh0IGxhbmUgaXMgZXF1YWwgb3IgbG93ZXIgcHJpb3JpdHkgdGhhbiB0aGUgd2lwCiAgICAgIC8vIG9uZS4gVGhpcyB3b3JrcyBiZWNhdXNlIHRoZSBiaXRzIGRlY3JlYXNlIGluIHByaW9yaXR5IGFzIHlvdSBnbyBsZWZ0LgogICAgICBuZXh0TGFuZSA+PSB3aXBMYW5lIHx8IC8vIERlZmF1bHQgcHJpb3JpdHkgdXBkYXRlcyBzaG91bGQgbm90IGludGVycnVwdCB0cmFuc2l0aW9uIHVwZGF0ZXMuIFRoZQogICAgICAvLyBvbmx5IGRpZmZlcmVuY2UgYmV0d2VlbiBkZWZhdWx0IHVwZGF0ZXMgYW5kIHRyYW5zaXRpb24gdXBkYXRlcyBpcyB0aGF0CiAgICAgIC8vIGRlZmF1bHQgdXBkYXRlcyBkbyBub3Qgc3VwcG9ydCByZWZyZXNoIHRyYW5zaXRpb25zLgogICAgICBuZXh0TGFuZSA9PT0gRGVmYXVsdExhbmUgJiYgKHdpcExhbmUgJiBUcmFuc2l0aW9uTGFuZXMpICE9PSBOb0xhbmVzKSB7CiAgICAgICAgLy8gS2VlcCB3b3JraW5nIG9uIHRoZSBleGlzdGluZyBpbi1wcm9ncmVzcyB0cmVlLiBEbyBub3QgaW50ZXJydXB0LgogICAgICAgIHJldHVybiB3aXBMYW5lczsKICAgICAgfQogICAgfQoKICAgIGlmICgobmV4dExhbmVzICYgSW5wdXRDb250aW51b3VzTGFuZSkgIT09IE5vTGFuZXMpIHsKICAgICAgLy8gV2hlbiB1cGRhdGVzIGFyZSBzeW5jIGJ5IGRlZmF1bHQsIHdlIGVudGFuZ2xlIGNvbnRpbnVvdXMgcHJpb3JpdHkgdXBkYXRlcwogICAgICAvLyBhbmQgZGVmYXVsdCB1cGRhdGVzLCBzbyB0aGV5IHJlbmRlciBpbiB0aGUgc2FtZSBiYXRjaC4gVGhlIG9ubHkgcmVhc29uCiAgICAgIC8vIHRoZXkgdXNlIHNlcGFyYXRlIGxhbmVzIGlzIGJlY2F1c2UgY29udGludW91cyB1cGRhdGVzIHNob3VsZCBpbnRlcnJ1cHQKICAgICAgLy8gdHJhbnNpdGlvbnMsIGJ1dCBkZWZhdWx0IHVwZGF0ZXMgc2hvdWxkIG5vdC4KICAgICAgbmV4dExhbmVzIHw9IHBlbmRpbmdMYW5lcyAmIERlZmF1bHRMYW5lOwogICAgfSAvLyBDaGVjayBmb3IgZW50YW5nbGVkIGxhbmVzIGFuZCBhZGQgdGhlbSB0byB0aGUgYmF0Y2guCiAgICAvLwogICAgLy8gQSBsYW5lIGlzIHNhaWQgdG8gYmUgZW50YW5nbGVkIHdpdGggYW5vdGhlciB3aGVuIGl0J3Mgbm90IGFsbG93ZWQgdG8gcmVuZGVyCiAgICAvLyBpbiBhIGJhdGNoIHRoYXQgZG9lcyBub3QgYWxzbyBpbmNsdWRlIHRoZSBvdGhlciBsYW5lLiBUeXBpY2FsbHkgd2UgZG8gdGhpcwogICAgLy8gd2hlbiBtdWx0aXBsZSB1cGRhdGVzIGhhdmUgdGhlIHNhbWUgc291cmNlLCBhbmQgd2Ugb25seSB3YW50IHRvIHJlc3BvbmQgdG8KICAgIC8vIHRoZSBtb3N0IHJlY2VudCBldmVudCBmcm9tIHRoYXQgc291cmNlLgogICAgLy8KICAgIC8vIE5vdGUgdGhhdCB3ZSBhcHBseSBlbnRhbmdsZW1lbnRzICphZnRlciogY2hlY2tpbmcgZm9yIHBhcnRpYWwgd29yayBhYm92ZS4KICAgIC8vIFRoaXMgbWVhbnMgdGhhdCBpZiBhIGxhbmUgaXMgZW50YW5nbGVkIGR1cmluZyBhbiBpbnRlcmxlYXZlZCBldmVudCB3aGlsZQogICAgLy8gaXQncyBhbHJlYWR5IHJlbmRlcmluZywgd2Ugd29uJ3QgaW50ZXJydXB0IGl0LiBUaGlzIGlzIGludGVudGlvbmFsLCBzaW5jZQogICAgLy8gZW50YW5nbGVtZW50IGlzIHVzdWFsbHkgImJlc3QgZWZmb3J0Ijogd2UnbGwgdHJ5IG91ciBiZXN0IHRvIHJlbmRlciB0aGUKICAgIC8vIGxhbmVzIGluIHRoZSBzYW1lIGJhdGNoLCBidXQgaXQncyBub3Qgd29ydGggdGhyb3dpbmcgb3V0IHBhcnRpYWxseQogICAgLy8gY29tcGxldGVkIHdvcmsgaW4gb3JkZXIgdG8gZG8gaXQuCiAgICAvLyBUT0RPOiBSZWNvbnNpZGVyIHRoaXMuIFRoZSBjb3VudGVyLWFyZ3VtZW50IGlzIHRoYXQgdGhlIHBhcnRpYWwgd29yawogICAgLy8gcmVwcmVzZW50cyBhbiBpbnRlcm1lZGlhdGUgc3RhdGUsIHdoaWNoIHdlIGRvbid0IHdhbnQgdG8gc2hvdyB0byB0aGUgdXNlci4KICAgIC8vIEFuZCBieSBzcGVuZGluZyBleHRyYSB0aW1lIGZpbmlzaGluZyBpdCwgd2UncmUgaW5jcmVhc2luZyB0aGUgYW1vdW50IG9mCiAgICAvLyB0aW1lIGl0IHRha2VzIHRvIHNob3cgdGhlIGZpbmFsIHN0YXRlLCB3aGljaCBpcyB3aGF0IHRoZXkgYXJlIGFjdHVhbGx5CiAgICAvLyB3YWl0aW5nIGZvci4KICAgIC8vCiAgICAvLyBGb3IgdGhvc2UgZXhjZXB0aW9ucyB3aGVyZSBlbnRhbmdsZW1lbnQgaXMgc2VtYW50aWNhbGx5IGltcG9ydGFudCwgbGlrZQogICAgLy8gdXNlTXV0YWJsZVNvdXJjZSwgd2Ugc2hvdWxkIGVuc3VyZSB0aGF0IHRoZXJlIGlzIG5vIHBhcnRpYWwgd29yayBhdCB0aGUKICAgIC8vIHRpbWUgd2UgYXBwbHkgdGhlIGVudGFuZ2xlbWVudC4KCgogICAgdmFyIGVudGFuZ2xlZExhbmVzID0gcm9vdC5lbnRhbmdsZWRMYW5lczsKCiAgICBpZiAoZW50YW5nbGVkTGFuZXMgIT09IE5vTGFuZXMpIHsKICAgICAgdmFyIGVudGFuZ2xlbWVudHMgPSByb290LmVudGFuZ2xlbWVudHM7CiAgICAgIHZhciBsYW5lcyA9IG5leHRMYW5lcyAmIGVudGFuZ2xlZExhbmVzOwoKICAgICAgd2hpbGUgKGxhbmVzID4gMCkgewogICAgICAgIHZhciBpbmRleCA9IHBpY2tBcmJpdHJhcnlMYW5lSW5kZXgobGFuZXMpOwogICAgICAgIHZhciBsYW5lID0gMSA8PCBpbmRleDsKICAgICAgICBuZXh0TGFuZXMgfD0gZW50YW5nbGVtZW50c1tpbmRleF07CiAgICAgICAgbGFuZXMgJj0gfmxhbmU7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gbmV4dExhbmVzOwogIH0KICBmdW5jdGlvbiBnZXRNb3N0UmVjZW50RXZlbnRUaW1lKHJvb3QsIGxhbmVzKSB7CiAgICB2YXIgZXZlbnRUaW1lcyA9IHJvb3QuZXZlbnRUaW1lczsKICAgIHZhciBtb3N0UmVjZW50RXZlbnRUaW1lID0gTm9UaW1lc3RhbXA7CgogICAgd2hpbGUgKGxhbmVzID4gMCkgewogICAgICB2YXIgaW5kZXggPSBwaWNrQXJiaXRyYXJ5TGFuZUluZGV4KGxhbmVzKTsKICAgICAgdmFyIGxhbmUgPSAxIDw8IGluZGV4OwogICAgICB2YXIgZXZlbnRUaW1lID0gZXZlbnRUaW1lc1tpbmRleF07CgogICAgICBpZiAoZXZlbnRUaW1lID4gbW9zdFJlY2VudEV2ZW50VGltZSkgewogICAgICAgIG1vc3RSZWNlbnRFdmVudFRpbWUgPSBldmVudFRpbWU7CiAgICAgIH0KCiAgICAgIGxhbmVzICY9IH5sYW5lOwogICAgfQoKICAgIHJldHVybiBtb3N0UmVjZW50RXZlbnRUaW1lOwogIH0KCiAgZnVuY3Rpb24gY29tcHV0ZUV4cGlyYXRpb25UaW1lKGxhbmUsIGN1cnJlbnRUaW1lKSB7CiAgICBzd2l0Y2ggKGxhbmUpIHsKICAgICAgY2FzZSBTeW5jTGFuZToKICAgICAgY2FzZSBJbnB1dENvbnRpbnVvdXNIeWRyYXRpb25MYW5lOgogICAgICBjYXNlIElucHV0Q29udGludW91c0xhbmU6CiAgICAgICAgLy8gVXNlciBpbnRlcmFjdGlvbnMgc2hvdWxkIGV4cGlyZSBzbGlnaHRseSBtb3JlIHF1aWNrbHkuCiAgICAgICAgLy8KICAgICAgICAvLyBOT1RFOiBUaGlzIGlzIHNldCB0byB0aGUgY29ycmVzcG9uZGluZyBjb25zdGFudCBhcyBpbiBTY2hlZHVsZXIuanMuCiAgICAgICAgLy8gV2hlbiB3ZSBtYWRlIGl0IGxhcmdlciwgYSBwcm9kdWN0IG1ldHJpYyBpbiB3d3cgcmVncmVzc2VkLCBzdWdnZXN0aW5nCiAgICAgICAgLy8gdGhlcmUncyBhIHVzZXIgaW50ZXJhY3Rpb24gdGhhdCdzIGJlaW5nIHN0YXJ2ZWQgYnkgYSBzZXJpZXMgb2YKICAgICAgICAvLyBzeW5jaHJvbm91cyB1cGRhdGVzLiBJZiB0aGF0IHRoZW9yeSBpcyBjb3JyZWN0LCB0aGUgcHJvcGVyIHNvbHV0aW9uIGlzCiAgICAgICAgLy8gdG8gZml4IHRoZSBzdGFydmF0aW9uLiBIb3dldmVyLCB0aGlzIHNjZW5hcmlvIHN1cHBvcnRzIHRoZSBpZGVhIHRoYXQKICAgICAgICAvLyBleHBpcmF0aW9uIHRpbWVzIGFyZSBhbiBpbXBvcnRhbnQgc2FmZWd1YXJkIHdoZW4gc3RhcnZhdGlvbgogICAgICAgIC8vIGRvZXMgaGFwcGVuLgogICAgICAgIHJldHVybiBjdXJyZW50VGltZSArIDI1MDsKCiAgICAgIGNhc2UgRGVmYXVsdEh5ZHJhdGlvbkxhbmU6CiAgICAgIGNhc2UgRGVmYXVsdExhbmU6CiAgICAgIGNhc2UgVHJhbnNpdGlvbkh5ZHJhdGlvbkxhbmU6CiAgICAgIGNhc2UgVHJhbnNpdGlvbkxhbmUxOgogICAgICBjYXNlIFRyYW5zaXRpb25MYW5lMjoKICAgICAgY2FzZSBUcmFuc2l0aW9uTGFuZTM6CiAgICAgIGNhc2UgVHJhbnNpdGlvbkxhbmU0OgogICAgICBjYXNlIFRyYW5zaXRpb25MYW5lNToKICAgICAgY2FzZSBUcmFuc2l0aW9uTGFuZTY6CiAgICAgIGNhc2UgVHJhbnNpdGlvbkxhbmU3OgogICAgICBjYXNlIFRyYW5zaXRpb25MYW5lODoKICAgICAgY2FzZSBUcmFuc2l0aW9uTGFuZTk6CiAgICAgIGNhc2UgVHJhbnNpdGlvbkxhbmUxMDoKICAgICAgY2FzZSBUcmFuc2l0aW9uTGFuZTExOgogICAgICBjYXNlIFRyYW5zaXRpb25MYW5lMTI6CiAgICAgIGNhc2UgVHJhbnNpdGlvbkxhbmUxMzoKICAgICAgY2FzZSBUcmFuc2l0aW9uTGFuZTE0OgogICAgICBjYXNlIFRyYW5zaXRpb25MYW5lMTU6CiAgICAgIGNhc2UgVHJhbnNpdGlvbkxhbmUxNjoKICAgICAgICByZXR1cm4gY3VycmVudFRpbWUgKyA1MDAwOwoKICAgICAgY2FzZSBSZXRyeUxhbmUxOgogICAgICBjYXNlIFJldHJ5TGFuZTI6CiAgICAgIGNhc2UgUmV0cnlMYW5lMzoKICAgICAgY2FzZSBSZXRyeUxhbmU0OgogICAgICBjYXNlIFJldHJ5TGFuZTU6CiAgICAgICAgLy8gVE9ETzogUmV0cmllcyBzaG91bGQgYmUgYWxsb3dlZCB0byBleHBpcmUgaWYgdGhleSBhcmUgQ1BVIGJvdW5kIGZvcgogICAgICAgIC8vIHRvbyBsb25nLCBidXQgd2hlbiBJIG1hZGUgdGhpcyBjaGFuZ2UgaXQgY2F1c2VkIGEgc3Bpa2UgaW4gYnJvd3NlcgogICAgICAgIC8vIGNyYXNoZXMuIFRoZXJlIG11c3QgYmUgc29tZSBvdGhlciB1bmRlcmx5aW5nIGJ1Zzsgbm90IHN1cGVyIHVyZ2VudCBidXQKICAgICAgICAvLyBpZGVhbGx5IHNob3VsZCBmaWd1cmUgb3V0IHdoeSBhbmQgZml4IGl0LiBVbmZvcnR1bmF0ZWx5IHdlIGRvbid0IGhhdmUKICAgICAgICAvLyBhIHJlcHJvIGZvciB0aGUgY3Jhc2hlcywgb25seSBkZXRlY3RlZCB2aWEgcHJvZHVjdGlvbiBtZXRyaWNzLgogICAgICAgIHJldHVybiBOb1RpbWVzdGFtcDsKCiAgICAgIGNhc2UgU2VsZWN0aXZlSHlkcmF0aW9uTGFuZToKICAgICAgY2FzZSBJZGxlSHlkcmF0aW9uTGFuZToKICAgICAgY2FzZSBJZGxlTGFuZToKICAgICAgY2FzZSBPZmZzY3JlZW5MYW5lOgogICAgICAgIC8vIEFueXRoaW5nIGlkbGUgcHJpb3JpdHkgb3IgbG93ZXIgc2hvdWxkIG5ldmVyIGV4cGlyZS4KICAgICAgICByZXR1cm4gTm9UaW1lc3RhbXA7CgogICAgICBkZWZhdWx0OgogICAgICAgIHsKICAgICAgICAgIGVycm9yKCdTaG91bGQgaGF2ZSBmb3VuZCBtYXRjaGluZyBsYW5lcy4gVGhpcyBpcyBhIGJ1ZyBpbiBSZWFjdC4nKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBOb1RpbWVzdGFtcDsKICAgIH0KICB9CgogIGZ1bmN0aW9uIG1hcmtTdGFydmVkTGFuZXNBc0V4cGlyZWQocm9vdCwgY3VycmVudFRpbWUpIHsKICAgIC8vIFRPRE86IFRoaXMgZ2V0cyBjYWxsZWQgZXZlcnkgdGltZSB3ZSB5aWVsZC4gV2UgY2FuIG9wdGltaXplIGJ5IHN0b3JpbmcKICAgIC8vIHRoZSBlYXJsaWVzdCBleHBpcmF0aW9uIHRpbWUgb24gdGhlIHJvb3QuIFRoZW4gdXNlIHRoYXQgdG8gcXVpY2tseSBiYWlsIG91dAogICAgLy8gb2YgdGhpcyBmdW5jdGlvbi4KICAgIHZhciBwZW5kaW5nTGFuZXMgPSByb290LnBlbmRpbmdMYW5lczsKICAgIHZhciBzdXNwZW5kZWRMYW5lcyA9IHJvb3Quc3VzcGVuZGVkTGFuZXM7CiAgICB2YXIgcGluZ2VkTGFuZXMgPSByb290LnBpbmdlZExhbmVzOwogICAgdmFyIGV4cGlyYXRpb25UaW1lcyA9IHJvb3QuZXhwaXJhdGlvblRpbWVzOyAvLyBJdGVyYXRlIHRocm91Z2ggdGhlIHBlbmRpbmcgbGFuZXMgYW5kIGNoZWNrIGlmIHdlJ3ZlIHJlYWNoZWQgdGhlaXIKICAgIC8vIGV4cGlyYXRpb24gdGltZS4gSWYgc28sIHdlJ2xsIGFzc3VtZSB0aGUgdXBkYXRlIGlzIGJlaW5nIHN0YXJ2ZWQgYW5kIG1hcmsKICAgIC8vIGl0IGFzIGV4cGlyZWQgdG8gZm9yY2UgaXQgdG8gZmluaXNoLgoKICAgIHZhciBsYW5lcyA9IHBlbmRpbmdMYW5lczsKCiAgICB3aGlsZSAobGFuZXMgPiAwKSB7CiAgICAgIHZhciBpbmRleCA9IHBpY2tBcmJpdHJhcnlMYW5lSW5kZXgobGFuZXMpOwogICAgICB2YXIgbGFuZSA9IDEgPDwgaW5kZXg7CiAgICAgIHZhciBleHBpcmF0aW9uVGltZSA9IGV4cGlyYXRpb25UaW1lc1tpbmRleF07CgogICAgICBpZiAoZXhwaXJhdGlvblRpbWUgPT09IE5vVGltZXN0YW1wKSB7CiAgICAgICAgLy8gRm91bmQgYSBwZW5kaW5nIGxhbmUgd2l0aCBubyBleHBpcmF0aW9uIHRpbWUuIElmIGl0J3Mgbm90IHN1c3BlbmRlZCwgb3IKICAgICAgICAvLyBpZiBpdCdzIHBpbmdlZCwgYXNzdW1lIGl0J3MgQ1BVLWJvdW5kLiBDb21wdXRlIGEgbmV3IGV4cGlyYXRpb24gdGltZQogICAgICAgIC8vIHVzaW5nIHRoZSBjdXJyZW50IHRpbWUuCiAgICAgICAgaWYgKChsYW5lICYgc3VzcGVuZGVkTGFuZXMpID09PSBOb0xhbmVzIHx8IChsYW5lICYgcGluZ2VkTGFuZXMpICE9PSBOb0xhbmVzKSB7CiAgICAgICAgICAvLyBBc3N1bWVzIHRpbWVzdGFtcHMgYXJlIG1vbm90b25pY2FsbHkgaW5jcmVhc2luZy4KICAgICAgICAgIGV4cGlyYXRpb25UaW1lc1tpbmRleF0gPSBjb21wdXRlRXhwaXJhdGlvblRpbWUobGFuZSwgY3VycmVudFRpbWUpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChleHBpcmF0aW9uVGltZSA8PSBjdXJyZW50VGltZSkgewogICAgICAgIC8vIFRoaXMgbGFuZSBleHBpcmVkCiAgICAgICAgcm9vdC5leHBpcmVkTGFuZXMgfD0gbGFuZTsKICAgICAgfQoKICAgICAgbGFuZXMgJj0gfmxhbmU7CiAgICB9CiAgfSAvLyBUaGlzIHJldHVybnMgdGhlIGhpZ2hlc3QgcHJpb3JpdHkgcGVuZGluZyBsYW5lcyByZWdhcmRsZXNzIG9mIHdoZXRoZXIgdGhleQogIC8vIGFyZSBzdXNwZW5kZWQuCgogIGZ1bmN0aW9uIGdldEhpZ2hlc3RQcmlvcml0eVBlbmRpbmdMYW5lcyhyb290KSB7CiAgICByZXR1cm4gZ2V0SGlnaGVzdFByaW9yaXR5TGFuZXMocm9vdC5wZW5kaW5nTGFuZXMpOwogIH0KICBmdW5jdGlvbiBnZXRMYW5lc1RvUmV0cnlTeW5jaHJvbm91c2x5T25FcnJvcihyb290KSB7CiAgICB2YXIgZXZlcnl0aGluZ0J1dE9mZnNjcmVlbiA9IHJvb3QucGVuZGluZ0xhbmVzICYgfk9mZnNjcmVlbkxhbmU7CgogICAgaWYgKGV2ZXJ5dGhpbmdCdXRPZmZzY3JlZW4gIT09IE5vTGFuZXMpIHsKICAgICAgcmV0dXJuIGV2ZXJ5dGhpbmdCdXRPZmZzY3JlZW47CiAgICB9CgogICAgaWYgKGV2ZXJ5dGhpbmdCdXRPZmZzY3JlZW4gJiBPZmZzY3JlZW5MYW5lKSB7CiAgICAgIHJldHVybiBPZmZzY3JlZW5MYW5lOwogICAgfQoKICAgIHJldHVybiBOb0xhbmVzOwogIH0KICBmdW5jdGlvbiBpbmNsdWRlc1N5bmNMYW5lKGxhbmVzKSB7CiAgICByZXR1cm4gKGxhbmVzICYgU3luY0xhbmUpICE9PSBOb0xhbmVzOwogIH0KICBmdW5jdGlvbiBpbmNsdWRlc05vbklkbGVXb3JrKGxhbmVzKSB7CiAgICByZXR1cm4gKGxhbmVzICYgTm9uSWRsZUxhbmVzKSAhPT0gTm9MYW5lczsKICB9CiAgZnVuY3Rpb24gaW5jbHVkZXNPbmx5UmV0cmllcyhsYW5lcykgewogICAgcmV0dXJuIChsYW5lcyAmIFJldHJ5TGFuZXMpID09PSBsYW5lczsKICB9CiAgZnVuY3Rpb24gaW5jbHVkZXNPbmx5Tm9uVXJnZW50TGFuZXMobGFuZXMpIHsKICAgIHZhciBVcmdlbnRMYW5lcyA9IFN5bmNMYW5lIHwgSW5wdXRDb250aW51b3VzTGFuZSB8IERlZmF1bHRMYW5lOwogICAgcmV0dXJuIChsYW5lcyAmIFVyZ2VudExhbmVzKSA9PT0gTm9MYW5lczsKICB9CiAgZnVuY3Rpb24gaW5jbHVkZXNPbmx5VHJhbnNpdGlvbnMobGFuZXMpIHsKICAgIHJldHVybiAobGFuZXMgJiBUcmFuc2l0aW9uTGFuZXMpID09PSBsYW5lczsKICB9CiAgZnVuY3Rpb24gaW5jbHVkZXNCbG9ja2luZ0xhbmUocm9vdCwgbGFuZXMpIHsKCiAgICB2YXIgU3luY0RlZmF1bHRMYW5lcyA9IElucHV0Q29udGludW91c0h5ZHJhdGlvbkxhbmUgfCBJbnB1dENvbnRpbnVvdXNMYW5lIHwgRGVmYXVsdEh5ZHJhdGlvbkxhbmUgfCBEZWZhdWx0TGFuZTsKICAgIHJldHVybiAobGFuZXMgJiBTeW5jRGVmYXVsdExhbmVzKSAhPT0gTm9MYW5lczsKICB9CiAgZnVuY3Rpb24gaW5jbHVkZXNFeHBpcmVkTGFuZShyb290LCBsYW5lcykgewogICAgLy8gVGhpcyBpcyBhIHNlcGFyYXRlIGNoZWNrIGZyb20gaW5jbHVkZXNCbG9ja2luZ0xhbmUgYmVjYXVzZSBhIGxhbmUgY2FuCiAgICAvLyBleHBpcmUgYWZ0ZXIgYSByZW5kZXIgaGFzIGFscmVhZHkgc3RhcnRlZC4KICAgIHJldHVybiAobGFuZXMgJiByb290LmV4cGlyZWRMYW5lcykgIT09IE5vTGFuZXM7CiAgfQogIGZ1bmN0aW9uIGlzVHJhbnNpdGlvbkxhbmUobGFuZSkgewogICAgcmV0dXJuIChsYW5lICYgVHJhbnNpdGlvbkxhbmVzKSAhPT0gTm9MYW5lczsKICB9CiAgZnVuY3Rpb24gY2xhaW1OZXh0VHJhbnNpdGlvbkxhbmUoKSB7CiAgICAvLyBDeWNsZSB0aHJvdWdoIHRoZSBsYW5lcywgYXNzaWduaW5nIGVhY2ggbmV3IHRyYW5zaXRpb24gdG8gdGhlIG5leHQgbGFuZS4KICAgIC8vIEluIG1vc3QgY2FzZXMsIHRoaXMgbWVhbnMgZXZlcnkgdHJhbnNpdGlvbiBnZXRzIGl0cyBvd24gbGFuZSwgdW50aWwgd2UKICAgIC8vIHJ1biBvdXQgb2YgbGFuZXMgYW5kIGN5Y2xlIGJhY2sgdG8gdGhlIGJlZ2lubmluZy4KICAgIHZhciBsYW5lID0gbmV4dFRyYW5zaXRpb25MYW5lOwogICAgbmV4dFRyYW5zaXRpb25MYW5lIDw8PSAxOwoKICAgIGlmICgobmV4dFRyYW5zaXRpb25MYW5lICYgVHJhbnNpdGlvbkxhbmVzKSA9PT0gTm9MYW5lcykgewogICAgICBuZXh0VHJhbnNpdGlvbkxhbmUgPSBUcmFuc2l0aW9uTGFuZTE7CiAgICB9CgogICAgcmV0dXJuIGxhbmU7CiAgfQogIGZ1bmN0aW9uIGNsYWltTmV4dFJldHJ5TGFuZSgpIHsKICAgIHZhciBsYW5lID0gbmV4dFJldHJ5TGFuZTsKICAgIG5leHRSZXRyeUxhbmUgPDw9IDE7CgogICAgaWYgKChuZXh0UmV0cnlMYW5lICYgUmV0cnlMYW5lcykgPT09IE5vTGFuZXMpIHsKICAgICAgbmV4dFJldHJ5TGFuZSA9IFJldHJ5TGFuZTE7CiAgICB9CgogICAgcmV0dXJuIGxhbmU7CiAgfQogIGZ1bmN0aW9uIGdldEhpZ2hlc3RQcmlvcml0eUxhbmUobGFuZXMpIHsKICAgIHJldHVybiBsYW5lcyAmIC1sYW5lczsKICB9CiAgZnVuY3Rpb24gcGlja0FyYml0cmFyeUxhbmUobGFuZXMpIHsKICAgIC8vIFRoaXMgd3JhcHBlciBmdW5jdGlvbiBnZXRzIGlubGluZWQuIE9ubHkgZXhpc3RzIHNvIHRvIGNvbW11bmljYXRlIHRoYXQgaXQKICAgIC8vIGRvZXNuJ3QgbWF0dGVyIHdoaWNoIGJpdCBpcyBzZWxlY3RlZDsgeW91IGNhbiBwaWNrIGFueSBiaXQgd2l0aG91dAogICAgLy8gYWZmZWN0aW5nIHRoZSBhbGdvcml0aG1zIHdoZXJlIGl0cyB1c2VkLiBIZXJlIEknbSB1c2luZwogICAgLy8gZ2V0SGlnaGVzdFByaW9yaXR5TGFuZSBiZWNhdXNlIGl0IHJlcXVpcmVzIHRoZSBmZXdlc3Qgb3BlcmF0aW9ucy4KICAgIHJldHVybiBnZXRIaWdoZXN0UHJpb3JpdHlMYW5lKGxhbmVzKTsKICB9CgogIGZ1bmN0aW9uIHBpY2tBcmJpdHJhcnlMYW5lSW5kZXgobGFuZXMpIHsKICAgIHJldHVybiAzMSAtIGNsejMyKGxhbmVzKTsKICB9CgogIGZ1bmN0aW9uIGxhbmVUb0luZGV4KGxhbmUpIHsKICAgIHJldHVybiBwaWNrQXJiaXRyYXJ5TGFuZUluZGV4KGxhbmUpOwogIH0KCiAgZnVuY3Rpb24gaW5jbHVkZXNTb21lTGFuZShhLCBiKSB7CiAgICByZXR1cm4gKGEgJiBiKSAhPT0gTm9MYW5lczsKICB9CiAgZnVuY3Rpb24gaXNTdWJzZXRPZkxhbmVzKHNldCwgc3Vic2V0KSB7CiAgICByZXR1cm4gKHNldCAmIHN1YnNldCkgPT09IHN1YnNldDsKICB9CiAgZnVuY3Rpb24gbWVyZ2VMYW5lcyhhLCBiKSB7CiAgICByZXR1cm4gYSB8IGI7CiAgfQogIGZ1bmN0aW9uIHJlbW92ZUxhbmVzKHNldCwgc3Vic2V0KSB7CiAgICByZXR1cm4gc2V0ICYgfnN1YnNldDsKICB9CiAgZnVuY3Rpb24gaW50ZXJzZWN0TGFuZXMoYSwgYikgewogICAgcmV0dXJuIGEgJiBiOwogIH0gLy8gU2VlbXMgcmVkdW5kYW50LCBidXQgaXQgY2hhbmdlcyB0aGUgdHlwZSBmcm9tIGEgc2luZ2xlIGxhbmUgKHVzZWQgZm9yCiAgLy8gdXBkYXRlcykgdG8gYSBncm91cCBvZiBsYW5lcyAodXNlZCBmb3IgZmx1c2hpbmcgd29yaykuCgogIGZ1bmN0aW9uIGxhbmVUb0xhbmVzKGxhbmUpIHsKICAgIHJldHVybiBsYW5lOwogIH0KICBmdW5jdGlvbiBoaWdoZXJQcmlvcml0eUxhbmUoYSwgYikgewogICAgLy8gVGhpcyB3b3JrcyBiZWNhdXNlIHRoZSBiaXQgcmFuZ2VzIGRlY3JlYXNlIGluIHByaW9yaXR5IGFzIHlvdSBnbyBsZWZ0LgogICAgcmV0dXJuIGEgIT09IE5vTGFuZSAmJiBhIDwgYiA/IGEgOiBiOwogIH0KICBmdW5jdGlvbiBjcmVhdGVMYW5lTWFwKGluaXRpYWwpIHsKICAgIC8vIEludGVudGlvbmFsbHkgcHVzaGluZyBvbmUgYnkgb25lLgogICAgLy8gaHR0cHM6Ly92OC5kZXYvYmxvZy9lbGVtZW50cy1raW5kcyNhdm9pZC1jcmVhdGluZy1ob2xlcwogICAgdmFyIGxhbmVNYXAgPSBbXTsKCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IFRvdGFsTGFuZXM7IGkrKykgewogICAgICBsYW5lTWFwLnB1c2goaW5pdGlhbCk7CiAgICB9CgogICAgcmV0dXJuIGxhbmVNYXA7CiAgfQogIGZ1bmN0aW9uIG1hcmtSb290VXBkYXRlZChyb290LCB1cGRhdGVMYW5lLCBldmVudFRpbWUpIHsKICAgIHJvb3QucGVuZGluZ0xhbmVzIHw9IHVwZGF0ZUxhbmU7IC8vIElmIHRoZXJlIGFyZSBhbnkgc3VzcGVuZGVkIHRyYW5zaXRpb25zLCBpdCdzIHBvc3NpYmxlIHRoaXMgbmV3IHVwZGF0ZQogICAgLy8gY291bGQgdW5ibG9jayB0aGVtLiBDbGVhciB0aGUgc3VzcGVuZGVkIGxhbmVzIHNvIHRoYXQgd2UgY2FuIHRyeSByZW5kZXJpbmcKICAgIC8vIHRoZW0gYWdhaW4uCiAgICAvLwogICAgLy8gVE9ETzogV2UgcmVhbGx5IG9ubHkgbmVlZCB0byB1bnN1c3BlbmQgb25seSBsYW5lcyB0aGF0IGFyZSBpbiB0aGUKICAgIC8vIGBzdWJ0cmVlTGFuZXNgIG9mIHRoZSB1cGRhdGVkIGZpYmVyLCBvciB0aGUgdXBkYXRlIGxhbmVzIG9mIHRoZSByZXR1cm4KICAgIC8vIHBhdGguIFRoaXMgd291bGQgZXhjbHVkZSBzdXNwZW5kZWQgdXBkYXRlcyBpbiBhbiB1bnJlbGF0ZWQgc2libGluZyB0cmVlLAogICAgLy8gc2luY2UgdGhlcmUncyBubyB3YXkgZm9yIHRoaXMgdXBkYXRlIHRvIHVuYmxvY2sgaXQuCiAgICAvLwogICAgLy8gV2UgZG9uJ3QgZG8gdGhpcyBpZiB0aGUgaW5jb21pbmcgdXBkYXRlIGlzIGlkbGUsIGJlY2F1c2Ugd2UgbmV2ZXIgcHJvY2VzcwogICAgLy8gaWRsZSB1cGRhdGVzIHVudGlsIGFmdGVyIGFsbCB0aGUgcmVndWxhciB1cGRhdGVzIGhhdmUgZmluaXNoZWQ7IHRoZXJlJ3Mgbm8KICAgIC8vIHdheSBpdCBjb3VsZCB1bmJsb2NrIGEgdHJhbnNpdGlvbi4KCiAgICBpZiAodXBkYXRlTGFuZSAhPT0gSWRsZUxhbmUpIHsKICAgICAgcm9vdC5zdXNwZW5kZWRMYW5lcyA9IE5vTGFuZXM7CiAgICAgIHJvb3QucGluZ2VkTGFuZXMgPSBOb0xhbmVzOwogICAgfQoKICAgIHZhciBldmVudFRpbWVzID0gcm9vdC5ldmVudFRpbWVzOwogICAgdmFyIGluZGV4ID0gbGFuZVRvSW5kZXgodXBkYXRlTGFuZSk7IC8vIFdlIGNhbiBhbHdheXMgb3ZlcndyaXRlIGFuIGV4aXN0aW5nIHRpbWVzdGFtcCBiZWNhdXNlIHdlIHByZWZlciB0aGUgbW9zdAogICAgLy8gcmVjZW50IGV2ZW50LCBhbmQgd2UgYXNzdW1lIHRpbWUgaXMgbW9ub3RvbmljYWxseSBpbmNyZWFzaW5nLgoKICAgIGV2ZW50VGltZXNbaW5kZXhdID0gZXZlbnRUaW1lOwogIH0KICBmdW5jdGlvbiBtYXJrUm9vdFN1c3BlbmRlZChyb290LCBzdXNwZW5kZWRMYW5lcykgewogICAgcm9vdC5zdXNwZW5kZWRMYW5lcyB8PSBzdXNwZW5kZWRMYW5lczsKICAgIHJvb3QucGluZ2VkTGFuZXMgJj0gfnN1c3BlbmRlZExhbmVzOyAvLyBUaGUgc3VzcGVuZGVkIGxhbmVzIGFyZSBubyBsb25nZXIgQ1BVLWJvdW5kLiBDbGVhciB0aGVpciBleHBpcmF0aW9uIHRpbWVzLgoKICAgIHZhciBleHBpcmF0aW9uVGltZXMgPSByb290LmV4cGlyYXRpb25UaW1lczsKICAgIHZhciBsYW5lcyA9IHN1c3BlbmRlZExhbmVzOwoKICAgIHdoaWxlIChsYW5lcyA+IDApIHsKICAgICAgdmFyIGluZGV4ID0gcGlja0FyYml0cmFyeUxhbmVJbmRleChsYW5lcyk7CiAgICAgIHZhciBsYW5lID0gMSA8PCBpbmRleDsKICAgICAgZXhwaXJhdGlvblRpbWVzW2luZGV4XSA9IE5vVGltZXN0YW1wOwogICAgICBsYW5lcyAmPSB+bGFuZTsKICAgIH0KICB9CiAgZnVuY3Rpb24gbWFya1Jvb3RQaW5nZWQocm9vdCwgcGluZ2VkTGFuZXMsIGV2ZW50VGltZSkgewogICAgcm9vdC5waW5nZWRMYW5lcyB8PSByb290LnN1c3BlbmRlZExhbmVzICYgcGluZ2VkTGFuZXM7CiAgfQogIGZ1bmN0aW9uIG1hcmtSb290RmluaXNoZWQocm9vdCwgcmVtYWluaW5nTGFuZXMpIHsKICAgIHZhciBub0xvbmdlclBlbmRpbmdMYW5lcyA9IHJvb3QucGVuZGluZ0xhbmVzICYgfnJlbWFpbmluZ0xhbmVzOwogICAgcm9vdC5wZW5kaW5nTGFuZXMgPSByZW1haW5pbmdMYW5lczsgLy8gTGV0J3MgdHJ5IGV2ZXJ5dGhpbmcgYWdhaW4KCiAgICByb290LnN1c3BlbmRlZExhbmVzID0gTm9MYW5lczsKICAgIHJvb3QucGluZ2VkTGFuZXMgPSBOb0xhbmVzOwogICAgcm9vdC5leHBpcmVkTGFuZXMgJj0gcmVtYWluaW5nTGFuZXM7CiAgICByb290Lm11dGFibGVSZWFkTGFuZXMgJj0gcmVtYWluaW5nTGFuZXM7CiAgICByb290LmVudGFuZ2xlZExhbmVzICY9IHJlbWFpbmluZ0xhbmVzOwogICAgdmFyIGVudGFuZ2xlbWVudHMgPSByb290LmVudGFuZ2xlbWVudHM7CiAgICB2YXIgZXZlbnRUaW1lcyA9IHJvb3QuZXZlbnRUaW1lczsKICAgIHZhciBleHBpcmF0aW9uVGltZXMgPSByb290LmV4cGlyYXRpb25UaW1lczsgLy8gQ2xlYXIgdGhlIGxhbmVzIHRoYXQgbm8gbG9uZ2VyIGhhdmUgcGVuZGluZyB3b3JrCgogICAgdmFyIGxhbmVzID0gbm9Mb25nZXJQZW5kaW5nTGFuZXM7CgogICAgd2hpbGUgKGxhbmVzID4gMCkgewogICAgICB2YXIgaW5kZXggPSBwaWNrQXJiaXRyYXJ5TGFuZUluZGV4KGxhbmVzKTsKICAgICAgdmFyIGxhbmUgPSAxIDw8IGluZGV4OwogICAgICBlbnRhbmdsZW1lbnRzW2luZGV4XSA9IE5vTGFuZXM7CiAgICAgIGV2ZW50VGltZXNbaW5kZXhdID0gTm9UaW1lc3RhbXA7CiAgICAgIGV4cGlyYXRpb25UaW1lc1tpbmRleF0gPSBOb1RpbWVzdGFtcDsKICAgICAgbGFuZXMgJj0gfmxhbmU7CiAgICB9CiAgfQogIGZ1bmN0aW9uIG1hcmtSb290RW50YW5nbGVkKHJvb3QsIGVudGFuZ2xlZExhbmVzKSB7CiAgICAvLyBJbiBhZGRpdGlvbiB0byBlbnRhbmdsaW5nIGVhY2ggb2YgdGhlIGdpdmVuIGxhbmVzIHdpdGggZWFjaCBvdGhlciwgd2UgYWxzbwogICAgLy8gaGF2ZSB0byBjb25zaWRlciBfdHJhbnNpdGl2ZV8gZW50YW5nbGVtZW50cy4gRm9yIGVhY2ggbGFuZSB0aGF0IGlzIGFscmVhZHkKICAgIC8vIGVudGFuZ2xlZCB3aXRoICphbnkqIG9mIHRoZSBnaXZlbiBsYW5lcywgdGhhdCBsYW5lIGlzIG5vdyB0cmFuc2l0aXZlbHkKICAgIC8vIGVudGFuZ2xlZCB3aXRoICphbGwqIHRoZSBnaXZlbiBsYW5lcy4KICAgIC8vCiAgICAvLyBUcmFuc2xhdGVkOiBJZiBDIGlzIGVudGFuZ2xlZCB3aXRoIEEsIHRoZW4gZW50YW5nbGluZyBBIHdpdGggQiBhbHNvCiAgICAvLyBlbnRhbmdsZXMgQyB3aXRoIEIuCiAgICAvLwogICAgLy8gSWYgdGhpcyBpcyBoYXJkIHRvIGdyYXNwLCBpdCBtaWdodCBoZWxwIHRvIGludGVudGlvbmFsbHkgYnJlYWsgdGhpcwogICAgLy8gZnVuY3Rpb24gYW5kIGxvb2sgYXQgdGhlIHRlc3RzIHRoYXQgZmFpbCBpbiBSZWFjdFRyYW5zaXRpb24tdGVzdC5qcy4gVHJ5CiAgICAvLyBjb21tZW50aW5nIG91dCBvbmUgb2YgdGhlIGNvbmRpdGlvbnMgYmVsb3cuCiAgICB2YXIgcm9vdEVudGFuZ2xlZExhbmVzID0gcm9vdC5lbnRhbmdsZWRMYW5lcyB8PSBlbnRhbmdsZWRMYW5lczsKICAgIHZhciBlbnRhbmdsZW1lbnRzID0gcm9vdC5lbnRhbmdsZW1lbnRzOwogICAgdmFyIGxhbmVzID0gcm9vdEVudGFuZ2xlZExhbmVzOwoKICAgIHdoaWxlIChsYW5lcykgewogICAgICB2YXIgaW5kZXggPSBwaWNrQXJiaXRyYXJ5TGFuZUluZGV4KGxhbmVzKTsKICAgICAgdmFyIGxhbmUgPSAxIDw8IGluZGV4OwoKICAgICAgaWYgKCAvLyBJcyB0aGlzIG9uZSBvZiB0aGUgbmV3bHkgZW50YW5nbGVkIGxhbmVzPwogICAgICBsYW5lICYgZW50YW5nbGVkTGFuZXMgfCAvLyBJcyB0aGlzIGxhbmUgdHJhbnNpdGl2ZWx5IGVudGFuZ2xlZCB3aXRoIHRoZSBuZXdseSBlbnRhbmdsZWQgbGFuZXM/CiAgICAgIGVudGFuZ2xlbWVudHNbaW5kZXhdICYgZW50YW5nbGVkTGFuZXMpIHsKICAgICAgICBlbnRhbmdsZW1lbnRzW2luZGV4XSB8PSBlbnRhbmdsZWRMYW5lczsKICAgICAgfQoKICAgICAgbGFuZXMgJj0gfmxhbmU7CiAgICB9CiAgfQogIGZ1bmN0aW9uIGdldEJ1bXBlZExhbmVGb3JIeWRyYXRpb24ocm9vdCwgcmVuZGVyTGFuZXMpIHsKICAgIHZhciByZW5kZXJMYW5lID0gZ2V0SGlnaGVzdFByaW9yaXR5TGFuZShyZW5kZXJMYW5lcyk7CiAgICB2YXIgbGFuZTsKCiAgICBzd2l0Y2ggKHJlbmRlckxhbmUpIHsKICAgICAgY2FzZSBJbnB1dENvbnRpbnVvdXNMYW5lOgogICAgICAgIGxhbmUgPSBJbnB1dENvbnRpbnVvdXNIeWRyYXRpb25MYW5lOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSBEZWZhdWx0TGFuZToKICAgICAgICBsYW5lID0gRGVmYXVsdEh5ZHJhdGlvbkxhbmU7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIFRyYW5zaXRpb25MYW5lMToKICAgICAgY2FzZSBUcmFuc2l0aW9uTGFuZTI6CiAgICAgIGNhc2UgVHJhbnNpdGlvbkxhbmUzOgogICAgICBjYXNlIFRyYW5zaXRpb25MYW5lNDoKICAgICAgY2FzZSBUcmFuc2l0aW9uTGFuZTU6CiAgICAgIGNhc2UgVHJhbnNpdGlvbkxhbmU2OgogICAgICBjYXNlIFRyYW5zaXRpb25MYW5lNzoKICAgICAgY2FzZSBUcmFuc2l0aW9uTGFuZTg6CiAgICAgIGNhc2UgVHJhbnNpdGlvbkxhbmU5OgogICAgICBjYXNlIFRyYW5zaXRpb25MYW5lMTA6CiAgICAgIGNhc2UgVHJhbnNpdGlvbkxhbmUxMToKICAgICAgY2FzZSBUcmFuc2l0aW9uTGFuZTEyOgogICAgICBjYXNlIFRyYW5zaXRpb25MYW5lMTM6CiAgICAgIGNhc2UgVHJhbnNpdGlvbkxhbmUxNDoKICAgICAgY2FzZSBUcmFuc2l0aW9uTGFuZTE1OgogICAgICBjYXNlIFRyYW5zaXRpb25MYW5lMTY6CiAgICAgIGNhc2UgUmV0cnlMYW5lMToKICAgICAgY2FzZSBSZXRyeUxhbmUyOgogICAgICBjYXNlIFJldHJ5TGFuZTM6CiAgICAgIGNhc2UgUmV0cnlMYW5lNDoKICAgICAgY2FzZSBSZXRyeUxhbmU1OgogICAgICAgIGxhbmUgPSBUcmFuc2l0aW9uSHlkcmF0aW9uTGFuZTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgSWRsZUxhbmU6CiAgICAgICAgbGFuZSA9IElkbGVIeWRyYXRpb25MYW5lOwogICAgICAgIGJyZWFrOwoKICAgICAgZGVmYXVsdDoKICAgICAgICAvLyBFdmVyeXRoaW5nIGVsc2UgaXMgYWxyZWFkeSBlaXRoZXIgYSBoeWRyYXRpb24gbGFuZSwgb3Igc2hvdWxkbid0CiAgICAgICAgLy8gYmUgcmV0cmllZCBhdCBhIGh5ZHJhdGlvbiBsYW5lLgogICAgICAgIGxhbmUgPSBOb0xhbmU7CiAgICAgICAgYnJlYWs7CiAgICB9IC8vIENoZWNrIGlmIHRoZSBsYW5lIHdlIGNob3NlIGlzIHN1c3BlbmRlZC4gSWYgc28sIHRoYXQgaW5kaWNhdGVzIHRoYXQgd2UKICAgIC8vIGFscmVhZHkgYXR0ZW1wdGVkIGFuZCBmYWlsZWQgdG8gaHlkcmF0ZSBhdCB0aGF0IGxldmVsLiBBbHNvIGNoZWNrIGlmIHdlJ3JlCiAgICAvLyBhbHJlYWR5IHJlbmRlcmluZyB0aGF0IGxhbmUsIHdoaWNoIGlzIHJhcmUgYnV0IGNvdWxkIGhhcHBlbi4KCgogICAgaWYgKChsYW5lICYgKHJvb3Quc3VzcGVuZGVkTGFuZXMgfCByZW5kZXJMYW5lcykpICE9PSBOb0xhbmUpIHsKICAgICAgLy8gR2l2ZSB1cCB0cnlpbmcgdG8gaHlkcmF0ZSBhbmQgZmFsbCBiYWNrIHRvIGNsaWVudCByZW5kZXIuCiAgICAgIHJldHVybiBOb0xhbmU7CiAgICB9CgogICAgcmV0dXJuIGxhbmU7CiAgfQogIGZ1bmN0aW9uIGFkZEZpYmVyVG9MYW5lc01hcChyb290LCBmaWJlciwgbGFuZXMpIHsKCiAgICBpZiAoIWlzRGV2VG9vbHNQcmVzZW50KSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB2YXIgcGVuZGluZ1VwZGF0ZXJzTGFuZU1hcCA9IHJvb3QucGVuZGluZ1VwZGF0ZXJzTGFuZU1hcDsKCiAgICB3aGlsZSAobGFuZXMgPiAwKSB7CiAgICAgIHZhciBpbmRleCA9IGxhbmVUb0luZGV4KGxhbmVzKTsKICAgICAgdmFyIGxhbmUgPSAxIDw8IGluZGV4OwogICAgICB2YXIgdXBkYXRlcnMgPSBwZW5kaW5nVXBkYXRlcnNMYW5lTWFwW2luZGV4XTsKICAgICAgdXBkYXRlcnMuYWRkKGZpYmVyKTsKICAgICAgbGFuZXMgJj0gfmxhbmU7CiAgICB9CiAgfQogIGZ1bmN0aW9uIG1vdmVQZW5kaW5nRmliZXJzVG9NZW1vaXplZChyb290LCBsYW5lcykgewoKICAgIGlmICghaXNEZXZUb29sc1ByZXNlbnQpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhciBwZW5kaW5nVXBkYXRlcnNMYW5lTWFwID0gcm9vdC5wZW5kaW5nVXBkYXRlcnNMYW5lTWFwOwogICAgdmFyIG1lbW9pemVkVXBkYXRlcnMgPSByb290Lm1lbW9pemVkVXBkYXRlcnM7CgogICAgd2hpbGUgKGxhbmVzID4gMCkgewogICAgICB2YXIgaW5kZXggPSBsYW5lVG9JbmRleChsYW5lcyk7CiAgICAgIHZhciBsYW5lID0gMSA8PCBpbmRleDsKICAgICAgdmFyIHVwZGF0ZXJzID0gcGVuZGluZ1VwZGF0ZXJzTGFuZU1hcFtpbmRleF07CgogICAgICBpZiAodXBkYXRlcnMuc2l6ZSA+IDApIHsKICAgICAgICB1cGRhdGVycy5mb3JFYWNoKGZ1bmN0aW9uIChmaWJlcikgewogICAgICAgICAgdmFyIGFsdGVybmF0ZSA9IGZpYmVyLmFsdGVybmF0ZTsKCiAgICAgICAgICBpZiAoYWx0ZXJuYXRlID09PSBudWxsIHx8ICFtZW1vaXplZFVwZGF0ZXJzLmhhcyhhbHRlcm5hdGUpKSB7CiAgICAgICAgICAgIG1lbW9pemVkVXBkYXRlcnMuYWRkKGZpYmVyKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICB1cGRhdGVycy5jbGVhcigpOwogICAgICB9CgogICAgICBsYW5lcyAmPSB+bGFuZTsKICAgIH0KICB9CiAgZnVuY3Rpb24gZ2V0VHJhbnNpdGlvbnNGb3JMYW5lcyhyb290LCBsYW5lcykgewogICAgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KICB9CgogIHZhciBEaXNjcmV0ZUV2ZW50UHJpb3JpdHkgPSBTeW5jTGFuZTsKICB2YXIgQ29udGludW91c0V2ZW50UHJpb3JpdHkgPSBJbnB1dENvbnRpbnVvdXNMYW5lOwogIHZhciBEZWZhdWx0RXZlbnRQcmlvcml0eSA9IERlZmF1bHRMYW5lOwogIHZhciBJZGxlRXZlbnRQcmlvcml0eSA9IElkbGVMYW5lOwogIHZhciBjdXJyZW50VXBkYXRlUHJpb3JpdHkgPSBOb0xhbmU7CiAgZnVuY3Rpb24gZ2V0Q3VycmVudFVwZGF0ZVByaW9yaXR5KCkgewogICAgcmV0dXJuIGN1cnJlbnRVcGRhdGVQcmlvcml0eTsKICB9CiAgZnVuY3Rpb24gc2V0Q3VycmVudFVwZGF0ZVByaW9yaXR5KG5ld1ByaW9yaXR5KSB7CiAgICBjdXJyZW50VXBkYXRlUHJpb3JpdHkgPSBuZXdQcmlvcml0eTsKICB9CiAgZnVuY3Rpb24gcnVuV2l0aFByaW9yaXR5KHByaW9yaXR5LCBmbikgewogICAgdmFyIHByZXZpb3VzUHJpb3JpdHkgPSBjdXJyZW50VXBkYXRlUHJpb3JpdHk7CgogICAgdHJ5IHsKICAgICAgY3VycmVudFVwZGF0ZVByaW9yaXR5ID0gcHJpb3JpdHk7CiAgICAgIHJldHVybiBmbigpOwogICAgfSBmaW5hbGx5IHsKICAgICAgY3VycmVudFVwZGF0ZVByaW9yaXR5ID0gcHJldmlvdXNQcmlvcml0eTsKICAgIH0KICB9CiAgZnVuY3Rpb24gaGlnaGVyRXZlbnRQcmlvcml0eShhLCBiKSB7CiAgICByZXR1cm4gYSAhPT0gMCAmJiBhIDwgYiA/IGEgOiBiOwogIH0KICBmdW5jdGlvbiBsb3dlckV2ZW50UHJpb3JpdHkoYSwgYikgewogICAgcmV0dXJuIGEgPT09IDAgfHwgYSA+IGIgPyBhIDogYjsKICB9CiAgZnVuY3Rpb24gaXNIaWdoZXJFdmVudFByaW9yaXR5KGEsIGIpIHsKICAgIHJldHVybiBhICE9PSAwICYmIGEgPCBiOwogIH0KICBmdW5jdGlvbiBsYW5lc1RvRXZlbnRQcmlvcml0eShsYW5lcykgewogICAgdmFyIGxhbmUgPSBnZXRIaWdoZXN0UHJpb3JpdHlMYW5lKGxhbmVzKTsKCiAgICBpZiAoIWlzSGlnaGVyRXZlbnRQcmlvcml0eShEaXNjcmV0ZUV2ZW50UHJpb3JpdHksIGxhbmUpKSB7CiAgICAgIHJldHVybiBEaXNjcmV0ZUV2ZW50UHJpb3JpdHk7CiAgICB9CgogICAgaWYgKCFpc0hpZ2hlckV2ZW50UHJpb3JpdHkoQ29udGludW91c0V2ZW50UHJpb3JpdHksIGxhbmUpKSB7CiAgICAgIHJldHVybiBDb250aW51b3VzRXZlbnRQcmlvcml0eTsKICAgIH0KCiAgICBpZiAoaW5jbHVkZXNOb25JZGxlV29yayhsYW5lKSkgewogICAgICByZXR1cm4gRGVmYXVsdEV2ZW50UHJpb3JpdHk7CiAgICB9CgogICAgcmV0dXJuIElkbGVFdmVudFByaW9yaXR5OwogIH0KCiAgLy8gVGhpcyBpcyBpbXBvcnRlZCBieSB0aGUgZXZlbnQgcmVwbGF5aW5nIGltcGxlbWVudGF0aW9uIGluIFJlYWN0IERPTS4gSXQncwogIC8vIGluIGEgc2VwYXJhdGUgZmlsZSB0byBicmVhayBhIGNpcmN1bGFyIGRlcGVuZGVuY3kgYmV0d2VlbiB0aGUgcmVuZGVyZXIgYW5kCiAgLy8gdGhlIHJlY29uY2lsZXIuCiAgZnVuY3Rpb24gaXNSb290RGVoeWRyYXRlZChyb290KSB7CiAgICB2YXIgY3VycmVudFN0YXRlID0gcm9vdC5jdXJyZW50Lm1lbW9pemVkU3RhdGU7CiAgICByZXR1cm4gY3VycmVudFN0YXRlLmlzRGVoeWRyYXRlZDsKICB9CgogIHZhciBfYXR0ZW1wdFN5bmNocm9ub3VzSHlkcmF0aW9uOwoKICBmdW5jdGlvbiBzZXRBdHRlbXB0U3luY2hyb25vdXNIeWRyYXRpb24oZm4pIHsKICAgIF9hdHRlbXB0U3luY2hyb25vdXNIeWRyYXRpb24gPSBmbjsKICB9CiAgZnVuY3Rpb24gYXR0ZW1wdFN5bmNocm9ub3VzSHlkcmF0aW9uKGZpYmVyKSB7CiAgICBfYXR0ZW1wdFN5bmNocm9ub3VzSHlkcmF0aW9uKGZpYmVyKTsKICB9CiAgdmFyIGF0dGVtcHRDb250aW51b3VzSHlkcmF0aW9uOwogIGZ1bmN0aW9uIHNldEF0dGVtcHRDb250aW51b3VzSHlkcmF0aW9uKGZuKSB7CiAgICBhdHRlbXB0Q29udGludW91c0h5ZHJhdGlvbiA9IGZuOwogIH0KICB2YXIgYXR0ZW1wdEh5ZHJhdGlvbkF0Q3VycmVudFByaW9yaXR5OwogIGZ1bmN0aW9uIHNldEF0dGVtcHRIeWRyYXRpb25BdEN1cnJlbnRQcmlvcml0eShmbikgewogICAgYXR0ZW1wdEh5ZHJhdGlvbkF0Q3VycmVudFByaW9yaXR5ID0gZm47CiAgfQogIHZhciBnZXRDdXJyZW50VXBkYXRlUHJpb3JpdHkkMTsKICBmdW5jdGlvbiBzZXRHZXRDdXJyZW50VXBkYXRlUHJpb3JpdHkoZm4pIHsKICAgIGdldEN1cnJlbnRVcGRhdGVQcmlvcml0eSQxID0gZm47CiAgfQogIHZhciBhdHRlbXB0SHlkcmF0aW9uQXRQcmlvcml0eTsKICBmdW5jdGlvbiBzZXRBdHRlbXB0SHlkcmF0aW9uQXRQcmlvcml0eShmbikgewogICAgYXR0ZW1wdEh5ZHJhdGlvbkF0UHJpb3JpdHkgPSBmbjsKICB9IC8vIFRPRE86IFVwZ3JhZGUgdGhpcyBkZWZpbml0aW9uIG9uY2Ugd2UncmUgb24gYSBuZXdlciB2ZXJzaW9uIG9mIEZsb3cgdGhhdAogIC8vIGhhcyB0aGlzIGRlZmluaXRpb24gYnVpbHQtaW4uCgogIHZhciBoYXNTY2hlZHVsZWRSZXBsYXlBdHRlbXB0ID0gZmFsc2U7IC8vIFRoZSBxdWV1ZSBvZiBkaXNjcmV0ZSBldmVudHMgdG8gYmUgcmVwbGF5ZWQuCgogIHZhciBxdWV1ZWREaXNjcmV0ZUV2ZW50cyA9IFtdOyAvLyBJbmRpY2F0ZXMgaWYgYW55IGNvbnRpbnVvdXMgZXZlbnQgdGFyZ2V0cyBhcmUgbm9uLW51bGwgZm9yIGVhcmx5IGJhaWxvdXQuCiAgLy8gaWYgdGhlIGxhc3QgdGFyZ2V0IHdhcyBkZWh5ZHJhdGVkLgoKICB2YXIgcXVldWVkRm9jdXMgPSBudWxsOwogIHZhciBxdWV1ZWREcmFnID0gbnVsbDsKICB2YXIgcXVldWVkTW91c2UgPSBudWxsOyAvLyBGb3IgcG9pbnRlciBldmVudHMgdGhlcmUgY2FuIGJlIG9uZSBsYXRlc3QgZXZlbnQgcGVyIHBvaW50ZXJJZC4KCiAgdmFyIHF1ZXVlZFBvaW50ZXJzID0gbmV3IE1hcCgpOwogIHZhciBxdWV1ZWRQb2ludGVyQ2FwdHVyZXMgPSBuZXcgTWFwKCk7IC8vIFdlIGNvdWxkIGNvbnNpZGVyIHJlcGxheWluZyBzZWxlY3Rpb25jaGFuZ2UgYW5kIHRvdWNobW92ZXMgdG9vLgoKICB2YXIgcXVldWVkRXhwbGljaXRIeWRyYXRpb25UYXJnZXRzID0gW107CiAgdmFyIGRpc2NyZXRlUmVwbGF5YWJsZUV2ZW50cyA9IFsnbW91c2Vkb3duJywgJ21vdXNldXAnLCAndG91Y2hjYW5jZWwnLCAndG91Y2hlbmQnLCAndG91Y2hzdGFydCcsICdhdXhjbGljaycsICdkYmxjbGljaycsICdwb2ludGVyY2FuY2VsJywgJ3BvaW50ZXJkb3duJywgJ3BvaW50ZXJ1cCcsICdkcmFnZW5kJywgJ2RyYWdzdGFydCcsICdkcm9wJywgJ2NvbXBvc2l0aW9uZW5kJywgJ2NvbXBvc2l0aW9uc3RhcnQnLCAna2V5ZG93bicsICdrZXlwcmVzcycsICdrZXl1cCcsICdpbnB1dCcsICd0ZXh0SW5wdXQnLCAvLyBJbnRlbnRpb25hbGx5IGNhbWVsQ2FzZQogICdjb3B5JywgJ2N1dCcsICdwYXN0ZScsICdjbGljaycsICdjaGFuZ2UnLCAnY29udGV4dG1lbnUnLCAncmVzZXQnLCAnc3VibWl0J107CiAgZnVuY3Rpb24gaXNEaXNjcmV0ZUV2ZW50VGhhdFJlcXVpcmVzSHlkcmF0aW9uKGV2ZW50VHlwZSkgewogICAgcmV0dXJuIGRpc2NyZXRlUmVwbGF5YWJsZUV2ZW50cy5pbmRleE9mKGV2ZW50VHlwZSkgPiAtMTsKICB9CgogIGZ1bmN0aW9uIGNyZWF0ZVF1ZXVlZFJlcGxheWFibGVFdmVudChibG9ja2VkT24sIGRvbUV2ZW50TmFtZSwgZXZlbnRTeXN0ZW1GbGFncywgdGFyZ2V0Q29udGFpbmVyLCBuYXRpdmVFdmVudCkgewogICAgcmV0dXJuIHsKICAgICAgYmxvY2tlZE9uOiBibG9ja2VkT24sCiAgICAgIGRvbUV2ZW50TmFtZTogZG9tRXZlbnROYW1lLAogICAgICBldmVudFN5c3RlbUZsYWdzOiBldmVudFN5c3RlbUZsYWdzLAogICAgICBuYXRpdmVFdmVudDogbmF0aXZlRXZlbnQsCiAgICAgIHRhcmdldENvbnRhaW5lcnM6IFt0YXJnZXRDb250YWluZXJdCiAgICB9OwogIH0KCiAgZnVuY3Rpb24gY2xlYXJJZkNvbnRpbnVvdXNFdmVudChkb21FdmVudE5hbWUsIG5hdGl2ZUV2ZW50KSB7CiAgICBzd2l0Y2ggKGRvbUV2ZW50TmFtZSkgewogICAgICBjYXNlICdmb2N1c2luJzoKICAgICAgY2FzZSAnZm9jdXNvdXQnOgogICAgICAgIHF1ZXVlZEZvY3VzID0gbnVsbDsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ2RyYWdlbnRlcic6CiAgICAgIGNhc2UgJ2RyYWdsZWF2ZSc6CiAgICAgICAgcXVldWVkRHJhZyA9IG51bGw7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICdtb3VzZW92ZXInOgogICAgICBjYXNlICdtb3VzZW91dCc6CiAgICAgICAgcXVldWVkTW91c2UgPSBudWxsOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAncG9pbnRlcm92ZXInOgogICAgICBjYXNlICdwb2ludGVyb3V0JzoKICAgICAgICB7CiAgICAgICAgICB2YXIgcG9pbnRlcklkID0gbmF0aXZlRXZlbnQucG9pbnRlcklkOwogICAgICAgICAgcXVldWVkUG9pbnRlcnMuZGVsZXRlKHBvaW50ZXJJZCk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICBjYXNlICdnb3Rwb2ludGVyY2FwdHVyZSc6CiAgICAgIGNhc2UgJ2xvc3Rwb2ludGVyY2FwdHVyZSc6CiAgICAgICAgewogICAgICAgICAgdmFyIF9wb2ludGVySWQgPSBuYXRpdmVFdmVudC5wb2ludGVySWQ7CiAgICAgICAgICBxdWV1ZWRQb2ludGVyQ2FwdHVyZXMuZGVsZXRlKF9wb2ludGVySWQpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gYWNjdW11bGF0ZU9yQ3JlYXRlQ29udGludW91c1F1ZXVlZFJlcGxheWFibGVFdmVudChleGlzdGluZ1F1ZXVlZEV2ZW50LCBibG9ja2VkT24sIGRvbUV2ZW50TmFtZSwgZXZlbnRTeXN0ZW1GbGFncywgdGFyZ2V0Q29udGFpbmVyLCBuYXRpdmVFdmVudCkgewogICAgaWYgKGV4aXN0aW5nUXVldWVkRXZlbnQgPT09IG51bGwgfHwgZXhpc3RpbmdRdWV1ZWRFdmVudC5uYXRpdmVFdmVudCAhPT0gbmF0aXZlRXZlbnQpIHsKICAgICAgdmFyIHF1ZXVlZEV2ZW50ID0gY3JlYXRlUXVldWVkUmVwbGF5YWJsZUV2ZW50KGJsb2NrZWRPbiwgZG9tRXZlbnROYW1lLCBldmVudFN5c3RlbUZsYWdzLCB0YXJnZXRDb250YWluZXIsIG5hdGl2ZUV2ZW50KTsKCiAgICAgIGlmIChibG9ja2VkT24gIT09IG51bGwpIHsKICAgICAgICB2YXIgX2ZpYmVyMiA9IGdldEluc3RhbmNlRnJvbU5vZGUoYmxvY2tlZE9uKTsKCiAgICAgICAgaWYgKF9maWJlcjIgIT09IG51bGwpIHsKICAgICAgICAgIC8vIEF0dGVtcHQgdG8gaW5jcmVhc2UgdGhlIHByaW9yaXR5IG9mIHRoaXMgdGFyZ2V0LgogICAgICAgICAgYXR0ZW1wdENvbnRpbnVvdXNIeWRyYXRpb24oX2ZpYmVyMik7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gcXVldWVkRXZlbnQ7CiAgICB9IC8vIElmIHdlIGhhdmUgYWxyZWFkeSBxdWV1ZWQgdGhpcyBleGFjdCBldmVudCwgdGhlbiBpdCdzIGJlY2F1c2UKICAgIC8vIHRoZSBkaWZmZXJlbnQgZXZlbnQgc3lzdGVtcyBoYXZlIGRpZmZlcmVudCBET00gZXZlbnQgbGlzdGVuZXJzLgogICAgLy8gV2UgY2FuIGFjY3VtdWxhdGUgdGhlIGZsYWdzLCBhbmQgdGhlIHRhcmdldENvbnRhaW5lcnMsIGFuZAogICAgLy8gc3RvcmUgYSBzaW5nbGUgZXZlbnQgdG8gYmUgcmVwbGF5ZWQuCgoKICAgIGV4aXN0aW5nUXVldWVkRXZlbnQuZXZlbnRTeXN0ZW1GbGFncyB8PSBldmVudFN5c3RlbUZsYWdzOwogICAgdmFyIHRhcmdldENvbnRhaW5lcnMgPSBleGlzdGluZ1F1ZXVlZEV2ZW50LnRhcmdldENvbnRhaW5lcnM7CgogICAgaWYgKHRhcmdldENvbnRhaW5lciAhPT0gbnVsbCAmJiB0YXJnZXRDb250YWluZXJzLmluZGV4T2YodGFyZ2V0Q29udGFpbmVyKSA9PT0gLTEpIHsKICAgICAgdGFyZ2V0Q29udGFpbmVycy5wdXNoKHRhcmdldENvbnRhaW5lcik7CiAgICB9CgogICAgcmV0dXJuIGV4aXN0aW5nUXVldWVkRXZlbnQ7CiAgfQoKICBmdW5jdGlvbiBxdWV1ZUlmQ29udGludW91c0V2ZW50KGJsb2NrZWRPbiwgZG9tRXZlbnROYW1lLCBldmVudFN5c3RlbUZsYWdzLCB0YXJnZXRDb250YWluZXIsIG5hdGl2ZUV2ZW50KSB7CiAgICAvLyBUaGVzZSBzZXQgcmVsYXRlZFRhcmdldCB0byBudWxsIGJlY2F1c2UgdGhlIHJlcGxheWVkIGV2ZW50IHdpbGwgYmUgdHJlYXRlZCBhcyBpZiB3ZQogICAgLy8gbW92ZWQgZnJvbSBvdXRzaWRlIHRoZSB3aW5kb3cgKG5vIHRhcmdldCkgb250byB0aGUgdGFyZ2V0IG9uY2UgaXQgaHlkcmF0ZXMuCiAgICAvLyBJbnN0ZWFkIG9mIG11dGF0aW5nIHdlIGNvdWxkIGNsb25lIHRoZSBldmVudC4KICAgIHN3aXRjaCAoZG9tRXZlbnROYW1lKSB7CiAgICAgIGNhc2UgJ2ZvY3VzaW4nOgogICAgICAgIHsKICAgICAgICAgIHZhciBmb2N1c0V2ZW50ID0gbmF0aXZlRXZlbnQ7CiAgICAgICAgICBxdWV1ZWRGb2N1cyA9IGFjY3VtdWxhdGVPckNyZWF0ZUNvbnRpbnVvdXNRdWV1ZWRSZXBsYXlhYmxlRXZlbnQocXVldWVkRm9jdXMsIGJsb2NrZWRPbiwgZG9tRXZlbnROYW1lLCBldmVudFN5c3RlbUZsYWdzLCB0YXJnZXRDb250YWluZXIsIGZvY3VzRXZlbnQpOwogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAgY2FzZSAnZHJhZ2VudGVyJzoKICAgICAgICB7CiAgICAgICAgICB2YXIgZHJhZ0V2ZW50ID0gbmF0aXZlRXZlbnQ7CiAgICAgICAgICBxdWV1ZWREcmFnID0gYWNjdW11bGF0ZU9yQ3JlYXRlQ29udGludW91c1F1ZXVlZFJlcGxheWFibGVFdmVudChxdWV1ZWREcmFnLCBibG9ja2VkT24sIGRvbUV2ZW50TmFtZSwgZXZlbnRTeXN0ZW1GbGFncywgdGFyZ2V0Q29udGFpbmVyLCBkcmFnRXZlbnQpOwogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAgY2FzZSAnbW91c2VvdmVyJzoKICAgICAgICB7CiAgICAgICAgICB2YXIgbW91c2VFdmVudCA9IG5hdGl2ZUV2ZW50OwogICAgICAgICAgcXVldWVkTW91c2UgPSBhY2N1bXVsYXRlT3JDcmVhdGVDb250aW51b3VzUXVldWVkUmVwbGF5YWJsZUV2ZW50KHF1ZXVlZE1vdXNlLCBibG9ja2VkT24sIGRvbUV2ZW50TmFtZSwgZXZlbnRTeXN0ZW1GbGFncywgdGFyZ2V0Q29udGFpbmVyLCBtb3VzZUV2ZW50KTsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCiAgICAgIGNhc2UgJ3BvaW50ZXJvdmVyJzoKICAgICAgICB7CiAgICAgICAgICB2YXIgcG9pbnRlckV2ZW50ID0gbmF0aXZlRXZlbnQ7CiAgICAgICAgICB2YXIgcG9pbnRlcklkID0gcG9pbnRlckV2ZW50LnBvaW50ZXJJZDsKICAgICAgICAgIHF1ZXVlZFBvaW50ZXJzLnNldChwb2ludGVySWQsIGFjY3VtdWxhdGVPckNyZWF0ZUNvbnRpbnVvdXNRdWV1ZWRSZXBsYXlhYmxlRXZlbnQocXVldWVkUG9pbnRlcnMuZ2V0KHBvaW50ZXJJZCkgfHwgbnVsbCwgYmxvY2tlZE9uLCBkb21FdmVudE5hbWUsIGV2ZW50U3lzdGVtRmxhZ3MsIHRhcmdldENvbnRhaW5lciwgcG9pbnRlckV2ZW50KSk7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CgogICAgICBjYXNlICdnb3Rwb2ludGVyY2FwdHVyZSc6CiAgICAgICAgewogICAgICAgICAgdmFyIF9wb2ludGVyRXZlbnQgPSBuYXRpdmVFdmVudDsKICAgICAgICAgIHZhciBfcG9pbnRlcklkMiA9IF9wb2ludGVyRXZlbnQucG9pbnRlcklkOwogICAgICAgICAgcXVldWVkUG9pbnRlckNhcHR1cmVzLnNldChfcG9pbnRlcklkMiwgYWNjdW11bGF0ZU9yQ3JlYXRlQ29udGludW91c1F1ZXVlZFJlcGxheWFibGVFdmVudChxdWV1ZWRQb2ludGVyQ2FwdHVyZXMuZ2V0KF9wb2ludGVySWQyKSB8fCBudWxsLCBibG9ja2VkT24sIGRvbUV2ZW50TmFtZSwgZXZlbnRTeXN0ZW1GbGFncywgdGFyZ2V0Q29udGFpbmVyLCBfcG9pbnRlckV2ZW50KSk7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICB9CgogICAgcmV0dXJuIGZhbHNlOwogIH0gLy8gQ2hlY2sgaWYgdGhpcyB0YXJnZXQgaXMgdW5ibG9ja2VkLiBSZXR1cm5zIHRydWUgaWYgaXQncyB1bmJsb2NrZWQuCgogIGZ1bmN0aW9uIGF0dGVtcHRFeHBsaWNpdEh5ZHJhdGlvblRhcmdldChxdWV1ZWRUYXJnZXQpIHsKICAgIC8vIFRPRE86IFRoaXMgZnVuY3Rpb24gc2hhcmVzIGEgbG90IG9mIGxvZ2ljIHdpdGggZmluZEluc3RhbmNlQmxvY2tpbmdFdmVudC4KICAgIC8vIFRyeSB0byB1bmlmeSB0aGVtLiBJdCdzIGEgYml0IHRyaWNreSBzaW5jZSBpdCB3b3VsZCByZXF1aXJlIHR3byByZXR1cm4KICAgIC8vIHZhbHVlcy4KICAgIHZhciB0YXJnZXRJbnN0ID0gZ2V0Q2xvc2VzdEluc3RhbmNlRnJvbU5vZGUocXVldWVkVGFyZ2V0LnRhcmdldCk7CgogICAgaWYgKHRhcmdldEluc3QgIT09IG51bGwpIHsKICAgICAgdmFyIG5lYXJlc3RNb3VudGVkID0gZ2V0TmVhcmVzdE1vdW50ZWRGaWJlcih0YXJnZXRJbnN0KTsKCiAgICAgIGlmIChuZWFyZXN0TW91bnRlZCAhPT0gbnVsbCkgewogICAgICAgIHZhciB0YWcgPSBuZWFyZXN0TW91bnRlZC50YWc7CgogICAgICAgIGlmICh0YWcgPT09IFN1c3BlbnNlQ29tcG9uZW50KSB7CiAgICAgICAgICB2YXIgaW5zdGFuY2UgPSBnZXRTdXNwZW5zZUluc3RhbmNlRnJvbUZpYmVyKG5lYXJlc3RNb3VudGVkKTsKCiAgICAgICAgICBpZiAoaW5zdGFuY2UgIT09IG51bGwpIHsKICAgICAgICAgICAgLy8gV2UncmUgYmxvY2tlZCBvbiBoeWRyYXRpbmcgdGhpcyBib3VuZGFyeS4KICAgICAgICAgICAgLy8gSW5jcmVhc2UgaXRzIHByaW9yaXR5LgogICAgICAgICAgICBxdWV1ZWRUYXJnZXQuYmxvY2tlZE9uID0gaW5zdGFuY2U7CiAgICAgICAgICAgIGF0dGVtcHRIeWRyYXRpb25BdFByaW9yaXR5KHF1ZXVlZFRhcmdldC5wcmlvcml0eSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIGF0dGVtcHRIeWRyYXRpb25BdEN1cnJlbnRQcmlvcml0eShuZWFyZXN0TW91bnRlZCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmICh0YWcgPT09IEhvc3RSb290KSB7CiAgICAgICAgICB2YXIgcm9vdCA9IG5lYXJlc3RNb3VudGVkLnN0YXRlTm9kZTsKCiAgICAgICAgICBpZiAoaXNSb290RGVoeWRyYXRlZChyb290KSkgewogICAgICAgICAgICBxdWV1ZWRUYXJnZXQuYmxvY2tlZE9uID0gZ2V0Q29udGFpbmVyRnJvbUZpYmVyKG5lYXJlc3RNb3VudGVkKTsgLy8gV2UgZG9uJ3QgY3VycmVudGx5IGhhdmUgYSB3YXkgdG8gaW5jcmVhc2UgdGhlIHByaW9yaXR5IG9mCiAgICAgICAgICAgIC8vIGEgcm9vdCBvdGhlciB0aGFuIHN5bmMuCgogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgcXVldWVkVGFyZ2V0LmJsb2NrZWRPbiA9IG51bGw7CiAgfQoKICBmdW5jdGlvbiBxdWV1ZUV4cGxpY2l0SHlkcmF0aW9uVGFyZ2V0KHRhcmdldCkgewogICAgLy8gVE9ETzogVGhpcyB3aWxsIHJlYWQgdGhlIHByaW9yaXR5IGlmIGl0J3MgZGlzcGF0Y2hlZCBieSB0aGUgUmVhY3QKICAgIC8vIGV2ZW50IHN5c3RlbSBidXQgbm90IG5hdGl2ZSBldmVudHMuIFNob3VsZCByZWFkIHdpbmRvdy5ldmVudC50eXBlLCBsaWtlCiAgICAvLyB3ZSBkbyBmb3IgdXBkYXRlcyAoZ2V0Q3VycmVudEV2ZW50UHJpb3JpdHkpLgogICAgdmFyIHVwZGF0ZVByaW9yaXR5ID0gZ2V0Q3VycmVudFVwZGF0ZVByaW9yaXR5JDEoKTsKICAgIHZhciBxdWV1ZWRUYXJnZXQgPSB7CiAgICAgIGJsb2NrZWRPbjogbnVsbCwKICAgICAgdGFyZ2V0OiB0YXJnZXQsCiAgICAgIHByaW9yaXR5OiB1cGRhdGVQcmlvcml0eQogICAgfTsKICAgIHZhciBpID0gMDsKCiAgICBmb3IgKDsgaSA8IHF1ZXVlZEV4cGxpY2l0SHlkcmF0aW9uVGFyZ2V0cy5sZW5ndGg7IGkrKykgewogICAgICAvLyBTdG9wIG9uY2Ugd2UgaGl0IHRoZSBmaXJzdCB0YXJnZXQgd2l0aCBsb3dlciBwcmlvcml0eSB0aGFuCiAgICAgIGlmICghaXNIaWdoZXJFdmVudFByaW9yaXR5KHVwZGF0ZVByaW9yaXR5LCBxdWV1ZWRFeHBsaWNpdEh5ZHJhdGlvblRhcmdldHNbaV0ucHJpb3JpdHkpKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICBxdWV1ZWRFeHBsaWNpdEh5ZHJhdGlvblRhcmdldHMuc3BsaWNlKGksIDAsIHF1ZXVlZFRhcmdldCk7CgogICAgaWYgKGkgPT09IDApIHsKICAgICAgYXR0ZW1wdEV4cGxpY2l0SHlkcmF0aW9uVGFyZ2V0KHF1ZXVlZFRhcmdldCk7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBhdHRlbXB0UmVwbGF5Q29udGludW91c1F1ZXVlZEV2ZW50KHF1ZXVlZEV2ZW50KSB7CiAgICBpZiAocXVldWVkRXZlbnQuYmxvY2tlZE9uICE9PSBudWxsKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICB2YXIgdGFyZ2V0Q29udGFpbmVycyA9IHF1ZXVlZEV2ZW50LnRhcmdldENvbnRhaW5lcnM7CgogICAgd2hpbGUgKHRhcmdldENvbnRhaW5lcnMubGVuZ3RoID4gMCkgewogICAgICB2YXIgdGFyZ2V0Q29udGFpbmVyID0gdGFyZ2V0Q29udGFpbmVyc1swXTsKICAgICAgdmFyIG5leHRCbG9ja2VkT24gPSBmaW5kSW5zdGFuY2VCbG9ja2luZ0V2ZW50KHF1ZXVlZEV2ZW50LmRvbUV2ZW50TmFtZSwgcXVldWVkRXZlbnQuZXZlbnRTeXN0ZW1GbGFncywgdGFyZ2V0Q29udGFpbmVyLCBxdWV1ZWRFdmVudC5uYXRpdmVFdmVudCk7CgogICAgICBpZiAobmV4dEJsb2NrZWRPbiA9PT0gbnVsbCkgewogICAgICAgIHsKICAgICAgICAgIHZhciBuYXRpdmVFdmVudCA9IHF1ZXVlZEV2ZW50Lm5hdGl2ZUV2ZW50OwogICAgICAgICAgdmFyIG5hdGl2ZUV2ZW50Q2xvbmUgPSBuZXcgbmF0aXZlRXZlbnQuY29uc3RydWN0b3IobmF0aXZlRXZlbnQudHlwZSwgbmF0aXZlRXZlbnQpOwogICAgICAgICAgc2V0UmVwbGF5aW5nRXZlbnQobmF0aXZlRXZlbnRDbG9uZSk7CiAgICAgICAgICBuYXRpdmVFdmVudC50YXJnZXQuZGlzcGF0Y2hFdmVudChuYXRpdmVFdmVudENsb25lKTsKICAgICAgICAgIHJlc2V0UmVwbGF5aW5nRXZlbnQoKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gV2UncmUgc3RpbGwgYmxvY2tlZC4gVHJ5IGFnYWluIGxhdGVyLgogICAgICAgIHZhciBfZmliZXIzID0gZ2V0SW5zdGFuY2VGcm9tTm9kZShuZXh0QmxvY2tlZE9uKTsKCiAgICAgICAgaWYgKF9maWJlcjMgIT09IG51bGwpIHsKICAgICAgICAgIGF0dGVtcHRDb250aW51b3VzSHlkcmF0aW9uKF9maWJlcjMpOwogICAgICAgIH0KCiAgICAgICAgcXVldWVkRXZlbnQuYmxvY2tlZE9uID0gbmV4dEJsb2NrZWRPbjsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0gLy8gVGhpcyB0YXJnZXQgY29udGFpbmVyIHdhcyBzdWNjZXNzZnVsbHkgZGlzcGF0Y2hlZC4gVHJ5IHRoZSBuZXh0LgoKCiAgICAgIHRhcmdldENvbnRhaW5lcnMuc2hpZnQoKTsKICAgIH0KCiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGZ1bmN0aW9uIGF0dGVtcHRSZXBsYXlDb250aW51b3VzUXVldWVkRXZlbnRJbk1hcChxdWV1ZWRFdmVudCwga2V5LCBtYXApIHsKICAgIGlmIChhdHRlbXB0UmVwbGF5Q29udGludW91c1F1ZXVlZEV2ZW50KHF1ZXVlZEV2ZW50KSkgewogICAgICBtYXAuZGVsZXRlKGtleSk7CiAgICB9CiAgfQoKICBmdW5jdGlvbiByZXBsYXlVbmJsb2NrZWRFdmVudHMoKSB7CiAgICBoYXNTY2hlZHVsZWRSZXBsYXlBdHRlbXB0ID0gZmFsc2U7CgoKICAgIGlmIChxdWV1ZWRGb2N1cyAhPT0gbnVsbCAmJiBhdHRlbXB0UmVwbGF5Q29udGludW91c1F1ZXVlZEV2ZW50KHF1ZXVlZEZvY3VzKSkgewogICAgICBxdWV1ZWRGb2N1cyA9IG51bGw7CiAgICB9CgogICAgaWYgKHF1ZXVlZERyYWcgIT09IG51bGwgJiYgYXR0ZW1wdFJlcGxheUNvbnRpbnVvdXNRdWV1ZWRFdmVudChxdWV1ZWREcmFnKSkgewogICAgICBxdWV1ZWREcmFnID0gbnVsbDsKICAgIH0KCiAgICBpZiAocXVldWVkTW91c2UgIT09IG51bGwgJiYgYXR0ZW1wdFJlcGxheUNvbnRpbnVvdXNRdWV1ZWRFdmVudChxdWV1ZWRNb3VzZSkpIHsKICAgICAgcXVldWVkTW91c2UgPSBudWxsOwogICAgfQoKICAgIHF1ZXVlZFBvaW50ZXJzLmZvckVhY2goYXR0ZW1wdFJlcGxheUNvbnRpbnVvdXNRdWV1ZWRFdmVudEluTWFwKTsKICAgIHF1ZXVlZFBvaW50ZXJDYXB0dXJlcy5mb3JFYWNoKGF0dGVtcHRSZXBsYXlDb250aW51b3VzUXVldWVkRXZlbnRJbk1hcCk7CiAgfQoKICBmdW5jdGlvbiBzY2hlZHVsZUNhbGxiYWNrSWZVbmJsb2NrZWQocXVldWVkRXZlbnQsIHVuYmxvY2tlZCkgewogICAgaWYgKHF1ZXVlZEV2ZW50LmJsb2NrZWRPbiA9PT0gdW5ibG9ja2VkKSB7CiAgICAgIHF1ZXVlZEV2ZW50LmJsb2NrZWRPbiA9IG51bGw7CgogICAgICBpZiAoIWhhc1NjaGVkdWxlZFJlcGxheUF0dGVtcHQpIHsKICAgICAgICBoYXNTY2hlZHVsZWRSZXBsYXlBdHRlbXB0ID0gdHJ1ZTsgLy8gU2NoZWR1bGUgYSBjYWxsYmFjayB0byBhdHRlbXB0IHJlcGxheWluZyBhcyBtYW55IGV2ZW50cyBhcyBhcmUKICAgICAgICAvLyBub3cgdW5ibG9ja2VkLiBUaGlzIGZpcnN0IG1pZ2h0IG5vdCBhY3R1YWxseSBiZSB1bmJsb2NrZWQgeWV0LgogICAgICAgIC8vIFdlIGNvdWxkIGNoZWNrIGl0IGVhcmx5IHRvIGF2b2lkIHNjaGVkdWxpbmcgYW4gdW5uZWNlc3NhcnkgY2FsbGJhY2suCgogICAgICAgIHVuc3RhYmxlX3NjaGVkdWxlQ2FsbGJhY2sodW5zdGFibGVfTm9ybWFsUHJpb3JpdHksIHJlcGxheVVuYmxvY2tlZEV2ZW50cyk7CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIHJldHJ5SWZCbG9ja2VkT24odW5ibG9ja2VkKSB7CiAgICAvLyBNYXJrIGFueXRoaW5nIHRoYXQgd2FzIGJsb2NrZWQgb24gdGhpcyBhcyBubyBsb25nZXIgYmxvY2tlZAogICAgLy8gYW5kIGVsaWdpYmxlIGZvciBhIHJlcGxheS4KICAgIGlmIChxdWV1ZWREaXNjcmV0ZUV2ZW50cy5sZW5ndGggPiAwKSB7CiAgICAgIHNjaGVkdWxlQ2FsbGJhY2tJZlVuYmxvY2tlZChxdWV1ZWREaXNjcmV0ZUV2ZW50c1swXSwgdW5ibG9ja2VkKTsgLy8gVGhpcyBpcyBhIGV4cG9uZW50aWFsIHNlYXJjaCBmb3IgZWFjaCBib3VuZGFyeSB0aGF0IGNvbW1pdHMuIEkgdGhpbmsgaXQncwogICAgICAvLyB3b3J0aCBpdCBiZWNhdXNlIHdlIGV4cGVjdCB2ZXJ5IGZldyBkaXNjcmV0ZSBldmVudHMgdG8gcXVldWUgdXAgYW5kIG9uY2UKICAgICAgLy8gd2UgYXJlIGFjdHVhbGx5IGZ1bGx5IHVuYmxvY2tlZCBpdCB3aWxsIGJlIGZhc3QgdG8gcmVwbGF5IHRoZW0uCgogICAgICBmb3IgKHZhciBpID0gMTsgaSA8IHF1ZXVlZERpc2NyZXRlRXZlbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdmFyIHF1ZXVlZEV2ZW50ID0gcXVldWVkRGlzY3JldGVFdmVudHNbaV07CgogICAgICAgIGlmIChxdWV1ZWRFdmVudC5ibG9ja2VkT24gPT09IHVuYmxvY2tlZCkgewogICAgICAgICAgcXVldWVkRXZlbnQuYmxvY2tlZE9uID0gbnVsbDsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBpZiAocXVldWVkRm9jdXMgIT09IG51bGwpIHsKICAgICAgc2NoZWR1bGVDYWxsYmFja0lmVW5ibG9ja2VkKHF1ZXVlZEZvY3VzLCB1bmJsb2NrZWQpOwogICAgfQoKICAgIGlmIChxdWV1ZWREcmFnICE9PSBudWxsKSB7CiAgICAgIHNjaGVkdWxlQ2FsbGJhY2tJZlVuYmxvY2tlZChxdWV1ZWREcmFnLCB1bmJsb2NrZWQpOwogICAgfQoKICAgIGlmIChxdWV1ZWRNb3VzZSAhPT0gbnVsbCkgewogICAgICBzY2hlZHVsZUNhbGxiYWNrSWZVbmJsb2NrZWQocXVldWVkTW91c2UsIHVuYmxvY2tlZCk7CiAgICB9CgogICAgdmFyIHVuYmxvY2sgPSBmdW5jdGlvbiAocXVldWVkRXZlbnQpIHsKICAgICAgcmV0dXJuIHNjaGVkdWxlQ2FsbGJhY2tJZlVuYmxvY2tlZChxdWV1ZWRFdmVudCwgdW5ibG9ja2VkKTsKICAgIH07CgogICAgcXVldWVkUG9pbnRlcnMuZm9yRWFjaCh1bmJsb2NrKTsKICAgIHF1ZXVlZFBvaW50ZXJDYXB0dXJlcy5mb3JFYWNoKHVuYmxvY2spOwoKICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBxdWV1ZWRFeHBsaWNpdEh5ZHJhdGlvblRhcmdldHMubGVuZ3RoOyBfaSsrKSB7CiAgICAgIHZhciBxdWV1ZWRUYXJnZXQgPSBxdWV1ZWRFeHBsaWNpdEh5ZHJhdGlvblRhcmdldHNbX2ldOwoKICAgICAgaWYgKHF1ZXVlZFRhcmdldC5ibG9ja2VkT24gPT09IHVuYmxvY2tlZCkgewogICAgICAgIHF1ZXVlZFRhcmdldC5ibG9ja2VkT24gPSBudWxsOwogICAgICB9CiAgICB9CgogICAgd2hpbGUgKHF1ZXVlZEV4cGxpY2l0SHlkcmF0aW9uVGFyZ2V0cy5sZW5ndGggPiAwKSB7CiAgICAgIHZhciBuZXh0RXhwbGljaXRUYXJnZXQgPSBxdWV1ZWRFeHBsaWNpdEh5ZHJhdGlvblRhcmdldHNbMF07CgogICAgICBpZiAobmV4dEV4cGxpY2l0VGFyZ2V0LmJsb2NrZWRPbiAhPT0gbnVsbCkgewogICAgICAgIC8vIFdlJ3JlIHN0aWxsIGJsb2NrZWQuCiAgICAgICAgYnJlYWs7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYXR0ZW1wdEV4cGxpY2l0SHlkcmF0aW9uVGFyZ2V0KG5leHRFeHBsaWNpdFRhcmdldCk7CgogICAgICAgIGlmIChuZXh0RXhwbGljaXRUYXJnZXQuYmxvY2tlZE9uID09PSBudWxsKSB7CiAgICAgICAgICAvLyBXZSdyZSB1bmJsb2NrZWQuCiAgICAgICAgICBxdWV1ZWRFeHBsaWNpdEh5ZHJhdGlvblRhcmdldHMuc2hpZnQoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CgogIHZhciBSZWFjdEN1cnJlbnRCYXRjaENvbmZpZyA9IFJlYWN0U2hhcmVkSW50ZXJuYWxzLlJlYWN0Q3VycmVudEJhdGNoQ29uZmlnOyAvLyBUT0RPOiBjYW4gd2Ugc3RvcCBleHBvcnRpbmcgdGhlc2U/CgogIHZhciBfZW5hYmxlZCA9IHRydWU7IC8vIFRoaXMgaXMgZXhwb3J0ZWQgaW4gRkIgYnVpbGRzIGZvciB1c2UgYnkgbGVnYWN5IEZCIGxheWVyIGluZnJhLgogIC8vIFdlJ2QgbGlrZSB0byByZW1vdmUgdGhpcyBidXQgaXQncyBub3QgY2xlYXIgaWYgdGhpcyBpcyBzYWZlLgoKICBmdW5jdGlvbiBzZXRFbmFibGVkKGVuYWJsZWQpIHsKICAgIF9lbmFibGVkID0gISFlbmFibGVkOwogIH0KICBmdW5jdGlvbiBpc0VuYWJsZWQoKSB7CiAgICByZXR1cm4gX2VuYWJsZWQ7CiAgfQogIGZ1bmN0aW9uIGNyZWF0ZUV2ZW50TGlzdGVuZXJXcmFwcGVyV2l0aFByaW9yaXR5KHRhcmdldENvbnRhaW5lciwgZG9tRXZlbnROYW1lLCBldmVudFN5c3RlbUZsYWdzKSB7CiAgICB2YXIgZXZlbnRQcmlvcml0eSA9IGdldEV2ZW50UHJpb3JpdHkoZG9tRXZlbnROYW1lKTsKICAgIHZhciBsaXN0ZW5lcldyYXBwZXI7CgogICAgc3dpdGNoIChldmVudFByaW9yaXR5KSB7CiAgICAgIGNhc2UgRGlzY3JldGVFdmVudFByaW9yaXR5OgogICAgICAgIGxpc3RlbmVyV3JhcHBlciA9IGRpc3BhdGNoRGlzY3JldGVFdmVudDsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgQ29udGludW91c0V2ZW50UHJpb3JpdHk6CiAgICAgICAgbGlzdGVuZXJXcmFwcGVyID0gZGlzcGF0Y2hDb250aW51b3VzRXZlbnQ7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIERlZmF1bHRFdmVudFByaW9yaXR5OgogICAgICBkZWZhdWx0OgogICAgICAgIGxpc3RlbmVyV3JhcHBlciA9IGRpc3BhdGNoRXZlbnQ7CiAgICAgICAgYnJlYWs7CiAgICB9CgogICAgcmV0dXJuIGxpc3RlbmVyV3JhcHBlci5iaW5kKG51bGwsIGRvbUV2ZW50TmFtZSwgZXZlbnRTeXN0ZW1GbGFncywgdGFyZ2V0Q29udGFpbmVyKTsKICB9CgogIGZ1bmN0aW9uIGRpc3BhdGNoRGlzY3JldGVFdmVudChkb21FdmVudE5hbWUsIGV2ZW50U3lzdGVtRmxhZ3MsIGNvbnRhaW5lciwgbmF0aXZlRXZlbnQpIHsKICAgIHZhciBwcmV2aW91c1ByaW9yaXR5ID0gZ2V0Q3VycmVudFVwZGF0ZVByaW9yaXR5KCk7CiAgICB2YXIgcHJldlRyYW5zaXRpb24gPSBSZWFjdEN1cnJlbnRCYXRjaENvbmZpZy50cmFuc2l0aW9uOwogICAgUmVhY3RDdXJyZW50QmF0Y2hDb25maWcudHJhbnNpdGlvbiA9IG51bGw7CgogICAgdHJ5IHsKICAgICAgc2V0Q3VycmVudFVwZGF0ZVByaW9yaXR5KERpc2NyZXRlRXZlbnRQcmlvcml0eSk7CiAgICAgIGRpc3BhdGNoRXZlbnQoZG9tRXZlbnROYW1lLCBldmVudFN5c3RlbUZsYWdzLCBjb250YWluZXIsIG5hdGl2ZUV2ZW50KTsKICAgIH0gZmluYWxseSB7CiAgICAgIHNldEN1cnJlbnRVcGRhdGVQcmlvcml0eShwcmV2aW91c1ByaW9yaXR5KTsKICAgICAgUmVhY3RDdXJyZW50QmF0Y2hDb25maWcudHJhbnNpdGlvbiA9IHByZXZUcmFuc2l0aW9uOwogICAgfQogIH0KCiAgZnVuY3Rpb24gZGlzcGF0Y2hDb250aW51b3VzRXZlbnQoZG9tRXZlbnROYW1lLCBldmVudFN5c3RlbUZsYWdzLCBjb250YWluZXIsIG5hdGl2ZUV2ZW50KSB7CiAgICB2YXIgcHJldmlvdXNQcmlvcml0eSA9IGdldEN1cnJlbnRVcGRhdGVQcmlvcml0eSgpOwogICAgdmFyIHByZXZUcmFuc2l0aW9uID0gUmVhY3RDdXJyZW50QmF0Y2hDb25maWcudHJhbnNpdGlvbjsKICAgIFJlYWN0Q3VycmVudEJhdGNoQ29uZmlnLnRyYW5zaXRpb24gPSBudWxsOwoKICAgIHRyeSB7CiAgICAgIHNldEN1cnJlbnRVcGRhdGVQcmlvcml0eShDb250aW51b3VzRXZlbnRQcmlvcml0eSk7CiAgICAgIGRpc3BhdGNoRXZlbnQoZG9tRXZlbnROYW1lLCBldmVudFN5c3RlbUZsYWdzLCBjb250YWluZXIsIG5hdGl2ZUV2ZW50KTsKICAgIH0gZmluYWxseSB7CiAgICAgIHNldEN1cnJlbnRVcGRhdGVQcmlvcml0eShwcmV2aW91c1ByaW9yaXR5KTsKICAgICAgUmVhY3RDdXJyZW50QmF0Y2hDb25maWcudHJhbnNpdGlvbiA9IHByZXZUcmFuc2l0aW9uOwogICAgfQogIH0KCiAgZnVuY3Rpb24gZGlzcGF0Y2hFdmVudChkb21FdmVudE5hbWUsIGV2ZW50U3lzdGVtRmxhZ3MsIHRhcmdldENvbnRhaW5lciwgbmF0aXZlRXZlbnQpIHsKICAgIGlmICghX2VuYWJsZWQpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHsKICAgICAgZGlzcGF0Y2hFdmVudFdpdGhFbmFibGVDYXB0dXJlUGhhc2VTZWxlY3RpdmVIeWRyYXRpb25XaXRob3V0RGlzY3JldGVFdmVudFJlcGxheShkb21FdmVudE5hbWUsIGV2ZW50U3lzdGVtRmxhZ3MsIHRhcmdldENvbnRhaW5lciwgbmF0aXZlRXZlbnQpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gZGlzcGF0Y2hFdmVudFdpdGhFbmFibGVDYXB0dXJlUGhhc2VTZWxlY3RpdmVIeWRyYXRpb25XaXRob3V0RGlzY3JldGVFdmVudFJlcGxheShkb21FdmVudE5hbWUsIGV2ZW50U3lzdGVtRmxhZ3MsIHRhcmdldENvbnRhaW5lciwgbmF0aXZlRXZlbnQpIHsKICAgIHZhciBibG9ja2VkT24gPSBmaW5kSW5zdGFuY2VCbG9ja2luZ0V2ZW50KGRvbUV2ZW50TmFtZSwgZXZlbnRTeXN0ZW1GbGFncywgdGFyZ2V0Q29udGFpbmVyLCBuYXRpdmVFdmVudCk7CgogICAgaWYgKGJsb2NrZWRPbiA9PT0gbnVsbCkgewogICAgICBkaXNwYXRjaEV2ZW50Rm9yUGx1Z2luRXZlbnRTeXN0ZW0oZG9tRXZlbnROYW1lLCBldmVudFN5c3RlbUZsYWdzLCBuYXRpdmVFdmVudCwgcmV0dXJuX3RhcmdldEluc3QsIHRhcmdldENvbnRhaW5lcik7CiAgICAgIGNsZWFySWZDb250aW51b3VzRXZlbnQoZG9tRXZlbnROYW1lLCBuYXRpdmVFdmVudCk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAocXVldWVJZkNvbnRpbnVvdXNFdmVudChibG9ja2VkT24sIGRvbUV2ZW50TmFtZSwgZXZlbnRTeXN0ZW1GbGFncywgdGFyZ2V0Q29udGFpbmVyLCBuYXRpdmVFdmVudCkpIHsKICAgICAgbmF0aXZlRXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgIHJldHVybjsKICAgIH0gLy8gV2UgbmVlZCB0byBjbGVhciBvbmx5IGlmIHdlIGRpZG4ndCBxdWV1ZSBiZWNhdXNlCiAgICAvLyBxdWV1ZWluZyBpcyBhY2N1bXVsYXRpdmUuCgoKICAgIGNsZWFySWZDb250aW51b3VzRXZlbnQoZG9tRXZlbnROYW1lLCBuYXRpdmVFdmVudCk7CgogICAgaWYgKGV2ZW50U3lzdGVtRmxhZ3MgJiBJU19DQVBUVVJFX1BIQVNFICYmIGlzRGlzY3JldGVFdmVudFRoYXRSZXF1aXJlc0h5ZHJhdGlvbihkb21FdmVudE5hbWUpKSB7CiAgICAgIHdoaWxlIChibG9ja2VkT24gIT09IG51bGwpIHsKICAgICAgICB2YXIgZmliZXIgPSBnZXRJbnN0YW5jZUZyb21Ob2RlKGJsb2NrZWRPbik7CgogICAgICAgIGlmIChmaWJlciAhPT0gbnVsbCkgewogICAgICAgICAgYXR0ZW1wdFN5bmNocm9ub3VzSHlkcmF0aW9uKGZpYmVyKTsKICAgICAgICB9CgogICAgICAgIHZhciBuZXh0QmxvY2tlZE9uID0gZmluZEluc3RhbmNlQmxvY2tpbmdFdmVudChkb21FdmVudE5hbWUsIGV2ZW50U3lzdGVtRmxhZ3MsIHRhcmdldENvbnRhaW5lciwgbmF0aXZlRXZlbnQpOwoKICAgICAgICBpZiAobmV4dEJsb2NrZWRPbiA9PT0gbnVsbCkgewogICAgICAgICAgZGlzcGF0Y2hFdmVudEZvclBsdWdpbkV2ZW50U3lzdGVtKGRvbUV2ZW50TmFtZSwgZXZlbnRTeXN0ZW1GbGFncywgbmF0aXZlRXZlbnQsIHJldHVybl90YXJnZXRJbnN0LCB0YXJnZXRDb250YWluZXIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKG5leHRCbG9ja2VkT24gPT09IGJsb2NrZWRPbikgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBibG9ja2VkT24gPSBuZXh0QmxvY2tlZE9uOwogICAgICB9CgogICAgICBpZiAoYmxvY2tlZE9uICE9PSBudWxsKSB7CiAgICAgICAgbmF0aXZlRXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgIH0KCiAgICAgIHJldHVybjsKICAgIH0gLy8gVGhpcyBpcyBub3QgcmVwbGF5YWJsZSBzbyB3ZSdsbCBpbnZva2UgaXQgYnV0IHdpdGhvdXQgYSB0YXJnZXQsCiAgICAvLyBpbiBjYXNlIHRoZSBldmVudCBzeXN0ZW0gbmVlZHMgdG8gdHJhY2UgaXQuCgoKICAgIGRpc3BhdGNoRXZlbnRGb3JQbHVnaW5FdmVudFN5c3RlbShkb21FdmVudE5hbWUsIGV2ZW50U3lzdGVtRmxhZ3MsIG5hdGl2ZUV2ZW50LCBudWxsLCB0YXJnZXRDb250YWluZXIpOwogIH0KCiAgdmFyIHJldHVybl90YXJnZXRJbnN0ID0gbnVsbDsgLy8gUmV0dXJucyBhIFN1c3BlbnNlSW5zdGFuY2Ugb3IgQ29udGFpbmVyIGlmIGl0J3MgYmxvY2tlZC4KICAvLyBUaGUgcmV0dXJuX3RhcmdldEluc3QgZmllbGQgYWJvdmUgaXMgY29uY2VwdHVhbGx5IHBhcnQgb2YgdGhlIHJldHVybiB2YWx1ZS4KCiAgZnVuY3Rpb24gZmluZEluc3RhbmNlQmxvY2tpbmdFdmVudChkb21FdmVudE5hbWUsIGV2ZW50U3lzdGVtRmxhZ3MsIHRhcmdldENvbnRhaW5lciwgbmF0aXZlRXZlbnQpIHsKICAgIC8vIFRPRE86IFdhcm4gaWYgX2VuYWJsZWQgaXMgZmFsc2UuCiAgICByZXR1cm5fdGFyZ2V0SW5zdCA9IG51bGw7CiAgICB2YXIgbmF0aXZlRXZlbnRUYXJnZXQgPSBnZXRFdmVudFRhcmdldChuYXRpdmVFdmVudCk7CiAgICB2YXIgdGFyZ2V0SW5zdCA9IGdldENsb3Nlc3RJbnN0YW5jZUZyb21Ob2RlKG5hdGl2ZUV2ZW50VGFyZ2V0KTsKCiAgICBpZiAodGFyZ2V0SW5zdCAhPT0gbnVsbCkgewogICAgICB2YXIgbmVhcmVzdE1vdW50ZWQgPSBnZXROZWFyZXN0TW91bnRlZEZpYmVyKHRhcmdldEluc3QpOwoKICAgICAgaWYgKG5lYXJlc3RNb3VudGVkID09PSBudWxsKSB7CiAgICAgICAgLy8gVGhpcyB0cmVlIGhhcyBiZWVuIHVubW91bnRlZCBhbHJlYWR5LiBEaXNwYXRjaCB3aXRob3V0IGEgdGFyZ2V0LgogICAgICAgIHRhcmdldEluc3QgPSBudWxsOwogICAgICB9IGVsc2UgewogICAgICAgIHZhciB0YWcgPSBuZWFyZXN0TW91bnRlZC50YWc7CgogICAgICAgIGlmICh0YWcgPT09IFN1c3BlbnNlQ29tcG9uZW50KSB7CiAgICAgICAgICB2YXIgaW5zdGFuY2UgPSBnZXRTdXNwZW5zZUluc3RhbmNlRnJvbUZpYmVyKG5lYXJlc3RNb3VudGVkKTsKCiAgICAgICAgICBpZiAoaW5zdGFuY2UgIT09IG51bGwpIHsKICAgICAgICAgICAgLy8gUXVldWUgdGhlIGV2ZW50IHRvIGJlIHJlcGxheWVkIGxhdGVyLiBBYm9ydCBkaXNwYXRjaGluZyBzaW5jZSB3ZQogICAgICAgICAgICAvLyBkb24ndCB3YW50IHRoaXMgZXZlbnQgZGlzcGF0Y2hlZCB0d2ljZSB0aHJvdWdoIHRoZSBldmVudCBzeXN0ZW0uCiAgICAgICAgICAgIC8vIFRPRE86IElmIHRoaXMgaXMgdGhlIGZpcnN0IGRpc2NyZXRlIGV2ZW50IGluIHRoZSBxdWV1ZS4gU2NoZWR1bGUgYW4gaW5jcmVhc2VkCiAgICAgICAgICAgIC8vIHByaW9yaXR5IGZvciB0aGlzIGJvdW5kYXJ5LgogICAgICAgICAgICByZXR1cm4gaW5zdGFuY2U7CiAgICAgICAgICB9IC8vIFRoaXMgc2hvdWxkbid0IGhhcHBlbiwgc29tZXRoaW5nIHdlbnQgd3JvbmcgYnV0IHRvIGF2b2lkIGJsb2NraW5nCiAgICAgICAgICAvLyB0aGUgd2hvbGUgc3lzdGVtLCBkaXNwYXRjaCB0aGUgZXZlbnQgd2l0aG91dCBhIHRhcmdldC4KICAgICAgICAgIC8vIFRPRE86IFdhcm4uCgoKICAgICAgICAgIHRhcmdldEluc3QgPSBudWxsOwogICAgICAgIH0gZWxzZSBpZiAodGFnID09PSBIb3N0Um9vdCkgewogICAgICAgICAgdmFyIHJvb3QgPSBuZWFyZXN0TW91bnRlZC5zdGF0ZU5vZGU7CgogICAgICAgICAgaWYgKGlzUm9vdERlaHlkcmF0ZWQocm9vdCkpIHsKICAgICAgICAgICAgLy8gSWYgdGhpcyBoYXBwZW5zIGR1cmluZyBhIHJlcGxheSBzb21ldGhpbmcgd2VudCB3cm9uZyBhbmQgaXQgbWlnaHQgYmxvY2sKICAgICAgICAgICAgLy8gdGhlIHdob2xlIHN5c3RlbS4KICAgICAgICAgICAgcmV0dXJuIGdldENvbnRhaW5lckZyb21GaWJlcihuZWFyZXN0TW91bnRlZCk7CiAgICAgICAgICB9CgogICAgICAgICAgdGFyZ2V0SW5zdCA9IG51bGw7CiAgICAgICAgfSBlbHNlIGlmIChuZWFyZXN0TW91bnRlZCAhPT0gdGFyZ2V0SW5zdCkgewogICAgICAgICAgLy8gSWYgd2UgZ2V0IGFuIGV2ZW50IChleDogaW1nIG9ubG9hZCkgYmVmb3JlIGNvbW1pdHRpbmcgdGhhdAogICAgICAgICAgLy8gY29tcG9uZW50J3MgbW91bnQsIGlnbm9yZSBpdCBmb3Igbm93ICh0aGF0IGlzLCB0cmVhdCBpdCBhcyBpZiBpdCB3YXMgYW4KICAgICAgICAgIC8vIGV2ZW50IG9uIGEgbm9uLVJlYWN0IHRyZWUpLiBXZSBtaWdodCBhbHNvIGNvbnNpZGVyIHF1ZXVlaW5nIGV2ZW50cyBhbmQKICAgICAgICAgIC8vIGRpc3BhdGNoaW5nIHRoZW0gYWZ0ZXIgdGhlIG1vdW50LgogICAgICAgICAgdGFyZ2V0SW5zdCA9IG51bGw7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgcmV0dXJuX3RhcmdldEluc3QgPSB0YXJnZXRJbnN0OyAvLyBXZSdyZSBub3QgYmxvY2tlZCBvbiBhbnl0aGluZy4KCiAgICByZXR1cm4gbnVsbDsKICB9CiAgZnVuY3Rpb24gZ2V0RXZlbnRQcmlvcml0eShkb21FdmVudE5hbWUpIHsKICAgIHN3aXRjaCAoZG9tRXZlbnROYW1lKSB7CiAgICAgIC8vIFVzZWQgYnkgU2ltcGxlRXZlbnRQbHVnaW46CiAgICAgIGNhc2UgJ2NhbmNlbCc6CiAgICAgIGNhc2UgJ2NsaWNrJzoKICAgICAgY2FzZSAnY2xvc2UnOgogICAgICBjYXNlICdjb250ZXh0bWVudSc6CiAgICAgIGNhc2UgJ2NvcHknOgogICAgICBjYXNlICdjdXQnOgogICAgICBjYXNlICdhdXhjbGljayc6CiAgICAgIGNhc2UgJ2RibGNsaWNrJzoKICAgICAgY2FzZSAnZHJhZ2VuZCc6CiAgICAgIGNhc2UgJ2RyYWdzdGFydCc6CiAgICAgIGNhc2UgJ2Ryb3AnOgogICAgICBjYXNlICdmb2N1c2luJzoKICAgICAgY2FzZSAnZm9jdXNvdXQnOgogICAgICBjYXNlICdpbnB1dCc6CiAgICAgIGNhc2UgJ2ludmFsaWQnOgogICAgICBjYXNlICdrZXlkb3duJzoKICAgICAgY2FzZSAna2V5cHJlc3MnOgogICAgICBjYXNlICdrZXl1cCc6CiAgICAgIGNhc2UgJ21vdXNlZG93bic6CiAgICAgIGNhc2UgJ21vdXNldXAnOgogICAgICBjYXNlICdwYXN0ZSc6CiAgICAgIGNhc2UgJ3BhdXNlJzoKICAgICAgY2FzZSAncGxheSc6CiAgICAgIGNhc2UgJ3BvaW50ZXJjYW5jZWwnOgogICAgICBjYXNlICdwb2ludGVyZG93bic6CiAgICAgIGNhc2UgJ3BvaW50ZXJ1cCc6CiAgICAgIGNhc2UgJ3JhdGVjaGFuZ2UnOgogICAgICBjYXNlICdyZXNldCc6CiAgICAgIGNhc2UgJ3Jlc2l6ZSc6CiAgICAgIGNhc2UgJ3NlZWtlZCc6CiAgICAgIGNhc2UgJ3N1Ym1pdCc6CiAgICAgIGNhc2UgJ3RvdWNoY2FuY2VsJzoKICAgICAgY2FzZSAndG91Y2hlbmQnOgogICAgICBjYXNlICd0b3VjaHN0YXJ0JzoKICAgICAgY2FzZSAndm9sdW1lY2hhbmdlJzogLy8gVXNlZCBieSBwb2x5ZmlsbHM6CiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1mYWxsdGhyb3VnaAoKICAgICAgY2FzZSAnY2hhbmdlJzoKICAgICAgY2FzZSAnc2VsZWN0aW9uY2hhbmdlJzoKICAgICAgY2FzZSAndGV4dElucHV0JzoKICAgICAgY2FzZSAnY29tcG9zaXRpb25zdGFydCc6CiAgICAgIGNhc2UgJ2NvbXBvc2l0aW9uZW5kJzoKICAgICAgY2FzZSAnY29tcG9zaXRpb251cGRhdGUnOiAvLyBPbmx5IGVuYWJsZUNyZWF0ZUV2ZW50SGFuZGxlQVBJOgogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tZmFsbHRocm91Z2gKCiAgICAgIGNhc2UgJ2JlZm9yZWJsdXInOgogICAgICBjYXNlICdhZnRlcmJsdXInOiAvLyBOb3QgdXNlZCBieSBSZWFjdCBidXQgY291bGQgYmUgYnkgdXNlciBjb2RlOgogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tZmFsbHRocm91Z2gKCiAgICAgIGNhc2UgJ2JlZm9yZWlucHV0JzoKICAgICAgY2FzZSAnYmx1cic6CiAgICAgIGNhc2UgJ2Z1bGxzY3JlZW5jaGFuZ2UnOgogICAgICBjYXNlICdmb2N1cyc6CiAgICAgIGNhc2UgJ2hhc2hjaGFuZ2UnOgogICAgICBjYXNlICdwb3BzdGF0ZSc6CiAgICAgIGNhc2UgJ3NlbGVjdCc6CiAgICAgIGNhc2UgJ3NlbGVjdHN0YXJ0JzoKICAgICAgICByZXR1cm4gRGlzY3JldGVFdmVudFByaW9yaXR5OwoKICAgICAgY2FzZSAnZHJhZyc6CiAgICAgIGNhc2UgJ2RyYWdlbnRlcic6CiAgICAgIGNhc2UgJ2RyYWdleGl0JzoKICAgICAgY2FzZSAnZHJhZ2xlYXZlJzoKICAgICAgY2FzZSAnZHJhZ292ZXInOgogICAgICBjYXNlICdtb3VzZW1vdmUnOgogICAgICBjYXNlICdtb3VzZW91dCc6CiAgICAgIGNhc2UgJ21vdXNlb3Zlcic6CiAgICAgIGNhc2UgJ3BvaW50ZXJtb3ZlJzoKICAgICAgY2FzZSAncG9pbnRlcm91dCc6CiAgICAgIGNhc2UgJ3BvaW50ZXJvdmVyJzoKICAgICAgY2FzZSAnc2Nyb2xsJzoKICAgICAgY2FzZSAndG9nZ2xlJzoKICAgICAgY2FzZSAndG91Y2htb3ZlJzoKICAgICAgY2FzZSAnd2hlZWwnOiAvLyBOb3QgdXNlZCBieSBSZWFjdCBidXQgY291bGQgYmUgYnkgdXNlciBjb2RlOgogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tZmFsbHRocm91Z2gKCiAgICAgIGNhc2UgJ21vdXNlZW50ZXInOgogICAgICBjYXNlICdtb3VzZWxlYXZlJzoKICAgICAgY2FzZSAncG9pbnRlcmVudGVyJzoKICAgICAgY2FzZSAncG9pbnRlcmxlYXZlJzoKICAgICAgICByZXR1cm4gQ29udGludW91c0V2ZW50UHJpb3JpdHk7CgogICAgICBjYXNlICdtZXNzYWdlJzoKICAgICAgICB7CiAgICAgICAgICAvLyBXZSBtaWdodCBiZSBpbiB0aGUgU2NoZWR1bGVyIGNhbGxiYWNrLgogICAgICAgICAgLy8gRXZlbnR1YWxseSB0aGlzIG1lY2hhbmlzbSB3aWxsIGJlIHJlcGxhY2VkIGJ5IGEgY2hlY2sKICAgICAgICAgIC8vIG9mIHRoZSBjdXJyZW50IHByaW9yaXR5IG9uIHRoZSBuYXRpdmUgc2NoZWR1bGVyLgogICAgICAgICAgdmFyIHNjaGVkdWxlclByaW9yaXR5ID0gZ2V0Q3VycmVudFByaW9yaXR5TGV2ZWwoKTsKCiAgICAgICAgICBzd2l0Y2ggKHNjaGVkdWxlclByaW9yaXR5KSB7CiAgICAgICAgICAgIGNhc2UgSW1tZWRpYXRlUHJpb3JpdHk6CiAgICAgICAgICAgICAgcmV0dXJuIERpc2NyZXRlRXZlbnRQcmlvcml0eTsKCiAgICAgICAgICAgIGNhc2UgVXNlckJsb2NraW5nUHJpb3JpdHk6CiAgICAgICAgICAgICAgcmV0dXJuIENvbnRpbnVvdXNFdmVudFByaW9yaXR5OwoKICAgICAgICAgICAgY2FzZSBOb3JtYWxQcmlvcml0eToKICAgICAgICAgICAgY2FzZSBMb3dQcmlvcml0eToKICAgICAgICAgICAgICAvLyBUT0RPOiBIYW5kbGUgTG93U2NoZWR1bGVyUHJpb3JpdHksIHNvbWVob3cuIE1heWJlIHRoZSBzYW1lIGxhbmUgYXMgaHlkcmF0aW9uLgogICAgICAgICAgICAgIHJldHVybiBEZWZhdWx0RXZlbnRQcmlvcml0eTsKCiAgICAgICAgICAgIGNhc2UgSWRsZVByaW9yaXR5OgogICAgICAgICAgICAgIHJldHVybiBJZGxlRXZlbnRQcmlvcml0eTsKCiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgcmV0dXJuIERlZmF1bHRFdmVudFByaW9yaXR5OwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgIGRlZmF1bHQ6CiAgICAgICAgcmV0dXJuIERlZmF1bHRFdmVudFByaW9yaXR5OwogICAgfQogIH0KCiAgZnVuY3Rpb24gYWRkRXZlbnRCdWJibGVMaXN0ZW5lcih0YXJnZXQsIGV2ZW50VHlwZSwgbGlzdGVuZXIpIHsKICAgIHRhcmdldC5hZGRFdmVudExpc3RlbmVyKGV2ZW50VHlwZSwgbGlzdGVuZXIsIGZhbHNlKTsKICAgIHJldHVybiBsaXN0ZW5lcjsKICB9CiAgZnVuY3Rpb24gYWRkRXZlbnRDYXB0dXJlTGlzdGVuZXIodGFyZ2V0LCBldmVudFR5cGUsIGxpc3RlbmVyKSB7CiAgICB0YXJnZXQuYWRkRXZlbnRMaXN0ZW5lcihldmVudFR5cGUsIGxpc3RlbmVyLCB0cnVlKTsKICAgIHJldHVybiBsaXN0ZW5lcjsKICB9CiAgZnVuY3Rpb24gYWRkRXZlbnRDYXB0dXJlTGlzdGVuZXJXaXRoUGFzc2l2ZUZsYWcodGFyZ2V0LCBldmVudFR5cGUsIGxpc3RlbmVyLCBwYXNzaXZlKSB7CiAgICB0YXJnZXQuYWRkRXZlbnRMaXN0ZW5lcihldmVudFR5cGUsIGxpc3RlbmVyLCB7CiAgICAgIGNhcHR1cmU6IHRydWUsCiAgICAgIHBhc3NpdmU6IHBhc3NpdmUKICAgIH0pOwogICAgcmV0dXJuIGxpc3RlbmVyOwogIH0KICBmdW5jdGlvbiBhZGRFdmVudEJ1YmJsZUxpc3RlbmVyV2l0aFBhc3NpdmVGbGFnKHRhcmdldCwgZXZlbnRUeXBlLCBsaXN0ZW5lciwgcGFzc2l2ZSkgewogICAgdGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnRUeXBlLCBsaXN0ZW5lciwgewogICAgICBwYXNzaXZlOiBwYXNzaXZlCiAgICB9KTsKICAgIHJldHVybiBsaXN0ZW5lcjsKICB9CgogIC8qKgogICAqIFRoZXNlIHZhcmlhYmxlcyBzdG9yZSBpbmZvcm1hdGlvbiBhYm91dCB0ZXh0IGNvbnRlbnQgb2YgYSB0YXJnZXQgbm9kZSwKICAgKiBhbGxvd2luZyBjb21wYXJpc29uIG9mIGNvbnRlbnQgYmVmb3JlIGFuZCBhZnRlciBhIGdpdmVuIGV2ZW50LgogICAqCiAgICogSWRlbnRpZnkgdGhlIG5vZGUgd2hlcmUgc2VsZWN0aW9uIGN1cnJlbnRseSBiZWdpbnMsIHRoZW4gb2JzZXJ2ZQogICAqIGJvdGggaXRzIHRleHQgY29udGVudCBhbmQgaXRzIGN1cnJlbnQgcG9zaXRpb24gaW4gdGhlIERPTS4gU2luY2UgdGhlCiAgICogYnJvd3NlciBtYXkgbmF0aXZlbHkgcmVwbGFjZSB0aGUgdGFyZ2V0IG5vZGUgZHVyaW5nIGNvbXBvc2l0aW9uLCB3ZSBjYW4KICAgKiB1c2UgaXRzIHBvc2l0aW9uIHRvIGZpbmQgaXRzIHJlcGxhY2VtZW50LgogICAqCiAgICoKICAgKi8KICB2YXIgcm9vdCA9IG51bGw7CiAgdmFyIHN0YXJ0VGV4dCA9IG51bGw7CiAgdmFyIGZhbGxiYWNrVGV4dCA9IG51bGw7CiAgZnVuY3Rpb24gaW5pdGlhbGl6ZShuYXRpdmVFdmVudFRhcmdldCkgewogICAgcm9vdCA9IG5hdGl2ZUV2ZW50VGFyZ2V0OwogICAgc3RhcnRUZXh0ID0gZ2V0VGV4dCgpOwogICAgcmV0dXJuIHRydWU7CiAgfQogIGZ1bmN0aW9uIHJlc2V0KCkgewogICAgcm9vdCA9IG51bGw7CiAgICBzdGFydFRleHQgPSBudWxsOwogICAgZmFsbGJhY2tUZXh0ID0gbnVsbDsKICB9CiAgZnVuY3Rpb24gZ2V0RGF0YSgpIHsKICAgIGlmIChmYWxsYmFja1RleHQpIHsKICAgICAgcmV0dXJuIGZhbGxiYWNrVGV4dDsKICAgIH0KCiAgICB2YXIgc3RhcnQ7CiAgICB2YXIgc3RhcnRWYWx1ZSA9IHN0YXJ0VGV4dDsKICAgIHZhciBzdGFydExlbmd0aCA9IHN0YXJ0VmFsdWUubGVuZ3RoOwogICAgdmFyIGVuZDsKICAgIHZhciBlbmRWYWx1ZSA9IGdldFRleHQoKTsKICAgIHZhciBlbmRMZW5ndGggPSBlbmRWYWx1ZS5sZW5ndGg7CgogICAgZm9yIChzdGFydCA9IDA7IHN0YXJ0IDwgc3RhcnRMZW5ndGg7IHN0YXJ0KyspIHsKICAgICAgaWYgKHN0YXJ0VmFsdWVbc3RhcnRdICE9PSBlbmRWYWx1ZVtzdGFydF0pIHsKICAgICAgICBicmVhazsKICAgICAgfQogICAgfQoKICAgIHZhciBtaW5FbmQgPSBzdGFydExlbmd0aCAtIHN0YXJ0OwoKICAgIGZvciAoZW5kID0gMTsgZW5kIDw9IG1pbkVuZDsgZW5kKyspIHsKICAgICAgaWYgKHN0YXJ0VmFsdWVbc3RhcnRMZW5ndGggLSBlbmRdICE9PSBlbmRWYWx1ZVtlbmRMZW5ndGggLSBlbmRdKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICB2YXIgc2xpY2VUYWlsID0gZW5kID4gMSA/IDEgLSBlbmQgOiB1bmRlZmluZWQ7CiAgICBmYWxsYmFja1RleHQgPSBlbmRWYWx1ZS5zbGljZShzdGFydCwgc2xpY2VUYWlsKTsKICAgIHJldHVybiBmYWxsYmFja1RleHQ7CiAgfQogIGZ1bmN0aW9uIGdldFRleHQoKSB7CiAgICBpZiAoJ3ZhbHVlJyBpbiByb290KSB7CiAgICAgIHJldHVybiByb290LnZhbHVlOwogICAgfQoKICAgIHJldHVybiByb290LnRleHRDb250ZW50OwogIH0KCiAgLyoqCiAgICogYGNoYXJDb2RlYCByZXByZXNlbnRzIHRoZSBhY3R1YWwgImNoYXJhY3RlciBjb2RlIiBhbmQgaXMgc2FmZSB0byB1c2Ugd2l0aAogICAqIGBTdHJpbmcuZnJvbUNoYXJDb2RlYC4gQXMgc3VjaCwgb25seSBrZXlzIHRoYXQgY29ycmVzcG9uZCB0byBwcmludGFibGUKICAgKiBjaGFyYWN0ZXJzIHByb2R1Y2UgYSB2YWxpZCBgY2hhckNvZGVgLCB0aGUgb25seSBleGNlcHRpb24gdG8gdGhpcyBpcyBFbnRlci4KICAgKiBUaGUgVGFiLWtleSBpcyBjb25zaWRlcmVkIG5vbi1wcmludGFibGUgYW5kIGRvZXMgbm90IGhhdmUgYSBgY2hhckNvZGVgLAogICAqIHByZXN1bWFibHkgYmVjYXVzZSBpdCBkb2VzIG5vdCBwcm9kdWNlIGEgdGFiLWNoYXJhY3RlciBpbiBicm93c2Vycy4KICAgKgogICAqIEBwYXJhbSB7b2JqZWN0fSBuYXRpdmVFdmVudCBOYXRpdmUgYnJvd3NlciBldmVudC4KICAgKiBAcmV0dXJuIHtudW1iZXJ9IE5vcm1hbGl6ZWQgYGNoYXJDb2RlYCBwcm9wZXJ0eS4KICAgKi8KICBmdW5jdGlvbiBnZXRFdmVudENoYXJDb2RlKG5hdGl2ZUV2ZW50KSB7CiAgICB2YXIgY2hhckNvZGU7CiAgICB2YXIga2V5Q29kZSA9IG5hdGl2ZUV2ZW50LmtleUNvZGU7CgogICAgaWYgKCdjaGFyQ29kZScgaW4gbmF0aXZlRXZlbnQpIHsKICAgICAgY2hhckNvZGUgPSBuYXRpdmVFdmVudC5jaGFyQ29kZTsgLy8gRkYgZG9lcyBub3Qgc2V0IGBjaGFyQ29kZWAgZm9yIHRoZSBFbnRlci1rZXksIGNoZWNrIGFnYWluc3QgYGtleUNvZGVgLgoKICAgICAgaWYgKGNoYXJDb2RlID09PSAwICYmIGtleUNvZGUgPT09IDEzKSB7CiAgICAgICAgY2hhckNvZGUgPSAxMzsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgLy8gSUU4IGRvZXMgbm90IGltcGxlbWVudCBgY2hhckNvZGVgLCBidXQgYGtleUNvZGVgIGhhcyB0aGUgY29ycmVjdCB2YWx1ZS4KICAgICAgY2hhckNvZGUgPSBrZXlDb2RlOwogICAgfSAvLyBJRSBhbmQgRWRnZSAob24gV2luZG93cykgYW5kIENocm9tZSAvIFNhZmFyaSAob24gV2luZG93cyBhbmQgTGludXgpCiAgICAvLyByZXBvcnQgRW50ZXIgYXMgY2hhckNvZGUgMTAgd2hlbiBjdHJsIGlzIHByZXNzZWQuCgoKICAgIGlmIChjaGFyQ29kZSA9PT0gMTApIHsKICAgICAgY2hhckNvZGUgPSAxMzsKICAgIH0gLy8gU29tZSBub24tcHJpbnRhYmxlIGtleXMgYXJlIHJlcG9ydGVkIGluIGBjaGFyQ29kZWAvYGtleUNvZGVgLCBkaXNjYXJkIHRoZW0uCiAgICAvLyBNdXN0IG5vdCBkaXNjYXJkIHRoZSAobm9uLSlwcmludGFibGUgRW50ZXIta2V5LgoKCiAgICBpZiAoY2hhckNvZGUgPj0gMzIgfHwgY2hhckNvZGUgPT09IDEzKSB7CiAgICAgIHJldHVybiBjaGFyQ29kZTsKICAgIH0KCiAgICByZXR1cm4gMDsKICB9CgogIGZ1bmN0aW9uIGZ1bmN0aW9uVGhhdFJldHVybnNUcnVlKCkgewogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiBmdW5jdGlvblRoYXRSZXR1cm5zRmFsc2UoKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfSAvLyBUaGlzIGlzIGludGVudGlvbmFsbHkgYSBmYWN0b3J5IHNvIHRoYXQgd2UgaGF2ZSBkaWZmZXJlbnQgcmV0dXJuZWQgY29uc3RydWN0b3JzLgogIC8vIElmIHdlIGhhZCBhIHNpbmdsZSBjb25zdHJ1Y3RvciwgaXQgd291bGQgYmUgbWVnYW1vcnBoaWMgYW5kIGVuZ2luZXMgd291bGQgZGVvcHQuCgoKICBmdW5jdGlvbiBjcmVhdGVTeW50aGV0aWNFdmVudChJbnRlcmZhY2UpIHsKICAgIC8qKgogICAgICogU3ludGhldGljIGV2ZW50cyBhcmUgZGlzcGF0Y2hlZCBieSBldmVudCBwbHVnaW5zLCB0eXBpY2FsbHkgaW4gcmVzcG9uc2UgdG8gYQogICAgICogdG9wLWxldmVsIGV2ZW50IGRlbGVnYXRpb24gaGFuZGxlci4KICAgICAqCiAgICAgKiBUaGVzZSBzeXN0ZW1zIHNob3VsZCBnZW5lcmFsbHkgdXNlIHBvb2xpbmcgdG8gcmVkdWNlIHRoZSBmcmVxdWVuY3kgb2YgZ2FyYmFnZQogICAgICogY29sbGVjdGlvbi4gVGhlIHN5c3RlbSBzaG91bGQgY2hlY2sgYGlzUGVyc2lzdGVudGAgdG8gZGV0ZXJtaW5lIHdoZXRoZXIgdGhlCiAgICAgKiBldmVudCBzaG91bGQgYmUgcmVsZWFzZWQgaW50byB0aGUgcG9vbCBhZnRlciBiZWluZyBkaXNwYXRjaGVkLiBVc2VycyB0aGF0CiAgICAgKiBuZWVkIGEgcGVyc2lzdGVkIGV2ZW50IHNob3VsZCBpbnZva2UgYHBlcnNpc3RgLgogICAgICoKICAgICAqIFN5bnRoZXRpYyBldmVudHMgKGFuZCBzdWJjbGFzc2VzKSBpbXBsZW1lbnQgdGhlIERPTSBMZXZlbCAzIEV2ZW50cyBBUEkgYnkKICAgICAqIG5vcm1hbGl6aW5nIGJyb3dzZXIgcXVpcmtzLiBTdWJjbGFzc2VzIGRvIG5vdCBuZWNlc3NhcmlseSBoYXZlIHRvIGltcGxlbWVudCBhCiAgICAgKiBET00gaW50ZXJmYWNlOyBjdXN0b20gYXBwbGljYXRpb24tc3BlY2lmaWMgZXZlbnRzIGNhbiBhbHNvIHN1YmNsYXNzIHRoaXMuCiAgICAgKi8KICAgIGZ1bmN0aW9uIFN5bnRoZXRpY0Jhc2VFdmVudChyZWFjdE5hbWUsIHJlYWN0RXZlbnRUeXBlLCB0YXJnZXRJbnN0LCBuYXRpdmVFdmVudCwgbmF0aXZlRXZlbnRUYXJnZXQpIHsKICAgICAgdGhpcy5fcmVhY3ROYW1lID0gcmVhY3ROYW1lOwogICAgICB0aGlzLl90YXJnZXRJbnN0ID0gdGFyZ2V0SW5zdDsKICAgICAgdGhpcy50eXBlID0gcmVhY3RFdmVudFR5cGU7CiAgICAgIHRoaXMubmF0aXZlRXZlbnQgPSBuYXRpdmVFdmVudDsKICAgICAgdGhpcy50YXJnZXQgPSBuYXRpdmVFdmVudFRhcmdldDsKICAgICAgdGhpcy5jdXJyZW50VGFyZ2V0ID0gbnVsbDsKCiAgICAgIGZvciAodmFyIF9wcm9wTmFtZSBpbiBJbnRlcmZhY2UpIHsKICAgICAgICBpZiAoIUludGVyZmFjZS5oYXNPd25Qcm9wZXJ0eShfcHJvcE5hbWUpKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIHZhciBub3JtYWxpemUgPSBJbnRlcmZhY2VbX3Byb3BOYW1lXTsKCiAgICAgICAgaWYgKG5vcm1hbGl6ZSkgewogICAgICAgICAgdGhpc1tfcHJvcE5hbWVdID0gbm9ybWFsaXplKG5hdGl2ZUV2ZW50KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpc1tfcHJvcE5hbWVdID0gbmF0aXZlRXZlbnRbX3Byb3BOYW1lXTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHZhciBkZWZhdWx0UHJldmVudGVkID0gbmF0aXZlRXZlbnQuZGVmYXVsdFByZXZlbnRlZCAhPSBudWxsID8gbmF0aXZlRXZlbnQuZGVmYXVsdFByZXZlbnRlZCA6IG5hdGl2ZUV2ZW50LnJldHVyblZhbHVlID09PSBmYWxzZTsKCiAgICAgIGlmIChkZWZhdWx0UHJldmVudGVkKSB7CiAgICAgICAgdGhpcy5pc0RlZmF1bHRQcmV2ZW50ZWQgPSBmdW5jdGlvblRoYXRSZXR1cm5zVHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmlzRGVmYXVsdFByZXZlbnRlZCA9IGZ1bmN0aW9uVGhhdFJldHVybnNGYWxzZTsKICAgICAgfQoKICAgICAgdGhpcy5pc1Byb3BhZ2F0aW9uU3RvcHBlZCA9IGZ1bmN0aW9uVGhhdFJldHVybnNGYWxzZTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgYXNzaWduKFN5bnRoZXRpY0Jhc2VFdmVudC5wcm90b3R5cGUsIHsKICAgICAgcHJldmVudERlZmF1bHQ6IGZ1bmN0aW9uICgpIHsKICAgICAgICB0aGlzLmRlZmF1bHRQcmV2ZW50ZWQgPSB0cnVlOwogICAgICAgIHZhciBldmVudCA9IHRoaXMubmF0aXZlRXZlbnQ7CgogICAgICAgIGlmICghZXZlbnQpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmIChldmVudC5wcmV2ZW50RGVmYXVsdCkgewogICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsgLy8gJEZsb3dGaXhNZSAtIGZsb3cgaXMgbm90IGF3YXJlIG9mIGB1bmtub3duYCBpbiBJRQogICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGV2ZW50LnJldHVyblZhbHVlICE9PSAndW5rbm93bicpIHsKICAgICAgICAgIGV2ZW50LnJldHVyblZhbHVlID0gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICB0aGlzLmlzRGVmYXVsdFByZXZlbnRlZCA9IGZ1bmN0aW9uVGhhdFJldHVybnNUcnVlOwogICAgICB9LAogICAgICBzdG9wUHJvcGFnYXRpb246IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgZXZlbnQgPSB0aGlzLm5hdGl2ZUV2ZW50OwoKICAgICAgICBpZiAoIWV2ZW50KSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAoZXZlbnQuc3RvcFByb3BhZ2F0aW9uKSB7CiAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTsgLy8gJEZsb3dGaXhNZSAtIGZsb3cgaXMgbm90IGF3YXJlIG9mIGB1bmtub3duYCBpbiBJRQogICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGV2ZW50LmNhbmNlbEJ1YmJsZSAhPT0gJ3Vua25vd24nKSB7CiAgICAgICAgICAvLyBUaGUgQ2hhbmdlRXZlbnRQbHVnaW4gcmVnaXN0ZXJzIGEgInByb3BlcnR5Y2hhbmdlIiBldmVudCBmb3IKICAgICAgICAgIC8vIElFLiBUaGlzIGV2ZW50IGRvZXMgbm90IHN1cHBvcnQgYnViYmxpbmcgb3IgY2FuY2VsbGluZywgYW5kCiAgICAgICAgICAvLyBhbnkgcmVmZXJlbmNlcyB0byBjYW5jZWxCdWJibGUgdGhyb3cgIk1lbWJlciBub3QgZm91bmQiLiAgQQogICAgICAgICAgLy8gdHlwZW9mIGNoZWNrIG9mICJ1bmtub3duIiBjaXJjdW12ZW50cyB0aGlzIGlzc3VlIChhbmQgaXMgYWxzbwogICAgICAgICAgLy8gSUUgc3BlY2lmaWMpLgogICAgICAgICAgZXZlbnQuY2FuY2VsQnViYmxlID0gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIHRoaXMuaXNQcm9wYWdhdGlvblN0b3BwZWQgPSBmdW5jdGlvblRoYXRSZXR1cm5zVHJ1ZTsKICAgICAgfSwKCiAgICAgIC8qKgogICAgICAgKiBXZSByZWxlYXNlIGFsbCBkaXNwYXRjaGVkIGBTeW50aGV0aWNFdmVudGBzIGFmdGVyIGVhY2ggZXZlbnQgbG9vcCwgYWRkaW5nCiAgICAgICAqIHRoZW0gYmFjayBpbnRvIHRoZSBwb29sLiBUaGlzIGFsbG93cyBhIHdheSB0byBob2xkIG9udG8gYSByZWZlcmVuY2UgdGhhdAogICAgICAgKiB3b24ndCBiZSBhZGRlZCBiYWNrIGludG8gdGhlIHBvb2wuCiAgICAgICAqLwogICAgICBwZXJzaXN0OiBmdW5jdGlvbiAoKSB7Ly8gTW9kZXJuIGV2ZW50IHN5c3RlbSBkb2Vzbid0IHVzZSBwb29saW5nLgogICAgICB9LAoKICAgICAgLyoqCiAgICAgICAqIENoZWNrcyBpZiB0aGlzIGV2ZW50IHNob3VsZCBiZSByZWxlYXNlZCBiYWNrIGludG8gdGhlIHBvb2wuCiAgICAgICAqCiAgICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IFRydWUgaWYgdGhpcyBzaG91bGQgbm90IGJlIHJlbGVhc2VkLCBmYWxzZSBvdGhlcndpc2UuCiAgICAgICAqLwogICAgICBpc1BlcnNpc3RlbnQ6IGZ1bmN0aW9uVGhhdFJldHVybnNUcnVlCiAgICB9KTsKICAgIHJldHVybiBTeW50aGV0aWNCYXNlRXZlbnQ7CiAgfQogIC8qKgogICAqIEBpbnRlcmZhY2UgRXZlbnQKICAgKiBAc2VlIGh0dHA6Ly93d3cudzMub3JnL1RSL0RPTS1MZXZlbC0zLUV2ZW50cy8KICAgKi8KCgogIHZhciBFdmVudEludGVyZmFjZSA9IHsKICAgIGV2ZW50UGhhc2U6IDAsCiAgICBidWJibGVzOiAwLAogICAgY2FuY2VsYWJsZTogMCwKICAgIHRpbWVTdGFtcDogZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgIHJldHVybiBldmVudC50aW1lU3RhbXAgfHwgRGF0ZS5ub3coKTsKICAgIH0sCiAgICBkZWZhdWx0UHJldmVudGVkOiAwLAogICAgaXNUcnVzdGVkOiAwCiAgfTsKICB2YXIgU3ludGhldGljRXZlbnQgPSBjcmVhdGVTeW50aGV0aWNFdmVudChFdmVudEludGVyZmFjZSk7CgogIHZhciBVSUV2ZW50SW50ZXJmYWNlID0gYXNzaWduKHt9LCBFdmVudEludGVyZmFjZSwgewogICAgdmlldzogMCwKICAgIGRldGFpbDogMAogIH0pOwoKICB2YXIgU3ludGhldGljVUlFdmVudCA9IGNyZWF0ZVN5bnRoZXRpY0V2ZW50KFVJRXZlbnRJbnRlcmZhY2UpOwogIHZhciBsYXN0TW92ZW1lbnRYOwogIHZhciBsYXN0TW92ZW1lbnRZOwogIHZhciBsYXN0TW91c2VFdmVudDsKCiAgZnVuY3Rpb24gdXBkYXRlTW91c2VNb3ZlbWVudFBvbHlmaWxsU3RhdGUoZXZlbnQpIHsKICAgIGlmIChldmVudCAhPT0gbGFzdE1vdXNlRXZlbnQpIHsKICAgICAgaWYgKGxhc3RNb3VzZUV2ZW50ICYmIGV2ZW50LnR5cGUgPT09ICdtb3VzZW1vdmUnKSB7CiAgICAgICAgbGFzdE1vdmVtZW50WCA9IGV2ZW50LnNjcmVlblggLSBsYXN0TW91c2VFdmVudC5zY3JlZW5YOwogICAgICAgIGxhc3RNb3ZlbWVudFkgPSBldmVudC5zY3JlZW5ZIC0gbGFzdE1vdXNlRXZlbnQuc2NyZWVuWTsKICAgICAgfSBlbHNlIHsKICAgICAgICBsYXN0TW92ZW1lbnRYID0gMDsKICAgICAgICBsYXN0TW92ZW1lbnRZID0gMDsKICAgICAgfQoKICAgICAgbGFzdE1vdXNlRXZlbnQgPSBldmVudDsKICAgIH0KICB9CiAgLyoqCiAgICogQGludGVyZmFjZSBNb3VzZUV2ZW50CiAgICogQHNlZSBodHRwOi8vd3d3LnczLm9yZy9UUi9ET00tTGV2ZWwtMy1FdmVudHMvCiAgICovCgoKICB2YXIgTW91c2VFdmVudEludGVyZmFjZSA9IGFzc2lnbih7fSwgVUlFdmVudEludGVyZmFjZSwgewogICAgc2NyZWVuWDogMCwKICAgIHNjcmVlblk6IDAsCiAgICBjbGllbnRYOiAwLAogICAgY2xpZW50WTogMCwKICAgIHBhZ2VYOiAwLAogICAgcGFnZVk6IDAsCiAgICBjdHJsS2V5OiAwLAogICAgc2hpZnRLZXk6IDAsCiAgICBhbHRLZXk6IDAsCiAgICBtZXRhS2V5OiAwLAogICAgZ2V0TW9kaWZpZXJTdGF0ZTogZ2V0RXZlbnRNb2RpZmllclN0YXRlLAogICAgYnV0dG9uOiAwLAogICAgYnV0dG9uczogMCwKICAgIHJlbGF0ZWRUYXJnZXQ6IGZ1bmN0aW9uIChldmVudCkgewogICAgICBpZiAoZXZlbnQucmVsYXRlZFRhcmdldCA9PT0gdW5kZWZpbmVkKSByZXR1cm4gZXZlbnQuZnJvbUVsZW1lbnQgPT09IGV2ZW50LnNyY0VsZW1lbnQgPyBldmVudC50b0VsZW1lbnQgOiBldmVudC5mcm9tRWxlbWVudDsKICAgICAgcmV0dXJuIGV2ZW50LnJlbGF0ZWRUYXJnZXQ7CiAgICB9LAogICAgbW92ZW1lbnRYOiBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgaWYgKCdtb3ZlbWVudFgnIGluIGV2ZW50KSB7CiAgICAgICAgcmV0dXJuIGV2ZW50Lm1vdmVtZW50WDsKICAgICAgfQoKICAgICAgdXBkYXRlTW91c2VNb3ZlbWVudFBvbHlmaWxsU3RhdGUoZXZlbnQpOwogICAgICByZXR1cm4gbGFzdE1vdmVtZW50WDsKICAgIH0sCiAgICBtb3ZlbWVudFk6IGZ1bmN0aW9uIChldmVudCkgewogICAgICBpZiAoJ21vdmVtZW50WScgaW4gZXZlbnQpIHsKICAgICAgICByZXR1cm4gZXZlbnQubW92ZW1lbnRZOwogICAgICB9IC8vIERvbid0IG5lZWQgdG8gY2FsbCB1cGRhdGVNb3VzZU1vdmVtZW50UG9seWZpbGxTdGF0ZSgpIGhlcmUKICAgICAgLy8gYmVjYXVzZSBpdCdzIGd1YXJhbnRlZWQgdG8gaGF2ZSBhbHJlYWR5IHJ1biB3aGVuIG1vdmVtZW50WAogICAgICAvLyB3YXMgY29waWVkLgoKCiAgICAgIHJldHVybiBsYXN0TW92ZW1lbnRZOwogICAgfQogIH0pOwoKICB2YXIgU3ludGhldGljTW91c2VFdmVudCA9IGNyZWF0ZVN5bnRoZXRpY0V2ZW50KE1vdXNlRXZlbnRJbnRlcmZhY2UpOwogIC8qKgogICAqIEBpbnRlcmZhY2UgRHJhZ0V2ZW50CiAgICogQHNlZSBodHRwOi8vd3d3LnczLm9yZy9UUi9ET00tTGV2ZWwtMy1FdmVudHMvCiAgICovCgogIHZhciBEcmFnRXZlbnRJbnRlcmZhY2UgPSBhc3NpZ24oe30sIE1vdXNlRXZlbnRJbnRlcmZhY2UsIHsKICAgIGRhdGFUcmFuc2ZlcjogMAogIH0pOwoKICB2YXIgU3ludGhldGljRHJhZ0V2ZW50ID0gY3JlYXRlU3ludGhldGljRXZlbnQoRHJhZ0V2ZW50SW50ZXJmYWNlKTsKICAvKioKICAgKiBAaW50ZXJmYWNlIEZvY3VzRXZlbnQKICAgKiBAc2VlIGh0dHA6Ly93d3cudzMub3JnL1RSL0RPTS1MZXZlbC0zLUV2ZW50cy8KICAgKi8KCiAgdmFyIEZvY3VzRXZlbnRJbnRlcmZhY2UgPSBhc3NpZ24oe30sIFVJRXZlbnRJbnRlcmZhY2UsIHsKICAgIHJlbGF0ZWRUYXJnZXQ6IDAKICB9KTsKCiAgdmFyIFN5bnRoZXRpY0ZvY3VzRXZlbnQgPSBjcmVhdGVTeW50aGV0aWNFdmVudChGb2N1c0V2ZW50SW50ZXJmYWNlKTsKICAvKioKICAgKiBAaW50ZXJmYWNlIEV2ZW50CiAgICogQHNlZSBodHRwOi8vd3d3LnczLm9yZy9UUi9jc3MzLWFuaW1hdGlvbnMvI0FuaW1hdGlvbkV2ZW50LWludGVyZmFjZQogICAqIEBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0FuaW1hdGlvbkV2ZW50CiAgICovCgogIHZhciBBbmltYXRpb25FdmVudEludGVyZmFjZSA9IGFzc2lnbih7fSwgRXZlbnRJbnRlcmZhY2UsIHsKICAgIGFuaW1hdGlvbk5hbWU6IDAsCiAgICBlbGFwc2VkVGltZTogMCwKICAgIHBzZXVkb0VsZW1lbnQ6IDAKICB9KTsKCiAgdmFyIFN5bnRoZXRpY0FuaW1hdGlvbkV2ZW50ID0gY3JlYXRlU3ludGhldGljRXZlbnQoQW5pbWF0aW9uRXZlbnRJbnRlcmZhY2UpOwogIC8qKgogICAqIEBpbnRlcmZhY2UgRXZlbnQKICAgKiBAc2VlIGh0dHA6Ly93d3cudzMub3JnL1RSL2NsaXBib2FyZC1hcGlzLwogICAqLwoKICB2YXIgQ2xpcGJvYXJkRXZlbnRJbnRlcmZhY2UgPSBhc3NpZ24oe30sIEV2ZW50SW50ZXJmYWNlLCB7CiAgICBjbGlwYm9hcmREYXRhOiBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgcmV0dXJuICdjbGlwYm9hcmREYXRhJyBpbiBldmVudCA/IGV2ZW50LmNsaXBib2FyZERhdGEgOiB3aW5kb3cuY2xpcGJvYXJkRGF0YTsKICAgIH0KICB9KTsKCiAgdmFyIFN5bnRoZXRpY0NsaXBib2FyZEV2ZW50ID0gY3JlYXRlU3ludGhldGljRXZlbnQoQ2xpcGJvYXJkRXZlbnRJbnRlcmZhY2UpOwogIC8qKgogICAqIEBpbnRlcmZhY2UgRXZlbnQKICAgKiBAc2VlIGh0dHA6Ly93d3cudzMub3JnL1RSL0RPTS1MZXZlbC0zLUV2ZW50cy8jZXZlbnRzLWNvbXBvc2l0aW9uZXZlbnRzCiAgICovCgogIHZhciBDb21wb3NpdGlvbkV2ZW50SW50ZXJmYWNlID0gYXNzaWduKHt9LCBFdmVudEludGVyZmFjZSwgewogICAgZGF0YTogMAogIH0pOwoKICB2YXIgU3ludGhldGljQ29tcG9zaXRpb25FdmVudCA9IGNyZWF0ZVN5bnRoZXRpY0V2ZW50KENvbXBvc2l0aW9uRXZlbnRJbnRlcmZhY2UpOwogIC8qKgogICAqIEBpbnRlcmZhY2UgRXZlbnQKICAgKiBAc2VlIGh0dHA6Ly93d3cudzMub3JnL1RSLzIwMTMvV0QtRE9NLUxldmVsLTMtRXZlbnRzLTIwMTMxMTA1CiAgICogICAgICAvI2V2ZW50cy1pbnB1dGV2ZW50cwogICAqLwogIC8vIEhhcHBlbnMgdG8gc2hhcmUgdGhlIHNhbWUgbGlzdCBmb3Igbm93LgoKICB2YXIgU3ludGhldGljSW5wdXRFdmVudCA9IFN5bnRoZXRpY0NvbXBvc2l0aW9uRXZlbnQ7CiAgLyoqCiAgICogTm9ybWFsaXphdGlvbiBvZiBkZXByZWNhdGVkIEhUTUw1IGBrZXlgIHZhbHVlcwogICAqIEBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0tleWJvYXJkRXZlbnQjS2V5X25hbWVzCiAgICovCgogIHZhciBub3JtYWxpemVLZXkgPSB7CiAgICBFc2M6ICdFc2NhcGUnLAogICAgU3BhY2ViYXI6ICcgJywKICAgIExlZnQ6ICdBcnJvd0xlZnQnLAogICAgVXA6ICdBcnJvd1VwJywKICAgIFJpZ2h0OiAnQXJyb3dSaWdodCcsCiAgICBEb3duOiAnQXJyb3dEb3duJywKICAgIERlbDogJ0RlbGV0ZScsCiAgICBXaW46ICdPUycsCiAgICBNZW51OiAnQ29udGV4dE1lbnUnLAogICAgQXBwczogJ0NvbnRleHRNZW51JywKICAgIFNjcm9sbDogJ1Njcm9sbExvY2snLAogICAgTW96UHJpbnRhYmxlS2V5OiAnVW5pZGVudGlmaWVkJwogIH07CiAgLyoqCiAgICogVHJhbnNsYXRpb24gZnJvbSBsZWdhY3kgYGtleUNvZGVgIHRvIEhUTUw1IGBrZXlgCiAgICogT25seSBzcGVjaWFsIGtleXMgc3VwcG9ydGVkLCBhbGwgb3RoZXJzIGRlcGVuZCBvbiBrZXlib2FyZCBsYXlvdXQgb3IgYnJvd3NlcgogICAqIEBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0tleWJvYXJkRXZlbnQjS2V5X25hbWVzCiAgICovCgogIHZhciB0cmFuc2xhdGVUb0tleSA9IHsKICAgICc4JzogJ0JhY2tzcGFjZScsCiAgICAnOSc6ICdUYWInLAogICAgJzEyJzogJ0NsZWFyJywKICAgICcxMyc6ICdFbnRlcicsCiAgICAnMTYnOiAnU2hpZnQnLAogICAgJzE3JzogJ0NvbnRyb2wnLAogICAgJzE4JzogJ0FsdCcsCiAgICAnMTknOiAnUGF1c2UnLAogICAgJzIwJzogJ0NhcHNMb2NrJywKICAgICcyNyc6ICdFc2NhcGUnLAogICAgJzMyJzogJyAnLAogICAgJzMzJzogJ1BhZ2VVcCcsCiAgICAnMzQnOiAnUGFnZURvd24nLAogICAgJzM1JzogJ0VuZCcsCiAgICAnMzYnOiAnSG9tZScsCiAgICAnMzcnOiAnQXJyb3dMZWZ0JywKICAgICczOCc6ICdBcnJvd1VwJywKICAgICczOSc6ICdBcnJvd1JpZ2h0JywKICAgICc0MCc6ICdBcnJvd0Rvd24nLAogICAgJzQ1JzogJ0luc2VydCcsCiAgICAnNDYnOiAnRGVsZXRlJywKICAgICcxMTInOiAnRjEnLAogICAgJzExMyc6ICdGMicsCiAgICAnMTE0JzogJ0YzJywKICAgICcxMTUnOiAnRjQnLAogICAgJzExNic6ICdGNScsCiAgICAnMTE3JzogJ0Y2JywKICAgICcxMTgnOiAnRjcnLAogICAgJzExOSc6ICdGOCcsCiAgICAnMTIwJzogJ0Y5JywKICAgICcxMjEnOiAnRjEwJywKICAgICcxMjInOiAnRjExJywKICAgICcxMjMnOiAnRjEyJywKICAgICcxNDQnOiAnTnVtTG9jaycsCiAgICAnMTQ1JzogJ1Njcm9sbExvY2snLAogICAgJzIyNCc6ICdNZXRhJwogIH07CiAgLyoqCiAgICogQHBhcmFtIHtvYmplY3R9IG5hdGl2ZUV2ZW50IE5hdGl2ZSBicm93c2VyIGV2ZW50LgogICAqIEByZXR1cm4ge3N0cmluZ30gTm9ybWFsaXplZCBga2V5YCBwcm9wZXJ0eS4KICAgKi8KCiAgZnVuY3Rpb24gZ2V0RXZlbnRLZXkobmF0aXZlRXZlbnQpIHsKICAgIGlmIChuYXRpdmVFdmVudC5rZXkpIHsKICAgICAgLy8gTm9ybWFsaXplIGluY29uc2lzdGVudCB2YWx1ZXMgcmVwb3J0ZWQgYnkgYnJvd3NlcnMgZHVlIHRvCiAgICAgIC8vIGltcGxlbWVudGF0aW9ucyBvZiBhIHdvcmtpbmcgZHJhZnQgc3BlY2lmaWNhdGlvbi4KICAgICAgLy8gRmlyZUZveCBpbXBsZW1lbnRzIGBrZXlgIGJ1dCByZXR1cm5zIGBNb3pQcmludGFibGVLZXlgIGZvciBhbGwKICAgICAgLy8gcHJpbnRhYmxlIGNoYXJhY3RlcnMgKG5vcm1hbGl6ZWQgdG8gYFVuaWRlbnRpZmllZGApLCBpZ25vcmUgaXQuCiAgICAgIHZhciBrZXkgPSBub3JtYWxpemVLZXlbbmF0aXZlRXZlbnQua2V5XSB8fCBuYXRpdmVFdmVudC5rZXk7CgogICAgICBpZiAoa2V5ICE9PSAnVW5pZGVudGlmaWVkJykgewogICAgICAgIHJldHVybiBrZXk7CiAgICAgIH0KICAgIH0gLy8gQnJvd3NlciBkb2VzIG5vdCBpbXBsZW1lbnQgYGtleWAsIHBvbHlmaWxsIGFzIG11Y2ggb2YgaXQgYXMgd2UgY2FuLgoKCiAgICBpZiAobmF0aXZlRXZlbnQudHlwZSA9PT0gJ2tleXByZXNzJykgewogICAgICB2YXIgY2hhckNvZGUgPSBnZXRFdmVudENoYXJDb2RlKG5hdGl2ZUV2ZW50KTsgLy8gVGhlIGVudGVyLWtleSBpcyB0ZWNobmljYWxseSBib3RoIHByaW50YWJsZSBhbmQgbm9uLXByaW50YWJsZSBhbmQgY2FuCiAgICAgIC8vIHRodXMgYmUgY2FwdHVyZWQgYnkgYGtleXByZXNzYCwgbm8gb3RoZXIgbm9uLXByaW50YWJsZSBrZXkgc2hvdWxkLgoKICAgICAgcmV0dXJuIGNoYXJDb2RlID09PSAxMyA/ICdFbnRlcicgOiBTdHJpbmcuZnJvbUNoYXJDb2RlKGNoYXJDb2RlKTsKICAgIH0KCiAgICBpZiAobmF0aXZlRXZlbnQudHlwZSA9PT0gJ2tleWRvd24nIHx8IG5hdGl2ZUV2ZW50LnR5cGUgPT09ICdrZXl1cCcpIHsKICAgICAgLy8gV2hpbGUgdXNlciBrZXlib2FyZCBsYXlvdXQgZGV0ZXJtaW5lcyB0aGUgYWN0dWFsIG1lYW5pbmcgb2YgZWFjaAogICAgICAvLyBga2V5Q29kZWAgdmFsdWUsIGFsbW9zdCBhbGwgZnVuY3Rpb24ga2V5cyBoYXZlIGEgdW5pdmVyc2FsIHZhbHVlLgogICAgICByZXR1cm4gdHJhbnNsYXRlVG9LZXlbbmF0aXZlRXZlbnQua2V5Q29kZV0gfHwgJ1VuaWRlbnRpZmllZCc7CiAgICB9CgogICAgcmV0dXJuICcnOwogIH0KICAvKioKICAgKiBUcmFuc2xhdGlvbiBmcm9tIG1vZGlmaWVyIGtleSB0byB0aGUgYXNzb2NpYXRlZCBwcm9wZXJ0eSBpbiB0aGUgZXZlbnQuCiAgICogQHNlZSBodHRwOi8vd3d3LnczLm9yZy9UUi9ET00tTGV2ZWwtMy1FdmVudHMvI2tleXMtTW9kaWZpZXJzCiAgICovCgoKICB2YXIgbW9kaWZpZXJLZXlUb1Byb3AgPSB7CiAgICBBbHQ6ICdhbHRLZXknLAogICAgQ29udHJvbDogJ2N0cmxLZXknLAogICAgTWV0YTogJ21ldGFLZXknLAogICAgU2hpZnQ6ICdzaGlmdEtleScKICB9OyAvLyBPbGRlciBicm93c2VycyAoU2FmYXJpIDw9IDEwLCBpT1MgU2FmYXJpIDw9IDEwLjIpIGRvIG5vdCBzdXBwb3J0CiAgLy8gZ2V0TW9kaWZpZXJTdGF0ZS4gSWYgZ2V0TW9kaWZpZXJTdGF0ZSBpcyBub3Qgc3VwcG9ydGVkLCB3ZSBtYXAgaXQgdG8gYSBzZXQgb2YKICAvLyBtb2RpZmllciBrZXlzIGV4cG9zZWQgYnkgdGhlIGV2ZW50LiBJbiB0aGlzIGNhc2UsIExvY2sta2V5cyBhcmUgbm90IHN1cHBvcnRlZC4KCiAgZnVuY3Rpb24gbW9kaWZpZXJTdGF0ZUdldHRlcihrZXlBcmcpIHsKICAgIHZhciBzeW50aGV0aWNFdmVudCA9IHRoaXM7CiAgICB2YXIgbmF0aXZlRXZlbnQgPSBzeW50aGV0aWNFdmVudC5uYXRpdmVFdmVudDsKCiAgICBpZiAobmF0aXZlRXZlbnQuZ2V0TW9kaWZpZXJTdGF0ZSkgewogICAgICByZXR1cm4gbmF0aXZlRXZlbnQuZ2V0TW9kaWZpZXJTdGF0ZShrZXlBcmcpOwogICAgfQoKICAgIHZhciBrZXlQcm9wID0gbW9kaWZpZXJLZXlUb1Byb3Bba2V5QXJnXTsKICAgIHJldHVybiBrZXlQcm9wID8gISFuYXRpdmVFdmVudFtrZXlQcm9wXSA6IGZhbHNlOwogIH0KCiAgZnVuY3Rpb24gZ2V0RXZlbnRNb2RpZmllclN0YXRlKG5hdGl2ZUV2ZW50KSB7CiAgICByZXR1cm4gbW9kaWZpZXJTdGF0ZUdldHRlcjsKICB9CiAgLyoqCiAgICogQGludGVyZmFjZSBLZXlib2FyZEV2ZW50CiAgICogQHNlZSBodHRwOi8vd3d3LnczLm9yZy9UUi9ET00tTGV2ZWwtMy1FdmVudHMvCiAgICovCgoKICB2YXIgS2V5Ym9hcmRFdmVudEludGVyZmFjZSA9IGFzc2lnbih7fSwgVUlFdmVudEludGVyZmFjZSwgewogICAga2V5OiBnZXRFdmVudEtleSwKICAgIGNvZGU6IDAsCiAgICBsb2NhdGlvbjogMCwKICAgIGN0cmxLZXk6IDAsCiAgICBzaGlmdEtleTogMCwKICAgIGFsdEtleTogMCwKICAgIG1ldGFLZXk6IDAsCiAgICByZXBlYXQ6IDAsCiAgICBsb2NhbGU6IDAsCiAgICBnZXRNb2RpZmllclN0YXRlOiBnZXRFdmVudE1vZGlmaWVyU3RhdGUsCiAgICAvLyBMZWdhY3kgSW50ZXJmYWNlCiAgICBjaGFyQ29kZTogZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgIC8vIGBjaGFyQ29kZWAgaXMgdGhlIHJlc3VsdCBvZiBhIEtleVByZXNzIGV2ZW50IGFuZCByZXByZXNlbnRzIHRoZSB2YWx1ZSBvZgogICAgICAvLyB0aGUgYWN0dWFsIHByaW50YWJsZSBjaGFyYWN0ZXIuCiAgICAgIC8vIEtleVByZXNzIGlzIGRlcHJlY2F0ZWQsIGJ1dCBpdHMgcmVwbGFjZW1lbnQgaXMgbm90IHlldCBmaW5hbCBhbmQgbm90CiAgICAgIC8vIGltcGxlbWVudGVkIGluIGFueSBtYWpvciBicm93c2VyLiBPbmx5IEtleVByZXNzIGhhcyBjaGFyQ29kZS4KICAgICAgaWYgKGV2ZW50LnR5cGUgPT09ICdrZXlwcmVzcycpIHsKICAgICAgICByZXR1cm4gZ2V0RXZlbnRDaGFyQ29kZShldmVudCk7CiAgICAgIH0KCiAgICAgIHJldHVybiAwOwogICAgfSwKICAgIGtleUNvZGU6IGZ1bmN0aW9uIChldmVudCkgewogICAgICAvLyBga2V5Q29kZWAgaXMgdGhlIHJlc3VsdCBvZiBhIEtleURvd24vVXAgZXZlbnQgYW5kIHJlcHJlc2VudHMgdGhlIHZhbHVlIG9mCiAgICAgIC8vIHBoeXNpY2FsIGtleWJvYXJkIGtleS4KICAgICAgLy8gVGhlIGFjdHVhbCBtZWFuaW5nIG9mIHRoZSB2YWx1ZSBkZXBlbmRzIG9uIHRoZSB1c2Vycycga2V5Ym9hcmQgbGF5b3V0CiAgICAgIC8vIHdoaWNoIGNhbm5vdCBiZSBkZXRlY3RlZC4gQXNzdW1pbmcgdGhhdCBpdCBpcyBhIFVTIGtleWJvYXJkIGxheW91dAogICAgICAvLyBwcm92aWRlcyBhIHN1cnByaXNpbmdseSBhY2N1cmF0ZSBtYXBwaW5nIGZvciBVUyBhbmQgRXVyb3BlYW4gdXNlcnMuCiAgICAgIC8vIER1ZSB0byB0aGlzLCBpdCBpcyBsZWZ0IHRvIHRoZSB1c2VyIHRvIGltcGxlbWVudCBhdCB0aGlzIHRpbWUuCiAgICAgIGlmIChldmVudC50eXBlID09PSAna2V5ZG93bicgfHwgZXZlbnQudHlwZSA9PT0gJ2tleXVwJykgewogICAgICAgIHJldHVybiBldmVudC5rZXlDb2RlOwogICAgICB9CgogICAgICByZXR1cm4gMDsKICAgIH0sCiAgICB3aGljaDogZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgIC8vIGB3aGljaGAgaXMgYW4gYWxpYXMgZm9yIGVpdGhlciBga2V5Q29kZWAgb3IgYGNoYXJDb2RlYCBkZXBlbmRpbmcgb24gdGhlCiAgICAgIC8vIHR5cGUgb2YgdGhlIGV2ZW50LgogICAgICBpZiAoZXZlbnQudHlwZSA9PT0gJ2tleXByZXNzJykgewogICAgICAgIHJldHVybiBnZXRFdmVudENoYXJDb2RlKGV2ZW50KTsKICAgICAgfQoKICAgICAgaWYgKGV2ZW50LnR5cGUgPT09ICdrZXlkb3duJyB8fCBldmVudC50eXBlID09PSAna2V5dXAnKSB7CiAgICAgICAgcmV0dXJuIGV2ZW50LmtleUNvZGU7CiAgICAgIH0KCiAgICAgIHJldHVybiAwOwogICAgfQogIH0pOwoKICB2YXIgU3ludGhldGljS2V5Ym9hcmRFdmVudCA9IGNyZWF0ZVN5bnRoZXRpY0V2ZW50KEtleWJvYXJkRXZlbnRJbnRlcmZhY2UpOwogIC8qKgogICAqIEBpbnRlcmZhY2UgUG9pbnRlckV2ZW50CiAgICogQHNlZSBodHRwOi8vd3d3LnczLm9yZy9UUi9wb2ludGVyZXZlbnRzLwogICAqLwoKICB2YXIgUG9pbnRlckV2ZW50SW50ZXJmYWNlID0gYXNzaWduKHt9LCBNb3VzZUV2ZW50SW50ZXJmYWNlLCB7CiAgICBwb2ludGVySWQ6IDAsCiAgICB3aWR0aDogMCwKICAgIGhlaWdodDogMCwKICAgIHByZXNzdXJlOiAwLAogICAgdGFuZ2VudGlhbFByZXNzdXJlOiAwLAogICAgdGlsdFg6IDAsCiAgICB0aWx0WTogMCwKICAgIHR3aXN0OiAwLAogICAgcG9pbnRlclR5cGU6IDAsCiAgICBpc1ByaW1hcnk6IDAKICB9KTsKCiAgdmFyIFN5bnRoZXRpY1BvaW50ZXJFdmVudCA9IGNyZWF0ZVN5bnRoZXRpY0V2ZW50KFBvaW50ZXJFdmVudEludGVyZmFjZSk7CiAgLyoqCiAgICogQGludGVyZmFjZSBUb3VjaEV2ZW50CiAgICogQHNlZSBodHRwOi8vd3d3LnczLm9yZy9UUi90b3VjaC1ldmVudHMvCiAgICovCgogIHZhciBUb3VjaEV2ZW50SW50ZXJmYWNlID0gYXNzaWduKHt9LCBVSUV2ZW50SW50ZXJmYWNlLCB7CiAgICB0b3VjaGVzOiAwLAogICAgdGFyZ2V0VG91Y2hlczogMCwKICAgIGNoYW5nZWRUb3VjaGVzOiAwLAogICAgYWx0S2V5OiAwLAogICAgbWV0YUtleTogMCwKICAgIGN0cmxLZXk6IDAsCiAgICBzaGlmdEtleTogMCwKICAgIGdldE1vZGlmaWVyU3RhdGU6IGdldEV2ZW50TW9kaWZpZXJTdGF0ZQogIH0pOwoKICB2YXIgU3ludGhldGljVG91Y2hFdmVudCA9IGNyZWF0ZVN5bnRoZXRpY0V2ZW50KFRvdWNoRXZlbnRJbnRlcmZhY2UpOwogIC8qKgogICAqIEBpbnRlcmZhY2UgRXZlbnQKICAgKiBAc2VlIGh0dHA6Ly93d3cudzMub3JnL1RSLzIwMDkvV0QtY3NzMy10cmFuc2l0aW9ucy0yMDA5MDMyMC8jdHJhbnNpdGlvbi1ldmVudHMtCiAgICogQHNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvVHJhbnNpdGlvbkV2ZW50CiAgICovCgogIHZhciBUcmFuc2l0aW9uRXZlbnRJbnRlcmZhY2UgPSBhc3NpZ24oe30sIEV2ZW50SW50ZXJmYWNlLCB7CiAgICBwcm9wZXJ0eU5hbWU6IDAsCiAgICBlbGFwc2VkVGltZTogMCwKICAgIHBzZXVkb0VsZW1lbnQ6IDAKICB9KTsKCiAgdmFyIFN5bnRoZXRpY1RyYW5zaXRpb25FdmVudCA9IGNyZWF0ZVN5bnRoZXRpY0V2ZW50KFRyYW5zaXRpb25FdmVudEludGVyZmFjZSk7CiAgLyoqCiAgICogQGludGVyZmFjZSBXaGVlbEV2ZW50CiAgICogQHNlZSBodHRwOi8vd3d3LnczLm9yZy9UUi9ET00tTGV2ZWwtMy1FdmVudHMvCiAgICovCgogIHZhciBXaGVlbEV2ZW50SW50ZXJmYWNlID0gYXNzaWduKHt9LCBNb3VzZUV2ZW50SW50ZXJmYWNlLCB7CiAgICBkZWx0YVg6IGZ1bmN0aW9uIChldmVudCkgewogICAgICByZXR1cm4gJ2RlbHRhWCcgaW4gZXZlbnQgPyBldmVudC5kZWx0YVggOiAvLyBGYWxsYmFjayB0byBgd2hlZWxEZWx0YVhgIGZvciBXZWJraXQgYW5kIG5vcm1hbGl6ZSAocmlnaHQgaXMgcG9zaXRpdmUpLgogICAgICAnd2hlZWxEZWx0YVgnIGluIGV2ZW50ID8gLWV2ZW50LndoZWVsRGVsdGFYIDogMDsKICAgIH0sCiAgICBkZWx0YVk6IGZ1bmN0aW9uIChldmVudCkgewogICAgICByZXR1cm4gJ2RlbHRhWScgaW4gZXZlbnQgPyBldmVudC5kZWx0YVkgOiAvLyBGYWxsYmFjayB0byBgd2hlZWxEZWx0YVlgIGZvciBXZWJraXQgYW5kIG5vcm1hbGl6ZSAoZG93biBpcyBwb3NpdGl2ZSkuCiAgICAgICd3aGVlbERlbHRhWScgaW4gZXZlbnQgPyAtZXZlbnQud2hlZWxEZWx0YVkgOiAvLyBGYWxsYmFjayB0byBgd2hlZWxEZWx0YWAgZm9yIElFPDkgYW5kIG5vcm1hbGl6ZSAoZG93biBpcyBwb3NpdGl2ZSkuCiAgICAgICd3aGVlbERlbHRhJyBpbiBldmVudCA/IC1ldmVudC53aGVlbERlbHRhIDogMDsKICAgIH0sCiAgICBkZWx0YVo6IDAsCiAgICAvLyBCcm93c2VycyB3aXRob3V0ICJkZWx0YU1vZGUiIGlzIHJlcG9ydGluZyBpbiByYXcgd2hlZWwgZGVsdGEgd2hlcmUgb25lCiAgICAvLyBub3RjaCBvbiB0aGUgc2Nyb2xsIGlzIGFsd2F5cyArLy0gMTIwLCByb3VnaGx5IGVxdWl2YWxlbnQgdG8gcGl4ZWxzLgogICAgLy8gQSBnb29kIGFwcHJveGltYXRpb24gb2YgRE9NX0RFTFRBX0xJTkUgKDEpIGlzIDUlIG9mIHZpZXdwb3J0IHNpemUgb3IKICAgIC8vIH40MCBwaXhlbHMsIGZvciBET01fREVMVEFfU0NSRUVOICgyKSBpdCBpcyA4Ny41JSBvZiB2aWV3cG9ydCBzaXplLgogICAgZGVsdGFNb2RlOiAwCiAgfSk7CgogIHZhciBTeW50aGV0aWNXaGVlbEV2ZW50ID0gY3JlYXRlU3ludGhldGljRXZlbnQoV2hlZWxFdmVudEludGVyZmFjZSk7CgogIHZhciBFTkRfS0VZQ09ERVMgPSBbOSwgMTMsIDI3LCAzMl07IC8vIFRhYiwgUmV0dXJuLCBFc2MsIFNwYWNlCgogIHZhciBTVEFSVF9LRVlDT0RFID0gMjI5OwogIHZhciBjYW5Vc2VDb21wb3NpdGlvbkV2ZW50ID0gY2FuVXNlRE9NICYmICdDb21wb3NpdGlvbkV2ZW50JyBpbiB3aW5kb3c7CiAgdmFyIGRvY3VtZW50TW9kZSA9IG51bGw7CgogIGlmIChjYW5Vc2VET00gJiYgJ2RvY3VtZW50TW9kZScgaW4gZG9jdW1lbnQpIHsKICAgIGRvY3VtZW50TW9kZSA9IGRvY3VtZW50LmRvY3VtZW50TW9kZTsKICB9IC8vIFdlYmtpdCBvZmZlcnMgYSB2ZXJ5IHVzZWZ1bCBgdGV4dElucHV0YCBldmVudCB0aGF0IGNhbiBiZSB1c2VkIHRvCiAgLy8gZGlyZWN0bHkgcmVwcmVzZW50IGBiZWZvcmVJbnB1dGAuIFRoZSBJRSBgdGV4dGlucHV0YCBldmVudCBpcyBub3QgYXMKICAvLyB1c2VmdWwsIHNvIHdlIGRvbid0IHVzZSBpdC4KCgogIHZhciBjYW5Vc2VUZXh0SW5wdXRFdmVudCA9IGNhblVzZURPTSAmJiAnVGV4dEV2ZW50JyBpbiB3aW5kb3cgJiYgIWRvY3VtZW50TW9kZTsgLy8gSW4gSUU5Kywgd2UgaGF2ZSBhY2Nlc3MgdG8gY29tcG9zaXRpb24gZXZlbnRzLCBidXQgdGhlIGRhdGEgc3VwcGxpZWQKICAvLyBieSB0aGUgbmF0aXZlIGNvbXBvc2l0aW9uZW5kIGV2ZW50IG1heSBiZSBpbmNvcnJlY3QuIEphcGFuZXNlIGlkZW9ncmFwaGljCiAgLy8gc3BhY2VzLCBmb3IgaW5zdGFuY2UgKFx1MzAwMCkgYXJlIG5vdCByZWNvcmRlZCBjb3JyZWN0bHkuCgogIHZhciB1c2VGYWxsYmFja0NvbXBvc2l0aW9uRGF0YSA9IGNhblVzZURPTSAmJiAoIWNhblVzZUNvbXBvc2l0aW9uRXZlbnQgfHwgZG9jdW1lbnRNb2RlICYmIGRvY3VtZW50TW9kZSA+IDggJiYgZG9jdW1lbnRNb2RlIDw9IDExKTsKICB2YXIgU1BBQ0VCQVJfQ09ERSA9IDMyOwogIHZhciBTUEFDRUJBUl9DSEFSID0gU3RyaW5nLmZyb21DaGFyQ29kZShTUEFDRUJBUl9DT0RFKTsKCiAgZnVuY3Rpb24gcmVnaXN0ZXJFdmVudHMoKSB7CiAgICByZWdpc3RlclR3b1BoYXNlRXZlbnQoJ29uQmVmb3JlSW5wdXQnLCBbJ2NvbXBvc2l0aW9uZW5kJywgJ2tleXByZXNzJywgJ3RleHRJbnB1dCcsICdwYXN0ZSddKTsKICAgIHJlZ2lzdGVyVHdvUGhhc2VFdmVudCgnb25Db21wb3NpdGlvbkVuZCcsIFsnY29tcG9zaXRpb25lbmQnLCAnZm9jdXNvdXQnLCAna2V5ZG93bicsICdrZXlwcmVzcycsICdrZXl1cCcsICdtb3VzZWRvd24nXSk7CiAgICByZWdpc3RlclR3b1BoYXNlRXZlbnQoJ29uQ29tcG9zaXRpb25TdGFydCcsIFsnY29tcG9zaXRpb25zdGFydCcsICdmb2N1c291dCcsICdrZXlkb3duJywgJ2tleXByZXNzJywgJ2tleXVwJywgJ21vdXNlZG93biddKTsKICAgIHJlZ2lzdGVyVHdvUGhhc2VFdmVudCgnb25Db21wb3NpdGlvblVwZGF0ZScsIFsnY29tcG9zaXRpb251cGRhdGUnLCAnZm9jdXNvdXQnLCAna2V5ZG93bicsICdrZXlwcmVzcycsICdrZXl1cCcsICdtb3VzZWRvd24nXSk7CiAgfSAvLyBUcmFjayB3aGV0aGVyIHdlJ3ZlIGV2ZXIgaGFuZGxlZCBhIGtleXByZXNzIG9uIHRoZSBzcGFjZSBrZXkuCgoKICB2YXIgaGFzU3BhY2VLZXlwcmVzcyA9IGZhbHNlOwogIC8qKgogICAqIFJldHVybiB3aGV0aGVyIGEgbmF0aXZlIGtleXByZXNzIGV2ZW50IGlzIGFzc3VtZWQgdG8gYmUgYSBjb21tYW5kLgogICAqIFRoaXMgaXMgcmVxdWlyZWQgYmVjYXVzZSBGaXJlZm94IGZpcmVzIGBrZXlwcmVzc2AgZXZlbnRzIGZvciBrZXkgY29tbWFuZHMKICAgKiAoY3V0LCBjb3B5LCBzZWxlY3QtYWxsLCBldGMuKSBldmVuIHRob3VnaCBubyBjaGFyYWN0ZXIgaXMgaW5zZXJ0ZWQuCiAgICovCgogIGZ1bmN0aW9uIGlzS2V5cHJlc3NDb21tYW5kKG5hdGl2ZUV2ZW50KSB7CiAgICByZXR1cm4gKG5hdGl2ZUV2ZW50LmN0cmxLZXkgfHwgbmF0aXZlRXZlbnQuYWx0S2V5IHx8IG5hdGl2ZUV2ZW50Lm1ldGFLZXkpICYmIC8vIGN0cmxLZXkgJiYgYWx0S2V5IGlzIGVxdWl2YWxlbnQgdG8gQWx0R3IsIGFuZCBpcyBub3QgYSBjb21tYW5kLgogICAgIShuYXRpdmVFdmVudC5jdHJsS2V5ICYmIG5hdGl2ZUV2ZW50LmFsdEtleSk7CiAgfQogIC8qKgogICAqIFRyYW5zbGF0ZSBuYXRpdmUgdG9wIGxldmVsIGV2ZW50cyBpbnRvIGV2ZW50IHR5cGVzLgogICAqLwoKCiAgZnVuY3Rpb24gZ2V0Q29tcG9zaXRpb25FdmVudFR5cGUoZG9tRXZlbnROYW1lKSB7CiAgICBzd2l0Y2ggKGRvbUV2ZW50TmFtZSkgewogICAgICBjYXNlICdjb21wb3NpdGlvbnN0YXJ0JzoKICAgICAgICByZXR1cm4gJ29uQ29tcG9zaXRpb25TdGFydCc7CgogICAgICBjYXNlICdjb21wb3NpdGlvbmVuZCc6CiAgICAgICAgcmV0dXJuICdvbkNvbXBvc2l0aW9uRW5kJzsKCiAgICAgIGNhc2UgJ2NvbXBvc2l0aW9udXBkYXRlJzoKICAgICAgICByZXR1cm4gJ29uQ29tcG9zaXRpb25VcGRhdGUnOwogICAgfQogIH0KICAvKioKICAgKiBEb2VzIG91ciBmYWxsYmFjayBiZXN0LWd1ZXNzIG1vZGVsIHRoaW5rIHRoaXMgZXZlbnQgc2lnbmlmaWVzIHRoYXQKICAgKiBjb21wb3NpdGlvbiBoYXMgYmVndW4/CiAgICovCgoKICBmdW5jdGlvbiBpc0ZhbGxiYWNrQ29tcG9zaXRpb25TdGFydChkb21FdmVudE5hbWUsIG5hdGl2ZUV2ZW50KSB7CiAgICByZXR1cm4gZG9tRXZlbnROYW1lID09PSAna2V5ZG93bicgJiYgbmF0aXZlRXZlbnQua2V5Q29kZSA9PT0gU1RBUlRfS0VZQ09ERTsKICB9CiAgLyoqCiAgICogRG9lcyBvdXIgZmFsbGJhY2sgbW9kZSB0aGluayB0aGF0IHRoaXMgZXZlbnQgaXMgdGhlIGVuZCBvZiBjb21wb3NpdGlvbj8KICAgKi8KCgogIGZ1bmN0aW9uIGlzRmFsbGJhY2tDb21wb3NpdGlvbkVuZChkb21FdmVudE5hbWUsIG5hdGl2ZUV2ZW50KSB7CiAgICBzd2l0Y2ggKGRvbUV2ZW50TmFtZSkgewogICAgICBjYXNlICdrZXl1cCc6CiAgICAgICAgLy8gQ29tbWFuZCBrZXlzIGluc2VydCBvciBjbGVhciBJTUUgaW5wdXQuCiAgICAgICAgcmV0dXJuIEVORF9LRVlDT0RFUy5pbmRleE9mKG5hdGl2ZUV2ZW50LmtleUNvZGUpICE9PSAtMTsKCiAgICAgIGNhc2UgJ2tleWRvd24nOgogICAgICAgIC8vIEV4cGVjdCBJTUUga2V5Q29kZSBvbiBlYWNoIGtleWRvd24uIElmIHdlIGdldCBhbnkgb3RoZXIKICAgICAgICAvLyBjb2RlIHdlIG11c3QgaGF2ZSBleGl0ZWQgZWFybGllci4KICAgICAgICByZXR1cm4gbmF0aXZlRXZlbnQua2V5Q29kZSAhPT0gU1RBUlRfS0VZQ09ERTsKCiAgICAgIGNhc2UgJ2tleXByZXNzJzoKICAgICAgY2FzZSAnbW91c2Vkb3duJzoKICAgICAgY2FzZSAnZm9jdXNvdXQnOgogICAgICAgIC8vIEV2ZW50cyBhcmUgbm90IHBvc3NpYmxlIHdpdGhvdXQgY2FuY2VsbGluZyBJTUUuCiAgICAgICAgcmV0dXJuIHRydWU7CgogICAgICBkZWZhdWx0OgogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9CiAgLyoqCiAgICogR29vZ2xlIElucHV0IFRvb2xzIHByb3ZpZGVzIGNvbXBvc2l0aW9uIGRhdGEgdmlhIGEgQ3VzdG9tRXZlbnQsCiAgICogd2l0aCB0aGUgYGRhdGFgIHByb3BlcnR5IHBvcHVsYXRlZCBpbiB0aGUgYGRldGFpbGAgb2JqZWN0LiBJZiB0aGlzCiAgICogaXMgYXZhaWxhYmxlIG9uIHRoZSBldmVudCBvYmplY3QsIHVzZSBpdC4gSWYgbm90LCB0aGlzIGlzIGEgcGxhaW4KICAgKiBjb21wb3NpdGlvbiBldmVudCBhbmQgd2UgaGF2ZSBub3RoaW5nIHNwZWNpYWwgdG8gZXh0cmFjdC4KICAgKgogICAqIEBwYXJhbSB7b2JqZWN0fSBuYXRpdmVFdmVudAogICAqIEByZXR1cm4gez9zdHJpbmd9CiAgICovCgoKICBmdW5jdGlvbiBnZXREYXRhRnJvbUN1c3RvbUV2ZW50KG5hdGl2ZUV2ZW50KSB7CiAgICB2YXIgZGV0YWlsID0gbmF0aXZlRXZlbnQuZGV0YWlsOwoKICAgIGlmICh0eXBlb2YgZGV0YWlsID09PSAnb2JqZWN0JyAmJiAnZGF0YScgaW4gZGV0YWlsKSB7CiAgICAgIHJldHVybiBkZXRhaWwuZGF0YTsKICAgIH0KCiAgICByZXR1cm4gbnVsbDsKICB9CiAgLyoqCiAgICogQ2hlY2sgaWYgYSBjb21wb3NpdGlvbiBldmVudCB3YXMgdHJpZ2dlcmVkIGJ5IEtvcmVhbiBJTUUuCiAgICogT3VyIGZhbGxiYWNrIG1vZGUgZG9lcyBub3Qgd29yayB3ZWxsIHdpdGggSUUncyBLb3JlYW4gSU1FLAogICAqIHNvIGp1c3QgdXNlIG5hdGl2ZSBjb21wb3NpdGlvbiBldmVudHMgd2hlbiBLb3JlYW4gSU1FIGlzIHVzZWQuCiAgICogQWx0aG91Z2ggQ29tcG9zaXRpb25FdmVudC5sb2NhbGUgcHJvcGVydHkgaXMgZGVwcmVjYXRlZCwKICAgKiBpdCBpcyBhdmFpbGFibGUgaW4gSUUsIHdoZXJlIG91ciBmYWxsYmFjayBtb2RlIGlzIGVuYWJsZWQuCiAgICoKICAgKiBAcGFyYW0ge29iamVjdH0gbmF0aXZlRXZlbnQKICAgKiBAcmV0dXJuIHtib29sZWFufQogICAqLwoKCiAgZnVuY3Rpb24gaXNVc2luZ0tvcmVhbklNRShuYXRpdmVFdmVudCkgewogICAgcmV0dXJuIG5hdGl2ZUV2ZW50LmxvY2FsZSA9PT0gJ2tvJzsKICB9IC8vIFRyYWNrIHRoZSBjdXJyZW50IElNRSBjb21wb3NpdGlvbiBzdGF0dXMsIGlmIGFueS4KCgogIHZhciBpc0NvbXBvc2luZyA9IGZhbHNlOwogIC8qKgogICAqIEByZXR1cm4gez9vYmplY3R9IEEgU3ludGhldGljQ29tcG9zaXRpb25FdmVudC4KICAgKi8KCiAgZnVuY3Rpb24gZXh0cmFjdENvbXBvc2l0aW9uRXZlbnQoZGlzcGF0Y2hRdWV1ZSwgZG9tRXZlbnROYW1lLCB0YXJnZXRJbnN0LCBuYXRpdmVFdmVudCwgbmF0aXZlRXZlbnRUYXJnZXQpIHsKICAgIHZhciBldmVudFR5cGU7CiAgICB2YXIgZmFsbGJhY2tEYXRhOwoKICAgIGlmIChjYW5Vc2VDb21wb3NpdGlvbkV2ZW50KSB7CiAgICAgIGV2ZW50VHlwZSA9IGdldENvbXBvc2l0aW9uRXZlbnRUeXBlKGRvbUV2ZW50TmFtZSk7CiAgICB9IGVsc2UgaWYgKCFpc0NvbXBvc2luZykgewogICAgICBpZiAoaXNGYWxsYmFja0NvbXBvc2l0aW9uU3RhcnQoZG9tRXZlbnROYW1lLCBuYXRpdmVFdmVudCkpIHsKICAgICAgICBldmVudFR5cGUgPSAnb25Db21wb3NpdGlvblN0YXJ0JzsKICAgICAgfQogICAgfSBlbHNlIGlmIChpc0ZhbGxiYWNrQ29tcG9zaXRpb25FbmQoZG9tRXZlbnROYW1lLCBuYXRpdmVFdmVudCkpIHsKICAgICAgZXZlbnRUeXBlID0gJ29uQ29tcG9zaXRpb25FbmQnOwogICAgfQoKICAgIGlmICghZXZlbnRUeXBlKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIGlmICh1c2VGYWxsYmFja0NvbXBvc2l0aW9uRGF0YSAmJiAhaXNVc2luZ0tvcmVhbklNRShuYXRpdmVFdmVudCkpIHsKICAgICAgLy8gVGhlIGN1cnJlbnQgY29tcG9zaXRpb24gaXMgc3RvcmVkIHN0YXRpY2FsbHkgYW5kIG11c3Qgbm90IGJlCiAgICAgIC8vIG92ZXJ3cml0dGVuIHdoaWxlIGNvbXBvc2l0aW9uIGNvbnRpbnVlcy4KICAgICAgaWYgKCFpc0NvbXBvc2luZyAmJiBldmVudFR5cGUgPT09ICdvbkNvbXBvc2l0aW9uU3RhcnQnKSB7CiAgICAgICAgaXNDb21wb3NpbmcgPSBpbml0aWFsaXplKG5hdGl2ZUV2ZW50VGFyZ2V0KTsKICAgICAgfSBlbHNlIGlmIChldmVudFR5cGUgPT09ICdvbkNvbXBvc2l0aW9uRW5kJykgewogICAgICAgIGlmIChpc0NvbXBvc2luZykgewogICAgICAgICAgZmFsbGJhY2tEYXRhID0gZ2V0RGF0YSgpOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHZhciBsaXN0ZW5lcnMgPSBhY2N1bXVsYXRlVHdvUGhhc2VMaXN0ZW5lcnModGFyZ2V0SW5zdCwgZXZlbnRUeXBlKTsKCiAgICBpZiAobGlzdGVuZXJzLmxlbmd0aCA+IDApIHsKICAgICAgdmFyIGV2ZW50ID0gbmV3IFN5bnRoZXRpY0NvbXBvc2l0aW9uRXZlbnQoZXZlbnRUeXBlLCBkb21FdmVudE5hbWUsIG51bGwsIG5hdGl2ZUV2ZW50LCBuYXRpdmVFdmVudFRhcmdldCk7CiAgICAgIGRpc3BhdGNoUXVldWUucHVzaCh7CiAgICAgICAgZXZlbnQ6IGV2ZW50LAogICAgICAgIGxpc3RlbmVyczogbGlzdGVuZXJzCiAgICAgIH0pOwoKICAgICAgaWYgKGZhbGxiYWNrRGF0YSkgewogICAgICAgIC8vIEluamVjdCBkYXRhIGdlbmVyYXRlZCBmcm9tIGZhbGxiYWNrIHBhdGggaW50byB0aGUgc3ludGhldGljIGV2ZW50LgogICAgICAgIC8vIFRoaXMgbWF0Y2hlcyB0aGUgcHJvcGVydHkgb2YgbmF0aXZlIENvbXBvc2l0aW9uRXZlbnRJbnRlcmZhY2UuCiAgICAgICAgZXZlbnQuZGF0YSA9IGZhbGxiYWNrRGF0YTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgY3VzdG9tRGF0YSA9IGdldERhdGFGcm9tQ3VzdG9tRXZlbnQobmF0aXZlRXZlbnQpOwoKICAgICAgICBpZiAoY3VzdG9tRGF0YSAhPT0gbnVsbCkgewogICAgICAgICAgZXZlbnQuZGF0YSA9IGN1c3RvbURhdGE7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiBnZXROYXRpdmVCZWZvcmVJbnB1dENoYXJzKGRvbUV2ZW50TmFtZSwgbmF0aXZlRXZlbnQpIHsKICAgIHN3aXRjaCAoZG9tRXZlbnROYW1lKSB7CiAgICAgIGNhc2UgJ2NvbXBvc2l0aW9uZW5kJzoKICAgICAgICByZXR1cm4gZ2V0RGF0YUZyb21DdXN0b21FdmVudChuYXRpdmVFdmVudCk7CgogICAgICBjYXNlICdrZXlwcmVzcyc6CiAgICAgICAgLyoqCiAgICAgICAgICogSWYgbmF0aXZlIGB0ZXh0SW5wdXRgIGV2ZW50cyBhcmUgYXZhaWxhYmxlLCBvdXIgZ29hbCBpcyB0byBtYWtlCiAgICAgICAgICogdXNlIG9mIHRoZW0uIEhvd2V2ZXIsIHRoZXJlIGlzIGEgc3BlY2lhbCBjYXNlOiB0aGUgc3BhY2ViYXIga2V5LgogICAgICAgICAqIEluIFdlYmtpdCwgcHJldmVudGluZyBkZWZhdWx0IG9uIGEgc3BhY2ViYXIgYHRleHRJbnB1dGAgZXZlbnQKICAgICAgICAgKiBjYW5jZWxzIGNoYXJhY3RlciBpbnNlcnRpb24sIGJ1dCBpdCAqYWxzbyogY2F1c2VzIHRoZSBicm93c2VyCiAgICAgICAgICogdG8gZmFsbCBiYWNrIHRvIGl0cyBkZWZhdWx0IHNwYWNlYmFyIGJlaGF2aW9yIG9mIHNjcm9sbGluZyB0aGUKICAgICAgICAgKiBwYWdlLgogICAgICAgICAqCiAgICAgICAgICogVHJhY2tpbmcgYXQ6CiAgICAgICAgICogaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC9jaHJvbWl1bS9pc3N1ZXMvZGV0YWlsP2lkPTM1NTEwMwogICAgICAgICAqCiAgICAgICAgICogVG8gYXZvaWQgdGhpcyBpc3N1ZSwgdXNlIHRoZSBrZXlwcmVzcyBldmVudCBhcyBpZiBubyBgdGV4dElucHV0YAogICAgICAgICAqIGV2ZW50IGlzIGF2YWlsYWJsZS4KICAgICAgICAgKi8KICAgICAgICB2YXIgd2hpY2ggPSBuYXRpdmVFdmVudC53aGljaDsKCiAgICAgICAgaWYgKHdoaWNoICE9PSBTUEFDRUJBUl9DT0RFKSB7CiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CgogICAgICAgIGhhc1NwYWNlS2V5cHJlc3MgPSB0cnVlOwogICAgICAgIHJldHVybiBTUEFDRUJBUl9DSEFSOwoKICAgICAgY2FzZSAndGV4dElucHV0JzoKICAgICAgICAvLyBSZWNvcmQgdGhlIGNoYXJhY3RlcnMgdG8gYmUgYWRkZWQgdG8gdGhlIERPTS4KICAgICAgICB2YXIgY2hhcnMgPSBuYXRpdmVFdmVudC5kYXRhOyAvLyBJZiBpdCdzIGEgc3BhY2ViYXIgY2hhcmFjdGVyLCBhc3N1bWUgdGhhdCB3ZSBoYXZlIGFscmVhZHkgaGFuZGxlZAogICAgICAgIC8vIGl0IGF0IHRoZSBrZXlwcmVzcyBsZXZlbCBhbmQgYmFpbCBpbW1lZGlhdGVseS4gQW5kcm9pZCBDaHJvbWUKICAgICAgICAvLyBkb2Vzbid0IGdpdmUgdXMga2V5Y29kZXMsIHNvIHdlIG5lZWQgdG8gaWdub3JlIGl0LgoKICAgICAgICBpZiAoY2hhcnMgPT09IFNQQUNFQkFSX0NIQVIgJiYgaGFzU3BhY2VLZXlwcmVzcykgewogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gY2hhcnM7CgogICAgICBkZWZhdWx0OgogICAgICAgIC8vIEZvciBvdGhlciBuYXRpdmUgZXZlbnQgdHlwZXMsIGRvIG5vdGhpbmcuCiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgfQogIC8qKgogICAqIEZvciBicm93c2VycyB0aGF0IGRvIG5vdCBwcm92aWRlIHRoZSBgdGV4dElucHV0YCBldmVudCwgZXh0cmFjdCB0aGUKICAgKiBhcHByb3ByaWF0ZSBzdHJpbmcgdG8gdXNlIGZvciBTeW50aGV0aWNJbnB1dEV2ZW50LgogICAqLwoKCiAgZnVuY3Rpb24gZ2V0RmFsbGJhY2tCZWZvcmVJbnB1dENoYXJzKGRvbUV2ZW50TmFtZSwgbmF0aXZlRXZlbnQpIHsKICAgIC8vIElmIHdlIGFyZSBjdXJyZW50bHkgY29tcG9zaW5nIChJTUUpIGFuZCB1c2luZyBhIGZhbGxiYWNrIHRvIGRvIHNvLAogICAgLy8gdHJ5IHRvIGV4dHJhY3QgdGhlIGNvbXBvc2VkIGNoYXJhY3RlcnMgZnJvbSB0aGUgZmFsbGJhY2sgb2JqZWN0LgogICAgLy8gSWYgY29tcG9zaXRpb24gZXZlbnQgaXMgYXZhaWxhYmxlLCB3ZSBleHRyYWN0IGEgc3RyaW5nIG9ubHkgYXQKICAgIC8vIGNvbXBvc2l0aW9uZXZlbnQsIG90aGVyd2lzZSBleHRyYWN0IGl0IGF0IGZhbGxiYWNrIGV2ZW50cy4KICAgIGlmIChpc0NvbXBvc2luZykgewogICAgICBpZiAoZG9tRXZlbnROYW1lID09PSAnY29tcG9zaXRpb25lbmQnIHx8ICFjYW5Vc2VDb21wb3NpdGlvbkV2ZW50ICYmIGlzRmFsbGJhY2tDb21wb3NpdGlvbkVuZChkb21FdmVudE5hbWUsIG5hdGl2ZUV2ZW50KSkgewogICAgICAgIHZhciBjaGFycyA9IGdldERhdGEoKTsKICAgICAgICByZXNldCgpOwogICAgICAgIGlzQ29tcG9zaW5nID0gZmFsc2U7CiAgICAgICAgcmV0dXJuIGNoYXJzOwogICAgICB9CgogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBzd2l0Y2ggKGRvbUV2ZW50TmFtZSkgewogICAgICBjYXNlICdwYXN0ZSc6CiAgICAgICAgLy8gSWYgYSBwYXN0ZSBldmVudCBvY2N1cnMgYWZ0ZXIgYSBrZXlwcmVzcywgdGhyb3cgb3V0IHRoZSBpbnB1dAogICAgICAgIC8vIGNoYXJzLiBQYXN0ZSBldmVudHMgc2hvdWxkIG5vdCBsZWFkIHRvIEJlZm9yZUlucHV0IGV2ZW50cy4KICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgIGNhc2UgJ2tleXByZXNzJzoKICAgICAgICAvKioKICAgICAgICAgKiBBcyBvZiB2MjcsIEZpcmVmb3ggbWF5IGZpcmUga2V5cHJlc3MgZXZlbnRzIGV2ZW4gd2hlbiBubyBjaGFyYWN0ZXIKICAgICAgICAgKiB3aWxsIGJlIGluc2VydGVkLiBBIGZldyBwb3NzaWJpbGl0aWVzOgogICAgICAgICAqCiAgICAgICAgICogLSBgd2hpY2hgIGlzIGAwYC4gQXJyb3cga2V5cywgRXNjIGtleSwgZXRjLgogICAgICAgICAqCiAgICAgICAgICogLSBgd2hpY2hgIGlzIHRoZSBwcmVzc2VkIGtleSBjb2RlLCBidXQgbm8gY2hhciBpcyBhdmFpbGFibGUuCiAgICAgICAgICogICBFeDogJ0FsdEdyICsgZGAgaW4gUG9saXNoLiBUaGVyZSBpcyBubyBtb2RpZmllZCBjaGFyYWN0ZXIgZm9yCiAgICAgICAgICogICB0aGlzIGtleSBjb21iaW5hdGlvbiBhbmQgbm8gY2hhcmFjdGVyIGlzIGluc2VydGVkIGludG8gdGhlCiAgICAgICAgICogICBkb2N1bWVudCwgYnV0IEZGIGZpcmVzIHRoZSBrZXlwcmVzcyBmb3IgY2hhciBjb2RlIGAxMDBgIGFueXdheS4KICAgICAgICAgKiAgIE5vIGBpbnB1dGAgZXZlbnQgd2lsbCBvY2N1ci4KICAgICAgICAgKgogICAgICAgICAqIC0gYHdoaWNoYCBpcyB0aGUgcHJlc3NlZCBrZXkgY29kZSwgYnV0IGEgY29tbWFuZCBjb21iaW5hdGlvbiBpcwogICAgICAgICAqICAgYmVpbmcgdXNlZC4gRXg6IGBDbWQrQ2AuIE5vIGNoYXJhY3RlciBpcyBpbnNlcnRlZCwgYW5kIG5vCiAgICAgICAgICogICBgaW5wdXRgIGV2ZW50IHdpbGwgb2NjdXIuCiAgICAgICAgICovCiAgICAgICAgaWYgKCFpc0tleXByZXNzQ29tbWFuZChuYXRpdmVFdmVudCkpIHsKICAgICAgICAgIC8vIElFIGZpcmVzIHRoZSBga2V5cHJlc3NgIGV2ZW50IHdoZW4gYSB1c2VyIHR5cGVzIGFuIGVtb2ppIHZpYQogICAgICAgICAgLy8gVG91Y2gga2V5Ym9hcmQgb2YgV2luZG93cy4gIEluIHN1Y2ggYSBjYXNlLCB0aGUgYGNoYXJgIHByb3BlcnR5CiAgICAgICAgICAvLyBob2xkcyBhbiBlbW9qaSBjaGFyYWN0ZXIgbGlrZSBgXHVEODNEXHVERTBBYC4gIEJlY2F1c2UgaXRzIGxlbmd0aAogICAgICAgICAgLy8gaXMgMiwgdGhlIHByb3BlcnR5IGB3aGljaGAgZG9lcyBub3QgcmVwcmVzZW50IGFuIGVtb2ppIGNvcnJlY3RseS4KICAgICAgICAgIC8vIEluIHN1Y2ggYSBjYXNlLCB3ZSBkaXJlY3RseSByZXR1cm4gdGhlIGBjaGFyYCBwcm9wZXJ0eSBpbnN0ZWFkIG9mCiAgICAgICAgICAvLyB1c2luZyBgd2hpY2hgLgogICAgICAgICAgaWYgKG5hdGl2ZUV2ZW50LmNoYXIgJiYgbmF0aXZlRXZlbnQuY2hhci5sZW5ndGggPiAxKSB7CiAgICAgICAgICAgIHJldHVybiBuYXRpdmVFdmVudC5jaGFyOwogICAgICAgICAgfSBlbHNlIGlmIChuYXRpdmVFdmVudC53aGljaCkgewogICAgICAgICAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZShuYXRpdmVFdmVudC53aGljaCk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgIGNhc2UgJ2NvbXBvc2l0aW9uZW5kJzoKICAgICAgICByZXR1cm4gdXNlRmFsbGJhY2tDb21wb3NpdGlvbkRhdGEgJiYgIWlzVXNpbmdLb3JlYW5JTUUobmF0aXZlRXZlbnQpID8gbnVsbCA6IG5hdGl2ZUV2ZW50LmRhdGE7CgogICAgICBkZWZhdWx0OgogICAgICAgIHJldHVybiBudWxsOwogICAgfQogIH0KICAvKioKICAgKiBFeHRyYWN0IGEgU3ludGhldGljSW5wdXRFdmVudCBmb3IgYGJlZm9yZUlucHV0YCwgYmFzZWQgb24gZWl0aGVyIG5hdGl2ZQogICAqIGB0ZXh0SW5wdXRgIG9yIGZhbGxiYWNrIGJlaGF2aW9yLgogICAqCiAgICogQHJldHVybiB7P29iamVjdH0gQSBTeW50aGV0aWNJbnB1dEV2ZW50LgogICAqLwoKCiAgZnVuY3Rpb24gZXh0cmFjdEJlZm9yZUlucHV0RXZlbnQoZGlzcGF0Y2hRdWV1ZSwgZG9tRXZlbnROYW1lLCB0YXJnZXRJbnN0LCBuYXRpdmVFdmVudCwgbmF0aXZlRXZlbnRUYXJnZXQpIHsKICAgIHZhciBjaGFyczsKCiAgICBpZiAoY2FuVXNlVGV4dElucHV0RXZlbnQpIHsKICAgICAgY2hhcnMgPSBnZXROYXRpdmVCZWZvcmVJbnB1dENoYXJzKGRvbUV2ZW50TmFtZSwgbmF0aXZlRXZlbnQpOwogICAgfSBlbHNlIHsKICAgICAgY2hhcnMgPSBnZXRGYWxsYmFja0JlZm9yZUlucHV0Q2hhcnMoZG9tRXZlbnROYW1lLCBuYXRpdmVFdmVudCk7CiAgICB9IC8vIElmIG5vIGNoYXJhY3RlcnMgYXJlIGJlaW5nIGluc2VydGVkLCBubyBCZWZvcmVJbnB1dCBldmVudCBzaG91bGQKICAgIC8vIGJlIGZpcmVkLgoKCiAgICBpZiAoIWNoYXJzKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIHZhciBsaXN0ZW5lcnMgPSBhY2N1bXVsYXRlVHdvUGhhc2VMaXN0ZW5lcnModGFyZ2V0SW5zdCwgJ29uQmVmb3JlSW5wdXQnKTsKCiAgICBpZiAobGlzdGVuZXJzLmxlbmd0aCA+IDApIHsKICAgICAgdmFyIGV2ZW50ID0gbmV3IFN5bnRoZXRpY0lucHV0RXZlbnQoJ29uQmVmb3JlSW5wdXQnLCAnYmVmb3JlaW5wdXQnLCBudWxsLCBuYXRpdmVFdmVudCwgbmF0aXZlRXZlbnRUYXJnZXQpOwogICAgICBkaXNwYXRjaFF1ZXVlLnB1c2goewogICAgICAgIGV2ZW50OiBldmVudCwKICAgICAgICBsaXN0ZW5lcnM6IGxpc3RlbmVycwogICAgICB9KTsKICAgICAgZXZlbnQuZGF0YSA9IGNoYXJzOwogICAgfQogIH0KICAvKioKICAgKiBDcmVhdGUgYW4gYG9uQmVmb3JlSW5wdXRgIGV2ZW50IHRvIG1hdGNoCiAgICogaHR0cDovL3d3dy53My5vcmcvVFIvMjAxMy9XRC1ET00tTGV2ZWwtMy1FdmVudHMtMjAxMzExMDUvI2V2ZW50cy1pbnB1dGV2ZW50cy4KICAgKgogICAqIFRoaXMgZXZlbnQgcGx1Z2luIGlzIGJhc2VkIG9uIHRoZSBuYXRpdmUgYHRleHRJbnB1dGAgZXZlbnQKICAgKiBhdmFpbGFibGUgaW4gQ2hyb21lLCBTYWZhcmksIE9wZXJhLCBhbmQgSUUuIFRoaXMgZXZlbnQgZmlyZXMgYWZ0ZXIKICAgKiBgb25LZXlQcmVzc2AgYW5kIGBvbkNvbXBvc2l0aW9uRW5kYCwgYnV0IGJlZm9yZSBgb25JbnB1dGAuCiAgICoKICAgKiBgYmVmb3JlSW5wdXRgIGlzIHNwZWMnZCBidXQgbm90IGltcGxlbWVudGVkIGluIGFueSBicm93c2VycywgYW5kCiAgICogdGhlIGBpbnB1dGAgZXZlbnQgZG9lcyBub3QgcHJvdmlkZSBhbnkgdXNlZnVsIGluZm9ybWF0aW9uIGFib3V0IHdoYXQgaGFzCiAgICogYWN0dWFsbHkgYmVlbiBhZGRlZCwgY29udHJhcnkgdG8gdGhlIHNwZWMuIFRodXMsIGB0ZXh0SW5wdXRgIGlzIHRoZSBiZXN0CiAgICogYXZhaWxhYmxlIGV2ZW50IHRvIGlkZW50aWZ5IHRoZSBjaGFyYWN0ZXJzIHRoYXQgaGF2ZSBhY3R1YWxseSBiZWVuIGluc2VydGVkCiAgICogaW50byB0aGUgdGFyZ2V0IG5vZGUuCiAgICoKICAgKiBUaGlzIHBsdWdpbiBpcyBhbHNvIHJlc3BvbnNpYmxlIGZvciBlbWl0dGluZyBgY29tcG9zaXRpb25gIGV2ZW50cywgdGh1cwogICAqIGFsbG93aW5nIHVzIHRvIHNoYXJlIGNvbXBvc2l0aW9uIGZhbGxiYWNrIGNvZGUgZm9yIGJvdGggYGJlZm9yZUlucHV0YCBhbmQKICAgKiBgY29tcG9zaXRpb25gIGV2ZW50IHR5cGVzLgogICAqLwoKCiAgZnVuY3Rpb24gZXh0cmFjdEV2ZW50cyhkaXNwYXRjaFF1ZXVlLCBkb21FdmVudE5hbWUsIHRhcmdldEluc3QsIG5hdGl2ZUV2ZW50LCBuYXRpdmVFdmVudFRhcmdldCwgZXZlbnRTeXN0ZW1GbGFncywgdGFyZ2V0Q29udGFpbmVyKSB7CiAgICBleHRyYWN0Q29tcG9zaXRpb25FdmVudChkaXNwYXRjaFF1ZXVlLCBkb21FdmVudE5hbWUsIHRhcmdldEluc3QsIG5hdGl2ZUV2ZW50LCBuYXRpdmVFdmVudFRhcmdldCk7CiAgICBleHRyYWN0QmVmb3JlSW5wdXRFdmVudChkaXNwYXRjaFF1ZXVlLCBkb21FdmVudE5hbWUsIHRhcmdldEluc3QsIG5hdGl2ZUV2ZW50LCBuYXRpdmVFdmVudFRhcmdldCk7CiAgfQoKICAvKioKICAgKiBAc2VlIGh0dHA6Ly93d3cud2hhdHdnLm9yZy9zcGVjcy93ZWItYXBwcy9jdXJyZW50LXdvcmsvbXVsdGlwYWdlL3RoZS1pbnB1dC1lbGVtZW50Lmh0bWwjaW5wdXQtdHlwZS1hdHRyLXN1bW1hcnkKICAgKi8KICB2YXIgc3VwcG9ydGVkSW5wdXRUeXBlcyA9IHsKICAgIGNvbG9yOiB0cnVlLAogICAgZGF0ZTogdHJ1ZSwKICAgIGRhdGV0aW1lOiB0cnVlLAogICAgJ2RhdGV0aW1lLWxvY2FsJzogdHJ1ZSwKICAgIGVtYWlsOiB0cnVlLAogICAgbW9udGg6IHRydWUsCiAgICBudW1iZXI6IHRydWUsCiAgICBwYXNzd29yZDogdHJ1ZSwKICAgIHJhbmdlOiB0cnVlLAogICAgc2VhcmNoOiB0cnVlLAogICAgdGVsOiB0cnVlLAogICAgdGV4dDogdHJ1ZSwKICAgIHRpbWU6IHRydWUsCiAgICB1cmw6IHRydWUsCiAgICB3ZWVrOiB0cnVlCiAgfTsKCiAgZnVuY3Rpb24gaXNUZXh0SW5wdXRFbGVtZW50KGVsZW0pIHsKICAgIHZhciBub2RlTmFtZSA9IGVsZW0gJiYgZWxlbS5ub2RlTmFtZSAmJiBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7CgogICAgaWYgKG5vZGVOYW1lID09PSAnaW5wdXQnKSB7CiAgICAgIHJldHVybiAhIXN1cHBvcnRlZElucHV0VHlwZXNbZWxlbS50eXBlXTsKICAgIH0KCiAgICBpZiAobm9kZU5hbWUgPT09ICd0ZXh0YXJlYScpIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgLyoqCiAgICogQ2hlY2tzIGlmIGFuIGV2ZW50IGlzIHN1cHBvcnRlZCBpbiB0aGUgY3VycmVudCBleGVjdXRpb24gZW52aXJvbm1lbnQuCiAgICoKICAgKiBOT1RFOiBUaGlzIHdpbGwgbm90IHdvcmsgY29ycmVjdGx5IGZvciBub24tZ2VuZXJpYyBldmVudHMgc3VjaCBhcyBgY2hhbmdlYCwKICAgKiBgcmVzZXRgLCBgbG9hZGAsIGBlcnJvcmAsIGFuZCBgc2VsZWN0YC4KICAgKgogICAqIEJvcnJvd3MgZnJvbSBNb2Rlcm5penIuCiAgICoKICAgKiBAcGFyYW0ge3N0cmluZ30gZXZlbnROYW1lU3VmZml4IEV2ZW50IG5hbWUsIGUuZy4gImNsaWNrIi4KICAgKiBAcmV0dXJuIHtib29sZWFufSBUcnVlIGlmIHRoZSBldmVudCBpcyBzdXBwb3J0ZWQuCiAgICogQGludGVybmFsCiAgICogQGxpY2Vuc2UgTW9kZXJuaXpyIDMuMC4wcHJlIChDdXN0b20gQnVpbGQpIHwgTUlUCiAgICovCgogIGZ1bmN0aW9uIGlzRXZlbnRTdXBwb3J0ZWQoZXZlbnROYW1lU3VmZml4KSB7CiAgICBpZiAoIWNhblVzZURPTSkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgdmFyIGV2ZW50TmFtZSA9ICdvbicgKyBldmVudE5hbWVTdWZmaXg7CiAgICB2YXIgaXNTdXBwb3J0ZWQgPSAoZXZlbnROYW1lIGluIGRvY3VtZW50KTsKCiAgICBpZiAoIWlzU3VwcG9ydGVkKSB7CiAgICAgIHZhciBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKGV2ZW50TmFtZSwgJ3JldHVybjsnKTsKICAgICAgaXNTdXBwb3J0ZWQgPSB0eXBlb2YgZWxlbWVudFtldmVudE5hbWVdID09PSAnZnVuY3Rpb24nOwogICAgfQoKICAgIHJldHVybiBpc1N1cHBvcnRlZDsKICB9CgogIGZ1bmN0aW9uIHJlZ2lzdGVyRXZlbnRzJDEoKSB7CiAgICByZWdpc3RlclR3b1BoYXNlRXZlbnQoJ29uQ2hhbmdlJywgWydjaGFuZ2UnLCAnY2xpY2snLCAnZm9jdXNpbicsICdmb2N1c291dCcsICdpbnB1dCcsICdrZXlkb3duJywgJ2tleXVwJywgJ3NlbGVjdGlvbmNoYW5nZSddKTsKICB9CgogIGZ1bmN0aW9uIGNyZWF0ZUFuZEFjY3VtdWxhdGVDaGFuZ2VFdmVudChkaXNwYXRjaFF1ZXVlLCBpbnN0LCBuYXRpdmVFdmVudCwgdGFyZ2V0KSB7CiAgICAvLyBGbGFnIHRoaXMgZXZlbnQgbG9vcCBhcyBuZWVkaW5nIHN0YXRlIHJlc3RvcmUuCiAgICBlbnF1ZXVlU3RhdGVSZXN0b3JlKHRhcmdldCk7CiAgICB2YXIgbGlzdGVuZXJzID0gYWNjdW11bGF0ZVR3b1BoYXNlTGlzdGVuZXJzKGluc3QsICdvbkNoYW5nZScpOwoKICAgIGlmIChsaXN0ZW5lcnMubGVuZ3RoID4gMCkgewogICAgICB2YXIgZXZlbnQgPSBuZXcgU3ludGhldGljRXZlbnQoJ29uQ2hhbmdlJywgJ2NoYW5nZScsIG51bGwsIG5hdGl2ZUV2ZW50LCB0YXJnZXQpOwogICAgICBkaXNwYXRjaFF1ZXVlLnB1c2goewogICAgICAgIGV2ZW50OiBldmVudCwKICAgICAgICBsaXN0ZW5lcnM6IGxpc3RlbmVycwogICAgICB9KTsKICAgIH0KICB9CiAgLyoqCiAgICogRm9yIElFIHNoaW1zCiAgICovCgoKICB2YXIgYWN0aXZlRWxlbWVudCA9IG51bGw7CiAgdmFyIGFjdGl2ZUVsZW1lbnRJbnN0ID0gbnVsbDsKICAvKioKICAgKiBTRUNUSU9OOiBoYW5kbGUgYGNoYW5nZWAgZXZlbnQKICAgKi8KCiAgZnVuY3Rpb24gc2hvdWxkVXNlQ2hhbmdlRXZlbnQoZWxlbSkgewogICAgdmFyIG5vZGVOYW1lID0gZWxlbS5ub2RlTmFtZSAmJiBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7CiAgICByZXR1cm4gbm9kZU5hbWUgPT09ICdzZWxlY3QnIHx8IG5vZGVOYW1lID09PSAnaW5wdXQnICYmIGVsZW0udHlwZSA9PT0gJ2ZpbGUnOwogIH0KCiAgZnVuY3Rpb24gbWFudWFsRGlzcGF0Y2hDaGFuZ2VFdmVudChuYXRpdmVFdmVudCkgewogICAgdmFyIGRpc3BhdGNoUXVldWUgPSBbXTsKICAgIGNyZWF0ZUFuZEFjY3VtdWxhdGVDaGFuZ2VFdmVudChkaXNwYXRjaFF1ZXVlLCBhY3RpdmVFbGVtZW50SW5zdCwgbmF0aXZlRXZlbnQsIGdldEV2ZW50VGFyZ2V0KG5hdGl2ZUV2ZW50KSk7IC8vIElmIGNoYW5nZSBhbmQgcHJvcGVydHljaGFuZ2UgYnViYmxlZCwgd2UnZCBqdXN0IGJpbmQgdG8gaXQgbGlrZSBhbGwgdGhlCiAgICAvLyBvdGhlciBldmVudHMgYW5kIGhhdmUgaXQgZ28gdGhyb3VnaCBSZWFjdEJyb3dzZXJFdmVudEVtaXR0ZXIuIFNpbmNlIGl0CiAgICAvLyBkb2Vzbid0LCB3ZSBtYW51YWxseSBsaXN0ZW4gZm9yIHRoZSBldmVudHMgYW5kIHNvIHdlIGhhdmUgdG8gZW5xdWV1ZSBhbmQKICAgIC8vIHByb2Nlc3MgdGhlIGFic3RyYWN0IGV2ZW50IG1hbnVhbGx5LgogICAgLy8KICAgIC8vIEJhdGNoaW5nIGlzIG5lY2Vzc2FyeSBoZXJlIGluIG9yZGVyIHRvIGVuc3VyZSB0aGF0IGFsbCBldmVudCBoYW5kbGVycyBydW4KICAgIC8vIGJlZm9yZSB0aGUgbmV4dCByZXJlbmRlciAoaW5jbHVkaW5nIGV2ZW50IGhhbmRsZXJzIGF0dGFjaGVkIHRvIGFuY2VzdG9yCiAgICAvLyBlbGVtZW50cyBpbnN0ZWFkIG9mIGRpcmVjdGx5IG9uIHRoZSBpbnB1dCkuIFdpdGhvdXQgdGhpcywgY29udHJvbGxlZAogICAgLy8gY29tcG9uZW50cyBkb24ndCB3b3JrIHByb3Blcmx5IGluIGNvbmp1bmN0aW9uIHdpdGggZXZlbnQgYnViYmxpbmcgYmVjYXVzZQogICAgLy8gdGhlIGNvbXBvbmVudCBpcyByZXJlbmRlcmVkIGFuZCB0aGUgdmFsdWUgcmV2ZXJ0ZWQgYmVmb3JlIGFsbCB0aGUgZXZlbnQKICAgIC8vIGhhbmRsZXJzIGNhbiBydW4uIFNlZSBodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2svcmVhY3QvaXNzdWVzLzcwOC4KCiAgICBiYXRjaGVkVXBkYXRlcyhydW5FdmVudEluQmF0Y2gsIGRpc3BhdGNoUXVldWUpOwogIH0KCiAgZnVuY3Rpb24gcnVuRXZlbnRJbkJhdGNoKGRpc3BhdGNoUXVldWUpIHsKICAgIHByb2Nlc3NEaXNwYXRjaFF1ZXVlKGRpc3BhdGNoUXVldWUsIDApOwogIH0KCiAgZnVuY3Rpb24gZ2V0SW5zdElmVmFsdWVDaGFuZ2VkKHRhcmdldEluc3QpIHsKICAgIHZhciB0YXJnZXROb2RlID0gZ2V0Tm9kZUZyb21JbnN0YW5jZSh0YXJnZXRJbnN0KTsKCiAgICBpZiAodXBkYXRlVmFsdWVJZkNoYW5nZWQodGFyZ2V0Tm9kZSkpIHsKICAgICAgcmV0dXJuIHRhcmdldEluc3Q7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBnZXRUYXJnZXRJbnN0Rm9yQ2hhbmdlRXZlbnQoZG9tRXZlbnROYW1lLCB0YXJnZXRJbnN0KSB7CiAgICBpZiAoZG9tRXZlbnROYW1lID09PSAnY2hhbmdlJykgewogICAgICByZXR1cm4gdGFyZ2V0SW5zdDsKICAgIH0KICB9CiAgLyoqCiAgICogU0VDVElPTjogaGFuZGxlIGBpbnB1dGAgZXZlbnQKICAgKi8KCgogIHZhciBpc0lucHV0RXZlbnRTdXBwb3J0ZWQgPSBmYWxzZTsKCiAgaWYgKGNhblVzZURPTSkgewogICAgLy8gSUU5IGNsYWltcyB0byBzdXBwb3J0IHRoZSBpbnB1dCBldmVudCBidXQgZmFpbHMgdG8gdHJpZ2dlciBpdCB3aGVuCiAgICAvLyBkZWxldGluZyB0ZXh0LCBzbyB3ZSBpZ25vcmUgaXRzIGlucHV0IGV2ZW50cy4KICAgIGlzSW5wdXRFdmVudFN1cHBvcnRlZCA9IGlzRXZlbnRTdXBwb3J0ZWQoJ2lucHV0JykgJiYgKCFkb2N1bWVudC5kb2N1bWVudE1vZGUgfHwgZG9jdW1lbnQuZG9jdW1lbnRNb2RlID4gOSk7CiAgfQogIC8qKgogICAqIChGb3IgSUUgPD05KSBTdGFydHMgdHJhY2tpbmcgcHJvcGVydHljaGFuZ2UgZXZlbnRzIG9uIHRoZSBwYXNzZWQtaW4gZWxlbWVudAogICAqIGFuZCBvdmVycmlkZSB0aGUgdmFsdWUgcHJvcGVydHkgc28gdGhhdCB3ZSBjYW4gZGlzdGluZ3Vpc2ggdXNlciBldmVudHMgZnJvbQogICAqIHZhbHVlIGNoYW5nZXMgaW4gSlMuCiAgICovCgoKICBmdW5jdGlvbiBzdGFydFdhdGNoaW5nRm9yVmFsdWVDaGFuZ2UodGFyZ2V0LCB0YXJnZXRJbnN0KSB7CiAgICBhY3RpdmVFbGVtZW50ID0gdGFyZ2V0OwogICAgYWN0aXZlRWxlbWVudEluc3QgPSB0YXJnZXRJbnN0OwogICAgYWN0aXZlRWxlbWVudC5hdHRhY2hFdmVudCgnb25wcm9wZXJ0eWNoYW5nZScsIGhhbmRsZVByb3BlcnR5Q2hhbmdlKTsKICB9CiAgLyoqCiAgICogKEZvciBJRSA8PTkpIFJlbW92ZXMgdGhlIGV2ZW50IGxpc3RlbmVycyBmcm9tIHRoZSBjdXJyZW50bHktdHJhY2tlZCBlbGVtZW50LAogICAqIGlmIGFueSBleGlzdHMuCiAgICovCgoKICBmdW5jdGlvbiBzdG9wV2F0Y2hpbmdGb3JWYWx1ZUNoYW5nZSgpIHsKICAgIGlmICghYWN0aXZlRWxlbWVudCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgYWN0aXZlRWxlbWVudC5kZXRhY2hFdmVudCgnb25wcm9wZXJ0eWNoYW5nZScsIGhhbmRsZVByb3BlcnR5Q2hhbmdlKTsKICAgIGFjdGl2ZUVsZW1lbnQgPSBudWxsOwogICAgYWN0aXZlRWxlbWVudEluc3QgPSBudWxsOwogIH0KICAvKioKICAgKiAoRm9yIElFIDw9OSkgSGFuZGxlcyBhIHByb3BlcnR5Y2hhbmdlIGV2ZW50LCBzZW5kaW5nIGEgYGNoYW5nZWAgZXZlbnQgaWYKICAgKiB0aGUgdmFsdWUgb2YgdGhlIGFjdGl2ZSBlbGVtZW50IGhhcyBjaGFuZ2VkLgogICAqLwoKCiAgZnVuY3Rpb24gaGFuZGxlUHJvcGVydHlDaGFuZ2UobmF0aXZlRXZlbnQpIHsKICAgIGlmIChuYXRpdmVFdmVudC5wcm9wZXJ0eU5hbWUgIT09ICd2YWx1ZScpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmIChnZXRJbnN0SWZWYWx1ZUNoYW5nZWQoYWN0aXZlRWxlbWVudEluc3QpKSB7CiAgICAgIG1hbnVhbERpc3BhdGNoQ2hhbmdlRXZlbnQobmF0aXZlRXZlbnQpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gaGFuZGxlRXZlbnRzRm9ySW5wdXRFdmVudFBvbHlmaWxsKGRvbUV2ZW50TmFtZSwgdGFyZ2V0LCB0YXJnZXRJbnN0KSB7CiAgICBpZiAoZG9tRXZlbnROYW1lID09PSAnZm9jdXNpbicpIHsKICAgICAgLy8gSW4gSUU5LCBwcm9wZXJ0eWNoYW5nZSBmaXJlcyBmb3IgbW9zdCBpbnB1dCBldmVudHMgYnV0IGlzIGJ1Z2d5IGFuZAogICAgICAvLyBkb2Vzbid0IGZpcmUgd2hlbiB0ZXh0IGlzIGRlbGV0ZWQsIGJ1dCBjb252ZW5pZW50bHksIHNlbGVjdGlvbmNoYW5nZQogICAgICAvLyBhcHBlYXJzIHRvIGZpcmUgaW4gYWxsIG9mIHRoZSByZW1haW5pbmcgY2FzZXMgc28gd2UgY2F0Y2ggdGhvc2UgYW5kCiAgICAgIC8vIGZvcndhcmQgdGhlIGV2ZW50IGlmIHRoZSB2YWx1ZSBoYXMgY2hhbmdlZAogICAgICAvLyBJbiBlaXRoZXIgY2FzZSwgd2UgZG9uJ3Qgd2FudCB0byBjYWxsIHRoZSBldmVudCBoYW5kbGVyIGlmIHRoZSB2YWx1ZQogICAgICAvLyBpcyBjaGFuZ2VkIGZyb20gSlMgc28gd2UgcmVkZWZpbmUgYSBzZXR0ZXIgZm9yIGAudmFsdWVgIHRoYXQgdXBkYXRlcwogICAgICAvLyBvdXIgYWN0aXZlRWxlbWVudFZhbHVlIHZhcmlhYmxlLCBhbGxvd2luZyB1cyB0byBpZ25vcmUgdGhvc2UgY2hhbmdlcwogICAgICAvLwogICAgICAvLyBzdG9wV2F0Y2hpbmcoKSBzaG91bGQgYmUgYSBub29wIGhlcmUgYnV0IHdlIGNhbGwgaXQganVzdCBpbiBjYXNlIHdlCiAgICAgIC8vIG1pc3NlZCBhIGJsdXIgZXZlbnQgc29tZWhvdy4KICAgICAgc3RvcFdhdGNoaW5nRm9yVmFsdWVDaGFuZ2UoKTsKICAgICAgc3RhcnRXYXRjaGluZ0ZvclZhbHVlQ2hhbmdlKHRhcmdldCwgdGFyZ2V0SW5zdCk7CiAgICB9IGVsc2UgaWYgKGRvbUV2ZW50TmFtZSA9PT0gJ2ZvY3Vzb3V0JykgewogICAgICBzdG9wV2F0Y2hpbmdGb3JWYWx1ZUNoYW5nZSgpOwogICAgfQogIH0gLy8gRm9yIElFOCBhbmQgSUU5LgoKCiAgZnVuY3Rpb24gZ2V0VGFyZ2V0SW5zdEZvcklucHV0RXZlbnRQb2x5ZmlsbChkb21FdmVudE5hbWUsIHRhcmdldEluc3QpIHsKICAgIGlmIChkb21FdmVudE5hbWUgPT09ICdzZWxlY3Rpb25jaGFuZ2UnIHx8IGRvbUV2ZW50TmFtZSA9PT0gJ2tleXVwJyB8fCBkb21FdmVudE5hbWUgPT09ICdrZXlkb3duJykgewogICAgICAvLyBPbiB0aGUgc2VsZWN0aW9uY2hhbmdlIGV2ZW50LCB0aGUgdGFyZ2V0IGlzIGp1c3QgZG9jdW1lbnQgd2hpY2ggaXNuJ3QKICAgICAgLy8gaGVscGZ1bCBmb3IgdXMgc28ganVzdCBjaGVjayBhY3RpdmVFbGVtZW50IGluc3RlYWQuCiAgICAgIC8vCiAgICAgIC8vIDk5JSBvZiB0aGUgdGltZSwga2V5ZG93biBhbmQga2V5dXAgYXJlbid0IG5lY2Vzc2FyeS4gSUU4IGZhaWxzIHRvIGZpcmUKICAgICAgLy8gcHJvcGVydHljaGFuZ2Ugb24gdGhlIGZpcnN0IGlucHV0IGV2ZW50IGFmdGVyIHNldHRpbmcgYHZhbHVlYCBmcm9tIGEKICAgICAgLy8gc2NyaXB0IGFuZCBmaXJlcyBvbmx5IGtleWRvd24sIGtleXByZXNzLCBrZXl1cC4gQ2F0Y2hpbmcga2V5dXAgdXN1YWxseQogICAgICAvLyBnZXRzIGl0IGFuZCBjYXRjaGluZyBrZXlkb3duIGxldHMgdXMgZmlyZSBhbiBldmVudCBmb3IgdGhlIGZpcnN0CiAgICAgIC8vIGtleXN0cm9rZSBpZiB1c2VyIGRvZXMgYSBrZXkgcmVwZWF0IChpdCdsbCBiZSBhIGxpdHRsZSBkZWxheWVkOiByaWdodAogICAgICAvLyBiZWZvcmUgdGhlIHNlY29uZCBrZXlzdHJva2UpLiBPdGhlciBpbnB1dCBtZXRob2RzIChlLmcuLCBwYXN0ZSkgc2VlbSB0bwogICAgICAvLyBmaXJlIHNlbGVjdGlvbmNoYW5nZSBub3JtYWxseS4KICAgICAgcmV0dXJuIGdldEluc3RJZlZhbHVlQ2hhbmdlZChhY3RpdmVFbGVtZW50SW5zdCk7CiAgICB9CiAgfQogIC8qKgogICAqIFNFQ1RJT046IGhhbmRsZSBgY2xpY2tgIGV2ZW50CiAgICovCgoKICBmdW5jdGlvbiBzaG91bGRVc2VDbGlja0V2ZW50KGVsZW0pIHsKICAgIC8vIFVzZSB0aGUgYGNsaWNrYCBldmVudCB0byBkZXRlY3QgY2hhbmdlcyB0byBjaGVja2JveCBhbmQgcmFkaW8gaW5wdXRzLgogICAgLy8gVGhpcyBhcHByb2FjaCB3b3JrcyBhY3Jvc3MgYWxsIGJyb3dzZXJzLCB3aGVyZWFzIGBjaGFuZ2VgIGRvZXMgbm90IGZpcmUKICAgIC8vIHVudGlsIGBibHVyYCBpbiBJRTguCiAgICB2YXIgbm9kZU5hbWUgPSBlbGVtLm5vZGVOYW1lOwogICAgcmV0dXJuIG5vZGVOYW1lICYmIG5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdpbnB1dCcgJiYgKGVsZW0udHlwZSA9PT0gJ2NoZWNrYm94JyB8fCBlbGVtLnR5cGUgPT09ICdyYWRpbycpOwogIH0KCiAgZnVuY3Rpb24gZ2V0VGFyZ2V0SW5zdEZvckNsaWNrRXZlbnQoZG9tRXZlbnROYW1lLCB0YXJnZXRJbnN0KSB7CiAgICBpZiAoZG9tRXZlbnROYW1lID09PSAnY2xpY2snKSB7CiAgICAgIHJldHVybiBnZXRJbnN0SWZWYWx1ZUNoYW5nZWQodGFyZ2V0SW5zdCk7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBnZXRUYXJnZXRJbnN0Rm9ySW5wdXRPckNoYW5nZUV2ZW50KGRvbUV2ZW50TmFtZSwgdGFyZ2V0SW5zdCkgewogICAgaWYgKGRvbUV2ZW50TmFtZSA9PT0gJ2lucHV0JyB8fCBkb21FdmVudE5hbWUgPT09ICdjaGFuZ2UnKSB7CiAgICAgIHJldHVybiBnZXRJbnN0SWZWYWx1ZUNoYW5nZWQodGFyZ2V0SW5zdCk7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBoYW5kbGVDb250cm9sbGVkSW5wdXRCbHVyKG5vZGUpIHsKICAgIHZhciBzdGF0ZSA9IG5vZGUuX3dyYXBwZXJTdGF0ZTsKCiAgICBpZiAoIXN0YXRlIHx8ICFzdGF0ZS5jb250cm9sbGVkIHx8IG5vZGUudHlwZSAhPT0gJ251bWJlcicpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHsKICAgICAgLy8gSWYgY29udHJvbGxlZCwgYXNzaWduIHRoZSB2YWx1ZSBhdHRyaWJ1dGUgdG8gdGhlIGN1cnJlbnQgdmFsdWUgb24gYmx1cgogICAgICBzZXREZWZhdWx0VmFsdWUobm9kZSwgJ251bWJlcicsIG5vZGUudmFsdWUpOwogICAgfQogIH0KICAvKioKICAgKiBUaGlzIHBsdWdpbiBjcmVhdGVzIGFuIGBvbkNoYW5nZWAgZXZlbnQgdGhhdCBub3JtYWxpemVzIGNoYW5nZSBldmVudHMKICAgKiBhY3Jvc3MgZm9ybSBlbGVtZW50cy4gVGhpcyBldmVudCBmaXJlcyBhdCBhIHRpbWUgd2hlbiBpdCdzIHBvc3NpYmxlIHRvCiAgICogY2hhbmdlIHRoZSBlbGVtZW50J3MgdmFsdWUgd2l0aG91dCBzZWVpbmcgYSBmbGlja2VyLgogICAqCiAgICogU3VwcG9ydGVkIGVsZW1lbnRzIGFyZToKICAgKiAtIGlucHV0IChzZWUgYGlzVGV4dElucHV0RWxlbWVudGApCiAgICogLSB0ZXh0YXJlYQogICAqIC0gc2VsZWN0CiAgICovCgoKICBmdW5jdGlvbiBleHRyYWN0RXZlbnRzJDEoZGlzcGF0Y2hRdWV1ZSwgZG9tRXZlbnROYW1lLCB0YXJnZXRJbnN0LCBuYXRpdmVFdmVudCwgbmF0aXZlRXZlbnRUYXJnZXQsIGV2ZW50U3lzdGVtRmxhZ3MsIHRhcmdldENvbnRhaW5lcikgewogICAgdmFyIHRhcmdldE5vZGUgPSB0YXJnZXRJbnN0ID8gZ2V0Tm9kZUZyb21JbnN0YW5jZSh0YXJnZXRJbnN0KSA6IHdpbmRvdzsKICAgIHZhciBnZXRUYXJnZXRJbnN0RnVuYywgaGFuZGxlRXZlbnRGdW5jOwoKICAgIGlmIChzaG91bGRVc2VDaGFuZ2VFdmVudCh0YXJnZXROb2RlKSkgewogICAgICBnZXRUYXJnZXRJbnN0RnVuYyA9IGdldFRhcmdldEluc3RGb3JDaGFuZ2VFdmVudDsKICAgIH0gZWxzZSBpZiAoaXNUZXh0SW5wdXRFbGVtZW50KHRhcmdldE5vZGUpKSB7CiAgICAgIGlmIChpc0lucHV0RXZlbnRTdXBwb3J0ZWQpIHsKICAgICAgICBnZXRUYXJnZXRJbnN0RnVuYyA9IGdldFRhcmdldEluc3RGb3JJbnB1dE9yQ2hhbmdlRXZlbnQ7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZ2V0VGFyZ2V0SW5zdEZ1bmMgPSBnZXRUYXJnZXRJbnN0Rm9ySW5wdXRFdmVudFBvbHlmaWxsOwogICAgICAgIGhhbmRsZUV2ZW50RnVuYyA9IGhhbmRsZUV2ZW50c0ZvcklucHV0RXZlbnRQb2x5ZmlsbDsKICAgICAgfQogICAgfSBlbHNlIGlmIChzaG91bGRVc2VDbGlja0V2ZW50KHRhcmdldE5vZGUpKSB7CiAgICAgIGdldFRhcmdldEluc3RGdW5jID0gZ2V0VGFyZ2V0SW5zdEZvckNsaWNrRXZlbnQ7CiAgICB9CgogICAgaWYgKGdldFRhcmdldEluc3RGdW5jKSB7CiAgICAgIHZhciBpbnN0ID0gZ2V0VGFyZ2V0SW5zdEZ1bmMoZG9tRXZlbnROYW1lLCB0YXJnZXRJbnN0KTsKCiAgICAgIGlmIChpbnN0KSB7CiAgICAgICAgY3JlYXRlQW5kQWNjdW11bGF0ZUNoYW5nZUV2ZW50KGRpc3BhdGNoUXVldWUsIGluc3QsIG5hdGl2ZUV2ZW50LCBuYXRpdmVFdmVudFRhcmdldCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICB9CgogICAgaWYgKGhhbmRsZUV2ZW50RnVuYykgewogICAgICBoYW5kbGVFdmVudEZ1bmMoZG9tRXZlbnROYW1lLCB0YXJnZXROb2RlLCB0YXJnZXRJbnN0KTsKICAgIH0gLy8gV2hlbiBibHVycmluZywgc2V0IHRoZSB2YWx1ZSBhdHRyaWJ1dGUgZm9yIG51bWJlciBpbnB1dHMKCgogICAgaWYgKGRvbUV2ZW50TmFtZSA9PT0gJ2ZvY3Vzb3V0JykgewogICAgICBoYW5kbGVDb250cm9sbGVkSW5wdXRCbHVyKHRhcmdldE5vZGUpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gcmVnaXN0ZXJFdmVudHMkMigpIHsKICAgIHJlZ2lzdGVyRGlyZWN0RXZlbnQoJ29uTW91c2VFbnRlcicsIFsnbW91c2VvdXQnLCAnbW91c2VvdmVyJ10pOwogICAgcmVnaXN0ZXJEaXJlY3RFdmVudCgnb25Nb3VzZUxlYXZlJywgWydtb3VzZW91dCcsICdtb3VzZW92ZXInXSk7CiAgICByZWdpc3RlckRpcmVjdEV2ZW50KCdvblBvaW50ZXJFbnRlcicsIFsncG9pbnRlcm91dCcsICdwb2ludGVyb3ZlciddKTsKICAgIHJlZ2lzdGVyRGlyZWN0RXZlbnQoJ29uUG9pbnRlckxlYXZlJywgWydwb2ludGVyb3V0JywgJ3BvaW50ZXJvdmVyJ10pOwogIH0KICAvKioKICAgKiBGb3IgYWxtb3N0IGV2ZXJ5IGludGVyYWN0aW9uIHdlIGNhcmUgYWJvdXQsIHRoZXJlIHdpbGwgYmUgYm90aCBhIHRvcC1sZXZlbAogICAqIGBtb3VzZW92ZXJgIGFuZCBgbW91c2VvdXRgIGV2ZW50IHRoYXQgb2NjdXJzLiBPbmx5IHVzZSBgbW91c2VvdXRgIHNvIHRoYXQKICAgKiB3ZSBkbyBub3QgZXh0cmFjdCBkdXBsaWNhdGUgZXZlbnRzLiBIb3dldmVyLCBtb3ZpbmcgdGhlIG1vdXNlIGludG8gdGhlCiAgICogYnJvd3NlciBmcm9tIG91dHNpZGUgd2lsbCBub3QgZmlyZSBhIGBtb3VzZW91dGAgZXZlbnQuIEluIHRoaXMgY2FzZSwgd2UgdXNlCiAgICogdGhlIGBtb3VzZW92ZXJgIHRvcC1sZXZlbCBldmVudC4KICAgKi8KCgogIGZ1bmN0aW9uIGV4dHJhY3RFdmVudHMkMihkaXNwYXRjaFF1ZXVlLCBkb21FdmVudE5hbWUsIHRhcmdldEluc3QsIG5hdGl2ZUV2ZW50LCBuYXRpdmVFdmVudFRhcmdldCwgZXZlbnRTeXN0ZW1GbGFncywgdGFyZ2V0Q29udGFpbmVyKSB7CiAgICB2YXIgaXNPdmVyRXZlbnQgPSBkb21FdmVudE5hbWUgPT09ICdtb3VzZW92ZXInIHx8IGRvbUV2ZW50TmFtZSA9PT0gJ3BvaW50ZXJvdmVyJzsKICAgIHZhciBpc091dEV2ZW50ID0gZG9tRXZlbnROYW1lID09PSAnbW91c2VvdXQnIHx8IGRvbUV2ZW50TmFtZSA9PT0gJ3BvaW50ZXJvdXQnOwoKICAgIGlmIChpc092ZXJFdmVudCAmJiAhaXNSZXBsYXlpbmdFdmVudChuYXRpdmVFdmVudCkpIHsKICAgICAgLy8gSWYgdGhpcyBpcyBhbiBvdmVyIGV2ZW50IHdpdGggYSB0YXJnZXQsIHdlIG1pZ2h0IGhhdmUgYWxyZWFkeSBkaXNwYXRjaGVkCiAgICAgIC8vIHRoZSBldmVudCBpbiB0aGUgb3V0IGV2ZW50IG9mIHRoZSBvdGhlciB0YXJnZXQuIElmIHRoaXMgaXMgcmVwbGF5ZWQsCiAgICAgIC8vIHRoZW4gaXQncyBiZWNhdXNlIHdlIGNvdWxkbid0IGRpc3BhdGNoIGFnYWluc3QgdGhpcyB0YXJnZXQgcHJldmlvdXNseQogICAgICAvLyBzbyB3ZSBoYXZlIHRvIGRvIGl0IG5vdyBpbnN0ZWFkLgogICAgICB2YXIgcmVsYXRlZCA9IG5hdGl2ZUV2ZW50LnJlbGF0ZWRUYXJnZXQgfHwgbmF0aXZlRXZlbnQuZnJvbUVsZW1lbnQ7CgogICAgICBpZiAocmVsYXRlZCkgewogICAgICAgIC8vIElmIHRoZSByZWxhdGVkIG5vZGUgaXMgbWFuYWdlZCBieSBSZWFjdCwgd2UgY2FuIGFzc3VtZSB0aGF0IHdlIGhhdmUKICAgICAgICAvLyBhbHJlYWR5IGRpc3BhdGNoZWQgdGhlIGNvcnJlc3BvbmRpbmcgZXZlbnRzIGR1cmluZyBpdHMgbW91c2VvdXQuCiAgICAgICAgaWYgKGdldENsb3Nlc3RJbnN0YW5jZUZyb21Ob2RlKHJlbGF0ZWQpIHx8IGlzQ29udGFpbmVyTWFya2VkQXNSb290KHJlbGF0ZWQpKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgaWYgKCFpc091dEV2ZW50ICYmICFpc092ZXJFdmVudCkgewogICAgICAvLyBNdXN0IG5vdCBiZSBhIG1vdXNlIG9yIHBvaW50ZXIgaW4gb3Igb3V0IC0gaWdub3JpbmcuCiAgICAgIHJldHVybjsKICAgIH0KCiAgICB2YXIgd2luOyAvLyBUT0RPOiB3aHkgaXMgdGhpcyBudWxsYWJsZSBpbiB0aGUgdHlwZXMgYnV0IHdlIHJlYWQgZnJvbSBpdD8KCiAgICBpZiAobmF0aXZlRXZlbnRUYXJnZXQud2luZG93ID09PSBuYXRpdmVFdmVudFRhcmdldCkgewogICAgICAvLyBgbmF0aXZlRXZlbnRUYXJnZXRgIGlzIHByb2JhYmx5IGEgd2luZG93IG9iamVjdC4KICAgICAgd2luID0gbmF0aXZlRXZlbnRUYXJnZXQ7CiAgICB9IGVsc2UgewogICAgICAvLyBUT0RPOiBGaWd1cmUgb3V0IHdoeSBgb3duZXJEb2N1bWVudGAgaXMgc29tZXRpbWVzIHVuZGVmaW5lZCBpbiBJRTguCiAgICAgIHZhciBkb2MgPSBuYXRpdmVFdmVudFRhcmdldC5vd25lckRvY3VtZW50OwoKICAgICAgaWYgKGRvYykgewogICAgICAgIHdpbiA9IGRvYy5kZWZhdWx0VmlldyB8fCBkb2MucGFyZW50V2luZG93OwogICAgICB9IGVsc2UgewogICAgICAgIHdpbiA9IHdpbmRvdzsKICAgICAgfQogICAgfQoKICAgIHZhciBmcm9tOwogICAgdmFyIHRvOwoKICAgIGlmIChpc091dEV2ZW50KSB7CiAgICAgIHZhciBfcmVsYXRlZCA9IG5hdGl2ZUV2ZW50LnJlbGF0ZWRUYXJnZXQgfHwgbmF0aXZlRXZlbnQudG9FbGVtZW50OwoKICAgICAgZnJvbSA9IHRhcmdldEluc3Q7CiAgICAgIHRvID0gX3JlbGF0ZWQgPyBnZXRDbG9zZXN0SW5zdGFuY2VGcm9tTm9kZShfcmVsYXRlZCkgOiBudWxsOwoKICAgICAgaWYgKHRvICE9PSBudWxsKSB7CiAgICAgICAgdmFyIG5lYXJlc3RNb3VudGVkID0gZ2V0TmVhcmVzdE1vdW50ZWRGaWJlcih0byk7CgogICAgICAgIGlmICh0byAhPT0gbmVhcmVzdE1vdW50ZWQgfHwgdG8udGFnICE9PSBIb3N0Q29tcG9uZW50ICYmIHRvLnRhZyAhPT0gSG9zdFRleHQpIHsKICAgICAgICAgIHRvID0gbnVsbDsKICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIC8vIE1vdmluZyB0byBhIG5vZGUgZnJvbSBvdXRzaWRlIHRoZSB3aW5kb3cuCiAgICAgIGZyb20gPSBudWxsOwogICAgICB0byA9IHRhcmdldEluc3Q7CiAgICB9CgogICAgaWYgKGZyb20gPT09IHRvKSB7CiAgICAgIC8vIE5vdGhpbmcgcGVydGFpbnMgdG8gb3VyIG1hbmFnZWQgY29tcG9uZW50cy4KICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhciBTeW50aGV0aWNFdmVudEN0b3IgPSBTeW50aGV0aWNNb3VzZUV2ZW50OwogICAgdmFyIGxlYXZlRXZlbnRUeXBlID0gJ29uTW91c2VMZWF2ZSc7CiAgICB2YXIgZW50ZXJFdmVudFR5cGUgPSAnb25Nb3VzZUVudGVyJzsKICAgIHZhciBldmVudFR5cGVQcmVmaXggPSAnbW91c2UnOwoKICAgIGlmIChkb21FdmVudE5hbWUgPT09ICdwb2ludGVyb3V0JyB8fCBkb21FdmVudE5hbWUgPT09ICdwb2ludGVyb3ZlcicpIHsKICAgICAgU3ludGhldGljRXZlbnRDdG9yID0gU3ludGhldGljUG9pbnRlckV2ZW50OwogICAgICBsZWF2ZUV2ZW50VHlwZSA9ICdvblBvaW50ZXJMZWF2ZSc7CiAgICAgIGVudGVyRXZlbnRUeXBlID0gJ29uUG9pbnRlckVudGVyJzsKICAgICAgZXZlbnRUeXBlUHJlZml4ID0gJ3BvaW50ZXInOwogICAgfQoKICAgIHZhciBmcm9tTm9kZSA9IGZyb20gPT0gbnVsbCA/IHdpbiA6IGdldE5vZGVGcm9tSW5zdGFuY2UoZnJvbSk7CiAgICB2YXIgdG9Ob2RlID0gdG8gPT0gbnVsbCA/IHdpbiA6IGdldE5vZGVGcm9tSW5zdGFuY2UodG8pOwogICAgdmFyIGxlYXZlID0gbmV3IFN5bnRoZXRpY0V2ZW50Q3RvcihsZWF2ZUV2ZW50VHlwZSwgZXZlbnRUeXBlUHJlZml4ICsgJ2xlYXZlJywgZnJvbSwgbmF0aXZlRXZlbnQsIG5hdGl2ZUV2ZW50VGFyZ2V0KTsKICAgIGxlYXZlLnRhcmdldCA9IGZyb21Ob2RlOwogICAgbGVhdmUucmVsYXRlZFRhcmdldCA9IHRvTm9kZTsKICAgIHZhciBlbnRlciA9IG51bGw7IC8vIFdlIHNob3VsZCBvbmx5IHByb2Nlc3MgdGhpcyBuYXRpdmVFdmVudCBpZiB3ZSBhcmUgcHJvY2Vzc2luZwogICAgLy8gdGhlIGZpcnN0IGFuY2VzdG9yLiBOZXh0IHRpbWUsIHdlIHdpbGwgaWdub3JlIHRoZSBldmVudC4KCiAgICB2YXIgbmF0aXZlVGFyZ2V0SW5zdCA9IGdldENsb3Nlc3RJbnN0YW5jZUZyb21Ob2RlKG5hdGl2ZUV2ZW50VGFyZ2V0KTsKCiAgICBpZiAobmF0aXZlVGFyZ2V0SW5zdCA9PT0gdGFyZ2V0SW5zdCkgewogICAgICB2YXIgZW50ZXJFdmVudCA9IG5ldyBTeW50aGV0aWNFdmVudEN0b3IoZW50ZXJFdmVudFR5cGUsIGV2ZW50VHlwZVByZWZpeCArICdlbnRlcicsIHRvLCBuYXRpdmVFdmVudCwgbmF0aXZlRXZlbnRUYXJnZXQpOwogICAgICBlbnRlckV2ZW50LnRhcmdldCA9IHRvTm9kZTsKICAgICAgZW50ZXJFdmVudC5yZWxhdGVkVGFyZ2V0ID0gZnJvbU5vZGU7CiAgICAgIGVudGVyID0gZW50ZXJFdmVudDsKICAgIH0KCiAgICBhY2N1bXVsYXRlRW50ZXJMZWF2ZVR3b1BoYXNlTGlzdGVuZXJzKGRpc3BhdGNoUXVldWUsIGxlYXZlLCBlbnRlciwgZnJvbSwgdG8pOwogIH0KCiAgLyoqCiAgICogaW5saW5lZCBPYmplY3QuaXMgcG9seWZpbGwgdG8gYXZvaWQgcmVxdWlyaW5nIGNvbnN1bWVycyBzaGlwIHRoZWlyIG93bgogICAqIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL09iamVjdC9pcwogICAqLwogIGZ1bmN0aW9uIGlzKHgsIHkpIHsKICAgIHJldHVybiB4ID09PSB5ICYmICh4ICE9PSAwIHx8IDEgLyB4ID09PSAxIC8geSkgfHwgeCAhPT0geCAmJiB5ICE9PSB5IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tc2VsZi1jb21wYXJlCiAgICA7CiAgfQoKICB2YXIgb2JqZWN0SXMgPSB0eXBlb2YgT2JqZWN0LmlzID09PSAnZnVuY3Rpb24nID8gT2JqZWN0LmlzIDogaXM7CgogIC8qKgogICAqIFBlcmZvcm1zIGVxdWFsaXR5IGJ5IGl0ZXJhdGluZyB0aHJvdWdoIGtleXMgb24gYW4gb2JqZWN0IGFuZCByZXR1cm5pbmcgZmFsc2UKICAgKiB3aGVuIGFueSBrZXkgaGFzIHZhbHVlcyB3aGljaCBhcmUgbm90IHN0cmljdGx5IGVxdWFsIGJldHdlZW4gdGhlIGFyZ3VtZW50cy4KICAgKiBSZXR1cm5zIHRydWUgd2hlbiB0aGUgdmFsdWVzIG9mIGFsbCBrZXlzIGFyZSBzdHJpY3RseSBlcXVhbC4KICAgKi8KCiAgZnVuY3Rpb24gc2hhbGxvd0VxdWFsKG9iakEsIG9iakIpIHsKICAgIGlmIChvYmplY3RJcyhvYmpBLCBvYmpCKSkgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBpZiAodHlwZW9mIG9iakEgIT09ICdvYmplY3QnIHx8IG9iakEgPT09IG51bGwgfHwgdHlwZW9mIG9iakIgIT09ICdvYmplY3QnIHx8IG9iakIgPT09IG51bGwpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIHZhciBrZXlzQSA9IE9iamVjdC5rZXlzKG9iakEpOwogICAgdmFyIGtleXNCID0gT2JqZWN0LmtleXMob2JqQik7CgogICAgaWYgKGtleXNBLmxlbmd0aCAhPT0ga2V5c0IubGVuZ3RoKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0gLy8gVGVzdCBmb3IgQSdzIGtleXMgZGlmZmVyZW50IGZyb20gQi4KCgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBrZXlzQS5sZW5ndGg7IGkrKykgewogICAgICB2YXIgY3VycmVudEtleSA9IGtleXNBW2ldOwoKICAgICAgaWYgKCFoYXNPd25Qcm9wZXJ0eS5jYWxsKG9iakIsIGN1cnJlbnRLZXkpIHx8ICFvYmplY3RJcyhvYmpBW2N1cnJlbnRLZXldLCBvYmpCW2N1cnJlbnRLZXldKSkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogR2l2ZW4gYW55IG5vZGUgcmV0dXJuIHRoZSBmaXJzdCBsZWFmIG5vZGUgd2l0aG91dCBjaGlsZHJlbi4KICAgKgogICAqIEBwYXJhbSB7RE9NRWxlbWVudHxET01UZXh0Tm9kZX0gbm9kZQogICAqIEByZXR1cm4ge0RPTUVsZW1lbnR8RE9NVGV4dE5vZGV9CiAgICovCgogIGZ1bmN0aW9uIGdldExlYWZOb2RlKG5vZGUpIHsKICAgIHdoaWxlIChub2RlICYmIG5vZGUuZmlyc3RDaGlsZCkgewogICAgICBub2RlID0gbm9kZS5maXJzdENoaWxkOwogICAgfQoKICAgIHJldHVybiBub2RlOwogIH0KICAvKioKICAgKiBHZXQgdGhlIG5leHQgc2libGluZyB3aXRoaW4gYSBjb250YWluZXIuIFRoaXMgd2lsbCB3YWxrIHVwIHRoZQogICAqIERPTSBpZiBhIG5vZGUncyBzaWJsaW5ncyBoYXZlIGJlZW4gZXhoYXVzdGVkLgogICAqCiAgICogQHBhcmFtIHtET01FbGVtZW50fERPTVRleHROb2RlfSBub2RlCiAgICogQHJldHVybiB7P0RPTUVsZW1lbnR8RE9NVGV4dE5vZGV9CiAgICovCgoKICBmdW5jdGlvbiBnZXRTaWJsaW5nTm9kZShub2RlKSB7CiAgICB3aGlsZSAobm9kZSkgewogICAgICBpZiAobm9kZS5uZXh0U2libGluZykgewogICAgICAgIHJldHVybiBub2RlLm5leHRTaWJsaW5nOwogICAgICB9CgogICAgICBub2RlID0gbm9kZS5wYXJlbnROb2RlOwogICAgfQogIH0KICAvKioKICAgKiBHZXQgb2JqZWN0IGRlc2NyaWJpbmcgdGhlIG5vZGVzIHdoaWNoIGNvbnRhaW4gY2hhcmFjdGVycyBhdCBvZmZzZXQuCiAgICoKICAgKiBAcGFyYW0ge0RPTUVsZW1lbnR8RE9NVGV4dE5vZGV9IHJvb3QKICAgKiBAcGFyYW0ge251bWJlcn0gb2Zmc2V0CiAgICogQHJldHVybiB7P29iamVjdH0KICAgKi8KCgogIGZ1bmN0aW9uIGdldE5vZGVGb3JDaGFyYWN0ZXJPZmZzZXQocm9vdCwgb2Zmc2V0KSB7CiAgICB2YXIgbm9kZSA9IGdldExlYWZOb2RlKHJvb3QpOwogICAgdmFyIG5vZGVTdGFydCA9IDA7CiAgICB2YXIgbm9kZUVuZCA9IDA7CgogICAgd2hpbGUgKG5vZGUpIHsKICAgICAgaWYgKG5vZGUubm9kZVR5cGUgPT09IFRFWFRfTk9ERSkgewogICAgICAgIG5vZGVFbmQgPSBub2RlU3RhcnQgKyBub2RlLnRleHRDb250ZW50Lmxlbmd0aDsKCiAgICAgICAgaWYgKG5vZGVTdGFydCA8PSBvZmZzZXQgJiYgbm9kZUVuZCA+PSBvZmZzZXQpIHsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIG5vZGU6IG5vZGUsCiAgICAgICAgICAgIG9mZnNldDogb2Zmc2V0IC0gbm9kZVN0YXJ0CiAgICAgICAgICB9OwogICAgICAgIH0KCiAgICAgICAgbm9kZVN0YXJ0ID0gbm9kZUVuZDsKICAgICAgfQoKICAgICAgbm9kZSA9IGdldExlYWZOb2RlKGdldFNpYmxpbmdOb2RlKG5vZGUpKTsKICAgIH0KICB9CgogIC8qKgogICAqIEBwYXJhbSB7RE9NRWxlbWVudH0gb3V0ZXJOb2RlCiAgICogQHJldHVybiB7P29iamVjdH0KICAgKi8KCiAgZnVuY3Rpb24gZ2V0T2Zmc2V0cyhvdXRlck5vZGUpIHsKICAgIHZhciBvd25lckRvY3VtZW50ID0gb3V0ZXJOb2RlLm93bmVyRG9jdW1lbnQ7CiAgICB2YXIgd2luID0gb3duZXJEb2N1bWVudCAmJiBvd25lckRvY3VtZW50LmRlZmF1bHRWaWV3IHx8IHdpbmRvdzsKICAgIHZhciBzZWxlY3Rpb24gPSB3aW4uZ2V0U2VsZWN0aW9uICYmIHdpbi5nZXRTZWxlY3Rpb24oKTsKCiAgICBpZiAoIXNlbGVjdGlvbiB8fCBzZWxlY3Rpb24ucmFuZ2VDb3VudCA9PT0gMCkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICB2YXIgYW5jaG9yTm9kZSA9IHNlbGVjdGlvbi5hbmNob3JOb2RlLAogICAgICAgIGFuY2hvck9mZnNldCA9IHNlbGVjdGlvbi5hbmNob3JPZmZzZXQsCiAgICAgICAgZm9jdXNOb2RlID0gc2VsZWN0aW9uLmZvY3VzTm9kZSwKICAgICAgICBmb2N1c09mZnNldCA9IHNlbGVjdGlvbi5mb2N1c09mZnNldDsgLy8gSW4gRmlyZWZveCwgYW5jaG9yTm9kZSBhbmQgZm9jdXNOb2RlIGNhbiBiZSAiYW5vbnltb3VzIGRpdnMiLCBlLmcuIHRoZQogICAgLy8gdXAvZG93biBidXR0b25zIG9uIGFuIDxpbnB1dCB0eXBlPSJudW1iZXIiPi4gQW5vbnltb3VzIGRpdnMgZG8gbm90IHNlZW0gdG8KICAgIC8vIGV4cG9zZSBwcm9wZXJ0aWVzLCB0cmlnZ2VyaW5nIGEgIlBlcm1pc3Npb24gZGVuaWVkIGVycm9yIiBpZiBhbnkgb2YgaXRzCiAgICAvLyBwcm9wZXJ0aWVzIGFyZSBhY2Nlc3NlZC4gVGhlIG9ubHkgc2VlbWluZ2x5IHBvc3NpYmxlIHdheSB0byBhdm9pZCBlcnJvcmluZwogICAgLy8gaXMgdG8gYWNjZXNzIGEgcHJvcGVydHkgdGhhdCB0eXBpY2FsbHkgd29ya3MgZm9yIG5vbi1hbm9ueW1vdXMgZGl2cyBhbmQKICAgIC8vIGNhdGNoIGFueSBlcnJvciB0aGF0IG1heSBvdGhlcndpc2UgYXJpc2UuIFNlZQogICAgLy8gaHR0cHM6Ly9idWd6aWxsYS5tb3ppbGxhLm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MjA4NDI3CgogICAgdHJ5IHsKICAgICAgLyogZXNsaW50LWRpc2FibGUgbm8tdW51c2VkLWV4cHJlc3Npb25zICovCiAgICAgIGFuY2hvck5vZGUubm9kZVR5cGU7CiAgICAgIGZvY3VzTm9kZS5ub2RlVHlwZTsKICAgICAgLyogZXNsaW50LWVuYWJsZSBuby11bnVzZWQtZXhwcmVzc2lvbnMgKi8KICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgcmV0dXJuIGdldE1vZGVybk9mZnNldHNGcm9tUG9pbnRzKG91dGVyTm9kZSwgYW5jaG9yTm9kZSwgYW5jaG9yT2Zmc2V0LCBmb2N1c05vZGUsIGZvY3VzT2Zmc2V0KTsKICB9CiAgLyoqCiAgICogUmV0dXJucyB7c3RhcnQsIGVuZH0gd2hlcmUgYHN0YXJ0YCBpcyB0aGUgY2hhcmFjdGVyL2NvZGVwb2ludCBpbmRleCBvZgogICAqIChhbmNob3JOb2RlLCBhbmNob3JPZmZzZXQpIHdpdGhpbiB0aGUgdGV4dENvbnRlbnQgb2YgYG91dGVyTm9kZWAsIGFuZAogICAqIGBlbmRgIGlzIHRoZSBpbmRleCBvZiAoZm9jdXNOb2RlLCBmb2N1c09mZnNldCkuCiAgICoKICAgKiBSZXR1cm5zIG51bGwgaWYgeW91IHBhc3MgaW4gZ2FyYmFnZSBpbnB1dCBidXQgd2Ugc2hvdWxkIHByb2JhYmx5IGp1c3QgY3Jhc2guCiAgICoKICAgKiBFeHBvcnRlZCBvbmx5IGZvciB0ZXN0aW5nLgogICAqLwoKICBmdW5jdGlvbiBnZXRNb2Rlcm5PZmZzZXRzRnJvbVBvaW50cyhvdXRlck5vZGUsIGFuY2hvck5vZGUsIGFuY2hvck9mZnNldCwgZm9jdXNOb2RlLCBmb2N1c09mZnNldCkgewogICAgdmFyIGxlbmd0aCA9IDA7CiAgICB2YXIgc3RhcnQgPSAtMTsKICAgIHZhciBlbmQgPSAtMTsKICAgIHZhciBpbmRleFdpdGhpbkFuY2hvciA9IDA7CiAgICB2YXIgaW5kZXhXaXRoaW5Gb2N1cyA9IDA7CiAgICB2YXIgbm9kZSA9IG91dGVyTm9kZTsKICAgIHZhciBwYXJlbnROb2RlID0gbnVsbDsKCiAgICBvdXRlcjogd2hpbGUgKHRydWUpIHsKICAgICAgdmFyIG5leHQgPSBudWxsOwoKICAgICAgd2hpbGUgKHRydWUpIHsKICAgICAgICBpZiAobm9kZSA9PT0gYW5jaG9yTm9kZSAmJiAoYW5jaG9yT2Zmc2V0ID09PSAwIHx8IG5vZGUubm9kZVR5cGUgPT09IFRFWFRfTk9ERSkpIHsKICAgICAgICAgIHN0YXJ0ID0gbGVuZ3RoICsgYW5jaG9yT2Zmc2V0OwogICAgICAgIH0KCiAgICAgICAgaWYgKG5vZGUgPT09IGZvY3VzTm9kZSAmJiAoZm9jdXNPZmZzZXQgPT09IDAgfHwgbm9kZS5ub2RlVHlwZSA9PT0gVEVYVF9OT0RFKSkgewogICAgICAgICAgZW5kID0gbGVuZ3RoICsgZm9jdXNPZmZzZXQ7CiAgICAgICAgfQoKICAgICAgICBpZiAobm9kZS5ub2RlVHlwZSA9PT0gVEVYVF9OT0RFKSB7CiAgICAgICAgICBsZW5ndGggKz0gbm9kZS5ub2RlVmFsdWUubGVuZ3RoOwogICAgICAgIH0KCiAgICAgICAgaWYgKChuZXh0ID0gbm9kZS5maXJzdENoaWxkKSA9PT0gbnVsbCkgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfSAvLyBNb3ZpbmcgZnJvbSBgbm9kZWAgdG8gaXRzIGZpcnN0IGNoaWxkIGBuZXh0YC4KCgogICAgICAgIHBhcmVudE5vZGUgPSBub2RlOwogICAgICAgIG5vZGUgPSBuZXh0OwogICAgICB9CgogICAgICB3aGlsZSAodHJ1ZSkgewogICAgICAgIGlmIChub2RlID09PSBvdXRlck5vZGUpIHsKICAgICAgICAgIC8vIElmIGBvdXRlck5vZGVgIGhhcyBjaGlsZHJlbiwgdGhpcyBpcyBhbHdheXMgdGhlIHNlY29uZCB0aW1lIHZpc2l0aW5nCiAgICAgICAgICAvLyBpdC4gSWYgaXQgaGFzIG5vIGNoaWxkcmVuLCB0aGlzIGlzIHN0aWxsIHRoZSBmaXJzdCBsb29wLCBhbmQgdGhlIG9ubHkKICAgICAgICAgIC8vIHZhbGlkIHNlbGVjdGlvbiBpcyBhbmNob3JOb2RlIGFuZCBmb2N1c05vZGUgYm90aCBlcXVhbCB0byB0aGlzIG5vZGUKICAgICAgICAgIC8vIGFuZCBib3RoIG9mZnNldHMgMCwgaW4gd2hpY2ggY2FzZSB3ZSB3aWxsIGhhdmUgaGFuZGxlZCBhYm92ZS4KICAgICAgICAgIGJyZWFrIG91dGVyOwogICAgICAgIH0KCiAgICAgICAgaWYgKHBhcmVudE5vZGUgPT09IGFuY2hvck5vZGUgJiYgKytpbmRleFdpdGhpbkFuY2hvciA9PT0gYW5jaG9yT2Zmc2V0KSB7CiAgICAgICAgICBzdGFydCA9IGxlbmd0aDsKICAgICAgICB9CgogICAgICAgIGlmIChwYXJlbnROb2RlID09PSBmb2N1c05vZGUgJiYgKytpbmRleFdpdGhpbkZvY3VzID09PSBmb2N1c09mZnNldCkgewogICAgICAgICAgZW5kID0gbGVuZ3RoOwogICAgICAgIH0KCiAgICAgICAgaWYgKChuZXh0ID0gbm9kZS5uZXh0U2libGluZykgIT09IG51bGwpIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgbm9kZSA9IHBhcmVudE5vZGU7CiAgICAgICAgcGFyZW50Tm9kZSA9IG5vZGUucGFyZW50Tm9kZTsKICAgICAgfSAvLyBNb3ZpbmcgZnJvbSBgbm9kZWAgdG8gaXRzIG5leHQgc2libGluZyBgbmV4dGAuCgoKICAgICAgbm9kZSA9IG5leHQ7CiAgICB9CgogICAgaWYgKHN0YXJ0ID09PSAtMSB8fCBlbmQgPT09IC0xKSB7CiAgICAgIC8vIFRoaXMgc2hvdWxkIG5ldmVyIGhhcHBlbi4gKFdvdWxkIGhhcHBlbiBpZiB0aGUgYW5jaG9yL2ZvY3VzIG5vZGVzIGFyZW4ndAogICAgICAvLyBhY3R1YWxseSBpbnNpZGUgdGhlIHBhc3NlZC1pbiBub2RlLikKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgcmV0dXJuIHsKICAgICAgc3RhcnQ6IHN0YXJ0LAogICAgICBlbmQ6IGVuZAogICAgfTsKICB9CiAgLyoqCiAgICogSW4gbW9kZXJuIG5vbi1JRSBicm93c2Vycywgd2UgY2FuIHN1cHBvcnQgYm90aCBmb3J3YXJkIGFuZCBiYWNrd2FyZAogICAqIHNlbGVjdGlvbnMuCiAgICoKICAgKiBOb3RlOiBJRTEwKyBzdXBwb3J0cyB0aGUgU2VsZWN0aW9uIG9iamVjdCwgYnV0IGl0IGRvZXMgbm90IHN1cHBvcnQKICAgKiB0aGUgYGV4dGVuZGAgbWV0aG9kLCB3aGljaCBtZWFucyB0aGF0IGV2ZW4gaW4gbW9kZXJuIElFLCBpdCdzIG5vdCBwb3NzaWJsZQogICAqIHRvIHByb2dyYW1tYXRpY2FsbHkgY3JlYXRlIGEgYmFja3dhcmQgc2VsZWN0aW9uLiBUaHVzLCBmb3IgYWxsIElFCiAgICogdmVyc2lvbnMsIHdlIHVzZSB0aGUgb2xkIElFIEFQSSB0byBjcmVhdGUgb3VyIHNlbGVjdGlvbnMuCiAgICoKICAgKiBAcGFyYW0ge0RPTUVsZW1lbnR8RE9NVGV4dE5vZGV9IG5vZGUKICAgKiBAcGFyYW0ge29iamVjdH0gb2Zmc2V0cwogICAqLwoKICBmdW5jdGlvbiBzZXRPZmZzZXRzKG5vZGUsIG9mZnNldHMpIHsKICAgIHZhciBkb2MgPSBub2RlLm93bmVyRG9jdW1lbnQgfHwgZG9jdW1lbnQ7CiAgICB2YXIgd2luID0gZG9jICYmIGRvYy5kZWZhdWx0VmlldyB8fCB3aW5kb3c7IC8vIEVkZ2UgZmFpbHMgd2l0aCAiT2JqZWN0IGV4cGVjdGVkIiBpbiBzb21lIHNjZW5hcmlvcy4KICAgIC8vIChGb3IgaW5zdGFuY2U6IFRpbnlNQ0UgZWRpdG9yIHVzZWQgaW4gYSBsaXN0IGNvbXBvbmVudCB0aGF0IHN1cHBvcnRzIHBhc3RpbmcgdG8gYWRkIG1vcmUsCiAgICAvLyBmYWlscyB3aGVuIHBhc3RpbmcgMTAwKyBpdGVtcykKCiAgICBpZiAoIXdpbi5nZXRTZWxlY3Rpb24pIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhciBzZWxlY3Rpb24gPSB3aW4uZ2V0U2VsZWN0aW9uKCk7CiAgICB2YXIgbGVuZ3RoID0gbm9kZS50ZXh0Q29udGVudC5sZW5ndGg7CiAgICB2YXIgc3RhcnQgPSBNYXRoLm1pbihvZmZzZXRzLnN0YXJ0LCBsZW5ndGgpOwogICAgdmFyIGVuZCA9IG9mZnNldHMuZW5kID09PSB1bmRlZmluZWQgPyBzdGFydCA6IE1hdGgubWluKG9mZnNldHMuZW5kLCBsZW5ndGgpOyAvLyBJRSAxMSB1c2VzIG1vZGVybiBzZWxlY3Rpb24sIGJ1dCBkb2Vzbid0IHN1cHBvcnQgdGhlIGV4dGVuZCBtZXRob2QuCiAgICAvLyBGbGlwIGJhY2t3YXJkIHNlbGVjdGlvbnMsIHNvIHdlIGNhbiBzZXQgd2l0aCBhIHNpbmdsZSByYW5nZS4KCiAgICBpZiAoIXNlbGVjdGlvbi5leHRlbmQgJiYgc3RhcnQgPiBlbmQpIHsKICAgICAgdmFyIHRlbXAgPSBlbmQ7CiAgICAgIGVuZCA9IHN0YXJ0OwogICAgICBzdGFydCA9IHRlbXA7CiAgICB9CgogICAgdmFyIHN0YXJ0TWFya2VyID0gZ2V0Tm9kZUZvckNoYXJhY3Rlck9mZnNldChub2RlLCBzdGFydCk7CiAgICB2YXIgZW5kTWFya2VyID0gZ2V0Tm9kZUZvckNoYXJhY3Rlck9mZnNldChub2RlLCBlbmQpOwoKICAgIGlmIChzdGFydE1hcmtlciAmJiBlbmRNYXJrZXIpIHsKICAgICAgaWYgKHNlbGVjdGlvbi5yYW5nZUNvdW50ID09PSAxICYmIHNlbGVjdGlvbi5hbmNob3JOb2RlID09PSBzdGFydE1hcmtlci5ub2RlICYmIHNlbGVjdGlvbi5hbmNob3JPZmZzZXQgPT09IHN0YXJ0TWFya2VyLm9mZnNldCAmJiBzZWxlY3Rpb24uZm9jdXNOb2RlID09PSBlbmRNYXJrZXIubm9kZSAmJiBzZWxlY3Rpb24uZm9jdXNPZmZzZXQgPT09IGVuZE1hcmtlci5vZmZzZXQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciByYW5nZSA9IGRvYy5jcmVhdGVSYW5nZSgpOwogICAgICByYW5nZS5zZXRTdGFydChzdGFydE1hcmtlci5ub2RlLCBzdGFydE1hcmtlci5vZmZzZXQpOwogICAgICBzZWxlY3Rpb24ucmVtb3ZlQWxsUmFuZ2VzKCk7CgogICAgICBpZiAoc3RhcnQgPiBlbmQpIHsKICAgICAgICBzZWxlY3Rpb24uYWRkUmFuZ2UocmFuZ2UpOwogICAgICAgIHNlbGVjdGlvbi5leHRlbmQoZW5kTWFya2VyLm5vZGUsIGVuZE1hcmtlci5vZmZzZXQpOwogICAgICB9IGVsc2UgewogICAgICAgIHJhbmdlLnNldEVuZChlbmRNYXJrZXIubm9kZSwgZW5kTWFya2VyLm9mZnNldCk7CiAgICAgICAgc2VsZWN0aW9uLmFkZFJhbmdlKHJhbmdlKTsKICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gaXNUZXh0Tm9kZShub2RlKSB7CiAgICByZXR1cm4gbm9kZSAmJiBub2RlLm5vZGVUeXBlID09PSBURVhUX05PREU7CiAgfQoKICBmdW5jdGlvbiBjb250YWluc05vZGUob3V0ZXJOb2RlLCBpbm5lck5vZGUpIHsKICAgIGlmICghb3V0ZXJOb2RlIHx8ICFpbm5lck5vZGUpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSBlbHNlIGlmIChvdXRlck5vZGUgPT09IGlubmVyTm9kZSkgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0gZWxzZSBpZiAoaXNUZXh0Tm9kZShvdXRlck5vZGUpKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0gZWxzZSBpZiAoaXNUZXh0Tm9kZShpbm5lck5vZGUpKSB7CiAgICAgIHJldHVybiBjb250YWluc05vZGUob3V0ZXJOb2RlLCBpbm5lck5vZGUucGFyZW50Tm9kZSk7CiAgICB9IGVsc2UgaWYgKCdjb250YWlucycgaW4gb3V0ZXJOb2RlKSB7CiAgICAgIHJldHVybiBvdXRlck5vZGUuY29udGFpbnMoaW5uZXJOb2RlKTsKICAgIH0gZWxzZSBpZiAob3V0ZXJOb2RlLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKSB7CiAgICAgIHJldHVybiAhIShvdXRlck5vZGUuY29tcGFyZURvY3VtZW50UG9zaXRpb24oaW5uZXJOb2RlKSAmIDE2KTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGlzSW5Eb2N1bWVudChub2RlKSB7CiAgICByZXR1cm4gbm9kZSAmJiBub2RlLm93bmVyRG9jdW1lbnQgJiYgY29udGFpbnNOb2RlKG5vZGUub3duZXJEb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsIG5vZGUpOwogIH0KCiAgZnVuY3Rpb24gaXNTYW1lT3JpZ2luRnJhbWUoaWZyYW1lKSB7CiAgICB0cnkgewogICAgICAvLyBBY2Nlc3NpbmcgdGhlIGNvbnRlbnREb2N1bWVudCBvZiBhIEhUTUxJZnJhbWVFbGVtZW50IGNhbiBjYXVzZSB0aGUgYnJvd3NlcgogICAgICAvLyB0byB0aHJvdywgZS5nLiBpZiBpdCBoYXMgYSBjcm9zcy1vcmlnaW4gc3JjIGF0dHJpYnV0ZS4KICAgICAgLy8gU2FmYXJpIHdpbGwgc2hvdyBhbiBlcnJvciBpbiB0aGUgY29uc29sZSB3aGVuIHRoZSBhY2Nlc3MgcmVzdWx0cyBpbiAiQmxvY2tlZCBhIGZyYW1lIHdpdGggb3JpZ2luIi4gZS5nOgogICAgICAvLyBpZnJhbWUuY29udGVudERvY3VtZW50LmRlZmF1bHRWaWV3OwogICAgICAvLyBBIHNhZmV0eSB3YXkgaXMgdG8gYWNjZXNzIG9uZSBvZiB0aGUgY3Jvc3Mgb3JpZ2luIHByb3BlcnRpZXM6IFdpbmRvdyBvciBMb2NhdGlvbgogICAgICAvLyBXaGljaCBtaWdodCByZXN1bHQgaW4gIlNlY3VyaXR5RXJyb3IiIERPTSBFeGNlcHRpb24gYW5kIGl0IGlzIGNvbXBhdGlibGUgdG8gU2FmYXJpLgogICAgICAvLyBodHRwczovL2h0bWwuc3BlYy53aGF0d2cub3JnL211bHRpcGFnZS9icm93c2Vycy5odG1sI2ludGVncmF0aW9uLXdpdGgtaWRsCiAgICAgIHJldHVybiB0eXBlb2YgaWZyYW1lLmNvbnRlbnRXaW5kb3cubG9jYXRpb24uaHJlZiA9PT0gJ3N0cmluZyc7CiAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0KCiAgZnVuY3Rpb24gZ2V0QWN0aXZlRWxlbWVudERlZXAoKSB7CiAgICB2YXIgd2luID0gd2luZG93OwogICAgdmFyIGVsZW1lbnQgPSBnZXRBY3RpdmVFbGVtZW50KCk7CgogICAgd2hpbGUgKGVsZW1lbnQgaW5zdGFuY2VvZiB3aW4uSFRNTElGcmFtZUVsZW1lbnQpIHsKICAgICAgaWYgKGlzU2FtZU9yaWdpbkZyYW1lKGVsZW1lbnQpKSB7CiAgICAgICAgd2luID0gZWxlbWVudC5jb250ZW50V2luZG93OwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBlbGVtZW50OwogICAgICB9CgogICAgICBlbGVtZW50ID0gZ2V0QWN0aXZlRWxlbWVudCh3aW4uZG9jdW1lbnQpOwogICAgfQoKICAgIHJldHVybiBlbGVtZW50OwogIH0KICAvKioKICAgKiBAUmVhY3RJbnB1dFNlbGVjdGlvbjogUmVhY3QgaW5wdXQgc2VsZWN0aW9uIG1vZHVsZS4gQmFzZWQgb24gU2VsZWN0aW9uLmpzLAogICAqIGJ1dCBtb2RpZmllZCB0byBiZSBzdWl0YWJsZSBmb3IgcmVhY3QgYW5kIGhhcyBhIGNvdXBsZSBvZiBidWcgZml4ZXMgKGRvZXNuJ3QKICAgKiBhc3N1bWUgYnV0dG9ucyBoYXZlIHJhbmdlIHNlbGVjdGlvbnMgYWxsb3dlZCkuCiAgICogSW5wdXQgc2VsZWN0aW9uIG1vZHVsZSBmb3IgUmVhY3QuCiAgICovCgogIC8qKgogICAqIEBoYXNTZWxlY3Rpb25DYXBhYmlsaXRpZXM6IHdlIGdldCB0aGUgZWxlbWVudCB0eXBlcyB0aGF0IHN1cHBvcnQgc2VsZWN0aW9uCiAgICogZnJvbSBodHRwczovL2h0bWwuc3BlYy53aGF0d2cub3JnLyNkby1ub3QtYXBwbHksIGxvb2tpbmcgYXQgYHNlbGVjdGlvblN0YXJ0YAogICAqIGFuZCBgc2VsZWN0aW9uRW5kYCByb3dzLgogICAqLwoKCiAgZnVuY3Rpb24gaGFzU2VsZWN0aW9uQ2FwYWJpbGl0aWVzKGVsZW0pIHsKICAgIHZhciBub2RlTmFtZSA9IGVsZW0gJiYgZWxlbS5ub2RlTmFtZSAmJiBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7CiAgICByZXR1cm4gbm9kZU5hbWUgJiYgKG5vZGVOYW1lID09PSAnaW5wdXQnICYmIChlbGVtLnR5cGUgPT09ICd0ZXh0JyB8fCBlbGVtLnR5cGUgPT09ICdzZWFyY2gnIHx8IGVsZW0udHlwZSA9PT0gJ3RlbCcgfHwgZWxlbS50eXBlID09PSAndXJsJyB8fCBlbGVtLnR5cGUgPT09ICdwYXNzd29yZCcpIHx8IG5vZGVOYW1lID09PSAndGV4dGFyZWEnIHx8IGVsZW0uY29udGVudEVkaXRhYmxlID09PSAndHJ1ZScpOwogIH0KICBmdW5jdGlvbiBnZXRTZWxlY3Rpb25JbmZvcm1hdGlvbigpIHsKICAgIHZhciBmb2N1c2VkRWxlbSA9IGdldEFjdGl2ZUVsZW1lbnREZWVwKCk7CiAgICByZXR1cm4gewogICAgICBmb2N1c2VkRWxlbTogZm9jdXNlZEVsZW0sCiAgICAgIHNlbGVjdGlvblJhbmdlOiBoYXNTZWxlY3Rpb25DYXBhYmlsaXRpZXMoZm9jdXNlZEVsZW0pID8gZ2V0U2VsZWN0aW9uKGZvY3VzZWRFbGVtKSA6IG51bGwKICAgIH07CiAgfQogIC8qKgogICAqIEByZXN0b3JlU2VsZWN0aW9uOiBJZiBhbnkgc2VsZWN0aW9uIGluZm9ybWF0aW9uIHdhcyBwb3RlbnRpYWxseSBsb3N0LAogICAqIHJlc3RvcmUgaXQuIFRoaXMgaXMgdXNlZnVsIHdoZW4gcGVyZm9ybWluZyBvcGVyYXRpb25zIHRoYXQgY291bGQgcmVtb3ZlIGRvbQogICAqIG5vZGVzIGFuZCBwbGFjZSB0aGVtIGJhY2sgaW4sIHJlc3VsdGluZyBpbiBmb2N1cyBiZWluZyBsb3N0LgogICAqLwoKICBmdW5jdGlvbiByZXN0b3JlU2VsZWN0aW9uKHByaW9yU2VsZWN0aW9uSW5mb3JtYXRpb24pIHsKICAgIHZhciBjdXJGb2N1c2VkRWxlbSA9IGdldEFjdGl2ZUVsZW1lbnREZWVwKCk7CiAgICB2YXIgcHJpb3JGb2N1c2VkRWxlbSA9IHByaW9yU2VsZWN0aW9uSW5mb3JtYXRpb24uZm9jdXNlZEVsZW07CiAgICB2YXIgcHJpb3JTZWxlY3Rpb25SYW5nZSA9IHByaW9yU2VsZWN0aW9uSW5mb3JtYXRpb24uc2VsZWN0aW9uUmFuZ2U7CgogICAgaWYgKGN1ckZvY3VzZWRFbGVtICE9PSBwcmlvckZvY3VzZWRFbGVtICYmIGlzSW5Eb2N1bWVudChwcmlvckZvY3VzZWRFbGVtKSkgewogICAgICBpZiAocHJpb3JTZWxlY3Rpb25SYW5nZSAhPT0gbnVsbCAmJiBoYXNTZWxlY3Rpb25DYXBhYmlsaXRpZXMocHJpb3JGb2N1c2VkRWxlbSkpIHsKICAgICAgICBzZXRTZWxlY3Rpb24ocHJpb3JGb2N1c2VkRWxlbSwgcHJpb3JTZWxlY3Rpb25SYW5nZSk7CiAgICAgIH0gLy8gRm9jdXNpbmcgYSBub2RlIGNhbiBjaGFuZ2UgdGhlIHNjcm9sbCBwb3NpdGlvbiwgd2hpY2ggaXMgdW5kZXNpcmFibGUKCgogICAgICB2YXIgYW5jZXN0b3JzID0gW107CiAgICAgIHZhciBhbmNlc3RvciA9IHByaW9yRm9jdXNlZEVsZW07CgogICAgICB3aGlsZSAoYW5jZXN0b3IgPSBhbmNlc3Rvci5wYXJlbnROb2RlKSB7CiAgICAgICAgaWYgKGFuY2VzdG9yLm5vZGVUeXBlID09PSBFTEVNRU5UX05PREUpIHsKICAgICAgICAgIGFuY2VzdG9ycy5wdXNoKHsKICAgICAgICAgICAgZWxlbWVudDogYW5jZXN0b3IsCiAgICAgICAgICAgIGxlZnQ6IGFuY2VzdG9yLnNjcm9sbExlZnQsCiAgICAgICAgICAgIHRvcDogYW5jZXN0b3Iuc2Nyb2xsVG9wCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICh0eXBlb2YgcHJpb3JGb2N1c2VkRWxlbS5mb2N1cyA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIHByaW9yRm9jdXNlZEVsZW0uZm9jdXMoKTsKICAgICAgfQoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhbmNlc3RvcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICB2YXIgaW5mbyA9IGFuY2VzdG9yc1tpXTsKICAgICAgICBpbmZvLmVsZW1lbnQuc2Nyb2xsTGVmdCA9IGluZm8ubGVmdDsKICAgICAgICBpbmZvLmVsZW1lbnQuc2Nyb2xsVG9wID0gaW5mby50b3A7CiAgICAgIH0KICAgIH0KICB9CiAgLyoqCiAgICogQGdldFNlbGVjdGlvbjogR2V0cyB0aGUgc2VsZWN0aW9uIGJvdW5kcyBvZiBhIGZvY3VzZWQgdGV4dGFyZWEsIGlucHV0IG9yCiAgICogY29udGVudEVkaXRhYmxlIG5vZGUuCiAgICogLUBpbnB1dDogTG9vayB1cCBzZWxlY3Rpb24gYm91bmRzIG9mIHRoaXMgaW5wdXQKICAgKiAtQHJldHVybiB7c3RhcnQ6IHNlbGVjdGlvblN0YXJ0LCBlbmQ6IHNlbGVjdGlvbkVuZH0KICAgKi8KCiAgZnVuY3Rpb24gZ2V0U2VsZWN0aW9uKGlucHV0KSB7CiAgICB2YXIgc2VsZWN0aW9uOwoKICAgIGlmICgnc2VsZWN0aW9uU3RhcnQnIGluIGlucHV0KSB7CiAgICAgIC8vIE1vZGVybiBicm93c2VyIHdpdGggaW5wdXQgb3IgdGV4dGFyZWEuCiAgICAgIHNlbGVjdGlvbiA9IHsKICAgICAgICBzdGFydDogaW5wdXQuc2VsZWN0aW9uU3RhcnQsCiAgICAgICAgZW5kOiBpbnB1dC5zZWxlY3Rpb25FbmQKICAgICAgfTsKICAgIH0gZWxzZSB7CiAgICAgIC8vIENvbnRlbnQgZWRpdGFibGUgb3Igb2xkIElFIHRleHRhcmVhLgogICAgICBzZWxlY3Rpb24gPSBnZXRPZmZzZXRzKGlucHV0KTsKICAgIH0KCiAgICByZXR1cm4gc2VsZWN0aW9uIHx8IHsKICAgICAgc3RhcnQ6IDAsCiAgICAgIGVuZDogMAogICAgfTsKICB9CiAgLyoqCiAgICogQHNldFNlbGVjdGlvbjogU2V0cyB0aGUgc2VsZWN0aW9uIGJvdW5kcyBvZiBhIHRleHRhcmVhIG9yIGlucHV0IGFuZCBmb2N1c2VzCiAgICogdGhlIGlucHV0LgogICAqIC1AaW5wdXQgICAgIFNldCBzZWxlY3Rpb24gYm91bmRzIG9mIHRoaXMgaW5wdXQgb3IgdGV4dGFyZWEKICAgKiAtQG9mZnNldHMgICBPYmplY3Qgb2Ygc2FtZSBmb3JtIHRoYXQgaXMgcmV0dXJuZWQgZnJvbSBnZXQqCiAgICovCgogIGZ1bmN0aW9uIHNldFNlbGVjdGlvbihpbnB1dCwgb2Zmc2V0cykgewogICAgdmFyIHN0YXJ0ID0gb2Zmc2V0cy5zdGFydDsKICAgIHZhciBlbmQgPSBvZmZzZXRzLmVuZDsKCiAgICBpZiAoZW5kID09PSB1bmRlZmluZWQpIHsKICAgICAgZW5kID0gc3RhcnQ7CiAgICB9CgogICAgaWYgKCdzZWxlY3Rpb25TdGFydCcgaW4gaW5wdXQpIHsKICAgICAgaW5wdXQuc2VsZWN0aW9uU3RhcnQgPSBzdGFydDsKICAgICAgaW5wdXQuc2VsZWN0aW9uRW5kID0gTWF0aC5taW4oZW5kLCBpbnB1dC52YWx1ZS5sZW5ndGgpOwogICAgfSBlbHNlIHsKICAgICAgc2V0T2Zmc2V0cyhpbnB1dCwgb2Zmc2V0cyk7CiAgICB9CiAgfQoKICB2YXIgc2tpcFNlbGVjdGlvbkNoYW5nZUV2ZW50ID0gY2FuVXNlRE9NICYmICdkb2N1bWVudE1vZGUnIGluIGRvY3VtZW50ICYmIGRvY3VtZW50LmRvY3VtZW50TW9kZSA8PSAxMTsKCiAgZnVuY3Rpb24gcmVnaXN0ZXJFdmVudHMkMygpIHsKICAgIHJlZ2lzdGVyVHdvUGhhc2VFdmVudCgnb25TZWxlY3QnLCBbJ2ZvY3Vzb3V0JywgJ2NvbnRleHRtZW51JywgJ2RyYWdlbmQnLCAnZm9jdXNpbicsICdrZXlkb3duJywgJ2tleXVwJywgJ21vdXNlZG93bicsICdtb3VzZXVwJywgJ3NlbGVjdGlvbmNoYW5nZSddKTsKICB9CgogIHZhciBhY3RpdmVFbGVtZW50JDEgPSBudWxsOwogIHZhciBhY3RpdmVFbGVtZW50SW5zdCQxID0gbnVsbDsKICB2YXIgbGFzdFNlbGVjdGlvbiA9IG51bGw7CiAgdmFyIG1vdXNlRG93biA9IGZhbHNlOwogIC8qKgogICAqIEdldCBhbiBvYmplY3Qgd2hpY2ggaXMgYSB1bmlxdWUgcmVwcmVzZW50YXRpb24gb2YgdGhlIGN1cnJlbnQgc2VsZWN0aW9uLgogICAqCiAgICogVGhlIHJldHVybiB2YWx1ZSB3aWxsIG5vdCBiZSBjb25zaXN0ZW50IGFjcm9zcyBub2RlcyBvciBicm93c2VycywgYnV0CiAgICogdHdvIGlkZW50aWNhbCBzZWxlY3Rpb25zIG9uIHRoZSBzYW1lIG5vZGUgd2lsbCByZXR1cm4gaWRlbnRpY2FsIG9iamVjdHMuCiAgICovCgogIGZ1bmN0aW9uIGdldFNlbGVjdGlvbiQxKG5vZGUpIHsKICAgIGlmICgnc2VsZWN0aW9uU3RhcnQnIGluIG5vZGUgJiYgaGFzU2VsZWN0aW9uQ2FwYWJpbGl0aWVzKG5vZGUpKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgc3RhcnQ6IG5vZGUuc2VsZWN0aW9uU3RhcnQsCiAgICAgICAgZW5kOiBub2RlLnNlbGVjdGlvbkVuZAogICAgICB9OwogICAgfSBlbHNlIHsKICAgICAgdmFyIHdpbiA9IG5vZGUub3duZXJEb2N1bWVudCAmJiBub2RlLm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcgfHwgd2luZG93OwogICAgICB2YXIgc2VsZWN0aW9uID0gd2luLmdldFNlbGVjdGlvbigpOwogICAgICByZXR1cm4gewogICAgICAgIGFuY2hvck5vZGU6IHNlbGVjdGlvbi5hbmNob3JOb2RlLAogICAgICAgIGFuY2hvck9mZnNldDogc2VsZWN0aW9uLmFuY2hvck9mZnNldCwKICAgICAgICBmb2N1c05vZGU6IHNlbGVjdGlvbi5mb2N1c05vZGUsCiAgICAgICAgZm9jdXNPZmZzZXQ6IHNlbGVjdGlvbi5mb2N1c09mZnNldAogICAgICB9OwogICAgfQogIH0KICAvKioKICAgKiBHZXQgZG9jdW1lbnQgYXNzb2NpYXRlZCB3aXRoIHRoZSBldmVudCB0YXJnZXQuCiAgICovCgoKICBmdW5jdGlvbiBnZXRFdmVudFRhcmdldERvY3VtZW50KGV2ZW50VGFyZ2V0KSB7CiAgICByZXR1cm4gZXZlbnRUYXJnZXQud2luZG93ID09PSBldmVudFRhcmdldCA/IGV2ZW50VGFyZ2V0LmRvY3VtZW50IDogZXZlbnRUYXJnZXQubm9kZVR5cGUgPT09IERPQ1VNRU5UX05PREUgPyBldmVudFRhcmdldCA6IGV2ZW50VGFyZ2V0Lm93bmVyRG9jdW1lbnQ7CiAgfQogIC8qKgogICAqIFBvbGwgc2VsZWN0aW9uIHRvIHNlZSB3aGV0aGVyIGl0J3MgY2hhbmdlZC4KICAgKgogICAqIEBwYXJhbSB7b2JqZWN0fSBuYXRpdmVFdmVudAogICAqIEBwYXJhbSB7b2JqZWN0fSBuYXRpdmVFdmVudFRhcmdldAogICAqIEByZXR1cm4gez9TeW50aGV0aWNFdmVudH0KICAgKi8KCgogIGZ1bmN0aW9uIGNvbnN0cnVjdFNlbGVjdEV2ZW50KGRpc3BhdGNoUXVldWUsIG5hdGl2ZUV2ZW50LCBuYXRpdmVFdmVudFRhcmdldCkgewogICAgLy8gRW5zdXJlIHdlIGhhdmUgdGhlIHJpZ2h0IGVsZW1lbnQsIGFuZCB0aGF0IHRoZSB1c2VyIGlzIG5vdCBkcmFnZ2luZyBhCiAgICAvLyBzZWxlY3Rpb24gKHRoaXMgbWF0Y2hlcyBuYXRpdmUgYHNlbGVjdGAgZXZlbnQgYmVoYXZpb3IpLiBJbiBIVE1MNSwgc2VsZWN0CiAgICAvLyBmaXJlcyBvbmx5IG9uIGlucHV0IGFuZCB0ZXh0YXJlYSB0aHVzIGlmIHRoZXJlJ3Mgbm8gZm9jdXNlZCBlbGVtZW50IHdlCiAgICAvLyB3b24ndCBkaXNwYXRjaC4KICAgIHZhciBkb2MgPSBnZXRFdmVudFRhcmdldERvY3VtZW50KG5hdGl2ZUV2ZW50VGFyZ2V0KTsKCiAgICBpZiAobW91c2VEb3duIHx8IGFjdGl2ZUVsZW1lbnQkMSA9PSBudWxsIHx8IGFjdGl2ZUVsZW1lbnQkMSAhPT0gZ2V0QWN0aXZlRWxlbWVudChkb2MpKSB7CiAgICAgIHJldHVybjsKICAgIH0gLy8gT25seSBmaXJlIHdoZW4gc2VsZWN0aW9uIGhhcyBhY3R1YWxseSBjaGFuZ2VkLgoKCiAgICB2YXIgY3VycmVudFNlbGVjdGlvbiA9IGdldFNlbGVjdGlvbiQxKGFjdGl2ZUVsZW1lbnQkMSk7CgogICAgaWYgKCFsYXN0U2VsZWN0aW9uIHx8ICFzaGFsbG93RXF1YWwobGFzdFNlbGVjdGlvbiwgY3VycmVudFNlbGVjdGlvbikpIHsKICAgICAgbGFzdFNlbGVjdGlvbiA9IGN1cnJlbnRTZWxlY3Rpb247CiAgICAgIHZhciBsaXN0ZW5lcnMgPSBhY2N1bXVsYXRlVHdvUGhhc2VMaXN0ZW5lcnMoYWN0aXZlRWxlbWVudEluc3QkMSwgJ29uU2VsZWN0Jyk7CgogICAgICBpZiAobGlzdGVuZXJzLmxlbmd0aCA+IDApIHsKICAgICAgICB2YXIgZXZlbnQgPSBuZXcgU3ludGhldGljRXZlbnQoJ29uU2VsZWN0JywgJ3NlbGVjdCcsIG51bGwsIG5hdGl2ZUV2ZW50LCBuYXRpdmVFdmVudFRhcmdldCk7CiAgICAgICAgZGlzcGF0Y2hRdWV1ZS5wdXNoKHsKICAgICAgICAgIGV2ZW50OiBldmVudCwKICAgICAgICAgIGxpc3RlbmVyczogbGlzdGVuZXJzCiAgICAgICAgfSk7CiAgICAgICAgZXZlbnQudGFyZ2V0ID0gYWN0aXZlRWxlbWVudCQxOwogICAgICB9CiAgICB9CiAgfQogIC8qKgogICAqIFRoaXMgcGx1Z2luIGNyZWF0ZXMgYW4gYG9uU2VsZWN0YCBldmVudCB0aGF0IG5vcm1hbGl6ZXMgc2VsZWN0IGV2ZW50cwogICAqIGFjcm9zcyBmb3JtIGVsZW1lbnRzLgogICAqCiAgICogU3VwcG9ydGVkIGVsZW1lbnRzIGFyZToKICAgKiAtIGlucHV0IChzZWUgYGlzVGV4dElucHV0RWxlbWVudGApCiAgICogLSB0ZXh0YXJlYQogICAqIC0gY29udGVudEVkaXRhYmxlCiAgICoKICAgKiBUaGlzIGRpZmZlcnMgZnJvbSBuYXRpdmUgYnJvd3NlciBpbXBsZW1lbnRhdGlvbnMgaW4gdGhlIGZvbGxvd2luZyB3YXlzOgogICAqIC0gRmlyZXMgb24gY29udGVudEVkaXRhYmxlIGZpZWxkcyBhcyB3ZWxsIGFzIGlucHV0cy4KICAgKiAtIEZpcmVzIGZvciBjb2xsYXBzZWQgc2VsZWN0aW9uLgogICAqIC0gRmlyZXMgYWZ0ZXIgdXNlciBpbnB1dC4KICAgKi8KCgogIGZ1bmN0aW9uIGV4dHJhY3RFdmVudHMkMyhkaXNwYXRjaFF1ZXVlLCBkb21FdmVudE5hbWUsIHRhcmdldEluc3QsIG5hdGl2ZUV2ZW50LCBuYXRpdmVFdmVudFRhcmdldCwgZXZlbnRTeXN0ZW1GbGFncywgdGFyZ2V0Q29udGFpbmVyKSB7CiAgICB2YXIgdGFyZ2V0Tm9kZSA9IHRhcmdldEluc3QgPyBnZXROb2RlRnJvbUluc3RhbmNlKHRhcmdldEluc3QpIDogd2luZG93OwoKICAgIHN3aXRjaCAoZG9tRXZlbnROYW1lKSB7CiAgICAgIC8vIFRyYWNrIHRoZSBpbnB1dCBub2RlIHRoYXQgaGFzIGZvY3VzLgogICAgICBjYXNlICdmb2N1c2luJzoKICAgICAgICBpZiAoaXNUZXh0SW5wdXRFbGVtZW50KHRhcmdldE5vZGUpIHx8IHRhcmdldE5vZGUuY29udGVudEVkaXRhYmxlID09PSAndHJ1ZScpIHsKICAgICAgICAgIGFjdGl2ZUVsZW1lbnQkMSA9IHRhcmdldE5vZGU7CiAgICAgICAgICBhY3RpdmVFbGVtZW50SW5zdCQxID0gdGFyZ2V0SW5zdDsKICAgICAgICAgIGxhc3RTZWxlY3Rpb24gPSBudWxsOwogICAgICAgIH0KCiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICdmb2N1c291dCc6CiAgICAgICAgYWN0aXZlRWxlbWVudCQxID0gbnVsbDsKICAgICAgICBhY3RpdmVFbGVtZW50SW5zdCQxID0gbnVsbDsKICAgICAgICBsYXN0U2VsZWN0aW9uID0gbnVsbDsKICAgICAgICBicmVhazsKICAgICAgLy8gRG9uJ3QgZmlyZSB0aGUgZXZlbnQgd2hpbGUgdGhlIHVzZXIgaXMgZHJhZ2dpbmcuIFRoaXMgbWF0Y2hlcyB0aGUKICAgICAgLy8gc2VtYW50aWNzIG9mIHRoZSBuYXRpdmUgc2VsZWN0IGV2ZW50LgoKICAgICAgY2FzZSAnbW91c2Vkb3duJzoKICAgICAgICBtb3VzZURvd24gPSB0cnVlOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnY29udGV4dG1lbnUnOgogICAgICBjYXNlICdtb3VzZXVwJzoKICAgICAgY2FzZSAnZHJhZ2VuZCc6CiAgICAgICAgbW91c2VEb3duID0gZmFsc2U7CiAgICAgICAgY29uc3RydWN0U2VsZWN0RXZlbnQoZGlzcGF0Y2hRdWV1ZSwgbmF0aXZlRXZlbnQsIG5hdGl2ZUV2ZW50VGFyZ2V0KTsKICAgICAgICBicmVhazsKICAgICAgLy8gQ2hyb21lIGFuZCBJRSBmaXJlIG5vbi1zdGFuZGFyZCBldmVudCB3aGVuIHNlbGVjdGlvbiBpcyBjaGFuZ2VkIChhbmQKICAgICAgLy8gc29tZXRpbWVzIHdoZW4gaXQgaGFzbid0KS4gSUUncyBldmVudCBmaXJlcyBvdXQgb2Ygb3JkZXIgd2l0aCByZXNwZWN0CiAgICAgIC8vIHRvIGtleSBhbmQgaW5wdXQgZXZlbnRzIG9uIGRlbGV0aW9uLCBzbyB3ZSBkaXNjYXJkIGl0LgogICAgICAvLwogICAgICAvLyBGaXJlZm94IGRvZXNuJ3Qgc3VwcG9ydCBzZWxlY3Rpb25jaGFuZ2UsIHNvIGNoZWNrIHNlbGVjdGlvbiBzdGF0dXMKICAgICAgLy8gYWZ0ZXIgZWFjaCBrZXkgZW50cnkuIFRoZSBzZWxlY3Rpb24gY2hhbmdlcyBhZnRlciBrZXlkb3duIGFuZCBiZWZvcmUKICAgICAgLy8ga2V5dXAsIGJ1dCB3ZSBjaGVjayBvbiBrZXlkb3duIGFzIHdlbGwgaW4gdGhlIGNhc2Ugb2YgaG9sZGluZyBkb3duIGEKICAgICAgLy8ga2V5LCB3aGVuIG11bHRpcGxlIGtleWRvd24gZXZlbnRzIGFyZSBmaXJlZCBidXQgb25seSBvbmUga2V5dXAgaXMuCiAgICAgIC8vIFRoaXMgaXMgYWxzbyBvdXIgYXBwcm9hY2ggZm9yIElFIGhhbmRsaW5nLCBmb3IgdGhlIHJlYXNvbiBhYm92ZS4KCiAgICAgIGNhc2UgJ3NlbGVjdGlvbmNoYW5nZSc6CiAgICAgICAgaWYgKHNraXBTZWxlY3Rpb25DaGFuZ2VFdmVudCkgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgLy8gZmFsbHMgdGhyb3VnaAoKICAgICAgY2FzZSAna2V5ZG93bic6CiAgICAgIGNhc2UgJ2tleXVwJzoKICAgICAgICBjb25zdHJ1Y3RTZWxlY3RFdmVudChkaXNwYXRjaFF1ZXVlLCBuYXRpdmVFdmVudCwgbmF0aXZlRXZlbnRUYXJnZXQpOwogICAgfQogIH0KCiAgLyoqCiAgICogR2VuZXJhdGUgYSBtYXBwaW5nIG9mIHN0YW5kYXJkIHZlbmRvciBwcmVmaXhlcyB1c2luZyB0aGUgZGVmaW5lZCBzdHlsZSBwcm9wZXJ0eSBhbmQgZXZlbnQgbmFtZS4KICAgKgogICAqIEBwYXJhbSB7c3RyaW5nfSBzdHlsZVByb3AKICAgKiBAcGFyYW0ge3N0cmluZ30gZXZlbnROYW1lCiAgICogQHJldHVybnMge29iamVjdH0KICAgKi8KCiAgZnVuY3Rpb24gbWFrZVByZWZpeE1hcChzdHlsZVByb3AsIGV2ZW50TmFtZSkgewogICAgdmFyIHByZWZpeGVzID0ge307CiAgICBwcmVmaXhlc1tzdHlsZVByb3AudG9Mb3dlckNhc2UoKV0gPSBldmVudE5hbWUudG9Mb3dlckNhc2UoKTsKICAgIHByZWZpeGVzWydXZWJraXQnICsgc3R5bGVQcm9wXSA9ICd3ZWJraXQnICsgZXZlbnROYW1lOwogICAgcHJlZml4ZXNbJ01veicgKyBzdHlsZVByb3BdID0gJ21veicgKyBldmVudE5hbWU7CiAgICByZXR1cm4gcHJlZml4ZXM7CiAgfQogIC8qKgogICAqIEEgbGlzdCBvZiBldmVudCBuYW1lcyB0byBhIGNvbmZpZ3VyYWJsZSBsaXN0IG9mIHZlbmRvciBwcmVmaXhlcy4KICAgKi8KCgogIHZhciB2ZW5kb3JQcmVmaXhlcyA9IHsKICAgIGFuaW1hdGlvbmVuZDogbWFrZVByZWZpeE1hcCgnQW5pbWF0aW9uJywgJ0FuaW1hdGlvbkVuZCcpLAogICAgYW5pbWF0aW9uaXRlcmF0aW9uOiBtYWtlUHJlZml4TWFwKCdBbmltYXRpb24nLCAnQW5pbWF0aW9uSXRlcmF0aW9uJyksCiAgICBhbmltYXRpb25zdGFydDogbWFrZVByZWZpeE1hcCgnQW5pbWF0aW9uJywgJ0FuaW1hdGlvblN0YXJ0JyksCiAgICB0cmFuc2l0aW9uZW5kOiBtYWtlUHJlZml4TWFwKCdUcmFuc2l0aW9uJywgJ1RyYW5zaXRpb25FbmQnKQogIH07CiAgLyoqCiAgICogRXZlbnQgbmFtZXMgdGhhdCBoYXZlIGFscmVhZHkgYmVlbiBkZXRlY3RlZCBhbmQgcHJlZml4ZWQgKGlmIGFwcGxpY2FibGUpLgogICAqLwoKICB2YXIgcHJlZml4ZWRFdmVudE5hbWVzID0ge307CiAgLyoqCiAgICogRWxlbWVudCB0byBjaGVjayBmb3IgcHJlZml4ZXMgb24uCiAgICovCgogIHZhciBzdHlsZSA9IHt9OwogIC8qKgogICAqIEJvb3RzdHJhcCBpZiBhIERPTSBleGlzdHMuCiAgICovCgogIGlmIChjYW5Vc2VET00pIHsKICAgIHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jykuc3R5bGU7IC8vIE9uIHNvbWUgcGxhdGZvcm1zLCBpbiBwYXJ0aWN1bGFyIHNvbWUgcmVsZWFzZXMgb2YgQW5kcm9pZCA0LngsCiAgICAvLyB0aGUgdW4tcHJlZml4ZWQgImFuaW1hdGlvbiIgYW5kICJ0cmFuc2l0aW9uIiBwcm9wZXJ0aWVzIGFyZSBkZWZpbmVkIG9uIHRoZQogICAgLy8gc3R5bGUgb2JqZWN0IGJ1dCB0aGUgZXZlbnRzIHRoYXQgZmlyZSB3aWxsIHN0aWxsIGJlIHByZWZpeGVkLCBzbyB3ZSBuZWVkCiAgICAvLyB0byBjaGVjayBpZiB0aGUgdW4tcHJlZml4ZWQgZXZlbnRzIGFyZSB1c2FibGUsIGFuZCBpZiBub3QgcmVtb3ZlIHRoZW0gZnJvbSB0aGUgbWFwLgoKICAgIGlmICghKCdBbmltYXRpb25FdmVudCcgaW4gd2luZG93KSkgewogICAgICBkZWxldGUgdmVuZG9yUHJlZml4ZXMuYW5pbWF0aW9uZW5kLmFuaW1hdGlvbjsKICAgICAgZGVsZXRlIHZlbmRvclByZWZpeGVzLmFuaW1hdGlvbml0ZXJhdGlvbi5hbmltYXRpb247CiAgICAgIGRlbGV0ZSB2ZW5kb3JQcmVmaXhlcy5hbmltYXRpb25zdGFydC5hbmltYXRpb247CiAgICB9IC8vIFNhbWUgYXMgYWJvdmUKCgogICAgaWYgKCEoJ1RyYW5zaXRpb25FdmVudCcgaW4gd2luZG93KSkgewogICAgICBkZWxldGUgdmVuZG9yUHJlZml4ZXMudHJhbnNpdGlvbmVuZC50cmFuc2l0aW9uOwogICAgfQogIH0KICAvKioKICAgKiBBdHRlbXB0cyB0byBkZXRlcm1pbmUgdGhlIGNvcnJlY3QgdmVuZG9yIHByZWZpeGVkIGV2ZW50IG5hbWUuCiAgICoKICAgKiBAcGFyYW0ge3N0cmluZ30gZXZlbnROYW1lCiAgICogQHJldHVybnMge3N0cmluZ30KICAgKi8KCgogIGZ1bmN0aW9uIGdldFZlbmRvclByZWZpeGVkRXZlbnROYW1lKGV2ZW50TmFtZSkgewogICAgaWYgKHByZWZpeGVkRXZlbnROYW1lc1tldmVudE5hbWVdKSB7CiAgICAgIHJldHVybiBwcmVmaXhlZEV2ZW50TmFtZXNbZXZlbnROYW1lXTsKICAgIH0gZWxzZSBpZiAoIXZlbmRvclByZWZpeGVzW2V2ZW50TmFtZV0pIHsKICAgICAgcmV0dXJuIGV2ZW50TmFtZTsKICAgIH0KCiAgICB2YXIgcHJlZml4TWFwID0gdmVuZG9yUHJlZml4ZXNbZXZlbnROYW1lXTsKCiAgICBmb3IgKHZhciBzdHlsZVByb3AgaW4gcHJlZml4TWFwKSB7CiAgICAgIGlmIChwcmVmaXhNYXAuaGFzT3duUHJvcGVydHkoc3R5bGVQcm9wKSAmJiBzdHlsZVByb3AgaW4gc3R5bGUpIHsKICAgICAgICByZXR1cm4gcHJlZml4ZWRFdmVudE5hbWVzW2V2ZW50TmFtZV0gPSBwcmVmaXhNYXBbc3R5bGVQcm9wXTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBldmVudE5hbWU7CiAgfQoKICB2YXIgQU5JTUFUSU9OX0VORCA9IGdldFZlbmRvclByZWZpeGVkRXZlbnROYW1lKCdhbmltYXRpb25lbmQnKTsKICB2YXIgQU5JTUFUSU9OX0lURVJBVElPTiA9IGdldFZlbmRvclByZWZpeGVkRXZlbnROYW1lKCdhbmltYXRpb25pdGVyYXRpb24nKTsKICB2YXIgQU5JTUFUSU9OX1NUQVJUID0gZ2V0VmVuZG9yUHJlZml4ZWRFdmVudE5hbWUoJ2FuaW1hdGlvbnN0YXJ0Jyk7CiAgdmFyIFRSQU5TSVRJT05fRU5EID0gZ2V0VmVuZG9yUHJlZml4ZWRFdmVudE5hbWUoJ3RyYW5zaXRpb25lbmQnKTsKCiAgdmFyIHRvcExldmVsRXZlbnRzVG9SZWFjdE5hbWVzID0gbmV3IE1hcCgpOyAvLyBOT1RFOiBDYXBpdGFsaXphdGlvbiBpcyBpbXBvcnRhbnQgaW4gdGhpcyBsaXN0IQogIC8vCiAgLy8gRS5nLiBpdCBuZWVkcyAicG9pbnRlckRvd24iLCBub3QgInBvaW50ZXJkb3duIi4KICAvLyBUaGlzIGlzIGJlY2F1c2Ugd2UgZGVyaXZlIGJvdGggUmVhY3QgbmFtZSAoIm9uUG9pbnRlckRvd24iKQogIC8vIGFuZCBET00gbmFtZSAoInBvaW50ZXJkb3duIikgZnJvbSB0aGUgc2FtZSBsaXN0LgogIC8vCiAgLy8gRXhjZXB0aW9ucyB0aGF0IGRvbid0IG1hdGNoIHRoaXMgY29udmVudGlvbiBhcmUgbGlzdGVkIHNlcGFyYXRlbHkuCiAgLy8KICAvLyBwcmV0dGllci1pZ25vcmUKCiAgdmFyIHNpbXBsZUV2ZW50UGx1Z2luRXZlbnRzID0gWydhYm9ydCcsICdhdXhDbGljaycsICdjYW5jZWwnLCAnY2FuUGxheScsICdjYW5QbGF5VGhyb3VnaCcsICdjbGljaycsICdjbG9zZScsICdjb250ZXh0TWVudScsICdjb3B5JywgJ2N1dCcsICdkcmFnJywgJ2RyYWdFbmQnLCAnZHJhZ0VudGVyJywgJ2RyYWdFeGl0JywgJ2RyYWdMZWF2ZScsICdkcmFnT3ZlcicsICdkcmFnU3RhcnQnLCAnZHJvcCcsICdkdXJhdGlvbkNoYW5nZScsICdlbXB0aWVkJywgJ2VuY3J5cHRlZCcsICdlbmRlZCcsICdlcnJvcicsICdnb3RQb2ludGVyQ2FwdHVyZScsICdpbnB1dCcsICdpbnZhbGlkJywgJ2tleURvd24nLCAna2V5UHJlc3MnLCAna2V5VXAnLCAnbG9hZCcsICdsb2FkZWREYXRhJywgJ2xvYWRlZE1ldGFkYXRhJywgJ2xvYWRTdGFydCcsICdsb3N0UG9pbnRlckNhcHR1cmUnLCAnbW91c2VEb3duJywgJ21vdXNlTW92ZScsICdtb3VzZU91dCcsICdtb3VzZU92ZXInLCAnbW91c2VVcCcsICdwYXN0ZScsICdwYXVzZScsICdwbGF5JywgJ3BsYXlpbmcnLCAncG9pbnRlckNhbmNlbCcsICdwb2ludGVyRG93bicsICdwb2ludGVyTW92ZScsICdwb2ludGVyT3V0JywgJ3BvaW50ZXJPdmVyJywgJ3BvaW50ZXJVcCcsICdwcm9ncmVzcycsICdyYXRlQ2hhbmdlJywgJ3Jlc2V0JywgJ3Jlc2l6ZScsICdzZWVrZWQnLCAnc2Vla2luZycsICdzdGFsbGVkJywgJ3N1Ym1pdCcsICdzdXNwZW5kJywgJ3RpbWVVcGRhdGUnLCAndG91Y2hDYW5jZWwnLCAndG91Y2hFbmQnLCAndG91Y2hTdGFydCcsICd2b2x1bWVDaGFuZ2UnLCAnc2Nyb2xsJywgJ3RvZ2dsZScsICd0b3VjaE1vdmUnLCAnd2FpdGluZycsICd3aGVlbCddOwoKICBmdW5jdGlvbiByZWdpc3RlclNpbXBsZUV2ZW50KGRvbUV2ZW50TmFtZSwgcmVhY3ROYW1lKSB7CiAgICB0b3BMZXZlbEV2ZW50c1RvUmVhY3ROYW1lcy5zZXQoZG9tRXZlbnROYW1lLCByZWFjdE5hbWUpOwogICAgcmVnaXN0ZXJUd29QaGFzZUV2ZW50KHJlYWN0TmFtZSwgW2RvbUV2ZW50TmFtZV0pOwogIH0KCiAgZnVuY3Rpb24gcmVnaXN0ZXJTaW1wbGVFdmVudHMoKSB7CiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNpbXBsZUV2ZW50UGx1Z2luRXZlbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgIHZhciBldmVudE5hbWUgPSBzaW1wbGVFdmVudFBsdWdpbkV2ZW50c1tpXTsKICAgICAgdmFyIGRvbUV2ZW50TmFtZSA9IGV2ZW50TmFtZS50b0xvd2VyQ2FzZSgpOwogICAgICB2YXIgY2FwaXRhbGl6ZWRFdmVudCA9IGV2ZW50TmFtZVswXS50b1VwcGVyQ2FzZSgpICsgZXZlbnROYW1lLnNsaWNlKDEpOwogICAgICByZWdpc3RlclNpbXBsZUV2ZW50KGRvbUV2ZW50TmFtZSwgJ29uJyArIGNhcGl0YWxpemVkRXZlbnQpOwogICAgfSAvLyBTcGVjaWFsIGNhc2VzIHdoZXJlIGV2ZW50IG5hbWVzIGRvbid0IG1hdGNoLgoKCiAgICByZWdpc3RlclNpbXBsZUV2ZW50KEFOSU1BVElPTl9FTkQsICdvbkFuaW1hdGlvbkVuZCcpOwogICAgcmVnaXN0ZXJTaW1wbGVFdmVudChBTklNQVRJT05fSVRFUkFUSU9OLCAnb25BbmltYXRpb25JdGVyYXRpb24nKTsKICAgIHJlZ2lzdGVyU2ltcGxlRXZlbnQoQU5JTUFUSU9OX1NUQVJULCAnb25BbmltYXRpb25TdGFydCcpOwogICAgcmVnaXN0ZXJTaW1wbGVFdmVudCgnZGJsY2xpY2snLCAnb25Eb3VibGVDbGljaycpOwogICAgcmVnaXN0ZXJTaW1wbGVFdmVudCgnZm9jdXNpbicsICdvbkZvY3VzJyk7CiAgICByZWdpc3RlclNpbXBsZUV2ZW50KCdmb2N1c291dCcsICdvbkJsdXInKTsKICAgIHJlZ2lzdGVyU2ltcGxlRXZlbnQoVFJBTlNJVElPTl9FTkQsICdvblRyYW5zaXRpb25FbmQnKTsKICB9CgogIGZ1bmN0aW9uIGV4dHJhY3RFdmVudHMkNChkaXNwYXRjaFF1ZXVlLCBkb21FdmVudE5hbWUsIHRhcmdldEluc3QsIG5hdGl2ZUV2ZW50LCBuYXRpdmVFdmVudFRhcmdldCwgZXZlbnRTeXN0ZW1GbGFncywgdGFyZ2V0Q29udGFpbmVyKSB7CiAgICB2YXIgcmVhY3ROYW1lID0gdG9wTGV2ZWxFdmVudHNUb1JlYWN0TmFtZXMuZ2V0KGRvbUV2ZW50TmFtZSk7CgogICAgaWYgKHJlYWN0TmFtZSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB2YXIgU3ludGhldGljRXZlbnRDdG9yID0gU3ludGhldGljRXZlbnQ7CiAgICB2YXIgcmVhY3RFdmVudFR5cGUgPSBkb21FdmVudE5hbWU7CgogICAgc3dpdGNoIChkb21FdmVudE5hbWUpIHsKICAgICAgY2FzZSAna2V5cHJlc3MnOgogICAgICAgIC8vIEZpcmVmb3ggY3JlYXRlcyBhIGtleXByZXNzIGV2ZW50IGZvciBmdW5jdGlvbiBrZXlzIHRvby4gVGhpcyByZW1vdmVzCiAgICAgICAgLy8gdGhlIHVud2FudGVkIGtleXByZXNzIGV2ZW50cy4gRW50ZXIgaXMgaG93ZXZlciBib3RoIHByaW50YWJsZSBhbmQKICAgICAgICAvLyBub24tcHJpbnRhYmxlLiBPbmUgd291bGQgZXhwZWN0IFRhYiB0byBiZSBhcyB3ZWxsIChidXQgaXQgaXNuJ3QpLgogICAgICAgIGlmIChnZXRFdmVudENoYXJDb2RlKG5hdGl2ZUV2ZW50KSA9PT0gMCkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgIC8qIGZhbGxzIHRocm91Z2ggKi8KCiAgICAgIGNhc2UgJ2tleWRvd24nOgogICAgICBjYXNlICdrZXl1cCc6CiAgICAgICAgU3ludGhldGljRXZlbnRDdG9yID0gU3ludGhldGljS2V5Ym9hcmRFdmVudDsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ2ZvY3VzaW4nOgogICAgICAgIHJlYWN0RXZlbnRUeXBlID0gJ2ZvY3VzJzsKICAgICAgICBTeW50aGV0aWNFdmVudEN0b3IgPSBTeW50aGV0aWNGb2N1c0V2ZW50OwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnZm9jdXNvdXQnOgogICAgICAgIHJlYWN0RXZlbnRUeXBlID0gJ2JsdXInOwogICAgICAgIFN5bnRoZXRpY0V2ZW50Q3RvciA9IFN5bnRoZXRpY0ZvY3VzRXZlbnQ7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICdiZWZvcmVibHVyJzoKICAgICAgY2FzZSAnYWZ0ZXJibHVyJzoKICAgICAgICBTeW50aGV0aWNFdmVudEN0b3IgPSBTeW50aGV0aWNGb2N1c0V2ZW50OwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnY2xpY2snOgogICAgICAgIC8vIEZpcmVmb3ggY3JlYXRlcyBhIGNsaWNrIGV2ZW50IG9uIHJpZ2h0IG1vdXNlIGNsaWNrcy4gVGhpcyByZW1vdmVzIHRoZQogICAgICAgIC8vIHVud2FudGVkIGNsaWNrIGV2ZW50cy4KICAgICAgICBpZiAobmF0aXZlRXZlbnQuYnV0dG9uID09PSAyKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgLyogZmFsbHMgdGhyb3VnaCAqLwoKICAgICAgY2FzZSAnYXV4Y2xpY2snOgogICAgICBjYXNlICdkYmxjbGljayc6CiAgICAgIGNhc2UgJ21vdXNlZG93bic6CiAgICAgIGNhc2UgJ21vdXNlbW92ZSc6CiAgICAgIGNhc2UgJ21vdXNldXAnOiAvLyBUT0RPOiBEaXNhYmxlZCBlbGVtZW50cyBzaG91bGQgbm90IHJlc3BvbmQgdG8gbW91c2UgZXZlbnRzCgogICAgICAvKiBmYWxscyB0aHJvdWdoICovCgogICAgICBjYXNlICdtb3VzZW91dCc6CiAgICAgIGNhc2UgJ21vdXNlb3Zlcic6CiAgICAgIGNhc2UgJ2NvbnRleHRtZW51JzoKICAgICAgICBTeW50aGV0aWNFdmVudEN0b3IgPSBTeW50aGV0aWNNb3VzZUV2ZW50OwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnZHJhZyc6CiAgICAgIGNhc2UgJ2RyYWdlbmQnOgogICAgICBjYXNlICdkcmFnZW50ZXInOgogICAgICBjYXNlICdkcmFnZXhpdCc6CiAgICAgIGNhc2UgJ2RyYWdsZWF2ZSc6CiAgICAgIGNhc2UgJ2RyYWdvdmVyJzoKICAgICAgY2FzZSAnZHJhZ3N0YXJ0JzoKICAgICAgY2FzZSAnZHJvcCc6CiAgICAgICAgU3ludGhldGljRXZlbnRDdG9yID0gU3ludGhldGljRHJhZ0V2ZW50OwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAndG91Y2hjYW5jZWwnOgogICAgICBjYXNlICd0b3VjaGVuZCc6CiAgICAgIGNhc2UgJ3RvdWNobW92ZSc6CiAgICAgIGNhc2UgJ3RvdWNoc3RhcnQnOgogICAgICAgIFN5bnRoZXRpY0V2ZW50Q3RvciA9IFN5bnRoZXRpY1RvdWNoRXZlbnQ7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIEFOSU1BVElPTl9FTkQ6CiAgICAgIGNhc2UgQU5JTUFUSU9OX0lURVJBVElPTjoKICAgICAgY2FzZSBBTklNQVRJT05fU1RBUlQ6CiAgICAgICAgU3ludGhldGljRXZlbnRDdG9yID0gU3ludGhldGljQW5pbWF0aW9uRXZlbnQ7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIFRSQU5TSVRJT05fRU5EOgogICAgICAgIFN5bnRoZXRpY0V2ZW50Q3RvciA9IFN5bnRoZXRpY1RyYW5zaXRpb25FdmVudDsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ3Njcm9sbCc6CiAgICAgICAgU3ludGhldGljRXZlbnRDdG9yID0gU3ludGhldGljVUlFdmVudDsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ3doZWVsJzoKICAgICAgICBTeW50aGV0aWNFdmVudEN0b3IgPSBTeW50aGV0aWNXaGVlbEV2ZW50OwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnY29weSc6CiAgICAgIGNhc2UgJ2N1dCc6CiAgICAgIGNhc2UgJ3Bhc3RlJzoKICAgICAgICBTeW50aGV0aWNFdmVudEN0b3IgPSBTeW50aGV0aWNDbGlwYm9hcmRFdmVudDsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ2dvdHBvaW50ZXJjYXB0dXJlJzoKICAgICAgY2FzZSAnbG9zdHBvaW50ZXJjYXB0dXJlJzoKICAgICAgY2FzZSAncG9pbnRlcmNhbmNlbCc6CiAgICAgIGNhc2UgJ3BvaW50ZXJkb3duJzoKICAgICAgY2FzZSAncG9pbnRlcm1vdmUnOgogICAgICBjYXNlICdwb2ludGVyb3V0JzoKICAgICAgY2FzZSAncG9pbnRlcm92ZXInOgogICAgICBjYXNlICdwb2ludGVydXAnOgogICAgICAgIFN5bnRoZXRpY0V2ZW50Q3RvciA9IFN5bnRoZXRpY1BvaW50ZXJFdmVudDsKICAgICAgICBicmVhazsKICAgIH0KCiAgICB2YXIgaW5DYXB0dXJlUGhhc2UgPSAoZXZlbnRTeXN0ZW1GbGFncyAmIElTX0NBUFRVUkVfUEhBU0UpICE9PSAwOwoKICAgIHsKICAgICAgLy8gU29tZSBldmVudHMgZG9uJ3QgYnViYmxlIGluIHRoZSBicm93c2VyLgogICAgICAvLyBJbiB0aGUgcGFzdCwgUmVhY3QgaGFzIGFsd2F5cyBidWJibGVkIHRoZW0sIGJ1dCB0aGlzIGNhbiBiZSBzdXJwcmlzaW5nLgogICAgICAvLyBXZSdyZSBnb2luZyB0byB0cnkgYWxpZ25pbmcgY2xvc2VyIHRvIHRoZSBicm93c2VyIGJlaGF2aW9yIGJ5IG5vdCBidWJibGluZwogICAgICAvLyB0aGVtIGluIFJlYWN0IGVpdGhlci4gV2UnbGwgc3RhcnQgYnkgbm90IGJ1YmJsaW5nIG9uU2Nyb2xsLCBhbmQgdGhlbiBleHBhbmQuCiAgICAgIHZhciBhY2N1bXVsYXRlVGFyZ2V0T25seSA9ICFpbkNhcHR1cmVQaGFzZSAmJiAvLyBUT0RPOiBpZGVhbGx5LCB3ZSdkIGV2ZW50dWFsbHkgYWRkIGFsbCBldmVudHMgZnJvbQogICAgICAvLyBub25EZWxlZ2F0ZWRFdmVudHMgbGlzdCBpbiBET01QbHVnaW5FdmVudFN5c3RlbS4KICAgICAgLy8gVGhlbiB3ZSBjYW4gcmVtb3ZlIHRoaXMgc3BlY2lhbCBsaXN0LgogICAgICAvLyBUaGlzIGlzIGEgYnJlYWtpbmcgY2hhbmdlIHRoYXQgY2FuIHdhaXQgdW50aWwgUmVhY3QgMTguCiAgICAgIGRvbUV2ZW50TmFtZSA9PT0gJ3Njcm9sbCc7CgogICAgICB2YXIgX2xpc3RlbmVycyA9IGFjY3VtdWxhdGVTaW5nbGVQaGFzZUxpc3RlbmVycyh0YXJnZXRJbnN0LCByZWFjdE5hbWUsIG5hdGl2ZUV2ZW50LnR5cGUsIGluQ2FwdHVyZVBoYXNlLCBhY2N1bXVsYXRlVGFyZ2V0T25seSk7CgogICAgICBpZiAoX2xpc3RlbmVycy5sZW5ndGggPiAwKSB7CiAgICAgICAgLy8gSW50ZW50aW9uYWxseSBjcmVhdGUgZXZlbnQgbGF6aWx5LgogICAgICAgIHZhciBfZXZlbnQgPSBuZXcgU3ludGhldGljRXZlbnRDdG9yKHJlYWN0TmFtZSwgcmVhY3RFdmVudFR5cGUsIG51bGwsIG5hdGl2ZUV2ZW50LCBuYXRpdmVFdmVudFRhcmdldCk7CgogICAgICAgIGRpc3BhdGNoUXVldWUucHVzaCh7CiAgICAgICAgICBldmVudDogX2V2ZW50LAogICAgICAgICAgbGlzdGVuZXJzOiBfbGlzdGVuZXJzCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9CgogIC8vIFRPRE86IHJlbW92ZSB0b3AtbGV2ZWwgc2lkZSBlZmZlY3QuCiAgcmVnaXN0ZXJTaW1wbGVFdmVudHMoKTsKICByZWdpc3RlckV2ZW50cyQyKCk7CiAgcmVnaXN0ZXJFdmVudHMkMSgpOwogIHJlZ2lzdGVyRXZlbnRzJDMoKTsKICByZWdpc3RlckV2ZW50cygpOwoKICBmdW5jdGlvbiBleHRyYWN0RXZlbnRzJDUoZGlzcGF0Y2hRdWV1ZSwgZG9tRXZlbnROYW1lLCB0YXJnZXRJbnN0LCBuYXRpdmVFdmVudCwgbmF0aXZlRXZlbnRUYXJnZXQsIGV2ZW50U3lzdGVtRmxhZ3MsIHRhcmdldENvbnRhaW5lcikgewogICAgLy8gVE9ETzogd2Ugc2hvdWxkIHJlbW92ZSB0aGUgY29uY2VwdCBvZiBhICJTaW1wbGVFdmVudFBsdWdpbiIuCiAgICAvLyBUaGlzIGlzIHRoZSBiYXNpYyBmdW5jdGlvbmFsaXR5IG9mIHRoZSBldmVudCBzeXN0ZW0uIEFsbAogICAgLy8gdGhlIG90aGVyIHBsdWdpbnMgYXJlIGVzc2VudGlhbGx5IHBvbHlmaWxscy4gU28gdGhlIHBsdWdpbgogICAgLy8gc2hvdWxkIHByb2JhYmx5IGJlIGlubGluZWQgc29tZXdoZXJlIGFuZCBoYXZlIGl0cyBsb2dpYwogICAgLy8gYmUgY29yZSB0aGUgdG8gZXZlbnQgc3lzdGVtLiBUaGlzIHdvdWxkIHBvdGVudGlhbGx5IGFsbG93CiAgICAvLyB1cyB0byBzaGlwIGJ1aWxkcyBvZiBSZWFjdCB3aXRob3V0IHRoZSBwb2x5ZmlsbGVkIHBsdWdpbnMgYmVsb3cuCiAgICBleHRyYWN0RXZlbnRzJDQoZGlzcGF0Y2hRdWV1ZSwgZG9tRXZlbnROYW1lLCB0YXJnZXRJbnN0LCBuYXRpdmVFdmVudCwgbmF0aXZlRXZlbnRUYXJnZXQsIGV2ZW50U3lzdGVtRmxhZ3MpOwogICAgdmFyIHNob3VsZFByb2Nlc3NQb2x5ZmlsbFBsdWdpbnMgPSAoZXZlbnRTeXN0ZW1GbGFncyAmIFNIT1VMRF9OT1RfUFJPQ0VTU19QT0xZRklMTF9FVkVOVF9QTFVHSU5TKSA9PT0gMDsgLy8gV2UgZG9uJ3QgcHJvY2VzcyB0aGVzZSBldmVudHMgdW5sZXNzIHdlIGFyZSBpbiB0aGUKICAgIC8vIGV2ZW50J3MgbmF0aXZlICJidWJibGUiIHBoYXNlLCB3aGljaCBtZWFucyB0aGF0IHdlJ3JlCiAgICAvLyBub3QgaW4gdGhlIGNhcHR1cmUgcGhhc2UuIFRoYXQncyBiZWNhdXNlIHdlIGVtdWxhdGUKICAgIC8vIHRoZSBjYXB0dXJlIHBoYXNlIGhlcmUgc3RpbGwuIFRoaXMgaXMgYSB0cmFkZS1vZmYsCiAgICAvLyBiZWNhdXNlIGluIGFuIGlkZWFsIHdvcmxkIHdlIHdvdWxkIG5vdCBlbXVsYXRlIGFuZCB1c2UKICAgIC8vIHRoZSBwaGFzZXMgcHJvcGVybHksIGxpa2Ugd2UgZG8gd2l0aCB0aGUgU2ltcGxlRXZlbnQKICAgIC8vIHBsdWdpbi4gSG93ZXZlciwgdGhlIHBsdWdpbnMgYmVsb3cgZWl0aGVyIGV4cGVjdAogICAgLy8gZW11bGF0aW9uIChFbnRlckxlYXZlKSBvciB1c2Ugc3RhdGUgbG9jYWxpemVkIHRvIHRoYXQKICAgIC8vIHBsdWdpbiAoQmVmb3JlSW5wdXQsIENoYW5nZSwgU2VsZWN0KS4gVGhlIHN0YXRlIGluCiAgICAvLyB0aGVzZSBtb2R1bGVzIGNvbXBsaWNhdGVzIHRoaW5ncywgYXMgeW91J2xsIGVzc2VudGlhbGx5CiAgICAvLyBnZXQgdGhlIGNhc2Ugd2hlcmUgdGhlIGNhcHR1cmUgcGhhc2UgZXZlbnQgbWlnaHQgY2hhbmdlCiAgICAvLyBzdGF0ZSwgb25seSBmb3IgdGhlIGZvbGxvd2luZyBidWJibGUgZXZlbnQgdG8gY29tZSBpbgogICAgLy8gbGF0ZXIgYW5kIG5vdCB0cmlnZ2VyIGFueXRoaW5nIGFzIHRoZSBzdGF0ZSBub3cKICAgIC8vIGludmFsaWRhdGVzIHRoZSBoZXVyaXN0aWNzIG9mIHRoZSBldmVudCBwbHVnaW4uIFdlCiAgICAvLyBjb3VsZCBhbHRlciBhbGwgdGhlc2UgcGx1Z2lucyB0byB3b3JrIGluIHN1Y2ggd2F5cywgYnV0CiAgICAvLyB0aGF0IG1pZ2h0IGNhdXNlIG90aGVyIHVua25vd24gc2lkZS1lZmZlY3RzIHRoYXQgd2UKICAgIC8vIGNhbid0IGZvcmVzZWUgcmlnaHQgbm93LgoKICAgIGlmIChzaG91bGRQcm9jZXNzUG9seWZpbGxQbHVnaW5zKSB7CiAgICAgIGV4dHJhY3RFdmVudHMkMihkaXNwYXRjaFF1ZXVlLCBkb21FdmVudE5hbWUsIHRhcmdldEluc3QsIG5hdGl2ZUV2ZW50LCBuYXRpdmVFdmVudFRhcmdldCk7CiAgICAgIGV4dHJhY3RFdmVudHMkMShkaXNwYXRjaFF1ZXVlLCBkb21FdmVudE5hbWUsIHRhcmdldEluc3QsIG5hdGl2ZUV2ZW50LCBuYXRpdmVFdmVudFRhcmdldCk7CiAgICAgIGV4dHJhY3RFdmVudHMkMyhkaXNwYXRjaFF1ZXVlLCBkb21FdmVudE5hbWUsIHRhcmdldEluc3QsIG5hdGl2ZUV2ZW50LCBuYXRpdmVFdmVudFRhcmdldCk7CiAgICAgIGV4dHJhY3RFdmVudHMoZGlzcGF0Y2hRdWV1ZSwgZG9tRXZlbnROYW1lLCB0YXJnZXRJbnN0LCBuYXRpdmVFdmVudCwgbmF0aXZlRXZlbnRUYXJnZXQpOwogICAgfQogIH0gLy8gTGlzdCBvZiBldmVudHMgdGhhdCBuZWVkIHRvIGJlIGluZGl2aWR1YWxseSBhdHRhY2hlZCB0byBtZWRpYSBlbGVtZW50cy4KCgogIHZhciBtZWRpYUV2ZW50VHlwZXMgPSBbJ2Fib3J0JywgJ2NhbnBsYXknLCAnY2FucGxheXRocm91Z2gnLCAnZHVyYXRpb25jaGFuZ2UnLCAnZW1wdGllZCcsICdlbmNyeXB0ZWQnLCAnZW5kZWQnLCAnZXJyb3InLCAnbG9hZGVkZGF0YScsICdsb2FkZWRtZXRhZGF0YScsICdsb2Fkc3RhcnQnLCAncGF1c2UnLCAncGxheScsICdwbGF5aW5nJywgJ3Byb2dyZXNzJywgJ3JhdGVjaGFuZ2UnLCAncmVzaXplJywgJ3NlZWtlZCcsICdzZWVraW5nJywgJ3N0YWxsZWQnLCAnc3VzcGVuZCcsICd0aW1ldXBkYXRlJywgJ3ZvbHVtZWNoYW5nZScsICd3YWl0aW5nJ107IC8vIFdlIHNob3VsZCBub3QgZGVsZWdhdGUgdGhlc2UgZXZlbnRzIHRvIHRoZSBjb250YWluZXIsIGJ1dCByYXRoZXIKICAvLyBzZXQgdGhlbSBvbiB0aGUgYWN0dWFsIHRhcmdldCBlbGVtZW50IGl0c2VsZi4gVGhpcyBpcyBwcmltYXJpbHkKICAvLyBiZWNhdXNlIHRoZXNlIGV2ZW50cyBkbyBub3QgY29uc2lzdGVudGx5IGJ1YmJsZSBpbiB0aGUgRE9NLgoKICB2YXIgbm9uRGVsZWdhdGVkRXZlbnRzID0gbmV3IFNldChbJ2NhbmNlbCcsICdjbG9zZScsICdpbnZhbGlkJywgJ2xvYWQnLCAnc2Nyb2xsJywgJ3RvZ2dsZSddLmNvbmNhdChtZWRpYUV2ZW50VHlwZXMpKTsKCiAgZnVuY3Rpb24gZXhlY3V0ZURpc3BhdGNoKGV2ZW50LCBsaXN0ZW5lciwgY3VycmVudFRhcmdldCkgewogICAgdmFyIHR5cGUgPSBldmVudC50eXBlIHx8ICd1bmtub3duLWV2ZW50JzsKICAgIGV2ZW50LmN1cnJlbnRUYXJnZXQgPSBjdXJyZW50VGFyZ2V0OwogICAgaW52b2tlR3VhcmRlZENhbGxiYWNrQW5kQ2F0Y2hGaXJzdEVycm9yKHR5cGUsIGxpc3RlbmVyLCB1bmRlZmluZWQsIGV2ZW50KTsKICAgIGV2ZW50LmN1cnJlbnRUYXJnZXQgPSBudWxsOwogIH0KCiAgZnVuY3Rpb24gcHJvY2Vzc0Rpc3BhdGNoUXVldWVJdGVtc0luT3JkZXIoZXZlbnQsIGRpc3BhdGNoTGlzdGVuZXJzLCBpbkNhcHR1cmVQaGFzZSkgewogICAgdmFyIHByZXZpb3VzSW5zdGFuY2U7CgogICAgaWYgKGluQ2FwdHVyZVBoYXNlKSB7CiAgICAgIGZvciAodmFyIGkgPSBkaXNwYXRjaExpc3RlbmVycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewogICAgICAgIHZhciBfZGlzcGF0Y2hMaXN0ZW5lcnMkaSA9IGRpc3BhdGNoTGlzdGVuZXJzW2ldLAogICAgICAgICAgICBpbnN0YW5jZSA9IF9kaXNwYXRjaExpc3RlbmVycyRpLmluc3RhbmNlLAogICAgICAgICAgICBjdXJyZW50VGFyZ2V0ID0gX2Rpc3BhdGNoTGlzdGVuZXJzJGkuY3VycmVudFRhcmdldCwKICAgICAgICAgICAgbGlzdGVuZXIgPSBfZGlzcGF0Y2hMaXN0ZW5lcnMkaS5saXN0ZW5lcjsKCiAgICAgICAgaWYgKGluc3RhbmNlICE9PSBwcmV2aW91c0luc3RhbmNlICYmIGV2ZW50LmlzUHJvcGFnYXRpb25TdG9wcGVkKCkpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGV4ZWN1dGVEaXNwYXRjaChldmVudCwgbGlzdGVuZXIsIGN1cnJlbnRUYXJnZXQpOwogICAgICAgIHByZXZpb3VzSW5zdGFuY2UgPSBpbnN0YW5jZTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGRpc3BhdGNoTGlzdGVuZXJzLmxlbmd0aDsgX2krKykgewogICAgICAgIHZhciBfZGlzcGF0Y2hMaXN0ZW5lcnMkX2kgPSBkaXNwYXRjaExpc3RlbmVyc1tfaV0sCiAgICAgICAgICAgIF9pbnN0YW5jZSA9IF9kaXNwYXRjaExpc3RlbmVycyRfaS5pbnN0YW5jZSwKICAgICAgICAgICAgX2N1cnJlbnRUYXJnZXQgPSBfZGlzcGF0Y2hMaXN0ZW5lcnMkX2kuY3VycmVudFRhcmdldCwKICAgICAgICAgICAgX2xpc3RlbmVyID0gX2Rpc3BhdGNoTGlzdGVuZXJzJF9pLmxpc3RlbmVyOwoKICAgICAgICBpZiAoX2luc3RhbmNlICE9PSBwcmV2aW91c0luc3RhbmNlICYmIGV2ZW50LmlzUHJvcGFnYXRpb25TdG9wcGVkKCkpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGV4ZWN1dGVEaXNwYXRjaChldmVudCwgX2xpc3RlbmVyLCBfY3VycmVudFRhcmdldCk7CiAgICAgICAgcHJldmlvdXNJbnN0YW5jZSA9IF9pbnN0YW5jZTsKICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gcHJvY2Vzc0Rpc3BhdGNoUXVldWUoZGlzcGF0Y2hRdWV1ZSwgZXZlbnRTeXN0ZW1GbGFncykgewogICAgdmFyIGluQ2FwdHVyZVBoYXNlID0gKGV2ZW50U3lzdGVtRmxhZ3MgJiBJU19DQVBUVVJFX1BIQVNFKSAhPT0gMDsKCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRpc3BhdGNoUXVldWUubGVuZ3RoOyBpKyspIHsKICAgICAgdmFyIF9kaXNwYXRjaFF1ZXVlJGkgPSBkaXNwYXRjaFF1ZXVlW2ldLAogICAgICAgICAgZXZlbnQgPSBfZGlzcGF0Y2hRdWV1ZSRpLmV2ZW50LAogICAgICAgICAgbGlzdGVuZXJzID0gX2Rpc3BhdGNoUXVldWUkaS5saXN0ZW5lcnM7CiAgICAgIHByb2Nlc3NEaXNwYXRjaFF1ZXVlSXRlbXNJbk9yZGVyKGV2ZW50LCBsaXN0ZW5lcnMsIGluQ2FwdHVyZVBoYXNlKTsgLy8gIGV2ZW50IHN5c3RlbSBkb2Vzbid0IHVzZSBwb29saW5nLgogICAgfSAvLyBUaGlzIHdvdWxkIGJlIGEgZ29vZCB0aW1lIHRvIHJldGhyb3cgaWYgYW55IG9mIHRoZSBldmVudCBoYW5kbGVycyB0aHJldy4KCgogICAgcmV0aHJvd0NhdWdodEVycm9yKCk7CiAgfQoKICBmdW5jdGlvbiBkaXNwYXRjaEV2ZW50c0ZvclBsdWdpbnMoZG9tRXZlbnROYW1lLCBldmVudFN5c3RlbUZsYWdzLCBuYXRpdmVFdmVudCwgdGFyZ2V0SW5zdCwgdGFyZ2V0Q29udGFpbmVyKSB7CiAgICB2YXIgbmF0aXZlRXZlbnRUYXJnZXQgPSBnZXRFdmVudFRhcmdldChuYXRpdmVFdmVudCk7CiAgICB2YXIgZGlzcGF0Y2hRdWV1ZSA9IFtdOwogICAgZXh0cmFjdEV2ZW50cyQ1KGRpc3BhdGNoUXVldWUsIGRvbUV2ZW50TmFtZSwgdGFyZ2V0SW5zdCwgbmF0aXZlRXZlbnQsIG5hdGl2ZUV2ZW50VGFyZ2V0LCBldmVudFN5c3RlbUZsYWdzKTsKICAgIHByb2Nlc3NEaXNwYXRjaFF1ZXVlKGRpc3BhdGNoUXVldWUsIGV2ZW50U3lzdGVtRmxhZ3MpOwogIH0KCiAgZnVuY3Rpb24gbGlzdGVuVG9Ob25EZWxlZ2F0ZWRFdmVudChkb21FdmVudE5hbWUsIHRhcmdldEVsZW1lbnQpIHsKICAgIHsKICAgICAgaWYgKCFub25EZWxlZ2F0ZWRFdmVudHMuaGFzKGRvbUV2ZW50TmFtZSkpIHsKICAgICAgICBlcnJvcignRGlkIG5vdCBleHBlY3QgYSBsaXN0ZW5Ub05vbkRlbGVnYXRlZEV2ZW50KCkgY2FsbCBmb3IgIiVzIi4gJyArICdUaGlzIGlzIGEgYnVnIGluIFJlYWN0LiBQbGVhc2UgZmlsZSBhbiBpc3N1ZS4nLCBkb21FdmVudE5hbWUpOwogICAgICB9CiAgICB9CgogICAgdmFyIGlzQ2FwdHVyZVBoYXNlTGlzdGVuZXIgPSBmYWxzZTsKICAgIHZhciBsaXN0ZW5lclNldCA9IGdldEV2ZW50TGlzdGVuZXJTZXQodGFyZ2V0RWxlbWVudCk7CiAgICB2YXIgbGlzdGVuZXJTZXRLZXkgPSBnZXRMaXN0ZW5lclNldEtleShkb21FdmVudE5hbWUsIGlzQ2FwdHVyZVBoYXNlTGlzdGVuZXIpOwoKICAgIGlmICghbGlzdGVuZXJTZXQuaGFzKGxpc3RlbmVyU2V0S2V5KSkgewogICAgICBhZGRUcmFwcGVkRXZlbnRMaXN0ZW5lcih0YXJnZXRFbGVtZW50LCBkb21FdmVudE5hbWUsIElTX05PTl9ERUxFR0FURUQsIGlzQ2FwdHVyZVBoYXNlTGlzdGVuZXIpOwogICAgICBsaXN0ZW5lclNldC5hZGQobGlzdGVuZXJTZXRLZXkpOwogICAgfQogIH0KICBmdW5jdGlvbiBsaXN0ZW5Ub05hdGl2ZUV2ZW50KGRvbUV2ZW50TmFtZSwgaXNDYXB0dXJlUGhhc2VMaXN0ZW5lciwgdGFyZ2V0KSB7CiAgICB7CiAgICAgIGlmIChub25EZWxlZ2F0ZWRFdmVudHMuaGFzKGRvbUV2ZW50TmFtZSkgJiYgIWlzQ2FwdHVyZVBoYXNlTGlzdGVuZXIpIHsKICAgICAgICBlcnJvcignRGlkIG5vdCBleHBlY3QgYSBsaXN0ZW5Ub05hdGl2ZUV2ZW50KCkgY2FsbCBmb3IgIiVzIiBpbiB0aGUgYnViYmxlIHBoYXNlLiAnICsgJ1RoaXMgaXMgYSBidWcgaW4gUmVhY3QuIFBsZWFzZSBmaWxlIGFuIGlzc3VlLicsIGRvbUV2ZW50TmFtZSk7CiAgICAgIH0KICAgIH0KCiAgICB2YXIgZXZlbnRTeXN0ZW1GbGFncyA9IDA7CgogICAgaWYgKGlzQ2FwdHVyZVBoYXNlTGlzdGVuZXIpIHsKICAgICAgZXZlbnRTeXN0ZW1GbGFncyB8PSBJU19DQVBUVVJFX1BIQVNFOwogICAgfQoKICAgIGFkZFRyYXBwZWRFdmVudExpc3RlbmVyKHRhcmdldCwgZG9tRXZlbnROYW1lLCBldmVudFN5c3RlbUZsYWdzLCBpc0NhcHR1cmVQaGFzZUxpc3RlbmVyKTsKICB9IC8vIFRoaXMgaXMgb25seSB1c2VkIGJ5IGNyZWF0ZUV2ZW50SGFuZGxlIHdoZW4gdGhlCiAgdmFyIGxpc3RlbmluZ01hcmtlciA9ICdfcmVhY3RMaXN0ZW5pbmcnICsgTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc2xpY2UoMik7CiAgZnVuY3Rpb24gbGlzdGVuVG9BbGxTdXBwb3J0ZWRFdmVudHMocm9vdENvbnRhaW5lckVsZW1lbnQpIHsKICAgIGlmICghcm9vdENvbnRhaW5lckVsZW1lbnRbbGlzdGVuaW5nTWFya2VyXSkgewogICAgICByb290Q29udGFpbmVyRWxlbWVudFtsaXN0ZW5pbmdNYXJrZXJdID0gdHJ1ZTsKICAgICAgYWxsTmF0aXZlRXZlbnRzLmZvckVhY2goZnVuY3Rpb24gKGRvbUV2ZW50TmFtZSkgewogICAgICAgIC8vIFdlIGhhbmRsZSBzZWxlY3Rpb25jaGFuZ2Ugc2VwYXJhdGVseSBiZWNhdXNlIGl0CiAgICAgICAgLy8gZG9lc24ndCBidWJibGUgYW5kIG5lZWRzIHRvIGJlIG9uIHRoZSBkb2N1bWVudC4KICAgICAgICBpZiAoZG9tRXZlbnROYW1lICE9PSAnc2VsZWN0aW9uY2hhbmdlJykgewogICAgICAgICAgaWYgKCFub25EZWxlZ2F0ZWRFdmVudHMuaGFzKGRvbUV2ZW50TmFtZSkpIHsKICAgICAgICAgICAgbGlzdGVuVG9OYXRpdmVFdmVudChkb21FdmVudE5hbWUsIGZhbHNlLCByb290Q29udGFpbmVyRWxlbWVudCk7CiAgICAgICAgICB9CgogICAgICAgICAgbGlzdGVuVG9OYXRpdmVFdmVudChkb21FdmVudE5hbWUsIHRydWUsIHJvb3RDb250YWluZXJFbGVtZW50KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICB2YXIgb3duZXJEb2N1bWVudCA9IHJvb3RDb250YWluZXJFbGVtZW50Lm5vZGVUeXBlID09PSBET0NVTUVOVF9OT0RFID8gcm9vdENvbnRhaW5lckVsZW1lbnQgOiByb290Q29udGFpbmVyRWxlbWVudC5vd25lckRvY3VtZW50OwoKICAgICAgaWYgKG93bmVyRG9jdW1lbnQgIT09IG51bGwpIHsKICAgICAgICAvLyBUaGUgc2VsZWN0aW9uY2hhbmdlIGV2ZW50IGFsc28gbmVlZHMgZGVkdXBsaWNhdGlvbgogICAgICAgIC8vIGJ1dCBpdCBpcyBhdHRhY2hlZCB0byB0aGUgZG9jdW1lbnQuCiAgICAgICAgaWYgKCFvd25lckRvY3VtZW50W2xpc3RlbmluZ01hcmtlcl0pIHsKICAgICAgICAgIG93bmVyRG9jdW1lbnRbbGlzdGVuaW5nTWFya2VyXSA9IHRydWU7CiAgICAgICAgICBsaXN0ZW5Ub05hdGl2ZUV2ZW50KCdzZWxlY3Rpb25jaGFuZ2UnLCBmYWxzZSwgb3duZXJEb2N1bWVudCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiBhZGRUcmFwcGVkRXZlbnRMaXN0ZW5lcih0YXJnZXRDb250YWluZXIsIGRvbUV2ZW50TmFtZSwgZXZlbnRTeXN0ZW1GbGFncywgaXNDYXB0dXJlUGhhc2VMaXN0ZW5lciwgaXNEZWZlcnJlZExpc3RlbmVyRm9yTGVnYWN5RkJTdXBwb3J0KSB7CiAgICB2YXIgbGlzdGVuZXIgPSBjcmVhdGVFdmVudExpc3RlbmVyV3JhcHBlcldpdGhQcmlvcml0eSh0YXJnZXRDb250YWluZXIsIGRvbUV2ZW50TmFtZSwgZXZlbnRTeXN0ZW1GbGFncyk7IC8vIElmIHBhc3NpdmUgb3B0aW9uIGlzIG5vdCBzdXBwb3J0ZWQsIHRoZW4gdGhlIGV2ZW50IHdpbGwgYmUKICAgIC8vIGFjdGl2ZSBhbmQgbm90IHBhc3NpdmUuCgogICAgdmFyIGlzUGFzc2l2ZUxpc3RlbmVyID0gdW5kZWZpbmVkOwoKICAgIGlmIChwYXNzaXZlQnJvd3NlckV2ZW50c1N1cHBvcnRlZCkgewogICAgICAvLyBCcm93c2VycyBpbnRyb2R1Y2VkIGFuIGludGVydmVudGlvbiwgbWFraW5nIHRoZXNlIGV2ZW50cwogICAgICAvLyBwYXNzaXZlIGJ5IGRlZmF1bHQgb24gZG9jdW1lbnQuIFJlYWN0IGRvZXNuJ3QgYmluZCB0aGVtCiAgICAgIC8vIHRvIGRvY3VtZW50IGFueW1vcmUsIGJ1dCBjaGFuZ2luZyB0aGlzIG5vdyB3b3VsZCB1bmRvCiAgICAgIC8vIHRoZSBwZXJmb3JtYW5jZSB3aW5zIGZyb20gdGhlIGNoYW5nZS4gU28gd2UgZW11bGF0ZQogICAgICAvLyB0aGUgZXhpc3RpbmcgYmVoYXZpb3IgbWFudWFsbHkgb24gdGhlIHJvb3RzIG5vdy4KICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL3JlYWN0L2lzc3Vlcy8xOTY1MQogICAgICBpZiAoZG9tRXZlbnROYW1lID09PSAndG91Y2hzdGFydCcgfHwgZG9tRXZlbnROYW1lID09PSAndG91Y2htb3ZlJyB8fCBkb21FdmVudE5hbWUgPT09ICd3aGVlbCcpIHsKICAgICAgICBpc1Bhc3NpdmVMaXN0ZW5lciA9IHRydWU7CiAgICAgIH0KICAgIH0KCiAgICB0YXJnZXRDb250YWluZXIgPSAgdGFyZ2V0Q29udGFpbmVyOwogICAgdmFyIHVuc3Vic2NyaWJlTGlzdGVuZXI7IC8vIFdoZW4gbGVnYWN5RkJTdXBwb3J0IGlzIGVuYWJsZWQsIGl0J3MgZm9yIHdoZW4gd2UKCgogICAgaWYgKGlzQ2FwdHVyZVBoYXNlTGlzdGVuZXIpIHsKICAgICAgaWYgKGlzUGFzc2l2ZUxpc3RlbmVyICE9PSB1bmRlZmluZWQpIHsKICAgICAgICB1bnN1YnNjcmliZUxpc3RlbmVyID0gYWRkRXZlbnRDYXB0dXJlTGlzdGVuZXJXaXRoUGFzc2l2ZUZsYWcodGFyZ2V0Q29udGFpbmVyLCBkb21FdmVudE5hbWUsIGxpc3RlbmVyLCBpc1Bhc3NpdmVMaXN0ZW5lcik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdW5zdWJzY3JpYmVMaXN0ZW5lciA9IGFkZEV2ZW50Q2FwdHVyZUxpc3RlbmVyKHRhcmdldENvbnRhaW5lciwgZG9tRXZlbnROYW1lLCBsaXN0ZW5lcik7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGlmIChpc1Bhc3NpdmVMaXN0ZW5lciAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgdW5zdWJzY3JpYmVMaXN0ZW5lciA9IGFkZEV2ZW50QnViYmxlTGlzdGVuZXJXaXRoUGFzc2l2ZUZsYWcodGFyZ2V0Q29udGFpbmVyLCBkb21FdmVudE5hbWUsIGxpc3RlbmVyLCBpc1Bhc3NpdmVMaXN0ZW5lcik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdW5zdWJzY3JpYmVMaXN0ZW5lciA9IGFkZEV2ZW50QnViYmxlTGlzdGVuZXIodGFyZ2V0Q29udGFpbmVyLCBkb21FdmVudE5hbWUsIGxpc3RlbmVyKTsKICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gaXNNYXRjaGluZ1Jvb3RDb250YWluZXIoZ3JhbmRDb250YWluZXIsIHRhcmdldENvbnRhaW5lcikgewogICAgcmV0dXJuIGdyYW5kQ29udGFpbmVyID09PSB0YXJnZXRDb250YWluZXIgfHwgZ3JhbmRDb250YWluZXIubm9kZVR5cGUgPT09IENPTU1FTlRfTk9ERSAmJiBncmFuZENvbnRhaW5lci5wYXJlbnROb2RlID09PSB0YXJnZXRDb250YWluZXI7CiAgfQoKICBmdW5jdGlvbiBkaXNwYXRjaEV2ZW50Rm9yUGx1Z2luRXZlbnRTeXN0ZW0oZG9tRXZlbnROYW1lLCBldmVudFN5c3RlbUZsYWdzLCBuYXRpdmVFdmVudCwgdGFyZ2V0SW5zdCwgdGFyZ2V0Q29udGFpbmVyKSB7CiAgICB2YXIgYW5jZXN0b3JJbnN0ID0gdGFyZ2V0SW5zdDsKCiAgICBpZiAoKGV2ZW50U3lzdGVtRmxhZ3MgJiBJU19FVkVOVF9IQU5ETEVfTk9OX01BTkFHRURfTk9ERSkgPT09IDAgJiYgKGV2ZW50U3lzdGVtRmxhZ3MgJiBJU19OT05fREVMRUdBVEVEKSA9PT0gMCkgewogICAgICB2YXIgdGFyZ2V0Q29udGFpbmVyTm9kZSA9IHRhcmdldENvbnRhaW5lcjsgLy8gSWYgd2UgYXJlIHVzaW5nIHRoZSBsZWdhY3kgRkIgc3VwcG9ydCBmbGFnLCB3ZQoKICAgICAgaWYgKHRhcmdldEluc3QgIT09IG51bGwpIHsKICAgICAgICAvLyBUaGUgYmVsb3cgbG9naWMgYXR0ZW1wdHMgdG8gd29yayBvdXQgaWYgd2UgbmVlZCB0byBjaGFuZ2UKICAgICAgICAvLyB0aGUgdGFyZ2V0IGZpYmVyIHRvIGEgZGlmZmVyZW50IGFuY2VzdG9yLiBXZSBoYWQgc2ltaWxhciBsb2dpYwogICAgICAgIC8vIGluIHRoZSBsZWdhY3kgZXZlbnQgc3lzdGVtLCBleGNlcHQgdGhlIGJpZyBkaWZmZXJlbmNlIGJldHdlZW4KICAgICAgICAvLyBzeXN0ZW1zIGlzIHRoYXQgdGhlIG1vZGVybiBldmVudCBzeXN0ZW0gbm93IGhhcyBhbiBldmVudCBsaXN0ZW5lcgogICAgICAgIC8vIGF0dGFjaGVkIHRvIGVhY2ggUmVhY3QgUm9vdCBhbmQgUmVhY3QgUG9ydGFsIFJvb3QuIFRvZ2V0aGVyLAogICAgICAgIC8vIHRoZSBET00gbm9kZXMgcmVwcmVzZW50aW5nIHRoZXNlIHJvb3RzIGFyZSB0aGUgInJvb3RDb250YWluZXIiLgogICAgICAgIC8vIFRvIGZpZ3VyZSBvdXQgd2hpY2ggYW5jZXN0b3IgaW5zdGFuY2Ugd2Ugc2hvdWxkIHVzZSwgd2UgdHJhdmVyc2UKICAgICAgICAvLyB1cCB0aGUgZmliZXIgdHJlZSBmcm9tIHRoZSB0YXJnZXQgaW5zdGFuY2UgYW5kIGF0dGVtcHQgdG8gZmluZAogICAgICAgIC8vIHJvb3QgYm91bmRhcmllcyB0aGF0IG1hdGNoIHRoYXQgb2Ygb3VyIGN1cnJlbnQgInJvb3RDb250YWluZXIiLgogICAgICAgIC8vIElmIHdlIGZpbmQgdGhhdCAicm9vdENvbnRhaW5lciIsIHdlIGZpbmQgdGhlIHBhcmVudCBmaWJlcgogICAgICAgIC8vIHN1Yi10cmVlIGZvciB0aGF0IHJvb3QgYW5kIG1ha2UgdGhhdCBvdXIgYW5jZXN0b3IgaW5zdGFuY2UuCiAgICAgICAgdmFyIG5vZGUgPSB0YXJnZXRJbnN0OwoKICAgICAgICBtYWluTG9vcDogd2hpbGUgKHRydWUpIHsKICAgICAgICAgIGlmIChub2RlID09PSBudWxsKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgbm9kZVRhZyA9IG5vZGUudGFnOwoKICAgICAgICAgIGlmIChub2RlVGFnID09PSBIb3N0Um9vdCB8fCBub2RlVGFnID09PSBIb3N0UG9ydGFsKSB7CiAgICAgICAgICAgIHZhciBjb250YWluZXIgPSBub2RlLnN0YXRlTm9kZS5jb250YWluZXJJbmZvOwoKICAgICAgICAgICAgaWYgKGlzTWF0Y2hpbmdSb290Q29udGFpbmVyKGNvbnRhaW5lciwgdGFyZ2V0Q29udGFpbmVyTm9kZSkpIHsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKG5vZGVUYWcgPT09IEhvc3RQb3J0YWwpIHsKICAgICAgICAgICAgICAvLyBUaGUgdGFyZ2V0IGlzIGEgcG9ydGFsLCBidXQgaXQncyBub3QgdGhlIHJvb3RDb250YWluZXIgd2UncmUgbG9va2luZyBmb3IuCiAgICAgICAgICAgICAgLy8gTm9ybWFsbHkgcG9ydGFscyBoYW5kbGUgdGhlaXIgb3duIGV2ZW50cyBhbGwgdGhlIHdheSBkb3duIHRvIHRoZSByb290LgogICAgICAgICAgICAgIC8vIFNvIHdlIHNob3VsZCBiZSBhYmxlIHRvIHN0b3Agbm93LiBIb3dldmVyLCB3ZSBkb24ndCBrbm93IGlmIHRoaXMgcG9ydGFsCiAgICAgICAgICAgICAgLy8gd2FzIHBhcnQgb2YgKm91ciogcm9vdC4KICAgICAgICAgICAgICB2YXIgZ3JhbmROb2RlID0gbm9kZS5yZXR1cm47CgogICAgICAgICAgICAgIHdoaWxlIChncmFuZE5vZGUgIT09IG51bGwpIHsKICAgICAgICAgICAgICAgIHZhciBncmFuZFRhZyA9IGdyYW5kTm9kZS50YWc7CgogICAgICAgICAgICAgICAgaWYgKGdyYW5kVGFnID09PSBIb3N0Um9vdCB8fCBncmFuZFRhZyA9PT0gSG9zdFBvcnRhbCkgewogICAgICAgICAgICAgICAgICB2YXIgZ3JhbmRDb250YWluZXIgPSBncmFuZE5vZGUuc3RhdGVOb2RlLmNvbnRhaW5lckluZm87CgogICAgICAgICAgICAgICAgICBpZiAoaXNNYXRjaGluZ1Jvb3RDb250YWluZXIoZ3JhbmRDb250YWluZXIsIHRhcmdldENvbnRhaW5lck5vZGUpKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyBpcyB0aGUgcm9vdENvbnRhaW5lciB3ZSdyZSBsb29raW5nIGZvciBhbmQgd2UgZm91bmQgaXQgYXMKICAgICAgICAgICAgICAgICAgICAvLyBhIHBhcmVudCBvZiB0aGUgUG9ydGFsLiBUaGF0IG1lYW5zIHdlIGNhbiBpZ25vcmUgaXQgYmVjYXVzZSB0aGUKICAgICAgICAgICAgICAgICAgICAvLyBQb3J0YWwgd2lsbCBidWJibGUgdGhyb3VnaCB0byB1cy4KICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBncmFuZE5vZGUgPSBncmFuZE5vZGUucmV0dXJuOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSAvLyBOb3cgd2UgbmVlZCB0byBmaW5kIGl0J3MgY29ycmVzcG9uZGluZyBob3N0IGZpYmVyIGluIHRoZSBvdGhlcgogICAgICAgICAgICAvLyB0cmVlLiBUbyBkbyB0aGlzIHdlIGNhbiB1c2UgZ2V0Q2xvc2VzdEluc3RhbmNlRnJvbU5vZGUsIGJ1dCB3ZQogICAgICAgICAgICAvLyBuZWVkIHRvIHZhbGlkYXRlIHRoYXQgdGhlIGZpYmVyIGlzIGEgaG9zdCBpbnN0YW5jZSwgb3RoZXJ3aXNlCiAgICAgICAgICAgIC8vIHdlIG5lZWQgdG8gdHJhdmVyc2UgdXAgdGhyb3VnaCB0aGUgRE9NIHRpbGwgd2UgZmluZCB0aGUgY29ycmVjdAogICAgICAgICAgICAvLyBub2RlIHRoYXQgaXMgZnJvbSB0aGUgb3RoZXIgdHJlZS4KCgogICAgICAgICAgICB3aGlsZSAoY29udGFpbmVyICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgdmFyIHBhcmVudE5vZGUgPSBnZXRDbG9zZXN0SW5zdGFuY2VGcm9tTm9kZShjb250YWluZXIpOwoKICAgICAgICAgICAgICBpZiAocGFyZW50Tm9kZSA9PT0gbnVsbCkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdmFyIHBhcmVudFRhZyA9IHBhcmVudE5vZGUudGFnOwoKICAgICAgICAgICAgICBpZiAocGFyZW50VGFnID09PSBIb3N0Q29tcG9uZW50IHx8IHBhcmVudFRhZyA9PT0gSG9zdFRleHQpIHsKICAgICAgICAgICAgICAgIG5vZGUgPSBhbmNlc3Rvckluc3QgPSBwYXJlbnROb2RlOwogICAgICAgICAgICAgICAgY29udGludWUgbWFpbkxvb3A7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjb250YWluZXIgPSBjb250YWluZXIucGFyZW50Tm9kZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIG5vZGUgPSBub2RlLnJldHVybjsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBiYXRjaGVkVXBkYXRlcyhmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBkaXNwYXRjaEV2ZW50c0ZvclBsdWdpbnMoZG9tRXZlbnROYW1lLCBldmVudFN5c3RlbUZsYWdzLCBuYXRpdmVFdmVudCwgYW5jZXN0b3JJbnN0KTsKICAgIH0pOwogIH0KCiAgZnVuY3Rpb24gY3JlYXRlRGlzcGF0Y2hMaXN0ZW5lcihpbnN0YW5jZSwgbGlzdGVuZXIsIGN1cnJlbnRUYXJnZXQpIHsKICAgIHJldHVybiB7CiAgICAgIGluc3RhbmNlOiBpbnN0YW5jZSwKICAgICAgbGlzdGVuZXI6IGxpc3RlbmVyLAogICAgICBjdXJyZW50VGFyZ2V0OiBjdXJyZW50VGFyZ2V0CiAgICB9OwogIH0KCiAgZnVuY3Rpb24gYWNjdW11bGF0ZVNpbmdsZVBoYXNlTGlzdGVuZXJzKHRhcmdldEZpYmVyLCByZWFjdE5hbWUsIG5hdGl2ZUV2ZW50VHlwZSwgaW5DYXB0dXJlUGhhc2UsIGFjY3VtdWxhdGVUYXJnZXRPbmx5LCBuYXRpdmVFdmVudCkgewogICAgdmFyIGNhcHR1cmVOYW1lID0gcmVhY3ROYW1lICE9PSBudWxsID8gcmVhY3ROYW1lICsgJ0NhcHR1cmUnIDogbnVsbDsKICAgIHZhciByZWFjdEV2ZW50TmFtZSA9IGluQ2FwdHVyZVBoYXNlID8gY2FwdHVyZU5hbWUgOiByZWFjdE5hbWU7CiAgICB2YXIgbGlzdGVuZXJzID0gW107CiAgICB2YXIgaW5zdGFuY2UgPSB0YXJnZXRGaWJlcjsKICAgIHZhciBsYXN0SG9zdENvbXBvbmVudCA9IG51bGw7IC8vIEFjY3VtdWxhdGUgYWxsIGluc3RhbmNlcyBhbmQgbGlzdGVuZXJzIHZpYSB0aGUgdGFyZ2V0IC0+IHJvb3QgcGF0aC4KCiAgICB3aGlsZSAoaW5zdGFuY2UgIT09IG51bGwpIHsKICAgICAgdmFyIF9pbnN0YW5jZTIgPSBpbnN0YW5jZSwKICAgICAgICAgIHN0YXRlTm9kZSA9IF9pbnN0YW5jZTIuc3RhdGVOb2RlLAogICAgICAgICAgdGFnID0gX2luc3RhbmNlMi50YWc7IC8vIEhhbmRsZSBsaXN0ZW5lcnMgdGhhdCBhcmUgb24gSG9zdENvbXBvbmVudHMgKGkuZS4gPGRpdj4pCgogICAgICBpZiAodGFnID09PSBIb3N0Q29tcG9uZW50ICYmIHN0YXRlTm9kZSAhPT0gbnVsbCkgewogICAgICAgIGxhc3RIb3N0Q29tcG9uZW50ID0gc3RhdGVOb2RlOyAvLyBjcmVhdGVFdmVudEhhbmRsZSBsaXN0ZW5lcnMKCgogICAgICAgIGlmIChyZWFjdEV2ZW50TmFtZSAhPT0gbnVsbCkgewogICAgICAgICAgdmFyIGxpc3RlbmVyID0gZ2V0TGlzdGVuZXIoaW5zdGFuY2UsIHJlYWN0RXZlbnROYW1lKTsKCiAgICAgICAgICBpZiAobGlzdGVuZXIgIT0gbnVsbCkgewogICAgICAgICAgICBsaXN0ZW5lcnMucHVzaChjcmVhdGVEaXNwYXRjaExpc3RlbmVyKGluc3RhbmNlLCBsaXN0ZW5lciwgbGFzdEhvc3RDb21wb25lbnQpKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gLy8gSWYgd2UgYXJlIG9ubHkgYWNjdW11bGF0aW5nIGV2ZW50cyBmb3IgdGhlIHRhcmdldCwgdGhlbiB3ZSBkb24ndAogICAgICAvLyBjb250aW51ZSB0byBwcm9wYWdhdGUgdGhyb3VnaCB0aGUgUmVhY3QgZmliZXIgdHJlZSB0byBmaW5kIG90aGVyCiAgICAgIC8vIGxpc3RlbmVycy4KCgogICAgICBpZiAoYWNjdW11bGF0ZVRhcmdldE9ubHkpIHsKICAgICAgICBicmVhazsKICAgICAgfSAvLyBJZiB3ZSBhcmUgcHJvY2Vzc2luZyB0aGUgb25CZWZvcmVCbHVyIGV2ZW50LCB0aGVuIHdlIG5lZWQgdG8gdGFrZQoKICAgICAgaW5zdGFuY2UgPSBpbnN0YW5jZS5yZXR1cm47CiAgICB9CgogICAgcmV0dXJuIGxpc3RlbmVyczsKICB9IC8vIFdlIHNob3VsZCBvbmx5IHVzZSB0aGlzIGZ1bmN0aW9uIGZvcjoKICAvLyAtIEJlZm9yZUlucHV0RXZlbnRQbHVnaW4KICAvLyAtIENoYW5nZUV2ZW50UGx1Z2luCiAgLy8gLSBTZWxlY3RFdmVudFBsdWdpbgogIC8vIFRoaXMgaXMgYmVjYXVzZSB3ZSBvbmx5IHByb2Nlc3MgdGhlc2UgcGx1Z2lucwogIC8vIGluIHRoZSBidWJibGUgcGhhc2UsIHNvIHdlIG5lZWQgdG8gYWNjdW11bGF0ZSB0d28KICAvLyBwaGFzZSBldmVudCBsaXN0ZW5lcnMgKHZpYSBlbXVsYXRpb24pLgoKICBmdW5jdGlvbiBhY2N1bXVsYXRlVHdvUGhhc2VMaXN0ZW5lcnModGFyZ2V0RmliZXIsIHJlYWN0TmFtZSkgewogICAgdmFyIGNhcHR1cmVOYW1lID0gcmVhY3ROYW1lICsgJ0NhcHR1cmUnOwogICAgdmFyIGxpc3RlbmVycyA9IFtdOwogICAgdmFyIGluc3RhbmNlID0gdGFyZ2V0RmliZXI7IC8vIEFjY3VtdWxhdGUgYWxsIGluc3RhbmNlcyBhbmQgbGlzdGVuZXJzIHZpYSB0aGUgdGFyZ2V0IC0+IHJvb3QgcGF0aC4KCiAgICB3aGlsZSAoaW5zdGFuY2UgIT09IG51bGwpIHsKICAgICAgdmFyIF9pbnN0YW5jZTMgPSBpbnN0YW5jZSwKICAgICAgICAgIHN0YXRlTm9kZSA9IF9pbnN0YW5jZTMuc3RhdGVOb2RlLAogICAgICAgICAgdGFnID0gX2luc3RhbmNlMy50YWc7IC8vIEhhbmRsZSBsaXN0ZW5lcnMgdGhhdCBhcmUgb24gSG9zdENvbXBvbmVudHMgKGkuZS4gPGRpdj4pCgogICAgICBpZiAodGFnID09PSBIb3N0Q29tcG9uZW50ICYmIHN0YXRlTm9kZSAhPT0gbnVsbCkgewogICAgICAgIHZhciBjdXJyZW50VGFyZ2V0ID0gc3RhdGVOb2RlOwogICAgICAgIHZhciBjYXB0dXJlTGlzdGVuZXIgPSBnZXRMaXN0ZW5lcihpbnN0YW5jZSwgY2FwdHVyZU5hbWUpOwoKICAgICAgICBpZiAoY2FwdHVyZUxpc3RlbmVyICE9IG51bGwpIHsKICAgICAgICAgIGxpc3RlbmVycy51bnNoaWZ0KGNyZWF0ZURpc3BhdGNoTGlzdGVuZXIoaW5zdGFuY2UsIGNhcHR1cmVMaXN0ZW5lciwgY3VycmVudFRhcmdldCkpOwogICAgICAgIH0KCiAgICAgICAgdmFyIGJ1YmJsZUxpc3RlbmVyID0gZ2V0TGlzdGVuZXIoaW5zdGFuY2UsIHJlYWN0TmFtZSk7CgogICAgICAgIGlmIChidWJibGVMaXN0ZW5lciAhPSBudWxsKSB7CiAgICAgICAgICBsaXN0ZW5lcnMucHVzaChjcmVhdGVEaXNwYXRjaExpc3RlbmVyKGluc3RhbmNlLCBidWJibGVMaXN0ZW5lciwgY3VycmVudFRhcmdldCkpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaW5zdGFuY2UgPSBpbnN0YW5jZS5yZXR1cm47CiAgICB9CgogICAgcmV0dXJuIGxpc3RlbmVyczsKICB9CgogIGZ1bmN0aW9uIGdldFBhcmVudChpbnN0KSB7CiAgICBpZiAoaW5zdCA9PT0gbnVsbCkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBkbyB7CiAgICAgIGluc3QgPSBpbnN0LnJldHVybjsgLy8gVE9ETzogSWYgdGhpcyBpcyBhIEhvc3RSb290IHdlIG1pZ2h0IHdhbnQgdG8gYmFpbCBvdXQuCiAgICAgIC8vIFRoYXQgaXMgZGVwZW5kaW5nIG9uIGlmIHdlIHdhbnQgbmVzdGVkIHN1YnRyZWVzIChsYXllcnMpIHRvIGJ1YmJsZQogICAgICAvLyBldmVudHMgdG8gdGhlaXIgcGFyZW50LiBXZSBjb3VsZCBhbHNvIGdvIHRocm91Z2ggcGFyZW50Tm9kZSBvbiB0aGUKICAgICAgLy8gaG9zdCBub2RlIGJ1dCB0aGF0IHdvdWxkbid0IHdvcmsgZm9yIFJlYWN0IE5hdGl2ZSBhbmQgZG9lc24ndCBsZXQgdXMKICAgICAgLy8gZG8gdGhlIHBvcnRhbCBmZWF0dXJlLgogICAgfSB3aGlsZSAoaW5zdCAmJiBpbnN0LnRhZyAhPT0gSG9zdENvbXBvbmVudCk7CgogICAgaWYgKGluc3QpIHsKICAgICAgcmV0dXJuIGluc3Q7CiAgICB9CgogICAgcmV0dXJuIG51bGw7CiAgfQogIC8qKgogICAqIFJldHVybiB0aGUgbG93ZXN0IGNvbW1vbiBhbmNlc3RvciBvZiBBIGFuZCBCLCBvciBudWxsIGlmIHRoZXkgYXJlIGluCiAgICogZGlmZmVyZW50IHRyZWVzLgogICAqLwoKCiAgZnVuY3Rpb24gZ2V0TG93ZXN0Q29tbW9uQW5jZXN0b3IoaW5zdEEsIGluc3RCKSB7CiAgICB2YXIgbm9kZUEgPSBpbnN0QTsKICAgIHZhciBub2RlQiA9IGluc3RCOwogICAgdmFyIGRlcHRoQSA9IDA7CgogICAgZm9yICh2YXIgdGVtcEEgPSBub2RlQTsgdGVtcEE7IHRlbXBBID0gZ2V0UGFyZW50KHRlbXBBKSkgewogICAgICBkZXB0aEErKzsKICAgIH0KCiAgICB2YXIgZGVwdGhCID0gMDsKCiAgICBmb3IgKHZhciB0ZW1wQiA9IG5vZGVCOyB0ZW1wQjsgdGVtcEIgPSBnZXRQYXJlbnQodGVtcEIpKSB7CiAgICAgIGRlcHRoQisrOwogICAgfSAvLyBJZiBBIGlzIGRlZXBlciwgY3Jhd2wgdXAuCgoKICAgIHdoaWxlIChkZXB0aEEgLSBkZXB0aEIgPiAwKSB7CiAgICAgIG5vZGVBID0gZ2V0UGFyZW50KG5vZGVBKTsKICAgICAgZGVwdGhBLS07CiAgICB9IC8vIElmIEIgaXMgZGVlcGVyLCBjcmF3bCB1cC4KCgogICAgd2hpbGUgKGRlcHRoQiAtIGRlcHRoQSA+IDApIHsKICAgICAgbm9kZUIgPSBnZXRQYXJlbnQobm9kZUIpOwogICAgICBkZXB0aEItLTsKICAgIH0gLy8gV2FsayBpbiBsb2Nrc3RlcCB1bnRpbCB3ZSBmaW5kIGEgbWF0Y2guCgoKICAgIHZhciBkZXB0aCA9IGRlcHRoQTsKCiAgICB3aGlsZSAoZGVwdGgtLSkgewogICAgICBpZiAobm9kZUEgPT09IG5vZGVCIHx8IG5vZGVCICE9PSBudWxsICYmIG5vZGVBID09PSBub2RlQi5hbHRlcm5hdGUpIHsKICAgICAgICByZXR1cm4gbm9kZUE7CiAgICAgIH0KCiAgICAgIG5vZGVBID0gZ2V0UGFyZW50KG5vZGVBKTsKICAgICAgbm9kZUIgPSBnZXRQYXJlbnQobm9kZUIpOwogICAgfQoKICAgIHJldHVybiBudWxsOwogIH0KCiAgZnVuY3Rpb24gYWNjdW11bGF0ZUVudGVyTGVhdmVMaXN0ZW5lcnNGb3JFdmVudChkaXNwYXRjaFF1ZXVlLCBldmVudCwgdGFyZ2V0LCBjb21tb24sIGluQ2FwdHVyZVBoYXNlKSB7CiAgICB2YXIgcmVnaXN0cmF0aW9uTmFtZSA9IGV2ZW50Ll9yZWFjdE5hbWU7CiAgICB2YXIgbGlzdGVuZXJzID0gW107CiAgICB2YXIgaW5zdGFuY2UgPSB0YXJnZXQ7CgogICAgd2hpbGUgKGluc3RhbmNlICE9PSBudWxsKSB7CiAgICAgIGlmIChpbnN0YW5jZSA9PT0gY29tbW9uKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIHZhciBfaW5zdGFuY2U0ID0gaW5zdGFuY2UsCiAgICAgICAgICBhbHRlcm5hdGUgPSBfaW5zdGFuY2U0LmFsdGVybmF0ZSwKICAgICAgICAgIHN0YXRlTm9kZSA9IF9pbnN0YW5jZTQuc3RhdGVOb2RlLAogICAgICAgICAgdGFnID0gX2luc3RhbmNlNC50YWc7CgogICAgICBpZiAoYWx0ZXJuYXRlICE9PSBudWxsICYmIGFsdGVybmF0ZSA9PT0gY29tbW9uKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGlmICh0YWcgPT09IEhvc3RDb21wb25lbnQgJiYgc3RhdGVOb2RlICE9PSBudWxsKSB7CiAgICAgICAgdmFyIGN1cnJlbnRUYXJnZXQgPSBzdGF0ZU5vZGU7CgogICAgICAgIGlmIChpbkNhcHR1cmVQaGFzZSkgewogICAgICAgICAgdmFyIGNhcHR1cmVMaXN0ZW5lciA9IGdldExpc3RlbmVyKGluc3RhbmNlLCByZWdpc3RyYXRpb25OYW1lKTsKCiAgICAgICAgICBpZiAoY2FwdHVyZUxpc3RlbmVyICE9IG51bGwpIHsKICAgICAgICAgICAgbGlzdGVuZXJzLnVuc2hpZnQoY3JlYXRlRGlzcGF0Y2hMaXN0ZW5lcihpbnN0YW5jZSwgY2FwdHVyZUxpc3RlbmVyLCBjdXJyZW50VGFyZ2V0KSk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmICghaW5DYXB0dXJlUGhhc2UpIHsKICAgICAgICAgIHZhciBidWJibGVMaXN0ZW5lciA9IGdldExpc3RlbmVyKGluc3RhbmNlLCByZWdpc3RyYXRpb25OYW1lKTsKCiAgICAgICAgICBpZiAoYnViYmxlTGlzdGVuZXIgIT0gbnVsbCkgewogICAgICAgICAgICBsaXN0ZW5lcnMucHVzaChjcmVhdGVEaXNwYXRjaExpc3RlbmVyKGluc3RhbmNlLCBidWJibGVMaXN0ZW5lciwgY3VycmVudFRhcmdldCkpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaW5zdGFuY2UgPSBpbnN0YW5jZS5yZXR1cm47CiAgICB9CgogICAgaWYgKGxpc3RlbmVycy5sZW5ndGggIT09IDApIHsKICAgICAgZGlzcGF0Y2hRdWV1ZS5wdXNoKHsKICAgICAgICBldmVudDogZXZlbnQsCiAgICAgICAgbGlzdGVuZXJzOiBsaXN0ZW5lcnMKICAgICAgfSk7CiAgICB9CiAgfSAvLyBXZSBzaG91bGQgb25seSB1c2UgdGhpcyBmdW5jdGlvbiBmb3I6CiAgLy8gLSBFbnRlckxlYXZlRXZlbnRQbHVnaW4KICAvLyBUaGlzIGlzIGJlY2F1c2Ugd2Ugb25seSBwcm9jZXNzIHRoaXMgcGx1Z2luCiAgLy8gaW4gdGhlIGJ1YmJsZSBwaGFzZSwgc28gd2UgbmVlZCB0byBhY2N1bXVsYXRlIHR3bwogIC8vIHBoYXNlIGV2ZW50IGxpc3RlbmVycy4KCgogIGZ1bmN0aW9uIGFjY3VtdWxhdGVFbnRlckxlYXZlVHdvUGhhc2VMaXN0ZW5lcnMoZGlzcGF0Y2hRdWV1ZSwgbGVhdmVFdmVudCwgZW50ZXJFdmVudCwgZnJvbSwgdG8pIHsKICAgIHZhciBjb21tb24gPSBmcm9tICYmIHRvID8gZ2V0TG93ZXN0Q29tbW9uQW5jZXN0b3IoZnJvbSwgdG8pIDogbnVsbDsKCiAgICBpZiAoZnJvbSAhPT0gbnVsbCkgewogICAgICBhY2N1bXVsYXRlRW50ZXJMZWF2ZUxpc3RlbmVyc0ZvckV2ZW50KGRpc3BhdGNoUXVldWUsIGxlYXZlRXZlbnQsIGZyb20sIGNvbW1vbiwgZmFsc2UpOwogICAgfQoKICAgIGlmICh0byAhPT0gbnVsbCAmJiBlbnRlckV2ZW50ICE9PSBudWxsKSB7CiAgICAgIGFjY3VtdWxhdGVFbnRlckxlYXZlTGlzdGVuZXJzRm9yRXZlbnQoZGlzcGF0Y2hRdWV1ZSwgZW50ZXJFdmVudCwgdG8sIGNvbW1vbiwgdHJ1ZSk7CiAgICB9CiAgfQogIGZ1bmN0aW9uIGdldExpc3RlbmVyU2V0S2V5KGRvbUV2ZW50TmFtZSwgY2FwdHVyZSkgewogICAgcmV0dXJuIGRvbUV2ZW50TmFtZSArICJfXyIgKyAoY2FwdHVyZSA/ICdjYXB0dXJlJyA6ICdidWJibGUnKTsKICB9CgogIHZhciBkaWRXYXJuSW52YWxpZEh5ZHJhdGlvbiA9IGZhbHNlOwogIHZhciBEQU5HRVJPVVNMWV9TRVRfSU5ORVJfSFRNTCA9ICdkYW5nZXJvdXNseVNldElubmVySFRNTCc7CiAgdmFyIFNVUFBSRVNTX0NPTlRFTlRfRURJVEFCTEVfV0FSTklORyA9ICdzdXBwcmVzc0NvbnRlbnRFZGl0YWJsZVdhcm5pbmcnOwogIHZhciBTVVBQUkVTU19IWURSQVRJT05fV0FSTklORyA9ICdzdXBwcmVzc0h5ZHJhdGlvbldhcm5pbmcnOwogIHZhciBBVVRPRk9DVVMgPSAnYXV0b0ZvY3VzJzsKICB2YXIgQ0hJTERSRU4gPSAnY2hpbGRyZW4nOwogIHZhciBTVFlMRSA9ICdzdHlsZSc7CiAgdmFyIEhUTUwkMSA9ICdfX2h0bWwnOwogIHZhciB3YXJuZWRVbmtub3duVGFnczsKICB2YXIgdmFsaWRhdGVQcm9wZXJ0aWVzSW5EZXZlbG9wbWVudDsKICB2YXIgd2FybkZvclByb3BEaWZmZXJlbmNlOwogIHZhciB3YXJuRm9yRXh0cmFBdHRyaWJ1dGVzOwogIHZhciB3YXJuRm9ySW52YWxpZEV2ZW50TGlzdGVuZXI7CiAgdmFyIGNhbkRpZmZTdHlsZUZvckh5ZHJhdGlvbldhcm5pbmc7CiAgdmFyIG5vcm1hbGl6ZUhUTUw7CgogIHsKICAgIHdhcm5lZFVua25vd25UYWdzID0gewogICAgICAvLyBUaGVyZSBhcmUgd29ya2luZyBwb2x5ZmlsbHMgZm9yIDxkaWFsb2c+LiBMZXQgcGVvcGxlIHVzZSBpdC4KICAgICAgZGlhbG9nOiB0cnVlLAogICAgICAvLyBFbGVjdHJvbiBzaGlwcyBhIGN1c3RvbSA8d2Vidmlldz4gdGFnIHRvIGRpc3BsYXkgZXh0ZXJuYWwgd2ViIGNvbnRlbnQgaW4KICAgICAgLy8gYW4gaXNvbGF0ZWQgZnJhbWUgYW5kIHByb2Nlc3MuCiAgICAgIC8vIFRoaXMgdGFnIGlzIG5vdCBwcmVzZW50IGluIG5vbiBFbGVjdHJvbiBlbnZpcm9ubWVudHMgc3VjaCBhcyBKU0RvbSB3aGljaAogICAgICAvLyBpcyBvZnRlbiB1c2VkIGZvciB0ZXN0aW5nIHB1cnBvc2VzLgogICAgICAvLyBAc2VlIGh0dHBzOi8vZWxlY3Ryb25qcy5vcmcvZG9jcy9hcGkvd2Vidmlldy10YWcKICAgICAgd2VidmlldzogdHJ1ZQogICAgfTsKCiAgICB2YWxpZGF0ZVByb3BlcnRpZXNJbkRldmVsb3BtZW50ID0gZnVuY3Rpb24gKHR5cGUsIHByb3BzKSB7CiAgICAgIHZhbGlkYXRlUHJvcGVydGllcyh0eXBlLCBwcm9wcyk7CiAgICAgIHZhbGlkYXRlUHJvcGVydGllcyQxKHR5cGUsIHByb3BzKTsKICAgICAgdmFsaWRhdGVQcm9wZXJ0aWVzJDIodHlwZSwgcHJvcHMsIHsKICAgICAgICByZWdpc3RyYXRpb25OYW1lRGVwZW5kZW5jaWVzOiByZWdpc3RyYXRpb25OYW1lRGVwZW5kZW5jaWVzLAogICAgICAgIHBvc3NpYmxlUmVnaXN0cmF0aW9uTmFtZXM6IHBvc3NpYmxlUmVnaXN0cmF0aW9uTmFtZXMKICAgICAgfSk7CiAgICB9OyAvLyBJRSAxMSBwYXJzZXMgJiBub3JtYWxpemVzIHRoZSBzdHlsZSBhdHRyaWJ1dGUgYXMgb3Bwb3NlZCB0byBvdGhlcgogICAgLy8gYnJvd3NlcnMuIEl0IGFkZHMgc3BhY2VzIGFuZCBzb3J0cyB0aGUgcHJvcGVydGllcyBpbiBzb21lCiAgICAvLyBub24tYWxwaGFiZXRpY2FsIG9yZGVyLiBIYW5kbGluZyB0aGF0IHdvdWxkIHJlcXVpcmUgc29ydGluZyBDU1MKICAgIC8vIHByb3BlcnRpZXMgaW4gdGhlIGNsaWVudCAmIHNlcnZlciB2ZXJzaW9ucyBvciBhcHBseWluZwogICAgLy8gYGV4cGVjdGVkU3R5bGVgIHRvIGEgdGVtcG9yYXJ5IERPTSBub2RlIHRvIHJlYWQgaXRzIGBzdHlsZWAgYXR0cmlidXRlCiAgICAvLyBub3JtYWxpemVkLiBTaW5jZSBpdCBvbmx5IGFmZmVjdHMgSUUsIHdlJ3JlIHNraXBwaW5nIHN0eWxlIHdhcm5pbmdzCiAgICAvLyBpbiB0aGF0IGJyb3dzZXIgY29tcGxldGVseSBpbiBmYXZvciBvZiBkb2luZyBhbGwgdGhhdCB3b3JrLgogICAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9mYWNlYm9vay9yZWFjdC9pc3N1ZXMvMTE4MDcKCgogICAgY2FuRGlmZlN0eWxlRm9ySHlkcmF0aW9uV2FybmluZyA9IGNhblVzZURPTSAmJiAhZG9jdW1lbnQuZG9jdW1lbnRNb2RlOwoKICAgIHdhcm5Gb3JQcm9wRGlmZmVyZW5jZSA9IGZ1bmN0aW9uIChwcm9wTmFtZSwgc2VydmVyVmFsdWUsIGNsaWVudFZhbHVlKSB7CiAgICAgIGlmIChkaWRXYXJuSW52YWxpZEh5ZHJhdGlvbikgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIG5vcm1hbGl6ZWRDbGllbnRWYWx1ZSA9IG5vcm1hbGl6ZU1hcmt1cEZvclRleHRPckF0dHJpYnV0ZShjbGllbnRWYWx1ZSk7CiAgICAgIHZhciBub3JtYWxpemVkU2VydmVyVmFsdWUgPSBub3JtYWxpemVNYXJrdXBGb3JUZXh0T3JBdHRyaWJ1dGUoc2VydmVyVmFsdWUpOwoKICAgICAgaWYgKG5vcm1hbGl6ZWRTZXJ2ZXJWYWx1ZSA9PT0gbm9ybWFsaXplZENsaWVudFZhbHVlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBkaWRXYXJuSW52YWxpZEh5ZHJhdGlvbiA9IHRydWU7CgogICAgICBlcnJvcignUHJvcCBgJXNgIGRpZCBub3QgbWF0Y2guIFNlcnZlcjogJXMgQ2xpZW50OiAlcycsIHByb3BOYW1lLCBKU09OLnN0cmluZ2lmeShub3JtYWxpemVkU2VydmVyVmFsdWUpLCBKU09OLnN0cmluZ2lmeShub3JtYWxpemVkQ2xpZW50VmFsdWUpKTsKICAgIH07CgogICAgd2FybkZvckV4dHJhQXR0cmlidXRlcyA9IGZ1bmN0aW9uIChhdHRyaWJ1dGVOYW1lcykgewogICAgICBpZiAoZGlkV2FybkludmFsaWRIeWRyYXRpb24pIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGRpZFdhcm5JbnZhbGlkSHlkcmF0aW9uID0gdHJ1ZTsKICAgICAgdmFyIG5hbWVzID0gW107CiAgICAgIGF0dHJpYnV0ZU5hbWVzLmZvckVhY2goZnVuY3Rpb24gKG5hbWUpIHsKICAgICAgICBuYW1lcy5wdXNoKG5hbWUpOwogICAgICB9KTsKCiAgICAgIGVycm9yKCdFeHRyYSBhdHRyaWJ1dGVzIGZyb20gdGhlIHNlcnZlcjogJXMnLCBuYW1lcyk7CiAgICB9OwoKICAgIHdhcm5Gb3JJbnZhbGlkRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uIChyZWdpc3RyYXRpb25OYW1lLCBsaXN0ZW5lcikgewogICAgICBpZiAobGlzdGVuZXIgPT09IGZhbHNlKSB7CiAgICAgICAgZXJyb3IoJ0V4cGVjdGVkIGAlc2AgbGlzdGVuZXIgdG8gYmUgYSBmdW5jdGlvbiwgaW5zdGVhZCBnb3QgYGZhbHNlYC5cblxuJyArICdJZiB5b3UgdXNlZCB0byBjb25kaXRpb25hbGx5IG9taXQgaXQgd2l0aCAlcz17Y29uZGl0aW9uICYmIHZhbHVlfSwgJyArICdwYXNzICVzPXtjb25kaXRpb24gPyB2YWx1ZSA6IHVuZGVmaW5lZH0gaW5zdGVhZC4nLCByZWdpc3RyYXRpb25OYW1lLCByZWdpc3RyYXRpb25OYW1lLCByZWdpc3RyYXRpb25OYW1lKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBlcnJvcignRXhwZWN0ZWQgYCVzYCBsaXN0ZW5lciB0byBiZSBhIGZ1bmN0aW9uLCBpbnN0ZWFkIGdvdCBhIHZhbHVlIG9mIGAlc2AgdHlwZS4nLCByZWdpc3RyYXRpb25OYW1lLCB0eXBlb2YgbGlzdGVuZXIpOwogICAgICB9CiAgICB9OyAvLyBQYXJzZSB0aGUgSFRNTCBhbmQgcmVhZCBpdCBiYWNrIHRvIG5vcm1hbGl6ZSB0aGUgSFRNTCBzdHJpbmcgc28gdGhhdCBpdAogICAgLy8gY2FuIGJlIHVzZWQgZm9yIGNvbXBhcmlzb24uCgoKICAgIG5vcm1hbGl6ZUhUTUwgPSBmdW5jdGlvbiAocGFyZW50LCBodG1sKSB7CiAgICAgIC8vIFdlIGNvdWxkIGhhdmUgY3JlYXRlZCBhIHNlcGFyYXRlIGRvY3VtZW50IGhlcmUgdG8gYXZvaWQKICAgICAgLy8gcmUtaW5pdGlhbGl6aW5nIGN1c3RvbSBlbGVtZW50cyBpZiB0aGV5IGV4aXN0LiBCdXQgdGhpcyBicmVha3MKICAgICAgLy8gaG93IDxub3NjcmlwdD4gaXMgYmVpbmcgaGFuZGxlZC4gU28gd2UgdXNlIHRoZSBzYW1lIGRvY3VtZW50LgogICAgICAvLyBTZWUgdGhlIGRpc2N1c3Npb24gaW4gaHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL3JlYWN0L3B1bGwvMTExNTcuCiAgICAgIHZhciB0ZXN0RWxlbWVudCA9IHBhcmVudC5uYW1lc3BhY2VVUkkgPT09IEhUTUxfTkFNRVNQQUNFID8gcGFyZW50Lm93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudChwYXJlbnQudGFnTmFtZSkgOiBwYXJlbnQub3duZXJEb2N1bWVudC5jcmVhdGVFbGVtZW50TlMocGFyZW50Lm5hbWVzcGFjZVVSSSwgcGFyZW50LnRhZ05hbWUpOwogICAgICB0ZXN0RWxlbWVudC5pbm5lckhUTUwgPSBodG1sOwogICAgICByZXR1cm4gdGVzdEVsZW1lbnQuaW5uZXJIVE1MOwogICAgfTsKICB9IC8vIEhUTUwgcGFyc2luZyBub3JtYWxpemVzIENSIGFuZCBDUkxGIHRvIExGLgogIC8vIEl0IGFsc28gY2FuIHR1cm4gXHUwMDAwIGludG8gXHVGRkZEIGluc2lkZSBhdHRyaWJ1dGVzLgogIC8vIGh0dHBzOi8vd3d3LnczLm9yZy9UUi9odG1sNS9zaW5nbGUtcGFnZS5odG1sI3ByZXByb2Nlc3NpbmctdGhlLWlucHV0LXN0cmVhbQogIC8vIElmIHdlIGhhdmUgYSBtaXNtYXRjaCwgaXQgbWlnaHQgYmUgY2F1c2VkIGJ5IHRoYXQuCiAgLy8gV2Ugd2lsbCBzdGlsbCBwYXRjaCB1cCBpbiB0aGlzIGNhc2UgYnV0IG5vdCBmaXJlIHRoZSB3YXJuaW5nLgoKCiAgdmFyIE5PUk1BTElaRV9ORVdMSU5FU19SRUdFWCA9IC9cclxuPy9nOwogIHZhciBOT1JNQUxJWkVfTlVMTF9BTkRfUkVQTEFDRU1FTlRfUkVHRVggPSAvXHUwMDAwfFx1RkZGRC9nOwoKICBmdW5jdGlvbiBub3JtYWxpemVNYXJrdXBGb3JUZXh0T3JBdHRyaWJ1dGUobWFya3VwKSB7CiAgICB7CiAgICAgIGNoZWNrSHRtbFN0cmluZ0NvZXJjaW9uKG1hcmt1cCk7CiAgICB9CgogICAgdmFyIG1hcmt1cFN0cmluZyA9IHR5cGVvZiBtYXJrdXAgPT09ICdzdHJpbmcnID8gbWFya3VwIDogJycgKyBtYXJrdXA7CiAgICByZXR1cm4gbWFya3VwU3RyaW5nLnJlcGxhY2UoTk9STUFMSVpFX05FV0xJTkVTX1JFR0VYLCAnXG4nKS5yZXBsYWNlKE5PUk1BTElaRV9OVUxMX0FORF9SRVBMQUNFTUVOVF9SRUdFWCwgJycpOwogIH0KCiAgZnVuY3Rpb24gY2hlY2tGb3JVbm1hdGNoZWRUZXh0KHNlcnZlclRleHQsIGNsaWVudFRleHQsIGlzQ29uY3VycmVudE1vZGUsIHNob3VsZFdhcm5EZXYpIHsKICAgIHZhciBub3JtYWxpemVkQ2xpZW50VGV4dCA9IG5vcm1hbGl6ZU1hcmt1cEZvclRleHRPckF0dHJpYnV0ZShjbGllbnRUZXh0KTsKICAgIHZhciBub3JtYWxpemVkU2VydmVyVGV4dCA9IG5vcm1hbGl6ZU1hcmt1cEZvclRleHRPckF0dHJpYnV0ZShzZXJ2ZXJUZXh0KTsKCiAgICBpZiAobm9ybWFsaXplZFNlcnZlclRleHQgPT09IG5vcm1hbGl6ZWRDbGllbnRUZXh0KSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAoc2hvdWxkV2FybkRldikgewogICAgICB7CiAgICAgICAgaWYgKCFkaWRXYXJuSW52YWxpZEh5ZHJhdGlvbikgewogICAgICAgICAgZGlkV2FybkludmFsaWRIeWRyYXRpb24gPSB0cnVlOwoKICAgICAgICAgIGVycm9yKCdUZXh0IGNvbnRlbnQgZGlkIG5vdCBtYXRjaC4gU2VydmVyOiAiJXMiIENsaWVudDogIiVzIicsIG5vcm1hbGl6ZWRTZXJ2ZXJUZXh0LCBub3JtYWxpemVkQ2xpZW50VGV4dCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgaWYgKGlzQ29uY3VycmVudE1vZGUgJiYgZW5hYmxlQ2xpZW50UmVuZGVyRmFsbGJhY2tPblRleHRNaXNtYXRjaCkgewogICAgICAvLyBJbiBjb25jdXJyZW50IHJvb3RzLCB3ZSB0aHJvdyB3aGVuIHRoZXJlJ3MgYSB0ZXh0IG1pc21hdGNoIGFuZCByZXZlcnQgdG8KICAgICAgLy8gY2xpZW50IHJlbmRlcmluZywgdXAgdG8gdGhlIG5lYXJlc3QgU3VzcGVuc2UgYm91bmRhcnkuCiAgICAgIHRocm93IG5ldyBFcnJvcignVGV4dCBjb250ZW50IGRvZXMgbm90IG1hdGNoIHNlcnZlci1yZW5kZXJlZCBIVE1MLicpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gZ2V0T3duZXJEb2N1bWVudEZyb21Sb290Q29udGFpbmVyKHJvb3RDb250YWluZXJFbGVtZW50KSB7CiAgICByZXR1cm4gcm9vdENvbnRhaW5lckVsZW1lbnQubm9kZVR5cGUgPT09IERPQ1VNRU5UX05PREUgPyByb290Q29udGFpbmVyRWxlbWVudCA6IHJvb3RDb250YWluZXJFbGVtZW50Lm93bmVyRG9jdW1lbnQ7CiAgfQoKICBmdW5jdGlvbiBub29wKCkge30KCiAgZnVuY3Rpb24gdHJhcENsaWNrT25Ob25JbnRlcmFjdGl2ZUVsZW1lbnQobm9kZSkgewogICAgLy8gTW9iaWxlIFNhZmFyaSBkb2VzIG5vdCBmaXJlIHByb3Blcmx5IGJ1YmJsZSBjbGljayBldmVudHMgb24KICAgIC8vIG5vbi1pbnRlcmFjdGl2ZSBlbGVtZW50cywgd2hpY2ggbWVhbnMgZGVsZWdhdGVkIGNsaWNrIGxpc3RlbmVycyBkbyBub3QKICAgIC8vIGZpcmUuIFRoZSB3b3JrYXJvdW5kIGZvciB0aGlzIGJ1ZyBpbnZvbHZlcyBhdHRhY2hpbmcgYW4gZW1wdHkgY2xpY2sKICAgIC8vIGxpc3RlbmVyIG9uIHRoZSB0YXJnZXQgbm9kZS4KICAgIC8vIGh0dHBzOi8vd3d3LnF1aXJrc21vZGUub3JnL2Jsb2cvYXJjaGl2ZXMvMjAxMC8wOS9jbGlja19ldmVudF9kZWwuaHRtbAogICAgLy8gSnVzdCBzZXQgaXQgdXNpbmcgdGhlIG9uY2xpY2sgcHJvcGVydHkgc28gdGhhdCB3ZSBkb24ndCBoYXZlIHRvIG1hbmFnZSBhbnkKICAgIC8vIGJvb2trZWVwaW5nIGZvciBpdC4gTm90IHN1cmUgaWYgd2UgbmVlZCB0byBjbGVhciBpdCB3aGVuIHRoZSBsaXN0ZW5lciBpcwogICAgLy8gcmVtb3ZlZC4KICAgIC8vIFRPRE86IE9ubHkgZG8gdGhpcyBmb3IgdGhlIHJlbGV2YW50IFNhZmFyaXMgbWF5YmU/CiAgICBub2RlLm9uY2xpY2sgPSBub29wOwogIH0KCiAgZnVuY3Rpb24gc2V0SW5pdGlhbERPTVByb3BlcnRpZXModGFnLCBkb21FbGVtZW50LCByb290Q29udGFpbmVyRWxlbWVudCwgbmV4dFByb3BzLCBpc0N1c3RvbUNvbXBvbmVudFRhZykgewogICAgZm9yICh2YXIgcHJvcEtleSBpbiBuZXh0UHJvcHMpIHsKICAgICAgaWYgKCFuZXh0UHJvcHMuaGFzT3duUHJvcGVydHkocHJvcEtleSkpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgdmFyIG5leHRQcm9wID0gbmV4dFByb3BzW3Byb3BLZXldOwoKICAgICAgaWYgKHByb3BLZXkgPT09IFNUWUxFKSB7CiAgICAgICAgewogICAgICAgICAgaWYgKG5leHRQcm9wKSB7CiAgICAgICAgICAgIC8vIEZyZWV6ZSB0aGUgbmV4dCBzdHlsZSBvYmplY3Qgc28gdGhhdCB3ZSBjYW4gYXNzdW1lIGl0IHdvbid0IGJlCiAgICAgICAgICAgIC8vIG11dGF0ZWQuIFdlIGhhdmUgYWxyZWFkeSB3YXJuZWQgZm9yIHRoaXMgaW4gdGhlIHBhc3QuCiAgICAgICAgICAgIE9iamVjdC5mcmVlemUobmV4dFByb3ApOwogICAgICAgICAgfQogICAgICAgIH0gLy8gUmVsaWVzIG9uIGB1cGRhdGVTdHlsZXNCeUlEYCBub3QgbXV0YXRpbmcgYHN0eWxlVXBkYXRlc2AuCgoKICAgICAgICBzZXRWYWx1ZUZvclN0eWxlcyhkb21FbGVtZW50LCBuZXh0UHJvcCk7CiAgICAgIH0gZWxzZSBpZiAocHJvcEtleSA9PT0gREFOR0VST1VTTFlfU0VUX0lOTkVSX0hUTUwpIHsKICAgICAgICB2YXIgbmV4dEh0bWwgPSBuZXh0UHJvcCA/IG5leHRQcm9wW0hUTUwkMV0gOiB1bmRlZmluZWQ7CgogICAgICAgIGlmIChuZXh0SHRtbCAhPSBudWxsKSB7CiAgICAgICAgICBzZXRJbm5lckhUTUwoZG9tRWxlbWVudCwgbmV4dEh0bWwpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChwcm9wS2V5ID09PSBDSElMRFJFTikgewogICAgICAgIGlmICh0eXBlb2YgbmV4dFByb3AgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgICAvLyBBdm9pZCBzZXR0aW5nIGluaXRpYWwgdGV4dENvbnRlbnQgd2hlbiB0aGUgdGV4dCBpcyBlbXB0eS4gSW4gSUUxMSBzZXR0aW5nCiAgICAgICAgICAvLyB0ZXh0Q29udGVudCBvbiBhIDx0ZXh0YXJlYT4gd2lsbCBjYXVzZSB0aGUgcGxhY2Vob2xkZXIgdG8gbm90CiAgICAgICAgICAvLyBzaG93IHdpdGhpbiB0aGUgPHRleHRhcmVhPiB1bnRpbCBpdCBoYXMgYmVlbiBmb2N1c2VkIGFuZCBibHVycmVkIGFnYWluLgogICAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL3JlYWN0L2lzc3Vlcy82NzMxI2lzc3VlY29tbWVudC0yNTQ4NzQ1NTMKICAgICAgICAgIHZhciBjYW5TZXRUZXh0Q29udGVudCA9IHRhZyAhPT0gJ3RleHRhcmVhJyB8fCBuZXh0UHJvcCAhPT0gJyc7CgogICAgICAgICAgaWYgKGNhblNldFRleHRDb250ZW50KSB7CiAgICAgICAgICAgIHNldFRleHRDb250ZW50KGRvbUVsZW1lbnQsIG5leHRQcm9wKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBuZXh0UHJvcCA9PT0gJ251bWJlcicpIHsKICAgICAgICAgIHNldFRleHRDb250ZW50KGRvbUVsZW1lbnQsICcnICsgbmV4dFByb3ApOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChwcm9wS2V5ID09PSBTVVBQUkVTU19DT05URU5UX0VESVRBQkxFX1dBUk5JTkcgfHwgcHJvcEtleSA9PT0gU1VQUFJFU1NfSFlEUkFUSU9OX1dBUk5JTkcpIDsgZWxzZSBpZiAocHJvcEtleSA9PT0gQVVUT0ZPQ1VTKSA7IGVsc2UgaWYgKHJlZ2lzdHJhdGlvbk5hbWVEZXBlbmRlbmNpZXMuaGFzT3duUHJvcGVydHkocHJvcEtleSkpIHsKICAgICAgICBpZiAobmV4dFByb3AgIT0gbnVsbCkgewogICAgICAgICAgaWYgKCB0eXBlb2YgbmV4dFByb3AgIT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgICAgd2FybkZvckludmFsaWRFdmVudExpc3RlbmVyKHByb3BLZXksIG5leHRQcm9wKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAocHJvcEtleSA9PT0gJ29uU2Nyb2xsJykgewogICAgICAgICAgICBsaXN0ZW5Ub05vbkRlbGVnYXRlZEV2ZW50KCdzY3JvbGwnLCBkb21FbGVtZW50KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAobmV4dFByb3AgIT0gbnVsbCkgewogICAgICAgIHNldFZhbHVlRm9yUHJvcGVydHkoZG9tRWxlbWVudCwgcHJvcEtleSwgbmV4dFByb3AsIGlzQ3VzdG9tQ29tcG9uZW50VGFnKTsKICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gdXBkYXRlRE9NUHJvcGVydGllcyhkb21FbGVtZW50LCB1cGRhdGVQYXlsb2FkLCB3YXNDdXN0b21Db21wb25lbnRUYWcsIGlzQ3VzdG9tQ29tcG9uZW50VGFnKSB7CiAgICAvLyBUT0RPOiBIYW5kbGUgd2FzQ3VzdG9tQ29tcG9uZW50VGFnCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHVwZGF0ZVBheWxvYWQubGVuZ3RoOyBpICs9IDIpIHsKICAgICAgdmFyIHByb3BLZXkgPSB1cGRhdGVQYXlsb2FkW2ldOwogICAgICB2YXIgcHJvcFZhbHVlID0gdXBkYXRlUGF5bG9hZFtpICsgMV07CgogICAgICBpZiAocHJvcEtleSA9PT0gU1RZTEUpIHsKICAgICAgICBzZXRWYWx1ZUZvclN0eWxlcyhkb21FbGVtZW50LCBwcm9wVmFsdWUpOwogICAgICB9IGVsc2UgaWYgKHByb3BLZXkgPT09IERBTkdFUk9VU0xZX1NFVF9JTk5FUl9IVE1MKSB7CiAgICAgICAgc2V0SW5uZXJIVE1MKGRvbUVsZW1lbnQsIHByb3BWYWx1ZSk7CiAgICAgIH0gZWxzZSBpZiAocHJvcEtleSA9PT0gQ0hJTERSRU4pIHsKICAgICAgICBzZXRUZXh0Q29udGVudChkb21FbGVtZW50LCBwcm9wVmFsdWUpOwogICAgICB9IGVsc2UgewogICAgICAgIHNldFZhbHVlRm9yUHJvcGVydHkoZG9tRWxlbWVudCwgcHJvcEtleSwgcHJvcFZhbHVlLCBpc0N1c3RvbUNvbXBvbmVudFRhZyk7CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIGNyZWF0ZUVsZW1lbnQodHlwZSwgcHJvcHMsIHJvb3RDb250YWluZXJFbGVtZW50LCBwYXJlbnROYW1lc3BhY2UpIHsKICAgIHZhciBpc0N1c3RvbUNvbXBvbmVudFRhZzsgLy8gV2UgY3JlYXRlIHRhZ3MgaW4gdGhlIG5hbWVzcGFjZSBvZiB0aGVpciBwYXJlbnQgY29udGFpbmVyLCBleGNlcHQgSFRNTAogICAgLy8gdGFncyBnZXQgbm8gbmFtZXNwYWNlLgoKICAgIHZhciBvd25lckRvY3VtZW50ID0gZ2V0T3duZXJEb2N1bWVudEZyb21Sb290Q29udGFpbmVyKHJvb3RDb250YWluZXJFbGVtZW50KTsKICAgIHZhciBkb21FbGVtZW50OwogICAgdmFyIG5hbWVzcGFjZVVSSSA9IHBhcmVudE5hbWVzcGFjZTsKCiAgICBpZiAobmFtZXNwYWNlVVJJID09PSBIVE1MX05BTUVTUEFDRSkgewogICAgICBuYW1lc3BhY2VVUkkgPSBnZXRJbnRyaW5zaWNOYW1lc3BhY2UodHlwZSk7CiAgICB9CgogICAgaWYgKG5hbWVzcGFjZVVSSSA9PT0gSFRNTF9OQU1FU1BBQ0UpIHsKICAgICAgewogICAgICAgIGlzQ3VzdG9tQ29tcG9uZW50VGFnID0gaXNDdXN0b21Db21wb25lbnQodHlwZSwgcHJvcHMpOyAvLyBTaG91bGQgdGhpcyBjaGVjayBiZSBnYXRlZCBieSBwYXJlbnQgbmFtZXNwYWNlPyBOb3Qgc3VyZSB3ZSB3YW50IHRvCiAgICAgICAgLy8gYWxsb3cgPFNWRz4gb3IgPG1BVEg+LgoKICAgICAgICBpZiAoIWlzQ3VzdG9tQ29tcG9uZW50VGFnICYmIHR5cGUgIT09IHR5cGUudG9Mb3dlckNhc2UoKSkgewogICAgICAgICAgZXJyb3IoJzwlcyAvPiBpcyB1c2luZyBpbmNvcnJlY3QgY2FzaW5nLiAnICsgJ1VzZSBQYXNjYWxDYXNlIGZvciBSZWFjdCBjb21wb25lbnRzLCAnICsgJ29yIGxvd2VyY2FzZSBmb3IgSFRNTCBlbGVtZW50cy4nLCB0eXBlKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICh0eXBlID09PSAnc2NyaXB0JykgewogICAgICAgIC8vIENyZWF0ZSB0aGUgc2NyaXB0IHZpYSAuaW5uZXJIVE1MIHNvIGl0cyAicGFyc2VyLWluc2VydGVkIiBmbGFnIGlzCiAgICAgICAgLy8gc2V0IHRvIHRydWUgYW5kIGl0IGRvZXMgbm90IGV4ZWN1dGUKICAgICAgICB2YXIgZGl2ID0gb3duZXJEb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKCiAgICAgICAgZGl2LmlubmVySFRNTCA9ICc8c2NyaXB0PjwnICsgJy9zY3JpcHQ+JzsgLy8gZXNsaW50LWRpc2FibGUtbGluZQogICAgICAgIC8vIFRoaXMgaXMgZ3VhcmFudGVlZCB0byB5aWVsZCBhIHNjcmlwdCBlbGVtZW50LgoKICAgICAgICB2YXIgZmlyc3RDaGlsZCA9IGRpdi5maXJzdENoaWxkOwogICAgICAgIGRvbUVsZW1lbnQgPSBkaXYucmVtb3ZlQ2hpbGQoZmlyc3RDaGlsZCk7CiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHByb3BzLmlzID09PSAnc3RyaW5nJykgewogICAgICAgIC8vICRGbG93SXNzdWUgYGNyZWF0ZUVsZW1lbnRgIHNob3VsZCBiZSB1cGRhdGVkIGZvciBXZWIgQ29tcG9uZW50cwogICAgICAgIGRvbUVsZW1lbnQgPSBvd25lckRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodHlwZSwgewogICAgICAgICAgaXM6IHByb3BzLmlzCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gU2VwYXJhdGUgZWxzZSBicmFuY2ggaW5zdGVhZCBvZiB1c2luZyBgcHJvcHMuaXMgfHwgdW5kZWZpbmVkYCBhYm92ZSBiZWNhdXNlIG9mIGEgRmlyZWZveCBidWcuCiAgICAgICAgLy8gU2VlIGRpc2N1c3Npb24gaW4gaHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL3JlYWN0L3B1bGwvNjg5NgogICAgICAgIC8vIGFuZCBkaXNjdXNzaW9uIGluIGh0dHBzOi8vYnVnemlsbGEubW96aWxsYS5vcmcvc2hvd19idWcuY2dpP2lkPTEyNzYyNDAKICAgICAgICBkb21FbGVtZW50ID0gb3duZXJEb2N1bWVudC5jcmVhdGVFbGVtZW50KHR5cGUpOyAvLyBOb3JtYWxseSBhdHRyaWJ1dGVzIGFyZSBhc3NpZ25lZCBpbiBgc2V0SW5pdGlhbERPTVByb3BlcnRpZXNgLCBob3dldmVyIHRoZSBgbXVsdGlwbGVgIGFuZCBgc2l6ZWAKICAgICAgICAvLyBhdHRyaWJ1dGVzIG9uIGBzZWxlY3RgcyBuZWVkcyB0byBiZSBhZGRlZCBiZWZvcmUgYG9wdGlvbmBzIGFyZSBpbnNlcnRlZC4KICAgICAgICAvLyBUaGlzIHByZXZlbnRzOgogICAgICAgIC8vIC0gYSBidWcgd2hlcmUgdGhlIGBzZWxlY3RgIGRvZXMgbm90IHNjcm9sbCB0byB0aGUgY29ycmVjdCBvcHRpb24gYmVjYXVzZSBzaW5ndWxhcgogICAgICAgIC8vICBgc2VsZWN0YCBlbGVtZW50cyBhdXRvbWF0aWNhbGx5IHBpY2sgdGhlIGZpcnN0IGl0ZW0gIzEzMjIyCiAgICAgICAgLy8gLSBhIGJ1ZyB3aGVyZSB0aGUgYHNlbGVjdGAgc2V0IHRoZSBmaXJzdCBpdGVtIGFzIHNlbGVjdGVkIGRlc3BpdGUgdGhlIGBzaXplYCBhdHRyaWJ1dGUgIzE0MjM5CiAgICAgICAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9mYWNlYm9vay9yZWFjdC9pc3N1ZXMvMTMyMjIKICAgICAgICAvLyBhbmQgaHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL3JlYWN0L2lzc3Vlcy8xNDIzOQoKICAgICAgICBpZiAodHlwZSA9PT0gJ3NlbGVjdCcpIHsKICAgICAgICAgIHZhciBub2RlID0gZG9tRWxlbWVudDsKCiAgICAgICAgICBpZiAocHJvcHMubXVsdGlwbGUpIHsKICAgICAgICAgICAgbm9kZS5tdWx0aXBsZSA9IHRydWU7CiAgICAgICAgICB9IGVsc2UgaWYgKHByb3BzLnNpemUpIHsKICAgICAgICAgICAgLy8gU2V0dGluZyBhIHNpemUgZ3JlYXRlciB0aGFuIDEgY2F1c2VzIGEgc2VsZWN0IHRvIGJlaGF2ZSBsaWtlIGBtdWx0aXBsZT10cnVlYCwgd2hlcmUKICAgICAgICAgICAgLy8gaXQgaXMgcG9zc2libGUgdGhhdCBubyBvcHRpb24gaXMgc2VsZWN0ZWQuCiAgICAgICAgICAgIC8vCiAgICAgICAgICAgIC8vIFRoaXMgaXMgb25seSBuZWNlc3Nhcnkgd2hlbiBhIHNlbGVjdCBpbiAic2luZ2xlIHNlbGVjdGlvbiBtb2RlIi4KICAgICAgICAgICAgbm9kZS5zaXplID0gcHJvcHMuc2l6ZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGRvbUVsZW1lbnQgPSBvd25lckRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyhuYW1lc3BhY2VVUkksIHR5cGUpOwogICAgfQoKICAgIHsKICAgICAgaWYgKG5hbWVzcGFjZVVSSSA9PT0gSFRNTF9OQU1FU1BBQ0UpIHsKICAgICAgICBpZiAoIWlzQ3VzdG9tQ29tcG9uZW50VGFnICYmIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChkb21FbGVtZW50KSA9PT0gJ1tvYmplY3QgSFRNTFVua25vd25FbGVtZW50XScgJiYgIWhhc093blByb3BlcnR5LmNhbGwod2FybmVkVW5rbm93blRhZ3MsIHR5cGUpKSB7CiAgICAgICAgICB3YXJuZWRVbmtub3duVGFnc1t0eXBlXSA9IHRydWU7CgogICAgICAgICAgZXJyb3IoJ1RoZSB0YWcgPCVzPiBpcyB1bnJlY29nbml6ZWQgaW4gdGhpcyBicm93c2VyLiAnICsgJ0lmIHlvdSBtZWFudCB0byByZW5kZXIgYSBSZWFjdCBjb21wb25lbnQsIHN0YXJ0IGl0cyBuYW1lIHdpdGggJyArICdhbiB1cHBlcmNhc2UgbGV0dGVyLicsIHR5cGUpOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHJldHVybiBkb21FbGVtZW50OwogIH0KICBmdW5jdGlvbiBjcmVhdGVUZXh0Tm9kZSh0ZXh0LCByb290Q29udGFpbmVyRWxlbWVudCkgewogICAgcmV0dXJuIGdldE93bmVyRG9jdW1lbnRGcm9tUm9vdENvbnRhaW5lcihyb290Q29udGFpbmVyRWxlbWVudCkuY3JlYXRlVGV4dE5vZGUodGV4dCk7CiAgfQogIGZ1bmN0aW9uIHNldEluaXRpYWxQcm9wZXJ0aWVzKGRvbUVsZW1lbnQsIHRhZywgcmF3UHJvcHMsIHJvb3RDb250YWluZXJFbGVtZW50KSB7CiAgICB2YXIgaXNDdXN0b21Db21wb25lbnRUYWcgPSBpc0N1c3RvbUNvbXBvbmVudCh0YWcsIHJhd1Byb3BzKTsKCiAgICB7CiAgICAgIHZhbGlkYXRlUHJvcGVydGllc0luRGV2ZWxvcG1lbnQodGFnLCByYXdQcm9wcyk7CiAgICB9IC8vIFRPRE86IE1ha2Ugc3VyZSB0aGF0IHdlIGNoZWNrIGlzTW91bnRlZCBiZWZvcmUgZmlyaW5nIGFueSBvZiB0aGVzZSBldmVudHMuCgoKICAgIHZhciBwcm9wczsKCiAgICBzd2l0Y2ggKHRhZykgewogICAgICBjYXNlICdkaWFsb2cnOgogICAgICAgIGxpc3RlblRvTm9uRGVsZWdhdGVkRXZlbnQoJ2NhbmNlbCcsIGRvbUVsZW1lbnQpOwogICAgICAgIGxpc3RlblRvTm9uRGVsZWdhdGVkRXZlbnQoJ2Nsb3NlJywgZG9tRWxlbWVudCk7CiAgICAgICAgcHJvcHMgPSByYXdQcm9wczsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ2lmcmFtZSc6CiAgICAgIGNhc2UgJ29iamVjdCc6CiAgICAgIGNhc2UgJ2VtYmVkJzoKICAgICAgICAvLyBXZSBsaXN0ZW4gdG8gdGhpcyBldmVudCBpbiBjYXNlIHRvIGVuc3VyZSBlbXVsYXRlZCBidWJibGUKICAgICAgICAvLyBsaXN0ZW5lcnMgc3RpbGwgZmlyZSBmb3IgdGhlIGxvYWQgZXZlbnQuCiAgICAgICAgbGlzdGVuVG9Ob25EZWxlZ2F0ZWRFdmVudCgnbG9hZCcsIGRvbUVsZW1lbnQpOwogICAgICAgIHByb3BzID0gcmF3UHJvcHM7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICd2aWRlbyc6CiAgICAgIGNhc2UgJ2F1ZGlvJzoKICAgICAgICAvLyBXZSBsaXN0ZW4gdG8gdGhlc2UgZXZlbnRzIGluIGNhc2UgdG8gZW5zdXJlIGVtdWxhdGVkIGJ1YmJsZQogICAgICAgIC8vIGxpc3RlbmVycyBzdGlsbCBmaXJlIGZvciBhbGwgdGhlIG1lZGlhIGV2ZW50cy4KICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1lZGlhRXZlbnRUeXBlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgbGlzdGVuVG9Ob25EZWxlZ2F0ZWRFdmVudChtZWRpYUV2ZW50VHlwZXNbaV0sIGRvbUVsZW1lbnQpOwogICAgICAgIH0KCiAgICAgICAgcHJvcHMgPSByYXdQcm9wczsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ3NvdXJjZSc6CiAgICAgICAgLy8gV2UgbGlzdGVuIHRvIHRoaXMgZXZlbnQgaW4gY2FzZSB0byBlbnN1cmUgZW11bGF0ZWQgYnViYmxlCiAgICAgICAgLy8gbGlzdGVuZXJzIHN0aWxsIGZpcmUgZm9yIHRoZSBlcnJvciBldmVudC4KICAgICAgICBsaXN0ZW5Ub05vbkRlbGVnYXRlZEV2ZW50KCdlcnJvcicsIGRvbUVsZW1lbnQpOwogICAgICAgIHByb3BzID0gcmF3UHJvcHM7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICdpbWcnOgogICAgICBjYXNlICdpbWFnZSc6CiAgICAgIGNhc2UgJ2xpbmsnOgogICAgICAgIC8vIFdlIGxpc3RlbiB0byB0aGVzZSBldmVudHMgaW4gY2FzZSB0byBlbnN1cmUgZW11bGF0ZWQgYnViYmxlCiAgICAgICAgLy8gbGlzdGVuZXJzIHN0aWxsIGZpcmUgZm9yIGVycm9yIGFuZCBsb2FkIGV2ZW50cy4KICAgICAgICBsaXN0ZW5Ub05vbkRlbGVnYXRlZEV2ZW50KCdlcnJvcicsIGRvbUVsZW1lbnQpOwogICAgICAgIGxpc3RlblRvTm9uRGVsZWdhdGVkRXZlbnQoJ2xvYWQnLCBkb21FbGVtZW50KTsKICAgICAgICBwcm9wcyA9IHJhd1Byb3BzOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnZGV0YWlscyc6CiAgICAgICAgLy8gV2UgbGlzdGVuIHRvIHRoaXMgZXZlbnQgaW4gY2FzZSB0byBlbnN1cmUgZW11bGF0ZWQgYnViYmxlCiAgICAgICAgLy8gbGlzdGVuZXJzIHN0aWxsIGZpcmUgZm9yIHRoZSB0b2dnbGUgZXZlbnQuCiAgICAgICAgbGlzdGVuVG9Ob25EZWxlZ2F0ZWRFdmVudCgndG9nZ2xlJywgZG9tRWxlbWVudCk7CiAgICAgICAgcHJvcHMgPSByYXdQcm9wczsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ2lucHV0JzoKICAgICAgICBpbml0V3JhcHBlclN0YXRlKGRvbUVsZW1lbnQsIHJhd1Byb3BzKTsKICAgICAgICBwcm9wcyA9IGdldEhvc3RQcm9wcyhkb21FbGVtZW50LCByYXdQcm9wcyk7IC8vIFdlIGxpc3RlbiB0byB0aGlzIGV2ZW50IGluIGNhc2UgdG8gZW5zdXJlIGVtdWxhdGVkIGJ1YmJsZQogICAgICAgIC8vIGxpc3RlbmVycyBzdGlsbCBmaXJlIGZvciB0aGUgaW52YWxpZCBldmVudC4KCiAgICAgICAgbGlzdGVuVG9Ob25EZWxlZ2F0ZWRFdmVudCgnaW52YWxpZCcsIGRvbUVsZW1lbnQpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnb3B0aW9uJzoKICAgICAgICB2YWxpZGF0ZVByb3BzKGRvbUVsZW1lbnQsIHJhd1Byb3BzKTsKICAgICAgICBwcm9wcyA9IHJhd1Byb3BzOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnc2VsZWN0JzoKICAgICAgICBpbml0V3JhcHBlclN0YXRlJDEoZG9tRWxlbWVudCwgcmF3UHJvcHMpOwogICAgICAgIHByb3BzID0gZ2V0SG9zdFByb3BzJDEoZG9tRWxlbWVudCwgcmF3UHJvcHMpOyAvLyBXZSBsaXN0ZW4gdG8gdGhpcyBldmVudCBpbiBjYXNlIHRvIGVuc3VyZSBlbXVsYXRlZCBidWJibGUKICAgICAgICAvLyBsaXN0ZW5lcnMgc3RpbGwgZmlyZSBmb3IgdGhlIGludmFsaWQgZXZlbnQuCgogICAgICAgIGxpc3RlblRvTm9uRGVsZWdhdGVkRXZlbnQoJ2ludmFsaWQnLCBkb21FbGVtZW50KTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ3RleHRhcmVhJzoKICAgICAgICBpbml0V3JhcHBlclN0YXRlJDIoZG9tRWxlbWVudCwgcmF3UHJvcHMpOwogICAgICAgIHByb3BzID0gZ2V0SG9zdFByb3BzJDIoZG9tRWxlbWVudCwgcmF3UHJvcHMpOyAvLyBXZSBsaXN0ZW4gdG8gdGhpcyBldmVudCBpbiBjYXNlIHRvIGVuc3VyZSBlbXVsYXRlZCBidWJibGUKICAgICAgICAvLyBsaXN0ZW5lcnMgc3RpbGwgZmlyZSBmb3IgdGhlIGludmFsaWQgZXZlbnQuCgogICAgICAgIGxpc3RlblRvTm9uRGVsZWdhdGVkRXZlbnQoJ2ludmFsaWQnLCBkb21FbGVtZW50KTsKICAgICAgICBicmVhazsKCiAgICAgIGRlZmF1bHQ6CiAgICAgICAgcHJvcHMgPSByYXdQcm9wczsKICAgIH0KCiAgICBhc3NlcnRWYWxpZFByb3BzKHRhZywgcHJvcHMpOwogICAgc2V0SW5pdGlhbERPTVByb3BlcnRpZXModGFnLCBkb21FbGVtZW50LCByb290Q29udGFpbmVyRWxlbWVudCwgcHJvcHMsIGlzQ3VzdG9tQ29tcG9uZW50VGFnKTsKCiAgICBzd2l0Y2ggKHRhZykgewogICAgICBjYXNlICdpbnB1dCc6CiAgICAgICAgLy8gVE9ETzogTWFrZSBzdXJlIHdlIGNoZWNrIGlmIHRoaXMgaXMgc3RpbGwgdW5tb3VudGVkIG9yIGRvIGFueSBjbGVhbgogICAgICAgIC8vIHVwIG5lY2Vzc2FyeSBzaW5jZSB3ZSBuZXZlciBzdG9wIHRyYWNraW5nIGFueW1vcmUuCiAgICAgICAgdHJhY2soZG9tRWxlbWVudCk7CiAgICAgICAgcG9zdE1vdW50V3JhcHBlcihkb21FbGVtZW50LCByYXdQcm9wcywgZmFsc2UpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAndGV4dGFyZWEnOgogICAgICAgIC8vIFRPRE86IE1ha2Ugc3VyZSB3ZSBjaGVjayBpZiB0aGlzIGlzIHN0aWxsIHVubW91bnRlZCBvciBkbyBhbnkgY2xlYW4KICAgICAgICAvLyB1cCBuZWNlc3Nhcnkgc2luY2Ugd2UgbmV2ZXIgc3RvcCB0cmFja2luZyBhbnltb3JlLgogICAgICAgIHRyYWNrKGRvbUVsZW1lbnQpOwogICAgICAgIHBvc3RNb3VudFdyYXBwZXIkMyhkb21FbGVtZW50KTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ29wdGlvbic6CiAgICAgICAgcG9zdE1vdW50V3JhcHBlciQxKGRvbUVsZW1lbnQsIHJhd1Byb3BzKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ3NlbGVjdCc6CiAgICAgICAgcG9zdE1vdW50V3JhcHBlciQyKGRvbUVsZW1lbnQsIHJhd1Byb3BzKTsKICAgICAgICBicmVhazsKCiAgICAgIGRlZmF1bHQ6CiAgICAgICAgaWYgKHR5cGVvZiBwcm9wcy5vbkNsaWNrID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAvLyBUT0RPOiBUaGlzIGNhc3QgbWF5IG5vdCBiZSBzb3VuZCBmb3IgU1ZHLCBNYXRoTUwgb3IgY3VzdG9tIGVsZW1lbnRzLgogICAgICAgICAgdHJhcENsaWNrT25Ob25JbnRlcmFjdGl2ZUVsZW1lbnQoZG9tRWxlbWVudCk7CiAgICAgICAgfQoKICAgICAgICBicmVhazsKICAgIH0KICB9IC8vIENhbGN1bGF0ZSB0aGUgZGlmZiBiZXR3ZWVuIHRoZSB0d28gb2JqZWN0cy4KCiAgZnVuY3Rpb24gZGlmZlByb3BlcnRpZXMoZG9tRWxlbWVudCwgdGFnLCBsYXN0UmF3UHJvcHMsIG5leHRSYXdQcm9wcywgcm9vdENvbnRhaW5lckVsZW1lbnQpIHsKICAgIHsKICAgICAgdmFsaWRhdGVQcm9wZXJ0aWVzSW5EZXZlbG9wbWVudCh0YWcsIG5leHRSYXdQcm9wcyk7CiAgICB9CgogICAgdmFyIHVwZGF0ZVBheWxvYWQgPSBudWxsOwogICAgdmFyIGxhc3RQcm9wczsKICAgIHZhciBuZXh0UHJvcHM7CgogICAgc3dpdGNoICh0YWcpIHsKICAgICAgY2FzZSAnaW5wdXQnOgogICAgICAgIGxhc3RQcm9wcyA9IGdldEhvc3RQcm9wcyhkb21FbGVtZW50LCBsYXN0UmF3UHJvcHMpOwogICAgICAgIG5leHRQcm9wcyA9IGdldEhvc3RQcm9wcyhkb21FbGVtZW50LCBuZXh0UmF3UHJvcHMpOwogICAgICAgIHVwZGF0ZVBheWxvYWQgPSBbXTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ3NlbGVjdCc6CiAgICAgICAgbGFzdFByb3BzID0gZ2V0SG9zdFByb3BzJDEoZG9tRWxlbWVudCwgbGFzdFJhd1Byb3BzKTsKICAgICAgICBuZXh0UHJvcHMgPSBnZXRIb3N0UHJvcHMkMShkb21FbGVtZW50LCBuZXh0UmF3UHJvcHMpOwogICAgICAgIHVwZGF0ZVBheWxvYWQgPSBbXTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ3RleHRhcmVhJzoKICAgICAgICBsYXN0UHJvcHMgPSBnZXRIb3N0UHJvcHMkMihkb21FbGVtZW50LCBsYXN0UmF3UHJvcHMpOwogICAgICAgIG5leHRQcm9wcyA9IGdldEhvc3RQcm9wcyQyKGRvbUVsZW1lbnQsIG5leHRSYXdQcm9wcyk7CiAgICAgICAgdXBkYXRlUGF5bG9hZCA9IFtdOwogICAgICAgIGJyZWFrOwoKICAgICAgZGVmYXVsdDoKICAgICAgICBsYXN0UHJvcHMgPSBsYXN0UmF3UHJvcHM7CiAgICAgICAgbmV4dFByb3BzID0gbmV4dFJhd1Byb3BzOwoKICAgICAgICBpZiAodHlwZW9mIGxhc3RQcm9wcy5vbkNsaWNrICE9PSAnZnVuY3Rpb24nICYmIHR5cGVvZiBuZXh0UHJvcHMub25DbGljayA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgLy8gVE9ETzogVGhpcyBjYXN0IG1heSBub3QgYmUgc291bmQgZm9yIFNWRywgTWF0aE1MIG9yIGN1c3RvbSBlbGVtZW50cy4KICAgICAgICAgIHRyYXBDbGlja09uTm9uSW50ZXJhY3RpdmVFbGVtZW50KGRvbUVsZW1lbnQpOwogICAgICAgIH0KCiAgICAgICAgYnJlYWs7CiAgICB9CgogICAgYXNzZXJ0VmFsaWRQcm9wcyh0YWcsIG5leHRQcm9wcyk7CiAgICB2YXIgcHJvcEtleTsKICAgIHZhciBzdHlsZU5hbWU7CiAgICB2YXIgc3R5bGVVcGRhdGVzID0gbnVsbDsKCiAgICBmb3IgKHByb3BLZXkgaW4gbGFzdFByb3BzKSB7CiAgICAgIGlmIChuZXh0UHJvcHMuaGFzT3duUHJvcGVydHkocHJvcEtleSkgfHwgIWxhc3RQcm9wcy5oYXNPd25Qcm9wZXJ0eShwcm9wS2V5KSB8fCBsYXN0UHJvcHNbcHJvcEtleV0gPT0gbnVsbCkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBpZiAocHJvcEtleSA9PT0gU1RZTEUpIHsKICAgICAgICB2YXIgbGFzdFN0eWxlID0gbGFzdFByb3BzW3Byb3BLZXldOwoKICAgICAgICBmb3IgKHN0eWxlTmFtZSBpbiBsYXN0U3R5bGUpIHsKICAgICAgICAgIGlmIChsYXN0U3R5bGUuaGFzT3duUHJvcGVydHkoc3R5bGVOYW1lKSkgewogICAgICAgICAgICBpZiAoIXN0eWxlVXBkYXRlcykgewogICAgICAgICAgICAgIHN0eWxlVXBkYXRlcyA9IHt9OwogICAgICAgICAgICB9CgogICAgICAgICAgICBzdHlsZVVwZGF0ZXNbc3R5bGVOYW1lXSA9ICcnOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChwcm9wS2V5ID09PSBEQU5HRVJPVVNMWV9TRVRfSU5ORVJfSFRNTCB8fCBwcm9wS2V5ID09PSBDSElMRFJFTikgOyBlbHNlIGlmIChwcm9wS2V5ID09PSBTVVBQUkVTU19DT05URU5UX0VESVRBQkxFX1dBUk5JTkcgfHwgcHJvcEtleSA9PT0gU1VQUFJFU1NfSFlEUkFUSU9OX1dBUk5JTkcpIDsgZWxzZSBpZiAocHJvcEtleSA9PT0gQVVUT0ZPQ1VTKSA7IGVsc2UgaWYgKHJlZ2lzdHJhdGlvbk5hbWVEZXBlbmRlbmNpZXMuaGFzT3duUHJvcGVydHkocHJvcEtleSkpIHsKICAgICAgICAvLyBUaGlzIGlzIGEgc3BlY2lhbCBjYXNlLiBJZiBhbnkgbGlzdGVuZXIgdXBkYXRlcyB3ZSBuZWVkIHRvIGVuc3VyZQogICAgICAgIC8vIHRoYXQgdGhlICJjdXJyZW50IiBmaWJlciBwb2ludGVyIGdldHMgdXBkYXRlZCBzbyB3ZSBuZWVkIGEgY29tbWl0CiAgICAgICAgLy8gdG8gdXBkYXRlIHRoaXMgZWxlbWVudC4KICAgICAgICBpZiAoIXVwZGF0ZVBheWxvYWQpIHsKICAgICAgICAgIHVwZGF0ZVBheWxvYWQgPSBbXTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gRm9yIGFsbCBvdGhlciBkZWxldGVkIHByb3BlcnRpZXMgd2UgYWRkIGl0IHRvIHRoZSBxdWV1ZS4gV2UgdXNlCiAgICAgICAgLy8gdGhlIGFsbG93ZWQgcHJvcGVydHkgbGlzdCBpbiB0aGUgY29tbWl0IHBoYXNlIGluc3RlYWQuCiAgICAgICAgKHVwZGF0ZVBheWxvYWQgPSB1cGRhdGVQYXlsb2FkIHx8IFtdKS5wdXNoKHByb3BLZXksIG51bGwpOwogICAgICB9CiAgICB9CgogICAgZm9yIChwcm9wS2V5IGluIG5leHRQcm9wcykgewogICAgICB2YXIgbmV4dFByb3AgPSBuZXh0UHJvcHNbcHJvcEtleV07CiAgICAgIHZhciBsYXN0UHJvcCA9IGxhc3RQcm9wcyAhPSBudWxsID8gbGFzdFByb3BzW3Byb3BLZXldIDogdW5kZWZpbmVkOwoKICAgICAgaWYgKCFuZXh0UHJvcHMuaGFzT3duUHJvcGVydHkocHJvcEtleSkgfHwgbmV4dFByb3AgPT09IGxhc3RQcm9wIHx8IG5leHRQcm9wID09IG51bGwgJiYgbGFzdFByb3AgPT0gbnVsbCkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBpZiAocHJvcEtleSA9PT0gU1RZTEUpIHsKICAgICAgICB7CiAgICAgICAgICBpZiAobmV4dFByb3ApIHsKICAgICAgICAgICAgLy8gRnJlZXplIHRoZSBuZXh0IHN0eWxlIG9iamVjdCBzbyB0aGF0IHdlIGNhbiBhc3N1bWUgaXQgd29uJ3QgYmUKICAgICAgICAgICAgLy8gbXV0YXRlZC4gV2UgaGF2ZSBhbHJlYWR5IHdhcm5lZCBmb3IgdGhpcyBpbiB0aGUgcGFzdC4KICAgICAgICAgICAgT2JqZWN0LmZyZWV6ZShuZXh0UHJvcCk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAobGFzdFByb3ApIHsKICAgICAgICAgIC8vIFVuc2V0IHN0eWxlcyBvbiBgbGFzdFByb3BgIGJ1dCBub3Qgb24gYG5leHRQcm9wYC4KICAgICAgICAgIGZvciAoc3R5bGVOYW1lIGluIGxhc3RQcm9wKSB7CiAgICAgICAgICAgIGlmIChsYXN0UHJvcC5oYXNPd25Qcm9wZXJ0eShzdHlsZU5hbWUpICYmICghbmV4dFByb3AgfHwgIW5leHRQcm9wLmhhc093blByb3BlcnR5KHN0eWxlTmFtZSkpKSB7CiAgICAgICAgICAgICAgaWYgKCFzdHlsZVVwZGF0ZXMpIHsKICAgICAgICAgICAgICAgIHN0eWxlVXBkYXRlcyA9IHt9OwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgc3R5bGVVcGRhdGVzW3N0eWxlTmFtZV0gPSAnJzsKICAgICAgICAgICAgfQogICAgICAgICAgfSAvLyBVcGRhdGUgc3R5bGVzIHRoYXQgY2hhbmdlZCBzaW5jZSBgbGFzdFByb3BgLgoKCiAgICAgICAgICBmb3IgKHN0eWxlTmFtZSBpbiBuZXh0UHJvcCkgewogICAgICAgICAgICBpZiAobmV4dFByb3AuaGFzT3duUHJvcGVydHkoc3R5bGVOYW1lKSAmJiBsYXN0UHJvcFtzdHlsZU5hbWVdICE9PSBuZXh0UHJvcFtzdHlsZU5hbWVdKSB7CiAgICAgICAgICAgICAgaWYgKCFzdHlsZVVwZGF0ZXMpIHsKICAgICAgICAgICAgICAgIHN0eWxlVXBkYXRlcyA9IHt9OwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgc3R5bGVVcGRhdGVzW3N0eWxlTmFtZV0gPSBuZXh0UHJvcFtzdHlsZU5hbWVdOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vIFJlbGllcyBvbiBgdXBkYXRlU3R5bGVzQnlJRGAgbm90IG11dGF0aW5nIGBzdHlsZVVwZGF0ZXNgLgogICAgICAgICAgaWYgKCFzdHlsZVVwZGF0ZXMpIHsKICAgICAgICAgICAgaWYgKCF1cGRhdGVQYXlsb2FkKSB7CiAgICAgICAgICAgICAgdXBkYXRlUGF5bG9hZCA9IFtdOwogICAgICAgICAgICB9CgogICAgICAgICAgICB1cGRhdGVQYXlsb2FkLnB1c2gocHJvcEtleSwgc3R5bGVVcGRhdGVzKTsKICAgICAgICAgIH0KCiAgICAgICAgICBzdHlsZVVwZGF0ZXMgPSBuZXh0UHJvcDsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAocHJvcEtleSA9PT0gREFOR0VST1VTTFlfU0VUX0lOTkVSX0hUTUwpIHsKICAgICAgICB2YXIgbmV4dEh0bWwgPSBuZXh0UHJvcCA/IG5leHRQcm9wW0hUTUwkMV0gOiB1bmRlZmluZWQ7CiAgICAgICAgdmFyIGxhc3RIdG1sID0gbGFzdFByb3AgPyBsYXN0UHJvcFtIVE1MJDFdIDogdW5kZWZpbmVkOwoKICAgICAgICBpZiAobmV4dEh0bWwgIT0gbnVsbCkgewogICAgICAgICAgaWYgKGxhc3RIdG1sICE9PSBuZXh0SHRtbCkgewogICAgICAgICAgICAodXBkYXRlUGF5bG9hZCA9IHVwZGF0ZVBheWxvYWQgfHwgW10pLnB1c2gocHJvcEtleSwgbmV4dEh0bWwpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChwcm9wS2V5ID09PSBDSElMRFJFTikgewogICAgICAgIGlmICh0eXBlb2YgbmV4dFByb3AgPT09ICdzdHJpbmcnIHx8IHR5cGVvZiBuZXh0UHJvcCA9PT0gJ251bWJlcicpIHsKICAgICAgICAgICh1cGRhdGVQYXlsb2FkID0gdXBkYXRlUGF5bG9hZCB8fCBbXSkucHVzaChwcm9wS2V5LCAnJyArIG5leHRQcm9wKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAocHJvcEtleSA9PT0gU1VQUFJFU1NfQ09OVEVOVF9FRElUQUJMRV9XQVJOSU5HIHx8IHByb3BLZXkgPT09IFNVUFBSRVNTX0hZRFJBVElPTl9XQVJOSU5HKSA7IGVsc2UgaWYgKHJlZ2lzdHJhdGlvbk5hbWVEZXBlbmRlbmNpZXMuaGFzT3duUHJvcGVydHkocHJvcEtleSkpIHsKICAgICAgICBpZiAobmV4dFByb3AgIT0gbnVsbCkgewogICAgICAgICAgLy8gV2UgZWFnZXJseSBsaXN0ZW4gdG8gdGhpcyBldmVuIHRob3VnaCB3ZSBoYXZlbid0IGNvbW1pdHRlZCB5ZXQuCiAgICAgICAgICBpZiAoIHR5cGVvZiBuZXh0UHJvcCAhPT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgICB3YXJuRm9ySW52YWxpZEV2ZW50TGlzdGVuZXIocHJvcEtleSwgbmV4dFByb3ApOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChwcm9wS2V5ID09PSAnb25TY3JvbGwnKSB7CiAgICAgICAgICAgIGxpc3RlblRvTm9uRGVsZWdhdGVkRXZlbnQoJ3Njcm9sbCcsIGRvbUVsZW1lbnQpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKCF1cGRhdGVQYXlsb2FkICYmIGxhc3RQcm9wICE9PSBuZXh0UHJvcCkgewogICAgICAgICAgLy8gVGhpcyBpcyBhIHNwZWNpYWwgY2FzZS4gSWYgYW55IGxpc3RlbmVyIHVwZGF0ZXMgd2UgbmVlZCB0byBlbnN1cmUKICAgICAgICAgIC8vIHRoYXQgdGhlICJjdXJyZW50IiBwcm9wcyBwb2ludGVyIGdldHMgdXBkYXRlZCBzbyB3ZSBuZWVkIGEgY29tbWl0CiAgICAgICAgICAvLyB0byB1cGRhdGUgdGhpcyBlbGVtZW50LgogICAgICAgICAgdXBkYXRlUGF5bG9hZCA9IFtdOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBGb3IgYW55IG90aGVyIHByb3BlcnR5IHdlIGFsd2F5cyBhZGQgaXQgdG8gdGhlIHF1ZXVlIGFuZCB0aGVuIHdlCiAgICAgICAgLy8gZmlsdGVyIGl0IG91dCB1c2luZyB0aGUgYWxsb3dlZCBwcm9wZXJ0eSBsaXN0IGR1cmluZyB0aGUgY29tbWl0LgogICAgICAgICh1cGRhdGVQYXlsb2FkID0gdXBkYXRlUGF5bG9hZCB8fCBbXSkucHVzaChwcm9wS2V5LCBuZXh0UHJvcCk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoc3R5bGVVcGRhdGVzKSB7CiAgICAgIHsKICAgICAgICB2YWxpZGF0ZVNob3J0aGFuZFByb3BlcnR5Q29sbGlzaW9uSW5EZXYoc3R5bGVVcGRhdGVzLCBuZXh0UHJvcHNbU1RZTEVdKTsKICAgICAgfQoKICAgICAgKHVwZGF0ZVBheWxvYWQgPSB1cGRhdGVQYXlsb2FkIHx8IFtdKS5wdXNoKFNUWUxFLCBzdHlsZVVwZGF0ZXMpOwogICAgfQoKICAgIHJldHVybiB1cGRhdGVQYXlsb2FkOwogIH0gLy8gQXBwbHkgdGhlIGRpZmYuCgogIGZ1bmN0aW9uIHVwZGF0ZVByb3BlcnRpZXMoZG9tRWxlbWVudCwgdXBkYXRlUGF5bG9hZCwgdGFnLCBsYXN0UmF3UHJvcHMsIG5leHRSYXdQcm9wcykgewogICAgLy8gVXBkYXRlIGNoZWNrZWQgKmJlZm9yZSogbmFtZS4KICAgIC8vIEluIHRoZSBtaWRkbGUgb2YgYW4gdXBkYXRlLCBpdCBpcyBwb3NzaWJsZSB0byBoYXZlIG11bHRpcGxlIGNoZWNrZWQuCiAgICAvLyBXaGVuIGEgY2hlY2tlZCByYWRpbyB0cmllcyB0byBjaGFuZ2UgbmFtZSwgYnJvd3NlciBtYWtlcyBhbm90aGVyIHJhZGlvJ3MgY2hlY2tlZCBmYWxzZS4KICAgIGlmICh0YWcgPT09ICdpbnB1dCcgJiYgbmV4dFJhd1Byb3BzLnR5cGUgPT09ICdyYWRpbycgJiYgbmV4dFJhd1Byb3BzLm5hbWUgIT0gbnVsbCkgewogICAgICB1cGRhdGVDaGVja2VkKGRvbUVsZW1lbnQsIG5leHRSYXdQcm9wcyk7CiAgICB9CgogICAgdmFyIHdhc0N1c3RvbUNvbXBvbmVudFRhZyA9IGlzQ3VzdG9tQ29tcG9uZW50KHRhZywgbGFzdFJhd1Byb3BzKTsKICAgIHZhciBpc0N1c3RvbUNvbXBvbmVudFRhZyA9IGlzQ3VzdG9tQ29tcG9uZW50KHRhZywgbmV4dFJhd1Byb3BzKTsgLy8gQXBwbHkgdGhlIGRpZmYuCgogICAgdXBkYXRlRE9NUHJvcGVydGllcyhkb21FbGVtZW50LCB1cGRhdGVQYXlsb2FkLCB3YXNDdXN0b21Db21wb25lbnRUYWcsIGlzQ3VzdG9tQ29tcG9uZW50VGFnKTsgLy8gVE9ETzogRW5zdXJlIHRoYXQgYW4gdXBkYXRlIGdldHMgc2NoZWR1bGVkIGlmIGFueSBvZiB0aGUgc3BlY2lhbCBwcm9wcwogICAgLy8gY2hhbmdlZC4KCiAgICBzd2l0Y2ggKHRhZykgewogICAgICBjYXNlICdpbnB1dCc6CiAgICAgICAgLy8gVXBkYXRlIHRoZSB3cmFwcGVyIGFyb3VuZCBpbnB1dHMgKmFmdGVyKiB1cGRhdGluZyBwcm9wcy4gVGhpcyBoYXMgdG8KICAgICAgICAvLyBoYXBwZW4gYWZ0ZXIgYHVwZGF0ZURPTVByb3BlcnRpZXNgLiBPdGhlcndpc2UgSFRNTDUgaW5wdXQgdmFsaWRhdGlvbnMKICAgICAgICAvLyByYWlzZSB3YXJuaW5ncyBhbmQgcHJldmVudCB0aGUgbmV3IHZhbHVlIGZyb20gYmVpbmcgYXNzaWduZWQuCiAgICAgICAgdXBkYXRlV3JhcHBlcihkb21FbGVtZW50LCBuZXh0UmF3UHJvcHMpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAndGV4dGFyZWEnOgogICAgICAgIHVwZGF0ZVdyYXBwZXIkMShkb21FbGVtZW50LCBuZXh0UmF3UHJvcHMpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnc2VsZWN0JzoKICAgICAgICAvLyA8c2VsZWN0PiB2YWx1ZSB1cGRhdGUgbmVlZHMgdG8gb2NjdXIgYWZ0ZXIgPG9wdGlvbj4gY2hpbGRyZW4KICAgICAgICAvLyByZWNvbmNpbGlhdGlvbgogICAgICAgIHBvc3RVcGRhdGVXcmFwcGVyKGRvbUVsZW1lbnQsIG5leHRSYXdQcm9wcyk7CiAgICAgICAgYnJlYWs7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBnZXRQb3NzaWJsZVN0YW5kYXJkTmFtZShwcm9wTmFtZSkgewogICAgewogICAgICB2YXIgbG93ZXJDYXNlZE5hbWUgPSBwcm9wTmFtZS50b0xvd2VyQ2FzZSgpOwoKICAgICAgaWYgKCFwb3NzaWJsZVN0YW5kYXJkTmFtZXMuaGFzT3duUHJvcGVydHkobG93ZXJDYXNlZE5hbWUpKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIHJldHVybiBwb3NzaWJsZVN0YW5kYXJkTmFtZXNbbG93ZXJDYXNlZE5hbWVdIHx8IG51bGw7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBkaWZmSHlkcmF0ZWRQcm9wZXJ0aWVzKGRvbUVsZW1lbnQsIHRhZywgcmF3UHJvcHMsIHBhcmVudE5hbWVzcGFjZSwgcm9vdENvbnRhaW5lckVsZW1lbnQsIGlzQ29uY3VycmVudE1vZGUsIHNob3VsZFdhcm5EZXYpIHsKICAgIHZhciBpc0N1c3RvbUNvbXBvbmVudFRhZzsKICAgIHZhciBleHRyYUF0dHJpYnV0ZU5hbWVzOwoKICAgIHsKICAgICAgaXNDdXN0b21Db21wb25lbnRUYWcgPSBpc0N1c3RvbUNvbXBvbmVudCh0YWcsIHJhd1Byb3BzKTsKICAgICAgdmFsaWRhdGVQcm9wZXJ0aWVzSW5EZXZlbG9wbWVudCh0YWcsIHJhd1Byb3BzKTsKICAgIH0gLy8gVE9ETzogTWFrZSBzdXJlIHRoYXQgd2UgY2hlY2sgaXNNb3VudGVkIGJlZm9yZSBmaXJpbmcgYW55IG9mIHRoZXNlIGV2ZW50cy4KCgogICAgc3dpdGNoICh0YWcpIHsKICAgICAgY2FzZSAnZGlhbG9nJzoKICAgICAgICBsaXN0ZW5Ub05vbkRlbGVnYXRlZEV2ZW50KCdjYW5jZWwnLCBkb21FbGVtZW50KTsKICAgICAgICBsaXN0ZW5Ub05vbkRlbGVnYXRlZEV2ZW50KCdjbG9zZScsIGRvbUVsZW1lbnQpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnaWZyYW1lJzoKICAgICAgY2FzZSAnb2JqZWN0JzoKICAgICAgY2FzZSAnZW1iZWQnOgogICAgICAgIC8vIFdlIGxpc3RlbiB0byB0aGlzIGV2ZW50IGluIGNhc2UgdG8gZW5zdXJlIGVtdWxhdGVkIGJ1YmJsZQogICAgICAgIC8vIGxpc3RlbmVycyBzdGlsbCBmaXJlIGZvciB0aGUgbG9hZCBldmVudC4KICAgICAgICBsaXN0ZW5Ub05vbkRlbGVnYXRlZEV2ZW50KCdsb2FkJywgZG9tRWxlbWVudCk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICd2aWRlbyc6CiAgICAgIGNhc2UgJ2F1ZGlvJzoKICAgICAgICAvLyBXZSBsaXN0ZW4gdG8gdGhlc2UgZXZlbnRzIGluIGNhc2UgdG8gZW5zdXJlIGVtdWxhdGVkIGJ1YmJsZQogICAgICAgIC8vIGxpc3RlbmVycyBzdGlsbCBmaXJlIGZvciBhbGwgdGhlIG1lZGlhIGV2ZW50cy4KICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1lZGlhRXZlbnRUeXBlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgbGlzdGVuVG9Ob25EZWxlZ2F0ZWRFdmVudChtZWRpYUV2ZW50VHlwZXNbaV0sIGRvbUVsZW1lbnQpOwogICAgICAgIH0KCiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICdzb3VyY2UnOgogICAgICAgIC8vIFdlIGxpc3RlbiB0byB0aGlzIGV2ZW50IGluIGNhc2UgdG8gZW5zdXJlIGVtdWxhdGVkIGJ1YmJsZQogICAgICAgIC8vIGxpc3RlbmVycyBzdGlsbCBmaXJlIGZvciB0aGUgZXJyb3IgZXZlbnQuCiAgICAgICAgbGlzdGVuVG9Ob25EZWxlZ2F0ZWRFdmVudCgnZXJyb3InLCBkb21FbGVtZW50KTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ2ltZyc6CiAgICAgIGNhc2UgJ2ltYWdlJzoKICAgICAgY2FzZSAnbGluayc6CiAgICAgICAgLy8gV2UgbGlzdGVuIHRvIHRoZXNlIGV2ZW50cyBpbiBjYXNlIHRvIGVuc3VyZSBlbXVsYXRlZCBidWJibGUKICAgICAgICAvLyBsaXN0ZW5lcnMgc3RpbGwgZmlyZSBmb3IgZXJyb3IgYW5kIGxvYWQgZXZlbnRzLgogICAgICAgIGxpc3RlblRvTm9uRGVsZWdhdGVkRXZlbnQoJ2Vycm9yJywgZG9tRWxlbWVudCk7CiAgICAgICAgbGlzdGVuVG9Ob25EZWxlZ2F0ZWRFdmVudCgnbG9hZCcsIGRvbUVsZW1lbnQpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnZGV0YWlscyc6CiAgICAgICAgLy8gV2UgbGlzdGVuIHRvIHRoaXMgZXZlbnQgaW4gY2FzZSB0byBlbnN1cmUgZW11bGF0ZWQgYnViYmxlCiAgICAgICAgLy8gbGlzdGVuZXJzIHN0aWxsIGZpcmUgZm9yIHRoZSB0b2dnbGUgZXZlbnQuCiAgICAgICAgbGlzdGVuVG9Ob25EZWxlZ2F0ZWRFdmVudCgndG9nZ2xlJywgZG9tRWxlbWVudCk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICdpbnB1dCc6CiAgICAgICAgaW5pdFdyYXBwZXJTdGF0ZShkb21FbGVtZW50LCByYXdQcm9wcyk7IC8vIFdlIGxpc3RlbiB0byB0aGlzIGV2ZW50IGluIGNhc2UgdG8gZW5zdXJlIGVtdWxhdGVkIGJ1YmJsZQogICAgICAgIC8vIGxpc3RlbmVycyBzdGlsbCBmaXJlIGZvciB0aGUgaW52YWxpZCBldmVudC4KCiAgICAgICAgbGlzdGVuVG9Ob25EZWxlZ2F0ZWRFdmVudCgnaW52YWxpZCcsIGRvbUVsZW1lbnQpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnb3B0aW9uJzoKICAgICAgICB2YWxpZGF0ZVByb3BzKGRvbUVsZW1lbnQsIHJhd1Byb3BzKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ3NlbGVjdCc6CiAgICAgICAgaW5pdFdyYXBwZXJTdGF0ZSQxKGRvbUVsZW1lbnQsIHJhd1Byb3BzKTsgLy8gV2UgbGlzdGVuIHRvIHRoaXMgZXZlbnQgaW4gY2FzZSB0byBlbnN1cmUgZW11bGF0ZWQgYnViYmxlCiAgICAgICAgLy8gbGlzdGVuZXJzIHN0aWxsIGZpcmUgZm9yIHRoZSBpbnZhbGlkIGV2ZW50LgoKICAgICAgICBsaXN0ZW5Ub05vbkRlbGVnYXRlZEV2ZW50KCdpbnZhbGlkJywgZG9tRWxlbWVudCk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICd0ZXh0YXJlYSc6CiAgICAgICAgaW5pdFdyYXBwZXJTdGF0ZSQyKGRvbUVsZW1lbnQsIHJhd1Byb3BzKTsgLy8gV2UgbGlzdGVuIHRvIHRoaXMgZXZlbnQgaW4gY2FzZSB0byBlbnN1cmUgZW11bGF0ZWQgYnViYmxlCiAgICAgICAgLy8gbGlzdGVuZXJzIHN0aWxsIGZpcmUgZm9yIHRoZSBpbnZhbGlkIGV2ZW50LgoKICAgICAgICBsaXN0ZW5Ub05vbkRlbGVnYXRlZEV2ZW50KCdpbnZhbGlkJywgZG9tRWxlbWVudCk7CiAgICAgICAgYnJlYWs7CiAgICB9CgogICAgYXNzZXJ0VmFsaWRQcm9wcyh0YWcsIHJhd1Byb3BzKTsKCiAgICB7CiAgICAgIGV4dHJhQXR0cmlidXRlTmFtZXMgPSBuZXcgU2V0KCk7CiAgICAgIHZhciBhdHRyaWJ1dGVzID0gZG9tRWxlbWVudC5hdHRyaWJ1dGVzOwoKICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGF0dHJpYnV0ZXMubGVuZ3RoOyBfaSsrKSB7CiAgICAgICAgdmFyIG5hbWUgPSBhdHRyaWJ1dGVzW19pXS5uYW1lLnRvTG93ZXJDYXNlKCk7CgogICAgICAgIHN3aXRjaCAobmFtZSkgewogICAgICAgICAgLy8gQ29udHJvbGxlZCBhdHRyaWJ1dGVzIGFyZSBub3QgdmFsaWRhdGVkCiAgICAgICAgICAvLyBUT0RPOiBPbmx5IGlnbm9yZSB0aGVtIG9uIGNvbnRyb2xsZWQgdGFncy4KICAgICAgICAgIGNhc2UgJ3ZhbHVlJzoKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAnY2hlY2tlZCc6CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgJ3NlbGVjdGVkJzoKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgLy8gSW50ZW50aW9uYWxseSB1c2UgdGhlIG9yaWdpbmFsIG5hbWUuCiAgICAgICAgICAgIC8vIFNlZSBkaXNjdXNzaW9uIGluIGh0dHBzOi8vZ2l0aHViLmNvbS9mYWNlYm9vay9yZWFjdC9wdWxsLzEwNjc2LgogICAgICAgICAgICBleHRyYUF0dHJpYnV0ZU5hbWVzLmFkZChhdHRyaWJ1dGVzW19pXS5uYW1lKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICB2YXIgdXBkYXRlUGF5bG9hZCA9IG51bGw7CgogICAgZm9yICh2YXIgcHJvcEtleSBpbiByYXdQcm9wcykgewogICAgICBpZiAoIXJhd1Byb3BzLmhhc093blByb3BlcnR5KHByb3BLZXkpKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIHZhciBuZXh0UHJvcCA9IHJhd1Byb3BzW3Byb3BLZXldOwoKICAgICAgaWYgKHByb3BLZXkgPT09IENISUxEUkVOKSB7CiAgICAgICAgLy8gRm9yIHRleHQgY29udGVudCBjaGlsZHJlbiB3ZSBjb21wYXJlIGFnYWluc3QgdGV4dENvbnRlbnQuIFRoaXMKICAgICAgICAvLyBtaWdodCBtYXRjaCBhZGRpdGlvbmFsIEhUTUwgdGhhdCBpcyBoaWRkZW4gd2hlbiB3ZSByZWFkIGl0IHVzaW5nCiAgICAgICAgLy8gdGV4dENvbnRlbnQuIEUuZy4gImZvbyIgd2lsbCBtYXRjaCAiZjxzcGFuPm9vPC9zcGFuPiIgYnV0IHRoYXQgc3RpbGwKICAgICAgICAvLyBzYXRpc2ZpZXMgb3VyIHJlcXVpcmVtZW50LiBPdXIgcmVxdWlyZW1lbnQgaXMgbm90IHRvIHByb2R1Y2UgcGVyZmVjdAogICAgICAgIC8vIEhUTUwgYW5kIGF0dHJpYnV0ZXMuIElkZWFsbHkgd2Ugc2hvdWxkIHByZXNlcnZlIHN0cnVjdHVyZSBidXQgaXQncwogICAgICAgIC8vIG9rIG5vdCB0byBpZiB0aGUgdmlzaWJsZSBjb250ZW50IGlzIHN0aWxsIGVub3VnaCB0byBpbmRpY2F0ZSB3aGF0CiAgICAgICAgLy8gZXZlbiBsaXN0ZW5lcnMgdGhlc2Ugbm9kZXMgbWlnaHQgYmUgd2lyZWQgdXAgdG8uCiAgICAgICAgLy8gVE9ETzogV2FybiBpZiB0aGVyZSBpcyBtb3JlIHRoYW4gYSBzaW5nbGUgdGV4dE5vZGUgYXMgYSBjaGlsZC4KICAgICAgICAvLyBUT0RPOiBTaG91bGQgd2UgdXNlIGRvbUVsZW1lbnQuZmlyc3RDaGlsZC5ub2RlVmFsdWUgdG8gY29tcGFyZT8KICAgICAgICBpZiAodHlwZW9mIG5leHRQcm9wID09PSAnc3RyaW5nJykgewogICAgICAgICAgaWYgKGRvbUVsZW1lbnQudGV4dENvbnRlbnQgIT09IG5leHRQcm9wKSB7CiAgICAgICAgICAgIGlmIChyYXdQcm9wc1tTVVBQUkVTU19IWURSQVRJT05fV0FSTklOR10gIT09IHRydWUpIHsKICAgICAgICAgICAgICBjaGVja0ZvclVubWF0Y2hlZFRleHQoZG9tRWxlbWVudC50ZXh0Q29udGVudCwgbmV4dFByb3AsIGlzQ29uY3VycmVudE1vZGUsIHNob3VsZFdhcm5EZXYpOwogICAgICAgICAgICB9CgogICAgICAgICAgICB1cGRhdGVQYXlsb2FkID0gW0NISUxEUkVOLCBuZXh0UHJvcF07CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgbmV4dFByb3AgPT09ICdudW1iZXInKSB7CiAgICAgICAgICBpZiAoZG9tRWxlbWVudC50ZXh0Q29udGVudCAhPT0gJycgKyBuZXh0UHJvcCkgewogICAgICAgICAgICBpZiAocmF3UHJvcHNbU1VQUFJFU1NfSFlEUkFUSU9OX1dBUk5JTkddICE9PSB0cnVlKSB7CiAgICAgICAgICAgICAgY2hlY2tGb3JVbm1hdGNoZWRUZXh0KGRvbUVsZW1lbnQudGV4dENvbnRlbnQsIG5leHRQcm9wLCBpc0NvbmN1cnJlbnRNb2RlLCBzaG91bGRXYXJuRGV2KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdXBkYXRlUGF5bG9hZCA9IFtDSElMRFJFTiwgJycgKyBuZXh0UHJvcF07CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHJlZ2lzdHJhdGlvbk5hbWVEZXBlbmRlbmNpZXMuaGFzT3duUHJvcGVydHkocHJvcEtleSkpIHsKICAgICAgICBpZiAobmV4dFByb3AgIT0gbnVsbCkgewogICAgICAgICAgaWYgKCB0eXBlb2YgbmV4dFByb3AgIT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgICAgd2FybkZvckludmFsaWRFdmVudExpc3RlbmVyKHByb3BLZXksIG5leHRQcm9wKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAocHJvcEtleSA9PT0gJ29uU2Nyb2xsJykgewogICAgICAgICAgICBsaXN0ZW5Ub05vbkRlbGVnYXRlZEV2ZW50KCdzY3JvbGwnLCBkb21FbGVtZW50KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoc2hvdWxkV2FybkRldiAmJiB0cnVlICYmIC8vIENvbnZpbmNlIEZsb3cgd2UndmUgY2FsY3VsYXRlZCBpdCAoaXQncyBERVYtb25seSBpbiB0aGlzIG1ldGhvZC4pCiAgICAgIHR5cGVvZiBpc0N1c3RvbUNvbXBvbmVudFRhZyA9PT0gJ2Jvb2xlYW4nKSB7CiAgICAgICAgLy8gVmFsaWRhdGUgdGhhdCB0aGUgcHJvcGVydGllcyBjb3JyZXNwb25kIHRvIHRoZWlyIGV4cGVjdGVkIHZhbHVlcy4KICAgICAgICB2YXIgc2VydmVyVmFsdWUgPSB2b2lkIDA7CiAgICAgICAgdmFyIHByb3BlcnR5SW5mbyA9IGlzQ3VzdG9tQ29tcG9uZW50VGFnICYmIGVuYWJsZUN1c3RvbUVsZW1lbnRQcm9wZXJ0eVN1cHBvcnQgPyBudWxsIDogZ2V0UHJvcGVydHlJbmZvKHByb3BLZXkpOwoKICAgICAgICBpZiAocmF3UHJvcHNbU1VQUFJFU1NfSFlEUkFUSU9OX1dBUk5JTkddID09PSB0cnVlKSA7IGVsc2UgaWYgKHByb3BLZXkgPT09IFNVUFBSRVNTX0NPTlRFTlRfRURJVEFCTEVfV0FSTklORyB8fCBwcm9wS2V5ID09PSBTVVBQUkVTU19IWURSQVRJT05fV0FSTklORyB8fCAvLyBDb250cm9sbGVkIGF0dHJpYnV0ZXMgYXJlIG5vdCB2YWxpZGF0ZWQKICAgICAgICAvLyBUT0RPOiBPbmx5IGlnbm9yZSB0aGVtIG9uIGNvbnRyb2xsZWQgdGFncy4KICAgICAgICBwcm9wS2V5ID09PSAndmFsdWUnIHx8IHByb3BLZXkgPT09ICdjaGVja2VkJyB8fCBwcm9wS2V5ID09PSAnc2VsZWN0ZWQnKSA7IGVsc2UgaWYgKHByb3BLZXkgPT09IERBTkdFUk9VU0xZX1NFVF9JTk5FUl9IVE1MKSB7CiAgICAgICAgICB2YXIgc2VydmVySFRNTCA9IGRvbUVsZW1lbnQuaW5uZXJIVE1MOwogICAgICAgICAgdmFyIG5leHRIdG1sID0gbmV4dFByb3AgPyBuZXh0UHJvcFtIVE1MJDFdIDogdW5kZWZpbmVkOwoKICAgICAgICAgIGlmIChuZXh0SHRtbCAhPSBudWxsKSB7CiAgICAgICAgICAgIHZhciBleHBlY3RlZEhUTUwgPSBub3JtYWxpemVIVE1MKGRvbUVsZW1lbnQsIG5leHRIdG1sKTsKCiAgICAgICAgICAgIGlmIChleHBlY3RlZEhUTUwgIT09IHNlcnZlckhUTUwpIHsKICAgICAgICAgICAgICB3YXJuRm9yUHJvcERpZmZlcmVuY2UocHJvcEtleSwgc2VydmVySFRNTCwgZXhwZWN0ZWRIVE1MKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAocHJvcEtleSA9PT0gU1RZTEUpIHsKICAgICAgICAgIC8vICRGbG93Rml4TWUgLSBTaG91bGQgYmUgaW5mZXJyZWQgYXMgbm90IHVuZGVmaW5lZC4KICAgICAgICAgIGV4dHJhQXR0cmlidXRlTmFtZXMuZGVsZXRlKHByb3BLZXkpOwoKICAgICAgICAgIGlmIChjYW5EaWZmU3R5bGVGb3JIeWRyYXRpb25XYXJuaW5nKSB7CiAgICAgICAgICAgIHZhciBleHBlY3RlZFN0eWxlID0gY3JlYXRlRGFuZ2Vyb3VzU3RyaW5nRm9yU3R5bGVzKG5leHRQcm9wKTsKICAgICAgICAgICAgc2VydmVyVmFsdWUgPSBkb21FbGVtZW50LmdldEF0dHJpYnV0ZSgnc3R5bGUnKTsKCiAgICAgICAgICAgIGlmIChleHBlY3RlZFN0eWxlICE9PSBzZXJ2ZXJWYWx1ZSkgewogICAgICAgICAgICAgIHdhcm5Gb3JQcm9wRGlmZmVyZW5jZShwcm9wS2V5LCBzZXJ2ZXJWYWx1ZSwgZXhwZWN0ZWRTdHlsZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKGlzQ3VzdG9tQ29tcG9uZW50VGFnICYmICFlbmFibGVDdXN0b21FbGVtZW50UHJvcGVydHlTdXBwb3J0KSB7CiAgICAgICAgICAvLyAkRmxvd0ZpeE1lIC0gU2hvdWxkIGJlIGluZmVycmVkIGFzIG5vdCB1bmRlZmluZWQuCiAgICAgICAgICBleHRyYUF0dHJpYnV0ZU5hbWVzLmRlbGV0ZShwcm9wS2V5LnRvTG93ZXJDYXNlKCkpOwogICAgICAgICAgc2VydmVyVmFsdWUgPSBnZXRWYWx1ZUZvckF0dHJpYnV0ZShkb21FbGVtZW50LCBwcm9wS2V5LCBuZXh0UHJvcCk7CgogICAgICAgICAgaWYgKG5leHRQcm9wICE9PSBzZXJ2ZXJWYWx1ZSkgewogICAgICAgICAgICB3YXJuRm9yUHJvcERpZmZlcmVuY2UocHJvcEtleSwgc2VydmVyVmFsdWUsIG5leHRQcm9wKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKCFzaG91bGRJZ25vcmVBdHRyaWJ1dGUocHJvcEtleSwgcHJvcGVydHlJbmZvLCBpc0N1c3RvbUNvbXBvbmVudFRhZykgJiYgIXNob3VsZFJlbW92ZUF0dHJpYnV0ZShwcm9wS2V5LCBuZXh0UHJvcCwgcHJvcGVydHlJbmZvLCBpc0N1c3RvbUNvbXBvbmVudFRhZykpIHsKICAgICAgICAgIHZhciBpc01pc21hdGNoRHVlVG9CYWRDYXNpbmcgPSBmYWxzZTsKCiAgICAgICAgICBpZiAocHJvcGVydHlJbmZvICE9PSBudWxsKSB7CiAgICAgICAgICAgIC8vICRGbG93Rml4TWUgLSBTaG91bGQgYmUgaW5mZXJyZWQgYXMgbm90IHVuZGVmaW5lZC4KICAgICAgICAgICAgZXh0cmFBdHRyaWJ1dGVOYW1lcy5kZWxldGUocHJvcGVydHlJbmZvLmF0dHJpYnV0ZU5hbWUpOwogICAgICAgICAgICBzZXJ2ZXJWYWx1ZSA9IGdldFZhbHVlRm9yUHJvcGVydHkoZG9tRWxlbWVudCwgcHJvcEtleSwgbmV4dFByb3AsIHByb3BlcnR5SW5mbyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB2YXIgb3duTmFtZXNwYWNlID0gcGFyZW50TmFtZXNwYWNlOwoKICAgICAgICAgICAgaWYgKG93bk5hbWVzcGFjZSA9PT0gSFRNTF9OQU1FU1BBQ0UpIHsKICAgICAgICAgICAgICBvd25OYW1lc3BhY2UgPSBnZXRJbnRyaW5zaWNOYW1lc3BhY2UodGFnKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKG93bk5hbWVzcGFjZSA9PT0gSFRNTF9OQU1FU1BBQ0UpIHsKICAgICAgICAgICAgICAvLyAkRmxvd0ZpeE1lIC0gU2hvdWxkIGJlIGluZmVycmVkIGFzIG5vdCB1bmRlZmluZWQuCiAgICAgICAgICAgICAgZXh0cmFBdHRyaWJ1dGVOYW1lcy5kZWxldGUocHJvcEtleS50b0xvd2VyQ2FzZSgpKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB2YXIgc3RhbmRhcmROYW1lID0gZ2V0UG9zc2libGVTdGFuZGFyZE5hbWUocHJvcEtleSk7CgogICAgICAgICAgICAgIGlmIChzdGFuZGFyZE5hbWUgIT09IG51bGwgJiYgc3RhbmRhcmROYW1lICE9PSBwcm9wS2V5KSB7CiAgICAgICAgICAgICAgICAvLyBJZiBhbiBTVkcgcHJvcCBpcyBzdXBwbGllZCB3aXRoIGJhZCBjYXNpbmcsIGl0IHdpbGwKICAgICAgICAgICAgICAgIC8vIGJlIHN1Y2Nlc3NmdWxseSBwYXJzZWQgZnJvbSBIVE1MLCBidXQgd2lsbCBwcm9kdWNlIGEgbWlzbWF0Y2gKICAgICAgICAgICAgICAgIC8vIChhbmQgd291bGQgYmUgaW5jb3JyZWN0bHkgcmVuZGVyZWQgb24gdGhlIGNsaWVudCkuCiAgICAgICAgICAgICAgICAvLyBIb3dldmVyLCB3ZSBhbHJlYWR5IHdhcm4gYWJvdXQgYmFkIGNhc2luZyBlbHNld2hlcmUuCiAgICAgICAgICAgICAgICAvLyBTbyB3ZSdsbCBza2lwIHRoZSBtaXNsZWFkaW5nIGV4dHJhIG1pc21hdGNoIHdhcm5pbmcgaW4gdGhpcyBjYXNlLgogICAgICAgICAgICAgICAgaXNNaXNtYXRjaER1ZVRvQmFkQ2FzaW5nID0gdHJ1ZTsgLy8gJEZsb3dGaXhNZSAtIFNob3VsZCBiZSBpbmZlcnJlZCBhcyBub3QgdW5kZWZpbmVkLgoKICAgICAgICAgICAgICAgIGV4dHJhQXR0cmlidXRlTmFtZXMuZGVsZXRlKHN0YW5kYXJkTmFtZSk7CiAgICAgICAgICAgICAgfSAvLyAkRmxvd0ZpeE1lIC0gU2hvdWxkIGJlIGluZmVycmVkIGFzIG5vdCB1bmRlZmluZWQuCgoKICAgICAgICAgICAgICBleHRyYUF0dHJpYnV0ZU5hbWVzLmRlbGV0ZShwcm9wS2V5KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgc2VydmVyVmFsdWUgPSBnZXRWYWx1ZUZvckF0dHJpYnV0ZShkb21FbGVtZW50LCBwcm9wS2V5LCBuZXh0UHJvcCk7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIGRvbnRXYXJuQ3VzdG9tRWxlbWVudCA9IGVuYWJsZUN1c3RvbUVsZW1lbnRQcm9wZXJ0eVN1cHBvcnQgIDsKCiAgICAgICAgICBpZiAoIWRvbnRXYXJuQ3VzdG9tRWxlbWVudCAmJiBuZXh0UHJvcCAhPT0gc2VydmVyVmFsdWUgJiYgIWlzTWlzbWF0Y2hEdWVUb0JhZENhc2luZykgewogICAgICAgICAgICB3YXJuRm9yUHJvcERpZmZlcmVuY2UocHJvcEtleSwgc2VydmVyVmFsdWUsIG5leHRQcm9wKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICB7CiAgICAgIGlmIChzaG91bGRXYXJuRGV2KSB7CiAgICAgICAgaWYgKCAvLyAkRmxvd0ZpeE1lIC0gU2hvdWxkIGJlIGluZmVycmVkIGFzIG5vdCB1bmRlZmluZWQuCiAgICAgICAgZXh0cmFBdHRyaWJ1dGVOYW1lcy5zaXplID4gMCAmJiByYXdQcm9wc1tTVVBQUkVTU19IWURSQVRJT05fV0FSTklOR10gIT09IHRydWUpIHsKICAgICAgICAgIC8vICRGbG93Rml4TWUgLSBTaG91bGQgYmUgaW5mZXJyZWQgYXMgbm90IHVuZGVmaW5lZC4KICAgICAgICAgIHdhcm5Gb3JFeHRyYUF0dHJpYnV0ZXMoZXh0cmFBdHRyaWJ1dGVOYW1lcyk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgc3dpdGNoICh0YWcpIHsKICAgICAgY2FzZSAnaW5wdXQnOgogICAgICAgIC8vIFRPRE86IE1ha2Ugc3VyZSB3ZSBjaGVjayBpZiB0aGlzIGlzIHN0aWxsIHVubW91bnRlZCBvciBkbyBhbnkgY2xlYW4KICAgICAgICAvLyB1cCBuZWNlc3Nhcnkgc2luY2Ugd2UgbmV2ZXIgc3RvcCB0cmFja2luZyBhbnltb3JlLgogICAgICAgIHRyYWNrKGRvbUVsZW1lbnQpOwogICAgICAgIHBvc3RNb3VudFdyYXBwZXIoZG9tRWxlbWVudCwgcmF3UHJvcHMsIHRydWUpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAndGV4dGFyZWEnOgogICAgICAgIC8vIFRPRE86IE1ha2Ugc3VyZSB3ZSBjaGVjayBpZiB0aGlzIGlzIHN0aWxsIHVubW91bnRlZCBvciBkbyBhbnkgY2xlYW4KICAgICAgICAvLyB1cCBuZWNlc3Nhcnkgc2luY2Ugd2UgbmV2ZXIgc3RvcCB0cmFja2luZyBhbnltb3JlLgogICAgICAgIHRyYWNrKGRvbUVsZW1lbnQpOwogICAgICAgIHBvc3RNb3VudFdyYXBwZXIkMyhkb21FbGVtZW50KTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ3NlbGVjdCc6CiAgICAgIGNhc2UgJ29wdGlvbic6CiAgICAgICAgLy8gRm9yIGlucHV0IGFuZCB0ZXh0YXJlYSB3ZSBjdXJyZW50IGFsd2F5cyBzZXQgdGhlIHZhbHVlIHByb3BlcnR5IGF0CiAgICAgICAgLy8gcG9zdCBtb3VudCB0byBmb3JjZSBpdCB0byBkaXZlcmdlIGZyb20gYXR0cmlidXRlcy4gSG93ZXZlciwgZm9yCiAgICAgICAgLy8gb3B0aW9uIGFuZCBzZWxlY3Qgd2UgZG9uJ3QgcXVpdGUgZG8gdGhlIHNhbWUgdGhpbmcgYW5kIHNlbGVjdAogICAgICAgIC8vIGlzIG5vdCByZXNpbGllbnQgdG8gdGhlIERPTSBzdGF0ZSBjaGFuZ2luZyBzbyB3ZSBkb24ndCBkbyB0aGF0IGhlcmUuCiAgICAgICAgLy8gVE9ETzogQ29uc2lkZXIgbm90IGRvaW5nIHRoaXMgZm9yIGlucHV0IGFuZCB0ZXh0YXJlYS4KICAgICAgICBicmVhazsKCiAgICAgIGRlZmF1bHQ6CiAgICAgICAgaWYgKHR5cGVvZiByYXdQcm9wcy5vbkNsaWNrID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAvLyBUT0RPOiBUaGlzIGNhc3QgbWF5IG5vdCBiZSBzb3VuZCBmb3IgU1ZHLCBNYXRoTUwgb3IgY3VzdG9tIGVsZW1lbnRzLgogICAgICAgICAgdHJhcENsaWNrT25Ob25JbnRlcmFjdGl2ZUVsZW1lbnQoZG9tRWxlbWVudCk7CiAgICAgICAgfQoKICAgICAgICBicmVhazsKICAgIH0KCiAgICByZXR1cm4gdXBkYXRlUGF5bG9hZDsKICB9CiAgZnVuY3Rpb24gZGlmZkh5ZHJhdGVkVGV4dCh0ZXh0Tm9kZSwgdGV4dCwgaXNDb25jdXJyZW50TW9kZSkgewogICAgdmFyIGlzRGlmZmVyZW50ID0gdGV4dE5vZGUubm9kZVZhbHVlICE9PSB0ZXh0OwogICAgcmV0dXJuIGlzRGlmZmVyZW50OwogIH0KICBmdW5jdGlvbiB3YXJuRm9yRGVsZXRlZEh5ZHJhdGFibGVFbGVtZW50KHBhcmVudE5vZGUsIGNoaWxkKSB7CiAgICB7CiAgICAgIGlmIChkaWRXYXJuSW52YWxpZEh5ZHJhdGlvbikgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgZGlkV2FybkludmFsaWRIeWRyYXRpb24gPSB0cnVlOwoKICAgICAgZXJyb3IoJ0RpZCBub3QgZXhwZWN0IHNlcnZlciBIVE1MIHRvIGNvbnRhaW4gYSA8JXM+IGluIDwlcz4uJywgY2hpbGQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSwgcGFyZW50Tm9kZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpKTsKICAgIH0KICB9CiAgZnVuY3Rpb24gd2FybkZvckRlbGV0ZWRIeWRyYXRhYmxlVGV4dChwYXJlbnROb2RlLCBjaGlsZCkgewogICAgewogICAgICBpZiAoZGlkV2FybkludmFsaWRIeWRyYXRpb24pIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGRpZFdhcm5JbnZhbGlkSHlkcmF0aW9uID0gdHJ1ZTsKCiAgICAgIGVycm9yKCdEaWQgbm90IGV4cGVjdCBzZXJ2ZXIgSFRNTCB0byBjb250YWluIHRoZSB0ZXh0IG5vZGUgIiVzIiBpbiA8JXM+LicsIGNoaWxkLm5vZGVWYWx1ZSwgcGFyZW50Tm9kZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpKTsKICAgIH0KICB9CiAgZnVuY3Rpb24gd2FybkZvckluc2VydGVkSHlkcmF0ZWRFbGVtZW50KHBhcmVudE5vZGUsIHRhZywgcHJvcHMpIHsKICAgIHsKICAgICAgaWYgKGRpZFdhcm5JbnZhbGlkSHlkcmF0aW9uKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBkaWRXYXJuSW52YWxpZEh5ZHJhdGlvbiA9IHRydWU7CgogICAgICBlcnJvcignRXhwZWN0ZWQgc2VydmVyIEhUTUwgdG8gY29udGFpbiBhIG1hdGNoaW5nIDwlcz4gaW4gPCVzPi4nLCB0YWcsIHBhcmVudE5vZGUubm9kZU5hbWUudG9Mb3dlckNhc2UoKSk7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHdhcm5Gb3JJbnNlcnRlZEh5ZHJhdGVkVGV4dChwYXJlbnROb2RlLCB0ZXh0KSB7CiAgICB7CiAgICAgIGlmICh0ZXh0ID09PSAnJykgewogICAgICAgIC8vIFdlIGV4cGVjdCB0byBpbnNlcnQgZW1wdHkgdGV4dCBub2RlcyBzaW5jZSB0aGV5J3JlIG5vdCByZXByZXNlbnRlZCBpbgogICAgICAgIC8vIHRoZSBIVE1MLgogICAgICAgIC8vIFRPRE86IFJlbW92ZSB0aGlzIHNwZWNpYWwgY2FzZSBpZiB3ZSBjYW4ganVzdCBhdm9pZCBpbnNlcnRpbmcgZW1wdHkKICAgICAgICAvLyB0ZXh0IG5vZGVzLgogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKGRpZFdhcm5JbnZhbGlkSHlkcmF0aW9uKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBkaWRXYXJuSW52YWxpZEh5ZHJhdGlvbiA9IHRydWU7CgogICAgICBlcnJvcignRXhwZWN0ZWQgc2VydmVyIEhUTUwgdG8gY29udGFpbiBhIG1hdGNoaW5nIHRleHQgbm9kZSBmb3IgIiVzIiBpbiA8JXM+LicsIHRleHQsIHBhcmVudE5vZGUubm9kZU5hbWUudG9Mb3dlckNhc2UoKSk7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHJlc3RvcmVDb250cm9sbGVkU3RhdGUkMyhkb21FbGVtZW50LCB0YWcsIHByb3BzKSB7CiAgICBzd2l0Y2ggKHRhZykgewogICAgICBjYXNlICdpbnB1dCc6CiAgICAgICAgcmVzdG9yZUNvbnRyb2xsZWRTdGF0ZShkb21FbGVtZW50LCBwcm9wcyk7CiAgICAgICAgcmV0dXJuOwoKICAgICAgY2FzZSAndGV4dGFyZWEnOgogICAgICAgIHJlc3RvcmVDb250cm9sbGVkU3RhdGUkMihkb21FbGVtZW50LCBwcm9wcyk7CiAgICAgICAgcmV0dXJuOwoKICAgICAgY2FzZSAnc2VsZWN0JzoKICAgICAgICByZXN0b3JlQ29udHJvbGxlZFN0YXRlJDEoZG9tRWxlbWVudCwgcHJvcHMpOwogICAgICAgIHJldHVybjsKICAgIH0KICB9CgogIHZhciB2YWxpZGF0ZURPTU5lc3RpbmcgPSBmdW5jdGlvbiAoKSB7fTsKCiAgdmFyIHVwZGF0ZWRBbmNlc3RvckluZm8gPSBmdW5jdGlvbiAoKSB7fTsKCiAgewogICAgLy8gVGhpcyB2YWxpZGF0aW9uIGNvZGUgd2FzIHdyaXR0ZW4gYmFzZWQgb24gdGhlIEhUTUw1IHBhcnNpbmcgc3BlYzoKICAgIC8vIGh0dHBzOi8vaHRtbC5zcGVjLndoYXR3Zy5vcmcvbXVsdGlwYWdlL3N5bnRheC5odG1sI2hhcy1hbi1lbGVtZW50LWluLXNjb3BlCiAgICAvLwogICAgLy8gTm90ZTogdGhpcyBkb2VzIG5vdCBjYXRjaCBhbGwgaW52YWxpZCBuZXN0aW5nLCBub3IgZG9lcyBpdCB0cnkgdG8gKGFzIGl0J3MKICAgIC8vIG5vdCBjbGVhciB3aGF0IHByYWN0aWNhbCBiZW5lZml0IGRvaW5nIHNvIHByb3ZpZGVzKTsgaW5zdGVhZCwgd2Ugd2FybiBvbmx5CiAgICAvLyBmb3IgY2FzZXMgd2hlcmUgdGhlIHBhcnNlciB3aWxsIGdpdmUgYSBwYXJzZSB0cmVlIGRpZmZlcmluZyBmcm9tIHdoYXQgUmVhY3QKICAgIC8vIGludGVuZGVkLiBGb3IgZXhhbXBsZSwgPGI+PGRpdj48L2Rpdj48L2I+IGlzIGludmFsaWQgYnV0IHdlIGRvbid0IHdhcm4KICAgIC8vIGJlY2F1c2UgaXQgc3RpbGwgcGFyc2VzIGNvcnJlY3RseTsgd2UgZG8gd2FybiBmb3Igb3RoZXIgY2FzZXMgbGlrZSBuZXN0ZWQKICAgIC8vIDxwPiB0YWdzIHdoZXJlIHRoZSBiZWdpbm5pbmcgb2YgdGhlIHNlY29uZCBlbGVtZW50IGltcGxpY2l0bHkgY2xvc2VzIHRoZQogICAgLy8gZmlyc3QsIGNhdXNpbmcgYSBjb25mdXNpbmcgbWVzcy4KICAgIC8vIGh0dHBzOi8vaHRtbC5zcGVjLndoYXR3Zy5vcmcvbXVsdGlwYWdlL3N5bnRheC5odG1sI3NwZWNpYWwKICAgIHZhciBzcGVjaWFsVGFncyA9IFsnYWRkcmVzcycsICdhcHBsZXQnLCAnYXJlYScsICdhcnRpY2xlJywgJ2FzaWRlJywgJ2Jhc2UnLCAnYmFzZWZvbnQnLCAnYmdzb3VuZCcsICdibG9ja3F1b3RlJywgJ2JvZHknLCAnYnInLCAnYnV0dG9uJywgJ2NhcHRpb24nLCAnY2VudGVyJywgJ2NvbCcsICdjb2xncm91cCcsICdkZCcsICdkZXRhaWxzJywgJ2RpcicsICdkaXYnLCAnZGwnLCAnZHQnLCAnZW1iZWQnLCAnZmllbGRzZXQnLCAnZmlnY2FwdGlvbicsICdmaWd1cmUnLCAnZm9vdGVyJywgJ2Zvcm0nLCAnZnJhbWUnLCAnZnJhbWVzZXQnLCAnaDEnLCAnaDInLCAnaDMnLCAnaDQnLCAnaDUnLCAnaDYnLCAnaGVhZCcsICdoZWFkZXInLCAnaGdyb3VwJywgJ2hyJywgJ2h0bWwnLCAnaWZyYW1lJywgJ2ltZycsICdpbnB1dCcsICdpc2luZGV4JywgJ2xpJywgJ2xpbmsnLCAnbGlzdGluZycsICdtYWluJywgJ21hcnF1ZWUnLCAnbWVudScsICdtZW51aXRlbScsICdtZXRhJywgJ25hdicsICdub2VtYmVkJywgJ25vZnJhbWVzJywgJ25vc2NyaXB0JywgJ29iamVjdCcsICdvbCcsICdwJywgJ3BhcmFtJywgJ3BsYWludGV4dCcsICdwcmUnLCAnc2NyaXB0JywgJ3NlY3Rpb24nLCAnc2VsZWN0JywgJ3NvdXJjZScsICdzdHlsZScsICdzdW1tYXJ5JywgJ3RhYmxlJywgJ3Rib2R5JywgJ3RkJywgJ3RlbXBsYXRlJywgJ3RleHRhcmVhJywgJ3Rmb290JywgJ3RoJywgJ3RoZWFkJywgJ3RpdGxlJywgJ3RyJywgJ3RyYWNrJywgJ3VsJywgJ3dicicsICd4bXAnXTsgLy8gaHR0cHM6Ly9odG1sLnNwZWMud2hhdHdnLm9yZy9tdWx0aXBhZ2Uvc3ludGF4Lmh0bWwjaGFzLWFuLWVsZW1lbnQtaW4tc2NvcGUKCiAgICB2YXIgaW5TY29wZVRhZ3MgPSBbJ2FwcGxldCcsICdjYXB0aW9uJywgJ2h0bWwnLCAndGFibGUnLCAndGQnLCAndGgnLCAnbWFycXVlZScsICdvYmplY3QnLCAndGVtcGxhdGUnLCAvLyBodHRwczovL2h0bWwuc3BlYy53aGF0d2cub3JnL211bHRpcGFnZS9zeW50YXguaHRtbCNodG1sLWludGVncmF0aW9uLXBvaW50CiAgICAvLyBUT0RPOiBEaXN0aW5ndWlzaCBieSBuYW1lc3BhY2UgaGVyZSAtLSBmb3IgPHRpdGxlPiwgaW5jbHVkaW5nIGl0IGhlcmUKICAgIC8vIGVycnMgb24gdGhlIHNpZGUgb2YgZmV3ZXIgd2FybmluZ3MKICAgICdmb3JlaWduT2JqZWN0JywgJ2Rlc2MnLCAndGl0bGUnXTsgLy8gaHR0cHM6Ly9odG1sLnNwZWMud2hhdHdnLm9yZy9tdWx0aXBhZ2Uvc3ludGF4Lmh0bWwjaGFzLWFuLWVsZW1lbnQtaW4tYnV0dG9uLXNjb3BlCgogICAgdmFyIGJ1dHRvblNjb3BlVGFncyA9IGluU2NvcGVUYWdzLmNvbmNhdChbJ2J1dHRvbiddKTsgLy8gaHR0cHM6Ly9odG1sLnNwZWMud2hhdHdnLm9yZy9tdWx0aXBhZ2Uvc3ludGF4Lmh0bWwjZ2VuZXJhdGUtaW1wbGllZC1lbmQtdGFncwoKICAgIHZhciBpbXBsaWVkRW5kVGFncyA9IFsnZGQnLCAnZHQnLCAnbGknLCAnb3B0aW9uJywgJ29wdGdyb3VwJywgJ3AnLCAncnAnLCAncnQnXTsKICAgIHZhciBlbXB0eUFuY2VzdG9ySW5mbyA9IHsKICAgICAgY3VycmVudDogbnVsbCwKICAgICAgZm9ybVRhZzogbnVsbCwKICAgICAgYVRhZ0luU2NvcGU6IG51bGwsCiAgICAgIGJ1dHRvblRhZ0luU2NvcGU6IG51bGwsCiAgICAgIG5vYnJUYWdJblNjb3BlOiBudWxsLAogICAgICBwVGFnSW5CdXR0b25TY29wZTogbnVsbCwKICAgICAgbGlzdEl0ZW1UYWdBdXRvY2xvc2luZzogbnVsbCwKICAgICAgZGxJdGVtVGFnQXV0b2Nsb3Npbmc6IG51bGwKICAgIH07CgogICAgdXBkYXRlZEFuY2VzdG9ySW5mbyA9IGZ1bmN0aW9uIChvbGRJbmZvLCB0YWcpIHsKICAgICAgdmFyIGFuY2VzdG9ySW5mbyA9IGFzc2lnbih7fSwgb2xkSW5mbyB8fCBlbXB0eUFuY2VzdG9ySW5mbyk7CgogICAgICB2YXIgaW5mbyA9IHsKICAgICAgICB0YWc6IHRhZwogICAgICB9OwoKICAgICAgaWYgKGluU2NvcGVUYWdzLmluZGV4T2YodGFnKSAhPT0gLTEpIHsKICAgICAgICBhbmNlc3RvckluZm8uYVRhZ0luU2NvcGUgPSBudWxsOwogICAgICAgIGFuY2VzdG9ySW5mby5idXR0b25UYWdJblNjb3BlID0gbnVsbDsKICAgICAgICBhbmNlc3RvckluZm8ubm9iclRhZ0luU2NvcGUgPSBudWxsOwogICAgICB9CgogICAgICBpZiAoYnV0dG9uU2NvcGVUYWdzLmluZGV4T2YodGFnKSAhPT0gLTEpIHsKICAgICAgICBhbmNlc3RvckluZm8ucFRhZ0luQnV0dG9uU2NvcGUgPSBudWxsOwogICAgICB9IC8vIFNlZSBydWxlcyBmb3IgJ2xpJywgJ2RkJywgJ2R0JyBzdGFydCB0YWdzIGluCiAgICAgIC8vIGh0dHBzOi8vaHRtbC5zcGVjLndoYXR3Zy5vcmcvbXVsdGlwYWdlL3N5bnRheC5odG1sI3BhcnNpbmctbWFpbi1pbmJvZHkKCgogICAgICBpZiAoc3BlY2lhbFRhZ3MuaW5kZXhPZih0YWcpICE9PSAtMSAmJiB0YWcgIT09ICdhZGRyZXNzJyAmJiB0YWcgIT09ICdkaXYnICYmIHRhZyAhPT0gJ3AnKSB7CiAgICAgICAgYW5jZXN0b3JJbmZvLmxpc3RJdGVtVGFnQXV0b2Nsb3NpbmcgPSBudWxsOwogICAgICAgIGFuY2VzdG9ySW5mby5kbEl0ZW1UYWdBdXRvY2xvc2luZyA9IG51bGw7CiAgICAgIH0KCiAgICAgIGFuY2VzdG9ySW5mby5jdXJyZW50ID0gaW5mbzsKCiAgICAgIGlmICh0YWcgPT09ICdmb3JtJykgewogICAgICAgIGFuY2VzdG9ySW5mby5mb3JtVGFnID0gaW5mbzsKICAgICAgfQoKICAgICAgaWYgKHRhZyA9PT0gJ2EnKSB7CiAgICAgICAgYW5jZXN0b3JJbmZvLmFUYWdJblNjb3BlID0gaW5mbzsKICAgICAgfQoKICAgICAgaWYgKHRhZyA9PT0gJ2J1dHRvbicpIHsKICAgICAgICBhbmNlc3RvckluZm8uYnV0dG9uVGFnSW5TY29wZSA9IGluZm87CiAgICAgIH0KCiAgICAgIGlmICh0YWcgPT09ICdub2JyJykgewogICAgICAgIGFuY2VzdG9ySW5mby5ub2JyVGFnSW5TY29wZSA9IGluZm87CiAgICAgIH0KCiAgICAgIGlmICh0YWcgPT09ICdwJykgewogICAgICAgIGFuY2VzdG9ySW5mby5wVGFnSW5CdXR0b25TY29wZSA9IGluZm87CiAgICAgIH0KCiAgICAgIGlmICh0YWcgPT09ICdsaScpIHsKICAgICAgICBhbmNlc3RvckluZm8ubGlzdEl0ZW1UYWdBdXRvY2xvc2luZyA9IGluZm87CiAgICAgIH0KCiAgICAgIGlmICh0YWcgPT09ICdkZCcgfHwgdGFnID09PSAnZHQnKSB7CiAgICAgICAgYW5jZXN0b3JJbmZvLmRsSXRlbVRhZ0F1dG9jbG9zaW5nID0gaW5mbzsKICAgICAgfQoKICAgICAgcmV0dXJuIGFuY2VzdG9ySW5mbzsKICAgIH07CiAgICAvKioKICAgICAqIFJldHVybnMgd2hldGhlcgogICAgICovCgoKICAgIHZhciBpc1RhZ1ZhbGlkV2l0aFBhcmVudCA9IGZ1bmN0aW9uICh0YWcsIHBhcmVudFRhZykgewogICAgICAvLyBGaXJzdCwgbGV0J3MgY2hlY2sgaWYgd2UncmUgaW4gYW4gdW51c3VhbCBwYXJzaW5nIG1vZGUuLi4KICAgICAgc3dpdGNoIChwYXJlbnRUYWcpIHsKICAgICAgICAvLyBodHRwczovL2h0bWwuc3BlYy53aGF0d2cub3JnL211bHRpcGFnZS9zeW50YXguaHRtbCNwYXJzaW5nLW1haW4taW5zZWxlY3QKICAgICAgICBjYXNlICdzZWxlY3QnOgogICAgICAgICAgcmV0dXJuIHRhZyA9PT0gJ29wdGlvbicgfHwgdGFnID09PSAnb3B0Z3JvdXAnIHx8IHRhZyA9PT0gJyN0ZXh0JzsKCiAgICAgICAgY2FzZSAnb3B0Z3JvdXAnOgogICAgICAgICAgcmV0dXJuIHRhZyA9PT0gJ29wdGlvbicgfHwgdGFnID09PSAnI3RleHQnOwogICAgICAgIC8vIFN0cmljdGx5IHNwZWFraW5nLCBzZWVpbmcgYW4gPG9wdGlvbj4gZG9lc24ndCBtZWFuIHdlJ3JlIGluIGEgPHNlbGVjdD4KICAgICAgICAvLyBidXQKCiAgICAgICAgY2FzZSAnb3B0aW9uJzoKICAgICAgICAgIHJldHVybiB0YWcgPT09ICcjdGV4dCc7CiAgICAgICAgLy8gaHR0cHM6Ly9odG1sLnNwZWMud2hhdHdnLm9yZy9tdWx0aXBhZ2Uvc3ludGF4Lmh0bWwjcGFyc2luZy1tYWluLWludGQKICAgICAgICAvLyBodHRwczovL2h0bWwuc3BlYy53aGF0d2cub3JnL211bHRpcGFnZS9zeW50YXguaHRtbCNwYXJzaW5nLW1haW4taW5jYXB0aW9uCiAgICAgICAgLy8gTm8gc3BlY2lhbCBiZWhhdmlvciBzaW5jZSB0aGVzZSBydWxlcyBmYWxsIGJhY2sgdG8gImluIGJvZHkiIG1vZGUgZm9yCiAgICAgICAgLy8gYWxsIGV4Y2VwdCBzcGVjaWFsIHRhYmxlIG5vZGVzIHdoaWNoIGNhdXNlIGJhZCBwYXJzaW5nIGJlaGF2aW9yIGFueXdheS4KICAgICAgICAvLyBodHRwczovL2h0bWwuc3BlYy53aGF0d2cub3JnL211bHRpcGFnZS9zeW50YXguaHRtbCNwYXJzaW5nLW1haW4taW50cgoKICAgICAgICBjYXNlICd0cic6CiAgICAgICAgICByZXR1cm4gdGFnID09PSAndGgnIHx8IHRhZyA9PT0gJ3RkJyB8fCB0YWcgPT09ICdzdHlsZScgfHwgdGFnID09PSAnc2NyaXB0JyB8fCB0YWcgPT09ICd0ZW1wbGF0ZSc7CiAgICAgICAgLy8gaHR0cHM6Ly9odG1sLnNwZWMud2hhdHdnLm9yZy9tdWx0aXBhZ2Uvc3ludGF4Lmh0bWwjcGFyc2luZy1tYWluLWludGJvZHkKCiAgICAgICAgY2FzZSAndGJvZHknOgogICAgICAgIGNhc2UgJ3RoZWFkJzoKICAgICAgICBjYXNlICd0Zm9vdCc6CiAgICAgICAgICByZXR1cm4gdGFnID09PSAndHInIHx8IHRhZyA9PT0gJ3N0eWxlJyB8fCB0YWcgPT09ICdzY3JpcHQnIHx8IHRhZyA9PT0gJ3RlbXBsYXRlJzsKICAgICAgICAvLyBodHRwczovL2h0bWwuc3BlYy53aGF0d2cub3JnL211bHRpcGFnZS9zeW50YXguaHRtbCNwYXJzaW5nLW1haW4taW5jb2xncm91cAoKICAgICAgICBjYXNlICdjb2xncm91cCc6CiAgICAgICAgICByZXR1cm4gdGFnID09PSAnY29sJyB8fCB0YWcgPT09ICd0ZW1wbGF0ZSc7CiAgICAgICAgLy8gaHR0cHM6Ly9odG1sLnNwZWMud2hhdHdnLm9yZy9tdWx0aXBhZ2Uvc3ludGF4Lmh0bWwjcGFyc2luZy1tYWluLWludGFibGUKCiAgICAgICAgY2FzZSAndGFibGUnOgogICAgICAgICAgcmV0dXJuIHRhZyA9PT0gJ2NhcHRpb24nIHx8IHRhZyA9PT0gJ2NvbGdyb3VwJyB8fCB0YWcgPT09ICd0Ym9keScgfHwgdGFnID09PSAndGZvb3QnIHx8IHRhZyA9PT0gJ3RoZWFkJyB8fCB0YWcgPT09ICdzdHlsZScgfHwgdGFnID09PSAnc2NyaXB0JyB8fCB0YWcgPT09ICd0ZW1wbGF0ZSc7CiAgICAgICAgLy8gaHR0cHM6Ly9odG1sLnNwZWMud2hhdHdnLm9yZy9tdWx0aXBhZ2Uvc3ludGF4Lmh0bWwjcGFyc2luZy1tYWluLWluaGVhZAoKICAgICAgICBjYXNlICdoZWFkJzoKICAgICAgICAgIHJldHVybiB0YWcgPT09ICdiYXNlJyB8fCB0YWcgPT09ICdiYXNlZm9udCcgfHwgdGFnID09PSAnYmdzb3VuZCcgfHwgdGFnID09PSAnbGluaycgfHwgdGFnID09PSAnbWV0YScgfHwgdGFnID09PSAndGl0bGUnIHx8IHRhZyA9PT0gJ25vc2NyaXB0JyB8fCB0YWcgPT09ICdub2ZyYW1lcycgfHwgdGFnID09PSAnc3R5bGUnIHx8IHRhZyA9PT0gJ3NjcmlwdCcgfHwgdGFnID09PSAndGVtcGxhdGUnOwogICAgICAgIC8vIGh0dHBzOi8vaHRtbC5zcGVjLndoYXR3Zy5vcmcvbXVsdGlwYWdlL3NlbWFudGljcy5odG1sI3RoZS1odG1sLWVsZW1lbnQKCiAgICAgICAgY2FzZSAnaHRtbCc6CiAgICAgICAgICByZXR1cm4gdGFnID09PSAnaGVhZCcgfHwgdGFnID09PSAnYm9keScgfHwgdGFnID09PSAnZnJhbWVzZXQnOwoKICAgICAgICBjYXNlICdmcmFtZXNldCc6CiAgICAgICAgICByZXR1cm4gdGFnID09PSAnZnJhbWUnOwoKICAgICAgICBjYXNlICcjZG9jdW1lbnQnOgogICAgICAgICAgcmV0dXJuIHRhZyA9PT0gJ2h0bWwnOwogICAgICB9IC8vIFByb2JhYmx5IGluIHRoZSAiaW4gYm9keSIgcGFyc2luZyBtb2RlLCBzbyB3ZSBvdXRsYXcgb25seSB0YWcgY29tYm9zCiAgICAgIC8vIHdoZXJlIHRoZSBwYXJzaW5nIHJ1bGVzIGNhdXNlIGltcGxpY2l0IG9wZW5zIG9yIGNsb3NlcyB0byBiZSBhZGRlZC4KICAgICAgLy8gaHR0cHM6Ly9odG1sLnNwZWMud2hhdHdnLm9yZy9tdWx0aXBhZ2Uvc3ludGF4Lmh0bWwjcGFyc2luZy1tYWluLWluYm9keQoKCiAgICAgIHN3aXRjaCAodGFnKSB7CiAgICAgICAgY2FzZSAnaDEnOgogICAgICAgIGNhc2UgJ2gyJzoKICAgICAgICBjYXNlICdoMyc6CiAgICAgICAgY2FzZSAnaDQnOgogICAgICAgIGNhc2UgJ2g1JzoKICAgICAgICBjYXNlICdoNic6CiAgICAgICAgICByZXR1cm4gcGFyZW50VGFnICE9PSAnaDEnICYmIHBhcmVudFRhZyAhPT0gJ2gyJyAmJiBwYXJlbnRUYWcgIT09ICdoMycgJiYgcGFyZW50VGFnICE9PSAnaDQnICYmIHBhcmVudFRhZyAhPT0gJ2g1JyAmJiBwYXJlbnRUYWcgIT09ICdoNic7CgogICAgICAgIGNhc2UgJ3JwJzoKICAgICAgICBjYXNlICdydCc6CiAgICAgICAgICByZXR1cm4gaW1wbGllZEVuZFRhZ3MuaW5kZXhPZihwYXJlbnRUYWcpID09PSAtMTsKCiAgICAgICAgY2FzZSAnYm9keSc6CiAgICAgICAgY2FzZSAnY2FwdGlvbic6CiAgICAgICAgY2FzZSAnY29sJzoKICAgICAgICBjYXNlICdjb2xncm91cCc6CiAgICAgICAgY2FzZSAnZnJhbWVzZXQnOgogICAgICAgIGNhc2UgJ2ZyYW1lJzoKICAgICAgICBjYXNlICdoZWFkJzoKICAgICAgICBjYXNlICdodG1sJzoKICAgICAgICBjYXNlICd0Ym9keSc6CiAgICAgICAgY2FzZSAndGQnOgogICAgICAgIGNhc2UgJ3Rmb290JzoKICAgICAgICBjYXNlICd0aCc6CiAgICAgICAgY2FzZSAndGhlYWQnOgogICAgICAgIGNhc2UgJ3RyJzoKICAgICAgICAgIC8vIFRoZXNlIHRhZ3MgYXJlIG9ubHkgdmFsaWQgd2l0aCBhIGZldyBwYXJlbnRzIHRoYXQgaGF2ZSBzcGVjaWFsIGNoaWxkCiAgICAgICAgICAvLyBwYXJzaW5nIHJ1bGVzIC0tIGlmIHdlJ3JlIGRvd24gaGVyZSwgdGhlbiBub25lIG9mIHRob3NlIG1hdGNoZWQgYW5kCiAgICAgICAgICAvLyBzbyB3ZSBhbGxvdyBpdCBvbmx5IGlmIHdlIGRvbid0IGtub3cgd2hhdCB0aGUgcGFyZW50IGlzLCBhcyBhbGwgb3RoZXIKICAgICAgICAgIC8vIGNhc2VzIGFyZSBpbnZhbGlkLgogICAgICAgICAgcmV0dXJuIHBhcmVudFRhZyA9PSBudWxsOwogICAgICB9CgogICAgICByZXR1cm4gdHJ1ZTsKICAgIH07CiAgICAvKioKICAgICAqIFJldHVybnMgd2hldGhlcgogICAgICovCgoKICAgIHZhciBmaW5kSW52YWxpZEFuY2VzdG9yRm9yVGFnID0gZnVuY3Rpb24gKHRhZywgYW5jZXN0b3JJbmZvKSB7CiAgICAgIHN3aXRjaCAodGFnKSB7CiAgICAgICAgY2FzZSAnYWRkcmVzcyc6CiAgICAgICAgY2FzZSAnYXJ0aWNsZSc6CiAgICAgICAgY2FzZSAnYXNpZGUnOgogICAgICAgIGNhc2UgJ2Jsb2NrcXVvdGUnOgogICAgICAgIGNhc2UgJ2NlbnRlcic6CiAgICAgICAgY2FzZSAnZGV0YWlscyc6CiAgICAgICAgY2FzZSAnZGlhbG9nJzoKICAgICAgICBjYXNlICdkaXInOgogICAgICAgIGNhc2UgJ2Rpdic6CiAgICAgICAgY2FzZSAnZGwnOgogICAgICAgIGNhc2UgJ2ZpZWxkc2V0JzoKICAgICAgICBjYXNlICdmaWdjYXB0aW9uJzoKICAgICAgICBjYXNlICdmaWd1cmUnOgogICAgICAgIGNhc2UgJ2Zvb3Rlcic6CiAgICAgICAgY2FzZSAnaGVhZGVyJzoKICAgICAgICBjYXNlICdoZ3JvdXAnOgogICAgICAgIGNhc2UgJ21haW4nOgogICAgICAgIGNhc2UgJ21lbnUnOgogICAgICAgIGNhc2UgJ25hdic6CiAgICAgICAgY2FzZSAnb2wnOgogICAgICAgIGNhc2UgJ3AnOgogICAgICAgIGNhc2UgJ3NlY3Rpb24nOgogICAgICAgIGNhc2UgJ3N1bW1hcnknOgogICAgICAgIGNhc2UgJ3VsJzoKICAgICAgICBjYXNlICdwcmUnOgogICAgICAgIGNhc2UgJ2xpc3RpbmcnOgogICAgICAgIGNhc2UgJ3RhYmxlJzoKICAgICAgICBjYXNlICdocic6CiAgICAgICAgY2FzZSAneG1wJzoKICAgICAgICBjYXNlICdoMSc6CiAgICAgICAgY2FzZSAnaDInOgogICAgICAgIGNhc2UgJ2gzJzoKICAgICAgICBjYXNlICdoNCc6CiAgICAgICAgY2FzZSAnaDUnOgogICAgICAgIGNhc2UgJ2g2JzoKICAgICAgICAgIHJldHVybiBhbmNlc3RvckluZm8ucFRhZ0luQnV0dG9uU2NvcGU7CgogICAgICAgIGNhc2UgJ2Zvcm0nOgogICAgICAgICAgcmV0dXJuIGFuY2VzdG9ySW5mby5mb3JtVGFnIHx8IGFuY2VzdG9ySW5mby5wVGFnSW5CdXR0b25TY29wZTsKCiAgICAgICAgY2FzZSAnbGknOgogICAgICAgICAgcmV0dXJuIGFuY2VzdG9ySW5mby5saXN0SXRlbVRhZ0F1dG9jbG9zaW5nOwoKICAgICAgICBjYXNlICdkZCc6CiAgICAgICAgY2FzZSAnZHQnOgogICAgICAgICAgcmV0dXJuIGFuY2VzdG9ySW5mby5kbEl0ZW1UYWdBdXRvY2xvc2luZzsKCiAgICAgICAgY2FzZSAnYnV0dG9uJzoKICAgICAgICAgIHJldHVybiBhbmNlc3RvckluZm8uYnV0dG9uVGFnSW5TY29wZTsKCiAgICAgICAgY2FzZSAnYSc6CiAgICAgICAgICAvLyBTcGVjIHNheXMgc29tZXRoaW5nIGFib3V0IHN0b3JpbmcgYSBsaXN0IG9mIG1hcmtlcnMsIGJ1dCBpdCBzb3VuZHMKICAgICAgICAgIC8vIGVxdWl2YWxlbnQgdG8gdGhpcyBjaGVjay4KICAgICAgICAgIHJldHVybiBhbmNlc3RvckluZm8uYVRhZ0luU2NvcGU7CgogICAgICAgIGNhc2UgJ25vYnInOgogICAgICAgICAgcmV0dXJuIGFuY2VzdG9ySW5mby5ub2JyVGFnSW5TY29wZTsKICAgICAgfQoKICAgICAgcmV0dXJuIG51bGw7CiAgICB9OwoKICAgIHZhciBkaWRXYXJuJDEgPSB7fTsKCiAgICB2YWxpZGF0ZURPTU5lc3RpbmcgPSBmdW5jdGlvbiAoY2hpbGRUYWcsIGNoaWxkVGV4dCwgYW5jZXN0b3JJbmZvKSB7CiAgICAgIGFuY2VzdG9ySW5mbyA9IGFuY2VzdG9ySW5mbyB8fCBlbXB0eUFuY2VzdG9ySW5mbzsKICAgICAgdmFyIHBhcmVudEluZm8gPSBhbmNlc3RvckluZm8uY3VycmVudDsKICAgICAgdmFyIHBhcmVudFRhZyA9IHBhcmVudEluZm8gJiYgcGFyZW50SW5mby50YWc7CgogICAgICBpZiAoY2hpbGRUZXh0ICE9IG51bGwpIHsKICAgICAgICBpZiAoY2hpbGRUYWcgIT0gbnVsbCkgewogICAgICAgICAgZXJyb3IoJ3ZhbGlkYXRlRE9NTmVzdGluZzogd2hlbiBjaGlsZFRleHQgaXMgcGFzc2VkLCBjaGlsZFRhZyBzaG91bGQgYmUgbnVsbCcpOwogICAgICAgIH0KCiAgICAgICAgY2hpbGRUYWcgPSAnI3RleHQnOwogICAgICB9CgogICAgICB2YXIgaW52YWxpZFBhcmVudCA9IGlzVGFnVmFsaWRXaXRoUGFyZW50KGNoaWxkVGFnLCBwYXJlbnRUYWcpID8gbnVsbCA6IHBhcmVudEluZm87CiAgICAgIHZhciBpbnZhbGlkQW5jZXN0b3IgPSBpbnZhbGlkUGFyZW50ID8gbnVsbCA6IGZpbmRJbnZhbGlkQW5jZXN0b3JGb3JUYWcoY2hpbGRUYWcsIGFuY2VzdG9ySW5mbyk7CiAgICAgIHZhciBpbnZhbGlkUGFyZW50T3JBbmNlc3RvciA9IGludmFsaWRQYXJlbnQgfHwgaW52YWxpZEFuY2VzdG9yOwoKICAgICAgaWYgKCFpbnZhbGlkUGFyZW50T3JBbmNlc3RvcikgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGFuY2VzdG9yVGFnID0gaW52YWxpZFBhcmVudE9yQW5jZXN0b3IudGFnOwogICAgICB2YXIgd2FybktleSA9ICEhaW52YWxpZFBhcmVudCArICd8JyArIGNoaWxkVGFnICsgJ3wnICsgYW5jZXN0b3JUYWc7CgogICAgICBpZiAoZGlkV2FybiQxW3dhcm5LZXldKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBkaWRXYXJuJDFbd2FybktleV0gPSB0cnVlOwogICAgICB2YXIgdGFnRGlzcGxheU5hbWUgPSBjaGlsZFRhZzsKICAgICAgdmFyIHdoaXRlc3BhY2VJbmZvID0gJyc7CgogICAgICBpZiAoY2hpbGRUYWcgPT09ICcjdGV4dCcpIHsKICAgICAgICBpZiAoL1xTLy50ZXN0KGNoaWxkVGV4dCkpIHsKICAgICAgICAgIHRhZ0Rpc3BsYXlOYW1lID0gJ1RleHQgbm9kZXMnOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0YWdEaXNwbGF5TmFtZSA9ICdXaGl0ZXNwYWNlIHRleHQgbm9kZXMnOwogICAgICAgICAgd2hpdGVzcGFjZUluZm8gPSAiIE1ha2Ugc3VyZSB5b3UgZG9uJ3QgaGF2ZSBhbnkgZXh0cmEgd2hpdGVzcGFjZSBiZXR3ZWVuIHRhZ3Mgb24gIiArICdlYWNoIGxpbmUgb2YgeW91ciBzb3VyY2UgY29kZS4nOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB0YWdEaXNwbGF5TmFtZSA9ICc8JyArIGNoaWxkVGFnICsgJz4nOwogICAgICB9CgogICAgICBpZiAoaW52YWxpZFBhcmVudCkgewogICAgICAgIHZhciBpbmZvID0gJyc7CgogICAgICAgIGlmIChhbmNlc3RvclRhZyA9PT0gJ3RhYmxlJyAmJiBjaGlsZFRhZyA9PT0gJ3RyJykgewogICAgICAgICAgaW5mbyArPSAnIEFkZCBhIDx0Ym9keT4sIDx0aGVhZD4gb3IgPHRmb290PiB0byB5b3VyIGNvZGUgdG8gbWF0Y2ggdGhlIERPTSB0cmVlIGdlbmVyYXRlZCBieSAnICsgJ3RoZSBicm93c2VyLic7CiAgICAgICAgfQoKICAgICAgICBlcnJvcigndmFsaWRhdGVET01OZXN0aW5nKC4uLik6ICVzIGNhbm5vdCBhcHBlYXIgYXMgYSBjaGlsZCBvZiA8JXM+LiVzJXMnLCB0YWdEaXNwbGF5TmFtZSwgYW5jZXN0b3JUYWcsIHdoaXRlc3BhY2VJbmZvLCBpbmZvKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBlcnJvcigndmFsaWRhdGVET01OZXN0aW5nKC4uLik6ICVzIGNhbm5vdCBhcHBlYXIgYXMgYSBkZXNjZW5kYW50IG9mICcgKyAnPCVzPi4nLCB0YWdEaXNwbGF5TmFtZSwgYW5jZXN0b3JUYWcpOwogICAgICB9CiAgICB9OwogIH0KCiAgdmFyIFNVUFBSRVNTX0hZRFJBVElPTl9XQVJOSU5HJDEgPSAnc3VwcHJlc3NIeWRyYXRpb25XYXJuaW5nJzsKICB2YXIgU1VTUEVOU0VfU1RBUlRfREFUQSA9ICckJzsKICB2YXIgU1VTUEVOU0VfRU5EX0RBVEEgPSAnLyQnOwogIHZhciBTVVNQRU5TRV9QRU5ESU5HX1NUQVJUX0RBVEEgPSAnJD8nOwogIHZhciBTVVNQRU5TRV9GQUxMQkFDS19TVEFSVF9EQVRBID0gJyQhJzsKICB2YXIgU1RZTEUkMSA9ICdzdHlsZSc7CiAgdmFyIGV2ZW50c0VuYWJsZWQgPSBudWxsOwogIHZhciBzZWxlY3Rpb25JbmZvcm1hdGlvbiA9IG51bGw7CiAgZnVuY3Rpb24gZ2V0Um9vdEhvc3RDb250ZXh0KHJvb3RDb250YWluZXJJbnN0YW5jZSkgewogICAgdmFyIHR5cGU7CiAgICB2YXIgbmFtZXNwYWNlOwogICAgdmFyIG5vZGVUeXBlID0gcm9vdENvbnRhaW5lckluc3RhbmNlLm5vZGVUeXBlOwoKICAgIHN3aXRjaCAobm9kZVR5cGUpIHsKICAgICAgY2FzZSBET0NVTUVOVF9OT0RFOgogICAgICBjYXNlIERPQ1VNRU5UX0ZSQUdNRU5UX05PREU6CiAgICAgICAgewogICAgICAgICAgdHlwZSA9IG5vZGVUeXBlID09PSBET0NVTUVOVF9OT0RFID8gJyNkb2N1bWVudCcgOiAnI2ZyYWdtZW50JzsKICAgICAgICAgIHZhciByb290ID0gcm9vdENvbnRhaW5lckluc3RhbmNlLmRvY3VtZW50RWxlbWVudDsKICAgICAgICAgIG5hbWVzcGFjZSA9IHJvb3QgPyByb290Lm5hbWVzcGFjZVVSSSA6IGdldENoaWxkTmFtZXNwYWNlKG51bGwsICcnKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgIGRlZmF1bHQ6CiAgICAgICAgewogICAgICAgICAgdmFyIGNvbnRhaW5lciA9IG5vZGVUeXBlID09PSBDT01NRU5UX05PREUgPyByb290Q29udGFpbmVySW5zdGFuY2UucGFyZW50Tm9kZSA6IHJvb3RDb250YWluZXJJbnN0YW5jZTsKICAgICAgICAgIHZhciBvd25OYW1lc3BhY2UgPSBjb250YWluZXIubmFtZXNwYWNlVVJJIHx8IG51bGw7CiAgICAgICAgICB0eXBlID0gY29udGFpbmVyLnRhZ05hbWU7CiAgICAgICAgICBuYW1lc3BhY2UgPSBnZXRDaGlsZE5hbWVzcGFjZShvd25OYW1lc3BhY2UsIHR5cGUpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgfQoKICAgIHsKICAgICAgdmFyIHZhbGlkYXRlZFRhZyA9IHR5cGUudG9Mb3dlckNhc2UoKTsKICAgICAgdmFyIGFuY2VzdG9ySW5mbyA9IHVwZGF0ZWRBbmNlc3RvckluZm8obnVsbCwgdmFsaWRhdGVkVGFnKTsKICAgICAgcmV0dXJuIHsKICAgICAgICBuYW1lc3BhY2U6IG5hbWVzcGFjZSwKICAgICAgICBhbmNlc3RvckluZm86IGFuY2VzdG9ySW5mbwogICAgICB9OwogICAgfQogIH0KICBmdW5jdGlvbiBnZXRDaGlsZEhvc3RDb250ZXh0KHBhcmVudEhvc3RDb250ZXh0LCB0eXBlLCByb290Q29udGFpbmVySW5zdGFuY2UpIHsKICAgIHsKICAgICAgdmFyIHBhcmVudEhvc3RDb250ZXh0RGV2ID0gcGFyZW50SG9zdENvbnRleHQ7CiAgICAgIHZhciBuYW1lc3BhY2UgPSBnZXRDaGlsZE5hbWVzcGFjZShwYXJlbnRIb3N0Q29udGV4dERldi5uYW1lc3BhY2UsIHR5cGUpOwogICAgICB2YXIgYW5jZXN0b3JJbmZvID0gdXBkYXRlZEFuY2VzdG9ySW5mbyhwYXJlbnRIb3N0Q29udGV4dERldi5hbmNlc3RvckluZm8sIHR5cGUpOwogICAgICByZXR1cm4gewogICAgICAgIG5hbWVzcGFjZTogbmFtZXNwYWNlLAogICAgICAgIGFuY2VzdG9ySW5mbzogYW5jZXN0b3JJbmZvCiAgICAgIH07CiAgICB9CiAgfQogIGZ1bmN0aW9uIGdldFB1YmxpY0luc3RhbmNlKGluc3RhbmNlKSB7CiAgICByZXR1cm4gaW5zdGFuY2U7CiAgfQogIGZ1bmN0aW9uIHByZXBhcmVGb3JDb21taXQoY29udGFpbmVySW5mbykgewogICAgZXZlbnRzRW5hYmxlZCA9IGlzRW5hYmxlZCgpOwogICAgc2VsZWN0aW9uSW5mb3JtYXRpb24gPSBnZXRTZWxlY3Rpb25JbmZvcm1hdGlvbigpOwogICAgdmFyIGFjdGl2ZUluc3RhbmNlID0gbnVsbDsKCiAgICBzZXRFbmFibGVkKGZhbHNlKTsKICAgIHJldHVybiBhY3RpdmVJbnN0YW5jZTsKICB9CiAgZnVuY3Rpb24gcmVzZXRBZnRlckNvbW1pdChjb250YWluZXJJbmZvKSB7CiAgICByZXN0b3JlU2VsZWN0aW9uKHNlbGVjdGlvbkluZm9ybWF0aW9uKTsKICAgIHNldEVuYWJsZWQoZXZlbnRzRW5hYmxlZCk7CiAgICBldmVudHNFbmFibGVkID0gbnVsbDsKICAgIHNlbGVjdGlvbkluZm9ybWF0aW9uID0gbnVsbDsKICB9CiAgZnVuY3Rpb24gY3JlYXRlSW5zdGFuY2UodHlwZSwgcHJvcHMsIHJvb3RDb250YWluZXJJbnN0YW5jZSwgaG9zdENvbnRleHQsIGludGVybmFsSW5zdGFuY2VIYW5kbGUpIHsKICAgIHZhciBwYXJlbnROYW1lc3BhY2U7CgogICAgewogICAgICAvLyBUT0RPOiB0YWtlIG5hbWVzcGFjZSBpbnRvIGFjY291bnQgd2hlbiB2YWxpZGF0aW5nLgogICAgICB2YXIgaG9zdENvbnRleHREZXYgPSBob3N0Q29udGV4dDsKICAgICAgdmFsaWRhdGVET01OZXN0aW5nKHR5cGUsIG51bGwsIGhvc3RDb250ZXh0RGV2LmFuY2VzdG9ySW5mbyk7CgogICAgICBpZiAodHlwZW9mIHByb3BzLmNoaWxkcmVuID09PSAnc3RyaW5nJyB8fCB0eXBlb2YgcHJvcHMuY2hpbGRyZW4gPT09ICdudW1iZXInKSB7CiAgICAgICAgdmFyIHN0cmluZyA9ICcnICsgcHJvcHMuY2hpbGRyZW47CiAgICAgICAgdmFyIG93bkFuY2VzdG9ySW5mbyA9IHVwZGF0ZWRBbmNlc3RvckluZm8oaG9zdENvbnRleHREZXYuYW5jZXN0b3JJbmZvLCB0eXBlKTsKICAgICAgICB2YWxpZGF0ZURPTU5lc3RpbmcobnVsbCwgc3RyaW5nLCBvd25BbmNlc3RvckluZm8pOwogICAgICB9CgogICAgICBwYXJlbnROYW1lc3BhY2UgPSBob3N0Q29udGV4dERldi5uYW1lc3BhY2U7CiAgICB9CgogICAgdmFyIGRvbUVsZW1lbnQgPSBjcmVhdGVFbGVtZW50KHR5cGUsIHByb3BzLCByb290Q29udGFpbmVySW5zdGFuY2UsIHBhcmVudE5hbWVzcGFjZSk7CiAgICBwcmVjYWNoZUZpYmVyTm9kZShpbnRlcm5hbEluc3RhbmNlSGFuZGxlLCBkb21FbGVtZW50KTsKICAgIHVwZGF0ZUZpYmVyUHJvcHMoZG9tRWxlbWVudCwgcHJvcHMpOwogICAgcmV0dXJuIGRvbUVsZW1lbnQ7CiAgfQogIGZ1bmN0aW9uIGFwcGVuZEluaXRpYWxDaGlsZChwYXJlbnRJbnN0YW5jZSwgY2hpbGQpIHsKICAgIHBhcmVudEluc3RhbmNlLmFwcGVuZENoaWxkKGNoaWxkKTsKICB9CiAgZnVuY3Rpb24gZmluYWxpemVJbml0aWFsQ2hpbGRyZW4oZG9tRWxlbWVudCwgdHlwZSwgcHJvcHMsIHJvb3RDb250YWluZXJJbnN0YW5jZSwgaG9zdENvbnRleHQpIHsKICAgIHNldEluaXRpYWxQcm9wZXJ0aWVzKGRvbUVsZW1lbnQsIHR5cGUsIHByb3BzLCByb290Q29udGFpbmVySW5zdGFuY2UpOwoKICAgIHN3aXRjaCAodHlwZSkgewogICAgICBjYXNlICdidXR0b24nOgogICAgICBjYXNlICdpbnB1dCc6CiAgICAgIGNhc2UgJ3NlbGVjdCc6CiAgICAgIGNhc2UgJ3RleHRhcmVhJzoKICAgICAgICByZXR1cm4gISFwcm9wcy5hdXRvRm9jdXM7CgogICAgICBjYXNlICdpbWcnOgogICAgICAgIHJldHVybiB0cnVlOwoKICAgICAgZGVmYXVsdDoKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHByZXBhcmVVcGRhdGUoZG9tRWxlbWVudCwgdHlwZSwgb2xkUHJvcHMsIG5ld1Byb3BzLCByb290Q29udGFpbmVySW5zdGFuY2UsIGhvc3RDb250ZXh0KSB7CiAgICB7CiAgICAgIHZhciBob3N0Q29udGV4dERldiA9IGhvc3RDb250ZXh0OwoKICAgICAgaWYgKHR5cGVvZiBuZXdQcm9wcy5jaGlsZHJlbiAhPT0gdHlwZW9mIG9sZFByb3BzLmNoaWxkcmVuICYmICh0eXBlb2YgbmV3UHJvcHMuY2hpbGRyZW4gPT09ICdzdHJpbmcnIHx8IHR5cGVvZiBuZXdQcm9wcy5jaGlsZHJlbiA9PT0gJ251bWJlcicpKSB7CiAgICAgICAgdmFyIHN0cmluZyA9ICcnICsgbmV3UHJvcHMuY2hpbGRyZW47CiAgICAgICAgdmFyIG93bkFuY2VzdG9ySW5mbyA9IHVwZGF0ZWRBbmNlc3RvckluZm8oaG9zdENvbnRleHREZXYuYW5jZXN0b3JJbmZvLCB0eXBlKTsKICAgICAgICB2YWxpZGF0ZURPTU5lc3RpbmcobnVsbCwgc3RyaW5nLCBvd25BbmNlc3RvckluZm8pOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIGRpZmZQcm9wZXJ0aWVzKGRvbUVsZW1lbnQsIHR5cGUsIG9sZFByb3BzLCBuZXdQcm9wcyk7CiAgfQogIGZ1bmN0aW9uIHNob3VsZFNldFRleHRDb250ZW50KHR5cGUsIHByb3BzKSB7CiAgICByZXR1cm4gdHlwZSA9PT0gJ3RleHRhcmVhJyB8fCB0eXBlID09PSAnbm9zY3JpcHQnIHx8IHR5cGVvZiBwcm9wcy5jaGlsZHJlbiA9PT0gJ3N0cmluZycgfHwgdHlwZW9mIHByb3BzLmNoaWxkcmVuID09PSAnbnVtYmVyJyB8fCB0eXBlb2YgcHJvcHMuZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUwgPT09ICdvYmplY3QnICYmIHByb3BzLmRhbmdlcm91c2x5U2V0SW5uZXJIVE1MICE9PSBudWxsICYmIHByb3BzLmRhbmdlcm91c2x5U2V0SW5uZXJIVE1MLl9faHRtbCAhPSBudWxsOwogIH0KICBmdW5jdGlvbiBjcmVhdGVUZXh0SW5zdGFuY2UodGV4dCwgcm9vdENvbnRhaW5lckluc3RhbmNlLCBob3N0Q29udGV4dCwgaW50ZXJuYWxJbnN0YW5jZUhhbmRsZSkgewogICAgewogICAgICB2YXIgaG9zdENvbnRleHREZXYgPSBob3N0Q29udGV4dDsKICAgICAgdmFsaWRhdGVET01OZXN0aW5nKG51bGwsIHRleHQsIGhvc3RDb250ZXh0RGV2LmFuY2VzdG9ySW5mbyk7CiAgICB9CgogICAgdmFyIHRleHROb2RlID0gY3JlYXRlVGV4dE5vZGUodGV4dCwgcm9vdENvbnRhaW5lckluc3RhbmNlKTsKICAgIHByZWNhY2hlRmliZXJOb2RlKGludGVybmFsSW5zdGFuY2VIYW5kbGUsIHRleHROb2RlKTsKICAgIHJldHVybiB0ZXh0Tm9kZTsKICB9CiAgZnVuY3Rpb24gZ2V0Q3VycmVudEV2ZW50UHJpb3JpdHkoKSB7CiAgICB2YXIgY3VycmVudEV2ZW50ID0gd2luZG93LmV2ZW50OwoKICAgIGlmIChjdXJyZW50RXZlbnQgPT09IHVuZGVmaW5lZCkgewogICAgICByZXR1cm4gRGVmYXVsdEV2ZW50UHJpb3JpdHk7CiAgICB9CgogICAgcmV0dXJuIGdldEV2ZW50UHJpb3JpdHkoY3VycmVudEV2ZW50LnR5cGUpOwogIH0KICAvLyBpZiBhIGNvbXBvbmVudCBqdXN0IGltcG9ydHMgUmVhY3RET00gKGUuZy4gZm9yIGZpbmRET01Ob2RlKS4KICAvLyBTb21lIGVudmlyb25tZW50cyBtaWdodCBub3QgaGF2ZSBzZXRUaW1lb3V0IG9yIGNsZWFyVGltZW91dC4KCiAgdmFyIHNjaGVkdWxlVGltZW91dCA9IHR5cGVvZiBzZXRUaW1lb3V0ID09PSAnZnVuY3Rpb24nID8gc2V0VGltZW91dCA6IHVuZGVmaW5lZDsKICB2YXIgY2FuY2VsVGltZW91dCA9IHR5cGVvZiBjbGVhclRpbWVvdXQgPT09ICdmdW5jdGlvbicgPyBjbGVhclRpbWVvdXQgOiB1bmRlZmluZWQ7CiAgdmFyIG5vVGltZW91dCA9IC0xOwogIHZhciBsb2NhbFByb21pc2UgPSB0eXBlb2YgUHJvbWlzZSA9PT0gJ2Z1bmN0aW9uJyA/IFByb21pc2UgOiB1bmRlZmluZWQ7IC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0KICB2YXIgc2NoZWR1bGVNaWNyb3Rhc2sgPSB0eXBlb2YgcXVldWVNaWNyb3Rhc2sgPT09ICdmdW5jdGlvbicgPyBxdWV1ZU1pY3JvdGFzayA6IHR5cGVvZiBsb2NhbFByb21pc2UgIT09ICd1bmRlZmluZWQnID8gZnVuY3Rpb24gKGNhbGxiYWNrKSB7CiAgICByZXR1cm4gbG9jYWxQcm9taXNlLnJlc29sdmUobnVsbCkudGhlbihjYWxsYmFjaykuY2F0Y2goaGFuZGxlRXJyb3JJbk5leHRUaWNrKTsKICB9IDogc2NoZWR1bGVUaW1lb3V0OyAvLyBUT0RPOiBEZXRlcm1pbmUgdGhlIGJlc3QgZmFsbGJhY2sgaGVyZS4KCiAgZnVuY3Rpb24gaGFuZGxlRXJyb3JJbk5leHRUaWNrKGVycm9yKSB7CiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgdGhyb3cgZXJyb3I7CiAgICB9KTsKICB9IC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0KICBmdW5jdGlvbiBjb21taXRNb3VudChkb21FbGVtZW50LCB0eXBlLCBuZXdQcm9wcywgaW50ZXJuYWxJbnN0YW5jZUhhbmRsZSkgewogICAgLy8gRGVzcGl0ZSB0aGUgbmFtaW5nIHRoYXQgbWlnaHQgaW1wbHkgb3RoZXJ3aXNlLCB0aGlzIG1ldGhvZCBvbmx5CiAgICAvLyBmaXJlcyBpZiB0aGVyZSBpcyBhbiBgVXBkYXRlYCBlZmZlY3Qgc2NoZWR1bGVkIGR1cmluZyBtb3VudGluZy4KICAgIC8vIFRoaXMgaGFwcGVucyBpZiBgZmluYWxpemVJbml0aWFsQ2hpbGRyZW5gIHJldHVybnMgYHRydWVgICh3aGljaCBpdAogICAgLy8gZG9lcyB0byBpbXBsZW1lbnQgdGhlIGBhdXRvRm9jdXNgIGF0dHJpYnV0ZSBvbiB0aGUgY2xpZW50KS4gQnV0CiAgICAvLyB0aGVyZSBhcmUgYWxzbyBvdGhlciBjYXNlcyB3aGVuIHRoaXMgbWlnaHQgaGFwcGVuIChzdWNoIGFzIHBhdGNoaW5nCiAgICAvLyB1cCB0ZXh0IGNvbnRlbnQgZHVyaW5nIGh5ZHJhdGlvbiBtaXNtYXRjaCkuIFNvIHdlJ2xsIGNoZWNrIHRoaXMgYWdhaW4uCiAgICBzd2l0Y2ggKHR5cGUpIHsKICAgICAgY2FzZSAnYnV0dG9uJzoKICAgICAgY2FzZSAnaW5wdXQnOgogICAgICBjYXNlICdzZWxlY3QnOgogICAgICBjYXNlICd0ZXh0YXJlYSc6CiAgICAgICAgaWYgKG5ld1Byb3BzLmF1dG9Gb2N1cykgewogICAgICAgICAgZG9tRWxlbWVudC5mb2N1cygpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuOwoKICAgICAgY2FzZSAnaW1nJzoKICAgICAgICB7CiAgICAgICAgICBpZiAobmV3UHJvcHMuc3JjKSB7CiAgICAgICAgICAgIGRvbUVsZW1lbnQuc3JjID0gbmV3UHJvcHMuc3JjOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICB9CiAgfQogIGZ1bmN0aW9uIGNvbW1pdFVwZGF0ZShkb21FbGVtZW50LCB1cGRhdGVQYXlsb2FkLCB0eXBlLCBvbGRQcm9wcywgbmV3UHJvcHMsIGludGVybmFsSW5zdGFuY2VIYW5kbGUpIHsKICAgIC8vIEFwcGx5IHRoZSBkaWZmIHRvIHRoZSBET00gbm9kZS4KICAgIHVwZGF0ZVByb3BlcnRpZXMoZG9tRWxlbWVudCwgdXBkYXRlUGF5bG9hZCwgdHlwZSwgb2xkUHJvcHMsIG5ld1Byb3BzKTsgLy8gVXBkYXRlIHRoZSBwcm9wcyBoYW5kbGUgc28gdGhhdCB3ZSBrbm93IHdoaWNoIHByb3BzIGFyZSB0aGUgb25lcyB3aXRoCiAgICAvLyB3aXRoIGN1cnJlbnQgZXZlbnQgaGFuZGxlcnMuCgogICAgdXBkYXRlRmliZXJQcm9wcyhkb21FbGVtZW50LCBuZXdQcm9wcyk7CiAgfQogIGZ1bmN0aW9uIHJlc2V0VGV4dENvbnRlbnQoZG9tRWxlbWVudCkgewogICAgc2V0VGV4dENvbnRlbnQoZG9tRWxlbWVudCwgJycpOwogIH0KICBmdW5jdGlvbiBjb21taXRUZXh0VXBkYXRlKHRleHRJbnN0YW5jZSwgb2xkVGV4dCwgbmV3VGV4dCkgewogICAgdGV4dEluc3RhbmNlLm5vZGVWYWx1ZSA9IG5ld1RleHQ7CiAgfQogIGZ1bmN0aW9uIGFwcGVuZENoaWxkKHBhcmVudEluc3RhbmNlLCBjaGlsZCkgewogICAgcGFyZW50SW5zdGFuY2UuYXBwZW5kQ2hpbGQoY2hpbGQpOwogIH0KICBmdW5jdGlvbiBhcHBlbmRDaGlsZFRvQ29udGFpbmVyKGNvbnRhaW5lciwgY2hpbGQpIHsKICAgIHZhciBwYXJlbnROb2RlOwoKICAgIGlmIChjb250YWluZXIubm9kZVR5cGUgPT09IENPTU1FTlRfTk9ERSkgewogICAgICBwYXJlbnROb2RlID0gY29udGFpbmVyLnBhcmVudE5vZGU7CiAgICAgIHBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGNoaWxkLCBjb250YWluZXIpOwogICAgfSBlbHNlIHsKICAgICAgcGFyZW50Tm9kZSA9IGNvbnRhaW5lcjsKICAgICAgcGFyZW50Tm9kZS5hcHBlbmRDaGlsZChjaGlsZCk7CiAgICB9IC8vIFRoaXMgY29udGFpbmVyIG1pZ2h0IGJlIHVzZWQgZm9yIGEgcG9ydGFsLgogICAgLy8gSWYgc29tZXRoaW5nIGluc2lkZSBhIHBvcnRhbCBpcyBjbGlja2VkLCB0aGF0IGNsaWNrIHNob3VsZCBidWJibGUKICAgIC8vIHRocm91Z2ggdGhlIFJlYWN0IHRyZWUuIEhvd2V2ZXIsIG9uIE1vYmlsZSBTYWZhcmkgdGhlIGNsaWNrIHdvdWxkCiAgICAvLyBuZXZlciBidWJibGUgdGhyb3VnaCB0aGUgKkRPTSogdHJlZSB1bmxlc3MgYW4gYW5jZXN0b3Igd2l0aCBvbmNsaWNrCiAgICAvLyBldmVudCBleGlzdHMuIFNvIHdlIHdvdWxkbid0IHNlZSBpdCBhbmQgZGlzcGF0Y2ggaXQuCiAgICAvLyBUaGlzIGlzIHdoeSB3ZSBlbnN1cmUgdGhhdCBub24gUmVhY3Qgcm9vdCBjb250YWluZXJzIGhhdmUgaW5saW5lIG9uY2xpY2sKICAgIC8vIGRlZmluZWQuCiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2svcmVhY3QvaXNzdWVzLzExOTE4CgoKICAgIHZhciByZWFjdFJvb3RDb250YWluZXIgPSBjb250YWluZXIuX3JlYWN0Um9vdENvbnRhaW5lcjsKCiAgICBpZiAoKHJlYWN0Um9vdENvbnRhaW5lciA9PT0gbnVsbCB8fCByZWFjdFJvb3RDb250YWluZXIgPT09IHVuZGVmaW5lZCkgJiYgcGFyZW50Tm9kZS5vbmNsaWNrID09PSBudWxsKSB7CiAgICAgIC8vIFRPRE86IFRoaXMgY2FzdCBtYXkgbm90IGJlIHNvdW5kIGZvciBTVkcsIE1hdGhNTCBvciBjdXN0b20gZWxlbWVudHMuCiAgICAgIHRyYXBDbGlja09uTm9uSW50ZXJhY3RpdmVFbGVtZW50KHBhcmVudE5vZGUpOwogICAgfQogIH0KICBmdW5jdGlvbiBpbnNlcnRCZWZvcmUocGFyZW50SW5zdGFuY2UsIGNoaWxkLCBiZWZvcmVDaGlsZCkgewogICAgcGFyZW50SW5zdGFuY2UuaW5zZXJ0QmVmb3JlKGNoaWxkLCBiZWZvcmVDaGlsZCk7CiAgfQogIGZ1bmN0aW9uIGluc2VydEluQ29udGFpbmVyQmVmb3JlKGNvbnRhaW5lciwgY2hpbGQsIGJlZm9yZUNoaWxkKSB7CiAgICBpZiAoY29udGFpbmVyLm5vZGVUeXBlID09PSBDT01NRU5UX05PREUpIHsKICAgICAgY29udGFpbmVyLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGNoaWxkLCBiZWZvcmVDaGlsZCk7CiAgICB9IGVsc2UgewogICAgICBjb250YWluZXIuaW5zZXJ0QmVmb3JlKGNoaWxkLCBiZWZvcmVDaGlsZCk7CiAgICB9CiAgfQoKICBmdW5jdGlvbiByZW1vdmVDaGlsZChwYXJlbnRJbnN0YW5jZSwgY2hpbGQpIHsKICAgIHBhcmVudEluc3RhbmNlLnJlbW92ZUNoaWxkKGNoaWxkKTsKICB9CiAgZnVuY3Rpb24gcmVtb3ZlQ2hpbGRGcm9tQ29udGFpbmVyKGNvbnRhaW5lciwgY2hpbGQpIHsKICAgIGlmIChjb250YWluZXIubm9kZVR5cGUgPT09IENPTU1FTlRfTk9ERSkgewogICAgICBjb250YWluZXIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChjaGlsZCk7CiAgICB9IGVsc2UgewogICAgICBjb250YWluZXIucmVtb3ZlQ2hpbGQoY2hpbGQpOwogICAgfQogIH0KICBmdW5jdGlvbiBjbGVhclN1c3BlbnNlQm91bmRhcnkocGFyZW50SW5zdGFuY2UsIHN1c3BlbnNlSW5zdGFuY2UpIHsKICAgIHZhciBub2RlID0gc3VzcGVuc2VJbnN0YW5jZTsgLy8gRGVsZXRlIGFsbCBub2RlcyB3aXRoaW4gdGhpcyBzdXNwZW5zZSBib3VuZGFyeS4KICAgIC8vIFRoZXJlIG1pZ2h0IGJlIG5lc3RlZCBub2RlcyBzbyB3ZSBuZWVkIHRvIGtlZXAgdHJhY2sgb2YgaG93CiAgICAvLyBkZWVwIHdlIGFyZSBhbmQgb25seSBicmVhayBvdXQgd2hlbiB3ZSdyZSBiYWNrIG9uIHRvcC4KCiAgICB2YXIgZGVwdGggPSAwOwoKICAgIGRvIHsKICAgICAgdmFyIG5leHROb2RlID0gbm9kZS5uZXh0U2libGluZzsKICAgICAgcGFyZW50SW5zdGFuY2UucmVtb3ZlQ2hpbGQobm9kZSk7CgogICAgICBpZiAobmV4dE5vZGUgJiYgbmV4dE5vZGUubm9kZVR5cGUgPT09IENPTU1FTlRfTk9ERSkgewogICAgICAgIHZhciBkYXRhID0gbmV4dE5vZGUuZGF0YTsKCiAgICAgICAgaWYgKGRhdGEgPT09IFNVU1BFTlNFX0VORF9EQVRBKSB7CiAgICAgICAgICBpZiAoZGVwdGggPT09IDApIHsKICAgICAgICAgICAgcGFyZW50SW5zdGFuY2UucmVtb3ZlQ2hpbGQobmV4dE5vZGUpOyAvLyBSZXRyeSBpZiBhbnkgZXZlbnQgcmVwbGF5aW5nIHdhcyBibG9ja2VkIG9uIHRoaXMuCgogICAgICAgICAgICByZXRyeUlmQmxvY2tlZE9uKHN1c3BlbnNlSW5zdGFuY2UpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBkZXB0aC0tOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoZGF0YSA9PT0gU1VTUEVOU0VfU1RBUlRfREFUQSB8fCBkYXRhID09PSBTVVNQRU5TRV9QRU5ESU5HX1NUQVJUX0RBVEEgfHwgZGF0YSA9PT0gU1VTUEVOU0VfRkFMTEJBQ0tfU1RBUlRfREFUQSkgewogICAgICAgICAgZGVwdGgrKzsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIG5vZGUgPSBuZXh0Tm9kZTsKICAgIH0gd2hpbGUgKG5vZGUpOyAvLyBUT0RPOiBXYXJuLCB3ZSBkaWRuJ3QgZmluZCB0aGUgZW5kIGNvbW1lbnQgYm91bmRhcnkuCiAgICAvLyBSZXRyeSBpZiBhbnkgZXZlbnQgcmVwbGF5aW5nIHdhcyBibG9ja2VkIG9uIHRoaXMuCgoKICAgIHJldHJ5SWZCbG9ja2VkT24oc3VzcGVuc2VJbnN0YW5jZSk7CiAgfQogIGZ1bmN0aW9uIGNsZWFyU3VzcGVuc2VCb3VuZGFyeUZyb21Db250YWluZXIoY29udGFpbmVyLCBzdXNwZW5zZUluc3RhbmNlKSB7CiAgICBpZiAoY29udGFpbmVyLm5vZGVUeXBlID09PSBDT01NRU5UX05PREUpIHsKICAgICAgY2xlYXJTdXNwZW5zZUJvdW5kYXJ5KGNvbnRhaW5lci5wYXJlbnROb2RlLCBzdXNwZW5zZUluc3RhbmNlKTsKICAgIH0gZWxzZSBpZiAoY29udGFpbmVyLm5vZGVUeXBlID09PSBFTEVNRU5UX05PREUpIHsKICAgICAgY2xlYXJTdXNwZW5zZUJvdW5kYXJ5KGNvbnRhaW5lciwgc3VzcGVuc2VJbnN0YW5jZSk7CiAgICB9IC8vIFJldHJ5IGlmIGFueSBldmVudCByZXBsYXlpbmcgd2FzIGJsb2NrZWQgb24gdGhpcy4KCgogICAgcmV0cnlJZkJsb2NrZWRPbihjb250YWluZXIpOwogIH0KICBmdW5jdGlvbiBoaWRlSW5zdGFuY2UoaW5zdGFuY2UpIHsKICAgIC8vIFRPRE86IERvZXMgdGhpcyB3b3JrIGZvciBhbGwgZWxlbWVudCB0eXBlcz8gV2hhdCBhYm91dCBNYXRoTUw/IFNob3VsZCB3ZQogICAgLy8gcGFzcyBob3N0IGNvbnRleHQgdG8gdGhpcyBtZXRob2Q/CiAgICBpbnN0YW5jZSA9IGluc3RhbmNlOwogICAgdmFyIHN0eWxlID0gaW5zdGFuY2Uuc3R5bGU7CgogICAgaWYgKHR5cGVvZiBzdHlsZS5zZXRQcm9wZXJ0eSA9PT0gJ2Z1bmN0aW9uJykgewogICAgICBzdHlsZS5zZXRQcm9wZXJ0eSgnZGlzcGxheScsICdub25lJywgJ2ltcG9ydGFudCcpOwogICAgfSBlbHNlIHsKICAgICAgc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgIH0KICB9CiAgZnVuY3Rpb24gaGlkZVRleHRJbnN0YW5jZSh0ZXh0SW5zdGFuY2UpIHsKICAgIHRleHRJbnN0YW5jZS5ub2RlVmFsdWUgPSAnJzsKICB9CiAgZnVuY3Rpb24gdW5oaWRlSW5zdGFuY2UoaW5zdGFuY2UsIHByb3BzKSB7CiAgICBpbnN0YW5jZSA9IGluc3RhbmNlOwogICAgdmFyIHN0eWxlUHJvcCA9IHByb3BzW1NUWUxFJDFdOwogICAgdmFyIGRpc3BsYXkgPSBzdHlsZVByb3AgIT09IHVuZGVmaW5lZCAmJiBzdHlsZVByb3AgIT09IG51bGwgJiYgc3R5bGVQcm9wLmhhc093blByb3BlcnR5KCdkaXNwbGF5JykgPyBzdHlsZVByb3AuZGlzcGxheSA6IG51bGw7CiAgICBpbnN0YW5jZS5zdHlsZS5kaXNwbGF5ID0gZGFuZ2Vyb3VzU3R5bGVWYWx1ZSgnZGlzcGxheScsIGRpc3BsYXkpOwogIH0KICBmdW5jdGlvbiB1bmhpZGVUZXh0SW5zdGFuY2UodGV4dEluc3RhbmNlLCB0ZXh0KSB7CiAgICB0ZXh0SW5zdGFuY2Uubm9kZVZhbHVlID0gdGV4dDsKICB9CiAgZnVuY3Rpb24gY2xlYXJDb250YWluZXIoY29udGFpbmVyKSB7CiAgICBpZiAoY29udGFpbmVyLm5vZGVUeXBlID09PSBFTEVNRU5UX05PREUpIHsKICAgICAgY29udGFpbmVyLnRleHRDb250ZW50ID0gJyc7CiAgICB9IGVsc2UgaWYgKGNvbnRhaW5lci5ub2RlVHlwZSA9PT0gRE9DVU1FTlRfTk9ERSkgewogICAgICBpZiAoY29udGFpbmVyLmRvY3VtZW50RWxlbWVudCkgewogICAgICAgIGNvbnRhaW5lci5yZW1vdmVDaGlsZChjb250YWluZXIuZG9jdW1lbnRFbGVtZW50KTsKICAgICAgfQogICAgfQogIH0gLy8gLS0tLS0tLS0tLS0tLS0tLS0tLQogIGZ1bmN0aW9uIGNhbkh5ZHJhdGVJbnN0YW5jZShpbnN0YW5jZSwgdHlwZSwgcHJvcHMpIHsKICAgIGlmIChpbnN0YW5jZS5ub2RlVHlwZSAhPT0gRUxFTUVOVF9OT0RFIHx8IHR5cGUudG9Mb3dlckNhc2UoKSAhPT0gaW5zdGFuY2Uubm9kZU5hbWUudG9Mb3dlckNhc2UoKSkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0gLy8gVGhpcyBoYXMgbm93IGJlZW4gcmVmaW5lZCB0byBhbiBlbGVtZW50IG5vZGUuCgoKICAgIHJldHVybiBpbnN0YW5jZTsKICB9CiAgZnVuY3Rpb24gY2FuSHlkcmF0ZVRleHRJbnN0YW5jZShpbnN0YW5jZSwgdGV4dCkgewogICAgaWYgKHRleHQgPT09ICcnIHx8IGluc3RhbmNlLm5vZGVUeXBlICE9PSBURVhUX05PREUpIHsKICAgICAgLy8gRW1wdHkgc3RyaW5ncyBhcmUgbm90IHBhcnNlZCBieSBIVE1MIHNvIHRoZXJlIHdvbid0IGJlIGEgY29ycmVjdCBtYXRjaCBoZXJlLgogICAgICByZXR1cm4gbnVsbDsKICAgIH0gLy8gVGhpcyBoYXMgbm93IGJlZW4gcmVmaW5lZCB0byBhIHRleHQgbm9kZS4KCgogICAgcmV0dXJuIGluc3RhbmNlOwogIH0KICBmdW5jdGlvbiBjYW5IeWRyYXRlU3VzcGVuc2VJbnN0YW5jZShpbnN0YW5jZSkgewogICAgaWYgKGluc3RhbmNlLm5vZGVUeXBlICE9PSBDT01NRU5UX05PREUpIHsKICAgICAgLy8gRW1wdHkgc3RyaW5ncyBhcmUgbm90IHBhcnNlZCBieSBIVE1MIHNvIHRoZXJlIHdvbid0IGJlIGEgY29ycmVjdCBtYXRjaCBoZXJlLgogICAgICByZXR1cm4gbnVsbDsKICAgIH0gLy8gVGhpcyBoYXMgbm93IGJlZW4gcmVmaW5lZCB0byBhIHN1c3BlbnNlIG5vZGUuCgoKICAgIHJldHVybiBpbnN0YW5jZTsKICB9CiAgZnVuY3Rpb24gaXNTdXNwZW5zZUluc3RhbmNlUGVuZGluZyhpbnN0YW5jZSkgewogICAgcmV0dXJuIGluc3RhbmNlLmRhdGEgPT09IFNVU1BFTlNFX1BFTkRJTkdfU1RBUlRfREFUQTsKICB9CiAgZnVuY3Rpb24gaXNTdXNwZW5zZUluc3RhbmNlRmFsbGJhY2soaW5zdGFuY2UpIHsKICAgIHJldHVybiBpbnN0YW5jZS5kYXRhID09PSBTVVNQRU5TRV9GQUxMQkFDS19TVEFSVF9EQVRBOwogIH0KICBmdW5jdGlvbiBnZXRTdXNwZW5zZUluc3RhbmNlRmFsbGJhY2tFcnJvckRldGFpbHMoaW5zdGFuY2UpIHsKICAgIHZhciBkYXRhc2V0ID0gaW5zdGFuY2UubmV4dFNpYmxpbmcgJiYgaW5zdGFuY2UubmV4dFNpYmxpbmcuZGF0YXNldDsKICAgIHZhciBkaWdlc3QsIG1lc3NhZ2UsIHN0YWNrOwoKICAgIGlmIChkYXRhc2V0KSB7CiAgICAgIGRpZ2VzdCA9IGRhdGFzZXQuZGdzdDsKCiAgICAgIHsKICAgICAgICBtZXNzYWdlID0gZGF0YXNldC5tc2c7CiAgICAgICAgc3RhY2sgPSBkYXRhc2V0LnN0Y2s7CiAgICAgIH0KICAgIH0KCiAgICB7CiAgICAgIHJldHVybiB7CiAgICAgICAgbWVzc2FnZTogbWVzc2FnZSwKICAgICAgICBkaWdlc3Q6IGRpZ2VzdCwKICAgICAgICBzdGFjazogc3RhY2sKICAgICAgfTsKICAgIH0gLy8gbGV0IHZhbHVlID0ge21lc3NhZ2U6IHVuZGVmaW5lZCwgaGFzaDogdW5kZWZpbmVkfTsKICAgIC8vIGNvbnN0IG5leHRTaWJsaW5nID0gaW5zdGFuY2UubmV4dFNpYmxpbmc7CiAgICAvLyBpZiAobmV4dFNpYmxpbmcpIHsKICAgIC8vICAgY29uc3QgZGF0YXNldCA9ICgobmV4dFNpYmxpbmc6IGFueSk6IEhUTUxUZW1wbGF0ZUVsZW1lbnQpLmRhdGFzZXQ7CiAgICAvLyAgIHZhbHVlLm1lc3NhZ2UgPSBkYXRhc2V0Lm1zZzsKICAgIC8vICAgdmFsdWUuaGFzaCA9IGRhdGFzZXQuaGFzaDsKICAgIC8vICAgaWYgKHRydWUpIHsKICAgIC8vICAgICB2YWx1ZS5zdGFjayA9IGRhdGFzZXQuc3RhY2s7CiAgICAvLyAgIH0KICAgIC8vIH0KICAgIC8vIHJldHVybiB2YWx1ZTsKCiAgfQogIGZ1bmN0aW9uIHJlZ2lzdGVyU3VzcGVuc2VJbnN0YW5jZVJldHJ5KGluc3RhbmNlLCBjYWxsYmFjaykgewogICAgaW5zdGFuY2UuX3JlYWN0UmV0cnkgPSBjYWxsYmFjazsKICB9CgogIGZ1bmN0aW9uIGdldE5leHRIeWRyYXRhYmxlKG5vZGUpIHsKICAgIC8vIFNraXAgbm9uLWh5ZHJhdGFibGUgbm9kZXMuCiAgICBmb3IgKDsgbm9kZSAhPSBudWxsOyBub2RlID0gbm9kZS5uZXh0U2libGluZykgewogICAgICB2YXIgbm9kZVR5cGUgPSBub2RlLm5vZGVUeXBlOwoKICAgICAgaWYgKG5vZGVUeXBlID09PSBFTEVNRU5UX05PREUgfHwgbm9kZVR5cGUgPT09IFRFWFRfTk9ERSkgewogICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICBpZiAobm9kZVR5cGUgPT09IENPTU1FTlRfTk9ERSkgewogICAgICAgIHZhciBub2RlRGF0YSA9IG5vZGUuZGF0YTsKCiAgICAgICAgaWYgKG5vZGVEYXRhID09PSBTVVNQRU5TRV9TVEFSVF9EQVRBIHx8IG5vZGVEYXRhID09PSBTVVNQRU5TRV9GQUxMQkFDS19TVEFSVF9EQVRBIHx8IG5vZGVEYXRhID09PSBTVVNQRU5TRV9QRU5ESU5HX1NUQVJUX0RBVEEpIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgaWYgKG5vZGVEYXRhID09PSBTVVNQRU5TRV9FTkRfREFUQSkgewogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgcmV0dXJuIG5vZGU7CiAgfQoKICBmdW5jdGlvbiBnZXROZXh0SHlkcmF0YWJsZVNpYmxpbmcoaW5zdGFuY2UpIHsKICAgIHJldHVybiBnZXROZXh0SHlkcmF0YWJsZShpbnN0YW5jZS5uZXh0U2libGluZyk7CiAgfQogIGZ1bmN0aW9uIGdldEZpcnN0SHlkcmF0YWJsZUNoaWxkKHBhcmVudEluc3RhbmNlKSB7CiAgICByZXR1cm4gZ2V0TmV4dEh5ZHJhdGFibGUocGFyZW50SW5zdGFuY2UuZmlyc3RDaGlsZCk7CiAgfQogIGZ1bmN0aW9uIGdldEZpcnN0SHlkcmF0YWJsZUNoaWxkV2l0aGluQ29udGFpbmVyKHBhcmVudENvbnRhaW5lcikgewogICAgcmV0dXJuIGdldE5leHRIeWRyYXRhYmxlKHBhcmVudENvbnRhaW5lci5maXJzdENoaWxkKTsKICB9CiAgZnVuY3Rpb24gZ2V0Rmlyc3RIeWRyYXRhYmxlQ2hpbGRXaXRoaW5TdXNwZW5zZUluc3RhbmNlKHBhcmVudEluc3RhbmNlKSB7CiAgICByZXR1cm4gZ2V0TmV4dEh5ZHJhdGFibGUocGFyZW50SW5zdGFuY2UubmV4dFNpYmxpbmcpOwogIH0KICBmdW5jdGlvbiBoeWRyYXRlSW5zdGFuY2UoaW5zdGFuY2UsIHR5cGUsIHByb3BzLCByb290Q29udGFpbmVySW5zdGFuY2UsIGhvc3RDb250ZXh0LCBpbnRlcm5hbEluc3RhbmNlSGFuZGxlLCBzaG91bGRXYXJuRGV2KSB7CiAgICBwcmVjYWNoZUZpYmVyTm9kZShpbnRlcm5hbEluc3RhbmNlSGFuZGxlLCBpbnN0YW5jZSk7IC8vIFRPRE86IFBvc3NpYmx5IGRlZmVyIHRoaXMgdW50aWwgdGhlIGNvbW1pdCBwaGFzZSB3aGVyZSBhbGwgdGhlIGV2ZW50cwogICAgLy8gZ2V0IGF0dGFjaGVkLgoKICAgIHVwZGF0ZUZpYmVyUHJvcHMoaW5zdGFuY2UsIHByb3BzKTsKICAgIHZhciBwYXJlbnROYW1lc3BhY2U7CgogICAgewogICAgICB2YXIgaG9zdENvbnRleHREZXYgPSBob3N0Q29udGV4dDsKICAgICAgcGFyZW50TmFtZXNwYWNlID0gaG9zdENvbnRleHREZXYubmFtZXNwYWNlOwogICAgfSAvLyBUT0RPOiBUZW1wb3JhcnkgaGFjayB0byBjaGVjayBpZiB3ZSdyZSBpbiBhIGNvbmN1cnJlbnQgcm9vdC4gV2UgY2FuIGRlbGV0ZQogICAgLy8gd2hlbiB0aGUgbGVnYWN5IHJvb3QgQVBJIGlzIHJlbW92ZWQuCgoKICAgIHZhciBpc0NvbmN1cnJlbnRNb2RlID0gKGludGVybmFsSW5zdGFuY2VIYW5kbGUubW9kZSAmIENvbmN1cnJlbnRNb2RlKSAhPT0gTm9Nb2RlOwogICAgcmV0dXJuIGRpZmZIeWRyYXRlZFByb3BlcnRpZXMoaW5zdGFuY2UsIHR5cGUsIHByb3BzLCBwYXJlbnROYW1lc3BhY2UsIHJvb3RDb250YWluZXJJbnN0YW5jZSwgaXNDb25jdXJyZW50TW9kZSwgc2hvdWxkV2FybkRldik7CiAgfQogIGZ1bmN0aW9uIGh5ZHJhdGVUZXh0SW5zdGFuY2UodGV4dEluc3RhbmNlLCB0ZXh0LCBpbnRlcm5hbEluc3RhbmNlSGFuZGxlLCBzaG91bGRXYXJuRGV2KSB7CiAgICBwcmVjYWNoZUZpYmVyTm9kZShpbnRlcm5hbEluc3RhbmNlSGFuZGxlLCB0ZXh0SW5zdGFuY2UpOyAvLyBUT0RPOiBUZW1wb3JhcnkgaGFjayB0byBjaGVjayBpZiB3ZSdyZSBpbiBhIGNvbmN1cnJlbnQgcm9vdC4gV2UgY2FuIGRlbGV0ZQogICAgLy8gd2hlbiB0aGUgbGVnYWN5IHJvb3QgQVBJIGlzIHJlbW92ZWQuCgogICAgdmFyIGlzQ29uY3VycmVudE1vZGUgPSAoaW50ZXJuYWxJbnN0YW5jZUhhbmRsZS5tb2RlICYgQ29uY3VycmVudE1vZGUpICE9PSBOb01vZGU7CiAgICByZXR1cm4gZGlmZkh5ZHJhdGVkVGV4dCh0ZXh0SW5zdGFuY2UsIHRleHQpOwogIH0KICBmdW5jdGlvbiBoeWRyYXRlU3VzcGVuc2VJbnN0YW5jZShzdXNwZW5zZUluc3RhbmNlLCBpbnRlcm5hbEluc3RhbmNlSGFuZGxlKSB7CiAgICBwcmVjYWNoZUZpYmVyTm9kZShpbnRlcm5hbEluc3RhbmNlSGFuZGxlLCBzdXNwZW5zZUluc3RhbmNlKTsKICB9CiAgZnVuY3Rpb24gZ2V0TmV4dEh5ZHJhdGFibGVJbnN0YW5jZUFmdGVyU3VzcGVuc2VJbnN0YW5jZShzdXNwZW5zZUluc3RhbmNlKSB7CiAgICB2YXIgbm9kZSA9IHN1c3BlbnNlSW5zdGFuY2UubmV4dFNpYmxpbmc7IC8vIFNraXAgcGFzdCBhbGwgbm9kZXMgd2l0aGluIHRoaXMgc3VzcGVuc2UgYm91bmRhcnkuCiAgICAvLyBUaGVyZSBtaWdodCBiZSBuZXN0ZWQgbm9kZXMgc28gd2UgbmVlZCB0byBrZWVwIHRyYWNrIG9mIGhvdwogICAgLy8gZGVlcCB3ZSBhcmUgYW5kIG9ubHkgYnJlYWsgb3V0IHdoZW4gd2UncmUgYmFjayBvbiB0b3AuCgogICAgdmFyIGRlcHRoID0gMDsKCiAgICB3aGlsZSAobm9kZSkgewogICAgICBpZiAobm9kZS5ub2RlVHlwZSA9PT0gQ09NTUVOVF9OT0RFKSB7CiAgICAgICAgdmFyIGRhdGEgPSBub2RlLmRhdGE7CgogICAgICAgIGlmIChkYXRhID09PSBTVVNQRU5TRV9FTkRfREFUQSkgewogICAgICAgICAgaWYgKGRlcHRoID09PSAwKSB7CiAgICAgICAgICAgIHJldHVybiBnZXROZXh0SHlkcmF0YWJsZVNpYmxpbmcobm9kZSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBkZXB0aC0tOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoZGF0YSA9PT0gU1VTUEVOU0VfU1RBUlRfREFUQSB8fCBkYXRhID09PSBTVVNQRU5TRV9GQUxMQkFDS19TVEFSVF9EQVRBIHx8IGRhdGEgPT09IFNVU1BFTlNFX1BFTkRJTkdfU1RBUlRfREFUQSkgewogICAgICAgICAgZGVwdGgrKzsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIG5vZGUgPSBub2RlLm5leHRTaWJsaW5nOwogICAgfSAvLyBUT0RPOiBXYXJuLCB3ZSBkaWRuJ3QgZmluZCB0aGUgZW5kIGNvbW1lbnQgYm91bmRhcnkuCgoKICAgIHJldHVybiBudWxsOwogIH0gLy8gUmV0dXJucyB0aGUgU3VzcGVuc2VJbnN0YW5jZSBpZiB0aGlzIG5vZGUgaXMgYSBkaXJlY3QgY2hpbGQgb2YgYQogIC8vIFN1c3BlbnNlSW5zdGFuY2UuIEkuZS4gaWYgaXRzIHByZXZpb3VzIHNpYmxpbmcgaXMgYSBDb21tZW50IHdpdGgKICAvLyBTVVNQRU5TRV94X1NUQVJUX0RBVEEuIE90aGVyd2lzZSwgbnVsbC4KCiAgZnVuY3Rpb24gZ2V0UGFyZW50U3VzcGVuc2VJbnN0YW5jZSh0YXJnZXRJbnN0YW5jZSkgewogICAgdmFyIG5vZGUgPSB0YXJnZXRJbnN0YW5jZS5wcmV2aW91c1NpYmxpbmc7IC8vIFNraXAgcGFzdCBhbGwgbm9kZXMgd2l0aGluIHRoaXMgc3VzcGVuc2UgYm91bmRhcnkuCiAgICAvLyBUaGVyZSBtaWdodCBiZSBuZXN0ZWQgbm9kZXMgc28gd2UgbmVlZCB0byBrZWVwIHRyYWNrIG9mIGhvdwogICAgLy8gZGVlcCB3ZSBhcmUgYW5kIG9ubHkgYnJlYWsgb3V0IHdoZW4gd2UncmUgYmFjayBvbiB0b3AuCgogICAgdmFyIGRlcHRoID0gMDsKCiAgICB3aGlsZSAobm9kZSkgewogICAgICBpZiAobm9kZS5ub2RlVHlwZSA9PT0gQ09NTUVOVF9OT0RFKSB7CiAgICAgICAgdmFyIGRhdGEgPSBub2RlLmRhdGE7CgogICAgICAgIGlmIChkYXRhID09PSBTVVNQRU5TRV9TVEFSVF9EQVRBIHx8IGRhdGEgPT09IFNVU1BFTlNFX0ZBTExCQUNLX1NUQVJUX0RBVEEgfHwgZGF0YSA9PT0gU1VTUEVOU0VfUEVORElOR19TVEFSVF9EQVRBKSB7CiAgICAgICAgICBpZiAoZGVwdGggPT09IDApIHsKICAgICAgICAgICAgcmV0dXJuIG5vZGU7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBkZXB0aC0tOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoZGF0YSA9PT0gU1VTUEVOU0VfRU5EX0RBVEEpIHsKICAgICAgICAgIGRlcHRoKys7CiAgICAgICAgfQogICAgICB9CgogICAgICBub2RlID0gbm9kZS5wcmV2aW91c1NpYmxpbmc7CiAgICB9CgogICAgcmV0dXJuIG51bGw7CiAgfQogIGZ1bmN0aW9uIGNvbW1pdEh5ZHJhdGVkQ29udGFpbmVyKGNvbnRhaW5lcikgewogICAgLy8gUmV0cnkgaWYgYW55IGV2ZW50IHJlcGxheWluZyB3YXMgYmxvY2tlZCBvbiB0aGlzLgogICAgcmV0cnlJZkJsb2NrZWRPbihjb250YWluZXIpOwogIH0KICBmdW5jdGlvbiBjb21taXRIeWRyYXRlZFN1c3BlbnNlSW5zdGFuY2Uoc3VzcGVuc2VJbnN0YW5jZSkgewogICAgLy8gUmV0cnkgaWYgYW55IGV2ZW50IHJlcGxheWluZyB3YXMgYmxvY2tlZCBvbiB0aGlzLgogICAgcmV0cnlJZkJsb2NrZWRPbihzdXNwZW5zZUluc3RhbmNlKTsKICB9CiAgZnVuY3Rpb24gc2hvdWxkRGVsZXRlVW5oeWRyYXRlZFRhaWxJbnN0YW5jZXMocGFyZW50VHlwZSkgewogICAgcmV0dXJuIHBhcmVudFR5cGUgIT09ICdoZWFkJyAmJiBwYXJlbnRUeXBlICE9PSAnYm9keSc7CiAgfQogIGZ1bmN0aW9uIGRpZE5vdE1hdGNoSHlkcmF0ZWRDb250YWluZXJUZXh0SW5zdGFuY2UocGFyZW50Q29udGFpbmVyLCB0ZXh0SW5zdGFuY2UsIHRleHQsIGlzQ29uY3VycmVudE1vZGUpIHsKICAgIHZhciBzaG91bGRXYXJuRGV2ID0gdHJ1ZTsKICAgIGNoZWNrRm9yVW5tYXRjaGVkVGV4dCh0ZXh0SW5zdGFuY2Uubm9kZVZhbHVlLCB0ZXh0LCBpc0NvbmN1cnJlbnRNb2RlLCBzaG91bGRXYXJuRGV2KTsKICB9CiAgZnVuY3Rpb24gZGlkTm90TWF0Y2hIeWRyYXRlZFRleHRJbnN0YW5jZShwYXJlbnRUeXBlLCBwYXJlbnRQcm9wcywgcGFyZW50SW5zdGFuY2UsIHRleHRJbnN0YW5jZSwgdGV4dCwgaXNDb25jdXJyZW50TW9kZSkgewogICAgaWYgKHBhcmVudFByb3BzW1NVUFBSRVNTX0hZRFJBVElPTl9XQVJOSU5HJDFdICE9PSB0cnVlKSB7CiAgICAgIHZhciBzaG91bGRXYXJuRGV2ID0gdHJ1ZTsKICAgICAgY2hlY2tGb3JVbm1hdGNoZWRUZXh0KHRleHRJbnN0YW5jZS5ub2RlVmFsdWUsIHRleHQsIGlzQ29uY3VycmVudE1vZGUsIHNob3VsZFdhcm5EZXYpOwogICAgfQogIH0KICBmdW5jdGlvbiBkaWROb3RIeWRyYXRlSW5zdGFuY2VXaXRoaW5Db250YWluZXIocGFyZW50Q29udGFpbmVyLCBpbnN0YW5jZSkgewogICAgewogICAgICBpZiAoaW5zdGFuY2Uubm9kZVR5cGUgPT09IEVMRU1FTlRfTk9ERSkgewogICAgICAgIHdhcm5Gb3JEZWxldGVkSHlkcmF0YWJsZUVsZW1lbnQocGFyZW50Q29udGFpbmVyLCBpbnN0YW5jZSk7CiAgICAgIH0gZWxzZSBpZiAoaW5zdGFuY2Uubm9kZVR5cGUgPT09IENPTU1FTlRfTk9ERSkgOyBlbHNlIHsKICAgICAgICB3YXJuRm9yRGVsZXRlZEh5ZHJhdGFibGVUZXh0KHBhcmVudENvbnRhaW5lciwgaW5zdGFuY2UpOwogICAgICB9CiAgICB9CiAgfQogIGZ1bmN0aW9uIGRpZE5vdEh5ZHJhdGVJbnN0YW5jZVdpdGhpblN1c3BlbnNlSW5zdGFuY2UocGFyZW50SW5zdGFuY2UsIGluc3RhbmNlKSB7CiAgICB7CiAgICAgIC8vICRGbG93Rml4TWU6IE9ubHkgRWxlbWVudCBvciBEb2N1bWVudCBjYW4gYmUgcGFyZW50IG5vZGVzLgogICAgICB2YXIgcGFyZW50Tm9kZSA9IHBhcmVudEluc3RhbmNlLnBhcmVudE5vZGU7CgogICAgICBpZiAocGFyZW50Tm9kZSAhPT0gbnVsbCkgewogICAgICAgIGlmIChpbnN0YW5jZS5ub2RlVHlwZSA9PT0gRUxFTUVOVF9OT0RFKSB7CiAgICAgICAgICB3YXJuRm9yRGVsZXRlZEh5ZHJhdGFibGVFbGVtZW50KHBhcmVudE5vZGUsIGluc3RhbmNlKTsKICAgICAgICB9IGVsc2UgaWYgKGluc3RhbmNlLm5vZGVUeXBlID09PSBDT01NRU5UX05PREUpIDsgZWxzZSB7CiAgICAgICAgICB3YXJuRm9yRGVsZXRlZEh5ZHJhdGFibGVUZXh0KHBhcmVudE5vZGUsIGluc3RhbmNlKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CiAgZnVuY3Rpb24gZGlkTm90SHlkcmF0ZUluc3RhbmNlKHBhcmVudFR5cGUsIHBhcmVudFByb3BzLCBwYXJlbnRJbnN0YW5jZSwgaW5zdGFuY2UsIGlzQ29uY3VycmVudE1vZGUpIHsKICAgIHsKICAgICAgaWYgKGlzQ29uY3VycmVudE1vZGUgfHwgcGFyZW50UHJvcHNbU1VQUFJFU1NfSFlEUkFUSU9OX1dBUk5JTkckMV0gIT09IHRydWUpIHsKICAgICAgICBpZiAoaW5zdGFuY2Uubm9kZVR5cGUgPT09IEVMRU1FTlRfTk9ERSkgewogICAgICAgICAgd2FybkZvckRlbGV0ZWRIeWRyYXRhYmxlRWxlbWVudChwYXJlbnRJbnN0YW5jZSwgaW5zdGFuY2UpOwogICAgICAgIH0gZWxzZSBpZiAoaW5zdGFuY2Uubm9kZVR5cGUgPT09IENPTU1FTlRfTk9ERSkgOyBlbHNlIHsKICAgICAgICAgIHdhcm5Gb3JEZWxldGVkSHlkcmF0YWJsZVRleHQocGFyZW50SW5zdGFuY2UsIGluc3RhbmNlKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CiAgZnVuY3Rpb24gZGlkTm90RmluZEh5ZHJhdGFibGVJbnN0YW5jZVdpdGhpbkNvbnRhaW5lcihwYXJlbnRDb250YWluZXIsIHR5cGUsIHByb3BzKSB7CiAgICB7CiAgICAgIHdhcm5Gb3JJbnNlcnRlZEh5ZHJhdGVkRWxlbWVudChwYXJlbnRDb250YWluZXIsIHR5cGUpOwogICAgfQogIH0KICBmdW5jdGlvbiBkaWROb3RGaW5kSHlkcmF0YWJsZVRleHRJbnN0YW5jZVdpdGhpbkNvbnRhaW5lcihwYXJlbnRDb250YWluZXIsIHRleHQpIHsKICAgIHsKICAgICAgd2FybkZvckluc2VydGVkSHlkcmF0ZWRUZXh0KHBhcmVudENvbnRhaW5lciwgdGV4dCk7CiAgICB9CiAgfQogIGZ1bmN0aW9uIGRpZE5vdEZpbmRIeWRyYXRhYmxlSW5zdGFuY2VXaXRoaW5TdXNwZW5zZUluc3RhbmNlKHBhcmVudEluc3RhbmNlLCB0eXBlLCBwcm9wcykgewogICAgewogICAgICAvLyAkRmxvd0ZpeE1lOiBPbmx5IEVsZW1lbnQgb3IgRG9jdW1lbnQgY2FuIGJlIHBhcmVudCBub2Rlcy4KICAgICAgdmFyIHBhcmVudE5vZGUgPSBwYXJlbnRJbnN0YW5jZS5wYXJlbnROb2RlOwogICAgICBpZiAocGFyZW50Tm9kZSAhPT0gbnVsbCkgd2FybkZvckluc2VydGVkSHlkcmF0ZWRFbGVtZW50KHBhcmVudE5vZGUsIHR5cGUpOwogICAgfQogIH0KICBmdW5jdGlvbiBkaWROb3RGaW5kSHlkcmF0YWJsZVRleHRJbnN0YW5jZVdpdGhpblN1c3BlbnNlSW5zdGFuY2UocGFyZW50SW5zdGFuY2UsIHRleHQpIHsKICAgIHsKICAgICAgLy8gJEZsb3dGaXhNZTogT25seSBFbGVtZW50IG9yIERvY3VtZW50IGNhbiBiZSBwYXJlbnQgbm9kZXMuCiAgICAgIHZhciBwYXJlbnROb2RlID0gcGFyZW50SW5zdGFuY2UucGFyZW50Tm9kZTsKICAgICAgaWYgKHBhcmVudE5vZGUgIT09IG51bGwpIHdhcm5Gb3JJbnNlcnRlZEh5ZHJhdGVkVGV4dChwYXJlbnROb2RlLCB0ZXh0KTsKICAgIH0KICB9CiAgZnVuY3Rpb24gZGlkTm90RmluZEh5ZHJhdGFibGVJbnN0YW5jZShwYXJlbnRUeXBlLCBwYXJlbnRQcm9wcywgcGFyZW50SW5zdGFuY2UsIHR5cGUsIHByb3BzLCBpc0NvbmN1cnJlbnRNb2RlKSB7CiAgICB7CiAgICAgIGlmIChpc0NvbmN1cnJlbnRNb2RlIHx8IHBhcmVudFByb3BzW1NVUFBSRVNTX0hZRFJBVElPTl9XQVJOSU5HJDFdICE9PSB0cnVlKSB7CiAgICAgICAgd2FybkZvckluc2VydGVkSHlkcmF0ZWRFbGVtZW50KHBhcmVudEluc3RhbmNlLCB0eXBlKTsKICAgICAgfQogICAgfQogIH0KICBmdW5jdGlvbiBkaWROb3RGaW5kSHlkcmF0YWJsZVRleHRJbnN0YW5jZShwYXJlbnRUeXBlLCBwYXJlbnRQcm9wcywgcGFyZW50SW5zdGFuY2UsIHRleHQsIGlzQ29uY3VycmVudE1vZGUpIHsKICAgIHsKICAgICAgaWYgKGlzQ29uY3VycmVudE1vZGUgfHwgcGFyZW50UHJvcHNbU1VQUFJFU1NfSFlEUkFUSU9OX1dBUk5JTkckMV0gIT09IHRydWUpIHsKICAgICAgICB3YXJuRm9ySW5zZXJ0ZWRIeWRyYXRlZFRleHQocGFyZW50SW5zdGFuY2UsIHRleHQpOwogICAgICB9CiAgICB9CiAgfQogIGZ1bmN0aW9uIGVycm9ySHlkcmF0aW5nQ29udGFpbmVyKHBhcmVudENvbnRhaW5lcikgewogICAgewogICAgICAvLyBUT0RPOiBUaGlzIGdldHMgbG9nZ2VkIGJ5IG9uUmVjb3ZlcmFibGVFcnJvciwgdG9vLCBzbyB3ZSBzaG91bGQgYmUKICAgICAgLy8gYWJsZSB0byByZW1vdmUgaXQuCiAgICAgIGVycm9yKCdBbiBlcnJvciBvY2N1cnJlZCBkdXJpbmcgaHlkcmF0aW9uLiBUaGUgc2VydmVyIEhUTUwgd2FzIHJlcGxhY2VkIHdpdGggY2xpZW50IGNvbnRlbnQgaW4gPCVzPi4nLCBwYXJlbnRDb250YWluZXIubm9kZU5hbWUudG9Mb3dlckNhc2UoKSk7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHByZXBhcmVQb3J0YWxNb3VudChwb3J0YWxJbnN0YW5jZSkgewogICAgbGlzdGVuVG9BbGxTdXBwb3J0ZWRFdmVudHMocG9ydGFsSW5zdGFuY2UpOwogIH0KCiAgdmFyIHJhbmRvbUtleSA9IE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnNsaWNlKDIpOwogIHZhciBpbnRlcm5hbEluc3RhbmNlS2V5ID0gJ19fcmVhY3RGaWJlciQnICsgcmFuZG9tS2V5OwogIHZhciBpbnRlcm5hbFByb3BzS2V5ID0gJ19fcmVhY3RQcm9wcyQnICsgcmFuZG9tS2V5OwogIHZhciBpbnRlcm5hbENvbnRhaW5lckluc3RhbmNlS2V5ID0gJ19fcmVhY3RDb250YWluZXIkJyArIHJhbmRvbUtleTsKICB2YXIgaW50ZXJuYWxFdmVudEhhbmRsZXJzS2V5ID0gJ19fcmVhY3RFdmVudHMkJyArIHJhbmRvbUtleTsKICB2YXIgaW50ZXJuYWxFdmVudEhhbmRsZXJMaXN0ZW5lcnNLZXkgPSAnX19yZWFjdExpc3RlbmVycyQnICsgcmFuZG9tS2V5OwogIHZhciBpbnRlcm5hbEV2ZW50SGFuZGxlc1NldEtleSA9ICdfX3JlYWN0SGFuZGxlcyQnICsgcmFuZG9tS2V5OwogIGZ1bmN0aW9uIGRldGFjaERlbGV0ZWRJbnN0YW5jZShub2RlKSB7CiAgICAvLyBUT0RPOiBUaGlzIGZ1bmN0aW9uIGlzIG9ubHkgY2FsbGVkIG9uIGhvc3QgY29tcG9uZW50cy4gSSBkb24ndCB0aGluayBhbGwgb2YKICAgIC8vIHRoZXNlIGZpZWxkcyBhcmUgcmVsZXZhbnQuCiAgICBkZWxldGUgbm9kZVtpbnRlcm5hbEluc3RhbmNlS2V5XTsKICAgIGRlbGV0ZSBub2RlW2ludGVybmFsUHJvcHNLZXldOwogICAgZGVsZXRlIG5vZGVbaW50ZXJuYWxFdmVudEhhbmRsZXJzS2V5XTsKICAgIGRlbGV0ZSBub2RlW2ludGVybmFsRXZlbnRIYW5kbGVyTGlzdGVuZXJzS2V5XTsKICAgIGRlbGV0ZSBub2RlW2ludGVybmFsRXZlbnRIYW5kbGVzU2V0S2V5XTsKICB9CiAgZnVuY3Rpb24gcHJlY2FjaGVGaWJlck5vZGUoaG9zdEluc3QsIG5vZGUpIHsKICAgIG5vZGVbaW50ZXJuYWxJbnN0YW5jZUtleV0gPSBob3N0SW5zdDsKICB9CiAgZnVuY3Rpb24gbWFya0NvbnRhaW5lckFzUm9vdChob3N0Um9vdCwgbm9kZSkgewogICAgbm9kZVtpbnRlcm5hbENvbnRhaW5lckluc3RhbmNlS2V5XSA9IGhvc3RSb290OwogIH0KICBmdW5jdGlvbiB1bm1hcmtDb250YWluZXJBc1Jvb3Qobm9kZSkgewogICAgbm9kZVtpbnRlcm5hbENvbnRhaW5lckluc3RhbmNlS2V5XSA9IG51bGw7CiAgfQogIGZ1bmN0aW9uIGlzQ29udGFpbmVyTWFya2VkQXNSb290KG5vZGUpIHsKICAgIHJldHVybiAhIW5vZGVbaW50ZXJuYWxDb250YWluZXJJbnN0YW5jZUtleV07CiAgfSAvLyBHaXZlbiBhIERPTSBub2RlLCByZXR1cm4gdGhlIGNsb3Nlc3QgSG9zdENvbXBvbmVudCBvciBIb3N0VGV4dCBmaWJlciBhbmNlc3Rvci4KICAvLyBJZiB0aGUgdGFyZ2V0IG5vZGUgaXMgcGFydCBvZiBhIGh5ZHJhdGVkIG9yIG5vdCB5ZXQgcmVuZGVyZWQgc3VidHJlZSwgdGhlbgogIC8vIHRoaXMgbWF5IGFsc28gcmV0dXJuIGEgU3VzcGVuc2VDb21wb25lbnQgb3IgSG9zdFJvb3QgdG8gaW5kaWNhdGUgdGhhdC4KICAvLyBDb25jZXB0dWFsbHkgdGhlIEhvc3RSb290IGZpYmVyIGlzIGEgY2hpbGQgb2YgdGhlIENvbnRhaW5lciBub2RlLiBTbyBpZiB5b3UKICAvLyBwYXNzIHRoZSBDb250YWluZXIgbm9kZSBhcyB0aGUgdGFyZ2V0Tm9kZSwgeW91IHdpbGwgbm90IGFjdHVhbGx5IGdldCB0aGUKICAvLyBIb3N0Um9vdCBiYWNrLiBUbyBnZXQgdG8gdGhlIEhvc3RSb290LCB5b3UgbmVlZCB0byBwYXNzIGEgY2hpbGQgb2YgaXQuCiAgLy8gVGhlIHNhbWUgdGhpbmcgYXBwbGllcyB0byBTdXNwZW5zZSBib3VuZGFyaWVzLgoKICBmdW5jdGlvbiBnZXRDbG9zZXN0SW5zdGFuY2VGcm9tTm9kZSh0YXJnZXROb2RlKSB7CiAgICB2YXIgdGFyZ2V0SW5zdCA9IHRhcmdldE5vZGVbaW50ZXJuYWxJbnN0YW5jZUtleV07CgogICAgaWYgKHRhcmdldEluc3QpIHsKICAgICAgLy8gRG9uJ3QgcmV0dXJuIEhvc3RSb290IG9yIFN1c3BlbnNlQ29tcG9uZW50IGhlcmUuCiAgICAgIHJldHVybiB0YXJnZXRJbnN0OwogICAgfSAvLyBJZiB0aGUgZGlyZWN0IGV2ZW50IHRhcmdldCBpc24ndCBhIFJlYWN0IG93bmVkIERPTSBub2RlLCB3ZSBuZWVkIHRvIGxvb2sKICAgIC8vIHRvIHNlZSBpZiBvbmUgb2YgaXRzIHBhcmVudHMgaXMgYSBSZWFjdCBvd25lZCBET00gbm9kZS4KCgogICAgdmFyIHBhcmVudE5vZGUgPSB0YXJnZXROb2RlLnBhcmVudE5vZGU7CgogICAgd2hpbGUgKHBhcmVudE5vZGUpIHsKICAgICAgLy8gV2UnbGwgY2hlY2sgaWYgdGhpcyBpcyBhIGNvbnRhaW5lciByb290IHRoYXQgY291bGQgaW5jbHVkZQogICAgICAvLyBSZWFjdCBub2RlcyBpbiB0aGUgZnV0dXJlLiBXZSBuZWVkIHRvIGNoZWNrIHRoaXMgZmlyc3QgYmVjYXVzZQogICAgICAvLyBpZiB3ZSdyZSBhIGNoaWxkIG9mIGEgZGVoeWRyYXRlZCBjb250YWluZXIsIHdlIG5lZWQgdG8gZmlyc3QKICAgICAgLy8gZmluZCB0aGF0IGlubmVyIGNvbnRhaW5lciBiZWZvcmUgbW92aW5nIG9uIHRvIGZpbmRpbmcgdGhlIHBhcmVudAogICAgICAvLyBpbnN0YW5jZS4gTm90ZSB0aGF0IHdlIGRvbid0IGNoZWNrIHRoaXMgZmllbGQgb24gIHRoZSB0YXJnZXROb2RlCiAgICAgIC8vIGl0c2VsZiBiZWNhdXNlIHRoZSBmaWJlcnMgYXJlIGNvbmNlcHR1YWxseSBiZXR3ZWVuIHRoZSBjb250YWluZXIKICAgICAgLy8gbm9kZSBhbmQgdGhlIGZpcnN0IGNoaWxkLiBJdCBpc24ndCBzdXJyb3VuZGluZyB0aGUgY29udGFpbmVyIG5vZGUuCiAgICAgIC8vIElmIGl0J3Mgbm90IGEgY29udGFpbmVyLCB3ZSBjaGVjayBpZiBpdCdzIGFuIGluc3RhbmNlLgogICAgICB0YXJnZXRJbnN0ID0gcGFyZW50Tm9kZVtpbnRlcm5hbENvbnRhaW5lckluc3RhbmNlS2V5XSB8fCBwYXJlbnROb2RlW2ludGVybmFsSW5zdGFuY2VLZXldOwoKICAgICAgaWYgKHRhcmdldEluc3QpIHsKICAgICAgICAvLyBTaW5jZSB0aGlzIHdhc24ndCB0aGUgZGlyZWN0IHRhcmdldCBvZiB0aGUgZXZlbnQsIHdlIG1pZ2h0IGhhdmUKICAgICAgICAvLyBzdGVwcGVkIHBhc3QgZGVoeWRyYXRlZCBET00gbm9kZXMgdG8gZ2V0IGhlcmUuIEhvd2V2ZXIgdGhleSBjb3VsZAogICAgICAgIC8vIGFsc28gaGF2ZSBiZWVuIG5vbi1SZWFjdCBub2Rlcy4gV2UgbmVlZCB0byBhbnN3ZXIgd2hpY2ggb25lLgogICAgICAgIC8vIElmIHdlIHRoZSBpbnN0YW5jZSBkb2Vzbid0IGhhdmUgYW55IGNoaWxkcmVuLCB0aGVuIHRoZXJlIGNhbid0IGJlCiAgICAgICAgLy8gYSBuZXN0ZWQgc3VzcGVuc2UgYm91bmRhcnkgd2l0aGluIGl0LiBTbyB3ZSBjYW4gdXNlIHRoaXMgYXMgYSBmYXN0CiAgICAgICAgLy8gYmFpbG91dC4gTW9zdCBvZiB0aGUgdGltZSwgd2hlbiBwZW9wbGUgYWRkIG5vbi1SZWFjdCBjaGlsZHJlbiB0bwogICAgICAgIC8vIHRoZSB0cmVlLCBpdCBpcyB1c2luZyBhIHJlZiB0byBhIGNoaWxkLWxlc3MgRE9NIG5vZGUuCiAgICAgICAgLy8gTm9ybWFsbHkgd2UnZCBvbmx5IG5lZWQgdG8gY2hlY2sgb25lIG9mIHRoZSBmaWJlcnMgYmVjYXVzZSBpZiBpdAogICAgICAgIC8vIGhhcyBldmVyIGdvbmUgZnJvbSBoYXZpbmcgY2hpbGRyZW4gdG8gZGVsZXRpbmcgdGhlbSBvciB2aWNlIHZlcnNhCiAgICAgICAgLy8gaXQgd291bGQgaGF2ZSBkZWxldGVkIHRoZSBkZWh5ZHJhdGVkIGJvdW5kYXJ5IG5lc3RlZCBpbnNpZGUgYWxyZWFkeS4KICAgICAgICAvLyBIb3dldmVyLCBzaW5jZSB0aGUgSG9zdFJvb3Qgc3RhcnRzIG91dCB3aXRoIGFuIGFsdGVybmF0ZSBpdCBtaWdodAogICAgICAgIC8vIGhhdmUgb25lIG9uIHRoZSBhbHRlcm5hdGUgc28gd2UgbmVlZCB0byBjaGVjayBpbiBjYXNlIHRoaXMgd2FzIGEKICAgICAgICAvLyByb290LgogICAgICAgIHZhciBhbHRlcm5hdGUgPSB0YXJnZXRJbnN0LmFsdGVybmF0ZTsKCiAgICAgICAgaWYgKHRhcmdldEluc3QuY2hpbGQgIT09IG51bGwgfHwgYWx0ZXJuYXRlICE9PSBudWxsICYmIGFsdGVybmF0ZS5jaGlsZCAhPT0gbnVsbCkgewogICAgICAgICAgLy8gTmV4dCB3ZSBuZWVkIHRvIGZpZ3VyZSBvdXQgaWYgdGhlIG5vZGUgdGhhdCBza2lwcGVkIHBhc3QgaXMKICAgICAgICAgIC8vIG5lc3RlZCB3aXRoaW4gYSBkZWh5ZHJhdGVkIGJvdW5kYXJ5IGFuZCBpZiBzbywgd2hpY2ggb25lLgogICAgICAgICAgdmFyIHN1c3BlbnNlSW5zdGFuY2UgPSBnZXRQYXJlbnRTdXNwZW5zZUluc3RhbmNlKHRhcmdldE5vZGUpOwoKICAgICAgICAgIHdoaWxlIChzdXNwZW5zZUluc3RhbmNlICE9PSBudWxsKSB7CiAgICAgICAgICAgIC8vIFdlIGZvdW5kIGEgc3VzcGVuc2UgaW5zdGFuY2UuIFRoYXQgbWVhbnMgdGhhdCB3ZSBoYXZlbid0CiAgICAgICAgICAgIC8vIGh5ZHJhdGVkIGl0IHlldC4gRXZlbiB0aG91Z2ggd2UgbGVhdmUgdGhlIGNvbW1lbnRzIGluIHRoZQogICAgICAgICAgICAvLyBET00gYWZ0ZXIgaHlkcmF0aW5nLCBhbmQgdGhlcmUgYXJlIGJvdW5kYXJpZXMgaW4gdGhlIERPTQogICAgICAgICAgICAvLyB0aGF0IGNvdWxkIGFscmVhZHkgYmUgaHlkcmF0ZWQsIHdlIHdvdWxkbid0IGhhdmUgZm91bmQgdGhlbQogICAgICAgICAgICAvLyB0aHJvdWdoIHRoaXMgcGFzcyBzaW5jZSBpZiB0aGUgdGFyZ2V0IGlzIGh5ZHJhdGVkIGl0IHdvdWxkCiAgICAgICAgICAgIC8vIGhhdmUgaGFkIGFuIGludGVybmFsSW5zdGFuY2VLZXkgb24gaXQuCiAgICAgICAgICAgIC8vIExldCdzIGdldCB0aGUgZmliZXIgYXNzb2NpYXRlZCB3aXRoIHRoZSBTdXNwZW5zZUNvbXBvbmVudAogICAgICAgICAgICAvLyBhcyB0aGUgZGVlcGVzdCBpbnN0YW5jZS4KICAgICAgICAgICAgdmFyIHRhcmdldFN1c3BlbnNlSW5zdCA9IHN1c3BlbnNlSW5zdGFuY2VbaW50ZXJuYWxJbnN0YW5jZUtleV07CgogICAgICAgICAgICBpZiAodGFyZ2V0U3VzcGVuc2VJbnN0KSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRhcmdldFN1c3BlbnNlSW5zdDsKICAgICAgICAgICAgfSAvLyBJZiB3ZSBkb24ndCBmaW5kIGEgRmliZXIgb24gdGhlIGNvbW1lbnQsIGl0IG1pZ2h0IGJlIGJlY2F1c2UKICAgICAgICAgICAgLy8gd2UgaGF2ZW4ndCBnb3R0ZW4gdG8gaHlkcmF0ZSBpdCB5ZXQuIFRoZXJlIG1pZ2h0IHN0aWxsIGJlIGEKICAgICAgICAgICAgLy8gcGFyZW50IGJvdW5kYXJ5IHRoYXQgaGFzbid0IGFib3ZlIHRoaXMgb25lIHNvIHdlIG5lZWQgdG8gZmluZAogICAgICAgICAgICAvLyB0aGUgb3V0ZXIgbW9zdCB0aGF0IGlzIGtub3duLgoKCiAgICAgICAgICAgIHN1c3BlbnNlSW5zdGFuY2UgPSBnZXRQYXJlbnRTdXNwZW5zZUluc3RhbmNlKHN1c3BlbnNlSW5zdGFuY2UpOyAvLyBJZiB3ZSBkb24ndCBmaW5kIG9uZSwgdGhlbiB0aGF0IHNob3VsZCBtZWFuIHRoYXQgdGhlIHBhcmVudAogICAgICAgICAgICAvLyBob3N0IGNvbXBvbmVudCBhbHNvIGhhc24ndCBoeWRyYXRlZCB5ZXQuIFdlIGNhbiByZXR1cm4gaXQKICAgICAgICAgICAgLy8gYmVsb3cgc2luY2UgaXQgd2lsbCBiYWlsIG91dCBvbiB0aGUgaXNNb3VudGVkIGNoZWNrIGxhdGVyLgogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHRhcmdldEluc3Q7CiAgICAgIH0KCiAgICAgIHRhcmdldE5vZGUgPSBwYXJlbnROb2RlOwogICAgICBwYXJlbnROb2RlID0gdGFyZ2V0Tm9kZS5wYXJlbnROb2RlOwogICAgfQoKICAgIHJldHVybiBudWxsOwogIH0KICAvKioKICAgKiBHaXZlbiBhIERPTSBub2RlLCByZXR1cm4gdGhlIFJlYWN0RE9NQ29tcG9uZW50IG9yIFJlYWN0RE9NVGV4dENvbXBvbmVudAogICAqIGluc3RhbmNlLCBvciBudWxsIGlmIHRoZSBub2RlIHdhcyBub3QgcmVuZGVyZWQgYnkgdGhpcyBSZWFjdC4KICAgKi8KCiAgZnVuY3Rpb24gZ2V0SW5zdGFuY2VGcm9tTm9kZShub2RlKSB7CiAgICB2YXIgaW5zdCA9IG5vZGVbaW50ZXJuYWxJbnN0YW5jZUtleV0gfHwgbm9kZVtpbnRlcm5hbENvbnRhaW5lckluc3RhbmNlS2V5XTsKCiAgICBpZiAoaW5zdCkgewogICAgICBpZiAoaW5zdC50YWcgPT09IEhvc3RDb21wb25lbnQgfHwgaW5zdC50YWcgPT09IEhvc3RUZXh0IHx8IGluc3QudGFnID09PSBTdXNwZW5zZUNvbXBvbmVudCB8fCBpbnN0LnRhZyA9PT0gSG9zdFJvb3QpIHsKICAgICAgICByZXR1cm4gaW5zdDsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBudWxsOwogIH0KICAvKioKICAgKiBHaXZlbiBhIFJlYWN0RE9NQ29tcG9uZW50IG9yIFJlYWN0RE9NVGV4dENvbXBvbmVudCwgcmV0dXJuIHRoZSBjb3JyZXNwb25kaW5nCiAgICogRE9NIG5vZGUuCiAgICovCgogIGZ1bmN0aW9uIGdldE5vZGVGcm9tSW5zdGFuY2UoaW5zdCkgewogICAgaWYgKGluc3QudGFnID09PSBIb3N0Q29tcG9uZW50IHx8IGluc3QudGFnID09PSBIb3N0VGV4dCkgewogICAgICAvLyBJbiBGaWJlciB0aGlzLCBpcyBqdXN0IHRoZSBzdGF0ZSBub2RlIHJpZ2h0IG5vdy4gV2UgYXNzdW1lIGl0IHdpbGwgYmUKICAgICAgLy8gYSBob3N0IGNvbXBvbmVudCBvciBob3N0IHRleHQuCiAgICAgIHJldHVybiBpbnN0LnN0YXRlTm9kZTsKICAgIH0gLy8gV2l0aG91dCB0aGlzIGZpcnN0IGludmFyaWFudCwgcGFzc2luZyBhIG5vbi1ET00tY29tcG9uZW50IHRyaWdnZXJzIHRoZSBuZXh0CiAgICAvLyBpbnZhcmlhbnQgZm9yIGEgbWlzc2luZyBwYXJlbnQsIHdoaWNoIGlzIHN1cGVyIGNvbmZ1c2luZy4KCgogICAgdGhyb3cgbmV3IEVycm9yKCdnZXROb2RlRnJvbUluc3RhbmNlOiBJbnZhbGlkIGFyZ3VtZW50LicpOwogIH0KICBmdW5jdGlvbiBnZXRGaWJlckN1cnJlbnRQcm9wc0Zyb21Ob2RlKG5vZGUpIHsKICAgIHJldHVybiBub2RlW2ludGVybmFsUHJvcHNLZXldIHx8IG51bGw7CiAgfQogIGZ1bmN0aW9uIHVwZGF0ZUZpYmVyUHJvcHMobm9kZSwgcHJvcHMpIHsKICAgIG5vZGVbaW50ZXJuYWxQcm9wc0tleV0gPSBwcm9wczsKICB9CiAgZnVuY3Rpb24gZ2V0RXZlbnRMaXN0ZW5lclNldChub2RlKSB7CiAgICB2YXIgZWxlbWVudExpc3RlbmVyU2V0ID0gbm9kZVtpbnRlcm5hbEV2ZW50SGFuZGxlcnNLZXldOwoKICAgIGlmIChlbGVtZW50TGlzdGVuZXJTZXQgPT09IHVuZGVmaW5lZCkgewogICAgICBlbGVtZW50TGlzdGVuZXJTZXQgPSBub2RlW2ludGVybmFsRXZlbnRIYW5kbGVyc0tleV0gPSBuZXcgU2V0KCk7CiAgICB9CgogICAgcmV0dXJuIGVsZW1lbnRMaXN0ZW5lclNldDsKICB9CgogIHZhciBsb2dnZWRUeXBlRmFpbHVyZXMgPSB7fTsKICB2YXIgUmVhY3REZWJ1Z0N1cnJlbnRGcmFtZSQxID0gUmVhY3RTaGFyZWRJbnRlcm5hbHMuUmVhY3REZWJ1Z0N1cnJlbnRGcmFtZTsKCiAgZnVuY3Rpb24gc2V0Q3VycmVudGx5VmFsaWRhdGluZ0VsZW1lbnQoZWxlbWVudCkgewogICAgewogICAgICBpZiAoZWxlbWVudCkgewogICAgICAgIHZhciBvd25lciA9IGVsZW1lbnQuX293bmVyOwogICAgICAgIHZhciBzdGFjayA9IGRlc2NyaWJlVW5rbm93bkVsZW1lbnRUeXBlRnJhbWVJbkRFVihlbGVtZW50LnR5cGUsIGVsZW1lbnQuX3NvdXJjZSwgb3duZXIgPyBvd25lci50eXBlIDogbnVsbCk7CiAgICAgICAgUmVhY3REZWJ1Z0N1cnJlbnRGcmFtZSQxLnNldEV4dHJhU3RhY2tGcmFtZShzdGFjayk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgUmVhY3REZWJ1Z0N1cnJlbnRGcmFtZSQxLnNldEV4dHJhU3RhY2tGcmFtZShudWxsKTsKICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gY2hlY2tQcm9wVHlwZXModHlwZVNwZWNzLCB2YWx1ZXMsIGxvY2F0aW9uLCBjb21wb25lbnROYW1lLCBlbGVtZW50KSB7CiAgICB7CiAgICAgIC8vICRGbG93Rml4TWUgVGhpcyBpcyBva2F5IGJ1dCBGbG93IGRvZXNuJ3Qga25vdyBpdC4KICAgICAgdmFyIGhhcyA9IEZ1bmN0aW9uLmNhbGwuYmluZChoYXNPd25Qcm9wZXJ0eSk7CgogICAgICBmb3IgKHZhciB0eXBlU3BlY05hbWUgaW4gdHlwZVNwZWNzKSB7CiAgICAgICAgaWYgKGhhcyh0eXBlU3BlY3MsIHR5cGVTcGVjTmFtZSkpIHsKICAgICAgICAgIHZhciBlcnJvciQxID0gdm9pZCAwOyAvLyBQcm9wIHR5cGUgdmFsaWRhdGlvbiBtYXkgdGhyb3cuIEluIGNhc2UgdGhleSBkbywgd2UgZG9uJ3Qgd2FudCB0bwogICAgICAgICAgLy8gZmFpbCB0aGUgcmVuZGVyIHBoYXNlIHdoZXJlIGl0IGRpZG4ndCBmYWlsIGJlZm9yZS4gU28gd2UgbG9nIGl0LgogICAgICAgICAgLy8gQWZ0ZXIgdGhlc2UgaGF2ZSBiZWVuIGNsZWFuZWQgdXAsIHdlJ2xsIGxldCB0aGVtIHRocm93LgoKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIC8vIFRoaXMgaXMgaW50ZW50aW9uYWxseSBhbiBpbnZhcmlhbnQgdGhhdCBnZXRzIGNhdWdodC4gSXQncyB0aGUgc2FtZQogICAgICAgICAgICAvLyBiZWhhdmlvciBhcyB3aXRob3V0IHRoaXMgc3RhdGVtZW50IGV4Y2VwdCB3aXRoIGEgYmV0dGVyIG1lc3NhZ2UuCiAgICAgICAgICAgIGlmICh0eXBlb2YgdHlwZVNwZWNzW3R5cGVTcGVjTmFtZV0gIT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaW50ZXJuYWwvcHJvZC1lcnJvci1jb2RlcwogICAgICAgICAgICAgIHZhciBlcnIgPSBFcnJvcigoY29tcG9uZW50TmFtZSB8fCAnUmVhY3QgY2xhc3MnKSArICc6ICcgKyBsb2NhdGlvbiArICcgdHlwZSBgJyArIHR5cGVTcGVjTmFtZSArICdgIGlzIGludmFsaWQ7ICcgKyAnaXQgbXVzdCBiZSBhIGZ1bmN0aW9uLCB1c3VhbGx5IGZyb20gdGhlIGBwcm9wLXR5cGVzYCBwYWNrYWdlLCBidXQgcmVjZWl2ZWQgYCcgKyB0eXBlb2YgdHlwZVNwZWNzW3R5cGVTcGVjTmFtZV0gKyAnYC4nICsgJ1RoaXMgb2Z0ZW4gaGFwcGVucyBiZWNhdXNlIG9mIHR5cG9zIHN1Y2ggYXMgYFByb3BUeXBlcy5mdW5jdGlvbmAgaW5zdGVhZCBvZiBgUHJvcFR5cGVzLmZ1bmNgLicpOwogICAgICAgICAgICAgIGVyci5uYW1lID0gJ0ludmFyaWFudCBWaW9sYXRpb24nOwogICAgICAgICAgICAgIHRocm93IGVycjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZXJyb3IkMSA9IHR5cGVTcGVjc1t0eXBlU3BlY05hbWVdKHZhbHVlcywgdHlwZVNwZWNOYW1lLCBjb21wb25lbnROYW1lLCBsb2NhdGlvbiwgbnVsbCwgJ1NFQ1JFVF9ET19OT1RfUEFTU19USElTX09SX1lPVV9XSUxMX0JFX0ZJUkVEJyk7CiAgICAgICAgICB9IGNhdGNoIChleCkgewogICAgICAgICAgICBlcnJvciQxID0gZXg7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGVycm9yJDEgJiYgIShlcnJvciQxIGluc3RhbmNlb2YgRXJyb3IpKSB7CiAgICAgICAgICAgIHNldEN1cnJlbnRseVZhbGlkYXRpbmdFbGVtZW50KGVsZW1lbnQpOwoKICAgICAgICAgICAgZXJyb3IoJyVzOiB0eXBlIHNwZWNpZmljYXRpb24gb2YgJXMnICsgJyBgJXNgIGlzIGludmFsaWQ7IHRoZSB0eXBlIGNoZWNrZXIgJyArICdmdW5jdGlvbiBtdXN0IHJldHVybiBgbnVsbGAgb3IgYW4gYEVycm9yYCBidXQgcmV0dXJuZWQgYSAlcy4gJyArICdZb3UgbWF5IGhhdmUgZm9yZ290dGVuIHRvIHBhc3MgYW4gYXJndW1lbnQgdG8gdGhlIHR5cGUgY2hlY2tlciAnICsgJ2NyZWF0b3IgKGFycmF5T2YsIGluc3RhbmNlT2YsIG9iamVjdE9mLCBvbmVPZiwgb25lT2ZUeXBlLCBhbmQgJyArICdzaGFwZSBhbGwgcmVxdWlyZSBhbiBhcmd1bWVudCkuJywgY29tcG9uZW50TmFtZSB8fCAnUmVhY3QgY2xhc3MnLCBsb2NhdGlvbiwgdHlwZVNwZWNOYW1lLCB0eXBlb2YgZXJyb3IkMSk7CgogICAgICAgICAgICBzZXRDdXJyZW50bHlWYWxpZGF0aW5nRWxlbWVudChudWxsKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoZXJyb3IkMSBpbnN0YW5jZW9mIEVycm9yICYmICEoZXJyb3IkMS5tZXNzYWdlIGluIGxvZ2dlZFR5cGVGYWlsdXJlcykpIHsKICAgICAgICAgICAgLy8gT25seSBtb25pdG9yIHRoaXMgZmFpbHVyZSBvbmNlIGJlY2F1c2UgdGhlcmUgdGVuZHMgdG8gYmUgYSBsb3Qgb2YgdGhlCiAgICAgICAgICAgIC8vIHNhbWUgZXJyb3IuCiAgICAgICAgICAgIGxvZ2dlZFR5cGVGYWlsdXJlc1tlcnJvciQxLm1lc3NhZ2VdID0gdHJ1ZTsKICAgICAgICAgICAgc2V0Q3VycmVudGx5VmFsaWRhdGluZ0VsZW1lbnQoZWxlbWVudCk7CgogICAgICAgICAgICBlcnJvcignRmFpbGVkICVzIHR5cGU6ICVzJywgbG9jYXRpb24sIGVycm9yJDEubWVzc2FnZSk7CgogICAgICAgICAgICBzZXRDdXJyZW50bHlWYWxpZGF0aW5nRWxlbWVudChudWxsKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CgogIHZhciB2YWx1ZVN0YWNrID0gW107CiAgdmFyIGZpYmVyU3RhY2s7CgogIHsKICAgIGZpYmVyU3RhY2sgPSBbXTsKICB9CgogIHZhciBpbmRleCA9IC0xOwoKICBmdW5jdGlvbiBjcmVhdGVDdXJzb3IoZGVmYXVsdFZhbHVlKSB7CiAgICByZXR1cm4gewogICAgICBjdXJyZW50OiBkZWZhdWx0VmFsdWUKICAgIH07CiAgfQoKICBmdW5jdGlvbiBwb3AoY3Vyc29yLCBmaWJlcikgewogICAgaWYgKGluZGV4IDwgMCkgewogICAgICB7CiAgICAgICAgZXJyb3IoJ1VuZXhwZWN0ZWQgcG9wLicpOwogICAgICB9CgogICAgICByZXR1cm47CiAgICB9CgogICAgewogICAgICBpZiAoZmliZXIgIT09IGZpYmVyU3RhY2tbaW5kZXhdKSB7CiAgICAgICAgZXJyb3IoJ1VuZXhwZWN0ZWQgRmliZXIgcG9wcGVkLicpOwogICAgICB9CiAgICB9CgogICAgY3Vyc29yLmN1cnJlbnQgPSB2YWx1ZVN0YWNrW2luZGV4XTsKICAgIHZhbHVlU3RhY2tbaW5kZXhdID0gbnVsbDsKCiAgICB7CiAgICAgIGZpYmVyU3RhY2tbaW5kZXhdID0gbnVsbDsKICAgIH0KCiAgICBpbmRleC0tOwogIH0KCiAgZnVuY3Rpb24gcHVzaChjdXJzb3IsIHZhbHVlLCBmaWJlcikgewogICAgaW5kZXgrKzsKICAgIHZhbHVlU3RhY2tbaW5kZXhdID0gY3Vyc29yLmN1cnJlbnQ7CgogICAgewogICAgICBmaWJlclN0YWNrW2luZGV4XSA9IGZpYmVyOwogICAgfQoKICAgIGN1cnNvci5jdXJyZW50ID0gdmFsdWU7CiAgfQoKICB2YXIgd2FybmVkQWJvdXRNaXNzaW5nR2V0Q2hpbGRDb250ZXh0OwoKICB7CiAgICB3YXJuZWRBYm91dE1pc3NpbmdHZXRDaGlsZENvbnRleHQgPSB7fTsKICB9CgogIHZhciBlbXB0eUNvbnRleHRPYmplY3QgPSB7fTsKCiAgewogICAgT2JqZWN0LmZyZWV6ZShlbXB0eUNvbnRleHRPYmplY3QpOwogIH0gLy8gQSBjdXJzb3IgdG8gdGhlIGN1cnJlbnQgbWVyZ2VkIGNvbnRleHQgb2JqZWN0IG9uIHRoZSBzdGFjay4KCgogIHZhciBjb250ZXh0U3RhY2tDdXJzb3IgPSBjcmVhdGVDdXJzb3IoZW1wdHlDb250ZXh0T2JqZWN0KTsgLy8gQSBjdXJzb3IgdG8gYSBib29sZWFuIGluZGljYXRpbmcgd2hldGhlciB0aGUgY29udGV4dCBoYXMgY2hhbmdlZC4KCiAgdmFyIGRpZFBlcmZvcm1Xb3JrU3RhY2tDdXJzb3IgPSBjcmVhdGVDdXJzb3IoZmFsc2UpOyAvLyBLZWVwIHRyYWNrIG9mIHRoZSBwcmV2aW91cyBjb250ZXh0IG9iamVjdCB0aGF0IHdhcyBvbiB0aGUgc3RhY2suCiAgLy8gV2UgdXNlIHRoaXMgdG8gZ2V0IGFjY2VzcyB0byB0aGUgcGFyZW50IGNvbnRleHQgYWZ0ZXIgd2UgaGF2ZSBhbHJlYWR5CiAgLy8gcHVzaGVkIHRoZSBuZXh0IGNvbnRleHQgcHJvdmlkZXIsIGFuZCBub3cgbmVlZCB0byBtZXJnZSB0aGVpciBjb250ZXh0cy4KCiAgdmFyIHByZXZpb3VzQ29udGV4dCA9IGVtcHR5Q29udGV4dE9iamVjdDsKCiAgZnVuY3Rpb24gZ2V0VW5tYXNrZWRDb250ZXh0KHdvcmtJblByb2dyZXNzLCBDb21wb25lbnQsIGRpZFB1c2hPd25Db250ZXh0SWZQcm92aWRlcikgewogICAgewogICAgICBpZiAoZGlkUHVzaE93bkNvbnRleHRJZlByb3ZpZGVyICYmIGlzQ29udGV4dFByb3ZpZGVyKENvbXBvbmVudCkpIHsKICAgICAgICAvLyBJZiB0aGUgZmliZXIgaXMgYSBjb250ZXh0IHByb3ZpZGVyIGl0c2VsZiwgd2hlbiB3ZSByZWFkIGl0cyBjb250ZXh0CiAgICAgICAgLy8gd2UgbWF5IGhhdmUgYWxyZWFkeSBwdXNoZWQgaXRzIG93biBjaGlsZCBjb250ZXh0IG9uIHRoZSBzdGFjay4gQSBjb250ZXh0CiAgICAgICAgLy8gcHJvdmlkZXIgc2hvdWxkIG5vdCAic2VlIiBpdHMgb3duIGNoaWxkIGNvbnRleHQuIFRoZXJlZm9yZSB3ZSByZWFkIHRoZQogICAgICAgIC8vIHByZXZpb3VzIChwYXJlbnQpIGNvbnRleHQgaW5zdGVhZCBmb3IgYSBjb250ZXh0IHByb3ZpZGVyLgogICAgICAgIHJldHVybiBwcmV2aW91c0NvbnRleHQ7CiAgICAgIH0KCiAgICAgIHJldHVybiBjb250ZXh0U3RhY2tDdXJzb3IuY3VycmVudDsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGNhY2hlQ29udGV4dCh3b3JrSW5Qcm9ncmVzcywgdW5tYXNrZWRDb250ZXh0LCBtYXNrZWRDb250ZXh0KSB7CiAgICB7CiAgICAgIHZhciBpbnN0YW5jZSA9IHdvcmtJblByb2dyZXNzLnN0YXRlTm9kZTsKICAgICAgaW5zdGFuY2UuX19yZWFjdEludGVybmFsTWVtb2l6ZWRVbm1hc2tlZENoaWxkQ29udGV4dCA9IHVubWFza2VkQ29udGV4dDsKICAgICAgaW5zdGFuY2UuX19yZWFjdEludGVybmFsTWVtb2l6ZWRNYXNrZWRDaGlsZENvbnRleHQgPSBtYXNrZWRDb250ZXh0OwogICAgfQogIH0KCiAgZnVuY3Rpb24gZ2V0TWFza2VkQ29udGV4dCh3b3JrSW5Qcm9ncmVzcywgdW5tYXNrZWRDb250ZXh0KSB7CiAgICB7CiAgICAgIHZhciB0eXBlID0gd29ya0luUHJvZ3Jlc3MudHlwZTsKICAgICAgdmFyIGNvbnRleHRUeXBlcyA9IHR5cGUuY29udGV4dFR5cGVzOwoKICAgICAgaWYgKCFjb250ZXh0VHlwZXMpIHsKICAgICAgICByZXR1cm4gZW1wdHlDb250ZXh0T2JqZWN0OwogICAgICB9IC8vIEF2b2lkIHJlY3JlYXRpbmcgbWFza2VkIGNvbnRleHQgdW5sZXNzIHVubWFza2VkIGNvbnRleHQgaGFzIGNoYW5nZWQuCiAgICAgIC8vIEZhaWxpbmcgdG8gZG8gdGhpcyB3aWxsIHJlc3VsdCBpbiB1bm5lY2Vzc2FyeSBjYWxscyB0byBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzLgogICAgICAvLyBUaGlzIG1heSB0cmlnZ2VyIGluZmluaXRlIGxvb3BzIGlmIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMgY2FsbHMgc2V0U3RhdGUuCgoKICAgICAgdmFyIGluc3RhbmNlID0gd29ya0luUHJvZ3Jlc3Muc3RhdGVOb2RlOwoKICAgICAgaWYgKGluc3RhbmNlICYmIGluc3RhbmNlLl9fcmVhY3RJbnRlcm5hbE1lbW9pemVkVW5tYXNrZWRDaGlsZENvbnRleHQgPT09IHVubWFza2VkQ29udGV4dCkgewogICAgICAgIHJldHVybiBpbnN0YW5jZS5fX3JlYWN0SW50ZXJuYWxNZW1vaXplZE1hc2tlZENoaWxkQ29udGV4dDsKICAgICAgfQoKICAgICAgdmFyIGNvbnRleHQgPSB7fTsKCiAgICAgIGZvciAodmFyIGtleSBpbiBjb250ZXh0VHlwZXMpIHsKICAgICAgICBjb250ZXh0W2tleV0gPSB1bm1hc2tlZENvbnRleHRba2V5XTsKICAgICAgfQoKICAgICAgewogICAgICAgIHZhciBuYW1lID0gZ2V0Q29tcG9uZW50TmFtZUZyb21GaWJlcih3b3JrSW5Qcm9ncmVzcykgfHwgJ1Vua25vd24nOwogICAgICAgIGNoZWNrUHJvcFR5cGVzKGNvbnRleHRUeXBlcywgY29udGV4dCwgJ2NvbnRleHQnLCBuYW1lKTsKICAgICAgfSAvLyBDYWNoZSB1bm1hc2tlZCBjb250ZXh0IHNvIHdlIGNhbiBhdm9pZCByZWNyZWF0aW5nIG1hc2tlZCBjb250ZXh0IHVubGVzcyBuZWNlc3NhcnkuCiAgICAgIC8vIENvbnRleHQgaXMgY3JlYXRlZCBiZWZvcmUgdGhlIGNsYXNzIGNvbXBvbmVudCBpcyBpbnN0YW50aWF0ZWQgc28gY2hlY2sgZm9yIGluc3RhbmNlLgoKCiAgICAgIGlmIChpbnN0YW5jZSkgewogICAgICAgIGNhY2hlQ29udGV4dCh3b3JrSW5Qcm9ncmVzcywgdW5tYXNrZWRDb250ZXh0LCBjb250ZXh0KTsKICAgICAgfQoKICAgICAgcmV0dXJuIGNvbnRleHQ7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBoYXNDb250ZXh0Q2hhbmdlZCgpIHsKICAgIHsKICAgICAgcmV0dXJuIGRpZFBlcmZvcm1Xb3JrU3RhY2tDdXJzb3IuY3VycmVudDsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGlzQ29udGV4dFByb3ZpZGVyKHR5cGUpIHsKICAgIHsKICAgICAgdmFyIGNoaWxkQ29udGV4dFR5cGVzID0gdHlwZS5jaGlsZENvbnRleHRUeXBlczsKICAgICAgcmV0dXJuIGNoaWxkQ29udGV4dFR5cGVzICE9PSBudWxsICYmIGNoaWxkQ29udGV4dFR5cGVzICE9PSB1bmRlZmluZWQ7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBwb3BDb250ZXh0KGZpYmVyKSB7CiAgICB7CiAgICAgIHBvcChkaWRQZXJmb3JtV29ya1N0YWNrQ3Vyc29yLCBmaWJlcik7CiAgICAgIHBvcChjb250ZXh0U3RhY2tDdXJzb3IsIGZpYmVyKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHBvcFRvcExldmVsQ29udGV4dE9iamVjdChmaWJlcikgewogICAgewogICAgICBwb3AoZGlkUGVyZm9ybVdvcmtTdGFja0N1cnNvciwgZmliZXIpOwogICAgICBwb3AoY29udGV4dFN0YWNrQ3Vyc29yLCBmaWJlcik7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBwdXNoVG9wTGV2ZWxDb250ZXh0T2JqZWN0KGZpYmVyLCBjb250ZXh0LCBkaWRDaGFuZ2UpIHsKICAgIHsKICAgICAgaWYgKGNvbnRleHRTdGFja0N1cnNvci5jdXJyZW50ICE9PSBlbXB0eUNvbnRleHRPYmplY3QpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuZXhwZWN0ZWQgY29udGV4dCBmb3VuZCBvbiBzdGFjay4gJyArICdUaGlzIGVycm9yIGlzIGxpa2VseSBjYXVzZWQgYnkgYSBidWcgaW4gUmVhY3QuIFBsZWFzZSBmaWxlIGFuIGlzc3VlLicpOwogICAgICB9CgogICAgICBwdXNoKGNvbnRleHRTdGFja0N1cnNvciwgY29udGV4dCwgZmliZXIpOwogICAgICBwdXNoKGRpZFBlcmZvcm1Xb3JrU3RhY2tDdXJzb3IsIGRpZENoYW5nZSwgZmliZXIpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gcHJvY2Vzc0NoaWxkQ29udGV4dChmaWJlciwgdHlwZSwgcGFyZW50Q29udGV4dCkgewogICAgewogICAgICB2YXIgaW5zdGFuY2UgPSBmaWJlci5zdGF0ZU5vZGU7CiAgICAgIHZhciBjaGlsZENvbnRleHRUeXBlcyA9IHR5cGUuY2hpbGRDb250ZXh0VHlwZXM7IC8vIFRPRE8gKGJ2YXVnaG4pIFJlcGxhY2UgdGhpcyBiZWhhdmlvciB3aXRoIGFuIGludmFyaWFudCgpIGluIHRoZSBmdXR1cmUuCiAgICAgIC8vIEl0IGhhcyBvbmx5IGJlZW4gYWRkZWQgaW4gRmliZXIgdG8gbWF0Y2ggdGhlICh1bmludGVudGlvbmFsKSBiZWhhdmlvciBpbiBTdGFjay4KCiAgICAgIGlmICh0eXBlb2YgaW5zdGFuY2UuZ2V0Q2hpbGRDb250ZXh0ICE9PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgewogICAgICAgICAgdmFyIGNvbXBvbmVudE5hbWUgPSBnZXRDb21wb25lbnROYW1lRnJvbUZpYmVyKGZpYmVyKSB8fCAnVW5rbm93bic7CgogICAgICAgICAgaWYgKCF3YXJuZWRBYm91dE1pc3NpbmdHZXRDaGlsZENvbnRleHRbY29tcG9uZW50TmFtZV0pIHsKICAgICAgICAgICAgd2FybmVkQWJvdXRNaXNzaW5nR2V0Q2hpbGRDb250ZXh0W2NvbXBvbmVudE5hbWVdID0gdHJ1ZTsKCiAgICAgICAgICAgIGVycm9yKCclcy5jaGlsZENvbnRleHRUeXBlcyBpcyBzcGVjaWZpZWQgYnV0IHRoZXJlIGlzIG5vIGdldENoaWxkQ29udGV4dCgpIG1ldGhvZCAnICsgJ29uIHRoZSBpbnN0YW5jZS4gWW91IGNhbiBlaXRoZXIgZGVmaW5lIGdldENoaWxkQ29udGV4dCgpIG9uICVzIG9yIHJlbW92ZSAnICsgJ2NoaWxkQ29udGV4dFR5cGVzIGZyb20gaXQuJywgY29tcG9uZW50TmFtZSwgY29tcG9uZW50TmFtZSk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gcGFyZW50Q29udGV4dDsKICAgICAgfQoKICAgICAgdmFyIGNoaWxkQ29udGV4dCA9IGluc3RhbmNlLmdldENoaWxkQ29udGV4dCgpOwoKICAgICAgZm9yICh2YXIgY29udGV4dEtleSBpbiBjaGlsZENvbnRleHQpIHsKICAgICAgICBpZiAoIShjb250ZXh0S2V5IGluIGNoaWxkQ29udGV4dFR5cGVzKSkgewogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKChnZXRDb21wb25lbnROYW1lRnJvbUZpYmVyKGZpYmVyKSB8fCAnVW5rbm93bicpICsgIi5nZXRDaGlsZENvbnRleHQoKToga2V5IFwiIiArIGNvbnRleHRLZXkgKyAiXCIgaXMgbm90IGRlZmluZWQgaW4gY2hpbGRDb250ZXh0VHlwZXMuIik7CiAgICAgICAgfQogICAgICB9CgogICAgICB7CiAgICAgICAgdmFyIG5hbWUgPSBnZXRDb21wb25lbnROYW1lRnJvbUZpYmVyKGZpYmVyKSB8fCAnVW5rbm93bic7CiAgICAgICAgY2hlY2tQcm9wVHlwZXMoY2hpbGRDb250ZXh0VHlwZXMsIGNoaWxkQ29udGV4dCwgJ2NoaWxkIGNvbnRleHQnLCBuYW1lKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGFzc2lnbih7fSwgcGFyZW50Q29udGV4dCwgY2hpbGRDb250ZXh0KTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHB1c2hDb250ZXh0UHJvdmlkZXIod29ya0luUHJvZ3Jlc3MpIHsKICAgIHsKICAgICAgdmFyIGluc3RhbmNlID0gd29ya0luUHJvZ3Jlc3Muc3RhdGVOb2RlOyAvLyBXZSBwdXNoIHRoZSBjb250ZXh0IGFzIGVhcmx5IGFzIHBvc3NpYmxlIHRvIGVuc3VyZSBzdGFjayBpbnRlZ3JpdHkuCiAgICAgIC8vIElmIHRoZSBpbnN0YW5jZSBkb2VzIG5vdCBleGlzdCB5ZXQsIHdlIHdpbGwgcHVzaCBudWxsIGF0IGZpcnN0LAogICAgICAvLyBhbmQgcmVwbGFjZSBpdCBvbiB0aGUgc3RhY2sgbGF0ZXIgd2hlbiBpbnZhbGlkYXRpbmcgdGhlIGNvbnRleHQuCgogICAgICB2YXIgbWVtb2l6ZWRNZXJnZWRDaGlsZENvbnRleHQgPSBpbnN0YW5jZSAmJiBpbnN0YW5jZS5fX3JlYWN0SW50ZXJuYWxNZW1vaXplZE1lcmdlZENoaWxkQ29udGV4dCB8fCBlbXB0eUNvbnRleHRPYmplY3Q7IC8vIFJlbWVtYmVyIHRoZSBwYXJlbnQgY29udGV4dCBzbyB3ZSBjYW4gbWVyZ2Ugd2l0aCBpdCBsYXRlci4KICAgICAgLy8gSW5oZXJpdCB0aGUgcGFyZW50J3MgZGlkLXBlcmZvcm0td29yayB2YWx1ZSB0byBhdm9pZCBpbmFkdmVydGVudGx5IGJsb2NraW5nIHVwZGF0ZXMuCgogICAgICBwcmV2aW91c0NvbnRleHQgPSBjb250ZXh0U3RhY2tDdXJzb3IuY3VycmVudDsKICAgICAgcHVzaChjb250ZXh0U3RhY2tDdXJzb3IsIG1lbW9pemVkTWVyZ2VkQ2hpbGRDb250ZXh0LCB3b3JrSW5Qcm9ncmVzcyk7CiAgICAgIHB1c2goZGlkUGVyZm9ybVdvcmtTdGFja0N1cnNvciwgZGlkUGVyZm9ybVdvcmtTdGFja0N1cnNvci5jdXJyZW50LCB3b3JrSW5Qcm9ncmVzcyk7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogIH0KCiAgZnVuY3Rpb24gaW52YWxpZGF0ZUNvbnRleHRQcm92aWRlcih3b3JrSW5Qcm9ncmVzcywgdHlwZSwgZGlkQ2hhbmdlKSB7CiAgICB7CiAgICAgIHZhciBpbnN0YW5jZSA9IHdvcmtJblByb2dyZXNzLnN0YXRlTm9kZTsKCiAgICAgIGlmICghaW5zdGFuY2UpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0V4cGVjdGVkIHRvIGhhdmUgYW4gaW5zdGFuY2UgYnkgdGhpcyBwb2ludC4gJyArICdUaGlzIGVycm9yIGlzIGxpa2VseSBjYXVzZWQgYnkgYSBidWcgaW4gUmVhY3QuIFBsZWFzZSBmaWxlIGFuIGlzc3VlLicpOwogICAgICB9CgogICAgICBpZiAoZGlkQ2hhbmdlKSB7CiAgICAgICAgLy8gTWVyZ2UgcGFyZW50IGFuZCBvd24gY29udGV4dC4KICAgICAgICAvLyBTa2lwIHRoaXMgaWYgd2UncmUgbm90IHVwZGF0aW5nIGR1ZSB0byBzQ1UuCiAgICAgICAgLy8gVGhpcyBhdm9pZHMgdW5uZWNlc3NhcmlseSByZWNvbXB1dGluZyBtZW1vaXplZCB2YWx1ZXMuCiAgICAgICAgdmFyIG1lcmdlZENvbnRleHQgPSBwcm9jZXNzQ2hpbGRDb250ZXh0KHdvcmtJblByb2dyZXNzLCB0eXBlLCBwcmV2aW91c0NvbnRleHQpOwogICAgICAgIGluc3RhbmNlLl9fcmVhY3RJbnRlcm5hbE1lbW9pemVkTWVyZ2VkQ2hpbGRDb250ZXh0ID0gbWVyZ2VkQ29udGV4dDsgLy8gUmVwbGFjZSB0aGUgb2xkIChvciBlbXB0eSkgY29udGV4dCB3aXRoIHRoZSBuZXcgb25lLgogICAgICAgIC8vIEl0IGlzIGltcG9ydGFudCB0byB1bndpbmQgdGhlIGNvbnRleHQgaW4gdGhlIHJldmVyc2Ugb3JkZXIuCgogICAgICAgIHBvcChkaWRQZXJmb3JtV29ya1N0YWNrQ3Vyc29yLCB3b3JrSW5Qcm9ncmVzcyk7CiAgICAgICAgcG9wKGNvbnRleHRTdGFja0N1cnNvciwgd29ya0luUHJvZ3Jlc3MpOyAvLyBOb3cgcHVzaCB0aGUgbmV3IGNvbnRleHQgYW5kIG1hcmsgdGhhdCBpdCBoYXMgY2hhbmdlZC4KCiAgICAgICAgcHVzaChjb250ZXh0U3RhY2tDdXJzb3IsIG1lcmdlZENvbnRleHQsIHdvcmtJblByb2dyZXNzKTsKICAgICAgICBwdXNoKGRpZFBlcmZvcm1Xb3JrU3RhY2tDdXJzb3IsIGRpZENoYW5nZSwgd29ya0luUHJvZ3Jlc3MpOwogICAgICB9IGVsc2UgewogICAgICAgIHBvcChkaWRQZXJmb3JtV29ya1N0YWNrQ3Vyc29yLCB3b3JrSW5Qcm9ncmVzcyk7CiAgICAgICAgcHVzaChkaWRQZXJmb3JtV29ya1N0YWNrQ3Vyc29yLCBkaWRDaGFuZ2UsIHdvcmtJblByb2dyZXNzKTsKICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gZmluZEN1cnJlbnRVbm1hc2tlZENvbnRleHQoZmliZXIpIHsKICAgIHsKICAgICAgLy8gQ3VycmVudGx5IHRoaXMgaXMgb25seSB1c2VkIHdpdGggcmVuZGVyU3VidHJlZUludG9Db250YWluZXI7IG5vdCBzdXJlIGlmIGl0CiAgICAgIC8vIG1ha2VzIHNlbnNlIGVsc2V3aGVyZQogICAgICBpZiAoIWlzRmliZXJNb3VudGVkKGZpYmVyKSB8fCBmaWJlci50YWcgIT09IENsYXNzQ29tcG9uZW50KSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdFeHBlY3RlZCBzdWJ0cmVlIHBhcmVudCB0byBiZSBhIG1vdW50ZWQgY2xhc3MgY29tcG9uZW50LiAnICsgJ1RoaXMgZXJyb3IgaXMgbGlrZWx5IGNhdXNlZCBieSBhIGJ1ZyBpbiBSZWFjdC4gUGxlYXNlIGZpbGUgYW4gaXNzdWUuJyk7CiAgICAgIH0KCiAgICAgIHZhciBub2RlID0gZmliZXI7CgogICAgICBkbyB7CiAgICAgICAgc3dpdGNoIChub2RlLnRhZykgewogICAgICAgICAgY2FzZSBIb3N0Um9vdDoKICAgICAgICAgICAgcmV0dXJuIG5vZGUuc3RhdGVOb2RlLmNvbnRleHQ7CgogICAgICAgICAgY2FzZSBDbGFzc0NvbXBvbmVudDoKICAgICAgICAgICAgewogICAgICAgICAgICAgIHZhciBDb21wb25lbnQgPSBub2RlLnR5cGU7CgogICAgICAgICAgICAgIGlmIChpc0NvbnRleHRQcm92aWRlcihDb21wb25lbnQpKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbm9kZS5zdGF0ZU5vZGUuX19yZWFjdEludGVybmFsTWVtb2l6ZWRNZXJnZWRDaGlsZENvbnRleHQ7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgbm9kZSA9IG5vZGUucmV0dXJuOwogICAgICB9IHdoaWxlIChub2RlICE9PSBudWxsKTsKCiAgICAgIHRocm93IG5ldyBFcnJvcignRm91bmQgdW5leHBlY3RlZCBkZXRhY2hlZCBzdWJ0cmVlIHBhcmVudC4gJyArICdUaGlzIGVycm9yIGlzIGxpa2VseSBjYXVzZWQgYnkgYSBidWcgaW4gUmVhY3QuIFBsZWFzZSBmaWxlIGFuIGlzc3VlLicpOwogICAgfQogIH0KCiAgdmFyIExlZ2FjeVJvb3QgPSAwOwogIHZhciBDb25jdXJyZW50Um9vdCA9IDE7CgogIHZhciBzeW5jUXVldWUgPSBudWxsOwogIHZhciBpbmNsdWRlc0xlZ2FjeVN5bmNDYWxsYmFja3MgPSBmYWxzZTsKICB2YXIgaXNGbHVzaGluZ1N5bmNRdWV1ZSA9IGZhbHNlOwogIGZ1bmN0aW9uIHNjaGVkdWxlU3luY0NhbGxiYWNrKGNhbGxiYWNrKSB7CiAgICAvLyBQdXNoIHRoaXMgY2FsbGJhY2sgaW50byBhbiBpbnRlcm5hbCBxdWV1ZS4gV2UnbGwgZmx1c2ggdGhlc2UgZWl0aGVyIGluCiAgICAvLyB0aGUgbmV4dCB0aWNrLCBvciBlYXJsaWVyIGlmIHNvbWV0aGluZyBjYWxscyBgZmx1c2hTeW5jQ2FsbGJhY2tRdWV1ZWAuCiAgICBpZiAoc3luY1F1ZXVlID09PSBudWxsKSB7CiAgICAgIHN5bmNRdWV1ZSA9IFtjYWxsYmFja107CiAgICB9IGVsc2UgewogICAgICAvLyBQdXNoIG9udG8gZXhpc3RpbmcgcXVldWUuIERvbid0IG5lZWQgdG8gc2NoZWR1bGUgYSBjYWxsYmFjayBiZWNhdXNlCiAgICAgIC8vIHdlIGFscmVhZHkgc2NoZWR1bGVkIG9uZSB3aGVuIHdlIGNyZWF0ZWQgdGhlIHF1ZXVlLgogICAgICBzeW5jUXVldWUucHVzaChjYWxsYmFjayk7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHNjaGVkdWxlTGVnYWN5U3luY0NhbGxiYWNrKGNhbGxiYWNrKSB7CiAgICBpbmNsdWRlc0xlZ2FjeVN5bmNDYWxsYmFja3MgPSB0cnVlOwogICAgc2NoZWR1bGVTeW5jQ2FsbGJhY2soY2FsbGJhY2spOwogIH0KICBmdW5jdGlvbiBmbHVzaFN5bmNDYWxsYmFja3NPbmx5SW5MZWdhY3lNb2RlKCkgewogICAgLy8gT25seSBmbHVzaGVzIHRoZSBxdWV1ZSBpZiB0aGVyZSdzIGEgbGVnYWN5IHN5bmMgY2FsbGJhY2sgc2NoZWR1bGVkLgogICAgLy8gVE9ETzogVGhlcmUncyBvbmx5IGEgc2luZ2xlIHR5cGUgb2YgY2FsbGJhY2s6IHBlcmZvcm1TeW5jT25Xb3JrT25Sb290LiBTbwogICAgLy8gaXQgbWlnaHQgbWFrZSBtb3JlIHNlbnNlIGZvciB0aGUgcXVldWUgdG8gYmUgYSBsaXN0IG9mIHJvb3RzIGluc3RlYWQgb2YgYQogICAgLy8gbGlzdCBvZiBnZW5lcmljIGNhbGxiYWNrcy4gVGhlbiB3ZSBjYW4gaGF2ZSB0d286IG9uZSBmb3IgbGVnYWN5IHJvb3RzLCBvbmUKICAgIC8vIGZvciBjb25jdXJyZW50IHJvb3RzLiBBbmQgdGhpcyBtZXRob2Qgd291bGQgb25seSBmbHVzaCB0aGUgbGVnYWN5IG9uZXMuCiAgICBpZiAoaW5jbHVkZXNMZWdhY3lTeW5jQ2FsbGJhY2tzKSB7CiAgICAgIGZsdXNoU3luY0NhbGxiYWNrcygpOwogICAgfQogIH0KICBmdW5jdGlvbiBmbHVzaFN5bmNDYWxsYmFja3MoKSB7CiAgICBpZiAoIWlzRmx1c2hpbmdTeW5jUXVldWUgJiYgc3luY1F1ZXVlICE9PSBudWxsKSB7CiAgICAgIC8vIFByZXZlbnQgcmUtZW50cmFuY2UuCiAgICAgIGlzRmx1c2hpbmdTeW5jUXVldWUgPSB0cnVlOwogICAgICB2YXIgaSA9IDA7CiAgICAgIHZhciBwcmV2aW91c1VwZGF0ZVByaW9yaXR5ID0gZ2V0Q3VycmVudFVwZGF0ZVByaW9yaXR5KCk7CgogICAgICB0cnkgewogICAgICAgIHZhciBpc1N5bmMgPSB0cnVlOwogICAgICAgIHZhciBxdWV1ZSA9IHN5bmNRdWV1ZTsgLy8gVE9ETzogSXMgdGhpcyBuZWNlc3NhcnkgYW55bW9yZT8gVGhlIG9ubHkgdXNlciBjb2RlIHRoYXQgcnVucyBpbiB0aGlzCiAgICAgICAgLy8gcXVldWUgaXMgaW4gdGhlIHJlbmRlciBvciBjb21taXQgcGhhc2VzLgoKICAgICAgICBzZXRDdXJyZW50VXBkYXRlUHJpb3JpdHkoRGlzY3JldGVFdmVudFByaW9yaXR5KTsKCiAgICAgICAgZm9yICg7IGkgPCBxdWV1ZS5sZW5ndGg7IGkrKykgewogICAgICAgICAgdmFyIGNhbGxiYWNrID0gcXVldWVbaV07CgogICAgICAgICAgZG8gewogICAgICAgICAgICBjYWxsYmFjayA9IGNhbGxiYWNrKGlzU3luYyk7CiAgICAgICAgICB9IHdoaWxlIChjYWxsYmFjayAhPT0gbnVsbCk7CiAgICAgICAgfQoKICAgICAgICBzeW5jUXVldWUgPSBudWxsOwogICAgICAgIGluY2x1ZGVzTGVnYWN5U3luY0NhbGxiYWNrcyA9IGZhbHNlOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIC8vIElmIHNvbWV0aGluZyB0aHJvd3MsIGxlYXZlIHRoZSByZW1haW5pbmcgY2FsbGJhY2tzIG9uIHRoZSBxdWV1ZS4KICAgICAgICBpZiAoc3luY1F1ZXVlICE9PSBudWxsKSB7CiAgICAgICAgICBzeW5jUXVldWUgPSBzeW5jUXVldWUuc2xpY2UoaSArIDEpOwogICAgICAgIH0gLy8gUmVzdW1lIGZsdXNoaW5nIGluIHRoZSBuZXh0IHRpY2sKCgogICAgICAgIHNjaGVkdWxlQ2FsbGJhY2soSW1tZWRpYXRlUHJpb3JpdHksIGZsdXNoU3luY0NhbGxiYWNrcyk7CiAgICAgICAgdGhyb3cgZXJyb3I7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgc2V0Q3VycmVudFVwZGF0ZVByaW9yaXR5KHByZXZpb3VzVXBkYXRlUHJpb3JpdHkpOwogICAgICAgIGlzRmx1c2hpbmdTeW5jUXVldWUgPSBmYWxzZTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBudWxsOwogIH0KCiAgLy8gVE9ETzogVXNlIHRoZSB1bmlmaWVkIGZpYmVyIHN0YWNrIG1vZHVsZSBpbnN0ZWFkIG9mIHRoaXMgbG9jYWwgb25lPwogIC8vIEludGVudGlvbmFsbHkgbm90IHVzaW5nIGl0IHlldCB0byBkZXJpc2sgdGhlIGluaXRpYWwgaW1wbGVtZW50YXRpb24sIGJlY2F1c2UKICAvLyB0aGUgd2F5IHdlIHB1c2gvcG9wIHRoZXNlIHZhbHVlcyBpcyBhIGJpdCB1bnVzdWFsLiBJZiB0aGVyZSdzIGEgbWlzdGFrZSwgSSdkCiAgLy8gcmF0aGVyIHRoZSBpZHMgYmUgd3JvbmcgdGhhbiBjcmFzaCB0aGUgd2hvbGUgcmVjb25jaWxlci4KICB2YXIgZm9ya1N0YWNrID0gW107CiAgdmFyIGZvcmtTdGFja0luZGV4ID0gMDsKICB2YXIgdHJlZUZvcmtQcm92aWRlciA9IG51bGw7CiAgdmFyIHRyZWVGb3JrQ291bnQgPSAwOwogIHZhciBpZFN0YWNrID0gW107CiAgdmFyIGlkU3RhY2tJbmRleCA9IDA7CiAgdmFyIHRyZWVDb250ZXh0UHJvdmlkZXIgPSBudWxsOwogIHZhciB0cmVlQ29udGV4dElkID0gMTsKICB2YXIgdHJlZUNvbnRleHRPdmVyZmxvdyA9ICcnOwogIGZ1bmN0aW9uIGlzRm9ya2VkQ2hpbGQod29ya0luUHJvZ3Jlc3MpIHsKICAgIHdhcm5JZk5vdEh5ZHJhdGluZygpOwogICAgcmV0dXJuICh3b3JrSW5Qcm9ncmVzcy5mbGFncyAmIEZvcmtlZCkgIT09IE5vRmxhZ3M7CiAgfQogIGZ1bmN0aW9uIGdldEZvcmtzQXRMZXZlbCh3b3JrSW5Qcm9ncmVzcykgewogICAgd2FybklmTm90SHlkcmF0aW5nKCk7CiAgICByZXR1cm4gdHJlZUZvcmtDb3VudDsKICB9CiAgZnVuY3Rpb24gZ2V0VHJlZUlkKCkgewogICAgdmFyIG92ZXJmbG93ID0gdHJlZUNvbnRleHRPdmVyZmxvdzsKICAgIHZhciBpZFdpdGhMZWFkaW5nQml0ID0gdHJlZUNvbnRleHRJZDsKICAgIHZhciBpZCA9IGlkV2l0aExlYWRpbmdCaXQgJiB+Z2V0TGVhZGluZ0JpdChpZFdpdGhMZWFkaW5nQml0KTsKICAgIHJldHVybiBpZC50b1N0cmluZygzMikgKyBvdmVyZmxvdzsKICB9CiAgZnVuY3Rpb24gcHVzaFRyZWVGb3JrKHdvcmtJblByb2dyZXNzLCB0b3RhbENoaWxkcmVuKSB7CiAgICAvLyBUaGlzIGlzIGNhbGxlZCByaWdodCBhZnRlciB3ZSByZWNvbmNpbGUgYW4gYXJyYXkgKG9yIGl0ZXJhdG9yKSBvZiBjaGlsZAogICAgLy8gZmliZXJzLCBiZWNhdXNlIHRoYXQncyB0aGUgb25seSBwbGFjZSB3aGVyZSB3ZSBrbm93IGhvdyBtYW55IGNoaWxkcmVuIGluCiAgICAvLyB0aGUgd2hvbGUgc2V0IHdpdGhvdXQgZG9pbmcgZXh0cmEgd29yayBsYXRlciwgb3Igc3RvcmluZyBhZGR0aW9uYWwKICAgIC8vIGluZm9ybWF0aW9uIG9uIHRoZSBmaWJlci4KICAgIC8vCiAgICAvLyBUaGF0J3Mgd2h5IHRoaXMgZnVuY3Rpb24gaXMgc2VwYXJhdGUgZnJvbSBwdXNoVHJlZUlkIOKAlCBpdCdzIGNhbGxlZCBkdXJpbmcKICAgIC8vIHRoZSByZW5kZXIgcGhhc2Ugb2YgdGhlIGZvcmsgcGFyZW50LCBub3QgdGhlIGNoaWxkLCB3aGljaCBpcyB3aGVyZSB3ZSBwdXNoCiAgICAvLyB0aGUgb3RoZXIgY29udGV4dCB2YWx1ZXMuCiAgICAvLwogICAgLy8gSW4gdGhlIEZpenogaW1wbGVtZW50YXRpb24gdGhpcyBpcyBtdWNoIHNpbXBsZXIgYmVjYXVzZSB0aGUgY2hpbGQgaXMKICAgIC8vIHJlbmRlcmVkIGluIHRoZSBzYW1lIGNhbGxzdGFjayBhcyB0aGUgcGFyZW50LgogICAgLy8KICAgIC8vIEl0IG1pZ2h0IGJlIGJldHRlciB0byBqdXN0IGFkZCBhIGBmb3Jrc2AgZmllbGQgdG8gdGhlIEZpYmVyIHR5cGUuIEl0IHdvdWxkCiAgICAvLyBtYWtlIHRoaXMgbW9kdWxlIHNpbXBsZXIuCiAgICB3YXJuSWZOb3RIeWRyYXRpbmcoKTsKICAgIGZvcmtTdGFja1tmb3JrU3RhY2tJbmRleCsrXSA9IHRyZWVGb3JrQ291bnQ7CiAgICBmb3JrU3RhY2tbZm9ya1N0YWNrSW5kZXgrK10gPSB0cmVlRm9ya1Byb3ZpZGVyOwogICAgdHJlZUZvcmtQcm92aWRlciA9IHdvcmtJblByb2dyZXNzOwogICAgdHJlZUZvcmtDb3VudCA9IHRvdGFsQ2hpbGRyZW47CiAgfQogIGZ1bmN0aW9uIHB1c2hUcmVlSWQod29ya0luUHJvZ3Jlc3MsIHRvdGFsQ2hpbGRyZW4sIGluZGV4KSB7CiAgICB3YXJuSWZOb3RIeWRyYXRpbmcoKTsKICAgIGlkU3RhY2tbaWRTdGFja0luZGV4KytdID0gdHJlZUNvbnRleHRJZDsKICAgIGlkU3RhY2tbaWRTdGFja0luZGV4KytdID0gdHJlZUNvbnRleHRPdmVyZmxvdzsKICAgIGlkU3RhY2tbaWRTdGFja0luZGV4KytdID0gdHJlZUNvbnRleHRQcm92aWRlcjsKICAgIHRyZWVDb250ZXh0UHJvdmlkZXIgPSB3b3JrSW5Qcm9ncmVzczsKICAgIHZhciBiYXNlSWRXaXRoTGVhZGluZ0JpdCA9IHRyZWVDb250ZXh0SWQ7CiAgICB2YXIgYmFzZU92ZXJmbG93ID0gdHJlZUNvbnRleHRPdmVyZmxvdzsgLy8gVGhlIGxlZnRtb3N0IDEgbWFya3MgdGhlIGVuZCBvZiB0aGUgc2VxdWVuY2UsIG5vbi1pbmNsdXNpdmUuIEl0J3Mgbm90IHBhcnQKICAgIC8vIG9mIHRoZSBpZDsgd2UgdXNlIGl0IHRvIGFjY291bnQgZm9yIGxlYWRpbmcgMHMuCgogICAgdmFyIGJhc2VMZW5ndGggPSBnZXRCaXRMZW5ndGgoYmFzZUlkV2l0aExlYWRpbmdCaXQpIC0gMTsKICAgIHZhciBiYXNlSWQgPSBiYXNlSWRXaXRoTGVhZGluZ0JpdCAmIH4oMSA8PCBiYXNlTGVuZ3RoKTsKICAgIHZhciBzbG90ID0gaW5kZXggKyAxOwogICAgdmFyIGxlbmd0aCA9IGdldEJpdExlbmd0aCh0b3RhbENoaWxkcmVuKSArIGJhc2VMZW5ndGg7IC8vIDMwIGlzIHRoZSBtYXggbGVuZ3RoIHdlIGNhbiBzdG9yZSB3aXRob3V0IG92ZXJmbG93aW5nLCB0YWtpbmcgaW50bwogICAgLy8gY29uc2lkZXJhdGlvbiB0aGUgbGVhZGluZyAxIHdlIHVzZSB0byBtYXJrIHRoZSBlbmQgb2YgdGhlIHNlcXVlbmNlLgoKICAgIGlmIChsZW5ndGggPiAzMCkgewogICAgICAvLyBXZSBvdmVyZmxvd2VkIHRoZSBiaXR3aXNlLXNhZmUgcmFuZ2UuIEZhbGwgYmFjayB0byBzbG93ZXIgYWxnb3JpdGhtLgogICAgICAvLyBUaGlzIGJyYW5jaCBhc3N1bWVzIHRoZSBsZW5ndGggb2YgdGhlIGJhc2UgaWQgaXMgZ3JlYXRlciB0aGFuIDU7IGl0IHdvbid0CiAgICAgIC8vIHdvcmsgZm9yIHNtYWxsZXIgaWRzLCBiZWNhdXNlIHlvdSBuZWVkIDUgYml0cyBwZXIgY2hhcmFjdGVyLgogICAgICAvLwogICAgICAvLyBXZSBlbmNvZGUgdGhlIGlkIGluIG11bHRpcGxlIHN0ZXBzOiBmaXJzdCB0aGUgYmFzZSBpZCwgdGhlbiB0aGUKICAgICAgLy8gcmVtYWluaW5nIGRpZ2l0cy4KICAgICAgLy8KICAgICAgLy8gRWFjaCA1IGJpdCBzZXF1ZW5jZSBjb3JyZXNwb25kcyB0byBhIHNpbmdsZSBiYXNlIDMyIGNoYXJhY3Rlci4gU28gZm9yCiAgICAgIC8vIGV4YW1wbGUsIGlmIHRoZSBjdXJyZW50IGlkIGlzIDIzIGJpdHMgbG9uZywgd2UgY2FuIGNvbnZlcnQgMjAgb2YgdGhvc2UKICAgICAgLy8gYml0cyBpbnRvIGEgc3RyaW5nIG9mIDQgY2hhcmFjdGVycywgd2l0aCAzIGJpdHMgbGVmdCBvdmVyLgogICAgICAvLwogICAgICAvLyBGaXJzdCBjYWxjdWxhdGUgaG93IG1hbnkgYml0cyBpbiB0aGUgYmFzZSBpZCByZXByZXNlbnQgYSBjb21wbGV0ZQogICAgICAvLyBzZXF1ZW5jZSBvZiBjaGFyYWN0ZXJzLgogICAgICB2YXIgbnVtYmVyT2ZPdmVyZmxvd0JpdHMgPSBiYXNlTGVuZ3RoIC0gYmFzZUxlbmd0aCAlIDU7IC8vIFRoZW4gY3JlYXRlIGEgYml0bWFzayB0aGF0IHNlbGVjdHMgb25seSB0aG9zZSBiaXRzLgoKICAgICAgdmFyIG5ld092ZXJmbG93Qml0cyA9ICgxIDw8IG51bWJlck9mT3ZlcmZsb3dCaXRzKSAtIDE7IC8vIFNlbGVjdCB0aGUgYml0cywgYW5kIGNvbnZlcnQgdGhlbSB0byBhIGJhc2UgMzIgc3RyaW5nLgoKICAgICAgdmFyIG5ld092ZXJmbG93ID0gKGJhc2VJZCAmIG5ld092ZXJmbG93Qml0cykudG9TdHJpbmcoMzIpOyAvLyBOb3cgd2UgY2FuIHJlbW92ZSB0aG9zZSBiaXRzIGZyb20gdGhlIGJhc2UgaWQuCgogICAgICB2YXIgcmVzdE9mQmFzZUlkID0gYmFzZUlkID4+IG51bWJlck9mT3ZlcmZsb3dCaXRzOwogICAgICB2YXIgcmVzdE9mQmFzZUxlbmd0aCA9IGJhc2VMZW5ndGggLSBudW1iZXJPZk92ZXJmbG93Qml0czsgLy8gRmluYWxseSwgZW5jb2RlIHRoZSByZXN0IG9mIHRoZSBiaXRzIHVzaW5nIHRoZSBub3JtYWwgYWxnb3JpdGhtLiBCZWNhdXNlCiAgICAgIC8vIHdlIG1hZGUgbW9yZSByb29tLCB0aGlzIHRpbWUgaXQgd29uJ3Qgb3ZlcmZsb3cuCgogICAgICB2YXIgcmVzdE9mTGVuZ3RoID0gZ2V0Qml0TGVuZ3RoKHRvdGFsQ2hpbGRyZW4pICsgcmVzdE9mQmFzZUxlbmd0aDsKICAgICAgdmFyIHJlc3RPZk5ld0JpdHMgPSBzbG90IDw8IHJlc3RPZkJhc2VMZW5ndGg7CiAgICAgIHZhciBpZCA9IHJlc3RPZk5ld0JpdHMgfCByZXN0T2ZCYXNlSWQ7CiAgICAgIHZhciBvdmVyZmxvdyA9IG5ld092ZXJmbG93ICsgYmFzZU92ZXJmbG93OwogICAgICB0cmVlQ29udGV4dElkID0gMSA8PCByZXN0T2ZMZW5ndGggfCBpZDsKICAgICAgdHJlZUNvbnRleHRPdmVyZmxvdyA9IG92ZXJmbG93OwogICAgfSBlbHNlIHsKICAgICAgLy8gTm9ybWFsIHBhdGgKICAgICAgdmFyIG5ld0JpdHMgPSBzbG90IDw8IGJhc2VMZW5ndGg7CgogICAgICB2YXIgX2lkID0gbmV3Qml0cyB8IGJhc2VJZDsKCiAgICAgIHZhciBfb3ZlcmZsb3cgPSBiYXNlT3ZlcmZsb3c7CiAgICAgIHRyZWVDb250ZXh0SWQgPSAxIDw8IGxlbmd0aCB8IF9pZDsKICAgICAgdHJlZUNvbnRleHRPdmVyZmxvdyA9IF9vdmVyZmxvdzsKICAgIH0KICB9CiAgZnVuY3Rpb24gcHVzaE1hdGVyaWFsaXplZFRyZWVJZCh3b3JrSW5Qcm9ncmVzcykgewogICAgd2FybklmTm90SHlkcmF0aW5nKCk7IC8vIFRoaXMgY29tcG9uZW50IG1hdGVyaWFsaXplZCBhbiBpZC4gVGhpcyB3aWxsIGFmZmVjdCBhbnkgaWRzIHRoYXQgYXBwZWFyCiAgICAvLyBpbiBpdHMgY2hpbGRyZW4uCgogICAgdmFyIHJldHVybkZpYmVyID0gd29ya0luUHJvZ3Jlc3MucmV0dXJuOwoKICAgIGlmIChyZXR1cm5GaWJlciAhPT0gbnVsbCkgewogICAgICB2YXIgbnVtYmVyT2ZGb3JrcyA9IDE7CiAgICAgIHZhciBzbG90SW5kZXggPSAwOwogICAgICBwdXNoVHJlZUZvcmsod29ya0luUHJvZ3Jlc3MsIG51bWJlck9mRm9ya3MpOwogICAgICBwdXNoVHJlZUlkKHdvcmtJblByb2dyZXNzLCBudW1iZXJPZkZvcmtzLCBzbG90SW5kZXgpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gZ2V0Qml0TGVuZ3RoKG51bWJlcikgewogICAgcmV0dXJuIDMyIC0gY2x6MzIobnVtYmVyKTsKICB9CgogIGZ1bmN0aW9uIGdldExlYWRpbmdCaXQoaWQpIHsKICAgIHJldHVybiAxIDw8IGdldEJpdExlbmd0aChpZCkgLSAxOwogIH0KCiAgZnVuY3Rpb24gcG9wVHJlZUNvbnRleHQod29ya0luUHJvZ3Jlc3MpIHsKICAgIC8vIFJlc3RvcmUgdGhlIHByZXZpb3VzIHZhbHVlcy4KICAgIC8vIFRoaXMgaXMgYSBiaXQgbW9yZSBjb21wbGljYXRlZCB0aGFuIG90aGVyIGNvbnRleHQtbGlrZSBtb2R1bGVzIGluIEZpYmVyCiAgICAvLyBiZWNhdXNlIHRoZSBzYW1lIEZpYmVyIG1heSBhcHBlYXIgb24gdGhlIHN0YWNrIG11bHRpcGxlIHRpbWVzIGFuZCBmb3IKICAgIC8vIGRpZmZlcmVudCByZWFzb25zLiBXZSBoYXZlIHRvIGtlZXAgcG9wcGluZyB1bnRpbCB0aGUgd29yay1pbi1wcm9ncmVzcyBpcwogICAgLy8gbm8gbG9uZ2VyIGF0IHRoZSB0b3Agb2YgdGhlIHN0YWNrLgogICAgd2hpbGUgKHdvcmtJblByb2dyZXNzID09PSB0cmVlRm9ya1Byb3ZpZGVyKSB7CiAgICAgIHRyZWVGb3JrUHJvdmlkZXIgPSBmb3JrU3RhY2tbLS1mb3JrU3RhY2tJbmRleF07CiAgICAgIGZvcmtTdGFja1tmb3JrU3RhY2tJbmRleF0gPSBudWxsOwogICAgICB0cmVlRm9ya0NvdW50ID0gZm9ya1N0YWNrWy0tZm9ya1N0YWNrSW5kZXhdOwogICAgICBmb3JrU3RhY2tbZm9ya1N0YWNrSW5kZXhdID0gbnVsbDsKICAgIH0KCiAgICB3aGlsZSAod29ya0luUHJvZ3Jlc3MgPT09IHRyZWVDb250ZXh0UHJvdmlkZXIpIHsKICAgICAgdHJlZUNvbnRleHRQcm92aWRlciA9IGlkU3RhY2tbLS1pZFN0YWNrSW5kZXhdOwogICAgICBpZFN0YWNrW2lkU3RhY2tJbmRleF0gPSBudWxsOwogICAgICB0cmVlQ29udGV4dE92ZXJmbG93ID0gaWRTdGFja1stLWlkU3RhY2tJbmRleF07CiAgICAgIGlkU3RhY2tbaWRTdGFja0luZGV4XSA9IG51bGw7CiAgICAgIHRyZWVDb250ZXh0SWQgPSBpZFN0YWNrWy0taWRTdGFja0luZGV4XTsKICAgICAgaWRTdGFja1tpZFN0YWNrSW5kZXhdID0gbnVsbDsKICAgIH0KICB9CiAgZnVuY3Rpb24gZ2V0U3VzcGVuZGVkVHJlZUNvbnRleHQoKSB7CiAgICB3YXJuSWZOb3RIeWRyYXRpbmcoKTsKCiAgICBpZiAodHJlZUNvbnRleHRQcm92aWRlciAhPT0gbnVsbCkgewogICAgICByZXR1cm4gewogICAgICAgIGlkOiB0cmVlQ29udGV4dElkLAogICAgICAgIG92ZXJmbG93OiB0cmVlQ29udGV4dE92ZXJmbG93CiAgICAgIH07CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KICB9CiAgZnVuY3Rpb24gcmVzdG9yZVN1c3BlbmRlZFRyZWVDb250ZXh0KHdvcmtJblByb2dyZXNzLCBzdXNwZW5kZWRDb250ZXh0KSB7CiAgICB3YXJuSWZOb3RIeWRyYXRpbmcoKTsKICAgIGlkU3RhY2tbaWRTdGFja0luZGV4KytdID0gdHJlZUNvbnRleHRJZDsKICAgIGlkU3RhY2tbaWRTdGFja0luZGV4KytdID0gdHJlZUNvbnRleHRPdmVyZmxvdzsKICAgIGlkU3RhY2tbaWRTdGFja0luZGV4KytdID0gdHJlZUNvbnRleHRQcm92aWRlcjsKICAgIHRyZWVDb250ZXh0SWQgPSBzdXNwZW5kZWRDb250ZXh0LmlkOwogICAgdHJlZUNvbnRleHRPdmVyZmxvdyA9IHN1c3BlbmRlZENvbnRleHQub3ZlcmZsb3c7CiAgICB0cmVlQ29udGV4dFByb3ZpZGVyID0gd29ya0luUHJvZ3Jlc3M7CiAgfQoKICBmdW5jdGlvbiB3YXJuSWZOb3RIeWRyYXRpbmcoKSB7CiAgICB7CiAgICAgIGlmICghZ2V0SXNIeWRyYXRpbmcoKSkgewogICAgICAgIGVycm9yKCdFeHBlY3RlZCB0byBiZSBoeWRyYXRpbmcuIFRoaXMgaXMgYSBidWcgaW4gUmVhY3QuIFBsZWFzZSBmaWxlICcgKyAnYW4gaXNzdWUuJyk7CiAgICAgIH0KICAgIH0KICB9CgogIC8vIFRoaXMgbWF5IGhhdmUgYmVlbiBhbiBpbnNlcnRpb24gb3IgYSBoeWRyYXRpb24uCgogIHZhciBoeWRyYXRpb25QYXJlbnRGaWJlciA9IG51bGw7CiAgdmFyIG5leHRIeWRyYXRhYmxlSW5zdGFuY2UgPSBudWxsOwogIHZhciBpc0h5ZHJhdGluZyA9IGZhbHNlOyAvLyBUaGlzIGZsYWcgYWxsb3dzIGZvciB3YXJuaW5nIHN1cHJlc3Npb24gd2hlbiB3ZSBleHBlY3QgdGhlcmUgdG8gYmUgbWlzbWF0Y2hlcwogIC8vIGR1ZSB0byBlYXJsaWVyIG1pc21hdGNoZXMgb3IgYSBzdXNwZW5kZWQgZmliZXIuCgogIHZhciBkaWRTdXNwZW5kT3JFcnJvckRFViA9IGZhbHNlOyAvLyBIeWRyYXRpb24gZXJyb3JzIHRoYXQgd2VyZSB0aHJvd24gaW5zaWRlIHRoaXMgYm91bmRhcnkKCiAgdmFyIGh5ZHJhdGlvbkVycm9ycyA9IG51bGw7CgogIGZ1bmN0aW9uIHdhcm5JZkh5ZHJhdGluZygpIHsKICAgIHsKICAgICAgaWYgKGlzSHlkcmF0aW5nKSB7CiAgICAgICAgZXJyb3IoJ1dlIHNob3VsZCBub3QgYmUgaHlkcmF0aW5nIGhlcmUuIFRoaXMgaXMgYSBidWcgaW4gUmVhY3QuIFBsZWFzZSBmaWxlIGEgYnVnLicpOwogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiBtYXJrRGlkVGhyb3dXaGlsZUh5ZHJhdGluZ0RFVigpIHsKICAgIHsKICAgICAgZGlkU3VzcGVuZE9yRXJyb3JERVYgPSB0cnVlOwogICAgfQogIH0KICBmdW5jdGlvbiBkaWRTdXNwZW5kT3JFcnJvcldoaWxlSHlkcmF0aW5nREVWKCkgewogICAgewogICAgICByZXR1cm4gZGlkU3VzcGVuZE9yRXJyb3JERVY7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBlbnRlckh5ZHJhdGlvblN0YXRlKGZpYmVyKSB7CgogICAgdmFyIHBhcmVudEluc3RhbmNlID0gZmliZXIuc3RhdGVOb2RlLmNvbnRhaW5lckluZm87CiAgICBuZXh0SHlkcmF0YWJsZUluc3RhbmNlID0gZ2V0Rmlyc3RIeWRyYXRhYmxlQ2hpbGRXaXRoaW5Db250YWluZXIocGFyZW50SW5zdGFuY2UpOwogICAgaHlkcmF0aW9uUGFyZW50RmliZXIgPSBmaWJlcjsKICAgIGlzSHlkcmF0aW5nID0gdHJ1ZTsKICAgIGh5ZHJhdGlvbkVycm9ycyA9IG51bGw7CiAgICBkaWRTdXNwZW5kT3JFcnJvckRFViA9IGZhbHNlOwogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiByZWVudGVySHlkcmF0aW9uU3RhdGVGcm9tRGVoeWRyYXRlZFN1c3BlbnNlSW5zdGFuY2UoZmliZXIsIHN1c3BlbnNlSW5zdGFuY2UsIHRyZWVDb250ZXh0KSB7CgogICAgbmV4dEh5ZHJhdGFibGVJbnN0YW5jZSA9IGdldEZpcnN0SHlkcmF0YWJsZUNoaWxkV2l0aGluU3VzcGVuc2VJbnN0YW5jZShzdXNwZW5zZUluc3RhbmNlKTsKICAgIGh5ZHJhdGlvblBhcmVudEZpYmVyID0gZmliZXI7CiAgICBpc0h5ZHJhdGluZyA9IHRydWU7CiAgICBoeWRyYXRpb25FcnJvcnMgPSBudWxsOwogICAgZGlkU3VzcGVuZE9yRXJyb3JERVYgPSBmYWxzZTsKCiAgICBpZiAodHJlZUNvbnRleHQgIT09IG51bGwpIHsKICAgICAgcmVzdG9yZVN1c3BlbmRlZFRyZWVDb250ZXh0KGZpYmVyLCB0cmVlQ29udGV4dCk7CiAgICB9CgogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiB3YXJuVW5oeWRyYXRlZEluc3RhbmNlKHJldHVybkZpYmVyLCBpbnN0YW5jZSkgewogICAgewogICAgICBzd2l0Y2ggKHJldHVybkZpYmVyLnRhZykgewogICAgICAgIGNhc2UgSG9zdFJvb3Q6CiAgICAgICAgICB7CiAgICAgICAgICAgIGRpZE5vdEh5ZHJhdGVJbnN0YW5jZVdpdGhpbkNvbnRhaW5lcihyZXR1cm5GaWJlci5zdGF0ZU5vZGUuY29udGFpbmVySW5mbywgaW5zdGFuY2UpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgY2FzZSBIb3N0Q29tcG9uZW50OgogICAgICAgICAgewogICAgICAgICAgICB2YXIgaXNDb25jdXJyZW50TW9kZSA9IChyZXR1cm5GaWJlci5tb2RlICYgQ29uY3VycmVudE1vZGUpICE9PSBOb01vZGU7CiAgICAgICAgICAgIGRpZE5vdEh5ZHJhdGVJbnN0YW5jZShyZXR1cm5GaWJlci50eXBlLCByZXR1cm5GaWJlci5tZW1vaXplZFByb3BzLCByZXR1cm5GaWJlci5zdGF0ZU5vZGUsIGluc3RhbmNlLCAvLyBUT0RPOiBEZWxldGUgdGhpcyBhcmd1bWVudCB3aGVuIHdlIHJlbW92ZSB0aGUgbGVnYWN5IHJvb3QgQVBJLgogICAgICAgICAgICBpc0NvbmN1cnJlbnRNb2RlKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgIGNhc2UgU3VzcGVuc2VDb21wb25lbnQ6CiAgICAgICAgICB7CiAgICAgICAgICAgIHZhciBzdXNwZW5zZVN0YXRlID0gcmV0dXJuRmliZXIubWVtb2l6ZWRTdGF0ZTsKICAgICAgICAgICAgaWYgKHN1c3BlbnNlU3RhdGUuZGVoeWRyYXRlZCAhPT0gbnVsbCkgZGlkTm90SHlkcmF0ZUluc3RhbmNlV2l0aGluU3VzcGVuc2VJbnN0YW5jZShzdXNwZW5zZVN0YXRlLmRlaHlkcmF0ZWQsIGluc3RhbmNlKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIGRlbGV0ZUh5ZHJhdGFibGVJbnN0YW5jZShyZXR1cm5GaWJlciwgaW5zdGFuY2UpIHsKICAgIHdhcm5Vbmh5ZHJhdGVkSW5zdGFuY2UocmV0dXJuRmliZXIsIGluc3RhbmNlKTsKICAgIHZhciBjaGlsZFRvRGVsZXRlID0gY3JlYXRlRmliZXJGcm9tSG9zdEluc3RhbmNlRm9yRGVsZXRpb24oKTsKICAgIGNoaWxkVG9EZWxldGUuc3RhdGVOb2RlID0gaW5zdGFuY2U7CiAgICBjaGlsZFRvRGVsZXRlLnJldHVybiA9IHJldHVybkZpYmVyOwogICAgdmFyIGRlbGV0aW9ucyA9IHJldHVybkZpYmVyLmRlbGV0aW9uczsKCiAgICBpZiAoZGVsZXRpb25zID09PSBudWxsKSB7CiAgICAgIHJldHVybkZpYmVyLmRlbGV0aW9ucyA9IFtjaGlsZFRvRGVsZXRlXTsKICAgICAgcmV0dXJuRmliZXIuZmxhZ3MgfD0gQ2hpbGREZWxldGlvbjsKICAgIH0gZWxzZSB7CiAgICAgIGRlbGV0aW9ucy5wdXNoKGNoaWxkVG9EZWxldGUpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gd2Fybk5vbmh5ZHJhdGVkSW5zdGFuY2UocmV0dXJuRmliZXIsIGZpYmVyKSB7CiAgICB7CiAgICAgIGlmIChkaWRTdXNwZW5kT3JFcnJvckRFVikgewogICAgICAgIC8vIEluc2lkZSBhIGJvdW5kYXJ5IHRoYXQgYWxyZWFkeSBzdXNwZW5kZWQuIFdlJ3JlIGN1cnJlbnRseSByZW5kZXJpbmcgdGhlCiAgICAgICAgLy8gc2libGluZ3Mgb2YgYSBzdXNwZW5kZWQgbm9kZS4gVGhlIG1pc21hdGNoIG1heSBiZSBkdWUgdG8gdGhlIG1pc3NpbmcKICAgICAgICAvLyBkYXRhLCBzbyBpdCdzIHByb2JhYmx5IGEgZmFsc2UgcG9zaXRpdmUuCiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBzd2l0Y2ggKHJldHVybkZpYmVyLnRhZykgewogICAgICAgIGNhc2UgSG9zdFJvb3Q6CiAgICAgICAgICB7CiAgICAgICAgICAgIHZhciBwYXJlbnRDb250YWluZXIgPSByZXR1cm5GaWJlci5zdGF0ZU5vZGUuY29udGFpbmVySW5mbzsKCiAgICAgICAgICAgIHN3aXRjaCAoZmliZXIudGFnKSB7CiAgICAgICAgICAgICAgY2FzZSBIb3N0Q29tcG9uZW50OgogICAgICAgICAgICAgICAgdmFyIHR5cGUgPSBmaWJlci50eXBlOwogICAgICAgICAgICAgICAgdmFyIHByb3BzID0gZmliZXIucGVuZGluZ1Byb3BzOwogICAgICAgICAgICAgICAgZGlkTm90RmluZEh5ZHJhdGFibGVJbnN0YW5jZVdpdGhpbkNvbnRhaW5lcihwYXJlbnRDb250YWluZXIsIHR5cGUpOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgSG9zdFRleHQ6CiAgICAgICAgICAgICAgICB2YXIgdGV4dCA9IGZpYmVyLnBlbmRpbmdQcm9wczsKICAgICAgICAgICAgICAgIGRpZE5vdEZpbmRIeWRyYXRhYmxlVGV4dEluc3RhbmNlV2l0aGluQ29udGFpbmVyKHBhcmVudENvbnRhaW5lciwgdGV4dCk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgIGNhc2UgSG9zdENvbXBvbmVudDoKICAgICAgICAgIHsKICAgICAgICAgICAgdmFyIHBhcmVudFR5cGUgPSByZXR1cm5GaWJlci50eXBlOwogICAgICAgICAgICB2YXIgcGFyZW50UHJvcHMgPSByZXR1cm5GaWJlci5tZW1vaXplZFByb3BzOwogICAgICAgICAgICB2YXIgcGFyZW50SW5zdGFuY2UgPSByZXR1cm5GaWJlci5zdGF0ZU5vZGU7CgogICAgICAgICAgICBzd2l0Y2ggKGZpYmVyLnRhZykgewogICAgICAgICAgICAgIGNhc2UgSG9zdENvbXBvbmVudDoKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgdmFyIF90eXBlID0gZmliZXIudHlwZTsKICAgICAgICAgICAgICAgICAgdmFyIF9wcm9wcyA9IGZpYmVyLnBlbmRpbmdQcm9wczsKICAgICAgICAgICAgICAgICAgdmFyIGlzQ29uY3VycmVudE1vZGUgPSAocmV0dXJuRmliZXIubW9kZSAmIENvbmN1cnJlbnRNb2RlKSAhPT0gTm9Nb2RlOwogICAgICAgICAgICAgICAgICBkaWROb3RGaW5kSHlkcmF0YWJsZUluc3RhbmNlKHBhcmVudFR5cGUsIHBhcmVudFByb3BzLCBwYXJlbnRJbnN0YW5jZSwgX3R5cGUsIF9wcm9wcywgLy8gVE9ETzogRGVsZXRlIHRoaXMgYXJndW1lbnQgd2hlbiB3ZSByZW1vdmUgdGhlIGxlZ2FjeSByb290IEFQSS4KICAgICAgICAgICAgICAgICAgaXNDb25jdXJyZW50TW9kZSk7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIEhvc3RUZXh0OgogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICB2YXIgX3RleHQgPSBmaWJlci5wZW5kaW5nUHJvcHM7CgogICAgICAgICAgICAgICAgICB2YXIgX2lzQ29uY3VycmVudE1vZGUgPSAocmV0dXJuRmliZXIubW9kZSAmIENvbmN1cnJlbnRNb2RlKSAhPT0gTm9Nb2RlOwoKICAgICAgICAgICAgICAgICAgZGlkTm90RmluZEh5ZHJhdGFibGVUZXh0SW5zdGFuY2UocGFyZW50VHlwZSwgcGFyZW50UHJvcHMsIHBhcmVudEluc3RhbmNlLCBfdGV4dCwgLy8gVE9ETzogRGVsZXRlIHRoaXMgYXJndW1lbnQgd2hlbiB3ZSByZW1vdmUgdGhlIGxlZ2FjeSByb290IEFQSS4KICAgICAgICAgICAgICAgICAgX2lzQ29uY3VycmVudE1vZGUpOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgIGNhc2UgU3VzcGVuc2VDb21wb25lbnQ6CiAgICAgICAgICB7CiAgICAgICAgICAgIHZhciBzdXNwZW5zZVN0YXRlID0gcmV0dXJuRmliZXIubWVtb2l6ZWRTdGF0ZTsKICAgICAgICAgICAgdmFyIF9wYXJlbnRJbnN0YW5jZSA9IHN1c3BlbnNlU3RhdGUuZGVoeWRyYXRlZDsKICAgICAgICAgICAgaWYgKF9wYXJlbnRJbnN0YW5jZSAhPT0gbnVsbCkgc3dpdGNoIChmaWJlci50YWcpIHsKICAgICAgICAgICAgICBjYXNlIEhvc3RDb21wb25lbnQ6CiAgICAgICAgICAgICAgICB2YXIgX3R5cGUyID0gZmliZXIudHlwZTsKICAgICAgICAgICAgICAgIHZhciBfcHJvcHMyID0gZmliZXIucGVuZGluZ1Byb3BzOwogICAgICAgICAgICAgICAgZGlkTm90RmluZEh5ZHJhdGFibGVJbnN0YW5jZVdpdGhpblN1c3BlbnNlSW5zdGFuY2UoX3BhcmVudEluc3RhbmNlLCBfdHlwZTIpOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgSG9zdFRleHQ6CiAgICAgICAgICAgICAgICB2YXIgX3RleHQyID0gZmliZXIucGVuZGluZ1Byb3BzOwogICAgICAgICAgICAgICAgZGlkTm90RmluZEh5ZHJhdGFibGVUZXh0SW5zdGFuY2VXaXRoaW5TdXNwZW5zZUluc3RhbmNlKF9wYXJlbnRJbnN0YW5jZSwgX3RleHQyKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiBpbnNlcnROb25IeWRyYXRlZEluc3RhbmNlKHJldHVybkZpYmVyLCBmaWJlcikgewogICAgZmliZXIuZmxhZ3MgPSBmaWJlci5mbGFncyAmIH5IeWRyYXRpbmcgfCBQbGFjZW1lbnQ7CiAgICB3YXJuTm9uaHlkcmF0ZWRJbnN0YW5jZShyZXR1cm5GaWJlciwgZmliZXIpOwogIH0KCiAgZnVuY3Rpb24gdHJ5SHlkcmF0ZShmaWJlciwgbmV4dEluc3RhbmNlKSB7CiAgICBzd2l0Y2ggKGZpYmVyLnRhZykgewogICAgICBjYXNlIEhvc3RDb21wb25lbnQ6CiAgICAgICAgewogICAgICAgICAgdmFyIHR5cGUgPSBmaWJlci50eXBlOwogICAgICAgICAgdmFyIHByb3BzID0gZmliZXIucGVuZGluZ1Byb3BzOwogICAgICAgICAgdmFyIGluc3RhbmNlID0gY2FuSHlkcmF0ZUluc3RhbmNlKG5leHRJbnN0YW5jZSwgdHlwZSk7CgogICAgICAgICAgaWYgKGluc3RhbmNlICE9PSBudWxsKSB7CiAgICAgICAgICAgIGZpYmVyLnN0YXRlTm9kZSA9IGluc3RhbmNlOwogICAgICAgICAgICBoeWRyYXRpb25QYXJlbnRGaWJlciA9IGZpYmVyOwogICAgICAgICAgICBuZXh0SHlkcmF0YWJsZUluc3RhbmNlID0gZ2V0Rmlyc3RIeWRyYXRhYmxlQ2hpbGQoaW5zdGFuY2UpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgY2FzZSBIb3N0VGV4dDoKICAgICAgICB7CiAgICAgICAgICB2YXIgdGV4dCA9IGZpYmVyLnBlbmRpbmdQcm9wczsKICAgICAgICAgIHZhciB0ZXh0SW5zdGFuY2UgPSBjYW5IeWRyYXRlVGV4dEluc3RhbmNlKG5leHRJbnN0YW5jZSwgdGV4dCk7CgogICAgICAgICAgaWYgKHRleHRJbnN0YW5jZSAhPT0gbnVsbCkgewogICAgICAgICAgICBmaWJlci5zdGF0ZU5vZGUgPSB0ZXh0SW5zdGFuY2U7CiAgICAgICAgICAgIGh5ZHJhdGlvblBhcmVudEZpYmVyID0gZmliZXI7IC8vIFRleHQgSW5zdGFuY2VzIGRvbid0IGhhdmUgY2hpbGRyZW4gc28gdGhlcmUncyBub3RoaW5nIHRvIGh5ZHJhdGUuCgogICAgICAgICAgICBuZXh0SHlkcmF0YWJsZUluc3RhbmNlID0gbnVsbDsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgIGNhc2UgU3VzcGVuc2VDb21wb25lbnQ6CiAgICAgICAgewogICAgICAgICAgdmFyIHN1c3BlbnNlSW5zdGFuY2UgPSBjYW5IeWRyYXRlU3VzcGVuc2VJbnN0YW5jZShuZXh0SW5zdGFuY2UpOwoKICAgICAgICAgIGlmIChzdXNwZW5zZUluc3RhbmNlICE9PSBudWxsKSB7CiAgICAgICAgICAgIHZhciBzdXNwZW5zZVN0YXRlID0gewogICAgICAgICAgICAgIGRlaHlkcmF0ZWQ6IHN1c3BlbnNlSW5zdGFuY2UsCiAgICAgICAgICAgICAgdHJlZUNvbnRleHQ6IGdldFN1c3BlbmRlZFRyZWVDb250ZXh0KCksCiAgICAgICAgICAgICAgcmV0cnlMYW5lOiBPZmZzY3JlZW5MYW5lCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIGZpYmVyLm1lbW9pemVkU3RhdGUgPSBzdXNwZW5zZVN0YXRlOyAvLyBTdG9yZSB0aGUgZGVoeWRyYXRlZCBmcmFnbWVudCBhcyBhIGNoaWxkIGZpYmVyLgogICAgICAgICAgICAvLyBUaGlzIHNpbXBsaWZpZXMgdGhlIGNvZGUgZm9yIGdldEhvc3RTaWJsaW5nIGFuZCBkZWxldGluZyBub2RlcywKICAgICAgICAgICAgLy8gc2luY2UgaXQgZG9lc24ndCBoYXZlIHRvIGNvbnNpZGVyIGFsbCBTdXNwZW5zZSBib3VuZGFyaWVzIGFuZAogICAgICAgICAgICAvLyBjaGVjayBpZiB0aGV5J3JlIGRlaHlkcmF0ZWQgb25lcyBvciBub3QuCgogICAgICAgICAgICB2YXIgZGVoeWRyYXRlZEZyYWdtZW50ID0gY3JlYXRlRmliZXJGcm9tRGVoeWRyYXRlZEZyYWdtZW50KHN1c3BlbnNlSW5zdGFuY2UpOwogICAgICAgICAgICBkZWh5ZHJhdGVkRnJhZ21lbnQucmV0dXJuID0gZmliZXI7CiAgICAgICAgICAgIGZpYmVyLmNoaWxkID0gZGVoeWRyYXRlZEZyYWdtZW50OwogICAgICAgICAgICBoeWRyYXRpb25QYXJlbnRGaWJlciA9IGZpYmVyOyAvLyBXaGlsZSBhIFN1c3BlbnNlIEluc3RhbmNlIGRvZXMgaGF2ZSBjaGlsZHJlbiwgd2Ugd29uJ3Qgc3RlcCBpbnRvCiAgICAgICAgICAgIC8vIGl0IGR1cmluZyB0aGUgZmlyc3QgcGFzcy4gSW5zdGVhZCwgd2UnbGwgcmVlbnRlciBpdCBsYXRlci4KCiAgICAgICAgICAgIG5leHRIeWRyYXRhYmxlSW5zdGFuY2UgPSBudWxsOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgZGVmYXVsdDoKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBzaG91bGRDbGllbnRSZW5kZXJPbk1pc21hdGNoKGZpYmVyKSB7CiAgICByZXR1cm4gKGZpYmVyLm1vZGUgJiBDb25jdXJyZW50TW9kZSkgIT09IE5vTW9kZSAmJiAoZmliZXIuZmxhZ3MgJiBEaWRDYXB0dXJlKSA9PT0gTm9GbGFnczsKICB9CgogIGZ1bmN0aW9uIHRocm93T25IeWRyYXRpb25NaXNtYXRjaChmaWJlcikgewogICAgdGhyb3cgbmV3IEVycm9yKCdIeWRyYXRpb24gZmFpbGVkIGJlY2F1c2UgdGhlIGluaXRpYWwgVUkgZG9lcyBub3QgbWF0Y2ggd2hhdCB3YXMgJyArICdyZW5kZXJlZCBvbiB0aGUgc2VydmVyLicpOwogIH0KCiAgZnVuY3Rpb24gdHJ5VG9DbGFpbU5leHRIeWRyYXRhYmxlSW5zdGFuY2UoZmliZXIpIHsKICAgIGlmICghaXNIeWRyYXRpbmcpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhciBuZXh0SW5zdGFuY2UgPSBuZXh0SHlkcmF0YWJsZUluc3RhbmNlOwoKICAgIGlmICghbmV4dEluc3RhbmNlKSB7CiAgICAgIGlmIChzaG91bGRDbGllbnRSZW5kZXJPbk1pc21hdGNoKGZpYmVyKSkgewogICAgICAgIHdhcm5Ob25oeWRyYXRlZEluc3RhbmNlKGh5ZHJhdGlvblBhcmVudEZpYmVyLCBmaWJlcik7CiAgICAgICAgdGhyb3dPbkh5ZHJhdGlvbk1pc21hdGNoKCk7CiAgICAgIH0gLy8gTm90aGluZyB0byBoeWRyYXRlLiBNYWtlIGl0IGFuIGluc2VydGlvbi4KCgogICAgICBpbnNlcnROb25IeWRyYXRlZEluc3RhbmNlKGh5ZHJhdGlvblBhcmVudEZpYmVyLCBmaWJlcik7CiAgICAgIGlzSHlkcmF0aW5nID0gZmFsc2U7CiAgICAgIGh5ZHJhdGlvblBhcmVudEZpYmVyID0gZmliZXI7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB2YXIgZmlyc3RBdHRlbXB0ZWRJbnN0YW5jZSA9IG5leHRJbnN0YW5jZTsKCiAgICBpZiAoIXRyeUh5ZHJhdGUoZmliZXIsIG5leHRJbnN0YW5jZSkpIHsKICAgICAgaWYgKHNob3VsZENsaWVudFJlbmRlck9uTWlzbWF0Y2goZmliZXIpKSB7CiAgICAgICAgd2Fybk5vbmh5ZHJhdGVkSW5zdGFuY2UoaHlkcmF0aW9uUGFyZW50RmliZXIsIGZpYmVyKTsKICAgICAgICB0aHJvd09uSHlkcmF0aW9uTWlzbWF0Y2goKTsKICAgICAgfSAvLyBJZiB3ZSBjYW4ndCBoeWRyYXRlIHRoaXMgaW5zdGFuY2UgbGV0J3MgdHJ5IHRoZSBuZXh0IG9uZS4KICAgICAgLy8gV2UgdXNlIHRoaXMgYXMgYSBoZXVyaXN0aWMuIEl0J3MgYmFzZWQgb24gaW50dWl0aW9uIGFuZCBub3QgZGF0YSBzbyBpdAogICAgICAvLyBtaWdodCBiZSBmbGF3ZWQgb3IgdW5uZWNlc3NhcnkuCgoKICAgICAgbmV4dEluc3RhbmNlID0gZ2V0TmV4dEh5ZHJhdGFibGVTaWJsaW5nKGZpcnN0QXR0ZW1wdGVkSW5zdGFuY2UpOwogICAgICB2YXIgcHJldkh5ZHJhdGlvblBhcmVudEZpYmVyID0gaHlkcmF0aW9uUGFyZW50RmliZXI7CgogICAgICBpZiAoIW5leHRJbnN0YW5jZSB8fCAhdHJ5SHlkcmF0ZShmaWJlciwgbmV4dEluc3RhbmNlKSkgewogICAgICAgIC8vIE5vdGhpbmcgdG8gaHlkcmF0ZS4gTWFrZSBpdCBhbiBpbnNlcnRpb24uCiAgICAgICAgaW5zZXJ0Tm9uSHlkcmF0ZWRJbnN0YW5jZShoeWRyYXRpb25QYXJlbnRGaWJlciwgZmliZXIpOwogICAgICAgIGlzSHlkcmF0aW5nID0gZmFsc2U7CiAgICAgICAgaHlkcmF0aW9uUGFyZW50RmliZXIgPSBmaWJlcjsKICAgICAgICByZXR1cm47CiAgICAgIH0gLy8gV2UgbWF0Y2hlZCB0aGUgbmV4dCBvbmUsIHdlJ2xsIG5vdyBhc3N1bWUgdGhhdCB0aGUgZmlyc3Qgb25lIHdhcwogICAgICAvLyBzdXBlcmZsdW91cyBhbmQgd2UnbGwgZGVsZXRlIGl0LiBTaW5jZSB3ZSBjYW4ndCBlYWdlcmx5IGRlbGV0ZSBpdAogICAgICAvLyB3ZSdsbCBoYXZlIHRvIHNjaGVkdWxlIGEgZGVsZXRpb24uIFRvIGRvIHRoYXQsIHRoaXMgbm9kZSBuZWVkcyBhIGR1bW15CiAgICAgIC8vIGZpYmVyIGFzc29jaWF0ZWQgd2l0aCBpdC4KCgogICAgICBkZWxldGVIeWRyYXRhYmxlSW5zdGFuY2UocHJldkh5ZHJhdGlvblBhcmVudEZpYmVyLCBmaXJzdEF0dGVtcHRlZEluc3RhbmNlKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHByZXBhcmVUb0h5ZHJhdGVIb3N0SW5zdGFuY2UoZmliZXIsIHJvb3RDb250YWluZXJJbnN0YW5jZSwgaG9zdENvbnRleHQpIHsKCiAgICB2YXIgaW5zdGFuY2UgPSBmaWJlci5zdGF0ZU5vZGU7CiAgICB2YXIgc2hvdWxkV2FybklmTWlzbWF0Y2hEZXYgPSAhZGlkU3VzcGVuZE9yRXJyb3JERVY7CiAgICB2YXIgdXBkYXRlUGF5bG9hZCA9IGh5ZHJhdGVJbnN0YW5jZShpbnN0YW5jZSwgZmliZXIudHlwZSwgZmliZXIubWVtb2l6ZWRQcm9wcywgcm9vdENvbnRhaW5lckluc3RhbmNlLCBob3N0Q29udGV4dCwgZmliZXIsIHNob3VsZFdhcm5JZk1pc21hdGNoRGV2KTsgLy8gVE9ETzogVHlwZSB0aGlzIHNwZWNpZmljIHRvIHRoaXMgdHlwZSBvZiBjb21wb25lbnQuCgogICAgZmliZXIudXBkYXRlUXVldWUgPSB1cGRhdGVQYXlsb2FkOyAvLyBJZiB0aGUgdXBkYXRlIHBheWxvYWQgaW5kaWNhdGVzIHRoYXQgdGhlcmUgaXMgYSBjaGFuZ2Ugb3IgaWYgdGhlcmUKICAgIC8vIGlzIGEgbmV3IHJlZiB3ZSBtYXJrIHRoaXMgYXMgYW4gdXBkYXRlLgoKICAgIGlmICh1cGRhdGVQYXlsb2FkICE9PSBudWxsKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHJldHVybiBmYWxzZTsKICB9CgogIGZ1bmN0aW9uIHByZXBhcmVUb0h5ZHJhdGVIb3N0VGV4dEluc3RhbmNlKGZpYmVyKSB7CgogICAgdmFyIHRleHRJbnN0YW5jZSA9IGZpYmVyLnN0YXRlTm9kZTsKICAgIHZhciB0ZXh0Q29udGVudCA9IGZpYmVyLm1lbW9pemVkUHJvcHM7CiAgICB2YXIgc2hvdWxkVXBkYXRlID0gaHlkcmF0ZVRleHRJbnN0YW5jZSh0ZXh0SW5zdGFuY2UsIHRleHRDb250ZW50LCBmaWJlcik7CgogICAgaWYgKHNob3VsZFVwZGF0ZSkgewogICAgICAvLyBXZSBhc3N1bWUgdGhhdCBwcmVwYXJlVG9IeWRyYXRlSG9zdFRleHRJbnN0YW5jZSBpcyBjYWxsZWQgaW4gYSBjb250ZXh0IHdoZXJlIHRoZQogICAgICAvLyBoeWRyYXRpb24gcGFyZW50IGlzIHRoZSBwYXJlbnQgaG9zdCBjb21wb25lbnQgb2YgdGhpcyBob3N0IHRleHQuCiAgICAgIHZhciByZXR1cm5GaWJlciA9IGh5ZHJhdGlvblBhcmVudEZpYmVyOwoKICAgICAgaWYgKHJldHVybkZpYmVyICE9PSBudWxsKSB7CiAgICAgICAgc3dpdGNoIChyZXR1cm5GaWJlci50YWcpIHsKICAgICAgICAgIGNhc2UgSG9zdFJvb3Q6CiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB2YXIgcGFyZW50Q29udGFpbmVyID0gcmV0dXJuRmliZXIuc3RhdGVOb2RlLmNvbnRhaW5lckluZm87CiAgICAgICAgICAgICAgdmFyIGlzQ29uY3VycmVudE1vZGUgPSAocmV0dXJuRmliZXIubW9kZSAmIENvbmN1cnJlbnRNb2RlKSAhPT0gTm9Nb2RlOwogICAgICAgICAgICAgIGRpZE5vdE1hdGNoSHlkcmF0ZWRDb250YWluZXJUZXh0SW5zdGFuY2UocGFyZW50Q29udGFpbmVyLCB0ZXh0SW5zdGFuY2UsIHRleHRDb250ZW50LCAvLyBUT0RPOiBEZWxldGUgdGhpcyBhcmd1bWVudCB3aGVuIHdlIHJlbW92ZSB0aGUgbGVnYWN5IHJvb3QgQVBJLgogICAgICAgICAgICAgIGlzQ29uY3VycmVudE1vZGUpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgY2FzZSBIb3N0Q29tcG9uZW50OgogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdmFyIHBhcmVudFR5cGUgPSByZXR1cm5GaWJlci50eXBlOwogICAgICAgICAgICAgIHZhciBwYXJlbnRQcm9wcyA9IHJldHVybkZpYmVyLm1lbW9pemVkUHJvcHM7CiAgICAgICAgICAgICAgdmFyIHBhcmVudEluc3RhbmNlID0gcmV0dXJuRmliZXIuc3RhdGVOb2RlOwoKICAgICAgICAgICAgICB2YXIgX2lzQ29uY3VycmVudE1vZGUyID0gKHJldHVybkZpYmVyLm1vZGUgJiBDb25jdXJyZW50TW9kZSkgIT09IE5vTW9kZTsKCiAgICAgICAgICAgICAgZGlkTm90TWF0Y2hIeWRyYXRlZFRleHRJbnN0YW5jZShwYXJlbnRUeXBlLCBwYXJlbnRQcm9wcywgcGFyZW50SW5zdGFuY2UsIHRleHRJbnN0YW5jZSwgdGV4dENvbnRlbnQsIC8vIFRPRE86IERlbGV0ZSB0aGlzIGFyZ3VtZW50IHdoZW4gd2UgcmVtb3ZlIHRoZSBsZWdhY3kgcm9vdCBBUEkuCiAgICAgICAgICAgICAgX2lzQ29uY3VycmVudE1vZGUyKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHJldHVybiBzaG91bGRVcGRhdGU7CiAgfQoKICBmdW5jdGlvbiBwcmVwYXJlVG9IeWRyYXRlSG9zdFN1c3BlbnNlSW5zdGFuY2UoZmliZXIpIHsKCiAgICB2YXIgc3VzcGVuc2VTdGF0ZSA9IGZpYmVyLm1lbW9pemVkU3RhdGU7CiAgICB2YXIgc3VzcGVuc2VJbnN0YW5jZSA9IHN1c3BlbnNlU3RhdGUgIT09IG51bGwgPyBzdXNwZW5zZVN0YXRlLmRlaHlkcmF0ZWQgOiBudWxsOwoKICAgIGlmICghc3VzcGVuc2VJbnN0YW5jZSkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ0V4cGVjdGVkIHRvIGhhdmUgYSBoeWRyYXRlZCBzdXNwZW5zZSBpbnN0YW5jZS4gJyArICdUaGlzIGVycm9yIGlzIGxpa2VseSBjYXVzZWQgYnkgYSBidWcgaW4gUmVhY3QuIFBsZWFzZSBmaWxlIGFuIGlzc3VlLicpOwogICAgfQoKICAgIGh5ZHJhdGVTdXNwZW5zZUluc3RhbmNlKHN1c3BlbnNlSW5zdGFuY2UsIGZpYmVyKTsKICB9CgogIGZ1bmN0aW9uIHNraXBQYXN0RGVoeWRyYXRlZFN1c3BlbnNlSW5zdGFuY2UoZmliZXIpIHsKCiAgICB2YXIgc3VzcGVuc2VTdGF0ZSA9IGZpYmVyLm1lbW9pemVkU3RhdGU7CiAgICB2YXIgc3VzcGVuc2VJbnN0YW5jZSA9IHN1c3BlbnNlU3RhdGUgIT09IG51bGwgPyBzdXNwZW5zZVN0YXRlLmRlaHlkcmF0ZWQgOiBudWxsOwoKICAgIGlmICghc3VzcGVuc2VJbnN0YW5jZSkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ0V4cGVjdGVkIHRvIGhhdmUgYSBoeWRyYXRlZCBzdXNwZW5zZSBpbnN0YW5jZS4gJyArICdUaGlzIGVycm9yIGlzIGxpa2VseSBjYXVzZWQgYnkgYSBidWcgaW4gUmVhY3QuIFBsZWFzZSBmaWxlIGFuIGlzc3VlLicpOwogICAgfQoKICAgIHJldHVybiBnZXROZXh0SHlkcmF0YWJsZUluc3RhbmNlQWZ0ZXJTdXNwZW5zZUluc3RhbmNlKHN1c3BlbnNlSW5zdGFuY2UpOwogIH0KCiAgZnVuY3Rpb24gcG9wVG9OZXh0SG9zdFBhcmVudChmaWJlcikgewogICAgdmFyIHBhcmVudCA9IGZpYmVyLnJldHVybjsKCiAgICB3aGlsZSAocGFyZW50ICE9PSBudWxsICYmIHBhcmVudC50YWcgIT09IEhvc3RDb21wb25lbnQgJiYgcGFyZW50LnRhZyAhPT0gSG9zdFJvb3QgJiYgcGFyZW50LnRhZyAhPT0gU3VzcGVuc2VDb21wb25lbnQpIHsKICAgICAgcGFyZW50ID0gcGFyZW50LnJldHVybjsKICAgIH0KCiAgICBoeWRyYXRpb25QYXJlbnRGaWJlciA9IHBhcmVudDsKICB9CgogIGZ1bmN0aW9uIHBvcEh5ZHJhdGlvblN0YXRlKGZpYmVyKSB7CgogICAgaWYgKGZpYmVyICE9PSBoeWRyYXRpb25QYXJlbnRGaWJlcikgewogICAgICAvLyBXZSdyZSBkZWVwZXIgdGhhbiB0aGUgY3VycmVudCBoeWRyYXRpb24gY29udGV4dCwgaW5zaWRlIGFuIGluc2VydGVkCiAgICAgIC8vIHRyZWUuCiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBpZiAoIWlzSHlkcmF0aW5nKSB7CiAgICAgIC8vIElmIHdlJ3JlIG5vdCBjdXJyZW50bHkgaHlkcmF0aW5nIGJ1dCB3ZSdyZSBpbiBhIGh5ZHJhdGlvbiBjb250ZXh0LCB0aGVuCiAgICAgIC8vIHdlIHdlcmUgYW4gaW5zZXJ0aW9uIGFuZCBub3cgbmVlZCB0byBwb3AgdXAgcmVlbnRlciBoeWRyYXRpb24gb2Ygb3VyCiAgICAgIC8vIHNpYmxpbmdzLgogICAgICBwb3BUb05leHRIb3N0UGFyZW50KGZpYmVyKTsKICAgICAgaXNIeWRyYXRpbmcgPSB0cnVlOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9IC8vIElmIHdlIGhhdmUgYW55IHJlbWFpbmluZyBoeWRyYXRhYmxlIG5vZGVzLCB3ZSBuZWVkIHRvIGRlbGV0ZSB0aGVtIG5vdy4KICAgIC8vIFdlIG9ubHkgZG8gdGhpcyBkZWVwZXIgdGhhbiBoZWFkIGFuZCBib2R5IHNpbmNlIHRoZXkgdGVuZCB0byBoYXZlIHJhbmRvbQogICAgLy8gb3RoZXIgbm9kZXMgaW4gdGhlbS4gV2UgYWxzbyBpZ25vcmUgY29tcG9uZW50cyB3aXRoIHB1cmUgdGV4dCBjb250ZW50IGluCiAgICAvLyBzaWRlIG9mIHRoZW0uIFdlIGFsc28gZG9uJ3QgZGVsZXRlIGFueXRoaW5nIGluc2lkZSB0aGUgcm9vdCBjb250YWluZXIuCgoKICAgIGlmIChmaWJlci50YWcgIT09IEhvc3RSb290ICYmIChmaWJlci50YWcgIT09IEhvc3RDb21wb25lbnQgfHwgc2hvdWxkRGVsZXRlVW5oeWRyYXRlZFRhaWxJbnN0YW5jZXMoZmliZXIudHlwZSkgJiYgIXNob3VsZFNldFRleHRDb250ZW50KGZpYmVyLnR5cGUsIGZpYmVyLm1lbW9pemVkUHJvcHMpKSkgewogICAgICB2YXIgbmV4dEluc3RhbmNlID0gbmV4dEh5ZHJhdGFibGVJbnN0YW5jZTsKCiAgICAgIGlmIChuZXh0SW5zdGFuY2UpIHsKICAgICAgICBpZiAoc2hvdWxkQ2xpZW50UmVuZGVyT25NaXNtYXRjaChmaWJlcikpIHsKICAgICAgICAgIHdhcm5JZlVuaHlkcmF0ZWRUYWlsTm9kZXMoZmliZXIpOwogICAgICAgICAgdGhyb3dPbkh5ZHJhdGlvbk1pc21hdGNoKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHdoaWxlIChuZXh0SW5zdGFuY2UpIHsKICAgICAgICAgICAgZGVsZXRlSHlkcmF0YWJsZUluc3RhbmNlKGZpYmVyLCBuZXh0SW5zdGFuY2UpOwogICAgICAgICAgICBuZXh0SW5zdGFuY2UgPSBnZXROZXh0SHlkcmF0YWJsZVNpYmxpbmcobmV4dEluc3RhbmNlKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBwb3BUb05leHRIb3N0UGFyZW50KGZpYmVyKTsKCiAgICBpZiAoZmliZXIudGFnID09PSBTdXNwZW5zZUNvbXBvbmVudCkgewogICAgICBuZXh0SHlkcmF0YWJsZUluc3RhbmNlID0gc2tpcFBhc3REZWh5ZHJhdGVkU3VzcGVuc2VJbnN0YW5jZShmaWJlcik7CiAgICB9IGVsc2UgewogICAgICBuZXh0SHlkcmF0YWJsZUluc3RhbmNlID0gaHlkcmF0aW9uUGFyZW50RmliZXIgPyBnZXROZXh0SHlkcmF0YWJsZVNpYmxpbmcoZmliZXIuc3RhdGVOb2RlKSA6IG51bGw7CiAgICB9CgogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiBoYXNVbmh5ZHJhdGVkVGFpbE5vZGVzKCkgewogICAgcmV0dXJuIGlzSHlkcmF0aW5nICYmIG5leHRIeWRyYXRhYmxlSW5zdGFuY2UgIT09IG51bGw7CiAgfQoKICBmdW5jdGlvbiB3YXJuSWZVbmh5ZHJhdGVkVGFpbE5vZGVzKGZpYmVyKSB7CiAgICB2YXIgbmV4dEluc3RhbmNlID0gbmV4dEh5ZHJhdGFibGVJbnN0YW5jZTsKCiAgICB3aGlsZSAobmV4dEluc3RhbmNlKSB7CiAgICAgIHdhcm5Vbmh5ZHJhdGVkSW5zdGFuY2UoZmliZXIsIG5leHRJbnN0YW5jZSk7CiAgICAgIG5leHRJbnN0YW5jZSA9IGdldE5leHRIeWRyYXRhYmxlU2libGluZyhuZXh0SW5zdGFuY2UpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gcmVzZXRIeWRyYXRpb25TdGF0ZSgpIHsKCiAgICBoeWRyYXRpb25QYXJlbnRGaWJlciA9IG51bGw7CiAgICBuZXh0SHlkcmF0YWJsZUluc3RhbmNlID0gbnVsbDsKICAgIGlzSHlkcmF0aW5nID0gZmFsc2U7CiAgICBkaWRTdXNwZW5kT3JFcnJvckRFViA9IGZhbHNlOwogIH0KCiAgZnVuY3Rpb24gdXBncmFkZUh5ZHJhdGlvbkVycm9yc1RvUmVjb3ZlcmFibGUoKSB7CiAgICBpZiAoaHlkcmF0aW9uRXJyb3JzICE9PSBudWxsKSB7CiAgICAgIC8vIFN1Y2Nlc3NmdWxseSBjb21wbGV0ZWQgYSBmb3JjZWQgY2xpZW50IHJlbmRlci4gVGhlIGVycm9ycyB0aGF0IG9jY3VycmVkCiAgICAgIC8vIGR1cmluZyB0aGUgaHlkcmF0aW9uIGF0dGVtcHQgYXJlIG5vdyByZWNvdmVyZWQuIFdlIHdpbGwgbG9nIHRoZW0gaW4KICAgICAgLy8gY29tbWl0IHBoYXNlLCBvbmNlIHRoZSBlbnRpcmUgdHJlZSBoYXMgZmluaXNoZWQuCiAgICAgIHF1ZXVlUmVjb3ZlcmFibGVFcnJvcnMoaHlkcmF0aW9uRXJyb3JzKTsKICAgICAgaHlkcmF0aW9uRXJyb3JzID0gbnVsbDsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGdldElzSHlkcmF0aW5nKCkgewogICAgcmV0dXJuIGlzSHlkcmF0aW5nOwogIH0KCiAgZnVuY3Rpb24gcXVldWVIeWRyYXRpb25FcnJvcihlcnJvcikgewogICAgaWYgKGh5ZHJhdGlvbkVycm9ycyA9PT0gbnVsbCkgewogICAgICBoeWRyYXRpb25FcnJvcnMgPSBbZXJyb3JdOwogICAgfSBlbHNlIHsKICAgICAgaHlkcmF0aW9uRXJyb3JzLnB1c2goZXJyb3IpOwogICAgfQogIH0KCiAgdmFyIFJlYWN0Q3VycmVudEJhdGNoQ29uZmlnJDEgPSBSZWFjdFNoYXJlZEludGVybmFscy5SZWFjdEN1cnJlbnRCYXRjaENvbmZpZzsKICB2YXIgTm9UcmFuc2l0aW9uID0gbnVsbDsKICBmdW5jdGlvbiByZXF1ZXN0Q3VycmVudFRyYW5zaXRpb24oKSB7CiAgICByZXR1cm4gUmVhY3RDdXJyZW50QmF0Y2hDb25maWckMS50cmFuc2l0aW9uOwogIH0KCiAgdmFyIFJlYWN0U3RyaWN0TW9kZVdhcm5pbmdzID0gewogICAgcmVjb3JkVW5zYWZlTGlmZWN5Y2xlV2FybmluZ3M6IGZ1bmN0aW9uIChmaWJlciwgaW5zdGFuY2UpIHt9LAogICAgZmx1c2hQZW5kaW5nVW5zYWZlTGlmZWN5Y2xlV2FybmluZ3M6IGZ1bmN0aW9uICgpIHt9LAogICAgcmVjb3JkTGVnYWN5Q29udGV4dFdhcm5pbmc6IGZ1bmN0aW9uIChmaWJlciwgaW5zdGFuY2UpIHt9LAogICAgZmx1c2hMZWdhY3lDb250ZXh0V2FybmluZzogZnVuY3Rpb24gKCkge30sCiAgICBkaXNjYXJkUGVuZGluZ1dhcm5pbmdzOiBmdW5jdGlvbiAoKSB7fQogIH07CgogIHsKICAgIHZhciBmaW5kU3RyaWN0Um9vdCA9IGZ1bmN0aW9uIChmaWJlcikgewogICAgICB2YXIgbWF5YmVTdHJpY3RSb290ID0gbnVsbDsKICAgICAgdmFyIG5vZGUgPSBmaWJlcjsKCiAgICAgIHdoaWxlIChub2RlICE9PSBudWxsKSB7CiAgICAgICAgaWYgKG5vZGUubW9kZSAmIFN0cmljdExlZ2FjeU1vZGUpIHsKICAgICAgICAgIG1heWJlU3RyaWN0Um9vdCA9IG5vZGU7CiAgICAgICAgfQoKICAgICAgICBub2RlID0gbm9kZS5yZXR1cm47CiAgICAgIH0KCiAgICAgIHJldHVybiBtYXliZVN0cmljdFJvb3Q7CiAgICB9OwoKICAgIHZhciBzZXRUb1NvcnRlZFN0cmluZyA9IGZ1bmN0aW9uIChzZXQpIHsKICAgICAgdmFyIGFycmF5ID0gW107CiAgICAgIHNldC5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgIGFycmF5LnB1c2godmFsdWUpOwogICAgICB9KTsKICAgICAgcmV0dXJuIGFycmF5LnNvcnQoKS5qb2luKCcsICcpOwogICAgfTsKCiAgICB2YXIgcGVuZGluZ0NvbXBvbmVudFdpbGxNb3VudFdhcm5pbmdzID0gW107CiAgICB2YXIgcGVuZGluZ1VOU0FGRV9Db21wb25lbnRXaWxsTW91bnRXYXJuaW5ncyA9IFtdOwogICAgdmFyIHBlbmRpbmdDb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzV2FybmluZ3MgPSBbXTsKICAgIHZhciBwZW5kaW5nVU5TQUZFX0NvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHNXYXJuaW5ncyA9IFtdOwogICAgdmFyIHBlbmRpbmdDb21wb25lbnRXaWxsVXBkYXRlV2FybmluZ3MgPSBbXTsKICAgIHZhciBwZW5kaW5nVU5TQUZFX0NvbXBvbmVudFdpbGxVcGRhdGVXYXJuaW5ncyA9IFtdOyAvLyBUcmFja3MgY29tcG9uZW50cyB3ZSBoYXZlIGFscmVhZHkgd2FybmVkIGFib3V0LgoKICAgIHZhciBkaWRXYXJuQWJvdXRVbnNhZmVMaWZlY3ljbGVzID0gbmV3IFNldCgpOwoKICAgIFJlYWN0U3RyaWN0TW9kZVdhcm5pbmdzLnJlY29yZFVuc2FmZUxpZmVjeWNsZVdhcm5pbmdzID0gZnVuY3Rpb24gKGZpYmVyLCBpbnN0YW5jZSkgewogICAgICAvLyBEZWR1cGUgc3RyYXRlZ3k6IFdhcm4gb25jZSBwZXIgY29tcG9uZW50LgogICAgICBpZiAoZGlkV2FybkFib3V0VW5zYWZlTGlmZWN5Y2xlcy5oYXMoZmliZXIudHlwZSkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0eXBlb2YgaW5zdGFuY2UuY29tcG9uZW50V2lsbE1vdW50ID09PSAnZnVuY3Rpb24nICYmIC8vIERvbid0IHdhcm4gYWJvdXQgcmVhY3QtbGlmZWN5Y2xlcy1jb21wYXQgcG9seWZpbGxlZCBjb21wb25lbnRzLgogICAgICBpbnN0YW5jZS5jb21wb25lbnRXaWxsTW91bnQuX19zdXBwcmVzc0RlcHJlY2F0aW9uV2FybmluZyAhPT0gdHJ1ZSkgewogICAgICAgIHBlbmRpbmdDb21wb25lbnRXaWxsTW91bnRXYXJuaW5ncy5wdXNoKGZpYmVyKTsKICAgICAgfQoKICAgICAgaWYgKGZpYmVyLm1vZGUgJiBTdHJpY3RMZWdhY3lNb2RlICYmIHR5cGVvZiBpbnN0YW5jZS5VTlNBRkVfY29tcG9uZW50V2lsbE1vdW50ID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgcGVuZGluZ1VOU0FGRV9Db21wb25lbnRXaWxsTW91bnRXYXJuaW5ncy5wdXNoKGZpYmVyKTsKICAgICAgfQoKICAgICAgaWYgKHR5cGVvZiBpbnN0YW5jZS5jb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzID09PSAnZnVuY3Rpb24nICYmIGluc3RhbmNlLmNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMuX19zdXBwcmVzc0RlcHJlY2F0aW9uV2FybmluZyAhPT0gdHJ1ZSkgewogICAgICAgIHBlbmRpbmdDb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzV2FybmluZ3MucHVzaChmaWJlcik7CiAgICAgIH0KCiAgICAgIGlmIChmaWJlci5tb2RlICYgU3RyaWN0TGVnYWN5TW9kZSAmJiB0eXBlb2YgaW5zdGFuY2UuVU5TQUZFX2NvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICBwZW5kaW5nVU5TQUZFX0NvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHNXYXJuaW5ncy5wdXNoKGZpYmVyKTsKICAgICAgfQoKICAgICAgaWYgKHR5cGVvZiBpbnN0YW5jZS5jb21wb25lbnRXaWxsVXBkYXRlID09PSAnZnVuY3Rpb24nICYmIGluc3RhbmNlLmNvbXBvbmVudFdpbGxVcGRhdGUuX19zdXBwcmVzc0RlcHJlY2F0aW9uV2FybmluZyAhPT0gdHJ1ZSkgewogICAgICAgIHBlbmRpbmdDb21wb25lbnRXaWxsVXBkYXRlV2FybmluZ3MucHVzaChmaWJlcik7CiAgICAgIH0KCiAgICAgIGlmIChmaWJlci5tb2RlICYgU3RyaWN0TGVnYWN5TW9kZSAmJiB0eXBlb2YgaW5zdGFuY2UuVU5TQUZFX2NvbXBvbmVudFdpbGxVcGRhdGUgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICBwZW5kaW5nVU5TQUZFX0NvbXBvbmVudFdpbGxVcGRhdGVXYXJuaW5ncy5wdXNoKGZpYmVyKTsKICAgICAgfQogICAgfTsKCiAgICBSZWFjdFN0cmljdE1vZGVXYXJuaW5ncy5mbHVzaFBlbmRpbmdVbnNhZmVMaWZlY3ljbGVXYXJuaW5ncyA9IGZ1bmN0aW9uICgpIHsKICAgICAgLy8gV2UgZG8gYW4gaW5pdGlhbCBwYXNzIHRvIGdhdGhlciBjb21wb25lbnQgbmFtZXMKICAgICAgdmFyIGNvbXBvbmVudFdpbGxNb3VudFVuaXF1ZU5hbWVzID0gbmV3IFNldCgpOwoKICAgICAgaWYgKHBlbmRpbmdDb21wb25lbnRXaWxsTW91bnRXYXJuaW5ncy5sZW5ndGggPiAwKSB7CiAgICAgICAgcGVuZGluZ0NvbXBvbmVudFdpbGxNb3VudFdhcm5pbmdzLmZvckVhY2goZnVuY3Rpb24gKGZpYmVyKSB7CiAgICAgICAgICBjb21wb25lbnRXaWxsTW91bnRVbmlxdWVOYW1lcy5hZGQoZ2V0Q29tcG9uZW50TmFtZUZyb21GaWJlcihmaWJlcikgfHwgJ0NvbXBvbmVudCcpOwogICAgICAgICAgZGlkV2FybkFib3V0VW5zYWZlTGlmZWN5Y2xlcy5hZGQoZmliZXIudHlwZSk7CiAgICAgICAgfSk7CiAgICAgICAgcGVuZGluZ0NvbXBvbmVudFdpbGxNb3VudFdhcm5pbmdzID0gW107CiAgICAgIH0KCiAgICAgIHZhciBVTlNBRkVfY29tcG9uZW50V2lsbE1vdW50VW5pcXVlTmFtZXMgPSBuZXcgU2V0KCk7CgogICAgICBpZiAocGVuZGluZ1VOU0FGRV9Db21wb25lbnRXaWxsTW91bnRXYXJuaW5ncy5sZW5ndGggPiAwKSB7CiAgICAgICAgcGVuZGluZ1VOU0FGRV9Db21wb25lbnRXaWxsTW91bnRXYXJuaW5ncy5mb3JFYWNoKGZ1bmN0aW9uIChmaWJlcikgewogICAgICAgICAgVU5TQUZFX2NvbXBvbmVudFdpbGxNb3VudFVuaXF1ZU5hbWVzLmFkZChnZXRDb21wb25lbnROYW1lRnJvbUZpYmVyKGZpYmVyKSB8fCAnQ29tcG9uZW50Jyk7CiAgICAgICAgICBkaWRXYXJuQWJvdXRVbnNhZmVMaWZlY3ljbGVzLmFkZChmaWJlci50eXBlKTsKICAgICAgICB9KTsKICAgICAgICBwZW5kaW5nVU5TQUZFX0NvbXBvbmVudFdpbGxNb3VudFdhcm5pbmdzID0gW107CiAgICAgIH0KCiAgICAgIHZhciBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzVW5pcXVlTmFtZXMgPSBuZXcgU2V0KCk7CgogICAgICBpZiAocGVuZGluZ0NvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHNXYXJuaW5ncy5sZW5ndGggPiAwKSB7CiAgICAgICAgcGVuZGluZ0NvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHNXYXJuaW5ncy5mb3JFYWNoKGZ1bmN0aW9uIChmaWJlcikgewogICAgICAgICAgY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wc1VuaXF1ZU5hbWVzLmFkZChnZXRDb21wb25lbnROYW1lRnJvbUZpYmVyKGZpYmVyKSB8fCAnQ29tcG9uZW50Jyk7CiAgICAgICAgICBkaWRXYXJuQWJvdXRVbnNhZmVMaWZlY3ljbGVzLmFkZChmaWJlci50eXBlKTsKICAgICAgICB9KTsKICAgICAgICBwZW5kaW5nQ29tcG9uZW50V2lsbFJlY2VpdmVQcm9wc1dhcm5pbmdzID0gW107CiAgICAgIH0KCiAgICAgIHZhciBVTlNBRkVfY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wc1VuaXF1ZU5hbWVzID0gbmV3IFNldCgpOwoKICAgICAgaWYgKHBlbmRpbmdVTlNBRkVfQ29tcG9uZW50V2lsbFJlY2VpdmVQcm9wc1dhcm5pbmdzLmxlbmd0aCA+IDApIHsKICAgICAgICBwZW5kaW5nVU5TQUZFX0NvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHNXYXJuaW5ncy5mb3JFYWNoKGZ1bmN0aW9uIChmaWJlcikgewogICAgICAgICAgVU5TQUZFX2NvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHNVbmlxdWVOYW1lcy5hZGQoZ2V0Q29tcG9uZW50TmFtZUZyb21GaWJlcihmaWJlcikgfHwgJ0NvbXBvbmVudCcpOwogICAgICAgICAgZGlkV2FybkFib3V0VW5zYWZlTGlmZWN5Y2xlcy5hZGQoZmliZXIudHlwZSk7CiAgICAgICAgfSk7CiAgICAgICAgcGVuZGluZ1VOU0FGRV9Db21wb25lbnRXaWxsUmVjZWl2ZVByb3BzV2FybmluZ3MgPSBbXTsKICAgICAgfQoKICAgICAgdmFyIGNvbXBvbmVudFdpbGxVcGRhdGVVbmlxdWVOYW1lcyA9IG5ldyBTZXQoKTsKCiAgICAgIGlmIChwZW5kaW5nQ29tcG9uZW50V2lsbFVwZGF0ZVdhcm5pbmdzLmxlbmd0aCA+IDApIHsKICAgICAgICBwZW5kaW5nQ29tcG9uZW50V2lsbFVwZGF0ZVdhcm5pbmdzLmZvckVhY2goZnVuY3Rpb24gKGZpYmVyKSB7CiAgICAgICAgICBjb21wb25lbnRXaWxsVXBkYXRlVW5pcXVlTmFtZXMuYWRkKGdldENvbXBvbmVudE5hbWVGcm9tRmliZXIoZmliZXIpIHx8ICdDb21wb25lbnQnKTsKICAgICAgICAgIGRpZFdhcm5BYm91dFVuc2FmZUxpZmVjeWNsZXMuYWRkKGZpYmVyLnR5cGUpOwogICAgICAgIH0pOwogICAgICAgIHBlbmRpbmdDb21wb25lbnRXaWxsVXBkYXRlV2FybmluZ3MgPSBbXTsKICAgICAgfQoKICAgICAgdmFyIFVOU0FGRV9jb21wb25lbnRXaWxsVXBkYXRlVW5pcXVlTmFtZXMgPSBuZXcgU2V0KCk7CgogICAgICBpZiAocGVuZGluZ1VOU0FGRV9Db21wb25lbnRXaWxsVXBkYXRlV2FybmluZ3MubGVuZ3RoID4gMCkgewogICAgICAgIHBlbmRpbmdVTlNBRkVfQ29tcG9uZW50V2lsbFVwZGF0ZVdhcm5pbmdzLmZvckVhY2goZnVuY3Rpb24gKGZpYmVyKSB7CiAgICAgICAgICBVTlNBRkVfY29tcG9uZW50V2lsbFVwZGF0ZVVuaXF1ZU5hbWVzLmFkZChnZXRDb21wb25lbnROYW1lRnJvbUZpYmVyKGZpYmVyKSB8fCAnQ29tcG9uZW50Jyk7CiAgICAgICAgICBkaWRXYXJuQWJvdXRVbnNhZmVMaWZlY3ljbGVzLmFkZChmaWJlci50eXBlKTsKICAgICAgICB9KTsKICAgICAgICBwZW5kaW5nVU5TQUZFX0NvbXBvbmVudFdpbGxVcGRhdGVXYXJuaW5ncyA9IFtdOwogICAgICB9IC8vIEZpbmFsbHksIHdlIGZsdXNoIGFsbCB0aGUgd2FybmluZ3MKICAgICAgLy8gVU5TQUZFXyBvbmVzIGJlZm9yZSB0aGUgZGVwcmVjYXRlZCBvbmVzLCBzaW5jZSB0aGV5J2xsIGJlICdsb3VkZXInCgoKICAgICAgaWYgKFVOU0FGRV9jb21wb25lbnRXaWxsTW91bnRVbmlxdWVOYW1lcy5zaXplID4gMCkgewogICAgICAgIHZhciBzb3J0ZWROYW1lcyA9IHNldFRvU29ydGVkU3RyaW5nKFVOU0FGRV9jb21wb25lbnRXaWxsTW91bnRVbmlxdWVOYW1lcyk7CgogICAgICAgIGVycm9yKCdVc2luZyBVTlNBRkVfY29tcG9uZW50V2lsbE1vdW50IGluIHN0cmljdCBtb2RlIGlzIG5vdCByZWNvbW1lbmRlZCBhbmQgbWF5IGluZGljYXRlIGJ1Z3MgaW4geW91ciBjb2RlLiAnICsgJ1NlZSBodHRwczovL3JlYWN0anMub3JnL2xpbmsvdW5zYWZlLWNvbXBvbmVudC1saWZlY3ljbGVzIGZvciBkZXRhaWxzLlxuXG4nICsgJyogTW92ZSBjb2RlIHdpdGggc2lkZSBlZmZlY3RzIHRvIGNvbXBvbmVudERpZE1vdW50LCBhbmQgc2V0IGluaXRpYWwgc3RhdGUgaW4gdGhlIGNvbnN0cnVjdG9yLlxuJyArICdcblBsZWFzZSB1cGRhdGUgdGhlIGZvbGxvd2luZyBjb21wb25lbnRzOiAlcycsIHNvcnRlZE5hbWVzKTsKICAgICAgfQoKICAgICAgaWYgKFVOU0FGRV9jb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzVW5pcXVlTmFtZXMuc2l6ZSA+IDApIHsKICAgICAgICB2YXIgX3NvcnRlZE5hbWVzID0gc2V0VG9Tb3J0ZWRTdHJpbmcoVU5TQUZFX2NvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHNVbmlxdWVOYW1lcyk7CgogICAgICAgIGVycm9yKCdVc2luZyBVTlNBRkVfY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyBpbiBzdHJpY3QgbW9kZSBpcyBub3QgcmVjb21tZW5kZWQgJyArICdhbmQgbWF5IGluZGljYXRlIGJ1Z3MgaW4geW91ciBjb2RlLiAnICsgJ1NlZSBodHRwczovL3JlYWN0anMub3JnL2xpbmsvdW5zYWZlLWNvbXBvbmVudC1saWZlY3ljbGVzIGZvciBkZXRhaWxzLlxuXG4nICsgJyogTW92ZSBkYXRhIGZldGNoaW5nIGNvZGUgb3Igc2lkZSBlZmZlY3RzIHRvIGNvbXBvbmVudERpZFVwZGF0ZS5cbicgKyAiKiBJZiB5b3UncmUgdXBkYXRpbmcgc3RhdGUgd2hlbmV2ZXIgcHJvcHMgY2hhbmdlLCAiICsgJ3JlZmFjdG9yIHlvdXIgY29kZSB0byB1c2UgbWVtb2l6YXRpb24gdGVjaG5pcXVlcyBvciBtb3ZlIGl0IHRvICcgKyAnc3RhdGljIGdldERlcml2ZWRTdGF0ZUZyb21Qcm9wcy4gTGVhcm4gbW9yZSBhdDogaHR0cHM6Ly9yZWFjdGpzLm9yZy9saW5rL2Rlcml2ZWQtc3RhdGVcbicgKyAnXG5QbGVhc2UgdXBkYXRlIHRoZSBmb2xsb3dpbmcgY29tcG9uZW50czogJXMnLCBfc29ydGVkTmFtZXMpOwogICAgICB9CgogICAgICBpZiAoVU5TQUZFX2NvbXBvbmVudFdpbGxVcGRhdGVVbmlxdWVOYW1lcy5zaXplID4gMCkgewogICAgICAgIHZhciBfc29ydGVkTmFtZXMyID0gc2V0VG9Tb3J0ZWRTdHJpbmcoVU5TQUZFX2NvbXBvbmVudFdpbGxVcGRhdGVVbmlxdWVOYW1lcyk7CgogICAgICAgIGVycm9yKCdVc2luZyBVTlNBRkVfY29tcG9uZW50V2lsbFVwZGF0ZSBpbiBzdHJpY3QgbW9kZSBpcyBub3QgcmVjb21tZW5kZWQgJyArICdhbmQgbWF5IGluZGljYXRlIGJ1Z3MgaW4geW91ciBjb2RlLiAnICsgJ1NlZSBodHRwczovL3JlYWN0anMub3JnL2xpbmsvdW5zYWZlLWNvbXBvbmVudC1saWZlY3ljbGVzIGZvciBkZXRhaWxzLlxuXG4nICsgJyogTW92ZSBkYXRhIGZldGNoaW5nIGNvZGUgb3Igc2lkZSBlZmZlY3RzIHRvIGNvbXBvbmVudERpZFVwZGF0ZS5cbicgKyAnXG5QbGVhc2UgdXBkYXRlIHRoZSBmb2xsb3dpbmcgY29tcG9uZW50czogJXMnLCBfc29ydGVkTmFtZXMyKTsKICAgICAgfQoKICAgICAgaWYgKGNvbXBvbmVudFdpbGxNb3VudFVuaXF1ZU5hbWVzLnNpemUgPiAwKSB7CiAgICAgICAgdmFyIF9zb3J0ZWROYW1lczMgPSBzZXRUb1NvcnRlZFN0cmluZyhjb21wb25lbnRXaWxsTW91bnRVbmlxdWVOYW1lcyk7CgogICAgICAgIHdhcm4oJ2NvbXBvbmVudFdpbGxNb3VudCBoYXMgYmVlbiByZW5hbWVkLCBhbmQgaXMgbm90IHJlY29tbWVuZGVkIGZvciB1c2UuICcgKyAnU2VlIGh0dHBzOi8vcmVhY3Rqcy5vcmcvbGluay91bnNhZmUtY29tcG9uZW50LWxpZmVjeWNsZXMgZm9yIGRldGFpbHMuXG5cbicgKyAnKiBNb3ZlIGNvZGUgd2l0aCBzaWRlIGVmZmVjdHMgdG8gY29tcG9uZW50RGlkTW91bnQsIGFuZCBzZXQgaW5pdGlhbCBzdGF0ZSBpbiB0aGUgY29uc3RydWN0b3IuXG4nICsgJyogUmVuYW1lIGNvbXBvbmVudFdpbGxNb3VudCB0byBVTlNBRkVfY29tcG9uZW50V2lsbE1vdW50IHRvIHN1cHByZXNzICcgKyAndGhpcyB3YXJuaW5nIGluIG5vbi1zdHJpY3QgbW9kZS4gSW4gUmVhY3QgMTgueCwgb25seSB0aGUgVU5TQUZFXyBuYW1lIHdpbGwgd29yay4gJyArICdUbyByZW5hbWUgYWxsIGRlcHJlY2F0ZWQgbGlmZWN5Y2xlcyB0byB0aGVpciBuZXcgbmFtZXMsIHlvdSBjYW4gcnVuICcgKyAnYG5weCByZWFjdC1jb2RlbW9kIHJlbmFtZS11bnNhZmUtbGlmZWN5Y2xlc2AgaW4geW91ciBwcm9qZWN0IHNvdXJjZSBmb2xkZXIuXG4nICsgJ1xuUGxlYXNlIHVwZGF0ZSB0aGUgZm9sbG93aW5nIGNvbXBvbmVudHM6ICVzJywgX3NvcnRlZE5hbWVzMyk7CiAgICAgIH0KCiAgICAgIGlmIChjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzVW5pcXVlTmFtZXMuc2l6ZSA+IDApIHsKICAgICAgICB2YXIgX3NvcnRlZE5hbWVzNCA9IHNldFRvU29ydGVkU3RyaW5nKGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHNVbmlxdWVOYW1lcyk7CgogICAgICAgIHdhcm4oJ2NvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMgaGFzIGJlZW4gcmVuYW1lZCwgYW5kIGlzIG5vdCByZWNvbW1lbmRlZCBmb3IgdXNlLiAnICsgJ1NlZSBodHRwczovL3JlYWN0anMub3JnL2xpbmsvdW5zYWZlLWNvbXBvbmVudC1saWZlY3ljbGVzIGZvciBkZXRhaWxzLlxuXG4nICsgJyogTW92ZSBkYXRhIGZldGNoaW5nIGNvZGUgb3Igc2lkZSBlZmZlY3RzIHRvIGNvbXBvbmVudERpZFVwZGF0ZS5cbicgKyAiKiBJZiB5b3UncmUgdXBkYXRpbmcgc3RhdGUgd2hlbmV2ZXIgcHJvcHMgY2hhbmdlLCByZWZhY3RvciB5b3VyICIgKyAnY29kZSB0byB1c2UgbWVtb2l6YXRpb24gdGVjaG5pcXVlcyBvciBtb3ZlIGl0IHRvICcgKyAnc3RhdGljIGdldERlcml2ZWRTdGF0ZUZyb21Qcm9wcy4gTGVhcm4gbW9yZSBhdDogaHR0cHM6Ly9yZWFjdGpzLm9yZy9saW5rL2Rlcml2ZWQtc3RhdGVcbicgKyAnKiBSZW5hbWUgY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyB0byBVTlNBRkVfY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyB0byBzdXBwcmVzcyAnICsgJ3RoaXMgd2FybmluZyBpbiBub24tc3RyaWN0IG1vZGUuIEluIFJlYWN0IDE4LngsIG9ubHkgdGhlIFVOU0FGRV8gbmFtZSB3aWxsIHdvcmsuICcgKyAnVG8gcmVuYW1lIGFsbCBkZXByZWNhdGVkIGxpZmVjeWNsZXMgdG8gdGhlaXIgbmV3IG5hbWVzLCB5b3UgY2FuIHJ1biAnICsgJ2BucHggcmVhY3QtY29kZW1vZCByZW5hbWUtdW5zYWZlLWxpZmVjeWNsZXNgIGluIHlvdXIgcHJvamVjdCBzb3VyY2UgZm9sZGVyLlxuJyArICdcblBsZWFzZSB1cGRhdGUgdGhlIGZvbGxvd2luZyBjb21wb25lbnRzOiAlcycsIF9zb3J0ZWROYW1lczQpOwogICAgICB9CgogICAgICBpZiAoY29tcG9uZW50V2lsbFVwZGF0ZVVuaXF1ZU5hbWVzLnNpemUgPiAwKSB7CiAgICAgICAgdmFyIF9zb3J0ZWROYW1lczUgPSBzZXRUb1NvcnRlZFN0cmluZyhjb21wb25lbnRXaWxsVXBkYXRlVW5pcXVlTmFtZXMpOwoKICAgICAgICB3YXJuKCdjb21wb25lbnRXaWxsVXBkYXRlIGhhcyBiZWVuIHJlbmFtZWQsIGFuZCBpcyBub3QgcmVjb21tZW5kZWQgZm9yIHVzZS4gJyArICdTZWUgaHR0cHM6Ly9yZWFjdGpzLm9yZy9saW5rL3Vuc2FmZS1jb21wb25lbnQtbGlmZWN5Y2xlcyBmb3IgZGV0YWlscy5cblxuJyArICcqIE1vdmUgZGF0YSBmZXRjaGluZyBjb2RlIG9yIHNpZGUgZWZmZWN0cyB0byBjb21wb25lbnREaWRVcGRhdGUuXG4nICsgJyogUmVuYW1lIGNvbXBvbmVudFdpbGxVcGRhdGUgdG8gVU5TQUZFX2NvbXBvbmVudFdpbGxVcGRhdGUgdG8gc3VwcHJlc3MgJyArICd0aGlzIHdhcm5pbmcgaW4gbm9uLXN0cmljdCBtb2RlLiBJbiBSZWFjdCAxOC54LCBvbmx5IHRoZSBVTlNBRkVfIG5hbWUgd2lsbCB3b3JrLiAnICsgJ1RvIHJlbmFtZSBhbGwgZGVwcmVjYXRlZCBsaWZlY3ljbGVzIHRvIHRoZWlyIG5ldyBuYW1lcywgeW91IGNhbiBydW4gJyArICdgbnB4IHJlYWN0LWNvZGVtb2QgcmVuYW1lLXVuc2FmZS1saWZlY3ljbGVzYCBpbiB5b3VyIHByb2plY3Qgc291cmNlIGZvbGRlci5cbicgKyAnXG5QbGVhc2UgdXBkYXRlIHRoZSBmb2xsb3dpbmcgY29tcG9uZW50czogJXMnLCBfc29ydGVkTmFtZXM1KTsKICAgICAgfQogICAgfTsKCiAgICB2YXIgcGVuZGluZ0xlZ2FjeUNvbnRleHRXYXJuaW5nID0gbmV3IE1hcCgpOyAvLyBUcmFja3MgY29tcG9uZW50cyB3ZSBoYXZlIGFscmVhZHkgd2FybmVkIGFib3V0LgoKICAgIHZhciBkaWRXYXJuQWJvdXRMZWdhY3lDb250ZXh0ID0gbmV3IFNldCgpOwoKICAgIFJlYWN0U3RyaWN0TW9kZVdhcm5pbmdzLnJlY29yZExlZ2FjeUNvbnRleHRXYXJuaW5nID0gZnVuY3Rpb24gKGZpYmVyLCBpbnN0YW5jZSkgewogICAgICB2YXIgc3RyaWN0Um9vdCA9IGZpbmRTdHJpY3RSb290KGZpYmVyKTsKCiAgICAgIGlmIChzdHJpY3RSb290ID09PSBudWxsKSB7CiAgICAgICAgZXJyb3IoJ0V4cGVjdGVkIHRvIGZpbmQgYSBTdHJpY3RNb2RlIGNvbXBvbmVudCBpbiBhIHN0cmljdCBtb2RlIHRyZWUuICcgKyAnVGhpcyBlcnJvciBpcyBsaWtlbHkgY2F1c2VkIGJ5IGEgYnVnIGluIFJlYWN0LiBQbGVhc2UgZmlsZSBhbiBpc3N1ZS4nKTsKCiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vIERlZHVwIHN0cmF0ZWd5OiBXYXJuIG9uY2UgcGVyIGNvbXBvbmVudC4KCgogICAgICBpZiAoZGlkV2FybkFib3V0TGVnYWN5Q29udGV4dC5oYXMoZmliZXIudHlwZSkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciB3YXJuaW5nc0ZvclJvb3QgPSBwZW5kaW5nTGVnYWN5Q29udGV4dFdhcm5pbmcuZ2V0KHN0cmljdFJvb3QpOwoKICAgICAgaWYgKGZpYmVyLnR5cGUuY29udGV4dFR5cGVzICE9IG51bGwgfHwgZmliZXIudHlwZS5jaGlsZENvbnRleHRUeXBlcyAhPSBudWxsIHx8IGluc3RhbmNlICE9PSBudWxsICYmIHR5cGVvZiBpbnN0YW5jZS5nZXRDaGlsZENvbnRleHQgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICBpZiAod2FybmluZ3NGb3JSb290ID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgIHdhcm5pbmdzRm9yUm9vdCA9IFtdOwogICAgICAgICAgcGVuZGluZ0xlZ2FjeUNvbnRleHRXYXJuaW5nLnNldChzdHJpY3RSb290LCB3YXJuaW5nc0ZvclJvb3QpOwogICAgICAgIH0KCiAgICAgICAgd2FybmluZ3NGb3JSb290LnB1c2goZmliZXIpOwogICAgICB9CiAgICB9OwoKICAgIFJlYWN0U3RyaWN0TW9kZVdhcm5pbmdzLmZsdXNoTGVnYWN5Q29udGV4dFdhcm5pbmcgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHBlbmRpbmdMZWdhY3lDb250ZXh0V2FybmluZy5mb3JFYWNoKGZ1bmN0aW9uIChmaWJlckFycmF5LCBzdHJpY3RSb290KSB7CiAgICAgICAgaWYgKGZpYmVyQXJyYXkubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICB2YXIgZmlyc3RGaWJlciA9IGZpYmVyQXJyYXlbMF07CiAgICAgICAgdmFyIHVuaXF1ZU5hbWVzID0gbmV3IFNldCgpOwogICAgICAgIGZpYmVyQXJyYXkuZm9yRWFjaChmdW5jdGlvbiAoZmliZXIpIHsKICAgICAgICAgIHVuaXF1ZU5hbWVzLmFkZChnZXRDb21wb25lbnROYW1lRnJvbUZpYmVyKGZpYmVyKSB8fCAnQ29tcG9uZW50Jyk7CiAgICAgICAgICBkaWRXYXJuQWJvdXRMZWdhY3lDb250ZXh0LmFkZChmaWJlci50eXBlKTsKICAgICAgICB9KTsKICAgICAgICB2YXIgc29ydGVkTmFtZXMgPSBzZXRUb1NvcnRlZFN0cmluZyh1bmlxdWVOYW1lcyk7CgogICAgICAgIHRyeSB7CiAgICAgICAgICBzZXRDdXJyZW50RmliZXIoZmlyc3RGaWJlcik7CgogICAgICAgICAgZXJyb3IoJ0xlZ2FjeSBjb250ZXh0IEFQSSBoYXMgYmVlbiBkZXRlY3RlZCB3aXRoaW4gYSBzdHJpY3QtbW9kZSB0cmVlLicgKyAnXG5cblRoZSBvbGQgQVBJIHdpbGwgYmUgc3VwcG9ydGVkIGluIGFsbCAxNi54IHJlbGVhc2VzLCBidXQgYXBwbGljYXRpb25zICcgKyAndXNpbmcgaXQgc2hvdWxkIG1pZ3JhdGUgdG8gdGhlIG5ldyB2ZXJzaW9uLicgKyAnXG5cblBsZWFzZSB1cGRhdGUgdGhlIGZvbGxvd2luZyBjb21wb25lbnRzOiAlcycgKyAnXG5cbkxlYXJuIG1vcmUgYWJvdXQgdGhpcyB3YXJuaW5nIGhlcmU6IGh0dHBzOi8vcmVhY3Rqcy5vcmcvbGluay9sZWdhY3ktY29udGV4dCcsIHNvcnRlZE5hbWVzKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgcmVzZXRDdXJyZW50RmliZXIoKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfTsKCiAgICBSZWFjdFN0cmljdE1vZGVXYXJuaW5ncy5kaXNjYXJkUGVuZGluZ1dhcm5pbmdzID0gZnVuY3Rpb24gKCkgewogICAgICBwZW5kaW5nQ29tcG9uZW50V2lsbE1vdW50V2FybmluZ3MgPSBbXTsKICAgICAgcGVuZGluZ1VOU0FGRV9Db21wb25lbnRXaWxsTW91bnRXYXJuaW5ncyA9IFtdOwogICAgICBwZW5kaW5nQ29tcG9uZW50V2lsbFJlY2VpdmVQcm9wc1dhcm5pbmdzID0gW107CiAgICAgIHBlbmRpbmdVTlNBRkVfQ29tcG9uZW50V2lsbFJlY2VpdmVQcm9wc1dhcm5pbmdzID0gW107CiAgICAgIHBlbmRpbmdDb21wb25lbnRXaWxsVXBkYXRlV2FybmluZ3MgPSBbXTsKICAgICAgcGVuZGluZ1VOU0FGRV9Db21wb25lbnRXaWxsVXBkYXRlV2FybmluZ3MgPSBbXTsKICAgICAgcGVuZGluZ0xlZ2FjeUNvbnRleHRXYXJuaW5nID0gbmV3IE1hcCgpOwogICAgfTsKICB9CgogIHZhciBkaWRXYXJuQWJvdXRNYXBzOwogIHZhciBkaWRXYXJuQWJvdXRHZW5lcmF0b3JzOwogIHZhciBkaWRXYXJuQWJvdXRTdHJpbmdSZWZzOwogIHZhciBvd25lckhhc0tleVVzZVdhcm5pbmc7CiAgdmFyIG93bmVySGFzRnVuY3Rpb25UeXBlV2FybmluZzsKCiAgdmFyIHdhcm5Gb3JNaXNzaW5nS2V5ID0gZnVuY3Rpb24gKGNoaWxkLCByZXR1cm5GaWJlcikge307CgogIHsKICAgIGRpZFdhcm5BYm91dE1hcHMgPSBmYWxzZTsKICAgIGRpZFdhcm5BYm91dEdlbmVyYXRvcnMgPSBmYWxzZTsKICAgIGRpZFdhcm5BYm91dFN0cmluZ1JlZnMgPSB7fTsKICAgIC8qKgogICAgICogV2FybiBpZiB0aGVyZSdzIG5vIGtleSBleHBsaWNpdGx5IHNldCBvbiBkeW5hbWljIGFycmF5cyBvZiBjaGlsZHJlbiBvcgogICAgICogb2JqZWN0IGtleXMgYXJlIG5vdCB2YWxpZC4gVGhpcyBhbGxvd3MgdXMgdG8ga2VlcCB0cmFjayBvZiBjaGlsZHJlbiBiZXR3ZWVuCiAgICAgKiB1cGRhdGVzLgogICAgICovCgogICAgb3duZXJIYXNLZXlVc2VXYXJuaW5nID0ge307CiAgICBvd25lckhhc0Z1bmN0aW9uVHlwZVdhcm5pbmcgPSB7fTsKCiAgICB3YXJuRm9yTWlzc2luZ0tleSA9IGZ1bmN0aW9uIChjaGlsZCwgcmV0dXJuRmliZXIpIHsKICAgICAgaWYgKGNoaWxkID09PSBudWxsIHx8IHR5cGVvZiBjaGlsZCAhPT0gJ29iamVjdCcpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICghY2hpbGQuX3N0b3JlIHx8IGNoaWxkLl9zdG9yZS52YWxpZGF0ZWQgfHwgY2hpbGQua2V5ICE9IG51bGwpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0eXBlb2YgY2hpbGQuX3N0b3JlICE9PSAnb2JqZWN0JykgewogICAgICAgIHRocm93IG5ldyBFcnJvcignUmVhY3QgQ29tcG9uZW50IGluIHdhcm5Gb3JNaXNzaW5nS2V5IHNob3VsZCBoYXZlIGEgX3N0b3JlLiAnICsgJ1RoaXMgZXJyb3IgaXMgbGlrZWx5IGNhdXNlZCBieSBhIGJ1ZyBpbiBSZWFjdC4gUGxlYXNlIGZpbGUgYW4gaXNzdWUuJyk7CiAgICAgIH0KCiAgICAgIGNoaWxkLl9zdG9yZS52YWxpZGF0ZWQgPSB0cnVlOwogICAgICB2YXIgY29tcG9uZW50TmFtZSA9IGdldENvbXBvbmVudE5hbWVGcm9tRmliZXIocmV0dXJuRmliZXIpIHx8ICdDb21wb25lbnQnOwoKICAgICAgaWYgKG93bmVySGFzS2V5VXNlV2FybmluZ1tjb21wb25lbnROYW1lXSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgb3duZXJIYXNLZXlVc2VXYXJuaW5nW2NvbXBvbmVudE5hbWVdID0gdHJ1ZTsKCiAgICAgIGVycm9yKCdFYWNoIGNoaWxkIGluIGEgbGlzdCBzaG91bGQgaGF2ZSBhIHVuaXF1ZSAnICsgJyJrZXkiIHByb3AuIFNlZSBodHRwczovL3JlYWN0anMub3JnL2xpbmsvd2FybmluZy1rZXlzIGZvciAnICsgJ21vcmUgaW5mb3JtYXRpb24uJyk7CiAgICB9OwogIH0KCiAgZnVuY3Rpb24gaXNSZWFjdENsYXNzKHR5cGUpIHsKICAgIHJldHVybiB0eXBlLnByb3RvdHlwZSAmJiB0eXBlLnByb3RvdHlwZS5pc1JlYWN0Q29tcG9uZW50OwogIH0KCiAgZnVuY3Rpb24gY29lcmNlUmVmKHJldHVybkZpYmVyLCBjdXJyZW50LCBlbGVtZW50KSB7CiAgICB2YXIgbWl4ZWRSZWYgPSBlbGVtZW50LnJlZjsKCiAgICBpZiAobWl4ZWRSZWYgIT09IG51bGwgJiYgdHlwZW9mIG1peGVkUmVmICE9PSAnZnVuY3Rpb24nICYmIHR5cGVvZiBtaXhlZFJlZiAhPT0gJ29iamVjdCcpIHsKICAgICAgewogICAgICAgIC8vIFRPRE86IENsZWFuIHRoaXMgdXAgb25jZSB3ZSB0dXJuIG9uIHRoZSBzdHJpbmcgcmVmIHdhcm5pbmcgZm9yCiAgICAgICAgLy8gZXZlcnlvbmUsIGJlY2F1c2UgdGhlIHN0cmljdCBtb2RlIGNhc2Ugd2lsbCBubyBsb25nZXIgYmUgcmVsZXZhbnQKICAgICAgICBpZiAoKHJldHVybkZpYmVyLm1vZGUgJiBTdHJpY3RMZWdhY3lNb2RlIHx8IHdhcm5BYm91dFN0cmluZ1JlZnMpICYmIC8vIFdlIHdhcm4gaW4gUmVhY3RFbGVtZW50LmpzIGlmIG93bmVyIGFuZCBzZWxmIGFyZSBlcXVhbCBmb3Igc3RyaW5nIHJlZnMKICAgICAgICAvLyBiZWNhdXNlIHRoZXNlIGNhbm5vdCBiZSBhdXRvbWF0aWNhbGx5IGNvbnZlcnRlZCB0byBhbiBhcnJvdyBmdW5jdGlvbgogICAgICAgIC8vIHVzaW5nIGEgY29kZW1vZC4gVGhlcmVmb3JlLCB3ZSBkb24ndCBoYXZlIHRvIHdhcm4gYWJvdXQgc3RyaW5nIHJlZnMgYWdhaW4uCiAgICAgICAgIShlbGVtZW50Ll9vd25lciAmJiBlbGVtZW50Ll9zZWxmICYmIGVsZW1lbnQuX293bmVyLnN0YXRlTm9kZSAhPT0gZWxlbWVudC5fc2VsZikgJiYgLy8gV2lsbCBhbHJlYWR5IHRocm93IHdpdGggIkZ1bmN0aW9uIGNvbXBvbmVudHMgY2Fubm90IGhhdmUgc3RyaW5nIHJlZnMiCiAgICAgICAgIShlbGVtZW50Ll9vd25lciAmJiBlbGVtZW50Ll9vd25lci50YWcgIT09IENsYXNzQ29tcG9uZW50KSAmJiAvLyBXaWxsIGFscmVhZHkgd2FybiB3aXRoICJGdW5jdGlvbiBjb21wb25lbnRzIGNhbm5vdCBiZSBnaXZlbiByZWZzIgogICAgICAgICEodHlwZW9mIGVsZW1lbnQudHlwZSA9PT0gJ2Z1bmN0aW9uJyAmJiAhaXNSZWFjdENsYXNzKGVsZW1lbnQudHlwZSkpICYmIC8vIFdpbGwgYWxyZWFkeSB0aHJvdyB3aXRoICJFbGVtZW50IHJlZiB3YXMgc3BlY2lmaWVkIGFzIGEgc3RyaW5nIChzb21lU3RyaW5nUmVmKSBidXQgbm8gb3duZXIgd2FzIHNldCIKICAgICAgICBlbGVtZW50Ll9vd25lcikgewogICAgICAgICAgdmFyIGNvbXBvbmVudE5hbWUgPSBnZXRDb21wb25lbnROYW1lRnJvbUZpYmVyKHJldHVybkZpYmVyKSB8fCAnQ29tcG9uZW50JzsKCiAgICAgICAgICBpZiAoIWRpZFdhcm5BYm91dFN0cmluZ1JlZnNbY29tcG9uZW50TmFtZV0pIHsKICAgICAgICAgICAgewogICAgICAgICAgICAgIGVycm9yKCdDb21wb25lbnQgIiVzIiBjb250YWlucyB0aGUgc3RyaW5nIHJlZiAiJXMiLiBTdXBwb3J0IGZvciBzdHJpbmcgcmVmcyAnICsgJ3dpbGwgYmUgcmVtb3ZlZCBpbiBhIGZ1dHVyZSBtYWpvciByZWxlYXNlLiBXZSByZWNvbW1lbmQgdXNpbmcgJyArICd1c2VSZWYoKSBvciBjcmVhdGVSZWYoKSBpbnN0ZWFkLiAnICsgJ0xlYXJuIG1vcmUgYWJvdXQgdXNpbmcgcmVmcyBzYWZlbHkgaGVyZTogJyArICdodHRwczovL3JlYWN0anMub3JnL2xpbmsvc3RyaWN0LW1vZGUtc3RyaW5nLXJlZicsIGNvbXBvbmVudE5hbWUsIG1peGVkUmVmKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZGlkV2FybkFib3V0U3RyaW5nUmVmc1tjb21wb25lbnROYW1lXSA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoZWxlbWVudC5fb3duZXIpIHsKICAgICAgICB2YXIgb3duZXIgPSBlbGVtZW50Ll9vd25lcjsKICAgICAgICB2YXIgaW5zdDsKCiAgICAgICAgaWYgKG93bmVyKSB7CiAgICAgICAgICB2YXIgb3duZXJGaWJlciA9IG93bmVyOwoKICAgICAgICAgIGlmIChvd25lckZpYmVyLnRhZyAhPT0gQ2xhc3NDb21wb25lbnQpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGdW5jdGlvbiBjb21wb25lbnRzIGNhbm5vdCBoYXZlIHN0cmluZyByZWZzLiAnICsgJ1dlIHJlY29tbWVuZCB1c2luZyB1c2VSZWYoKSBpbnN0ZWFkLiAnICsgJ0xlYXJuIG1vcmUgYWJvdXQgdXNpbmcgcmVmcyBzYWZlbHkgaGVyZTogJyArICdodHRwczovL3JlYWN0anMub3JnL2xpbmsvc3RyaWN0LW1vZGUtc3RyaW5nLXJlZicpOwogICAgICAgICAgfQoKICAgICAgICAgIGluc3QgPSBvd25lckZpYmVyLnN0YXRlTm9kZTsKICAgICAgICB9CgogICAgICAgIGlmICghaW5zdCkgewogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJNaXNzaW5nIG93bmVyIGZvciBzdHJpbmcgcmVmICIgKyBtaXhlZFJlZiArICIuIFRoaXMgZXJyb3IgaXMgbGlrZWx5IGNhdXNlZCBieSBhICIgKyAnYnVnIGluIFJlYWN0LiBQbGVhc2UgZmlsZSBhbiBpc3N1ZS4nKTsKICAgICAgICB9IC8vIEFzc2lnbmluZyB0aGlzIHRvIGEgY29uc3Qgc28gRmxvdyBrbm93cyBpdCB3b24ndCBjaGFuZ2UgaW4gdGhlIGNsb3N1cmUKCgogICAgICAgIHZhciByZXNvbHZlZEluc3QgPSBpbnN0OwoKICAgICAgICB7CiAgICAgICAgICBjaGVja1Byb3BTdHJpbmdDb2VyY2lvbihtaXhlZFJlZiwgJ3JlZicpOwogICAgICAgIH0KCiAgICAgICAgdmFyIHN0cmluZ1JlZiA9ICcnICsgbWl4ZWRSZWY7IC8vIENoZWNrIGlmIHByZXZpb3VzIHN0cmluZyByZWYgbWF0Y2hlcyBuZXcgc3RyaW5nIHJlZgoKICAgICAgICBpZiAoY3VycmVudCAhPT0gbnVsbCAmJiBjdXJyZW50LnJlZiAhPT0gbnVsbCAmJiB0eXBlb2YgY3VycmVudC5yZWYgPT09ICdmdW5jdGlvbicgJiYgY3VycmVudC5yZWYuX3N0cmluZ1JlZiA9PT0gc3RyaW5nUmVmKSB7CiAgICAgICAgICByZXR1cm4gY3VycmVudC5yZWY7CiAgICAgICAgfQoKICAgICAgICB2YXIgcmVmID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgICB2YXIgcmVmcyA9IHJlc29sdmVkSW5zdC5yZWZzOwoKICAgICAgICAgIGlmICh2YWx1ZSA9PT0gbnVsbCkgewogICAgICAgICAgICBkZWxldGUgcmVmc1tzdHJpbmdSZWZdOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVmc1tzdHJpbmdSZWZdID0gdmFsdWU7CiAgICAgICAgICB9CiAgICAgICAgfTsKCiAgICAgICAgcmVmLl9zdHJpbmdSZWYgPSBzdHJpbmdSZWY7CiAgICAgICAgcmV0dXJuIHJlZjsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAodHlwZW9mIG1peGVkUmVmICE9PSAnc3RyaW5nJykgewogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdFeHBlY3RlZCByZWYgdG8gYmUgYSBmdW5jdGlvbiwgYSBzdHJpbmcsIGFuIG9iamVjdCByZXR1cm5lZCBieSBSZWFjdC5jcmVhdGVSZWYoKSwgb3IgbnVsbC4nKTsKICAgICAgICB9CgogICAgICAgIGlmICghZWxlbWVudC5fb3duZXIpIHsKICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiRWxlbWVudCByZWYgd2FzIHNwZWNpZmllZCBhcyBhIHN0cmluZyAoIiArIG1peGVkUmVmICsgIikgYnV0IG5vIG93bmVyIHdhcyBzZXQuIFRoaXMgY291bGQgaGFwcGVuIGZvciBvbmUgb2YiICsgJyB0aGUgZm9sbG93aW5nIHJlYXNvbnM6XG4nICsgJzEuIFlvdSBtYXkgYmUgYWRkaW5nIGEgcmVmIHRvIGEgZnVuY3Rpb24gY29tcG9uZW50XG4nICsgIjIuIFlvdSBtYXkgYmUgYWRkaW5nIGEgcmVmIHRvIGEgY29tcG9uZW50IHRoYXQgd2FzIG5vdCBjcmVhdGVkIGluc2lkZSBhIGNvbXBvbmVudCdzIHJlbmRlciBtZXRob2RcbiIgKyAnMy4gWW91IGhhdmUgbXVsdGlwbGUgY29waWVzIG9mIFJlYWN0IGxvYWRlZFxuJyArICdTZWUgaHR0cHM6Ly9yZWFjdGpzLm9yZy9saW5rL3JlZnMtbXVzdC1oYXZlLW93bmVyIGZvciBtb3JlIGluZm9ybWF0aW9uLicpOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHJldHVybiBtaXhlZFJlZjsKICB9CgogIGZ1bmN0aW9uIHRocm93T25JbnZhbGlkT2JqZWN0VHlwZShyZXR1cm5GaWJlciwgbmV3Q2hpbGQpIHsKICAgIHZhciBjaGlsZFN0cmluZyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChuZXdDaGlsZCk7CiAgICB0aHJvdyBuZXcgRXJyb3IoIk9iamVjdHMgYXJlIG5vdCB2YWxpZCBhcyBhIFJlYWN0IGNoaWxkIChmb3VuZDogIiArIChjaGlsZFN0cmluZyA9PT0gJ1tvYmplY3QgT2JqZWN0XScgPyAnb2JqZWN0IHdpdGgga2V5cyB7JyArIE9iamVjdC5rZXlzKG5ld0NoaWxkKS5qb2luKCcsICcpICsgJ30nIDogY2hpbGRTdHJpbmcpICsgIikuICIgKyAnSWYgeW91IG1lYW50IHRvIHJlbmRlciBhIGNvbGxlY3Rpb24gb2YgY2hpbGRyZW4sIHVzZSBhbiBhcnJheSAnICsgJ2luc3RlYWQuJyk7CiAgfQoKICBmdW5jdGlvbiB3YXJuT25GdW5jdGlvblR5cGUocmV0dXJuRmliZXIpIHsKICAgIHsKICAgICAgdmFyIGNvbXBvbmVudE5hbWUgPSBnZXRDb21wb25lbnROYW1lRnJvbUZpYmVyKHJldHVybkZpYmVyKSB8fCAnQ29tcG9uZW50JzsKCiAgICAgIGlmIChvd25lckhhc0Z1bmN0aW9uVHlwZVdhcm5pbmdbY29tcG9uZW50TmFtZV0pIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIG93bmVySGFzRnVuY3Rpb25UeXBlV2FybmluZ1tjb21wb25lbnROYW1lXSA9IHRydWU7CgogICAgICBlcnJvcignRnVuY3Rpb25zIGFyZSBub3QgdmFsaWQgYXMgYSBSZWFjdCBjaGlsZC4gVGhpcyBtYXkgaGFwcGVuIGlmICcgKyAneW91IHJldHVybiBhIENvbXBvbmVudCBpbnN0ZWFkIG9mIDxDb21wb25lbnQgLz4gZnJvbSByZW5kZXIuICcgKyAnT3IgbWF5YmUgeW91IG1lYW50IHRvIGNhbGwgdGhpcyBmdW5jdGlvbiByYXRoZXIgdGhhbiByZXR1cm4gaXQuJyk7CiAgICB9CiAgfQoKICBmdW5jdGlvbiByZXNvbHZlTGF6eShsYXp5VHlwZSkgewogICAgdmFyIHBheWxvYWQgPSBsYXp5VHlwZS5fcGF5bG9hZDsKICAgIHZhciBpbml0ID0gbGF6eVR5cGUuX2luaXQ7CiAgICByZXR1cm4gaW5pdChwYXlsb2FkKTsKICB9IC8vIFRoaXMgd3JhcHBlciBmdW5jdGlvbiBleGlzdHMgYmVjYXVzZSBJIGV4cGVjdCB0byBjbG9uZSB0aGUgY29kZSBpbiBlYWNoIHBhdGgKICAvLyB0byBiZSBhYmxlIHRvIG9wdGltaXplIGVhY2ggcGF0aCBpbmRpdmlkdWFsbHkgYnkgYnJhbmNoaW5nIGVhcmx5LiBUaGlzIG5lZWRzCiAgLy8gYSBjb21waWxlciBvciB3ZSBjYW4gZG8gaXQgbWFudWFsbHkuIEhlbHBlcnMgdGhhdCBkb24ndCBuZWVkIHRoaXMgYnJhbmNoaW5nCiAgLy8gbGl2ZSBvdXRzaWRlIG9mIHRoaXMgZnVuY3Rpb24uCgoKICBmdW5jdGlvbiBDaGlsZFJlY29uY2lsZXIoc2hvdWxkVHJhY2tTaWRlRWZmZWN0cykgewogICAgZnVuY3Rpb24gZGVsZXRlQ2hpbGQocmV0dXJuRmliZXIsIGNoaWxkVG9EZWxldGUpIHsKICAgICAgaWYgKCFzaG91bGRUcmFja1NpZGVFZmZlY3RzKSB7CiAgICAgICAgLy8gTm9vcC4KICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBkZWxldGlvbnMgPSByZXR1cm5GaWJlci5kZWxldGlvbnM7CgogICAgICBpZiAoZGVsZXRpb25zID09PSBudWxsKSB7CiAgICAgICAgcmV0dXJuRmliZXIuZGVsZXRpb25zID0gW2NoaWxkVG9EZWxldGVdOwogICAgICAgIHJldHVybkZpYmVyLmZsYWdzIHw9IENoaWxkRGVsZXRpb247CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZGVsZXRpb25zLnB1c2goY2hpbGRUb0RlbGV0ZSk7CiAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBkZWxldGVSZW1haW5pbmdDaGlsZHJlbihyZXR1cm5GaWJlciwgY3VycmVudEZpcnN0Q2hpbGQpIHsKICAgICAgaWYgKCFzaG91bGRUcmFja1NpZGVFZmZlY3RzKSB7CiAgICAgICAgLy8gTm9vcC4KICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfSAvLyBUT0RPOiBGb3IgdGhlIHNob3VsZENsb25lIGNhc2UsIHRoaXMgY291bGQgYmUgbWljcm8tb3B0aW1pemVkIGEgYml0IGJ5CiAgICAgIC8vIGFzc3VtaW5nIHRoYXQgYWZ0ZXIgdGhlIGZpcnN0IGNoaWxkIHdlJ3ZlIGFscmVhZHkgYWRkZWQgZXZlcnl0aGluZy4KCgogICAgICB2YXIgY2hpbGRUb0RlbGV0ZSA9IGN1cnJlbnRGaXJzdENoaWxkOwoKICAgICAgd2hpbGUgKGNoaWxkVG9EZWxldGUgIT09IG51bGwpIHsKICAgICAgICBkZWxldGVDaGlsZChyZXR1cm5GaWJlciwgY2hpbGRUb0RlbGV0ZSk7CiAgICAgICAgY2hpbGRUb0RlbGV0ZSA9IGNoaWxkVG9EZWxldGUuc2libGluZzsKICAgICAgfQoKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgZnVuY3Rpb24gbWFwUmVtYWluaW5nQ2hpbGRyZW4ocmV0dXJuRmliZXIsIGN1cnJlbnRGaXJzdENoaWxkKSB7CiAgICAgIC8vIEFkZCB0aGUgcmVtYWluaW5nIGNoaWxkcmVuIHRvIGEgdGVtcG9yYXJ5IG1hcCBzbyB0aGF0IHdlIGNhbiBmaW5kIHRoZW0gYnkKICAgICAgLy8ga2V5cyBxdWlja2x5LiBJbXBsaWNpdCAobnVsbCkga2V5cyBnZXQgYWRkZWQgdG8gdGhpcyBzZXQgd2l0aCB0aGVpciBpbmRleAogICAgICAvLyBpbnN0ZWFkLgogICAgICB2YXIgZXhpc3RpbmdDaGlsZHJlbiA9IG5ldyBNYXAoKTsKICAgICAgdmFyIGV4aXN0aW5nQ2hpbGQgPSBjdXJyZW50Rmlyc3RDaGlsZDsKCiAgICAgIHdoaWxlIChleGlzdGluZ0NoaWxkICE9PSBudWxsKSB7CiAgICAgICAgaWYgKGV4aXN0aW5nQ2hpbGQua2V5ICE9PSBudWxsKSB7CiAgICAgICAgICBleGlzdGluZ0NoaWxkcmVuLnNldChleGlzdGluZ0NoaWxkLmtleSwgZXhpc3RpbmdDaGlsZCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGV4aXN0aW5nQ2hpbGRyZW4uc2V0KGV4aXN0aW5nQ2hpbGQuaW5kZXgsIGV4aXN0aW5nQ2hpbGQpOwogICAgICAgIH0KCiAgICAgICAgZXhpc3RpbmdDaGlsZCA9IGV4aXN0aW5nQ2hpbGQuc2libGluZzsKICAgICAgfQoKICAgICAgcmV0dXJuIGV4aXN0aW5nQ2hpbGRyZW47CiAgICB9CgogICAgZnVuY3Rpb24gdXNlRmliZXIoZmliZXIsIHBlbmRpbmdQcm9wcykgewogICAgICAvLyBXZSBjdXJyZW50bHkgc2V0IHNpYmxpbmcgdG8gbnVsbCBhbmQgaW5kZXggdG8gMCBoZXJlIGJlY2F1c2UgaXQgaXMgZWFzeQogICAgICAvLyB0byBmb3JnZXQgdG8gZG8gYmVmb3JlIHJldHVybmluZyBpdC4gRS5nLiBmb3IgdGhlIHNpbmdsZSBjaGlsZCBjYXNlLgogICAgICB2YXIgY2xvbmUgPSBjcmVhdGVXb3JrSW5Qcm9ncmVzcyhmaWJlciwgcGVuZGluZ1Byb3BzKTsKICAgICAgY2xvbmUuaW5kZXggPSAwOwogICAgICBjbG9uZS5zaWJsaW5nID0gbnVsbDsKICAgICAgcmV0dXJuIGNsb25lOwogICAgfQoKICAgIGZ1bmN0aW9uIHBsYWNlQ2hpbGQobmV3RmliZXIsIGxhc3RQbGFjZWRJbmRleCwgbmV3SW5kZXgpIHsKICAgICAgbmV3RmliZXIuaW5kZXggPSBuZXdJbmRleDsKCiAgICAgIGlmICghc2hvdWxkVHJhY2tTaWRlRWZmZWN0cykgewogICAgICAgIC8vIER1cmluZyBoeWRyYXRpb24sIHRoZSB1c2VJZCBhbGdvcml0aG0gbmVlZHMgdG8ga25vdyB3aGljaCBmaWJlcnMgYXJlCiAgICAgICAgLy8gcGFydCBvZiBhIGxpc3Qgb2YgY2hpbGRyZW4gKGFycmF5cywgaXRlcmF0b3JzKS4KICAgICAgICBuZXdGaWJlci5mbGFncyB8PSBGb3JrZWQ7CiAgICAgICAgcmV0dXJuIGxhc3RQbGFjZWRJbmRleDsKICAgICAgfQoKICAgICAgdmFyIGN1cnJlbnQgPSBuZXdGaWJlci5hbHRlcm5hdGU7CgogICAgICBpZiAoY3VycmVudCAhPT0gbnVsbCkgewogICAgICAgIHZhciBvbGRJbmRleCA9IGN1cnJlbnQuaW5kZXg7CgogICAgICAgIGlmIChvbGRJbmRleCA8IGxhc3RQbGFjZWRJbmRleCkgewogICAgICAgICAgLy8gVGhpcyBpcyBhIG1vdmUuCiAgICAgICAgICBuZXdGaWJlci5mbGFncyB8PSBQbGFjZW1lbnQ7CiAgICAgICAgICByZXR1cm4gbGFzdFBsYWNlZEluZGV4OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyBUaGlzIGl0ZW0gY2FuIHN0YXkgaW4gcGxhY2UuCiAgICAgICAgICByZXR1cm4gb2xkSW5kZXg7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vIFRoaXMgaXMgYW4gaW5zZXJ0aW9uLgogICAgICAgIG5ld0ZpYmVyLmZsYWdzIHw9IFBsYWNlbWVudDsKICAgICAgICByZXR1cm4gbGFzdFBsYWNlZEluZGV4OwogICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gcGxhY2VTaW5nbGVDaGlsZChuZXdGaWJlcikgewogICAgICAvLyBUaGlzIGlzIHNpbXBsZXIgZm9yIHRoZSBzaW5nbGUgY2hpbGQgY2FzZS4gV2Ugb25seSBuZWVkIHRvIGRvIGEKICAgICAgLy8gcGxhY2VtZW50IGZvciBpbnNlcnRpbmcgbmV3IGNoaWxkcmVuLgogICAgICBpZiAoc2hvdWxkVHJhY2tTaWRlRWZmZWN0cyAmJiBuZXdGaWJlci5hbHRlcm5hdGUgPT09IG51bGwpIHsKICAgICAgICBuZXdGaWJlci5mbGFncyB8PSBQbGFjZW1lbnQ7CiAgICAgIH0KCiAgICAgIHJldHVybiBuZXdGaWJlcjsKICAgIH0KCiAgICBmdW5jdGlvbiB1cGRhdGVUZXh0Tm9kZShyZXR1cm5GaWJlciwgY3VycmVudCwgdGV4dENvbnRlbnQsIGxhbmVzKSB7CiAgICAgIGlmIChjdXJyZW50ID09PSBudWxsIHx8IGN1cnJlbnQudGFnICE9PSBIb3N0VGV4dCkgewogICAgICAgIC8vIEluc2VydAogICAgICAgIHZhciBjcmVhdGVkID0gY3JlYXRlRmliZXJGcm9tVGV4dCh0ZXh0Q29udGVudCwgcmV0dXJuRmliZXIubW9kZSwgbGFuZXMpOwogICAgICAgIGNyZWF0ZWQucmV0dXJuID0gcmV0dXJuRmliZXI7CiAgICAgICAgcmV0dXJuIGNyZWF0ZWQ7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gVXBkYXRlCiAgICAgICAgdmFyIGV4aXN0aW5nID0gdXNlRmliZXIoY3VycmVudCwgdGV4dENvbnRlbnQpOwogICAgICAgIGV4aXN0aW5nLnJldHVybiA9IHJldHVybkZpYmVyOwogICAgICAgIHJldHVybiBleGlzdGluZzsKICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHVwZGF0ZUVsZW1lbnQocmV0dXJuRmliZXIsIGN1cnJlbnQsIGVsZW1lbnQsIGxhbmVzKSB7CiAgICAgIHZhciBlbGVtZW50VHlwZSA9IGVsZW1lbnQudHlwZTsKCiAgICAgIGlmIChlbGVtZW50VHlwZSA9PT0gUkVBQ1RfRlJBR01FTlRfVFlQRSkgewogICAgICAgIHJldHVybiB1cGRhdGVGcmFnbWVudChyZXR1cm5GaWJlciwgY3VycmVudCwgZWxlbWVudC5wcm9wcy5jaGlsZHJlbiwgbGFuZXMsIGVsZW1lbnQua2V5KTsKICAgICAgfQoKICAgICAgaWYgKGN1cnJlbnQgIT09IG51bGwpIHsKICAgICAgICBpZiAoY3VycmVudC5lbGVtZW50VHlwZSA9PT0gZWxlbWVudFR5cGUgfHwgKCAvLyBLZWVwIHRoaXMgY2hlY2sgaW5saW5lIHNvIGl0IG9ubHkgcnVucyBvbiB0aGUgZmFsc2UgcGF0aDoKICAgICAgICAgaXNDb21wYXRpYmxlRmFtaWx5Rm9ySG90UmVsb2FkaW5nKGN1cnJlbnQsIGVsZW1lbnQpICkgfHwgLy8gTGF6eSB0eXBlcyBzaG91bGQgcmVjb25jaWxlIHRoZWlyIHJlc29sdmVkIHR5cGUuCiAgICAgICAgLy8gV2UgbmVlZCB0byBkbyB0aGlzIGFmdGVyIHRoZSBIb3QgUmVsb2FkaW5nIGNoZWNrIGFib3ZlLAogICAgICAgIC8vIGJlY2F1c2UgaG90IHJlbG9hZGluZyBoYXMgZGlmZmVyZW50IHNlbWFudGljcyB0aGFuIHByb2QgYmVjYXVzZQogICAgICAgIC8vIGl0IGRvZXNuJ3QgcmVzdXNwZW5kLiBTbyB3ZSBjYW4ndCBsZXQgdGhlIGNhbGwgYmVsb3cgc3VzcGVuZC4KICAgICAgICB0eXBlb2YgZWxlbWVudFR5cGUgPT09ICdvYmplY3QnICYmIGVsZW1lbnRUeXBlICE9PSBudWxsICYmIGVsZW1lbnRUeXBlLiQkdHlwZW9mID09PSBSRUFDVF9MQVpZX1RZUEUgJiYgcmVzb2x2ZUxhenkoZWxlbWVudFR5cGUpID09PSBjdXJyZW50LnR5cGUpIHsKICAgICAgICAgIC8vIE1vdmUgYmFzZWQgb24gaW5kZXgKICAgICAgICAgIHZhciBleGlzdGluZyA9IHVzZUZpYmVyKGN1cnJlbnQsIGVsZW1lbnQucHJvcHMpOwogICAgICAgICAgZXhpc3RpbmcucmVmID0gY29lcmNlUmVmKHJldHVybkZpYmVyLCBjdXJyZW50LCBlbGVtZW50KTsKICAgICAgICAgIGV4aXN0aW5nLnJldHVybiA9IHJldHVybkZpYmVyOwoKICAgICAgICAgIHsKICAgICAgICAgICAgZXhpc3RpbmcuX2RlYnVnU291cmNlID0gZWxlbWVudC5fc291cmNlOwogICAgICAgICAgICBleGlzdGluZy5fZGVidWdPd25lciA9IGVsZW1lbnQuX293bmVyOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBleGlzdGluZzsKICAgICAgICB9CiAgICAgIH0gLy8gSW5zZXJ0CgoKICAgICAgdmFyIGNyZWF0ZWQgPSBjcmVhdGVGaWJlckZyb21FbGVtZW50KGVsZW1lbnQsIHJldHVybkZpYmVyLm1vZGUsIGxhbmVzKTsKICAgICAgY3JlYXRlZC5yZWYgPSBjb2VyY2VSZWYocmV0dXJuRmliZXIsIGN1cnJlbnQsIGVsZW1lbnQpOwogICAgICBjcmVhdGVkLnJldHVybiA9IHJldHVybkZpYmVyOwogICAgICByZXR1cm4gY3JlYXRlZDsKICAgIH0KCiAgICBmdW5jdGlvbiB1cGRhdGVQb3J0YWwocmV0dXJuRmliZXIsIGN1cnJlbnQsIHBvcnRhbCwgbGFuZXMpIHsKICAgICAgaWYgKGN1cnJlbnQgPT09IG51bGwgfHwgY3VycmVudC50YWcgIT09IEhvc3RQb3J0YWwgfHwgY3VycmVudC5zdGF0ZU5vZGUuY29udGFpbmVySW5mbyAhPT0gcG9ydGFsLmNvbnRhaW5lckluZm8gfHwgY3VycmVudC5zdGF0ZU5vZGUuaW1wbGVtZW50YXRpb24gIT09IHBvcnRhbC5pbXBsZW1lbnRhdGlvbikgewogICAgICAgIC8vIEluc2VydAogICAgICAgIHZhciBjcmVhdGVkID0gY3JlYXRlRmliZXJGcm9tUG9ydGFsKHBvcnRhbCwgcmV0dXJuRmliZXIubW9kZSwgbGFuZXMpOwogICAgICAgIGNyZWF0ZWQucmV0dXJuID0gcmV0dXJuRmliZXI7CiAgICAgICAgcmV0dXJuIGNyZWF0ZWQ7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gVXBkYXRlCiAgICAgICAgdmFyIGV4aXN0aW5nID0gdXNlRmliZXIoY3VycmVudCwgcG9ydGFsLmNoaWxkcmVuIHx8IFtdKTsKICAgICAgICBleGlzdGluZy5yZXR1cm4gPSByZXR1cm5GaWJlcjsKICAgICAgICByZXR1cm4gZXhpc3Rpbmc7CiAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiB1cGRhdGVGcmFnbWVudChyZXR1cm5GaWJlciwgY3VycmVudCwgZnJhZ21lbnQsIGxhbmVzLCBrZXkpIHsKICAgICAgaWYgKGN1cnJlbnQgPT09IG51bGwgfHwgY3VycmVudC50YWcgIT09IEZyYWdtZW50KSB7CiAgICAgICAgLy8gSW5zZXJ0CiAgICAgICAgdmFyIGNyZWF0ZWQgPSBjcmVhdGVGaWJlckZyb21GcmFnbWVudChmcmFnbWVudCwgcmV0dXJuRmliZXIubW9kZSwgbGFuZXMsIGtleSk7CiAgICAgICAgY3JlYXRlZC5yZXR1cm4gPSByZXR1cm5GaWJlcjsKICAgICAgICByZXR1cm4gY3JlYXRlZDsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBVcGRhdGUKICAgICAgICB2YXIgZXhpc3RpbmcgPSB1c2VGaWJlcihjdXJyZW50LCBmcmFnbWVudCk7CiAgICAgICAgZXhpc3RpbmcucmV0dXJuID0gcmV0dXJuRmliZXI7CiAgICAgICAgcmV0dXJuIGV4aXN0aW5nOwogICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gY3JlYXRlQ2hpbGQocmV0dXJuRmliZXIsIG5ld0NoaWxkLCBsYW5lcykgewogICAgICBpZiAodHlwZW9mIG5ld0NoaWxkID09PSAnc3RyaW5nJyAmJiBuZXdDaGlsZCAhPT0gJycgfHwgdHlwZW9mIG5ld0NoaWxkID09PSAnbnVtYmVyJykgewogICAgICAgIC8vIFRleHQgbm9kZXMgZG9uJ3QgaGF2ZSBrZXlzLiBJZiB0aGUgcHJldmlvdXMgbm9kZSBpcyBpbXBsaWNpdGx5IGtleWVkCiAgICAgICAgLy8gd2UgY2FuIGNvbnRpbnVlIHRvIHJlcGxhY2UgaXQgd2l0aG91dCBhYm9ydGluZyBldmVuIGlmIGl0IGlzIG5vdCBhIHRleHQKICAgICAgICAvLyBub2RlLgogICAgICAgIHZhciBjcmVhdGVkID0gY3JlYXRlRmliZXJGcm9tVGV4dCgnJyArIG5ld0NoaWxkLCByZXR1cm5GaWJlci5tb2RlLCBsYW5lcyk7CiAgICAgICAgY3JlYXRlZC5yZXR1cm4gPSByZXR1cm5GaWJlcjsKICAgICAgICByZXR1cm4gY3JlYXRlZDsKICAgICAgfQoKICAgICAgaWYgKHR5cGVvZiBuZXdDaGlsZCA9PT0gJ29iamVjdCcgJiYgbmV3Q2hpbGQgIT09IG51bGwpIHsKICAgICAgICBzd2l0Y2ggKG5ld0NoaWxkLiQkdHlwZW9mKSB7CiAgICAgICAgICBjYXNlIFJFQUNUX0VMRU1FTlRfVFlQRToKICAgICAgICAgICAgewogICAgICAgICAgICAgIHZhciBfY3JlYXRlZCA9IGNyZWF0ZUZpYmVyRnJvbUVsZW1lbnQobmV3Q2hpbGQsIHJldHVybkZpYmVyLm1vZGUsIGxhbmVzKTsKCiAgICAgICAgICAgICAgX2NyZWF0ZWQucmVmID0gY29lcmNlUmVmKHJldHVybkZpYmVyLCBudWxsLCBuZXdDaGlsZCk7CiAgICAgICAgICAgICAgX2NyZWF0ZWQucmV0dXJuID0gcmV0dXJuRmliZXI7CiAgICAgICAgICAgICAgcmV0dXJuIF9jcmVhdGVkOwogICAgICAgICAgICB9CgogICAgICAgICAgY2FzZSBSRUFDVF9QT1JUQUxfVFlQRToKICAgICAgICAgICAgewogICAgICAgICAgICAgIHZhciBfY3JlYXRlZDIgPSBjcmVhdGVGaWJlckZyb21Qb3J0YWwobmV3Q2hpbGQsIHJldHVybkZpYmVyLm1vZGUsIGxhbmVzKTsKCiAgICAgICAgICAgICAgX2NyZWF0ZWQyLnJldHVybiA9IHJldHVybkZpYmVyOwogICAgICAgICAgICAgIHJldHVybiBfY3JlYXRlZDI7CiAgICAgICAgICAgIH0KCiAgICAgICAgICBjYXNlIFJFQUNUX0xBWllfVFlQRToKICAgICAgICAgICAgewogICAgICAgICAgICAgIHZhciBwYXlsb2FkID0gbmV3Q2hpbGQuX3BheWxvYWQ7CiAgICAgICAgICAgICAgdmFyIGluaXQgPSBuZXdDaGlsZC5faW5pdDsKICAgICAgICAgICAgICByZXR1cm4gY3JlYXRlQ2hpbGQocmV0dXJuRmliZXIsIGluaXQocGF5bG9hZCksIGxhbmVzKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKGlzQXJyYXkobmV3Q2hpbGQpIHx8IGdldEl0ZXJhdG9yRm4obmV3Q2hpbGQpKSB7CiAgICAgICAgICB2YXIgX2NyZWF0ZWQzID0gY3JlYXRlRmliZXJGcm9tRnJhZ21lbnQobmV3Q2hpbGQsIHJldHVybkZpYmVyLm1vZGUsIGxhbmVzLCBudWxsKTsKCiAgICAgICAgICBfY3JlYXRlZDMucmV0dXJuID0gcmV0dXJuRmliZXI7CiAgICAgICAgICByZXR1cm4gX2NyZWF0ZWQzOwogICAgICAgIH0KCiAgICAgICAgdGhyb3dPbkludmFsaWRPYmplY3RUeXBlKHJldHVybkZpYmVyLCBuZXdDaGlsZCk7CiAgICAgIH0KCiAgICAgIHsKICAgICAgICBpZiAodHlwZW9mIG5ld0NoaWxkID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICB3YXJuT25GdW5jdGlvblR5cGUocmV0dXJuRmliZXIpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgZnVuY3Rpb24gdXBkYXRlU2xvdChyZXR1cm5GaWJlciwgb2xkRmliZXIsIG5ld0NoaWxkLCBsYW5lcykgewogICAgICAvLyBVcGRhdGUgdGhlIGZpYmVyIGlmIHRoZSBrZXlzIG1hdGNoLCBvdGhlcndpc2UgcmV0dXJuIG51bGwuCiAgICAgIHZhciBrZXkgPSBvbGRGaWJlciAhPT0gbnVsbCA/IG9sZEZpYmVyLmtleSA6IG51bGw7CgogICAgICBpZiAodHlwZW9mIG5ld0NoaWxkID09PSAnc3RyaW5nJyAmJiBuZXdDaGlsZCAhPT0gJycgfHwgdHlwZW9mIG5ld0NoaWxkID09PSAnbnVtYmVyJykgewogICAgICAgIC8vIFRleHQgbm9kZXMgZG9uJ3QgaGF2ZSBrZXlzLiBJZiB0aGUgcHJldmlvdXMgbm9kZSBpcyBpbXBsaWNpdGx5IGtleWVkCiAgICAgICAgLy8gd2UgY2FuIGNvbnRpbnVlIHRvIHJlcGxhY2UgaXQgd2l0aG91dCBhYm9ydGluZyBldmVuIGlmIGl0IGlzIG5vdCBhIHRleHQKICAgICAgICAvLyBub2RlLgogICAgICAgIGlmIChrZXkgIT09IG51bGwpIHsKICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHVwZGF0ZVRleHROb2RlKHJldHVybkZpYmVyLCBvbGRGaWJlciwgJycgKyBuZXdDaGlsZCwgbGFuZXMpOwogICAgICB9CgogICAgICBpZiAodHlwZW9mIG5ld0NoaWxkID09PSAnb2JqZWN0JyAmJiBuZXdDaGlsZCAhPT0gbnVsbCkgewogICAgICAgIHN3aXRjaCAobmV3Q2hpbGQuJCR0eXBlb2YpIHsKICAgICAgICAgIGNhc2UgUkVBQ1RfRUxFTUVOVF9UWVBFOgogICAgICAgICAgICB7CiAgICAgICAgICAgICAgaWYgKG5ld0NoaWxkLmtleSA9PT0ga2V5KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdXBkYXRlRWxlbWVudChyZXR1cm5GaWJlciwgb2xkRmliZXIsIG5ld0NoaWxkLCBsYW5lcyk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgIGNhc2UgUkVBQ1RfUE9SVEFMX1RZUEU6CiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpZiAobmV3Q2hpbGQua2V5ID09PSBrZXkpIHsKICAgICAgICAgICAgICAgIHJldHVybiB1cGRhdGVQb3J0YWwocmV0dXJuRmliZXIsIG9sZEZpYmVyLCBuZXdDaGlsZCwgbGFuZXMpOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICBjYXNlIFJFQUNUX0xBWllfVFlQRToKICAgICAgICAgICAgewogICAgICAgICAgICAgIHZhciBwYXlsb2FkID0gbmV3Q2hpbGQuX3BheWxvYWQ7CiAgICAgICAgICAgICAgdmFyIGluaXQgPSBuZXdDaGlsZC5faW5pdDsKICAgICAgICAgICAgICByZXR1cm4gdXBkYXRlU2xvdChyZXR1cm5GaWJlciwgb2xkRmliZXIsIGluaXQocGF5bG9hZCksIGxhbmVzKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKGlzQXJyYXkobmV3Q2hpbGQpIHx8IGdldEl0ZXJhdG9yRm4obmV3Q2hpbGQpKSB7CiAgICAgICAgICBpZiAoa2V5ICE9PSBudWxsKSB7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiB1cGRhdGVGcmFnbWVudChyZXR1cm5GaWJlciwgb2xkRmliZXIsIG5ld0NoaWxkLCBsYW5lcywgbnVsbCk7CiAgICAgICAgfQoKICAgICAgICB0aHJvd09uSW52YWxpZE9iamVjdFR5cGUocmV0dXJuRmliZXIsIG5ld0NoaWxkKTsKICAgICAgfQoKICAgICAgewogICAgICAgIGlmICh0eXBlb2YgbmV3Q2hpbGQgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgIHdhcm5PbkZ1bmN0aW9uVHlwZShyZXR1cm5GaWJlcik7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBmdW5jdGlvbiB1cGRhdGVGcm9tTWFwKGV4aXN0aW5nQ2hpbGRyZW4sIHJldHVybkZpYmVyLCBuZXdJZHgsIG5ld0NoaWxkLCBsYW5lcykgewogICAgICBpZiAodHlwZW9mIG5ld0NoaWxkID09PSAnc3RyaW5nJyAmJiBuZXdDaGlsZCAhPT0gJycgfHwgdHlwZW9mIG5ld0NoaWxkID09PSAnbnVtYmVyJykgewogICAgICAgIC8vIFRleHQgbm9kZXMgZG9uJ3QgaGF2ZSBrZXlzLCBzbyB3ZSBuZWl0aGVyIGhhdmUgdG8gY2hlY2sgdGhlIG9sZCBub3IKICAgICAgICAvLyBuZXcgbm9kZSBmb3IgdGhlIGtleS4gSWYgYm90aCBhcmUgdGV4dCBub2RlcywgdGhleSBtYXRjaC4KICAgICAgICB2YXIgbWF0Y2hlZEZpYmVyID0gZXhpc3RpbmdDaGlsZHJlbi5nZXQobmV3SWR4KSB8fCBudWxsOwogICAgICAgIHJldHVybiB1cGRhdGVUZXh0Tm9kZShyZXR1cm5GaWJlciwgbWF0Y2hlZEZpYmVyLCAnJyArIG5ld0NoaWxkLCBsYW5lcyk7CiAgICAgIH0KCiAgICAgIGlmICh0eXBlb2YgbmV3Q2hpbGQgPT09ICdvYmplY3QnICYmIG5ld0NoaWxkICE9PSBudWxsKSB7CiAgICAgICAgc3dpdGNoIChuZXdDaGlsZC4kJHR5cGVvZikgewogICAgICAgICAgY2FzZSBSRUFDVF9FTEVNRU5UX1RZUEU6CiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB2YXIgX21hdGNoZWRGaWJlciA9IGV4aXN0aW5nQ2hpbGRyZW4uZ2V0KG5ld0NoaWxkLmtleSA9PT0gbnVsbCA/IG5ld0lkeCA6IG5ld0NoaWxkLmtleSkgfHwgbnVsbDsKCiAgICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZUVsZW1lbnQocmV0dXJuRmliZXIsIF9tYXRjaGVkRmliZXIsIG5ld0NoaWxkLCBsYW5lcyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICBjYXNlIFJFQUNUX1BPUlRBTF9UWVBFOgogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdmFyIF9tYXRjaGVkRmliZXIyID0gZXhpc3RpbmdDaGlsZHJlbi5nZXQobmV3Q2hpbGQua2V5ID09PSBudWxsID8gbmV3SWR4IDogbmV3Q2hpbGQua2V5KSB8fCBudWxsOwoKICAgICAgICAgICAgICByZXR1cm4gdXBkYXRlUG9ydGFsKHJldHVybkZpYmVyLCBfbWF0Y2hlZEZpYmVyMiwgbmV3Q2hpbGQsIGxhbmVzKTsKICAgICAgICAgICAgfQoKICAgICAgICAgIGNhc2UgUkVBQ1RfTEFaWV9UWVBFOgogICAgICAgICAgICB2YXIgcGF5bG9hZCA9IG5ld0NoaWxkLl9wYXlsb2FkOwogICAgICAgICAgICB2YXIgaW5pdCA9IG5ld0NoaWxkLl9pbml0OwogICAgICAgICAgICByZXR1cm4gdXBkYXRlRnJvbU1hcChleGlzdGluZ0NoaWxkcmVuLCByZXR1cm5GaWJlciwgbmV3SWR4LCBpbml0KHBheWxvYWQpLCBsYW5lcyk7CiAgICAgICAgfQoKICAgICAgICBpZiAoaXNBcnJheShuZXdDaGlsZCkgfHwgZ2V0SXRlcmF0b3JGbihuZXdDaGlsZCkpIHsKICAgICAgICAgIHZhciBfbWF0Y2hlZEZpYmVyMyA9IGV4aXN0aW5nQ2hpbGRyZW4uZ2V0KG5ld0lkeCkgfHwgbnVsbDsKCiAgICAgICAgICByZXR1cm4gdXBkYXRlRnJhZ21lbnQocmV0dXJuRmliZXIsIF9tYXRjaGVkRmliZXIzLCBuZXdDaGlsZCwgbGFuZXMsIG51bGwpOwogICAgICAgIH0KCiAgICAgICAgdGhyb3dPbkludmFsaWRPYmplY3RUeXBlKHJldHVybkZpYmVyLCBuZXdDaGlsZCk7CiAgICAgIH0KCiAgICAgIHsKICAgICAgICBpZiAodHlwZW9mIG5ld0NoaWxkID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICB3YXJuT25GdW5jdGlvblR5cGUocmV0dXJuRmliZXIpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgICAvKioKICAgICAqIFdhcm5zIGlmIHRoZXJlIGlzIGEgZHVwbGljYXRlIG9yIG1pc3Npbmcga2V5CiAgICAgKi8KCgogICAgZnVuY3Rpb24gd2Fybk9uSW52YWxpZEtleShjaGlsZCwga25vd25LZXlzLCByZXR1cm5GaWJlcikgewogICAgICB7CiAgICAgICAgaWYgKHR5cGVvZiBjaGlsZCAhPT0gJ29iamVjdCcgfHwgY2hpbGQgPT09IG51bGwpIHsKICAgICAgICAgIHJldHVybiBrbm93bktleXM7CiAgICAgICAgfQoKICAgICAgICBzd2l0Y2ggKGNoaWxkLiQkdHlwZW9mKSB7CiAgICAgICAgICBjYXNlIFJFQUNUX0VMRU1FTlRfVFlQRToKICAgICAgICAgIGNhc2UgUkVBQ1RfUE9SVEFMX1RZUEU6CiAgICAgICAgICAgIHdhcm5Gb3JNaXNzaW5nS2V5KGNoaWxkLCByZXR1cm5GaWJlcik7CiAgICAgICAgICAgIHZhciBrZXkgPSBjaGlsZC5rZXk7CgogICAgICAgICAgICBpZiAodHlwZW9mIGtleSAhPT0gJ3N0cmluZycpIHsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGtub3duS2V5cyA9PT0gbnVsbCkgewogICAgICAgICAgICAgIGtub3duS2V5cyA9IG5ldyBTZXQoKTsKICAgICAgICAgICAgICBrbm93bktleXMuYWRkKGtleSk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICgha25vd25LZXlzLmhhcyhrZXkpKSB7CiAgICAgICAgICAgICAga25vd25LZXlzLmFkZChrZXkpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBlcnJvcignRW5jb3VudGVyZWQgdHdvIGNoaWxkcmVuIHdpdGggdGhlIHNhbWUga2V5LCBgJXNgLiAnICsgJ0tleXMgc2hvdWxkIGJlIHVuaXF1ZSBzbyB0aGF0IGNvbXBvbmVudHMgbWFpbnRhaW4gdGhlaXIgaWRlbnRpdHkgJyArICdhY3Jvc3MgdXBkYXRlcy4gTm9uLXVuaXF1ZSBrZXlzIG1heSBjYXVzZSBjaGlsZHJlbiB0byBiZSAnICsgJ2R1cGxpY2F0ZWQgYW5kL29yIG9taXR0ZWQg4oCUIHRoZSBiZWhhdmlvciBpcyB1bnN1cHBvcnRlZCBhbmQgJyArICdjb3VsZCBjaGFuZ2UgaW4gYSBmdXR1cmUgdmVyc2lvbi4nLCBrZXkpOwoKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSBSRUFDVF9MQVpZX1RZUEU6CiAgICAgICAgICAgIHZhciBwYXlsb2FkID0gY2hpbGQuX3BheWxvYWQ7CiAgICAgICAgICAgIHZhciBpbml0ID0gY2hpbGQuX2luaXQ7CiAgICAgICAgICAgIHdhcm5PbkludmFsaWRLZXkoaW5pdChwYXlsb2FkKSwga25vd25LZXlzLCByZXR1cm5GaWJlcik7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIGtub3duS2V5czsKICAgIH0KCiAgICBmdW5jdGlvbiByZWNvbmNpbGVDaGlsZHJlbkFycmF5KHJldHVybkZpYmVyLCBjdXJyZW50Rmlyc3RDaGlsZCwgbmV3Q2hpbGRyZW4sIGxhbmVzKSB7CiAgICAgIC8vIFRoaXMgYWxnb3JpdGhtIGNhbid0IG9wdGltaXplIGJ5IHNlYXJjaGluZyBmcm9tIGJvdGggZW5kcyBzaW5jZSB3ZQogICAgICAvLyBkb24ndCBoYXZlIGJhY2twb2ludGVycyBvbiBmaWJlcnMuIEknbSB0cnlpbmcgdG8gc2VlIGhvdyBmYXIgd2UgY2FuIGdldAogICAgICAvLyB3aXRoIHRoYXQgbW9kZWwuIElmIGl0IGVuZHMgdXAgbm90IGJlaW5nIHdvcnRoIHRoZSB0cmFkZW9mZnMsIHdlIGNhbgogICAgICAvLyBhZGQgaXQgbGF0ZXIuCiAgICAgIC8vIEV2ZW4gd2l0aCBhIHR3byBlbmRlZCBvcHRpbWl6YXRpb24sIHdlJ2Qgd2FudCB0byBvcHRpbWl6ZSBmb3IgdGhlIGNhc2UKICAgICAgLy8gd2hlcmUgdGhlcmUgYXJlIGZldyBjaGFuZ2VzIGFuZCBicnV0ZSBmb3JjZSB0aGUgY29tcGFyaXNvbiBpbnN0ZWFkIG9mCiAgICAgIC8vIGdvaW5nIGZvciB0aGUgTWFwLiBJdCdkIGxpa2UgdG8gZXhwbG9yZSBoaXR0aW5nIHRoYXQgcGF0aCBmaXJzdCBpbgogICAgICAvLyBmb3J3YXJkLW9ubHkgbW9kZSBhbmQgb25seSBnbyBmb3IgdGhlIE1hcCBvbmNlIHdlIG5vdGljZSB0aGF0IHdlIG5lZWQKICAgICAgLy8gbG90cyBvZiBsb29rIGFoZWFkLiBUaGlzIGRvZXNuJ3QgaGFuZGxlIHJldmVyc2FsIGFzIHdlbGwgYXMgdHdvIGVuZGVkCiAgICAgIC8vIHNlYXJjaCBidXQgdGhhdCdzIHVudXN1YWwuIEJlc2lkZXMsIGZvciB0aGUgdHdvIGVuZGVkIG9wdGltaXphdGlvbiB0bwogICAgICAvLyB3b3JrIG9uIEl0ZXJhYmxlcywgd2UnZCBuZWVkIHRvIGNvcHkgdGhlIHdob2xlIHNldC4KICAgICAgLy8gSW4gdGhpcyBmaXJzdCBpdGVyYXRpb24sIHdlJ2xsIGp1c3QgbGl2ZSB3aXRoIGhpdHRpbmcgdGhlIGJhZCBjYXNlCiAgICAgIC8vIChhZGRpbmcgZXZlcnl0aGluZyB0byBhIE1hcCkgaW4gZm9yIGV2ZXJ5IGluc2VydC9tb3ZlLgogICAgICAvLyBJZiB5b3UgY2hhbmdlIHRoaXMgY29kZSwgYWxzbyB1cGRhdGUgcmVjb25jaWxlQ2hpbGRyZW5JdGVyYXRvcigpIHdoaWNoCiAgICAgIC8vIHVzZXMgdGhlIHNhbWUgYWxnb3JpdGhtLgogICAgICB7CiAgICAgICAgLy8gRmlyc3QsIHZhbGlkYXRlIGtleXMuCiAgICAgICAgdmFyIGtub3duS2V5cyA9IG51bGw7CgogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbmV3Q2hpbGRyZW4ubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIHZhciBjaGlsZCA9IG5ld0NoaWxkcmVuW2ldOwogICAgICAgICAga25vd25LZXlzID0gd2Fybk9uSW52YWxpZEtleShjaGlsZCwga25vd25LZXlzLCByZXR1cm5GaWJlcik7CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgcmVzdWx0aW5nRmlyc3RDaGlsZCA9IG51bGw7CiAgICAgIHZhciBwcmV2aW91c05ld0ZpYmVyID0gbnVsbDsKICAgICAgdmFyIG9sZEZpYmVyID0gY3VycmVudEZpcnN0Q2hpbGQ7CiAgICAgIHZhciBsYXN0UGxhY2VkSW5kZXggPSAwOwogICAgICB2YXIgbmV3SWR4ID0gMDsKICAgICAgdmFyIG5leHRPbGRGaWJlciA9IG51bGw7CgogICAgICBmb3IgKDsgb2xkRmliZXIgIT09IG51bGwgJiYgbmV3SWR4IDwgbmV3Q2hpbGRyZW4ubGVuZ3RoOyBuZXdJZHgrKykgewogICAgICAgIGlmIChvbGRGaWJlci5pbmRleCA+IG5ld0lkeCkgewogICAgICAgICAgbmV4dE9sZEZpYmVyID0gb2xkRmliZXI7CiAgICAgICAgICBvbGRGaWJlciA9IG51bGw7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG5leHRPbGRGaWJlciA9IG9sZEZpYmVyLnNpYmxpbmc7CiAgICAgICAgfQoKICAgICAgICB2YXIgbmV3RmliZXIgPSB1cGRhdGVTbG90KHJldHVybkZpYmVyLCBvbGRGaWJlciwgbmV3Q2hpbGRyZW5bbmV3SWR4XSwgbGFuZXMpOwoKICAgICAgICBpZiAobmV3RmliZXIgPT09IG51bGwpIHsKICAgICAgICAgIC8vIFRPRE86IFRoaXMgYnJlYWtzIG9uIGVtcHR5IHNsb3RzIGxpa2UgbnVsbCBjaGlsZHJlbi4gVGhhdCdzCiAgICAgICAgICAvLyB1bmZvcnR1bmF0ZSBiZWNhdXNlIGl0IHRyaWdnZXJzIHRoZSBzbG93IHBhdGggYWxsIHRoZSB0aW1lLiBXZSBuZWVkCiAgICAgICAgICAvLyBhIGJldHRlciB3YXkgdG8gY29tbXVuaWNhdGUgd2hldGhlciB0aGlzIHdhcyBhIG1pc3Mgb3IgbnVsbCwKICAgICAgICAgIC8vIGJvb2xlYW4sIHVuZGVmaW5lZCwgZXRjLgogICAgICAgICAgaWYgKG9sZEZpYmVyID09PSBudWxsKSB7CiAgICAgICAgICAgIG9sZEZpYmVyID0gbmV4dE9sZEZpYmVyOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgaWYgKHNob3VsZFRyYWNrU2lkZUVmZmVjdHMpIHsKICAgICAgICAgIGlmIChvbGRGaWJlciAmJiBuZXdGaWJlci5hbHRlcm5hdGUgPT09IG51bGwpIHsKICAgICAgICAgICAgLy8gV2UgbWF0Y2hlZCB0aGUgc2xvdCwgYnV0IHdlIGRpZG4ndCByZXVzZSB0aGUgZXhpc3RpbmcgZmliZXIsIHNvIHdlCiAgICAgICAgICAgIC8vIG5lZWQgdG8gZGVsZXRlIHRoZSBleGlzdGluZyBjaGlsZC4KICAgICAgICAgICAgZGVsZXRlQ2hpbGQocmV0dXJuRmliZXIsIG9sZEZpYmVyKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGxhc3RQbGFjZWRJbmRleCA9IHBsYWNlQ2hpbGQobmV3RmliZXIsIGxhc3RQbGFjZWRJbmRleCwgbmV3SWR4KTsKCiAgICAgICAgaWYgKHByZXZpb3VzTmV3RmliZXIgPT09IG51bGwpIHsKICAgICAgICAgIC8vIFRPRE86IE1vdmUgb3V0IG9mIHRoZSBsb29wLiBUaGlzIG9ubHkgaGFwcGVucyBmb3IgdGhlIGZpcnN0IHJ1bi4KICAgICAgICAgIHJlc3VsdGluZ0ZpcnN0Q2hpbGQgPSBuZXdGaWJlcjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy8gVE9ETzogRGVmZXIgc2libGluZ3MgaWYgd2UncmUgbm90IGF0IHRoZSByaWdodCBpbmRleCBmb3IgdGhpcyBzbG90LgogICAgICAgICAgLy8gSS5lLiBpZiB3ZSBoYWQgbnVsbCB2YWx1ZXMgYmVmb3JlLCB0aGVuIHdlIHdhbnQgdG8gZGVmZXIgdGhpcwogICAgICAgICAgLy8gZm9yIGVhY2ggbnVsbCB2YWx1ZS4gSG93ZXZlciwgd2UgYWxzbyBkb24ndCB3YW50IHRvIGNhbGwgdXBkYXRlU2xvdAogICAgICAgICAgLy8gd2l0aCB0aGUgcHJldmlvdXMgb25lLgogICAgICAgICAgcHJldmlvdXNOZXdGaWJlci5zaWJsaW5nID0gbmV3RmliZXI7CiAgICAgICAgfQoKICAgICAgICBwcmV2aW91c05ld0ZpYmVyID0gbmV3RmliZXI7CiAgICAgICAgb2xkRmliZXIgPSBuZXh0T2xkRmliZXI7CiAgICAgIH0KCiAgICAgIGlmIChuZXdJZHggPT09IG5ld0NoaWxkcmVuLmxlbmd0aCkgewogICAgICAgIC8vIFdlJ3ZlIHJlYWNoZWQgdGhlIGVuZCBvZiB0aGUgbmV3IGNoaWxkcmVuLiBXZSBjYW4gZGVsZXRlIHRoZSByZXN0LgogICAgICAgIGRlbGV0ZVJlbWFpbmluZ0NoaWxkcmVuKHJldHVybkZpYmVyLCBvbGRGaWJlcik7CgogICAgICAgIGlmIChnZXRJc0h5ZHJhdGluZygpKSB7CiAgICAgICAgICB2YXIgbnVtYmVyT2ZGb3JrcyA9IG5ld0lkeDsKICAgICAgICAgIHB1c2hUcmVlRm9yayhyZXR1cm5GaWJlciwgbnVtYmVyT2ZGb3Jrcyk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gcmVzdWx0aW5nRmlyc3RDaGlsZDsKICAgICAgfQoKICAgICAgaWYgKG9sZEZpYmVyID09PSBudWxsKSB7CiAgICAgICAgLy8gSWYgd2UgZG9uJ3QgaGF2ZSBhbnkgbW9yZSBleGlzdGluZyBjaGlsZHJlbiB3ZSBjYW4gY2hvb3NlIGEgZmFzdCBwYXRoCiAgICAgICAgLy8gc2luY2UgdGhlIHJlc3Qgd2lsbCBhbGwgYmUgaW5zZXJ0aW9ucy4KICAgICAgICBmb3IgKDsgbmV3SWR4IDwgbmV3Q2hpbGRyZW4ubGVuZ3RoOyBuZXdJZHgrKykgewogICAgICAgICAgdmFyIF9uZXdGaWJlciA9IGNyZWF0ZUNoaWxkKHJldHVybkZpYmVyLCBuZXdDaGlsZHJlbltuZXdJZHhdLCBsYW5lcyk7CgogICAgICAgICAgaWYgKF9uZXdGaWJlciA9PT0gbnVsbCkgewogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBsYXN0UGxhY2VkSW5kZXggPSBwbGFjZUNoaWxkKF9uZXdGaWJlciwgbGFzdFBsYWNlZEluZGV4LCBuZXdJZHgpOwoKICAgICAgICAgIGlmIChwcmV2aW91c05ld0ZpYmVyID09PSBudWxsKSB7CiAgICAgICAgICAgIC8vIFRPRE86IE1vdmUgb3V0IG9mIHRoZSBsb29wLiBUaGlzIG9ubHkgaGFwcGVucyBmb3IgdGhlIGZpcnN0IHJ1bi4KICAgICAgICAgICAgcmVzdWx0aW5nRmlyc3RDaGlsZCA9IF9uZXdGaWJlcjsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHByZXZpb3VzTmV3RmliZXIuc2libGluZyA9IF9uZXdGaWJlcjsKICAgICAgICAgIH0KCiAgICAgICAgICBwcmV2aW91c05ld0ZpYmVyID0gX25ld0ZpYmVyOwogICAgICAgIH0KCiAgICAgICAgaWYgKGdldElzSHlkcmF0aW5nKCkpIHsKICAgICAgICAgIHZhciBfbnVtYmVyT2ZGb3JrcyA9IG5ld0lkeDsKICAgICAgICAgIHB1c2hUcmVlRm9yayhyZXR1cm5GaWJlciwgX251bWJlck9mRm9ya3MpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHJlc3VsdGluZ0ZpcnN0Q2hpbGQ7CiAgICAgIH0gLy8gQWRkIGFsbCBjaGlsZHJlbiB0byBhIGtleSBtYXAgZm9yIHF1aWNrIGxvb2t1cHMuCgoKICAgICAgdmFyIGV4aXN0aW5nQ2hpbGRyZW4gPSBtYXBSZW1haW5pbmdDaGlsZHJlbihyZXR1cm5GaWJlciwgb2xkRmliZXIpOyAvLyBLZWVwIHNjYW5uaW5nIGFuZCB1c2UgdGhlIG1hcCB0byByZXN0b3JlIGRlbGV0ZWQgaXRlbXMgYXMgbW92ZXMuCgogICAgICBmb3IgKDsgbmV3SWR4IDwgbmV3Q2hpbGRyZW4ubGVuZ3RoOyBuZXdJZHgrKykgewogICAgICAgIHZhciBfbmV3RmliZXIyID0gdXBkYXRlRnJvbU1hcChleGlzdGluZ0NoaWxkcmVuLCByZXR1cm5GaWJlciwgbmV3SWR4LCBuZXdDaGlsZHJlbltuZXdJZHhdLCBsYW5lcyk7CgogICAgICAgIGlmIChfbmV3RmliZXIyICE9PSBudWxsKSB7CiAgICAgICAgICBpZiAoc2hvdWxkVHJhY2tTaWRlRWZmZWN0cykgewogICAgICAgICAgICBpZiAoX25ld0ZpYmVyMi5hbHRlcm5hdGUgIT09IG51bGwpIHsKICAgICAgICAgICAgICAvLyBUaGUgbmV3IGZpYmVyIGlzIGEgd29yayBpbiBwcm9ncmVzcywgYnV0IGlmIHRoZXJlIGV4aXN0cyBhCiAgICAgICAgICAgICAgLy8gY3VycmVudCwgdGhhdCBtZWFucyB0aGF0IHdlIHJldXNlZCB0aGUgZmliZXIuIFdlIG5lZWQgdG8gZGVsZXRlCiAgICAgICAgICAgICAgLy8gaXQgZnJvbSB0aGUgY2hpbGQgbGlzdCBzbyB0aGF0IHdlIGRvbid0IGFkZCBpdCB0byB0aGUgZGVsZXRpb24KICAgICAgICAgICAgICAvLyBsaXN0LgogICAgICAgICAgICAgIGV4aXN0aW5nQ2hpbGRyZW4uZGVsZXRlKF9uZXdGaWJlcjIua2V5ID09PSBudWxsID8gbmV3SWR4IDogX25ld0ZpYmVyMi5rZXkpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgbGFzdFBsYWNlZEluZGV4ID0gcGxhY2VDaGlsZChfbmV3RmliZXIyLCBsYXN0UGxhY2VkSW5kZXgsIG5ld0lkeCk7CgogICAgICAgICAgaWYgKHByZXZpb3VzTmV3RmliZXIgPT09IG51bGwpIHsKICAgICAgICAgICAgcmVzdWx0aW5nRmlyc3RDaGlsZCA9IF9uZXdGaWJlcjI7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBwcmV2aW91c05ld0ZpYmVyLnNpYmxpbmcgPSBfbmV3RmliZXIyOwogICAgICAgICAgfQoKICAgICAgICAgIHByZXZpb3VzTmV3RmliZXIgPSBfbmV3RmliZXIyOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHNob3VsZFRyYWNrU2lkZUVmZmVjdHMpIHsKICAgICAgICAvLyBBbnkgZXhpc3RpbmcgY2hpbGRyZW4gdGhhdCB3ZXJlbid0IGNvbnN1bWVkIGFib3ZlIHdlcmUgZGVsZXRlZC4gV2UgbmVlZAogICAgICAgIC8vIHRvIGFkZCB0aGVtIHRvIHRoZSBkZWxldGlvbiBsaXN0LgogICAgICAgIGV4aXN0aW5nQ2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQpIHsKICAgICAgICAgIHJldHVybiBkZWxldGVDaGlsZChyZXR1cm5GaWJlciwgY2hpbGQpOwogICAgICAgIH0pOwogICAgICB9CgogICAgICBpZiAoZ2V0SXNIeWRyYXRpbmcoKSkgewogICAgICAgIHZhciBfbnVtYmVyT2ZGb3JrczIgPSBuZXdJZHg7CiAgICAgICAgcHVzaFRyZWVGb3JrKHJldHVybkZpYmVyLCBfbnVtYmVyT2ZGb3JrczIpOwogICAgICB9CgogICAgICByZXR1cm4gcmVzdWx0aW5nRmlyc3RDaGlsZDsKICAgIH0KCiAgICBmdW5jdGlvbiByZWNvbmNpbGVDaGlsZHJlbkl0ZXJhdG9yKHJldHVybkZpYmVyLCBjdXJyZW50Rmlyc3RDaGlsZCwgbmV3Q2hpbGRyZW5JdGVyYWJsZSwgbGFuZXMpIHsKICAgICAgLy8gVGhpcyBpcyB0aGUgc2FtZSBpbXBsZW1lbnRhdGlvbiBhcyByZWNvbmNpbGVDaGlsZHJlbkFycmF5KCksCiAgICAgIC8vIGJ1dCB1c2luZyB0aGUgaXRlcmF0b3IgaW5zdGVhZC4KICAgICAgdmFyIGl0ZXJhdG9yRm4gPSBnZXRJdGVyYXRvckZuKG5ld0NoaWxkcmVuSXRlcmFibGUpOwoKICAgICAgaWYgKHR5cGVvZiBpdGVyYXRvckZuICE9PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBbiBvYmplY3QgaXMgbm90IGFuIGl0ZXJhYmxlLiBUaGlzIGVycm9yIGlzIGxpa2VseSBjYXVzZWQgYnkgYSBidWcgaW4gJyArICdSZWFjdC4gUGxlYXNlIGZpbGUgYW4gaXNzdWUuJyk7CiAgICAgIH0KCiAgICAgIHsKICAgICAgICAvLyBXZSBkb24ndCBzdXBwb3J0IHJlbmRlcmluZyBHZW5lcmF0b3JzIGJlY2F1c2UgaXQncyBhIG11dGF0aW9uLgogICAgICAgIC8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2svcmVhY3QvaXNzdWVzLzEyOTk1CiAgICAgICAgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICdmdW5jdGlvbicgJiYgLy8gJEZsb3dGaXhNZSBGbG93IGRvZXNuJ3Qga25vdyBhYm91dCB0b1N0cmluZ1RhZwogICAgICAgIG5ld0NoaWxkcmVuSXRlcmFibGVbU3ltYm9sLnRvU3RyaW5nVGFnXSA9PT0gJ0dlbmVyYXRvcicpIHsKICAgICAgICAgIGlmICghZGlkV2FybkFib3V0R2VuZXJhdG9ycykgewogICAgICAgICAgICBlcnJvcignVXNpbmcgR2VuZXJhdG9ycyBhcyBjaGlsZHJlbiBpcyB1bnN1cHBvcnRlZCBhbmQgd2lsbCBsaWtlbHkgeWllbGQgJyArICd1bmV4cGVjdGVkIHJlc3VsdHMgYmVjYXVzZSBlbnVtZXJhdGluZyBhIGdlbmVyYXRvciBtdXRhdGVzIGl0LiAnICsgJ1lvdSBtYXkgY29udmVydCBpdCB0byBhbiBhcnJheSB3aXRoIGBBcnJheS5mcm9tKClgIG9yIHRoZSAnICsgJ2BbLi4uc3ByZWFkXWAgb3BlcmF0b3IgYmVmb3JlIHJlbmRlcmluZy4gS2VlcCBpbiBtaW5kICcgKyAneW91IG1pZ2h0IG5lZWQgdG8gcG9seWZpbGwgdGhlc2UgZmVhdHVyZXMgZm9yIG9sZGVyIGJyb3dzZXJzLicpOwogICAgICAgICAgfQoKICAgICAgICAgIGRpZFdhcm5BYm91dEdlbmVyYXRvcnMgPSB0cnVlOwogICAgICAgIH0gLy8gV2FybiBhYm91dCB1c2luZyBNYXBzIGFzIGNoaWxkcmVuCgoKICAgICAgICBpZiAobmV3Q2hpbGRyZW5JdGVyYWJsZS5lbnRyaWVzID09PSBpdGVyYXRvckZuKSB7CiAgICAgICAgICBpZiAoIWRpZFdhcm5BYm91dE1hcHMpIHsKICAgICAgICAgICAgZXJyb3IoJ1VzaW5nIE1hcHMgYXMgY2hpbGRyZW4gaXMgbm90IHN1cHBvcnRlZC4gJyArICdVc2UgYW4gYXJyYXkgb2Yga2V5ZWQgUmVhY3RFbGVtZW50cyBpbnN0ZWFkLicpOwogICAgICAgICAgfQoKICAgICAgICAgIGRpZFdhcm5BYm91dE1hcHMgPSB0cnVlOwogICAgICAgIH0gLy8gRmlyc3QsIHZhbGlkYXRlIGtleXMuCiAgICAgICAgLy8gV2UnbGwgZ2V0IGEgZGlmZmVyZW50IGl0ZXJhdG9yIGxhdGVyIGZvciB0aGUgbWFpbiBwYXNzLgoKCiAgICAgICAgdmFyIF9uZXdDaGlsZHJlbiA9IGl0ZXJhdG9yRm4uY2FsbChuZXdDaGlsZHJlbkl0ZXJhYmxlKTsKCiAgICAgICAgaWYgKF9uZXdDaGlsZHJlbikgewogICAgICAgICAgdmFyIGtub3duS2V5cyA9IG51bGw7CgogICAgICAgICAgdmFyIF9zdGVwID0gX25ld0NoaWxkcmVuLm5leHQoKTsKCiAgICAgICAgICBmb3IgKDsgIV9zdGVwLmRvbmU7IF9zdGVwID0gX25ld0NoaWxkcmVuLm5leHQoKSkgewogICAgICAgICAgICB2YXIgY2hpbGQgPSBfc3RlcC52YWx1ZTsKICAgICAgICAgICAga25vd25LZXlzID0gd2Fybk9uSW52YWxpZEtleShjaGlsZCwga25vd25LZXlzLCByZXR1cm5GaWJlcik7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgbmV3Q2hpbGRyZW4gPSBpdGVyYXRvckZuLmNhbGwobmV3Q2hpbGRyZW5JdGVyYWJsZSk7CgogICAgICBpZiAobmV3Q2hpbGRyZW4gPT0gbnVsbCkgewogICAgICAgIHRocm93IG5ldyBFcnJvcignQW4gaXRlcmFibGUgb2JqZWN0IHByb3ZpZGVkIG5vIGl0ZXJhdG9yLicpOwogICAgICB9CgogICAgICB2YXIgcmVzdWx0aW5nRmlyc3RDaGlsZCA9IG51bGw7CiAgICAgIHZhciBwcmV2aW91c05ld0ZpYmVyID0gbnVsbDsKICAgICAgdmFyIG9sZEZpYmVyID0gY3VycmVudEZpcnN0Q2hpbGQ7CiAgICAgIHZhciBsYXN0UGxhY2VkSW5kZXggPSAwOwogICAgICB2YXIgbmV3SWR4ID0gMDsKICAgICAgdmFyIG5leHRPbGRGaWJlciA9IG51bGw7CiAgICAgIHZhciBzdGVwID0gbmV3Q2hpbGRyZW4ubmV4dCgpOwoKICAgICAgZm9yICg7IG9sZEZpYmVyICE9PSBudWxsICYmICFzdGVwLmRvbmU7IG5ld0lkeCsrLCBzdGVwID0gbmV3Q2hpbGRyZW4ubmV4dCgpKSB7CiAgICAgICAgaWYgKG9sZEZpYmVyLmluZGV4ID4gbmV3SWR4KSB7CiAgICAgICAgICBuZXh0T2xkRmliZXIgPSBvbGRGaWJlcjsKICAgICAgICAgIG9sZEZpYmVyID0gbnVsbDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgbmV4dE9sZEZpYmVyID0gb2xkRmliZXIuc2libGluZzsKICAgICAgICB9CgogICAgICAgIHZhciBuZXdGaWJlciA9IHVwZGF0ZVNsb3QocmV0dXJuRmliZXIsIG9sZEZpYmVyLCBzdGVwLnZhbHVlLCBsYW5lcyk7CgogICAgICAgIGlmIChuZXdGaWJlciA9PT0gbnVsbCkgewogICAgICAgICAgLy8gVE9ETzogVGhpcyBicmVha3Mgb24gZW1wdHkgc2xvdHMgbGlrZSBudWxsIGNoaWxkcmVuLiBUaGF0J3MKICAgICAgICAgIC8vIHVuZm9ydHVuYXRlIGJlY2F1c2UgaXQgdHJpZ2dlcnMgdGhlIHNsb3cgcGF0aCBhbGwgdGhlIHRpbWUuIFdlIG5lZWQKICAgICAgICAgIC8vIGEgYmV0dGVyIHdheSB0byBjb21tdW5pY2F0ZSB3aGV0aGVyIHRoaXMgd2FzIGEgbWlzcyBvciBudWxsLAogICAgICAgICAgLy8gYm9vbGVhbiwgdW5kZWZpbmVkLCBldGMuCiAgICAgICAgICBpZiAob2xkRmliZXIgPT09IG51bGwpIHsKICAgICAgICAgICAgb2xkRmliZXIgPSBuZXh0T2xkRmliZXI7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBpZiAoc2hvdWxkVHJhY2tTaWRlRWZmZWN0cykgewogICAgICAgICAgaWYgKG9sZEZpYmVyICYmIG5ld0ZpYmVyLmFsdGVybmF0ZSA9PT0gbnVsbCkgewogICAgICAgICAgICAvLyBXZSBtYXRjaGVkIHRoZSBzbG90LCBidXQgd2UgZGlkbid0IHJldXNlIHRoZSBleGlzdGluZyBmaWJlciwgc28gd2UKICAgICAgICAgICAgLy8gbmVlZCB0byBkZWxldGUgdGhlIGV4aXN0aW5nIGNoaWxkLgogICAgICAgICAgICBkZWxldGVDaGlsZChyZXR1cm5GaWJlciwgb2xkRmliZXIpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgbGFzdFBsYWNlZEluZGV4ID0gcGxhY2VDaGlsZChuZXdGaWJlciwgbGFzdFBsYWNlZEluZGV4LCBuZXdJZHgpOwoKICAgICAgICBpZiAocHJldmlvdXNOZXdGaWJlciA9PT0gbnVsbCkgewogICAgICAgICAgLy8gVE9ETzogTW92ZSBvdXQgb2YgdGhlIGxvb3AuIFRoaXMgb25seSBoYXBwZW5zIGZvciB0aGUgZmlyc3QgcnVuLgogICAgICAgICAgcmVzdWx0aW5nRmlyc3RDaGlsZCA9IG5ld0ZpYmVyOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyBUT0RPOiBEZWZlciBzaWJsaW5ncyBpZiB3ZSdyZSBub3QgYXQgdGhlIHJpZ2h0IGluZGV4IGZvciB0aGlzIHNsb3QuCiAgICAgICAgICAvLyBJLmUuIGlmIHdlIGhhZCBudWxsIHZhbHVlcyBiZWZvcmUsIHRoZW4gd2Ugd2FudCB0byBkZWZlciB0aGlzCiAgICAgICAgICAvLyBmb3IgZWFjaCBudWxsIHZhbHVlLiBIb3dldmVyLCB3ZSBhbHNvIGRvbid0IHdhbnQgdG8gY2FsbCB1cGRhdGVTbG90CiAgICAgICAgICAvLyB3aXRoIHRoZSBwcmV2aW91cyBvbmUuCiAgICAgICAgICBwcmV2aW91c05ld0ZpYmVyLnNpYmxpbmcgPSBuZXdGaWJlcjsKICAgICAgICB9CgogICAgICAgIHByZXZpb3VzTmV3RmliZXIgPSBuZXdGaWJlcjsKICAgICAgICBvbGRGaWJlciA9IG5leHRPbGRGaWJlcjsKICAgICAgfQoKICAgICAgaWYgKHN0ZXAuZG9uZSkgewogICAgICAgIC8vIFdlJ3ZlIHJlYWNoZWQgdGhlIGVuZCBvZiB0aGUgbmV3IGNoaWxkcmVuLiBXZSBjYW4gZGVsZXRlIHRoZSByZXN0LgogICAgICAgIGRlbGV0ZVJlbWFpbmluZ0NoaWxkcmVuKHJldHVybkZpYmVyLCBvbGRGaWJlcik7CgogICAgICAgIGlmIChnZXRJc0h5ZHJhdGluZygpKSB7CiAgICAgICAgICB2YXIgbnVtYmVyT2ZGb3JrcyA9IG5ld0lkeDsKICAgICAgICAgIHB1c2hUcmVlRm9yayhyZXR1cm5GaWJlciwgbnVtYmVyT2ZGb3Jrcyk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gcmVzdWx0aW5nRmlyc3RDaGlsZDsKICAgICAgfQoKICAgICAgaWYgKG9sZEZpYmVyID09PSBudWxsKSB7CiAgICAgICAgLy8gSWYgd2UgZG9uJ3QgaGF2ZSBhbnkgbW9yZSBleGlzdGluZyBjaGlsZHJlbiB3ZSBjYW4gY2hvb3NlIGEgZmFzdCBwYXRoCiAgICAgICAgLy8gc2luY2UgdGhlIHJlc3Qgd2lsbCBhbGwgYmUgaW5zZXJ0aW9ucy4KICAgICAgICBmb3IgKDsgIXN0ZXAuZG9uZTsgbmV3SWR4KyssIHN0ZXAgPSBuZXdDaGlsZHJlbi5uZXh0KCkpIHsKICAgICAgICAgIHZhciBfbmV3RmliZXIzID0gY3JlYXRlQ2hpbGQocmV0dXJuRmliZXIsIHN0ZXAudmFsdWUsIGxhbmVzKTsKCiAgICAgICAgICBpZiAoX25ld0ZpYmVyMyA9PT0gbnVsbCkgewogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBsYXN0UGxhY2VkSW5kZXggPSBwbGFjZUNoaWxkKF9uZXdGaWJlcjMsIGxhc3RQbGFjZWRJbmRleCwgbmV3SWR4KTsKCiAgICAgICAgICBpZiAocHJldmlvdXNOZXdGaWJlciA9PT0gbnVsbCkgewogICAgICAgICAgICAvLyBUT0RPOiBNb3ZlIG91dCBvZiB0aGUgbG9vcC4gVGhpcyBvbmx5IGhhcHBlbnMgZm9yIHRoZSBmaXJzdCBydW4uCiAgICAgICAgICAgIHJlc3VsdGluZ0ZpcnN0Q2hpbGQgPSBfbmV3RmliZXIzOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcHJldmlvdXNOZXdGaWJlci5zaWJsaW5nID0gX25ld0ZpYmVyMzsKICAgICAgICAgIH0KCiAgICAgICAgICBwcmV2aW91c05ld0ZpYmVyID0gX25ld0ZpYmVyMzsKICAgICAgICB9CgogICAgICAgIGlmIChnZXRJc0h5ZHJhdGluZygpKSB7CiAgICAgICAgICB2YXIgX251bWJlck9mRm9ya3MzID0gbmV3SWR4OwogICAgICAgICAgcHVzaFRyZWVGb3JrKHJldHVybkZpYmVyLCBfbnVtYmVyT2ZGb3JrczMpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHJlc3VsdGluZ0ZpcnN0Q2hpbGQ7CiAgICAgIH0gLy8gQWRkIGFsbCBjaGlsZHJlbiB0byBhIGtleSBtYXAgZm9yIHF1aWNrIGxvb2t1cHMuCgoKICAgICAgdmFyIGV4aXN0aW5nQ2hpbGRyZW4gPSBtYXBSZW1haW5pbmdDaGlsZHJlbihyZXR1cm5GaWJlciwgb2xkRmliZXIpOyAvLyBLZWVwIHNjYW5uaW5nIGFuZCB1c2UgdGhlIG1hcCB0byByZXN0b3JlIGRlbGV0ZWQgaXRlbXMgYXMgbW92ZXMuCgogICAgICBmb3IgKDsgIXN0ZXAuZG9uZTsgbmV3SWR4KyssIHN0ZXAgPSBuZXdDaGlsZHJlbi5uZXh0KCkpIHsKICAgICAgICB2YXIgX25ld0ZpYmVyNCA9IHVwZGF0ZUZyb21NYXAoZXhpc3RpbmdDaGlsZHJlbiwgcmV0dXJuRmliZXIsIG5ld0lkeCwgc3RlcC52YWx1ZSwgbGFuZXMpOwoKICAgICAgICBpZiAoX25ld0ZpYmVyNCAhPT0gbnVsbCkgewogICAgICAgICAgaWYgKHNob3VsZFRyYWNrU2lkZUVmZmVjdHMpIHsKICAgICAgICAgICAgaWYgKF9uZXdGaWJlcjQuYWx0ZXJuYXRlICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgLy8gVGhlIG5ldyBmaWJlciBpcyBhIHdvcmsgaW4gcHJvZ3Jlc3MsIGJ1dCBpZiB0aGVyZSBleGlzdHMgYQogICAgICAgICAgICAgIC8vIGN1cnJlbnQsIHRoYXQgbWVhbnMgdGhhdCB3ZSByZXVzZWQgdGhlIGZpYmVyLiBXZSBuZWVkIHRvIGRlbGV0ZQogICAgICAgICAgICAgIC8vIGl0IGZyb20gdGhlIGNoaWxkIGxpc3Qgc28gdGhhdCB3ZSBkb24ndCBhZGQgaXQgdG8gdGhlIGRlbGV0aW9uCiAgICAgICAgICAgICAgLy8gbGlzdC4KICAgICAgICAgICAgICBleGlzdGluZ0NoaWxkcmVuLmRlbGV0ZShfbmV3RmliZXI0LmtleSA9PT0gbnVsbCA/IG5ld0lkeCA6IF9uZXdGaWJlcjQua2V5KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGxhc3RQbGFjZWRJbmRleCA9IHBsYWNlQ2hpbGQoX25ld0ZpYmVyNCwgbGFzdFBsYWNlZEluZGV4LCBuZXdJZHgpOwoKICAgICAgICAgIGlmIChwcmV2aW91c05ld0ZpYmVyID09PSBudWxsKSB7CiAgICAgICAgICAgIHJlc3VsdGluZ0ZpcnN0Q2hpbGQgPSBfbmV3RmliZXI0OwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcHJldmlvdXNOZXdGaWJlci5zaWJsaW5nID0gX25ld0ZpYmVyNDsKICAgICAgICAgIH0KCiAgICAgICAgICBwcmV2aW91c05ld0ZpYmVyID0gX25ld0ZpYmVyNDsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChzaG91bGRUcmFja1NpZGVFZmZlY3RzKSB7CiAgICAgICAgLy8gQW55IGV4aXN0aW5nIGNoaWxkcmVuIHRoYXQgd2VyZW4ndCBjb25zdW1lZCBhYm92ZSB3ZXJlIGRlbGV0ZWQuIFdlIG5lZWQKICAgICAgICAvLyB0byBhZGQgdGhlbSB0byB0aGUgZGVsZXRpb24gbGlzdC4KICAgICAgICBleGlzdGluZ0NoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkKSB7CiAgICAgICAgICByZXR1cm4gZGVsZXRlQ2hpbGQocmV0dXJuRmliZXIsIGNoaWxkKTsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgaWYgKGdldElzSHlkcmF0aW5nKCkpIHsKICAgICAgICB2YXIgX251bWJlck9mRm9ya3M0ID0gbmV3SWR4OwogICAgICAgIHB1c2hUcmVlRm9yayhyZXR1cm5GaWJlciwgX251bWJlck9mRm9ya3M0KTsKICAgICAgfQoKICAgICAgcmV0dXJuIHJlc3VsdGluZ0ZpcnN0Q2hpbGQ7CiAgICB9CgogICAgZnVuY3Rpb24gcmVjb25jaWxlU2luZ2xlVGV4dE5vZGUocmV0dXJuRmliZXIsIGN1cnJlbnRGaXJzdENoaWxkLCB0ZXh0Q29udGVudCwgbGFuZXMpIHsKICAgICAgLy8gVGhlcmUncyBubyBuZWVkIHRvIGNoZWNrIGZvciBrZXlzIG9uIHRleHQgbm9kZXMgc2luY2Ugd2UgZG9uJ3QgaGF2ZSBhCiAgICAgIC8vIHdheSB0byBkZWZpbmUgdGhlbS4KICAgICAgaWYgKGN1cnJlbnRGaXJzdENoaWxkICE9PSBudWxsICYmIGN1cnJlbnRGaXJzdENoaWxkLnRhZyA9PT0gSG9zdFRleHQpIHsKICAgICAgICAvLyBXZSBhbHJlYWR5IGhhdmUgYW4gZXhpc3Rpbmcgbm9kZSBzbyBsZXQncyBqdXN0IHVwZGF0ZSBpdCBhbmQgZGVsZXRlCiAgICAgICAgLy8gdGhlIHJlc3QuCiAgICAgICAgZGVsZXRlUmVtYWluaW5nQ2hpbGRyZW4ocmV0dXJuRmliZXIsIGN1cnJlbnRGaXJzdENoaWxkLnNpYmxpbmcpOwogICAgICAgIHZhciBleGlzdGluZyA9IHVzZUZpYmVyKGN1cnJlbnRGaXJzdENoaWxkLCB0ZXh0Q29udGVudCk7CiAgICAgICAgZXhpc3RpbmcucmV0dXJuID0gcmV0dXJuRmliZXI7CiAgICAgICAgcmV0dXJuIGV4aXN0aW5nOwogICAgICB9IC8vIFRoZSBleGlzdGluZyBmaXJzdCBjaGlsZCBpcyBub3QgYSB0ZXh0IG5vZGUgc28gd2UgbmVlZCB0byBjcmVhdGUgb25lCiAgICAgIC8vIGFuZCBkZWxldGUgdGhlIGV4aXN0aW5nIG9uZXMuCgoKICAgICAgZGVsZXRlUmVtYWluaW5nQ2hpbGRyZW4ocmV0dXJuRmliZXIsIGN1cnJlbnRGaXJzdENoaWxkKTsKICAgICAgdmFyIGNyZWF0ZWQgPSBjcmVhdGVGaWJlckZyb21UZXh0KHRleHRDb250ZW50LCByZXR1cm5GaWJlci5tb2RlLCBsYW5lcyk7CiAgICAgIGNyZWF0ZWQucmV0dXJuID0gcmV0dXJuRmliZXI7CiAgICAgIHJldHVybiBjcmVhdGVkOwogICAgfQoKICAgIGZ1bmN0aW9uIHJlY29uY2lsZVNpbmdsZUVsZW1lbnQocmV0dXJuRmliZXIsIGN1cnJlbnRGaXJzdENoaWxkLCBlbGVtZW50LCBsYW5lcykgewogICAgICB2YXIga2V5ID0gZWxlbWVudC5rZXk7CiAgICAgIHZhciBjaGlsZCA9IGN1cnJlbnRGaXJzdENoaWxkOwoKICAgICAgd2hpbGUgKGNoaWxkICE9PSBudWxsKSB7CiAgICAgICAgLy8gVE9ETzogSWYga2V5ID09PSBudWxsIGFuZCBjaGlsZC5rZXkgPT09IG51bGwsIHRoZW4gdGhpcyBvbmx5IGFwcGxpZXMgdG8KICAgICAgICAvLyB0aGUgZmlyc3QgaXRlbSBpbiB0aGUgbGlzdC4KICAgICAgICBpZiAoY2hpbGQua2V5ID09PSBrZXkpIHsKICAgICAgICAgIHZhciBlbGVtZW50VHlwZSA9IGVsZW1lbnQudHlwZTsKCiAgICAgICAgICBpZiAoZWxlbWVudFR5cGUgPT09IFJFQUNUX0ZSQUdNRU5UX1RZUEUpIHsKICAgICAgICAgICAgaWYgKGNoaWxkLnRhZyA9PT0gRnJhZ21lbnQpIHsKICAgICAgICAgICAgICBkZWxldGVSZW1haW5pbmdDaGlsZHJlbihyZXR1cm5GaWJlciwgY2hpbGQuc2libGluZyk7CiAgICAgICAgICAgICAgdmFyIGV4aXN0aW5nID0gdXNlRmliZXIoY2hpbGQsIGVsZW1lbnQucHJvcHMuY2hpbGRyZW4pOwogICAgICAgICAgICAgIGV4aXN0aW5nLnJldHVybiA9IHJldHVybkZpYmVyOwoKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBleGlzdGluZy5fZGVidWdTb3VyY2UgPSBlbGVtZW50Ll9zb3VyY2U7CiAgICAgICAgICAgICAgICBleGlzdGluZy5fZGVidWdPd25lciA9IGVsZW1lbnQuX293bmVyOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgcmV0dXJuIGV4aXN0aW5nOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAoY2hpbGQuZWxlbWVudFR5cGUgPT09IGVsZW1lbnRUeXBlIHx8ICggLy8gS2VlcCB0aGlzIGNoZWNrIGlubGluZSBzbyBpdCBvbmx5IHJ1bnMgb24gdGhlIGZhbHNlIHBhdGg6CiAgICAgICAgICAgICBpc0NvbXBhdGlibGVGYW1pbHlGb3JIb3RSZWxvYWRpbmcoY2hpbGQsIGVsZW1lbnQpICkgfHwgLy8gTGF6eSB0eXBlcyBzaG91bGQgcmVjb25jaWxlIHRoZWlyIHJlc29sdmVkIHR5cGUuCiAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8gZG8gdGhpcyBhZnRlciB0aGUgSG90IFJlbG9hZGluZyBjaGVjayBhYm92ZSwKICAgICAgICAgICAgLy8gYmVjYXVzZSBob3QgcmVsb2FkaW5nIGhhcyBkaWZmZXJlbnQgc2VtYW50aWNzIHRoYW4gcHJvZCBiZWNhdXNlCiAgICAgICAgICAgIC8vIGl0IGRvZXNuJ3QgcmVzdXNwZW5kLiBTbyB3ZSBjYW4ndCBsZXQgdGhlIGNhbGwgYmVsb3cgc3VzcGVuZC4KICAgICAgICAgICAgdHlwZW9mIGVsZW1lbnRUeXBlID09PSAnb2JqZWN0JyAmJiBlbGVtZW50VHlwZSAhPT0gbnVsbCAmJiBlbGVtZW50VHlwZS4kJHR5cGVvZiA9PT0gUkVBQ1RfTEFaWV9UWVBFICYmIHJlc29sdmVMYXp5KGVsZW1lbnRUeXBlKSA9PT0gY2hpbGQudHlwZSkgewogICAgICAgICAgICAgIGRlbGV0ZVJlbWFpbmluZ0NoaWxkcmVuKHJldHVybkZpYmVyLCBjaGlsZC5zaWJsaW5nKTsKCiAgICAgICAgICAgICAgdmFyIF9leGlzdGluZyA9IHVzZUZpYmVyKGNoaWxkLCBlbGVtZW50LnByb3BzKTsKCiAgICAgICAgICAgICAgX2V4aXN0aW5nLnJlZiA9IGNvZXJjZVJlZihyZXR1cm5GaWJlciwgY2hpbGQsIGVsZW1lbnQpOwogICAgICAgICAgICAgIF9leGlzdGluZy5yZXR1cm4gPSByZXR1cm5GaWJlcjsKCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgX2V4aXN0aW5nLl9kZWJ1Z1NvdXJjZSA9IGVsZW1lbnQuX3NvdXJjZTsKICAgICAgICAgICAgICAgIF9leGlzdGluZy5fZGVidWdPd25lciA9IGVsZW1lbnQuX293bmVyOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgcmV0dXJuIF9leGlzdGluZzsKICAgICAgICAgICAgfQogICAgICAgICAgfSAvLyBEaWRuJ3QgbWF0Y2guCgoKICAgICAgICAgIGRlbGV0ZVJlbWFpbmluZ0NoaWxkcmVuKHJldHVybkZpYmVyLCBjaGlsZCk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZGVsZXRlQ2hpbGQocmV0dXJuRmliZXIsIGNoaWxkKTsKICAgICAgICB9CgogICAgICAgIGNoaWxkID0gY2hpbGQuc2libGluZzsKICAgICAgfQoKICAgICAgaWYgKGVsZW1lbnQudHlwZSA9PT0gUkVBQ1RfRlJBR01FTlRfVFlQRSkgewogICAgICAgIHZhciBjcmVhdGVkID0gY3JlYXRlRmliZXJGcm9tRnJhZ21lbnQoZWxlbWVudC5wcm9wcy5jaGlsZHJlbiwgcmV0dXJuRmliZXIubW9kZSwgbGFuZXMsIGVsZW1lbnQua2V5KTsKICAgICAgICBjcmVhdGVkLnJldHVybiA9IHJldHVybkZpYmVyOwogICAgICAgIHJldHVybiBjcmVhdGVkOwogICAgICB9IGVsc2UgewogICAgICAgIHZhciBfY3JlYXRlZDQgPSBjcmVhdGVGaWJlckZyb21FbGVtZW50KGVsZW1lbnQsIHJldHVybkZpYmVyLm1vZGUsIGxhbmVzKTsKCiAgICAgICAgX2NyZWF0ZWQ0LnJlZiA9IGNvZXJjZVJlZihyZXR1cm5GaWJlciwgY3VycmVudEZpcnN0Q2hpbGQsIGVsZW1lbnQpOwogICAgICAgIF9jcmVhdGVkNC5yZXR1cm4gPSByZXR1cm5GaWJlcjsKICAgICAgICByZXR1cm4gX2NyZWF0ZWQ0OwogICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gcmVjb25jaWxlU2luZ2xlUG9ydGFsKHJldHVybkZpYmVyLCBjdXJyZW50Rmlyc3RDaGlsZCwgcG9ydGFsLCBsYW5lcykgewogICAgICB2YXIga2V5ID0gcG9ydGFsLmtleTsKICAgICAgdmFyIGNoaWxkID0gY3VycmVudEZpcnN0Q2hpbGQ7CgogICAgICB3aGlsZSAoY2hpbGQgIT09IG51bGwpIHsKICAgICAgICAvLyBUT0RPOiBJZiBrZXkgPT09IG51bGwgYW5kIGNoaWxkLmtleSA9PT0gbnVsbCwgdGhlbiB0aGlzIG9ubHkgYXBwbGllcyB0bwogICAgICAgIC8vIHRoZSBmaXJzdCBpdGVtIGluIHRoZSBsaXN0LgogICAgICAgIGlmIChjaGlsZC5rZXkgPT09IGtleSkgewogICAgICAgICAgaWYgKGNoaWxkLnRhZyA9PT0gSG9zdFBvcnRhbCAmJiBjaGlsZC5zdGF0ZU5vZGUuY29udGFpbmVySW5mbyA9PT0gcG9ydGFsLmNvbnRhaW5lckluZm8gJiYgY2hpbGQuc3RhdGVOb2RlLmltcGxlbWVudGF0aW9uID09PSBwb3J0YWwuaW1wbGVtZW50YXRpb24pIHsKICAgICAgICAgICAgZGVsZXRlUmVtYWluaW5nQ2hpbGRyZW4ocmV0dXJuRmliZXIsIGNoaWxkLnNpYmxpbmcpOwogICAgICAgICAgICB2YXIgZXhpc3RpbmcgPSB1c2VGaWJlcihjaGlsZCwgcG9ydGFsLmNoaWxkcmVuIHx8IFtdKTsKICAgICAgICAgICAgZXhpc3RpbmcucmV0dXJuID0gcmV0dXJuRmliZXI7CiAgICAgICAgICAgIHJldHVybiBleGlzdGluZzsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGRlbGV0ZVJlbWFpbmluZ0NoaWxkcmVuKHJldHVybkZpYmVyLCBjaGlsZCk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBkZWxldGVDaGlsZChyZXR1cm5GaWJlciwgY2hpbGQpOwogICAgICAgIH0KCiAgICAgICAgY2hpbGQgPSBjaGlsZC5zaWJsaW5nOwogICAgICB9CgogICAgICB2YXIgY3JlYXRlZCA9IGNyZWF0ZUZpYmVyRnJvbVBvcnRhbChwb3J0YWwsIHJldHVybkZpYmVyLm1vZGUsIGxhbmVzKTsKICAgICAgY3JlYXRlZC5yZXR1cm4gPSByZXR1cm5GaWJlcjsKICAgICAgcmV0dXJuIGNyZWF0ZWQ7CiAgICB9IC8vIFRoaXMgQVBJIHdpbGwgdGFnIHRoZSBjaGlsZHJlbiB3aXRoIHRoZSBzaWRlLWVmZmVjdCBvZiB0aGUgcmVjb25jaWxpYXRpb24KICAgIC8vIGl0c2VsZi4gVGhleSB3aWxsIGJlIGFkZGVkIHRvIHRoZSBzaWRlLWVmZmVjdCBsaXN0IGFzIHdlIHBhc3MgdGhyb3VnaCB0aGUKICAgIC8vIGNoaWxkcmVuIGFuZCB0aGUgcGFyZW50LgoKCiAgICBmdW5jdGlvbiByZWNvbmNpbGVDaGlsZEZpYmVycyhyZXR1cm5GaWJlciwgY3VycmVudEZpcnN0Q2hpbGQsIG5ld0NoaWxkLCBsYW5lcykgewogICAgICAvLyBUaGlzIGZ1bmN0aW9uIGlzIG5vdCByZWN1cnNpdmUuCiAgICAgIC8vIElmIHRoZSB0b3AgbGV2ZWwgaXRlbSBpcyBhbiBhcnJheSwgd2UgdHJlYXQgaXQgYXMgYSBzZXQgb2YgY2hpbGRyZW4sCiAgICAgIC8vIG5vdCBhcyBhIGZyYWdtZW50LiBOZXN0ZWQgYXJyYXlzIG9uIHRoZSBvdGhlciBoYW5kIHdpbGwgYmUgdHJlYXRlZCBhcwogICAgICAvLyBmcmFnbWVudCBub2Rlcy4gUmVjdXJzaW9uIGhhcHBlbnMgYXQgdGhlIG5vcm1hbCBmbG93LgogICAgICAvLyBIYW5kbGUgdG9wIGxldmVsIHVua2V5ZWQgZnJhZ21lbnRzIGFzIGlmIHRoZXkgd2VyZSBhcnJheXMuCiAgICAgIC8vIFRoaXMgbGVhZHMgdG8gYW4gYW1iaWd1aXR5IGJldHdlZW4gPD57Wy4uLl19PC8+IGFuZCA8Pi4uLjwvPi4KICAgICAgLy8gV2UgdHJlYXQgdGhlIGFtYmlndW91cyBjYXNlcyBhYm92ZSB0aGUgc2FtZS4KICAgICAgdmFyIGlzVW5rZXllZFRvcExldmVsRnJhZ21lbnQgPSB0eXBlb2YgbmV3Q2hpbGQgPT09ICdvYmplY3QnICYmIG5ld0NoaWxkICE9PSBudWxsICYmIG5ld0NoaWxkLnR5cGUgPT09IFJFQUNUX0ZSQUdNRU5UX1RZUEUgJiYgbmV3Q2hpbGQua2V5ID09PSBudWxsOwoKICAgICAgaWYgKGlzVW5rZXllZFRvcExldmVsRnJhZ21lbnQpIHsKICAgICAgICBuZXdDaGlsZCA9IG5ld0NoaWxkLnByb3BzLmNoaWxkcmVuOwogICAgICB9IC8vIEhhbmRsZSBvYmplY3QgdHlwZXMKCgogICAgICBpZiAodHlwZW9mIG5ld0NoaWxkID09PSAnb2JqZWN0JyAmJiBuZXdDaGlsZCAhPT0gbnVsbCkgewogICAgICAgIHN3aXRjaCAobmV3Q2hpbGQuJCR0eXBlb2YpIHsKICAgICAgICAgIGNhc2UgUkVBQ1RfRUxFTUVOVF9UWVBFOgogICAgICAgICAgICByZXR1cm4gcGxhY2VTaW5nbGVDaGlsZChyZWNvbmNpbGVTaW5nbGVFbGVtZW50KHJldHVybkZpYmVyLCBjdXJyZW50Rmlyc3RDaGlsZCwgbmV3Q2hpbGQsIGxhbmVzKSk7CgogICAgICAgICAgY2FzZSBSRUFDVF9QT1JUQUxfVFlQRToKICAgICAgICAgICAgcmV0dXJuIHBsYWNlU2luZ2xlQ2hpbGQocmVjb25jaWxlU2luZ2xlUG9ydGFsKHJldHVybkZpYmVyLCBjdXJyZW50Rmlyc3RDaGlsZCwgbmV3Q2hpbGQsIGxhbmVzKSk7CgogICAgICAgICAgY2FzZSBSRUFDVF9MQVpZX1RZUEU6CiAgICAgICAgICAgIHZhciBwYXlsb2FkID0gbmV3Q2hpbGQuX3BheWxvYWQ7CiAgICAgICAgICAgIHZhciBpbml0ID0gbmV3Q2hpbGQuX2luaXQ7IC8vIFRPRE86IFRoaXMgZnVuY3Rpb24gaXMgc3VwcG9zZWQgdG8gYmUgbm9uLXJlY3Vyc2l2ZS4KCiAgICAgICAgICAgIHJldHVybiByZWNvbmNpbGVDaGlsZEZpYmVycyhyZXR1cm5GaWJlciwgY3VycmVudEZpcnN0Q2hpbGQsIGluaXQocGF5bG9hZCksIGxhbmVzKTsKICAgICAgICB9CgogICAgICAgIGlmIChpc0FycmF5KG5ld0NoaWxkKSkgewogICAgICAgICAgcmV0dXJuIHJlY29uY2lsZUNoaWxkcmVuQXJyYXkocmV0dXJuRmliZXIsIGN1cnJlbnRGaXJzdENoaWxkLCBuZXdDaGlsZCwgbGFuZXMpOwogICAgICAgIH0KCiAgICAgICAgaWYgKGdldEl0ZXJhdG9yRm4obmV3Q2hpbGQpKSB7CiAgICAgICAgICByZXR1cm4gcmVjb25jaWxlQ2hpbGRyZW5JdGVyYXRvcihyZXR1cm5GaWJlciwgY3VycmVudEZpcnN0Q2hpbGQsIG5ld0NoaWxkLCBsYW5lcyk7CiAgICAgICAgfQoKICAgICAgICB0aHJvd09uSW52YWxpZE9iamVjdFR5cGUocmV0dXJuRmliZXIsIG5ld0NoaWxkKTsKICAgICAgfQoKICAgICAgaWYgKHR5cGVvZiBuZXdDaGlsZCA9PT0gJ3N0cmluZycgJiYgbmV3Q2hpbGQgIT09ICcnIHx8IHR5cGVvZiBuZXdDaGlsZCA9PT0gJ251bWJlcicpIHsKICAgICAgICByZXR1cm4gcGxhY2VTaW5nbGVDaGlsZChyZWNvbmNpbGVTaW5nbGVUZXh0Tm9kZShyZXR1cm5GaWJlciwgY3VycmVudEZpcnN0Q2hpbGQsICcnICsgbmV3Q2hpbGQsIGxhbmVzKSk7CiAgICAgIH0KCiAgICAgIHsKICAgICAgICBpZiAodHlwZW9mIG5ld0NoaWxkID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICB3YXJuT25GdW5jdGlvblR5cGUocmV0dXJuRmliZXIpOwogICAgICAgIH0KICAgICAgfSAvLyBSZW1haW5pbmcgY2FzZXMgYXJlIGFsbCB0cmVhdGVkIGFzIGVtcHR5LgoKCiAgICAgIHJldHVybiBkZWxldGVSZW1haW5pbmdDaGlsZHJlbihyZXR1cm5GaWJlciwgY3VycmVudEZpcnN0Q2hpbGQpOwogICAgfQoKICAgIHJldHVybiByZWNvbmNpbGVDaGlsZEZpYmVyczsKICB9CgogIHZhciByZWNvbmNpbGVDaGlsZEZpYmVycyA9IENoaWxkUmVjb25jaWxlcih0cnVlKTsKICB2YXIgbW91bnRDaGlsZEZpYmVycyA9IENoaWxkUmVjb25jaWxlcihmYWxzZSk7CiAgZnVuY3Rpb24gY2xvbmVDaGlsZEZpYmVycyhjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcykgewogICAgaWYgKGN1cnJlbnQgIT09IG51bGwgJiYgd29ya0luUHJvZ3Jlc3MuY2hpbGQgIT09IGN1cnJlbnQuY2hpbGQpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXN1bWluZyB3b3JrIG5vdCB5ZXQgaW1wbGVtZW50ZWQuJyk7CiAgICB9CgogICAgaWYgKHdvcmtJblByb2dyZXNzLmNoaWxkID09PSBudWxsKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB2YXIgY3VycmVudENoaWxkID0gd29ya0luUHJvZ3Jlc3MuY2hpbGQ7CiAgICB2YXIgbmV3Q2hpbGQgPSBjcmVhdGVXb3JrSW5Qcm9ncmVzcyhjdXJyZW50Q2hpbGQsIGN1cnJlbnRDaGlsZC5wZW5kaW5nUHJvcHMpOwogICAgd29ya0luUHJvZ3Jlc3MuY2hpbGQgPSBuZXdDaGlsZDsKICAgIG5ld0NoaWxkLnJldHVybiA9IHdvcmtJblByb2dyZXNzOwoKICAgIHdoaWxlIChjdXJyZW50Q2hpbGQuc2libGluZyAhPT0gbnVsbCkgewogICAgICBjdXJyZW50Q2hpbGQgPSBjdXJyZW50Q2hpbGQuc2libGluZzsKICAgICAgbmV3Q2hpbGQgPSBuZXdDaGlsZC5zaWJsaW5nID0gY3JlYXRlV29ya0luUHJvZ3Jlc3MoY3VycmVudENoaWxkLCBjdXJyZW50Q2hpbGQucGVuZGluZ1Byb3BzKTsKICAgICAgbmV3Q2hpbGQucmV0dXJuID0gd29ya0luUHJvZ3Jlc3M7CiAgICB9CgogICAgbmV3Q2hpbGQuc2libGluZyA9IG51bGw7CiAgfSAvLyBSZXNldCBhIHdvcmtJblByb2dyZXNzIGNoaWxkIHNldCB0byBwcmVwYXJlIGl0IGZvciBhIHNlY29uZCBwYXNzLgoKICBmdW5jdGlvbiByZXNldENoaWxkRmliZXJzKHdvcmtJblByb2dyZXNzLCBsYW5lcykgewogICAgdmFyIGNoaWxkID0gd29ya0luUHJvZ3Jlc3MuY2hpbGQ7CgogICAgd2hpbGUgKGNoaWxkICE9PSBudWxsKSB7CiAgICAgIHJlc2V0V29ya0luUHJvZ3Jlc3MoY2hpbGQsIGxhbmVzKTsKICAgICAgY2hpbGQgPSBjaGlsZC5zaWJsaW5nOwogICAgfQogIH0KCiAgdmFyIHZhbHVlQ3Vyc29yID0gY3JlYXRlQ3Vyc29yKG51bGwpOwogIHZhciByZW5kZXJlclNpZ2lsOwoKICB7CiAgICAvLyBVc2UgdGhpcyB0byBkZXRlY3QgbXVsdGlwbGUgcmVuZGVyZXJzIHVzaW5nIHRoZSBzYW1lIGNvbnRleHQKICAgIHJlbmRlcmVyU2lnaWwgPSB7fTsKICB9CgogIHZhciBjdXJyZW50bHlSZW5kZXJpbmdGaWJlciA9IG51bGw7CiAgdmFyIGxhc3RDb250ZXh0RGVwZW5kZW5jeSA9IG51bGw7CiAgdmFyIGxhc3RGdWxseU9ic2VydmVkQ29udGV4dCA9IG51bGw7CiAgdmFyIGlzRGlzYWxsb3dlZENvbnRleHRSZWFkSW5ERVYgPSBmYWxzZTsKICBmdW5jdGlvbiByZXNldENvbnRleHREZXBlbmRlbmNpZXMoKSB7CiAgICAvLyBUaGlzIGlzIGNhbGxlZCByaWdodCBiZWZvcmUgUmVhY3QgeWllbGRzIGV4ZWN1dGlvbiwgdG8gZW5zdXJlIGByZWFkQ29udGV4dGAKICAgIC8vIGNhbm5vdCBiZSBjYWxsZWQgb3V0c2lkZSB0aGUgcmVuZGVyIHBoYXNlLgogICAgY3VycmVudGx5UmVuZGVyaW5nRmliZXIgPSBudWxsOwogICAgbGFzdENvbnRleHREZXBlbmRlbmN5ID0gbnVsbDsKICAgIGxhc3RGdWxseU9ic2VydmVkQ29udGV4dCA9IG51bGw7CgogICAgewogICAgICBpc0Rpc2FsbG93ZWRDb250ZXh0UmVhZEluREVWID0gZmFsc2U7CiAgICB9CiAgfQogIGZ1bmN0aW9uIGVudGVyRGlzYWxsb3dlZENvbnRleHRSZWFkSW5ERVYoKSB7CiAgICB7CiAgICAgIGlzRGlzYWxsb3dlZENvbnRleHRSZWFkSW5ERVYgPSB0cnVlOwogICAgfQogIH0KICBmdW5jdGlvbiBleGl0RGlzYWxsb3dlZENvbnRleHRSZWFkSW5ERVYoKSB7CiAgICB7CiAgICAgIGlzRGlzYWxsb3dlZENvbnRleHRSZWFkSW5ERVYgPSBmYWxzZTsKICAgIH0KICB9CiAgZnVuY3Rpb24gcHVzaFByb3ZpZGVyKHByb3ZpZGVyRmliZXIsIGNvbnRleHQsIG5leHRWYWx1ZSkgewogICAgewogICAgICBwdXNoKHZhbHVlQ3Vyc29yLCBjb250ZXh0Ll9jdXJyZW50VmFsdWUsIHByb3ZpZGVyRmliZXIpOwogICAgICBjb250ZXh0Ll9jdXJyZW50VmFsdWUgPSBuZXh0VmFsdWU7CgogICAgICB7CiAgICAgICAgaWYgKGNvbnRleHQuX2N1cnJlbnRSZW5kZXJlciAhPT0gdW5kZWZpbmVkICYmIGNvbnRleHQuX2N1cnJlbnRSZW5kZXJlciAhPT0gbnVsbCAmJiBjb250ZXh0Ll9jdXJyZW50UmVuZGVyZXIgIT09IHJlbmRlcmVyU2lnaWwpIHsKICAgICAgICAgIGVycm9yKCdEZXRlY3RlZCBtdWx0aXBsZSByZW5kZXJlcnMgY29uY3VycmVudGx5IHJlbmRlcmluZyB0aGUgJyArICdzYW1lIGNvbnRleHQgcHJvdmlkZXIuIFRoaXMgaXMgY3VycmVudGx5IHVuc3VwcG9ydGVkLicpOwogICAgICAgIH0KCiAgICAgICAgY29udGV4dC5fY3VycmVudFJlbmRlcmVyID0gcmVuZGVyZXJTaWdpbDsKICAgICAgfQogICAgfQogIH0KICBmdW5jdGlvbiBwb3BQcm92aWRlcihjb250ZXh0LCBwcm92aWRlckZpYmVyKSB7CiAgICB2YXIgY3VycmVudFZhbHVlID0gdmFsdWVDdXJzb3IuY3VycmVudDsKICAgIHBvcCh2YWx1ZUN1cnNvciwgcHJvdmlkZXJGaWJlcik7CgogICAgewogICAgICB7CiAgICAgICAgY29udGV4dC5fY3VycmVudFZhbHVlID0gY3VycmVudFZhbHVlOwogICAgICB9CiAgICB9CiAgfQogIGZ1bmN0aW9uIHNjaGVkdWxlQ29udGV4dFdvcmtPblBhcmVudFBhdGgocGFyZW50LCByZW5kZXJMYW5lcywgcHJvcGFnYXRpb25Sb290KSB7CiAgICAvLyBVcGRhdGUgdGhlIGNoaWxkIGxhbmVzIG9mIGFsbCB0aGUgYW5jZXN0b3JzLCBpbmNsdWRpbmcgdGhlIGFsdGVybmF0ZXMuCiAgICB2YXIgbm9kZSA9IHBhcmVudDsKCiAgICB3aGlsZSAobm9kZSAhPT0gbnVsbCkgewogICAgICB2YXIgYWx0ZXJuYXRlID0gbm9kZS5hbHRlcm5hdGU7CgogICAgICBpZiAoIWlzU3Vic2V0T2ZMYW5lcyhub2RlLmNoaWxkTGFuZXMsIHJlbmRlckxhbmVzKSkgewogICAgICAgIG5vZGUuY2hpbGRMYW5lcyA9IG1lcmdlTGFuZXMobm9kZS5jaGlsZExhbmVzLCByZW5kZXJMYW5lcyk7CgogICAgICAgIGlmIChhbHRlcm5hdGUgIT09IG51bGwpIHsKICAgICAgICAgIGFsdGVybmF0ZS5jaGlsZExhbmVzID0gbWVyZ2VMYW5lcyhhbHRlcm5hdGUuY2hpbGRMYW5lcywgcmVuZGVyTGFuZXMpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChhbHRlcm5hdGUgIT09IG51bGwgJiYgIWlzU3Vic2V0T2ZMYW5lcyhhbHRlcm5hdGUuY2hpbGRMYW5lcywgcmVuZGVyTGFuZXMpKSB7CiAgICAgICAgYWx0ZXJuYXRlLmNoaWxkTGFuZXMgPSBtZXJnZUxhbmVzKGFsdGVybmF0ZS5jaGlsZExhbmVzLCByZW5kZXJMYW5lcyk7CiAgICAgIH0KCiAgICAgIGlmIChub2RlID09PSBwcm9wYWdhdGlvblJvb3QpIHsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgbm9kZSA9IG5vZGUucmV0dXJuOwogICAgfQoKICAgIHsKICAgICAgaWYgKG5vZGUgIT09IHByb3BhZ2F0aW9uUm9vdCkgewogICAgICAgIGVycm9yKCdFeHBlY3RlZCB0byBmaW5kIHRoZSBwcm9wYWdhdGlvbiByb290IHdoZW4gc2NoZWR1bGluZyBjb250ZXh0IHdvcmsuICcgKyAnVGhpcyBlcnJvciBpcyBsaWtlbHkgY2F1c2VkIGJ5IGEgYnVnIGluIFJlYWN0LiBQbGVhc2UgZmlsZSBhbiBpc3N1ZS4nKTsKICAgICAgfQogICAgfQogIH0KICBmdW5jdGlvbiBwcm9wYWdhdGVDb250ZXh0Q2hhbmdlKHdvcmtJblByb2dyZXNzLCBjb250ZXh0LCByZW5kZXJMYW5lcykgewogICAgewogICAgICBwcm9wYWdhdGVDb250ZXh0Q2hhbmdlX2VhZ2VyKHdvcmtJblByb2dyZXNzLCBjb250ZXh0LCByZW5kZXJMYW5lcyk7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBwcm9wYWdhdGVDb250ZXh0Q2hhbmdlX2VhZ2VyKHdvcmtJblByb2dyZXNzLCBjb250ZXh0LCByZW5kZXJMYW5lcykgewoKICAgIHZhciBmaWJlciA9IHdvcmtJblByb2dyZXNzLmNoaWxkOwoKICAgIGlmIChmaWJlciAhPT0gbnVsbCkgewogICAgICAvLyBTZXQgdGhlIHJldHVybiBwb2ludGVyIG9mIHRoZSBjaGlsZCB0byB0aGUgd29yay1pbi1wcm9ncmVzcyBmaWJlci4KICAgICAgZmliZXIucmV0dXJuID0gd29ya0luUHJvZ3Jlc3M7CiAgICB9CgogICAgd2hpbGUgKGZpYmVyICE9PSBudWxsKSB7CiAgICAgIHZhciBuZXh0RmliZXIgPSB2b2lkIDA7IC8vIFZpc2l0IHRoaXMgZmliZXIuCgogICAgICB2YXIgbGlzdCA9IGZpYmVyLmRlcGVuZGVuY2llczsKCiAgICAgIGlmIChsaXN0ICE9PSBudWxsKSB7CiAgICAgICAgbmV4dEZpYmVyID0gZmliZXIuY2hpbGQ7CiAgICAgICAgdmFyIGRlcGVuZGVuY3kgPSBsaXN0LmZpcnN0Q29udGV4dDsKCiAgICAgICAgd2hpbGUgKGRlcGVuZGVuY3kgIT09IG51bGwpIHsKICAgICAgICAgIC8vIENoZWNrIGlmIHRoZSBjb250ZXh0IG1hdGNoZXMuCiAgICAgICAgICBpZiAoZGVwZW5kZW5jeS5jb250ZXh0ID09PSBjb250ZXh0KSB7CiAgICAgICAgICAgIC8vIE1hdGNoISBTY2hlZHVsZSBhbiB1cGRhdGUgb24gdGhpcyBmaWJlci4KICAgICAgICAgICAgaWYgKGZpYmVyLnRhZyA9PT0gQ2xhc3NDb21wb25lbnQpIHsKICAgICAgICAgICAgICAvLyBTY2hlZHVsZSBhIGZvcmNlIHVwZGF0ZSBvbiB0aGUgd29yay1pbi1wcm9ncmVzcy4KICAgICAgICAgICAgICB2YXIgbGFuZSA9IHBpY2tBcmJpdHJhcnlMYW5lKHJlbmRlckxhbmVzKTsKICAgICAgICAgICAgICB2YXIgdXBkYXRlID0gY3JlYXRlVXBkYXRlKE5vVGltZXN0YW1wLCBsYW5lKTsKICAgICAgICAgICAgICB1cGRhdGUudGFnID0gRm9yY2VVcGRhdGU7IC8vIFRPRE86IEJlY2F1c2Ugd2UgZG9uJ3QgaGF2ZSBhIHdvcmstaW4tcHJvZ3Jlc3MsIHRoaXMgd2lsbCBhZGQgdGhlCiAgICAgICAgICAgICAgLy8gdXBkYXRlIHRvIHRoZSBjdXJyZW50IGZpYmVyLCB0b28sIHdoaWNoIG1lYW5zIGl0IHdpbGwgcGVyc2lzdCBldmVuIGlmCiAgICAgICAgICAgICAgLy8gdGhpcyByZW5kZXIgaXMgdGhyb3duIGF3YXkuIFNpbmNlIGl0J3MgYSByYWNlIGNvbmRpdGlvbiwgbm90IHN1cmUgaXQncwogICAgICAgICAgICAgIC8vIHdvcnRoIGZpeGluZy4KICAgICAgICAgICAgICAvLyBJbmxpbmVkIGBlbnF1ZXVlVXBkYXRlYCB0byByZW1vdmUgaW50ZXJsZWF2ZWQgdXBkYXRlIGNoZWNrCgogICAgICAgICAgICAgIHZhciB1cGRhdGVRdWV1ZSA9IGZpYmVyLnVwZGF0ZVF1ZXVlOwoKICAgICAgICAgICAgICBpZiAodXBkYXRlUXVldWUgPT09IG51bGwpIDsgZWxzZSB7CiAgICAgICAgICAgICAgICB2YXIgc2hhcmVkUXVldWUgPSB1cGRhdGVRdWV1ZS5zaGFyZWQ7CiAgICAgICAgICAgICAgICB2YXIgcGVuZGluZyA9IHNoYXJlZFF1ZXVlLnBlbmRpbmc7CgogICAgICAgICAgICAgICAgaWYgKHBlbmRpbmcgPT09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgLy8gVGhpcyBpcyB0aGUgZmlyc3QgdXBkYXRlLiBDcmVhdGUgYSBjaXJjdWxhciBsaXN0LgogICAgICAgICAgICAgICAgICB1cGRhdGUubmV4dCA9IHVwZGF0ZTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIHVwZGF0ZS5uZXh0ID0gcGVuZGluZy5uZXh0OwogICAgICAgICAgICAgICAgICBwZW5kaW5nLm5leHQgPSB1cGRhdGU7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgc2hhcmVkUXVldWUucGVuZGluZyA9IHVwZGF0ZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZpYmVyLmxhbmVzID0gbWVyZ2VMYW5lcyhmaWJlci5sYW5lcywgcmVuZGVyTGFuZXMpOwogICAgICAgICAgICB2YXIgYWx0ZXJuYXRlID0gZmliZXIuYWx0ZXJuYXRlOwoKICAgICAgICAgICAgaWYgKGFsdGVybmF0ZSAhPT0gbnVsbCkgewogICAgICAgICAgICAgIGFsdGVybmF0ZS5sYW5lcyA9IG1lcmdlTGFuZXMoYWx0ZXJuYXRlLmxhbmVzLCByZW5kZXJMYW5lcyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHNjaGVkdWxlQ29udGV4dFdvcmtPblBhcmVudFBhdGgoZmliZXIucmV0dXJuLCByZW5kZXJMYW5lcywgd29ya0luUHJvZ3Jlc3MpOyAvLyBNYXJrIHRoZSB1cGRhdGVkIGxhbmVzIG9uIHRoZSBsaXN0LCB0b28uCgogICAgICAgICAgICBsaXN0LmxhbmVzID0gbWVyZ2VMYW5lcyhsaXN0LmxhbmVzLCByZW5kZXJMYW5lcyk7IC8vIFNpbmNlIHdlIGFscmVhZHkgZm91bmQgYSBtYXRjaCwgd2UgY2FuIHN0b3AgdHJhdmVyc2luZyB0aGUKICAgICAgICAgICAgLy8gZGVwZW5kZW5jeSBsaXN0LgoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgZGVwZW5kZW5jeSA9IGRlcGVuZGVuY3kubmV4dDsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoZmliZXIudGFnID09PSBDb250ZXh0UHJvdmlkZXIpIHsKICAgICAgICAvLyBEb24ndCBzY2FuIGRlZXBlciBpZiB0aGlzIGlzIGEgbWF0Y2hpbmcgcHJvdmlkZXIKICAgICAgICBuZXh0RmliZXIgPSBmaWJlci50eXBlID09PSB3b3JrSW5Qcm9ncmVzcy50eXBlID8gbnVsbCA6IGZpYmVyLmNoaWxkOwogICAgICB9IGVsc2UgaWYgKGZpYmVyLnRhZyA9PT0gRGVoeWRyYXRlZEZyYWdtZW50KSB7CiAgICAgICAgLy8gSWYgYSBkZWh5ZHJhdGVkIHN1c3BlbnNlIGJvdW5kYXJ5IGlzIGluIHRoaXMgc3VidHJlZSwgd2UgZG9uJ3Qga25vdwogICAgICAgIC8vIGlmIGl0IHdpbGwgaGF2ZSBhbnkgY29udGV4dCBjb25zdW1lcnMgaW4gaXQuIFRoZSBiZXN0IHdlIGNhbiBkbyBpcwogICAgICAgIC8vIG1hcmsgaXQgYXMgaGF2aW5nIHVwZGF0ZXMuCiAgICAgICAgdmFyIHBhcmVudFN1c3BlbnNlID0gZmliZXIucmV0dXJuOwoKICAgICAgICBpZiAocGFyZW50U3VzcGVuc2UgPT09IG51bGwpIHsKICAgICAgICAgIHRocm93IG5ldyBFcnJvcignV2UganVzdCBjYW1lIGZyb20gYSBwYXJlbnQgc28gd2UgbXVzdCBoYXZlIGhhZCBhIHBhcmVudC4gVGhpcyBpcyBhIGJ1ZyBpbiBSZWFjdC4nKTsKICAgICAgICB9CgogICAgICAgIHBhcmVudFN1c3BlbnNlLmxhbmVzID0gbWVyZ2VMYW5lcyhwYXJlbnRTdXNwZW5zZS5sYW5lcywgcmVuZGVyTGFuZXMpOwogICAgICAgIHZhciBfYWx0ZXJuYXRlID0gcGFyZW50U3VzcGVuc2UuYWx0ZXJuYXRlOwoKICAgICAgICBpZiAoX2FsdGVybmF0ZSAhPT0gbnVsbCkgewogICAgICAgICAgX2FsdGVybmF0ZS5sYW5lcyA9IG1lcmdlTGFuZXMoX2FsdGVybmF0ZS5sYW5lcywgcmVuZGVyTGFuZXMpOwogICAgICAgIH0gLy8gVGhpcyBpcyBpbnRlbnRpb25hbGx5IHBhc3NpbmcgdGhpcyBmaWJlciBhcyB0aGUgcGFyZW50CiAgICAgICAgLy8gYmVjYXVzZSB3ZSB3YW50IHRvIHNjaGVkdWxlIHRoaXMgZmliZXIgYXMgaGF2aW5nIHdvcmsKICAgICAgICAvLyBvbiBpdHMgY2hpbGRyZW4uIFdlJ2xsIHVzZSB0aGUgY2hpbGRMYW5lcyBvbgogICAgICAgIC8vIHRoaXMgZmliZXIgdG8gaW5kaWNhdGUgdGhhdCBhIGNvbnRleHQgaGFzIGNoYW5nZWQuCgoKICAgICAgICBzY2hlZHVsZUNvbnRleHRXb3JrT25QYXJlbnRQYXRoKHBhcmVudFN1c3BlbnNlLCByZW5kZXJMYW5lcywgd29ya0luUHJvZ3Jlc3MpOwogICAgICAgIG5leHRGaWJlciA9IGZpYmVyLnNpYmxpbmc7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gVHJhdmVyc2UgZG93bi4KICAgICAgICBuZXh0RmliZXIgPSBmaWJlci5jaGlsZDsKICAgICAgfQoKICAgICAgaWYgKG5leHRGaWJlciAhPT0gbnVsbCkgewogICAgICAgIC8vIFNldCB0aGUgcmV0dXJuIHBvaW50ZXIgb2YgdGhlIGNoaWxkIHRvIHRoZSB3b3JrLWluLXByb2dyZXNzIGZpYmVyLgogICAgICAgIG5leHRGaWJlci5yZXR1cm4gPSBmaWJlcjsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBObyBjaGlsZC4gVHJhdmVyc2UgdG8gbmV4dCBzaWJsaW5nLgogICAgICAgIG5leHRGaWJlciA9IGZpYmVyOwoKICAgICAgICB3aGlsZSAobmV4dEZpYmVyICE9PSBudWxsKSB7CiAgICAgICAgICBpZiAobmV4dEZpYmVyID09PSB3b3JrSW5Qcm9ncmVzcykgewogICAgICAgICAgICAvLyBXZSdyZSBiYWNrIHRvIHRoZSByb290IG9mIHRoaXMgc3VidHJlZS4gRXhpdC4KICAgICAgICAgICAgbmV4dEZpYmVyID0gbnVsbDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIHNpYmxpbmcgPSBuZXh0RmliZXIuc2libGluZzsKCiAgICAgICAgICBpZiAoc2libGluZyAhPT0gbnVsbCkgewogICAgICAgICAgICAvLyBTZXQgdGhlIHJldHVybiBwb2ludGVyIG9mIHRoZSBzaWJsaW5nIHRvIHRoZSB3b3JrLWluLXByb2dyZXNzIGZpYmVyLgogICAgICAgICAgICBzaWJsaW5nLnJldHVybiA9IG5leHRGaWJlci5yZXR1cm47CiAgICAgICAgICAgIG5leHRGaWJlciA9IHNpYmxpbmc7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfSAvLyBObyBtb3JlIHNpYmxpbmdzLiBUcmF2ZXJzZSB1cC4KCgogICAgICAgICAgbmV4dEZpYmVyID0gbmV4dEZpYmVyLnJldHVybjsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZpYmVyID0gbmV4dEZpYmVyOwogICAgfQogIH0KICBmdW5jdGlvbiBwcmVwYXJlVG9SZWFkQ29udGV4dCh3b3JrSW5Qcm9ncmVzcywgcmVuZGVyTGFuZXMpIHsKICAgIGN1cnJlbnRseVJlbmRlcmluZ0ZpYmVyID0gd29ya0luUHJvZ3Jlc3M7CiAgICBsYXN0Q29udGV4dERlcGVuZGVuY3kgPSBudWxsOwogICAgbGFzdEZ1bGx5T2JzZXJ2ZWRDb250ZXh0ID0gbnVsbDsKICAgIHZhciBkZXBlbmRlbmNpZXMgPSB3b3JrSW5Qcm9ncmVzcy5kZXBlbmRlbmNpZXM7CgogICAgaWYgKGRlcGVuZGVuY2llcyAhPT0gbnVsbCkgewogICAgICB7CiAgICAgICAgdmFyIGZpcnN0Q29udGV4dCA9IGRlcGVuZGVuY2llcy5maXJzdENvbnRleHQ7CgogICAgICAgIGlmIChmaXJzdENvbnRleHQgIT09IG51bGwpIHsKICAgICAgICAgIGlmIChpbmNsdWRlc1NvbWVMYW5lKGRlcGVuZGVuY2llcy5sYW5lcywgcmVuZGVyTGFuZXMpKSB7CiAgICAgICAgICAgIC8vIENvbnRleHQgbGlzdCBoYXMgYSBwZW5kaW5nIHVwZGF0ZS4gTWFyayB0aGF0IHRoaXMgZmliZXIgcGVyZm9ybWVkIHdvcmsuCiAgICAgICAgICAgIG1hcmtXb3JrSW5Qcm9ncmVzc1JlY2VpdmVkVXBkYXRlKCk7CiAgICAgICAgICB9IC8vIFJlc2V0IHRoZSB3b3JrLWluLXByb2dyZXNzIGxpc3QKCgogICAgICAgICAgZGVwZW5kZW5jaWVzLmZpcnN0Q29udGV4dCA9IG51bGw7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQogIGZ1bmN0aW9uIHJlYWRDb250ZXh0KGNvbnRleHQpIHsKICAgIHsKICAgICAgLy8gVGhpcyB3YXJuaW5nIHdvdWxkIGZpcmUgaWYgeW91IHJlYWQgY29udGV4dCBpbnNpZGUgYSBIb29rIGxpa2UgdXNlTWVtby4KICAgICAgLy8gVW5saWtlIHRoZSBjbGFzcyBjaGVjayBiZWxvdywgaXQncyBub3QgZW5mb3JjZWQgaW4gcHJvZHVjdGlvbiBmb3IgcGVyZi4KICAgICAgaWYgKGlzRGlzYWxsb3dlZENvbnRleHRSZWFkSW5ERVYpIHsKICAgICAgICBlcnJvcignQ29udGV4dCBjYW4gb25seSBiZSByZWFkIHdoaWxlIFJlYWN0IGlzIHJlbmRlcmluZy4gJyArICdJbiBjbGFzc2VzLCB5b3UgY2FuIHJlYWQgaXQgaW4gdGhlIHJlbmRlciBtZXRob2Qgb3IgZ2V0RGVyaXZlZFN0YXRlRnJvbVByb3BzLiAnICsgJ0luIGZ1bmN0aW9uIGNvbXBvbmVudHMsIHlvdSBjYW4gcmVhZCBpdCBkaXJlY3RseSBpbiB0aGUgZnVuY3Rpb24gYm9keSwgYnV0IG5vdCAnICsgJ2luc2lkZSBIb29rcyBsaWtlIHVzZVJlZHVjZXIoKSBvciB1c2VNZW1vKCkuJyk7CiAgICAgIH0KICAgIH0KCiAgICB2YXIgdmFsdWUgPSAgY29udGV4dC5fY3VycmVudFZhbHVlIDsKCiAgICBpZiAobGFzdEZ1bGx5T2JzZXJ2ZWRDb250ZXh0ID09PSBjb250ZXh0KSA7IGVsc2UgewogICAgICB2YXIgY29udGV4dEl0ZW0gPSB7CiAgICAgICAgY29udGV4dDogY29udGV4dCwKICAgICAgICBtZW1vaXplZFZhbHVlOiB2YWx1ZSwKICAgICAgICBuZXh0OiBudWxsCiAgICAgIH07CgogICAgICBpZiAobGFzdENvbnRleHREZXBlbmRlbmN5ID09PSBudWxsKSB7CiAgICAgICAgaWYgKGN1cnJlbnRseVJlbmRlcmluZ0ZpYmVyID09PSBudWxsKSB7CiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvbnRleHQgY2FuIG9ubHkgYmUgcmVhZCB3aGlsZSBSZWFjdCBpcyByZW5kZXJpbmcuICcgKyAnSW4gY2xhc3NlcywgeW91IGNhbiByZWFkIGl0IGluIHRoZSByZW5kZXIgbWV0aG9kIG9yIGdldERlcml2ZWRTdGF0ZUZyb21Qcm9wcy4gJyArICdJbiBmdW5jdGlvbiBjb21wb25lbnRzLCB5b3UgY2FuIHJlYWQgaXQgZGlyZWN0bHkgaW4gdGhlIGZ1bmN0aW9uIGJvZHksIGJ1dCBub3QgJyArICdpbnNpZGUgSG9va3MgbGlrZSB1c2VSZWR1Y2VyKCkgb3IgdXNlTWVtbygpLicpOwogICAgICAgIH0gLy8gVGhpcyBpcyB0aGUgZmlyc3QgZGVwZW5kZW5jeSBmb3IgdGhpcyBjb21wb25lbnQuIENyZWF0ZSBhIG5ldyBsaXN0LgoKCiAgICAgICAgbGFzdENvbnRleHREZXBlbmRlbmN5ID0gY29udGV4dEl0ZW07CiAgICAgICAgY3VycmVudGx5UmVuZGVyaW5nRmliZXIuZGVwZW5kZW5jaWVzID0gewogICAgICAgICAgbGFuZXM6IE5vTGFuZXMsCiAgICAgICAgICBmaXJzdENvbnRleHQ6IGNvbnRleHRJdGVtCiAgICAgICAgfTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBBcHBlbmQgYSBuZXcgY29udGV4dCBpdGVtLgogICAgICAgIGxhc3RDb250ZXh0RGVwZW5kZW5jeSA9IGxhc3RDb250ZXh0RGVwZW5kZW5jeS5uZXh0ID0gY29udGV4dEl0ZW07CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gdmFsdWU7CiAgfQoKICAvLyByZW5kZXIuIFdoZW4gdGhpcyByZW5kZXIgZXhpdHMsIGVpdGhlciBiZWNhdXNlIGl0IGZpbmlzaGVzIG9yIGJlY2F1c2UgaXQgaXMKICAvLyBpbnRlcnJ1cHRlZCwgdGhlIGludGVybGVhdmVkIHVwZGF0ZXMgd2lsbCBiZSB0cmFuc2ZlcnJlZCBvbnRvIHRoZSBtYWluIHBhcnQKICAvLyBvZiB0aGUgcXVldWUuCgogIHZhciBjb25jdXJyZW50UXVldWVzID0gbnVsbDsKICBmdW5jdGlvbiBwdXNoQ29uY3VycmVudFVwZGF0ZVF1ZXVlKHF1ZXVlKSB7CiAgICBpZiAoY29uY3VycmVudFF1ZXVlcyA9PT0gbnVsbCkgewogICAgICBjb25jdXJyZW50UXVldWVzID0gW3F1ZXVlXTsKICAgIH0gZWxzZSB7CiAgICAgIGNvbmN1cnJlbnRRdWV1ZXMucHVzaChxdWV1ZSk7CiAgICB9CiAgfQogIGZ1bmN0aW9uIGZpbmlzaFF1ZXVlaW5nQ29uY3VycmVudFVwZGF0ZXMoKSB7CiAgICAvLyBUcmFuc2ZlciB0aGUgaW50ZXJsZWF2ZWQgdXBkYXRlcyBvbnRvIHRoZSBtYWluIHF1ZXVlLiBFYWNoIHF1ZXVlIGhhcyBhCiAgICAvLyBgcGVuZGluZ2AgZmllbGQgYW5kIGFuIGBpbnRlcmxlYXZlZGAgZmllbGQuIFdoZW4gdGhleSBhcmUgbm90IG51bGwsIHRoZXkKICAgIC8vIHBvaW50IHRvIHRoZSBsYXN0IG5vZGUgaW4gYSBjaXJjdWxhciBsaW5rZWQgbGlzdC4gV2UgbmVlZCB0byBhcHBlbmQgdGhlCiAgICAvLyBpbnRlcmxlYXZlZCBsaXN0IHRvIHRoZSBlbmQgb2YgdGhlIHBlbmRpbmcgbGlzdCBieSBqb2luaW5nIHRoZW0gaW50byBhCiAgICAvLyBzaW5nbGUsIGNpcmN1bGFyIGxpc3QuCiAgICBpZiAoY29uY3VycmVudFF1ZXVlcyAhPT0gbnVsbCkgewogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbmN1cnJlbnRRdWV1ZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICB2YXIgcXVldWUgPSBjb25jdXJyZW50UXVldWVzW2ldOwogICAgICAgIHZhciBsYXN0SW50ZXJsZWF2ZWRVcGRhdGUgPSBxdWV1ZS5pbnRlcmxlYXZlZDsKCiAgICAgICAgaWYgKGxhc3RJbnRlcmxlYXZlZFVwZGF0ZSAhPT0gbnVsbCkgewogICAgICAgICAgcXVldWUuaW50ZXJsZWF2ZWQgPSBudWxsOwogICAgICAgICAgdmFyIGZpcnN0SW50ZXJsZWF2ZWRVcGRhdGUgPSBsYXN0SW50ZXJsZWF2ZWRVcGRhdGUubmV4dDsKICAgICAgICAgIHZhciBsYXN0UGVuZGluZ1VwZGF0ZSA9IHF1ZXVlLnBlbmRpbmc7CgogICAgICAgICAgaWYgKGxhc3RQZW5kaW5nVXBkYXRlICE9PSBudWxsKSB7CiAgICAgICAgICAgIHZhciBmaXJzdFBlbmRpbmdVcGRhdGUgPSBsYXN0UGVuZGluZ1VwZGF0ZS5uZXh0OwogICAgICAgICAgICBsYXN0UGVuZGluZ1VwZGF0ZS5uZXh0ID0gZmlyc3RJbnRlcmxlYXZlZFVwZGF0ZTsKICAgICAgICAgICAgbGFzdEludGVybGVhdmVkVXBkYXRlLm5leHQgPSBmaXJzdFBlbmRpbmdVcGRhdGU7CiAgICAgICAgICB9CgogICAgICAgICAgcXVldWUucGVuZGluZyA9IGxhc3RJbnRlcmxlYXZlZFVwZGF0ZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGNvbmN1cnJlbnRRdWV1ZXMgPSBudWxsOwogICAgfQogIH0KICBmdW5jdGlvbiBlbnF1ZXVlQ29uY3VycmVudEhvb2tVcGRhdGUoZmliZXIsIHF1ZXVlLCB1cGRhdGUsIGxhbmUpIHsKICAgIHZhciBpbnRlcmxlYXZlZCA9IHF1ZXVlLmludGVybGVhdmVkOwoKICAgIGlmIChpbnRlcmxlYXZlZCA9PT0gbnVsbCkgewogICAgICAvLyBUaGlzIGlzIHRoZSBmaXJzdCB1cGRhdGUuIENyZWF0ZSBhIGNpcmN1bGFyIGxpc3QuCiAgICAgIHVwZGF0ZS5uZXh0ID0gdXBkYXRlOyAvLyBBdCB0aGUgZW5kIG9mIHRoZSBjdXJyZW50IHJlbmRlciwgdGhpcyBxdWV1ZSdzIGludGVybGVhdmVkIHVwZGF0ZXMgd2lsbAogICAgICAvLyBiZSB0cmFuc2ZlcnJlZCB0byB0aGUgcGVuZGluZyBxdWV1ZS4KCiAgICAgIHB1c2hDb25jdXJyZW50VXBkYXRlUXVldWUocXVldWUpOwogICAgfSBlbHNlIHsKICAgICAgdXBkYXRlLm5leHQgPSBpbnRlcmxlYXZlZC5uZXh0OwogICAgICBpbnRlcmxlYXZlZC5uZXh0ID0gdXBkYXRlOwogICAgfQoKICAgIHF1ZXVlLmludGVybGVhdmVkID0gdXBkYXRlOwogICAgcmV0dXJuIG1hcmtVcGRhdGVMYW5lRnJvbUZpYmVyVG9Sb290KGZpYmVyLCBsYW5lKTsKICB9CiAgZnVuY3Rpb24gZW5xdWV1ZUNvbmN1cnJlbnRIb29rVXBkYXRlQW5kRWFnZXJseUJhaWxvdXQoZmliZXIsIHF1ZXVlLCB1cGRhdGUsIGxhbmUpIHsKICAgIHZhciBpbnRlcmxlYXZlZCA9IHF1ZXVlLmludGVybGVhdmVkOwoKICAgIGlmIChpbnRlcmxlYXZlZCA9PT0gbnVsbCkgewogICAgICAvLyBUaGlzIGlzIHRoZSBmaXJzdCB1cGRhdGUuIENyZWF0ZSBhIGNpcmN1bGFyIGxpc3QuCiAgICAgIHVwZGF0ZS5uZXh0ID0gdXBkYXRlOyAvLyBBdCB0aGUgZW5kIG9mIHRoZSBjdXJyZW50IHJlbmRlciwgdGhpcyBxdWV1ZSdzIGludGVybGVhdmVkIHVwZGF0ZXMgd2lsbAogICAgICAvLyBiZSB0cmFuc2ZlcnJlZCB0byB0aGUgcGVuZGluZyBxdWV1ZS4KCiAgICAgIHB1c2hDb25jdXJyZW50VXBkYXRlUXVldWUocXVldWUpOwogICAgfSBlbHNlIHsKICAgICAgdXBkYXRlLm5leHQgPSBpbnRlcmxlYXZlZC5uZXh0OwogICAgICBpbnRlcmxlYXZlZC5uZXh0ID0gdXBkYXRlOwogICAgfQoKICAgIHF1ZXVlLmludGVybGVhdmVkID0gdXBkYXRlOwogIH0KICBmdW5jdGlvbiBlbnF1ZXVlQ29uY3VycmVudENsYXNzVXBkYXRlKGZpYmVyLCBxdWV1ZSwgdXBkYXRlLCBsYW5lKSB7CiAgICB2YXIgaW50ZXJsZWF2ZWQgPSBxdWV1ZS5pbnRlcmxlYXZlZDsKCiAgICBpZiAoaW50ZXJsZWF2ZWQgPT09IG51bGwpIHsKICAgICAgLy8gVGhpcyBpcyB0aGUgZmlyc3QgdXBkYXRlLiBDcmVhdGUgYSBjaXJjdWxhciBsaXN0LgogICAgICB1cGRhdGUubmV4dCA9IHVwZGF0ZTsgLy8gQXQgdGhlIGVuZCBvZiB0aGUgY3VycmVudCByZW5kZXIsIHRoaXMgcXVldWUncyBpbnRlcmxlYXZlZCB1cGRhdGVzIHdpbGwKICAgICAgLy8gYmUgdHJhbnNmZXJyZWQgdG8gdGhlIHBlbmRpbmcgcXVldWUuCgogICAgICBwdXNoQ29uY3VycmVudFVwZGF0ZVF1ZXVlKHF1ZXVlKTsKICAgIH0gZWxzZSB7CiAgICAgIHVwZGF0ZS5uZXh0ID0gaW50ZXJsZWF2ZWQubmV4dDsKICAgICAgaW50ZXJsZWF2ZWQubmV4dCA9IHVwZGF0ZTsKICAgIH0KCiAgICBxdWV1ZS5pbnRlcmxlYXZlZCA9IHVwZGF0ZTsKICAgIHJldHVybiBtYXJrVXBkYXRlTGFuZUZyb21GaWJlclRvUm9vdChmaWJlciwgbGFuZSk7CiAgfQogIGZ1bmN0aW9uIGVucXVldWVDb25jdXJyZW50UmVuZGVyRm9yTGFuZShmaWJlciwgbGFuZSkgewogICAgcmV0dXJuIG1hcmtVcGRhdGVMYW5lRnJvbUZpYmVyVG9Sb290KGZpYmVyLCBsYW5lKTsKICB9IC8vIENhbGxpbmcgdGhpcyBmdW5jdGlvbiBvdXRzaWRlIHRoaXMgbW9kdWxlIHNob3VsZCBvbmx5IGJlIGRvbmUgZm9yIGJhY2t3YXJkcwogIC8vIGNvbXBhdGliaWxpdHkgYW5kIHNob3VsZCBhbHdheXMgYmUgYWNjb21wYW5pZWQgYnkgYSB3YXJuaW5nLgoKICB2YXIgdW5zYWZlX21hcmtVcGRhdGVMYW5lRnJvbUZpYmVyVG9Sb290ID0gbWFya1VwZGF0ZUxhbmVGcm9tRmliZXJUb1Jvb3Q7CgogIGZ1bmN0aW9uIG1hcmtVcGRhdGVMYW5lRnJvbUZpYmVyVG9Sb290KHNvdXJjZUZpYmVyLCBsYW5lKSB7CiAgICAvLyBVcGRhdGUgdGhlIHNvdXJjZSBmaWJlcidzIGxhbmVzCiAgICBzb3VyY2VGaWJlci5sYW5lcyA9IG1lcmdlTGFuZXMoc291cmNlRmliZXIubGFuZXMsIGxhbmUpOwogICAgdmFyIGFsdGVybmF0ZSA9IHNvdXJjZUZpYmVyLmFsdGVybmF0ZTsKCiAgICBpZiAoYWx0ZXJuYXRlICE9PSBudWxsKSB7CiAgICAgIGFsdGVybmF0ZS5sYW5lcyA9IG1lcmdlTGFuZXMoYWx0ZXJuYXRlLmxhbmVzLCBsYW5lKTsKICAgIH0KCiAgICB7CiAgICAgIGlmIChhbHRlcm5hdGUgPT09IG51bGwgJiYgKHNvdXJjZUZpYmVyLmZsYWdzICYgKFBsYWNlbWVudCB8IEh5ZHJhdGluZykpICE9PSBOb0ZsYWdzKSB7CiAgICAgICAgd2FybkFib3V0VXBkYXRlT25Ob3RZZXRNb3VudGVkRmliZXJJbkRFVihzb3VyY2VGaWJlcik7CiAgICAgIH0KICAgIH0gLy8gV2FsayB0aGUgcGFyZW50IHBhdGggdG8gdGhlIHJvb3QgYW5kIHVwZGF0ZSB0aGUgY2hpbGQgbGFuZXMuCgoKICAgIHZhciBub2RlID0gc291cmNlRmliZXI7CiAgICB2YXIgcGFyZW50ID0gc291cmNlRmliZXIucmV0dXJuOwoKICAgIHdoaWxlIChwYXJlbnQgIT09IG51bGwpIHsKICAgICAgcGFyZW50LmNoaWxkTGFuZXMgPSBtZXJnZUxhbmVzKHBhcmVudC5jaGlsZExhbmVzLCBsYW5lKTsKICAgICAgYWx0ZXJuYXRlID0gcGFyZW50LmFsdGVybmF0ZTsKCiAgICAgIGlmIChhbHRlcm5hdGUgIT09IG51bGwpIHsKICAgICAgICBhbHRlcm5hdGUuY2hpbGRMYW5lcyA9IG1lcmdlTGFuZXMoYWx0ZXJuYXRlLmNoaWxkTGFuZXMsIGxhbmUpOwogICAgICB9IGVsc2UgewogICAgICAgIHsKICAgICAgICAgIGlmICgocGFyZW50LmZsYWdzICYgKFBsYWNlbWVudCB8IEh5ZHJhdGluZykpICE9PSBOb0ZsYWdzKSB7CiAgICAgICAgICAgIHdhcm5BYm91dFVwZGF0ZU9uTm90WWV0TW91bnRlZEZpYmVySW5ERVYoc291cmNlRmliZXIpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgbm9kZSA9IHBhcmVudDsKICAgICAgcGFyZW50ID0gcGFyZW50LnJldHVybjsKICAgIH0KCiAgICBpZiAobm9kZS50YWcgPT09IEhvc3RSb290KSB7CiAgICAgIHZhciByb290ID0gbm9kZS5zdGF0ZU5vZGU7CiAgICAgIHJldHVybiByb290OwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgfQoKICB2YXIgVXBkYXRlU3RhdGUgPSAwOwogIHZhciBSZXBsYWNlU3RhdGUgPSAxOwogIHZhciBGb3JjZVVwZGF0ZSA9IDI7CiAgdmFyIENhcHR1cmVVcGRhdGUgPSAzOyAvLyBHbG9iYWwgc3RhdGUgdGhhdCBpcyByZXNldCBhdCB0aGUgYmVnaW5uaW5nIG9mIGNhbGxpbmcgYHByb2Nlc3NVcGRhdGVRdWV1ZWAuCiAgLy8gSXQgc2hvdWxkIG9ubHkgYmUgcmVhZCByaWdodCBhZnRlciBjYWxsaW5nIGBwcm9jZXNzVXBkYXRlUXVldWVgLCB2aWEKICAvLyBgY2hlY2tIYXNGb3JjZVVwZGF0ZUFmdGVyUHJvY2Vzc2luZ2AuCgogIHZhciBoYXNGb3JjZVVwZGF0ZSA9IGZhbHNlOwogIHZhciBkaWRXYXJuVXBkYXRlSW5zaWRlVXBkYXRlOwogIHZhciBjdXJyZW50bHlQcm9jZXNzaW5nUXVldWU7CgogIHsKICAgIGRpZFdhcm5VcGRhdGVJbnNpZGVVcGRhdGUgPSBmYWxzZTsKICAgIGN1cnJlbnRseVByb2Nlc3NpbmdRdWV1ZSA9IG51bGw7CiAgfQoKICBmdW5jdGlvbiBpbml0aWFsaXplVXBkYXRlUXVldWUoZmliZXIpIHsKICAgIHZhciBxdWV1ZSA9IHsKICAgICAgYmFzZVN0YXRlOiBmaWJlci5tZW1vaXplZFN0YXRlLAogICAgICBmaXJzdEJhc2VVcGRhdGU6IG51bGwsCiAgICAgIGxhc3RCYXNlVXBkYXRlOiBudWxsLAogICAgICBzaGFyZWQ6IHsKICAgICAgICBwZW5kaW5nOiBudWxsLAogICAgICAgIGludGVybGVhdmVkOiBudWxsLAogICAgICAgIGxhbmVzOiBOb0xhbmVzCiAgICAgIH0sCiAgICAgIGVmZmVjdHM6IG51bGwKICAgIH07CiAgICBmaWJlci51cGRhdGVRdWV1ZSA9IHF1ZXVlOwogIH0KICBmdW5jdGlvbiBjbG9uZVVwZGF0ZVF1ZXVlKGN1cnJlbnQsIHdvcmtJblByb2dyZXNzKSB7CiAgICAvLyBDbG9uZSB0aGUgdXBkYXRlIHF1ZXVlIGZyb20gY3VycmVudC4gVW5sZXNzIGl0J3MgYWxyZWFkeSBhIGNsb25lLgogICAgdmFyIHF1ZXVlID0gd29ya0luUHJvZ3Jlc3MudXBkYXRlUXVldWU7CiAgICB2YXIgY3VycmVudFF1ZXVlID0gY3VycmVudC51cGRhdGVRdWV1ZTsKCiAgICBpZiAocXVldWUgPT09IGN1cnJlbnRRdWV1ZSkgewogICAgICB2YXIgY2xvbmUgPSB7CiAgICAgICAgYmFzZVN0YXRlOiBjdXJyZW50UXVldWUuYmFzZVN0YXRlLAogICAgICAgIGZpcnN0QmFzZVVwZGF0ZTogY3VycmVudFF1ZXVlLmZpcnN0QmFzZVVwZGF0ZSwKICAgICAgICBsYXN0QmFzZVVwZGF0ZTogY3VycmVudFF1ZXVlLmxhc3RCYXNlVXBkYXRlLAogICAgICAgIHNoYXJlZDogY3VycmVudFF1ZXVlLnNoYXJlZCwKICAgICAgICBlZmZlY3RzOiBjdXJyZW50UXVldWUuZWZmZWN0cwogICAgICB9OwogICAgICB3b3JrSW5Qcm9ncmVzcy51cGRhdGVRdWV1ZSA9IGNsb25lOwogICAgfQogIH0KICBmdW5jdGlvbiBjcmVhdGVVcGRhdGUoZXZlbnRUaW1lLCBsYW5lKSB7CiAgICB2YXIgdXBkYXRlID0gewogICAgICBldmVudFRpbWU6IGV2ZW50VGltZSwKICAgICAgbGFuZTogbGFuZSwKICAgICAgdGFnOiBVcGRhdGVTdGF0ZSwKICAgICAgcGF5bG9hZDogbnVsbCwKICAgICAgY2FsbGJhY2s6IG51bGwsCiAgICAgIG5leHQ6IG51bGwKICAgIH07CiAgICByZXR1cm4gdXBkYXRlOwogIH0KICBmdW5jdGlvbiBlbnF1ZXVlVXBkYXRlKGZpYmVyLCB1cGRhdGUsIGxhbmUpIHsKICAgIHZhciB1cGRhdGVRdWV1ZSA9IGZpYmVyLnVwZGF0ZVF1ZXVlOwoKICAgIGlmICh1cGRhdGVRdWV1ZSA9PT0gbnVsbCkgewogICAgICAvLyBPbmx5IG9jY3VycyBpZiB0aGUgZmliZXIgaGFzIGJlZW4gdW5tb3VudGVkLgogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICB2YXIgc2hhcmVkUXVldWUgPSB1cGRhdGVRdWV1ZS5zaGFyZWQ7CgogICAgewogICAgICBpZiAoY3VycmVudGx5UHJvY2Vzc2luZ1F1ZXVlID09PSBzaGFyZWRRdWV1ZSAmJiAhZGlkV2FyblVwZGF0ZUluc2lkZVVwZGF0ZSkgewogICAgICAgIGVycm9yKCdBbiB1cGRhdGUgKHNldFN0YXRlLCByZXBsYWNlU3RhdGUsIG9yIGZvcmNlVXBkYXRlKSB3YXMgc2NoZWR1bGVkICcgKyAnZnJvbSBpbnNpZGUgYW4gdXBkYXRlIGZ1bmN0aW9uLiBVcGRhdGUgZnVuY3Rpb25zIHNob3VsZCBiZSBwdXJlLCAnICsgJ3dpdGggemVybyBzaWRlLWVmZmVjdHMuIENvbnNpZGVyIHVzaW5nIGNvbXBvbmVudERpZFVwZGF0ZSBvciBhICcgKyAnY2FsbGJhY2suJyk7CgogICAgICAgIGRpZFdhcm5VcGRhdGVJbnNpZGVVcGRhdGUgPSB0cnVlOwogICAgICB9CiAgICB9CgogICAgaWYgKGlzVW5zYWZlQ2xhc3NSZW5kZXJQaGFzZVVwZGF0ZSgpKSB7CiAgICAgIC8vIFRoaXMgaXMgYW4gdW5zYWZlIHJlbmRlciBwaGFzZSB1cGRhdGUuIEFkZCBkaXJlY3RseSB0byB0aGUgdXBkYXRlCiAgICAgIC8vIHF1ZXVlIHNvIHdlIGNhbiBwcm9jZXNzIGl0IGltbWVkaWF0ZWx5IGR1cmluZyB0aGUgY3VycmVudCByZW5kZXIuCiAgICAgIHZhciBwZW5kaW5nID0gc2hhcmVkUXVldWUucGVuZGluZzsKCiAgICAgIGlmIChwZW5kaW5nID09PSBudWxsKSB7CiAgICAgICAgLy8gVGhpcyBpcyB0aGUgZmlyc3QgdXBkYXRlLiBDcmVhdGUgYSBjaXJjdWxhciBsaXN0LgogICAgICAgIHVwZGF0ZS5uZXh0ID0gdXBkYXRlOwogICAgICB9IGVsc2UgewogICAgICAgIHVwZGF0ZS5uZXh0ID0gcGVuZGluZy5uZXh0OwogICAgICAgIHBlbmRpbmcubmV4dCA9IHVwZGF0ZTsKICAgICAgfQoKICAgICAgc2hhcmVkUXVldWUucGVuZGluZyA9IHVwZGF0ZTsgLy8gVXBkYXRlIHRoZSBjaGlsZExhbmVzIGV2ZW4gdGhvdWdoIHdlJ3JlIG1vc3QgbGlrZWx5IGFscmVhZHkgcmVuZGVyaW5nCiAgICAgIC8vIHRoaXMgZmliZXIuIFRoaXMgaXMgZm9yIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5IGluIHRoZSBjYXNlIHdoZXJlIHlvdQogICAgICAvLyB1cGRhdGUgYSBkaWZmZXJlbnQgY29tcG9uZW50IGR1cmluZyByZW5kZXIgcGhhc2UgdGhhbiB0aGUgb25lIHRoYXQgaXMKICAgICAgLy8gY3VycmVudGx5IHJlbmRlcmluZ3MgKGEgcGF0dGVybiB0aGF0IGlzIGFjY29tcGFuaWVkIGJ5IGEgd2FybmluZykuCgogICAgICByZXR1cm4gdW5zYWZlX21hcmtVcGRhdGVMYW5lRnJvbUZpYmVyVG9Sb290KGZpYmVyLCBsYW5lKTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBlbnF1ZXVlQ29uY3VycmVudENsYXNzVXBkYXRlKGZpYmVyLCBzaGFyZWRRdWV1ZSwgdXBkYXRlLCBsYW5lKTsKICAgIH0KICB9CiAgZnVuY3Rpb24gZW50YW5nbGVUcmFuc2l0aW9ucyhyb290LCBmaWJlciwgbGFuZSkgewogICAgdmFyIHVwZGF0ZVF1ZXVlID0gZmliZXIudXBkYXRlUXVldWU7CgogICAgaWYgKHVwZGF0ZVF1ZXVlID09PSBudWxsKSB7CiAgICAgIC8vIE9ubHkgb2NjdXJzIGlmIHRoZSBmaWJlciBoYXMgYmVlbiB1bm1vdW50ZWQuCiAgICAgIHJldHVybjsKICAgIH0KCiAgICB2YXIgc2hhcmVkUXVldWUgPSB1cGRhdGVRdWV1ZS5zaGFyZWQ7CgogICAgaWYgKGlzVHJhbnNpdGlvbkxhbmUobGFuZSkpIHsKICAgICAgdmFyIHF1ZXVlTGFuZXMgPSBzaGFyZWRRdWV1ZS5sYW5lczsgLy8gSWYgYW55IGVudGFuZ2xlZCBsYW5lcyBhcmUgbm8gbG9uZ2VyIHBlbmRpbmcgb24gdGhlIHJvb3QsIHRoZW4gdGhleSBtdXN0CiAgICAgIC8vIGhhdmUgZmluaXNoZWQuIFdlIGNhbiByZW1vdmUgdGhlbSBmcm9tIHRoZSBzaGFyZWQgcXVldWUsIHdoaWNoIHJlcHJlc2VudHMKICAgICAgLy8gYSBzdXBlcnNldCBvZiB0aGUgYWN0dWFsbHkgcGVuZGluZyBsYW5lcy4gSW4gc29tZSBjYXNlcyB3ZSBtYXkgZW50YW5nbGUKICAgICAgLy8gbW9yZSB0aGFuIHdlIG5lZWQgdG8sIGJ1dCB0aGF0J3MgT0suIEluIGZhY3QgaXQncyB3b3JzZSBpZiB3ZSAqZG9uJ3QqCiAgICAgIC8vIGVudGFuZ2xlIHdoZW4gd2Ugc2hvdWxkLgoKICAgICAgcXVldWVMYW5lcyA9IGludGVyc2VjdExhbmVzKHF1ZXVlTGFuZXMsIHJvb3QucGVuZGluZ0xhbmVzKTsgLy8gRW50YW5nbGUgdGhlIG5ldyB0cmFuc2l0aW9uIGxhbmUgd2l0aCB0aGUgb3RoZXIgdHJhbnNpdGlvbiBsYW5lcy4KCiAgICAgIHZhciBuZXdRdWV1ZUxhbmVzID0gbWVyZ2VMYW5lcyhxdWV1ZUxhbmVzLCBsYW5lKTsKICAgICAgc2hhcmVkUXVldWUubGFuZXMgPSBuZXdRdWV1ZUxhbmVzOyAvLyBFdmVuIGlmIHF1ZXVlLmxhbmVzIGFscmVhZHkgaW5jbHVkZSBsYW5lLCB3ZSBkb24ndCBrbm93IGZvciBjZXJ0YWluIGlmCiAgICAgIC8vIHRoZSBsYW5lIGZpbmlzaGVkIHNpbmNlIHRoZSBsYXN0IHRpbWUgd2UgZW50YW5nbGVkIGl0LiBTbyB3ZSBuZWVkIHRvCiAgICAgIC8vIGVudGFuZ2xlIGl0IGFnYWluLCBqdXN0IHRvIGJlIHN1cmUuCgogICAgICBtYXJrUm9vdEVudGFuZ2xlZChyb290LCBuZXdRdWV1ZUxhbmVzKTsKICAgIH0KICB9CiAgZnVuY3Rpb24gZW5xdWV1ZUNhcHR1cmVkVXBkYXRlKHdvcmtJblByb2dyZXNzLCBjYXB0dXJlZFVwZGF0ZSkgewogICAgLy8gQ2FwdHVyZWQgdXBkYXRlcyBhcmUgdXBkYXRlcyB0aGF0IGFyZSB0aHJvd24gYnkgYSBjaGlsZCBkdXJpbmcgdGhlIHJlbmRlcgogICAgLy8gcGhhc2UuIFRoZXkgc2hvdWxkIGJlIGRpc2NhcmRlZCBpZiB0aGUgcmVuZGVyIGlzIGFib3J0ZWQuIFRoZXJlZm9yZSwKICAgIC8vIHdlIHNob3VsZCBvbmx5IHB1dCB0aGVtIG9uIHRoZSB3b3JrLWluLXByb2dyZXNzIHF1ZXVlLCBub3QgdGhlIGN1cnJlbnQgb25lLgogICAgdmFyIHF1ZXVlID0gd29ya0luUHJvZ3Jlc3MudXBkYXRlUXVldWU7IC8vIENoZWNrIGlmIHRoZSB3b3JrLWluLXByb2dyZXNzIHF1ZXVlIGlzIGEgY2xvbmUuCgogICAgdmFyIGN1cnJlbnQgPSB3b3JrSW5Qcm9ncmVzcy5hbHRlcm5hdGU7CgogICAgaWYgKGN1cnJlbnQgIT09IG51bGwpIHsKICAgICAgdmFyIGN1cnJlbnRRdWV1ZSA9IGN1cnJlbnQudXBkYXRlUXVldWU7CgogICAgICBpZiAocXVldWUgPT09IGN1cnJlbnRRdWV1ZSkgewogICAgICAgIC8vIFRoZSB3b3JrLWluLXByb2dyZXNzIHF1ZXVlIGlzIHRoZSBzYW1lIGFzIGN1cnJlbnQuIFRoaXMgaGFwcGVucyB3aGVuCiAgICAgICAgLy8gd2UgYmFpbCBvdXQgb24gYSBwYXJlbnQgZmliZXIgdGhhdCB0aGVuIGNhcHR1cmVzIGFuIGVycm9yIHRocm93biBieQogICAgICAgIC8vIGEgY2hpbGQuIFNpbmNlIHdlIHdhbnQgdG8gYXBwZW5kIHRoZSB1cGRhdGUgb25seSB0byB0aGUgd29yay1pbgogICAgICAgIC8vIC1wcm9ncmVzcyBxdWV1ZSwgd2UgbmVlZCB0byBjbG9uZSB0aGUgdXBkYXRlcy4gV2UgdXN1YWxseSBjbG9uZSBkdXJpbmcKICAgICAgICAvLyBwcm9jZXNzVXBkYXRlUXVldWUsIGJ1dCB0aGF0IGRpZG4ndCBoYXBwZW4gaW4gdGhpcyBjYXNlIGJlY2F1c2Ugd2UKICAgICAgICAvLyBza2lwcGVkIG92ZXIgdGhlIHBhcmVudCB3aGVuIHdlIGJhaWxlZCBvdXQuCiAgICAgICAgdmFyIG5ld0ZpcnN0ID0gbnVsbDsKICAgICAgICB2YXIgbmV3TGFzdCA9IG51bGw7CiAgICAgICAgdmFyIGZpcnN0QmFzZVVwZGF0ZSA9IHF1ZXVlLmZpcnN0QmFzZVVwZGF0ZTsKCiAgICAgICAgaWYgKGZpcnN0QmFzZVVwZGF0ZSAhPT0gbnVsbCkgewogICAgICAgICAgLy8gTG9vcCB0aHJvdWdoIHRoZSB1cGRhdGVzIGFuZCBjbG9uZSB0aGVtLgogICAgICAgICAgdmFyIHVwZGF0ZSA9IGZpcnN0QmFzZVVwZGF0ZTsKCiAgICAgICAgICBkbyB7CiAgICAgICAgICAgIHZhciBjbG9uZSA9IHsKICAgICAgICAgICAgICBldmVudFRpbWU6IHVwZGF0ZS5ldmVudFRpbWUsCiAgICAgICAgICAgICAgbGFuZTogdXBkYXRlLmxhbmUsCiAgICAgICAgICAgICAgdGFnOiB1cGRhdGUudGFnLAogICAgICAgICAgICAgIHBheWxvYWQ6IHVwZGF0ZS5wYXlsb2FkLAogICAgICAgICAgICAgIGNhbGxiYWNrOiB1cGRhdGUuY2FsbGJhY2ssCiAgICAgICAgICAgICAgbmV4dDogbnVsbAogICAgICAgICAgICB9OwoKICAgICAgICAgICAgaWYgKG5ld0xhc3QgPT09IG51bGwpIHsKICAgICAgICAgICAgICBuZXdGaXJzdCA9IG5ld0xhc3QgPSBjbG9uZTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBuZXdMYXN0Lm5leHQgPSBjbG9uZTsKICAgICAgICAgICAgICBuZXdMYXN0ID0gY2xvbmU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHVwZGF0ZSA9IHVwZGF0ZS5uZXh0OwogICAgICAgICAgfSB3aGlsZSAodXBkYXRlICE9PSBudWxsKTsgLy8gQXBwZW5kIHRoZSBjYXB0dXJlZCB1cGRhdGUgdGhlIGVuZCBvZiB0aGUgY2xvbmVkIGxpc3QuCgoKICAgICAgICAgIGlmIChuZXdMYXN0ID09PSBudWxsKSB7CiAgICAgICAgICAgIG5ld0ZpcnN0ID0gbmV3TGFzdCA9IGNhcHR1cmVkVXBkYXRlOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbmV3TGFzdC5uZXh0ID0gY2FwdHVyZWRVcGRhdGU7CiAgICAgICAgICAgIG5ld0xhc3QgPSBjYXB0dXJlZFVwZGF0ZTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy8gVGhlcmUgYXJlIG5vIGJhc2UgdXBkYXRlcy4KICAgICAgICAgIG5ld0ZpcnN0ID0gbmV3TGFzdCA9IGNhcHR1cmVkVXBkYXRlOwogICAgICAgIH0KCiAgICAgICAgcXVldWUgPSB7CiAgICAgICAgICBiYXNlU3RhdGU6IGN1cnJlbnRRdWV1ZS5iYXNlU3RhdGUsCiAgICAgICAgICBmaXJzdEJhc2VVcGRhdGU6IG5ld0ZpcnN0LAogICAgICAgICAgbGFzdEJhc2VVcGRhdGU6IG5ld0xhc3QsCiAgICAgICAgICBzaGFyZWQ6IGN1cnJlbnRRdWV1ZS5zaGFyZWQsCiAgICAgICAgICBlZmZlY3RzOiBjdXJyZW50UXVldWUuZWZmZWN0cwogICAgICAgIH07CiAgICAgICAgd29ya0luUHJvZ3Jlc3MudXBkYXRlUXVldWUgPSBxdWV1ZTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgIH0gLy8gQXBwZW5kIHRoZSB1cGRhdGUgdG8gdGhlIGVuZCBvZiB0aGUgbGlzdC4KCgogICAgdmFyIGxhc3RCYXNlVXBkYXRlID0gcXVldWUubGFzdEJhc2VVcGRhdGU7CgogICAgaWYgKGxhc3RCYXNlVXBkYXRlID09PSBudWxsKSB7CiAgICAgIHF1ZXVlLmZpcnN0QmFzZVVwZGF0ZSA9IGNhcHR1cmVkVXBkYXRlOwogICAgfSBlbHNlIHsKICAgICAgbGFzdEJhc2VVcGRhdGUubmV4dCA9IGNhcHR1cmVkVXBkYXRlOwogICAgfQoKICAgIHF1ZXVlLmxhc3RCYXNlVXBkYXRlID0gY2FwdHVyZWRVcGRhdGU7CiAgfQoKICBmdW5jdGlvbiBnZXRTdGF0ZUZyb21VcGRhdGUod29ya0luUHJvZ3Jlc3MsIHF1ZXVlLCB1cGRhdGUsIHByZXZTdGF0ZSwgbmV4dFByb3BzLCBpbnN0YW5jZSkgewogICAgc3dpdGNoICh1cGRhdGUudGFnKSB7CiAgICAgIGNhc2UgUmVwbGFjZVN0YXRlOgogICAgICAgIHsKICAgICAgICAgIHZhciBwYXlsb2FkID0gdXBkYXRlLnBheWxvYWQ7CgogICAgICAgICAgaWYgKHR5cGVvZiBwYXlsb2FkID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAgIC8vIFVwZGF0ZXIgZnVuY3Rpb24KICAgICAgICAgICAgewogICAgICAgICAgICAgIGVudGVyRGlzYWxsb3dlZENvbnRleHRSZWFkSW5ERVYoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmFyIG5leHRTdGF0ZSA9IHBheWxvYWQuY2FsbChpbnN0YW5jZSwgcHJldlN0YXRlLCBuZXh0UHJvcHMpOwoKICAgICAgICAgICAgewogICAgICAgICAgICAgIGlmICggd29ya0luUHJvZ3Jlc3MubW9kZSAmIFN0cmljdExlZ2FjeU1vZGUpIHsKICAgICAgICAgICAgICAgIHNldElzU3RyaWN0TW9kZUZvckRldnRvb2xzKHRydWUpOwoKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgIHBheWxvYWQuY2FsbChpbnN0YW5jZSwgcHJldlN0YXRlLCBuZXh0UHJvcHMpOwogICAgICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgICAgc2V0SXNTdHJpY3RNb2RlRm9yRGV2dG9vbHMoZmFsc2UpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgZXhpdERpc2FsbG93ZWRDb250ZXh0UmVhZEluREVWKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiBuZXh0U3RhdGU7CiAgICAgICAgICB9IC8vIFN0YXRlIG9iamVjdAoKCiAgICAgICAgICByZXR1cm4gcGF5bG9hZDsKICAgICAgICB9CgogICAgICBjYXNlIENhcHR1cmVVcGRhdGU6CiAgICAgICAgewogICAgICAgICAgd29ya0luUHJvZ3Jlc3MuZmxhZ3MgPSB3b3JrSW5Qcm9ncmVzcy5mbGFncyAmIH5TaG91bGRDYXB0dXJlIHwgRGlkQ2FwdHVyZTsKICAgICAgICB9CiAgICAgIC8vIEludGVudGlvbmFsIGZhbGx0aHJvdWdoCgogICAgICBjYXNlIFVwZGF0ZVN0YXRlOgogICAgICAgIHsKICAgICAgICAgIHZhciBfcGF5bG9hZCA9IHVwZGF0ZS5wYXlsb2FkOwogICAgICAgICAgdmFyIHBhcnRpYWxTdGF0ZTsKCiAgICAgICAgICBpZiAodHlwZW9mIF9wYXlsb2FkID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAgIC8vIFVwZGF0ZXIgZnVuY3Rpb24KICAgICAgICAgICAgewogICAgICAgICAgICAgIGVudGVyRGlzYWxsb3dlZENvbnRleHRSZWFkSW5ERVYoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcGFydGlhbFN0YXRlID0gX3BheWxvYWQuY2FsbChpbnN0YW5jZSwgcHJldlN0YXRlLCBuZXh0UHJvcHMpOwoKICAgICAgICAgICAgewogICAgICAgICAgICAgIGlmICggd29ya0luUHJvZ3Jlc3MubW9kZSAmIFN0cmljdExlZ2FjeU1vZGUpIHsKICAgICAgICAgICAgICAgIHNldElzU3RyaWN0TW9kZUZvckRldnRvb2xzKHRydWUpOwoKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgIF9wYXlsb2FkLmNhbGwoaW5zdGFuY2UsIHByZXZTdGF0ZSwgbmV4dFByb3BzKTsKICAgICAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICAgIHNldElzU3RyaWN0TW9kZUZvckRldnRvb2xzKGZhbHNlKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGV4aXREaXNhbGxvd2VkQ29udGV4dFJlYWRJbkRFVigpOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyBQYXJ0aWFsIHN0YXRlIG9iamVjdAogICAgICAgICAgICBwYXJ0aWFsU3RhdGUgPSBfcGF5bG9hZDsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAocGFydGlhbFN0YXRlID09PSBudWxsIHx8IHBhcnRpYWxTdGF0ZSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIC8vIE51bGwgYW5kIHVuZGVmaW5lZCBhcmUgdHJlYXRlZCBhcyBuby1vcHMuCiAgICAgICAgICAgIHJldHVybiBwcmV2U3RhdGU7CiAgICAgICAgICB9IC8vIE1lcmdlIHRoZSBwYXJ0aWFsIHN0YXRlIGFuZCB0aGUgcHJldmlvdXMgc3RhdGUuCgoKICAgICAgICAgIHJldHVybiBhc3NpZ24oe30sIHByZXZTdGF0ZSwgcGFydGlhbFN0YXRlKTsKICAgICAgICB9CgogICAgICBjYXNlIEZvcmNlVXBkYXRlOgogICAgICAgIHsKICAgICAgICAgIGhhc0ZvcmNlVXBkYXRlID0gdHJ1ZTsKICAgICAgICAgIHJldHVybiBwcmV2U3RhdGU7CiAgICAgICAgfQogICAgfQoKICAgIHJldHVybiBwcmV2U3RhdGU7CiAgfQoKICBmdW5jdGlvbiBwcm9jZXNzVXBkYXRlUXVldWUod29ya0luUHJvZ3Jlc3MsIHByb3BzLCBpbnN0YW5jZSwgcmVuZGVyTGFuZXMpIHsKICAgIC8vIFRoaXMgaXMgYWx3YXlzIG5vbi1udWxsIG9uIGEgQ2xhc3NDb21wb25lbnQgb3IgSG9zdFJvb3QKICAgIHZhciBxdWV1ZSA9IHdvcmtJblByb2dyZXNzLnVwZGF0ZVF1ZXVlOwogICAgaGFzRm9yY2VVcGRhdGUgPSBmYWxzZTsKCiAgICB7CiAgICAgIGN1cnJlbnRseVByb2Nlc3NpbmdRdWV1ZSA9IHF1ZXVlLnNoYXJlZDsKICAgIH0KCiAgICB2YXIgZmlyc3RCYXNlVXBkYXRlID0gcXVldWUuZmlyc3RCYXNlVXBkYXRlOwogICAgdmFyIGxhc3RCYXNlVXBkYXRlID0gcXVldWUubGFzdEJhc2VVcGRhdGU7IC8vIENoZWNrIGlmIHRoZXJlIGFyZSBwZW5kaW5nIHVwZGF0ZXMuIElmIHNvLCB0cmFuc2ZlciB0aGVtIHRvIHRoZSBiYXNlIHF1ZXVlLgoKICAgIHZhciBwZW5kaW5nUXVldWUgPSBxdWV1ZS5zaGFyZWQucGVuZGluZzsKCiAgICBpZiAocGVuZGluZ1F1ZXVlICE9PSBudWxsKSB7CiAgICAgIHF1ZXVlLnNoYXJlZC5wZW5kaW5nID0gbnVsbDsgLy8gVGhlIHBlbmRpbmcgcXVldWUgaXMgY2lyY3VsYXIuIERpc2Nvbm5lY3QgdGhlIHBvaW50ZXIgYmV0d2VlbiBmaXJzdAogICAgICAvLyBhbmQgbGFzdCBzbyB0aGF0IGl0J3Mgbm9uLWNpcmN1bGFyLgoKICAgICAgdmFyIGxhc3RQZW5kaW5nVXBkYXRlID0gcGVuZGluZ1F1ZXVlOwogICAgICB2YXIgZmlyc3RQZW5kaW5nVXBkYXRlID0gbGFzdFBlbmRpbmdVcGRhdGUubmV4dDsKICAgICAgbGFzdFBlbmRpbmdVcGRhdGUubmV4dCA9IG51bGw7IC8vIEFwcGVuZCBwZW5kaW5nIHVwZGF0ZXMgdG8gYmFzZSBxdWV1ZQoKICAgICAgaWYgKGxhc3RCYXNlVXBkYXRlID09PSBudWxsKSB7CiAgICAgICAgZmlyc3RCYXNlVXBkYXRlID0gZmlyc3RQZW5kaW5nVXBkYXRlOwogICAgICB9IGVsc2UgewogICAgICAgIGxhc3RCYXNlVXBkYXRlLm5leHQgPSBmaXJzdFBlbmRpbmdVcGRhdGU7CiAgICAgIH0KCiAgICAgIGxhc3RCYXNlVXBkYXRlID0gbGFzdFBlbmRpbmdVcGRhdGU7IC8vIElmIHRoZXJlJ3MgYSBjdXJyZW50IHF1ZXVlLCBhbmQgaXQncyBkaWZmZXJlbnQgZnJvbSB0aGUgYmFzZSBxdWV1ZSwgdGhlbgogICAgICAvLyB3ZSBuZWVkIHRvIHRyYW5zZmVyIHRoZSB1cGRhdGVzIHRvIHRoYXQgcXVldWUsIHRvby4gQmVjYXVzZSB0aGUgYmFzZQogICAgICAvLyBxdWV1ZSBpcyBhIHNpbmdseS1saW5rZWQgbGlzdCB3aXRoIG5vIGN5Y2xlcywgd2UgY2FuIGFwcGVuZCB0byBib3RoCiAgICAgIC8vIGxpc3RzIGFuZCB0YWtlIGFkdmFudGFnZSBvZiBzdHJ1Y3R1cmFsIHNoYXJpbmcuCiAgICAgIC8vIFRPRE86IFBhc3MgYGN1cnJlbnRgIGFzIGFyZ3VtZW50CgogICAgICB2YXIgY3VycmVudCA9IHdvcmtJblByb2dyZXNzLmFsdGVybmF0ZTsKCiAgICAgIGlmIChjdXJyZW50ICE9PSBudWxsKSB7CiAgICAgICAgLy8gVGhpcyBpcyBhbHdheXMgbm9uLW51bGwgb24gYSBDbGFzc0NvbXBvbmVudCBvciBIb3N0Um9vdAogICAgICAgIHZhciBjdXJyZW50UXVldWUgPSBjdXJyZW50LnVwZGF0ZVF1ZXVlOwogICAgICAgIHZhciBjdXJyZW50TGFzdEJhc2VVcGRhdGUgPSBjdXJyZW50UXVldWUubGFzdEJhc2VVcGRhdGU7CgogICAgICAgIGlmIChjdXJyZW50TGFzdEJhc2VVcGRhdGUgIT09IGxhc3RCYXNlVXBkYXRlKSB7CiAgICAgICAgICBpZiAoY3VycmVudExhc3RCYXNlVXBkYXRlID09PSBudWxsKSB7CiAgICAgICAgICAgIGN1cnJlbnRRdWV1ZS5maXJzdEJhc2VVcGRhdGUgPSBmaXJzdFBlbmRpbmdVcGRhdGU7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjdXJyZW50TGFzdEJhc2VVcGRhdGUubmV4dCA9IGZpcnN0UGVuZGluZ1VwZGF0ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBjdXJyZW50UXVldWUubGFzdEJhc2VVcGRhdGUgPSBsYXN0UGVuZGluZ1VwZGF0ZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gLy8gVGhlc2UgdmFsdWVzIG1heSBjaGFuZ2UgYXMgd2UgcHJvY2VzcyB0aGUgcXVldWUuCgoKICAgIGlmIChmaXJzdEJhc2VVcGRhdGUgIT09IG51bGwpIHsKICAgICAgLy8gSXRlcmF0ZSB0aHJvdWdoIHRoZSBsaXN0IG9mIHVwZGF0ZXMgdG8gY29tcHV0ZSB0aGUgcmVzdWx0LgogICAgICB2YXIgbmV3U3RhdGUgPSBxdWV1ZS5iYXNlU3RhdGU7IC8vIFRPRE86IERvbid0IG5lZWQgdG8gYWNjdW11bGF0ZSB0aGlzLiBJbnN0ZWFkLCB3ZSBjYW4gcmVtb3ZlIHJlbmRlckxhbmVzCiAgICAgIC8vIGZyb20gdGhlIG9yaWdpbmFsIGxhbmVzLgoKICAgICAgdmFyIG5ld0xhbmVzID0gTm9MYW5lczsKICAgICAgdmFyIG5ld0Jhc2VTdGF0ZSA9IG51bGw7CiAgICAgIHZhciBuZXdGaXJzdEJhc2VVcGRhdGUgPSBudWxsOwogICAgICB2YXIgbmV3TGFzdEJhc2VVcGRhdGUgPSBudWxsOwogICAgICB2YXIgdXBkYXRlID0gZmlyc3RCYXNlVXBkYXRlOwoKICAgICAgZG8gewogICAgICAgIHZhciB1cGRhdGVMYW5lID0gdXBkYXRlLmxhbmU7CiAgICAgICAgdmFyIHVwZGF0ZUV2ZW50VGltZSA9IHVwZGF0ZS5ldmVudFRpbWU7CgogICAgICAgIGlmICghaXNTdWJzZXRPZkxhbmVzKHJlbmRlckxhbmVzLCB1cGRhdGVMYW5lKSkgewogICAgICAgICAgLy8gUHJpb3JpdHkgaXMgaW5zdWZmaWNpZW50LiBTa2lwIHRoaXMgdXBkYXRlLiBJZiB0aGlzIGlzIHRoZSBmaXJzdAogICAgICAgICAgLy8gc2tpcHBlZCB1cGRhdGUsIHRoZSBwcmV2aW91cyB1cGRhdGUvc3RhdGUgaXMgdGhlIG5ldyBiYXNlCiAgICAgICAgICAvLyB1cGRhdGUvc3RhdGUuCiAgICAgICAgICB2YXIgY2xvbmUgPSB7CiAgICAgICAgICAgIGV2ZW50VGltZTogdXBkYXRlRXZlbnRUaW1lLAogICAgICAgICAgICBsYW5lOiB1cGRhdGVMYW5lLAogICAgICAgICAgICB0YWc6IHVwZGF0ZS50YWcsCiAgICAgICAgICAgIHBheWxvYWQ6IHVwZGF0ZS5wYXlsb2FkLAogICAgICAgICAgICBjYWxsYmFjazogdXBkYXRlLmNhbGxiYWNrLAogICAgICAgICAgICBuZXh0OiBudWxsCiAgICAgICAgICB9OwoKICAgICAgICAgIGlmIChuZXdMYXN0QmFzZVVwZGF0ZSA9PT0gbnVsbCkgewogICAgICAgICAgICBuZXdGaXJzdEJhc2VVcGRhdGUgPSBuZXdMYXN0QmFzZVVwZGF0ZSA9IGNsb25lOwogICAgICAgICAgICBuZXdCYXNlU3RhdGUgPSBuZXdTdGF0ZTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG5ld0xhc3RCYXNlVXBkYXRlID0gbmV3TGFzdEJhc2VVcGRhdGUubmV4dCA9IGNsb25lOwogICAgICAgICAgfSAvLyBVcGRhdGUgdGhlIHJlbWFpbmluZyBwcmlvcml0eSBpbiB0aGUgcXVldWUuCgoKICAgICAgICAgIG5ld0xhbmVzID0gbWVyZ2VMYW5lcyhuZXdMYW5lcywgdXBkYXRlTGFuZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vIFRoaXMgdXBkYXRlIGRvZXMgaGF2ZSBzdWZmaWNpZW50IHByaW9yaXR5LgogICAgICAgICAgaWYgKG5ld0xhc3RCYXNlVXBkYXRlICE9PSBudWxsKSB7CiAgICAgICAgICAgIHZhciBfY2xvbmUgPSB7CiAgICAgICAgICAgICAgZXZlbnRUaW1lOiB1cGRhdGVFdmVudFRpbWUsCiAgICAgICAgICAgICAgLy8gVGhpcyB1cGRhdGUgaXMgZ29pbmcgdG8gYmUgY29tbWl0dGVkIHNvIHdlIG5ldmVyIHdhbnQgdW5jb21taXQKICAgICAgICAgICAgICAvLyBpdC4gVXNpbmcgTm9MYW5lIHdvcmtzIGJlY2F1c2UgMCBpcyBhIHN1YnNldCBvZiBhbGwgYml0bWFza3MsIHNvCiAgICAgICAgICAgICAgLy8gdGhpcyB3aWxsIG5ldmVyIGJlIHNraXBwZWQgYnkgdGhlIGNoZWNrIGFib3ZlLgogICAgICAgICAgICAgIGxhbmU6IE5vTGFuZSwKICAgICAgICAgICAgICB0YWc6IHVwZGF0ZS50YWcsCiAgICAgICAgICAgICAgcGF5bG9hZDogdXBkYXRlLnBheWxvYWQsCiAgICAgICAgICAgICAgY2FsbGJhY2s6IHVwZGF0ZS5jYWxsYmFjaywKICAgICAgICAgICAgICBuZXh0OiBudWxsCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIG5ld0xhc3RCYXNlVXBkYXRlID0gbmV3TGFzdEJhc2VVcGRhdGUubmV4dCA9IF9jbG9uZTsKICAgICAgICAgIH0gLy8gUHJvY2VzcyB0aGlzIHVwZGF0ZS4KCgogICAgICAgICAgbmV3U3RhdGUgPSBnZXRTdGF0ZUZyb21VcGRhdGUod29ya0luUHJvZ3Jlc3MsIHF1ZXVlLCB1cGRhdGUsIG5ld1N0YXRlLCBwcm9wcywgaW5zdGFuY2UpOwogICAgICAgICAgdmFyIGNhbGxiYWNrID0gdXBkYXRlLmNhbGxiYWNrOwoKICAgICAgICAgIGlmIChjYWxsYmFjayAhPT0gbnVsbCAmJiAvLyBJZiB0aGUgdXBkYXRlIHdhcyBhbHJlYWR5IGNvbW1pdHRlZCwgd2Ugc2hvdWxkIG5vdCBxdWV1ZSBpdHMKICAgICAgICAgIC8vIGNhbGxiYWNrIGFnYWluLgogICAgICAgICAgdXBkYXRlLmxhbmUgIT09IE5vTGFuZSkgewogICAgICAgICAgICB3b3JrSW5Qcm9ncmVzcy5mbGFncyB8PSBDYWxsYmFjazsKICAgICAgICAgICAgdmFyIGVmZmVjdHMgPSBxdWV1ZS5lZmZlY3RzOwoKICAgICAgICAgICAgaWYgKGVmZmVjdHMgPT09IG51bGwpIHsKICAgICAgICAgICAgICBxdWV1ZS5lZmZlY3RzID0gW3VwZGF0ZV07CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgZWZmZWN0cy5wdXNoKHVwZGF0ZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHVwZGF0ZSA9IHVwZGF0ZS5uZXh0OwoKICAgICAgICBpZiAodXBkYXRlID09PSBudWxsKSB7CiAgICAgICAgICBwZW5kaW5nUXVldWUgPSBxdWV1ZS5zaGFyZWQucGVuZGluZzsKCiAgICAgICAgICBpZiAocGVuZGluZ1F1ZXVlID09PSBudWxsKSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gQW4gdXBkYXRlIHdhcyBzY2hlZHVsZWQgZnJvbSBpbnNpZGUgYSByZWR1Y2VyLiBBZGQgdGhlIG5ldwogICAgICAgICAgICAvLyBwZW5kaW5nIHVwZGF0ZXMgdG8gdGhlIGVuZCBvZiB0aGUgbGlzdCBhbmQga2VlcCBwcm9jZXNzaW5nLgogICAgICAgICAgICB2YXIgX2xhc3RQZW5kaW5nVXBkYXRlID0gcGVuZGluZ1F1ZXVlOyAvLyBJbnRlbnRpb25hbGx5IHVuc291bmQuIFBlbmRpbmcgdXBkYXRlcyBmb3JtIGEgY2lyY3VsYXIgbGlzdCwgYnV0IHdlCiAgICAgICAgICAgIC8vIHVucmF2ZWwgdGhlbSB3aGVuIHRyYW5zZmVycmluZyB0aGVtIHRvIHRoZSBiYXNlIHF1ZXVlLgoKICAgICAgICAgICAgdmFyIF9maXJzdFBlbmRpbmdVcGRhdGUgPSBfbGFzdFBlbmRpbmdVcGRhdGUubmV4dDsKICAgICAgICAgICAgX2xhc3RQZW5kaW5nVXBkYXRlLm5leHQgPSBudWxsOwogICAgICAgICAgICB1cGRhdGUgPSBfZmlyc3RQZW5kaW5nVXBkYXRlOwogICAgICAgICAgICBxdWV1ZS5sYXN0QmFzZVVwZGF0ZSA9IF9sYXN0UGVuZGluZ1VwZGF0ZTsKICAgICAgICAgICAgcXVldWUuc2hhcmVkLnBlbmRpbmcgPSBudWxsOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSB3aGlsZSAodHJ1ZSk7CgogICAgICBpZiAobmV3TGFzdEJhc2VVcGRhdGUgPT09IG51bGwpIHsKICAgICAgICBuZXdCYXNlU3RhdGUgPSBuZXdTdGF0ZTsKICAgICAgfQoKICAgICAgcXVldWUuYmFzZVN0YXRlID0gbmV3QmFzZVN0YXRlOwogICAgICBxdWV1ZS5maXJzdEJhc2VVcGRhdGUgPSBuZXdGaXJzdEJhc2VVcGRhdGU7CiAgICAgIHF1ZXVlLmxhc3RCYXNlVXBkYXRlID0gbmV3TGFzdEJhc2VVcGRhdGU7IC8vIEludGVybGVhdmVkIHVwZGF0ZXMgYXJlIHN0b3JlZCBvbiBhIHNlcGFyYXRlIHF1ZXVlLiBXZSBhcmVuJ3QgZ29pbmcgdG8KICAgICAgLy8gcHJvY2VzcyB0aGVtIGR1cmluZyB0aGlzIHJlbmRlciwgYnV0IHdlIGRvIG5lZWQgdG8gdHJhY2sgd2hpY2ggbGFuZXMKICAgICAgLy8gYXJlIHJlbWFpbmluZy4KCiAgICAgIHZhciBsYXN0SW50ZXJsZWF2ZWQgPSBxdWV1ZS5zaGFyZWQuaW50ZXJsZWF2ZWQ7CgogICAgICBpZiAobGFzdEludGVybGVhdmVkICE9PSBudWxsKSB7CiAgICAgICAgdmFyIGludGVybGVhdmVkID0gbGFzdEludGVybGVhdmVkOwoKICAgICAgICBkbyB7CiAgICAgICAgICBuZXdMYW5lcyA9IG1lcmdlTGFuZXMobmV3TGFuZXMsIGludGVybGVhdmVkLmxhbmUpOwogICAgICAgICAgaW50ZXJsZWF2ZWQgPSBpbnRlcmxlYXZlZC5uZXh0OwogICAgICAgIH0gd2hpbGUgKGludGVybGVhdmVkICE9PSBsYXN0SW50ZXJsZWF2ZWQpOwogICAgICB9IGVsc2UgaWYgKGZpcnN0QmFzZVVwZGF0ZSA9PT0gbnVsbCkgewogICAgICAgIC8vIGBxdWV1ZS5sYW5lc2AgaXMgdXNlZCBmb3IgZW50YW5nbGluZyB0cmFuc2l0aW9ucy4gV2UgY2FuIHNldCBpdCBiYWNrIHRvCiAgICAgICAgLy8gemVybyBvbmNlIHRoZSBxdWV1ZSBpcyBlbXB0eS4KICAgICAgICBxdWV1ZS5zaGFyZWQubGFuZXMgPSBOb0xhbmVzOwogICAgICB9IC8vIFNldCB0aGUgcmVtYWluaW5nIGV4cGlyYXRpb24gdGltZSB0byBiZSB3aGF0ZXZlciBpcyByZW1haW5pbmcgaW4gdGhlIHF1ZXVlLgogICAgICAvLyBUaGlzIHNob3VsZCBiZSBmaW5lIGJlY2F1c2UgdGhlIG9ubHkgdHdvIG90aGVyIHRoaW5ncyB0aGF0IGNvbnRyaWJ1dGUgdG8KICAgICAgLy8gZXhwaXJhdGlvbiB0aW1lIGFyZSBwcm9wcyBhbmQgY29udGV4dC4gV2UncmUgYWxyZWFkeSBpbiB0aGUgbWlkZGxlIG9mIHRoZQogICAgICAvLyBiZWdpbiBwaGFzZSBieSB0aGUgdGltZSB3ZSBzdGFydCBwcm9jZXNzaW5nIHRoZSBxdWV1ZSwgc28gd2UndmUgYWxyZWFkeQogICAgICAvLyBkZWFsdCB3aXRoIHRoZSBwcm9wcy4gQ29udGV4dCBpbiBjb21wb25lbnRzIHRoYXQgc3BlY2lmeQogICAgICAvLyBzaG91bGRDb21wb25lbnRVcGRhdGUgaXMgdHJpY2t5OyBidXQgd2UnbGwgaGF2ZSB0byBhY2NvdW50IGZvcgogICAgICAvLyB0aGF0IHJlZ2FyZGxlc3MuCgoKICAgICAgbWFya1NraXBwZWRVcGRhdGVMYW5lcyhuZXdMYW5lcyk7CiAgICAgIHdvcmtJblByb2dyZXNzLmxhbmVzID0gbmV3TGFuZXM7CiAgICAgIHdvcmtJblByb2dyZXNzLm1lbW9pemVkU3RhdGUgPSBuZXdTdGF0ZTsKICAgIH0KCiAgICB7CiAgICAgIGN1cnJlbnRseVByb2Nlc3NpbmdRdWV1ZSA9IG51bGw7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBjYWxsQ2FsbGJhY2soY2FsbGJhY2ssIGNvbnRleHQpIHsKICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgIT09ICdmdW5jdGlvbicpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGFyZ3VtZW50IHBhc3NlZCBhcyBjYWxsYmFjay4gRXhwZWN0ZWQgYSBmdW5jdGlvbi4gSW5zdGVhZCAnICsgKCJyZWNlaXZlZDogIiArIGNhbGxiYWNrKSk7CiAgICB9CgogICAgY2FsbGJhY2suY2FsbChjb250ZXh0KTsKICB9CgogIGZ1bmN0aW9uIHJlc2V0SGFzRm9yY2VVcGRhdGVCZWZvcmVQcm9jZXNzaW5nKCkgewogICAgaGFzRm9yY2VVcGRhdGUgPSBmYWxzZTsKICB9CiAgZnVuY3Rpb24gY2hlY2tIYXNGb3JjZVVwZGF0ZUFmdGVyUHJvY2Vzc2luZygpIHsKICAgIHJldHVybiBoYXNGb3JjZVVwZGF0ZTsKICB9CiAgZnVuY3Rpb24gY29tbWl0VXBkYXRlUXVldWUoZmluaXNoZWRXb3JrLCBmaW5pc2hlZFF1ZXVlLCBpbnN0YW5jZSkgewogICAgLy8gQ29tbWl0IHRoZSBlZmZlY3RzCiAgICB2YXIgZWZmZWN0cyA9IGZpbmlzaGVkUXVldWUuZWZmZWN0czsKICAgIGZpbmlzaGVkUXVldWUuZWZmZWN0cyA9IG51bGw7CgogICAgaWYgKGVmZmVjdHMgIT09IG51bGwpIHsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlZmZlY3RzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdmFyIGVmZmVjdCA9IGVmZmVjdHNbaV07CiAgICAgICAgdmFyIGNhbGxiYWNrID0gZWZmZWN0LmNhbGxiYWNrOwoKICAgICAgICBpZiAoY2FsbGJhY2sgIT09IG51bGwpIHsKICAgICAgICAgIGVmZmVjdC5jYWxsYmFjayA9IG51bGw7CiAgICAgICAgICBjYWxsQ2FsbGJhY2soY2FsbGJhY2ssIGluc3RhbmNlKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CgogIHZhciBOT19DT05URVhUID0ge307CiAgdmFyIGNvbnRleHRTdGFja0N1cnNvciQxID0gY3JlYXRlQ3Vyc29yKE5PX0NPTlRFWFQpOwogIHZhciBjb250ZXh0RmliZXJTdGFja0N1cnNvciA9IGNyZWF0ZUN1cnNvcihOT19DT05URVhUKTsKICB2YXIgcm9vdEluc3RhbmNlU3RhY2tDdXJzb3IgPSBjcmVhdGVDdXJzb3IoTk9fQ09OVEVYVCk7CgogIGZ1bmN0aW9uIHJlcXVpcmVkQ29udGV4dChjKSB7CiAgICBpZiAoYyA9PT0gTk9fQ09OVEVYVCkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ0V4cGVjdGVkIGhvc3QgY29udGV4dCB0byBleGlzdC4gVGhpcyBlcnJvciBpcyBsaWtlbHkgY2F1c2VkIGJ5IGEgYnVnICcgKyAnaW4gUmVhY3QuIFBsZWFzZSBmaWxlIGFuIGlzc3VlLicpOwogICAgfQoKICAgIHJldHVybiBjOwogIH0KCiAgZnVuY3Rpb24gZ2V0Um9vdEhvc3RDb250YWluZXIoKSB7CiAgICB2YXIgcm9vdEluc3RhbmNlID0gcmVxdWlyZWRDb250ZXh0KHJvb3RJbnN0YW5jZVN0YWNrQ3Vyc29yLmN1cnJlbnQpOwogICAgcmV0dXJuIHJvb3RJbnN0YW5jZTsKICB9CgogIGZ1bmN0aW9uIHB1c2hIb3N0Q29udGFpbmVyKGZpYmVyLCBuZXh0Um9vdEluc3RhbmNlKSB7CiAgICAvLyBQdXNoIGN1cnJlbnQgcm9vdCBpbnN0YW5jZSBvbnRvIHRoZSBzdGFjazsKICAgIC8vIFRoaXMgYWxsb3dzIHVzIHRvIHJlc2V0IHJvb3Qgd2hlbiBwb3J0YWxzIGFyZSBwb3BwZWQuCiAgICBwdXNoKHJvb3RJbnN0YW5jZVN0YWNrQ3Vyc29yLCBuZXh0Um9vdEluc3RhbmNlLCBmaWJlcik7IC8vIFRyYWNrIHRoZSBjb250ZXh0IGFuZCB0aGUgRmliZXIgdGhhdCBwcm92aWRlZCBpdC4KICAgIC8vIFRoaXMgZW5hYmxlcyB1cyB0byBwb3Agb25seSBGaWJlcnMgdGhhdCBwcm92aWRlIHVuaXF1ZSBjb250ZXh0cy4KCiAgICBwdXNoKGNvbnRleHRGaWJlclN0YWNrQ3Vyc29yLCBmaWJlciwgZmliZXIpOyAvLyBGaW5hbGx5LCB3ZSBuZWVkIHRvIHB1c2ggdGhlIGhvc3QgY29udGV4dCB0byB0aGUgc3RhY2suCiAgICAvLyBIb3dldmVyLCB3ZSBjYW4ndCBqdXN0IGNhbGwgZ2V0Um9vdEhvc3RDb250ZXh0KCkgYW5kIHB1c2ggaXQgYmVjYXVzZQogICAgLy8gd2UnZCBoYXZlIGEgZGlmZmVyZW50IG51bWJlciBvZiBlbnRyaWVzIG9uIHRoZSBzdGFjayBkZXBlbmRpbmcgb24KICAgIC8vIHdoZXRoZXIgZ2V0Um9vdEhvc3RDb250ZXh0KCkgdGhyb3dzIHNvbWV3aGVyZSBpbiByZW5kZXJlciBjb2RlIG9yIG5vdC4KICAgIC8vIFNvIHdlIHB1c2ggYW4gZW1wdHkgdmFsdWUgZmlyc3QuIFRoaXMgbGV0cyB1cyBzYWZlbHkgdW53aW5kIG9uIGVycm9ycy4KCiAgICBwdXNoKGNvbnRleHRTdGFja0N1cnNvciQxLCBOT19DT05URVhULCBmaWJlcik7CiAgICB2YXIgbmV4dFJvb3RDb250ZXh0ID0gZ2V0Um9vdEhvc3RDb250ZXh0KG5leHRSb290SW5zdGFuY2UpOyAvLyBOb3cgdGhhdCB3ZSBrbm93IHRoaXMgZnVuY3Rpb24gZG9lc24ndCB0aHJvdywgcmVwbGFjZSBpdC4KCiAgICBwb3AoY29udGV4dFN0YWNrQ3Vyc29yJDEsIGZpYmVyKTsKICAgIHB1c2goY29udGV4dFN0YWNrQ3Vyc29yJDEsIG5leHRSb290Q29udGV4dCwgZmliZXIpOwogIH0KCiAgZnVuY3Rpb24gcG9wSG9zdENvbnRhaW5lcihmaWJlcikgewogICAgcG9wKGNvbnRleHRTdGFja0N1cnNvciQxLCBmaWJlcik7CiAgICBwb3AoY29udGV4dEZpYmVyU3RhY2tDdXJzb3IsIGZpYmVyKTsKICAgIHBvcChyb290SW5zdGFuY2VTdGFja0N1cnNvciwgZmliZXIpOwogIH0KCiAgZnVuY3Rpb24gZ2V0SG9zdENvbnRleHQoKSB7CiAgICB2YXIgY29udGV4dCA9IHJlcXVpcmVkQ29udGV4dChjb250ZXh0U3RhY2tDdXJzb3IkMS5jdXJyZW50KTsKICAgIHJldHVybiBjb250ZXh0OwogIH0KCiAgZnVuY3Rpb24gcHVzaEhvc3RDb250ZXh0KGZpYmVyKSB7CiAgICB2YXIgcm9vdEluc3RhbmNlID0gcmVxdWlyZWRDb250ZXh0KHJvb3RJbnN0YW5jZVN0YWNrQ3Vyc29yLmN1cnJlbnQpOwogICAgdmFyIGNvbnRleHQgPSByZXF1aXJlZENvbnRleHQoY29udGV4dFN0YWNrQ3Vyc29yJDEuY3VycmVudCk7CiAgICB2YXIgbmV4dENvbnRleHQgPSBnZXRDaGlsZEhvc3RDb250ZXh0KGNvbnRleHQsIGZpYmVyLnR5cGUpOyAvLyBEb24ndCBwdXNoIHRoaXMgRmliZXIncyBjb250ZXh0IHVubGVzcyBpdCdzIHVuaXF1ZS4KCiAgICBpZiAoY29udGV4dCA9PT0gbmV4dENvbnRleHQpIHsKICAgICAgcmV0dXJuOwogICAgfSAvLyBUcmFjayB0aGUgY29udGV4dCBhbmQgdGhlIEZpYmVyIHRoYXQgcHJvdmlkZWQgaXQuCiAgICAvLyBUaGlzIGVuYWJsZXMgdXMgdG8gcG9wIG9ubHkgRmliZXJzIHRoYXQgcHJvdmlkZSB1bmlxdWUgY29udGV4dHMuCgoKICAgIHB1c2goY29udGV4dEZpYmVyU3RhY2tDdXJzb3IsIGZpYmVyLCBmaWJlcik7CiAgICBwdXNoKGNvbnRleHRTdGFja0N1cnNvciQxLCBuZXh0Q29udGV4dCwgZmliZXIpOwogIH0KCiAgZnVuY3Rpb24gcG9wSG9zdENvbnRleHQoZmliZXIpIHsKICAgIC8vIERvIG5vdCBwb3AgdW5sZXNzIHRoaXMgRmliZXIgcHJvdmlkZWQgdGhlIGN1cnJlbnQgY29udGV4dC4KICAgIC8vIHB1c2hIb3N0Q29udGV4dCgpIG9ubHkgcHVzaGVzIEZpYmVycyB0aGF0IHByb3ZpZGUgdW5pcXVlIGNvbnRleHRzLgogICAgaWYgKGNvbnRleHRGaWJlclN0YWNrQ3Vyc29yLmN1cnJlbnQgIT09IGZpYmVyKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBwb3AoY29udGV4dFN0YWNrQ3Vyc29yJDEsIGZpYmVyKTsKICAgIHBvcChjb250ZXh0RmliZXJTdGFja0N1cnNvciwgZmliZXIpOwogIH0KCiAgdmFyIERlZmF1bHRTdXNwZW5zZUNvbnRleHQgPSAwOyAvLyBUaGUgU3VzcGVuc2UgQ29udGV4dCBpcyBzcGxpdCBpbnRvIHR3byBwYXJ0cy4gVGhlIGxvd2VyIGJpdHMgaXMKICAvLyBpbmhlcml0ZWQgZGVlcGx5IGRvd24gdGhlIHN1YnRyZWUuIFRoZSB1cHBlciBiaXRzIG9ubHkgYWZmZWN0CiAgLy8gdGhpcyBpbW1lZGlhdGUgc3VzcGVuc2UgYm91bmRhcnkgYW5kIGdldHMgcmVzZXQgZWFjaCBuZXcKICAvLyBib3VuZGFyeSBvciBzdXNwZW5zZSBsaXN0LgoKICB2YXIgU3VidHJlZVN1c3BlbnNlQ29udGV4dE1hc2sgPSAxOyAvLyBTdWJ0cmVlIEZsYWdzOgogIC8vIEludmlzaWJsZVBhcmVudFN1c3BlbnNlQ29udGV4dCBpbmRpY2F0ZXMgdGhhdCBvbmUgb2Ygb3VyIHBhcmVudCBTdXNwZW5zZQogIC8vIGJvdW5kYXJpZXMgaXMgbm90IGN1cnJlbnRseSBzaG93aW5nIHZpc2libGUgbWFpbiBjb250ZW50LgogIC8vIEVpdGhlciBiZWNhdXNlIGl0IGlzIGFscmVhZHkgc2hvd2luZyBhIGZhbGxiYWNrIG9yIGlzIG5vdCBtb3VudGVkIGF0IGFsbC4KICAvLyBXZSBjYW4gdXNlIHRoaXMgdG8gZGV0ZXJtaW5lIGlmIGl0IGlzIGRlc2lyYWJsZSB0byB0cmlnZ2VyIGEgZmFsbGJhY2sgYXQKICAvLyB0aGUgcGFyZW50LiBJZiBub3QsIHRoZW4gd2UgbWlnaHQgbmVlZCB0byB0cmlnZ2VyIHVuZGVzaXJhYmxlIGJvdW5kYXJpZXMKICAvLyBhbmQvb3Igc3VzcGVuZCB0aGUgY29tbWl0IHRvIGF2b2lkIGhpZGluZyB0aGUgcGFyZW50IGNvbnRlbnQuCgogIHZhciBJbnZpc2libGVQYXJlbnRTdXNwZW5zZUNvbnRleHQgPSAxOyAvLyBTaGFsbG93IEZsYWdzOgogIC8vIEZvcmNlU3VzcGVuc2VGYWxsYmFjayBjYW4gYmUgdXNlZCBieSBTdXNwZW5zZUxpc3QgdG8gZm9yY2UgbmV3bHkgYWRkZWQKICAvLyBpdGVtcyBpbnRvIHRoZWlyIGZhbGxiYWNrIHN0YXRlIGR1cmluZyBvbmUgb2YgdGhlIHJlbmRlciBwYXNzZXMuCgogIHZhciBGb3JjZVN1c3BlbnNlRmFsbGJhY2sgPSAyOwogIHZhciBzdXNwZW5zZVN0YWNrQ3Vyc29yID0gY3JlYXRlQ3Vyc29yKERlZmF1bHRTdXNwZW5zZUNvbnRleHQpOwogIGZ1bmN0aW9uIGhhc1N1c3BlbnNlQ29udGV4dChwYXJlbnRDb250ZXh0LCBmbGFnKSB7CiAgICByZXR1cm4gKHBhcmVudENvbnRleHQgJiBmbGFnKSAhPT0gMDsKICB9CiAgZnVuY3Rpb24gc2V0RGVmYXVsdFNoYWxsb3dTdXNwZW5zZUNvbnRleHQocGFyZW50Q29udGV4dCkgewogICAgcmV0dXJuIHBhcmVudENvbnRleHQgJiBTdWJ0cmVlU3VzcGVuc2VDb250ZXh0TWFzazsKICB9CiAgZnVuY3Rpb24gc2V0U2hhbGxvd1N1c3BlbnNlQ29udGV4dChwYXJlbnRDb250ZXh0LCBzaGFsbG93Q29udGV4dCkgewogICAgcmV0dXJuIHBhcmVudENvbnRleHQgJiBTdWJ0cmVlU3VzcGVuc2VDb250ZXh0TWFzayB8IHNoYWxsb3dDb250ZXh0OwogIH0KICBmdW5jdGlvbiBhZGRTdWJ0cmVlU3VzcGVuc2VDb250ZXh0KHBhcmVudENvbnRleHQsIHN1YnRyZWVDb250ZXh0KSB7CiAgICByZXR1cm4gcGFyZW50Q29udGV4dCB8IHN1YnRyZWVDb250ZXh0OwogIH0KICBmdW5jdGlvbiBwdXNoU3VzcGVuc2VDb250ZXh0KGZpYmVyLCBuZXdDb250ZXh0KSB7CiAgICBwdXNoKHN1c3BlbnNlU3RhY2tDdXJzb3IsIG5ld0NvbnRleHQsIGZpYmVyKTsKICB9CiAgZnVuY3Rpb24gcG9wU3VzcGVuc2VDb250ZXh0KGZpYmVyKSB7CiAgICBwb3Aoc3VzcGVuc2VTdGFja0N1cnNvciwgZmliZXIpOwogIH0KCiAgZnVuY3Rpb24gc2hvdWxkQ2FwdHVyZVN1c3BlbnNlKHdvcmtJblByb2dyZXNzLCBoYXNJbnZpc2libGVQYXJlbnQpIHsKICAgIC8vIElmIGl0IHdhcyB0aGUgcHJpbWFyeSBjaGlsZHJlbiB0aGF0IGp1c3Qgc3VzcGVuZGVkLCBjYXB0dXJlIGFuZCByZW5kZXIgdGhlCiAgICAvLyBmYWxsYmFjay4gT3RoZXJ3aXNlLCBkb24ndCBjYXB0dXJlIGFuZCBidWJibGUgdG8gdGhlIG5leHQgYm91bmRhcnkuCiAgICB2YXIgbmV4dFN0YXRlID0gd29ya0luUHJvZ3Jlc3MubWVtb2l6ZWRTdGF0ZTsKCiAgICBpZiAobmV4dFN0YXRlICE9PSBudWxsKSB7CiAgICAgIGlmIChuZXh0U3RhdGUuZGVoeWRyYXRlZCAhPT0gbnVsbCkgewogICAgICAgIC8vIEEgZGVoeWRyYXRlZCBib3VuZGFyeSBhbHdheXMgY2FwdHVyZXMuCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KCiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICB2YXIgcHJvcHMgPSB3b3JrSW5Qcm9ncmVzcy5tZW1vaXplZFByb3BzOyAvLyBSZWd1bGFyIGJvdW5kYXJpZXMgYWx3YXlzIGNhcHR1cmUuCgogICAgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0gLy8gSWYgaXQncyBhIGJvdW5kYXJ5IHdlIHNob3VsZCBhdm9pZCwgdGhlbiB3ZSBwcmVmZXIgdG8gYnViYmxlIHVwIHRvIHRoZQogIH0KICBmdW5jdGlvbiBmaW5kRmlyc3RTdXNwZW5kZWQocm93KSB7CiAgICB2YXIgbm9kZSA9IHJvdzsKCiAgICB3aGlsZSAobm9kZSAhPT0gbnVsbCkgewogICAgICBpZiAobm9kZS50YWcgPT09IFN1c3BlbnNlQ29tcG9uZW50KSB7CiAgICAgICAgdmFyIHN0YXRlID0gbm9kZS5tZW1vaXplZFN0YXRlOwoKICAgICAgICBpZiAoc3RhdGUgIT09IG51bGwpIHsKICAgICAgICAgIHZhciBkZWh5ZHJhdGVkID0gc3RhdGUuZGVoeWRyYXRlZDsKCiAgICAgICAgICBpZiAoZGVoeWRyYXRlZCA9PT0gbnVsbCB8fCBpc1N1c3BlbnNlSW5zdGFuY2VQZW5kaW5nKGRlaHlkcmF0ZWQpIHx8IGlzU3VzcGVuc2VJbnN0YW5jZUZhbGxiYWNrKGRlaHlkcmF0ZWQpKSB7CiAgICAgICAgICAgIHJldHVybiBub2RlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChub2RlLnRhZyA9PT0gU3VzcGVuc2VMaXN0Q29tcG9uZW50ICYmIC8vIHJldmVhbE9yZGVyIHVuZGVmaW5lZCBjYW4ndCBiZSB0cnVzdGVkIGJlY2F1c2UgaXQgZG9uJ3QKICAgICAgLy8ga2VlcCB0cmFjayBvZiB3aGV0aGVyIGl0IHN1c3BlbmRlZCBvciBub3QuCiAgICAgIG5vZGUubWVtb2l6ZWRQcm9wcy5yZXZlYWxPcmRlciAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgdmFyIGRpZFN1c3BlbmQgPSAobm9kZS5mbGFncyAmIERpZENhcHR1cmUpICE9PSBOb0ZsYWdzOwoKICAgICAgICBpZiAoZGlkU3VzcGVuZCkgewogICAgICAgICAgcmV0dXJuIG5vZGU7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKG5vZGUuY2hpbGQgIT09IG51bGwpIHsKICAgICAgICBub2RlLmNoaWxkLnJldHVybiA9IG5vZGU7CiAgICAgICAgbm9kZSA9IG5vZGUuY2hpbGQ7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGlmIChub2RlID09PSByb3cpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgd2hpbGUgKG5vZGUuc2libGluZyA9PT0gbnVsbCkgewogICAgICAgIGlmIChub2RlLnJldHVybiA9PT0gbnVsbCB8fCBub2RlLnJldHVybiA9PT0gcm93KSB7CiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CgogICAgICAgIG5vZGUgPSBub2RlLnJldHVybjsKICAgICAgfQoKICAgICAgbm9kZS5zaWJsaW5nLnJldHVybiA9IG5vZGUucmV0dXJuOwogICAgICBub2RlID0gbm9kZS5zaWJsaW5nOwogICAgfQoKICAgIHJldHVybiBudWxsOwogIH0KCiAgdmFyIE5vRmxhZ3MkMSA9CiAgLyogICAqLwogIDA7IC8vIFJlcHJlc2VudHMgd2hldGhlciBlZmZlY3Qgc2hvdWxkIGZpcmUuCgogIHZhciBIYXNFZmZlY3QgPQogIC8qICovCiAgMTsgLy8gUmVwcmVzZW50cyB0aGUgcGhhc2UgaW4gd2hpY2ggdGhlIGVmZmVjdCAobm90IHRoZSBjbGVhbi11cCkgZmlyZXMuCgogIHZhciBJbnNlcnRpb24gPQogIC8qICAqLwogIDI7CiAgdmFyIExheW91dCA9CiAgLyogICAgKi8KICA0OwogIHZhciBQYXNzaXZlJDEgPQogIC8qICAgKi8KICA4OwoKICAvLyBhbmQgc2hvdWxkIGJlIHJlc2V0IGJlZm9yZSBzdGFydGluZyBhIG5ldyByZW5kZXIuCiAgLy8gVGhpcyB0cmFja3Mgd2hpY2ggbXV0YWJsZSBzb3VyY2VzIG5lZWQgdG8gYmUgcmVzZXQgYWZ0ZXIgYSByZW5kZXIuCgogIHZhciB3b3JrSW5Qcm9ncmVzc1NvdXJjZXMgPSBbXTsKICBmdW5jdGlvbiByZXNldFdvcmtJblByb2dyZXNzVmVyc2lvbnMoKSB7CiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHdvcmtJblByb2dyZXNzU291cmNlcy5sZW5ndGg7IGkrKykgewogICAgICB2YXIgbXV0YWJsZVNvdXJjZSA9IHdvcmtJblByb2dyZXNzU291cmNlc1tpXTsKCiAgICAgIHsKICAgICAgICBtdXRhYmxlU291cmNlLl93b3JrSW5Qcm9ncmVzc1ZlcnNpb25QcmltYXJ5ID0gbnVsbDsKICAgICAgfQogICAgfQoKICAgIHdvcmtJblByb2dyZXNzU291cmNlcy5sZW5ndGggPSAwOwogIH0KICAvLyBUaGlzIGVuc3VyZXMgdGhhdCB0aGUgdmVyc2lvbiB1c2VkIGZvciBzZXJ2ZXIgcmVuZGVyaW5nIG1hdGNoZXMgdGhlIG9uZQogIC8vIHRoYXQgaXMgZXZlbnR1YWxseSByZWFkIGR1cmluZyBoeWRyYXRpb24uCiAgLy8gSWYgdGhleSBkb24ndCBtYXRjaCB0aGVyZSdzIGEgcG90ZW50aWFsIHRlYXIgYW5kIGEgZnVsbCBkZW9wdCByZW5kZXIgaXMgcmVxdWlyZWQuCgogIGZ1bmN0aW9uIHJlZ2lzdGVyTXV0YWJsZVNvdXJjZUZvckh5ZHJhdGlvbihyb290LCBtdXRhYmxlU291cmNlKSB7CiAgICB2YXIgZ2V0VmVyc2lvbiA9IG11dGFibGVTb3VyY2UuX2dldFZlcnNpb247CiAgICB2YXIgdmVyc2lvbiA9IGdldFZlcnNpb24obXV0YWJsZVNvdXJjZS5fc291cmNlKTsgLy8gVE9ETyBDbGVhciB0aGlzIGRhdGEgb25jZSBhbGwgcGVuZGluZyBoeWRyYXRpb24gd29yayBpcyBmaW5pc2hlZC4KICAgIC8vIFJldGFpbmluZyBpdCBmb3JldmVyIG1heSBpbnRlcmZlcmUgd2l0aCBHQy4KCiAgICBpZiAocm9vdC5tdXRhYmxlU291cmNlRWFnZXJIeWRyYXRpb25EYXRhID09IG51bGwpIHsKICAgICAgcm9vdC5tdXRhYmxlU291cmNlRWFnZXJIeWRyYXRpb25EYXRhID0gW211dGFibGVTb3VyY2UsIHZlcnNpb25dOwogICAgfSBlbHNlIHsKICAgICAgcm9vdC5tdXRhYmxlU291cmNlRWFnZXJIeWRyYXRpb25EYXRhLnB1c2gobXV0YWJsZVNvdXJjZSwgdmVyc2lvbik7CiAgICB9CiAgfQoKICB2YXIgUmVhY3RDdXJyZW50RGlzcGF0Y2hlciQxID0gUmVhY3RTaGFyZWRJbnRlcm5hbHMuUmVhY3RDdXJyZW50RGlzcGF0Y2hlciwKICAgICAgUmVhY3RDdXJyZW50QmF0Y2hDb25maWckMiA9IFJlYWN0U2hhcmVkSW50ZXJuYWxzLlJlYWN0Q3VycmVudEJhdGNoQ29uZmlnOwogIHZhciBkaWRXYXJuQWJvdXRNaXNtYXRjaGVkSG9va3NGb3JDb21wb25lbnQ7CiAgdmFyIGRpZFdhcm5VbmNhY2hlZEdldFNuYXBzaG90OwoKICB7CiAgICBkaWRXYXJuQWJvdXRNaXNtYXRjaGVkSG9va3NGb3JDb21wb25lbnQgPSBuZXcgU2V0KCk7CiAgfQoKICAvLyBUaGVzZSBhcmUgc2V0IHJpZ2h0IGJlZm9yZSBjYWxsaW5nIHRoZSBjb21wb25lbnQuCiAgdmFyIHJlbmRlckxhbmVzID0gTm9MYW5lczsgLy8gVGhlIHdvcmstaW4tcHJvZ3Jlc3MgZmliZXIuIEkndmUgbmFtZWQgaXQgZGlmZmVyZW50bHkgdG8gZGlzdGluZ3Vpc2ggaXQgZnJvbQogIC8vIHRoZSB3b3JrLWluLXByb2dyZXNzIGhvb2suCgogIHZhciBjdXJyZW50bHlSZW5kZXJpbmdGaWJlciQxID0gbnVsbDsgLy8gSG9va3MgYXJlIHN0b3JlZCBhcyBhIGxpbmtlZCBsaXN0IG9uIHRoZSBmaWJlcidzIG1lbW9pemVkU3RhdGUgZmllbGQuIFRoZQogIC8vIGN1cnJlbnQgaG9vayBsaXN0IGlzIHRoZSBsaXN0IHRoYXQgYmVsb25ncyB0byB0aGUgY3VycmVudCBmaWJlci4gVGhlCiAgLy8gd29yay1pbi1wcm9ncmVzcyBob29rIGxpc3QgaXMgYSBuZXcgbGlzdCB0aGF0IHdpbGwgYmUgYWRkZWQgdG8gdGhlCiAgLy8gd29yay1pbi1wcm9ncmVzcyBmaWJlci4KCiAgdmFyIGN1cnJlbnRIb29rID0gbnVsbDsKICB2YXIgd29ya0luUHJvZ3Jlc3NIb29rID0gbnVsbDsgLy8gV2hldGhlciBhbiB1cGRhdGUgd2FzIHNjaGVkdWxlZCBhdCBhbnkgcG9pbnQgZHVyaW5nIHRoZSByZW5kZXIgcGhhc2UuIFRoaXMKICAvLyBkb2VzIG5vdCBnZXQgcmVzZXQgaWYgd2UgZG8gYW5vdGhlciByZW5kZXIgcGFzczsgb25seSB3aGVuIHdlJ3JlIGNvbXBsZXRlbHkKICAvLyBmaW5pc2hlZCBldmFsdWF0aW5nIHRoaXMgY29tcG9uZW50LiBUaGlzIGlzIGFuIG9wdGltaXphdGlvbiBzbyB3ZSBrbm93CiAgLy8gd2hldGhlciB3ZSBuZWVkIHRvIGNsZWFyIHJlbmRlciBwaGFzZSB1cGRhdGVzIGFmdGVyIGEgdGhyb3cuCgogIHZhciBkaWRTY2hlZHVsZVJlbmRlclBoYXNlVXBkYXRlID0gZmFsc2U7IC8vIFdoZXJlIGFuIHVwZGF0ZSB3YXMgc2NoZWR1bGVkIG9ubHkgZHVyaW5nIHRoZSBjdXJyZW50IHJlbmRlciBwYXNzLiBUaGlzCiAgLy8gZ2V0cyByZXNldCBhZnRlciBlYWNoIGF0dGVtcHQuCiAgLy8gVE9ETzogTWF5YmUgdGhlcmUncyBzb21lIHdheSB0byBjb25zb2xpZGF0ZSB0aGlzIHdpdGgKICAvLyBgZGlkU2NoZWR1bGVSZW5kZXJQaGFzZVVwZGF0ZWAuIE9yIHdpdGggYG51bWJlck9mUmVSZW5kZXJzYC4KCiAgdmFyIGRpZFNjaGVkdWxlUmVuZGVyUGhhc2VVcGRhdGVEdXJpbmdUaGlzUGFzcyA9IGZhbHNlOyAvLyBDb3VudHMgdGhlIG51bWJlciBvZiB1c2VJZCBob29rcyBpbiB0aGlzIGNvbXBvbmVudC4KCiAgdmFyIGxvY2FsSWRDb3VudGVyID0gMDsgLy8gVXNlZCBmb3IgaWRzIHRoYXQgYXJlIGdlbmVyYXRlZCBjb21wbGV0ZWx5IGNsaWVudC1zaWRlIChpLmUuIG5vdCBkdXJpbmcKICAvLyBoeWRyYXRpb24pLiBUaGlzIGNvdW50ZXIgaXMgZ2xvYmFsLCBzbyBjbGllbnQgaWRzIGFyZSBub3Qgc3RhYmxlIGFjcm9zcwogIC8vIHJlbmRlciBhdHRlbXB0cy4KCiAgdmFyIGdsb2JhbENsaWVudElkQ291bnRlciA9IDA7CiAgdmFyIFJFX1JFTkRFUl9MSU1JVCA9IDI1OyAvLyBJbiBERVYsIHRoaXMgaXMgdGhlIG5hbWUgb2YgdGhlIGN1cnJlbnRseSBleGVjdXRpbmcgcHJpbWl0aXZlIGhvb2sKCiAgdmFyIGN1cnJlbnRIb29rTmFtZUluRGV2ID0gbnVsbDsgLy8gSW4gREVWLCB0aGlzIGxpc3QgZW5zdXJlcyB0aGF0IGhvb2tzIGFyZSBjYWxsZWQgaW4gdGhlIHNhbWUgb3JkZXIgYmV0d2VlbiByZW5kZXJzLgogIC8vIFRoZSBsaXN0IHN0b3JlcyB0aGUgb3JkZXIgb2YgaG9va3MgdXNlZCBkdXJpbmcgdGhlIGluaXRpYWwgcmVuZGVyIChtb3VudCkuCiAgLy8gU3Vic2VxdWVudCByZW5kZXJzICh1cGRhdGVzKSByZWZlcmVuY2UgdGhpcyBsaXN0LgoKICB2YXIgaG9va1R5cGVzRGV2ID0gbnVsbDsKICB2YXIgaG9va1R5cGVzVXBkYXRlSW5kZXhEZXYgPSAtMTsgLy8gSW4gREVWLCB0aGlzIHRyYWNrcyB3aGV0aGVyIGN1cnJlbnRseSByZW5kZXJpbmcgY29tcG9uZW50IG5lZWRzIHRvIGlnbm9yZQogIC8vIHRoZSBkZXBlbmRlbmNpZXMgZm9yIEhvb2tzIHRoYXQgbmVlZCB0aGVtIChlLmcuIHVzZUVmZmVjdCBvciB1c2VNZW1vKS4KICAvLyBXaGVuIHRydWUsIHN1Y2ggSG9va3Mgd2lsbCBhbHdheXMgYmUgInJlbW91bnRlZCIuIE9ubHkgdXNlZCBkdXJpbmcgaG90IHJlbG9hZC4KCiAgdmFyIGlnbm9yZVByZXZpb3VzRGVwZW5kZW5jaWVzID0gZmFsc2U7CgogIGZ1bmN0aW9uIG1vdW50SG9va1R5cGVzRGV2KCkgewogICAgewogICAgICB2YXIgaG9va05hbWUgPSBjdXJyZW50SG9va05hbWVJbkRldjsKCiAgICAgIGlmIChob29rVHlwZXNEZXYgPT09IG51bGwpIHsKICAgICAgICBob29rVHlwZXNEZXYgPSBbaG9va05hbWVdOwogICAgICB9IGVsc2UgewogICAgICAgIGhvb2tUeXBlc0Rldi5wdXNoKGhvb2tOYW1lKTsKICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gdXBkYXRlSG9va1R5cGVzRGV2KCkgewogICAgewogICAgICB2YXIgaG9va05hbWUgPSBjdXJyZW50SG9va05hbWVJbkRldjsKCiAgICAgIGlmIChob29rVHlwZXNEZXYgIT09IG51bGwpIHsKICAgICAgICBob29rVHlwZXNVcGRhdGVJbmRleERldisrOwoKICAgICAgICBpZiAoaG9va1R5cGVzRGV2W2hvb2tUeXBlc1VwZGF0ZUluZGV4RGV2XSAhPT0gaG9va05hbWUpIHsKICAgICAgICAgIHdhcm5Pbkhvb2tNaXNtYXRjaEluRGV2KGhvb2tOYW1lKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIGNoZWNrRGVwc0FyZUFycmF5RGV2KGRlcHMpIHsKICAgIHsKICAgICAgaWYgKGRlcHMgIT09IHVuZGVmaW5lZCAmJiBkZXBzICE9PSBudWxsICYmICFpc0FycmF5KGRlcHMpKSB7CiAgICAgICAgLy8gVmVyaWZ5IGRlcHMsIGJ1dCBvbmx5IG9uIG1vdW50IHRvIGF2b2lkIGV4dHJhIGNoZWNrcy4KICAgICAgICAvLyBJdCdzIHVubGlrZWx5IHRoZWlyIHR5cGUgd291bGQgY2hhbmdlIGFzIHVzdWFsbHkgeW91IGRlZmluZSB0aGVtIGlubGluZS4KICAgICAgICBlcnJvcignJXMgcmVjZWl2ZWQgYSBmaW5hbCBhcmd1bWVudCB0aGF0IGlzIG5vdCBhbiBhcnJheSAoaW5zdGVhZCwgcmVjZWl2ZWQgYCVzYCkuIFdoZW4gJyArICdzcGVjaWZpZWQsIHRoZSBmaW5hbCBhcmd1bWVudCBtdXN0IGJlIGFuIGFycmF5LicsIGN1cnJlbnRIb29rTmFtZUluRGV2LCB0eXBlb2YgZGVwcyk7CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIHdhcm5Pbkhvb2tNaXNtYXRjaEluRGV2KGN1cnJlbnRIb29rTmFtZSkgewogICAgewogICAgICB2YXIgY29tcG9uZW50TmFtZSA9IGdldENvbXBvbmVudE5hbWVGcm9tRmliZXIoY3VycmVudGx5UmVuZGVyaW5nRmliZXIkMSk7CgogICAgICBpZiAoIWRpZFdhcm5BYm91dE1pc21hdGNoZWRIb29rc0ZvckNvbXBvbmVudC5oYXMoY29tcG9uZW50TmFtZSkpIHsKICAgICAgICBkaWRXYXJuQWJvdXRNaXNtYXRjaGVkSG9va3NGb3JDb21wb25lbnQuYWRkKGNvbXBvbmVudE5hbWUpOwoKICAgICAgICBpZiAoaG9va1R5cGVzRGV2ICE9PSBudWxsKSB7CiAgICAgICAgICB2YXIgdGFibGUgPSAnJzsKICAgICAgICAgIHZhciBzZWNvbmRDb2x1bW5TdGFydCA9IDMwOwoKICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDw9IGhvb2tUeXBlc1VwZGF0ZUluZGV4RGV2OyBpKyspIHsKICAgICAgICAgICAgdmFyIG9sZEhvb2tOYW1lID0gaG9va1R5cGVzRGV2W2ldOwogICAgICAgICAgICB2YXIgbmV3SG9va05hbWUgPSBpID09PSBob29rVHlwZXNVcGRhdGVJbmRleERldiA/IGN1cnJlbnRIb29rTmFtZSA6IG9sZEhvb2tOYW1lOwogICAgICAgICAgICB2YXIgcm93ID0gaSArIDEgKyAiLiAiICsgb2xkSG9va05hbWU7IC8vIEV4dHJhIHNwYWNlIHNvIHNlY29uZCBjb2x1bW4gbGluZXMgdXAKICAgICAgICAgICAgLy8gbG9sIEAgSUUgbm90IHN1cHBvcnRpbmcgU3RyaW5nI3JlcGVhdAoKICAgICAgICAgICAgd2hpbGUgKHJvdy5sZW5ndGggPCBzZWNvbmRDb2x1bW5TdGFydCkgewogICAgICAgICAgICAgIHJvdyArPSAnICc7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJvdyArPSBuZXdIb29rTmFtZSArICdcbic7CiAgICAgICAgICAgIHRhYmxlICs9IHJvdzsKICAgICAgICAgIH0KCiAgICAgICAgICBlcnJvcignUmVhY3QgaGFzIGRldGVjdGVkIGEgY2hhbmdlIGluIHRoZSBvcmRlciBvZiBIb29rcyBjYWxsZWQgYnkgJXMuICcgKyAnVGhpcyB3aWxsIGxlYWQgdG8gYnVncyBhbmQgZXJyb3JzIGlmIG5vdCBmaXhlZC4gJyArICdGb3IgbW9yZSBpbmZvcm1hdGlvbiwgcmVhZCB0aGUgUnVsZXMgb2YgSG9va3M6IGh0dHBzOi8vcmVhY3Rqcy5vcmcvbGluay9ydWxlcy1vZi1ob29rc1xuXG4nICsgJyAgIFByZXZpb3VzIHJlbmRlciAgICAgICAgICAgIE5leHQgcmVuZGVyXG4nICsgJyAgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuJyArICclcycgKyAnICAgXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXG4nLCBjb21wb25lbnROYW1lLCB0YWJsZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiB0aHJvd0ludmFsaWRIb29rRXJyb3IoKSB7CiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgaG9vayBjYWxsLiBIb29rcyBjYW4gb25seSBiZSBjYWxsZWQgaW5zaWRlIG9mIHRoZSBib2R5IG9mIGEgZnVuY3Rpb24gY29tcG9uZW50LiBUaGlzIGNvdWxkIGhhcHBlbiBmb3InICsgJyBvbmUgb2YgdGhlIGZvbGxvd2luZyByZWFzb25zOlxuJyArICcxLiBZb3UgbWlnaHQgaGF2ZSBtaXNtYXRjaGluZyB2ZXJzaW9ucyBvZiBSZWFjdCBhbmQgdGhlIHJlbmRlcmVyIChzdWNoIGFzIFJlYWN0IERPTSlcbicgKyAnMi4gWW91IG1pZ2h0IGJlIGJyZWFraW5nIHRoZSBSdWxlcyBvZiBIb29rc1xuJyArICczLiBZb3UgbWlnaHQgaGF2ZSBtb3JlIHRoYW4gb25lIGNvcHkgb2YgUmVhY3QgaW4gdGhlIHNhbWUgYXBwXG4nICsgJ1NlZSBodHRwczovL3JlYWN0anMub3JnL2xpbmsvaW52YWxpZC1ob29rLWNhbGwgZm9yIHRpcHMgYWJvdXQgaG93IHRvIGRlYnVnIGFuZCBmaXggdGhpcyBwcm9ibGVtLicpOwogIH0KCiAgZnVuY3Rpb24gYXJlSG9va0lucHV0c0VxdWFsKG5leHREZXBzLCBwcmV2RGVwcykgewogICAgewogICAgICBpZiAoaWdub3JlUHJldmlvdXNEZXBlbmRlbmNpZXMpIHsKICAgICAgICAvLyBPbmx5IHRydWUgd2hlbiB0aGlzIGNvbXBvbmVudCBpcyBiZWluZyBob3QgcmVsb2FkZWQuCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9CgogICAgaWYgKHByZXZEZXBzID09PSBudWxsKSB7CiAgICAgIHsKICAgICAgICBlcnJvcignJXMgcmVjZWl2ZWQgYSBmaW5hbCBhcmd1bWVudCBkdXJpbmcgdGhpcyByZW5kZXIsIGJ1dCBub3QgZHVyaW5nICcgKyAndGhlIHByZXZpb3VzIHJlbmRlci4gRXZlbiB0aG91Z2ggdGhlIGZpbmFsIGFyZ3VtZW50IGlzIG9wdGlvbmFsLCAnICsgJ2l0cyB0eXBlIGNhbm5vdCBjaGFuZ2UgYmV0d2VlbiByZW5kZXJzLicsIGN1cnJlbnRIb29rTmFtZUluRGV2KTsKICAgICAgfQoKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIHsKICAgICAgLy8gRG9uJ3QgYm90aGVyIGNvbXBhcmluZyBsZW5ndGhzIGluIHByb2QgYmVjYXVzZSB0aGVzZSBhcnJheXMgc2hvdWxkIGJlCiAgICAgIC8vIHBhc3NlZCBpbmxpbmUuCiAgICAgIGlmIChuZXh0RGVwcy5sZW5ndGggIT09IHByZXZEZXBzLmxlbmd0aCkgewogICAgICAgIGVycm9yKCdUaGUgZmluYWwgYXJndW1lbnQgcGFzc2VkIHRvICVzIGNoYW5nZWQgc2l6ZSBiZXR3ZWVuIHJlbmRlcnMuIFRoZSAnICsgJ29yZGVyIGFuZCBzaXplIG9mIHRoaXMgYXJyYXkgbXVzdCByZW1haW4gY29uc3RhbnQuXG5cbicgKyAnUHJldmlvdXM6ICVzXG4nICsgJ0luY29taW5nOiAlcycsIGN1cnJlbnRIb29rTmFtZUluRGV2LCAiWyIgKyBwcmV2RGVwcy5qb2luKCcsICcpICsgIl0iLCAiWyIgKyBuZXh0RGVwcy5qb2luKCcsICcpICsgIl0iKTsKICAgICAgfQogICAgfQoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcHJldkRlcHMubGVuZ3RoICYmIGkgPCBuZXh0RGVwcy5sZW5ndGg7IGkrKykgewogICAgICBpZiAob2JqZWN0SXMobmV4dERlcHNbaV0sIHByZXZEZXBzW2ldKSkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiByZW5kZXJXaXRoSG9va3MoY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIENvbXBvbmVudCwgcHJvcHMsIHNlY29uZEFyZywgbmV4dFJlbmRlckxhbmVzKSB7CiAgICByZW5kZXJMYW5lcyA9IG5leHRSZW5kZXJMYW5lczsKICAgIGN1cnJlbnRseVJlbmRlcmluZ0ZpYmVyJDEgPSB3b3JrSW5Qcm9ncmVzczsKCiAgICB7CiAgICAgIGhvb2tUeXBlc0RldiA9IGN1cnJlbnQgIT09IG51bGwgPyBjdXJyZW50Ll9kZWJ1Z0hvb2tUeXBlcyA6IG51bGw7CiAgICAgIGhvb2tUeXBlc1VwZGF0ZUluZGV4RGV2ID0gLTE7IC8vIFVzZWQgZm9yIGhvdCByZWxvYWRpbmc6CgogICAgICBpZ25vcmVQcmV2aW91c0RlcGVuZGVuY2llcyA9IGN1cnJlbnQgIT09IG51bGwgJiYgY3VycmVudC50eXBlICE9PSB3b3JrSW5Qcm9ncmVzcy50eXBlOwogICAgfQoKICAgIHdvcmtJblByb2dyZXNzLm1lbW9pemVkU3RhdGUgPSBudWxsOwogICAgd29ya0luUHJvZ3Jlc3MudXBkYXRlUXVldWUgPSBudWxsOwogICAgd29ya0luUHJvZ3Jlc3MubGFuZXMgPSBOb0xhbmVzOyAvLyBUaGUgZm9sbG93aW5nIHNob3VsZCBoYXZlIGFscmVhZHkgYmVlbiByZXNldAogICAgLy8gY3VycmVudEhvb2sgPSBudWxsOwogICAgLy8gd29ya0luUHJvZ3Jlc3NIb29rID0gbnVsbDsKICAgIC8vIGRpZFNjaGVkdWxlUmVuZGVyUGhhc2VVcGRhdGUgPSBmYWxzZTsKICAgIC8vIGxvY2FsSWRDb3VudGVyID0gMDsKICAgIC8vIFRPRE8gV2FybiBpZiBubyBob29rcyBhcmUgdXNlZCBhdCBhbGwgZHVyaW5nIG1vdW50LCB0aGVuIHNvbWUgYXJlIHVzZWQgZHVyaW5nIHVwZGF0ZS4KICAgIC8vIEN1cnJlbnRseSB3ZSB3aWxsIGlkZW50aWZ5IHRoZSB1cGRhdGUgcmVuZGVyIGFzIGEgbW91bnQgYmVjYXVzZSBtZW1vaXplZFN0YXRlID09PSBudWxsLgogICAgLy8gVGhpcyBpcyB0cmlja3kgYmVjYXVzZSBpdCdzIHZhbGlkIGZvciBjZXJ0YWluIHR5cGVzIG9mIGNvbXBvbmVudHMgKGUuZy4gUmVhY3QubGF6eSkKICAgIC8vIFVzaW5nIG1lbW9pemVkU3RhdGUgdG8gZGlmZmVyZW50aWF0ZSBiZXR3ZWVuIG1vdW50L3VwZGF0ZSBvbmx5IHdvcmtzIGlmIGF0IGxlYXN0IG9uZSBzdGF0ZWZ1bCBob29rIGlzIHVzZWQuCiAgICAvLyBOb24tc3RhdGVmdWwgaG9va3MgKGUuZy4gY29udGV4dCkgZG9uJ3QgZ2V0IGFkZGVkIHRvIG1lbW9pemVkU3RhdGUsCiAgICAvLyBzbyBtZW1vaXplZFN0YXRlIHdvdWxkIGJlIG51bGwgZHVyaW5nIHVwZGF0ZXMgYW5kIG1vdW50cy4KCiAgICB7CiAgICAgIGlmIChjdXJyZW50ICE9PSBudWxsICYmIGN1cnJlbnQubWVtb2l6ZWRTdGF0ZSAhPT0gbnVsbCkgewogICAgICAgIFJlYWN0Q3VycmVudERpc3BhdGNoZXIkMS5jdXJyZW50ID0gSG9va3NEaXNwYXRjaGVyT25VcGRhdGVJbkRFVjsKICAgICAgfSBlbHNlIGlmIChob29rVHlwZXNEZXYgIT09IG51bGwpIHsKICAgICAgICAvLyBUaGlzIGRpc3BhdGNoZXIgaGFuZGxlcyBhbiBlZGdlIGNhc2Ugd2hlcmUgYSBjb21wb25lbnQgaXMgdXBkYXRpbmcsCiAgICAgICAgLy8gYnV0IG5vIHN0YXRlZnVsIGhvb2tzIGhhdmUgYmVlbiB1c2VkLgogICAgICAgIC8vIFdlIHdhbnQgdG8gbWF0Y2ggdGhlIHByb2R1Y3Rpb24gY29kZSBiZWhhdmlvciAod2hpY2ggd2lsbCB1c2UgSG9va3NEaXNwYXRjaGVyT25Nb3VudCksCiAgICAgICAgLy8gYnV0IHdpdGggdGhlIGV4dHJhIERFViB2YWxpZGF0aW9uIHRvIGVuc3VyZSBob29rcyBvcmRlcmluZyBoYXNuJ3QgY2hhbmdlZC4KICAgICAgICAvLyBUaGlzIGRpc3BhdGNoZXIgZG9lcyB0aGF0LgogICAgICAgIFJlYWN0Q3VycmVudERpc3BhdGNoZXIkMS5jdXJyZW50ID0gSG9va3NEaXNwYXRjaGVyT25Nb3VudFdpdGhIb29rVHlwZXNJbkRFVjsKICAgICAgfSBlbHNlIHsKICAgICAgICBSZWFjdEN1cnJlbnREaXNwYXRjaGVyJDEuY3VycmVudCA9IEhvb2tzRGlzcGF0Y2hlck9uTW91bnRJbkRFVjsKICAgICAgfQogICAgfQoKICAgIHZhciBjaGlsZHJlbiA9IENvbXBvbmVudChwcm9wcywgc2Vjb25kQXJnKTsgLy8gQ2hlY2sgaWYgdGhlcmUgd2FzIGEgcmVuZGVyIHBoYXNlIHVwZGF0ZQoKICAgIGlmIChkaWRTY2hlZHVsZVJlbmRlclBoYXNlVXBkYXRlRHVyaW5nVGhpc1Bhc3MpIHsKICAgICAgLy8gS2VlcCByZW5kZXJpbmcgaW4gYSBsb29wIGZvciBhcyBsb25nIGFzIHJlbmRlciBwaGFzZSB1cGRhdGVzIGNvbnRpbnVlIHRvCiAgICAgIC8vIGJlIHNjaGVkdWxlZC4gVXNlIGEgY291bnRlciB0byBwcmV2ZW50IGluZmluaXRlIGxvb3BzLgogICAgICB2YXIgbnVtYmVyT2ZSZVJlbmRlcnMgPSAwOwoKICAgICAgZG8gewogICAgICAgIGRpZFNjaGVkdWxlUmVuZGVyUGhhc2VVcGRhdGVEdXJpbmdUaGlzUGFzcyA9IGZhbHNlOwogICAgICAgIGxvY2FsSWRDb3VudGVyID0gMDsKCiAgICAgICAgaWYgKG51bWJlck9mUmVSZW5kZXJzID49IFJFX1JFTkRFUl9MSU1JVCkgewogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUb28gbWFueSByZS1yZW5kZXJzLiBSZWFjdCBsaW1pdHMgdGhlIG51bWJlciBvZiByZW5kZXJzIHRvIHByZXZlbnQgJyArICdhbiBpbmZpbml0ZSBsb29wLicpOwogICAgICAgIH0KCiAgICAgICAgbnVtYmVyT2ZSZVJlbmRlcnMgKz0gMTsKCiAgICAgICAgewogICAgICAgICAgLy8gRXZlbiB3aGVuIGhvdCByZWxvYWRpbmcsIGFsbG93IGRlcGVuZGVuY2llcyB0byBzdGFiaWxpemUKICAgICAgICAgIC8vIGFmdGVyIGZpcnN0IHJlbmRlciB0byBwcmV2ZW50IGluZmluaXRlIHJlbmRlciBwaGFzZSB1cGRhdGVzLgogICAgICAgICAgaWdub3JlUHJldmlvdXNEZXBlbmRlbmNpZXMgPSBmYWxzZTsKICAgICAgICB9IC8vIFN0YXJ0IG92ZXIgZnJvbSB0aGUgYmVnaW5uaW5nIG9mIHRoZSBsaXN0CgoKICAgICAgICBjdXJyZW50SG9vayA9IG51bGw7CiAgICAgICAgd29ya0luUHJvZ3Jlc3NIb29rID0gbnVsbDsKICAgICAgICB3b3JrSW5Qcm9ncmVzcy51cGRhdGVRdWV1ZSA9IG51bGw7CgogICAgICAgIHsKICAgICAgICAgIC8vIEFsc28gdmFsaWRhdGUgaG9vayBvcmRlciBmb3IgY2FzY2FkaW5nIHVwZGF0ZXMuCiAgICAgICAgICBob29rVHlwZXNVcGRhdGVJbmRleERldiA9IC0xOwogICAgICAgIH0KCiAgICAgICAgUmVhY3RDdXJyZW50RGlzcGF0Y2hlciQxLmN1cnJlbnQgPSAgSG9va3NEaXNwYXRjaGVyT25SZXJlbmRlckluREVWIDsKICAgICAgICBjaGlsZHJlbiA9IENvbXBvbmVudChwcm9wcywgc2Vjb25kQXJnKTsKICAgICAgfSB3aGlsZSAoZGlkU2NoZWR1bGVSZW5kZXJQaGFzZVVwZGF0ZUR1cmluZ1RoaXNQYXNzKTsKICAgIH0gLy8gV2UgY2FuIGFzc3VtZSB0aGUgcHJldmlvdXMgZGlzcGF0Y2hlciBpcyBhbHdheXMgdGhpcyBvbmUsIHNpbmNlIHdlIHNldCBpdAogICAgLy8gYXQgdGhlIGJlZ2lubmluZyBvZiB0aGUgcmVuZGVyIHBoYXNlIGFuZCB0aGVyZSdzIG5vIHJlLWVudHJhbmNlLgoKCiAgICBSZWFjdEN1cnJlbnREaXNwYXRjaGVyJDEuY3VycmVudCA9IENvbnRleHRPbmx5RGlzcGF0Y2hlcjsKCiAgICB7CiAgICAgIHdvcmtJblByb2dyZXNzLl9kZWJ1Z0hvb2tUeXBlcyA9IGhvb2tUeXBlc0RldjsKICAgIH0gLy8gVGhpcyBjaGVjayB1c2VzIGN1cnJlbnRIb29rIHNvIHRoYXQgaXQgd29ya3MgdGhlIHNhbWUgaW4gREVWIGFuZCBwcm9kIGJ1bmRsZXMuCiAgICAvLyBob29rVHlwZXNEZXYgY291bGQgY2F0Y2ggbW9yZSBjYXNlcyAoZS5nLiBjb250ZXh0KSBidXQgb25seSBpbiBERVYgYnVuZGxlcy4KCgogICAgdmFyIGRpZFJlbmRlclRvb0Zld0hvb2tzID0gY3VycmVudEhvb2sgIT09IG51bGwgJiYgY3VycmVudEhvb2submV4dCAhPT0gbnVsbDsKICAgIHJlbmRlckxhbmVzID0gTm9MYW5lczsKICAgIGN1cnJlbnRseVJlbmRlcmluZ0ZpYmVyJDEgPSBudWxsOwogICAgY3VycmVudEhvb2sgPSBudWxsOwogICAgd29ya0luUHJvZ3Jlc3NIb29rID0gbnVsbDsKCiAgICB7CiAgICAgIGN1cnJlbnRIb29rTmFtZUluRGV2ID0gbnVsbDsKICAgICAgaG9va1R5cGVzRGV2ID0gbnVsbDsKICAgICAgaG9va1R5cGVzVXBkYXRlSW5kZXhEZXYgPSAtMTsgLy8gQ29uZmlybSB0aGF0IGEgc3RhdGljIGZsYWcgd2FzIG5vdCBhZGRlZCBvciByZW1vdmVkIHNpbmNlIHRoZSBsYXN0CiAgICAgIC8vIHJlbmRlci4gSWYgdGhpcyBmaXJlcywgaXQgc3VnZ2VzdHMgdGhhdCB3ZSBpbmNvcnJlY3RseSByZXNldCB0aGUgc3RhdGljCiAgICAgIC8vIGZsYWdzIGluIHNvbWUgb3RoZXIgcGFydCBvZiB0aGUgY29kZWJhc2UuIFRoaXMgaGFzIGhhcHBlbmVkIGJlZm9yZSwgZm9yCiAgICAgIC8vIGV4YW1wbGUsIGluIHRoZSBTdXNwZW5zZUxpc3QgaW1wbGVtZW50YXRpb24uCgogICAgICBpZiAoY3VycmVudCAhPT0gbnVsbCAmJiAoY3VycmVudC5mbGFncyAmIFN0YXRpY01hc2spICE9PSAod29ya0luUHJvZ3Jlc3MuZmxhZ3MgJiBTdGF0aWNNYXNrKSAmJiAvLyBEaXNhYmxlIHRoaXMgd2FybmluZyBpbiBsZWdhY3kgbW9kZSwgYmVjYXVzZSBsZWdhY3kgU3VzcGVuc2UgaXMgd2VpcmQKICAgICAgLy8gYW5kIGNyZWF0ZXMgZmFsc2UgcG9zaXRpdmVzLiBUbyBtYWtlIHRoaXMgd29yayBpbiBsZWdhY3kgbW9kZSwgd2UnZAogICAgICAvLyBuZWVkIHRvIG1hcmsgZmliZXJzIHRoYXQgY29tbWl0IGluIGFuIGluY29tcGxldGUgc3RhdGUsIHNvbWVob3cuIEZvcgogICAgICAvLyBub3cgSSdsbCBkaXNhYmxlIHRoZSB3YXJuaW5nIHRoYXQgbW9zdCBvZiB0aGUgYnVncyB0aGF0IHdvdWxkIHRyaWdnZXIKICAgICAgLy8gaXQgYXJlIGVpdGhlciBleGNsdXNpdmUgdG8gY29uY3VycmVudCBtb2RlIG9yIGV4aXN0IGluIGJvdGguCiAgICAgIChjdXJyZW50Lm1vZGUgJiBDb25jdXJyZW50TW9kZSkgIT09IE5vTW9kZSkgewogICAgICAgIGVycm9yKCdJbnRlcm5hbCBSZWFjdCBlcnJvcjogRXhwZWN0ZWQgc3RhdGljIGZsYWcgd2FzIG1pc3NpbmcuIFBsZWFzZSAnICsgJ25vdGlmeSB0aGUgUmVhY3QgdGVhbS4nKTsKICAgICAgfQogICAgfQoKICAgIGRpZFNjaGVkdWxlUmVuZGVyUGhhc2VVcGRhdGUgPSBmYWxzZTsgLy8gVGhpcyBpcyByZXNldCBieSBjaGVja0RpZFJlbmRlcklkSG9vawogICAgLy8gbG9jYWxJZENvdW50ZXIgPSAwOwoKICAgIGlmIChkaWRSZW5kZXJUb29GZXdIb29rcykgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlbmRlcmVkIGZld2VyIGhvb2tzIHRoYW4gZXhwZWN0ZWQuIFRoaXMgbWF5IGJlIGNhdXNlZCBieSBhbiBhY2NpZGVudGFsICcgKyAnZWFybHkgcmV0dXJuIHN0YXRlbWVudC4nKTsKICAgIH0KCiAgICByZXR1cm4gY2hpbGRyZW47CiAgfQogIGZ1bmN0aW9uIGNoZWNrRGlkUmVuZGVySWRIb29rKCkgewogICAgLy8gVGhpcyBzaG91bGQgYmUgY2FsbGVkIGltbWVkaWF0ZWx5IGFmdGVyIGV2ZXJ5IHJlbmRlcldpdGhIb29rcyBjYWxsLgogICAgLy8gQ29uY2VwdHVhbGx5LCBpdCdzIHBhcnQgb2YgdGhlIHJldHVybiB2YWx1ZSBvZiByZW5kZXJXaXRoSG9va3M7IGl0J3Mgb25seSBhCiAgICAvLyBzZXBhcmF0ZSBmdW5jdGlvbiB0byBhdm9pZCB1c2luZyBhbiBhcnJheSB0dXBsZS4KICAgIHZhciBkaWRSZW5kZXJJZEhvb2sgPSBsb2NhbElkQ291bnRlciAhPT0gMDsKICAgIGxvY2FsSWRDb3VudGVyID0gMDsKICAgIHJldHVybiBkaWRSZW5kZXJJZEhvb2s7CiAgfQogIGZ1bmN0aW9uIGJhaWxvdXRIb29rcyhjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcywgbGFuZXMpIHsKICAgIHdvcmtJblByb2dyZXNzLnVwZGF0ZVF1ZXVlID0gY3VycmVudC51cGRhdGVRdWV1ZTsgLy8gVE9ETzogRG9uJ3QgbmVlZCB0byByZXNldCB0aGUgZmxhZ3MgaGVyZSwgYmVjYXVzZSB0aGV5J3JlIHJlc2V0IGluIHRoZQogICAgLy8gY29tcGxldGUgcGhhc2UgKGJ1YmJsZVByb3BlcnRpZXMpLgoKICAgIGlmICggKHdvcmtJblByb2dyZXNzLm1vZGUgJiBTdHJpY3RFZmZlY3RzTW9kZSkgIT09IE5vTW9kZSkgewogICAgICB3b3JrSW5Qcm9ncmVzcy5mbGFncyAmPSB+KE1vdW50UGFzc2l2ZURldiB8IE1vdW50TGF5b3V0RGV2IHwgUGFzc2l2ZSB8IFVwZGF0ZSk7CiAgICB9IGVsc2UgewogICAgICB3b3JrSW5Qcm9ncmVzcy5mbGFncyAmPSB+KFBhc3NpdmUgfCBVcGRhdGUpOwogICAgfQoKICAgIGN1cnJlbnQubGFuZXMgPSByZW1vdmVMYW5lcyhjdXJyZW50LmxhbmVzLCBsYW5lcyk7CiAgfQogIGZ1bmN0aW9uIHJlc2V0SG9va3NBZnRlclRocm93KCkgewogICAgLy8gV2UgY2FuIGFzc3VtZSB0aGUgcHJldmlvdXMgZGlzcGF0Y2hlciBpcyBhbHdheXMgdGhpcyBvbmUsIHNpbmNlIHdlIHNldCBpdAogICAgLy8gYXQgdGhlIGJlZ2lubmluZyBvZiB0aGUgcmVuZGVyIHBoYXNlIGFuZCB0aGVyZSdzIG5vIHJlLWVudHJhbmNlLgogICAgUmVhY3RDdXJyZW50RGlzcGF0Y2hlciQxLmN1cnJlbnQgPSBDb250ZXh0T25seURpc3BhdGNoZXI7CgogICAgaWYgKGRpZFNjaGVkdWxlUmVuZGVyUGhhc2VVcGRhdGUpIHsKICAgICAgLy8gVGhlcmUgd2VyZSByZW5kZXIgcGhhc2UgdXBkYXRlcy4gVGhlc2UgYXJlIG9ubHkgdmFsaWQgZm9yIHRoaXMgcmVuZGVyCiAgICAgIC8vIHBoYXNlLCB3aGljaCB3ZSBhcmUgbm93IGFib3J0aW5nLiBSZW1vdmUgdGhlIHVwZGF0ZXMgZnJvbSB0aGUgcXVldWVzIHNvCiAgICAgIC8vIHRoZXkgZG8gbm90IHBlcnNpc3QgdG8gdGhlIG5leHQgcmVuZGVyLiBEbyBub3QgcmVtb3ZlIHVwZGF0ZXMgZnJvbSBob29rcwogICAgICAvLyB0aGF0IHdlcmVuJ3QgcHJvY2Vzc2VkLgogICAgICAvLwogICAgICAvLyBPbmx5IHJlc2V0IHRoZSB1cGRhdGVzIGZyb20gdGhlIHF1ZXVlIGlmIGl0IGhhcyBhIGNsb25lLiBJZiBpdCBkb2VzCiAgICAgIC8vIG5vdCBoYXZlIGEgY2xvbmUsIHRoYXQgbWVhbnMgaXQgd2Fzbid0IHByb2Nlc3NlZCwgYW5kIHRoZSB1cGRhdGVzIHdlcmUKICAgICAgLy8gc2NoZWR1bGVkIGJlZm9yZSB3ZSBlbnRlcmVkIHRoZSByZW5kZXIgcGhhc2UuCiAgICAgIHZhciBob29rID0gY3VycmVudGx5UmVuZGVyaW5nRmliZXIkMS5tZW1vaXplZFN0YXRlOwoKICAgICAgd2hpbGUgKGhvb2sgIT09IG51bGwpIHsKICAgICAgICB2YXIgcXVldWUgPSBob29rLnF1ZXVlOwoKICAgICAgICBpZiAocXVldWUgIT09IG51bGwpIHsKICAgICAgICAgIHF1ZXVlLnBlbmRpbmcgPSBudWxsOwogICAgICAgIH0KCiAgICAgICAgaG9vayA9IGhvb2submV4dDsKICAgICAgfQoKICAgICAgZGlkU2NoZWR1bGVSZW5kZXJQaGFzZVVwZGF0ZSA9IGZhbHNlOwogICAgfQoKICAgIHJlbmRlckxhbmVzID0gTm9MYW5lczsKICAgIGN1cnJlbnRseVJlbmRlcmluZ0ZpYmVyJDEgPSBudWxsOwogICAgY3VycmVudEhvb2sgPSBudWxsOwogICAgd29ya0luUHJvZ3Jlc3NIb29rID0gbnVsbDsKCiAgICB7CiAgICAgIGhvb2tUeXBlc0RldiA9IG51bGw7CiAgICAgIGhvb2tUeXBlc1VwZGF0ZUluZGV4RGV2ID0gLTE7CiAgICAgIGN1cnJlbnRIb29rTmFtZUluRGV2ID0gbnVsbDsKICAgICAgaXNVcGRhdGluZ09wYXF1ZVZhbHVlSW5SZW5kZXJQaGFzZSA9IGZhbHNlOwogICAgfQoKICAgIGRpZFNjaGVkdWxlUmVuZGVyUGhhc2VVcGRhdGVEdXJpbmdUaGlzUGFzcyA9IGZhbHNlOwogICAgbG9jYWxJZENvdW50ZXIgPSAwOwogIH0KCiAgZnVuY3Rpb24gbW91bnRXb3JrSW5Qcm9ncmVzc0hvb2soKSB7CiAgICB2YXIgaG9vayA9IHsKICAgICAgbWVtb2l6ZWRTdGF0ZTogbnVsbCwKICAgICAgYmFzZVN0YXRlOiBudWxsLAogICAgICBiYXNlUXVldWU6IG51bGwsCiAgICAgIHF1ZXVlOiBudWxsLAogICAgICBuZXh0OiBudWxsCiAgICB9OwoKICAgIGlmICh3b3JrSW5Qcm9ncmVzc0hvb2sgPT09IG51bGwpIHsKICAgICAgLy8gVGhpcyBpcyB0aGUgZmlyc3QgaG9vayBpbiB0aGUgbGlzdAogICAgICBjdXJyZW50bHlSZW5kZXJpbmdGaWJlciQxLm1lbW9pemVkU3RhdGUgPSB3b3JrSW5Qcm9ncmVzc0hvb2sgPSBob29rOwogICAgfSBlbHNlIHsKICAgICAgLy8gQXBwZW5kIHRvIHRoZSBlbmQgb2YgdGhlIGxpc3QKICAgICAgd29ya0luUHJvZ3Jlc3NIb29rID0gd29ya0luUHJvZ3Jlc3NIb29rLm5leHQgPSBob29rOwogICAgfQoKICAgIHJldHVybiB3b3JrSW5Qcm9ncmVzc0hvb2s7CiAgfQoKICBmdW5jdGlvbiB1cGRhdGVXb3JrSW5Qcm9ncmVzc0hvb2soKSB7CiAgICAvLyBUaGlzIGZ1bmN0aW9uIGlzIHVzZWQgYm90aCBmb3IgdXBkYXRlcyBhbmQgZm9yIHJlLXJlbmRlcnMgdHJpZ2dlcmVkIGJ5IGEKICAgIC8vIHJlbmRlciBwaGFzZSB1cGRhdGUuIEl0IGFzc3VtZXMgdGhlcmUgaXMgZWl0aGVyIGEgY3VycmVudCBob29rIHdlIGNhbgogICAgLy8gY2xvbmUsIG9yIGEgd29yay1pbi1wcm9ncmVzcyBob29rIGZyb20gYSBwcmV2aW91cyByZW5kZXIgcGFzcyB0aGF0IHdlIGNhbgogICAgLy8gdXNlIGFzIGEgYmFzZS4gV2hlbiB3ZSByZWFjaCB0aGUgZW5kIG9mIHRoZSBiYXNlIGxpc3QsIHdlIG11c3Qgc3dpdGNoIHRvCiAgICAvLyB0aGUgZGlzcGF0Y2hlciB1c2VkIGZvciBtb3VudHMuCiAgICB2YXIgbmV4dEN1cnJlbnRIb29rOwoKICAgIGlmIChjdXJyZW50SG9vayA9PT0gbnVsbCkgewogICAgICB2YXIgY3VycmVudCA9IGN1cnJlbnRseVJlbmRlcmluZ0ZpYmVyJDEuYWx0ZXJuYXRlOwoKICAgICAgaWYgKGN1cnJlbnQgIT09IG51bGwpIHsKICAgICAgICBuZXh0Q3VycmVudEhvb2sgPSBjdXJyZW50Lm1lbW9pemVkU3RhdGU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbmV4dEN1cnJlbnRIb29rID0gbnVsbDsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgbmV4dEN1cnJlbnRIb29rID0gY3VycmVudEhvb2submV4dDsKICAgIH0KCiAgICB2YXIgbmV4dFdvcmtJblByb2dyZXNzSG9vazsKCiAgICBpZiAod29ya0luUHJvZ3Jlc3NIb29rID09PSBudWxsKSB7CiAgICAgIG5leHRXb3JrSW5Qcm9ncmVzc0hvb2sgPSBjdXJyZW50bHlSZW5kZXJpbmdGaWJlciQxLm1lbW9pemVkU3RhdGU7CiAgICB9IGVsc2UgewogICAgICBuZXh0V29ya0luUHJvZ3Jlc3NIb29rID0gd29ya0luUHJvZ3Jlc3NIb29rLm5leHQ7CiAgICB9CgogICAgaWYgKG5leHRXb3JrSW5Qcm9ncmVzc0hvb2sgIT09IG51bGwpIHsKICAgICAgLy8gVGhlcmUncyBhbHJlYWR5IGEgd29yay1pbi1wcm9ncmVzcy4gUmV1c2UgaXQuCiAgICAgIHdvcmtJblByb2dyZXNzSG9vayA9IG5leHRXb3JrSW5Qcm9ncmVzc0hvb2s7CiAgICAgIG5leHRXb3JrSW5Qcm9ncmVzc0hvb2sgPSB3b3JrSW5Qcm9ncmVzc0hvb2submV4dDsKICAgICAgY3VycmVudEhvb2sgPSBuZXh0Q3VycmVudEhvb2s7CiAgICB9IGVsc2UgewogICAgICAvLyBDbG9uZSBmcm9tIHRoZSBjdXJyZW50IGhvb2suCiAgICAgIGlmIChuZXh0Q3VycmVudEhvb2sgPT09IG51bGwpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlbmRlcmVkIG1vcmUgaG9va3MgdGhhbiBkdXJpbmcgdGhlIHByZXZpb3VzIHJlbmRlci4nKTsKICAgICAgfQoKICAgICAgY3VycmVudEhvb2sgPSBuZXh0Q3VycmVudEhvb2s7CiAgICAgIHZhciBuZXdIb29rID0gewogICAgICAgIG1lbW9pemVkU3RhdGU6IGN1cnJlbnRIb29rLm1lbW9pemVkU3RhdGUsCiAgICAgICAgYmFzZVN0YXRlOiBjdXJyZW50SG9vay5iYXNlU3RhdGUsCiAgICAgICAgYmFzZVF1ZXVlOiBjdXJyZW50SG9vay5iYXNlUXVldWUsCiAgICAgICAgcXVldWU6IGN1cnJlbnRIb29rLnF1ZXVlLAogICAgICAgIG5leHQ6IG51bGwKICAgICAgfTsKCiAgICAgIGlmICh3b3JrSW5Qcm9ncmVzc0hvb2sgPT09IG51bGwpIHsKICAgICAgICAvLyBUaGlzIGlzIHRoZSBmaXJzdCBob29rIGluIHRoZSBsaXN0LgogICAgICAgIGN1cnJlbnRseVJlbmRlcmluZ0ZpYmVyJDEubWVtb2l6ZWRTdGF0ZSA9IHdvcmtJblByb2dyZXNzSG9vayA9IG5ld0hvb2s7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gQXBwZW5kIHRvIHRoZSBlbmQgb2YgdGhlIGxpc3QuCiAgICAgICAgd29ya0luUHJvZ3Jlc3NIb29rID0gd29ya0luUHJvZ3Jlc3NIb29rLm5leHQgPSBuZXdIb29rOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHdvcmtJblByb2dyZXNzSG9vazsKICB9CgogIGZ1bmN0aW9uIGNyZWF0ZUZ1bmN0aW9uQ29tcG9uZW50VXBkYXRlUXVldWUoKSB7CiAgICByZXR1cm4gewogICAgICBsYXN0RWZmZWN0OiBudWxsLAogICAgICBzdG9yZXM6IG51bGwKICAgIH07CiAgfQoKICBmdW5jdGlvbiBiYXNpY1N0YXRlUmVkdWNlcihzdGF0ZSwgYWN0aW9uKSB7CiAgICAvLyAkRmxvd0ZpeE1lOiBGbG93IGRvZXNuJ3QgbGlrZSBtaXhlZCB0eXBlcwogICAgcmV0dXJuIHR5cGVvZiBhY3Rpb24gPT09ICdmdW5jdGlvbicgPyBhY3Rpb24oc3RhdGUpIDogYWN0aW9uOwogIH0KCiAgZnVuY3Rpb24gbW91bnRSZWR1Y2VyKHJlZHVjZXIsIGluaXRpYWxBcmcsIGluaXQpIHsKICAgIHZhciBob29rID0gbW91bnRXb3JrSW5Qcm9ncmVzc0hvb2soKTsKICAgIHZhciBpbml0aWFsU3RhdGU7CgogICAgaWYgKGluaXQgIT09IHVuZGVmaW5lZCkgewogICAgICBpbml0aWFsU3RhdGUgPSBpbml0KGluaXRpYWxBcmcpOwogICAgfSBlbHNlIHsKICAgICAgaW5pdGlhbFN0YXRlID0gaW5pdGlhbEFyZzsKICAgIH0KCiAgICBob29rLm1lbW9pemVkU3RhdGUgPSBob29rLmJhc2VTdGF0ZSA9IGluaXRpYWxTdGF0ZTsKICAgIHZhciBxdWV1ZSA9IHsKICAgICAgcGVuZGluZzogbnVsbCwKICAgICAgaW50ZXJsZWF2ZWQ6IG51bGwsCiAgICAgIGxhbmVzOiBOb0xhbmVzLAogICAgICBkaXNwYXRjaDogbnVsbCwKICAgICAgbGFzdFJlbmRlcmVkUmVkdWNlcjogcmVkdWNlciwKICAgICAgbGFzdFJlbmRlcmVkU3RhdGU6IGluaXRpYWxTdGF0ZQogICAgfTsKICAgIGhvb2sucXVldWUgPSBxdWV1ZTsKICAgIHZhciBkaXNwYXRjaCA9IHF1ZXVlLmRpc3BhdGNoID0gZGlzcGF0Y2hSZWR1Y2VyQWN0aW9uLmJpbmQobnVsbCwgY3VycmVudGx5UmVuZGVyaW5nRmliZXIkMSwgcXVldWUpOwogICAgcmV0dXJuIFtob29rLm1lbW9pemVkU3RhdGUsIGRpc3BhdGNoXTsKICB9CgogIGZ1bmN0aW9uIHVwZGF0ZVJlZHVjZXIocmVkdWNlciwgaW5pdGlhbEFyZywgaW5pdCkgewogICAgdmFyIGhvb2sgPSB1cGRhdGVXb3JrSW5Qcm9ncmVzc0hvb2soKTsKICAgIHZhciBxdWV1ZSA9IGhvb2sucXVldWU7CgogICAgaWYgKHF1ZXVlID09PSBudWxsKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignU2hvdWxkIGhhdmUgYSBxdWV1ZS4gVGhpcyBpcyBsaWtlbHkgYSBidWcgaW4gUmVhY3QuIFBsZWFzZSBmaWxlIGFuIGlzc3VlLicpOwogICAgfQoKICAgIHF1ZXVlLmxhc3RSZW5kZXJlZFJlZHVjZXIgPSByZWR1Y2VyOwogICAgdmFyIGN1cnJlbnQgPSBjdXJyZW50SG9vazsgLy8gVGhlIGxhc3QgcmViYXNlIHVwZGF0ZSB0aGF0IGlzIE5PVCBwYXJ0IG9mIHRoZSBiYXNlIHN0YXRlLgoKICAgIHZhciBiYXNlUXVldWUgPSBjdXJyZW50LmJhc2VRdWV1ZTsgLy8gVGhlIGxhc3QgcGVuZGluZyB1cGRhdGUgdGhhdCBoYXNuJ3QgYmVlbiBwcm9jZXNzZWQgeWV0LgoKICAgIHZhciBwZW5kaW5nUXVldWUgPSBxdWV1ZS5wZW5kaW5nOwoKICAgIGlmIChwZW5kaW5nUXVldWUgIT09IG51bGwpIHsKICAgICAgLy8gV2UgaGF2ZSBuZXcgdXBkYXRlcyB0aGF0IGhhdmVuJ3QgYmVlbiBwcm9jZXNzZWQgeWV0LgogICAgICAvLyBXZSdsbCBhZGQgdGhlbSB0byB0aGUgYmFzZSBxdWV1ZS4KICAgICAgaWYgKGJhc2VRdWV1ZSAhPT0gbnVsbCkgewogICAgICAgIC8vIE1lcmdlIHRoZSBwZW5kaW5nIHF1ZXVlIGFuZCB0aGUgYmFzZSBxdWV1ZS4KICAgICAgICB2YXIgYmFzZUZpcnN0ID0gYmFzZVF1ZXVlLm5leHQ7CiAgICAgICAgdmFyIHBlbmRpbmdGaXJzdCA9IHBlbmRpbmdRdWV1ZS5uZXh0OwogICAgICAgIGJhc2VRdWV1ZS5uZXh0ID0gcGVuZGluZ0ZpcnN0OwogICAgICAgIHBlbmRpbmdRdWV1ZS5uZXh0ID0gYmFzZUZpcnN0OwogICAgICB9CgogICAgICB7CiAgICAgICAgaWYgKGN1cnJlbnQuYmFzZVF1ZXVlICE9PSBiYXNlUXVldWUpIHsKICAgICAgICAgIC8vIEludGVybmFsIGludmFyaWFudCB0aGF0IHNob3VsZCBuZXZlciBoYXBwZW4sIGJ1dCBmZWFzaWJseSBjb3VsZCBpbgogICAgICAgICAgLy8gdGhlIGZ1dHVyZSBpZiB3ZSBpbXBsZW1lbnQgcmVzdW1pbmcsIG9yIHNvbWUgZm9ybSBvZiB0aGF0LgogICAgICAgICAgZXJyb3IoJ0ludGVybmFsIGVycm9yOiBFeHBlY3RlZCB3b3JrLWluLXByb2dyZXNzIHF1ZXVlIHRvIGJlIGEgY2xvbmUuICcgKyAnVGhpcyBpcyBhIGJ1ZyBpbiBSZWFjdC4nKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGN1cnJlbnQuYmFzZVF1ZXVlID0gYmFzZVF1ZXVlID0gcGVuZGluZ1F1ZXVlOwogICAgICBxdWV1ZS5wZW5kaW5nID0gbnVsbDsKICAgIH0KCiAgICBpZiAoYmFzZVF1ZXVlICE9PSBudWxsKSB7CiAgICAgIC8vIFdlIGhhdmUgYSBxdWV1ZSB0byBwcm9jZXNzLgogICAgICB2YXIgZmlyc3QgPSBiYXNlUXVldWUubmV4dDsKICAgICAgdmFyIG5ld1N0YXRlID0gY3VycmVudC5iYXNlU3RhdGU7CiAgICAgIHZhciBuZXdCYXNlU3RhdGUgPSBudWxsOwogICAgICB2YXIgbmV3QmFzZVF1ZXVlRmlyc3QgPSBudWxsOwogICAgICB2YXIgbmV3QmFzZVF1ZXVlTGFzdCA9IG51bGw7CiAgICAgIHZhciB1cGRhdGUgPSBmaXJzdDsKCiAgICAgIGRvIHsKICAgICAgICB2YXIgdXBkYXRlTGFuZSA9IHVwZGF0ZS5sYW5lOwoKICAgICAgICBpZiAoIWlzU3Vic2V0T2ZMYW5lcyhyZW5kZXJMYW5lcywgdXBkYXRlTGFuZSkpIHsKICAgICAgICAgIC8vIFByaW9yaXR5IGlzIGluc3VmZmljaWVudC4gU2tpcCB0aGlzIHVwZGF0ZS4gSWYgdGhpcyBpcyB0aGUgZmlyc3QKICAgICAgICAgIC8vIHNraXBwZWQgdXBkYXRlLCB0aGUgcHJldmlvdXMgdXBkYXRlL3N0YXRlIGlzIHRoZSBuZXcgYmFzZQogICAgICAgICAgLy8gdXBkYXRlL3N0YXRlLgogICAgICAgICAgdmFyIGNsb25lID0gewogICAgICAgICAgICBsYW5lOiB1cGRhdGVMYW5lLAogICAgICAgICAgICBhY3Rpb246IHVwZGF0ZS5hY3Rpb24sCiAgICAgICAgICAgIGhhc0VhZ2VyU3RhdGU6IHVwZGF0ZS5oYXNFYWdlclN0YXRlLAogICAgICAgICAgICBlYWdlclN0YXRlOiB1cGRhdGUuZWFnZXJTdGF0ZSwKICAgICAgICAgICAgbmV4dDogbnVsbAogICAgICAgICAgfTsKCiAgICAgICAgICBpZiAobmV3QmFzZVF1ZXVlTGFzdCA9PT0gbnVsbCkgewogICAgICAgICAgICBuZXdCYXNlUXVldWVGaXJzdCA9IG5ld0Jhc2VRdWV1ZUxhc3QgPSBjbG9uZTsKICAgICAgICAgICAgbmV3QmFzZVN0YXRlID0gbmV3U3RhdGU7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuZXdCYXNlUXVldWVMYXN0ID0gbmV3QmFzZVF1ZXVlTGFzdC5uZXh0ID0gY2xvbmU7CiAgICAgICAgICB9IC8vIFVwZGF0ZSB0aGUgcmVtYWluaW5nIHByaW9yaXR5IGluIHRoZSBxdWV1ZS4KICAgICAgICAgIC8vIFRPRE86IERvbid0IG5lZWQgdG8gYWNjdW11bGF0ZSB0aGlzLiBJbnN0ZWFkLCB3ZSBjYW4gcmVtb3ZlCiAgICAgICAgICAvLyByZW5kZXJMYW5lcyBmcm9tIHRoZSBvcmlnaW5hbCBsYW5lcy4KCgogICAgICAgICAgY3VycmVudGx5UmVuZGVyaW5nRmliZXIkMS5sYW5lcyA9IG1lcmdlTGFuZXMoY3VycmVudGx5UmVuZGVyaW5nRmliZXIkMS5sYW5lcywgdXBkYXRlTGFuZSk7CiAgICAgICAgICBtYXJrU2tpcHBlZFVwZGF0ZUxhbmVzKHVwZGF0ZUxhbmUpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyBUaGlzIHVwZGF0ZSBkb2VzIGhhdmUgc3VmZmljaWVudCBwcmlvcml0eS4KICAgICAgICAgIGlmIChuZXdCYXNlUXVldWVMYXN0ICE9PSBudWxsKSB7CiAgICAgICAgICAgIHZhciBfY2xvbmUgPSB7CiAgICAgICAgICAgICAgLy8gVGhpcyB1cGRhdGUgaXMgZ29pbmcgdG8gYmUgY29tbWl0dGVkIHNvIHdlIG5ldmVyIHdhbnQgdW5jb21taXQKICAgICAgICAgICAgICAvLyBpdC4gVXNpbmcgTm9MYW5lIHdvcmtzIGJlY2F1c2UgMCBpcyBhIHN1YnNldCBvZiBhbGwgYml0bWFza3MsIHNvCiAgICAgICAgICAgICAgLy8gdGhpcyB3aWxsIG5ldmVyIGJlIHNraXBwZWQgYnkgdGhlIGNoZWNrIGFib3ZlLgogICAgICAgICAgICAgIGxhbmU6IE5vTGFuZSwKICAgICAgICAgICAgICBhY3Rpb246IHVwZGF0ZS5hY3Rpb24sCiAgICAgICAgICAgICAgaGFzRWFnZXJTdGF0ZTogdXBkYXRlLmhhc0VhZ2VyU3RhdGUsCiAgICAgICAgICAgICAgZWFnZXJTdGF0ZTogdXBkYXRlLmVhZ2VyU3RhdGUsCiAgICAgICAgICAgICAgbmV4dDogbnVsbAogICAgICAgICAgICB9OwogICAgICAgICAgICBuZXdCYXNlUXVldWVMYXN0ID0gbmV3QmFzZVF1ZXVlTGFzdC5uZXh0ID0gX2Nsb25lOwogICAgICAgICAgfSAvLyBQcm9jZXNzIHRoaXMgdXBkYXRlLgoKCiAgICAgICAgICBpZiAodXBkYXRlLmhhc0VhZ2VyU3RhdGUpIHsKICAgICAgICAgICAgLy8gSWYgdGhpcyB1cGRhdGUgaXMgYSBzdGF0ZSB1cGRhdGUgKG5vdCBhIHJlZHVjZXIpIGFuZCB3YXMgcHJvY2Vzc2VkIGVhZ2VybHksCiAgICAgICAgICAgIC8vIHdlIGNhbiB1c2UgdGhlIGVhZ2VybHkgY29tcHV0ZWQgc3RhdGUKICAgICAgICAgICAgbmV3U3RhdGUgPSB1cGRhdGUuZWFnZXJTdGF0ZTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHZhciBhY3Rpb24gPSB1cGRhdGUuYWN0aW9uOwogICAgICAgICAgICBuZXdTdGF0ZSA9IHJlZHVjZXIobmV3U3RhdGUsIGFjdGlvbik7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICB1cGRhdGUgPSB1cGRhdGUubmV4dDsKICAgICAgfSB3aGlsZSAodXBkYXRlICE9PSBudWxsICYmIHVwZGF0ZSAhPT0gZmlyc3QpOwoKICAgICAgaWYgKG5ld0Jhc2VRdWV1ZUxhc3QgPT09IG51bGwpIHsKICAgICAgICBuZXdCYXNlU3RhdGUgPSBuZXdTdGF0ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICBuZXdCYXNlUXVldWVMYXN0Lm5leHQgPSBuZXdCYXNlUXVldWVGaXJzdDsKICAgICAgfSAvLyBNYXJrIHRoYXQgdGhlIGZpYmVyIHBlcmZvcm1lZCB3b3JrLCBidXQgb25seSBpZiB0aGUgbmV3IHN0YXRlIGlzCiAgICAgIC8vIGRpZmZlcmVudCBmcm9tIHRoZSBjdXJyZW50IHN0YXRlLgoKCiAgICAgIGlmICghb2JqZWN0SXMobmV3U3RhdGUsIGhvb2subWVtb2l6ZWRTdGF0ZSkpIHsKICAgICAgICBtYXJrV29ya0luUHJvZ3Jlc3NSZWNlaXZlZFVwZGF0ZSgpOwogICAgICB9CgogICAgICBob29rLm1lbW9pemVkU3RhdGUgPSBuZXdTdGF0ZTsKICAgICAgaG9vay5iYXNlU3RhdGUgPSBuZXdCYXNlU3RhdGU7CiAgICAgIGhvb2suYmFzZVF1ZXVlID0gbmV3QmFzZVF1ZXVlTGFzdDsKICAgICAgcXVldWUubGFzdFJlbmRlcmVkU3RhdGUgPSBuZXdTdGF0ZTsKICAgIH0gLy8gSW50ZXJsZWF2ZWQgdXBkYXRlcyBhcmUgc3RvcmVkIG9uIGEgc2VwYXJhdGUgcXVldWUuIFdlIGFyZW4ndCBnb2luZyB0bwogICAgLy8gcHJvY2VzcyB0aGVtIGR1cmluZyB0aGlzIHJlbmRlciwgYnV0IHdlIGRvIG5lZWQgdG8gdHJhY2sgd2hpY2ggbGFuZXMKICAgIC8vIGFyZSByZW1haW5pbmcuCgoKICAgIHZhciBsYXN0SW50ZXJsZWF2ZWQgPSBxdWV1ZS5pbnRlcmxlYXZlZDsKCiAgICBpZiAobGFzdEludGVybGVhdmVkICE9PSBudWxsKSB7CiAgICAgIHZhciBpbnRlcmxlYXZlZCA9IGxhc3RJbnRlcmxlYXZlZDsKCiAgICAgIGRvIHsKICAgICAgICB2YXIgaW50ZXJsZWF2ZWRMYW5lID0gaW50ZXJsZWF2ZWQubGFuZTsKICAgICAgICBjdXJyZW50bHlSZW5kZXJpbmdGaWJlciQxLmxhbmVzID0gbWVyZ2VMYW5lcyhjdXJyZW50bHlSZW5kZXJpbmdGaWJlciQxLmxhbmVzLCBpbnRlcmxlYXZlZExhbmUpOwogICAgICAgIG1hcmtTa2lwcGVkVXBkYXRlTGFuZXMoaW50ZXJsZWF2ZWRMYW5lKTsKICAgICAgICBpbnRlcmxlYXZlZCA9IGludGVybGVhdmVkLm5leHQ7CiAgICAgIH0gd2hpbGUgKGludGVybGVhdmVkICE9PSBsYXN0SW50ZXJsZWF2ZWQpOwogICAgfSBlbHNlIGlmIChiYXNlUXVldWUgPT09IG51bGwpIHsKICAgICAgLy8gYHF1ZXVlLmxhbmVzYCBpcyB1c2VkIGZvciBlbnRhbmdsaW5nIHRyYW5zaXRpb25zLiBXZSBjYW4gc2V0IGl0IGJhY2sgdG8KICAgICAgLy8gemVybyBvbmNlIHRoZSBxdWV1ZSBpcyBlbXB0eS4KICAgICAgcXVldWUubGFuZXMgPSBOb0xhbmVzOwogICAgfQoKICAgIHZhciBkaXNwYXRjaCA9IHF1ZXVlLmRpc3BhdGNoOwogICAgcmV0dXJuIFtob29rLm1lbW9pemVkU3RhdGUsIGRpc3BhdGNoXTsKICB9CgogIGZ1bmN0aW9uIHJlcmVuZGVyUmVkdWNlcihyZWR1Y2VyLCBpbml0aWFsQXJnLCBpbml0KSB7CiAgICB2YXIgaG9vayA9IHVwZGF0ZVdvcmtJblByb2dyZXNzSG9vaygpOwogICAgdmFyIHF1ZXVlID0gaG9vay5xdWV1ZTsKCiAgICBpZiAocXVldWUgPT09IG51bGwpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdTaG91bGQgaGF2ZSBhIHF1ZXVlLiBUaGlzIGlzIGxpa2VseSBhIGJ1ZyBpbiBSZWFjdC4gUGxlYXNlIGZpbGUgYW4gaXNzdWUuJyk7CiAgICB9CgogICAgcXVldWUubGFzdFJlbmRlcmVkUmVkdWNlciA9IHJlZHVjZXI7IC8vIFRoaXMgaXMgYSByZS1yZW5kZXIuIEFwcGx5IHRoZSBuZXcgcmVuZGVyIHBoYXNlIHVwZGF0ZXMgdG8gdGhlIHByZXZpb3VzCiAgICAvLyB3b3JrLWluLXByb2dyZXNzIGhvb2suCgogICAgdmFyIGRpc3BhdGNoID0gcXVldWUuZGlzcGF0Y2g7CiAgICB2YXIgbGFzdFJlbmRlclBoYXNlVXBkYXRlID0gcXVldWUucGVuZGluZzsKICAgIHZhciBuZXdTdGF0ZSA9IGhvb2subWVtb2l6ZWRTdGF0ZTsKCiAgICBpZiAobGFzdFJlbmRlclBoYXNlVXBkYXRlICE9PSBudWxsKSB7CiAgICAgIC8vIFRoZSBxdWV1ZSBkb2Vzbid0IHBlcnNpc3QgcGFzdCB0aGlzIHJlbmRlciBwYXNzLgogICAgICBxdWV1ZS5wZW5kaW5nID0gbnVsbDsKICAgICAgdmFyIGZpcnN0UmVuZGVyUGhhc2VVcGRhdGUgPSBsYXN0UmVuZGVyUGhhc2VVcGRhdGUubmV4dDsKICAgICAgdmFyIHVwZGF0ZSA9IGZpcnN0UmVuZGVyUGhhc2VVcGRhdGU7CgogICAgICBkbyB7CiAgICAgICAgLy8gUHJvY2VzcyB0aGlzIHJlbmRlciBwaGFzZSB1cGRhdGUuIFdlIGRvbid0IGhhdmUgdG8gY2hlY2sgdGhlCiAgICAgICAgLy8gcHJpb3JpdHkgYmVjYXVzZSBpdCB3aWxsIGFsd2F5cyBiZSB0aGUgc2FtZSBhcyB0aGUgY3VycmVudAogICAgICAgIC8vIHJlbmRlcidzLgogICAgICAgIHZhciBhY3Rpb24gPSB1cGRhdGUuYWN0aW9uOwogICAgICAgIG5ld1N0YXRlID0gcmVkdWNlcihuZXdTdGF0ZSwgYWN0aW9uKTsKICAgICAgICB1cGRhdGUgPSB1cGRhdGUubmV4dDsKICAgICAgfSB3aGlsZSAodXBkYXRlICE9PSBmaXJzdFJlbmRlclBoYXNlVXBkYXRlKTsgLy8gTWFyayB0aGF0IHRoZSBmaWJlciBwZXJmb3JtZWQgd29yaywgYnV0IG9ubHkgaWYgdGhlIG5ldyBzdGF0ZSBpcwogICAgICAvLyBkaWZmZXJlbnQgZnJvbSB0aGUgY3VycmVudCBzdGF0ZS4KCgogICAgICBpZiAoIW9iamVjdElzKG5ld1N0YXRlLCBob29rLm1lbW9pemVkU3RhdGUpKSB7CiAgICAgICAgbWFya1dvcmtJblByb2dyZXNzUmVjZWl2ZWRVcGRhdGUoKTsKICAgICAgfQoKICAgICAgaG9vay5tZW1vaXplZFN0YXRlID0gbmV3U3RhdGU7IC8vIERvbid0IHBlcnNpc3QgdGhlIHN0YXRlIGFjY3VtdWxhdGVkIGZyb20gdGhlIHJlbmRlciBwaGFzZSB1cGRhdGVzIHRvCiAgICAgIC8vIHRoZSBiYXNlIHN0YXRlIHVubGVzcyB0aGUgcXVldWUgaXMgZW1wdHkuCiAgICAgIC8vIFRPRE86IE5vdCBzdXJlIGlmIHRoaXMgaXMgdGhlIGRlc2lyZWQgc2VtYW50aWNzLCBidXQgaXQncyB3aGF0IHdlCiAgICAgIC8vIGRvIGZvciBnRFNGUC4gSSBjYW4ndCByZW1lbWJlciB3aHkuCgogICAgICBpZiAoaG9vay5iYXNlUXVldWUgPT09IG51bGwpIHsKICAgICAgICBob29rLmJhc2VTdGF0ZSA9IG5ld1N0YXRlOwogICAgICB9CgogICAgICBxdWV1ZS5sYXN0UmVuZGVyZWRTdGF0ZSA9IG5ld1N0YXRlOwogICAgfQoKICAgIHJldHVybiBbbmV3U3RhdGUsIGRpc3BhdGNoXTsKICB9CgogIGZ1bmN0aW9uIG1vdW50TXV0YWJsZVNvdXJjZShzb3VyY2UsIGdldFNuYXBzaG90LCBzdWJzY3JpYmUpIHsKICAgIHsKICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHVwZGF0ZU11dGFibGVTb3VyY2Uoc291cmNlLCBnZXRTbmFwc2hvdCwgc3Vic2NyaWJlKSB7CiAgICB7CiAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBtb3VudFN5bmNFeHRlcm5hbFN0b3JlKHN1YnNjcmliZSwgZ2V0U25hcHNob3QsIGdldFNlcnZlclNuYXBzaG90KSB7CiAgICB2YXIgZmliZXIgPSBjdXJyZW50bHlSZW5kZXJpbmdGaWJlciQxOwogICAgdmFyIGhvb2sgPSBtb3VudFdvcmtJblByb2dyZXNzSG9vaygpOwogICAgdmFyIG5leHRTbmFwc2hvdDsKICAgIHZhciBpc0h5ZHJhdGluZyA9IGdldElzSHlkcmF0aW5nKCk7CgogICAgaWYgKGlzSHlkcmF0aW5nKSB7CiAgICAgIGlmIChnZXRTZXJ2ZXJTbmFwc2hvdCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGdldFNlcnZlclNuYXBzaG90LCB3aGljaCBpcyByZXF1aXJlZCBmb3IgJyArICdzZXJ2ZXItcmVuZGVyZWQgY29udGVudC4gV2lsbCByZXZlcnQgdG8gY2xpZW50IHJlbmRlcmluZy4nKTsKICAgICAgfQoKICAgICAgbmV4dFNuYXBzaG90ID0gZ2V0U2VydmVyU25hcHNob3QoKTsKCiAgICAgIHsKICAgICAgICBpZiAoIWRpZFdhcm5VbmNhY2hlZEdldFNuYXBzaG90KSB7CiAgICAgICAgICBpZiAobmV4dFNuYXBzaG90ICE9PSBnZXRTZXJ2ZXJTbmFwc2hvdCgpKSB7CiAgICAgICAgICAgIGVycm9yKCdUaGUgcmVzdWx0IG9mIGdldFNlcnZlclNuYXBzaG90IHNob3VsZCBiZSBjYWNoZWQgdG8gYXZvaWQgYW4gaW5maW5pdGUgbG9vcCcpOwoKICAgICAgICAgICAgZGlkV2FyblVuY2FjaGVkR2V0U25hcHNob3QgPSB0cnVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgbmV4dFNuYXBzaG90ID0gZ2V0U25hcHNob3QoKTsKCiAgICAgIHsKICAgICAgICBpZiAoIWRpZFdhcm5VbmNhY2hlZEdldFNuYXBzaG90KSB7CiAgICAgICAgICB2YXIgY2FjaGVkU25hcHNob3QgPSBnZXRTbmFwc2hvdCgpOwoKICAgICAgICAgIGlmICghb2JqZWN0SXMobmV4dFNuYXBzaG90LCBjYWNoZWRTbmFwc2hvdCkpIHsKICAgICAgICAgICAgZXJyb3IoJ1RoZSByZXN1bHQgb2YgZ2V0U25hcHNob3Qgc2hvdWxkIGJlIGNhY2hlZCB0byBhdm9pZCBhbiBpbmZpbml0ZSBsb29wJyk7CgogICAgICAgICAgICBkaWRXYXJuVW5jYWNoZWRHZXRTbmFwc2hvdCA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IC8vIFVubGVzcyB3ZSdyZSByZW5kZXJpbmcgYSBibG9ja2luZyBsYW5lLCBzY2hlZHVsZSBhIGNvbnNpc3RlbmN5IGNoZWNrLgogICAgICAvLyBSaWdodCBiZWZvcmUgY29tbWl0dGluZywgd2Ugd2lsbCB3YWxrIHRoZSB0cmVlIGFuZCBjaGVjayBpZiBhbnkgb2YgdGhlCiAgICAgIC8vIHN0b3JlcyB3ZXJlIG11dGF0ZWQuCiAgICAgIC8vCiAgICAgIC8vIFdlIHdvbid0IGRvIHRoaXMgaWYgd2UncmUgaHlkcmF0aW5nIHNlcnZlci1yZW5kZXJlZCBjb250ZW50LCBiZWNhdXNlIGlmCiAgICAgIC8vIHRoZSBjb250ZW50IGlzIHN0YWxlLCBpdCdzIGFscmVhZHkgdmlzaWJsZSBhbnl3YXkuIEluc3RlYWQgd2UnbGwgcGF0Y2gKICAgICAgLy8gaXQgdXAgaW4gYSBwYXNzaXZlIGVmZmVjdC4KCgogICAgICB2YXIgcm9vdCA9IGdldFdvcmtJblByb2dyZXNzUm9vdCgpOwoKICAgICAgaWYgKHJvb3QgPT09IG51bGwpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0V4cGVjdGVkIGEgd29yay1pbi1wcm9ncmVzcyByb290LiBUaGlzIGlzIGEgYnVnIGluIFJlYWN0LiBQbGVhc2UgZmlsZSBhbiBpc3N1ZS4nKTsKICAgICAgfQoKICAgICAgaWYgKCFpbmNsdWRlc0Jsb2NraW5nTGFuZShyb290LCByZW5kZXJMYW5lcykpIHsKICAgICAgICBwdXNoU3RvcmVDb25zaXN0ZW5jeUNoZWNrKGZpYmVyLCBnZXRTbmFwc2hvdCwgbmV4dFNuYXBzaG90KTsKICAgICAgfQogICAgfSAvLyBSZWFkIHRoZSBjdXJyZW50IHNuYXBzaG90IGZyb20gdGhlIHN0b3JlIG9uIGV2ZXJ5IHJlbmRlci4gVGhpcyBicmVha3MgdGhlCiAgICAvLyBub3JtYWwgcnVsZXMgb2YgUmVhY3QsIGFuZCBvbmx5IHdvcmtzIGJlY2F1c2Ugc3RvcmUgdXBkYXRlcyBhcmUKICAgIC8vIGFsd2F5cyBzeW5jaHJvbm91cy4KCgogICAgaG9vay5tZW1vaXplZFN0YXRlID0gbmV4dFNuYXBzaG90OwogICAgdmFyIGluc3QgPSB7CiAgICAgIHZhbHVlOiBuZXh0U25hcHNob3QsCiAgICAgIGdldFNuYXBzaG90OiBnZXRTbmFwc2hvdAogICAgfTsKICAgIGhvb2sucXVldWUgPSBpbnN0OyAvLyBTY2hlZHVsZSBhbiBlZmZlY3QgdG8gc3Vic2NyaWJlIHRvIHRoZSBzdG9yZS4KCiAgICBtb3VudEVmZmVjdChzdWJzY3JpYmVUb1N0b3JlLmJpbmQobnVsbCwgZmliZXIsIGluc3QsIHN1YnNjcmliZSksIFtzdWJzY3JpYmVdKTsgLy8gU2NoZWR1bGUgYW4gZWZmZWN0IHRvIHVwZGF0ZSB0aGUgbXV0YWJsZSBpbnN0YW5jZSBmaWVsZHMuIFdlIHdpbGwgdXBkYXRlCiAgICAvLyB0aGlzIHdoZW5ldmVyIHN1YnNjcmliZSwgZ2V0U25hcHNob3QsIG9yIHZhbHVlIGNoYW5nZXMuIEJlY2F1c2UgdGhlcmUncyBubwogICAgLy8gY2xlYW4tdXAgZnVuY3Rpb24sIGFuZCB3ZSB0cmFjayB0aGUgZGVwcyBjb3JyZWN0bHksIHdlIGNhbiBjYWxsIHB1c2hFZmZlY3QKICAgIC8vIGRpcmVjdGx5LCB3aXRob3V0IHN0b3JpbmcgYW55IGFkZGl0aW9uYWwgc3RhdGUuIEZvciB0aGUgc2FtZSByZWFzb24sIHdlCiAgICAvLyBkb24ndCBuZWVkIHRvIHNldCBhIHN0YXRpYyBmbGFnLCBlaXRoZXIuCiAgICAvLyBUT0RPOiBXZSBjYW4gbW92ZSB0aGlzIHRvIHRoZSBwYXNzaXZlIHBoYXNlIG9uY2Ugd2UgYWRkIGEgcHJlLWNvbW1pdAogICAgLy8gY29uc2lzdGVuY3kgY2hlY2suIFNlZSB0aGUgbmV4dCBjb21tZW50LgoKICAgIGZpYmVyLmZsYWdzIHw9IFBhc3NpdmU7CiAgICBwdXNoRWZmZWN0KEhhc0VmZmVjdCB8IFBhc3NpdmUkMSwgdXBkYXRlU3RvcmVJbnN0YW5jZS5iaW5kKG51bGwsIGZpYmVyLCBpbnN0LCBuZXh0U25hcHNob3QsIGdldFNuYXBzaG90KSwgdW5kZWZpbmVkLCBudWxsKTsKICAgIHJldHVybiBuZXh0U25hcHNob3Q7CiAgfQoKICBmdW5jdGlvbiB1cGRhdGVTeW5jRXh0ZXJuYWxTdG9yZShzdWJzY3JpYmUsIGdldFNuYXBzaG90LCBnZXRTZXJ2ZXJTbmFwc2hvdCkgewogICAgdmFyIGZpYmVyID0gY3VycmVudGx5UmVuZGVyaW5nRmliZXIkMTsKICAgIHZhciBob29rID0gdXBkYXRlV29ya0luUHJvZ3Jlc3NIb29rKCk7IC8vIFJlYWQgdGhlIGN1cnJlbnQgc25hcHNob3QgZnJvbSB0aGUgc3RvcmUgb24gZXZlcnkgcmVuZGVyLiBUaGlzIGJyZWFrcyB0aGUKICAgIC8vIG5vcm1hbCBydWxlcyBvZiBSZWFjdCwgYW5kIG9ubHkgd29ya3MgYmVjYXVzZSBzdG9yZSB1cGRhdGVzIGFyZQogICAgLy8gYWx3YXlzIHN5bmNocm9ub3VzLgoKICAgIHZhciBuZXh0U25hcHNob3QgPSBnZXRTbmFwc2hvdCgpOwoKICAgIHsKICAgICAgaWYgKCFkaWRXYXJuVW5jYWNoZWRHZXRTbmFwc2hvdCkgewogICAgICAgIHZhciBjYWNoZWRTbmFwc2hvdCA9IGdldFNuYXBzaG90KCk7CgogICAgICAgIGlmICghb2JqZWN0SXMobmV4dFNuYXBzaG90LCBjYWNoZWRTbmFwc2hvdCkpIHsKICAgICAgICAgIGVycm9yKCdUaGUgcmVzdWx0IG9mIGdldFNuYXBzaG90IHNob3VsZCBiZSBjYWNoZWQgdG8gYXZvaWQgYW4gaW5maW5pdGUgbG9vcCcpOwoKICAgICAgICAgIGRpZFdhcm5VbmNhY2hlZEdldFNuYXBzaG90ID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICB2YXIgcHJldlNuYXBzaG90ID0gaG9vay5tZW1vaXplZFN0YXRlOwogICAgdmFyIHNuYXBzaG90Q2hhbmdlZCA9ICFvYmplY3RJcyhwcmV2U25hcHNob3QsIG5leHRTbmFwc2hvdCk7CgogICAgaWYgKHNuYXBzaG90Q2hhbmdlZCkgewogICAgICBob29rLm1lbW9pemVkU3RhdGUgPSBuZXh0U25hcHNob3Q7CiAgICAgIG1hcmtXb3JrSW5Qcm9ncmVzc1JlY2VpdmVkVXBkYXRlKCk7CiAgICB9CgogICAgdmFyIGluc3QgPSBob29rLnF1ZXVlOwogICAgdXBkYXRlRWZmZWN0KHN1YnNjcmliZVRvU3RvcmUuYmluZChudWxsLCBmaWJlciwgaW5zdCwgc3Vic2NyaWJlKSwgW3N1YnNjcmliZV0pOyAvLyBXaGVuZXZlciBnZXRTbmFwc2hvdCBvciBzdWJzY3JpYmUgY2hhbmdlcywgd2UgbmVlZCB0byBjaGVjayBpbiB0aGUKICAgIC8vIGNvbW1pdCBwaGFzZSBpZiB0aGVyZSB3YXMgYW4gaW50ZXJsZWF2ZWQgbXV0YXRpb24uIEluIGNvbmN1cnJlbnQgbW9kZQogICAgLy8gdGhpcyBjYW4gaGFwcGVuIGFsbCB0aGUgdGltZSwgYnV0IGV2ZW4gaW4gc3luY2hyb25vdXMgbW9kZSwgYW4gZWFybGllcgogICAgLy8gZWZmZWN0IG1heSBoYXZlIG11dGF0ZWQgdGhlIHN0b3JlLgoKICAgIGlmIChpbnN0LmdldFNuYXBzaG90ICE9PSBnZXRTbmFwc2hvdCB8fCBzbmFwc2hvdENoYW5nZWQgfHwgLy8gQ2hlY2sgaWYgdGhlIHN1c2JjcmliZSBmdW5jdGlvbiBjaGFuZ2VkLiBXZSBjYW4gc2F2ZSBzb21lIG1lbW9yeSBieQogICAgLy8gY2hlY2tpbmcgd2hldGhlciB3ZSBzY2hlZHVsZWQgYSBzdWJzY3JpcHRpb24gZWZmZWN0IGFib3ZlLgogICAgd29ya0luUHJvZ3Jlc3NIb29rICE9PSBudWxsICYmIHdvcmtJblByb2dyZXNzSG9vay5tZW1vaXplZFN0YXRlLnRhZyAmIEhhc0VmZmVjdCkgewogICAgICBmaWJlci5mbGFncyB8PSBQYXNzaXZlOwogICAgICBwdXNoRWZmZWN0KEhhc0VmZmVjdCB8IFBhc3NpdmUkMSwgdXBkYXRlU3RvcmVJbnN0YW5jZS5iaW5kKG51bGwsIGZpYmVyLCBpbnN0LCBuZXh0U25hcHNob3QsIGdldFNuYXBzaG90KSwgdW5kZWZpbmVkLCBudWxsKTsgLy8gVW5sZXNzIHdlJ3JlIHJlbmRlcmluZyBhIGJsb2NraW5nIGxhbmUsIHNjaGVkdWxlIGEgY29uc2lzdGVuY3kgY2hlY2suCiAgICAgIC8vIFJpZ2h0IGJlZm9yZSBjb21taXR0aW5nLCB3ZSB3aWxsIHdhbGsgdGhlIHRyZWUgYW5kIGNoZWNrIGlmIGFueSBvZiB0aGUKICAgICAgLy8gc3RvcmVzIHdlcmUgbXV0YXRlZC4KCiAgICAgIHZhciByb290ID0gZ2V0V29ya0luUHJvZ3Jlc3NSb290KCk7CgogICAgICBpZiAocm9vdCA9PT0gbnVsbCkgewogICAgICAgIHRocm93IG5ldyBFcnJvcignRXhwZWN0ZWQgYSB3b3JrLWluLXByb2dyZXNzIHJvb3QuIFRoaXMgaXMgYSBidWcgaW4gUmVhY3QuIFBsZWFzZSBmaWxlIGFuIGlzc3VlLicpOwogICAgICB9CgogICAgICBpZiAoIWluY2x1ZGVzQmxvY2tpbmdMYW5lKHJvb3QsIHJlbmRlckxhbmVzKSkgewogICAgICAgIHB1c2hTdG9yZUNvbnNpc3RlbmN5Q2hlY2soZmliZXIsIGdldFNuYXBzaG90LCBuZXh0U25hcHNob3QpOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIG5leHRTbmFwc2hvdDsKICB9CgogIGZ1bmN0aW9uIHB1c2hTdG9yZUNvbnNpc3RlbmN5Q2hlY2soZmliZXIsIGdldFNuYXBzaG90LCByZW5kZXJlZFNuYXBzaG90KSB7CiAgICBmaWJlci5mbGFncyB8PSBTdG9yZUNvbnNpc3RlbmN5OwogICAgdmFyIGNoZWNrID0gewogICAgICBnZXRTbmFwc2hvdDogZ2V0U25hcHNob3QsCiAgICAgIHZhbHVlOiByZW5kZXJlZFNuYXBzaG90CiAgICB9OwogICAgdmFyIGNvbXBvbmVudFVwZGF0ZVF1ZXVlID0gY3VycmVudGx5UmVuZGVyaW5nRmliZXIkMS51cGRhdGVRdWV1ZTsKCiAgICBpZiAoY29tcG9uZW50VXBkYXRlUXVldWUgPT09IG51bGwpIHsKICAgICAgY29tcG9uZW50VXBkYXRlUXVldWUgPSBjcmVhdGVGdW5jdGlvbkNvbXBvbmVudFVwZGF0ZVF1ZXVlKCk7CiAgICAgIGN1cnJlbnRseVJlbmRlcmluZ0ZpYmVyJDEudXBkYXRlUXVldWUgPSBjb21wb25lbnRVcGRhdGVRdWV1ZTsKICAgICAgY29tcG9uZW50VXBkYXRlUXVldWUuc3RvcmVzID0gW2NoZWNrXTsKICAgIH0gZWxzZSB7CiAgICAgIHZhciBzdG9yZXMgPSBjb21wb25lbnRVcGRhdGVRdWV1ZS5zdG9yZXM7CgogICAgICBpZiAoc3RvcmVzID09PSBudWxsKSB7CiAgICAgICAgY29tcG9uZW50VXBkYXRlUXVldWUuc3RvcmVzID0gW2NoZWNrXTsKICAgICAgfSBlbHNlIHsKICAgICAgICBzdG9yZXMucHVzaChjaGVjayk7CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIHVwZGF0ZVN0b3JlSW5zdGFuY2UoZmliZXIsIGluc3QsIG5leHRTbmFwc2hvdCwgZ2V0U25hcHNob3QpIHsKICAgIC8vIFRoZXNlIGFyZSB1cGRhdGVkIGluIHRoZSBwYXNzaXZlIHBoYXNlCiAgICBpbnN0LnZhbHVlID0gbmV4dFNuYXBzaG90OwogICAgaW5zdC5nZXRTbmFwc2hvdCA9IGdldFNuYXBzaG90OyAvLyBTb21ldGhpbmcgbWF5IGhhdmUgYmVlbiBtdXRhdGVkIGluIGJldHdlZW4gcmVuZGVyIGFuZCBjb21taXQuIFRoaXMgY291bGQKICAgIC8vIGhhdmUgYmVlbiBpbiBhbiBldmVudCB0aGF0IGZpcmVkIGJlZm9yZSB0aGUgcGFzc2l2ZSBlZmZlY3RzLCBvciBpdCBjb3VsZAogICAgLy8gaGF2ZSBiZWVuIGluIGEgbGF5b3V0IGVmZmVjdC4gSW4gdGhhdCBjYXNlLCB3ZSB3b3VsZCBoYXZlIHVzZWQgdGhlIG9sZAogICAgLy8gc25hcHNobyBhbmQgZ2V0U25hcHNob3QgdmFsdWVzIHRvIGJhaWwgb3V0LiBXZSBuZWVkIHRvIGNoZWNrIG9uZSBtb3JlIHRpbWUuCgogICAgaWYgKGNoZWNrSWZTbmFwc2hvdENoYW5nZWQoaW5zdCkpIHsKICAgICAgLy8gRm9yY2UgYSByZS1yZW5kZXIuCiAgICAgIGZvcmNlU3RvcmVSZXJlbmRlcihmaWJlcik7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBzdWJzY3JpYmVUb1N0b3JlKGZpYmVyLCBpbnN0LCBzdWJzY3JpYmUpIHsKICAgIHZhciBoYW5kbGVTdG9yZUNoYW5nZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgLy8gVGhlIHN0b3JlIGNoYW5nZWQuIENoZWNrIGlmIHRoZSBzbmFwc2hvdCBjaGFuZ2VkIHNpbmNlIHRoZSBsYXN0IHRpbWUgd2UKICAgICAgLy8gcmVhZCBmcm9tIHRoZSBzdG9yZS4KICAgICAgaWYgKGNoZWNrSWZTbmFwc2hvdENoYW5nZWQoaW5zdCkpIHsKICAgICAgICAvLyBGb3JjZSBhIHJlLXJlbmRlci4KICAgICAgICBmb3JjZVN0b3JlUmVyZW5kZXIoZmliZXIpOwogICAgICB9CiAgICB9OyAvLyBTdWJzY3JpYmUgdG8gdGhlIHN0b3JlIGFuZCByZXR1cm4gYSBjbGVhbi11cCBmdW5jdGlvbi4KCgogICAgcmV0dXJuIHN1YnNjcmliZShoYW5kbGVTdG9yZUNoYW5nZSk7CiAgfQoKICBmdW5jdGlvbiBjaGVja0lmU25hcHNob3RDaGFuZ2VkKGluc3QpIHsKICAgIHZhciBsYXRlc3RHZXRTbmFwc2hvdCA9IGluc3QuZ2V0U25hcHNob3Q7CiAgICB2YXIgcHJldlZhbHVlID0gaW5zdC52YWx1ZTsKCiAgICB0cnkgewogICAgICB2YXIgbmV4dFZhbHVlID0gbGF0ZXN0R2V0U25hcHNob3QoKTsKICAgICAgcmV0dXJuICFvYmplY3RJcyhwcmV2VmFsdWUsIG5leHRWYWx1ZSk7CiAgICB9IGNhdGNoIChlcnJvcikgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGZvcmNlU3RvcmVSZXJlbmRlcihmaWJlcikgewogICAgdmFyIHJvb3QgPSBlbnF1ZXVlQ29uY3VycmVudFJlbmRlckZvckxhbmUoZmliZXIsIFN5bmNMYW5lKTsKCiAgICBpZiAocm9vdCAhPT0gbnVsbCkgewogICAgICBzY2hlZHVsZVVwZGF0ZU9uRmliZXIocm9vdCwgZmliZXIsIFN5bmNMYW5lLCBOb1RpbWVzdGFtcCk7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBtb3VudFN0YXRlKGluaXRpYWxTdGF0ZSkgewogICAgdmFyIGhvb2sgPSBtb3VudFdvcmtJblByb2dyZXNzSG9vaygpOwoKICAgIGlmICh0eXBlb2YgaW5pdGlhbFN0YXRlID09PSAnZnVuY3Rpb24nKSB7CiAgICAgIC8vICRGbG93Rml4TWU6IEZsb3cgZG9lc24ndCBsaWtlIG1peGVkIHR5cGVzCiAgICAgIGluaXRpYWxTdGF0ZSA9IGluaXRpYWxTdGF0ZSgpOwogICAgfQoKICAgIGhvb2subWVtb2l6ZWRTdGF0ZSA9IGhvb2suYmFzZVN0YXRlID0gaW5pdGlhbFN0YXRlOwogICAgdmFyIHF1ZXVlID0gewogICAgICBwZW5kaW5nOiBudWxsLAogICAgICBpbnRlcmxlYXZlZDogbnVsbCwKICAgICAgbGFuZXM6IE5vTGFuZXMsCiAgICAgIGRpc3BhdGNoOiBudWxsLAogICAgICBsYXN0UmVuZGVyZWRSZWR1Y2VyOiBiYXNpY1N0YXRlUmVkdWNlciwKICAgICAgbGFzdFJlbmRlcmVkU3RhdGU6IGluaXRpYWxTdGF0ZQogICAgfTsKICAgIGhvb2sucXVldWUgPSBxdWV1ZTsKICAgIHZhciBkaXNwYXRjaCA9IHF1ZXVlLmRpc3BhdGNoID0gZGlzcGF0Y2hTZXRTdGF0ZS5iaW5kKG51bGwsIGN1cnJlbnRseVJlbmRlcmluZ0ZpYmVyJDEsIHF1ZXVlKTsKICAgIHJldHVybiBbaG9vay5tZW1vaXplZFN0YXRlLCBkaXNwYXRjaF07CiAgfQoKICBmdW5jdGlvbiB1cGRhdGVTdGF0ZShpbml0aWFsU3RhdGUpIHsKICAgIHJldHVybiB1cGRhdGVSZWR1Y2VyKGJhc2ljU3RhdGVSZWR1Y2VyKTsKICB9CgogIGZ1bmN0aW9uIHJlcmVuZGVyU3RhdGUoaW5pdGlhbFN0YXRlKSB7CiAgICByZXR1cm4gcmVyZW5kZXJSZWR1Y2VyKGJhc2ljU3RhdGVSZWR1Y2VyKTsKICB9CgogIGZ1bmN0aW9uIHB1c2hFZmZlY3QodGFnLCBjcmVhdGUsIGRlc3Ryb3ksIGRlcHMpIHsKICAgIHZhciBlZmZlY3QgPSB7CiAgICAgIHRhZzogdGFnLAogICAgICBjcmVhdGU6IGNyZWF0ZSwKICAgICAgZGVzdHJveTogZGVzdHJveSwKICAgICAgZGVwczogZGVwcywKICAgICAgLy8gQ2lyY3VsYXIKICAgICAgbmV4dDogbnVsbAogICAgfTsKICAgIHZhciBjb21wb25lbnRVcGRhdGVRdWV1ZSA9IGN1cnJlbnRseVJlbmRlcmluZ0ZpYmVyJDEudXBkYXRlUXVldWU7CgogICAgaWYgKGNvbXBvbmVudFVwZGF0ZVF1ZXVlID09PSBudWxsKSB7CiAgICAgIGNvbXBvbmVudFVwZGF0ZVF1ZXVlID0gY3JlYXRlRnVuY3Rpb25Db21wb25lbnRVcGRhdGVRdWV1ZSgpOwogICAgICBjdXJyZW50bHlSZW5kZXJpbmdGaWJlciQxLnVwZGF0ZVF1ZXVlID0gY29tcG9uZW50VXBkYXRlUXVldWU7CiAgICAgIGNvbXBvbmVudFVwZGF0ZVF1ZXVlLmxhc3RFZmZlY3QgPSBlZmZlY3QubmV4dCA9IGVmZmVjdDsKICAgIH0gZWxzZSB7CiAgICAgIHZhciBsYXN0RWZmZWN0ID0gY29tcG9uZW50VXBkYXRlUXVldWUubGFzdEVmZmVjdDsKCiAgICAgIGlmIChsYXN0RWZmZWN0ID09PSBudWxsKSB7CiAgICAgICAgY29tcG9uZW50VXBkYXRlUXVldWUubGFzdEVmZmVjdCA9IGVmZmVjdC5uZXh0ID0gZWZmZWN0OwogICAgICB9IGVsc2UgewogICAgICAgIHZhciBmaXJzdEVmZmVjdCA9IGxhc3RFZmZlY3QubmV4dDsKICAgICAgICBsYXN0RWZmZWN0Lm5leHQgPSBlZmZlY3Q7CiAgICAgICAgZWZmZWN0Lm5leHQgPSBmaXJzdEVmZmVjdDsKICAgICAgICBjb21wb25lbnRVcGRhdGVRdWV1ZS5sYXN0RWZmZWN0ID0gZWZmZWN0OwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIGVmZmVjdDsKICB9CgogIGZ1bmN0aW9uIG1vdW50UmVmKGluaXRpYWxWYWx1ZSkgewogICAgdmFyIGhvb2sgPSBtb3VudFdvcmtJblByb2dyZXNzSG9vaygpOwoKICAgIHsKICAgICAgdmFyIF9yZWYyID0gewogICAgICAgIGN1cnJlbnQ6IGluaXRpYWxWYWx1ZQogICAgICB9OwogICAgICBob29rLm1lbW9pemVkU3RhdGUgPSBfcmVmMjsKICAgICAgcmV0dXJuIF9yZWYyOwogICAgfQogIH0KCiAgZnVuY3Rpb24gdXBkYXRlUmVmKGluaXRpYWxWYWx1ZSkgewogICAgdmFyIGhvb2sgPSB1cGRhdGVXb3JrSW5Qcm9ncmVzc0hvb2soKTsKICAgIHJldHVybiBob29rLm1lbW9pemVkU3RhdGU7CiAgfQoKICBmdW5jdGlvbiBtb3VudEVmZmVjdEltcGwoZmliZXJGbGFncywgaG9va0ZsYWdzLCBjcmVhdGUsIGRlcHMpIHsKICAgIHZhciBob29rID0gbW91bnRXb3JrSW5Qcm9ncmVzc0hvb2soKTsKICAgIHZhciBuZXh0RGVwcyA9IGRlcHMgPT09IHVuZGVmaW5lZCA/IG51bGwgOiBkZXBzOwogICAgY3VycmVudGx5UmVuZGVyaW5nRmliZXIkMS5mbGFncyB8PSBmaWJlckZsYWdzOwogICAgaG9vay5tZW1vaXplZFN0YXRlID0gcHVzaEVmZmVjdChIYXNFZmZlY3QgfCBob29rRmxhZ3MsIGNyZWF0ZSwgdW5kZWZpbmVkLCBuZXh0RGVwcyk7CiAgfQoKICBmdW5jdGlvbiB1cGRhdGVFZmZlY3RJbXBsKGZpYmVyRmxhZ3MsIGhvb2tGbGFncywgY3JlYXRlLCBkZXBzKSB7CiAgICB2YXIgaG9vayA9IHVwZGF0ZVdvcmtJblByb2dyZXNzSG9vaygpOwogICAgdmFyIG5leHREZXBzID0gZGVwcyA9PT0gdW5kZWZpbmVkID8gbnVsbCA6IGRlcHM7CiAgICB2YXIgZGVzdHJveSA9IHVuZGVmaW5lZDsKCiAgICBpZiAoY3VycmVudEhvb2sgIT09IG51bGwpIHsKICAgICAgdmFyIHByZXZFZmZlY3QgPSBjdXJyZW50SG9vay5tZW1vaXplZFN0YXRlOwogICAgICBkZXN0cm95ID0gcHJldkVmZmVjdC5kZXN0cm95OwoKICAgICAgaWYgKG5leHREZXBzICE9PSBudWxsKSB7CiAgICAgICAgdmFyIHByZXZEZXBzID0gcHJldkVmZmVjdC5kZXBzOwoKICAgICAgICBpZiAoYXJlSG9va0lucHV0c0VxdWFsKG5leHREZXBzLCBwcmV2RGVwcykpIHsKICAgICAgICAgIGhvb2subWVtb2l6ZWRTdGF0ZSA9IHB1c2hFZmZlY3QoaG9va0ZsYWdzLCBjcmVhdGUsIGRlc3Ryb3ksIG5leHREZXBzKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBjdXJyZW50bHlSZW5kZXJpbmdGaWJlciQxLmZsYWdzIHw9IGZpYmVyRmxhZ3M7CiAgICBob29rLm1lbW9pemVkU3RhdGUgPSBwdXNoRWZmZWN0KEhhc0VmZmVjdCB8IGhvb2tGbGFncywgY3JlYXRlLCBkZXN0cm95LCBuZXh0RGVwcyk7CiAgfQoKICBmdW5jdGlvbiBtb3VudEVmZmVjdChjcmVhdGUsIGRlcHMpIHsKICAgIGlmICggKGN1cnJlbnRseVJlbmRlcmluZ0ZpYmVyJDEubW9kZSAmIFN0cmljdEVmZmVjdHNNb2RlKSAhPT0gTm9Nb2RlKSB7CiAgICAgIHJldHVybiBtb3VudEVmZmVjdEltcGwoTW91bnRQYXNzaXZlRGV2IHwgUGFzc2l2ZSB8IFBhc3NpdmVTdGF0aWMsIFBhc3NpdmUkMSwgY3JlYXRlLCBkZXBzKTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBtb3VudEVmZmVjdEltcGwoUGFzc2l2ZSB8IFBhc3NpdmVTdGF0aWMsIFBhc3NpdmUkMSwgY3JlYXRlLCBkZXBzKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHVwZGF0ZUVmZmVjdChjcmVhdGUsIGRlcHMpIHsKICAgIHJldHVybiB1cGRhdGVFZmZlY3RJbXBsKFBhc3NpdmUsIFBhc3NpdmUkMSwgY3JlYXRlLCBkZXBzKTsKICB9CgogIGZ1bmN0aW9uIG1vdW50SW5zZXJ0aW9uRWZmZWN0KGNyZWF0ZSwgZGVwcykgewogICAgcmV0dXJuIG1vdW50RWZmZWN0SW1wbChVcGRhdGUsIEluc2VydGlvbiwgY3JlYXRlLCBkZXBzKTsKICB9CgogIGZ1bmN0aW9uIHVwZGF0ZUluc2VydGlvbkVmZmVjdChjcmVhdGUsIGRlcHMpIHsKICAgIHJldHVybiB1cGRhdGVFZmZlY3RJbXBsKFVwZGF0ZSwgSW5zZXJ0aW9uLCBjcmVhdGUsIGRlcHMpOwogIH0KCiAgZnVuY3Rpb24gbW91bnRMYXlvdXRFZmZlY3QoY3JlYXRlLCBkZXBzKSB7CiAgICB2YXIgZmliZXJGbGFncyA9IFVwZGF0ZTsKCiAgICB7CiAgICAgIGZpYmVyRmxhZ3MgfD0gTGF5b3V0U3RhdGljOwogICAgfQoKICAgIGlmICggKGN1cnJlbnRseVJlbmRlcmluZ0ZpYmVyJDEubW9kZSAmIFN0cmljdEVmZmVjdHNNb2RlKSAhPT0gTm9Nb2RlKSB7CiAgICAgIGZpYmVyRmxhZ3MgfD0gTW91bnRMYXlvdXREZXY7CiAgICB9CgogICAgcmV0dXJuIG1vdW50RWZmZWN0SW1wbChmaWJlckZsYWdzLCBMYXlvdXQsIGNyZWF0ZSwgZGVwcyk7CiAgfQoKICBmdW5jdGlvbiB1cGRhdGVMYXlvdXRFZmZlY3QoY3JlYXRlLCBkZXBzKSB7CiAgICByZXR1cm4gdXBkYXRlRWZmZWN0SW1wbChVcGRhdGUsIExheW91dCwgY3JlYXRlLCBkZXBzKTsKICB9CgogIGZ1bmN0aW9uIGltcGVyYXRpdmVIYW5kbGVFZmZlY3QoY3JlYXRlLCByZWYpIHsKICAgIGlmICh0eXBlb2YgcmVmID09PSAnZnVuY3Rpb24nKSB7CiAgICAgIHZhciByZWZDYWxsYmFjayA9IHJlZjsKCiAgICAgIHZhciBfaW5zdCA9IGNyZWF0ZSgpOwoKICAgICAgcmVmQ2FsbGJhY2soX2luc3QpOwogICAgICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICAgIHJlZkNhbGxiYWNrKG51bGwpOwogICAgICB9OwogICAgfSBlbHNlIGlmIChyZWYgIT09IG51bGwgJiYgcmVmICE9PSB1bmRlZmluZWQpIHsKICAgICAgdmFyIHJlZk9iamVjdCA9IHJlZjsKCiAgICAgIHsKICAgICAgICBpZiAoIXJlZk9iamVjdC5oYXNPd25Qcm9wZXJ0eSgnY3VycmVudCcpKSB7CiAgICAgICAgICBlcnJvcignRXhwZWN0ZWQgdXNlSW1wZXJhdGl2ZUhhbmRsZSgpIGZpcnN0IGFyZ3VtZW50IHRvIGVpdGhlciBiZSBhICcgKyAncmVmIGNhbGxiYWNrIG9yIFJlYWN0LmNyZWF0ZVJlZigpIG9iamVjdC4gSW5zdGVhZCByZWNlaXZlZDogJXMuJywgJ2FuIG9iamVjdCB3aXRoIGtleXMgeycgKyBPYmplY3Qua2V5cyhyZWZPYmplY3QpLmpvaW4oJywgJykgKyAnfScpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdmFyIF9pbnN0MiA9IGNyZWF0ZSgpOwoKICAgICAgcmVmT2JqZWN0LmN1cnJlbnQgPSBfaW5zdDI7CiAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmVmT2JqZWN0LmN1cnJlbnQgPSBudWxsOwogICAgICB9OwogICAgfQogIH0KCiAgZnVuY3Rpb24gbW91bnRJbXBlcmF0aXZlSGFuZGxlKHJlZiwgY3JlYXRlLCBkZXBzKSB7CiAgICB7CiAgICAgIGlmICh0eXBlb2YgY3JlYXRlICE9PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgZXJyb3IoJ0V4cGVjdGVkIHVzZUltcGVyYXRpdmVIYW5kbGUoKSBzZWNvbmQgYXJndW1lbnQgdG8gYmUgYSBmdW5jdGlvbiAnICsgJ3RoYXQgY3JlYXRlcyBhIGhhbmRsZS4gSW5zdGVhZCByZWNlaXZlZDogJXMuJywgY3JlYXRlICE9PSBudWxsID8gdHlwZW9mIGNyZWF0ZSA6ICdudWxsJyk7CiAgICAgIH0KICAgIH0gLy8gVE9ETzogSWYgZGVwcyBhcmUgcHJvdmlkZWQsIHNob3VsZCB3ZSBza2lwIGNvbXBhcmluZyB0aGUgcmVmIGl0c2VsZj8KCgogICAgdmFyIGVmZmVjdERlcHMgPSBkZXBzICE9PSBudWxsICYmIGRlcHMgIT09IHVuZGVmaW5lZCA/IGRlcHMuY29uY2F0KFtyZWZdKSA6IG51bGw7CiAgICB2YXIgZmliZXJGbGFncyA9IFVwZGF0ZTsKCiAgICB7CiAgICAgIGZpYmVyRmxhZ3MgfD0gTGF5b3V0U3RhdGljOwogICAgfQoKICAgIGlmICggKGN1cnJlbnRseVJlbmRlcmluZ0ZpYmVyJDEubW9kZSAmIFN0cmljdEVmZmVjdHNNb2RlKSAhPT0gTm9Nb2RlKSB7CiAgICAgIGZpYmVyRmxhZ3MgfD0gTW91bnRMYXlvdXREZXY7CiAgICB9CgogICAgcmV0dXJuIG1vdW50RWZmZWN0SW1wbChmaWJlckZsYWdzLCBMYXlvdXQsIGltcGVyYXRpdmVIYW5kbGVFZmZlY3QuYmluZChudWxsLCBjcmVhdGUsIHJlZiksIGVmZmVjdERlcHMpOwogIH0KCiAgZnVuY3Rpb24gdXBkYXRlSW1wZXJhdGl2ZUhhbmRsZShyZWYsIGNyZWF0ZSwgZGVwcykgewogICAgewogICAgICBpZiAodHlwZW9mIGNyZWF0ZSAhPT0gJ2Z1bmN0aW9uJykgewogICAgICAgIGVycm9yKCdFeHBlY3RlZCB1c2VJbXBlcmF0aXZlSGFuZGxlKCkgc2Vjb25kIGFyZ3VtZW50IHRvIGJlIGEgZnVuY3Rpb24gJyArICd0aGF0IGNyZWF0ZXMgYSBoYW5kbGUuIEluc3RlYWQgcmVjZWl2ZWQ6ICVzLicsIGNyZWF0ZSAhPT0gbnVsbCA/IHR5cGVvZiBjcmVhdGUgOiAnbnVsbCcpOwogICAgICB9CiAgICB9IC8vIFRPRE86IElmIGRlcHMgYXJlIHByb3ZpZGVkLCBzaG91bGQgd2Ugc2tpcCBjb21wYXJpbmcgdGhlIHJlZiBpdHNlbGY/CgoKICAgIHZhciBlZmZlY3REZXBzID0gZGVwcyAhPT0gbnVsbCAmJiBkZXBzICE9PSB1bmRlZmluZWQgPyBkZXBzLmNvbmNhdChbcmVmXSkgOiBudWxsOwogICAgcmV0dXJuIHVwZGF0ZUVmZmVjdEltcGwoVXBkYXRlLCBMYXlvdXQsIGltcGVyYXRpdmVIYW5kbGVFZmZlY3QuYmluZChudWxsLCBjcmVhdGUsIHJlZiksIGVmZmVjdERlcHMpOwogIH0KCiAgZnVuY3Rpb24gbW91bnREZWJ1Z1ZhbHVlKHZhbHVlLCBmb3JtYXR0ZXJGbikgey8vIFRoaXMgaG9vayBpcyBub3JtYWxseSBhIG5vLW9wLgogICAgLy8gVGhlIHJlYWN0LWRlYnVnLWhvb2tzIHBhY2thZ2UgaW5qZWN0cyBpdHMgb3duIGltcGxlbWVudGF0aW9uCiAgICAvLyBzbyB0aGF0IGUuZy4gRGV2VG9vbHMgY2FuIGRpc3BsYXkgY3VzdG9tIGhvb2sgdmFsdWVzLgogIH0KCiAgdmFyIHVwZGF0ZURlYnVnVmFsdWUgPSBtb3VudERlYnVnVmFsdWU7CgogIGZ1bmN0aW9uIG1vdW50Q2FsbGJhY2soY2FsbGJhY2ssIGRlcHMpIHsKICAgIHZhciBob29rID0gbW91bnRXb3JrSW5Qcm9ncmVzc0hvb2soKTsKICAgIHZhciBuZXh0RGVwcyA9IGRlcHMgPT09IHVuZGVmaW5lZCA/IG51bGwgOiBkZXBzOwogICAgaG9vay5tZW1vaXplZFN0YXRlID0gW2NhbGxiYWNrLCBuZXh0RGVwc107CiAgICByZXR1cm4gY2FsbGJhY2s7CiAgfQoKICBmdW5jdGlvbiB1cGRhdGVDYWxsYmFjayhjYWxsYmFjaywgZGVwcykgewogICAgdmFyIGhvb2sgPSB1cGRhdGVXb3JrSW5Qcm9ncmVzc0hvb2soKTsKICAgIHZhciBuZXh0RGVwcyA9IGRlcHMgPT09IHVuZGVmaW5lZCA/IG51bGwgOiBkZXBzOwogICAgdmFyIHByZXZTdGF0ZSA9IGhvb2subWVtb2l6ZWRTdGF0ZTsKCiAgICBpZiAocHJldlN0YXRlICE9PSBudWxsKSB7CiAgICAgIGlmIChuZXh0RGVwcyAhPT0gbnVsbCkgewogICAgICAgIHZhciBwcmV2RGVwcyA9IHByZXZTdGF0ZVsxXTsKCiAgICAgICAgaWYgKGFyZUhvb2tJbnB1dHNFcXVhbChuZXh0RGVwcywgcHJldkRlcHMpKSB7CiAgICAgICAgICByZXR1cm4gcHJldlN0YXRlWzBdOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGhvb2subWVtb2l6ZWRTdGF0ZSA9IFtjYWxsYmFjaywgbmV4dERlcHNdOwogICAgcmV0dXJuIGNhbGxiYWNrOwogIH0KCiAgZnVuY3Rpb24gbW91bnRNZW1vKG5leHRDcmVhdGUsIGRlcHMpIHsKICAgIHZhciBob29rID0gbW91bnRXb3JrSW5Qcm9ncmVzc0hvb2soKTsKICAgIHZhciBuZXh0RGVwcyA9IGRlcHMgPT09IHVuZGVmaW5lZCA/IG51bGwgOiBkZXBzOwogICAgdmFyIG5leHRWYWx1ZSA9IG5leHRDcmVhdGUoKTsKICAgIGhvb2subWVtb2l6ZWRTdGF0ZSA9IFtuZXh0VmFsdWUsIG5leHREZXBzXTsKICAgIHJldHVybiBuZXh0VmFsdWU7CiAgfQoKICBmdW5jdGlvbiB1cGRhdGVNZW1vKG5leHRDcmVhdGUsIGRlcHMpIHsKICAgIHZhciBob29rID0gdXBkYXRlV29ya0luUHJvZ3Jlc3NIb29rKCk7CiAgICB2YXIgbmV4dERlcHMgPSBkZXBzID09PSB1bmRlZmluZWQgPyBudWxsIDogZGVwczsKICAgIHZhciBwcmV2U3RhdGUgPSBob29rLm1lbW9pemVkU3RhdGU7CgogICAgaWYgKHByZXZTdGF0ZSAhPT0gbnVsbCkgewogICAgICAvLyBBc3N1bWUgdGhlc2UgYXJlIGRlZmluZWQuIElmIHRoZXkncmUgbm90LCBhcmVIb29rSW5wdXRzRXF1YWwgd2lsbCB3YXJuLgogICAgICBpZiAobmV4dERlcHMgIT09IG51bGwpIHsKICAgICAgICB2YXIgcHJldkRlcHMgPSBwcmV2U3RhdGVbMV07CgogICAgICAgIGlmIChhcmVIb29rSW5wdXRzRXF1YWwobmV4dERlcHMsIHByZXZEZXBzKSkgewogICAgICAgICAgcmV0dXJuIHByZXZTdGF0ZVswXTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICB2YXIgbmV4dFZhbHVlID0gbmV4dENyZWF0ZSgpOwogICAgaG9vay5tZW1vaXplZFN0YXRlID0gW25leHRWYWx1ZSwgbmV4dERlcHNdOwogICAgcmV0dXJuIG5leHRWYWx1ZTsKICB9CgogIGZ1bmN0aW9uIG1vdW50RGVmZXJyZWRWYWx1ZSh2YWx1ZSkgewogICAgdmFyIGhvb2sgPSBtb3VudFdvcmtJblByb2dyZXNzSG9vaygpOwogICAgaG9vay5tZW1vaXplZFN0YXRlID0gdmFsdWU7CiAgICByZXR1cm4gdmFsdWU7CiAgfQoKICBmdW5jdGlvbiB1cGRhdGVEZWZlcnJlZFZhbHVlKHZhbHVlKSB7CiAgICB2YXIgaG9vayA9IHVwZGF0ZVdvcmtJblByb2dyZXNzSG9vaygpOwogICAgdmFyIHJlc29sdmVkQ3VycmVudEhvb2sgPSBjdXJyZW50SG9vazsKICAgIHZhciBwcmV2VmFsdWUgPSByZXNvbHZlZEN1cnJlbnRIb29rLm1lbW9pemVkU3RhdGU7CiAgICByZXR1cm4gdXBkYXRlRGVmZXJyZWRWYWx1ZUltcGwoaG9vaywgcHJldlZhbHVlLCB2YWx1ZSk7CiAgfQoKICBmdW5jdGlvbiByZXJlbmRlckRlZmVycmVkVmFsdWUodmFsdWUpIHsKICAgIHZhciBob29rID0gdXBkYXRlV29ya0luUHJvZ3Jlc3NIb29rKCk7CgogICAgaWYgKGN1cnJlbnRIb29rID09PSBudWxsKSB7CiAgICAgIC8vIFRoaXMgaXMgYSByZXJlbmRlciBkdXJpbmcgYSBtb3VudC4KICAgICAgaG9vay5tZW1vaXplZFN0YXRlID0gdmFsdWU7CiAgICAgIHJldHVybiB2YWx1ZTsKICAgIH0gZWxzZSB7CiAgICAgIC8vIFRoaXMgaXMgYSByZXJlbmRlciBkdXJpbmcgYW4gdXBkYXRlLgogICAgICB2YXIgcHJldlZhbHVlID0gY3VycmVudEhvb2subWVtb2l6ZWRTdGF0ZTsKICAgICAgcmV0dXJuIHVwZGF0ZURlZmVycmVkVmFsdWVJbXBsKGhvb2ssIHByZXZWYWx1ZSwgdmFsdWUpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gdXBkYXRlRGVmZXJyZWRWYWx1ZUltcGwoaG9vaywgcHJldlZhbHVlLCB2YWx1ZSkgewogICAgdmFyIHNob3VsZERlZmVyVmFsdWUgPSAhaW5jbHVkZXNPbmx5Tm9uVXJnZW50TGFuZXMocmVuZGVyTGFuZXMpOwoKICAgIGlmIChzaG91bGREZWZlclZhbHVlKSB7CiAgICAgIC8vIFRoaXMgaXMgYW4gdXJnZW50IHVwZGF0ZS4gSWYgdGhlIHZhbHVlIGhhcyBjaGFuZ2VkLCBrZWVwIHVzaW5nIHRoZQogICAgICAvLyBwcmV2aW91cyB2YWx1ZSBhbmQgc3Bhd24gYSBkZWZlcnJlZCByZW5kZXIgdG8gdXBkYXRlIGl0IGxhdGVyLgogICAgICBpZiAoIW9iamVjdElzKHZhbHVlLCBwcmV2VmFsdWUpKSB7CiAgICAgICAgLy8gU2NoZWR1bGUgYSBkZWZlcnJlZCByZW5kZXIKICAgICAgICB2YXIgZGVmZXJyZWRMYW5lID0gY2xhaW1OZXh0VHJhbnNpdGlvbkxhbmUoKTsKICAgICAgICBjdXJyZW50bHlSZW5kZXJpbmdGaWJlciQxLmxhbmVzID0gbWVyZ2VMYW5lcyhjdXJyZW50bHlSZW5kZXJpbmdGaWJlciQxLmxhbmVzLCBkZWZlcnJlZExhbmUpOwogICAgICAgIG1hcmtTa2lwcGVkVXBkYXRlTGFuZXMoZGVmZXJyZWRMYW5lKTsgLy8gU2V0IHRoaXMgdG8gdHJ1ZSB0byBpbmRpY2F0ZSB0aGF0IHRoZSByZW5kZXJlZCB2YWx1ZSBpcyBpbmNvbnNpc3RlbnQKICAgICAgICAvLyBmcm9tIHRoZSBsYXRlc3QgdmFsdWUuIFRoZSBuYW1lICJiYXNlU3RhdGUiIGRvZXNuJ3QgcmVhbGx5IG1hdGNoIGhvdyB3ZQogICAgICAgIC8vIHVzZSBpdCBiZWNhdXNlIHdlJ3JlIHJldXNpbmcgYSBzdGF0ZSBob29rIGZpZWxkIGluc3RlYWQgb2YgY3JlYXRpbmcgYQogICAgICAgIC8vIG5ldyBvbmUuCgogICAgICAgIGhvb2suYmFzZVN0YXRlID0gdHJ1ZTsKICAgICAgfSAvLyBSZXVzZSB0aGUgcHJldmlvdXMgdmFsdWUKCgogICAgICByZXR1cm4gcHJldlZhbHVlOwogICAgfSBlbHNlIHsKICAgICAgLy8gVGhpcyBpcyBub3QgYW4gdXJnZW50IHVwZGF0ZSwgc28gd2UgY2FuIHVzZSB0aGUgbGF0ZXN0IHZhbHVlIHJlZ2FyZGxlc3MKICAgICAgLy8gb2Ygd2hhdCBpdCBpcy4gTm8gbmVlZCB0byBkZWZlciBpdC4KICAgICAgLy8gSG93ZXZlciwgaWYgd2UncmUgY3VycmVudGx5IGluc2lkZSBhIHNwYXduZWQgcmVuZGVyLCB0aGVuIHdlIG5lZWQgdG8gbWFyawogICAgICAvLyB0aGlzIGFzIGFuIHVwZGF0ZSB0byBwcmV2ZW50IHRoZSBmaWJlciBmcm9tIGJhaWxpbmcgb3V0LgogICAgICAvLwogICAgICAvLyBgYmFzZVN0YXRlYCBpcyB0cnVlIHdoZW4gdGhlIGN1cnJlbnQgdmFsdWUgaXMgZGlmZmVyZW50IGZyb20gdGhlIHJlbmRlcmVkCiAgICAgIC8vIHZhbHVlLiBUaGUgbmFtZSBkb2Vzbid0IHJlYWxseSBtYXRjaCBob3cgd2UgdXNlIGl0IGJlY2F1c2Ugd2UncmUgcmV1c2luZwogICAgICAvLyBhIHN0YXRlIGhvb2sgZmllbGQgaW5zdGVhZCBvZiBjcmVhdGluZyBhIG5ldyBvbmUuCiAgICAgIGlmIChob29rLmJhc2VTdGF0ZSkgewogICAgICAgIC8vIEZsaXAgdGhpcyBiYWNrIHRvIGZhbHNlLgogICAgICAgIGhvb2suYmFzZVN0YXRlID0gZmFsc2U7CiAgICAgICAgbWFya1dvcmtJblByb2dyZXNzUmVjZWl2ZWRVcGRhdGUoKTsKICAgICAgfQoKICAgICAgaG9vay5tZW1vaXplZFN0YXRlID0gdmFsdWU7CiAgICAgIHJldHVybiB2YWx1ZTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHN0YXJ0VHJhbnNpdGlvbihzZXRQZW5kaW5nLCBjYWxsYmFjaywgb3B0aW9ucykgewogICAgdmFyIHByZXZpb3VzUHJpb3JpdHkgPSBnZXRDdXJyZW50VXBkYXRlUHJpb3JpdHkoKTsKICAgIHNldEN1cnJlbnRVcGRhdGVQcmlvcml0eShoaWdoZXJFdmVudFByaW9yaXR5KHByZXZpb3VzUHJpb3JpdHksIENvbnRpbnVvdXNFdmVudFByaW9yaXR5KSk7CiAgICBzZXRQZW5kaW5nKHRydWUpOwogICAgdmFyIHByZXZUcmFuc2l0aW9uID0gUmVhY3RDdXJyZW50QmF0Y2hDb25maWckMi50cmFuc2l0aW9uOwogICAgUmVhY3RDdXJyZW50QmF0Y2hDb25maWckMi50cmFuc2l0aW9uID0ge307CiAgICB2YXIgY3VycmVudFRyYW5zaXRpb24gPSBSZWFjdEN1cnJlbnRCYXRjaENvbmZpZyQyLnRyYW5zaXRpb247CgogICAgewogICAgICBSZWFjdEN1cnJlbnRCYXRjaENvbmZpZyQyLnRyYW5zaXRpb24uX3VwZGF0ZWRGaWJlcnMgPSBuZXcgU2V0KCk7CiAgICB9CgogICAgdHJ5IHsKICAgICAgc2V0UGVuZGluZyhmYWxzZSk7CiAgICAgIGNhbGxiYWNrKCk7CiAgICB9IGZpbmFsbHkgewogICAgICBzZXRDdXJyZW50VXBkYXRlUHJpb3JpdHkocHJldmlvdXNQcmlvcml0eSk7CiAgICAgIFJlYWN0Q3VycmVudEJhdGNoQ29uZmlnJDIudHJhbnNpdGlvbiA9IHByZXZUcmFuc2l0aW9uOwoKICAgICAgewogICAgICAgIGlmIChwcmV2VHJhbnNpdGlvbiA9PT0gbnVsbCAmJiBjdXJyZW50VHJhbnNpdGlvbi5fdXBkYXRlZEZpYmVycykgewogICAgICAgICAgdmFyIHVwZGF0ZWRGaWJlcnNDb3VudCA9IGN1cnJlbnRUcmFuc2l0aW9uLl91cGRhdGVkRmliZXJzLnNpemU7CgogICAgICAgICAgaWYgKHVwZGF0ZWRGaWJlcnNDb3VudCA+IDEwKSB7CiAgICAgICAgICAgIHdhcm4oJ0RldGVjdGVkIGEgbGFyZ2UgbnVtYmVyIG9mIHVwZGF0ZXMgaW5zaWRlIHN0YXJ0VHJhbnNpdGlvbi4gJyArICdJZiB0aGlzIGlzIGR1ZSB0byBhIHN1YnNjcmlwdGlvbiBwbGVhc2UgcmUtd3JpdGUgaXQgdG8gdXNlIFJlYWN0IHByb3ZpZGVkIGhvb2tzLiAnICsgJ090aGVyd2lzZSBjb25jdXJyZW50IG1vZGUgZ3VhcmFudGVlcyBhcmUgb2ZmIHRoZSB0YWJsZS4nKTsKICAgICAgICAgIH0KCiAgICAgICAgICBjdXJyZW50VHJhbnNpdGlvbi5fdXBkYXRlZEZpYmVycy5jbGVhcigpOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gbW91bnRUcmFuc2l0aW9uKCkgewogICAgdmFyIF9tb3VudFN0YXRlID0gbW91bnRTdGF0ZShmYWxzZSksCiAgICAgICAgaXNQZW5kaW5nID0gX21vdW50U3RhdGVbMF0sCiAgICAgICAgc2V0UGVuZGluZyA9IF9tb3VudFN0YXRlWzFdOyAvLyBUaGUgYHN0YXJ0YCBtZXRob2QgbmV2ZXIgY2hhbmdlcy4KCgogICAgdmFyIHN0YXJ0ID0gc3RhcnRUcmFuc2l0aW9uLmJpbmQobnVsbCwgc2V0UGVuZGluZyk7CiAgICB2YXIgaG9vayA9IG1vdW50V29ya0luUHJvZ3Jlc3NIb29rKCk7CiAgICBob29rLm1lbW9pemVkU3RhdGUgPSBzdGFydDsKICAgIHJldHVybiBbaXNQZW5kaW5nLCBzdGFydF07CiAgfQoKICBmdW5jdGlvbiB1cGRhdGVUcmFuc2l0aW9uKCkgewogICAgdmFyIF91cGRhdGVTdGF0ZSA9IHVwZGF0ZVN0YXRlKCksCiAgICAgICAgaXNQZW5kaW5nID0gX3VwZGF0ZVN0YXRlWzBdOwoKICAgIHZhciBob29rID0gdXBkYXRlV29ya0luUHJvZ3Jlc3NIb29rKCk7CiAgICB2YXIgc3RhcnQgPSBob29rLm1lbW9pemVkU3RhdGU7CiAgICByZXR1cm4gW2lzUGVuZGluZywgc3RhcnRdOwogIH0KCiAgZnVuY3Rpb24gcmVyZW5kZXJUcmFuc2l0aW9uKCkgewogICAgdmFyIF9yZXJlbmRlclN0YXRlID0gcmVyZW5kZXJTdGF0ZSgpLAogICAgICAgIGlzUGVuZGluZyA9IF9yZXJlbmRlclN0YXRlWzBdOwoKICAgIHZhciBob29rID0gdXBkYXRlV29ya0luUHJvZ3Jlc3NIb29rKCk7CiAgICB2YXIgc3RhcnQgPSBob29rLm1lbW9pemVkU3RhdGU7CiAgICByZXR1cm4gW2lzUGVuZGluZywgc3RhcnRdOwogIH0KCiAgdmFyIGlzVXBkYXRpbmdPcGFxdWVWYWx1ZUluUmVuZGVyUGhhc2UgPSBmYWxzZTsKICBmdW5jdGlvbiBnZXRJc1VwZGF0aW5nT3BhcXVlVmFsdWVJblJlbmRlclBoYXNlSW5ERVYoKSB7CiAgICB7CiAgICAgIHJldHVybiBpc1VwZGF0aW5nT3BhcXVlVmFsdWVJblJlbmRlclBoYXNlOwogICAgfQogIH0KCiAgZnVuY3Rpb24gbW91bnRJZCgpIHsKICAgIHZhciBob29rID0gbW91bnRXb3JrSW5Qcm9ncmVzc0hvb2soKTsKICAgIHZhciByb290ID0gZ2V0V29ya0luUHJvZ3Jlc3NSb290KCk7IC8vIFRPRE86IEluIEZpenosIGlkIGdlbmVyYXRpb24gaXMgc3BlY2lmaWMgdG8gZWFjaCBzZXJ2ZXIgY29uZmlnLiBNYXliZSB3ZQogICAgLy8gc2hvdWxkIGRvIHRoaXMgaW4gRmliZXIsIHRvbz8gRGVmZXJyaW5nIHRoaXMgZGVjaXNpb24gZm9yIG5vdyBiZWNhdXNlCiAgICAvLyB0aGVyZSdzIG5vIG90aGVyIHBsYWNlIHRvIHN0b3JlIHRoZSBwcmVmaXggZXhjZXB0IGZvciBhbiBpbnRlcm5hbCBmaWVsZCBvbgogICAgLy8gdGhlIHB1YmxpYyBjcmVhdGVSb290IG9iamVjdCwgd2hpY2ggdGhlIGZpYmVyIHRyZWUgZG9lcyBub3QgY3VycmVudGx5IGhhdmUKICAgIC8vIGEgcmVmZXJlbmNlIHRvLgoKICAgIHZhciBpZGVudGlmaWVyUHJlZml4ID0gcm9vdC5pZGVudGlmaWVyUHJlZml4OwogICAgdmFyIGlkOwoKICAgIGlmIChnZXRJc0h5ZHJhdGluZygpKSB7CiAgICAgIHZhciB0cmVlSWQgPSBnZXRUcmVlSWQoKTsgLy8gVXNlIGEgY2FwdGlhbCBSIHByZWZpeCBmb3Igc2VydmVyLWdlbmVyYXRlZCBpZHMuCgogICAgICBpZCA9ICc6JyArIGlkZW50aWZpZXJQcmVmaXggKyAnUicgKyB0cmVlSWQ7IC8vIFVubGVzcyB0aGlzIGlzIHRoZSBmaXJzdCBpZCBhdCB0aGlzIGxldmVsLCBhcHBlbmQgYSBudW1iZXIgYXQgdGhlIGVuZAogICAgICAvLyB0aGF0IHJlcHJlc2VudHMgdGhlIHBvc2l0aW9uIG9mIHRoaXMgdXNlSWQgaG9vayBhbW9uZyBhbGwgdGhlIHVzZUlkCiAgICAgIC8vIGhvb2tzIGZvciB0aGlzIGZpYmVyLgoKICAgICAgdmFyIGxvY2FsSWQgPSBsb2NhbElkQ291bnRlcisrOwoKICAgICAgaWYgKGxvY2FsSWQgPiAwKSB7CiAgICAgICAgaWQgKz0gJ0gnICsgbG9jYWxJZC50b1N0cmluZygzMik7CiAgICAgIH0KCiAgICAgIGlkICs9ICc6JzsKICAgIH0gZWxzZSB7CiAgICAgIC8vIFVzZSBhIGxvd2VyY2FzZSByIHByZWZpeCBmb3IgY2xpZW50LWdlbmVyYXRlZCBpZHMuCiAgICAgIHZhciBnbG9iYWxDbGllbnRJZCA9IGdsb2JhbENsaWVudElkQ291bnRlcisrOwogICAgICBpZCA9ICc6JyArIGlkZW50aWZpZXJQcmVmaXggKyAncicgKyBnbG9iYWxDbGllbnRJZC50b1N0cmluZygzMikgKyAnOic7CiAgICB9CgogICAgaG9vay5tZW1vaXplZFN0YXRlID0gaWQ7CiAgICByZXR1cm4gaWQ7CiAgfQoKICBmdW5jdGlvbiB1cGRhdGVJZCgpIHsKICAgIHZhciBob29rID0gdXBkYXRlV29ya0luUHJvZ3Jlc3NIb29rKCk7CiAgICB2YXIgaWQgPSBob29rLm1lbW9pemVkU3RhdGU7CiAgICByZXR1cm4gaWQ7CiAgfQoKICBmdW5jdGlvbiBkaXNwYXRjaFJlZHVjZXJBY3Rpb24oZmliZXIsIHF1ZXVlLCBhY3Rpb24pIHsKICAgIHsKICAgICAgaWYgKHR5cGVvZiBhcmd1bWVudHNbM10gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICBlcnJvcigiU3RhdGUgdXBkYXRlcyBmcm9tIHRoZSB1c2VTdGF0ZSgpIGFuZCB1c2VSZWR1Y2VyKCkgSG9va3MgZG9uJ3Qgc3VwcG9ydCB0aGUgIiArICdzZWNvbmQgY2FsbGJhY2sgYXJndW1lbnQuIFRvIGV4ZWN1dGUgYSBzaWRlIGVmZmVjdCBhZnRlciAnICsgJ3JlbmRlcmluZywgZGVjbGFyZSBpdCBpbiB0aGUgY29tcG9uZW50IGJvZHkgd2l0aCB1c2VFZmZlY3QoKS4nKTsKICAgICAgfQogICAgfQoKICAgIHZhciBsYW5lID0gcmVxdWVzdFVwZGF0ZUxhbmUoZmliZXIpOwogICAgdmFyIHVwZGF0ZSA9IHsKICAgICAgbGFuZTogbGFuZSwKICAgICAgYWN0aW9uOiBhY3Rpb24sCiAgICAgIGhhc0VhZ2VyU3RhdGU6IGZhbHNlLAogICAgICBlYWdlclN0YXRlOiBudWxsLAogICAgICBuZXh0OiBudWxsCiAgICB9OwoKICAgIGlmIChpc1JlbmRlclBoYXNlVXBkYXRlKGZpYmVyKSkgewogICAgICBlbnF1ZXVlUmVuZGVyUGhhc2VVcGRhdGUocXVldWUsIHVwZGF0ZSk7CiAgICB9IGVsc2UgewogICAgICB2YXIgcm9vdCA9IGVucXVldWVDb25jdXJyZW50SG9va1VwZGF0ZShmaWJlciwgcXVldWUsIHVwZGF0ZSwgbGFuZSk7CgogICAgICBpZiAocm9vdCAhPT0gbnVsbCkgewogICAgICAgIHZhciBldmVudFRpbWUgPSByZXF1ZXN0RXZlbnRUaW1lKCk7CiAgICAgICAgc2NoZWR1bGVVcGRhdGVPbkZpYmVyKHJvb3QsIGZpYmVyLCBsYW5lLCBldmVudFRpbWUpOwogICAgICAgIGVudGFuZ2xlVHJhbnNpdGlvblVwZGF0ZShyb290LCBxdWV1ZSwgbGFuZSk7CiAgICAgIH0KICAgIH0KCiAgICBtYXJrVXBkYXRlSW5EZXZUb29scyhmaWJlciwgbGFuZSk7CiAgfQoKICBmdW5jdGlvbiBkaXNwYXRjaFNldFN0YXRlKGZpYmVyLCBxdWV1ZSwgYWN0aW9uKSB7CiAgICB7CiAgICAgIGlmICh0eXBlb2YgYXJndW1lbnRzWzNdID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgZXJyb3IoIlN0YXRlIHVwZGF0ZXMgZnJvbSB0aGUgdXNlU3RhdGUoKSBhbmQgdXNlUmVkdWNlcigpIEhvb2tzIGRvbid0IHN1cHBvcnQgdGhlICIgKyAnc2Vjb25kIGNhbGxiYWNrIGFyZ3VtZW50LiBUbyBleGVjdXRlIGEgc2lkZSBlZmZlY3QgYWZ0ZXIgJyArICdyZW5kZXJpbmcsIGRlY2xhcmUgaXQgaW4gdGhlIGNvbXBvbmVudCBib2R5IHdpdGggdXNlRWZmZWN0KCkuJyk7CiAgICAgIH0KICAgIH0KCiAgICB2YXIgbGFuZSA9IHJlcXVlc3RVcGRhdGVMYW5lKGZpYmVyKTsKICAgIHZhciB1cGRhdGUgPSB7CiAgICAgIGxhbmU6IGxhbmUsCiAgICAgIGFjdGlvbjogYWN0aW9uLAogICAgICBoYXNFYWdlclN0YXRlOiBmYWxzZSwKICAgICAgZWFnZXJTdGF0ZTogbnVsbCwKICAgICAgbmV4dDogbnVsbAogICAgfTsKCiAgICBpZiAoaXNSZW5kZXJQaGFzZVVwZGF0ZShmaWJlcikpIHsKICAgICAgZW5xdWV1ZVJlbmRlclBoYXNlVXBkYXRlKHF1ZXVlLCB1cGRhdGUpOwogICAgfSBlbHNlIHsKICAgICAgdmFyIGFsdGVybmF0ZSA9IGZpYmVyLmFsdGVybmF0ZTsKCiAgICAgIGlmIChmaWJlci5sYW5lcyA9PT0gTm9MYW5lcyAmJiAoYWx0ZXJuYXRlID09PSBudWxsIHx8IGFsdGVybmF0ZS5sYW5lcyA9PT0gTm9MYW5lcykpIHsKICAgICAgICAvLyBUaGUgcXVldWUgaXMgY3VycmVudGx5IGVtcHR5LCB3aGljaCBtZWFucyB3ZSBjYW4gZWFnZXJseSBjb21wdXRlIHRoZQogICAgICAgIC8vIG5leHQgc3RhdGUgYmVmb3JlIGVudGVyaW5nIHRoZSByZW5kZXIgcGhhc2UuIElmIHRoZSBuZXcgc3RhdGUgaXMgdGhlCiAgICAgICAgLy8gc2FtZSBhcyB0aGUgY3VycmVudCBzdGF0ZSwgd2UgbWF5IGJlIGFibGUgdG8gYmFpbCBvdXQgZW50aXJlbHkuCiAgICAgICAgdmFyIGxhc3RSZW5kZXJlZFJlZHVjZXIgPSBxdWV1ZS5sYXN0UmVuZGVyZWRSZWR1Y2VyOwoKICAgICAgICBpZiAobGFzdFJlbmRlcmVkUmVkdWNlciAhPT0gbnVsbCkgewogICAgICAgICAgdmFyIHByZXZEaXNwYXRjaGVyOwoKICAgICAgICAgIHsKICAgICAgICAgICAgcHJldkRpc3BhdGNoZXIgPSBSZWFjdEN1cnJlbnREaXNwYXRjaGVyJDEuY3VycmVudDsKICAgICAgICAgICAgUmVhY3RDdXJyZW50RGlzcGF0Y2hlciQxLmN1cnJlbnQgPSBJbnZhbGlkTmVzdGVkSG9va3NEaXNwYXRjaGVyT25VcGRhdGVJbkRFVjsKICAgICAgICAgIH0KCiAgICAgICAgICB0cnkgewogICAgICAgICAgICB2YXIgY3VycmVudFN0YXRlID0gcXVldWUubGFzdFJlbmRlcmVkU3RhdGU7CiAgICAgICAgICAgIHZhciBlYWdlclN0YXRlID0gbGFzdFJlbmRlcmVkUmVkdWNlcihjdXJyZW50U3RhdGUsIGFjdGlvbik7IC8vIFN0YXNoIHRoZSBlYWdlcmx5IGNvbXB1dGVkIHN0YXRlLCBhbmQgdGhlIHJlZHVjZXIgdXNlZCB0byBjb21wdXRlCiAgICAgICAgICAgIC8vIGl0LCBvbiB0aGUgdXBkYXRlIG9iamVjdC4gSWYgdGhlIHJlZHVjZXIgaGFzbid0IGNoYW5nZWQgYnkgdGhlCiAgICAgICAgICAgIC8vIHRpbWUgd2UgZW50ZXIgdGhlIHJlbmRlciBwaGFzZSwgdGhlbiB0aGUgZWFnZXIgc3RhdGUgY2FuIGJlIHVzZWQKICAgICAgICAgICAgLy8gd2l0aG91dCBjYWxsaW5nIHRoZSByZWR1Y2VyIGFnYWluLgoKICAgICAgICAgICAgdXBkYXRlLmhhc0VhZ2VyU3RhdGUgPSB0cnVlOwogICAgICAgICAgICB1cGRhdGUuZWFnZXJTdGF0ZSA9IGVhZ2VyU3RhdGU7CgogICAgICAgICAgICBpZiAob2JqZWN0SXMoZWFnZXJTdGF0ZSwgY3VycmVudFN0YXRlKSkgewogICAgICAgICAgICAgIC8vIEZhc3QgcGF0aC4gV2UgY2FuIGJhaWwgb3V0IHdpdGhvdXQgc2NoZWR1bGluZyBSZWFjdCB0byByZS1yZW5kZXIuCiAgICAgICAgICAgICAgLy8gSXQncyBzdGlsbCBwb3NzaWJsZSB0aGF0IHdlJ2xsIG5lZWQgdG8gcmViYXNlIHRoaXMgdXBkYXRlIGxhdGVyLAogICAgICAgICAgICAgIC8vIGlmIHRoZSBjb21wb25lbnQgcmUtcmVuZGVycyBmb3IgYSBkaWZmZXJlbnQgcmVhc29uIGFuZCBieSB0aGF0CiAgICAgICAgICAgICAgLy8gdGltZSB0aGUgcmVkdWNlciBoYXMgY2hhbmdlZC4KICAgICAgICAgICAgICAvLyBUT0RPOiBEbyB3ZSBzdGlsbCBuZWVkIHRvIGVudGFuZ2xlIHRyYW5zaXRpb25zIGluIHRoaXMgY2FzZT8KICAgICAgICAgICAgICBlbnF1ZXVlQ29uY3VycmVudEhvb2tVcGRhdGVBbmRFYWdlcmx5QmFpbG91dChmaWJlciwgcXVldWUsIHVwZGF0ZSwgbGFuZSk7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGNhdGNoIChlcnJvcikgey8vIFN1cHByZXNzIHRoZSBlcnJvci4gSXQgd2lsbCB0aHJvdyBhZ2FpbiBpbiB0aGUgcmVuZGVyIHBoYXNlLgogICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgewogICAgICAgICAgICAgIFJlYWN0Q3VycmVudERpc3BhdGNoZXIkMS5jdXJyZW50ID0gcHJldkRpc3BhdGNoZXI7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHZhciByb290ID0gZW5xdWV1ZUNvbmN1cnJlbnRIb29rVXBkYXRlKGZpYmVyLCBxdWV1ZSwgdXBkYXRlLCBsYW5lKTsKCiAgICAgIGlmIChyb290ICE9PSBudWxsKSB7CiAgICAgICAgdmFyIGV2ZW50VGltZSA9IHJlcXVlc3RFdmVudFRpbWUoKTsKICAgICAgICBzY2hlZHVsZVVwZGF0ZU9uRmliZXIocm9vdCwgZmliZXIsIGxhbmUsIGV2ZW50VGltZSk7CiAgICAgICAgZW50YW5nbGVUcmFuc2l0aW9uVXBkYXRlKHJvb3QsIHF1ZXVlLCBsYW5lKTsKICAgICAgfQogICAgfQoKICAgIG1hcmtVcGRhdGVJbkRldlRvb2xzKGZpYmVyLCBsYW5lKTsKICB9CgogIGZ1bmN0aW9uIGlzUmVuZGVyUGhhc2VVcGRhdGUoZmliZXIpIHsKICAgIHZhciBhbHRlcm5hdGUgPSBmaWJlci5hbHRlcm5hdGU7CiAgICByZXR1cm4gZmliZXIgPT09IGN1cnJlbnRseVJlbmRlcmluZ0ZpYmVyJDEgfHwgYWx0ZXJuYXRlICE9PSBudWxsICYmIGFsdGVybmF0ZSA9PT0gY3VycmVudGx5UmVuZGVyaW5nRmliZXIkMTsKICB9CgogIGZ1bmN0aW9uIGVucXVldWVSZW5kZXJQaGFzZVVwZGF0ZShxdWV1ZSwgdXBkYXRlKSB7CiAgICAvLyBUaGlzIGlzIGEgcmVuZGVyIHBoYXNlIHVwZGF0ZS4gU3Rhc2ggaXQgaW4gYSBsYXppbHktY3JlYXRlZCBtYXAgb2YKICAgIC8vIHF1ZXVlIC0+IGxpbmtlZCBsaXN0IG9mIHVwZGF0ZXMuIEFmdGVyIHRoaXMgcmVuZGVyIHBhc3MsIHdlJ2xsIHJlc3RhcnQKICAgIC8vIGFuZCBhcHBseSB0aGUgc3Rhc2hlZCB1cGRhdGVzIG9uIHRvcCBvZiB0aGUgd29yay1pbi1wcm9ncmVzcyBob29rLgogICAgZGlkU2NoZWR1bGVSZW5kZXJQaGFzZVVwZGF0ZUR1cmluZ1RoaXNQYXNzID0gZGlkU2NoZWR1bGVSZW5kZXJQaGFzZVVwZGF0ZSA9IHRydWU7CiAgICB2YXIgcGVuZGluZyA9IHF1ZXVlLnBlbmRpbmc7CgogICAgaWYgKHBlbmRpbmcgPT09IG51bGwpIHsKICAgICAgLy8gVGhpcyBpcyB0aGUgZmlyc3QgdXBkYXRlLiBDcmVhdGUgYSBjaXJjdWxhciBsaXN0LgogICAgICB1cGRhdGUubmV4dCA9IHVwZGF0ZTsKICAgIH0gZWxzZSB7CiAgICAgIHVwZGF0ZS5uZXh0ID0gcGVuZGluZy5uZXh0OwogICAgICBwZW5kaW5nLm5leHQgPSB1cGRhdGU7CiAgICB9CgogICAgcXVldWUucGVuZGluZyA9IHVwZGF0ZTsKICB9IC8vIFRPRE86IE1vdmUgdG8gUmVhY3RGaWJlckNvbmN1cnJlbnRVcGRhdGVzPwoKCiAgZnVuY3Rpb24gZW50YW5nbGVUcmFuc2l0aW9uVXBkYXRlKHJvb3QsIHF1ZXVlLCBsYW5lKSB7CiAgICBpZiAoaXNUcmFuc2l0aW9uTGFuZShsYW5lKSkgewogICAgICB2YXIgcXVldWVMYW5lcyA9IHF1ZXVlLmxhbmVzOyAvLyBJZiBhbnkgZW50YW5nbGVkIGxhbmVzIGFyZSBubyBsb25nZXIgcGVuZGluZyBvbiB0aGUgcm9vdCwgdGhlbiB0aGV5CiAgICAgIC8vIG11c3QgaGF2ZSBmaW5pc2hlZC4gV2UgY2FuIHJlbW92ZSB0aGVtIGZyb20gdGhlIHNoYXJlZCBxdWV1ZSwgd2hpY2gKICAgICAgLy8gcmVwcmVzZW50cyBhIHN1cGVyc2V0IG9mIHRoZSBhY3R1YWxseSBwZW5kaW5nIGxhbmVzLiBJbiBzb21lIGNhc2VzIHdlCiAgICAgIC8vIG1heSBlbnRhbmdsZSBtb3JlIHRoYW4gd2UgbmVlZCB0bywgYnV0IHRoYXQncyBPSy4gSW4gZmFjdCBpdCdzIHdvcnNlIGlmCiAgICAgIC8vIHdlICpkb24ndCogZW50YW5nbGUgd2hlbiB3ZSBzaG91bGQuCgogICAgICBxdWV1ZUxhbmVzID0gaW50ZXJzZWN0TGFuZXMocXVldWVMYW5lcywgcm9vdC5wZW5kaW5nTGFuZXMpOyAvLyBFbnRhbmdsZSB0aGUgbmV3IHRyYW5zaXRpb24gbGFuZSB3aXRoIHRoZSBvdGhlciB0cmFuc2l0aW9uIGxhbmVzLgoKICAgICAgdmFyIG5ld1F1ZXVlTGFuZXMgPSBtZXJnZUxhbmVzKHF1ZXVlTGFuZXMsIGxhbmUpOwogICAgICBxdWV1ZS5sYW5lcyA9IG5ld1F1ZXVlTGFuZXM7IC8vIEV2ZW4gaWYgcXVldWUubGFuZXMgYWxyZWFkeSBpbmNsdWRlIGxhbmUsIHdlIGRvbid0IGtub3cgZm9yIGNlcnRhaW4gaWYKICAgICAgLy8gdGhlIGxhbmUgZmluaXNoZWQgc2luY2UgdGhlIGxhc3QgdGltZSB3ZSBlbnRhbmdsZWQgaXQuIFNvIHdlIG5lZWQgdG8KICAgICAgLy8gZW50YW5nbGUgaXQgYWdhaW4sIGp1c3QgdG8gYmUgc3VyZS4KCiAgICAgIG1hcmtSb290RW50YW5nbGVkKHJvb3QsIG5ld1F1ZXVlTGFuZXMpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gbWFya1VwZGF0ZUluRGV2VG9vbHMoZmliZXIsIGxhbmUsIGFjdGlvbikgewoKICAgIHsKICAgICAgbWFya1N0YXRlVXBkYXRlU2NoZWR1bGVkKGZpYmVyLCBsYW5lKTsKICAgIH0KICB9CgogIHZhciBDb250ZXh0T25seURpc3BhdGNoZXIgPSB7CiAgICByZWFkQ29udGV4dDogcmVhZENvbnRleHQsCiAgICB1c2VDYWxsYmFjazogdGhyb3dJbnZhbGlkSG9va0Vycm9yLAogICAgdXNlQ29udGV4dDogdGhyb3dJbnZhbGlkSG9va0Vycm9yLAogICAgdXNlRWZmZWN0OiB0aHJvd0ludmFsaWRIb29rRXJyb3IsCiAgICB1c2VJbXBlcmF0aXZlSGFuZGxlOiB0aHJvd0ludmFsaWRIb29rRXJyb3IsCiAgICB1c2VJbnNlcnRpb25FZmZlY3Q6IHRocm93SW52YWxpZEhvb2tFcnJvciwKICAgIHVzZUxheW91dEVmZmVjdDogdGhyb3dJbnZhbGlkSG9va0Vycm9yLAogICAgdXNlTWVtbzogdGhyb3dJbnZhbGlkSG9va0Vycm9yLAogICAgdXNlUmVkdWNlcjogdGhyb3dJbnZhbGlkSG9va0Vycm9yLAogICAgdXNlUmVmOiB0aHJvd0ludmFsaWRIb29rRXJyb3IsCiAgICB1c2VTdGF0ZTogdGhyb3dJbnZhbGlkSG9va0Vycm9yLAogICAgdXNlRGVidWdWYWx1ZTogdGhyb3dJbnZhbGlkSG9va0Vycm9yLAogICAgdXNlRGVmZXJyZWRWYWx1ZTogdGhyb3dJbnZhbGlkSG9va0Vycm9yLAogICAgdXNlVHJhbnNpdGlvbjogdGhyb3dJbnZhbGlkSG9va0Vycm9yLAogICAgdXNlTXV0YWJsZVNvdXJjZTogdGhyb3dJbnZhbGlkSG9va0Vycm9yLAogICAgdXNlU3luY0V4dGVybmFsU3RvcmU6IHRocm93SW52YWxpZEhvb2tFcnJvciwKICAgIHVzZUlkOiB0aHJvd0ludmFsaWRIb29rRXJyb3IsCiAgICB1bnN0YWJsZV9pc05ld1JlY29uY2lsZXI6IGVuYWJsZU5ld1JlY29uY2lsZXIKICB9OwoKICB2YXIgSG9va3NEaXNwYXRjaGVyT25Nb3VudEluREVWID0gbnVsbDsKICB2YXIgSG9va3NEaXNwYXRjaGVyT25Nb3VudFdpdGhIb29rVHlwZXNJbkRFViA9IG51bGw7CiAgdmFyIEhvb2tzRGlzcGF0Y2hlck9uVXBkYXRlSW5ERVYgPSBudWxsOwogIHZhciBIb29rc0Rpc3BhdGNoZXJPblJlcmVuZGVySW5ERVYgPSBudWxsOwogIHZhciBJbnZhbGlkTmVzdGVkSG9va3NEaXNwYXRjaGVyT25Nb3VudEluREVWID0gbnVsbDsKICB2YXIgSW52YWxpZE5lc3RlZEhvb2tzRGlzcGF0Y2hlck9uVXBkYXRlSW5ERVYgPSBudWxsOwogIHZhciBJbnZhbGlkTmVzdGVkSG9va3NEaXNwYXRjaGVyT25SZXJlbmRlckluREVWID0gbnVsbDsKCiAgewogICAgdmFyIHdhcm5JbnZhbGlkQ29udGV4dEFjY2VzcyA9IGZ1bmN0aW9uICgpIHsKICAgICAgZXJyb3IoJ0NvbnRleHQgY2FuIG9ubHkgYmUgcmVhZCB3aGlsZSBSZWFjdCBpcyByZW5kZXJpbmcuICcgKyAnSW4gY2xhc3NlcywgeW91IGNhbiByZWFkIGl0IGluIHRoZSByZW5kZXIgbWV0aG9kIG9yIGdldERlcml2ZWRTdGF0ZUZyb21Qcm9wcy4gJyArICdJbiBmdW5jdGlvbiBjb21wb25lbnRzLCB5b3UgY2FuIHJlYWQgaXQgZGlyZWN0bHkgaW4gdGhlIGZ1bmN0aW9uIGJvZHksIGJ1dCBub3QgJyArICdpbnNpZGUgSG9va3MgbGlrZSB1c2VSZWR1Y2VyKCkgb3IgdXNlTWVtbygpLicpOwogICAgfTsKCiAgICB2YXIgd2FybkludmFsaWRIb29rQWNjZXNzID0gZnVuY3Rpb24gKCkgewogICAgICBlcnJvcignRG8gbm90IGNhbGwgSG9va3MgaW5zaWRlIHVzZUVmZmVjdCguLi4pLCB1c2VNZW1vKC4uLiksIG9yIG90aGVyIGJ1aWx0LWluIEhvb2tzLiAnICsgJ1lvdSBjYW4gb25seSBjYWxsIEhvb2tzIGF0IHRoZSB0b3AgbGV2ZWwgb2YgeW91ciBSZWFjdCBmdW5jdGlvbi4gJyArICdGb3IgbW9yZSBpbmZvcm1hdGlvbiwgc2VlICcgKyAnaHR0cHM6Ly9yZWFjdGpzLm9yZy9saW5rL3J1bGVzLW9mLWhvb2tzJyk7CiAgICB9OwoKICAgIEhvb2tzRGlzcGF0Y2hlck9uTW91bnRJbkRFViA9IHsKICAgICAgcmVhZENvbnRleHQ6IGZ1bmN0aW9uIChjb250ZXh0KSB7CiAgICAgICAgcmV0dXJuIHJlYWRDb250ZXh0KGNvbnRleHQpOwogICAgICB9LAogICAgICB1c2VDYWxsYmFjazogZnVuY3Rpb24gKGNhbGxiYWNrLCBkZXBzKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlQ2FsbGJhY2snOwogICAgICAgIG1vdW50SG9va1R5cGVzRGV2KCk7CiAgICAgICAgY2hlY2tEZXBzQXJlQXJyYXlEZXYoZGVwcyk7CiAgICAgICAgcmV0dXJuIG1vdW50Q2FsbGJhY2soY2FsbGJhY2ssIGRlcHMpOwogICAgICB9LAogICAgICB1c2VDb250ZXh0OiBmdW5jdGlvbiAoY29udGV4dCkgewogICAgICAgIGN1cnJlbnRIb29rTmFtZUluRGV2ID0gJ3VzZUNvbnRleHQnOwogICAgICAgIG1vdW50SG9va1R5cGVzRGV2KCk7CiAgICAgICAgcmV0dXJuIHJlYWRDb250ZXh0KGNvbnRleHQpOwogICAgICB9LAogICAgICB1c2VFZmZlY3Q6IGZ1bmN0aW9uIChjcmVhdGUsIGRlcHMpIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VFZmZlY3QnOwogICAgICAgIG1vdW50SG9va1R5cGVzRGV2KCk7CiAgICAgICAgY2hlY2tEZXBzQXJlQXJyYXlEZXYoZGVwcyk7CiAgICAgICAgcmV0dXJuIG1vdW50RWZmZWN0KGNyZWF0ZSwgZGVwcyk7CiAgICAgIH0sCiAgICAgIHVzZUltcGVyYXRpdmVIYW5kbGU6IGZ1bmN0aW9uIChyZWYsIGNyZWF0ZSwgZGVwcykgewogICAgICAgIGN1cnJlbnRIb29rTmFtZUluRGV2ID0gJ3VzZUltcGVyYXRpdmVIYW5kbGUnOwogICAgICAgIG1vdW50SG9va1R5cGVzRGV2KCk7CiAgICAgICAgY2hlY2tEZXBzQXJlQXJyYXlEZXYoZGVwcyk7CiAgICAgICAgcmV0dXJuIG1vdW50SW1wZXJhdGl2ZUhhbmRsZShyZWYsIGNyZWF0ZSwgZGVwcyk7CiAgICAgIH0sCiAgICAgIHVzZUluc2VydGlvbkVmZmVjdDogZnVuY3Rpb24gKGNyZWF0ZSwgZGVwcykgewogICAgICAgIGN1cnJlbnRIb29rTmFtZUluRGV2ID0gJ3VzZUluc2VydGlvbkVmZmVjdCc7CiAgICAgICAgbW91bnRIb29rVHlwZXNEZXYoKTsKICAgICAgICBjaGVja0RlcHNBcmVBcnJheURldihkZXBzKTsKICAgICAgICByZXR1cm4gbW91bnRJbnNlcnRpb25FZmZlY3QoY3JlYXRlLCBkZXBzKTsKICAgICAgfSwKICAgICAgdXNlTGF5b3V0RWZmZWN0OiBmdW5jdGlvbiAoY3JlYXRlLCBkZXBzKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlTGF5b3V0RWZmZWN0JzsKICAgICAgICBtb3VudEhvb2tUeXBlc0RldigpOwogICAgICAgIGNoZWNrRGVwc0FyZUFycmF5RGV2KGRlcHMpOwogICAgICAgIHJldHVybiBtb3VudExheW91dEVmZmVjdChjcmVhdGUsIGRlcHMpOwogICAgICB9LAogICAgICB1c2VNZW1vOiBmdW5jdGlvbiAoY3JlYXRlLCBkZXBzKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlTWVtbyc7CiAgICAgICAgbW91bnRIb29rVHlwZXNEZXYoKTsKICAgICAgICBjaGVja0RlcHNBcmVBcnJheURldihkZXBzKTsKICAgICAgICB2YXIgcHJldkRpc3BhdGNoZXIgPSBSZWFjdEN1cnJlbnREaXNwYXRjaGVyJDEuY3VycmVudDsKICAgICAgICBSZWFjdEN1cnJlbnREaXNwYXRjaGVyJDEuY3VycmVudCA9IEludmFsaWROZXN0ZWRIb29rc0Rpc3BhdGNoZXJPbk1vdW50SW5ERVY7CgogICAgICAgIHRyeSB7CiAgICAgICAgICByZXR1cm4gbW91bnRNZW1vKGNyZWF0ZSwgZGVwcyk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIFJlYWN0Q3VycmVudERpc3BhdGNoZXIkMS5jdXJyZW50ID0gcHJldkRpc3BhdGNoZXI7CiAgICAgICAgfQogICAgICB9LAogICAgICB1c2VSZWR1Y2VyOiBmdW5jdGlvbiAocmVkdWNlciwgaW5pdGlhbEFyZywgaW5pdCkgewogICAgICAgIGN1cnJlbnRIb29rTmFtZUluRGV2ID0gJ3VzZVJlZHVjZXInOwogICAgICAgIG1vdW50SG9va1R5cGVzRGV2KCk7CiAgICAgICAgdmFyIHByZXZEaXNwYXRjaGVyID0gUmVhY3RDdXJyZW50RGlzcGF0Y2hlciQxLmN1cnJlbnQ7CiAgICAgICAgUmVhY3RDdXJyZW50RGlzcGF0Y2hlciQxLmN1cnJlbnQgPSBJbnZhbGlkTmVzdGVkSG9va3NEaXNwYXRjaGVyT25Nb3VudEluREVWOwoKICAgICAgICB0cnkgewogICAgICAgICAgcmV0dXJuIG1vdW50UmVkdWNlcihyZWR1Y2VyLCBpbml0aWFsQXJnLCBpbml0KTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgUmVhY3RDdXJyZW50RGlzcGF0Y2hlciQxLmN1cnJlbnQgPSBwcmV2RGlzcGF0Y2hlcjsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHVzZVJlZjogZnVuY3Rpb24gKGluaXRpYWxWYWx1ZSkgewogICAgICAgIGN1cnJlbnRIb29rTmFtZUluRGV2ID0gJ3VzZVJlZic7CiAgICAgICAgbW91bnRIb29rVHlwZXNEZXYoKTsKICAgICAgICByZXR1cm4gbW91bnRSZWYoaW5pdGlhbFZhbHVlKTsKICAgICAgfSwKICAgICAgdXNlU3RhdGU6IGZ1bmN0aW9uIChpbml0aWFsU3RhdGUpIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VTdGF0ZSc7CiAgICAgICAgbW91bnRIb29rVHlwZXNEZXYoKTsKICAgICAgICB2YXIgcHJldkRpc3BhdGNoZXIgPSBSZWFjdEN1cnJlbnREaXNwYXRjaGVyJDEuY3VycmVudDsKICAgICAgICBSZWFjdEN1cnJlbnREaXNwYXRjaGVyJDEuY3VycmVudCA9IEludmFsaWROZXN0ZWRIb29rc0Rpc3BhdGNoZXJPbk1vdW50SW5ERVY7CgogICAgICAgIHRyeSB7CiAgICAgICAgICByZXR1cm4gbW91bnRTdGF0ZShpbml0aWFsU3RhdGUpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICBSZWFjdEN1cnJlbnREaXNwYXRjaGVyJDEuY3VycmVudCA9IHByZXZEaXNwYXRjaGVyOwogICAgICAgIH0KICAgICAgfSwKICAgICAgdXNlRGVidWdWYWx1ZTogZnVuY3Rpb24gKHZhbHVlLCBmb3JtYXR0ZXJGbikgewogICAgICAgIGN1cnJlbnRIb29rTmFtZUluRGV2ID0gJ3VzZURlYnVnVmFsdWUnOwogICAgICAgIG1vdW50SG9va1R5cGVzRGV2KCk7CiAgICAgICAgcmV0dXJuIG1vdW50RGVidWdWYWx1ZSgpOwogICAgICB9LAogICAgICB1c2VEZWZlcnJlZFZhbHVlOiBmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VEZWZlcnJlZFZhbHVlJzsKICAgICAgICBtb3VudEhvb2tUeXBlc0RldigpOwogICAgICAgIHJldHVybiBtb3VudERlZmVycmVkVmFsdWUodmFsdWUpOwogICAgICB9LAogICAgICB1c2VUcmFuc2l0aW9uOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlVHJhbnNpdGlvbic7CiAgICAgICAgbW91bnRIb29rVHlwZXNEZXYoKTsKICAgICAgICByZXR1cm4gbW91bnRUcmFuc2l0aW9uKCk7CiAgICAgIH0sCiAgICAgIHVzZU11dGFibGVTb3VyY2U6IGZ1bmN0aW9uIChzb3VyY2UsIGdldFNuYXBzaG90LCBzdWJzY3JpYmUpIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VNdXRhYmxlU291cmNlJzsKICAgICAgICBtb3VudEhvb2tUeXBlc0RldigpOwogICAgICAgIHJldHVybiBtb3VudE11dGFibGVTb3VyY2UoKTsKICAgICAgfSwKICAgICAgdXNlU3luY0V4dGVybmFsU3RvcmU6IGZ1bmN0aW9uIChzdWJzY3JpYmUsIGdldFNuYXBzaG90LCBnZXRTZXJ2ZXJTbmFwc2hvdCkgewogICAgICAgIGN1cnJlbnRIb29rTmFtZUluRGV2ID0gJ3VzZVN5bmNFeHRlcm5hbFN0b3JlJzsKICAgICAgICBtb3VudEhvb2tUeXBlc0RldigpOwogICAgICAgIHJldHVybiBtb3VudFN5bmNFeHRlcm5hbFN0b3JlKHN1YnNjcmliZSwgZ2V0U25hcHNob3QsIGdldFNlcnZlclNuYXBzaG90KTsKICAgICAgfSwKICAgICAgdXNlSWQ6IGZ1bmN0aW9uICgpIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VJZCc7CiAgICAgICAgbW91bnRIb29rVHlwZXNEZXYoKTsKICAgICAgICByZXR1cm4gbW91bnRJZCgpOwogICAgICB9LAogICAgICB1bnN0YWJsZV9pc05ld1JlY29uY2lsZXI6IGVuYWJsZU5ld1JlY29uY2lsZXIKICAgIH07CgogICAgSG9va3NEaXNwYXRjaGVyT25Nb3VudFdpdGhIb29rVHlwZXNJbkRFViA9IHsKICAgICAgcmVhZENvbnRleHQ6IGZ1bmN0aW9uIChjb250ZXh0KSB7CiAgICAgICAgcmV0dXJuIHJlYWRDb250ZXh0KGNvbnRleHQpOwogICAgICB9LAogICAgICB1c2VDYWxsYmFjazogZnVuY3Rpb24gKGNhbGxiYWNrLCBkZXBzKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlQ2FsbGJhY2snOwogICAgICAgIHVwZGF0ZUhvb2tUeXBlc0RldigpOwogICAgICAgIHJldHVybiBtb3VudENhbGxiYWNrKGNhbGxiYWNrLCBkZXBzKTsKICAgICAgfSwKICAgICAgdXNlQ29udGV4dDogZnVuY3Rpb24gKGNvbnRleHQpIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VDb250ZXh0JzsKICAgICAgICB1cGRhdGVIb29rVHlwZXNEZXYoKTsKICAgICAgICByZXR1cm4gcmVhZENvbnRleHQoY29udGV4dCk7CiAgICAgIH0sCiAgICAgIHVzZUVmZmVjdDogZnVuY3Rpb24gKGNyZWF0ZSwgZGVwcykgewogICAgICAgIGN1cnJlbnRIb29rTmFtZUluRGV2ID0gJ3VzZUVmZmVjdCc7CiAgICAgICAgdXBkYXRlSG9va1R5cGVzRGV2KCk7CiAgICAgICAgcmV0dXJuIG1vdW50RWZmZWN0KGNyZWF0ZSwgZGVwcyk7CiAgICAgIH0sCiAgICAgIHVzZUltcGVyYXRpdmVIYW5kbGU6IGZ1bmN0aW9uIChyZWYsIGNyZWF0ZSwgZGVwcykgewogICAgICAgIGN1cnJlbnRIb29rTmFtZUluRGV2ID0gJ3VzZUltcGVyYXRpdmVIYW5kbGUnOwogICAgICAgIHVwZGF0ZUhvb2tUeXBlc0RldigpOwogICAgICAgIHJldHVybiBtb3VudEltcGVyYXRpdmVIYW5kbGUocmVmLCBjcmVhdGUsIGRlcHMpOwogICAgICB9LAogICAgICB1c2VJbnNlcnRpb25FZmZlY3Q6IGZ1bmN0aW9uIChjcmVhdGUsIGRlcHMpIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VJbnNlcnRpb25FZmZlY3QnOwogICAgICAgIHVwZGF0ZUhvb2tUeXBlc0RldigpOwogICAgICAgIHJldHVybiBtb3VudEluc2VydGlvbkVmZmVjdChjcmVhdGUsIGRlcHMpOwogICAgICB9LAogICAgICB1c2VMYXlvdXRFZmZlY3Q6IGZ1bmN0aW9uIChjcmVhdGUsIGRlcHMpIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VMYXlvdXRFZmZlY3QnOwogICAgICAgIHVwZGF0ZUhvb2tUeXBlc0RldigpOwogICAgICAgIHJldHVybiBtb3VudExheW91dEVmZmVjdChjcmVhdGUsIGRlcHMpOwogICAgICB9LAogICAgICB1c2VNZW1vOiBmdW5jdGlvbiAoY3JlYXRlLCBkZXBzKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlTWVtbyc7CiAgICAgICAgdXBkYXRlSG9va1R5cGVzRGV2KCk7CiAgICAgICAgdmFyIHByZXZEaXNwYXRjaGVyID0gUmVhY3RDdXJyZW50RGlzcGF0Y2hlciQxLmN1cnJlbnQ7CiAgICAgICAgUmVhY3RDdXJyZW50RGlzcGF0Y2hlciQxLmN1cnJlbnQgPSBJbnZhbGlkTmVzdGVkSG9va3NEaXNwYXRjaGVyT25Nb3VudEluREVWOwoKICAgICAgICB0cnkgewogICAgICAgICAgcmV0dXJuIG1vdW50TWVtbyhjcmVhdGUsIGRlcHMpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICBSZWFjdEN1cnJlbnREaXNwYXRjaGVyJDEuY3VycmVudCA9IHByZXZEaXNwYXRjaGVyOwogICAgICAgIH0KICAgICAgfSwKICAgICAgdXNlUmVkdWNlcjogZnVuY3Rpb24gKHJlZHVjZXIsIGluaXRpYWxBcmcsIGluaXQpIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VSZWR1Y2VyJzsKICAgICAgICB1cGRhdGVIb29rVHlwZXNEZXYoKTsKICAgICAgICB2YXIgcHJldkRpc3BhdGNoZXIgPSBSZWFjdEN1cnJlbnREaXNwYXRjaGVyJDEuY3VycmVudDsKICAgICAgICBSZWFjdEN1cnJlbnREaXNwYXRjaGVyJDEuY3VycmVudCA9IEludmFsaWROZXN0ZWRIb29rc0Rpc3BhdGNoZXJPbk1vdW50SW5ERVY7CgogICAgICAgIHRyeSB7CiAgICAgICAgICByZXR1cm4gbW91bnRSZWR1Y2VyKHJlZHVjZXIsIGluaXRpYWxBcmcsIGluaXQpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICBSZWFjdEN1cnJlbnREaXNwYXRjaGVyJDEuY3VycmVudCA9IHByZXZEaXNwYXRjaGVyOwogICAgICAgIH0KICAgICAgfSwKICAgICAgdXNlUmVmOiBmdW5jdGlvbiAoaW5pdGlhbFZhbHVlKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlUmVmJzsKICAgICAgICB1cGRhdGVIb29rVHlwZXNEZXYoKTsKICAgICAgICByZXR1cm4gbW91bnRSZWYoaW5pdGlhbFZhbHVlKTsKICAgICAgfSwKICAgICAgdXNlU3RhdGU6IGZ1bmN0aW9uIChpbml0aWFsU3RhdGUpIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VTdGF0ZSc7CiAgICAgICAgdXBkYXRlSG9va1R5cGVzRGV2KCk7CiAgICAgICAgdmFyIHByZXZEaXNwYXRjaGVyID0gUmVhY3RDdXJyZW50RGlzcGF0Y2hlciQxLmN1cnJlbnQ7CiAgICAgICAgUmVhY3RDdXJyZW50RGlzcGF0Y2hlciQxLmN1cnJlbnQgPSBJbnZhbGlkTmVzdGVkSG9va3NEaXNwYXRjaGVyT25Nb3VudEluREVWOwoKICAgICAgICB0cnkgewogICAgICAgICAgcmV0dXJuIG1vdW50U3RhdGUoaW5pdGlhbFN0YXRlKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgUmVhY3RDdXJyZW50RGlzcGF0Y2hlciQxLmN1cnJlbnQgPSBwcmV2RGlzcGF0Y2hlcjsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHVzZURlYnVnVmFsdWU6IGZ1bmN0aW9uICh2YWx1ZSwgZm9ybWF0dGVyRm4pIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VEZWJ1Z1ZhbHVlJzsKICAgICAgICB1cGRhdGVIb29rVHlwZXNEZXYoKTsKICAgICAgICByZXR1cm4gbW91bnREZWJ1Z1ZhbHVlKCk7CiAgICAgIH0sCiAgICAgIHVzZURlZmVycmVkVmFsdWU6IGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgIGN1cnJlbnRIb29rTmFtZUluRGV2ID0gJ3VzZURlZmVycmVkVmFsdWUnOwogICAgICAgIHVwZGF0ZUhvb2tUeXBlc0RldigpOwogICAgICAgIHJldHVybiBtb3VudERlZmVycmVkVmFsdWUodmFsdWUpOwogICAgICB9LAogICAgICB1c2VUcmFuc2l0aW9uOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlVHJhbnNpdGlvbic7CiAgICAgICAgdXBkYXRlSG9va1R5cGVzRGV2KCk7CiAgICAgICAgcmV0dXJuIG1vdW50VHJhbnNpdGlvbigpOwogICAgICB9LAogICAgICB1c2VNdXRhYmxlU291cmNlOiBmdW5jdGlvbiAoc291cmNlLCBnZXRTbmFwc2hvdCwgc3Vic2NyaWJlKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlTXV0YWJsZVNvdXJjZSc7CiAgICAgICAgdXBkYXRlSG9va1R5cGVzRGV2KCk7CiAgICAgICAgcmV0dXJuIG1vdW50TXV0YWJsZVNvdXJjZSgpOwogICAgICB9LAogICAgICB1c2VTeW5jRXh0ZXJuYWxTdG9yZTogZnVuY3Rpb24gKHN1YnNjcmliZSwgZ2V0U25hcHNob3QsIGdldFNlcnZlclNuYXBzaG90KSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlU3luY0V4dGVybmFsU3RvcmUnOwogICAgICAgIHVwZGF0ZUhvb2tUeXBlc0RldigpOwogICAgICAgIHJldHVybiBtb3VudFN5bmNFeHRlcm5hbFN0b3JlKHN1YnNjcmliZSwgZ2V0U25hcHNob3QsIGdldFNlcnZlclNuYXBzaG90KTsKICAgICAgfSwKICAgICAgdXNlSWQ6IGZ1bmN0aW9uICgpIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VJZCc7CiAgICAgICAgdXBkYXRlSG9va1R5cGVzRGV2KCk7CiAgICAgICAgcmV0dXJuIG1vdW50SWQoKTsKICAgICAgfSwKICAgICAgdW5zdGFibGVfaXNOZXdSZWNvbmNpbGVyOiBlbmFibGVOZXdSZWNvbmNpbGVyCiAgICB9OwoKICAgIEhvb2tzRGlzcGF0Y2hlck9uVXBkYXRlSW5ERVYgPSB7CiAgICAgIHJlYWRDb250ZXh0OiBmdW5jdGlvbiAoY29udGV4dCkgewogICAgICAgIHJldHVybiByZWFkQ29udGV4dChjb250ZXh0KTsKICAgICAgfSwKICAgICAgdXNlQ2FsbGJhY2s6IGZ1bmN0aW9uIChjYWxsYmFjaywgZGVwcykgewogICAgICAgIGN1cnJlbnRIb29rTmFtZUluRGV2ID0gJ3VzZUNhbGxiYWNrJzsKICAgICAgICB1cGRhdGVIb29rVHlwZXNEZXYoKTsKICAgICAgICByZXR1cm4gdXBkYXRlQ2FsbGJhY2soY2FsbGJhY2ssIGRlcHMpOwogICAgICB9LAogICAgICB1c2VDb250ZXh0OiBmdW5jdGlvbiAoY29udGV4dCkgewogICAgICAgIGN1cnJlbnRIb29rTmFtZUluRGV2ID0gJ3VzZUNvbnRleHQnOwogICAgICAgIHVwZGF0ZUhvb2tUeXBlc0RldigpOwogICAgICAgIHJldHVybiByZWFkQ29udGV4dChjb250ZXh0KTsKICAgICAgfSwKICAgICAgdXNlRWZmZWN0OiBmdW5jdGlvbiAoY3JlYXRlLCBkZXBzKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlRWZmZWN0JzsKICAgICAgICB1cGRhdGVIb29rVHlwZXNEZXYoKTsKICAgICAgICByZXR1cm4gdXBkYXRlRWZmZWN0KGNyZWF0ZSwgZGVwcyk7CiAgICAgIH0sCiAgICAgIHVzZUltcGVyYXRpdmVIYW5kbGU6IGZ1bmN0aW9uIChyZWYsIGNyZWF0ZSwgZGVwcykgewogICAgICAgIGN1cnJlbnRIb29rTmFtZUluRGV2ID0gJ3VzZUltcGVyYXRpdmVIYW5kbGUnOwogICAgICAgIHVwZGF0ZUhvb2tUeXBlc0RldigpOwogICAgICAgIHJldHVybiB1cGRhdGVJbXBlcmF0aXZlSGFuZGxlKHJlZiwgY3JlYXRlLCBkZXBzKTsKICAgICAgfSwKICAgICAgdXNlSW5zZXJ0aW9uRWZmZWN0OiBmdW5jdGlvbiAoY3JlYXRlLCBkZXBzKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlSW5zZXJ0aW9uRWZmZWN0JzsKICAgICAgICB1cGRhdGVIb29rVHlwZXNEZXYoKTsKICAgICAgICByZXR1cm4gdXBkYXRlSW5zZXJ0aW9uRWZmZWN0KGNyZWF0ZSwgZGVwcyk7CiAgICAgIH0sCiAgICAgIHVzZUxheW91dEVmZmVjdDogZnVuY3Rpb24gKGNyZWF0ZSwgZGVwcykgewogICAgICAgIGN1cnJlbnRIb29rTmFtZUluRGV2ID0gJ3VzZUxheW91dEVmZmVjdCc7CiAgICAgICAgdXBkYXRlSG9va1R5cGVzRGV2KCk7CiAgICAgICAgcmV0dXJuIHVwZGF0ZUxheW91dEVmZmVjdChjcmVhdGUsIGRlcHMpOwogICAgICB9LAogICAgICB1c2VNZW1vOiBmdW5jdGlvbiAoY3JlYXRlLCBkZXBzKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlTWVtbyc7CiAgICAgICAgdXBkYXRlSG9va1R5cGVzRGV2KCk7CiAgICAgICAgdmFyIHByZXZEaXNwYXRjaGVyID0gUmVhY3RDdXJyZW50RGlzcGF0Y2hlciQxLmN1cnJlbnQ7CiAgICAgICAgUmVhY3RDdXJyZW50RGlzcGF0Y2hlciQxLmN1cnJlbnQgPSBJbnZhbGlkTmVzdGVkSG9va3NEaXNwYXRjaGVyT25VcGRhdGVJbkRFVjsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgIHJldHVybiB1cGRhdGVNZW1vKGNyZWF0ZSwgZGVwcyk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIFJlYWN0Q3VycmVudERpc3BhdGNoZXIkMS5jdXJyZW50ID0gcHJldkRpc3BhdGNoZXI7CiAgICAgICAgfQogICAgICB9LAogICAgICB1c2VSZWR1Y2VyOiBmdW5jdGlvbiAocmVkdWNlciwgaW5pdGlhbEFyZywgaW5pdCkgewogICAgICAgIGN1cnJlbnRIb29rTmFtZUluRGV2ID0gJ3VzZVJlZHVjZXInOwogICAgICAgIHVwZGF0ZUhvb2tUeXBlc0RldigpOwogICAgICAgIHZhciBwcmV2RGlzcGF0Y2hlciA9IFJlYWN0Q3VycmVudERpc3BhdGNoZXIkMS5jdXJyZW50OwogICAgICAgIFJlYWN0Q3VycmVudERpc3BhdGNoZXIkMS5jdXJyZW50ID0gSW52YWxpZE5lc3RlZEhvb2tzRGlzcGF0Y2hlck9uVXBkYXRlSW5ERVY7CgogICAgICAgIHRyeSB7CiAgICAgICAgICByZXR1cm4gdXBkYXRlUmVkdWNlcihyZWR1Y2VyLCBpbml0aWFsQXJnLCBpbml0KTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgUmVhY3RDdXJyZW50RGlzcGF0Y2hlciQxLmN1cnJlbnQgPSBwcmV2RGlzcGF0Y2hlcjsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHVzZVJlZjogZnVuY3Rpb24gKGluaXRpYWxWYWx1ZSkgewogICAgICAgIGN1cnJlbnRIb29rTmFtZUluRGV2ID0gJ3VzZVJlZic7CiAgICAgICAgdXBkYXRlSG9va1R5cGVzRGV2KCk7CiAgICAgICAgcmV0dXJuIHVwZGF0ZVJlZigpOwogICAgICB9LAogICAgICB1c2VTdGF0ZTogZnVuY3Rpb24gKGluaXRpYWxTdGF0ZSkgewogICAgICAgIGN1cnJlbnRIb29rTmFtZUluRGV2ID0gJ3VzZVN0YXRlJzsKICAgICAgICB1cGRhdGVIb29rVHlwZXNEZXYoKTsKICAgICAgICB2YXIgcHJldkRpc3BhdGNoZXIgPSBSZWFjdEN1cnJlbnREaXNwYXRjaGVyJDEuY3VycmVudDsKICAgICAgICBSZWFjdEN1cnJlbnREaXNwYXRjaGVyJDEuY3VycmVudCA9IEludmFsaWROZXN0ZWRIb29rc0Rpc3BhdGNoZXJPblVwZGF0ZUluREVWOwoKICAgICAgICB0cnkgewogICAgICAgICAgcmV0dXJuIHVwZGF0ZVN0YXRlKGluaXRpYWxTdGF0ZSk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIFJlYWN0Q3VycmVudERpc3BhdGNoZXIkMS5jdXJyZW50ID0gcHJldkRpc3BhdGNoZXI7CiAgICAgICAgfQogICAgICB9LAogICAgICB1c2VEZWJ1Z1ZhbHVlOiBmdW5jdGlvbiAodmFsdWUsIGZvcm1hdHRlckZuKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlRGVidWdWYWx1ZSc7CiAgICAgICAgdXBkYXRlSG9va1R5cGVzRGV2KCk7CiAgICAgICAgcmV0dXJuIHVwZGF0ZURlYnVnVmFsdWUoKTsKICAgICAgfSwKICAgICAgdXNlRGVmZXJyZWRWYWx1ZTogZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlRGVmZXJyZWRWYWx1ZSc7CiAgICAgICAgdXBkYXRlSG9va1R5cGVzRGV2KCk7CiAgICAgICAgcmV0dXJuIHVwZGF0ZURlZmVycmVkVmFsdWUodmFsdWUpOwogICAgICB9LAogICAgICB1c2VUcmFuc2l0aW9uOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlVHJhbnNpdGlvbic7CiAgICAgICAgdXBkYXRlSG9va1R5cGVzRGV2KCk7CiAgICAgICAgcmV0dXJuIHVwZGF0ZVRyYW5zaXRpb24oKTsKICAgICAgfSwKICAgICAgdXNlTXV0YWJsZVNvdXJjZTogZnVuY3Rpb24gKHNvdXJjZSwgZ2V0U25hcHNob3QsIHN1YnNjcmliZSkgewogICAgICAgIGN1cnJlbnRIb29rTmFtZUluRGV2ID0gJ3VzZU11dGFibGVTb3VyY2UnOwogICAgICAgIHVwZGF0ZUhvb2tUeXBlc0RldigpOwogICAgICAgIHJldHVybiB1cGRhdGVNdXRhYmxlU291cmNlKCk7CiAgICAgIH0sCiAgICAgIHVzZVN5bmNFeHRlcm5hbFN0b3JlOiBmdW5jdGlvbiAoc3Vic2NyaWJlLCBnZXRTbmFwc2hvdCwgZ2V0U2VydmVyU25hcHNob3QpIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VTeW5jRXh0ZXJuYWxTdG9yZSc7CiAgICAgICAgdXBkYXRlSG9va1R5cGVzRGV2KCk7CiAgICAgICAgcmV0dXJuIHVwZGF0ZVN5bmNFeHRlcm5hbFN0b3JlKHN1YnNjcmliZSwgZ2V0U25hcHNob3QpOwogICAgICB9LAogICAgICB1c2VJZDogZnVuY3Rpb24gKCkgewogICAgICAgIGN1cnJlbnRIb29rTmFtZUluRGV2ID0gJ3VzZUlkJzsKICAgICAgICB1cGRhdGVIb29rVHlwZXNEZXYoKTsKICAgICAgICByZXR1cm4gdXBkYXRlSWQoKTsKICAgICAgfSwKICAgICAgdW5zdGFibGVfaXNOZXdSZWNvbmNpbGVyOiBlbmFibGVOZXdSZWNvbmNpbGVyCiAgICB9OwoKICAgIEhvb2tzRGlzcGF0Y2hlck9uUmVyZW5kZXJJbkRFViA9IHsKICAgICAgcmVhZENvbnRleHQ6IGZ1bmN0aW9uIChjb250ZXh0KSB7CiAgICAgICAgcmV0dXJuIHJlYWRDb250ZXh0KGNvbnRleHQpOwogICAgICB9LAogICAgICB1c2VDYWxsYmFjazogZnVuY3Rpb24gKGNhbGxiYWNrLCBkZXBzKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlQ2FsbGJhY2snOwogICAgICAgIHVwZGF0ZUhvb2tUeXBlc0RldigpOwogICAgICAgIHJldHVybiB1cGRhdGVDYWxsYmFjayhjYWxsYmFjaywgZGVwcyk7CiAgICAgIH0sCiAgICAgIHVzZUNvbnRleHQ6IGZ1bmN0aW9uIChjb250ZXh0KSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlQ29udGV4dCc7CiAgICAgICAgdXBkYXRlSG9va1R5cGVzRGV2KCk7CiAgICAgICAgcmV0dXJuIHJlYWRDb250ZXh0KGNvbnRleHQpOwogICAgICB9LAogICAgICB1c2VFZmZlY3Q6IGZ1bmN0aW9uIChjcmVhdGUsIGRlcHMpIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VFZmZlY3QnOwogICAgICAgIHVwZGF0ZUhvb2tUeXBlc0RldigpOwogICAgICAgIHJldHVybiB1cGRhdGVFZmZlY3QoY3JlYXRlLCBkZXBzKTsKICAgICAgfSwKICAgICAgdXNlSW1wZXJhdGl2ZUhhbmRsZTogZnVuY3Rpb24gKHJlZiwgY3JlYXRlLCBkZXBzKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlSW1wZXJhdGl2ZUhhbmRsZSc7CiAgICAgICAgdXBkYXRlSG9va1R5cGVzRGV2KCk7CiAgICAgICAgcmV0dXJuIHVwZGF0ZUltcGVyYXRpdmVIYW5kbGUocmVmLCBjcmVhdGUsIGRlcHMpOwogICAgICB9LAogICAgICB1c2VJbnNlcnRpb25FZmZlY3Q6IGZ1bmN0aW9uIChjcmVhdGUsIGRlcHMpIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VJbnNlcnRpb25FZmZlY3QnOwogICAgICAgIHVwZGF0ZUhvb2tUeXBlc0RldigpOwogICAgICAgIHJldHVybiB1cGRhdGVJbnNlcnRpb25FZmZlY3QoY3JlYXRlLCBkZXBzKTsKICAgICAgfSwKICAgICAgdXNlTGF5b3V0RWZmZWN0OiBmdW5jdGlvbiAoY3JlYXRlLCBkZXBzKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlTGF5b3V0RWZmZWN0JzsKICAgICAgICB1cGRhdGVIb29rVHlwZXNEZXYoKTsKICAgICAgICByZXR1cm4gdXBkYXRlTGF5b3V0RWZmZWN0KGNyZWF0ZSwgZGVwcyk7CiAgICAgIH0sCiAgICAgIHVzZU1lbW86IGZ1bmN0aW9uIChjcmVhdGUsIGRlcHMpIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VNZW1vJzsKICAgICAgICB1cGRhdGVIb29rVHlwZXNEZXYoKTsKICAgICAgICB2YXIgcHJldkRpc3BhdGNoZXIgPSBSZWFjdEN1cnJlbnREaXNwYXRjaGVyJDEuY3VycmVudDsKICAgICAgICBSZWFjdEN1cnJlbnREaXNwYXRjaGVyJDEuY3VycmVudCA9IEludmFsaWROZXN0ZWRIb29rc0Rpc3BhdGNoZXJPblJlcmVuZGVySW5ERVY7CgogICAgICAgIHRyeSB7CiAgICAgICAgICByZXR1cm4gdXBkYXRlTWVtbyhjcmVhdGUsIGRlcHMpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICBSZWFjdEN1cnJlbnREaXNwYXRjaGVyJDEuY3VycmVudCA9IHByZXZEaXNwYXRjaGVyOwogICAgICAgIH0KICAgICAgfSwKICAgICAgdXNlUmVkdWNlcjogZnVuY3Rpb24gKHJlZHVjZXIsIGluaXRpYWxBcmcsIGluaXQpIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VSZWR1Y2VyJzsKICAgICAgICB1cGRhdGVIb29rVHlwZXNEZXYoKTsKICAgICAgICB2YXIgcHJldkRpc3BhdGNoZXIgPSBSZWFjdEN1cnJlbnREaXNwYXRjaGVyJDEuY3VycmVudDsKICAgICAgICBSZWFjdEN1cnJlbnREaXNwYXRjaGVyJDEuY3VycmVudCA9IEludmFsaWROZXN0ZWRIb29rc0Rpc3BhdGNoZXJPblJlcmVuZGVySW5ERVY7CgogICAgICAgIHRyeSB7CiAgICAgICAgICByZXR1cm4gcmVyZW5kZXJSZWR1Y2VyKHJlZHVjZXIsIGluaXRpYWxBcmcsIGluaXQpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICBSZWFjdEN1cnJlbnREaXNwYXRjaGVyJDEuY3VycmVudCA9IHByZXZEaXNwYXRjaGVyOwogICAgICAgIH0KICAgICAgfSwKICAgICAgdXNlUmVmOiBmdW5jdGlvbiAoaW5pdGlhbFZhbHVlKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlUmVmJzsKICAgICAgICB1cGRhdGVIb29rVHlwZXNEZXYoKTsKICAgICAgICByZXR1cm4gdXBkYXRlUmVmKCk7CiAgICAgIH0sCiAgICAgIHVzZVN0YXRlOiBmdW5jdGlvbiAoaW5pdGlhbFN0YXRlKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlU3RhdGUnOwogICAgICAgIHVwZGF0ZUhvb2tUeXBlc0RldigpOwogICAgICAgIHZhciBwcmV2RGlzcGF0Y2hlciA9IFJlYWN0Q3VycmVudERpc3BhdGNoZXIkMS5jdXJyZW50OwogICAgICAgIFJlYWN0Q3VycmVudERpc3BhdGNoZXIkMS5jdXJyZW50ID0gSW52YWxpZE5lc3RlZEhvb2tzRGlzcGF0Y2hlck9uUmVyZW5kZXJJbkRFVjsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgIHJldHVybiByZXJlbmRlclN0YXRlKGluaXRpYWxTdGF0ZSk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIFJlYWN0Q3VycmVudERpc3BhdGNoZXIkMS5jdXJyZW50ID0gcHJldkRpc3BhdGNoZXI7CiAgICAgICAgfQogICAgICB9LAogICAgICB1c2VEZWJ1Z1ZhbHVlOiBmdW5jdGlvbiAodmFsdWUsIGZvcm1hdHRlckZuKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlRGVidWdWYWx1ZSc7CiAgICAgICAgdXBkYXRlSG9va1R5cGVzRGV2KCk7CiAgICAgICAgcmV0dXJuIHVwZGF0ZURlYnVnVmFsdWUoKTsKICAgICAgfSwKICAgICAgdXNlRGVmZXJyZWRWYWx1ZTogZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlRGVmZXJyZWRWYWx1ZSc7CiAgICAgICAgdXBkYXRlSG9va1R5cGVzRGV2KCk7CiAgICAgICAgcmV0dXJuIHJlcmVuZGVyRGVmZXJyZWRWYWx1ZSh2YWx1ZSk7CiAgICAgIH0sCiAgICAgIHVzZVRyYW5zaXRpb246IGZ1bmN0aW9uICgpIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VUcmFuc2l0aW9uJzsKICAgICAgICB1cGRhdGVIb29rVHlwZXNEZXYoKTsKICAgICAgICByZXR1cm4gcmVyZW5kZXJUcmFuc2l0aW9uKCk7CiAgICAgIH0sCiAgICAgIHVzZU11dGFibGVTb3VyY2U6IGZ1bmN0aW9uIChzb3VyY2UsIGdldFNuYXBzaG90LCBzdWJzY3JpYmUpIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VNdXRhYmxlU291cmNlJzsKICAgICAgICB1cGRhdGVIb29rVHlwZXNEZXYoKTsKICAgICAgICByZXR1cm4gdXBkYXRlTXV0YWJsZVNvdXJjZSgpOwogICAgICB9LAogICAgICB1c2VTeW5jRXh0ZXJuYWxTdG9yZTogZnVuY3Rpb24gKHN1YnNjcmliZSwgZ2V0U25hcHNob3QsIGdldFNlcnZlclNuYXBzaG90KSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlU3luY0V4dGVybmFsU3RvcmUnOwogICAgICAgIHVwZGF0ZUhvb2tUeXBlc0RldigpOwogICAgICAgIHJldHVybiB1cGRhdGVTeW5jRXh0ZXJuYWxTdG9yZShzdWJzY3JpYmUsIGdldFNuYXBzaG90KTsKICAgICAgfSwKICAgICAgdXNlSWQ6IGZ1bmN0aW9uICgpIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VJZCc7CiAgICAgICAgdXBkYXRlSG9va1R5cGVzRGV2KCk7CiAgICAgICAgcmV0dXJuIHVwZGF0ZUlkKCk7CiAgICAgIH0sCiAgICAgIHVuc3RhYmxlX2lzTmV3UmVjb25jaWxlcjogZW5hYmxlTmV3UmVjb25jaWxlcgogICAgfTsKCiAgICBJbnZhbGlkTmVzdGVkSG9va3NEaXNwYXRjaGVyT25Nb3VudEluREVWID0gewogICAgICByZWFkQ29udGV4dDogZnVuY3Rpb24gKGNvbnRleHQpIHsKICAgICAgICB3YXJuSW52YWxpZENvbnRleHRBY2Nlc3MoKTsKICAgICAgICByZXR1cm4gcmVhZENvbnRleHQoY29udGV4dCk7CiAgICAgIH0sCiAgICAgIHVzZUNhbGxiYWNrOiBmdW5jdGlvbiAoY2FsbGJhY2ssIGRlcHMpIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VDYWxsYmFjayc7CiAgICAgICAgd2FybkludmFsaWRIb29rQWNjZXNzKCk7CiAgICAgICAgbW91bnRIb29rVHlwZXNEZXYoKTsKICAgICAgICByZXR1cm4gbW91bnRDYWxsYmFjayhjYWxsYmFjaywgZGVwcyk7CiAgICAgIH0sCiAgICAgIHVzZUNvbnRleHQ6IGZ1bmN0aW9uIChjb250ZXh0KSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlQ29udGV4dCc7CiAgICAgICAgd2FybkludmFsaWRIb29rQWNjZXNzKCk7CiAgICAgICAgbW91bnRIb29rVHlwZXNEZXYoKTsKICAgICAgICByZXR1cm4gcmVhZENvbnRleHQoY29udGV4dCk7CiAgICAgIH0sCiAgICAgIHVzZUVmZmVjdDogZnVuY3Rpb24gKGNyZWF0ZSwgZGVwcykgewogICAgICAgIGN1cnJlbnRIb29rTmFtZUluRGV2ID0gJ3VzZUVmZmVjdCc7CiAgICAgICAgd2FybkludmFsaWRIb29rQWNjZXNzKCk7CiAgICAgICAgbW91bnRIb29rVHlwZXNEZXYoKTsKICAgICAgICByZXR1cm4gbW91bnRFZmZlY3QoY3JlYXRlLCBkZXBzKTsKICAgICAgfSwKICAgICAgdXNlSW1wZXJhdGl2ZUhhbmRsZTogZnVuY3Rpb24gKHJlZiwgY3JlYXRlLCBkZXBzKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlSW1wZXJhdGl2ZUhhbmRsZSc7CiAgICAgICAgd2FybkludmFsaWRIb29rQWNjZXNzKCk7CiAgICAgICAgbW91bnRIb29rVHlwZXNEZXYoKTsKICAgICAgICByZXR1cm4gbW91bnRJbXBlcmF0aXZlSGFuZGxlKHJlZiwgY3JlYXRlLCBkZXBzKTsKICAgICAgfSwKICAgICAgdXNlSW5zZXJ0aW9uRWZmZWN0OiBmdW5jdGlvbiAoY3JlYXRlLCBkZXBzKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlSW5zZXJ0aW9uRWZmZWN0JzsKICAgICAgICB3YXJuSW52YWxpZEhvb2tBY2Nlc3MoKTsKICAgICAgICBtb3VudEhvb2tUeXBlc0RldigpOwogICAgICAgIHJldHVybiBtb3VudEluc2VydGlvbkVmZmVjdChjcmVhdGUsIGRlcHMpOwogICAgICB9LAogICAgICB1c2VMYXlvdXRFZmZlY3Q6IGZ1bmN0aW9uIChjcmVhdGUsIGRlcHMpIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VMYXlvdXRFZmZlY3QnOwogICAgICAgIHdhcm5JbnZhbGlkSG9va0FjY2VzcygpOwogICAgICAgIG1vdW50SG9va1R5cGVzRGV2KCk7CiAgICAgICAgcmV0dXJuIG1vdW50TGF5b3V0RWZmZWN0KGNyZWF0ZSwgZGVwcyk7CiAgICAgIH0sCiAgICAgIHVzZU1lbW86IGZ1bmN0aW9uIChjcmVhdGUsIGRlcHMpIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VNZW1vJzsKICAgICAgICB3YXJuSW52YWxpZEhvb2tBY2Nlc3MoKTsKICAgICAgICBtb3VudEhvb2tUeXBlc0RldigpOwogICAgICAgIHZhciBwcmV2RGlzcGF0Y2hlciA9IFJlYWN0Q3VycmVudERpc3BhdGNoZXIkMS5jdXJyZW50OwogICAgICAgIFJlYWN0Q3VycmVudERpc3BhdGNoZXIkMS5jdXJyZW50ID0gSW52YWxpZE5lc3RlZEhvb2tzRGlzcGF0Y2hlck9uTW91bnRJbkRFVjsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgIHJldHVybiBtb3VudE1lbW8oY3JlYXRlLCBkZXBzKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgUmVhY3RDdXJyZW50RGlzcGF0Y2hlciQxLmN1cnJlbnQgPSBwcmV2RGlzcGF0Y2hlcjsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHVzZVJlZHVjZXI6IGZ1bmN0aW9uIChyZWR1Y2VyLCBpbml0aWFsQXJnLCBpbml0KSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlUmVkdWNlcic7CiAgICAgICAgd2FybkludmFsaWRIb29rQWNjZXNzKCk7CiAgICAgICAgbW91bnRIb29rVHlwZXNEZXYoKTsKICAgICAgICB2YXIgcHJldkRpc3BhdGNoZXIgPSBSZWFjdEN1cnJlbnREaXNwYXRjaGVyJDEuY3VycmVudDsKICAgICAgICBSZWFjdEN1cnJlbnREaXNwYXRjaGVyJDEuY3VycmVudCA9IEludmFsaWROZXN0ZWRIb29rc0Rpc3BhdGNoZXJPbk1vdW50SW5ERVY7CgogICAgICAgIHRyeSB7CiAgICAgICAgICByZXR1cm4gbW91bnRSZWR1Y2VyKHJlZHVjZXIsIGluaXRpYWxBcmcsIGluaXQpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICBSZWFjdEN1cnJlbnREaXNwYXRjaGVyJDEuY3VycmVudCA9IHByZXZEaXNwYXRjaGVyOwogICAgICAgIH0KICAgICAgfSwKICAgICAgdXNlUmVmOiBmdW5jdGlvbiAoaW5pdGlhbFZhbHVlKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlUmVmJzsKICAgICAgICB3YXJuSW52YWxpZEhvb2tBY2Nlc3MoKTsKICAgICAgICBtb3VudEhvb2tUeXBlc0RldigpOwogICAgICAgIHJldHVybiBtb3VudFJlZihpbml0aWFsVmFsdWUpOwogICAgICB9LAogICAgICB1c2VTdGF0ZTogZnVuY3Rpb24gKGluaXRpYWxTdGF0ZSkgewogICAgICAgIGN1cnJlbnRIb29rTmFtZUluRGV2ID0gJ3VzZVN0YXRlJzsKICAgICAgICB3YXJuSW52YWxpZEhvb2tBY2Nlc3MoKTsKICAgICAgICBtb3VudEhvb2tUeXBlc0RldigpOwogICAgICAgIHZhciBwcmV2RGlzcGF0Y2hlciA9IFJlYWN0Q3VycmVudERpc3BhdGNoZXIkMS5jdXJyZW50OwogICAgICAgIFJlYWN0Q3VycmVudERpc3BhdGNoZXIkMS5jdXJyZW50ID0gSW52YWxpZE5lc3RlZEhvb2tzRGlzcGF0Y2hlck9uTW91bnRJbkRFVjsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgIHJldHVybiBtb3VudFN0YXRlKGluaXRpYWxTdGF0ZSk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIFJlYWN0Q3VycmVudERpc3BhdGNoZXIkMS5jdXJyZW50ID0gcHJldkRpc3BhdGNoZXI7CiAgICAgICAgfQogICAgICB9LAogICAgICB1c2VEZWJ1Z1ZhbHVlOiBmdW5jdGlvbiAodmFsdWUsIGZvcm1hdHRlckZuKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlRGVidWdWYWx1ZSc7CiAgICAgICAgd2FybkludmFsaWRIb29rQWNjZXNzKCk7CiAgICAgICAgbW91bnRIb29rVHlwZXNEZXYoKTsKICAgICAgICByZXR1cm4gbW91bnREZWJ1Z1ZhbHVlKCk7CiAgICAgIH0sCiAgICAgIHVzZURlZmVycmVkVmFsdWU6IGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgIGN1cnJlbnRIb29rTmFtZUluRGV2ID0gJ3VzZURlZmVycmVkVmFsdWUnOwogICAgICAgIHdhcm5JbnZhbGlkSG9va0FjY2VzcygpOwogICAgICAgIG1vdW50SG9va1R5cGVzRGV2KCk7CiAgICAgICAgcmV0dXJuIG1vdW50RGVmZXJyZWRWYWx1ZSh2YWx1ZSk7CiAgICAgIH0sCiAgICAgIHVzZVRyYW5zaXRpb246IGZ1bmN0aW9uICgpIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VUcmFuc2l0aW9uJzsKICAgICAgICB3YXJuSW52YWxpZEhvb2tBY2Nlc3MoKTsKICAgICAgICBtb3VudEhvb2tUeXBlc0RldigpOwogICAgICAgIHJldHVybiBtb3VudFRyYW5zaXRpb24oKTsKICAgICAgfSwKICAgICAgdXNlTXV0YWJsZVNvdXJjZTogZnVuY3Rpb24gKHNvdXJjZSwgZ2V0U25hcHNob3QsIHN1YnNjcmliZSkgewogICAgICAgIGN1cnJlbnRIb29rTmFtZUluRGV2ID0gJ3VzZU11dGFibGVTb3VyY2UnOwogICAgICAgIHdhcm5JbnZhbGlkSG9va0FjY2VzcygpOwogICAgICAgIG1vdW50SG9va1R5cGVzRGV2KCk7CiAgICAgICAgcmV0dXJuIG1vdW50TXV0YWJsZVNvdXJjZSgpOwogICAgICB9LAogICAgICB1c2VTeW5jRXh0ZXJuYWxTdG9yZTogZnVuY3Rpb24gKHN1YnNjcmliZSwgZ2V0U25hcHNob3QsIGdldFNlcnZlclNuYXBzaG90KSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlU3luY0V4dGVybmFsU3RvcmUnOwogICAgICAgIHdhcm5JbnZhbGlkSG9va0FjY2VzcygpOwogICAgICAgIG1vdW50SG9va1R5cGVzRGV2KCk7CiAgICAgICAgcmV0dXJuIG1vdW50U3luY0V4dGVybmFsU3RvcmUoc3Vic2NyaWJlLCBnZXRTbmFwc2hvdCwgZ2V0U2VydmVyU25hcHNob3QpOwogICAgICB9LAogICAgICB1c2VJZDogZnVuY3Rpb24gKCkgewogICAgICAgIGN1cnJlbnRIb29rTmFtZUluRGV2ID0gJ3VzZUlkJzsKICAgICAgICB3YXJuSW52YWxpZEhvb2tBY2Nlc3MoKTsKICAgICAgICBtb3VudEhvb2tUeXBlc0RldigpOwogICAgICAgIHJldHVybiBtb3VudElkKCk7CiAgICAgIH0sCiAgICAgIHVuc3RhYmxlX2lzTmV3UmVjb25jaWxlcjogZW5hYmxlTmV3UmVjb25jaWxlcgogICAgfTsKCiAgICBJbnZhbGlkTmVzdGVkSG9va3NEaXNwYXRjaGVyT25VcGRhdGVJbkRFViA9IHsKICAgICAgcmVhZENvbnRleHQ6IGZ1bmN0aW9uIChjb250ZXh0KSB7CiAgICAgICAgd2FybkludmFsaWRDb250ZXh0QWNjZXNzKCk7CiAgICAgICAgcmV0dXJuIHJlYWRDb250ZXh0KGNvbnRleHQpOwogICAgICB9LAogICAgICB1c2VDYWxsYmFjazogZnVuY3Rpb24gKGNhbGxiYWNrLCBkZXBzKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlQ2FsbGJhY2snOwogICAgICAgIHdhcm5JbnZhbGlkSG9va0FjY2VzcygpOwogICAgICAgIHVwZGF0ZUhvb2tUeXBlc0RldigpOwogICAgICAgIHJldHVybiB1cGRhdGVDYWxsYmFjayhjYWxsYmFjaywgZGVwcyk7CiAgICAgIH0sCiAgICAgIHVzZUNvbnRleHQ6IGZ1bmN0aW9uIChjb250ZXh0KSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlQ29udGV4dCc7CiAgICAgICAgd2FybkludmFsaWRIb29rQWNjZXNzKCk7CiAgICAgICAgdXBkYXRlSG9va1R5cGVzRGV2KCk7CiAgICAgICAgcmV0dXJuIHJlYWRDb250ZXh0KGNvbnRleHQpOwogICAgICB9LAogICAgICB1c2VFZmZlY3Q6IGZ1bmN0aW9uIChjcmVhdGUsIGRlcHMpIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VFZmZlY3QnOwogICAgICAgIHdhcm5JbnZhbGlkSG9va0FjY2VzcygpOwogICAgICAgIHVwZGF0ZUhvb2tUeXBlc0RldigpOwogICAgICAgIHJldHVybiB1cGRhdGVFZmZlY3QoY3JlYXRlLCBkZXBzKTsKICAgICAgfSwKICAgICAgdXNlSW1wZXJhdGl2ZUhhbmRsZTogZnVuY3Rpb24gKHJlZiwgY3JlYXRlLCBkZXBzKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlSW1wZXJhdGl2ZUhhbmRsZSc7CiAgICAgICAgd2FybkludmFsaWRIb29rQWNjZXNzKCk7CiAgICAgICAgdXBkYXRlSG9va1R5cGVzRGV2KCk7CiAgICAgICAgcmV0dXJuIHVwZGF0ZUltcGVyYXRpdmVIYW5kbGUocmVmLCBjcmVhdGUsIGRlcHMpOwogICAgICB9LAogICAgICB1c2VJbnNlcnRpb25FZmZlY3Q6IGZ1bmN0aW9uIChjcmVhdGUsIGRlcHMpIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VJbnNlcnRpb25FZmZlY3QnOwogICAgICAgIHdhcm5JbnZhbGlkSG9va0FjY2VzcygpOwogICAgICAgIHVwZGF0ZUhvb2tUeXBlc0RldigpOwogICAgICAgIHJldHVybiB1cGRhdGVJbnNlcnRpb25FZmZlY3QoY3JlYXRlLCBkZXBzKTsKICAgICAgfSwKICAgICAgdXNlTGF5b3V0RWZmZWN0OiBmdW5jdGlvbiAoY3JlYXRlLCBkZXBzKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlTGF5b3V0RWZmZWN0JzsKICAgICAgICB3YXJuSW52YWxpZEhvb2tBY2Nlc3MoKTsKICAgICAgICB1cGRhdGVIb29rVHlwZXNEZXYoKTsKICAgICAgICByZXR1cm4gdXBkYXRlTGF5b3V0RWZmZWN0KGNyZWF0ZSwgZGVwcyk7CiAgICAgIH0sCiAgICAgIHVzZU1lbW86IGZ1bmN0aW9uIChjcmVhdGUsIGRlcHMpIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VNZW1vJzsKICAgICAgICB3YXJuSW52YWxpZEhvb2tBY2Nlc3MoKTsKICAgICAgICB1cGRhdGVIb29rVHlwZXNEZXYoKTsKICAgICAgICB2YXIgcHJldkRpc3BhdGNoZXIgPSBSZWFjdEN1cnJlbnREaXNwYXRjaGVyJDEuY3VycmVudDsKICAgICAgICBSZWFjdEN1cnJlbnREaXNwYXRjaGVyJDEuY3VycmVudCA9IEludmFsaWROZXN0ZWRIb29rc0Rpc3BhdGNoZXJPblVwZGF0ZUluREVWOwoKICAgICAgICB0cnkgewogICAgICAgICAgcmV0dXJuIHVwZGF0ZU1lbW8oY3JlYXRlLCBkZXBzKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgUmVhY3RDdXJyZW50RGlzcGF0Y2hlciQxLmN1cnJlbnQgPSBwcmV2RGlzcGF0Y2hlcjsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHVzZVJlZHVjZXI6IGZ1bmN0aW9uIChyZWR1Y2VyLCBpbml0aWFsQXJnLCBpbml0KSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlUmVkdWNlcic7CiAgICAgICAgd2FybkludmFsaWRIb29rQWNjZXNzKCk7CiAgICAgICAgdXBkYXRlSG9va1R5cGVzRGV2KCk7CiAgICAgICAgdmFyIHByZXZEaXNwYXRjaGVyID0gUmVhY3RDdXJyZW50RGlzcGF0Y2hlciQxLmN1cnJlbnQ7CiAgICAgICAgUmVhY3RDdXJyZW50RGlzcGF0Y2hlciQxLmN1cnJlbnQgPSBJbnZhbGlkTmVzdGVkSG9va3NEaXNwYXRjaGVyT25VcGRhdGVJbkRFVjsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgIHJldHVybiB1cGRhdGVSZWR1Y2VyKHJlZHVjZXIsIGluaXRpYWxBcmcsIGluaXQpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICBSZWFjdEN1cnJlbnREaXNwYXRjaGVyJDEuY3VycmVudCA9IHByZXZEaXNwYXRjaGVyOwogICAgICAgIH0KICAgICAgfSwKICAgICAgdXNlUmVmOiBmdW5jdGlvbiAoaW5pdGlhbFZhbHVlKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlUmVmJzsKICAgICAgICB3YXJuSW52YWxpZEhvb2tBY2Nlc3MoKTsKICAgICAgICB1cGRhdGVIb29rVHlwZXNEZXYoKTsKICAgICAgICByZXR1cm4gdXBkYXRlUmVmKCk7CiAgICAgIH0sCiAgICAgIHVzZVN0YXRlOiBmdW5jdGlvbiAoaW5pdGlhbFN0YXRlKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlU3RhdGUnOwogICAgICAgIHdhcm5JbnZhbGlkSG9va0FjY2VzcygpOwogICAgICAgIHVwZGF0ZUhvb2tUeXBlc0RldigpOwogICAgICAgIHZhciBwcmV2RGlzcGF0Y2hlciA9IFJlYWN0Q3VycmVudERpc3BhdGNoZXIkMS5jdXJyZW50OwogICAgICAgIFJlYWN0Q3VycmVudERpc3BhdGNoZXIkMS5jdXJyZW50ID0gSW52YWxpZE5lc3RlZEhvb2tzRGlzcGF0Y2hlck9uVXBkYXRlSW5ERVY7CgogICAgICAgIHRyeSB7CiAgICAgICAgICByZXR1cm4gdXBkYXRlU3RhdGUoaW5pdGlhbFN0YXRlKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgUmVhY3RDdXJyZW50RGlzcGF0Y2hlciQxLmN1cnJlbnQgPSBwcmV2RGlzcGF0Y2hlcjsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHVzZURlYnVnVmFsdWU6IGZ1bmN0aW9uICh2YWx1ZSwgZm9ybWF0dGVyRm4pIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VEZWJ1Z1ZhbHVlJzsKICAgICAgICB3YXJuSW52YWxpZEhvb2tBY2Nlc3MoKTsKICAgICAgICB1cGRhdGVIb29rVHlwZXNEZXYoKTsKICAgICAgICByZXR1cm4gdXBkYXRlRGVidWdWYWx1ZSgpOwogICAgICB9LAogICAgICB1c2VEZWZlcnJlZFZhbHVlOiBmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VEZWZlcnJlZFZhbHVlJzsKICAgICAgICB3YXJuSW52YWxpZEhvb2tBY2Nlc3MoKTsKICAgICAgICB1cGRhdGVIb29rVHlwZXNEZXYoKTsKICAgICAgICByZXR1cm4gdXBkYXRlRGVmZXJyZWRWYWx1ZSh2YWx1ZSk7CiAgICAgIH0sCiAgICAgIHVzZVRyYW5zaXRpb246IGZ1bmN0aW9uICgpIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VUcmFuc2l0aW9uJzsKICAgICAgICB3YXJuSW52YWxpZEhvb2tBY2Nlc3MoKTsKICAgICAgICB1cGRhdGVIb29rVHlwZXNEZXYoKTsKICAgICAgICByZXR1cm4gdXBkYXRlVHJhbnNpdGlvbigpOwogICAgICB9LAogICAgICB1c2VNdXRhYmxlU291cmNlOiBmdW5jdGlvbiAoc291cmNlLCBnZXRTbmFwc2hvdCwgc3Vic2NyaWJlKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlTXV0YWJsZVNvdXJjZSc7CiAgICAgICAgd2FybkludmFsaWRIb29rQWNjZXNzKCk7CiAgICAgICAgdXBkYXRlSG9va1R5cGVzRGV2KCk7CiAgICAgICAgcmV0dXJuIHVwZGF0ZU11dGFibGVTb3VyY2UoKTsKICAgICAgfSwKICAgICAgdXNlU3luY0V4dGVybmFsU3RvcmU6IGZ1bmN0aW9uIChzdWJzY3JpYmUsIGdldFNuYXBzaG90LCBnZXRTZXJ2ZXJTbmFwc2hvdCkgewogICAgICAgIGN1cnJlbnRIb29rTmFtZUluRGV2ID0gJ3VzZVN5bmNFeHRlcm5hbFN0b3JlJzsKICAgICAgICB3YXJuSW52YWxpZEhvb2tBY2Nlc3MoKTsKICAgICAgICB1cGRhdGVIb29rVHlwZXNEZXYoKTsKICAgICAgICByZXR1cm4gdXBkYXRlU3luY0V4dGVybmFsU3RvcmUoc3Vic2NyaWJlLCBnZXRTbmFwc2hvdCk7CiAgICAgIH0sCiAgICAgIHVzZUlkOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlSWQnOwogICAgICAgIHdhcm5JbnZhbGlkSG9va0FjY2VzcygpOwogICAgICAgIHVwZGF0ZUhvb2tUeXBlc0RldigpOwogICAgICAgIHJldHVybiB1cGRhdGVJZCgpOwogICAgICB9LAogICAgICB1bnN0YWJsZV9pc05ld1JlY29uY2lsZXI6IGVuYWJsZU5ld1JlY29uY2lsZXIKICAgIH07CgogICAgSW52YWxpZE5lc3RlZEhvb2tzRGlzcGF0Y2hlck9uUmVyZW5kZXJJbkRFViA9IHsKICAgICAgcmVhZENvbnRleHQ6IGZ1bmN0aW9uIChjb250ZXh0KSB7CiAgICAgICAgd2FybkludmFsaWRDb250ZXh0QWNjZXNzKCk7CiAgICAgICAgcmV0dXJuIHJlYWRDb250ZXh0KGNvbnRleHQpOwogICAgICB9LAogICAgICB1c2VDYWxsYmFjazogZnVuY3Rpb24gKGNhbGxiYWNrLCBkZXBzKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlQ2FsbGJhY2snOwogICAgICAgIHdhcm5JbnZhbGlkSG9va0FjY2VzcygpOwogICAgICAgIHVwZGF0ZUhvb2tUeXBlc0RldigpOwogICAgICAgIHJldHVybiB1cGRhdGVDYWxsYmFjayhjYWxsYmFjaywgZGVwcyk7CiAgICAgIH0sCiAgICAgIHVzZUNvbnRleHQ6IGZ1bmN0aW9uIChjb250ZXh0KSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlQ29udGV4dCc7CiAgICAgICAgd2FybkludmFsaWRIb29rQWNjZXNzKCk7CiAgICAgICAgdXBkYXRlSG9va1R5cGVzRGV2KCk7CiAgICAgICAgcmV0dXJuIHJlYWRDb250ZXh0KGNvbnRleHQpOwogICAgICB9LAogICAgICB1c2VFZmZlY3Q6IGZ1bmN0aW9uIChjcmVhdGUsIGRlcHMpIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VFZmZlY3QnOwogICAgICAgIHdhcm5JbnZhbGlkSG9va0FjY2VzcygpOwogICAgICAgIHVwZGF0ZUhvb2tUeXBlc0RldigpOwogICAgICAgIHJldHVybiB1cGRhdGVFZmZlY3QoY3JlYXRlLCBkZXBzKTsKICAgICAgfSwKICAgICAgdXNlSW1wZXJhdGl2ZUhhbmRsZTogZnVuY3Rpb24gKHJlZiwgY3JlYXRlLCBkZXBzKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlSW1wZXJhdGl2ZUhhbmRsZSc7CiAgICAgICAgd2FybkludmFsaWRIb29rQWNjZXNzKCk7CiAgICAgICAgdXBkYXRlSG9va1R5cGVzRGV2KCk7CiAgICAgICAgcmV0dXJuIHVwZGF0ZUltcGVyYXRpdmVIYW5kbGUocmVmLCBjcmVhdGUsIGRlcHMpOwogICAgICB9LAogICAgICB1c2VJbnNlcnRpb25FZmZlY3Q6IGZ1bmN0aW9uIChjcmVhdGUsIGRlcHMpIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VJbnNlcnRpb25FZmZlY3QnOwogICAgICAgIHdhcm5JbnZhbGlkSG9va0FjY2VzcygpOwogICAgICAgIHVwZGF0ZUhvb2tUeXBlc0RldigpOwogICAgICAgIHJldHVybiB1cGRhdGVJbnNlcnRpb25FZmZlY3QoY3JlYXRlLCBkZXBzKTsKICAgICAgfSwKICAgICAgdXNlTGF5b3V0RWZmZWN0OiBmdW5jdGlvbiAoY3JlYXRlLCBkZXBzKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlTGF5b3V0RWZmZWN0JzsKICAgICAgICB3YXJuSW52YWxpZEhvb2tBY2Nlc3MoKTsKICAgICAgICB1cGRhdGVIb29rVHlwZXNEZXYoKTsKICAgICAgICByZXR1cm4gdXBkYXRlTGF5b3V0RWZmZWN0KGNyZWF0ZSwgZGVwcyk7CiAgICAgIH0sCiAgICAgIHVzZU1lbW86IGZ1bmN0aW9uIChjcmVhdGUsIGRlcHMpIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VNZW1vJzsKICAgICAgICB3YXJuSW52YWxpZEhvb2tBY2Nlc3MoKTsKICAgICAgICB1cGRhdGVIb29rVHlwZXNEZXYoKTsKICAgICAgICB2YXIgcHJldkRpc3BhdGNoZXIgPSBSZWFjdEN1cnJlbnREaXNwYXRjaGVyJDEuY3VycmVudDsKICAgICAgICBSZWFjdEN1cnJlbnREaXNwYXRjaGVyJDEuY3VycmVudCA9IEludmFsaWROZXN0ZWRIb29rc0Rpc3BhdGNoZXJPblVwZGF0ZUluREVWOwoKICAgICAgICB0cnkgewogICAgICAgICAgcmV0dXJuIHVwZGF0ZU1lbW8oY3JlYXRlLCBkZXBzKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgUmVhY3RDdXJyZW50RGlzcGF0Y2hlciQxLmN1cnJlbnQgPSBwcmV2RGlzcGF0Y2hlcjsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHVzZVJlZHVjZXI6IGZ1bmN0aW9uIChyZWR1Y2VyLCBpbml0aWFsQXJnLCBpbml0KSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlUmVkdWNlcic7CiAgICAgICAgd2FybkludmFsaWRIb29rQWNjZXNzKCk7CiAgICAgICAgdXBkYXRlSG9va1R5cGVzRGV2KCk7CiAgICAgICAgdmFyIHByZXZEaXNwYXRjaGVyID0gUmVhY3RDdXJyZW50RGlzcGF0Y2hlciQxLmN1cnJlbnQ7CiAgICAgICAgUmVhY3RDdXJyZW50RGlzcGF0Y2hlciQxLmN1cnJlbnQgPSBJbnZhbGlkTmVzdGVkSG9va3NEaXNwYXRjaGVyT25VcGRhdGVJbkRFVjsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgIHJldHVybiByZXJlbmRlclJlZHVjZXIocmVkdWNlciwgaW5pdGlhbEFyZywgaW5pdCk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIFJlYWN0Q3VycmVudERpc3BhdGNoZXIkMS5jdXJyZW50ID0gcHJldkRpc3BhdGNoZXI7CiAgICAgICAgfQogICAgICB9LAogICAgICB1c2VSZWY6IGZ1bmN0aW9uIChpbml0aWFsVmFsdWUpIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VSZWYnOwogICAgICAgIHdhcm5JbnZhbGlkSG9va0FjY2VzcygpOwogICAgICAgIHVwZGF0ZUhvb2tUeXBlc0RldigpOwogICAgICAgIHJldHVybiB1cGRhdGVSZWYoKTsKICAgICAgfSwKICAgICAgdXNlU3RhdGU6IGZ1bmN0aW9uIChpbml0aWFsU3RhdGUpIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VTdGF0ZSc7CiAgICAgICAgd2FybkludmFsaWRIb29rQWNjZXNzKCk7CiAgICAgICAgdXBkYXRlSG9va1R5cGVzRGV2KCk7CiAgICAgICAgdmFyIHByZXZEaXNwYXRjaGVyID0gUmVhY3RDdXJyZW50RGlzcGF0Y2hlciQxLmN1cnJlbnQ7CiAgICAgICAgUmVhY3RDdXJyZW50RGlzcGF0Y2hlciQxLmN1cnJlbnQgPSBJbnZhbGlkTmVzdGVkSG9va3NEaXNwYXRjaGVyT25VcGRhdGVJbkRFVjsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgIHJldHVybiByZXJlbmRlclN0YXRlKGluaXRpYWxTdGF0ZSk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIFJlYWN0Q3VycmVudERpc3BhdGNoZXIkMS5jdXJyZW50ID0gcHJldkRpc3BhdGNoZXI7CiAgICAgICAgfQogICAgICB9LAogICAgICB1c2VEZWJ1Z1ZhbHVlOiBmdW5jdGlvbiAodmFsdWUsIGZvcm1hdHRlckZuKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlRGVidWdWYWx1ZSc7CiAgICAgICAgd2FybkludmFsaWRIb29rQWNjZXNzKCk7CiAgICAgICAgdXBkYXRlSG9va1R5cGVzRGV2KCk7CiAgICAgICAgcmV0dXJuIHVwZGF0ZURlYnVnVmFsdWUoKTsKICAgICAgfSwKICAgICAgdXNlRGVmZXJyZWRWYWx1ZTogZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlRGVmZXJyZWRWYWx1ZSc7CiAgICAgICAgd2FybkludmFsaWRIb29rQWNjZXNzKCk7CiAgICAgICAgdXBkYXRlSG9va1R5cGVzRGV2KCk7CiAgICAgICAgcmV0dXJuIHJlcmVuZGVyRGVmZXJyZWRWYWx1ZSh2YWx1ZSk7CiAgICAgIH0sCiAgICAgIHVzZVRyYW5zaXRpb246IGZ1bmN0aW9uICgpIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VUcmFuc2l0aW9uJzsKICAgICAgICB3YXJuSW52YWxpZEhvb2tBY2Nlc3MoKTsKICAgICAgICB1cGRhdGVIb29rVHlwZXNEZXYoKTsKICAgICAgICByZXR1cm4gcmVyZW5kZXJUcmFuc2l0aW9uKCk7CiAgICAgIH0sCiAgICAgIHVzZU11dGFibGVTb3VyY2U6IGZ1bmN0aW9uIChzb3VyY2UsIGdldFNuYXBzaG90LCBzdWJzY3JpYmUpIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VNdXRhYmxlU291cmNlJzsKICAgICAgICB3YXJuSW52YWxpZEhvb2tBY2Nlc3MoKTsKICAgICAgICB1cGRhdGVIb29rVHlwZXNEZXYoKTsKICAgICAgICByZXR1cm4gdXBkYXRlTXV0YWJsZVNvdXJjZSgpOwogICAgICB9LAogICAgICB1c2VTeW5jRXh0ZXJuYWxTdG9yZTogZnVuY3Rpb24gKHN1YnNjcmliZSwgZ2V0U25hcHNob3QsIGdldFNlcnZlclNuYXBzaG90KSB7CiAgICAgICAgY3VycmVudEhvb2tOYW1lSW5EZXYgPSAndXNlU3luY0V4dGVybmFsU3RvcmUnOwogICAgICAgIHdhcm5JbnZhbGlkSG9va0FjY2VzcygpOwogICAgICAgIHVwZGF0ZUhvb2tUeXBlc0RldigpOwogICAgICAgIHJldHVybiB1cGRhdGVTeW5jRXh0ZXJuYWxTdG9yZShzdWJzY3JpYmUsIGdldFNuYXBzaG90KTsKICAgICAgfSwKICAgICAgdXNlSWQ6IGZ1bmN0aW9uICgpIHsKICAgICAgICBjdXJyZW50SG9va05hbWVJbkRldiA9ICd1c2VJZCc7CiAgICAgICAgd2FybkludmFsaWRIb29rQWNjZXNzKCk7CiAgICAgICAgdXBkYXRlSG9va1R5cGVzRGV2KCk7CiAgICAgICAgcmV0dXJuIHVwZGF0ZUlkKCk7CiAgICAgIH0sCiAgICAgIHVuc3RhYmxlX2lzTmV3UmVjb25jaWxlcjogZW5hYmxlTmV3UmVjb25jaWxlcgogICAgfTsKICB9CgogIHZhciBub3ckMSA9IHVuc3RhYmxlX25vdzsKICB2YXIgY29tbWl0VGltZSA9IDA7CiAgdmFyIGxheW91dEVmZmVjdFN0YXJ0VGltZSA9IC0xOwogIHZhciBwcm9maWxlclN0YXJ0VGltZSA9IC0xOwogIHZhciBwYXNzaXZlRWZmZWN0U3RhcnRUaW1lID0gLTE7CiAgLyoqCiAgICogVHJhY2tzIHdoZXRoZXIgdGhlIGN1cnJlbnQgdXBkYXRlIHdhcyBhIG5lc3RlZC9jYXNjYWRpbmcgdXBkYXRlIChzY2hlZHVsZWQgZnJvbSBhIGxheW91dCBlZmZlY3QpLgogICAqCiAgICogVGhlIG92ZXJhbGwgc2VxdWVuY2UgaXM6CiAgICogICAxLiByZW5kZXIKICAgKiAgIDIuIGNvbW1pdCAoYW5kIGNhbGwgYG9uUmVuZGVyYCwgYG9uQ29tbWl0YCkKICAgKiAgIDMuIGNoZWNrIGZvciBuZXN0ZWQgdXBkYXRlcwogICAqICAgNC4gZmx1c2ggcGFzc2l2ZSBlZmZlY3RzIChhbmQgY2FsbCBgb25Qb3N0Q29tbWl0YCkKICAgKgogICAqIE5lc3RlZCB1cGRhdGVzIGFyZSBpZGVudGlmaWVkIGluIHN0ZXAgMyBhYm92ZSwKICAgKiBidXQgc3RlcCA0IHN0aWxsIGFwcGxpZXMgdG8gdGhlIHdvcmsgdGhhdCB3YXMganVzdCBjb21taXR0ZWQuCiAgICogV2UgdXNlIHR3byBmbGFncyB0byB0cmFjayBuZXN0ZWQgdXBkYXRlcyB0aGVuOgogICAqIG9uZSB0cmFja3Mgd2hldGhlciB0aGUgdXBjb21pbmcgdXBkYXRlIGlzIGEgbmVzdGVkIHVwZGF0ZSwKICAgKiBhbmQgdGhlIG90aGVyIHRyYWNrcyB3aGV0aGVyIHRoZSBjdXJyZW50IHVwZGF0ZSB3YXMgYSBuZXN0ZWQgdXBkYXRlLgogICAqIFRoZSBmaXJzdCB2YWx1ZSBnZXRzIHN5bmNlZCB0byB0aGUgc2Vjb25kIGF0IHRoZSBzdGFydCBvZiB0aGUgcmVuZGVyIHBoYXNlLgogICAqLwoKICB2YXIgY3VycmVudFVwZGF0ZUlzTmVzdGVkID0gZmFsc2U7CiAgdmFyIG5lc3RlZFVwZGF0ZVNjaGVkdWxlZCA9IGZhbHNlOwoKICBmdW5jdGlvbiBpc0N1cnJlbnRVcGRhdGVOZXN0ZWQoKSB7CiAgICByZXR1cm4gY3VycmVudFVwZGF0ZUlzTmVzdGVkOwogIH0KCiAgZnVuY3Rpb24gbWFya05lc3RlZFVwZGF0ZVNjaGVkdWxlZCgpIHsKICAgIHsKICAgICAgbmVzdGVkVXBkYXRlU2NoZWR1bGVkID0gdHJ1ZTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHJlc2V0TmVzdGVkVXBkYXRlRmxhZygpIHsKICAgIHsKICAgICAgY3VycmVudFVwZGF0ZUlzTmVzdGVkID0gZmFsc2U7CiAgICAgIG5lc3RlZFVwZGF0ZVNjaGVkdWxlZCA9IGZhbHNlOwogICAgfQogIH0KCiAgZnVuY3Rpb24gc3luY05lc3RlZFVwZGF0ZUZsYWcoKSB7CiAgICB7CiAgICAgIGN1cnJlbnRVcGRhdGVJc05lc3RlZCA9IG5lc3RlZFVwZGF0ZVNjaGVkdWxlZDsKICAgICAgbmVzdGVkVXBkYXRlU2NoZWR1bGVkID0gZmFsc2U7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBnZXRDb21taXRUaW1lKCkgewogICAgcmV0dXJuIGNvbW1pdFRpbWU7CiAgfQoKICBmdW5jdGlvbiByZWNvcmRDb21taXRUaW1lKCkgewoKICAgIGNvbW1pdFRpbWUgPSBub3ckMSgpOwogIH0KCiAgZnVuY3Rpb24gc3RhcnRQcm9maWxlclRpbWVyKGZpYmVyKSB7CgogICAgcHJvZmlsZXJTdGFydFRpbWUgPSBub3ckMSgpOwoKICAgIGlmIChmaWJlci5hY3R1YWxTdGFydFRpbWUgPCAwKSB7CiAgICAgIGZpYmVyLmFjdHVhbFN0YXJ0VGltZSA9IG5vdyQxKCk7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBzdG9wUHJvZmlsZXJUaW1lcklmUnVubmluZyhmaWJlcikgewoKICAgIHByb2ZpbGVyU3RhcnRUaW1lID0gLTE7CiAgfQoKICBmdW5jdGlvbiBzdG9wUHJvZmlsZXJUaW1lcklmUnVubmluZ0FuZFJlY29yZERlbHRhKGZpYmVyLCBvdmVycmlkZUJhc2VUaW1lKSB7CgogICAgaWYgKHByb2ZpbGVyU3RhcnRUaW1lID49IDApIHsKICAgICAgdmFyIGVsYXBzZWRUaW1lID0gbm93JDEoKSAtIHByb2ZpbGVyU3RhcnRUaW1lOwogICAgICBmaWJlci5hY3R1YWxEdXJhdGlvbiArPSBlbGFwc2VkVGltZTsKCiAgICAgIGlmIChvdmVycmlkZUJhc2VUaW1lKSB7CiAgICAgICAgZmliZXIuc2VsZkJhc2VEdXJhdGlvbiA9IGVsYXBzZWRUaW1lOwogICAgICB9CgogICAgICBwcm9maWxlclN0YXJ0VGltZSA9IC0xOwogICAgfQogIH0KCiAgZnVuY3Rpb24gcmVjb3JkTGF5b3V0RWZmZWN0RHVyYXRpb24oZmliZXIpIHsKCiAgICBpZiAobGF5b3V0RWZmZWN0U3RhcnRUaW1lID49IDApIHsKICAgICAgdmFyIGVsYXBzZWRUaW1lID0gbm93JDEoKSAtIGxheW91dEVmZmVjdFN0YXJ0VGltZTsKICAgICAgbGF5b3V0RWZmZWN0U3RhcnRUaW1lID0gLTE7IC8vIFN0b3JlIGR1cmF0aW9uIG9uIHRoZSBuZXh0IG5lYXJlc3QgUHJvZmlsZXIgYW5jZXN0b3IKICAgICAgLy8gT3IgdGhlIHJvb3QgKGZvciB0aGUgRGV2VG9vbHMgUHJvZmlsZXIgdG8gcmVhZCkKCiAgICAgIHZhciBwYXJlbnRGaWJlciA9IGZpYmVyLnJldHVybjsKCiAgICAgIHdoaWxlIChwYXJlbnRGaWJlciAhPT0gbnVsbCkgewogICAgICAgIHN3aXRjaCAocGFyZW50RmliZXIudGFnKSB7CiAgICAgICAgICBjYXNlIEhvc3RSb290OgogICAgICAgICAgICB2YXIgcm9vdCA9IHBhcmVudEZpYmVyLnN0YXRlTm9kZTsKICAgICAgICAgICAgcm9vdC5lZmZlY3REdXJhdGlvbiArPSBlbGFwc2VkVGltZTsKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICAgIGNhc2UgUHJvZmlsZXI6CiAgICAgICAgICAgIHZhciBwYXJlbnRTdGF0ZU5vZGUgPSBwYXJlbnRGaWJlci5zdGF0ZU5vZGU7CiAgICAgICAgICAgIHBhcmVudFN0YXRlTm9kZS5lZmZlY3REdXJhdGlvbiArPSBlbGFwc2VkVGltZTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgcGFyZW50RmliZXIgPSBwYXJlbnRGaWJlci5yZXR1cm47CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIHJlY29yZFBhc3NpdmVFZmZlY3REdXJhdGlvbihmaWJlcikgewoKICAgIGlmIChwYXNzaXZlRWZmZWN0U3RhcnRUaW1lID49IDApIHsKICAgICAgdmFyIGVsYXBzZWRUaW1lID0gbm93JDEoKSAtIHBhc3NpdmVFZmZlY3RTdGFydFRpbWU7CiAgICAgIHBhc3NpdmVFZmZlY3RTdGFydFRpbWUgPSAtMTsgLy8gU3RvcmUgZHVyYXRpb24gb24gdGhlIG5leHQgbmVhcmVzdCBQcm9maWxlciBhbmNlc3RvcgogICAgICAvLyBPciB0aGUgcm9vdCAoZm9yIHRoZSBEZXZUb29scyBQcm9maWxlciB0byByZWFkKQoKICAgICAgdmFyIHBhcmVudEZpYmVyID0gZmliZXIucmV0dXJuOwoKICAgICAgd2hpbGUgKHBhcmVudEZpYmVyICE9PSBudWxsKSB7CiAgICAgICAgc3dpdGNoIChwYXJlbnRGaWJlci50YWcpIHsKICAgICAgICAgIGNhc2UgSG9zdFJvb3Q6CiAgICAgICAgICAgIHZhciByb290ID0gcGFyZW50RmliZXIuc3RhdGVOb2RlOwoKICAgICAgICAgICAgaWYgKHJvb3QgIT09IG51bGwpIHsKICAgICAgICAgICAgICByb290LnBhc3NpdmVFZmZlY3REdXJhdGlvbiArPSBlbGFwc2VkVGltZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICAgIGNhc2UgUHJvZmlsZXI6CiAgICAgICAgICAgIHZhciBwYXJlbnRTdGF0ZU5vZGUgPSBwYXJlbnRGaWJlci5zdGF0ZU5vZGU7CgogICAgICAgICAgICBpZiAocGFyZW50U3RhdGVOb2RlICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgLy8gRGV0YWNoZWQgZmliZXJzIGhhdmUgdGhlaXIgc3RhdGUgbm9kZSBjbGVhcmVkIG91dC4KICAgICAgICAgICAgICAvLyBJbiB0aGlzIGNhc2UsIHRoZSByZXR1cm4gcG9pbnRlciBpcyBhbHNvIGNsZWFyZWQgb3V0LAogICAgICAgICAgICAgIC8vIHNvIHdlIHdvbid0IGJlIGFibGUgdG8gcmVwb3J0IHRoZSB0aW1lIHNwZW50IGluIHRoaXMgUHJvZmlsZXIncyBzdWJ0cmVlLgogICAgICAgICAgICAgIHBhcmVudFN0YXRlTm9kZS5wYXNzaXZlRWZmZWN0RHVyYXRpb24gKz0gZWxhcHNlZFRpbWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHBhcmVudEZpYmVyID0gcGFyZW50RmliZXIucmV0dXJuOwogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiBzdGFydExheW91dEVmZmVjdFRpbWVyKCkgewoKICAgIGxheW91dEVmZmVjdFN0YXJ0VGltZSA9IG5vdyQxKCk7CiAgfQoKICBmdW5jdGlvbiBzdGFydFBhc3NpdmVFZmZlY3RUaW1lcigpIHsKCiAgICBwYXNzaXZlRWZmZWN0U3RhcnRUaW1lID0gbm93JDEoKTsKICB9CgogIGZ1bmN0aW9uIHRyYW5zZmVyQWN0dWFsRHVyYXRpb24oZmliZXIpIHsKICAgIC8vIFRyYW5zZmVyIHRpbWUgc3BlbnQgcmVuZGVyaW5nIHRoZXNlIGNoaWxkcmVuIHNvIHdlIGRvbid0IGxvc2UgaXQKICAgIC8vIGFmdGVyIHdlIHJlcmVuZGVyLiBUaGlzIGlzIHVzZWQgYXMgYSBoZWxwZXIgaW4gc3BlY2lhbCBjYXNlcwogICAgLy8gd2hlcmUgd2Ugc2hvdWxkIGNvdW50IHRoZSB3b3JrIG9mIG11bHRpcGxlIHBhc3Nlcy4KICAgIHZhciBjaGlsZCA9IGZpYmVyLmNoaWxkOwoKICAgIHdoaWxlIChjaGlsZCkgewogICAgICBmaWJlci5hY3R1YWxEdXJhdGlvbiArPSBjaGlsZC5hY3R1YWxEdXJhdGlvbjsKICAgICAgY2hpbGQgPSBjaGlsZC5zaWJsaW5nOwogICAgfQogIH0KCiAgZnVuY3Rpb24gcmVzb2x2ZURlZmF1bHRQcm9wcyhDb21wb25lbnQsIGJhc2VQcm9wcykgewogICAgaWYgKENvbXBvbmVudCAmJiBDb21wb25lbnQuZGVmYXVsdFByb3BzKSB7CiAgICAgIC8vIFJlc29sdmUgZGVmYXVsdCBwcm9wcy4gVGFrZW4gZnJvbSBSZWFjdEVsZW1lbnQKICAgICAgdmFyIHByb3BzID0gYXNzaWduKHt9LCBiYXNlUHJvcHMpOwogICAgICB2YXIgZGVmYXVsdFByb3BzID0gQ29tcG9uZW50LmRlZmF1bHRQcm9wczsKCiAgICAgIGZvciAodmFyIHByb3BOYW1lIGluIGRlZmF1bHRQcm9wcykgewogICAgICAgIGlmIChwcm9wc1twcm9wTmFtZV0gPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgcHJvcHNbcHJvcE5hbWVdID0gZGVmYXVsdFByb3BzW3Byb3BOYW1lXTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBwcm9wczsKICAgIH0KCiAgICByZXR1cm4gYmFzZVByb3BzOwogIH0KCiAgdmFyIGZha2VJbnRlcm5hbEluc3RhbmNlID0ge307CiAgdmFyIGRpZFdhcm5BYm91dFN0YXRlQXNzaWdubWVudEZvckNvbXBvbmVudDsKICB2YXIgZGlkV2FybkFib3V0VW5pbml0aWFsaXplZFN0YXRlOwogIHZhciBkaWRXYXJuQWJvdXRHZXRTbmFwc2hvdEJlZm9yZVVwZGF0ZVdpdGhvdXREaWRVcGRhdGU7CiAgdmFyIGRpZFdhcm5BYm91dExlZ2FjeUxpZmVjeWNsZXNBbmREZXJpdmVkU3RhdGU7CiAgdmFyIGRpZFdhcm5BYm91dFVuZGVmaW5lZERlcml2ZWRTdGF0ZTsKICB2YXIgd2Fybk9uVW5kZWZpbmVkRGVyaXZlZFN0YXRlOwogIHZhciB3YXJuT25JbnZhbGlkQ2FsbGJhY2s7CiAgdmFyIGRpZFdhcm5BYm91dERpcmVjdGx5QXNzaWduaW5nUHJvcHNUb1N0YXRlOwogIHZhciBkaWRXYXJuQWJvdXRDb250ZXh0VHlwZUFuZENvbnRleHRUeXBlczsKICB2YXIgZGlkV2FybkFib3V0SW52YWxpZGF0ZUNvbnRleHRUeXBlOwogIHZhciBkaWRXYXJuQWJvdXRMZWdhY3lDb250ZXh0JDE7CgogIHsKICAgIGRpZFdhcm5BYm91dFN0YXRlQXNzaWdubWVudEZvckNvbXBvbmVudCA9IG5ldyBTZXQoKTsKICAgIGRpZFdhcm5BYm91dFVuaW5pdGlhbGl6ZWRTdGF0ZSA9IG5ldyBTZXQoKTsKICAgIGRpZFdhcm5BYm91dEdldFNuYXBzaG90QmVmb3JlVXBkYXRlV2l0aG91dERpZFVwZGF0ZSA9IG5ldyBTZXQoKTsKICAgIGRpZFdhcm5BYm91dExlZ2FjeUxpZmVjeWNsZXNBbmREZXJpdmVkU3RhdGUgPSBuZXcgU2V0KCk7CiAgICBkaWRXYXJuQWJvdXREaXJlY3RseUFzc2lnbmluZ1Byb3BzVG9TdGF0ZSA9IG5ldyBTZXQoKTsKICAgIGRpZFdhcm5BYm91dFVuZGVmaW5lZERlcml2ZWRTdGF0ZSA9IG5ldyBTZXQoKTsKICAgIGRpZFdhcm5BYm91dENvbnRleHRUeXBlQW5kQ29udGV4dFR5cGVzID0gbmV3IFNldCgpOwogICAgZGlkV2FybkFib3V0SW52YWxpZGF0ZUNvbnRleHRUeXBlID0gbmV3IFNldCgpOwogICAgZGlkV2FybkFib3V0TGVnYWN5Q29udGV4dCQxID0gbmV3IFNldCgpOwogICAgdmFyIGRpZFdhcm5PbkludmFsaWRDYWxsYmFjayA9IG5ldyBTZXQoKTsKCiAgICB3YXJuT25JbnZhbGlkQ2FsbGJhY2sgPSBmdW5jdGlvbiAoY2FsbGJhY2ssIGNhbGxlck5hbWUpIHsKICAgICAgaWYgKGNhbGxiYWNrID09PSBudWxsIHx8IHR5cGVvZiBjYWxsYmFjayA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGtleSA9IGNhbGxlck5hbWUgKyAnXycgKyBjYWxsYmFjazsKCiAgICAgIGlmICghZGlkV2Fybk9uSW52YWxpZENhbGxiYWNrLmhhcyhrZXkpKSB7CiAgICAgICAgZGlkV2Fybk9uSW52YWxpZENhbGxiYWNrLmFkZChrZXkpOwoKICAgICAgICBlcnJvcignJXMoLi4uKTogRXhwZWN0ZWQgdGhlIGxhc3Qgb3B0aW9uYWwgYGNhbGxiYWNrYCBhcmd1bWVudCB0byBiZSBhICcgKyAnZnVuY3Rpb24uIEluc3RlYWQgcmVjZWl2ZWQ6ICVzLicsIGNhbGxlck5hbWUsIGNhbGxiYWNrKTsKICAgICAgfQogICAgfTsKCiAgICB3YXJuT25VbmRlZmluZWREZXJpdmVkU3RhdGUgPSBmdW5jdGlvbiAodHlwZSwgcGFydGlhbFN0YXRlKSB7CiAgICAgIGlmIChwYXJ0aWFsU3RhdGUgPT09IHVuZGVmaW5lZCkgewogICAgICAgIHZhciBjb21wb25lbnROYW1lID0gZ2V0Q29tcG9uZW50TmFtZUZyb21UeXBlKHR5cGUpIHx8ICdDb21wb25lbnQnOwoKICAgICAgICBpZiAoIWRpZFdhcm5BYm91dFVuZGVmaW5lZERlcml2ZWRTdGF0ZS5oYXMoY29tcG9uZW50TmFtZSkpIHsKICAgICAgICAgIGRpZFdhcm5BYm91dFVuZGVmaW5lZERlcml2ZWRTdGF0ZS5hZGQoY29tcG9uZW50TmFtZSk7CgogICAgICAgICAgZXJyb3IoJyVzLmdldERlcml2ZWRTdGF0ZUZyb21Qcm9wcygpOiBBIHZhbGlkIHN0YXRlIG9iamVjdCAob3IgbnVsbCkgbXVzdCBiZSByZXR1cm5lZC4gJyArICdZb3UgaGF2ZSByZXR1cm5lZCB1bmRlZmluZWQuJywgY29tcG9uZW50TmFtZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9OyAvLyBUaGlzIGlzIHNvIGdyb3NzIGJ1dCBpdCdzIGF0IGxlYXN0IG5vbi1jcml0aWNhbCBhbmQgY2FuIGJlIHJlbW92ZWQgaWYKICAgIC8vIGl0IGNhdXNlcyBwcm9ibGVtcy4gVGhpcyBpcyBtZWFudCB0byBnaXZlIGEgbmljZXIgZXJyb3IgbWVzc2FnZSBmb3IKICAgIC8vIFJlYWN0RE9NMTUudW5zdGFibGVfcmVuZGVyU3VidHJlZUludG9Db250YWluZXIocmVhY3RET00xNkNvbXBvbmVudCwKICAgIC8vIC4uLikpIHdoaWNoIG90aGVyd2lzZSB0aHJvd3MgYSAiX3Byb2Nlc3NDaGlsZENvbnRleHQgaXMgbm90IGEgZnVuY3Rpb24iCiAgICAvLyBleGNlcHRpb24uCgoKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShmYWtlSW50ZXJuYWxJbnN0YW5jZSwgJ19wcm9jZXNzQ2hpbGRDb250ZXh0JywgewogICAgICBlbnVtZXJhYmxlOiBmYWxzZSwKICAgICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ19wcm9jZXNzQ2hpbGRDb250ZXh0IGlzIG5vdCBhdmFpbGFibGUgaW4gUmVhY3QgMTYrLiBUaGlzIGxpa2VseSAnICsgJ21lYW5zIHlvdSBoYXZlIG11bHRpcGxlIGNvcGllcyBvZiBSZWFjdCBhbmQgYXJlIGF0dGVtcHRpbmcgdG8gbmVzdCAnICsgJ2EgUmVhY3QgMTUgdHJlZSBpbnNpZGUgYSBSZWFjdCAxNiB0cmVlIHVzaW5nICcgKyAidW5zdGFibGVfcmVuZGVyU3VidHJlZUludG9Db250YWluZXIsIHdoaWNoIGlzbid0IHN1cHBvcnRlZC4gVHJ5ICIgKyAndG8gbWFrZSBzdXJlIHlvdSBoYXZlIG9ubHkgb25lIGNvcHkgb2YgUmVhY3QgKGFuZCBpZGVhbGx5LCBzd2l0Y2ggJyArICd0byBSZWFjdERPTS5jcmVhdGVQb3J0YWwpLicpOwogICAgICB9CiAgICB9KTsKICAgIE9iamVjdC5mcmVlemUoZmFrZUludGVybmFsSW5zdGFuY2UpOwogIH0KCiAgZnVuY3Rpb24gYXBwbHlEZXJpdmVkU3RhdGVGcm9tUHJvcHMod29ya0luUHJvZ3Jlc3MsIGN0b3IsIGdldERlcml2ZWRTdGF0ZUZyb21Qcm9wcywgbmV4dFByb3BzKSB7CiAgICB2YXIgcHJldlN0YXRlID0gd29ya0luUHJvZ3Jlc3MubWVtb2l6ZWRTdGF0ZTsKICAgIHZhciBwYXJ0aWFsU3RhdGUgPSBnZXREZXJpdmVkU3RhdGVGcm9tUHJvcHMobmV4dFByb3BzLCBwcmV2U3RhdGUpOwoKICAgIHsKICAgICAgaWYgKCB3b3JrSW5Qcm9ncmVzcy5tb2RlICYgU3RyaWN0TGVnYWN5TW9kZSkgewogICAgICAgIHNldElzU3RyaWN0TW9kZUZvckRldnRvb2xzKHRydWUpOwoKICAgICAgICB0cnkgewogICAgICAgICAgLy8gSW52b2tlIHRoZSBmdW5jdGlvbiBhbiBleHRyYSB0aW1lIHRvIGhlbHAgZGV0ZWN0IHNpZGUtZWZmZWN0cy4KICAgICAgICAgIHBhcnRpYWxTdGF0ZSA9IGdldERlcml2ZWRTdGF0ZUZyb21Qcm9wcyhuZXh0UHJvcHMsIHByZXZTdGF0ZSk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIHNldElzU3RyaWN0TW9kZUZvckRldnRvb2xzKGZhbHNlKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHdhcm5PblVuZGVmaW5lZERlcml2ZWRTdGF0ZShjdG9yLCBwYXJ0aWFsU3RhdGUpOwogICAgfSAvLyBNZXJnZSB0aGUgcGFydGlhbCBzdGF0ZSBhbmQgdGhlIHByZXZpb3VzIHN0YXRlLgoKCiAgICB2YXIgbWVtb2l6ZWRTdGF0ZSA9IHBhcnRpYWxTdGF0ZSA9PT0gbnVsbCB8fCBwYXJ0aWFsU3RhdGUgPT09IHVuZGVmaW5lZCA/IHByZXZTdGF0ZSA6IGFzc2lnbih7fSwgcHJldlN0YXRlLCBwYXJ0aWFsU3RhdGUpOwogICAgd29ya0luUHJvZ3Jlc3MubWVtb2l6ZWRTdGF0ZSA9IG1lbW9pemVkU3RhdGU7IC8vIE9uY2UgdGhlIHVwZGF0ZSBxdWV1ZSBpcyBlbXB0eSwgcGVyc2lzdCB0aGUgZGVyaXZlZCBzdGF0ZSBvbnRvIHRoZQogICAgLy8gYmFzZSBzdGF0ZS4KCiAgICBpZiAod29ya0luUHJvZ3Jlc3MubGFuZXMgPT09IE5vTGFuZXMpIHsKICAgICAgLy8gUXVldWUgaXMgYWx3YXlzIG5vbi1udWxsIGZvciBjbGFzc2VzCiAgICAgIHZhciB1cGRhdGVRdWV1ZSA9IHdvcmtJblByb2dyZXNzLnVwZGF0ZVF1ZXVlOwogICAgICB1cGRhdGVRdWV1ZS5iYXNlU3RhdGUgPSBtZW1vaXplZFN0YXRlOwogICAgfQogIH0KCiAgdmFyIGNsYXNzQ29tcG9uZW50VXBkYXRlciA9IHsKICAgIGlzTW91bnRlZDogaXNNb3VudGVkLAogICAgZW5xdWV1ZVNldFN0YXRlOiBmdW5jdGlvbiAoaW5zdCwgcGF5bG9hZCwgY2FsbGJhY2spIHsKICAgICAgdmFyIGZpYmVyID0gZ2V0KGluc3QpOwogICAgICB2YXIgZXZlbnRUaW1lID0gcmVxdWVzdEV2ZW50VGltZSgpOwogICAgICB2YXIgbGFuZSA9IHJlcXVlc3RVcGRhdGVMYW5lKGZpYmVyKTsKICAgICAgdmFyIHVwZGF0ZSA9IGNyZWF0ZVVwZGF0ZShldmVudFRpbWUsIGxhbmUpOwogICAgICB1cGRhdGUucGF5bG9hZCA9IHBheWxvYWQ7CgogICAgICBpZiAoY2FsbGJhY2sgIT09IHVuZGVmaW5lZCAmJiBjYWxsYmFjayAhPT0gbnVsbCkgewogICAgICAgIHsKICAgICAgICAgIHdhcm5PbkludmFsaWRDYWxsYmFjayhjYWxsYmFjaywgJ3NldFN0YXRlJyk7CiAgICAgICAgfQoKICAgICAgICB1cGRhdGUuY2FsbGJhY2sgPSBjYWxsYmFjazsKICAgICAgfQoKICAgICAgdmFyIHJvb3QgPSBlbnF1ZXVlVXBkYXRlKGZpYmVyLCB1cGRhdGUsIGxhbmUpOwoKICAgICAgaWYgKHJvb3QgIT09IG51bGwpIHsKICAgICAgICBzY2hlZHVsZVVwZGF0ZU9uRmliZXIocm9vdCwgZmliZXIsIGxhbmUsIGV2ZW50VGltZSk7CiAgICAgICAgZW50YW5nbGVUcmFuc2l0aW9ucyhyb290LCBmaWJlciwgbGFuZSk7CiAgICAgIH0KCiAgICAgIHsKICAgICAgICBtYXJrU3RhdGVVcGRhdGVTY2hlZHVsZWQoZmliZXIsIGxhbmUpOwogICAgICB9CiAgICB9LAogICAgZW5xdWV1ZVJlcGxhY2VTdGF0ZTogZnVuY3Rpb24gKGluc3QsIHBheWxvYWQsIGNhbGxiYWNrKSB7CiAgICAgIHZhciBmaWJlciA9IGdldChpbnN0KTsKICAgICAgdmFyIGV2ZW50VGltZSA9IHJlcXVlc3RFdmVudFRpbWUoKTsKICAgICAgdmFyIGxhbmUgPSByZXF1ZXN0VXBkYXRlTGFuZShmaWJlcik7CiAgICAgIHZhciB1cGRhdGUgPSBjcmVhdGVVcGRhdGUoZXZlbnRUaW1lLCBsYW5lKTsKICAgICAgdXBkYXRlLnRhZyA9IFJlcGxhY2VTdGF0ZTsKICAgICAgdXBkYXRlLnBheWxvYWQgPSBwYXlsb2FkOwoKICAgICAgaWYgKGNhbGxiYWNrICE9PSB1bmRlZmluZWQgJiYgY2FsbGJhY2sgIT09IG51bGwpIHsKICAgICAgICB7CiAgICAgICAgICB3YXJuT25JbnZhbGlkQ2FsbGJhY2soY2FsbGJhY2ssICdyZXBsYWNlU3RhdGUnKTsKICAgICAgICB9CgogICAgICAgIHVwZGF0ZS5jYWxsYmFjayA9IGNhbGxiYWNrOwogICAgICB9CgogICAgICB2YXIgcm9vdCA9IGVucXVldWVVcGRhdGUoZmliZXIsIHVwZGF0ZSwgbGFuZSk7CgogICAgICBpZiAocm9vdCAhPT0gbnVsbCkgewogICAgICAgIHNjaGVkdWxlVXBkYXRlT25GaWJlcihyb290LCBmaWJlciwgbGFuZSwgZXZlbnRUaW1lKTsKICAgICAgICBlbnRhbmdsZVRyYW5zaXRpb25zKHJvb3QsIGZpYmVyLCBsYW5lKTsKICAgICAgfQoKICAgICAgewogICAgICAgIG1hcmtTdGF0ZVVwZGF0ZVNjaGVkdWxlZChmaWJlciwgbGFuZSk7CiAgICAgIH0KICAgIH0sCiAgICBlbnF1ZXVlRm9yY2VVcGRhdGU6IGZ1bmN0aW9uIChpbnN0LCBjYWxsYmFjaykgewogICAgICB2YXIgZmliZXIgPSBnZXQoaW5zdCk7CiAgICAgIHZhciBldmVudFRpbWUgPSByZXF1ZXN0RXZlbnRUaW1lKCk7CiAgICAgIHZhciBsYW5lID0gcmVxdWVzdFVwZGF0ZUxhbmUoZmliZXIpOwogICAgICB2YXIgdXBkYXRlID0gY3JlYXRlVXBkYXRlKGV2ZW50VGltZSwgbGFuZSk7CiAgICAgIHVwZGF0ZS50YWcgPSBGb3JjZVVwZGF0ZTsKCiAgICAgIGlmIChjYWxsYmFjayAhPT0gdW5kZWZpbmVkICYmIGNhbGxiYWNrICE9PSBudWxsKSB7CiAgICAgICAgewogICAgICAgICAgd2Fybk9uSW52YWxpZENhbGxiYWNrKGNhbGxiYWNrLCAnZm9yY2VVcGRhdGUnKTsKICAgICAgICB9CgogICAgICAgIHVwZGF0ZS5jYWxsYmFjayA9IGNhbGxiYWNrOwogICAgICB9CgogICAgICB2YXIgcm9vdCA9IGVucXVldWVVcGRhdGUoZmliZXIsIHVwZGF0ZSwgbGFuZSk7CgogICAgICBpZiAocm9vdCAhPT0gbnVsbCkgewogICAgICAgIHNjaGVkdWxlVXBkYXRlT25GaWJlcihyb290LCBmaWJlciwgbGFuZSwgZXZlbnRUaW1lKTsKICAgICAgICBlbnRhbmdsZVRyYW5zaXRpb25zKHJvb3QsIGZpYmVyLCBsYW5lKTsKICAgICAgfQoKICAgICAgewogICAgICAgIG1hcmtGb3JjZVVwZGF0ZVNjaGVkdWxlZChmaWJlciwgbGFuZSk7CiAgICAgIH0KICAgIH0KICB9OwoKICBmdW5jdGlvbiBjaGVja1Nob3VsZENvbXBvbmVudFVwZGF0ZSh3b3JrSW5Qcm9ncmVzcywgY3Rvciwgb2xkUHJvcHMsIG5ld1Byb3BzLCBvbGRTdGF0ZSwgbmV3U3RhdGUsIG5leHRDb250ZXh0KSB7CiAgICB2YXIgaW5zdGFuY2UgPSB3b3JrSW5Qcm9ncmVzcy5zdGF0ZU5vZGU7CgogICAgaWYgKHR5cGVvZiBpbnN0YW5jZS5zaG91bGRDb21wb25lbnRVcGRhdGUgPT09ICdmdW5jdGlvbicpIHsKICAgICAgdmFyIHNob3VsZFVwZGF0ZSA9IGluc3RhbmNlLnNob3VsZENvbXBvbmVudFVwZGF0ZShuZXdQcm9wcywgbmV3U3RhdGUsIG5leHRDb250ZXh0KTsKCiAgICAgIHsKICAgICAgICBpZiAoIHdvcmtJblByb2dyZXNzLm1vZGUgJiBTdHJpY3RMZWdhY3lNb2RlKSB7CiAgICAgICAgICBzZXRJc1N0cmljdE1vZGVGb3JEZXZ0b29scyh0cnVlKTsKCiAgICAgICAgICB0cnkgewogICAgICAgICAgICAvLyBJbnZva2UgdGhlIGZ1bmN0aW9uIGFuIGV4dHJhIHRpbWUgdG8gaGVscCBkZXRlY3Qgc2lkZS1lZmZlY3RzLgogICAgICAgICAgICBzaG91bGRVcGRhdGUgPSBpbnN0YW5jZS5zaG91bGRDb21wb25lbnRVcGRhdGUobmV3UHJvcHMsIG5ld1N0YXRlLCBuZXh0Q29udGV4dCk7CiAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBzZXRJc1N0cmljdE1vZGVGb3JEZXZ0b29scyhmYWxzZSk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoc2hvdWxkVXBkYXRlID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgIGVycm9yKCclcy5zaG91bGRDb21wb25lbnRVcGRhdGUoKTogUmV0dXJuZWQgdW5kZWZpbmVkIGluc3RlYWQgb2YgYSAnICsgJ2Jvb2xlYW4gdmFsdWUuIE1ha2Ugc3VyZSB0byByZXR1cm4gdHJ1ZSBvciBmYWxzZS4nLCBnZXRDb21wb25lbnROYW1lRnJvbVR5cGUoY3RvcikgfHwgJ0NvbXBvbmVudCcpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHNob3VsZFVwZGF0ZTsKICAgIH0KCiAgICBpZiAoY3Rvci5wcm90b3R5cGUgJiYgY3Rvci5wcm90b3R5cGUuaXNQdXJlUmVhY3RDb21wb25lbnQpIHsKICAgICAgcmV0dXJuICFzaGFsbG93RXF1YWwob2xkUHJvcHMsIG5ld1Byb3BzKSB8fCAhc2hhbGxvd0VxdWFsKG9sZFN0YXRlLCBuZXdTdGF0ZSk7CiAgICB9CgogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiBjaGVja0NsYXNzSW5zdGFuY2Uod29ya0luUHJvZ3Jlc3MsIGN0b3IsIG5ld1Byb3BzKSB7CiAgICB2YXIgaW5zdGFuY2UgPSB3b3JrSW5Qcm9ncmVzcy5zdGF0ZU5vZGU7CgogICAgewogICAgICB2YXIgbmFtZSA9IGdldENvbXBvbmVudE5hbWVGcm9tVHlwZShjdG9yKSB8fCAnQ29tcG9uZW50JzsKICAgICAgdmFyIHJlbmRlclByZXNlbnQgPSBpbnN0YW5jZS5yZW5kZXI7CgogICAgICBpZiAoIXJlbmRlclByZXNlbnQpIHsKICAgICAgICBpZiAoY3Rvci5wcm90b3R5cGUgJiYgdHlwZW9mIGN0b3IucHJvdG90eXBlLnJlbmRlciA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgZXJyb3IoJyVzKC4uLik6IE5vIGByZW5kZXJgIG1ldGhvZCBmb3VuZCBvbiB0aGUgcmV0dXJuZWQgY29tcG9uZW50ICcgKyAnaW5zdGFuY2U6IGRpZCB5b3UgYWNjaWRlbnRhbGx5IHJldHVybiBhbiBvYmplY3QgZnJvbSB0aGUgY29uc3RydWN0b3I/JywgbmFtZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGVycm9yKCclcyguLi4pOiBObyBgcmVuZGVyYCBtZXRob2QgZm91bmQgb24gdGhlIHJldHVybmVkIGNvbXBvbmVudCAnICsgJ2luc3RhbmNlOiB5b3UgbWF5IGhhdmUgZm9yZ290dGVuIHRvIGRlZmluZSBgcmVuZGVyYC4nLCBuYW1lKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChpbnN0YW5jZS5nZXRJbml0aWFsU3RhdGUgJiYgIWluc3RhbmNlLmdldEluaXRpYWxTdGF0ZS5pc1JlYWN0Q2xhc3NBcHByb3ZlZCAmJiAhaW5zdGFuY2Uuc3RhdGUpIHsKICAgICAgICBlcnJvcignZ2V0SW5pdGlhbFN0YXRlIHdhcyBkZWZpbmVkIG9uICVzLCBhIHBsYWluIEphdmFTY3JpcHQgY2xhc3MuICcgKyAnVGhpcyBpcyBvbmx5IHN1cHBvcnRlZCBmb3IgY2xhc3NlcyBjcmVhdGVkIHVzaW5nIFJlYWN0LmNyZWF0ZUNsYXNzLiAnICsgJ0RpZCB5b3UgbWVhbiB0byBkZWZpbmUgYSBzdGF0ZSBwcm9wZXJ0eSBpbnN0ZWFkPycsIG5hbWUpOwogICAgICB9CgogICAgICBpZiAoaW5zdGFuY2UuZ2V0RGVmYXVsdFByb3BzICYmICFpbnN0YW5jZS5nZXREZWZhdWx0UHJvcHMuaXNSZWFjdENsYXNzQXBwcm92ZWQpIHsKICAgICAgICBlcnJvcignZ2V0RGVmYXVsdFByb3BzIHdhcyBkZWZpbmVkIG9uICVzLCBhIHBsYWluIEphdmFTY3JpcHQgY2xhc3MuICcgKyAnVGhpcyBpcyBvbmx5IHN1cHBvcnRlZCBmb3IgY2xhc3NlcyBjcmVhdGVkIHVzaW5nIFJlYWN0LmNyZWF0ZUNsYXNzLiAnICsgJ1VzZSBhIHN0YXRpYyBwcm9wZXJ0eSB0byBkZWZpbmUgZGVmYXVsdFByb3BzIGluc3RlYWQuJywgbmFtZSk7CiAgICAgIH0KCiAgICAgIGlmIChpbnN0YW5jZS5wcm9wVHlwZXMpIHsKICAgICAgICBlcnJvcigncHJvcFR5cGVzIHdhcyBkZWZpbmVkIGFzIGFuIGluc3RhbmNlIHByb3BlcnR5IG9uICVzLiBVc2UgYSBzdGF0aWMgJyArICdwcm9wZXJ0eSB0byBkZWZpbmUgcHJvcFR5cGVzIGluc3RlYWQuJywgbmFtZSk7CiAgICAgIH0KCiAgICAgIGlmIChpbnN0YW5jZS5jb250ZXh0VHlwZSkgewogICAgICAgIGVycm9yKCdjb250ZXh0VHlwZSB3YXMgZGVmaW5lZCBhcyBhbiBpbnN0YW5jZSBwcm9wZXJ0eSBvbiAlcy4gVXNlIGEgc3RhdGljICcgKyAncHJvcGVydHkgdG8gZGVmaW5lIGNvbnRleHRUeXBlIGluc3RlYWQuJywgbmFtZSk7CiAgICAgIH0KCiAgICAgIHsKICAgICAgICBpZiAoY3Rvci5jaGlsZENvbnRleHRUeXBlcyAmJiAhZGlkV2FybkFib3V0TGVnYWN5Q29udGV4dCQxLmhhcyhjdG9yKSAmJiAvLyBTdHJpY3QgTW9kZSBoYXMgaXRzIG93biB3YXJuaW5nIGZvciBsZWdhY3kgY29udGV4dCwgc28gd2UgY2FuIHNraXAKICAgICAgICAvLyB0aGlzIG9uZS4KICAgICAgICAod29ya0luUHJvZ3Jlc3MubW9kZSAmIFN0cmljdExlZ2FjeU1vZGUpID09PSBOb01vZGUpIHsKICAgICAgICAgIGRpZFdhcm5BYm91dExlZ2FjeUNvbnRleHQkMS5hZGQoY3Rvcik7CgogICAgICAgICAgZXJyb3IoJyVzIHVzZXMgdGhlIGxlZ2FjeSBjaGlsZENvbnRleHRUeXBlcyBBUEkgd2hpY2ggaXMgbm8gbG9uZ2VyICcgKyAnc3VwcG9ydGVkIGFuZCB3aWxsIGJlIHJlbW92ZWQgaW4gdGhlIG5leHQgbWFqb3IgcmVsZWFzZS4gVXNlICcgKyAnUmVhY3QuY3JlYXRlQ29udGV4dCgpIGluc3RlYWRcblxuLicgKyAnTGVhcm4gbW9yZSBhYm91dCB0aGlzIHdhcm5pbmcgaGVyZTogaHR0cHM6Ly9yZWFjdGpzLm9yZy9saW5rL2xlZ2FjeS1jb250ZXh0JywgbmFtZSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoY3Rvci5jb250ZXh0VHlwZXMgJiYgIWRpZFdhcm5BYm91dExlZ2FjeUNvbnRleHQkMS5oYXMoY3RvcikgJiYgLy8gU3RyaWN0IE1vZGUgaGFzIGl0cyBvd24gd2FybmluZyBmb3IgbGVnYWN5IGNvbnRleHQsIHNvIHdlIGNhbiBza2lwCiAgICAgICAgLy8gdGhpcyBvbmUuCiAgICAgICAgKHdvcmtJblByb2dyZXNzLm1vZGUgJiBTdHJpY3RMZWdhY3lNb2RlKSA9PT0gTm9Nb2RlKSB7CiAgICAgICAgICBkaWRXYXJuQWJvdXRMZWdhY3lDb250ZXh0JDEuYWRkKGN0b3IpOwoKICAgICAgICAgIGVycm9yKCclcyB1c2VzIHRoZSBsZWdhY3kgY29udGV4dFR5cGVzIEFQSSB3aGljaCBpcyBubyBsb25nZXIgc3VwcG9ydGVkICcgKyAnYW5kIHdpbGwgYmUgcmVtb3ZlZCBpbiB0aGUgbmV4dCBtYWpvciByZWxlYXNlLiBVc2UgJyArICdSZWFjdC5jcmVhdGVDb250ZXh0KCkgd2l0aCBzdGF0aWMgY29udGV4dFR5cGUgaW5zdGVhZC5cblxuJyArICdMZWFybiBtb3JlIGFib3V0IHRoaXMgd2FybmluZyBoZXJlOiBodHRwczovL3JlYWN0anMub3JnL2xpbmsvbGVnYWN5LWNvbnRleHQnLCBuYW1lKTsKICAgICAgICB9CgogICAgICAgIGlmIChpbnN0YW5jZS5jb250ZXh0VHlwZXMpIHsKICAgICAgICAgIGVycm9yKCdjb250ZXh0VHlwZXMgd2FzIGRlZmluZWQgYXMgYW4gaW5zdGFuY2UgcHJvcGVydHkgb24gJXMuIFVzZSBhIHN0YXRpYyAnICsgJ3Byb3BlcnR5IHRvIGRlZmluZSBjb250ZXh0VHlwZXMgaW5zdGVhZC4nLCBuYW1lKTsKICAgICAgICB9CgogICAgICAgIGlmIChjdG9yLmNvbnRleHRUeXBlICYmIGN0b3IuY29udGV4dFR5cGVzICYmICFkaWRXYXJuQWJvdXRDb250ZXh0VHlwZUFuZENvbnRleHRUeXBlcy5oYXMoY3RvcikpIHsKICAgICAgICAgIGRpZFdhcm5BYm91dENvbnRleHRUeXBlQW5kQ29udGV4dFR5cGVzLmFkZChjdG9yKTsKCiAgICAgICAgICBlcnJvcignJXMgZGVjbGFyZXMgYm90aCBjb250ZXh0VHlwZXMgYW5kIGNvbnRleHRUeXBlIHN0YXRpYyBwcm9wZXJ0aWVzLiAnICsgJ1RoZSBsZWdhY3kgY29udGV4dFR5cGVzIHByb3BlcnR5IHdpbGwgYmUgaWdub3JlZC4nLCBuYW1lKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICh0eXBlb2YgaW5zdGFuY2UuY29tcG9uZW50U2hvdWxkVXBkYXRlID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgZXJyb3IoJyVzIGhhcyBhIG1ldGhvZCBjYWxsZWQgJyArICdjb21wb25lbnRTaG91bGRVcGRhdGUoKS4gRGlkIHlvdSBtZWFuIHNob3VsZENvbXBvbmVudFVwZGF0ZSgpPyAnICsgJ1RoZSBuYW1lIGlzIHBocmFzZWQgYXMgYSBxdWVzdGlvbiBiZWNhdXNlIHRoZSBmdW5jdGlvbiBpcyAnICsgJ2V4cGVjdGVkIHRvIHJldHVybiBhIHZhbHVlLicsIG5hbWUpOwogICAgICB9CgogICAgICBpZiAoY3Rvci5wcm90b3R5cGUgJiYgY3Rvci5wcm90b3R5cGUuaXNQdXJlUmVhY3RDb21wb25lbnQgJiYgdHlwZW9mIGluc3RhbmNlLnNob3VsZENvbXBvbmVudFVwZGF0ZSAhPT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICBlcnJvcignJXMgaGFzIGEgbWV0aG9kIGNhbGxlZCBzaG91bGRDb21wb25lbnRVcGRhdGUoKS4gJyArICdzaG91bGRDb21wb25lbnRVcGRhdGUgc2hvdWxkIG5vdCBiZSB1c2VkIHdoZW4gZXh0ZW5kaW5nIFJlYWN0LlB1cmVDb21wb25lbnQuICcgKyAnUGxlYXNlIGV4dGVuZCBSZWFjdC5Db21wb25lbnQgaWYgc2hvdWxkQ29tcG9uZW50VXBkYXRlIGlzIHVzZWQuJywgZ2V0Q29tcG9uZW50TmFtZUZyb21UeXBlKGN0b3IpIHx8ICdBIHB1cmUgY29tcG9uZW50Jyk7CiAgICAgIH0KCiAgICAgIGlmICh0eXBlb2YgaW5zdGFuY2UuY29tcG9uZW50RGlkVW5tb3VudCA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIGVycm9yKCclcyBoYXMgYSBtZXRob2QgY2FsbGVkICcgKyAnY29tcG9uZW50RGlkVW5tb3VudCgpLiBCdXQgdGhlcmUgaXMgbm8gc3VjaCBsaWZlY3ljbGUgbWV0aG9kLiAnICsgJ0RpZCB5b3UgbWVhbiBjb21wb25lbnRXaWxsVW5tb3VudCgpPycsIG5hbWUpOwogICAgICB9CgogICAgICBpZiAodHlwZW9mIGluc3RhbmNlLmNvbXBvbmVudERpZFJlY2VpdmVQcm9wcyA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIGVycm9yKCclcyBoYXMgYSBtZXRob2QgY2FsbGVkICcgKyAnY29tcG9uZW50RGlkUmVjZWl2ZVByb3BzKCkuIEJ1dCB0aGVyZSBpcyBubyBzdWNoIGxpZmVjeWNsZSBtZXRob2QuICcgKyAnSWYgeW91IG1lYW50IHRvIHVwZGF0ZSB0aGUgc3RhdGUgaW4gcmVzcG9uc2UgdG8gY2hhbmdpbmcgcHJvcHMsICcgKyAndXNlIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMoKS4gSWYgeW91IG1lYW50IHRvIGZldGNoIGRhdGEgb3IgJyArICdydW4gc2lkZS1lZmZlY3RzIG9yIG11dGF0aW9ucyBhZnRlciBSZWFjdCBoYXMgdXBkYXRlZCB0aGUgVUksIHVzZSBjb21wb25lbnREaWRVcGRhdGUoKS4nLCBuYW1lKTsKICAgICAgfQoKICAgICAgaWYgKHR5cGVvZiBpbnN0YW5jZS5jb21wb25lbnRXaWxsUmVjaWV2ZVByb3BzID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgZXJyb3IoJyVzIGhhcyBhIG1ldGhvZCBjYWxsZWQgJyArICdjb21wb25lbnRXaWxsUmVjaWV2ZVByb3BzKCkuIERpZCB5b3UgbWVhbiBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKCk/JywgbmFtZSk7CiAgICAgIH0KCiAgICAgIGlmICh0eXBlb2YgaW5zdGFuY2UuVU5TQUZFX2NvbXBvbmVudFdpbGxSZWNpZXZlUHJvcHMgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICBlcnJvcignJXMgaGFzIGEgbWV0aG9kIGNhbGxlZCAnICsgJ1VOU0FGRV9jb21wb25lbnRXaWxsUmVjaWV2ZVByb3BzKCkuIERpZCB5b3UgbWVhbiBVTlNBRkVfY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcygpPycsIG5hbWUpOwogICAgICB9CgogICAgICB2YXIgaGFzTXV0YXRlZFByb3BzID0gaW5zdGFuY2UucHJvcHMgIT09IG5ld1Byb3BzOwoKICAgICAgaWYgKGluc3RhbmNlLnByb3BzICE9PSB1bmRlZmluZWQgJiYgaGFzTXV0YXRlZFByb3BzKSB7CiAgICAgICAgZXJyb3IoJyVzKC4uLik6IFdoZW4gY2FsbGluZyBzdXBlcigpIGluIGAlc2AsIG1ha2Ugc3VyZSB0byBwYXNzICcgKyAidXAgdGhlIHNhbWUgcHJvcHMgdGhhdCB5b3VyIGNvbXBvbmVudCdzIGNvbnN0cnVjdG9yIHdhcyBwYXNzZWQuIiwgbmFtZSwgbmFtZSk7CiAgICAgIH0KCiAgICAgIGlmIChpbnN0YW5jZS5kZWZhdWx0UHJvcHMpIHsKICAgICAgICBlcnJvcignU2V0dGluZyBkZWZhdWx0UHJvcHMgYXMgYW4gaW5zdGFuY2UgcHJvcGVydHkgb24gJXMgaXMgbm90IHN1cHBvcnRlZCBhbmQgd2lsbCBiZSBpZ25vcmVkLicgKyAnIEluc3RlYWQsIGRlZmluZSBkZWZhdWx0UHJvcHMgYXMgYSBzdGF0aWMgcHJvcGVydHkgb24gJXMuJywgbmFtZSwgbmFtZSk7CiAgICAgIH0KCiAgICAgIGlmICh0eXBlb2YgaW5zdGFuY2UuZ2V0U25hcHNob3RCZWZvcmVVcGRhdGUgPT09ICdmdW5jdGlvbicgJiYgdHlwZW9mIGluc3RhbmNlLmNvbXBvbmVudERpZFVwZGF0ZSAhPT0gJ2Z1bmN0aW9uJyAmJiAhZGlkV2FybkFib3V0R2V0U25hcHNob3RCZWZvcmVVcGRhdGVXaXRob3V0RGlkVXBkYXRlLmhhcyhjdG9yKSkgewogICAgICAgIGRpZFdhcm5BYm91dEdldFNuYXBzaG90QmVmb3JlVXBkYXRlV2l0aG91dERpZFVwZGF0ZS5hZGQoY3Rvcik7CgogICAgICAgIGVycm9yKCclczogZ2V0U25hcHNob3RCZWZvcmVVcGRhdGUoKSBzaG91bGQgYmUgdXNlZCB3aXRoIGNvbXBvbmVudERpZFVwZGF0ZSgpLiAnICsgJ1RoaXMgY29tcG9uZW50IGRlZmluZXMgZ2V0U25hcHNob3RCZWZvcmVVcGRhdGUoKSBvbmx5LicsIGdldENvbXBvbmVudE5hbWVGcm9tVHlwZShjdG9yKSk7CiAgICAgIH0KCiAgICAgIGlmICh0eXBlb2YgaW5zdGFuY2UuZ2V0RGVyaXZlZFN0YXRlRnJvbVByb3BzID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgZXJyb3IoJyVzOiBnZXREZXJpdmVkU3RhdGVGcm9tUHJvcHMoKSBpcyBkZWZpbmVkIGFzIGFuIGluc3RhbmNlIG1ldGhvZCAnICsgJ2FuZCB3aWxsIGJlIGlnbm9yZWQuIEluc3RlYWQsIGRlY2xhcmUgaXQgYXMgYSBzdGF0aWMgbWV0aG9kLicsIG5hbWUpOwogICAgICB9CgogICAgICBpZiAodHlwZW9mIGluc3RhbmNlLmdldERlcml2ZWRTdGF0ZUZyb21FcnJvciA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIGVycm9yKCclczogZ2V0RGVyaXZlZFN0YXRlRnJvbUVycm9yKCkgaXMgZGVmaW5lZCBhcyBhbiBpbnN0YW5jZSBtZXRob2QgJyArICdhbmQgd2lsbCBiZSBpZ25vcmVkLiBJbnN0ZWFkLCBkZWNsYXJlIGl0IGFzIGEgc3RhdGljIG1ldGhvZC4nLCBuYW1lKTsKICAgICAgfQoKICAgICAgaWYgKHR5cGVvZiBjdG9yLmdldFNuYXBzaG90QmVmb3JlVXBkYXRlID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgZXJyb3IoJyVzOiBnZXRTbmFwc2hvdEJlZm9yZVVwZGF0ZSgpIGlzIGRlZmluZWQgYXMgYSBzdGF0aWMgbWV0aG9kICcgKyAnYW5kIHdpbGwgYmUgaWdub3JlZC4gSW5zdGVhZCwgZGVjbGFyZSBpdCBhcyBhbiBpbnN0YW5jZSBtZXRob2QuJywgbmFtZSk7CiAgICAgIH0KCiAgICAgIHZhciBfc3RhdGUgPSBpbnN0YW5jZS5zdGF0ZTsKCiAgICAgIGlmIChfc3RhdGUgJiYgKHR5cGVvZiBfc3RhdGUgIT09ICdvYmplY3QnIHx8IGlzQXJyYXkoX3N0YXRlKSkpIHsKICAgICAgICBlcnJvcignJXMuc3RhdGU6IG11c3QgYmUgc2V0IHRvIGFuIG9iamVjdCBvciBudWxsJywgbmFtZSk7CiAgICAgIH0KCiAgICAgIGlmICh0eXBlb2YgaW5zdGFuY2UuZ2V0Q2hpbGRDb250ZXh0ID09PSAnZnVuY3Rpb24nICYmIHR5cGVvZiBjdG9yLmNoaWxkQ29udGV4dFR5cGVzICE9PSAnb2JqZWN0JykgewogICAgICAgIGVycm9yKCclcy5nZXRDaGlsZENvbnRleHQoKTogY2hpbGRDb250ZXh0VHlwZXMgbXVzdCBiZSBkZWZpbmVkIGluIG9yZGVyIHRvICcgKyAndXNlIGdldENoaWxkQ29udGV4dCgpLicsIG5hbWUpOwogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiBhZG9wdENsYXNzSW5zdGFuY2Uod29ya0luUHJvZ3Jlc3MsIGluc3RhbmNlKSB7CiAgICBpbnN0YW5jZS51cGRhdGVyID0gY2xhc3NDb21wb25lbnRVcGRhdGVyOwogICAgd29ya0luUHJvZ3Jlc3Muc3RhdGVOb2RlID0gaW5zdGFuY2U7IC8vIFRoZSBpbnN0YW5jZSBuZWVkcyBhY2Nlc3MgdG8gdGhlIGZpYmVyIHNvIHRoYXQgaXQgY2FuIHNjaGVkdWxlIHVwZGF0ZXMKCiAgICBzZXQoaW5zdGFuY2UsIHdvcmtJblByb2dyZXNzKTsKCiAgICB7CiAgICAgIGluc3RhbmNlLl9yZWFjdEludGVybmFsSW5zdGFuY2UgPSBmYWtlSW50ZXJuYWxJbnN0YW5jZTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGNvbnN0cnVjdENsYXNzSW5zdGFuY2Uod29ya0luUHJvZ3Jlc3MsIGN0b3IsIHByb3BzKSB7CiAgICB2YXIgaXNMZWdhY3lDb250ZXh0Q29uc3VtZXIgPSBmYWxzZTsKICAgIHZhciB1bm1hc2tlZENvbnRleHQgPSBlbXB0eUNvbnRleHRPYmplY3Q7CiAgICB2YXIgY29udGV4dCA9IGVtcHR5Q29udGV4dE9iamVjdDsKICAgIHZhciBjb250ZXh0VHlwZSA9IGN0b3IuY29udGV4dFR5cGU7CgogICAgewogICAgICBpZiAoJ2NvbnRleHRUeXBlJyBpbiBjdG9yKSB7CiAgICAgICAgdmFyIGlzVmFsaWQgPSAvLyBBbGxvdyBudWxsIGZvciBjb25kaXRpb25hbCBkZWNsYXJhdGlvbgogICAgICAgIGNvbnRleHRUeXBlID09PSBudWxsIHx8IGNvbnRleHRUeXBlICE9PSB1bmRlZmluZWQgJiYgY29udGV4dFR5cGUuJCR0eXBlb2YgPT09IFJFQUNUX0NPTlRFWFRfVFlQRSAmJiBjb250ZXh0VHlwZS5fY29udGV4dCA9PT0gdW5kZWZpbmVkOyAvLyBOb3QgYSA8Q29udGV4dC5Db25zdW1lcj4KCiAgICAgICAgaWYgKCFpc1ZhbGlkICYmICFkaWRXYXJuQWJvdXRJbnZhbGlkYXRlQ29udGV4dFR5cGUuaGFzKGN0b3IpKSB7CiAgICAgICAgICBkaWRXYXJuQWJvdXRJbnZhbGlkYXRlQ29udGV4dFR5cGUuYWRkKGN0b3IpOwogICAgICAgICAgdmFyIGFkZGVuZHVtID0gJyc7CgogICAgICAgICAgaWYgKGNvbnRleHRUeXBlID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgYWRkZW5kdW0gPSAnIEhvd2V2ZXIsIGl0IGlzIHNldCB0byB1bmRlZmluZWQuICcgKyAnVGhpcyBjYW4gYmUgY2F1c2VkIGJ5IGEgdHlwbyBvciBieSBtaXhpbmcgdXAgbmFtZWQgYW5kIGRlZmF1bHQgaW1wb3J0cy4gJyArICdUaGlzIGNhbiBhbHNvIGhhcHBlbiBkdWUgdG8gYSBjaXJjdWxhciBkZXBlbmRlbmN5LCBzbyAnICsgJ3RyeSBtb3ZpbmcgdGhlIGNyZWF0ZUNvbnRleHQoKSBjYWxsIHRvIGEgc2VwYXJhdGUgZmlsZS4nOwogICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgY29udGV4dFR5cGUgIT09ICdvYmplY3QnKSB7CiAgICAgICAgICAgIGFkZGVuZHVtID0gJyBIb3dldmVyLCBpdCBpcyBzZXQgdG8gYSAnICsgdHlwZW9mIGNvbnRleHRUeXBlICsgJy4nOwogICAgICAgICAgfSBlbHNlIGlmIChjb250ZXh0VHlwZS4kJHR5cGVvZiA9PT0gUkVBQ1RfUFJPVklERVJfVFlQRSkgewogICAgICAgICAgICBhZGRlbmR1bSA9ICcgRGlkIHlvdSBhY2NpZGVudGFsbHkgcGFzcyB0aGUgQ29udGV4dC5Qcm92aWRlciBpbnN0ZWFkPyc7CiAgICAgICAgICB9IGVsc2UgaWYgKGNvbnRleHRUeXBlLl9jb250ZXh0ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgLy8gPENvbnRleHQuQ29uc3VtZXI+CiAgICAgICAgICAgIGFkZGVuZHVtID0gJyBEaWQgeW91IGFjY2lkZW50YWxseSBwYXNzIHRoZSBDb250ZXh0LkNvbnN1bWVyIGluc3RlYWQ/JzsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGFkZGVuZHVtID0gJyBIb3dldmVyLCBpdCBpcyBzZXQgdG8gYW4gb2JqZWN0IHdpdGgga2V5cyB7JyArIE9iamVjdC5rZXlzKGNvbnRleHRUeXBlKS5qb2luKCcsICcpICsgJ30uJzsKICAgICAgICAgIH0KCiAgICAgICAgICBlcnJvcignJXMgZGVmaW5lcyBhbiBpbnZhbGlkIGNvbnRleHRUeXBlLiAnICsgJ2NvbnRleHRUeXBlIHNob3VsZCBwb2ludCB0byB0aGUgQ29udGV4dCBvYmplY3QgcmV0dXJuZWQgYnkgUmVhY3QuY3JlYXRlQ29udGV4dCgpLiVzJywgZ2V0Q29tcG9uZW50TmFtZUZyb21UeXBlKGN0b3IpIHx8ICdDb21wb25lbnQnLCBhZGRlbmR1bSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgaWYgKHR5cGVvZiBjb250ZXh0VHlwZSA9PT0gJ29iamVjdCcgJiYgY29udGV4dFR5cGUgIT09IG51bGwpIHsKICAgICAgY29udGV4dCA9IHJlYWRDb250ZXh0KGNvbnRleHRUeXBlKTsKICAgIH0gZWxzZSB7CiAgICAgIHVubWFza2VkQ29udGV4dCA9IGdldFVubWFza2VkQ29udGV4dCh3b3JrSW5Qcm9ncmVzcywgY3RvciwgdHJ1ZSk7CiAgICAgIHZhciBjb250ZXh0VHlwZXMgPSBjdG9yLmNvbnRleHRUeXBlczsKICAgICAgaXNMZWdhY3lDb250ZXh0Q29uc3VtZXIgPSBjb250ZXh0VHlwZXMgIT09IG51bGwgJiYgY29udGV4dFR5cGVzICE9PSB1bmRlZmluZWQ7CiAgICAgIGNvbnRleHQgPSBpc0xlZ2FjeUNvbnRleHRDb25zdW1lciA/IGdldE1hc2tlZENvbnRleHQod29ya0luUHJvZ3Jlc3MsIHVubWFza2VkQ29udGV4dCkgOiBlbXB0eUNvbnRleHRPYmplY3Q7CiAgICB9CgogICAgdmFyIGluc3RhbmNlID0gbmV3IGN0b3IocHJvcHMsIGNvbnRleHQpOyAvLyBJbnN0YW50aWF0ZSB0d2ljZSB0byBoZWxwIGRldGVjdCBzaWRlLWVmZmVjdHMuCgogICAgewogICAgICBpZiAoIHdvcmtJblByb2dyZXNzLm1vZGUgJiBTdHJpY3RMZWdhY3lNb2RlKSB7CiAgICAgICAgc2V0SXNTdHJpY3RNb2RlRm9yRGV2dG9vbHModHJ1ZSk7CgogICAgICAgIHRyeSB7CiAgICAgICAgICBpbnN0YW5jZSA9IG5ldyBjdG9yKHByb3BzLCBjb250ZXh0KTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1uZXcKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgc2V0SXNTdHJpY3RNb2RlRm9yRGV2dG9vbHMoZmFsc2UpOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHZhciBzdGF0ZSA9IHdvcmtJblByb2dyZXNzLm1lbW9pemVkU3RhdGUgPSBpbnN0YW5jZS5zdGF0ZSAhPT0gbnVsbCAmJiBpbnN0YW5jZS5zdGF0ZSAhPT0gdW5kZWZpbmVkID8gaW5zdGFuY2Uuc3RhdGUgOiBudWxsOwogICAgYWRvcHRDbGFzc0luc3RhbmNlKHdvcmtJblByb2dyZXNzLCBpbnN0YW5jZSk7CgogICAgewogICAgICBpZiAodHlwZW9mIGN0b3IuZ2V0RGVyaXZlZFN0YXRlRnJvbVByb3BzID09PSAnZnVuY3Rpb24nICYmIHN0YXRlID09PSBudWxsKSB7CiAgICAgICAgdmFyIGNvbXBvbmVudE5hbWUgPSBnZXRDb21wb25lbnROYW1lRnJvbVR5cGUoY3RvcikgfHwgJ0NvbXBvbmVudCc7CgogICAgICAgIGlmICghZGlkV2FybkFib3V0VW5pbml0aWFsaXplZFN0YXRlLmhhcyhjb21wb25lbnROYW1lKSkgewogICAgICAgICAgZGlkV2FybkFib3V0VW5pbml0aWFsaXplZFN0YXRlLmFkZChjb21wb25lbnROYW1lKTsKCiAgICAgICAgICBlcnJvcignYCVzYCB1c2VzIGBnZXREZXJpdmVkU3RhdGVGcm9tUHJvcHNgIGJ1dCBpdHMgaW5pdGlhbCBzdGF0ZSBpcyAnICsgJyVzLiBUaGlzIGlzIG5vdCByZWNvbW1lbmRlZC4gSW5zdGVhZCwgZGVmaW5lIHRoZSBpbml0aWFsIHN0YXRlIGJ5ICcgKyAnYXNzaWduaW5nIGFuIG9iamVjdCB0byBgdGhpcy5zdGF0ZWAgaW4gdGhlIGNvbnN0cnVjdG9yIG9mIGAlc2AuICcgKyAnVGhpcyBlbnN1cmVzIHRoYXQgYGdldERlcml2ZWRTdGF0ZUZyb21Qcm9wc2AgYXJndW1lbnRzIGhhdmUgYSBjb25zaXN0ZW50IHNoYXBlLicsIGNvbXBvbmVudE5hbWUsIGluc3RhbmNlLnN0YXRlID09PSBudWxsID8gJ251bGwnIDogJ3VuZGVmaW5lZCcsIGNvbXBvbmVudE5hbWUpOwogICAgICAgIH0KICAgICAgfSAvLyBJZiBuZXcgY29tcG9uZW50IEFQSXMgYXJlIGRlZmluZWQsICJ1bnNhZmUiIGxpZmVjeWNsZXMgd29uJ3QgYmUgY2FsbGVkLgogICAgICAvLyBXYXJuIGFib3V0IHRoZXNlIGxpZmVjeWNsZXMgaWYgdGhleSBhcmUgcHJlc2VudC4KICAgICAgLy8gRG9uJ3Qgd2FybiBhYm91dCByZWFjdC1saWZlY3ljbGVzLWNvbXBhdCBwb2x5ZmlsbGVkIG1ldGhvZHMgdGhvdWdoLgoKCiAgICAgIGlmICh0eXBlb2YgY3Rvci5nZXREZXJpdmVkU3RhdGVGcm9tUHJvcHMgPT09ICdmdW5jdGlvbicgfHwgdHlwZW9mIGluc3RhbmNlLmdldFNuYXBzaG90QmVmb3JlVXBkYXRlID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgdmFyIGZvdW5kV2lsbE1vdW50TmFtZSA9IG51bGw7CiAgICAgICAgdmFyIGZvdW5kV2lsbFJlY2VpdmVQcm9wc05hbWUgPSBudWxsOwogICAgICAgIHZhciBmb3VuZFdpbGxVcGRhdGVOYW1lID0gbnVsbDsKCiAgICAgICAgaWYgKHR5cGVvZiBpbnN0YW5jZS5jb21wb25lbnRXaWxsTW91bnQgPT09ICdmdW5jdGlvbicgJiYgaW5zdGFuY2UuY29tcG9uZW50V2lsbE1vdW50Ll9fc3VwcHJlc3NEZXByZWNhdGlvbldhcm5pbmcgIT09IHRydWUpIHsKICAgICAgICAgIGZvdW5kV2lsbE1vdW50TmFtZSA9ICdjb21wb25lbnRXaWxsTW91bnQnOwogICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGluc3RhbmNlLlVOU0FGRV9jb21wb25lbnRXaWxsTW91bnQgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgIGZvdW5kV2lsbE1vdW50TmFtZSA9ICdVTlNBRkVfY29tcG9uZW50V2lsbE1vdW50JzsKICAgICAgICB9CgogICAgICAgIGlmICh0eXBlb2YgaW5zdGFuY2UuY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyA9PT0gJ2Z1bmN0aW9uJyAmJiBpbnN0YW5jZS5jb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzLl9fc3VwcHJlc3NEZXByZWNhdGlvbldhcm5pbmcgIT09IHRydWUpIHsKICAgICAgICAgIGZvdW5kV2lsbFJlY2VpdmVQcm9wc05hbWUgPSAnY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyc7CiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgaW5zdGFuY2UuVU5TQUZFX2NvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgIGZvdW5kV2lsbFJlY2VpdmVQcm9wc05hbWUgPSAnVU5TQUZFX2NvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMnOwogICAgICAgIH0KCiAgICAgICAgaWYgKHR5cGVvZiBpbnN0YW5jZS5jb21wb25lbnRXaWxsVXBkYXRlID09PSAnZnVuY3Rpb24nICYmIGluc3RhbmNlLmNvbXBvbmVudFdpbGxVcGRhdGUuX19zdXBwcmVzc0RlcHJlY2F0aW9uV2FybmluZyAhPT0gdHJ1ZSkgewogICAgICAgICAgZm91bmRXaWxsVXBkYXRlTmFtZSA9ICdjb21wb25lbnRXaWxsVXBkYXRlJzsKICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBpbnN0YW5jZS5VTlNBRkVfY29tcG9uZW50V2lsbFVwZGF0ZSA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgZm91bmRXaWxsVXBkYXRlTmFtZSA9ICdVTlNBRkVfY29tcG9uZW50V2lsbFVwZGF0ZSc7CiAgICAgICAgfQoKICAgICAgICBpZiAoZm91bmRXaWxsTW91bnROYW1lICE9PSBudWxsIHx8IGZvdW5kV2lsbFJlY2VpdmVQcm9wc05hbWUgIT09IG51bGwgfHwgZm91bmRXaWxsVXBkYXRlTmFtZSAhPT0gbnVsbCkgewogICAgICAgICAgdmFyIF9jb21wb25lbnROYW1lID0gZ2V0Q29tcG9uZW50TmFtZUZyb21UeXBlKGN0b3IpIHx8ICdDb21wb25lbnQnOwoKICAgICAgICAgIHZhciBuZXdBcGlOYW1lID0gdHlwZW9mIGN0b3IuZ2V0RGVyaXZlZFN0YXRlRnJvbVByb3BzID09PSAnZnVuY3Rpb24nID8gJ2dldERlcml2ZWRTdGF0ZUZyb21Qcm9wcygpJyA6ICdnZXRTbmFwc2hvdEJlZm9yZVVwZGF0ZSgpJzsKCiAgICAgICAgICBpZiAoIWRpZFdhcm5BYm91dExlZ2FjeUxpZmVjeWNsZXNBbmREZXJpdmVkU3RhdGUuaGFzKF9jb21wb25lbnROYW1lKSkgewogICAgICAgICAgICBkaWRXYXJuQWJvdXRMZWdhY3lMaWZlY3ljbGVzQW5kRGVyaXZlZFN0YXRlLmFkZChfY29tcG9uZW50TmFtZSk7CgogICAgICAgICAgICBlcnJvcignVW5zYWZlIGxlZ2FjeSBsaWZlY3ljbGVzIHdpbGwgbm90IGJlIGNhbGxlZCBmb3IgY29tcG9uZW50cyB1c2luZyBuZXcgY29tcG9uZW50IEFQSXMuXG5cbicgKyAnJXMgdXNlcyAlcyBidXQgYWxzbyBjb250YWlucyB0aGUgZm9sbG93aW5nIGxlZ2FjeSBsaWZlY3ljbGVzOiVzJXMlc1xuXG4nICsgJ1RoZSBhYm92ZSBsaWZlY3ljbGVzIHNob3VsZCBiZSByZW1vdmVkLiBMZWFybiBtb3JlIGFib3V0IHRoaXMgd2FybmluZyBoZXJlOlxuJyArICdodHRwczovL3JlYWN0anMub3JnL2xpbmsvdW5zYWZlLWNvbXBvbmVudC1saWZlY3ljbGVzJywgX2NvbXBvbmVudE5hbWUsIG5ld0FwaU5hbWUsIGZvdW5kV2lsbE1vdW50TmFtZSAhPT0gbnVsbCA/ICJcbiAgIiArIGZvdW5kV2lsbE1vdW50TmFtZSA6ICcnLCBmb3VuZFdpbGxSZWNlaXZlUHJvcHNOYW1lICE9PSBudWxsID8gIlxuICAiICsgZm91bmRXaWxsUmVjZWl2ZVByb3BzTmFtZSA6ICcnLCBmb3VuZFdpbGxVcGRhdGVOYW1lICE9PSBudWxsID8gIlxuICAiICsgZm91bmRXaWxsVXBkYXRlTmFtZSA6ICcnKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0gLy8gQ2FjaGUgdW5tYXNrZWQgY29udGV4dCBzbyB3ZSBjYW4gYXZvaWQgcmVjcmVhdGluZyBtYXNrZWQgY29udGV4dCB1bmxlc3MgbmVjZXNzYXJ5LgogICAgLy8gUmVhY3RGaWJlckNvbnRleHQgdXN1YWxseSB1cGRhdGVzIHRoaXMgY2FjaGUgYnV0IGNhbid0IGZvciBuZXdseS1jcmVhdGVkIGluc3RhbmNlcy4KCgogICAgaWYgKGlzTGVnYWN5Q29udGV4dENvbnN1bWVyKSB7CiAgICAgIGNhY2hlQ29udGV4dCh3b3JrSW5Qcm9ncmVzcywgdW5tYXNrZWRDb250ZXh0LCBjb250ZXh0KTsKICAgIH0KCiAgICByZXR1cm4gaW5zdGFuY2U7CiAgfQoKICBmdW5jdGlvbiBjYWxsQ29tcG9uZW50V2lsbE1vdW50KHdvcmtJblByb2dyZXNzLCBpbnN0YW5jZSkgewogICAgdmFyIG9sZFN0YXRlID0gaW5zdGFuY2Uuc3RhdGU7CgogICAgaWYgKHR5cGVvZiBpbnN0YW5jZS5jb21wb25lbnRXaWxsTW91bnQgPT09ICdmdW5jdGlvbicpIHsKICAgICAgaW5zdGFuY2UuY29tcG9uZW50V2lsbE1vdW50KCk7CiAgICB9CgogICAgaWYgKHR5cGVvZiBpbnN0YW5jZS5VTlNBRkVfY29tcG9uZW50V2lsbE1vdW50ID09PSAnZnVuY3Rpb24nKSB7CiAgICAgIGluc3RhbmNlLlVOU0FGRV9jb21wb25lbnRXaWxsTW91bnQoKTsKICAgIH0KCiAgICBpZiAob2xkU3RhdGUgIT09IGluc3RhbmNlLnN0YXRlKSB7CiAgICAgIHsKICAgICAgICBlcnJvcignJXMuY29tcG9uZW50V2lsbE1vdW50KCk6IEFzc2lnbmluZyBkaXJlY3RseSB0byB0aGlzLnN0YXRlIGlzICcgKyAiZGVwcmVjYXRlZCAoZXhjZXB0IGluc2lkZSBhIGNvbXBvbmVudCdzICIgKyAnY29uc3RydWN0b3IpLiBVc2Ugc2V0U3RhdGUgaW5zdGVhZC4nLCBnZXRDb21wb25lbnROYW1lRnJvbUZpYmVyKHdvcmtJblByb2dyZXNzKSB8fCAnQ29tcG9uZW50Jyk7CiAgICAgIH0KCiAgICAgIGNsYXNzQ29tcG9uZW50VXBkYXRlci5lbnF1ZXVlUmVwbGFjZVN0YXRlKGluc3RhbmNlLCBpbnN0YW5jZS5zdGF0ZSwgbnVsbCk7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBjYWxsQ29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyh3b3JrSW5Qcm9ncmVzcywgaW5zdGFuY2UsIG5ld1Byb3BzLCBuZXh0Q29udGV4dCkgewogICAgdmFyIG9sZFN0YXRlID0gaW5zdGFuY2Uuc3RhdGU7CgogICAgaWYgKHR5cGVvZiBpbnN0YW5jZS5jb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzID09PSAnZnVuY3Rpb24nKSB7CiAgICAgIGluc3RhbmNlLmNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMobmV3UHJvcHMsIG5leHRDb250ZXh0KTsKICAgIH0KCiAgICBpZiAodHlwZW9mIGluc3RhbmNlLlVOU0FGRV9jb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzID09PSAnZnVuY3Rpb24nKSB7CiAgICAgIGluc3RhbmNlLlVOU0FGRV9jb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKG5ld1Byb3BzLCBuZXh0Q29udGV4dCk7CiAgICB9CgogICAgaWYgKGluc3RhbmNlLnN0YXRlICE9PSBvbGRTdGF0ZSkgewogICAgICB7CiAgICAgICAgdmFyIGNvbXBvbmVudE5hbWUgPSBnZXRDb21wb25lbnROYW1lRnJvbUZpYmVyKHdvcmtJblByb2dyZXNzKSB8fCAnQ29tcG9uZW50JzsKCiAgICAgICAgaWYgKCFkaWRXYXJuQWJvdXRTdGF0ZUFzc2lnbm1lbnRGb3JDb21wb25lbnQuaGFzKGNvbXBvbmVudE5hbWUpKSB7CiAgICAgICAgICBkaWRXYXJuQWJvdXRTdGF0ZUFzc2lnbm1lbnRGb3JDb21wb25lbnQuYWRkKGNvbXBvbmVudE5hbWUpOwoKICAgICAgICAgIGVycm9yKCclcy5jb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKCk6IEFzc2lnbmluZyBkaXJlY3RseSB0byAnICsgInRoaXMuc3RhdGUgaXMgZGVwcmVjYXRlZCAoZXhjZXB0IGluc2lkZSBhIGNvbXBvbmVudCdzICIgKyAnY29uc3RydWN0b3IpLiBVc2Ugc2V0U3RhdGUgaW5zdGVhZC4nLCBjb21wb25lbnROYW1lKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGNsYXNzQ29tcG9uZW50VXBkYXRlci5lbnF1ZXVlUmVwbGFjZVN0YXRlKGluc3RhbmNlLCBpbnN0YW5jZS5zdGF0ZSwgbnVsbCk7CiAgICB9CiAgfSAvLyBJbnZva2VzIHRoZSBtb3VudCBsaWZlLWN5Y2xlcyBvbiBhIHByZXZpb3VzbHkgbmV2ZXIgcmVuZGVyZWQgaW5zdGFuY2UuCgoKICBmdW5jdGlvbiBtb3VudENsYXNzSW5zdGFuY2Uod29ya0luUHJvZ3Jlc3MsIGN0b3IsIG5ld1Byb3BzLCByZW5kZXJMYW5lcykgewogICAgewogICAgICBjaGVja0NsYXNzSW5zdGFuY2Uod29ya0luUHJvZ3Jlc3MsIGN0b3IsIG5ld1Byb3BzKTsKICAgIH0KCiAgICB2YXIgaW5zdGFuY2UgPSB3b3JrSW5Qcm9ncmVzcy5zdGF0ZU5vZGU7CiAgICBpbnN0YW5jZS5wcm9wcyA9IG5ld1Byb3BzOwogICAgaW5zdGFuY2Uuc3RhdGUgPSB3b3JrSW5Qcm9ncmVzcy5tZW1vaXplZFN0YXRlOwogICAgaW5zdGFuY2UucmVmcyA9IHt9OwogICAgaW5pdGlhbGl6ZVVwZGF0ZVF1ZXVlKHdvcmtJblByb2dyZXNzKTsKICAgIHZhciBjb250ZXh0VHlwZSA9IGN0b3IuY29udGV4dFR5cGU7CgogICAgaWYgKHR5cGVvZiBjb250ZXh0VHlwZSA9PT0gJ29iamVjdCcgJiYgY29udGV4dFR5cGUgIT09IG51bGwpIHsKICAgICAgaW5zdGFuY2UuY29udGV4dCA9IHJlYWRDb250ZXh0KGNvbnRleHRUeXBlKTsKICAgIH0gZWxzZSB7CiAgICAgIHZhciB1bm1hc2tlZENvbnRleHQgPSBnZXRVbm1hc2tlZENvbnRleHQod29ya0luUHJvZ3Jlc3MsIGN0b3IsIHRydWUpOwogICAgICBpbnN0YW5jZS5jb250ZXh0ID0gZ2V0TWFza2VkQ29udGV4dCh3b3JrSW5Qcm9ncmVzcywgdW5tYXNrZWRDb250ZXh0KTsKICAgIH0KCiAgICB7CiAgICAgIGlmIChpbnN0YW5jZS5zdGF0ZSA9PT0gbmV3UHJvcHMpIHsKICAgICAgICB2YXIgY29tcG9uZW50TmFtZSA9IGdldENvbXBvbmVudE5hbWVGcm9tVHlwZShjdG9yKSB8fCAnQ29tcG9uZW50JzsKCiAgICAgICAgaWYgKCFkaWRXYXJuQWJvdXREaXJlY3RseUFzc2lnbmluZ1Byb3BzVG9TdGF0ZS5oYXMoY29tcG9uZW50TmFtZSkpIHsKICAgICAgICAgIGRpZFdhcm5BYm91dERpcmVjdGx5QXNzaWduaW5nUHJvcHNUb1N0YXRlLmFkZChjb21wb25lbnROYW1lKTsKCiAgICAgICAgICBlcnJvcignJXM6IEl0IGlzIG5vdCByZWNvbW1lbmRlZCB0byBhc3NpZ24gcHJvcHMgZGlyZWN0bHkgdG8gc3RhdGUgJyArICJiZWNhdXNlIHVwZGF0ZXMgdG8gcHJvcHMgd29uJ3QgYmUgcmVmbGVjdGVkIGluIHN0YXRlLiAiICsgJ0luIG1vc3QgY2FzZXMsIGl0IGlzIGJldHRlciB0byB1c2UgcHJvcHMgZGlyZWN0bHkuJywgY29tcG9uZW50TmFtZSk7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAod29ya0luUHJvZ3Jlc3MubW9kZSAmIFN0cmljdExlZ2FjeU1vZGUpIHsKICAgICAgICBSZWFjdFN0cmljdE1vZGVXYXJuaW5ncy5yZWNvcmRMZWdhY3lDb250ZXh0V2FybmluZyh3b3JrSW5Qcm9ncmVzcywgaW5zdGFuY2UpOwogICAgICB9CgogICAgICB7CiAgICAgICAgUmVhY3RTdHJpY3RNb2RlV2FybmluZ3MucmVjb3JkVW5zYWZlTGlmZWN5Y2xlV2FybmluZ3Mod29ya0luUHJvZ3Jlc3MsIGluc3RhbmNlKTsKICAgICAgfQogICAgfQoKICAgIGluc3RhbmNlLnN0YXRlID0gd29ya0luUHJvZ3Jlc3MubWVtb2l6ZWRTdGF0ZTsKICAgIHZhciBnZXREZXJpdmVkU3RhdGVGcm9tUHJvcHMgPSBjdG9yLmdldERlcml2ZWRTdGF0ZUZyb21Qcm9wczsKCiAgICBpZiAodHlwZW9mIGdldERlcml2ZWRTdGF0ZUZyb21Qcm9wcyA9PT0gJ2Z1bmN0aW9uJykgewogICAgICBhcHBseURlcml2ZWRTdGF0ZUZyb21Qcm9wcyh3b3JrSW5Qcm9ncmVzcywgY3RvciwgZ2V0RGVyaXZlZFN0YXRlRnJvbVByb3BzLCBuZXdQcm9wcyk7CiAgICAgIGluc3RhbmNlLnN0YXRlID0gd29ya0luUHJvZ3Jlc3MubWVtb2l6ZWRTdGF0ZTsKICAgIH0gLy8gSW4gb3JkZXIgdG8gc3VwcG9ydCByZWFjdC1saWZlY3ljbGVzLWNvbXBhdCBwb2x5ZmlsbGVkIGNvbXBvbmVudHMsCiAgICAvLyBVbnNhZmUgbGlmZWN5Y2xlcyBzaG91bGQgbm90IGJlIGludm9rZWQgZm9yIGNvbXBvbmVudHMgdXNpbmcgdGhlIG5ldyBBUElzLgoKCiAgICBpZiAodHlwZW9mIGN0b3IuZ2V0RGVyaXZlZFN0YXRlRnJvbVByb3BzICE9PSAnZnVuY3Rpb24nICYmIHR5cGVvZiBpbnN0YW5jZS5nZXRTbmFwc2hvdEJlZm9yZVVwZGF0ZSAhPT0gJ2Z1bmN0aW9uJyAmJiAodHlwZW9mIGluc3RhbmNlLlVOU0FGRV9jb21wb25lbnRXaWxsTW91bnQgPT09ICdmdW5jdGlvbicgfHwgdHlwZW9mIGluc3RhbmNlLmNvbXBvbmVudFdpbGxNb3VudCA9PT0gJ2Z1bmN0aW9uJykpIHsKICAgICAgY2FsbENvbXBvbmVudFdpbGxNb3VudCh3b3JrSW5Qcm9ncmVzcywgaW5zdGFuY2UpOyAvLyBJZiB3ZSBoYWQgYWRkaXRpb25hbCBzdGF0ZSB1cGRhdGVzIGR1cmluZyB0aGlzIGxpZmUtY3ljbGUsIGxldCdzCiAgICAgIC8vIHByb2Nlc3MgdGhlbSBub3cuCgogICAgICBwcm9jZXNzVXBkYXRlUXVldWUod29ya0luUHJvZ3Jlc3MsIG5ld1Byb3BzLCBpbnN0YW5jZSwgcmVuZGVyTGFuZXMpOwogICAgICBpbnN0YW5jZS5zdGF0ZSA9IHdvcmtJblByb2dyZXNzLm1lbW9pemVkU3RhdGU7CiAgICB9CgogICAgaWYgKHR5cGVvZiBpbnN0YW5jZS5jb21wb25lbnREaWRNb3VudCA9PT0gJ2Z1bmN0aW9uJykgewogICAgICB2YXIgZmliZXJGbGFncyA9IFVwZGF0ZTsKCiAgICAgIHsKICAgICAgICBmaWJlckZsYWdzIHw9IExheW91dFN0YXRpYzsKICAgICAgfQoKICAgICAgaWYgKCAod29ya0luUHJvZ3Jlc3MubW9kZSAmIFN0cmljdEVmZmVjdHNNb2RlKSAhPT0gTm9Nb2RlKSB7CiAgICAgICAgZmliZXJGbGFncyB8PSBNb3VudExheW91dERldjsKICAgICAgfQoKICAgICAgd29ya0luUHJvZ3Jlc3MuZmxhZ3MgfD0gZmliZXJGbGFnczsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHJlc3VtZU1vdW50Q2xhc3NJbnN0YW5jZSh3b3JrSW5Qcm9ncmVzcywgY3RvciwgbmV3UHJvcHMsIHJlbmRlckxhbmVzKSB7CiAgICB2YXIgaW5zdGFuY2UgPSB3b3JrSW5Qcm9ncmVzcy5zdGF0ZU5vZGU7CiAgICB2YXIgb2xkUHJvcHMgPSB3b3JrSW5Qcm9ncmVzcy5tZW1vaXplZFByb3BzOwogICAgaW5zdGFuY2UucHJvcHMgPSBvbGRQcm9wczsKICAgIHZhciBvbGRDb250ZXh0ID0gaW5zdGFuY2UuY29udGV4dDsKICAgIHZhciBjb250ZXh0VHlwZSA9IGN0b3IuY29udGV4dFR5cGU7CiAgICB2YXIgbmV4dENvbnRleHQgPSBlbXB0eUNvbnRleHRPYmplY3Q7CgogICAgaWYgKHR5cGVvZiBjb250ZXh0VHlwZSA9PT0gJ29iamVjdCcgJiYgY29udGV4dFR5cGUgIT09IG51bGwpIHsKICAgICAgbmV4dENvbnRleHQgPSByZWFkQ29udGV4dChjb250ZXh0VHlwZSk7CiAgICB9IGVsc2UgewogICAgICB2YXIgbmV4dExlZ2FjeVVubWFza2VkQ29udGV4dCA9IGdldFVubWFza2VkQ29udGV4dCh3b3JrSW5Qcm9ncmVzcywgY3RvciwgdHJ1ZSk7CiAgICAgIG5leHRDb250ZXh0ID0gZ2V0TWFza2VkQ29udGV4dCh3b3JrSW5Qcm9ncmVzcywgbmV4dExlZ2FjeVVubWFza2VkQ29udGV4dCk7CiAgICB9CgogICAgdmFyIGdldERlcml2ZWRTdGF0ZUZyb21Qcm9wcyA9IGN0b3IuZ2V0RGVyaXZlZFN0YXRlRnJvbVByb3BzOwogICAgdmFyIGhhc05ld0xpZmVjeWNsZXMgPSB0eXBlb2YgZ2V0RGVyaXZlZFN0YXRlRnJvbVByb3BzID09PSAnZnVuY3Rpb24nIHx8IHR5cGVvZiBpbnN0YW5jZS5nZXRTbmFwc2hvdEJlZm9yZVVwZGF0ZSA9PT0gJ2Z1bmN0aW9uJzsgLy8gTm90ZTogRHVyaW5nIHRoZXNlIGxpZmUtY3ljbGVzLCBpbnN0YW5jZS5wcm9wcy9pbnN0YW5jZS5zdGF0ZSBhcmUgd2hhdAogICAgLy8gZXZlciB0aGUgcHJldmlvdXNseSBhdHRlbXB0ZWQgdG8gcmVuZGVyIC0gbm90IHRoZSAiY3VycmVudCIuIEhvd2V2ZXIsCiAgICAvLyBkdXJpbmcgY29tcG9uZW50RGlkVXBkYXRlIHdlIHBhc3MgdGhlICJjdXJyZW50IiBwcm9wcy4KICAgIC8vIEluIG9yZGVyIHRvIHN1cHBvcnQgcmVhY3QtbGlmZWN5Y2xlcy1jb21wYXQgcG9seWZpbGxlZCBjb21wb25lbnRzLAogICAgLy8gVW5zYWZlIGxpZmVjeWNsZXMgc2hvdWxkIG5vdCBiZSBpbnZva2VkIGZvciBjb21wb25lbnRzIHVzaW5nIHRoZSBuZXcgQVBJcy4KCiAgICBpZiAoIWhhc05ld0xpZmVjeWNsZXMgJiYgKHR5cGVvZiBpbnN0YW5jZS5VTlNBRkVfY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyA9PT0gJ2Z1bmN0aW9uJyB8fCB0eXBlb2YgaW5zdGFuY2UuY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyA9PT0gJ2Z1bmN0aW9uJykpIHsKICAgICAgaWYgKG9sZFByb3BzICE9PSBuZXdQcm9wcyB8fCBvbGRDb250ZXh0ICE9PSBuZXh0Q29udGV4dCkgewogICAgICAgIGNhbGxDb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKHdvcmtJblByb2dyZXNzLCBpbnN0YW5jZSwgbmV3UHJvcHMsIG5leHRDb250ZXh0KTsKICAgICAgfQogICAgfQoKICAgIHJlc2V0SGFzRm9yY2VVcGRhdGVCZWZvcmVQcm9jZXNzaW5nKCk7CiAgICB2YXIgb2xkU3RhdGUgPSB3b3JrSW5Qcm9ncmVzcy5tZW1vaXplZFN0YXRlOwogICAgdmFyIG5ld1N0YXRlID0gaW5zdGFuY2Uuc3RhdGUgPSBvbGRTdGF0ZTsKICAgIHByb2Nlc3NVcGRhdGVRdWV1ZSh3b3JrSW5Qcm9ncmVzcywgbmV3UHJvcHMsIGluc3RhbmNlLCByZW5kZXJMYW5lcyk7CiAgICBuZXdTdGF0ZSA9IHdvcmtJblByb2dyZXNzLm1lbW9pemVkU3RhdGU7CgogICAgaWYgKG9sZFByb3BzID09PSBuZXdQcm9wcyAmJiBvbGRTdGF0ZSA9PT0gbmV3U3RhdGUgJiYgIWhhc0NvbnRleHRDaGFuZ2VkKCkgJiYgIWNoZWNrSGFzRm9yY2VVcGRhdGVBZnRlclByb2Nlc3NpbmcoKSkgewogICAgICAvLyBJZiBhbiB1cGRhdGUgd2FzIGFscmVhZHkgaW4gcHJvZ3Jlc3MsIHdlIHNob3VsZCBzY2hlZHVsZSBhbiBVcGRhdGUKICAgICAgLy8gZWZmZWN0IGV2ZW4gdGhvdWdoIHdlJ3JlIGJhaWxpbmcgb3V0LCBzbyB0aGF0IGNXVS9jRFUgYXJlIGNhbGxlZC4KICAgICAgaWYgKHR5cGVvZiBpbnN0YW5jZS5jb21wb25lbnREaWRNb3VudCA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIHZhciBmaWJlckZsYWdzID0gVXBkYXRlOwoKICAgICAgICB7CiAgICAgICAgICBmaWJlckZsYWdzIHw9IExheW91dFN0YXRpYzsKICAgICAgICB9CgogICAgICAgIGlmICggKHdvcmtJblByb2dyZXNzLm1vZGUgJiBTdHJpY3RFZmZlY3RzTW9kZSkgIT09IE5vTW9kZSkgewogICAgICAgICAgZmliZXJGbGFncyB8PSBNb3VudExheW91dERldjsKICAgICAgICB9CgogICAgICAgIHdvcmtJblByb2dyZXNzLmZsYWdzIHw9IGZpYmVyRmxhZ3M7CiAgICAgIH0KCiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBpZiAodHlwZW9mIGdldERlcml2ZWRTdGF0ZUZyb21Qcm9wcyA9PT0gJ2Z1bmN0aW9uJykgewogICAgICBhcHBseURlcml2ZWRTdGF0ZUZyb21Qcm9wcyh3b3JrSW5Qcm9ncmVzcywgY3RvciwgZ2V0RGVyaXZlZFN0YXRlRnJvbVByb3BzLCBuZXdQcm9wcyk7CiAgICAgIG5ld1N0YXRlID0gd29ya0luUHJvZ3Jlc3MubWVtb2l6ZWRTdGF0ZTsKICAgIH0KCiAgICB2YXIgc2hvdWxkVXBkYXRlID0gY2hlY2tIYXNGb3JjZVVwZGF0ZUFmdGVyUHJvY2Vzc2luZygpIHx8IGNoZWNrU2hvdWxkQ29tcG9uZW50VXBkYXRlKHdvcmtJblByb2dyZXNzLCBjdG9yLCBvbGRQcm9wcywgbmV3UHJvcHMsIG9sZFN0YXRlLCBuZXdTdGF0ZSwgbmV4dENvbnRleHQpOwoKICAgIGlmIChzaG91bGRVcGRhdGUpIHsKICAgICAgLy8gSW4gb3JkZXIgdG8gc3VwcG9ydCByZWFjdC1saWZlY3ljbGVzLWNvbXBhdCBwb2x5ZmlsbGVkIGNvbXBvbmVudHMsCiAgICAgIC8vIFVuc2FmZSBsaWZlY3ljbGVzIHNob3VsZCBub3QgYmUgaW52b2tlZCBmb3IgY29tcG9uZW50cyB1c2luZyB0aGUgbmV3IEFQSXMuCiAgICAgIGlmICghaGFzTmV3TGlmZWN5Y2xlcyAmJiAodHlwZW9mIGluc3RhbmNlLlVOU0FGRV9jb21wb25lbnRXaWxsTW91bnQgPT09ICdmdW5jdGlvbicgfHwgdHlwZW9mIGluc3RhbmNlLmNvbXBvbmVudFdpbGxNb3VudCA9PT0gJ2Z1bmN0aW9uJykpIHsKICAgICAgICBpZiAodHlwZW9mIGluc3RhbmNlLmNvbXBvbmVudFdpbGxNb3VudCA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgaW5zdGFuY2UuY29tcG9uZW50V2lsbE1vdW50KCk7CiAgICAgICAgfQoKICAgICAgICBpZiAodHlwZW9mIGluc3RhbmNlLlVOU0FGRV9jb21wb25lbnRXaWxsTW91bnQgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgIGluc3RhbmNlLlVOU0FGRV9jb21wb25lbnRXaWxsTW91bnQoKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICh0eXBlb2YgaW5zdGFuY2UuY29tcG9uZW50RGlkTW91bnQgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICB2YXIgX2ZpYmVyRmxhZ3MgPSBVcGRhdGU7CgogICAgICAgIHsKICAgICAgICAgIF9maWJlckZsYWdzIHw9IExheW91dFN0YXRpYzsKICAgICAgICB9CgogICAgICAgIGlmICggKHdvcmtJblByb2dyZXNzLm1vZGUgJiBTdHJpY3RFZmZlY3RzTW9kZSkgIT09IE5vTW9kZSkgewogICAgICAgICAgX2ZpYmVyRmxhZ3MgfD0gTW91bnRMYXlvdXREZXY7CiAgICAgICAgfQoKICAgICAgICB3b3JrSW5Qcm9ncmVzcy5mbGFncyB8PSBfZmliZXJGbGFnczsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgLy8gSWYgYW4gdXBkYXRlIHdhcyBhbHJlYWR5IGluIHByb2dyZXNzLCB3ZSBzaG91bGQgc2NoZWR1bGUgYW4gVXBkYXRlCiAgICAgIC8vIGVmZmVjdCBldmVuIHRob3VnaCB3ZSdyZSBiYWlsaW5nIG91dCwgc28gdGhhdCBjV1UvY0RVIGFyZSBjYWxsZWQuCiAgICAgIGlmICh0eXBlb2YgaW5zdGFuY2UuY29tcG9uZW50RGlkTW91bnQgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICB2YXIgX2ZpYmVyRmxhZ3MyID0gVXBkYXRlOwoKICAgICAgICB7CiAgICAgICAgICBfZmliZXJGbGFnczIgfD0gTGF5b3V0U3RhdGljOwogICAgICAgIH0KCiAgICAgICAgaWYgKCAod29ya0luUHJvZ3Jlc3MubW9kZSAmIFN0cmljdEVmZmVjdHNNb2RlKSAhPT0gTm9Nb2RlKSB7CiAgICAgICAgICBfZmliZXJGbGFnczIgfD0gTW91bnRMYXlvdXREZXY7CiAgICAgICAgfQoKICAgICAgICB3b3JrSW5Qcm9ncmVzcy5mbGFncyB8PSBfZmliZXJGbGFnczI7CiAgICAgIH0gLy8gSWYgc2hvdWxkQ29tcG9uZW50VXBkYXRlIHJldHVybmVkIGZhbHNlLCB3ZSBzaG91bGQgc3RpbGwgdXBkYXRlIHRoZQogICAgICAvLyBtZW1vaXplZCBzdGF0ZSB0byBpbmRpY2F0ZSB0aGF0IHRoaXMgd29yayBjYW4gYmUgcmV1c2VkLgoKCiAgICAgIHdvcmtJblByb2dyZXNzLm1lbW9pemVkUHJvcHMgPSBuZXdQcm9wczsKICAgICAgd29ya0luUHJvZ3Jlc3MubWVtb2l6ZWRTdGF0ZSA9IG5ld1N0YXRlOwogICAgfSAvLyBVcGRhdGUgdGhlIGV4aXN0aW5nIGluc3RhbmNlJ3Mgc3RhdGUsIHByb3BzLCBhbmQgY29udGV4dCBwb2ludGVycyBldmVuCiAgICAvLyBpZiBzaG91bGRDb21wb25lbnRVcGRhdGUgcmV0dXJucyBmYWxzZS4KCgogICAgaW5zdGFuY2UucHJvcHMgPSBuZXdQcm9wczsKICAgIGluc3RhbmNlLnN0YXRlID0gbmV3U3RhdGU7CiAgICBpbnN0YW5jZS5jb250ZXh0ID0gbmV4dENvbnRleHQ7CiAgICByZXR1cm4gc2hvdWxkVXBkYXRlOwogIH0gLy8gSW52b2tlcyB0aGUgdXBkYXRlIGxpZmUtY3ljbGVzIGFuZCByZXR1cm5zIGZhbHNlIGlmIGl0IHNob3VsZG4ndCByZXJlbmRlci4KCgogIGZ1bmN0aW9uIHVwZGF0ZUNsYXNzSW5zdGFuY2UoY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIGN0b3IsIG5ld1Byb3BzLCByZW5kZXJMYW5lcykgewogICAgdmFyIGluc3RhbmNlID0gd29ya0luUHJvZ3Jlc3Muc3RhdGVOb2RlOwogICAgY2xvbmVVcGRhdGVRdWV1ZShjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcyk7CiAgICB2YXIgdW5yZXNvbHZlZE9sZFByb3BzID0gd29ya0luUHJvZ3Jlc3MubWVtb2l6ZWRQcm9wczsKICAgIHZhciBvbGRQcm9wcyA9IHdvcmtJblByb2dyZXNzLnR5cGUgPT09IHdvcmtJblByb2dyZXNzLmVsZW1lbnRUeXBlID8gdW5yZXNvbHZlZE9sZFByb3BzIDogcmVzb2x2ZURlZmF1bHRQcm9wcyh3b3JrSW5Qcm9ncmVzcy50eXBlLCB1bnJlc29sdmVkT2xkUHJvcHMpOwogICAgaW5zdGFuY2UucHJvcHMgPSBvbGRQcm9wczsKICAgIHZhciB1bnJlc29sdmVkTmV3UHJvcHMgPSB3b3JrSW5Qcm9ncmVzcy5wZW5kaW5nUHJvcHM7CiAgICB2YXIgb2xkQ29udGV4dCA9IGluc3RhbmNlLmNvbnRleHQ7CiAgICB2YXIgY29udGV4dFR5cGUgPSBjdG9yLmNvbnRleHRUeXBlOwogICAgdmFyIG5leHRDb250ZXh0ID0gZW1wdHlDb250ZXh0T2JqZWN0OwoKICAgIGlmICh0eXBlb2YgY29udGV4dFR5cGUgPT09ICdvYmplY3QnICYmIGNvbnRleHRUeXBlICE9PSBudWxsKSB7CiAgICAgIG5leHRDb250ZXh0ID0gcmVhZENvbnRleHQoY29udGV4dFR5cGUpOwogICAgfSBlbHNlIHsKICAgICAgdmFyIG5leHRVbm1hc2tlZENvbnRleHQgPSBnZXRVbm1hc2tlZENvbnRleHQod29ya0luUHJvZ3Jlc3MsIGN0b3IsIHRydWUpOwogICAgICBuZXh0Q29udGV4dCA9IGdldE1hc2tlZENvbnRleHQod29ya0luUHJvZ3Jlc3MsIG5leHRVbm1hc2tlZENvbnRleHQpOwogICAgfQoKICAgIHZhciBnZXREZXJpdmVkU3RhdGVGcm9tUHJvcHMgPSBjdG9yLmdldERlcml2ZWRTdGF0ZUZyb21Qcm9wczsKICAgIHZhciBoYXNOZXdMaWZlY3ljbGVzID0gdHlwZW9mIGdldERlcml2ZWRTdGF0ZUZyb21Qcm9wcyA9PT0gJ2Z1bmN0aW9uJyB8fCB0eXBlb2YgaW5zdGFuY2UuZ2V0U25hcHNob3RCZWZvcmVVcGRhdGUgPT09ICdmdW5jdGlvbic7IC8vIE5vdGU6IER1cmluZyB0aGVzZSBsaWZlLWN5Y2xlcywgaW5zdGFuY2UucHJvcHMvaW5zdGFuY2Uuc3RhdGUgYXJlIHdoYXQKICAgIC8vIGV2ZXIgdGhlIHByZXZpb3VzbHkgYXR0ZW1wdGVkIHRvIHJlbmRlciAtIG5vdCB0aGUgImN1cnJlbnQiLiBIb3dldmVyLAogICAgLy8gZHVyaW5nIGNvbXBvbmVudERpZFVwZGF0ZSB3ZSBwYXNzIHRoZSAiY3VycmVudCIgcHJvcHMuCiAgICAvLyBJbiBvcmRlciB0byBzdXBwb3J0IHJlYWN0LWxpZmVjeWNsZXMtY29tcGF0IHBvbHlmaWxsZWQgY29tcG9uZW50cywKICAgIC8vIFVuc2FmZSBsaWZlY3ljbGVzIHNob3VsZCBub3QgYmUgaW52b2tlZCBmb3IgY29tcG9uZW50cyB1c2luZyB0aGUgbmV3IEFQSXMuCgogICAgaWYgKCFoYXNOZXdMaWZlY3ljbGVzICYmICh0eXBlb2YgaW5zdGFuY2UuVU5TQUZFX2NvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMgPT09ICdmdW5jdGlvbicgfHwgdHlwZW9mIGluc3RhbmNlLmNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMgPT09ICdmdW5jdGlvbicpKSB7CiAgICAgIGlmICh1bnJlc29sdmVkT2xkUHJvcHMgIT09IHVucmVzb2x2ZWROZXdQcm9wcyB8fCBvbGRDb250ZXh0ICE9PSBuZXh0Q29udGV4dCkgewogICAgICAgIGNhbGxDb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKHdvcmtJblByb2dyZXNzLCBpbnN0YW5jZSwgbmV3UHJvcHMsIG5leHRDb250ZXh0KTsKICAgICAgfQogICAgfQoKICAgIHJlc2V0SGFzRm9yY2VVcGRhdGVCZWZvcmVQcm9jZXNzaW5nKCk7CiAgICB2YXIgb2xkU3RhdGUgPSB3b3JrSW5Qcm9ncmVzcy5tZW1vaXplZFN0YXRlOwogICAgdmFyIG5ld1N0YXRlID0gaW5zdGFuY2Uuc3RhdGUgPSBvbGRTdGF0ZTsKICAgIHByb2Nlc3NVcGRhdGVRdWV1ZSh3b3JrSW5Qcm9ncmVzcywgbmV3UHJvcHMsIGluc3RhbmNlLCByZW5kZXJMYW5lcyk7CiAgICBuZXdTdGF0ZSA9IHdvcmtJblByb2dyZXNzLm1lbW9pemVkU3RhdGU7CgogICAgaWYgKHVucmVzb2x2ZWRPbGRQcm9wcyA9PT0gdW5yZXNvbHZlZE5ld1Byb3BzICYmIG9sZFN0YXRlID09PSBuZXdTdGF0ZSAmJiAhaGFzQ29udGV4dENoYW5nZWQoKSAmJiAhY2hlY2tIYXNGb3JjZVVwZGF0ZUFmdGVyUHJvY2Vzc2luZygpICYmICEoZW5hYmxlTGF6eUNvbnRleHRQcm9wYWdhdGlvbiAgICkpIHsKICAgICAgLy8gSWYgYW4gdXBkYXRlIHdhcyBhbHJlYWR5IGluIHByb2dyZXNzLCB3ZSBzaG91bGQgc2NoZWR1bGUgYW4gVXBkYXRlCiAgICAgIC8vIGVmZmVjdCBldmVuIHRob3VnaCB3ZSdyZSBiYWlsaW5nIG91dCwgc28gdGhhdCBjV1UvY0RVIGFyZSBjYWxsZWQuCiAgICAgIGlmICh0eXBlb2YgaW5zdGFuY2UuY29tcG9uZW50RGlkVXBkYXRlID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgaWYgKHVucmVzb2x2ZWRPbGRQcm9wcyAhPT0gY3VycmVudC5tZW1vaXplZFByb3BzIHx8IG9sZFN0YXRlICE9PSBjdXJyZW50Lm1lbW9pemVkU3RhdGUpIHsKICAgICAgICAgIHdvcmtJblByb2dyZXNzLmZsYWdzIHw9IFVwZGF0ZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICh0eXBlb2YgaW5zdGFuY2UuZ2V0U25hcHNob3RCZWZvcmVVcGRhdGUgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICBpZiAodW5yZXNvbHZlZE9sZFByb3BzICE9PSBjdXJyZW50Lm1lbW9pemVkUHJvcHMgfHwgb2xkU3RhdGUgIT09IGN1cnJlbnQubWVtb2l6ZWRTdGF0ZSkgewogICAgICAgICAgd29ya0luUHJvZ3Jlc3MuZmxhZ3MgfD0gU25hcHNob3Q7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgaWYgKHR5cGVvZiBnZXREZXJpdmVkU3RhdGVGcm9tUHJvcHMgPT09ICdmdW5jdGlvbicpIHsKICAgICAgYXBwbHlEZXJpdmVkU3RhdGVGcm9tUHJvcHMod29ya0luUHJvZ3Jlc3MsIGN0b3IsIGdldERlcml2ZWRTdGF0ZUZyb21Qcm9wcywgbmV3UHJvcHMpOwogICAgICBuZXdTdGF0ZSA9IHdvcmtJblByb2dyZXNzLm1lbW9pemVkU3RhdGU7CiAgICB9CgogICAgdmFyIHNob3VsZFVwZGF0ZSA9IGNoZWNrSGFzRm9yY2VVcGRhdGVBZnRlclByb2Nlc3NpbmcoKSB8fCBjaGVja1Nob3VsZENvbXBvbmVudFVwZGF0ZSh3b3JrSW5Qcm9ncmVzcywgY3Rvciwgb2xkUHJvcHMsIG5ld1Byb3BzLCBvbGRTdGF0ZSwgbmV3U3RhdGUsIG5leHRDb250ZXh0KSB8fCAvLyBUT0RPOiBJbiBzb21lIGNhc2VzLCB3ZSdsbCBlbmQgdXAgY2hlY2tpbmcgaWYgY29udGV4dCBoYXMgY2hhbmdlZCB0d2ljZSwKICAgIC8vIGJvdGggYmVmb3JlIGFuZCBhZnRlciBgc2hvdWxkQ29tcG9uZW50VXBkYXRlYCBoYXMgYmVlbiBjYWxsZWQuIE5vdCBpZGVhbCwKICAgIC8vIGJ1dCBJJ20gbG9hdGggdG8gcmVmYWN0b3IgdGhpcyBmdW5jdGlvbi4gVGhpcyBvbmx5IGhhcHBlbnMgZm9yIG1lbW9pemVkCiAgICAvLyBjb21wb25lbnRzIHNvIGl0J3Mgbm90IHRoYXQgY29tbW9uLgogICAgZW5hYmxlTGF6eUNvbnRleHRQcm9wYWdhdGlvbiAgIDsKCiAgICBpZiAoc2hvdWxkVXBkYXRlKSB7CiAgICAgIC8vIEluIG9yZGVyIHRvIHN1cHBvcnQgcmVhY3QtbGlmZWN5Y2xlcy1jb21wYXQgcG9seWZpbGxlZCBjb21wb25lbnRzLAogICAgICAvLyBVbnNhZmUgbGlmZWN5Y2xlcyBzaG91bGQgbm90IGJlIGludm9rZWQgZm9yIGNvbXBvbmVudHMgdXNpbmcgdGhlIG5ldyBBUElzLgogICAgICBpZiAoIWhhc05ld0xpZmVjeWNsZXMgJiYgKHR5cGVvZiBpbnN0YW5jZS5VTlNBRkVfY29tcG9uZW50V2lsbFVwZGF0ZSA9PT0gJ2Z1bmN0aW9uJyB8fCB0eXBlb2YgaW5zdGFuY2UuY29tcG9uZW50V2lsbFVwZGF0ZSA9PT0gJ2Z1bmN0aW9uJykpIHsKICAgICAgICBpZiAodHlwZW9mIGluc3RhbmNlLmNvbXBvbmVudFdpbGxVcGRhdGUgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgIGluc3RhbmNlLmNvbXBvbmVudFdpbGxVcGRhdGUobmV3UHJvcHMsIG5ld1N0YXRlLCBuZXh0Q29udGV4dCk7CiAgICAgICAgfQoKICAgICAgICBpZiAodHlwZW9mIGluc3RhbmNlLlVOU0FGRV9jb21wb25lbnRXaWxsVXBkYXRlID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICBpbnN0YW5jZS5VTlNBRkVfY29tcG9uZW50V2lsbFVwZGF0ZShuZXdQcm9wcywgbmV3U3RhdGUsIG5leHRDb250ZXh0KTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICh0eXBlb2YgaW5zdGFuY2UuY29tcG9uZW50RGlkVXBkYXRlID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgd29ya0luUHJvZ3Jlc3MuZmxhZ3MgfD0gVXBkYXRlOwogICAgICB9CgogICAgICBpZiAodHlwZW9mIGluc3RhbmNlLmdldFNuYXBzaG90QmVmb3JlVXBkYXRlID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgd29ya0luUHJvZ3Jlc3MuZmxhZ3MgfD0gU25hcHNob3Q7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIC8vIElmIGFuIHVwZGF0ZSB3YXMgYWxyZWFkeSBpbiBwcm9ncmVzcywgd2Ugc2hvdWxkIHNjaGVkdWxlIGFuIFVwZGF0ZQogICAgICAvLyBlZmZlY3QgZXZlbiB0aG91Z2ggd2UncmUgYmFpbGluZyBvdXQsIHNvIHRoYXQgY1dVL2NEVSBhcmUgY2FsbGVkLgogICAgICBpZiAodHlwZW9mIGluc3RhbmNlLmNvbXBvbmVudERpZFVwZGF0ZSA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIGlmICh1bnJlc29sdmVkT2xkUHJvcHMgIT09IGN1cnJlbnQubWVtb2l6ZWRQcm9wcyB8fCBvbGRTdGF0ZSAhPT0gY3VycmVudC5tZW1vaXplZFN0YXRlKSB7CiAgICAgICAgICB3b3JrSW5Qcm9ncmVzcy5mbGFncyB8PSBVcGRhdGU7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAodHlwZW9mIGluc3RhbmNlLmdldFNuYXBzaG90QmVmb3JlVXBkYXRlID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgaWYgKHVucmVzb2x2ZWRPbGRQcm9wcyAhPT0gY3VycmVudC5tZW1vaXplZFByb3BzIHx8IG9sZFN0YXRlICE9PSBjdXJyZW50Lm1lbW9pemVkU3RhdGUpIHsKICAgICAgICAgIHdvcmtJblByb2dyZXNzLmZsYWdzIHw9IFNuYXBzaG90OwogICAgICAgIH0KICAgICAgfSAvLyBJZiBzaG91bGRDb21wb25lbnRVcGRhdGUgcmV0dXJuZWQgZmFsc2UsIHdlIHNob3VsZCBzdGlsbCB1cGRhdGUgdGhlCiAgICAgIC8vIG1lbW9pemVkIHByb3BzL3N0YXRlIHRvIGluZGljYXRlIHRoYXQgdGhpcyB3b3JrIGNhbiBiZSByZXVzZWQuCgoKICAgICAgd29ya0luUHJvZ3Jlc3MubWVtb2l6ZWRQcm9wcyA9IG5ld1Byb3BzOwogICAgICB3b3JrSW5Qcm9ncmVzcy5tZW1vaXplZFN0YXRlID0gbmV3U3RhdGU7CiAgICB9IC8vIFVwZGF0ZSB0aGUgZXhpc3RpbmcgaW5zdGFuY2UncyBzdGF0ZSwgcHJvcHMsIGFuZCBjb250ZXh0IHBvaW50ZXJzIGV2ZW4KICAgIC8vIGlmIHNob3VsZENvbXBvbmVudFVwZGF0ZSByZXR1cm5zIGZhbHNlLgoKCiAgICBpbnN0YW5jZS5wcm9wcyA9IG5ld1Byb3BzOwogICAgaW5zdGFuY2Uuc3RhdGUgPSBuZXdTdGF0ZTsKICAgIGluc3RhbmNlLmNvbnRleHQgPSBuZXh0Q29udGV4dDsKICAgIHJldHVybiBzaG91bGRVcGRhdGU7CiAgfQoKICBmdW5jdGlvbiBjcmVhdGVDYXB0dXJlZFZhbHVlQXRGaWJlcih2YWx1ZSwgc291cmNlKSB7CiAgICAvLyBJZiB0aGUgdmFsdWUgaXMgYW4gZXJyb3IsIGNhbGwgdGhpcyBmdW5jdGlvbiBpbW1lZGlhdGVseSBhZnRlciBpdCBpcyB0aHJvd24KICAgIC8vIHNvIHRoZSBzdGFjayBpcyBhY2N1cmF0ZS4KICAgIHJldHVybiB7CiAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgc291cmNlOiBzb3VyY2UsCiAgICAgIHN0YWNrOiBnZXRTdGFja0J5RmliZXJJbkRldkFuZFByb2Qoc291cmNlKSwKICAgICAgZGlnZXN0OiBudWxsCiAgICB9OwogIH0KICBmdW5jdGlvbiBjcmVhdGVDYXB0dXJlZFZhbHVlKHZhbHVlLCBkaWdlc3QsIHN0YWNrKSB7CiAgICByZXR1cm4gewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIHNvdXJjZTogbnVsbCwKICAgICAgc3RhY2s6IHN0YWNrICE9IG51bGwgPyBzdGFjayA6IG51bGwsCiAgICAgIGRpZ2VzdDogZGlnZXN0ICE9IG51bGwgPyBkaWdlc3QgOiBudWxsCiAgICB9OwogIH0KCiAgLy8gVGhpcyBtb2R1bGUgaXMgZm9ya2VkIGluIGRpZmZlcmVudCBlbnZpcm9ubWVudHMuCiAgLy8gQnkgZGVmYXVsdCwgcmV0dXJuIGB0cnVlYCB0byBsb2cgZXJyb3JzIHRvIHRoZSBjb25zb2xlLgogIC8vIEZvcmtzIGNhbiByZXR1cm4gYGZhbHNlYCBpZiB0aGlzIGlzbid0IGRlc2lyYWJsZS4KICBmdW5jdGlvbiBzaG93RXJyb3JEaWFsb2coYm91bmRhcnksIGVycm9ySW5mbykgewogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiBsb2dDYXB0dXJlZEVycm9yKGJvdW5kYXJ5LCBlcnJvckluZm8pIHsKICAgIHRyeSB7CiAgICAgIHZhciBsb2dFcnJvciA9IHNob3dFcnJvckRpYWxvZyhib3VuZGFyeSwgZXJyb3JJbmZvKTsgLy8gQWxsb3cgaW5qZWN0ZWQgc2hvd0Vycm9yRGlhbG9nKCkgdG8gcHJldmVudCBkZWZhdWx0IGNvbnNvbGUuZXJyb3IgbG9nZ2luZy4KICAgICAgLy8gVGhpcyBlbmFibGVzIHJlbmRlcmVycyBsaWtlIFJlYWN0TmF0aXZlIHRvIGJldHRlciBtYW5hZ2UgcmVkYm94IGJlaGF2aW9yLgoKICAgICAgaWYgKGxvZ0Vycm9yID09PSBmYWxzZSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGVycm9yID0gZXJyb3JJbmZvLnZhbHVlOwoKICAgICAgaWYgKHRydWUpIHsKICAgICAgICB2YXIgc291cmNlID0gZXJyb3JJbmZvLnNvdXJjZTsKICAgICAgICB2YXIgc3RhY2sgPSBlcnJvckluZm8uc3RhY2s7CiAgICAgICAgdmFyIGNvbXBvbmVudFN0YWNrID0gc3RhY2sgIT09IG51bGwgPyBzdGFjayA6ICcnOyAvLyBCcm93c2VycyBzdXBwb3J0IHNpbGVuY2luZyB1bmNhdWdodCBlcnJvcnMgYnkgY2FsbGluZwogICAgICAgIC8vIGBwcmV2ZW50RGVmYXVsdCgpYCBpbiB3aW5kb3cgYGVycm9yYCBoYW5kbGVyLgogICAgICAgIC8vIFdlIHJlY29yZCB0aGlzIGluZm9ybWF0aW9uIGFzIGFuIGV4cGFuZG8gb24gdGhlIGVycm9yLgoKICAgICAgICBpZiAoZXJyb3IgIT0gbnVsbCAmJiBlcnJvci5fc3VwcHJlc3NMb2dnaW5nKSB7CiAgICAgICAgICBpZiAoYm91bmRhcnkudGFnID09PSBDbGFzc0NvbXBvbmVudCkgewogICAgICAgICAgICAvLyBUaGUgZXJyb3IgaXMgcmVjb3ZlcmFibGUgYW5kIHdhcyBzaWxlbmNlZC4KICAgICAgICAgICAgLy8gSWdub3JlIGl0IGFuZCBkb24ndCBwcmludCB0aGUgc3RhY2sgYWRkZW5kdW0uCiAgICAgICAgICAgIC8vIFRoaXMgaXMgaGFuZHkgZm9yIHRlc3RpbmcgZXJyb3IgYm91bmRhcmllcyB3aXRob3V0IG5vaXNlLgogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9IC8vIFRoZSBlcnJvciBpcyBmYXRhbC4gU2luY2UgdGhlIHNpbGVuY2luZyBtaWdodCBoYXZlCiAgICAgICAgICAvLyBiZWVuIGFjY2lkZW50YWwsIHdlJ2xsIHN1cmZhY2UgaXQgYW55d2F5LgogICAgICAgICAgLy8gSG93ZXZlciwgdGhlIGJyb3dzZXIgd291bGQgaGF2ZSBzaWxlbmNlZCB0aGUgb3JpZ2luYWwgZXJyb3IKICAgICAgICAgIC8vIHNvIHdlJ2xsIHByaW50IGl0IGZpcnN0LCBhbmQgdGhlbiBwcmludCB0aGUgc3RhY2sgYWRkZW5kdW0uCgoKICAgICAgICAgIGNvbnNvbGVbJ2Vycm9yJ10oZXJyb3IpOyAvLyBEb24ndCB0cmFuc2Zvcm0gdG8gb3VyIHdyYXBwZXIKICAgICAgICAgIC8vIEZvciBhIG1vcmUgZGV0YWlsZWQgZGVzY3JpcHRpb24gb2YgdGhpcyBibG9jaywgc2VlOgogICAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL3JlYWN0L3B1bGwvMTMzODQKICAgICAgICB9CgogICAgICAgIHZhciBjb21wb25lbnROYW1lID0gc291cmNlID8gZ2V0Q29tcG9uZW50TmFtZUZyb21GaWJlcihzb3VyY2UpIDogbnVsbDsKICAgICAgICB2YXIgY29tcG9uZW50TmFtZU1lc3NhZ2UgPSBjb21wb25lbnROYW1lID8gIlRoZSBhYm92ZSBlcnJvciBvY2N1cnJlZCBpbiB0aGUgPCIgKyBjb21wb25lbnROYW1lICsgIj4gY29tcG9uZW50OiIgOiAnVGhlIGFib3ZlIGVycm9yIG9jY3VycmVkIGluIG9uZSBvZiB5b3VyIFJlYWN0IGNvbXBvbmVudHM6JzsKICAgICAgICB2YXIgZXJyb3JCb3VuZGFyeU1lc3NhZ2U7CgogICAgICAgIGlmIChib3VuZGFyeS50YWcgPT09IEhvc3RSb290KSB7CiAgICAgICAgICBlcnJvckJvdW5kYXJ5TWVzc2FnZSA9ICdDb25zaWRlciBhZGRpbmcgYW4gZXJyb3IgYm91bmRhcnkgdG8geW91ciB0cmVlIHRvIGN1c3RvbWl6ZSBlcnJvciBoYW5kbGluZyBiZWhhdmlvci5cbicgKyAnVmlzaXQgaHR0cHM6Ly9yZWFjdGpzLm9yZy9saW5rL2Vycm9yLWJvdW5kYXJpZXMgdG8gbGVhcm4gbW9yZSBhYm91dCBlcnJvciBib3VuZGFyaWVzLic7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHZhciBlcnJvckJvdW5kYXJ5TmFtZSA9IGdldENvbXBvbmVudE5hbWVGcm9tRmliZXIoYm91bmRhcnkpIHx8ICdBbm9ueW1vdXMnOwogICAgICAgICAgZXJyb3JCb3VuZGFyeU1lc3NhZ2UgPSAiUmVhY3Qgd2lsbCB0cnkgdG8gcmVjcmVhdGUgdGhpcyBjb21wb25lbnQgdHJlZSBmcm9tIHNjcmF0Y2ggIiArICgidXNpbmcgdGhlIGVycm9yIGJvdW5kYXJ5IHlvdSBwcm92aWRlZCwgIiArIGVycm9yQm91bmRhcnlOYW1lICsgIi4iKTsKICAgICAgICB9CgogICAgICAgIHZhciBjb21iaW5lZE1lc3NhZ2UgPSBjb21wb25lbnROYW1lTWVzc2FnZSArICJcbiIgKyBjb21wb25lbnRTdGFjayArICJcblxuIiArICgiIiArIGVycm9yQm91bmRhcnlNZXNzYWdlKTsgLy8gSW4gZGV2ZWxvcG1lbnQsIHdlIHByb3ZpZGUgb3VyIG93biBtZXNzYWdlIHdpdGgganVzdCB0aGUgY29tcG9uZW50IHN0YWNrLgogICAgICAgIC8vIFdlIGRvbid0IGluY2x1ZGUgdGhlIG9yaWdpbmFsIGVycm9yIG1lc3NhZ2UgYW5kIEpTIHN0YWNrIGJlY2F1c2UgdGhlIGJyb3dzZXIKICAgICAgICAvLyBoYXMgYWxyZWFkeSBwcmludGVkIGl0LiBFdmVuIGlmIHRoZSBhcHBsaWNhdGlvbiBzd2FsbG93cyB0aGUgZXJyb3IsIGl0IGlzIHN0aWxsCiAgICAgICAgLy8gZGlzcGxheWVkIGJ5IHRoZSBicm93c2VyIHRoYW5rcyB0byB0aGUgREVWLW9ubHkgZmFrZSBldmVudCB0cmljayBpbiBSZWFjdEVycm9yVXRpbHMuCgogICAgICAgIGNvbnNvbGVbJ2Vycm9yJ10oY29tYmluZWRNZXNzYWdlKTsgLy8gRG9uJ3QgdHJhbnNmb3JtIHRvIG91ciB3cmFwcGVyCiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gSW4gcHJvZHVjdGlvbiwgd2UgcHJpbnQgdGhlIGVycm9yIGRpcmVjdGx5LgogICAgICAgIC8vIFRoaXMgd2lsbCBpbmNsdWRlIHRoZSBtZXNzYWdlLCB0aGUgSlMgc3RhY2ssIGFuZCBhbnl0aGluZyB0aGUgYnJvd3NlciB3YW50cyB0byBzaG93LgogICAgICAgIC8vIFdlIHBhc3MgdGhlIGVycm9yIG9iamVjdCBpbnN0ZWFkIG9mIGN1c3RvbSBtZXNzYWdlIHNvIHRoYXQgdGhlIGJyb3dzZXIgZGlzcGxheXMgdGhlIGVycm9yIG5hdGl2ZWx5LgogICAgICAgIGNvbnNvbGVbJ2Vycm9yJ10oZXJyb3IpOyAvLyBEb24ndCB0cmFuc2Zvcm0gdG8gb3VyIHdyYXBwZXIKICAgICAgfQogICAgfSBjYXRjaCAoZSkgewogICAgICAvLyBUaGlzIG1ldGhvZCBtdXN0IG5vdCB0aHJvdywgb3IgUmVhY3QgaW50ZXJuYWwgc3RhdGUgd2lsbCBnZXQgbWVzc2VkIHVwLgogICAgICAvLyBJZiBjb25zb2xlLmVycm9yIGlzIG92ZXJyaWRkZW4sIG9yIGxvZ0NhcHR1cmVkRXJyb3IoKSBzaG93cyBhIGRpYWxvZyB0aGF0IHRocm93cywKICAgICAgLy8gd2Ugd2FudCB0byByZXBvcnQgdGhpcyBlcnJvciBvdXRzaWRlIG9mIHRoZSBub3JtYWwgc3RhY2sgYXMgYSBsYXN0IHJlc29ydC4KICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL3JlYWN0L2lzc3Vlcy8xMzE4OAogICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICB0aHJvdyBlOwogICAgICB9KTsKICAgIH0KICB9CgogIHZhciBQb3NzaWJseVdlYWtNYXAkMSA9IHR5cGVvZiBXZWFrTWFwID09PSAnZnVuY3Rpb24nID8gV2Vha01hcCA6IE1hcDsKCiAgZnVuY3Rpb24gY3JlYXRlUm9vdEVycm9yVXBkYXRlKGZpYmVyLCBlcnJvckluZm8sIGxhbmUpIHsKICAgIHZhciB1cGRhdGUgPSBjcmVhdGVVcGRhdGUoTm9UaW1lc3RhbXAsIGxhbmUpOyAvLyBVbm1vdW50IHRoZSByb290IGJ5IHJlbmRlcmluZyBudWxsLgoKICAgIHVwZGF0ZS50YWcgPSBDYXB0dXJlVXBkYXRlOyAvLyBDYXV0aW9uOiBSZWFjdCBEZXZUb29scyBjdXJyZW50bHkgZGVwZW5kcyBvbiB0aGlzIHByb3BlcnR5CiAgICAvLyBiZWluZyBjYWxsZWQgImVsZW1lbnQiLgoKICAgIHVwZGF0ZS5wYXlsb2FkID0gewogICAgICBlbGVtZW50OiBudWxsCiAgICB9OwogICAgdmFyIGVycm9yID0gZXJyb3JJbmZvLnZhbHVlOwoKICAgIHVwZGF0ZS5jYWxsYmFjayA9IGZ1bmN0aW9uICgpIHsKICAgICAgb25VbmNhdWdodEVycm9yKGVycm9yKTsKICAgICAgbG9nQ2FwdHVyZWRFcnJvcihmaWJlciwgZXJyb3JJbmZvKTsKICAgIH07CgogICAgcmV0dXJuIHVwZGF0ZTsKICB9CgogIGZ1bmN0aW9uIGNyZWF0ZUNsYXNzRXJyb3JVcGRhdGUoZmliZXIsIGVycm9ySW5mbywgbGFuZSkgewogICAgdmFyIHVwZGF0ZSA9IGNyZWF0ZVVwZGF0ZShOb1RpbWVzdGFtcCwgbGFuZSk7CiAgICB1cGRhdGUudGFnID0gQ2FwdHVyZVVwZGF0ZTsKICAgIHZhciBnZXREZXJpdmVkU3RhdGVGcm9tRXJyb3IgPSBmaWJlci50eXBlLmdldERlcml2ZWRTdGF0ZUZyb21FcnJvcjsKCiAgICBpZiAodHlwZW9mIGdldERlcml2ZWRTdGF0ZUZyb21FcnJvciA9PT0gJ2Z1bmN0aW9uJykgewogICAgICB2YXIgZXJyb3IkMSA9IGVycm9ySW5mby52YWx1ZTsKCiAgICAgIHVwZGF0ZS5wYXlsb2FkID0gZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBnZXREZXJpdmVkU3RhdGVGcm9tRXJyb3IoZXJyb3IkMSk7CiAgICAgIH07CgogICAgICB1cGRhdGUuY2FsbGJhY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgewogICAgICAgICAgbWFya0ZhaWxlZEVycm9yQm91bmRhcnlGb3JIb3RSZWxvYWRpbmcoZmliZXIpOwogICAgICAgIH0KCiAgICAgICAgbG9nQ2FwdHVyZWRFcnJvcihmaWJlciwgZXJyb3JJbmZvKTsKICAgICAgfTsKICAgIH0KCiAgICB2YXIgaW5zdCA9IGZpYmVyLnN0YXRlTm9kZTsKCiAgICBpZiAoaW5zdCAhPT0gbnVsbCAmJiB0eXBlb2YgaW5zdC5jb21wb25lbnREaWRDYXRjaCA9PT0gJ2Z1bmN0aW9uJykgewogICAgICB1cGRhdGUuY2FsbGJhY2sgPSBmdW5jdGlvbiBjYWxsYmFjaygpIHsKICAgICAgICB7CiAgICAgICAgICBtYXJrRmFpbGVkRXJyb3JCb3VuZGFyeUZvckhvdFJlbG9hZGluZyhmaWJlcik7CiAgICAgICAgfQoKICAgICAgICBsb2dDYXB0dXJlZEVycm9yKGZpYmVyLCBlcnJvckluZm8pOwoKICAgICAgICBpZiAodHlwZW9mIGdldERlcml2ZWRTdGF0ZUZyb21FcnJvciAhPT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgLy8gVG8gcHJlc2VydmUgdGhlIHByZWV4aXN0aW5nIHJldHJ5IGJlaGF2aW9yIG9mIGVycm9yIGJvdW5kYXJpZXMsCiAgICAgICAgICAvLyB3ZSBrZWVwIHRyYWNrIG9mIHdoaWNoIG9uZXMgYWxyZWFkeSBmYWlsZWQgZHVyaW5nIHRoaXMgYmF0Y2guCiAgICAgICAgICAvLyBUaGlzIGdldHMgcmVzZXQgYmVmb3JlIHdlIHlpZWxkIGJhY2sgdG8gdGhlIGJyb3dzZXIuCiAgICAgICAgICAvLyBUT0RPOiBXYXJuIGluIHN0cmljdCBtb2RlIGlmIGdldERlcml2ZWRTdGF0ZUZyb21FcnJvciBpcwogICAgICAgICAgLy8gbm90IGRlZmluZWQuCiAgICAgICAgICBtYXJrTGVnYWN5RXJyb3JCb3VuZGFyeUFzRmFpbGVkKHRoaXMpOwogICAgICAgIH0KCiAgICAgICAgdmFyIGVycm9yJDEgPSBlcnJvckluZm8udmFsdWU7CiAgICAgICAgdmFyIHN0YWNrID0gZXJyb3JJbmZvLnN0YWNrOwogICAgICAgIHRoaXMuY29tcG9uZW50RGlkQ2F0Y2goZXJyb3IkMSwgewogICAgICAgICAgY29tcG9uZW50U3RhY2s6IHN0YWNrICE9PSBudWxsID8gc3RhY2sgOiAnJwogICAgICAgIH0pOwoKICAgICAgICB7CiAgICAgICAgICBpZiAodHlwZW9mIGdldERlcml2ZWRTdGF0ZUZyb21FcnJvciAhPT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgICAvLyBJZiBjb21wb25lbnREaWRDYXRjaCBpcyB0aGUgb25seSBlcnJvciBib3VuZGFyeSBtZXRob2QgZGVmaW5lZCwKICAgICAgICAgICAgLy8gdGhlbiBpdCBuZWVkcyB0byBjYWxsIHNldFN0YXRlIHRvIHJlY292ZXIgZnJvbSBlcnJvcnMuCiAgICAgICAgICAgIC8vIElmIG5vIHN0YXRlIHVwZGF0ZSBpcyBzY2hlZHVsZWQgdGhlbiB0aGUgYm91bmRhcnkgd2lsbCBzd2FsbG93IHRoZSBlcnJvci4KICAgICAgICAgICAgaWYgKCFpbmNsdWRlc1NvbWVMYW5lKGZpYmVyLmxhbmVzLCBTeW5jTGFuZSkpIHsKICAgICAgICAgICAgICBlcnJvcignJXM6IEVycm9yIGJvdW5kYXJpZXMgc2hvdWxkIGltcGxlbWVudCBnZXREZXJpdmVkU3RhdGVGcm9tRXJyb3IoKS4gJyArICdJbiB0aGF0IG1ldGhvZCwgcmV0dXJuIGEgc3RhdGUgdXBkYXRlIHRvIGRpc3BsYXkgYW4gZXJyb3IgbWVzc2FnZSBvciBmYWxsYmFjayBVSS4nLCBnZXRDb21wb25lbnROYW1lRnJvbUZpYmVyKGZpYmVyKSB8fCAnVW5rbm93bicpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9OwogICAgfQoKICAgIHJldHVybiB1cGRhdGU7CiAgfQoKICBmdW5jdGlvbiBhdHRhY2hQaW5nTGlzdGVuZXIocm9vdCwgd2FrZWFibGUsIGxhbmVzKSB7CiAgICAvLyBBdHRhY2ggYSBwaW5nIGxpc3RlbmVyCiAgICAvLwogICAgLy8gVGhlIGRhdGEgbWlnaHQgcmVzb2x2ZSBiZWZvcmUgd2UgaGF2ZSBhIGNoYW5jZSB0byBjb21taXQgdGhlIGZhbGxiYWNrLiBPciwKICAgIC8vIGluIHRoZSBjYXNlIG9mIGEgcmVmcmVzaCwgd2UnbGwgbmV2ZXIgY29tbWl0IGEgZmFsbGJhY2suIFNvIHdlIG5lZWQgdG8KICAgIC8vIGF0dGFjaCBhIGxpc3RlbmVyIG5vdy4gV2hlbiBpdCByZXNvbHZlcyAoInBpbmdzIiksIHdlIGNhbiBkZWNpZGUgd2hldGhlciB0bwogICAgLy8gdHJ5IHJlbmRlcmluZyB0aGUgdHJlZSBhZ2Fpbi4KICAgIC8vCiAgICAvLyBPbmx5IGF0dGFjaCBhIGxpc3RlbmVyIGlmIG9uZSBkb2VzIG5vdCBhbHJlYWR5IGV4aXN0IGZvciB0aGUgbGFuZXMKICAgIC8vIHdlJ3JlIGN1cnJlbnRseSByZW5kZXJpbmcgKHdoaWNoIGFjdHMgbGlrZSBhICJ0aHJlYWQgSUQiIGhlcmUpLgogICAgLy8KICAgIC8vIFdlIG9ubHkgbmVlZCB0byBkbyB0aGlzIGluIGNvbmN1cnJlbnQgbW9kZS4gTGVnYWN5IFN1c3BlbnNlIGFsd2F5cwogICAgLy8gY29tbWl0cyBmYWxsYmFja3Mgc3luY2hyb25vdXNseSwgc28gdGhlcmUgYXJlIG5vIHBpbmdzLgogICAgdmFyIHBpbmdDYWNoZSA9IHJvb3QucGluZ0NhY2hlOwogICAgdmFyIHRocmVhZElEczsKCiAgICBpZiAocGluZ0NhY2hlID09PSBudWxsKSB7CiAgICAgIHBpbmdDYWNoZSA9IHJvb3QucGluZ0NhY2hlID0gbmV3IFBvc3NpYmx5V2Vha01hcCQxKCk7CiAgICAgIHRocmVhZElEcyA9IG5ldyBTZXQoKTsKICAgICAgcGluZ0NhY2hlLnNldCh3YWtlYWJsZSwgdGhyZWFkSURzKTsKICAgIH0gZWxzZSB7CiAgICAgIHRocmVhZElEcyA9IHBpbmdDYWNoZS5nZXQod2FrZWFibGUpOwoKICAgICAgaWYgKHRocmVhZElEcyA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgdGhyZWFkSURzID0gbmV3IFNldCgpOwogICAgICAgIHBpbmdDYWNoZS5zZXQod2FrZWFibGUsIHRocmVhZElEcyk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoIXRocmVhZElEcy5oYXMobGFuZXMpKSB7CiAgICAgIC8vIE1lbW9pemUgdXNpbmcgdGhlIHRocmVhZCBJRCB0byBwcmV2ZW50IHJlZHVuZGFudCBsaXN0ZW5lcnMuCiAgICAgIHRocmVhZElEcy5hZGQobGFuZXMpOwogICAgICB2YXIgcGluZyA9IHBpbmdTdXNwZW5kZWRSb290LmJpbmQobnVsbCwgcm9vdCwgd2FrZWFibGUsIGxhbmVzKTsKCiAgICAgIHsKICAgICAgICBpZiAoaXNEZXZUb29sc1ByZXNlbnQpIHsKICAgICAgICAgIC8vIElmIHdlIGhhdmUgcGVuZGluZyB3b3JrIHN0aWxsLCByZXN0b3JlIHRoZSBvcmlnaW5hbCB1cGRhdGVycwogICAgICAgICAgcmVzdG9yZVBlbmRpbmdVcGRhdGVycyhyb290LCBsYW5lcyk7CiAgICAgICAgfQogICAgICB9CgogICAgICB3YWtlYWJsZS50aGVuKHBpbmcsIHBpbmcpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gYXR0YWNoUmV0cnlMaXN0ZW5lcihzdXNwZW5zZUJvdW5kYXJ5LCByb290LCB3YWtlYWJsZSwgbGFuZXMpIHsKICAgIC8vIFJldHJ5IGxpc3RlbmVyCiAgICAvLwogICAgLy8gSWYgdGhlIGZhbGxiYWNrIGRvZXMgY29tbWl0LCB3ZSBuZWVkIHRvIGF0dGFjaCBhIGRpZmZlcmVudCB0eXBlIG9mCiAgICAvLyBsaXN0ZW5lci4gVGhpcyBvbmUgc2NoZWR1bGVzIGFuIHVwZGF0ZSBvbiB0aGUgU3VzcGVuc2UgYm91bmRhcnkgdG8gdHVybgogICAgLy8gdGhlIGZhbGxiYWNrIHN0YXRlIG9mZi4KICAgIC8vCiAgICAvLyBTdGFzaCB0aGUgd2FrZWFibGUgb24gdGhlIGJvdW5kYXJ5IGZpYmVyIHNvIHdlIGNhbiBhY2Nlc3MgaXQgaW4gdGhlCiAgICAvLyBjb21taXQgcGhhc2UuCiAgICAvLwogICAgLy8gV2hlbiB0aGUgd2FrZWFibGUgcmVzb2x2ZXMsIHdlJ2xsIGF0dGVtcHQgdG8gcmVuZGVyIHRoZSBib3VuZGFyeQogICAgLy8gYWdhaW4gKCJyZXRyeSIpLgogICAgdmFyIHdha2VhYmxlcyA9IHN1c3BlbnNlQm91bmRhcnkudXBkYXRlUXVldWU7CgogICAgaWYgKHdha2VhYmxlcyA9PT0gbnVsbCkgewogICAgICB2YXIgdXBkYXRlUXVldWUgPSBuZXcgU2V0KCk7CiAgICAgIHVwZGF0ZVF1ZXVlLmFkZCh3YWtlYWJsZSk7CiAgICAgIHN1c3BlbnNlQm91bmRhcnkudXBkYXRlUXVldWUgPSB1cGRhdGVRdWV1ZTsKICAgIH0gZWxzZSB7CiAgICAgIHdha2VhYmxlcy5hZGQod2FrZWFibGUpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gcmVzZXRTdXNwZW5kZWRDb21wb25lbnQoc291cmNlRmliZXIsIHJvb3RSZW5kZXJMYW5lcykgewogICAgLy8gQSBsZWdhY3kgbW9kZSBTdXNwZW5zZSBxdWlyaywgb25seSByZWxldmFudCB0byBob29rIGNvbXBvbmVudHMuCgoKICAgIHZhciB0YWcgPSBzb3VyY2VGaWJlci50YWc7CgogICAgaWYgKChzb3VyY2VGaWJlci5tb2RlICYgQ29uY3VycmVudE1vZGUpID09PSBOb01vZGUgJiYgKHRhZyA9PT0gRnVuY3Rpb25Db21wb25lbnQgfHwgdGFnID09PSBGb3J3YXJkUmVmIHx8IHRhZyA9PT0gU2ltcGxlTWVtb0NvbXBvbmVudCkpIHsKICAgICAgdmFyIGN1cnJlbnRTb3VyY2UgPSBzb3VyY2VGaWJlci5hbHRlcm5hdGU7CgogICAgICBpZiAoY3VycmVudFNvdXJjZSkgewogICAgICAgIHNvdXJjZUZpYmVyLnVwZGF0ZVF1ZXVlID0gY3VycmVudFNvdXJjZS51cGRhdGVRdWV1ZTsKICAgICAgICBzb3VyY2VGaWJlci5tZW1vaXplZFN0YXRlID0gY3VycmVudFNvdXJjZS5tZW1vaXplZFN0YXRlOwogICAgICAgIHNvdXJjZUZpYmVyLmxhbmVzID0gY3VycmVudFNvdXJjZS5sYW5lczsKICAgICAgfSBlbHNlIHsKICAgICAgICBzb3VyY2VGaWJlci51cGRhdGVRdWV1ZSA9IG51bGw7CiAgICAgICAgc291cmNlRmliZXIubWVtb2l6ZWRTdGF0ZSA9IG51bGw7CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIGdldE5lYXJlc3RTdXNwZW5zZUJvdW5kYXJ5VG9DYXB0dXJlKHJldHVybkZpYmVyKSB7CiAgICB2YXIgbm9kZSA9IHJldHVybkZpYmVyOwoKICAgIGRvIHsKICAgICAgaWYgKG5vZGUudGFnID09PSBTdXNwZW5zZUNvbXBvbmVudCAmJiBzaG91bGRDYXB0dXJlU3VzcGVuc2Uobm9kZSkpIHsKICAgICAgICByZXR1cm4gbm9kZTsKICAgICAgfSAvLyBUaGlzIGJvdW5kYXJ5IGFscmVhZHkgY2FwdHVyZWQgZHVyaW5nIHRoaXMgcmVuZGVyLiBDb250aW51ZSB0byB0aGUgbmV4dAogICAgICAvLyBib3VuZGFyeS4KCgogICAgICBub2RlID0gbm9kZS5yZXR1cm47CiAgICB9IHdoaWxlIChub2RlICE9PSBudWxsKTsKCiAgICByZXR1cm4gbnVsbDsKICB9CgogIGZ1bmN0aW9uIG1hcmtTdXNwZW5zZUJvdW5kYXJ5U2hvdWxkQ2FwdHVyZShzdXNwZW5zZUJvdW5kYXJ5LCByZXR1cm5GaWJlciwgc291cmNlRmliZXIsIHJvb3QsIHJvb3RSZW5kZXJMYW5lcykgewogICAgLy8gVGhpcyBtYXJrcyBhIFN1c3BlbnNlIGJvdW5kYXJ5IHNvIHRoYXQgd2hlbiB3ZSdyZSB1bndpbmRpbmcgdGhlIHN0YWNrLAogICAgLy8gaXQgY2FwdHVyZXMgdGhlIHN1c3BlbmRlZCAiZXhjZXB0aW9uIiBhbmQgZG9lcyBhIHNlY29uZCAoZmFsbGJhY2spIHBhc3MuCiAgICBpZiAoKHN1c3BlbnNlQm91bmRhcnkubW9kZSAmIENvbmN1cnJlbnRNb2RlKSA9PT0gTm9Nb2RlKSB7CiAgICAgIC8vIExlZ2FjeSBNb2RlIFN1c3BlbnNlCiAgICAgIC8vCiAgICAgIC8vIElmIHRoZSBib3VuZGFyeSBpcyBpbiBsZWdhY3kgbW9kZSwgd2Ugc2hvdWxkICpub3QqCiAgICAgIC8vIHN1c3BlbmQgdGhlIGNvbW1pdC4gUHJldGVuZCBhcyBpZiB0aGUgc3VzcGVuZGVkIGNvbXBvbmVudCByZW5kZXJlZAogICAgICAvLyBudWxsIGFuZCBrZWVwIHJlbmRlcmluZy4gV2hlbiB0aGUgU3VzcGVuc2UgYm91bmRhcnkgY29tcGxldGVzLAogICAgICAvLyB3ZSdsbCBkbyBhIHNlY29uZCBwYXNzIHRvIHJlbmRlciB0aGUgZmFsbGJhY2suCiAgICAgIGlmIChzdXNwZW5zZUJvdW5kYXJ5ID09PSByZXR1cm5GaWJlcikgewogICAgICAgIC8vIFNwZWNpYWwgY2FzZSB3aGVyZSB3ZSBzdXNwZW5kZWQgd2hpbGUgcmVjb25jaWxpbmcgdGhlIGNoaWxkcmVuIG9mCiAgICAgICAgLy8gYSBTdXNwZW5zZSBib3VuZGFyeSdzIGlubmVyIE9mZnNjcmVlbiB3cmFwcGVyIGZpYmVyLiBUaGlzIGhhcHBlbnMKICAgICAgICAvLyB3aGVuIGEgUmVhY3QubGF6eSBjb21wb25lbnQgaXMgYSBkaXJlY3QgY2hpbGQgb2YgYQogICAgICAgIC8vIFN1c3BlbnNlIGJvdW5kYXJ5LgogICAgICAgIC8vCiAgICAgICAgLy8gU3VzcGVuc2UgYm91bmRhcmllcyBhcmUgaW1wbGVtZW50ZWQgYXMgbXVsdGlwbGUgZmliZXJzLCBidXQgdGhleQogICAgICAgIC8vIGFyZSBhIHNpbmdsZSBjb25jZXB0dWFsIHVuaXQuIFRoZSBsZWdhY3kgbW9kZSBiZWhhdmlvciB3aGVyZSB3ZQogICAgICAgIC8vIHByZXRlbmQgdGhlIHN1c3BlbmRlZCBmaWJlciBjb21taXR0ZWQgYXMgYG51bGxgIHdvbid0IHdvcmssCiAgICAgICAgLy8gYmVjYXVzZSBpbiB0aGlzIGNhc2UgdGhlICJzdXNwZW5kZWQiIGZpYmVyIGlzIHRoZSBpbm5lcgogICAgICAgIC8vIE9mZnNjcmVlbiB3cmFwcGVyLgogICAgICAgIC8vCiAgICAgICAgLy8gQmVjYXVzZSB0aGUgY29udGVudHMgb2YgdGhlIGJvdW5kYXJ5IGhhdmVuJ3Qgc3RhcnRlZCByZW5kZXJpbmcKICAgICAgICAvLyB5ZXQgKGkuZS4gbm90aGluZyBpbiB0aGUgdHJlZSBoYXMgcGFydGlhbGx5IHJlbmRlcmVkKSB3ZSBjYW4KICAgICAgICAvLyBzd2l0Y2ggdG8gdGhlIHJlZ3VsYXIsIGNvbmN1cnJlbnQgbW9kZSBiZWhhdmlvcjogbWFyayB0aGUKICAgICAgICAvLyBib3VuZGFyeSB3aXRoIFNob3VsZENhcHR1cmUgYW5kIGVudGVyIHRoZSB1bndpbmQgcGhhc2UuCiAgICAgICAgc3VzcGVuc2VCb3VuZGFyeS5mbGFncyB8PSBTaG91bGRDYXB0dXJlOwogICAgICB9IGVsc2UgewogICAgICAgIHN1c3BlbnNlQm91bmRhcnkuZmxhZ3MgfD0gRGlkQ2FwdHVyZTsKICAgICAgICBzb3VyY2VGaWJlci5mbGFncyB8PSBGb3JjZVVwZGF0ZUZvckxlZ2FjeVN1c3BlbnNlOyAvLyBXZSdyZSBnb2luZyB0byBjb21taXQgdGhpcyBmaWJlciBldmVuIHRob3VnaCBpdCBkaWRuJ3QgY29tcGxldGUuCiAgICAgICAgLy8gQnV0IHdlIHNob3VsZG4ndCBjYWxsIGFueSBsaWZlY3ljbGUgbWV0aG9kcyBvciBjYWxsYmFja3MuIFJlbW92ZQogICAgICAgIC8vIGFsbCBsaWZlY3ljbGUgZWZmZWN0IHRhZ3MuCgogICAgICAgIHNvdXJjZUZpYmVyLmZsYWdzICY9IH4oTGlmZWN5Y2xlRWZmZWN0TWFzayB8IEluY29tcGxldGUpOwoKICAgICAgICBpZiAoc291cmNlRmliZXIudGFnID09PSBDbGFzc0NvbXBvbmVudCkgewogICAgICAgICAgdmFyIGN1cnJlbnRTb3VyY2VGaWJlciA9IHNvdXJjZUZpYmVyLmFsdGVybmF0ZTsKCiAgICAgICAgICBpZiAoY3VycmVudFNvdXJjZUZpYmVyID09PSBudWxsKSB7CiAgICAgICAgICAgIC8vIFRoaXMgaXMgYSBuZXcgbW91bnQuIENoYW5nZSB0aGUgdGFnIHNvIGl0J3Mgbm90IG1pc3Rha2VuIGZvciBhCiAgICAgICAgICAgIC8vIGNvbXBsZXRlZCBjbGFzcyBjb21wb25lbnQuIEZvciBleGFtcGxlLCB3ZSBzaG91bGQgbm90IGNhbGwKICAgICAgICAgICAgLy8gY29tcG9uZW50V2lsbFVubW91bnQgaWYgaXQgaXMgZGVsZXRlZC4KICAgICAgICAgICAgc291cmNlRmliZXIudGFnID0gSW5jb21wbGV0ZUNsYXNzQ29tcG9uZW50OwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gV2hlbiB3ZSB0cnkgcmVuZGVyaW5nIGFnYWluLCB3ZSBzaG91bGQgbm90IHJldXNlIHRoZSBjdXJyZW50IGZpYmVyLAogICAgICAgICAgICAvLyBzaW5jZSBpdCdzIGtub3duIHRvIGJlIGluIGFuIGluY29uc2lzdGVudCBzdGF0ZS4gVXNlIGEgZm9yY2UgdXBkYXRlIHRvCiAgICAgICAgICAgIC8vIHByZXZlbnQgYSBiYWlsIG91dC4KICAgICAgICAgICAgdmFyIHVwZGF0ZSA9IGNyZWF0ZVVwZGF0ZShOb1RpbWVzdGFtcCwgU3luY0xhbmUpOwogICAgICAgICAgICB1cGRhdGUudGFnID0gRm9yY2VVcGRhdGU7CiAgICAgICAgICAgIGVucXVldWVVcGRhdGUoc291cmNlRmliZXIsIHVwZGF0ZSwgU3luY0xhbmUpOwogICAgICAgICAgfQogICAgICAgIH0gLy8gVGhlIHNvdXJjZSBmaWJlciBkaWQgbm90IGNvbXBsZXRlLiBNYXJrIGl0IHdpdGggU3luYyBwcmlvcml0eSB0bwogICAgICAgIC8vIGluZGljYXRlIHRoYXQgaXQgc3RpbGwgaGFzIHBlbmRpbmcgd29yay4KCgogICAgICAgIHNvdXJjZUZpYmVyLmxhbmVzID0gbWVyZ2VMYW5lcyhzb3VyY2VGaWJlci5sYW5lcywgU3luY0xhbmUpOwogICAgICB9CgogICAgICByZXR1cm4gc3VzcGVuc2VCb3VuZGFyeTsKICAgIH0gLy8gQ29uZmlybWVkIHRoYXQgdGhlIGJvdW5kYXJ5IGlzIGluIGEgY29uY3VycmVudCBtb2RlIHRyZWUuIENvbnRpbnVlCiAgICAvLyB3aXRoIHRoZSBub3JtYWwgc3VzcGVuZCBwYXRoLgogICAgLy8KICAgIC8vIEFmdGVyIHRoaXMgd2UnbGwgdXNlIGEgc2V0IG9mIGhldXJpc3RpY3MgdG8gZGV0ZXJtaW5lIHdoZXRoZXIgdGhpcwogICAgLy8gcmVuZGVyIHBhc3Mgd2lsbCBydW4gdG8gY29tcGxldGlvbiBvciByZXN0YXJ0IG9yICJzdXNwZW5kIiB0aGUgY29tbWl0LgogICAgLy8gVGhlIGFjdHVhbCBsb2dpYyBmb3IgdGhpcyBpcyBzcHJlYWQgb3V0IGluIGRpZmZlcmVudCBwbGFjZXMuCiAgICAvLwogICAgLy8gVGhpcyBmaXJzdCBwcmluY2lwbGUgaXMgdGhhdCBpZiB3ZSdyZSBnb2luZyB0byBzdXNwZW5kIHdoZW4gd2UgY29tcGxldGUKICAgIC8vIGEgcm9vdCwgdGhlbiB3ZSBzaG91bGQgYWxzbyByZXN0YXJ0IGlmIHdlIGdldCBhbiB1cGRhdGUgb3IgcGluZyB0aGF0CiAgICAvLyBtaWdodCB1bnN1c3BlbmQgaXQsIGFuZCB2aWNlIHZlcnNhLiBUaGUgb25seSByZWFzb24gdG8gc3VzcGVuZCBpcwogICAgLy8gYmVjYXVzZSB5b3UgdGhpbmsgeW91IG1pZ2h0IHdhbnQgdG8gcmVzdGFydCBiZWZvcmUgY29tbWl0dGluZy4gSG93ZXZlciwKICAgIC8vIGl0IGRvZXNuJ3QgbWFrZSBzZW5zZSB0byByZXN0YXJ0IG9ubHkgd2hpbGUgaW4gdGhlIHBlcmlvZCB3ZSdyZSBzdXNwZW5kZWQuCiAgICAvLwogICAgLy8gUmVzdGFydGluZyB0b28gYWdncmVzc2l2ZWx5IGlzIGFsc28gbm90IGdvb2QgYmVjYXVzZSBpdCBzdGFydmVzIG91dCBhbnkKICAgIC8vIGludGVybWVkaWF0ZSBsb2FkaW5nIHN0YXRlLiBTbyB3ZSB1c2UgaGV1cmlzdGljcyB0byBkZXRlcm1pbmUgd2hlbi4KICAgIC8vIFN1c3BlbnNlIEhldXJpc3RpY3MKICAgIC8vCiAgICAvLyBJZiBub3RoaW5nIHRocmV3IGEgUHJvbWlzZSBvciBhbGwgdGhlIHNhbWUgZmFsbGJhY2tzIGFyZSBhbHJlYWR5IHNob3dpbmcsCiAgICAvLyB0aGVuIGRvbid0IHN1c3BlbmQvcmVzdGFydC4KICAgIC8vCiAgICAvLyBJZiB0aGlzIGlzIGFuIGluaXRpYWwgcmVuZGVyIG9mIGEgbmV3IHRyZWUgb2YgU3VzcGVuc2UgYm91bmRhcmllcyBhbmQKICAgIC8vIHRob3NlIHRyaWdnZXIgYSBmYWxsYmFjaywgdGhlbiBkb24ndCBzdXNwZW5kL3Jlc3RhcnQuIFdlIHdhbnQgdG8gZW5zdXJlCiAgICAvLyB0aGF0IHdlIGNhbiBzaG93IHRoZSBpbml0aWFsIGxvYWRpbmcgc3RhdGUgYXMgcXVpY2tseSBhcyBwb3NzaWJsZS4KICAgIC8vCiAgICAvLyBJZiB3ZSBoaXQgYSAiRGVsYXllZCIgY2FzZSwgc3VjaCBhcyB3aGVuIHdlJ2Qgc3dpdGNoIGZyb20gY29udGVudCBiYWNrIGludG8KICAgIC8vIGEgZmFsbGJhY2ssIHRoZW4gd2Ugc2hvdWxkIGFsd2F5cyBzdXNwZW5kL3Jlc3RhcnQuIFRyYW5zaXRpb25zIGFwcGx5CiAgICAvLyB0byB0aGlzIGNhc2UuIElmIG5vbmUgaXMgZGVmaW5lZCwgSk5EIGlzIHVzZWQgaW5zdGVhZC4KICAgIC8vCiAgICAvLyBJZiB3ZSdyZSBhbHJlYWR5IHNob3dpbmcgYSBmYWxsYmFjayBhbmQgaXQgZ2V0cyAicmV0cmllZCIsIGFsbG93aW5nIHVzIHRvIHNob3cKICAgIC8vIGFub3RoZXIgbGV2ZWwsIGJ1dCB0aGVyZSdzIHN0aWxsIGFuIGlubmVyIGJvdW5kYXJ5IHRoYXQgd291bGQgc2hvdyBhIGZhbGxiYWNrLAogICAgLy8gdGhlbiB3ZSBzdXNwZW5kL3Jlc3RhcnQgZm9yIDUwMG1zIHNpbmNlIHRoZSBsYXN0IHRpbWUgd2Ugc2hvd2VkIGEgZmFsbGJhY2sKICAgIC8vIGFueXdoZXJlIGluIHRoZSB0cmVlLiBUaGlzIGVmZmVjdGl2ZWx5IHRocm90dGxlcyBwcm9ncmVzc2l2ZSBsb2FkaW5nIGludG8gYQogICAgLy8gY29uc2lzdGVudCB0cmFpbiBvZiBjb21taXRzLiBUaGlzIGFsc28gZ2l2ZXMgdXMgYW4gb3Bwb3J0dW5pdHkgdG8gcmVzdGFydCB0bwogICAgLy8gZ2V0IHRvIHRoZSBjb21wbGV0ZWQgc3RhdGUgc2xpZ2h0bHkgZWFybGllci4KICAgIC8vCiAgICAvLyBJZiB0aGVyZSdzIGFtYmlndWl0eSBkdWUgdG8gYmF0Y2hpbmcgaXQncyByZXNvbHZlZCBpbiBwcmVmZXJlbmNlIG9mOgogICAgLy8gMSkgImRlbGF5ZWQiLCAyKSAiaW5pdGlhbCByZW5kZXIiLCAzKSAicmV0cnkiLgogICAgLy8KICAgIC8vIFdlIHdhbnQgdG8gZW5zdXJlIHRoYXQgYSAiYnVzeSIgc3RhdGUgZG9lc24ndCBnZXQgZm9yY2UgY29tbWl0dGVkLiBXZSB3YW50IHRvCiAgICAvLyBlbnN1cmUgdGhhdCBuZXcgaW5pdGlhbCBsb2FkaW5nIHN0YXRlcyBjYW4gY29tbWl0IGFzIHNvb24gYXMgcG9zc2libGUuCgoKICAgIHN1c3BlbnNlQm91bmRhcnkuZmxhZ3MgfD0gU2hvdWxkQ2FwdHVyZTsgLy8gVE9ETzogSSB0aGluayB3ZSBjYW4gcmVtb3ZlIHRoaXMsIHNpbmNlIHdlIG5vdyB1c2UgYERpZENhcHR1cmVgIGluCiAgICAvLyB0aGUgYmVnaW4gcGhhc2UgdG8gcHJldmVudCBhbiBlYXJseSBiYWlsb3V0LgoKICAgIHN1c3BlbnNlQm91bmRhcnkubGFuZXMgPSByb290UmVuZGVyTGFuZXM7CiAgICByZXR1cm4gc3VzcGVuc2VCb3VuZGFyeTsKICB9CgogIGZ1bmN0aW9uIHRocm93RXhjZXB0aW9uKHJvb3QsIHJldHVybkZpYmVyLCBzb3VyY2VGaWJlciwgdmFsdWUsIHJvb3RSZW5kZXJMYW5lcykgewogICAgLy8gVGhlIHNvdXJjZSBmaWJlciBkaWQgbm90IGNvbXBsZXRlLgogICAgc291cmNlRmliZXIuZmxhZ3MgfD0gSW5jb21wbGV0ZTsKCiAgICB7CiAgICAgIGlmIChpc0RldlRvb2xzUHJlc2VudCkgewogICAgICAgIC8vIElmIHdlIGhhdmUgcGVuZGluZyB3b3JrIHN0aWxsLCByZXN0b3JlIHRoZSBvcmlnaW5hbCB1cGRhdGVycwogICAgICAgIHJlc3RvcmVQZW5kaW5nVXBkYXRlcnMocm9vdCwgcm9vdFJlbmRlckxhbmVzKTsKICAgICAgfQogICAgfQoKICAgIGlmICh2YWx1ZSAhPT0gbnVsbCAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHR5cGVvZiB2YWx1ZS50aGVuID09PSAnZnVuY3Rpb24nKSB7CiAgICAgIC8vIFRoaXMgaXMgYSB3YWtlYWJsZS4gVGhlIGNvbXBvbmVudCBzdXNwZW5kZWQuCiAgICAgIHZhciB3YWtlYWJsZSA9IHZhbHVlOwogICAgICByZXNldFN1c3BlbmRlZENvbXBvbmVudChzb3VyY2VGaWJlcik7CgogICAgICB7CiAgICAgICAgaWYgKGdldElzSHlkcmF0aW5nKCkgJiYgc291cmNlRmliZXIubW9kZSAmIENvbmN1cnJlbnRNb2RlKSB7CiAgICAgICAgICBtYXJrRGlkVGhyb3dXaGlsZUh5ZHJhdGluZ0RFVigpOwogICAgICAgIH0KICAgICAgfQoKCiAgICAgIHZhciBzdXNwZW5zZUJvdW5kYXJ5ID0gZ2V0TmVhcmVzdFN1c3BlbnNlQm91bmRhcnlUb0NhcHR1cmUocmV0dXJuRmliZXIpOwoKICAgICAgaWYgKHN1c3BlbnNlQm91bmRhcnkgIT09IG51bGwpIHsKICAgICAgICBzdXNwZW5zZUJvdW5kYXJ5LmZsYWdzICY9IH5Gb3JjZUNsaWVudFJlbmRlcjsKICAgICAgICBtYXJrU3VzcGVuc2VCb3VuZGFyeVNob3VsZENhcHR1cmUoc3VzcGVuc2VCb3VuZGFyeSwgcmV0dXJuRmliZXIsIHNvdXJjZUZpYmVyLCByb290LCByb290UmVuZGVyTGFuZXMpOyAvLyBXZSBvbmx5IGF0dGFjaCBwaW5nIGxpc3RlbmVycyBpbiBjb25jdXJyZW50IG1vZGUuIExlZ2FjeSBTdXNwZW5zZSBhbHdheXMKICAgICAgICAvLyBjb21taXRzIGZhbGxiYWNrcyBzeW5jaHJvbm91c2x5LCBzbyB0aGVyZSBhcmUgbm8gcGluZ3MuCgogICAgICAgIGlmIChzdXNwZW5zZUJvdW5kYXJ5Lm1vZGUgJiBDb25jdXJyZW50TW9kZSkgewogICAgICAgICAgYXR0YWNoUGluZ0xpc3RlbmVyKHJvb3QsIHdha2VhYmxlLCByb290UmVuZGVyTGFuZXMpOwogICAgICAgIH0KCiAgICAgICAgYXR0YWNoUmV0cnlMaXN0ZW5lcihzdXNwZW5zZUJvdW5kYXJ5LCByb290LCB3YWtlYWJsZSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIE5vIGJvdW5kYXJ5IHdhcyBmb3VuZC4gVW5sZXNzIHRoaXMgaXMgYSBzeW5jIHVwZGF0ZSwgdGhpcyBpcyBPSy4KICAgICAgICAvLyBXZSBjYW4gc3VzcGVuZCBhbmQgd2FpdCBmb3IgbW9yZSBkYXRhIHRvIGFycml2ZS4KICAgICAgICBpZiAoIWluY2x1ZGVzU3luY0xhbmUocm9vdFJlbmRlckxhbmVzKSkgewogICAgICAgICAgLy8gVGhpcyBpcyBub3QgYSBzeW5jIHVwZGF0ZS4gU3VzcGVuZC4gU2luY2Ugd2UncmUgbm90IGFjdGl2YXRpbmcgYQogICAgICAgICAgLy8gU3VzcGVuc2UgYm91bmRhcnksIHRoaXMgd2lsbCB1bndpbmQgYWxsIHRoZSB3YXkgdG8gdGhlIHJvb3Qgd2l0aG91dAogICAgICAgICAgLy8gcGVyZm9ybWluZyBhIHNlY29uZCBwYXNzIHRvIHJlbmRlciBhIGZhbGxiYWNrLiAoVGhpcyBpcyBhcmd1YWJseSBob3cKICAgICAgICAgIC8vIHJlZnJlc2ggdHJhbnNpdGlvbnMgc2hvdWxkIHdvcmssIHRvbywgc2luY2Ugd2UncmUgbm90IGdvaW5nIHRvIGNvbW1pdAogICAgICAgICAgLy8gdGhlIGZhbGxiYWNrcyBhbnl3YXkuKQogICAgICAgICAgLy8KICAgICAgICAgIC8vIFRoaXMgY2FzZSBhbHNvIGFwcGxpZXMgdG8gaW5pdGlhbCBoeWRyYXRpb24uCiAgICAgICAgICBhdHRhY2hQaW5nTGlzdGVuZXIocm9vdCwgd2FrZWFibGUsIHJvb3RSZW5kZXJMYW5lcyk7CiAgICAgICAgICByZW5kZXJEaWRTdXNwZW5kRGVsYXlJZlBvc3NpYmxlKCk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfSAvLyBUaGlzIGlzIGEgc3luYy9kaXNjcmV0ZSB1cGRhdGUuIFdlIHRyZWF0IHRoaXMgY2FzZSBsaWtlIGFuIGVycm9yCiAgICAgICAgLy8gYmVjYXVzZSBkaXNjcmV0ZSByZW5kZXJzIGFyZSBleHBlY3RlZCB0byBwcm9kdWNlIGEgY29tcGxldGUgdHJlZQogICAgICAgIC8vIHN5bmNocm9ub3VzbHkgdG8gbWFpbnRhaW4gY29uc2lzdGVuY3kgd2l0aCBleHRlcm5hbCBzdGF0ZS4KCgogICAgICAgIHZhciB1bmNhdWdodFN1c3BlbnNlRXJyb3IgPSBuZXcgRXJyb3IoJ0EgY29tcG9uZW50IHN1c3BlbmRlZCB3aGlsZSByZXNwb25kaW5nIHRvIHN5bmNocm9ub3VzIGlucHV0LiBUaGlzICcgKyAnd2lsbCBjYXVzZSB0aGUgVUkgdG8gYmUgcmVwbGFjZWQgd2l0aCBhIGxvYWRpbmcgaW5kaWNhdG9yLiBUbyAnICsgJ2ZpeCwgdXBkYXRlcyB0aGF0IHN1c3BlbmQgc2hvdWxkIGJlIHdyYXBwZWQgJyArICd3aXRoIHN0YXJ0VHJhbnNpdGlvbi4nKTsgLy8gSWYgd2UncmUgb3V0c2lkZSBhIHRyYW5zaXRpb24sIGZhbGwgdGhyb3VnaCB0byB0aGUgcmVndWxhciBlcnJvciBwYXRoLgogICAgICAgIC8vIFRoZSBlcnJvciB3aWxsIGJlIGNhdWdodCBieSB0aGUgbmVhcmVzdCBzdXNwZW5zZSBib3VuZGFyeS4KCiAgICAgICAgdmFsdWUgPSB1bmNhdWdodFN1c3BlbnNlRXJyb3I7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIC8vIFRoaXMgaXMgYSByZWd1bGFyIGVycm9yLCBub3QgYSBTdXNwZW5zZSB3YWtlYWJsZS4KICAgICAgaWYgKGdldElzSHlkcmF0aW5nKCkgJiYgc291cmNlRmliZXIubW9kZSAmIENvbmN1cnJlbnRNb2RlKSB7CiAgICAgICAgbWFya0RpZFRocm93V2hpbGVIeWRyYXRpbmdERVYoKTsKCiAgICAgICAgdmFyIF9zdXNwZW5zZUJvdW5kYXJ5ID0gZ2V0TmVhcmVzdFN1c3BlbnNlQm91bmRhcnlUb0NhcHR1cmUocmV0dXJuRmliZXIpOyAvLyBJZiB0aGUgZXJyb3Igd2FzIHRocm93biBkdXJpbmcgaHlkcmF0aW9uLCB3ZSBtYXkgYmUgYWJsZSB0byByZWNvdmVyIGJ5CiAgICAgICAgLy8gZGlzY2FyZGluZyB0aGUgZGVoeWRyYXRlZCBjb250ZW50IGFuZCBzd2l0Y2hpbmcgdG8gYSBjbGllbnQgcmVuZGVyLgogICAgICAgIC8vIEluc3RlYWQgb2Ygc3VyZmFjaW5nIHRoZSBlcnJvciwgZmluZCB0aGUgbmVhcmVzdCBTdXNwZW5zZSBib3VuZGFyeQogICAgICAgIC8vIGFuZCByZW5kZXIgaXQgYWdhaW4gd2l0aG91dCBoeWRyYXRpb24uCgoKICAgICAgICBpZiAoX3N1c3BlbnNlQm91bmRhcnkgIT09IG51bGwpIHsKICAgICAgICAgIGlmICgoX3N1c3BlbnNlQm91bmRhcnkuZmxhZ3MgJiBTaG91bGRDYXB0dXJlKSA9PT0gTm9GbGFncykgewogICAgICAgICAgICAvLyBTZXQgYSBmbGFnIHRvIGluZGljYXRlIHRoYXQgd2Ugc2hvdWxkIHRyeSByZW5kZXJpbmcgdGhlIG5vcm1hbAogICAgICAgICAgICAvLyBjaGlsZHJlbiBhZ2Fpbiwgbm90IHRoZSBmYWxsYmFjay4KICAgICAgICAgICAgX3N1c3BlbnNlQm91bmRhcnkuZmxhZ3MgfD0gRm9yY2VDbGllbnRSZW5kZXI7CiAgICAgICAgICB9CgogICAgICAgICAgbWFya1N1c3BlbnNlQm91bmRhcnlTaG91bGRDYXB0dXJlKF9zdXNwZW5zZUJvdW5kYXJ5LCByZXR1cm5GaWJlciwgc291cmNlRmliZXIsIHJvb3QsIHJvb3RSZW5kZXJMYW5lcyk7IC8vIEV2ZW4gdGhvdWdoIHRoZSB1c2VyIG1heSBub3QgYmUgYWZmZWN0ZWQgYnkgdGhpcyBlcnJvciwgd2Ugc2hvdWxkCiAgICAgICAgICAvLyBzdGlsbCBsb2cgaXQgc28gaXQgY2FuIGJlIGZpeGVkLgoKICAgICAgICAgIHF1ZXVlSHlkcmF0aW9uRXJyb3IoY3JlYXRlQ2FwdHVyZWRWYWx1ZUF0RmliZXIodmFsdWUsIHNvdXJjZUZpYmVyKSk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgdmFsdWUgPSBjcmVhdGVDYXB0dXJlZFZhbHVlQXRGaWJlcih2YWx1ZSwgc291cmNlRmliZXIpOwogICAgcmVuZGVyRGlkRXJyb3IodmFsdWUpOyAvLyBXZSBkaWRuJ3QgZmluZCBhIGJvdW5kYXJ5IHRoYXQgY291bGQgaGFuZGxlIHRoaXMgdHlwZSBvZiBleGNlcHRpb24uIFN0YXJ0CiAgICAvLyBvdmVyIGFuZCB0cmF2ZXJzZSBwYXJlbnQgcGF0aCBhZ2FpbiwgdGhpcyB0aW1lIHRyZWF0aW5nIHRoZSBleGNlcHRpb24KICAgIC8vIGFzIGFuIGVycm9yLgoKICAgIHZhciB3b3JrSW5Qcm9ncmVzcyA9IHJldHVybkZpYmVyOwoKICAgIGRvIHsKICAgICAgc3dpdGNoICh3b3JrSW5Qcm9ncmVzcy50YWcpIHsKICAgICAgICBjYXNlIEhvc3RSb290OgogICAgICAgICAgewogICAgICAgICAgICB2YXIgX2Vycm9ySW5mbyA9IHZhbHVlOwogICAgICAgICAgICB3b3JrSW5Qcm9ncmVzcy5mbGFncyB8PSBTaG91bGRDYXB0dXJlOwogICAgICAgICAgICB2YXIgbGFuZSA9IHBpY2tBcmJpdHJhcnlMYW5lKHJvb3RSZW5kZXJMYW5lcyk7CiAgICAgICAgICAgIHdvcmtJblByb2dyZXNzLmxhbmVzID0gbWVyZ2VMYW5lcyh3b3JrSW5Qcm9ncmVzcy5sYW5lcywgbGFuZSk7CiAgICAgICAgICAgIHZhciB1cGRhdGUgPSBjcmVhdGVSb290RXJyb3JVcGRhdGUod29ya0luUHJvZ3Jlc3MsIF9lcnJvckluZm8sIGxhbmUpOwogICAgICAgICAgICBlbnF1ZXVlQ2FwdHVyZWRVcGRhdGUod29ya0luUHJvZ3Jlc3MsIHVwZGF0ZSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KCiAgICAgICAgY2FzZSBDbGFzc0NvbXBvbmVudDoKICAgICAgICAgIC8vIENhcHR1cmUgYW5kIHJldHJ5CiAgICAgICAgICB2YXIgZXJyb3JJbmZvID0gdmFsdWU7CiAgICAgICAgICB2YXIgY3RvciA9IHdvcmtJblByb2dyZXNzLnR5cGU7CiAgICAgICAgICB2YXIgaW5zdGFuY2UgPSB3b3JrSW5Qcm9ncmVzcy5zdGF0ZU5vZGU7CgogICAgICAgICAgaWYgKCh3b3JrSW5Qcm9ncmVzcy5mbGFncyAmIERpZENhcHR1cmUpID09PSBOb0ZsYWdzICYmICh0eXBlb2YgY3Rvci5nZXREZXJpdmVkU3RhdGVGcm9tRXJyb3IgPT09ICdmdW5jdGlvbicgfHwgaW5zdGFuY2UgIT09IG51bGwgJiYgdHlwZW9mIGluc3RhbmNlLmNvbXBvbmVudERpZENhdGNoID09PSAnZnVuY3Rpb24nICYmICFpc0FscmVhZHlGYWlsZWRMZWdhY3lFcnJvckJvdW5kYXJ5KGluc3RhbmNlKSkpIHsKICAgICAgICAgICAgd29ya0luUHJvZ3Jlc3MuZmxhZ3MgfD0gU2hvdWxkQ2FwdHVyZTsKCiAgICAgICAgICAgIHZhciBfbGFuZSA9IHBpY2tBcmJpdHJhcnlMYW5lKHJvb3RSZW5kZXJMYW5lcyk7CgogICAgICAgICAgICB3b3JrSW5Qcm9ncmVzcy5sYW5lcyA9IG1lcmdlTGFuZXMod29ya0luUHJvZ3Jlc3MubGFuZXMsIF9sYW5lKTsgLy8gU2NoZWR1bGUgdGhlIGVycm9yIGJvdW5kYXJ5IHRvIHJlLXJlbmRlciB1c2luZyB1cGRhdGVkIHN0YXRlCgogICAgICAgICAgICB2YXIgX3VwZGF0ZSA9IGNyZWF0ZUNsYXNzRXJyb3JVcGRhdGUod29ya0luUHJvZ3Jlc3MsIGVycm9ySW5mbywgX2xhbmUpOwoKICAgICAgICAgICAgZW5xdWV1ZUNhcHR1cmVkVXBkYXRlKHdvcmtJblByb2dyZXNzLCBfdXBkYXRlKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICB3b3JrSW5Qcm9ncmVzcyA9IHdvcmtJblByb2dyZXNzLnJldHVybjsKICAgIH0gd2hpbGUgKHdvcmtJblByb2dyZXNzICE9PSBudWxsKTsKICB9CgogIGZ1bmN0aW9uIGdldFN1c3BlbmRlZENhY2hlKCkgewogICAgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0gLy8gVGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgd2hlbiBhIFN1c3BlbnNlIGJvdW5kYXJ5IHN1c3BlbmRzLiBJdCByZXR1cm5zIHRoZQogIH0KCiAgdmFyIFJlYWN0Q3VycmVudE93bmVyJDEgPSBSZWFjdFNoYXJlZEludGVybmFscy5SZWFjdEN1cnJlbnRPd25lcjsKICB2YXIgZGlkUmVjZWl2ZVVwZGF0ZSA9IGZhbHNlOwogIHZhciBkaWRXYXJuQWJvdXRCYWRDbGFzczsKICB2YXIgZGlkV2FybkFib3V0TW9kdWxlUGF0dGVybkNvbXBvbmVudDsKICB2YXIgZGlkV2FybkFib3V0Q29udGV4dFR5cGVPbkZ1bmN0aW9uQ29tcG9uZW50OwogIHZhciBkaWRXYXJuQWJvdXRHZXREZXJpdmVkU3RhdGVPbkZ1bmN0aW9uQ29tcG9uZW50OwogIHZhciBkaWRXYXJuQWJvdXRGdW5jdGlvblJlZnM7CiAgdmFyIGRpZFdhcm5BYm91dFJlYXNzaWduaW5nUHJvcHM7CiAgdmFyIGRpZFdhcm5BYm91dFJldmVhbE9yZGVyOwogIHZhciBkaWRXYXJuQWJvdXRUYWlsT3B0aW9uczsKICB2YXIgZGlkV2FybkFib3V0RGVmYXVsdFByb3BzT25GdW5jdGlvbkNvbXBvbmVudDsKCiAgewogICAgZGlkV2FybkFib3V0QmFkQ2xhc3MgPSB7fTsKICAgIGRpZFdhcm5BYm91dE1vZHVsZVBhdHRlcm5Db21wb25lbnQgPSB7fTsKICAgIGRpZFdhcm5BYm91dENvbnRleHRUeXBlT25GdW5jdGlvbkNvbXBvbmVudCA9IHt9OwogICAgZGlkV2FybkFib3V0R2V0RGVyaXZlZFN0YXRlT25GdW5jdGlvbkNvbXBvbmVudCA9IHt9OwogICAgZGlkV2FybkFib3V0RnVuY3Rpb25SZWZzID0ge307CiAgICBkaWRXYXJuQWJvdXRSZWFzc2lnbmluZ1Byb3BzID0gZmFsc2U7CiAgICBkaWRXYXJuQWJvdXRSZXZlYWxPcmRlciA9IHt9OwogICAgZGlkV2FybkFib3V0VGFpbE9wdGlvbnMgPSB7fTsKICAgIGRpZFdhcm5BYm91dERlZmF1bHRQcm9wc09uRnVuY3Rpb25Db21wb25lbnQgPSB7fTsKICB9CgogIGZ1bmN0aW9uIHJlY29uY2lsZUNoaWxkcmVuKGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCBuZXh0Q2hpbGRyZW4sIHJlbmRlckxhbmVzKSB7CiAgICBpZiAoY3VycmVudCA9PT0gbnVsbCkgewogICAgICAvLyBJZiB0aGlzIGlzIGEgZnJlc2ggbmV3IGNvbXBvbmVudCB0aGF0IGhhc24ndCBiZWVuIHJlbmRlcmVkIHlldCwgd2UKICAgICAgLy8gd29uJ3QgdXBkYXRlIGl0cyBjaGlsZCBzZXQgYnkgYXBwbHlpbmcgbWluaW1hbCBzaWRlLWVmZmVjdHMuIEluc3RlYWQsCiAgICAgIC8vIHdlIHdpbGwgYWRkIHRoZW0gYWxsIHRvIHRoZSBjaGlsZCBiZWZvcmUgaXQgZ2V0cyByZW5kZXJlZC4gVGhhdCBtZWFucwogICAgICAvLyB3ZSBjYW4gb3B0aW1pemUgdGhpcyByZWNvbmNpbGlhdGlvbiBwYXNzIGJ5IG5vdCB0cmFja2luZyBzaWRlLWVmZmVjdHMuCiAgICAgIHdvcmtJblByb2dyZXNzLmNoaWxkID0gbW91bnRDaGlsZEZpYmVycyh3b3JrSW5Qcm9ncmVzcywgbnVsbCwgbmV4dENoaWxkcmVuLCByZW5kZXJMYW5lcyk7CiAgICB9IGVsc2UgewogICAgICAvLyBJZiB0aGUgY3VycmVudCBjaGlsZCBpcyB0aGUgc2FtZSBhcyB0aGUgd29yayBpbiBwcm9ncmVzcywgaXQgbWVhbnMgdGhhdAogICAgICAvLyB3ZSBoYXZlbid0IHlldCBzdGFydGVkIGFueSB3b3JrIG9uIHRoZXNlIGNoaWxkcmVuLiBUaGVyZWZvcmUsIHdlIHVzZQogICAgICAvLyB0aGUgY2xvbmUgYWxnb3JpdGhtIHRvIGNyZWF0ZSBhIGNvcHkgb2YgYWxsIHRoZSBjdXJyZW50IGNoaWxkcmVuLgogICAgICAvLyBJZiB3ZSBoYWQgYW55IHByb2dyZXNzZWQgd29yayBhbHJlYWR5LCB0aGF0IGlzIGludmFsaWQgYXQgdGhpcyBwb2ludCBzbwogICAgICAvLyBsZXQncyB0aHJvdyBpdCBvdXQuCiAgICAgIHdvcmtJblByb2dyZXNzLmNoaWxkID0gcmVjb25jaWxlQ2hpbGRGaWJlcnMod29ya0luUHJvZ3Jlc3MsIGN1cnJlbnQuY2hpbGQsIG5leHRDaGlsZHJlbiwgcmVuZGVyTGFuZXMpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gZm9yY2VVbm1vdW50Q3VycmVudEFuZFJlY29uY2lsZShjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcywgbmV4dENoaWxkcmVuLCByZW5kZXJMYW5lcykgewogICAgLy8gVGhpcyBmdW5jdGlvbiBpcyBmb3JrIG9mIHJlY29uY2lsZUNoaWxkcmVuLiBJdCdzIHVzZWQgaW4gY2FzZXMgd2hlcmUgd2UKICAgIC8vIHdhbnQgdG8gcmVjb25jaWxlIHdpdGhvdXQgbWF0Y2hpbmcgYWdhaW5zdCB0aGUgZXhpc3Rpbmcgc2V0LiBUaGlzIGhhcyB0aGUKICAgIC8vIGVmZmVjdCBvZiBhbGwgY3VycmVudCBjaGlsZHJlbiBiZWluZyB1bm1vdW50ZWQ7IGV2ZW4gaWYgdGhlIHR5cGUgYW5kIGtleQogICAgLy8gYXJlIHRoZSBzYW1lLCB0aGUgb2xkIGNoaWxkIGlzIHVubW91bnRlZCBhbmQgYSBuZXcgY2hpbGQgaXMgY3JlYXRlZC4KICAgIC8vCiAgICAvLyBUbyBkbyB0aGlzLCB3ZSdyZSBnb2luZyB0byBnbyB0aHJvdWdoIHRoZSByZWNvbmNpbGUgYWxnb3JpdGhtIHR3aWNlLiBJbgogICAgLy8gdGhlIGZpcnN0IHBhc3MsIHdlIHNjaGVkdWxlIGEgZGVsZXRpb24gZm9yIGFsbCB0aGUgY3VycmVudCBjaGlsZHJlbiBieQogICAgLy8gcGFzc2luZyBudWxsLgogICAgd29ya0luUHJvZ3Jlc3MuY2hpbGQgPSByZWNvbmNpbGVDaGlsZEZpYmVycyh3b3JrSW5Qcm9ncmVzcywgY3VycmVudC5jaGlsZCwgbnVsbCwgcmVuZGVyTGFuZXMpOyAvLyBJbiB0aGUgc2Vjb25kIHBhc3MsIHdlIG1vdW50IHRoZSBuZXcgY2hpbGRyZW4uIFRoZSB0cmljayBoZXJlIGlzIHRoYXQgd2UKICAgIC8vIHBhc3MgbnVsbCBpbiBwbGFjZSBvZiB3aGVyZSB3ZSB1c3VhbGx5IHBhc3MgdGhlIGN1cnJlbnQgY2hpbGQgc2V0LiBUaGlzIGhhcwogICAgLy8gdGhlIGVmZmVjdCBvZiByZW1vdW50aW5nIGFsbCBjaGlsZHJlbiByZWdhcmRsZXNzIG9mIHdoZXRoZXIgdGhlaXIKICAgIC8vIGlkZW50aXRpZXMgbWF0Y2guCgogICAgd29ya0luUHJvZ3Jlc3MuY2hpbGQgPSByZWNvbmNpbGVDaGlsZEZpYmVycyh3b3JrSW5Qcm9ncmVzcywgbnVsbCwgbmV4dENoaWxkcmVuLCByZW5kZXJMYW5lcyk7CiAgfQoKICBmdW5jdGlvbiB1cGRhdGVGb3J3YXJkUmVmKGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCBDb21wb25lbnQsIG5leHRQcm9wcywgcmVuZGVyTGFuZXMpIHsKICAgIC8vIFRPRE86IGN1cnJlbnQgY2FuIGJlIG5vbi1udWxsIGhlcmUgZXZlbiBpZiB0aGUgY29tcG9uZW50CiAgICAvLyBoYXNuJ3QgeWV0IG1vdW50ZWQuIFRoaXMgaGFwcGVucyBhZnRlciB0aGUgZmlyc3QgcmVuZGVyIHN1c3BlbmRzLgogICAgLy8gV2UnbGwgbmVlZCB0byBmaWd1cmUgb3V0IGlmIHRoaXMgaXMgZmluZSBvciBjYW4gY2F1c2UgaXNzdWVzLgogICAgewogICAgICBpZiAod29ya0luUHJvZ3Jlc3MudHlwZSAhPT0gd29ya0luUHJvZ3Jlc3MuZWxlbWVudFR5cGUpIHsKICAgICAgICAvLyBMYXp5IGNvbXBvbmVudCBwcm9wcyBjYW4ndCBiZSB2YWxpZGF0ZWQgaW4gY3JlYXRlRWxlbWVudAogICAgICAgIC8vIGJlY2F1c2UgdGhleSdyZSBvbmx5IGd1YXJhbnRlZWQgdG8gYmUgcmVzb2x2ZWQgaGVyZS4KICAgICAgICB2YXIgaW5uZXJQcm9wVHlwZXMgPSBDb21wb25lbnQucHJvcFR5cGVzOwoKICAgICAgICBpZiAoaW5uZXJQcm9wVHlwZXMpIHsKICAgICAgICAgIGNoZWNrUHJvcFR5cGVzKGlubmVyUHJvcFR5cGVzLCBuZXh0UHJvcHMsIC8vIFJlc29sdmVkIHByb3BzCiAgICAgICAgICAncHJvcCcsIGdldENvbXBvbmVudE5hbWVGcm9tVHlwZShDb21wb25lbnQpKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICB2YXIgcmVuZGVyID0gQ29tcG9uZW50LnJlbmRlcjsKICAgIHZhciByZWYgPSB3b3JrSW5Qcm9ncmVzcy5yZWY7IC8vIFRoZSByZXN0IGlzIGEgZm9yayBvZiB1cGRhdGVGdW5jdGlvbkNvbXBvbmVudAoKICAgIHZhciBuZXh0Q2hpbGRyZW47CiAgICB2YXIgaGFzSWQ7CiAgICBwcmVwYXJlVG9SZWFkQ29udGV4dCh3b3JrSW5Qcm9ncmVzcywgcmVuZGVyTGFuZXMpOwoKICAgIHsKICAgICAgbWFya0NvbXBvbmVudFJlbmRlclN0YXJ0ZWQod29ya0luUHJvZ3Jlc3MpOwogICAgfQoKICAgIHsKICAgICAgUmVhY3RDdXJyZW50T3duZXIkMS5jdXJyZW50ID0gd29ya0luUHJvZ3Jlc3M7CiAgICAgIHNldElzUmVuZGVyaW5nKHRydWUpOwogICAgICBuZXh0Q2hpbGRyZW4gPSByZW5kZXJXaXRoSG9va3MoY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIHJlbmRlciwgbmV4dFByb3BzLCByZWYsIHJlbmRlckxhbmVzKTsKICAgICAgaGFzSWQgPSBjaGVja0RpZFJlbmRlcklkSG9vaygpOwoKICAgICAgaWYgKCB3b3JrSW5Qcm9ncmVzcy5tb2RlICYgU3RyaWN0TGVnYWN5TW9kZSkgewogICAgICAgIHNldElzU3RyaWN0TW9kZUZvckRldnRvb2xzKHRydWUpOwoKICAgICAgICB0cnkgewogICAgICAgICAgbmV4dENoaWxkcmVuID0gcmVuZGVyV2l0aEhvb2tzKGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCByZW5kZXIsIG5leHRQcm9wcywgcmVmLCByZW5kZXJMYW5lcyk7CiAgICAgICAgICBoYXNJZCA9IGNoZWNrRGlkUmVuZGVySWRIb29rKCk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIHNldElzU3RyaWN0TW9kZUZvckRldnRvb2xzKGZhbHNlKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHNldElzUmVuZGVyaW5nKGZhbHNlKTsKICAgIH0KCiAgICB7CiAgICAgIG1hcmtDb21wb25lbnRSZW5kZXJTdG9wcGVkKCk7CiAgICB9CgogICAgaWYgKGN1cnJlbnQgIT09IG51bGwgJiYgIWRpZFJlY2VpdmVVcGRhdGUpIHsKICAgICAgYmFpbG91dEhvb2tzKGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCByZW5kZXJMYW5lcyk7CiAgICAgIHJldHVybiBiYWlsb3V0T25BbHJlYWR5RmluaXNoZWRXb3JrKGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCByZW5kZXJMYW5lcyk7CiAgICB9CgogICAgaWYgKGdldElzSHlkcmF0aW5nKCkgJiYgaGFzSWQpIHsKICAgICAgcHVzaE1hdGVyaWFsaXplZFRyZWVJZCh3b3JrSW5Qcm9ncmVzcyk7CiAgICB9IC8vIFJlYWN0IERldlRvb2xzIHJlYWRzIHRoaXMgZmxhZy4KCgogICAgd29ya0luUHJvZ3Jlc3MuZmxhZ3MgfD0gUGVyZm9ybWVkV29yazsKICAgIHJlY29uY2lsZUNoaWxkcmVuKGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCBuZXh0Q2hpbGRyZW4sIHJlbmRlckxhbmVzKTsKICAgIHJldHVybiB3b3JrSW5Qcm9ncmVzcy5jaGlsZDsKICB9CgogIGZ1bmN0aW9uIHVwZGF0ZU1lbW9Db21wb25lbnQoY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIENvbXBvbmVudCwgbmV4dFByb3BzLCByZW5kZXJMYW5lcykgewogICAgaWYgKGN1cnJlbnQgPT09IG51bGwpIHsKICAgICAgdmFyIHR5cGUgPSBDb21wb25lbnQudHlwZTsKCiAgICAgIGlmIChpc1NpbXBsZUZ1bmN0aW9uQ29tcG9uZW50KHR5cGUpICYmIENvbXBvbmVudC5jb21wYXJlID09PSBudWxsICYmIC8vIFNpbXBsZU1lbW9Db21wb25lbnQgY29kZXBhdGggZG9lc24ndCByZXNvbHZlIG91dGVyIHByb3BzIGVpdGhlci4KICAgICAgQ29tcG9uZW50LmRlZmF1bHRQcm9wcyA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgdmFyIHJlc29sdmVkVHlwZSA9IHR5cGU7CgogICAgICAgIHsKICAgICAgICAgIHJlc29sdmVkVHlwZSA9IHJlc29sdmVGdW5jdGlvbkZvckhvdFJlbG9hZGluZyh0eXBlKTsKICAgICAgICB9IC8vIElmIHRoaXMgaXMgYSBwbGFpbiBmdW5jdGlvbiBjb21wb25lbnQgd2l0aG91dCBkZWZhdWx0IHByb3BzLAogICAgICAgIC8vIGFuZCB3aXRoIG9ubHkgdGhlIGRlZmF1bHQgc2hhbGxvdyBjb21wYXJpc29uLCB3ZSB1cGdyYWRlIGl0CiAgICAgICAgLy8gdG8gYSBTaW1wbGVNZW1vQ29tcG9uZW50IHRvIGFsbG93IGZhc3QgcGF0aCB1cGRhdGVzLgoKCiAgICAgICAgd29ya0luUHJvZ3Jlc3MudGFnID0gU2ltcGxlTWVtb0NvbXBvbmVudDsKICAgICAgICB3b3JrSW5Qcm9ncmVzcy50eXBlID0gcmVzb2x2ZWRUeXBlOwoKICAgICAgICB7CiAgICAgICAgICB2YWxpZGF0ZUZ1bmN0aW9uQ29tcG9uZW50SW5EZXYod29ya0luUHJvZ3Jlc3MsIHR5cGUpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHVwZGF0ZVNpbXBsZU1lbW9Db21wb25lbnQoY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIHJlc29sdmVkVHlwZSwgbmV4dFByb3BzLCByZW5kZXJMYW5lcyk7CiAgICAgIH0KCiAgICAgIHsKICAgICAgICB2YXIgaW5uZXJQcm9wVHlwZXMgPSB0eXBlLnByb3BUeXBlczsKCiAgICAgICAgaWYgKGlubmVyUHJvcFR5cGVzKSB7CiAgICAgICAgICAvLyBJbm5lciBtZW1vIGNvbXBvbmVudCBwcm9wcyBhcmVuJ3QgY3VycmVudGx5IHZhbGlkYXRlZCBpbiBjcmVhdGVFbGVtZW50LgogICAgICAgICAgLy8gV2UgY291bGQgbW92ZSBpdCB0aGVyZSwgYnV0IHdlJ2Qgc3RpbGwgbmVlZCB0aGlzIGZvciBsYXp5IGNvZGUgcGF0aC4KICAgICAgICAgIGNoZWNrUHJvcFR5cGVzKGlubmVyUHJvcFR5cGVzLCBuZXh0UHJvcHMsIC8vIFJlc29sdmVkIHByb3BzCiAgICAgICAgICAncHJvcCcsIGdldENvbXBvbmVudE5hbWVGcm9tVHlwZSh0eXBlKSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoIENvbXBvbmVudC5kZWZhdWx0UHJvcHMgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgdmFyIGNvbXBvbmVudE5hbWUgPSBnZXRDb21wb25lbnROYW1lRnJvbVR5cGUodHlwZSkgfHwgJ1Vua25vd24nOwoKICAgICAgICAgIGlmICghZGlkV2FybkFib3V0RGVmYXVsdFByb3BzT25GdW5jdGlvbkNvbXBvbmVudFtjb21wb25lbnROYW1lXSkgewogICAgICAgICAgICBlcnJvcignJXM6IFN1cHBvcnQgZm9yIGRlZmF1bHRQcm9wcyB3aWxsIGJlIHJlbW92ZWQgZnJvbSBtZW1vIGNvbXBvbmVudHMgJyArICdpbiBhIGZ1dHVyZSBtYWpvciByZWxlYXNlLiBVc2UgSmF2YVNjcmlwdCBkZWZhdWx0IHBhcmFtZXRlcnMgaW5zdGVhZC4nLCBjb21wb25lbnROYW1lKTsKCiAgICAgICAgICAgIGRpZFdhcm5BYm91dERlZmF1bHRQcm9wc09uRnVuY3Rpb25Db21wb25lbnRbY29tcG9uZW50TmFtZV0gPSB0cnVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgdmFyIGNoaWxkID0gY3JlYXRlRmliZXJGcm9tVHlwZUFuZFByb3BzKENvbXBvbmVudC50eXBlLCBudWxsLCBuZXh0UHJvcHMsIHdvcmtJblByb2dyZXNzLCB3b3JrSW5Qcm9ncmVzcy5tb2RlLCByZW5kZXJMYW5lcyk7CiAgICAgIGNoaWxkLnJlZiA9IHdvcmtJblByb2dyZXNzLnJlZjsKICAgICAgY2hpbGQucmV0dXJuID0gd29ya0luUHJvZ3Jlc3M7CiAgICAgIHdvcmtJblByb2dyZXNzLmNoaWxkID0gY2hpbGQ7CiAgICAgIHJldHVybiBjaGlsZDsKICAgIH0KCiAgICB7CiAgICAgIHZhciBfdHlwZSA9IENvbXBvbmVudC50eXBlOwogICAgICB2YXIgX2lubmVyUHJvcFR5cGVzID0gX3R5cGUucHJvcFR5cGVzOwoKICAgICAgaWYgKF9pbm5lclByb3BUeXBlcykgewogICAgICAgIC8vIElubmVyIG1lbW8gY29tcG9uZW50IHByb3BzIGFyZW4ndCBjdXJyZW50bHkgdmFsaWRhdGVkIGluIGNyZWF0ZUVsZW1lbnQuCiAgICAgICAgLy8gV2UgY291bGQgbW92ZSBpdCB0aGVyZSwgYnV0IHdlJ2Qgc3RpbGwgbmVlZCB0aGlzIGZvciBsYXp5IGNvZGUgcGF0aC4KICAgICAgICBjaGVja1Byb3BUeXBlcyhfaW5uZXJQcm9wVHlwZXMsIG5leHRQcm9wcywgLy8gUmVzb2x2ZWQgcHJvcHMKICAgICAgICAncHJvcCcsIGdldENvbXBvbmVudE5hbWVGcm9tVHlwZShfdHlwZSkpOwogICAgICB9CiAgICB9CgogICAgdmFyIGN1cnJlbnRDaGlsZCA9IGN1cnJlbnQuY2hpbGQ7IC8vIFRoaXMgaXMgYWx3YXlzIGV4YWN0bHkgb25lIGNoaWxkCgogICAgdmFyIGhhc1NjaGVkdWxlZFVwZGF0ZU9yQ29udGV4dCA9IGNoZWNrU2NoZWR1bGVkVXBkYXRlT3JDb250ZXh0KGN1cnJlbnQsIHJlbmRlckxhbmVzKTsKCiAgICBpZiAoIWhhc1NjaGVkdWxlZFVwZGF0ZU9yQ29udGV4dCkgewogICAgICAvLyBUaGlzIHdpbGwgYmUgdGhlIHByb3BzIHdpdGggcmVzb2x2ZWQgZGVmYXVsdFByb3BzLAogICAgICAvLyB1bmxpa2UgY3VycmVudC5tZW1vaXplZFByb3BzIHdoaWNoIHdpbGwgYmUgdGhlIHVucmVzb2x2ZWQgb25lcy4KICAgICAgdmFyIHByZXZQcm9wcyA9IGN1cnJlbnRDaGlsZC5tZW1vaXplZFByb3BzOyAvLyBEZWZhdWx0IHRvIHNoYWxsb3cgY29tcGFyaXNvbgoKICAgICAgdmFyIGNvbXBhcmUgPSBDb21wb25lbnQuY29tcGFyZTsKICAgICAgY29tcGFyZSA9IGNvbXBhcmUgIT09IG51bGwgPyBjb21wYXJlIDogc2hhbGxvd0VxdWFsOwoKICAgICAgaWYgKGNvbXBhcmUocHJldlByb3BzLCBuZXh0UHJvcHMpICYmIGN1cnJlbnQucmVmID09PSB3b3JrSW5Qcm9ncmVzcy5yZWYpIHsKICAgICAgICByZXR1cm4gYmFpbG91dE9uQWxyZWFkeUZpbmlzaGVkV29yayhjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcywgcmVuZGVyTGFuZXMpOwogICAgICB9CiAgICB9IC8vIFJlYWN0IERldlRvb2xzIHJlYWRzIHRoaXMgZmxhZy4KCgogICAgd29ya0luUHJvZ3Jlc3MuZmxhZ3MgfD0gUGVyZm9ybWVkV29yazsKICAgIHZhciBuZXdDaGlsZCA9IGNyZWF0ZVdvcmtJblByb2dyZXNzKGN1cnJlbnRDaGlsZCwgbmV4dFByb3BzKTsKICAgIG5ld0NoaWxkLnJlZiA9IHdvcmtJblByb2dyZXNzLnJlZjsKICAgIG5ld0NoaWxkLnJldHVybiA9IHdvcmtJblByb2dyZXNzOwogICAgd29ya0luUHJvZ3Jlc3MuY2hpbGQgPSBuZXdDaGlsZDsKICAgIHJldHVybiBuZXdDaGlsZDsKICB9CgogIGZ1bmN0aW9uIHVwZGF0ZVNpbXBsZU1lbW9Db21wb25lbnQoY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIENvbXBvbmVudCwgbmV4dFByb3BzLCByZW5kZXJMYW5lcykgewogICAgLy8gVE9ETzogY3VycmVudCBjYW4gYmUgbm9uLW51bGwgaGVyZSBldmVuIGlmIHRoZSBjb21wb25lbnQKICAgIC8vIGhhc24ndCB5ZXQgbW91bnRlZC4gVGhpcyBoYXBwZW5zIHdoZW4gdGhlIGlubmVyIHJlbmRlciBzdXNwZW5kcy4KICAgIC8vIFdlJ2xsIG5lZWQgdG8gZmlndXJlIG91dCBpZiB0aGlzIGlzIGZpbmUgb3IgY2FuIGNhdXNlIGlzc3Vlcy4KICAgIHsKICAgICAgaWYgKHdvcmtJblByb2dyZXNzLnR5cGUgIT09IHdvcmtJblByb2dyZXNzLmVsZW1lbnRUeXBlKSB7CiAgICAgICAgLy8gTGF6eSBjb21wb25lbnQgcHJvcHMgY2FuJ3QgYmUgdmFsaWRhdGVkIGluIGNyZWF0ZUVsZW1lbnQKICAgICAgICAvLyBiZWNhdXNlIHRoZXkncmUgb25seSBndWFyYW50ZWVkIHRvIGJlIHJlc29sdmVkIGhlcmUuCiAgICAgICAgdmFyIG91dGVyTWVtb1R5cGUgPSB3b3JrSW5Qcm9ncmVzcy5lbGVtZW50VHlwZTsKCiAgICAgICAgaWYgKG91dGVyTWVtb1R5cGUuJCR0eXBlb2YgPT09IFJFQUNUX0xBWllfVFlQRSkgewogICAgICAgICAgLy8gV2Ugd2FybiB3aGVuIHlvdSBkZWZpbmUgcHJvcFR5cGVzIG9uIGxhenkoKQogICAgICAgICAgLy8gc28gbGV0J3MganVzdCBza2lwIG92ZXIgaXQgdG8gZmluZCBtZW1vKCkgb3V0ZXIgd3JhcHBlci4KICAgICAgICAgIC8vIElubmVyIHByb3BzIGZvciBtZW1vIGFyZSB2YWxpZGF0ZWQgbGF0ZXIuCiAgICAgICAgICB2YXIgbGF6eUNvbXBvbmVudCA9IG91dGVyTWVtb1R5cGU7CiAgICAgICAgICB2YXIgcGF5bG9hZCA9IGxhenlDb21wb25lbnQuX3BheWxvYWQ7CiAgICAgICAgICB2YXIgaW5pdCA9IGxhenlDb21wb25lbnQuX2luaXQ7CgogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgb3V0ZXJNZW1vVHlwZSA9IGluaXQocGF5bG9hZCk7CiAgICAgICAgICB9IGNhdGNoICh4KSB7CiAgICAgICAgICAgIG91dGVyTWVtb1R5cGUgPSBudWxsOwogICAgICAgICAgfSAvLyBJbm5lciBwcm9wVHlwZXMgd2lsbCBiZSB2YWxpZGF0ZWQgaW4gdGhlIGZ1bmN0aW9uIGNvbXBvbmVudCBwYXRoLgoKCiAgICAgICAgICB2YXIgb3V0ZXJQcm9wVHlwZXMgPSBvdXRlck1lbW9UeXBlICYmIG91dGVyTWVtb1R5cGUucHJvcFR5cGVzOwoKICAgICAgICAgIGlmIChvdXRlclByb3BUeXBlcykgewogICAgICAgICAgICBjaGVja1Byb3BUeXBlcyhvdXRlclByb3BUeXBlcywgbmV4dFByb3BzLCAvLyBSZXNvbHZlZCAoU2ltcGxlTWVtb0NvbXBvbmVudCBoYXMgbm8gZGVmYXVsdFByb3BzKQogICAgICAgICAgICAncHJvcCcsIGdldENvbXBvbmVudE5hbWVGcm9tVHlwZShvdXRlck1lbW9UeXBlKSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgaWYgKGN1cnJlbnQgIT09IG51bGwpIHsKICAgICAgdmFyIHByZXZQcm9wcyA9IGN1cnJlbnQubWVtb2l6ZWRQcm9wczsKCiAgICAgIGlmIChzaGFsbG93RXF1YWwocHJldlByb3BzLCBuZXh0UHJvcHMpICYmIGN1cnJlbnQucmVmID09PSB3b3JrSW5Qcm9ncmVzcy5yZWYgJiYgKCAvLyBQcmV2ZW50IGJhaWxvdXQgaWYgdGhlIGltcGxlbWVudGF0aW9uIGNoYW5nZWQgZHVlIHRvIGhvdCByZWxvYWQuCiAgICAgICB3b3JrSW5Qcm9ncmVzcy50eXBlID09PSBjdXJyZW50LnR5cGUgKSkgewogICAgICAgIGRpZFJlY2VpdmVVcGRhdGUgPSBmYWxzZTsgLy8gVGhlIHByb3BzIGFyZSBzaGFsbG93bHkgZXF1YWwuIFJldXNlIHRoZSBwcmV2aW91cyBwcm9wcyBvYmplY3QsIGxpa2Ugd2UKICAgICAgICAvLyB3b3VsZCBkdXJpbmcgYSBub3JtYWwgZmliZXIgYmFpbG91dC4KICAgICAgICAvLwogICAgICAgIC8vIFdlIGRvbid0IGhhdmUgc3Ryb25nIGd1YXJhbnRlZXMgdGhhdCB0aGUgcHJvcHMgb2JqZWN0IGlzIHJlZmVyZW50aWFsbHkKICAgICAgICAvLyBlcXVhbCBkdXJpbmcgdXBkYXRlcyB3aGVyZSB3ZSBjYW4ndCBiYWlsIG91dCBhbnl3YXkg4oCUIGxpa2UgaWYgdGhlIHByb3BzCiAgICAgICAgLy8gYXJlIHNoYWxsb3dseSBlcXVhbCwgYnV0IHRoZXJlJ3MgYSBsb2NhbCBzdGF0ZSBvciBjb250ZXh0IHVwZGF0ZSBpbiB0aGUKICAgICAgICAvLyBzYW1lIGJhdGNoLgogICAgICAgIC8vCiAgICAgICAgLy8gSG93ZXZlciwgYXMgYSBwcmluY2lwbGUsIHdlIHNob3VsZCBhaW0gdG8gbWFrZSB0aGUgYmVoYXZpb3IgY29uc2lzdGVudAogICAgICAgIC8vIGFjcm9zcyBkaWZmZXJlbnQgd2F5cyBvZiBtZW1vaXppbmcgYSBjb21wb25lbnQuIEZvciBleGFtcGxlLCBSZWFjdC5tZW1vCiAgICAgICAgLy8gaGFzIGEgZGlmZmVyZW50IGludGVybmFsIEZpYmVyIGxheW91dCBpZiB5b3UgcGFzcyBhIG5vcm1hbCBmdW5jdGlvbgogICAgICAgIC8vIGNvbXBvbmVudCAoU2ltcGxlTWVtb0NvbXBvbmVudCkgdmVyc3VzIGlmIHlvdSBwYXNzIGEgZGlmZmVyZW50IHR5cGUKICAgICAgICAvLyBsaWtlIGZvcndhcmRSZWYgKE1lbW9Db21wb25lbnQpLiBCdXQgdGhpcyBpcyBhbiBpbXBsZW1lbnRhdGlvbiBkZXRhaWwuCiAgICAgICAgLy8gV3JhcHBpbmcgYSBjb21wb25lbnQgaW4gZm9yd2FyZFJlZiAob3IgUmVhY3QubGF6eSwgZXRjKSBzaG91bGRuJ3QKICAgICAgICAvLyBhZmZlY3Qgd2hldGhlciB0aGUgcHJvcHMgb2JqZWN0IGlzIHJldXNlZCBkdXJpbmcgYSBiYWlsb3V0LgoKICAgICAgICB3b3JrSW5Qcm9ncmVzcy5wZW5kaW5nUHJvcHMgPSBuZXh0UHJvcHMgPSBwcmV2UHJvcHM7CgogICAgICAgIGlmICghY2hlY2tTY2hlZHVsZWRVcGRhdGVPckNvbnRleHQoY3VycmVudCwgcmVuZGVyTGFuZXMpKSB7CiAgICAgICAgICAvLyBUaGUgcGVuZGluZyBsYW5lcyB3ZXJlIGNsZWFyZWQgYXQgdGhlIGJlZ2lubmluZyBvZiBiZWdpbldvcmsuIFdlJ3JlCiAgICAgICAgICAvLyBhYm91dCB0byBiYWlsIG91dCwgYnV0IHRoZXJlIG1pZ2h0IGJlIG90aGVyIGxhbmVzIHRoYXQgd2VyZW4ndAogICAgICAgICAgLy8gaW5jbHVkZWQgaW4gdGhlIGN1cnJlbnQgcmVuZGVyLiBVc3VhbGx5LCB0aGUgcHJpb3JpdHkgbGV2ZWwgb2YgdGhlCiAgICAgICAgICAvLyByZW1haW5pbmcgdXBkYXRlcyBpcyBhY2N1bXVsYXRlZCBkdXJpbmcgdGhlIGV2YWx1YXRpb24gb2YgdGhlCiAgICAgICAgICAvLyBjb21wb25lbnQgKGkuZS4gd2hlbiBwcm9jZXNzaW5nIHRoZSB1cGRhdGUgcXVldWUpLiBCdXQgc2luY2Ugc2luY2UKICAgICAgICAgIC8vIHdlJ3JlIGJhaWxpbmcgb3V0IGVhcmx5ICp3aXRob3V0KiBldmFsdWF0aW5nIHRoZSBjb21wb25lbnQsIHdlIG5lZWQKICAgICAgICAgIC8vIHRvIGFjY291bnQgZm9yIGl0IGhlcmUsIHRvby4gUmVzZXQgdG8gdGhlIHZhbHVlIG9mIHRoZSBjdXJyZW50IGZpYmVyLgogICAgICAgICAgLy8gTk9URTogVGhpcyBvbmx5IGFwcGxpZXMgdG8gU2ltcGxlTWVtb0NvbXBvbmVudCwgbm90IE1lbW9Db21wb25lbnQsCiAgICAgICAgICAvLyBiZWNhdXNlIGEgTWVtb0NvbXBvbmVudCBmaWJlciBkb2VzIG5vdCBoYXZlIGhvb2tzIG9yIGFuIHVwZGF0ZSBxdWV1ZTsKICAgICAgICAgIC8vIHJhdGhlciwgaXQgd3JhcHMgYXJvdW5kIGFuIGlubmVyIGNvbXBvbmVudCwgd2hpY2ggbWF5IG9yIG1heSBub3QKICAgICAgICAgIC8vIGNvbnRhaW5zIGhvb2tzLgogICAgICAgICAgLy8gVE9ETzogTW92ZSB0aGUgcmVzZXQgYXQgaW4gYmVnaW5Xb3JrIG91dCBvZiB0aGUgY29tbW9uIHBhdGggc28gdGhhdAogICAgICAgICAgLy8gdGhpcyBpcyBubyBsb25nZXIgbmVjZXNzYXJ5LgogICAgICAgICAgd29ya0luUHJvZ3Jlc3MubGFuZXMgPSBjdXJyZW50LmxhbmVzOwogICAgICAgICAgcmV0dXJuIGJhaWxvdXRPbkFscmVhZHlGaW5pc2hlZFdvcmsoY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIHJlbmRlckxhbmVzKTsKICAgICAgICB9IGVsc2UgaWYgKChjdXJyZW50LmZsYWdzICYgRm9yY2VVcGRhdGVGb3JMZWdhY3lTdXNwZW5zZSkgIT09IE5vRmxhZ3MpIHsKICAgICAgICAgIC8vIFRoaXMgaXMgYSBzcGVjaWFsIGNhc2UgdGhhdCBvbmx5IGV4aXN0cyBmb3IgbGVnYWN5IG1vZGUuCiAgICAgICAgICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL3JlYWN0L3B1bGwvMTkyMTYuCiAgICAgICAgICBkaWRSZWNlaXZlVXBkYXRlID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gdXBkYXRlRnVuY3Rpb25Db21wb25lbnQoY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIENvbXBvbmVudCwgbmV4dFByb3BzLCByZW5kZXJMYW5lcyk7CiAgfQoKICBmdW5jdGlvbiB1cGRhdGVPZmZzY3JlZW5Db21wb25lbnQoY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIHJlbmRlckxhbmVzKSB7CiAgICB2YXIgbmV4dFByb3BzID0gd29ya0luUHJvZ3Jlc3MucGVuZGluZ1Byb3BzOwogICAgdmFyIG5leHRDaGlsZHJlbiA9IG5leHRQcm9wcy5jaGlsZHJlbjsKICAgIHZhciBwcmV2U3RhdGUgPSBjdXJyZW50ICE9PSBudWxsID8gY3VycmVudC5tZW1vaXplZFN0YXRlIDogbnVsbDsKCiAgICBpZiAobmV4dFByb3BzLm1vZGUgPT09ICdoaWRkZW4nIHx8IGVuYWJsZUxlZ2FjeUhpZGRlbiApIHsKICAgICAgLy8gUmVuZGVyaW5nIGEgaGlkZGVuIHRyZWUuCiAgICAgIGlmICgod29ya0luUHJvZ3Jlc3MubW9kZSAmIENvbmN1cnJlbnRNb2RlKSA9PT0gTm9Nb2RlKSB7CiAgICAgICAgLy8gSW4gbGVnYWN5IHN5bmMgbW9kZSwgZG9uJ3QgZGVmZXIgdGhlIHN1YnRyZWUuIFJlbmRlciBpdCBub3cuCiAgICAgICAgLy8gVE9ETzogQ29uc2lkZXIgaG93IE9mZnNjcmVlbiBzaG91bGQgd29yayB3aXRoIHRyYW5zaXRpb25zIGluIHRoZSBmdXR1cmUKICAgICAgICB2YXIgbmV4dFN0YXRlID0gewogICAgICAgICAgYmFzZUxhbmVzOiBOb0xhbmVzLAogICAgICAgICAgY2FjaGVQb29sOiBudWxsLAogICAgICAgICAgdHJhbnNpdGlvbnM6IG51bGwKICAgICAgICB9OwogICAgICAgIHdvcmtJblByb2dyZXNzLm1lbW9pemVkU3RhdGUgPSBuZXh0U3RhdGU7CgogICAgICAgIHB1c2hSZW5kZXJMYW5lcyh3b3JrSW5Qcm9ncmVzcywgcmVuZGVyTGFuZXMpOwogICAgICB9IGVsc2UgaWYgKCFpbmNsdWRlc1NvbWVMYW5lKHJlbmRlckxhbmVzLCBPZmZzY3JlZW5MYW5lKSkgewogICAgICAgIHZhciBzcGF3bmVkQ2FjaGVQb29sID0gbnVsbDsgLy8gV2UncmUgaGlkZGVuLCBhbmQgd2UncmUgbm90IHJlbmRlcmluZyBhdCBPZmZzY3JlZW4uIFdlIHdpbGwgYmFpbCBvdXQKICAgICAgICAvLyBhbmQgcmVzdW1lIHRoaXMgdHJlZSBsYXRlci4KCiAgICAgICAgdmFyIG5leHRCYXNlTGFuZXM7CgogICAgICAgIGlmIChwcmV2U3RhdGUgIT09IG51bGwpIHsKICAgICAgICAgIHZhciBwcmV2QmFzZUxhbmVzID0gcHJldlN0YXRlLmJhc2VMYW5lczsKICAgICAgICAgIG5leHRCYXNlTGFuZXMgPSBtZXJnZUxhbmVzKHByZXZCYXNlTGFuZXMsIHJlbmRlckxhbmVzKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgbmV4dEJhc2VMYW5lcyA9IHJlbmRlckxhbmVzOwogICAgICAgIH0gLy8gU2NoZWR1bGUgdGhpcyBmaWJlciB0byByZS1yZW5kZXIgYXQgb2Zmc2NyZWVuIHByaW9yaXR5LiBUaGVuIGJhaWxvdXQuCgoKICAgICAgICB3b3JrSW5Qcm9ncmVzcy5sYW5lcyA9IHdvcmtJblByb2dyZXNzLmNoaWxkTGFuZXMgPSBsYW5lVG9MYW5lcyhPZmZzY3JlZW5MYW5lKTsKICAgICAgICB2YXIgX25leHRTdGF0ZSA9IHsKICAgICAgICAgIGJhc2VMYW5lczogbmV4dEJhc2VMYW5lcywKICAgICAgICAgIGNhY2hlUG9vbDogc3Bhd25lZENhY2hlUG9vbCwKICAgICAgICAgIHRyYW5zaXRpb25zOiBudWxsCiAgICAgICAgfTsKICAgICAgICB3b3JrSW5Qcm9ncmVzcy5tZW1vaXplZFN0YXRlID0gX25leHRTdGF0ZTsKICAgICAgICB3b3JrSW5Qcm9ncmVzcy51cGRhdGVRdWV1ZSA9IG51bGw7CiAgICAgICAgLy8gdG8gYXZvaWQgYSBwdXNoL3BvcCBtaXNhbGlnbm1lbnQuCgoKICAgICAgICBwdXNoUmVuZGVyTGFuZXMod29ya0luUHJvZ3Jlc3MsIG5leHRCYXNlTGFuZXMpOwoKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBUaGlzIGlzIHRoZSBzZWNvbmQgcmVuZGVyLiBUaGUgc3Vycm91bmRpbmcgdmlzaWJsZSBjb250ZW50IGhhcyBhbHJlYWR5CiAgICAgICAgLy8gY29tbWl0dGVkLiBOb3cgd2UgcmVzdW1lIHJlbmRlcmluZyB0aGUgaGlkZGVuIHRyZWUuCiAgICAgICAgLy8gUmVuZGVyaW5nIGF0IG9mZnNjcmVlbiwgc28gd2UgY2FuIGNsZWFyIHRoZSBiYXNlIGxhbmVzLgogICAgICAgIHZhciBfbmV4dFN0YXRlMiA9IHsKICAgICAgICAgIGJhc2VMYW5lczogTm9MYW5lcywKICAgICAgICAgIGNhY2hlUG9vbDogbnVsbCwKICAgICAgICAgIHRyYW5zaXRpb25zOiBudWxsCiAgICAgICAgfTsKICAgICAgICB3b3JrSW5Qcm9ncmVzcy5tZW1vaXplZFN0YXRlID0gX25leHRTdGF0ZTI7IC8vIFB1c2ggdGhlIGxhbmVzIHRoYXQgd2VyZSBza2lwcGVkIHdoZW4gd2UgYmFpbGVkIG91dC4KCiAgICAgICAgdmFyIHN1YnRyZWVSZW5kZXJMYW5lcyA9IHByZXZTdGF0ZSAhPT0gbnVsbCA/IHByZXZTdGF0ZS5iYXNlTGFuZXMgOiByZW5kZXJMYW5lczsKCiAgICAgICAgcHVzaFJlbmRlckxhbmVzKHdvcmtJblByb2dyZXNzLCBzdWJ0cmVlUmVuZGVyTGFuZXMpOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICAvLyBSZW5kZXJpbmcgYSB2aXNpYmxlIHRyZWUuCiAgICAgIHZhciBfc3VidHJlZVJlbmRlckxhbmVzOwoKICAgICAgaWYgKHByZXZTdGF0ZSAhPT0gbnVsbCkgewogICAgICAgIC8vIFdlJ3JlIGdvaW5nIGZyb20gaGlkZGVuIC0+IHZpc2libGUuCiAgICAgICAgX3N1YnRyZWVSZW5kZXJMYW5lcyA9IG1lcmdlTGFuZXMocHJldlN0YXRlLmJhc2VMYW5lcywgcmVuZGVyTGFuZXMpOwoKICAgICAgICB3b3JrSW5Qcm9ncmVzcy5tZW1vaXplZFN0YXRlID0gbnVsbDsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBXZSB3ZXJlbid0IHByZXZpb3VzbHkgaGlkZGVuLCBhbmQgd2Ugc3RpbGwgYXJlbid0LCBzbyB0aGVyZSdzIG5vdGhpbmcKICAgICAgICAvLyBzcGVjaWFsIHRvIGRvLiBOZWVkIHRvIHB1c2ggdG8gdGhlIHN0YWNrIHJlZ2FyZGxlc3MsIHRob3VnaCwgdG8gYXZvaWQKICAgICAgICAvLyBhIHB1c2gvcG9wIG1pc2FsaWdubWVudC4KICAgICAgICBfc3VidHJlZVJlbmRlckxhbmVzID0gcmVuZGVyTGFuZXM7CiAgICAgIH0KCiAgICAgIHB1c2hSZW5kZXJMYW5lcyh3b3JrSW5Qcm9ncmVzcywgX3N1YnRyZWVSZW5kZXJMYW5lcyk7CiAgICB9CgogICAgcmVjb25jaWxlQ2hpbGRyZW4oY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIG5leHRDaGlsZHJlbiwgcmVuZGVyTGFuZXMpOwogICAgcmV0dXJuIHdvcmtJblByb2dyZXNzLmNoaWxkOwogIH0gLy8gTm90ZTogVGhlc2UgaGFwcGVuIHRvIGhhdmUgaWRlbnRpY2FsIGJlZ2luIHBoYXNlcywgZm9yIG5vdy4gV2Ugc2hvdWxkbid0IGhvbGQKCiAgZnVuY3Rpb24gdXBkYXRlRnJhZ21lbnQoY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIHJlbmRlckxhbmVzKSB7CiAgICB2YXIgbmV4dENoaWxkcmVuID0gd29ya0luUHJvZ3Jlc3MucGVuZGluZ1Byb3BzOwogICAgcmVjb25jaWxlQ2hpbGRyZW4oY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIG5leHRDaGlsZHJlbiwgcmVuZGVyTGFuZXMpOwogICAgcmV0dXJuIHdvcmtJblByb2dyZXNzLmNoaWxkOwogIH0KCiAgZnVuY3Rpb24gdXBkYXRlTW9kZShjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcywgcmVuZGVyTGFuZXMpIHsKICAgIHZhciBuZXh0Q2hpbGRyZW4gPSB3b3JrSW5Qcm9ncmVzcy5wZW5kaW5nUHJvcHMuY2hpbGRyZW47CiAgICByZWNvbmNpbGVDaGlsZHJlbihjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcywgbmV4dENoaWxkcmVuLCByZW5kZXJMYW5lcyk7CiAgICByZXR1cm4gd29ya0luUHJvZ3Jlc3MuY2hpbGQ7CiAgfQoKICBmdW5jdGlvbiB1cGRhdGVQcm9maWxlcihjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcywgcmVuZGVyTGFuZXMpIHsKICAgIHsKICAgICAgd29ya0luUHJvZ3Jlc3MuZmxhZ3MgfD0gVXBkYXRlOwoKICAgICAgewogICAgICAgIC8vIFJlc2V0IGVmZmVjdCBkdXJhdGlvbnMgZm9yIHRoZSBuZXh0IGV2ZW50dWFsIGVmZmVjdCBwaGFzZS4KICAgICAgICAvLyBUaGVzZSBhcmUgcmVzZXQgZHVyaW5nIHJlbmRlciB0byBhbGxvdyB0aGUgRGV2VG9vbHMgY29tbWl0IGhvb2sgYSBjaGFuY2UgdG8gcmVhZCB0aGVtLAogICAgICAgIHZhciBzdGF0ZU5vZGUgPSB3b3JrSW5Qcm9ncmVzcy5zdGF0ZU5vZGU7CiAgICAgICAgc3RhdGVOb2RlLmVmZmVjdER1cmF0aW9uID0gMDsKICAgICAgICBzdGF0ZU5vZGUucGFzc2l2ZUVmZmVjdER1cmF0aW9uID0gMDsKICAgICAgfQogICAgfQoKICAgIHZhciBuZXh0UHJvcHMgPSB3b3JrSW5Qcm9ncmVzcy5wZW5kaW5nUHJvcHM7CiAgICB2YXIgbmV4dENoaWxkcmVuID0gbmV4dFByb3BzLmNoaWxkcmVuOwogICAgcmVjb25jaWxlQ2hpbGRyZW4oY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIG5leHRDaGlsZHJlbiwgcmVuZGVyTGFuZXMpOwogICAgcmV0dXJuIHdvcmtJblByb2dyZXNzLmNoaWxkOwogIH0KCiAgZnVuY3Rpb24gbWFya1JlZihjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcykgewogICAgdmFyIHJlZiA9IHdvcmtJblByb2dyZXNzLnJlZjsKCiAgICBpZiAoY3VycmVudCA9PT0gbnVsbCAmJiByZWYgIT09IG51bGwgfHwgY3VycmVudCAhPT0gbnVsbCAmJiBjdXJyZW50LnJlZiAhPT0gcmVmKSB7CiAgICAgIC8vIFNjaGVkdWxlIGEgUmVmIGVmZmVjdAogICAgICB3b3JrSW5Qcm9ncmVzcy5mbGFncyB8PSBSZWY7CgogICAgICB7CiAgICAgICAgd29ya0luUHJvZ3Jlc3MuZmxhZ3MgfD0gUmVmU3RhdGljOwogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiB1cGRhdGVGdW5jdGlvbkNvbXBvbmVudChjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcywgQ29tcG9uZW50LCBuZXh0UHJvcHMsIHJlbmRlckxhbmVzKSB7CiAgICB7CiAgICAgIGlmICh3b3JrSW5Qcm9ncmVzcy50eXBlICE9PSB3b3JrSW5Qcm9ncmVzcy5lbGVtZW50VHlwZSkgewogICAgICAgIC8vIExhenkgY29tcG9uZW50IHByb3BzIGNhbid0IGJlIHZhbGlkYXRlZCBpbiBjcmVhdGVFbGVtZW50CiAgICAgICAgLy8gYmVjYXVzZSB0aGV5J3JlIG9ubHkgZ3VhcmFudGVlZCB0byBiZSByZXNvbHZlZCBoZXJlLgogICAgICAgIHZhciBpbm5lclByb3BUeXBlcyA9IENvbXBvbmVudC5wcm9wVHlwZXM7CgogICAgICAgIGlmIChpbm5lclByb3BUeXBlcykgewogICAgICAgICAgY2hlY2tQcm9wVHlwZXMoaW5uZXJQcm9wVHlwZXMsIG5leHRQcm9wcywgLy8gUmVzb2x2ZWQgcHJvcHMKICAgICAgICAgICdwcm9wJywgZ2V0Q29tcG9uZW50TmFtZUZyb21UeXBlKENvbXBvbmVudCkpOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHZhciBjb250ZXh0OwoKICAgIHsKICAgICAgdmFyIHVubWFza2VkQ29udGV4dCA9IGdldFVubWFza2VkQ29udGV4dCh3b3JrSW5Qcm9ncmVzcywgQ29tcG9uZW50LCB0cnVlKTsKICAgICAgY29udGV4dCA9IGdldE1hc2tlZENvbnRleHQod29ya0luUHJvZ3Jlc3MsIHVubWFza2VkQ29udGV4dCk7CiAgICB9CgogICAgdmFyIG5leHRDaGlsZHJlbjsKICAgIHZhciBoYXNJZDsKICAgIHByZXBhcmVUb1JlYWRDb250ZXh0KHdvcmtJblByb2dyZXNzLCByZW5kZXJMYW5lcyk7CgogICAgewogICAgICBtYXJrQ29tcG9uZW50UmVuZGVyU3RhcnRlZCh3b3JrSW5Qcm9ncmVzcyk7CiAgICB9CgogICAgewogICAgICBSZWFjdEN1cnJlbnRPd25lciQxLmN1cnJlbnQgPSB3b3JrSW5Qcm9ncmVzczsKICAgICAgc2V0SXNSZW5kZXJpbmcodHJ1ZSk7CiAgICAgIG5leHRDaGlsZHJlbiA9IHJlbmRlcldpdGhIb29rcyhjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcywgQ29tcG9uZW50LCBuZXh0UHJvcHMsIGNvbnRleHQsIHJlbmRlckxhbmVzKTsKICAgICAgaGFzSWQgPSBjaGVja0RpZFJlbmRlcklkSG9vaygpOwoKICAgICAgaWYgKCB3b3JrSW5Qcm9ncmVzcy5tb2RlICYgU3RyaWN0TGVnYWN5TW9kZSkgewogICAgICAgIHNldElzU3RyaWN0TW9kZUZvckRldnRvb2xzKHRydWUpOwoKICAgICAgICB0cnkgewogICAgICAgICAgbmV4dENoaWxkcmVuID0gcmVuZGVyV2l0aEhvb2tzKGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCBDb21wb25lbnQsIG5leHRQcm9wcywgY29udGV4dCwgcmVuZGVyTGFuZXMpOwogICAgICAgICAgaGFzSWQgPSBjaGVja0RpZFJlbmRlcklkSG9vaygpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICBzZXRJc1N0cmljdE1vZGVGb3JEZXZ0b29scyhmYWxzZSk7CiAgICAgICAgfQogICAgICB9CgogICAgICBzZXRJc1JlbmRlcmluZyhmYWxzZSk7CiAgICB9CgogICAgewogICAgICBtYXJrQ29tcG9uZW50UmVuZGVyU3RvcHBlZCgpOwogICAgfQoKICAgIGlmIChjdXJyZW50ICE9PSBudWxsICYmICFkaWRSZWNlaXZlVXBkYXRlKSB7CiAgICAgIGJhaWxvdXRIb29rcyhjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcywgcmVuZGVyTGFuZXMpOwogICAgICByZXR1cm4gYmFpbG91dE9uQWxyZWFkeUZpbmlzaGVkV29yayhjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcywgcmVuZGVyTGFuZXMpOwogICAgfQoKICAgIGlmIChnZXRJc0h5ZHJhdGluZygpICYmIGhhc0lkKSB7CiAgICAgIHB1c2hNYXRlcmlhbGl6ZWRUcmVlSWQod29ya0luUHJvZ3Jlc3MpOwogICAgfSAvLyBSZWFjdCBEZXZUb29scyByZWFkcyB0aGlzIGZsYWcuCgoKICAgIHdvcmtJblByb2dyZXNzLmZsYWdzIHw9IFBlcmZvcm1lZFdvcms7CiAgICByZWNvbmNpbGVDaGlsZHJlbihjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcywgbmV4dENoaWxkcmVuLCByZW5kZXJMYW5lcyk7CiAgICByZXR1cm4gd29ya0luUHJvZ3Jlc3MuY2hpbGQ7CiAgfQoKICBmdW5jdGlvbiB1cGRhdGVDbGFzc0NvbXBvbmVudChjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcywgQ29tcG9uZW50LCBuZXh0UHJvcHMsIHJlbmRlckxhbmVzKSB7CiAgICB7CiAgICAgIC8vIFRoaXMgaXMgdXNlZCBieSBEZXZUb29scyB0byBmb3JjZSBhIGJvdW5kYXJ5IHRvIGVycm9yLgogICAgICBzd2l0Y2ggKHNob3VsZEVycm9yKHdvcmtJblByb2dyZXNzKSkgewogICAgICAgIGNhc2UgZmFsc2U6CiAgICAgICAgICB7CiAgICAgICAgICAgIHZhciBfaW5zdGFuY2UgPSB3b3JrSW5Qcm9ncmVzcy5zdGF0ZU5vZGU7CiAgICAgICAgICAgIHZhciBjdG9yID0gd29ya0luUHJvZ3Jlc3MudHlwZTsgLy8gVE9ETyBUaGlzIHdheSBvZiByZXNldHRpbmcgdGhlIGVycm9yIGJvdW5kYXJ5IHN0YXRlIGlzIGEgaGFjay4KICAgICAgICAgICAgLy8gSXMgdGhlcmUgYSBiZXR0ZXIgd2F5IHRvIGRvIHRoaXM/CgogICAgICAgICAgICB2YXIgdGVtcEluc3RhbmNlID0gbmV3IGN0b3Iod29ya0luUHJvZ3Jlc3MubWVtb2l6ZWRQcm9wcywgX2luc3RhbmNlLmNvbnRleHQpOwogICAgICAgICAgICB2YXIgc3RhdGUgPSB0ZW1wSW5zdGFuY2Uuc3RhdGU7CgogICAgICAgICAgICBfaW5zdGFuY2UudXBkYXRlci5lbnF1ZXVlU2V0U3RhdGUoX2luc3RhbmNlLCBzdGF0ZSwgbnVsbCk7CgogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgY2FzZSB0cnVlOgogICAgICAgICAgewogICAgICAgICAgICB3b3JrSW5Qcm9ncmVzcy5mbGFncyB8PSBEaWRDYXB0dXJlOwogICAgICAgICAgICB3b3JrSW5Qcm9ncmVzcy5mbGFncyB8PSBTaG91bGRDYXB0dXJlOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaW50ZXJuYWwvcHJvZC1lcnJvci1jb2RlcwoKICAgICAgICAgICAgdmFyIGVycm9yJDEgPSBuZXcgRXJyb3IoJ1NpbXVsYXRlZCBlcnJvciBjb21pbmcgZnJvbSBEZXZUb29scycpOwogICAgICAgICAgICB2YXIgbGFuZSA9IHBpY2tBcmJpdHJhcnlMYW5lKHJlbmRlckxhbmVzKTsKICAgICAgICAgICAgd29ya0luUHJvZ3Jlc3MubGFuZXMgPSBtZXJnZUxhbmVzKHdvcmtJblByb2dyZXNzLmxhbmVzLCBsYW5lKTsgLy8gU2NoZWR1bGUgdGhlIGVycm9yIGJvdW5kYXJ5IHRvIHJlLXJlbmRlciB1c2luZyB1cGRhdGVkIHN0YXRlCgogICAgICAgICAgICB2YXIgdXBkYXRlID0gY3JlYXRlQ2xhc3NFcnJvclVwZGF0ZSh3b3JrSW5Qcm9ncmVzcywgY3JlYXRlQ2FwdHVyZWRWYWx1ZUF0RmliZXIoZXJyb3IkMSwgd29ya0luUHJvZ3Jlc3MpLCBsYW5lKTsKICAgICAgICAgICAgZW5xdWV1ZUNhcHR1cmVkVXBkYXRlKHdvcmtJblByb2dyZXNzLCB1cGRhdGUpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHdvcmtJblByb2dyZXNzLnR5cGUgIT09IHdvcmtJblByb2dyZXNzLmVsZW1lbnRUeXBlKSB7CiAgICAgICAgLy8gTGF6eSBjb21wb25lbnQgcHJvcHMgY2FuJ3QgYmUgdmFsaWRhdGVkIGluIGNyZWF0ZUVsZW1lbnQKICAgICAgICAvLyBiZWNhdXNlIHRoZXkncmUgb25seSBndWFyYW50ZWVkIHRvIGJlIHJlc29sdmVkIGhlcmUuCiAgICAgICAgdmFyIGlubmVyUHJvcFR5cGVzID0gQ29tcG9uZW50LnByb3BUeXBlczsKCiAgICAgICAgaWYgKGlubmVyUHJvcFR5cGVzKSB7CiAgICAgICAgICBjaGVja1Byb3BUeXBlcyhpbm5lclByb3BUeXBlcywgbmV4dFByb3BzLCAvLyBSZXNvbHZlZCBwcm9wcwogICAgICAgICAgJ3Byb3AnLCBnZXRDb21wb25lbnROYW1lRnJvbVR5cGUoQ29tcG9uZW50KSk7CiAgICAgICAgfQogICAgICB9CiAgICB9IC8vIFB1c2ggY29udGV4dCBwcm92aWRlcnMgZWFybHkgdG8gcHJldmVudCBjb250ZXh0IHN0YWNrIG1pc21hdGNoZXMuCiAgICAvLyBEdXJpbmcgbW91bnRpbmcgd2UgZG9uJ3Qga25vdyB0aGUgY2hpbGQgY29udGV4dCB5ZXQgYXMgdGhlIGluc3RhbmNlIGRvZXNuJ3QgZXhpc3QuCiAgICAvLyBXZSB3aWxsIGludmFsaWRhdGUgdGhlIGNoaWxkIGNvbnRleHQgaW4gZmluaXNoQ2xhc3NDb21wb25lbnQoKSByaWdodCBhZnRlciByZW5kZXJpbmcuCgoKICAgIHZhciBoYXNDb250ZXh0OwoKICAgIGlmIChpc0NvbnRleHRQcm92aWRlcihDb21wb25lbnQpKSB7CiAgICAgIGhhc0NvbnRleHQgPSB0cnVlOwogICAgICBwdXNoQ29udGV4dFByb3ZpZGVyKHdvcmtJblByb2dyZXNzKTsKICAgIH0gZWxzZSB7CiAgICAgIGhhc0NvbnRleHQgPSBmYWxzZTsKICAgIH0KCiAgICBwcmVwYXJlVG9SZWFkQ29udGV4dCh3b3JrSW5Qcm9ncmVzcywgcmVuZGVyTGFuZXMpOwogICAgdmFyIGluc3RhbmNlID0gd29ya0luUHJvZ3Jlc3Muc3RhdGVOb2RlOwogICAgdmFyIHNob3VsZFVwZGF0ZTsKCiAgICBpZiAoaW5zdGFuY2UgPT09IG51bGwpIHsKICAgICAgcmVzZXRTdXNwZW5kZWRDdXJyZW50T25Nb3VudEluTGVnYWN5TW9kZShjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcyk7IC8vIEluIHRoZSBpbml0aWFsIHBhc3Mgd2UgbWlnaHQgbmVlZCB0byBjb25zdHJ1Y3QgdGhlIGluc3RhbmNlLgoKICAgICAgY29uc3RydWN0Q2xhc3NJbnN0YW5jZSh3b3JrSW5Qcm9ncmVzcywgQ29tcG9uZW50LCBuZXh0UHJvcHMpOwogICAgICBtb3VudENsYXNzSW5zdGFuY2Uod29ya0luUHJvZ3Jlc3MsIENvbXBvbmVudCwgbmV4dFByb3BzLCByZW5kZXJMYW5lcyk7CiAgICAgIHNob3VsZFVwZGF0ZSA9IHRydWU7CiAgICB9IGVsc2UgaWYgKGN1cnJlbnQgPT09IG51bGwpIHsKICAgICAgLy8gSW4gYSByZXN1bWUsIHdlJ2xsIGFscmVhZHkgaGF2ZSBhbiBpbnN0YW5jZSB3ZSBjYW4gcmV1c2UuCiAgICAgIHNob3VsZFVwZGF0ZSA9IHJlc3VtZU1vdW50Q2xhc3NJbnN0YW5jZSh3b3JrSW5Qcm9ncmVzcywgQ29tcG9uZW50LCBuZXh0UHJvcHMsIHJlbmRlckxhbmVzKTsKICAgIH0gZWxzZSB7CiAgICAgIHNob3VsZFVwZGF0ZSA9IHVwZGF0ZUNsYXNzSW5zdGFuY2UoY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIENvbXBvbmVudCwgbmV4dFByb3BzLCByZW5kZXJMYW5lcyk7CiAgICB9CgogICAgdmFyIG5leHRVbml0T2ZXb3JrID0gZmluaXNoQ2xhc3NDb21wb25lbnQoY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIENvbXBvbmVudCwgc2hvdWxkVXBkYXRlLCBoYXNDb250ZXh0LCByZW5kZXJMYW5lcyk7CgogICAgewogICAgICB2YXIgaW5zdCA9IHdvcmtJblByb2dyZXNzLnN0YXRlTm9kZTsKCiAgICAgIGlmIChzaG91bGRVcGRhdGUgJiYgaW5zdC5wcm9wcyAhPT0gbmV4dFByb3BzKSB7CiAgICAgICAgaWYgKCFkaWRXYXJuQWJvdXRSZWFzc2lnbmluZ1Byb3BzKSB7CiAgICAgICAgICBlcnJvcignSXQgbG9va3MgbGlrZSAlcyBpcyByZWFzc2lnbmluZyBpdHMgb3duIGB0aGlzLnByb3BzYCB3aGlsZSByZW5kZXJpbmcuICcgKyAnVGhpcyBpcyBub3Qgc3VwcG9ydGVkIGFuZCBjYW4gbGVhZCB0byBjb25mdXNpbmcgYnVncy4nLCBnZXRDb21wb25lbnROYW1lRnJvbUZpYmVyKHdvcmtJblByb2dyZXNzKSB8fCAnYSBjb21wb25lbnQnKTsKICAgICAgICB9CgogICAgICAgIGRpZFdhcm5BYm91dFJlYXNzaWduaW5nUHJvcHMgPSB0cnVlOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIG5leHRVbml0T2ZXb3JrOwogIH0KCiAgZnVuY3Rpb24gZmluaXNoQ2xhc3NDb21wb25lbnQoY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIENvbXBvbmVudCwgc2hvdWxkVXBkYXRlLCBoYXNDb250ZXh0LCByZW5kZXJMYW5lcykgewogICAgLy8gUmVmcyBzaG91bGQgdXBkYXRlIGV2ZW4gaWYgc2hvdWxkQ29tcG9uZW50VXBkYXRlIHJldHVybnMgZmFsc2UKICAgIG1hcmtSZWYoY3VycmVudCwgd29ya0luUHJvZ3Jlc3MpOwogICAgdmFyIGRpZENhcHR1cmVFcnJvciA9ICh3b3JrSW5Qcm9ncmVzcy5mbGFncyAmIERpZENhcHR1cmUpICE9PSBOb0ZsYWdzOwoKICAgIGlmICghc2hvdWxkVXBkYXRlICYmICFkaWRDYXB0dXJlRXJyb3IpIHsKICAgICAgLy8gQ29udGV4dCBwcm92aWRlcnMgc2hvdWxkIGRlZmVyIHRvIHNDVSBmb3IgcmVuZGVyaW5nCiAgICAgIGlmIChoYXNDb250ZXh0KSB7CiAgICAgICAgaW52YWxpZGF0ZUNvbnRleHRQcm92aWRlcih3b3JrSW5Qcm9ncmVzcywgQ29tcG9uZW50LCBmYWxzZSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBiYWlsb3V0T25BbHJlYWR5RmluaXNoZWRXb3JrKGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCByZW5kZXJMYW5lcyk7CiAgICB9CgogICAgdmFyIGluc3RhbmNlID0gd29ya0luUHJvZ3Jlc3Muc3RhdGVOb2RlOyAvLyBSZXJlbmRlcgoKICAgIFJlYWN0Q3VycmVudE93bmVyJDEuY3VycmVudCA9IHdvcmtJblByb2dyZXNzOwogICAgdmFyIG5leHRDaGlsZHJlbjsKCiAgICBpZiAoZGlkQ2FwdHVyZUVycm9yICYmIHR5cGVvZiBDb21wb25lbnQuZ2V0RGVyaXZlZFN0YXRlRnJvbUVycm9yICE9PSAnZnVuY3Rpb24nKSB7CiAgICAgIC8vIElmIHdlIGNhcHR1cmVkIGFuIGVycm9yLCBidXQgZ2V0RGVyaXZlZFN0YXRlRnJvbUVycm9yIGlzIG5vdCBkZWZpbmVkLAogICAgICAvLyB1bm1vdW50IGFsbCB0aGUgY2hpbGRyZW4uIGNvbXBvbmVudERpZENhdGNoIHdpbGwgc2NoZWR1bGUgYW4gdXBkYXRlIHRvCiAgICAgIC8vIHJlLXJlbmRlciBhIGZhbGxiYWNrLiBUaGlzIGlzIHRlbXBvcmFyeSB1bnRpbCB3ZSBtaWdyYXRlIGV2ZXJ5b25lIHRvCiAgICAgIC8vIHRoZSBuZXcgQVBJLgogICAgICAvLyBUT0RPOiBXYXJuIGluIGEgZnV0dXJlIHJlbGVhc2UuCiAgICAgIG5leHRDaGlsZHJlbiA9IG51bGw7CgogICAgICB7CiAgICAgICAgc3RvcFByb2ZpbGVyVGltZXJJZlJ1bm5pbmcoKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgewogICAgICAgIG1hcmtDb21wb25lbnRSZW5kZXJTdGFydGVkKHdvcmtJblByb2dyZXNzKTsKICAgICAgfQoKICAgICAgewogICAgICAgIHNldElzUmVuZGVyaW5nKHRydWUpOwogICAgICAgIG5leHRDaGlsZHJlbiA9IGluc3RhbmNlLnJlbmRlcigpOwoKICAgICAgICBpZiAoIHdvcmtJblByb2dyZXNzLm1vZGUgJiBTdHJpY3RMZWdhY3lNb2RlKSB7CiAgICAgICAgICBzZXRJc1N0cmljdE1vZGVGb3JEZXZ0b29scyh0cnVlKTsKCiAgICAgICAgICB0cnkgewogICAgICAgICAgICBpbnN0YW5jZS5yZW5kZXIoKTsKICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIHNldElzU3RyaWN0TW9kZUZvckRldnRvb2xzKGZhbHNlKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHNldElzUmVuZGVyaW5nKGZhbHNlKTsKICAgICAgfQoKICAgICAgewogICAgICAgIG1hcmtDb21wb25lbnRSZW5kZXJTdG9wcGVkKCk7CiAgICAgIH0KICAgIH0gLy8gUmVhY3QgRGV2VG9vbHMgcmVhZHMgdGhpcyBmbGFnLgoKCiAgICB3b3JrSW5Qcm9ncmVzcy5mbGFncyB8PSBQZXJmb3JtZWRXb3JrOwoKICAgIGlmIChjdXJyZW50ICE9PSBudWxsICYmIGRpZENhcHR1cmVFcnJvcikgewogICAgICAvLyBJZiB3ZSdyZSByZWNvdmVyaW5nIGZyb20gYW4gZXJyb3IsIHJlY29uY2lsZSB3aXRob3V0IHJldXNpbmcgYW55IG9mCiAgICAgIC8vIHRoZSBleGlzdGluZyBjaGlsZHJlbi4gQ29uY2VwdHVhbGx5LCB0aGUgbm9ybWFsIGNoaWxkcmVuIGFuZCB0aGUgY2hpbGRyZW4KICAgICAgLy8gdGhhdCBhcmUgc2hvd24gb24gZXJyb3IgYXJlIHR3byBkaWZmZXJlbnQgc2V0cywgc28gd2Ugc2hvdWxkbid0IHJldXNlCiAgICAgIC8vIG5vcm1hbCBjaGlsZHJlbiBldmVuIGlmIHRoZWlyIGlkZW50aXRpZXMgbWF0Y2guCiAgICAgIGZvcmNlVW5tb3VudEN1cnJlbnRBbmRSZWNvbmNpbGUoY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIG5leHRDaGlsZHJlbiwgcmVuZGVyTGFuZXMpOwogICAgfSBlbHNlIHsKICAgICAgcmVjb25jaWxlQ2hpbGRyZW4oY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIG5leHRDaGlsZHJlbiwgcmVuZGVyTGFuZXMpOwogICAgfSAvLyBNZW1vaXplIHN0YXRlIHVzaW5nIHRoZSB2YWx1ZXMgd2UganVzdCB1c2VkIHRvIHJlbmRlci4KICAgIC8vIFRPRE86IFJlc3RydWN0dXJlIHNvIHdlIG5ldmVyIHJlYWQgdmFsdWVzIGZyb20gdGhlIGluc3RhbmNlLgoKCiAgICB3b3JrSW5Qcm9ncmVzcy5tZW1vaXplZFN0YXRlID0gaW5zdGFuY2Uuc3RhdGU7IC8vIFRoZSBjb250ZXh0IG1pZ2h0IGhhdmUgY2hhbmdlZCBzbyB3ZSBuZWVkIHRvIHJlY2FsY3VsYXRlIGl0LgoKICAgIGlmIChoYXNDb250ZXh0KSB7CiAgICAgIGludmFsaWRhdGVDb250ZXh0UHJvdmlkZXIod29ya0luUHJvZ3Jlc3MsIENvbXBvbmVudCwgdHJ1ZSk7CiAgICB9CgogICAgcmV0dXJuIHdvcmtJblByb2dyZXNzLmNoaWxkOwogIH0KCiAgZnVuY3Rpb24gcHVzaEhvc3RSb290Q29udGV4dCh3b3JrSW5Qcm9ncmVzcykgewogICAgdmFyIHJvb3QgPSB3b3JrSW5Qcm9ncmVzcy5zdGF0ZU5vZGU7CgogICAgaWYgKHJvb3QucGVuZGluZ0NvbnRleHQpIHsKICAgICAgcHVzaFRvcExldmVsQ29udGV4dE9iamVjdCh3b3JrSW5Qcm9ncmVzcywgcm9vdC5wZW5kaW5nQ29udGV4dCwgcm9vdC5wZW5kaW5nQ29udGV4dCAhPT0gcm9vdC5jb250ZXh0KTsKICAgIH0gZWxzZSBpZiAocm9vdC5jb250ZXh0KSB7CiAgICAgIC8vIFNob3VsZCBhbHdheXMgYmUgc2V0CiAgICAgIHB1c2hUb3BMZXZlbENvbnRleHRPYmplY3Qod29ya0luUHJvZ3Jlc3MsIHJvb3QuY29udGV4dCwgZmFsc2UpOwogICAgfQoKICAgIHB1c2hIb3N0Q29udGFpbmVyKHdvcmtJblByb2dyZXNzLCByb290LmNvbnRhaW5lckluZm8pOwogIH0KCiAgZnVuY3Rpb24gdXBkYXRlSG9zdFJvb3QoY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIHJlbmRlckxhbmVzKSB7CiAgICBwdXNoSG9zdFJvb3RDb250ZXh0KHdvcmtJblByb2dyZXNzKTsKCiAgICBpZiAoY3VycmVudCA9PT0gbnVsbCkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Nob3VsZCBoYXZlIGEgY3VycmVudCBmaWJlci4gVGhpcyBpcyBhIGJ1ZyBpbiBSZWFjdC4nKTsKICAgIH0KCiAgICB2YXIgbmV4dFByb3BzID0gd29ya0luUHJvZ3Jlc3MucGVuZGluZ1Byb3BzOwogICAgdmFyIHByZXZTdGF0ZSA9IHdvcmtJblByb2dyZXNzLm1lbW9pemVkU3RhdGU7CiAgICB2YXIgcHJldkNoaWxkcmVuID0gcHJldlN0YXRlLmVsZW1lbnQ7CiAgICBjbG9uZVVwZGF0ZVF1ZXVlKGN1cnJlbnQsIHdvcmtJblByb2dyZXNzKTsKICAgIHByb2Nlc3NVcGRhdGVRdWV1ZSh3b3JrSW5Qcm9ncmVzcywgbmV4dFByb3BzLCBudWxsLCByZW5kZXJMYW5lcyk7CiAgICB2YXIgbmV4dFN0YXRlID0gd29ya0luUHJvZ3Jlc3MubWVtb2l6ZWRTdGF0ZTsKICAgIHZhciByb290ID0gd29ya0luUHJvZ3Jlc3Muc3RhdGVOb2RlOwogICAgLy8gYmVpbmcgY2FsbGVkICJlbGVtZW50Ii4KCgogICAgdmFyIG5leHRDaGlsZHJlbiA9IG5leHRTdGF0ZS5lbGVtZW50OwoKICAgIGlmICggcHJldlN0YXRlLmlzRGVoeWRyYXRlZCkgewogICAgICAvLyBUaGlzIGlzIGEgaHlkcmF0aW9uIHJvb3Qgd2hvc2Ugc2hlbGwgaGFzIG5vdCB5ZXQgaHlkcmF0ZWQuIFdlIHNob3VsZAogICAgICAvLyBhdHRlbXB0IHRvIGh5ZHJhdGUuCiAgICAgIC8vIEZsaXAgaXNEZWh5ZHJhdGVkIHRvIGZhbHNlIHRvIGluZGljYXRlIHRoYXQgd2hlbiB0aGlzIHJlbmRlcgogICAgICAvLyBmaW5pc2hlcywgdGhlIHJvb3Qgd2lsbCBubyBsb25nZXIgYmUgZGVoeWRyYXRlZC4KICAgICAgdmFyIG92ZXJyaWRlU3RhdGUgPSB7CiAgICAgICAgZWxlbWVudDogbmV4dENoaWxkcmVuLAogICAgICAgIGlzRGVoeWRyYXRlZDogZmFsc2UsCiAgICAgICAgY2FjaGU6IG5leHRTdGF0ZS5jYWNoZSwKICAgICAgICBwZW5kaW5nU3VzcGVuc2VCb3VuZGFyaWVzOiBuZXh0U3RhdGUucGVuZGluZ1N1c3BlbnNlQm91bmRhcmllcywKICAgICAgICB0cmFuc2l0aW9uczogbmV4dFN0YXRlLnRyYW5zaXRpb25zCiAgICAgIH07CiAgICAgIHZhciB1cGRhdGVRdWV1ZSA9IHdvcmtJblByb2dyZXNzLnVwZGF0ZVF1ZXVlOyAvLyBgYmFzZVN0YXRlYCBjYW4gYWx3YXlzIGJlIHRoZSBsYXN0IHN0YXRlIGJlY2F1c2UgdGhlIHJvb3QgZG9lc24ndAogICAgICAvLyBoYXZlIHJlZHVjZXIgZnVuY3Rpb25zIHNvIGl0IGRvZXNuJ3QgbmVlZCByZWJhc2luZy4KCiAgICAgIHVwZGF0ZVF1ZXVlLmJhc2VTdGF0ZSA9IG92ZXJyaWRlU3RhdGU7CiAgICAgIHdvcmtJblByb2dyZXNzLm1lbW9pemVkU3RhdGUgPSBvdmVycmlkZVN0YXRlOwoKICAgICAgaWYgKHdvcmtJblByb2dyZXNzLmZsYWdzICYgRm9yY2VDbGllbnRSZW5kZXIpIHsKICAgICAgICAvLyBTb21ldGhpbmcgZXJyb3JlZCBkdXJpbmcgYSBwcmV2aW91cyBhdHRlbXB0IHRvIGh5ZHJhdGUgdGhlIHNoZWxsLCBzbyB3ZQogICAgICAgIC8vIGZvcmNlZCBhIGNsaWVudCByZW5kZXIuCiAgICAgICAgdmFyIHJlY292ZXJhYmxlRXJyb3IgPSBjcmVhdGVDYXB0dXJlZFZhbHVlQXRGaWJlcihuZXcgRXJyb3IoJ1RoZXJlIHdhcyBhbiBlcnJvciB3aGlsZSBoeWRyYXRpbmcuIEJlY2F1c2UgdGhlIGVycm9yIGhhcHBlbmVkIG91dHNpZGUgJyArICdvZiBhIFN1c3BlbnNlIGJvdW5kYXJ5LCB0aGUgZW50aXJlIHJvb3Qgd2lsbCBzd2l0Y2ggdG8gJyArICdjbGllbnQgcmVuZGVyaW5nLicpLCB3b3JrSW5Qcm9ncmVzcyk7CiAgICAgICAgcmV0dXJuIG1vdW50SG9zdFJvb3RXaXRob3V0SHlkcmF0aW5nKGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCBuZXh0Q2hpbGRyZW4sIHJlbmRlckxhbmVzLCByZWNvdmVyYWJsZUVycm9yKTsKICAgICAgfSBlbHNlIGlmIChuZXh0Q2hpbGRyZW4gIT09IHByZXZDaGlsZHJlbikgewogICAgICAgIHZhciBfcmVjb3ZlcmFibGVFcnJvciA9IGNyZWF0ZUNhcHR1cmVkVmFsdWVBdEZpYmVyKG5ldyBFcnJvcignVGhpcyByb290IHJlY2VpdmVkIGFuIGVhcmx5IHVwZGF0ZSwgYmVmb3JlIGFueXRoaW5nIHdhcyBhYmxlICcgKyAnaHlkcmF0ZS4gU3dpdGNoZWQgdGhlIGVudGlyZSByb290IHRvIGNsaWVudCByZW5kZXJpbmcuJyksIHdvcmtJblByb2dyZXNzKTsKCiAgICAgICAgcmV0dXJuIG1vdW50SG9zdFJvb3RXaXRob3V0SHlkcmF0aW5nKGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCBuZXh0Q2hpbGRyZW4sIHJlbmRlckxhbmVzLCBfcmVjb3ZlcmFibGVFcnJvcik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gVGhlIG91dGVybW9zdCBzaGVsbCBoYXMgbm90IGh5ZHJhdGVkIHlldC4gU3RhcnQgaHlkcmF0aW5nLgogICAgICAgIGVudGVySHlkcmF0aW9uU3RhdGUod29ya0luUHJvZ3Jlc3MpOwoKICAgICAgICB2YXIgY2hpbGQgPSBtb3VudENoaWxkRmliZXJzKHdvcmtJblByb2dyZXNzLCBudWxsLCBuZXh0Q2hpbGRyZW4sIHJlbmRlckxhbmVzKTsKICAgICAgICB3b3JrSW5Qcm9ncmVzcy5jaGlsZCA9IGNoaWxkOwogICAgICAgIHZhciBub2RlID0gY2hpbGQ7CgogICAgICAgIHdoaWxlIChub2RlKSB7CiAgICAgICAgICAvLyBNYXJrIGVhY2ggY2hpbGQgYXMgaHlkcmF0aW5nLiBUaGlzIGlzIGEgZmFzdCBwYXRoIHRvIGtub3cgd2hldGhlciB0aGlzCiAgICAgICAgICAvLyB0cmVlIGlzIHBhcnQgb2YgYSBoeWRyYXRpbmcgdHJlZS4gVGhpcyBpcyB1c2VkIHRvIGRldGVybWluZSBpZiBhIGNoaWxkCiAgICAgICAgICAvLyBub2RlIGhhcyBmdWxseSBtb3VudGVkIHlldCwgYW5kIGZvciBzY2hlZHVsaW5nIGV2ZW50IHJlcGxheWluZy4KICAgICAgICAgIC8vIENvbmNlcHR1YWxseSB0aGlzIGlzIHNpbWlsYXIgdG8gUGxhY2VtZW50IGluIHRoYXQgYSBuZXcgc3VidHJlZSBpcwogICAgICAgICAgLy8gaW5zZXJ0ZWQgaW50byB0aGUgUmVhY3QgdHJlZSBoZXJlLiBJdCBqdXN0IGhhcHBlbnMgdG8gbm90IG5lZWQgRE9NCiAgICAgICAgICAvLyBtdXRhdGlvbnMgYmVjYXVzZSBpdCBhbHJlYWR5IGV4aXN0cy4KICAgICAgICAgIG5vZGUuZmxhZ3MgPSBub2RlLmZsYWdzICYgflBsYWNlbWVudCB8IEh5ZHJhdGluZzsKICAgICAgICAgIG5vZGUgPSBub2RlLnNpYmxpbmc7CiAgICAgICAgfQogICAgICB9CiAgICB9IGVsc2UgewogICAgICAvLyBSb290IGlzIG5vdCBkZWh5ZHJhdGVkLiBFaXRoZXIgdGhpcyBpcyBhIGNsaWVudC1vbmx5IHJvb3QsIG9yIGl0CiAgICAgIC8vIGFscmVhZHkgaHlkcmF0ZWQuCiAgICAgIHJlc2V0SHlkcmF0aW9uU3RhdGUoKTsKCiAgICAgIGlmIChuZXh0Q2hpbGRyZW4gPT09IHByZXZDaGlsZHJlbikgewogICAgICAgIHJldHVybiBiYWlsb3V0T25BbHJlYWR5RmluaXNoZWRXb3JrKGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCByZW5kZXJMYW5lcyk7CiAgICAgIH0KCiAgICAgIHJlY29uY2lsZUNoaWxkcmVuKGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCBuZXh0Q2hpbGRyZW4sIHJlbmRlckxhbmVzKTsKICAgIH0KCiAgICByZXR1cm4gd29ya0luUHJvZ3Jlc3MuY2hpbGQ7CiAgfQoKICBmdW5jdGlvbiBtb3VudEhvc3RSb290V2l0aG91dEh5ZHJhdGluZyhjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcywgbmV4dENoaWxkcmVuLCByZW5kZXJMYW5lcywgcmVjb3ZlcmFibGVFcnJvcikgewogICAgLy8gUmV2ZXJ0IHRvIGNsaWVudCByZW5kZXJpbmcuCiAgICByZXNldEh5ZHJhdGlvblN0YXRlKCk7CiAgICBxdWV1ZUh5ZHJhdGlvbkVycm9yKHJlY292ZXJhYmxlRXJyb3IpOwogICAgd29ya0luUHJvZ3Jlc3MuZmxhZ3MgfD0gRm9yY2VDbGllbnRSZW5kZXI7CiAgICByZWNvbmNpbGVDaGlsZHJlbihjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcywgbmV4dENoaWxkcmVuLCByZW5kZXJMYW5lcyk7CiAgICByZXR1cm4gd29ya0luUHJvZ3Jlc3MuY2hpbGQ7CiAgfQoKICBmdW5jdGlvbiB1cGRhdGVIb3N0Q29tcG9uZW50KGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCByZW5kZXJMYW5lcykgewogICAgcHVzaEhvc3RDb250ZXh0KHdvcmtJblByb2dyZXNzKTsKCiAgICBpZiAoY3VycmVudCA9PT0gbnVsbCkgewogICAgICB0cnlUb0NsYWltTmV4dEh5ZHJhdGFibGVJbnN0YW5jZSh3b3JrSW5Qcm9ncmVzcyk7CiAgICB9CgogICAgdmFyIHR5cGUgPSB3b3JrSW5Qcm9ncmVzcy50eXBlOwogICAgdmFyIG5leHRQcm9wcyA9IHdvcmtJblByb2dyZXNzLnBlbmRpbmdQcm9wczsKICAgIHZhciBwcmV2UHJvcHMgPSBjdXJyZW50ICE9PSBudWxsID8gY3VycmVudC5tZW1vaXplZFByb3BzIDogbnVsbDsKICAgIHZhciBuZXh0Q2hpbGRyZW4gPSBuZXh0UHJvcHMuY2hpbGRyZW47CiAgICB2YXIgaXNEaXJlY3RUZXh0Q2hpbGQgPSBzaG91bGRTZXRUZXh0Q29udGVudCh0eXBlLCBuZXh0UHJvcHMpOwoKICAgIGlmIChpc0RpcmVjdFRleHRDaGlsZCkgewogICAgICAvLyBXZSBzcGVjaWFsIGNhc2UgYSBkaXJlY3QgdGV4dCBjaGlsZCBvZiBhIGhvc3Qgbm9kZS4gVGhpcyBpcyBhIGNvbW1vbgogICAgICAvLyBjYXNlLiBXZSB3b24ndCBoYW5kbGUgaXQgYXMgYSByZWlmaWVkIGNoaWxkLiBXZSB3aWxsIGluc3RlYWQgaGFuZGxlCiAgICAgIC8vIHRoaXMgaW4gdGhlIGhvc3QgZW52aXJvbm1lbnQgdGhhdCBhbHNvIGhhcyBhY2Nlc3MgdG8gdGhpcyBwcm9wLiBUaGF0CiAgICAgIC8vIGF2b2lkcyBhbGxvY2F0aW5nIGFub3RoZXIgSG9zdFRleHQgZmliZXIgYW5kIHRyYXZlcnNpbmcgaXQuCiAgICAgIG5leHRDaGlsZHJlbiA9IG51bGw7CiAgICB9IGVsc2UgaWYgKHByZXZQcm9wcyAhPT0gbnVsbCAmJiBzaG91bGRTZXRUZXh0Q29udGVudCh0eXBlLCBwcmV2UHJvcHMpKSB7CiAgICAgIC8vIElmIHdlJ3JlIHN3aXRjaGluZyBmcm9tIGEgZGlyZWN0IHRleHQgY2hpbGQgdG8gYSBub3JtYWwgY2hpbGQsIG9yIHRvCiAgICAgIC8vIGVtcHR5LCB3ZSBuZWVkIHRvIHNjaGVkdWxlIHRoZSB0ZXh0IGNvbnRlbnQgdG8gYmUgcmVzZXQuCiAgICAgIHdvcmtJblByb2dyZXNzLmZsYWdzIHw9IENvbnRlbnRSZXNldDsKICAgIH0KCiAgICBtYXJrUmVmKGN1cnJlbnQsIHdvcmtJblByb2dyZXNzKTsKICAgIHJlY29uY2lsZUNoaWxkcmVuKGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCBuZXh0Q2hpbGRyZW4sIHJlbmRlckxhbmVzKTsKICAgIHJldHVybiB3b3JrSW5Qcm9ncmVzcy5jaGlsZDsKICB9CgogIGZ1bmN0aW9uIHVwZGF0ZUhvc3RUZXh0KGN1cnJlbnQsIHdvcmtJblByb2dyZXNzKSB7CiAgICBpZiAoY3VycmVudCA9PT0gbnVsbCkgewogICAgICB0cnlUb0NsYWltTmV4dEh5ZHJhdGFibGVJbnN0YW5jZSh3b3JrSW5Qcm9ncmVzcyk7CiAgICB9IC8vIE5vdGhpbmcgdG8gZG8gaGVyZS4gVGhpcyBpcyB0ZXJtaW5hbC4gV2UnbGwgZG8gdGhlIGNvbXBsZXRpb24gc3RlcAogICAgLy8gaW1tZWRpYXRlbHkgYWZ0ZXIuCgoKICAgIHJldHVybiBudWxsOwogIH0KCiAgZnVuY3Rpb24gbW91bnRMYXp5Q29tcG9uZW50KF9jdXJyZW50LCB3b3JrSW5Qcm9ncmVzcywgZWxlbWVudFR5cGUsIHJlbmRlckxhbmVzKSB7CiAgICByZXNldFN1c3BlbmRlZEN1cnJlbnRPbk1vdW50SW5MZWdhY3lNb2RlKF9jdXJyZW50LCB3b3JrSW5Qcm9ncmVzcyk7CiAgICB2YXIgcHJvcHMgPSB3b3JrSW5Qcm9ncmVzcy5wZW5kaW5nUHJvcHM7CiAgICB2YXIgbGF6eUNvbXBvbmVudCA9IGVsZW1lbnRUeXBlOwogICAgdmFyIHBheWxvYWQgPSBsYXp5Q29tcG9uZW50Ll9wYXlsb2FkOwogICAgdmFyIGluaXQgPSBsYXp5Q29tcG9uZW50Ll9pbml0OwogICAgdmFyIENvbXBvbmVudCA9IGluaXQocGF5bG9hZCk7IC8vIFN0b3JlIHRoZSB1bndyYXBwZWQgY29tcG9uZW50IGluIHRoZSB0eXBlLgoKICAgIHdvcmtJblByb2dyZXNzLnR5cGUgPSBDb21wb25lbnQ7CiAgICB2YXIgcmVzb2x2ZWRUYWcgPSB3b3JrSW5Qcm9ncmVzcy50YWcgPSByZXNvbHZlTGF6eUNvbXBvbmVudFRhZyhDb21wb25lbnQpOwogICAgdmFyIHJlc29sdmVkUHJvcHMgPSByZXNvbHZlRGVmYXVsdFByb3BzKENvbXBvbmVudCwgcHJvcHMpOwogICAgdmFyIGNoaWxkOwoKICAgIHN3aXRjaCAocmVzb2x2ZWRUYWcpIHsKICAgICAgY2FzZSBGdW5jdGlvbkNvbXBvbmVudDoKICAgICAgICB7CiAgICAgICAgICB7CiAgICAgICAgICAgIHZhbGlkYXRlRnVuY3Rpb25Db21wb25lbnRJbkRldih3b3JrSW5Qcm9ncmVzcywgQ29tcG9uZW50KTsKICAgICAgICAgICAgd29ya0luUHJvZ3Jlc3MudHlwZSA9IENvbXBvbmVudCA9IHJlc29sdmVGdW5jdGlvbkZvckhvdFJlbG9hZGluZyhDb21wb25lbnQpOwogICAgICAgICAgfQoKICAgICAgICAgIGNoaWxkID0gdXBkYXRlRnVuY3Rpb25Db21wb25lbnQobnVsbCwgd29ya0luUHJvZ3Jlc3MsIENvbXBvbmVudCwgcmVzb2x2ZWRQcm9wcywgcmVuZGVyTGFuZXMpOwogICAgICAgICAgcmV0dXJuIGNoaWxkOwogICAgICAgIH0KCiAgICAgIGNhc2UgQ2xhc3NDb21wb25lbnQ6CiAgICAgICAgewogICAgICAgICAgewogICAgICAgICAgICB3b3JrSW5Qcm9ncmVzcy50eXBlID0gQ29tcG9uZW50ID0gcmVzb2x2ZUNsYXNzRm9ySG90UmVsb2FkaW5nKENvbXBvbmVudCk7CiAgICAgICAgICB9CgogICAgICAgICAgY2hpbGQgPSB1cGRhdGVDbGFzc0NvbXBvbmVudChudWxsLCB3b3JrSW5Qcm9ncmVzcywgQ29tcG9uZW50LCByZXNvbHZlZFByb3BzLCByZW5kZXJMYW5lcyk7CiAgICAgICAgICByZXR1cm4gY2hpbGQ7CiAgICAgICAgfQoKICAgICAgY2FzZSBGb3J3YXJkUmVmOgogICAgICAgIHsKICAgICAgICAgIHsKICAgICAgICAgICAgd29ya0luUHJvZ3Jlc3MudHlwZSA9IENvbXBvbmVudCA9IHJlc29sdmVGb3J3YXJkUmVmRm9ySG90UmVsb2FkaW5nKENvbXBvbmVudCk7CiAgICAgICAgICB9CgogICAgICAgICAgY2hpbGQgPSB1cGRhdGVGb3J3YXJkUmVmKG51bGwsIHdvcmtJblByb2dyZXNzLCBDb21wb25lbnQsIHJlc29sdmVkUHJvcHMsIHJlbmRlckxhbmVzKTsKICAgICAgICAgIHJldHVybiBjaGlsZDsKICAgICAgICB9CgogICAgICBjYXNlIE1lbW9Db21wb25lbnQ6CiAgICAgICAgewogICAgICAgICAgewogICAgICAgICAgICBpZiAod29ya0luUHJvZ3Jlc3MudHlwZSAhPT0gd29ya0luUHJvZ3Jlc3MuZWxlbWVudFR5cGUpIHsKICAgICAgICAgICAgICB2YXIgb3V0ZXJQcm9wVHlwZXMgPSBDb21wb25lbnQucHJvcFR5cGVzOwoKICAgICAgICAgICAgICBpZiAob3V0ZXJQcm9wVHlwZXMpIHsKICAgICAgICAgICAgICAgIGNoZWNrUHJvcFR5cGVzKG91dGVyUHJvcFR5cGVzLCByZXNvbHZlZFByb3BzLCAvLyBSZXNvbHZlZCBmb3Igb3V0ZXIgb25seQogICAgICAgICAgICAgICAgJ3Byb3AnLCBnZXRDb21wb25lbnROYW1lRnJvbVR5cGUoQ29tcG9uZW50KSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgY2hpbGQgPSB1cGRhdGVNZW1vQ29tcG9uZW50KG51bGwsIHdvcmtJblByb2dyZXNzLCBDb21wb25lbnQsIHJlc29sdmVEZWZhdWx0UHJvcHMoQ29tcG9uZW50LnR5cGUsIHJlc29sdmVkUHJvcHMpLCAvLyBUaGUgaW5uZXIgdHlwZSBjYW4gaGF2ZSBkZWZhdWx0cyB0b28KICAgICAgICAgIHJlbmRlckxhbmVzKTsKICAgICAgICAgIHJldHVybiBjaGlsZDsKICAgICAgICB9CiAgICB9CgogICAgdmFyIGhpbnQgPSAnJzsKCiAgICB7CiAgICAgIGlmIChDb21wb25lbnQgIT09IG51bGwgJiYgdHlwZW9mIENvbXBvbmVudCA9PT0gJ29iamVjdCcgJiYgQ29tcG9uZW50LiQkdHlwZW9mID09PSBSRUFDVF9MQVpZX1RZUEUpIHsKICAgICAgICBoaW50ID0gJyBEaWQgeW91IHdyYXAgYSBjb21wb25lbnQgaW4gUmVhY3QubGF6eSgpIG1vcmUgdGhhbiBvbmNlPyc7CiAgICAgIH0KICAgIH0gLy8gVGhpcyBtZXNzYWdlIGludGVudGlvbmFsbHkgZG9lc24ndCBtZW50aW9uIEZvcndhcmRSZWYgb3IgTWVtb0NvbXBvbmVudAogICAgLy8gYmVjYXVzZSB0aGUgZmFjdCB0aGF0IGl0J3MgYSBzZXBhcmF0ZSB0eXBlIG9mIHdvcmsgaXMgYW4KICAgIC8vIGltcGxlbWVudGF0aW9uIGRldGFpbC4KCgogICAgdGhyb3cgbmV3IEVycm9yKCJFbGVtZW50IHR5cGUgaXMgaW52YWxpZC4gUmVjZWl2ZWQgYSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG86ICIgKyBDb21wb25lbnQgKyAiLiAiICsgKCJMYXp5IGVsZW1lbnQgdHlwZSBtdXN0IHJlc29sdmUgdG8gYSBjbGFzcyBvciBmdW5jdGlvbi4iICsgaGludCkpOwogIH0KCiAgZnVuY3Rpb24gbW91bnRJbmNvbXBsZXRlQ2xhc3NDb21wb25lbnQoX2N1cnJlbnQsIHdvcmtJblByb2dyZXNzLCBDb21wb25lbnQsIG5leHRQcm9wcywgcmVuZGVyTGFuZXMpIHsKICAgIHJlc2V0U3VzcGVuZGVkQ3VycmVudE9uTW91bnRJbkxlZ2FjeU1vZGUoX2N1cnJlbnQsIHdvcmtJblByb2dyZXNzKTsgLy8gUHJvbW90ZSB0aGUgZmliZXIgdG8gYSBjbGFzcyBhbmQgdHJ5IHJlbmRlcmluZyBhZ2Fpbi4KCiAgICB3b3JrSW5Qcm9ncmVzcy50YWcgPSBDbGFzc0NvbXBvbmVudDsgLy8gVGhlIHJlc3Qgb2YgdGhpcyBmdW5jdGlvbiBpcyBhIGZvcmsgb2YgYHVwZGF0ZUNsYXNzQ29tcG9uZW50YAogICAgLy8gUHVzaCBjb250ZXh0IHByb3ZpZGVycyBlYXJseSB0byBwcmV2ZW50IGNvbnRleHQgc3RhY2sgbWlzbWF0Y2hlcy4KICAgIC8vIER1cmluZyBtb3VudGluZyB3ZSBkb24ndCBrbm93IHRoZSBjaGlsZCBjb250ZXh0IHlldCBhcyB0aGUgaW5zdGFuY2UgZG9lc24ndCBleGlzdC4KICAgIC8vIFdlIHdpbGwgaW52YWxpZGF0ZSB0aGUgY2hpbGQgY29udGV4dCBpbiBmaW5pc2hDbGFzc0NvbXBvbmVudCgpIHJpZ2h0IGFmdGVyIHJlbmRlcmluZy4KCiAgICB2YXIgaGFzQ29udGV4dDsKCiAgICBpZiAoaXNDb250ZXh0UHJvdmlkZXIoQ29tcG9uZW50KSkgewogICAgICBoYXNDb250ZXh0ID0gdHJ1ZTsKICAgICAgcHVzaENvbnRleHRQcm92aWRlcih3b3JrSW5Qcm9ncmVzcyk7CiAgICB9IGVsc2UgewogICAgICBoYXNDb250ZXh0ID0gZmFsc2U7CiAgICB9CgogICAgcHJlcGFyZVRvUmVhZENvbnRleHQod29ya0luUHJvZ3Jlc3MsIHJlbmRlckxhbmVzKTsKICAgIGNvbnN0cnVjdENsYXNzSW5zdGFuY2Uod29ya0luUHJvZ3Jlc3MsIENvbXBvbmVudCwgbmV4dFByb3BzKTsKICAgIG1vdW50Q2xhc3NJbnN0YW5jZSh3b3JrSW5Qcm9ncmVzcywgQ29tcG9uZW50LCBuZXh0UHJvcHMsIHJlbmRlckxhbmVzKTsKICAgIHJldHVybiBmaW5pc2hDbGFzc0NvbXBvbmVudChudWxsLCB3b3JrSW5Qcm9ncmVzcywgQ29tcG9uZW50LCB0cnVlLCBoYXNDb250ZXh0LCByZW5kZXJMYW5lcyk7CiAgfQoKICBmdW5jdGlvbiBtb3VudEluZGV0ZXJtaW5hdGVDb21wb25lbnQoX2N1cnJlbnQsIHdvcmtJblByb2dyZXNzLCBDb21wb25lbnQsIHJlbmRlckxhbmVzKSB7CiAgICByZXNldFN1c3BlbmRlZEN1cnJlbnRPbk1vdW50SW5MZWdhY3lNb2RlKF9jdXJyZW50LCB3b3JrSW5Qcm9ncmVzcyk7CiAgICB2YXIgcHJvcHMgPSB3b3JrSW5Qcm9ncmVzcy5wZW5kaW5nUHJvcHM7CiAgICB2YXIgY29udGV4dDsKCiAgICB7CiAgICAgIHZhciB1bm1hc2tlZENvbnRleHQgPSBnZXRVbm1hc2tlZENvbnRleHQod29ya0luUHJvZ3Jlc3MsIENvbXBvbmVudCwgZmFsc2UpOwogICAgICBjb250ZXh0ID0gZ2V0TWFza2VkQ29udGV4dCh3b3JrSW5Qcm9ncmVzcywgdW5tYXNrZWRDb250ZXh0KTsKICAgIH0KCiAgICBwcmVwYXJlVG9SZWFkQ29udGV4dCh3b3JrSW5Qcm9ncmVzcywgcmVuZGVyTGFuZXMpOwogICAgdmFyIHZhbHVlOwogICAgdmFyIGhhc0lkOwoKICAgIHsKICAgICAgbWFya0NvbXBvbmVudFJlbmRlclN0YXJ0ZWQod29ya0luUHJvZ3Jlc3MpOwogICAgfQoKICAgIHsKICAgICAgaWYgKENvbXBvbmVudC5wcm90b3R5cGUgJiYgdHlwZW9mIENvbXBvbmVudC5wcm90b3R5cGUucmVuZGVyID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgdmFyIGNvbXBvbmVudE5hbWUgPSBnZXRDb21wb25lbnROYW1lRnJvbVR5cGUoQ29tcG9uZW50KSB8fCAnVW5rbm93bic7CgogICAgICAgIGlmICghZGlkV2FybkFib3V0QmFkQ2xhc3NbY29tcG9uZW50TmFtZV0pIHsKICAgICAgICAgIGVycm9yKCJUaGUgPCVzIC8+IGNvbXBvbmVudCBhcHBlYXJzIHRvIGhhdmUgYSByZW5kZXIgbWV0aG9kLCBidXQgZG9lc24ndCBleHRlbmQgUmVhY3QuQ29tcG9uZW50LiAiICsgJ1RoaXMgaXMgbGlrZWx5IHRvIGNhdXNlIGVycm9ycy4gQ2hhbmdlICVzIHRvIGV4dGVuZCBSZWFjdC5Db21wb25lbnQgaW5zdGVhZC4nLCBjb21wb25lbnROYW1lLCBjb21wb25lbnROYW1lKTsKCiAgICAgICAgICBkaWRXYXJuQWJvdXRCYWRDbGFzc1tjb21wb25lbnROYW1lXSA9IHRydWU7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAod29ya0luUHJvZ3Jlc3MubW9kZSAmIFN0cmljdExlZ2FjeU1vZGUpIHsKICAgICAgICBSZWFjdFN0cmljdE1vZGVXYXJuaW5ncy5yZWNvcmRMZWdhY3lDb250ZXh0V2FybmluZyh3b3JrSW5Qcm9ncmVzcywgbnVsbCk7CiAgICAgIH0KCiAgICAgIHNldElzUmVuZGVyaW5nKHRydWUpOwogICAgICBSZWFjdEN1cnJlbnRPd25lciQxLmN1cnJlbnQgPSB3b3JrSW5Qcm9ncmVzczsKICAgICAgdmFsdWUgPSByZW5kZXJXaXRoSG9va3MobnVsbCwgd29ya0luUHJvZ3Jlc3MsIENvbXBvbmVudCwgcHJvcHMsIGNvbnRleHQsIHJlbmRlckxhbmVzKTsKICAgICAgaGFzSWQgPSBjaGVja0RpZFJlbmRlcklkSG9vaygpOwogICAgICBzZXRJc1JlbmRlcmluZyhmYWxzZSk7CiAgICB9CgogICAgewogICAgICBtYXJrQ29tcG9uZW50UmVuZGVyU3RvcHBlZCgpOwogICAgfSAvLyBSZWFjdCBEZXZUb29scyByZWFkcyB0aGlzIGZsYWcuCgoKICAgIHdvcmtJblByb2dyZXNzLmZsYWdzIHw9IFBlcmZvcm1lZFdvcms7CgogICAgewogICAgICAvLyBTdXBwb3J0IGZvciBtb2R1bGUgY29tcG9uZW50cyBpcyBkZXByZWNhdGVkIGFuZCBpcyByZW1vdmVkIGJlaGluZCBhIGZsYWcuCiAgICAgIC8vIFdoZXRoZXIgb3Igbm90IGl0IHdvdWxkIGNyYXNoIGxhdGVyLCB3ZSB3YW50IHRvIHNob3cgYSBnb29kIG1lc3NhZ2UgaW4gREVWIGZpcnN0LgogICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAhPT0gbnVsbCAmJiB0eXBlb2YgdmFsdWUucmVuZGVyID09PSAnZnVuY3Rpb24nICYmIHZhbHVlLiQkdHlwZW9mID09PSB1bmRlZmluZWQpIHsKICAgICAgICB2YXIgX2NvbXBvbmVudE5hbWUgPSBnZXRDb21wb25lbnROYW1lRnJvbVR5cGUoQ29tcG9uZW50KSB8fCAnVW5rbm93bic7CgogICAgICAgIGlmICghZGlkV2FybkFib3V0TW9kdWxlUGF0dGVybkNvbXBvbmVudFtfY29tcG9uZW50TmFtZV0pIHsKICAgICAgICAgIGVycm9yKCdUaGUgPCVzIC8+IGNvbXBvbmVudCBhcHBlYXJzIHRvIGJlIGEgZnVuY3Rpb24gY29tcG9uZW50IHRoYXQgcmV0dXJucyBhIGNsYXNzIGluc3RhbmNlLiAnICsgJ0NoYW5nZSAlcyB0byBhIGNsYXNzIHRoYXQgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQgaW5zdGVhZC4gJyArICJJZiB5b3UgY2FuJ3QgdXNlIGEgY2xhc3MgdHJ5IGFzc2lnbmluZyB0aGUgcHJvdG90eXBlIG9uIHRoZSBmdW5jdGlvbiBhcyBhIHdvcmthcm91bmQuICIgKyAiYCVzLnByb3RvdHlwZSA9IFJlYWN0LkNvbXBvbmVudC5wcm90b3R5cGVgLiBEb24ndCB1c2UgYW4gYXJyb3cgZnVuY3Rpb24gc2luY2UgaXQgIiArICdjYW5ub3QgYmUgY2FsbGVkIHdpdGggYG5ld2AgYnkgUmVhY3QuJywgX2NvbXBvbmVudE5hbWUsIF9jb21wb25lbnROYW1lLCBfY29tcG9uZW50TmFtZSk7CgogICAgICAgICAgZGlkV2FybkFib3V0TW9kdWxlUGF0dGVybkNvbXBvbmVudFtfY29tcG9uZW50TmFtZV0gPSB0cnVlOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGlmICggLy8gUnVuIHRoZXNlIGNoZWNrcyBpbiBwcm9kdWN0aW9uIG9ubHkgaWYgdGhlIGZsYWcgaXMgb2ZmLgogICAgLy8gRXZlbnR1YWxseSB3ZSdsbCBkZWxldGUgdGhpcyBicmFuY2ggYWx0b2dldGhlci4KICAgICB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICE9PSBudWxsICYmIHR5cGVvZiB2YWx1ZS5yZW5kZXIgPT09ICdmdW5jdGlvbicgJiYgdmFsdWUuJCR0eXBlb2YgPT09IHVuZGVmaW5lZCkgewogICAgICB7CiAgICAgICAgdmFyIF9jb21wb25lbnROYW1lMiA9IGdldENvbXBvbmVudE5hbWVGcm9tVHlwZShDb21wb25lbnQpIHx8ICdVbmtub3duJzsKCiAgICAgICAgaWYgKCFkaWRXYXJuQWJvdXRNb2R1bGVQYXR0ZXJuQ29tcG9uZW50W19jb21wb25lbnROYW1lMl0pIHsKICAgICAgICAgIGVycm9yKCdUaGUgPCVzIC8+IGNvbXBvbmVudCBhcHBlYXJzIHRvIGJlIGEgZnVuY3Rpb24gY29tcG9uZW50IHRoYXQgcmV0dXJucyBhIGNsYXNzIGluc3RhbmNlLiAnICsgJ0NoYW5nZSAlcyB0byBhIGNsYXNzIHRoYXQgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQgaW5zdGVhZC4gJyArICJJZiB5b3UgY2FuJ3QgdXNlIGEgY2xhc3MgdHJ5IGFzc2lnbmluZyB0aGUgcHJvdG90eXBlIG9uIHRoZSBmdW5jdGlvbiBhcyBhIHdvcmthcm91bmQuICIgKyAiYCVzLnByb3RvdHlwZSA9IFJlYWN0LkNvbXBvbmVudC5wcm90b3R5cGVgLiBEb24ndCB1c2UgYW4gYXJyb3cgZnVuY3Rpb24gc2luY2UgaXQgIiArICdjYW5ub3QgYmUgY2FsbGVkIHdpdGggYG5ld2AgYnkgUmVhY3QuJywgX2NvbXBvbmVudE5hbWUyLCBfY29tcG9uZW50TmFtZTIsIF9jb21wb25lbnROYW1lMik7CgogICAgICAgICAgZGlkV2FybkFib3V0TW9kdWxlUGF0dGVybkNvbXBvbmVudFtfY29tcG9uZW50TmFtZTJdID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0gLy8gUHJvY2VlZCB1bmRlciB0aGUgYXNzdW1wdGlvbiB0aGF0IHRoaXMgaXMgYSBjbGFzcyBpbnN0YW5jZQoKCiAgICAgIHdvcmtJblByb2dyZXNzLnRhZyA9IENsYXNzQ29tcG9uZW50OyAvLyBUaHJvdyBvdXQgYW55IGhvb2tzIHRoYXQgd2VyZSB1c2VkLgoKICAgICAgd29ya0luUHJvZ3Jlc3MubWVtb2l6ZWRTdGF0ZSA9IG51bGw7CiAgICAgIHdvcmtJblByb2dyZXNzLnVwZGF0ZVF1ZXVlID0gbnVsbDsgLy8gUHVzaCBjb250ZXh0IHByb3ZpZGVycyBlYXJseSB0byBwcmV2ZW50IGNvbnRleHQgc3RhY2sgbWlzbWF0Y2hlcy4KICAgICAgLy8gRHVyaW5nIG1vdW50aW5nIHdlIGRvbid0IGtub3cgdGhlIGNoaWxkIGNvbnRleHQgeWV0IGFzIHRoZSBpbnN0YW5jZSBkb2Vzbid0IGV4aXN0LgogICAgICAvLyBXZSB3aWxsIGludmFsaWRhdGUgdGhlIGNoaWxkIGNvbnRleHQgaW4gZmluaXNoQ2xhc3NDb21wb25lbnQoKSByaWdodCBhZnRlciByZW5kZXJpbmcuCgogICAgICB2YXIgaGFzQ29udGV4dCA9IGZhbHNlOwoKICAgICAgaWYgKGlzQ29udGV4dFByb3ZpZGVyKENvbXBvbmVudCkpIHsKICAgICAgICBoYXNDb250ZXh0ID0gdHJ1ZTsKICAgICAgICBwdXNoQ29udGV4dFByb3ZpZGVyKHdvcmtJblByb2dyZXNzKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBoYXNDb250ZXh0ID0gZmFsc2U7CiAgICAgIH0KCiAgICAgIHdvcmtJblByb2dyZXNzLm1lbW9pemVkU3RhdGUgPSB2YWx1ZS5zdGF0ZSAhPT0gbnVsbCAmJiB2YWx1ZS5zdGF0ZSAhPT0gdW5kZWZpbmVkID8gdmFsdWUuc3RhdGUgOiBudWxsOwogICAgICBpbml0aWFsaXplVXBkYXRlUXVldWUod29ya0luUHJvZ3Jlc3MpOwogICAgICBhZG9wdENsYXNzSW5zdGFuY2Uod29ya0luUHJvZ3Jlc3MsIHZhbHVlKTsKICAgICAgbW91bnRDbGFzc0luc3RhbmNlKHdvcmtJblByb2dyZXNzLCBDb21wb25lbnQsIHByb3BzLCByZW5kZXJMYW5lcyk7CiAgICAgIHJldHVybiBmaW5pc2hDbGFzc0NvbXBvbmVudChudWxsLCB3b3JrSW5Qcm9ncmVzcywgQ29tcG9uZW50LCB0cnVlLCBoYXNDb250ZXh0LCByZW5kZXJMYW5lcyk7CiAgICB9IGVsc2UgewogICAgICAvLyBQcm9jZWVkIHVuZGVyIHRoZSBhc3N1bXB0aW9uIHRoYXQgdGhpcyBpcyBhIGZ1bmN0aW9uIGNvbXBvbmVudAogICAgICB3b3JrSW5Qcm9ncmVzcy50YWcgPSBGdW5jdGlvbkNvbXBvbmVudDsKCiAgICAgIHsKCiAgICAgICAgaWYgKCB3b3JrSW5Qcm9ncmVzcy5tb2RlICYgU3RyaWN0TGVnYWN5TW9kZSkgewogICAgICAgICAgc2V0SXNTdHJpY3RNb2RlRm9yRGV2dG9vbHModHJ1ZSk7CgogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgdmFsdWUgPSByZW5kZXJXaXRoSG9va3MobnVsbCwgd29ya0luUHJvZ3Jlc3MsIENvbXBvbmVudCwgcHJvcHMsIGNvbnRleHQsIHJlbmRlckxhbmVzKTsKICAgICAgICAgICAgaGFzSWQgPSBjaGVja0RpZFJlbmRlcklkSG9vaygpOwogICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgc2V0SXNTdHJpY3RNb2RlRm9yRGV2dG9vbHMoZmFsc2UpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGdldElzSHlkcmF0aW5nKCkgJiYgaGFzSWQpIHsKICAgICAgICBwdXNoTWF0ZXJpYWxpemVkVHJlZUlkKHdvcmtJblByb2dyZXNzKTsKICAgICAgfQoKICAgICAgcmVjb25jaWxlQ2hpbGRyZW4obnVsbCwgd29ya0luUHJvZ3Jlc3MsIHZhbHVlLCByZW5kZXJMYW5lcyk7CgogICAgICB7CiAgICAgICAgdmFsaWRhdGVGdW5jdGlvbkNvbXBvbmVudEluRGV2KHdvcmtJblByb2dyZXNzLCBDb21wb25lbnQpOwogICAgICB9CgogICAgICByZXR1cm4gd29ya0luUHJvZ3Jlc3MuY2hpbGQ7CiAgICB9CiAgfQoKICBmdW5jdGlvbiB2YWxpZGF0ZUZ1bmN0aW9uQ29tcG9uZW50SW5EZXYod29ya0luUHJvZ3Jlc3MsIENvbXBvbmVudCkgewogICAgewogICAgICBpZiAoQ29tcG9uZW50KSB7CiAgICAgICAgaWYgKENvbXBvbmVudC5jaGlsZENvbnRleHRUeXBlcykgewogICAgICAgICAgZXJyb3IoJyVzKC4uLik6IGNoaWxkQ29udGV4dFR5cGVzIGNhbm5vdCBiZSBkZWZpbmVkIG9uIGEgZnVuY3Rpb24gY29tcG9uZW50LicsIENvbXBvbmVudC5kaXNwbGF5TmFtZSB8fCBDb21wb25lbnQubmFtZSB8fCAnQ29tcG9uZW50Jyk7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAod29ya0luUHJvZ3Jlc3MucmVmICE9PSBudWxsKSB7CiAgICAgICAgdmFyIGluZm8gPSAnJzsKICAgICAgICB2YXIgb3duZXJOYW1lID0gZ2V0Q3VycmVudEZpYmVyT3duZXJOYW1lSW5EZXZPck51bGwoKTsKCiAgICAgICAgaWYgKG93bmVyTmFtZSkgewogICAgICAgICAgaW5mbyArPSAnXG5cbkNoZWNrIHRoZSByZW5kZXIgbWV0aG9kIG9mIGAnICsgb3duZXJOYW1lICsgJ2AuJzsKICAgICAgICB9CgogICAgICAgIHZhciB3YXJuaW5nS2V5ID0gb3duZXJOYW1lIHx8ICcnOwogICAgICAgIHZhciBkZWJ1Z1NvdXJjZSA9IHdvcmtJblByb2dyZXNzLl9kZWJ1Z1NvdXJjZTsKCiAgICAgICAgaWYgKGRlYnVnU291cmNlKSB7CiAgICAgICAgICB3YXJuaW5nS2V5ID0gZGVidWdTb3VyY2UuZmlsZU5hbWUgKyAnOicgKyBkZWJ1Z1NvdXJjZS5saW5lTnVtYmVyOwogICAgICAgIH0KCiAgICAgICAgaWYgKCFkaWRXYXJuQWJvdXRGdW5jdGlvblJlZnNbd2FybmluZ0tleV0pIHsKICAgICAgICAgIGRpZFdhcm5BYm91dEZ1bmN0aW9uUmVmc1t3YXJuaW5nS2V5XSA9IHRydWU7CgogICAgICAgICAgZXJyb3IoJ0Z1bmN0aW9uIGNvbXBvbmVudHMgY2Fubm90IGJlIGdpdmVuIHJlZnMuICcgKyAnQXR0ZW1wdHMgdG8gYWNjZXNzIHRoaXMgcmVmIHdpbGwgZmFpbC4gJyArICdEaWQgeW91IG1lYW4gdG8gdXNlIFJlYWN0LmZvcndhcmRSZWYoKT8lcycsIGluZm8pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKCBDb21wb25lbnQuZGVmYXVsdFByb3BzICE9PSB1bmRlZmluZWQpIHsKICAgICAgICB2YXIgY29tcG9uZW50TmFtZSA9IGdldENvbXBvbmVudE5hbWVGcm9tVHlwZShDb21wb25lbnQpIHx8ICdVbmtub3duJzsKCiAgICAgICAgaWYgKCFkaWRXYXJuQWJvdXREZWZhdWx0UHJvcHNPbkZ1bmN0aW9uQ29tcG9uZW50W2NvbXBvbmVudE5hbWVdKSB7CiAgICAgICAgICBlcnJvcignJXM6IFN1cHBvcnQgZm9yIGRlZmF1bHRQcm9wcyB3aWxsIGJlIHJlbW92ZWQgZnJvbSBmdW5jdGlvbiBjb21wb25lbnRzICcgKyAnaW4gYSBmdXR1cmUgbWFqb3IgcmVsZWFzZS4gVXNlIEphdmFTY3JpcHQgZGVmYXVsdCBwYXJhbWV0ZXJzIGluc3RlYWQuJywgY29tcG9uZW50TmFtZSk7CgogICAgICAgICAgZGlkV2FybkFib3V0RGVmYXVsdFByb3BzT25GdW5jdGlvbkNvbXBvbmVudFtjb21wb25lbnROYW1lXSA9IHRydWU7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAodHlwZW9mIENvbXBvbmVudC5nZXREZXJpdmVkU3RhdGVGcm9tUHJvcHMgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICB2YXIgX2NvbXBvbmVudE5hbWUzID0gZ2V0Q29tcG9uZW50TmFtZUZyb21UeXBlKENvbXBvbmVudCkgfHwgJ1Vua25vd24nOwoKICAgICAgICBpZiAoIWRpZFdhcm5BYm91dEdldERlcml2ZWRTdGF0ZU9uRnVuY3Rpb25Db21wb25lbnRbX2NvbXBvbmVudE5hbWUzXSkgewogICAgICAgICAgZXJyb3IoJyVzOiBGdW5jdGlvbiBjb21wb25lbnRzIGRvIG5vdCBzdXBwb3J0IGdldERlcml2ZWRTdGF0ZUZyb21Qcm9wcy4nLCBfY29tcG9uZW50TmFtZTMpOwoKICAgICAgICAgIGRpZFdhcm5BYm91dEdldERlcml2ZWRTdGF0ZU9uRnVuY3Rpb25Db21wb25lbnRbX2NvbXBvbmVudE5hbWUzXSA9IHRydWU7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAodHlwZW9mIENvbXBvbmVudC5jb250ZXh0VHlwZSA9PT0gJ29iamVjdCcgJiYgQ29tcG9uZW50LmNvbnRleHRUeXBlICE9PSBudWxsKSB7CiAgICAgICAgdmFyIF9jb21wb25lbnROYW1lNCA9IGdldENvbXBvbmVudE5hbWVGcm9tVHlwZShDb21wb25lbnQpIHx8ICdVbmtub3duJzsKCiAgICAgICAgaWYgKCFkaWRXYXJuQWJvdXRDb250ZXh0VHlwZU9uRnVuY3Rpb25Db21wb25lbnRbX2NvbXBvbmVudE5hbWU0XSkgewogICAgICAgICAgZXJyb3IoJyVzOiBGdW5jdGlvbiBjb21wb25lbnRzIGRvIG5vdCBzdXBwb3J0IGNvbnRleHRUeXBlLicsIF9jb21wb25lbnROYW1lNCk7CgogICAgICAgICAgZGlkV2FybkFib3V0Q29udGV4dFR5cGVPbkZ1bmN0aW9uQ29tcG9uZW50W19jb21wb25lbnROYW1lNF0gPSB0cnVlOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KCiAgdmFyIFNVU1BFTkRFRF9NQVJLRVIgPSB7CiAgICBkZWh5ZHJhdGVkOiBudWxsLAogICAgdHJlZUNvbnRleHQ6IG51bGwsCiAgICByZXRyeUxhbmU6IE5vTGFuZQogIH07CgogIGZ1bmN0aW9uIG1vdW50U3VzcGVuc2VPZmZzY3JlZW5TdGF0ZShyZW5kZXJMYW5lcykgewogICAgcmV0dXJuIHsKICAgICAgYmFzZUxhbmVzOiByZW5kZXJMYW5lcywKICAgICAgY2FjaGVQb29sOiBnZXRTdXNwZW5kZWRDYWNoZSgpLAogICAgICB0cmFuc2l0aW9uczogbnVsbAogICAgfTsKICB9CgogIGZ1bmN0aW9uIHVwZGF0ZVN1c3BlbnNlT2Zmc2NyZWVuU3RhdGUocHJldk9mZnNjcmVlblN0YXRlLCByZW5kZXJMYW5lcykgewogICAgdmFyIGNhY2hlUG9vbCA9IG51bGw7CgogICAgcmV0dXJuIHsKICAgICAgYmFzZUxhbmVzOiBtZXJnZUxhbmVzKHByZXZPZmZzY3JlZW5TdGF0ZS5iYXNlTGFuZXMsIHJlbmRlckxhbmVzKSwKICAgICAgY2FjaGVQb29sOiBjYWNoZVBvb2wsCiAgICAgIHRyYW5zaXRpb25zOiBwcmV2T2Zmc2NyZWVuU3RhdGUudHJhbnNpdGlvbnMKICAgIH07CiAgfSAvLyBUT0RPOiBQcm9iYWJseSBzaG91bGQgaW5saW5lIHRoaXMgYmFjawoKCiAgZnVuY3Rpb24gc2hvdWxkUmVtYWluT25GYWxsYmFjayhzdXNwZW5zZUNvbnRleHQsIGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCByZW5kZXJMYW5lcykgewogICAgLy8gSWYgd2UncmUgYWxyZWFkeSBzaG93aW5nIGEgZmFsbGJhY2ssIHRoZXJlIGFyZSBjYXNlcyB3aGVyZSB3ZSBuZWVkIHRvCiAgICAvLyByZW1haW4gb24gdGhhdCBmYWxsYmFjayByZWdhcmRsZXNzIG9mIHdoZXRoZXIgdGhlIGNvbnRlbnQgaGFzIHJlc29sdmVkLgogICAgLy8gRm9yIGV4YW1wbGUsIFN1c3BlbnNlTGlzdCBjb29yZGluYXRlcyB3aGVuIG5lc3RlZCBjb250ZW50IGFwcGVhcnMuCiAgICBpZiAoY3VycmVudCAhPT0gbnVsbCkgewogICAgICB2YXIgc3VzcGVuc2VTdGF0ZSA9IGN1cnJlbnQubWVtb2l6ZWRTdGF0ZTsKCiAgICAgIGlmIChzdXNwZW5zZVN0YXRlID09PSBudWxsKSB7CiAgICAgICAgLy8gQ3VycmVudGx5IHNob3dpbmcgY29udGVudC4gRG9uJ3QgaGlkZSBpdCwgZXZlbiBpZiBGb3JjZVN1c3BlbnNlRmFsbGJhY2sKICAgICAgICAvLyBpcyB0cnVlLiBNb3JlIHByZWNpc2UgbmFtZSBtaWdodCBiZSAiRm9yY2VSZW1haW5TdXNwZW5zZUZhbGxiYWNrIi4KICAgICAgICAvLyBOb3RlOiBUaGlzIGlzIGEgZmFjdG9yaW5nIHNtZWxsLiBDYW4ndCByZW1haW4gb24gYSBmYWxsYmFjayBpZiB0aGVyZSdzCiAgICAgICAgLy8gbm8gZmFsbGJhY2sgdG8gcmVtYWluIG9uLgogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgfSAvLyBOb3QgY3VycmVudGx5IHNob3dpbmcgY29udGVudC4gQ29uc3VsdCB0aGUgU3VzcGVuc2UgY29udGV4dC4KCgogICAgcmV0dXJuIGhhc1N1c3BlbnNlQ29udGV4dChzdXNwZW5zZUNvbnRleHQsIEZvcmNlU3VzcGVuc2VGYWxsYmFjayk7CiAgfQoKICBmdW5jdGlvbiBnZXRSZW1haW5pbmdXb3JrSW5QcmltYXJ5VHJlZShjdXJyZW50LCByZW5kZXJMYW5lcykgewogICAgLy8gVE9ETzogU2hvdWxkIG5vdCByZW1vdmUgcmVuZGVyIGxhbmVzIHRoYXQgd2VyZSBwaW5nZWQgZHVyaW5nIHRoaXMgcmVuZGVyCiAgICByZXR1cm4gcmVtb3ZlTGFuZXMoY3VycmVudC5jaGlsZExhbmVzLCByZW5kZXJMYW5lcyk7CiAgfQoKICBmdW5jdGlvbiB1cGRhdGVTdXNwZW5zZUNvbXBvbmVudChjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcywgcmVuZGVyTGFuZXMpIHsKICAgIHZhciBuZXh0UHJvcHMgPSB3b3JrSW5Qcm9ncmVzcy5wZW5kaW5nUHJvcHM7IC8vIFRoaXMgaXMgdXNlZCBieSBEZXZUb29scyB0byBmb3JjZSBhIGJvdW5kYXJ5IHRvIHN1c3BlbmQuCgogICAgewogICAgICBpZiAoc2hvdWxkU3VzcGVuZCh3b3JrSW5Qcm9ncmVzcykpIHsKICAgICAgICB3b3JrSW5Qcm9ncmVzcy5mbGFncyB8PSBEaWRDYXB0dXJlOwogICAgICB9CiAgICB9CgogICAgdmFyIHN1c3BlbnNlQ29udGV4dCA9IHN1c3BlbnNlU3RhY2tDdXJzb3IuY3VycmVudDsKICAgIHZhciBzaG93RmFsbGJhY2sgPSBmYWxzZTsKICAgIHZhciBkaWRTdXNwZW5kID0gKHdvcmtJblByb2dyZXNzLmZsYWdzICYgRGlkQ2FwdHVyZSkgIT09IE5vRmxhZ3M7CgogICAgaWYgKGRpZFN1c3BlbmQgfHwgc2hvdWxkUmVtYWluT25GYWxsYmFjayhzdXNwZW5zZUNvbnRleHQsIGN1cnJlbnQpKSB7CiAgICAgIC8vIFNvbWV0aGluZyBpbiB0aGlzIGJvdW5kYXJ5J3Mgc3VidHJlZSBhbHJlYWR5IHN1c3BlbmRlZC4gU3dpdGNoIHRvCiAgICAgIC8vIHJlbmRlcmluZyB0aGUgZmFsbGJhY2sgY2hpbGRyZW4uCiAgICAgIHNob3dGYWxsYmFjayA9IHRydWU7CiAgICAgIHdvcmtJblByb2dyZXNzLmZsYWdzICY9IH5EaWRDYXB0dXJlOwogICAgfSBlbHNlIHsKICAgICAgLy8gQXR0ZW1wdGluZyB0aGUgbWFpbiBjb250ZW50CiAgICAgIGlmIChjdXJyZW50ID09PSBudWxsIHx8IGN1cnJlbnQubWVtb2l6ZWRTdGF0ZSAhPT0gbnVsbCkgewogICAgICAgIC8vIFRoaXMgaXMgYSBuZXcgbW91bnQgb3IgdGhpcyBib3VuZGFyeSBpcyBhbHJlYWR5IHNob3dpbmcgYSBmYWxsYmFjayBzdGF0ZS4KICAgICAgICAvLyBNYXJrIHRoaXMgc3VidHJlZSBjb250ZXh0IGFzIGhhdmluZyBhdCBsZWFzdCBvbmUgaW52aXNpYmxlIHBhcmVudCB0aGF0IGNvdWxkCiAgICAgICAgLy8gaGFuZGxlIHRoZSBmYWxsYmFjayBzdGF0ZS4KICAgICAgICAvLyBBdm9pZGVkIGJvdW5kYXJpZXMgYXJlIG5vdCBjb25zaWRlcmVkIHNpbmNlIHRoZXkgY2Fubm90IGhhbmRsZSBwcmVmZXJyZWQgZmFsbGJhY2sgc3RhdGVzLgogICAgICAgIHsKICAgICAgICAgIHN1c3BlbnNlQ29udGV4dCA9IGFkZFN1YnRyZWVTdXNwZW5zZUNvbnRleHQoc3VzcGVuc2VDb250ZXh0LCBJbnZpc2libGVQYXJlbnRTdXNwZW5zZUNvbnRleHQpOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHN1c3BlbnNlQ29udGV4dCA9IHNldERlZmF1bHRTaGFsbG93U3VzcGVuc2VDb250ZXh0KHN1c3BlbnNlQ29udGV4dCk7CiAgICBwdXNoU3VzcGVuc2VDb250ZXh0KHdvcmtJblByb2dyZXNzLCBzdXNwZW5zZUNvbnRleHQpOyAvLyBPSywgdGhlIG5leHQgcGFydCBpcyBjb25mdXNpbmcuIFdlJ3JlIGFib3V0IHRvIHJlY29uY2lsZSB0aGUgU3VzcGVuc2UKICAgIC8vIGJvdW5kYXJ5J3MgY2hpbGRyZW4uIFRoaXMgaW52b2x2ZXMgc29tZSBjdXN0b20gcmVjb25jaWxpYXRpb24gbG9naWMuIFR3bwogICAgLy8gbWFpbiByZWFzb25zIHRoaXMgaXMgc28gY29tcGxpY2F0ZWQuCiAgICAvLwogICAgLy8gRmlyc3QsIExlZ2FjeSBNb2RlIGhhcyBkaWZmZXJlbnQgc2VtYW50aWNzIGZvciBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eS4gVGhlCiAgICAvLyBwcmltYXJ5IHRyZWUgd2lsbCBjb21taXQgaW4gYW4gaW5jb25zaXN0ZW50IHN0YXRlLCBzbyB3aGVuIHdlIGRvIHRoZQogICAgLy8gc2Vjb25kIHBhc3MgdG8gcmVuZGVyIHRoZSBmYWxsYmFjaywgd2UgZG8gc29tZSBleGNlZWRpbmdseSwgdWgsIGNsZXZlcgogICAgLy8gaGFja3MgdG8gbWFrZSB0aGF0IG5vdCB0b3RhbGx5IGJyZWFrLiBMaWtlIHRyYW5zZmVycmluZyBlZmZlY3RzIGFuZAogICAgLy8gZGVsZXRpb25zIGZyb20gaGlkZGVuIHRyZWUuIEluIENvbmN1cnJlbnQgTW9kZSwgaXQncyBtdWNoIHNpbXBsZXIsCiAgICAvLyBiZWNhdXNlIHdlIGJhaWxvdXQgb24gdGhlIHByaW1hcnkgdHJlZSBjb21wbGV0ZWx5IGFuZCBsZWF2ZSBpdCBpbiBpdHMgb2xkCiAgICAvLyBzdGF0ZSwgbm8gZWZmZWN0cy4gU2FtZSBhcyB3aGF0IHdlIGRvIGZvciBPZmZzY3JlZW4gKGV4Y2VwdCB0aGF0CiAgICAvLyBPZmZzY3JlZW4gZG9lc24ndCBoYXZlIHRoZSBmaXJzdCByZW5kZXIgcGFzcykuCiAgICAvLwogICAgLy8gU2Vjb25kIGlzIGh5ZHJhdGlvbi4gRHVyaW5nIGh5ZHJhdGlvbiwgdGhlIFN1c3BlbnNlIGZpYmVyIGhhcyBhIHNsaWdodGx5CiAgICAvLyBkaWZmZXJlbnQgbGF5b3V0LCB3aGVyZSB0aGUgY2hpbGQgcG9pbnRzIHRvIGEgZGVoeWRyYXRlZCBmcmFnbWVudCwgd2hpY2gKICAgIC8vIGNvbnRhaW5zIHRoZSBET00gcmVuZGVyZWQgYnkgdGhlIHNlcnZlci4KICAgIC8vCiAgICAvLyBUaGlyZCwgZXZlbiBpZiB5b3Ugc2V0IGFsbCB0aGF0IGFzaWRlLCBTdXNwZW5zZSBpcyBsaWtlIGVycm9yIGJvdW5kYXJpZXMgaW4KICAgIC8vIHRoYXQgd2UgZmlyc3Qgd2UgdHJ5IHRvIHJlbmRlciBvbmUgdHJlZSwgYW5kIGlmIHRoYXQgZmFpbHMsIHdlIHJlbmRlciBhZ2FpbgogICAgLy8gYW5kIHN3aXRjaCB0byBhIGRpZmZlcmVudCB0cmVlLiBMaWtlIGEgdHJ5L2NhdGNoIGJsb2NrLiBTbyB3ZSBoYXZlIHRvIHRyYWNrCiAgICAvLyB3aGljaCBicmFuY2ggd2UncmUgY3VycmVudGx5IHJlbmRlcmluZy4gSWRlYWxseSB3ZSB3b3VsZCBtb2RlbCB0aGlzIHVzaW5nCiAgICAvLyBhIHN0YWNrLgoKICAgIGlmIChjdXJyZW50ID09PSBudWxsKSB7CiAgICAgIC8vIEluaXRpYWwgbW91bnQKICAgICAgLy8gU3BlY2lhbCBwYXRoIGZvciBoeWRyYXRpb24KICAgICAgLy8gSWYgd2UncmUgY3VycmVudGx5IGh5ZHJhdGluZywgdHJ5IHRvIGh5ZHJhdGUgdGhpcyBib3VuZGFyeS4KICAgICAgdHJ5VG9DbGFpbU5leHRIeWRyYXRhYmxlSW5zdGFuY2Uod29ya0luUHJvZ3Jlc3MpOyAvLyBUaGlzIGNvdWxkJ3ZlIGJlZW4gYSBkZWh5ZHJhdGVkIHN1c3BlbnNlIGNvbXBvbmVudC4KCiAgICAgIHZhciBzdXNwZW5zZVN0YXRlID0gd29ya0luUHJvZ3Jlc3MubWVtb2l6ZWRTdGF0ZTsKCiAgICAgIGlmIChzdXNwZW5zZVN0YXRlICE9PSBudWxsKSB7CiAgICAgICAgdmFyIGRlaHlkcmF0ZWQgPSBzdXNwZW5zZVN0YXRlLmRlaHlkcmF0ZWQ7CgogICAgICAgIGlmIChkZWh5ZHJhdGVkICE9PSBudWxsKSB7CiAgICAgICAgICByZXR1cm4gbW91bnREZWh5ZHJhdGVkU3VzcGVuc2VDb21wb25lbnQod29ya0luUHJvZ3Jlc3MsIGRlaHlkcmF0ZWQpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdmFyIG5leHRQcmltYXJ5Q2hpbGRyZW4gPSBuZXh0UHJvcHMuY2hpbGRyZW47CiAgICAgIHZhciBuZXh0RmFsbGJhY2tDaGlsZHJlbiA9IG5leHRQcm9wcy5mYWxsYmFjazsKCiAgICAgIGlmIChzaG93RmFsbGJhY2spIHsKICAgICAgICB2YXIgZmFsbGJhY2tGcmFnbWVudCA9IG1vdW50U3VzcGVuc2VGYWxsYmFja0NoaWxkcmVuKHdvcmtJblByb2dyZXNzLCBuZXh0UHJpbWFyeUNoaWxkcmVuLCBuZXh0RmFsbGJhY2tDaGlsZHJlbiwgcmVuZGVyTGFuZXMpOwogICAgICAgIHZhciBwcmltYXJ5Q2hpbGRGcmFnbWVudCA9IHdvcmtJblByb2dyZXNzLmNoaWxkOwogICAgICAgIHByaW1hcnlDaGlsZEZyYWdtZW50Lm1lbW9pemVkU3RhdGUgPSBtb3VudFN1c3BlbnNlT2Zmc2NyZWVuU3RhdGUocmVuZGVyTGFuZXMpOwogICAgICAgIHdvcmtJblByb2dyZXNzLm1lbW9pemVkU3RhdGUgPSBTVVNQRU5ERURfTUFSS0VSOwoKICAgICAgICByZXR1cm4gZmFsbGJhY2tGcmFnbWVudDsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gbW91bnRTdXNwZW5zZVByaW1hcnlDaGlsZHJlbih3b3JrSW5Qcm9ncmVzcywgbmV4dFByaW1hcnlDaGlsZHJlbik7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIC8vIFRoaXMgaXMgYW4gdXBkYXRlLgogICAgICAvLyBTcGVjaWFsIHBhdGggZm9yIGh5ZHJhdGlvbgogICAgICB2YXIgcHJldlN0YXRlID0gY3VycmVudC5tZW1vaXplZFN0YXRlOwoKICAgICAgaWYgKHByZXZTdGF0ZSAhPT0gbnVsbCkgewogICAgICAgIHZhciBfZGVoeWRyYXRlZCA9IHByZXZTdGF0ZS5kZWh5ZHJhdGVkOwoKICAgICAgICBpZiAoX2RlaHlkcmF0ZWQgIT09IG51bGwpIHsKICAgICAgICAgIHJldHVybiB1cGRhdGVEZWh5ZHJhdGVkU3VzcGVuc2VDb21wb25lbnQoY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIGRpZFN1c3BlbmQsIG5leHRQcm9wcywgX2RlaHlkcmF0ZWQsIHByZXZTdGF0ZSwgcmVuZGVyTGFuZXMpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHNob3dGYWxsYmFjaykgewogICAgICAgIHZhciBfbmV4dEZhbGxiYWNrQ2hpbGRyZW4gPSBuZXh0UHJvcHMuZmFsbGJhY2s7CiAgICAgICAgdmFyIF9uZXh0UHJpbWFyeUNoaWxkcmVuID0gbmV4dFByb3BzLmNoaWxkcmVuOwogICAgICAgIHZhciBmYWxsYmFja0NoaWxkRnJhZ21lbnQgPSB1cGRhdGVTdXNwZW5zZUZhbGxiYWNrQ2hpbGRyZW4oY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIF9uZXh0UHJpbWFyeUNoaWxkcmVuLCBfbmV4dEZhbGxiYWNrQ2hpbGRyZW4sIHJlbmRlckxhbmVzKTsKICAgICAgICB2YXIgX3ByaW1hcnlDaGlsZEZyYWdtZW50MiA9IHdvcmtJblByb2dyZXNzLmNoaWxkOwogICAgICAgIHZhciBwcmV2T2Zmc2NyZWVuU3RhdGUgPSBjdXJyZW50LmNoaWxkLm1lbW9pemVkU3RhdGU7CiAgICAgICAgX3ByaW1hcnlDaGlsZEZyYWdtZW50Mi5tZW1vaXplZFN0YXRlID0gcHJldk9mZnNjcmVlblN0YXRlID09PSBudWxsID8gbW91bnRTdXNwZW5zZU9mZnNjcmVlblN0YXRlKHJlbmRlckxhbmVzKSA6IHVwZGF0ZVN1c3BlbnNlT2Zmc2NyZWVuU3RhdGUocHJldk9mZnNjcmVlblN0YXRlLCByZW5kZXJMYW5lcyk7CgogICAgICAgIF9wcmltYXJ5Q2hpbGRGcmFnbWVudDIuY2hpbGRMYW5lcyA9IGdldFJlbWFpbmluZ1dvcmtJblByaW1hcnlUcmVlKGN1cnJlbnQsIHJlbmRlckxhbmVzKTsKICAgICAgICB3b3JrSW5Qcm9ncmVzcy5tZW1vaXplZFN0YXRlID0gU1VTUEVOREVEX01BUktFUjsKICAgICAgICByZXR1cm4gZmFsbGJhY2tDaGlsZEZyYWdtZW50OwogICAgICB9IGVsc2UgewogICAgICAgIHZhciBfbmV4dFByaW1hcnlDaGlsZHJlbjIgPSBuZXh0UHJvcHMuY2hpbGRyZW47CgogICAgICAgIHZhciBfcHJpbWFyeUNoaWxkRnJhZ21lbnQzID0gdXBkYXRlU3VzcGVuc2VQcmltYXJ5Q2hpbGRyZW4oY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIF9uZXh0UHJpbWFyeUNoaWxkcmVuMiwgcmVuZGVyTGFuZXMpOwoKICAgICAgICB3b3JrSW5Qcm9ncmVzcy5tZW1vaXplZFN0YXRlID0gbnVsbDsKICAgICAgICByZXR1cm4gX3ByaW1hcnlDaGlsZEZyYWdtZW50MzsKICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gbW91bnRTdXNwZW5zZVByaW1hcnlDaGlsZHJlbih3b3JrSW5Qcm9ncmVzcywgcHJpbWFyeUNoaWxkcmVuLCByZW5kZXJMYW5lcykgewogICAgdmFyIG1vZGUgPSB3b3JrSW5Qcm9ncmVzcy5tb2RlOwogICAgdmFyIHByaW1hcnlDaGlsZFByb3BzID0gewogICAgICBtb2RlOiAndmlzaWJsZScsCiAgICAgIGNoaWxkcmVuOiBwcmltYXJ5Q2hpbGRyZW4KICAgIH07CiAgICB2YXIgcHJpbWFyeUNoaWxkRnJhZ21lbnQgPSBtb3VudFdvcmtJblByb2dyZXNzT2Zmc2NyZWVuRmliZXIocHJpbWFyeUNoaWxkUHJvcHMsIG1vZGUpOwogICAgcHJpbWFyeUNoaWxkRnJhZ21lbnQucmV0dXJuID0gd29ya0luUHJvZ3Jlc3M7CiAgICB3b3JrSW5Qcm9ncmVzcy5jaGlsZCA9IHByaW1hcnlDaGlsZEZyYWdtZW50OwogICAgcmV0dXJuIHByaW1hcnlDaGlsZEZyYWdtZW50OwogIH0KCiAgZnVuY3Rpb24gbW91bnRTdXNwZW5zZUZhbGxiYWNrQ2hpbGRyZW4od29ya0luUHJvZ3Jlc3MsIHByaW1hcnlDaGlsZHJlbiwgZmFsbGJhY2tDaGlsZHJlbiwgcmVuZGVyTGFuZXMpIHsKICAgIHZhciBtb2RlID0gd29ya0luUHJvZ3Jlc3MubW9kZTsKICAgIHZhciBwcm9ncmVzc2VkUHJpbWFyeUZyYWdtZW50ID0gd29ya0luUHJvZ3Jlc3MuY2hpbGQ7CiAgICB2YXIgcHJpbWFyeUNoaWxkUHJvcHMgPSB7CiAgICAgIG1vZGU6ICdoaWRkZW4nLAogICAgICBjaGlsZHJlbjogcHJpbWFyeUNoaWxkcmVuCiAgICB9OwogICAgdmFyIHByaW1hcnlDaGlsZEZyYWdtZW50OwogICAgdmFyIGZhbGxiYWNrQ2hpbGRGcmFnbWVudDsKCiAgICBpZiAoKG1vZGUgJiBDb25jdXJyZW50TW9kZSkgPT09IE5vTW9kZSAmJiBwcm9ncmVzc2VkUHJpbWFyeUZyYWdtZW50ICE9PSBudWxsKSB7CiAgICAgIC8vIEluIGxlZ2FjeSBtb2RlLCB3ZSBjb21taXQgdGhlIHByaW1hcnkgdHJlZSBhcyBpZiBpdCBzdWNjZXNzZnVsbHkKICAgICAgLy8gY29tcGxldGVkLCBldmVuIHRob3VnaCBpdCdzIGluIGFuIGluY29uc2lzdGVudCBzdGF0ZS4KICAgICAgcHJpbWFyeUNoaWxkRnJhZ21lbnQgPSBwcm9ncmVzc2VkUHJpbWFyeUZyYWdtZW50OwogICAgICBwcmltYXJ5Q2hpbGRGcmFnbWVudC5jaGlsZExhbmVzID0gTm9MYW5lczsKICAgICAgcHJpbWFyeUNoaWxkRnJhZ21lbnQucGVuZGluZ1Byb3BzID0gcHJpbWFyeUNoaWxkUHJvcHM7CgogICAgICBpZiAoIHdvcmtJblByb2dyZXNzLm1vZGUgJiBQcm9maWxlTW9kZSkgewogICAgICAgIC8vIFJlc2V0IHRoZSBkdXJhdGlvbnMgZnJvbSB0aGUgZmlyc3QgcGFzcyBzbyB0aGV5IGFyZW4ndCBpbmNsdWRlZCBpbiB0aGUKICAgICAgICAvLyBmaW5hbCBhbW91bnRzLiBUaGlzIHNlZW1zIGNvdW50ZXJpbnR1aXRpdmUsIHNpbmNlIHdlJ3JlIGludGVudGlvbmFsbHkKICAgICAgICAvLyBub3QgbWVhc3VyaW5nIHBhcnQgb2YgdGhlIHJlbmRlciBwaGFzZSwgYnV0IHRoaXMgbWFrZXMgaXQgbWF0Y2ggd2hhdCB3ZQogICAgICAgIC8vIGRvIGluIENvbmN1cnJlbnQgTW9kZS4KICAgICAgICBwcmltYXJ5Q2hpbGRGcmFnbWVudC5hY3R1YWxEdXJhdGlvbiA9IDA7CiAgICAgICAgcHJpbWFyeUNoaWxkRnJhZ21lbnQuYWN0dWFsU3RhcnRUaW1lID0gLTE7CiAgICAgICAgcHJpbWFyeUNoaWxkRnJhZ21lbnQuc2VsZkJhc2VEdXJhdGlvbiA9IDA7CiAgICAgICAgcHJpbWFyeUNoaWxkRnJhZ21lbnQudHJlZUJhc2VEdXJhdGlvbiA9IDA7CiAgICAgIH0KCiAgICAgIGZhbGxiYWNrQ2hpbGRGcmFnbWVudCA9IGNyZWF0ZUZpYmVyRnJvbUZyYWdtZW50KGZhbGxiYWNrQ2hpbGRyZW4sIG1vZGUsIHJlbmRlckxhbmVzLCBudWxsKTsKICAgIH0gZWxzZSB7CiAgICAgIHByaW1hcnlDaGlsZEZyYWdtZW50ID0gbW91bnRXb3JrSW5Qcm9ncmVzc09mZnNjcmVlbkZpYmVyKHByaW1hcnlDaGlsZFByb3BzLCBtb2RlKTsKICAgICAgZmFsbGJhY2tDaGlsZEZyYWdtZW50ID0gY3JlYXRlRmliZXJGcm9tRnJhZ21lbnQoZmFsbGJhY2tDaGlsZHJlbiwgbW9kZSwgcmVuZGVyTGFuZXMsIG51bGwpOwogICAgfQoKICAgIHByaW1hcnlDaGlsZEZyYWdtZW50LnJldHVybiA9IHdvcmtJblByb2dyZXNzOwogICAgZmFsbGJhY2tDaGlsZEZyYWdtZW50LnJldHVybiA9IHdvcmtJblByb2dyZXNzOwogICAgcHJpbWFyeUNoaWxkRnJhZ21lbnQuc2libGluZyA9IGZhbGxiYWNrQ2hpbGRGcmFnbWVudDsKICAgIHdvcmtJblByb2dyZXNzLmNoaWxkID0gcHJpbWFyeUNoaWxkRnJhZ21lbnQ7CiAgICByZXR1cm4gZmFsbGJhY2tDaGlsZEZyYWdtZW50OwogIH0KCiAgZnVuY3Rpb24gbW91bnRXb3JrSW5Qcm9ncmVzc09mZnNjcmVlbkZpYmVyKG9mZnNjcmVlblByb3BzLCBtb2RlLCByZW5kZXJMYW5lcykgewogICAgLy8gVGhlIHByb3BzIGFyZ3VtZW50IHRvIGBjcmVhdGVGaWJlckZyb21PZmZzY3JlZW5gIGlzIGBhbnlgIHR5cGVkLCBzbyB3ZSB1c2UKICAgIC8vIHRoaXMgd3JhcHBlciBmdW5jdGlvbiB0byBjb25zdHJhaW4gaXQuCiAgICByZXR1cm4gY3JlYXRlRmliZXJGcm9tT2Zmc2NyZWVuKG9mZnNjcmVlblByb3BzLCBtb2RlLCBOb0xhbmVzLCBudWxsKTsKICB9CgogIGZ1bmN0aW9uIHVwZGF0ZVdvcmtJblByb2dyZXNzT2Zmc2NyZWVuRmliZXIoY3VycmVudCwgb2Zmc2NyZWVuUHJvcHMpIHsKICAgIC8vIFRoZSBwcm9wcyBhcmd1bWVudCB0byBgY3JlYXRlV29ya0luUHJvZ3Jlc3NgIGlzIGBhbnlgIHR5cGVkLCBzbyB3ZSB1c2UgdGhpcwogICAgLy8gd3JhcHBlciBmdW5jdGlvbiB0byBjb25zdHJhaW4gaXQuCiAgICByZXR1cm4gY3JlYXRlV29ya0luUHJvZ3Jlc3MoY3VycmVudCwgb2Zmc2NyZWVuUHJvcHMpOwogIH0KCiAgZnVuY3Rpb24gdXBkYXRlU3VzcGVuc2VQcmltYXJ5Q2hpbGRyZW4oY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIHByaW1hcnlDaGlsZHJlbiwgcmVuZGVyTGFuZXMpIHsKICAgIHZhciBjdXJyZW50UHJpbWFyeUNoaWxkRnJhZ21lbnQgPSBjdXJyZW50LmNoaWxkOwogICAgdmFyIGN1cnJlbnRGYWxsYmFja0NoaWxkRnJhZ21lbnQgPSBjdXJyZW50UHJpbWFyeUNoaWxkRnJhZ21lbnQuc2libGluZzsKICAgIHZhciBwcmltYXJ5Q2hpbGRGcmFnbWVudCA9IHVwZGF0ZVdvcmtJblByb2dyZXNzT2Zmc2NyZWVuRmliZXIoY3VycmVudFByaW1hcnlDaGlsZEZyYWdtZW50LCB7CiAgICAgIG1vZGU6ICd2aXNpYmxlJywKICAgICAgY2hpbGRyZW46IHByaW1hcnlDaGlsZHJlbgogICAgfSk7CgogICAgaWYgKCh3b3JrSW5Qcm9ncmVzcy5tb2RlICYgQ29uY3VycmVudE1vZGUpID09PSBOb01vZGUpIHsKICAgICAgcHJpbWFyeUNoaWxkRnJhZ21lbnQubGFuZXMgPSByZW5kZXJMYW5lczsKICAgIH0KCiAgICBwcmltYXJ5Q2hpbGRGcmFnbWVudC5yZXR1cm4gPSB3b3JrSW5Qcm9ncmVzczsKICAgIHByaW1hcnlDaGlsZEZyYWdtZW50LnNpYmxpbmcgPSBudWxsOwoKICAgIGlmIChjdXJyZW50RmFsbGJhY2tDaGlsZEZyYWdtZW50ICE9PSBudWxsKSB7CiAgICAgIC8vIERlbGV0ZSB0aGUgZmFsbGJhY2sgY2hpbGQgZnJhZ21lbnQKICAgICAgdmFyIGRlbGV0aW9ucyA9IHdvcmtJblByb2dyZXNzLmRlbGV0aW9uczsKCiAgICAgIGlmIChkZWxldGlvbnMgPT09IG51bGwpIHsKICAgICAgICB3b3JrSW5Qcm9ncmVzcy5kZWxldGlvbnMgPSBbY3VycmVudEZhbGxiYWNrQ2hpbGRGcmFnbWVudF07CiAgICAgICAgd29ya0luUHJvZ3Jlc3MuZmxhZ3MgfD0gQ2hpbGREZWxldGlvbjsKICAgICAgfSBlbHNlIHsKICAgICAgICBkZWxldGlvbnMucHVzaChjdXJyZW50RmFsbGJhY2tDaGlsZEZyYWdtZW50KTsKICAgICAgfQogICAgfQoKICAgIHdvcmtJblByb2dyZXNzLmNoaWxkID0gcHJpbWFyeUNoaWxkRnJhZ21lbnQ7CiAgICByZXR1cm4gcHJpbWFyeUNoaWxkRnJhZ21lbnQ7CiAgfQoKICBmdW5jdGlvbiB1cGRhdGVTdXNwZW5zZUZhbGxiYWNrQ2hpbGRyZW4oY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIHByaW1hcnlDaGlsZHJlbiwgZmFsbGJhY2tDaGlsZHJlbiwgcmVuZGVyTGFuZXMpIHsKICAgIHZhciBtb2RlID0gd29ya0luUHJvZ3Jlc3MubW9kZTsKICAgIHZhciBjdXJyZW50UHJpbWFyeUNoaWxkRnJhZ21lbnQgPSBjdXJyZW50LmNoaWxkOwogICAgdmFyIGN1cnJlbnRGYWxsYmFja0NoaWxkRnJhZ21lbnQgPSBjdXJyZW50UHJpbWFyeUNoaWxkRnJhZ21lbnQuc2libGluZzsKICAgIHZhciBwcmltYXJ5Q2hpbGRQcm9wcyA9IHsKICAgICAgbW9kZTogJ2hpZGRlbicsCiAgICAgIGNoaWxkcmVuOiBwcmltYXJ5Q2hpbGRyZW4KICAgIH07CiAgICB2YXIgcHJpbWFyeUNoaWxkRnJhZ21lbnQ7CgogICAgaWYgKCAvLyBJbiBsZWdhY3kgbW9kZSwgd2UgY29tbWl0IHRoZSBwcmltYXJ5IHRyZWUgYXMgaWYgaXQgc3VjY2Vzc2Z1bGx5CiAgICAvLyBjb21wbGV0ZWQsIGV2ZW4gdGhvdWdoIGl0J3MgaW4gYW4gaW5jb25zaXN0ZW50IHN0YXRlLgogICAgKG1vZGUgJiBDb25jdXJyZW50TW9kZSkgPT09IE5vTW9kZSAmJiAvLyBNYWtlIHN1cmUgd2UncmUgb24gdGhlIHNlY29uZCBwYXNzLCBpLmUuIHRoZSBwcmltYXJ5IGNoaWxkIGZyYWdtZW50IHdhcwogICAgLy8gYWxyZWFkeSBjbG9uZWQuIEluIGxlZ2FjeSBtb2RlLCB0aGUgb25seSBjYXNlIHdoZXJlIHRoaXMgaXNuJ3QgdHJ1ZSBpcwogICAgLy8gd2hlbiBEZXZUb29scyBmb3JjZXMgdXMgdG8gZGlzcGxheSBhIGZhbGxiYWNrOyB3ZSBza2lwIHRoZSBmaXJzdCByZW5kZXIKICAgIC8vIHBhc3MgZW50aXJlbHkgYW5kIGdvIHN0cmFpZ2h0IHRvIHJlbmRlcmluZyB0aGUgZmFsbGJhY2suIChJbiBDb25jdXJyZW50CiAgICAvLyBNb2RlLCBTdXNwZW5zZUxpc3QgY2FuIGFsc28gdHJpZ2dlciB0aGlzIHNjZW5hcmlvLCBidXQgdGhpcyBpcyBhIGxlZ2FjeS0KICAgIC8vIG9ubHkgY29kZXBhdGguKQogICAgd29ya0luUHJvZ3Jlc3MuY2hpbGQgIT09IGN1cnJlbnRQcmltYXJ5Q2hpbGRGcmFnbWVudCkgewogICAgICB2YXIgcHJvZ3Jlc3NlZFByaW1hcnlGcmFnbWVudCA9IHdvcmtJblByb2dyZXNzLmNoaWxkOwogICAgICBwcmltYXJ5Q2hpbGRGcmFnbWVudCA9IHByb2dyZXNzZWRQcmltYXJ5RnJhZ21lbnQ7CiAgICAgIHByaW1hcnlDaGlsZEZyYWdtZW50LmNoaWxkTGFuZXMgPSBOb0xhbmVzOwogICAgICBwcmltYXJ5Q2hpbGRGcmFnbWVudC5wZW5kaW5nUHJvcHMgPSBwcmltYXJ5Q2hpbGRQcm9wczsKCiAgICAgIGlmICggd29ya0luUHJvZ3Jlc3MubW9kZSAmIFByb2ZpbGVNb2RlKSB7CiAgICAgICAgLy8gUmVzZXQgdGhlIGR1cmF0aW9ucyBmcm9tIHRoZSBmaXJzdCBwYXNzIHNvIHRoZXkgYXJlbid0IGluY2x1ZGVkIGluIHRoZQogICAgICAgIC8vIGZpbmFsIGFtb3VudHMuIFRoaXMgc2VlbXMgY291bnRlcmludHVpdGl2ZSwgc2luY2Ugd2UncmUgaW50ZW50aW9uYWxseQogICAgICAgIC8vIG5vdCBtZWFzdXJpbmcgcGFydCBvZiB0aGUgcmVuZGVyIHBoYXNlLCBidXQgdGhpcyBtYWtlcyBpdCBtYXRjaCB3aGF0IHdlCiAgICAgICAgLy8gZG8gaW4gQ29uY3VycmVudCBNb2RlLgogICAgICAgIHByaW1hcnlDaGlsZEZyYWdtZW50LmFjdHVhbER1cmF0aW9uID0gMDsKICAgICAgICBwcmltYXJ5Q2hpbGRGcmFnbWVudC5hY3R1YWxTdGFydFRpbWUgPSAtMTsKICAgICAgICBwcmltYXJ5Q2hpbGRGcmFnbWVudC5zZWxmQmFzZUR1cmF0aW9uID0gY3VycmVudFByaW1hcnlDaGlsZEZyYWdtZW50LnNlbGZCYXNlRHVyYXRpb247CiAgICAgICAgcHJpbWFyeUNoaWxkRnJhZ21lbnQudHJlZUJhc2VEdXJhdGlvbiA9IGN1cnJlbnRQcmltYXJ5Q2hpbGRGcmFnbWVudC50cmVlQmFzZUR1cmF0aW9uOwogICAgICB9IC8vIFRoZSBmYWxsYmFjayBmaWJlciB3YXMgYWRkZWQgYXMgYSBkZWxldGlvbiBkdXJpbmcgdGhlIGZpcnN0IHBhc3MuCiAgICAgIC8vIEhvd2V2ZXIsIHNpbmNlIHdlJ3JlIGdvaW5nIHRvIHJlbWFpbiBvbiB0aGUgZmFsbGJhY2ssIHdlIG5vIGxvbmdlciB3YW50CiAgICAgIC8vIHRvIGRlbGV0ZSBpdC4KCgogICAgICB3b3JrSW5Qcm9ncmVzcy5kZWxldGlvbnMgPSBudWxsOwogICAgfSBlbHNlIHsKICAgICAgcHJpbWFyeUNoaWxkRnJhZ21lbnQgPSB1cGRhdGVXb3JrSW5Qcm9ncmVzc09mZnNjcmVlbkZpYmVyKGN1cnJlbnRQcmltYXJ5Q2hpbGRGcmFnbWVudCwgcHJpbWFyeUNoaWxkUHJvcHMpOyAvLyBTaW5jZSB3ZSdyZSByZXVzaW5nIGEgY3VycmVudCB0cmVlLCB3ZSBuZWVkIHRvIHJldXNlIHRoZSBmbGFncywgdG9vLgogICAgICAvLyAoV2UgZG9uJ3QgZG8gdGhpcyBpbiBsZWdhY3kgbW9kZSwgYmVjYXVzZSBpbiBsZWdhY3kgbW9kZSB3ZSBkb24ndCByZS11c2UKICAgICAgLy8gdGhlIGN1cnJlbnQgdHJlZTsgc2VlIHByZXZpb3VzIGJyYW5jaC4pCgogICAgICBwcmltYXJ5Q2hpbGRGcmFnbWVudC5zdWJ0cmVlRmxhZ3MgPSBjdXJyZW50UHJpbWFyeUNoaWxkRnJhZ21lbnQuc3VidHJlZUZsYWdzICYgU3RhdGljTWFzazsKICAgIH0KCiAgICB2YXIgZmFsbGJhY2tDaGlsZEZyYWdtZW50OwoKICAgIGlmIChjdXJyZW50RmFsbGJhY2tDaGlsZEZyYWdtZW50ICE9PSBudWxsKSB7CiAgICAgIGZhbGxiYWNrQ2hpbGRGcmFnbWVudCA9IGNyZWF0ZVdvcmtJblByb2dyZXNzKGN1cnJlbnRGYWxsYmFja0NoaWxkRnJhZ21lbnQsIGZhbGxiYWNrQ2hpbGRyZW4pOwogICAgfSBlbHNlIHsKICAgICAgZmFsbGJhY2tDaGlsZEZyYWdtZW50ID0gY3JlYXRlRmliZXJGcm9tRnJhZ21lbnQoZmFsbGJhY2tDaGlsZHJlbiwgbW9kZSwgcmVuZGVyTGFuZXMsIG51bGwpOyAvLyBOZWVkcyBhIHBsYWNlbWVudCBlZmZlY3QgYmVjYXVzZSB0aGUgcGFyZW50ICh0aGUgU3VzcGVuc2UgYm91bmRhcnkpIGFscmVhZHkKICAgICAgLy8gbW91bnRlZCBidXQgdGhpcyBpcyBhIG5ldyBmaWJlci4KCiAgICAgIGZhbGxiYWNrQ2hpbGRGcmFnbWVudC5mbGFncyB8PSBQbGFjZW1lbnQ7CiAgICB9CgogICAgZmFsbGJhY2tDaGlsZEZyYWdtZW50LnJldHVybiA9IHdvcmtJblByb2dyZXNzOwogICAgcHJpbWFyeUNoaWxkRnJhZ21lbnQucmV0dXJuID0gd29ya0luUHJvZ3Jlc3M7CiAgICBwcmltYXJ5Q2hpbGRGcmFnbWVudC5zaWJsaW5nID0gZmFsbGJhY2tDaGlsZEZyYWdtZW50OwogICAgd29ya0luUHJvZ3Jlc3MuY2hpbGQgPSBwcmltYXJ5Q2hpbGRGcmFnbWVudDsKICAgIHJldHVybiBmYWxsYmFja0NoaWxkRnJhZ21lbnQ7CiAgfQoKICBmdW5jdGlvbiByZXRyeVN1c3BlbnNlQ29tcG9uZW50V2l0aG91dEh5ZHJhdGluZyhjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcywgcmVuZGVyTGFuZXMsIHJlY292ZXJhYmxlRXJyb3IpIHsKICAgIC8vIEZhbGxpbmcgYmFjayB0byBjbGllbnQgcmVuZGVyaW5nLiBCZWNhdXNlIHRoaXMgaGFzIHBlcmZvcm1hbmNlCiAgICAvLyBpbXBsaWNhdGlvbnMsIGl0J3MgY29uc2lkZXJlZCBhIHJlY292ZXJhYmxlIGVycm9yLCBldmVuIHRob3VnaCB0aGUgdXNlcgogICAgLy8gbGlrZWx5IHdvbid0IG9ic2VydmUgYW55dGhpbmcgd3Jvbmcgd2l0aCB0aGUgVUkuCiAgICAvLwogICAgLy8gVGhlIGVycm9yIGlzIHBhc3NlZCBpbiBhcyBhbiBhcmd1bWVudCB0byBlbmZvcmNlIHRoYXQgZXZlcnkgY2FsbGVyIHByb3ZpZGUKICAgIC8vIGEgY3VzdG9tIG1lc3NhZ2UsIG9yIGV4cGxpY2l0bHkgb3B0IG91dCAoY3VycmVudGx5IHRoZSBvbmx5IHBhdGggdGhhdCBvcHRzCiAgICAvLyBvdXQgaXMgbGVnYWN5IG1vZGU7IGV2ZXJ5IGNvbmN1cnJlbnQgcGF0aCBwcm92aWRlcyBhbiBlcnJvcikuCiAgICBpZiAocmVjb3ZlcmFibGVFcnJvciAhPT0gbnVsbCkgewogICAgICBxdWV1ZUh5ZHJhdGlvbkVycm9yKHJlY292ZXJhYmxlRXJyb3IpOwogICAgfSAvLyBUaGlzIHdpbGwgYWRkIHRoZSBvbGQgZmliZXIgdG8gdGhlIGRlbGV0aW9uIGxpc3QKCgogICAgcmVjb25jaWxlQ2hpbGRGaWJlcnMod29ya0luUHJvZ3Jlc3MsIGN1cnJlbnQuY2hpbGQsIG51bGwsIHJlbmRlckxhbmVzKTsgLy8gV2UncmUgbm93IG5vdCBzdXNwZW5kZWQgbm9yIGRlaHlkcmF0ZWQuCgogICAgdmFyIG5leHRQcm9wcyA9IHdvcmtJblByb2dyZXNzLnBlbmRpbmdQcm9wczsKICAgIHZhciBwcmltYXJ5Q2hpbGRyZW4gPSBuZXh0UHJvcHMuY2hpbGRyZW47CiAgICB2YXIgcHJpbWFyeUNoaWxkRnJhZ21lbnQgPSBtb3VudFN1c3BlbnNlUHJpbWFyeUNoaWxkcmVuKHdvcmtJblByb2dyZXNzLCBwcmltYXJ5Q2hpbGRyZW4pOyAvLyBOZWVkcyBhIHBsYWNlbWVudCBlZmZlY3QgYmVjYXVzZSB0aGUgcGFyZW50ICh0aGUgU3VzcGVuc2UgYm91bmRhcnkpIGFscmVhZHkKICAgIC8vIG1vdW50ZWQgYnV0IHRoaXMgaXMgYSBuZXcgZmliZXIuCgogICAgcHJpbWFyeUNoaWxkRnJhZ21lbnQuZmxhZ3MgfD0gUGxhY2VtZW50OwogICAgd29ya0luUHJvZ3Jlc3MubWVtb2l6ZWRTdGF0ZSA9IG51bGw7CiAgICByZXR1cm4gcHJpbWFyeUNoaWxkRnJhZ21lbnQ7CiAgfQoKICBmdW5jdGlvbiBtb3VudFN1c3BlbnNlRmFsbGJhY2tBZnRlclJldHJ5V2l0aG91dEh5ZHJhdGluZyhjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcywgcHJpbWFyeUNoaWxkcmVuLCBmYWxsYmFja0NoaWxkcmVuLCByZW5kZXJMYW5lcykgewogICAgdmFyIGZpYmVyTW9kZSA9IHdvcmtJblByb2dyZXNzLm1vZGU7CiAgICB2YXIgcHJpbWFyeUNoaWxkUHJvcHMgPSB7CiAgICAgIG1vZGU6ICd2aXNpYmxlJywKICAgICAgY2hpbGRyZW46IHByaW1hcnlDaGlsZHJlbgogICAgfTsKICAgIHZhciBwcmltYXJ5Q2hpbGRGcmFnbWVudCA9IG1vdW50V29ya0luUHJvZ3Jlc3NPZmZzY3JlZW5GaWJlcihwcmltYXJ5Q2hpbGRQcm9wcywgZmliZXJNb2RlKTsKICAgIHZhciBmYWxsYmFja0NoaWxkRnJhZ21lbnQgPSBjcmVhdGVGaWJlckZyb21GcmFnbWVudChmYWxsYmFja0NoaWxkcmVuLCBmaWJlck1vZGUsIHJlbmRlckxhbmVzLCBudWxsKTsgLy8gTmVlZHMgYSBwbGFjZW1lbnQgZWZmZWN0IGJlY2F1c2UgdGhlIHBhcmVudCAodGhlIFN1c3BlbnNlCiAgICAvLyBib3VuZGFyeSkgYWxyZWFkeSBtb3VudGVkIGJ1dCB0aGlzIGlzIGEgbmV3IGZpYmVyLgoKICAgIGZhbGxiYWNrQ2hpbGRGcmFnbWVudC5mbGFncyB8PSBQbGFjZW1lbnQ7CiAgICBwcmltYXJ5Q2hpbGRGcmFnbWVudC5yZXR1cm4gPSB3b3JrSW5Qcm9ncmVzczsKICAgIGZhbGxiYWNrQ2hpbGRGcmFnbWVudC5yZXR1cm4gPSB3b3JrSW5Qcm9ncmVzczsKICAgIHByaW1hcnlDaGlsZEZyYWdtZW50LnNpYmxpbmcgPSBmYWxsYmFja0NoaWxkRnJhZ21lbnQ7CiAgICB3b3JrSW5Qcm9ncmVzcy5jaGlsZCA9IHByaW1hcnlDaGlsZEZyYWdtZW50OwoKICAgIGlmICgod29ya0luUHJvZ3Jlc3MubW9kZSAmIENvbmN1cnJlbnRNb2RlKSAhPT0gTm9Nb2RlKSB7CiAgICAgIC8vIFdlIHdpbGwgaGF2ZSBkcm9wcGVkIHRoZSBlZmZlY3QgbGlzdCB3aGljaCBjb250YWlucyB0aGUKICAgICAgLy8gZGVsZXRpb24uIFdlIG5lZWQgdG8gcmVjb25jaWxlIHRvIGRlbGV0ZSB0aGUgY3VycmVudCBjaGlsZC4KICAgICAgcmVjb25jaWxlQ2hpbGRGaWJlcnMod29ya0luUHJvZ3Jlc3MsIGN1cnJlbnQuY2hpbGQsIG51bGwsIHJlbmRlckxhbmVzKTsKICAgIH0KCiAgICByZXR1cm4gZmFsbGJhY2tDaGlsZEZyYWdtZW50OwogIH0KCiAgZnVuY3Rpb24gbW91bnREZWh5ZHJhdGVkU3VzcGVuc2VDb21wb25lbnQod29ya0luUHJvZ3Jlc3MsIHN1c3BlbnNlSW5zdGFuY2UsIHJlbmRlckxhbmVzKSB7CiAgICAvLyBEdXJpbmcgdGhlIGZpcnN0IHBhc3MsIHdlJ2xsIGJhaWwgb3V0IGFuZCBub3QgZHJpbGwgaW50byB0aGUgY2hpbGRyZW4uCiAgICAvLyBJbnN0ZWFkLCB3ZSdsbCBsZWF2ZSB0aGUgY29udGVudCBpbiBwbGFjZSBhbmQgdHJ5IHRvIGh5ZHJhdGUgaXQgbGF0ZXIuCiAgICBpZiAoKHdvcmtJblByb2dyZXNzLm1vZGUgJiBDb25jdXJyZW50TW9kZSkgPT09IE5vTW9kZSkgewogICAgICB7CiAgICAgICAgZXJyb3IoJ0Nhbm5vdCBoeWRyYXRlIFN1c3BlbnNlIGluIGxlZ2FjeSBtb2RlLiBTd2l0Y2ggZnJvbSAnICsgJ1JlYWN0RE9NLmh5ZHJhdGUoZWxlbWVudCwgY29udGFpbmVyKSB0byAnICsgJ1JlYWN0RE9NQ2xpZW50Lmh5ZHJhdGVSb290KGNvbnRhaW5lciwgPEFwcCAvPiknICsgJy5yZW5kZXIoZWxlbWVudCkgb3IgcmVtb3ZlIHRoZSBTdXNwZW5zZSBjb21wb25lbnRzIGZyb20gJyArICd0aGUgc2VydmVyIHJlbmRlcmVkIGNvbXBvbmVudHMuJyk7CiAgICAgIH0KCiAgICAgIHdvcmtJblByb2dyZXNzLmxhbmVzID0gbGFuZVRvTGFuZXMoU3luY0xhbmUpOwogICAgfSBlbHNlIGlmIChpc1N1c3BlbnNlSW5zdGFuY2VGYWxsYmFjayhzdXNwZW5zZUluc3RhbmNlKSkgewogICAgICAvLyBUaGlzIGlzIGEgY2xpZW50LW9ubHkgYm91bmRhcnkuIFNpbmNlIHdlIHdvbid0IGdldCBhbnkgY29udGVudCBmcm9tIHRoZSBzZXJ2ZXIKICAgICAgLy8gZm9yIHRoaXMsIHdlIG5lZWQgdG8gc2NoZWR1bGUgdGhhdCBhdCBhIGhpZ2hlciBwcmlvcml0eSBiYXNlZCBvbiB3aGVuIGl0IHdvdWxkCiAgICAgIC8vIGhhdmUgdGltZWQgb3V0LiBJbiB0aGVvcnkgd2UgY291bGQgcmVuZGVyIGl0IGluIHRoaXMgcGFzcyBidXQgaXQgd291bGQgaGF2ZSB0aGUKICAgICAgLy8gd3JvbmcgcHJpb3JpdHkgYXNzb2NpYXRlZCB3aXRoIGl0IGFuZCB3aWxsIHByZXZlbnQgaHlkcmF0aW9uIG9mIHBhcmVudCBwYXRoLgogICAgICAvLyBJbnN0ZWFkLCB3ZSdsbCBsZWF2ZSB3b3JrIGxlZnQgb24gaXQgdG8gcmVuZGVyIGl0IGluIGEgc2VwYXJhdGUgY29tbWl0LgogICAgICAvLyBUT0RPIFRoaXMgdGltZSBzaG91bGQgYmUgdGhlIHRpbWUgYXQgd2hpY2ggdGhlIHNlcnZlciByZW5kZXJlZCByZXNwb25zZSB0aGF0IGlzCiAgICAgIC8vIGEgcGFyZW50IHRvIHRoaXMgYm91bmRhcnkgd2FzIGRpc3BsYXllZC4gSG93ZXZlciwgc2luY2Ugd2UgY3VycmVudGx5IGRvbid0IGhhdmUKICAgICAgLy8gYSBwcm90b2NvbCB0byB0cmFuc2ZlciB0aGF0IHRpbWUsIHdlJ2xsIGp1c3QgZXN0aW1hdGUgaXQgYnkgdXNpbmcgdGhlIGN1cnJlbnQKICAgICAgLy8gdGltZS4gVGhpcyB3aWxsIG1lYW4gdGhhdCBTdXNwZW5zZSB0aW1lb3V0cyBhcmUgc2xpZ2h0bHkgc2hpZnRlZCB0byBsYXRlciB0aGFuCiAgICAgIC8vIHRoZXkgc2hvdWxkIGJlLgogICAgICAvLyBTY2hlZHVsZSBhIG5vcm1hbCBwcmkgdXBkYXRlIHRvIHJlbmRlciB0aGlzIGNvbnRlbnQuCiAgICAgIHdvcmtJblByb2dyZXNzLmxhbmVzID0gbGFuZVRvTGFuZXMoRGVmYXVsdEh5ZHJhdGlvbkxhbmUpOwogICAgfSBlbHNlIHsKICAgICAgLy8gV2UnbGwgY29udGludWUgaHlkcmF0aW5nIHRoZSByZXN0IGF0IG9mZnNjcmVlbiBwcmlvcml0eSBzaW5jZSB3ZSdsbCBhbHJlYWR5CiAgICAgIC8vIGJlIHNob3dpbmcgdGhlIHJpZ2h0IGNvbnRlbnQgY29taW5nIGZyb20gdGhlIHNlcnZlciwgaXQgaXMgbm8gcnVzaC4KICAgICAgd29ya0luUHJvZ3Jlc3MubGFuZXMgPSBsYW5lVG9MYW5lcyhPZmZzY3JlZW5MYW5lKTsKICAgIH0KCiAgICByZXR1cm4gbnVsbDsKICB9CgogIGZ1bmN0aW9uIHVwZGF0ZURlaHlkcmF0ZWRTdXNwZW5zZUNvbXBvbmVudChjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcywgZGlkU3VzcGVuZCwgbmV4dFByb3BzLCBzdXNwZW5zZUluc3RhbmNlLCBzdXNwZW5zZVN0YXRlLCByZW5kZXJMYW5lcykgewogICAgaWYgKCFkaWRTdXNwZW5kKSB7CiAgICAgIC8vIFRoaXMgaXMgdGhlIGZpcnN0IHJlbmRlciBwYXNzLiBBdHRlbXB0IHRvIGh5ZHJhdGUuCiAgICAgIC8vIFdlIHNob3VsZCBuZXZlciBiZSBoeWRyYXRpbmcgYXQgdGhpcyBwb2ludCBiZWNhdXNlIGl0IGlzIHRoZSBmaXJzdCBwYXNzLAogICAgICAvLyBidXQgYWZ0ZXIgd2UndmUgYWxyZWFkeSBjb21taXR0ZWQgb25jZS4KICAgICAgd2FybklmSHlkcmF0aW5nKCk7CgogICAgICBpZiAoKHdvcmtJblByb2dyZXNzLm1vZGUgJiBDb25jdXJyZW50TW9kZSkgPT09IE5vTW9kZSkgewogICAgICAgIHJldHVybiByZXRyeVN1c3BlbnNlQ29tcG9uZW50V2l0aG91dEh5ZHJhdGluZyhjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcywgcmVuZGVyTGFuZXMsIC8vIFRPRE86IFdoZW4gd2UgZGVsZXRlIGxlZ2FjeSBtb2RlLCB3ZSBzaG91bGQgbWFrZSB0aGlzIGVycm9yIGFyZ3VtZW50CiAgICAgICAgLy8gcmVxdWlyZWQg4oCUIGV2ZXJ5IGNvbmN1cnJlbnQgbW9kZSBwYXRoIHRoYXQgY2F1c2VzIGh5ZHJhdGlvbiB0bwogICAgICAgIC8vIGRlLW9wdCB0byBjbGllbnQgcmVuZGVyaW5nIHNob3VsZCBoYXZlIGFuIGVycm9yIG1lc3NhZ2UuCiAgICAgICAgbnVsbCk7CiAgICAgIH0KCiAgICAgIGlmIChpc1N1c3BlbnNlSW5zdGFuY2VGYWxsYmFjayhzdXNwZW5zZUluc3RhbmNlKSkgewogICAgICAgIC8vIFRoaXMgYm91bmRhcnkgaXMgaW4gYSBwZXJtYW5lbnQgZmFsbGJhY2sgc3RhdGUuIEluIHRoaXMgY2FzZSwgd2UnbGwgbmV2ZXIKICAgICAgICAvLyBnZXQgYW4gdXBkYXRlIGFuZCB3ZSdsbCBuZXZlciBiZSBhYmxlIHRvIGh5ZHJhdGUgdGhlIGZpbmFsIGNvbnRlbnQuIExldCdzIGp1c3QgdHJ5IHRoZQogICAgICAgIC8vIGNsaWVudCBzaWRlIHJlbmRlciBpbnN0ZWFkLgogICAgICAgIHZhciBkaWdlc3QsIG1lc3NhZ2UsIHN0YWNrOwoKICAgICAgICB7CiAgICAgICAgICB2YXIgX2dldFN1c3BlbnNlSW5zdGFuY2VGID0gZ2V0U3VzcGVuc2VJbnN0YW5jZUZhbGxiYWNrRXJyb3JEZXRhaWxzKHN1c3BlbnNlSW5zdGFuY2UpOwoKICAgICAgICAgIGRpZ2VzdCA9IF9nZXRTdXNwZW5zZUluc3RhbmNlRi5kaWdlc3Q7CiAgICAgICAgICBtZXNzYWdlID0gX2dldFN1c3BlbnNlSW5zdGFuY2VGLm1lc3NhZ2U7CiAgICAgICAgICBzdGFjayA9IF9nZXRTdXNwZW5zZUluc3RhbmNlRi5zdGFjazsKICAgICAgICB9CgogICAgICAgIHZhciBlcnJvcjsKCiAgICAgICAgaWYgKG1lc3NhZ2UpIHsKICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC1pbnRlcm5hbC9wcm9kLWVycm9yLWNvZGVzCiAgICAgICAgICBlcnJvciA9IG5ldyBFcnJvcihtZXNzYWdlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZXJyb3IgPSBuZXcgRXJyb3IoJ1RoZSBzZXJ2ZXIgY291bGQgbm90IGZpbmlzaCB0aGlzIFN1c3BlbnNlIGJvdW5kYXJ5LCBsaWtlbHkgJyArICdkdWUgdG8gYW4gZXJyb3IgZHVyaW5nIHNlcnZlciByZW5kZXJpbmcuIFN3aXRjaGVkIHRvICcgKyAnY2xpZW50IHJlbmRlcmluZy4nKTsKICAgICAgICB9CgogICAgICAgIHZhciBjYXB0dXJlZFZhbHVlID0gY3JlYXRlQ2FwdHVyZWRWYWx1ZShlcnJvciwgZGlnZXN0LCBzdGFjayk7CiAgICAgICAgcmV0dXJuIHJldHJ5U3VzcGVuc2VDb21wb25lbnRXaXRob3V0SHlkcmF0aW5nKGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCByZW5kZXJMYW5lcywgY2FwdHVyZWRWYWx1ZSk7CiAgICAgIH0KICAgICAgLy8gYW55IGNvbnRleHQgaGFzIGNoYW5nZWQsIHdlIG5lZWQgdG8gdHJlYXQgaXMgYXMgaWYgdGhlIGlucHV0IG1pZ2h0IGhhdmUgY2hhbmdlZC4KCgogICAgICB2YXIgaGFzQ29udGV4dENoYW5nZWQgPSBpbmNsdWRlc1NvbWVMYW5lKHJlbmRlckxhbmVzLCBjdXJyZW50LmNoaWxkTGFuZXMpOwoKICAgICAgaWYgKGRpZFJlY2VpdmVVcGRhdGUgfHwgaGFzQ29udGV4dENoYW5nZWQpIHsKICAgICAgICAvLyBUaGlzIGJvdW5kYXJ5IGhhcyBjaGFuZ2VkIHNpbmNlIHRoZSBmaXJzdCByZW5kZXIuIFRoaXMgbWVhbnMgdGhhdCB3ZSBhcmUgbm93IHVuYWJsZSB0bwogICAgICAgIC8vIGh5ZHJhdGUgaXQuIFdlIG1pZ2h0IHN0aWxsIGJlIGFibGUgdG8gaHlkcmF0ZSBpdCB1c2luZyBhIGhpZ2hlciBwcmlvcml0eSBsYW5lLgogICAgICAgIHZhciByb290ID0gZ2V0V29ya0luUHJvZ3Jlc3NSb290KCk7CgogICAgICAgIGlmIChyb290ICE9PSBudWxsKSB7CiAgICAgICAgICB2YXIgYXR0ZW1wdEh5ZHJhdGlvbkF0TGFuZSA9IGdldEJ1bXBlZExhbmVGb3JIeWRyYXRpb24ocm9vdCwgcmVuZGVyTGFuZXMpOwoKICAgICAgICAgIGlmIChhdHRlbXB0SHlkcmF0aW9uQXRMYW5lICE9PSBOb0xhbmUgJiYgYXR0ZW1wdEh5ZHJhdGlvbkF0TGFuZSAhPT0gc3VzcGVuc2VTdGF0ZS5yZXRyeUxhbmUpIHsKICAgICAgICAgICAgLy8gSW50ZW50aW9uYWxseSBtdXRhdGluZyBzaW5jZSB0aGlzIHJlbmRlciB3aWxsIGdldCBpbnRlcnJ1cHRlZC4gVGhpcwogICAgICAgICAgICAvLyBpcyBvbmUgb2YgdGhlIHZlcnkgcmFyZSB0aW1lcyB3aGVyZSB3ZSBtdXRhdGUgdGhlIGN1cnJlbnQgdHJlZQogICAgICAgICAgICAvLyBkdXJpbmcgdGhlIHJlbmRlciBwaGFzZS4KICAgICAgICAgICAgc3VzcGVuc2VTdGF0ZS5yZXRyeUxhbmUgPSBhdHRlbXB0SHlkcmF0aW9uQXRMYW5lOyAvLyBUT0RPOiBJZGVhbGx5IHRoaXMgd291bGQgaW5oZXJpdCB0aGUgZXZlbnQgdGltZSBvZiB0aGUgY3VycmVudCByZW5kZXIKCiAgICAgICAgICAgIHZhciBldmVudFRpbWUgPSBOb1RpbWVzdGFtcDsKICAgICAgICAgICAgZW5xdWV1ZUNvbmN1cnJlbnRSZW5kZXJGb3JMYW5lKGN1cnJlbnQsIGF0dGVtcHRIeWRyYXRpb25BdExhbmUpOwogICAgICAgICAgICBzY2hlZHVsZVVwZGF0ZU9uRmliZXIocm9vdCwgY3VycmVudCwgYXR0ZW1wdEh5ZHJhdGlvbkF0TGFuZSwgZXZlbnRUaW1lKTsKICAgICAgICAgIH0KICAgICAgICB9IC8vIElmIHdlIGhhdmUgc2NoZWR1bGVkIGhpZ2hlciBwcmkgd29yayBhYm92ZSwgdGhpcyB3aWxsIHByb2JhYmx5IGp1c3QgYWJvcnQgdGhlIHJlbmRlcgogICAgICAgIC8vIHNpbmNlIHdlIG5vdyBoYXZlIGhpZ2hlciBwcmlvcml0eSB3b3JrLCBidXQgaW4gY2FzZSBpdCBkb2Vzbid0LCB3ZSBuZWVkIHRvIHByZXBhcmUgdG8KICAgICAgICAvLyByZW5kZXIgc29tZXRoaW5nLCBpZiB3ZSB0aW1lIG91dC4gRXZlbiBpZiB0aGF0IHJlcXVpcmVzIHVzIHRvIGRlbGV0ZSBldmVyeXRoaW5nIGFuZAogICAgICAgIC8vIHNraXAgaHlkcmF0aW9uLgogICAgICAgIC8vIERlbGF5IGhhdmluZyB0byBkbyB0aGlzIGFzIGxvbmcgYXMgdGhlIHN1c3BlbnNlIHRpbWVvdXQgYWxsb3dzIHVzLgoKCiAgICAgICAgcmVuZGVyRGlkU3VzcGVuZERlbGF5SWZQb3NzaWJsZSgpOwoKICAgICAgICB2YXIgX2NhcHR1cmVkVmFsdWUgPSBjcmVhdGVDYXB0dXJlZFZhbHVlKG5ldyBFcnJvcignVGhpcyBTdXNwZW5zZSBib3VuZGFyeSByZWNlaXZlZCBhbiB1cGRhdGUgYmVmb3JlIGl0IGZpbmlzaGVkICcgKyAnaHlkcmF0aW5nLiBUaGlzIGNhdXNlZCB0aGUgYm91bmRhcnkgdG8gc3dpdGNoIHRvIGNsaWVudCByZW5kZXJpbmcuICcgKyAnVGhlIHVzdWFsIHdheSB0byBmaXggdGhpcyBpcyB0byB3cmFwIHRoZSBvcmlnaW5hbCB1cGRhdGUgJyArICdpbiBzdGFydFRyYW5zaXRpb24uJykpOwoKICAgICAgICByZXR1cm4gcmV0cnlTdXNwZW5zZUNvbXBvbmVudFdpdGhvdXRIeWRyYXRpbmcoY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIHJlbmRlckxhbmVzLCBfY2FwdHVyZWRWYWx1ZSk7CiAgICAgIH0gZWxzZSBpZiAoaXNTdXNwZW5zZUluc3RhbmNlUGVuZGluZyhzdXNwZW5zZUluc3RhbmNlKSkgewogICAgICAgIC8vIFRoaXMgY29tcG9uZW50IGlzIHN0aWxsIHBlbmRpbmcgbW9yZSBkYXRhIGZyb20gdGhlIHNlcnZlciwgc28gd2UgY2FuJ3QgaHlkcmF0ZSBpdHMKICAgICAgICAvLyBjb250ZW50LiBXZSB0cmVhdCBpdCBhcyBpZiB0aGlzIGNvbXBvbmVudCBzdXNwZW5kZWQgaXRzZWxmLiBJdCBtaWdodCBzZWVtIGFzIGlmCiAgICAgICAgLy8gd2UgY291bGQganVzdCB0cnkgdG8gcmVuZGVyIGl0IGNsaWVudC1zaWRlIGluc3RlYWQuIEhvd2V2ZXIsIHRoaXMgd2lsbCBwZXJmb3JtIGEKICAgICAgICAvLyBsb3Qgb2YgdW5uZWNlc3Nhcnkgd29yayBhbmQgaXMgdW5saWtlbHkgdG8gY29tcGxldGUgc2luY2UgaXQgb2Z0ZW4gd2lsbCBzdXNwZW5kCiAgICAgICAgLy8gb24gbWlzc2luZyBkYXRhIGFueXdheS4gQWRkaXRpb25hbGx5LCB0aGUgc2VydmVyIG1pZ2h0IGJlIGFibGUgdG8gcmVuZGVyIG1vcmUKICAgICAgICAvLyB0aGFuIHdlIGNhbiBvbiB0aGUgY2xpZW50IHlldC4gSW4gdGhhdCBjYXNlIHdlJ2QgZW5kIHVwIHdpdGggbW9yZSBmYWxsYmFjayBzdGF0ZXMKICAgICAgICAvLyBvbiB0aGUgY2xpZW50IHRoYW4gaWYgd2UganVzdCBsZWF2ZSBpdCBhbG9uZS4gSWYgdGhlIHNlcnZlciB0aW1lcyBvdXQgb3IgZXJyb3JzCiAgICAgICAgLy8gdGhlc2Ugc2hvdWxkIHVwZGF0ZSB0aGlzIGJvdW5kYXJ5IHRvIHRoZSBwZXJtYW5lbnQgRmFsbGJhY2sgc3RhdGUgaW5zdGVhZC4KICAgICAgICAvLyBNYXJrIGl0IGFzIGhhdmluZyBjYXB0dXJlZCAoaS5lLiBzdXNwZW5kZWQpLgogICAgICAgIHdvcmtJblByb2dyZXNzLmZsYWdzIHw9IERpZENhcHR1cmU7IC8vIExlYXZlIHRoZSBjaGlsZCBpbiBwbGFjZS4gSS5lLiB0aGUgZGVoeWRyYXRlZCBmcmFnbWVudC4KCiAgICAgICAgd29ya0luUHJvZ3Jlc3MuY2hpbGQgPSBjdXJyZW50LmNoaWxkOyAvLyBSZWdpc3RlciBhIGNhbGxiYWNrIHRvIHJldHJ5IHRoaXMgYm91bmRhcnkgb25jZSB0aGUgc2VydmVyIGhhcyBzZW50IHRoZSByZXN1bHQuCgogICAgICAgIHZhciByZXRyeSA9IHJldHJ5RGVoeWRyYXRlZFN1c3BlbnNlQm91bmRhcnkuYmluZChudWxsLCBjdXJyZW50KTsKICAgICAgICByZWdpc3RlclN1c3BlbnNlSW5zdGFuY2VSZXRyeShzdXNwZW5zZUluc3RhbmNlLCByZXRyeSk7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gVGhpcyBpcyB0aGUgZmlyc3QgYXR0ZW1wdC4KICAgICAgICByZWVudGVySHlkcmF0aW9uU3RhdGVGcm9tRGVoeWRyYXRlZFN1c3BlbnNlSW5zdGFuY2Uod29ya0luUHJvZ3Jlc3MsIHN1c3BlbnNlSW5zdGFuY2UsIHN1c3BlbnNlU3RhdGUudHJlZUNvbnRleHQpOwogICAgICAgIHZhciBwcmltYXJ5Q2hpbGRyZW4gPSBuZXh0UHJvcHMuY2hpbGRyZW47CiAgICAgICAgdmFyIHByaW1hcnlDaGlsZEZyYWdtZW50ID0gbW91bnRTdXNwZW5zZVByaW1hcnlDaGlsZHJlbih3b3JrSW5Qcm9ncmVzcywgcHJpbWFyeUNoaWxkcmVuKTsgLy8gTWFyayB0aGUgY2hpbGRyZW4gYXMgaHlkcmF0aW5nLiBUaGlzIGlzIGEgZmFzdCBwYXRoIHRvIGtub3cgd2hldGhlciB0aGlzCiAgICAgICAgLy8gdHJlZSBpcyBwYXJ0IG9mIGEgaHlkcmF0aW5nIHRyZWUuIFRoaXMgaXMgdXNlZCB0byBkZXRlcm1pbmUgaWYgYSBjaGlsZAogICAgICAgIC8vIG5vZGUgaGFzIGZ1bGx5IG1vdW50ZWQgeWV0LCBhbmQgZm9yIHNjaGVkdWxpbmcgZXZlbnQgcmVwbGF5aW5nLgogICAgICAgIC8vIENvbmNlcHR1YWxseSB0aGlzIGlzIHNpbWlsYXIgdG8gUGxhY2VtZW50IGluIHRoYXQgYSBuZXcgc3VidHJlZSBpcwogICAgICAgIC8vIGluc2VydGVkIGludG8gdGhlIFJlYWN0IHRyZWUgaGVyZS4gSXQganVzdCBoYXBwZW5zIHRvIG5vdCBuZWVkIERPTQogICAgICAgIC8vIG11dGF0aW9ucyBiZWNhdXNlIGl0IGFscmVhZHkgZXhpc3RzLgoKICAgICAgICBwcmltYXJ5Q2hpbGRGcmFnbWVudC5mbGFncyB8PSBIeWRyYXRpbmc7CiAgICAgICAgcmV0dXJuIHByaW1hcnlDaGlsZEZyYWdtZW50OwogICAgICB9CiAgICB9IGVsc2UgewogICAgICAvLyBUaGlzIGlzIHRoZSBzZWNvbmQgcmVuZGVyIHBhc3MuIFdlIGFscmVhZHkgYXR0ZW1wdGVkIHRvIGh5ZHJhdGVkLCBidXQKICAgICAgLy8gc29tZXRoaW5nIGVpdGhlciBzdXNwZW5kZWQgb3IgZXJyb3JlZC4KICAgICAgaWYgKHdvcmtJblByb2dyZXNzLmZsYWdzICYgRm9yY2VDbGllbnRSZW5kZXIpIHsKICAgICAgICAvLyBTb21ldGhpbmcgZXJyb3JlZCBkdXJpbmcgaHlkcmF0aW9uLiBUcnkgYWdhaW4gd2l0aG91dCBoeWRyYXRpbmcuCiAgICAgICAgd29ya0luUHJvZ3Jlc3MuZmxhZ3MgJj0gfkZvcmNlQ2xpZW50UmVuZGVyOwoKICAgICAgICB2YXIgX2NhcHR1cmVkVmFsdWUyID0gY3JlYXRlQ2FwdHVyZWRWYWx1ZShuZXcgRXJyb3IoJ1RoZXJlIHdhcyBhbiBlcnJvciB3aGlsZSBoeWRyYXRpbmcgdGhpcyBTdXNwZW5zZSBib3VuZGFyeS4gJyArICdTd2l0Y2hlZCB0byBjbGllbnQgcmVuZGVyaW5nLicpKTsKCiAgICAgICAgcmV0dXJuIHJldHJ5U3VzcGVuc2VDb21wb25lbnRXaXRob3V0SHlkcmF0aW5nKGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCByZW5kZXJMYW5lcywgX2NhcHR1cmVkVmFsdWUyKTsKICAgICAgfSBlbHNlIGlmICh3b3JrSW5Qcm9ncmVzcy5tZW1vaXplZFN0YXRlICE9PSBudWxsKSB7CiAgICAgICAgLy8gU29tZXRoaW5nIHN1c3BlbmRlZCBhbmQgd2Ugc2hvdWxkIHN0aWxsIGJlIGluIGRlaHlkcmF0ZWQgbW9kZS4KICAgICAgICAvLyBMZWF2ZSB0aGUgZXhpc3RpbmcgY2hpbGQgaW4gcGxhY2UuCiAgICAgICAgd29ya0luUHJvZ3Jlc3MuY2hpbGQgPSBjdXJyZW50LmNoaWxkOyAvLyBUaGUgZGVoeWRyYXRlZCBjb21wbGV0aW9uIHBhc3MgZXhwZWN0cyB0aGlzIGZsYWcgdG8gYmUgdGhlcmUKICAgICAgICAvLyBidXQgdGhlIG5vcm1hbCBzdXNwZW5zZSBwYXNzIGRvZXNuJ3QuCgogICAgICAgIHdvcmtJblByb2dyZXNzLmZsYWdzIHw9IERpZENhcHR1cmU7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gU3VzcGVuZGVkIGJ1dCB3ZSBzaG91bGQgbm8gbG9uZ2VyIGJlIGluIGRlaHlkcmF0ZWQgbW9kZS4KICAgICAgICAvLyBUaGVyZWZvcmUgd2Ugbm93IGhhdmUgdG8gcmVuZGVyIHRoZSBmYWxsYmFjay4KICAgICAgICB2YXIgbmV4dFByaW1hcnlDaGlsZHJlbiA9IG5leHRQcm9wcy5jaGlsZHJlbjsKICAgICAgICB2YXIgbmV4dEZhbGxiYWNrQ2hpbGRyZW4gPSBuZXh0UHJvcHMuZmFsbGJhY2s7CiAgICAgICAgdmFyIGZhbGxiYWNrQ2hpbGRGcmFnbWVudCA9IG1vdW50U3VzcGVuc2VGYWxsYmFja0FmdGVyUmV0cnlXaXRob3V0SHlkcmF0aW5nKGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCBuZXh0UHJpbWFyeUNoaWxkcmVuLCBuZXh0RmFsbGJhY2tDaGlsZHJlbiwgcmVuZGVyTGFuZXMpOwogICAgICAgIHZhciBfcHJpbWFyeUNoaWxkRnJhZ21lbnQ0ID0gd29ya0luUHJvZ3Jlc3MuY2hpbGQ7CiAgICAgICAgX3ByaW1hcnlDaGlsZEZyYWdtZW50NC5tZW1vaXplZFN0YXRlID0gbW91bnRTdXNwZW5zZU9mZnNjcmVlblN0YXRlKHJlbmRlckxhbmVzKTsKICAgICAgICB3b3JrSW5Qcm9ncmVzcy5tZW1vaXplZFN0YXRlID0gU1VTUEVOREVEX01BUktFUjsKICAgICAgICByZXR1cm4gZmFsbGJhY2tDaGlsZEZyYWdtZW50OwogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiBzY2hlZHVsZVN1c3BlbnNlV29ya09uRmliZXIoZmliZXIsIHJlbmRlckxhbmVzLCBwcm9wYWdhdGlvblJvb3QpIHsKICAgIGZpYmVyLmxhbmVzID0gbWVyZ2VMYW5lcyhmaWJlci5sYW5lcywgcmVuZGVyTGFuZXMpOwogICAgdmFyIGFsdGVybmF0ZSA9IGZpYmVyLmFsdGVybmF0ZTsKCiAgICBpZiAoYWx0ZXJuYXRlICE9PSBudWxsKSB7CiAgICAgIGFsdGVybmF0ZS5sYW5lcyA9IG1lcmdlTGFuZXMoYWx0ZXJuYXRlLmxhbmVzLCByZW5kZXJMYW5lcyk7CiAgICB9CgogICAgc2NoZWR1bGVDb250ZXh0V29ya09uUGFyZW50UGF0aChmaWJlci5yZXR1cm4sIHJlbmRlckxhbmVzLCBwcm9wYWdhdGlvblJvb3QpOwogIH0KCiAgZnVuY3Rpb24gcHJvcGFnYXRlU3VzcGVuc2VDb250ZXh0Q2hhbmdlKHdvcmtJblByb2dyZXNzLCBmaXJzdENoaWxkLCByZW5kZXJMYW5lcykgewogICAgLy8gTWFyayBhbnkgU3VzcGVuc2UgYm91bmRhcmllcyB3aXRoIGZhbGxiYWNrcyBhcyBoYXZpbmcgd29yayB0byBkby4KICAgIC8vIElmIHRoZXkgd2VyZSBwcmV2aW91c2x5IGZvcmNlZCBpbnRvIGZhbGxiYWNrcywgdGhleSBtYXkgbm93IGJlIGFibGUKICAgIC8vIHRvIHVuYmxvY2suCiAgICB2YXIgbm9kZSA9IGZpcnN0Q2hpbGQ7CgogICAgd2hpbGUgKG5vZGUgIT09IG51bGwpIHsKICAgICAgaWYgKG5vZGUudGFnID09PSBTdXNwZW5zZUNvbXBvbmVudCkgewogICAgICAgIHZhciBzdGF0ZSA9IG5vZGUubWVtb2l6ZWRTdGF0ZTsKCiAgICAgICAgaWYgKHN0YXRlICE9PSBudWxsKSB7CiAgICAgICAgICBzY2hlZHVsZVN1c3BlbnNlV29ya09uRmliZXIobm9kZSwgcmVuZGVyTGFuZXMsIHdvcmtJblByb2dyZXNzKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAobm9kZS50YWcgPT09IFN1c3BlbnNlTGlzdENvbXBvbmVudCkgewogICAgICAgIC8vIElmIHRoZSB0YWlsIGlzIGhpZGRlbiB0aGVyZSBtaWdodCBub3QgYmUgYW4gU3VzcGVuc2UgYm91bmRhcmllcwogICAgICAgIC8vIHRvIHNjaGVkdWxlIHdvcmsgb24uIEluIHRoaXMgY2FzZSB3ZSBoYXZlIHRvIHNjaGVkdWxlIGl0IG9uIHRoZQogICAgICAgIC8vIGxpc3QgaXRzZWxmLgogICAgICAgIC8vIFdlIGRvbid0IGhhdmUgdG8gdHJhdmVyc2UgdG8gdGhlIGNoaWxkcmVuIG9mIHRoZSBsaXN0IHNpbmNlCiAgICAgICAgLy8gdGhlIGxpc3Qgd2lsbCBwcm9wYWdhdGUgdGhlIGNoYW5nZSB3aGVuIGl0IHJlcmVuZGVycy4KICAgICAgICBzY2hlZHVsZVN1c3BlbnNlV29ya09uRmliZXIobm9kZSwgcmVuZGVyTGFuZXMsIHdvcmtJblByb2dyZXNzKTsKICAgICAgfSBlbHNlIGlmIChub2RlLmNoaWxkICE9PSBudWxsKSB7CiAgICAgICAgbm9kZS5jaGlsZC5yZXR1cm4gPSBub2RlOwogICAgICAgIG5vZGUgPSBub2RlLmNoaWxkOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBpZiAobm9kZSA9PT0gd29ya0luUHJvZ3Jlc3MpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHdoaWxlIChub2RlLnNpYmxpbmcgPT09IG51bGwpIHsKICAgICAgICBpZiAobm9kZS5yZXR1cm4gPT09IG51bGwgfHwgbm9kZS5yZXR1cm4gPT09IHdvcmtJblByb2dyZXNzKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBub2RlID0gbm9kZS5yZXR1cm47CiAgICAgIH0KCiAgICAgIG5vZGUuc2libGluZy5yZXR1cm4gPSBub2RlLnJldHVybjsKICAgICAgbm9kZSA9IG5vZGUuc2libGluZzsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGZpbmRMYXN0Q29udGVudFJvdyhmaXJzdENoaWxkKSB7CiAgICAvLyBUaGlzIGlzIGdvaW5nIHRvIGZpbmQgdGhlIGxhc3Qgcm93IGFtb25nIHRoZXNlIGNoaWxkcmVuIHRoYXQgaXMgYWxyZWFkeQogICAgLy8gc2hvd2luZyBjb250ZW50IG9uIHRoZSBzY3JlZW4sIGFzIG9wcG9zZWQgdG8gYmVpbmcgaW4gZmFsbGJhY2sgc3RhdGUgb3IKICAgIC8vIG5ldy4gSWYgYSByb3cgaGFzIG11bHRpcGxlIFN1c3BlbnNlIGJvdW5kYXJpZXMsIGFueSBvZiB0aGVtIGJlaW5nIGluIHRoZQogICAgLy8gZmFsbGJhY2sgc3RhdGUsIGNvdW50cyBhcyB0aGUgd2hvbGUgcm93IGJlaW5nIGluIGEgZmFsbGJhY2sgc3RhdGUuCiAgICAvLyBOb3RlIHRoYXQgdGhlICJyb3dzIiB3aWxsIGJlIHdvcmtJblByb2dyZXNzLCBidXQgYW55IG5lc3RlZCBjaGlsZHJlbgogICAgLy8gd2lsbCBzdGlsbCBiZSBjdXJyZW50IHNpbmNlIHdlIGhhdmVuJ3QgcmVuZGVyZWQgdGhlbSB5ZXQuIFRoZSBtb3VudGVkCiAgICAvLyBvcmRlciBtYXkgbm90IGJlIHRoZSBzYW1lIGFzIHRoZSBuZXcgb3JkZXIuIFdlIHVzZSB0aGUgbmV3IG9yZGVyLgogICAgdmFyIHJvdyA9IGZpcnN0Q2hpbGQ7CiAgICB2YXIgbGFzdENvbnRlbnRSb3cgPSBudWxsOwoKICAgIHdoaWxlIChyb3cgIT09IG51bGwpIHsKICAgICAgdmFyIGN1cnJlbnRSb3cgPSByb3cuYWx0ZXJuYXRlOyAvLyBOZXcgcm93cyBjYW4ndCBiZSBjb250ZW50IHJvd3MuCgogICAgICBpZiAoY3VycmVudFJvdyAhPT0gbnVsbCAmJiBmaW5kRmlyc3RTdXNwZW5kZWQoY3VycmVudFJvdykgPT09IG51bGwpIHsKICAgICAgICBsYXN0Q29udGVudFJvdyA9IHJvdzsKICAgICAgfQoKICAgICAgcm93ID0gcm93LnNpYmxpbmc7CiAgICB9CgogICAgcmV0dXJuIGxhc3RDb250ZW50Um93OwogIH0KCiAgZnVuY3Rpb24gdmFsaWRhdGVSZXZlYWxPcmRlcihyZXZlYWxPcmRlcikgewogICAgewogICAgICBpZiAocmV2ZWFsT3JkZXIgIT09IHVuZGVmaW5lZCAmJiByZXZlYWxPcmRlciAhPT0gJ2ZvcndhcmRzJyAmJiByZXZlYWxPcmRlciAhPT0gJ2JhY2t3YXJkcycgJiYgcmV2ZWFsT3JkZXIgIT09ICd0b2dldGhlcicgJiYgIWRpZFdhcm5BYm91dFJldmVhbE9yZGVyW3JldmVhbE9yZGVyXSkgewogICAgICAgIGRpZFdhcm5BYm91dFJldmVhbE9yZGVyW3JldmVhbE9yZGVyXSA9IHRydWU7CgogICAgICAgIGlmICh0eXBlb2YgcmV2ZWFsT3JkZXIgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgICBzd2l0Y2ggKHJldmVhbE9yZGVyLnRvTG93ZXJDYXNlKCkpIHsKICAgICAgICAgICAgY2FzZSAndG9nZXRoZXInOgogICAgICAgICAgICBjYXNlICdmb3J3YXJkcyc6CiAgICAgICAgICAgIGNhc2UgJ2JhY2t3YXJkcyc6CiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgZXJyb3IoJyIlcyIgaXMgbm90IGEgdmFsaWQgdmFsdWUgZm9yIHJldmVhbE9yZGVyIG9uIDxTdXNwZW5zZUxpc3QgLz4uICcgKyAnVXNlIGxvd2VyY2FzZSAiJXMiIGluc3RlYWQuJywgcmV2ZWFsT3JkZXIsIHJldmVhbE9yZGVyLnRvTG93ZXJDYXNlKCkpOwoKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNhc2UgJ2ZvcndhcmQnOgogICAgICAgICAgICBjYXNlICdiYWNrd2FyZCc6CiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgZXJyb3IoJyIlcyIgaXMgbm90IGEgdmFsaWQgdmFsdWUgZm9yIHJldmVhbE9yZGVyIG9uIDxTdXNwZW5zZUxpc3QgLz4uICcgKyAnUmVhY3QgdXNlcyB0aGUgLXMgc3VmZml4IGluIHRoZSBzcGVsbGluZy4gVXNlICIlc3MiIGluc3RlYWQuJywgcmV2ZWFsT3JkZXIsIHJldmVhbE9yZGVyLnRvTG93ZXJDYXNlKCkpOwoKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgZXJyb3IoJyIlcyIgaXMgbm90IGEgc3VwcG9ydGVkIHJldmVhbE9yZGVyIG9uIDxTdXNwZW5zZUxpc3QgLz4uICcgKyAnRGlkIHlvdSBtZWFuICJ0b2dldGhlciIsICJmb3J3YXJkcyIgb3IgImJhY2t3YXJkcyI/JywgcmV2ZWFsT3JkZXIpOwoKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgZXJyb3IoJyVzIGlzIG5vdCBhIHN1cHBvcnRlZCB2YWx1ZSBmb3IgcmV2ZWFsT3JkZXIgb24gPFN1c3BlbnNlTGlzdCAvPi4gJyArICdEaWQgeW91IG1lYW4gInRvZ2V0aGVyIiwgImZvcndhcmRzIiBvciAiYmFja3dhcmRzIj8nLCByZXZlYWxPcmRlcik7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiB2YWxpZGF0ZVRhaWxPcHRpb25zKHRhaWxNb2RlLCByZXZlYWxPcmRlcikgewogICAgewogICAgICBpZiAodGFpbE1vZGUgIT09IHVuZGVmaW5lZCAmJiAhZGlkV2FybkFib3V0VGFpbE9wdGlvbnNbdGFpbE1vZGVdKSB7CiAgICAgICAgaWYgKHRhaWxNb2RlICE9PSAnY29sbGFwc2VkJyAmJiB0YWlsTW9kZSAhPT0gJ2hpZGRlbicpIHsKICAgICAgICAgIGRpZFdhcm5BYm91dFRhaWxPcHRpb25zW3RhaWxNb2RlXSA9IHRydWU7CgogICAgICAgICAgZXJyb3IoJyIlcyIgaXMgbm90IGEgc3VwcG9ydGVkIHZhbHVlIGZvciB0YWlsIG9uIDxTdXNwZW5zZUxpc3QgLz4uICcgKyAnRGlkIHlvdSBtZWFuICJjb2xsYXBzZWQiIG9yICJoaWRkZW4iPycsIHRhaWxNb2RlKTsKICAgICAgICB9IGVsc2UgaWYgKHJldmVhbE9yZGVyICE9PSAnZm9yd2FyZHMnICYmIHJldmVhbE9yZGVyICE9PSAnYmFja3dhcmRzJykgewogICAgICAgICAgZGlkV2FybkFib3V0VGFpbE9wdGlvbnNbdGFpbE1vZGVdID0gdHJ1ZTsKCiAgICAgICAgICBlcnJvcignPFN1c3BlbnNlTGlzdCB0YWlsPSIlcyIgLz4gaXMgb25seSB2YWxpZCBpZiByZXZlYWxPcmRlciBpcyAnICsgJyJmb3J3YXJkcyIgb3IgImJhY2t3YXJkcyIuICcgKyAnRGlkIHlvdSBtZWFuIHRvIHNwZWNpZnkgcmV2ZWFsT3JkZXI9ImZvcndhcmRzIj8nLCB0YWlsTW9kZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiB2YWxpZGF0ZVN1c3BlbnNlTGlzdE5lc3RlZENoaWxkKGNoaWxkU2xvdCwgaW5kZXgpIHsKICAgIHsKICAgICAgdmFyIGlzQW5BcnJheSA9IGlzQXJyYXkoY2hpbGRTbG90KTsKICAgICAgdmFyIGlzSXRlcmFibGUgPSAhaXNBbkFycmF5ICYmIHR5cGVvZiBnZXRJdGVyYXRvckZuKGNoaWxkU2xvdCkgPT09ICdmdW5jdGlvbic7CgogICAgICBpZiAoaXNBbkFycmF5IHx8IGlzSXRlcmFibGUpIHsKICAgICAgICB2YXIgdHlwZSA9IGlzQW5BcnJheSA/ICdhcnJheScgOiAnaXRlcmFibGUnOwoKICAgICAgICBlcnJvcignQSBuZXN0ZWQgJXMgd2FzIHBhc3NlZCB0byByb3cgIyVzIGluIDxTdXNwZW5zZUxpc3QgLz4uIFdyYXAgaXQgaW4gJyArICdhbiBhZGRpdGlvbmFsIFN1c3BlbnNlTGlzdCB0byBjb25maWd1cmUgaXRzIHJldmVhbE9yZGVyOiAnICsgJzxTdXNwZW5zZUxpc3QgcmV2ZWFsT3JkZXI9Li4uPiAuLi4gJyArICc8U3VzcGVuc2VMaXN0IHJldmVhbE9yZGVyPS4uLj57JXN9PC9TdXNwZW5zZUxpc3Q+IC4uLiAnICsgJzwvU3VzcGVuc2VMaXN0PicsIHR5cGUsIGluZGV4LCB0eXBlKTsKCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiB2YWxpZGF0ZVN1c3BlbnNlTGlzdENoaWxkcmVuKGNoaWxkcmVuLCByZXZlYWxPcmRlcikgewogICAgewogICAgICBpZiAoKHJldmVhbE9yZGVyID09PSAnZm9yd2FyZHMnIHx8IHJldmVhbE9yZGVyID09PSAnYmFja3dhcmRzJykgJiYgY2hpbGRyZW4gIT09IHVuZGVmaW5lZCAmJiBjaGlsZHJlbiAhPT0gbnVsbCAmJiBjaGlsZHJlbiAhPT0gZmFsc2UpIHsKICAgICAgICBpZiAoaXNBcnJheShjaGlsZHJlbikpIHsKICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKCF2YWxpZGF0ZVN1c3BlbnNlTGlzdE5lc3RlZENoaWxkKGNoaWxkcmVuW2ldLCBpKSkgewogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB2YXIgaXRlcmF0b3JGbiA9IGdldEl0ZXJhdG9yRm4oY2hpbGRyZW4pOwoKICAgICAgICAgIGlmICh0eXBlb2YgaXRlcmF0b3JGbiA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgICB2YXIgY2hpbGRyZW5JdGVyYXRvciA9IGl0ZXJhdG9yRm4uY2FsbChjaGlsZHJlbik7CgogICAgICAgICAgICBpZiAoY2hpbGRyZW5JdGVyYXRvcikgewogICAgICAgICAgICAgIHZhciBzdGVwID0gY2hpbGRyZW5JdGVyYXRvci5uZXh0KCk7CiAgICAgICAgICAgICAgdmFyIF9pID0gMDsKCiAgICAgICAgICAgICAgZm9yICg7ICFzdGVwLmRvbmU7IHN0ZXAgPSBjaGlsZHJlbkl0ZXJhdG9yLm5leHQoKSkgewogICAgICAgICAgICAgICAgaWYgKCF2YWxpZGF0ZVN1c3BlbnNlTGlzdE5lc3RlZENoaWxkKHN0ZXAudmFsdWUsIF9pKSkgewogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2krKzsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGVycm9yKCdBIHNpbmdsZSByb3cgd2FzIHBhc3NlZCB0byBhIDxTdXNwZW5zZUxpc3QgcmV2ZWFsT3JkZXI9IiVzIiAvPi4gJyArICdUaGlzIGlzIG5vdCB1c2VmdWwgc2luY2UgaXQgbmVlZHMgbXVsdGlwbGUgcm93cy4gJyArICdEaWQgeW91IG1lYW4gdG8gcGFzcyBtdWx0aXBsZSBjaGlsZHJlbiBvciBhbiBhcnJheT8nLCByZXZlYWxPcmRlcik7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiBpbml0U3VzcGVuc2VMaXN0UmVuZGVyU3RhdGUod29ya0luUHJvZ3Jlc3MsIGlzQmFja3dhcmRzLCB0YWlsLCBsYXN0Q29udGVudFJvdywgdGFpbE1vZGUpIHsKICAgIHZhciByZW5kZXJTdGF0ZSA9IHdvcmtJblByb2dyZXNzLm1lbW9pemVkU3RhdGU7CgogICAgaWYgKHJlbmRlclN0YXRlID09PSBudWxsKSB7CiAgICAgIHdvcmtJblByb2dyZXNzLm1lbW9pemVkU3RhdGUgPSB7CiAgICAgICAgaXNCYWNrd2FyZHM6IGlzQmFja3dhcmRzLAogICAgICAgIHJlbmRlcmluZzogbnVsbCwKICAgICAgICByZW5kZXJpbmdTdGFydFRpbWU6IDAsCiAgICAgICAgbGFzdDogbGFzdENvbnRlbnRSb3csCiAgICAgICAgdGFpbDogdGFpbCwKICAgICAgICB0YWlsTW9kZTogdGFpbE1vZGUKICAgICAgfTsKICAgIH0gZWxzZSB7CiAgICAgIC8vIFdlIGNhbiByZXVzZSB0aGUgZXhpc3Rpbmcgb2JqZWN0IGZyb20gcHJldmlvdXMgcmVuZGVycy4KICAgICAgcmVuZGVyU3RhdGUuaXNCYWNrd2FyZHMgPSBpc0JhY2t3YXJkczsKICAgICAgcmVuZGVyU3RhdGUucmVuZGVyaW5nID0gbnVsbDsKICAgICAgcmVuZGVyU3RhdGUucmVuZGVyaW5nU3RhcnRUaW1lID0gMDsKICAgICAgcmVuZGVyU3RhdGUubGFzdCA9IGxhc3RDb250ZW50Um93OwogICAgICByZW5kZXJTdGF0ZS50YWlsID0gdGFpbDsKICAgICAgcmVuZGVyU3RhdGUudGFpbE1vZGUgPSB0YWlsTW9kZTsKICAgIH0KICB9IC8vIFRoaXMgY2FuIGVuZCB1cCByZW5kZXJpbmcgdGhpcyBjb21wb25lbnQgbXVsdGlwbGUgcGFzc2VzLgogIC8vIFRoZSBmaXJzdCBwYXNzIHNwbGl0cyB0aGUgY2hpbGRyZW4gZmliZXJzIGludG8gdHdvIHNldHMuIEEgaGVhZCBhbmQgdGFpbC4KICAvLyBXZSBmaXJzdCByZW5kZXIgdGhlIGhlYWQuIElmIGFueXRoaW5nIGlzIGluIGZhbGxiYWNrIHN0YXRlLCB3ZSBkbyBhbm90aGVyCiAgLy8gcGFzcyB0aHJvdWdoIGJlZ2luV29yayB0byByZXJlbmRlciBhbGwgY2hpbGRyZW4gKGluY2x1ZGluZyB0aGUgdGFpbCkgd2l0aAogIC8vIHRoZSBmb3JjZSBzdXNwZW5kIGNvbnRleHQuIElmIHRoZSBmaXJzdCByZW5kZXIgZGlkbid0IGhhdmUgYW55dGhpbmcgaW4KICAvLyBpbiBmYWxsYmFjayBzdGF0ZS4gVGhlbiB3ZSByZW5kZXIgZWFjaCByb3cgaW4gdGhlIHRhaWwgb25lLWJ5LW9uZS4KICAvLyBUaGF0IGhhcHBlbnMgaW4gdGhlIGNvbXBsZXRlV29yayBwaGFzZSB3aXRob3V0IGdvaW5nIGJhY2sgdG8gYmVnaW5Xb3JrLgoKCiAgZnVuY3Rpb24gdXBkYXRlU3VzcGVuc2VMaXN0Q29tcG9uZW50KGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCByZW5kZXJMYW5lcykgewogICAgdmFyIG5leHRQcm9wcyA9IHdvcmtJblByb2dyZXNzLnBlbmRpbmdQcm9wczsKICAgIHZhciByZXZlYWxPcmRlciA9IG5leHRQcm9wcy5yZXZlYWxPcmRlcjsKICAgIHZhciB0YWlsTW9kZSA9IG5leHRQcm9wcy50YWlsOwogICAgdmFyIG5ld0NoaWxkcmVuID0gbmV4dFByb3BzLmNoaWxkcmVuOwogICAgdmFsaWRhdGVSZXZlYWxPcmRlcihyZXZlYWxPcmRlcik7CiAgICB2YWxpZGF0ZVRhaWxPcHRpb25zKHRhaWxNb2RlLCByZXZlYWxPcmRlcik7CiAgICB2YWxpZGF0ZVN1c3BlbnNlTGlzdENoaWxkcmVuKG5ld0NoaWxkcmVuLCByZXZlYWxPcmRlcik7CiAgICByZWNvbmNpbGVDaGlsZHJlbihjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcywgbmV3Q2hpbGRyZW4sIHJlbmRlckxhbmVzKTsKICAgIHZhciBzdXNwZW5zZUNvbnRleHQgPSBzdXNwZW5zZVN0YWNrQ3Vyc29yLmN1cnJlbnQ7CiAgICB2YXIgc2hvdWxkRm9yY2VGYWxsYmFjayA9IGhhc1N1c3BlbnNlQ29udGV4dChzdXNwZW5zZUNvbnRleHQsIEZvcmNlU3VzcGVuc2VGYWxsYmFjayk7CgogICAgaWYgKHNob3VsZEZvcmNlRmFsbGJhY2spIHsKICAgICAgc3VzcGVuc2VDb250ZXh0ID0gc2V0U2hhbGxvd1N1c3BlbnNlQ29udGV4dChzdXNwZW5zZUNvbnRleHQsIEZvcmNlU3VzcGVuc2VGYWxsYmFjayk7CiAgICAgIHdvcmtJblByb2dyZXNzLmZsYWdzIHw9IERpZENhcHR1cmU7CiAgICB9IGVsc2UgewogICAgICB2YXIgZGlkU3VzcGVuZEJlZm9yZSA9IGN1cnJlbnQgIT09IG51bGwgJiYgKGN1cnJlbnQuZmxhZ3MgJiBEaWRDYXB0dXJlKSAhPT0gTm9GbGFnczsKCiAgICAgIGlmIChkaWRTdXNwZW5kQmVmb3JlKSB7CiAgICAgICAgLy8gSWYgd2UgcHJldmlvdXNseSBmb3JjZWQgYSBmYWxsYmFjaywgd2UgbmVlZCB0byBzY2hlZHVsZSB3b3JrCiAgICAgICAgLy8gb24gYW55IG5lc3RlZCBib3VuZGFyaWVzIHRvIGxldCB0aGVtIGtub3cgdG8gdHJ5IHRvIHJlbmRlcgogICAgICAgIC8vIGFnYWluLiBUaGlzIGlzIHRoZSBzYW1lIGFzIGNvbnRleHQgdXBkYXRpbmcuCiAgICAgICAgcHJvcGFnYXRlU3VzcGVuc2VDb250ZXh0Q2hhbmdlKHdvcmtJblByb2dyZXNzLCB3b3JrSW5Qcm9ncmVzcy5jaGlsZCwgcmVuZGVyTGFuZXMpOwogICAgICB9CgogICAgICBzdXNwZW5zZUNvbnRleHQgPSBzZXREZWZhdWx0U2hhbGxvd1N1c3BlbnNlQ29udGV4dChzdXNwZW5zZUNvbnRleHQpOwogICAgfQoKICAgIHB1c2hTdXNwZW5zZUNvbnRleHQod29ya0luUHJvZ3Jlc3MsIHN1c3BlbnNlQ29udGV4dCk7CgogICAgaWYgKCh3b3JrSW5Qcm9ncmVzcy5tb2RlICYgQ29uY3VycmVudE1vZGUpID09PSBOb01vZGUpIHsKICAgICAgLy8gSW4gbGVnYWN5IG1vZGUsIFN1c3BlbnNlTGlzdCBkb2Vzbid0IHdvcmsgc28gd2UganVzdAogICAgICAvLyB1c2UgbWFrZSBpdCBhIG5vb3AgYnkgdHJlYXRpbmcgaXQgYXMgdGhlIGRlZmF1bHQgcmV2ZWFsT3JkZXIuCiAgICAgIHdvcmtJblByb2dyZXNzLm1lbW9pemVkU3RhdGUgPSBudWxsOwogICAgfSBlbHNlIHsKICAgICAgc3dpdGNoIChyZXZlYWxPcmRlcikgewogICAgICAgIGNhc2UgJ2ZvcndhcmRzJzoKICAgICAgICAgIHsKICAgICAgICAgICAgdmFyIGxhc3RDb250ZW50Um93ID0gZmluZExhc3RDb250ZW50Um93KHdvcmtJblByb2dyZXNzLmNoaWxkKTsKICAgICAgICAgICAgdmFyIHRhaWw7CgogICAgICAgICAgICBpZiAobGFzdENvbnRlbnRSb3cgPT09IG51bGwpIHsKICAgICAgICAgICAgICAvLyBUaGUgd2hvbGUgbGlzdCBpcyBwYXJ0IG9mIHRoZSB0YWlsLgogICAgICAgICAgICAgIC8vIFRPRE86IFdlIGNvdWxkIGZhc3QgcGF0aCBieSBqdXN0IHJlbmRlcmluZyB0aGUgdGFpbCBub3cuCiAgICAgICAgICAgICAgdGFpbCA9IHdvcmtJblByb2dyZXNzLmNoaWxkOwogICAgICAgICAgICAgIHdvcmtJblByb2dyZXNzLmNoaWxkID0gbnVsbDsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAvLyBEaXNjb25uZWN0IHRoZSB0YWlsIHJvd3MgYWZ0ZXIgdGhlIGNvbnRlbnQgcm93LgogICAgICAgICAgICAgIC8vIFdlJ3JlIGdvaW5nIHRvIHJlbmRlciB0aGVtIHNlcGFyYXRlbHkgbGF0ZXIuCiAgICAgICAgICAgICAgdGFpbCA9IGxhc3RDb250ZW50Um93LnNpYmxpbmc7CiAgICAgICAgICAgICAgbGFzdENvbnRlbnRSb3cuc2libGluZyA9IG51bGw7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGluaXRTdXNwZW5zZUxpc3RSZW5kZXJTdGF0ZSh3b3JrSW5Qcm9ncmVzcywgZmFsc2UsIC8vIGlzQmFja3dhcmRzCiAgICAgICAgICAgIHRhaWwsIGxhc3RDb250ZW50Um93LCB0YWlsTW9kZSk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICBjYXNlICdiYWNrd2FyZHMnOgogICAgICAgICAgewogICAgICAgICAgICAvLyBXZSdyZSBnb2luZyB0byBmaW5kIHRoZSBmaXJzdCByb3cgdGhhdCBoYXMgZXhpc3RpbmcgY29udGVudC4KICAgICAgICAgICAgLy8gQXQgdGhlIHNhbWUgdGltZSB3ZSdyZSBnb2luZyB0byByZXZlcnNlIHRoZSBsaXN0IG9mIGV2ZXJ5dGhpbmcKICAgICAgICAgICAgLy8gd2UgcGFzcyBpbiB0aGUgbWVhbnRpbWUuIFRoYXQncyBnb2luZyB0byBiZSBvdXIgdGFpbCBpbiByZXZlcnNlCiAgICAgICAgICAgIC8vIG9yZGVyLgogICAgICAgICAgICB2YXIgX3RhaWwgPSBudWxsOwogICAgICAgICAgICB2YXIgcm93ID0gd29ya0luUHJvZ3Jlc3MuY2hpbGQ7CiAgICAgICAgICAgIHdvcmtJblByb2dyZXNzLmNoaWxkID0gbnVsbDsKCiAgICAgICAgICAgIHdoaWxlIChyb3cgIT09IG51bGwpIHsKICAgICAgICAgICAgICB2YXIgY3VycmVudFJvdyA9IHJvdy5hbHRlcm5hdGU7IC8vIE5ldyByb3dzIGNhbid0IGJlIGNvbnRlbnQgcm93cy4KCiAgICAgICAgICAgICAgaWYgKGN1cnJlbnRSb3cgIT09IG51bGwgJiYgZmluZEZpcnN0U3VzcGVuZGVkKGN1cnJlbnRSb3cpID09PSBudWxsKSB7CiAgICAgICAgICAgICAgICAvLyBUaGlzIGlzIHRoZSBiZWdpbm5pbmcgb2YgdGhlIG1haW4gY29udGVudC4KICAgICAgICAgICAgICAgIHdvcmtJblByb2dyZXNzLmNoaWxkID0gcm93OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB2YXIgbmV4dFJvdyA9IHJvdy5zaWJsaW5nOwogICAgICAgICAgICAgIHJvdy5zaWJsaW5nID0gX3RhaWw7CiAgICAgICAgICAgICAgX3RhaWwgPSByb3c7CiAgICAgICAgICAgICAgcm93ID0gbmV4dFJvdzsKICAgICAgICAgICAgfSAvLyBUT0RPOiBJZiB3b3JrSW5Qcm9ncmVzcy5jaGlsZCBpcyBudWxsLCB3ZSBjYW4gY29udGludWUgb24gdGhlIHRhaWwgaW1tZWRpYXRlbHkuCgoKICAgICAgICAgICAgaW5pdFN1c3BlbnNlTGlzdFJlbmRlclN0YXRlKHdvcmtJblByb2dyZXNzLCB0cnVlLCAvLyBpc0JhY2t3YXJkcwogICAgICAgICAgICBfdGFpbCwgbnVsbCwgLy8gbGFzdAogICAgICAgICAgICB0YWlsTW9kZSk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICBjYXNlICd0b2dldGhlcic6CiAgICAgICAgICB7CiAgICAgICAgICAgIGluaXRTdXNwZW5zZUxpc3RSZW5kZXJTdGF0ZSh3b3JrSW5Qcm9ncmVzcywgZmFsc2UsIC8vIGlzQmFja3dhcmRzCiAgICAgICAgICAgIG51bGwsIC8vIHRhaWwKICAgICAgICAgICAgbnVsbCwgLy8gbGFzdAogICAgICAgICAgICB1bmRlZmluZWQpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIHsKICAgICAgICAgICAgLy8gVGhlIGRlZmF1bHQgcmV2ZWFsIG9yZGVyIGlzIHRoZSBzYW1lIGFzIG5vdCBoYXZpbmcKICAgICAgICAgICAgLy8gYSBib3VuZGFyeS4KICAgICAgICAgICAgd29ya0luUHJvZ3Jlc3MubWVtb2l6ZWRTdGF0ZSA9IG51bGw7CiAgICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gd29ya0luUHJvZ3Jlc3MuY2hpbGQ7CiAgfQoKICBmdW5jdGlvbiB1cGRhdGVQb3J0YWxDb21wb25lbnQoY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIHJlbmRlckxhbmVzKSB7CiAgICBwdXNoSG9zdENvbnRhaW5lcih3b3JrSW5Qcm9ncmVzcywgd29ya0luUHJvZ3Jlc3Muc3RhdGVOb2RlLmNvbnRhaW5lckluZm8pOwogICAgdmFyIG5leHRDaGlsZHJlbiA9IHdvcmtJblByb2dyZXNzLnBlbmRpbmdQcm9wczsKCiAgICBpZiAoY3VycmVudCA9PT0gbnVsbCkgewogICAgICAvLyBQb3J0YWxzIGFyZSBzcGVjaWFsIGJlY2F1c2Ugd2UgZG9uJ3QgYXBwZW5kIHRoZSBjaGlsZHJlbiBkdXJpbmcgbW91bnQKICAgICAgLy8gYnV0IGF0IGNvbW1pdC4gVGhlcmVmb3JlIHdlIG5lZWQgdG8gdHJhY2sgaW5zZXJ0aW9ucyB3aGljaCB0aGUgbm9ybWFsCiAgICAgIC8vIGZsb3cgZG9lc24ndCBkbyBkdXJpbmcgbW91bnQuIFRoaXMgZG9lc24ndCBoYXBwZW4gYXQgdGhlIHJvb3QgYmVjYXVzZQogICAgICAvLyB0aGUgcm9vdCBhbHdheXMgc3RhcnRzIHdpdGggYSAiY3VycmVudCIgd2l0aCBhIG51bGwgY2hpbGQuCiAgICAgIC8vIFRPRE86IENvbnNpZGVyIHVuaWZ5aW5nIHRoaXMgd2l0aCBob3cgdGhlIHJvb3Qgd29ya3MuCiAgICAgIHdvcmtJblByb2dyZXNzLmNoaWxkID0gcmVjb25jaWxlQ2hpbGRGaWJlcnMod29ya0luUHJvZ3Jlc3MsIG51bGwsIG5leHRDaGlsZHJlbiwgcmVuZGVyTGFuZXMpOwogICAgfSBlbHNlIHsKICAgICAgcmVjb25jaWxlQ2hpbGRyZW4oY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIG5leHRDaGlsZHJlbiwgcmVuZGVyTGFuZXMpOwogICAgfQoKICAgIHJldHVybiB3b3JrSW5Qcm9ncmVzcy5jaGlsZDsKICB9CgogIHZhciBoYXNXYXJuZWRBYm91dFVzaW5nTm9WYWx1ZVByb3BPbkNvbnRleHRQcm92aWRlciA9IGZhbHNlOwoKICBmdW5jdGlvbiB1cGRhdGVDb250ZXh0UHJvdmlkZXIoY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIHJlbmRlckxhbmVzKSB7CiAgICB2YXIgcHJvdmlkZXJUeXBlID0gd29ya0luUHJvZ3Jlc3MudHlwZTsKICAgIHZhciBjb250ZXh0ID0gcHJvdmlkZXJUeXBlLl9jb250ZXh0OwogICAgdmFyIG5ld1Byb3BzID0gd29ya0luUHJvZ3Jlc3MucGVuZGluZ1Byb3BzOwogICAgdmFyIG9sZFByb3BzID0gd29ya0luUHJvZ3Jlc3MubWVtb2l6ZWRQcm9wczsKICAgIHZhciBuZXdWYWx1ZSA9IG5ld1Byb3BzLnZhbHVlOwoKICAgIHsKICAgICAgaWYgKCEoJ3ZhbHVlJyBpbiBuZXdQcm9wcykpIHsKICAgICAgICBpZiAoIWhhc1dhcm5lZEFib3V0VXNpbmdOb1ZhbHVlUHJvcE9uQ29udGV4dFByb3ZpZGVyKSB7CiAgICAgICAgICBoYXNXYXJuZWRBYm91dFVzaW5nTm9WYWx1ZVByb3BPbkNvbnRleHRQcm92aWRlciA9IHRydWU7CgogICAgICAgICAgZXJyb3IoJ1RoZSBgdmFsdWVgIHByb3AgaXMgcmVxdWlyZWQgZm9yIHRoZSBgPENvbnRleHQuUHJvdmlkZXI+YC4gRGlkIHlvdSBtaXNzcGVsbCBpdCBvciBmb3JnZXQgdG8gcGFzcyBpdD8nKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHZhciBwcm92aWRlclByb3BUeXBlcyA9IHdvcmtJblByb2dyZXNzLnR5cGUucHJvcFR5cGVzOwoKICAgICAgaWYgKHByb3ZpZGVyUHJvcFR5cGVzKSB7CiAgICAgICAgY2hlY2tQcm9wVHlwZXMocHJvdmlkZXJQcm9wVHlwZXMsIG5ld1Byb3BzLCAncHJvcCcsICdDb250ZXh0LlByb3ZpZGVyJyk7CiAgICAgIH0KICAgIH0KCiAgICBwdXNoUHJvdmlkZXIod29ya0luUHJvZ3Jlc3MsIGNvbnRleHQsIG5ld1ZhbHVlKTsKCiAgICB7CiAgICAgIGlmIChvbGRQcm9wcyAhPT0gbnVsbCkgewogICAgICAgIHZhciBvbGRWYWx1ZSA9IG9sZFByb3BzLnZhbHVlOwoKICAgICAgICBpZiAob2JqZWN0SXMob2xkVmFsdWUsIG5ld1ZhbHVlKSkgewogICAgICAgICAgLy8gTm8gY2hhbmdlLiBCYWlsb3V0IGVhcmx5IGlmIGNoaWxkcmVuIGFyZSB0aGUgc2FtZS4KICAgICAgICAgIGlmIChvbGRQcm9wcy5jaGlsZHJlbiA9PT0gbmV3UHJvcHMuY2hpbGRyZW4gJiYgIWhhc0NvbnRleHRDaGFuZ2VkKCkpIHsKICAgICAgICAgICAgcmV0dXJuIGJhaWxvdXRPbkFscmVhZHlGaW5pc2hlZFdvcmsoY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIHJlbmRlckxhbmVzKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy8gVGhlIGNvbnRleHQgdmFsdWUgY2hhbmdlZC4gU2VhcmNoIGZvciBtYXRjaGluZyBjb25zdW1lcnMgYW5kIHNjaGVkdWxlCiAgICAgICAgICAvLyB0aGVtIHRvIHVwZGF0ZS4KICAgICAgICAgIHByb3BhZ2F0ZUNvbnRleHRDaGFuZ2Uod29ya0luUHJvZ3Jlc3MsIGNvbnRleHQsIHJlbmRlckxhbmVzKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICB2YXIgbmV3Q2hpbGRyZW4gPSBuZXdQcm9wcy5jaGlsZHJlbjsKICAgIHJlY29uY2lsZUNoaWxkcmVuKGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCBuZXdDaGlsZHJlbiwgcmVuZGVyTGFuZXMpOwogICAgcmV0dXJuIHdvcmtJblByb2dyZXNzLmNoaWxkOwogIH0KCiAgdmFyIGhhc1dhcm5lZEFib3V0VXNpbmdDb250ZXh0QXNDb25zdW1lciA9IGZhbHNlOwoKICBmdW5jdGlvbiB1cGRhdGVDb250ZXh0Q29uc3VtZXIoY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIHJlbmRlckxhbmVzKSB7CiAgICB2YXIgY29udGV4dCA9IHdvcmtJblByb2dyZXNzLnR5cGU7IC8vIFRoZSBsb2dpYyBiZWxvdyBmb3IgQ29udGV4dCBkaWZmZXJzIGRlcGVuZGluZyBvbiBQUk9EIG9yIERFViBtb2RlLiBJbgogICAgLy8gREVWIG1vZGUsIHdlIGNyZWF0ZSBhIHNlcGFyYXRlIG9iamVjdCBmb3IgQ29udGV4dC5Db25zdW1lciB0aGF0IGFjdHMKICAgIC8vIGxpa2UgYSBwcm94eSB0byBDb250ZXh0LiBUaGlzIHByb3h5IG9iamVjdCBhZGRzIHVubmVjZXNzYXJ5IGNvZGUgaW4gUFJPRAogICAgLy8gc28gd2UgdXNlIHRoZSBvbGQgYmVoYXZpb3VyIChDb250ZXh0LkNvbnN1bWVyIHJlZmVyZW5jZXMgQ29udGV4dCkgdG8KICAgIC8vIHJlZHVjZSBzaXplIGFuZCBvdmVyaGVhZC4gVGhlIHNlcGFyYXRlIG9iamVjdCByZWZlcmVuY2VzIGNvbnRleHQgdmlhCiAgICAvLyBhIHByb3BlcnR5IGNhbGxlZCAiX2NvbnRleHQiLCB3aGljaCBhbHNvIGdpdmVzIHVzIHRoZSBhYmlsaXR5IHRvIGNoZWNrCiAgICAvLyBpbiBERVYgbW9kZSBpZiB0aGlzIHByb3BlcnR5IGV4aXN0cyBvciBub3QgYW5kIHdhcm4gaWYgaXQgZG9lcyBub3QuCgogICAgewogICAgICBpZiAoY29udGV4dC5fY29udGV4dCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgLy8gVGhpcyBtYXkgYmUgYmVjYXVzZSBpdCdzIGEgQ29udGV4dCAocmF0aGVyIHRoYW4gYSBDb25zdW1lcikuCiAgICAgICAgLy8gT3IgaXQgbWF5IGJlIGJlY2F1c2UgaXQncyBvbGRlciBSZWFjdCB3aGVyZSB0aGV5J3JlIHRoZSBzYW1lIHRoaW5nLgogICAgICAgIC8vIFdlIG9ubHkgd2FudCB0byB3YXJuIGlmIHdlJ3JlIHN1cmUgaXQncyBhIG5ldyBSZWFjdC4KICAgICAgICBpZiAoY29udGV4dCAhPT0gY29udGV4dC5Db25zdW1lcikgewogICAgICAgICAgaWYgKCFoYXNXYXJuZWRBYm91dFVzaW5nQ29udGV4dEFzQ29uc3VtZXIpIHsKICAgICAgICAgICAgaGFzV2FybmVkQWJvdXRVc2luZ0NvbnRleHRBc0NvbnN1bWVyID0gdHJ1ZTsKCiAgICAgICAgICAgIGVycm9yKCdSZW5kZXJpbmcgPENvbnRleHQ+IGRpcmVjdGx5IGlzIG5vdCBzdXBwb3J0ZWQgYW5kIHdpbGwgYmUgcmVtb3ZlZCBpbiAnICsgJ2EgZnV0dXJlIG1ham9yIHJlbGVhc2UuIERpZCB5b3UgbWVhbiB0byByZW5kZXIgPENvbnRleHQuQ29uc3VtZXI+IGluc3RlYWQ/Jyk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGNvbnRleHQgPSBjb250ZXh0Ll9jb250ZXh0OwogICAgICB9CiAgICB9CgogICAgdmFyIG5ld1Byb3BzID0gd29ya0luUHJvZ3Jlc3MucGVuZGluZ1Byb3BzOwogICAgdmFyIHJlbmRlciA9IG5ld1Byb3BzLmNoaWxkcmVuOwoKICAgIHsKICAgICAgaWYgKHR5cGVvZiByZW5kZXIgIT09ICdmdW5jdGlvbicpIHsKICAgICAgICBlcnJvcignQSBjb250ZXh0IGNvbnN1bWVyIHdhcyByZW5kZXJlZCB3aXRoIG11bHRpcGxlIGNoaWxkcmVuLCBvciBhIGNoaWxkICcgKyAidGhhdCBpc24ndCBhIGZ1bmN0aW9uLiBBIGNvbnRleHQgY29uc3VtZXIgZXhwZWN0cyBhIHNpbmdsZSBjaGlsZCAiICsgJ3RoYXQgaXMgYSBmdW5jdGlvbi4gSWYgeW91IGRpZCBwYXNzIGEgZnVuY3Rpb24sIG1ha2Ugc3VyZSB0aGVyZSAnICsgJ2lzIG5vIHRyYWlsaW5nIG9yIGxlYWRpbmcgd2hpdGVzcGFjZSBhcm91bmQgaXQuJyk7CiAgICAgIH0KICAgIH0KCiAgICBwcmVwYXJlVG9SZWFkQ29udGV4dCh3b3JrSW5Qcm9ncmVzcywgcmVuZGVyTGFuZXMpOwogICAgdmFyIG5ld1ZhbHVlID0gcmVhZENvbnRleHQoY29udGV4dCk7CgogICAgewogICAgICBtYXJrQ29tcG9uZW50UmVuZGVyU3RhcnRlZCh3b3JrSW5Qcm9ncmVzcyk7CiAgICB9CgogICAgdmFyIG5ld0NoaWxkcmVuOwoKICAgIHsKICAgICAgUmVhY3RDdXJyZW50T3duZXIkMS5jdXJyZW50ID0gd29ya0luUHJvZ3Jlc3M7CiAgICAgIHNldElzUmVuZGVyaW5nKHRydWUpOwogICAgICBuZXdDaGlsZHJlbiA9IHJlbmRlcihuZXdWYWx1ZSk7CiAgICAgIHNldElzUmVuZGVyaW5nKGZhbHNlKTsKICAgIH0KCiAgICB7CiAgICAgIG1hcmtDb21wb25lbnRSZW5kZXJTdG9wcGVkKCk7CiAgICB9IC8vIFJlYWN0IERldlRvb2xzIHJlYWRzIHRoaXMgZmxhZy4KCgogICAgd29ya0luUHJvZ3Jlc3MuZmxhZ3MgfD0gUGVyZm9ybWVkV29yazsKICAgIHJlY29uY2lsZUNoaWxkcmVuKGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCBuZXdDaGlsZHJlbiwgcmVuZGVyTGFuZXMpOwogICAgcmV0dXJuIHdvcmtJblByb2dyZXNzLmNoaWxkOwogIH0KCiAgZnVuY3Rpb24gbWFya1dvcmtJblByb2dyZXNzUmVjZWl2ZWRVcGRhdGUoKSB7CiAgICBkaWRSZWNlaXZlVXBkYXRlID0gdHJ1ZTsKICB9CgogIGZ1bmN0aW9uIHJlc2V0U3VzcGVuZGVkQ3VycmVudE9uTW91bnRJbkxlZ2FjeU1vZGUoY3VycmVudCwgd29ya0luUHJvZ3Jlc3MpIHsKICAgIGlmICgod29ya0luUHJvZ3Jlc3MubW9kZSAmIENvbmN1cnJlbnRNb2RlKSA9PT0gTm9Nb2RlKSB7CiAgICAgIGlmIChjdXJyZW50ICE9PSBudWxsKSB7CiAgICAgICAgLy8gQSBsYXp5IGNvbXBvbmVudCBvbmx5IG1vdW50cyBpZiBpdCBzdXNwZW5kZWQgaW5zaWRlIGEgbm9uLQogICAgICAgIC8vIGNvbmN1cnJlbnQgdHJlZSwgaW4gYW4gaW5jb25zaXN0ZW50IHN0YXRlLiBXZSB3YW50IHRvIHRyZWF0IGl0IGxpa2UKICAgICAgICAvLyBhIG5ldyBtb3VudCwgZXZlbiB0aG91Z2ggYW4gZW1wdHkgdmVyc2lvbiBvZiBpdCBhbHJlYWR5IGNvbW1pdHRlZC4KICAgICAgICAvLyBEaXNjb25uZWN0IHRoZSBhbHRlcm5hdGUgcG9pbnRlcnMuCiAgICAgICAgY3VycmVudC5hbHRlcm5hdGUgPSBudWxsOwogICAgICAgIHdvcmtJblByb2dyZXNzLmFsdGVybmF0ZSA9IG51bGw7IC8vIFNpbmNlIHRoaXMgaXMgY29uY2VwdHVhbGx5IGEgbmV3IGZpYmVyLCBzY2hlZHVsZSBhIFBsYWNlbWVudCBlZmZlY3QKCiAgICAgICAgd29ya0luUHJvZ3Jlc3MuZmxhZ3MgfD0gUGxhY2VtZW50OwogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiBiYWlsb3V0T25BbHJlYWR5RmluaXNoZWRXb3JrKGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCByZW5kZXJMYW5lcykgewogICAgaWYgKGN1cnJlbnQgIT09IG51bGwpIHsKICAgICAgLy8gUmV1c2UgcHJldmlvdXMgZGVwZW5kZW5jaWVzCiAgICAgIHdvcmtJblByb2dyZXNzLmRlcGVuZGVuY2llcyA9IGN1cnJlbnQuZGVwZW5kZW5jaWVzOwogICAgfQoKICAgIHsKICAgICAgLy8gRG9uJ3QgdXBkYXRlICJiYXNlIiByZW5kZXIgdGltZXMgZm9yIGJhaWxvdXRzLgogICAgICBzdG9wUHJvZmlsZXJUaW1lcklmUnVubmluZygpOwogICAgfQoKICAgIG1hcmtTa2lwcGVkVXBkYXRlTGFuZXMod29ya0luUHJvZ3Jlc3MubGFuZXMpOyAvLyBDaGVjayBpZiB0aGUgY2hpbGRyZW4gaGF2ZSBhbnkgcGVuZGluZyB3b3JrLgoKICAgIGlmICghaW5jbHVkZXNTb21lTGFuZShyZW5kZXJMYW5lcywgd29ya0luUHJvZ3Jlc3MuY2hpbGRMYW5lcykpIHsKICAgICAgLy8gVGhlIGNoaWxkcmVuIGRvbid0IGhhdmUgYW55IHdvcmsgZWl0aGVyLiBXZSBjYW4gc2tpcCB0aGVtLgogICAgICAvLyBUT0RPOiBPbmNlIHdlIGFkZCBiYWNrIHJlc3VtaW5nLCB3ZSBzaG91bGQgY2hlY2sgaWYgdGhlIGNoaWxkcmVuIGFyZQogICAgICAvLyBhIHdvcmstaW4tcHJvZ3Jlc3Mgc2V0LiBJZiBzbywgd2UgbmVlZCB0byB0cmFuc2ZlciB0aGVpciBlZmZlY3RzLgogICAgICB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgIH0gLy8gVGhpcyBmaWJlciBkb2Vzbid0IGhhdmUgd29yaywgYnV0IGl0cyBzdWJ0cmVlIGRvZXMuIENsb25lIHRoZSBjaGlsZAogICAgLy8gZmliZXJzIGFuZCBjb250aW51ZS4KCgogICAgY2xvbmVDaGlsZEZpYmVycyhjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcyk7CiAgICByZXR1cm4gd29ya0luUHJvZ3Jlc3MuY2hpbGQ7CiAgfQoKICBmdW5jdGlvbiByZW1vdW50RmliZXIoY3VycmVudCwgb2xkV29ya0luUHJvZ3Jlc3MsIG5ld1dvcmtJblByb2dyZXNzKSB7CiAgICB7CiAgICAgIHZhciByZXR1cm5GaWJlciA9IG9sZFdvcmtJblByb2dyZXNzLnJldHVybjsKCiAgICAgIGlmIChyZXR1cm5GaWJlciA9PT0gbnVsbCkgewogICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC1pbnRlcm5hbC9wcm9kLWVycm9yLWNvZGVzCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDYW5ub3Qgc3dhcCB0aGUgcm9vdCBmaWJlci4nKTsKICAgICAgfSAvLyBEaXNjb25uZWN0IGZyb20gdGhlIG9sZCBjdXJyZW50LgogICAgICAvLyBJdCB3aWxsIGdldCBkZWxldGVkLgoKCiAgICAgIGN1cnJlbnQuYWx0ZXJuYXRlID0gbnVsbDsKICAgICAgb2xkV29ya0luUHJvZ3Jlc3MuYWx0ZXJuYXRlID0gbnVsbDsgLy8gQ29ubmVjdCB0byB0aGUgbmV3IHRyZWUuCgogICAgICBuZXdXb3JrSW5Qcm9ncmVzcy5pbmRleCA9IG9sZFdvcmtJblByb2dyZXNzLmluZGV4OwogICAgICBuZXdXb3JrSW5Qcm9ncmVzcy5zaWJsaW5nID0gb2xkV29ya0luUHJvZ3Jlc3Muc2libGluZzsKICAgICAgbmV3V29ya0luUHJvZ3Jlc3MucmV0dXJuID0gb2xkV29ya0luUHJvZ3Jlc3MucmV0dXJuOwogICAgICBuZXdXb3JrSW5Qcm9ncmVzcy5yZWYgPSBvbGRXb3JrSW5Qcm9ncmVzcy5yZWY7IC8vIFJlcGxhY2UgdGhlIGNoaWxkL3NpYmxpbmcgcG9pbnRlcnMgYWJvdmUgaXQuCgogICAgICBpZiAob2xkV29ya0luUHJvZ3Jlc3MgPT09IHJldHVybkZpYmVyLmNoaWxkKSB7CiAgICAgICAgcmV0dXJuRmliZXIuY2hpbGQgPSBuZXdXb3JrSW5Qcm9ncmVzczsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgcHJldlNpYmxpbmcgPSByZXR1cm5GaWJlci5jaGlsZDsKCiAgICAgICAgaWYgKHByZXZTaWJsaW5nID09PSBudWxsKSB7CiAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaW50ZXJuYWwvcHJvZC1lcnJvci1jb2RlcwogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdFeHBlY3RlZCBwYXJlbnQgdG8gaGF2ZSBhIGNoaWxkLicpOwogICAgICAgIH0KCiAgICAgICAgd2hpbGUgKHByZXZTaWJsaW5nLnNpYmxpbmcgIT09IG9sZFdvcmtJblByb2dyZXNzKSB7CiAgICAgICAgICBwcmV2U2libGluZyA9IHByZXZTaWJsaW5nLnNpYmxpbmc7CgogICAgICAgICAgaWYgKHByZXZTaWJsaW5nID09PSBudWxsKSB7CiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC1pbnRlcm5hbC9wcm9kLWVycm9yLWNvZGVzCiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRXhwZWN0ZWQgdG8gZmluZCB0aGUgcHJldmlvdXMgc2libGluZy4nKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHByZXZTaWJsaW5nLnNpYmxpbmcgPSBuZXdXb3JrSW5Qcm9ncmVzczsKICAgICAgfSAvLyBEZWxldGUgdGhlIG9sZCBmaWJlciBhbmQgcGxhY2UgdGhlIG5ldyBvbmUuCiAgICAgIC8vIFNpbmNlIHRoZSBvbGQgZmliZXIgaXMgZGlzY29ubmVjdGVkLCB3ZSBoYXZlIHRvIHNjaGVkdWxlIGl0IG1hbnVhbGx5LgoKCiAgICAgIHZhciBkZWxldGlvbnMgPSByZXR1cm5GaWJlci5kZWxldGlvbnM7CgogICAgICBpZiAoZGVsZXRpb25zID09PSBudWxsKSB7CiAgICAgICAgcmV0dXJuRmliZXIuZGVsZXRpb25zID0gW2N1cnJlbnRdOwogICAgICAgIHJldHVybkZpYmVyLmZsYWdzIHw9IENoaWxkRGVsZXRpb247CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZGVsZXRpb25zLnB1c2goY3VycmVudCk7CiAgICAgIH0KCiAgICAgIG5ld1dvcmtJblByb2dyZXNzLmZsYWdzIHw9IFBsYWNlbWVudDsgLy8gUmVzdGFydCB3b3JrIGZyb20gdGhlIG5ldyBmaWJlci4KCiAgICAgIHJldHVybiBuZXdXb3JrSW5Qcm9ncmVzczsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGNoZWNrU2NoZWR1bGVkVXBkYXRlT3JDb250ZXh0KGN1cnJlbnQsIHJlbmRlckxhbmVzKSB7CiAgICAvLyBCZWZvcmUgcGVyZm9ybWluZyBhbiBlYXJseSBiYWlsb3V0LCB3ZSBtdXN0IGNoZWNrIGlmIHRoZXJlIGFyZSBwZW5kaW5nCiAgICAvLyB1cGRhdGVzIG9yIGNvbnRleHQuCiAgICB2YXIgdXBkYXRlTGFuZXMgPSBjdXJyZW50LmxhbmVzOwoKICAgIGlmIChpbmNsdWRlc1NvbWVMYW5lKHVwZGF0ZUxhbmVzLCByZW5kZXJMYW5lcykpIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9IC8vIE5vIHBlbmRpbmcgdXBkYXRlLCBidXQgYmVjYXVzZSBjb250ZXh0IGlzIHByb3BhZ2F0ZWQgbGF6aWx5LCB3ZSBuZWVkCgogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgZnVuY3Rpb24gYXR0ZW1wdEVhcmx5QmFpbG91dElmTm9TY2hlZHVsZWRVcGRhdGUoY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIHJlbmRlckxhbmVzKSB7CiAgICAvLyBUaGlzIGZpYmVyIGRvZXMgbm90IGhhdmUgYW55IHBlbmRpbmcgd29yay4gQmFpbG91dCB3aXRob3V0IGVudGVyaW5nCiAgICAvLyB0aGUgYmVnaW4gcGhhc2UuIFRoZXJlJ3Mgc3RpbGwgc29tZSBib29ra2VlcGluZyB3ZSB0aGF0IG5lZWRzIHRvIGJlIGRvbmUKICAgIC8vIGluIHRoaXMgb3B0aW1pemVkIHBhdGgsIG1vc3RseSBwdXNoaW5nIHN0dWZmIG9udG8gdGhlIHN0YWNrLgogICAgc3dpdGNoICh3b3JrSW5Qcm9ncmVzcy50YWcpIHsKICAgICAgY2FzZSBIb3N0Um9vdDoKICAgICAgICBwdXNoSG9zdFJvb3RDb250ZXh0KHdvcmtJblByb2dyZXNzKTsKICAgICAgICB2YXIgcm9vdCA9IHdvcmtJblByb2dyZXNzLnN0YXRlTm9kZTsKCiAgICAgICAgcmVzZXRIeWRyYXRpb25TdGF0ZSgpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSBIb3N0Q29tcG9uZW50OgogICAgICAgIHB1c2hIb3N0Q29udGV4dCh3b3JrSW5Qcm9ncmVzcyk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIENsYXNzQ29tcG9uZW50OgogICAgICAgIHsKICAgICAgICAgIHZhciBDb21wb25lbnQgPSB3b3JrSW5Qcm9ncmVzcy50eXBlOwoKICAgICAgICAgIGlmIChpc0NvbnRleHRQcm92aWRlcihDb21wb25lbnQpKSB7CiAgICAgICAgICAgIHB1c2hDb250ZXh0UHJvdmlkZXIod29ya0luUHJvZ3Jlc3MpOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgIGNhc2UgSG9zdFBvcnRhbDoKICAgICAgICBwdXNoSG9zdENvbnRhaW5lcih3b3JrSW5Qcm9ncmVzcywgd29ya0luUHJvZ3Jlc3Muc3RhdGVOb2RlLmNvbnRhaW5lckluZm8pOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSBDb250ZXh0UHJvdmlkZXI6CiAgICAgICAgewogICAgICAgICAgdmFyIG5ld1ZhbHVlID0gd29ya0luUHJvZ3Jlc3MubWVtb2l6ZWRQcm9wcy52YWx1ZTsKICAgICAgICAgIHZhciBjb250ZXh0ID0gd29ya0luUHJvZ3Jlc3MudHlwZS5fY29udGV4dDsKICAgICAgICAgIHB1c2hQcm92aWRlcih3b3JrSW5Qcm9ncmVzcywgY29udGV4dCwgbmV3VmFsdWUpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgY2FzZSBQcm9maWxlcjoKICAgICAgICB7CiAgICAgICAgICAvLyBQcm9maWxlciBzaG91bGQgb25seSBjYWxsIG9uUmVuZGVyIHdoZW4gb25lIG9mIGl0cyBkZXNjZW5kYW50cyBhY3R1YWxseSByZW5kZXJlZC4KICAgICAgICAgIHZhciBoYXNDaGlsZFdvcmsgPSBpbmNsdWRlc1NvbWVMYW5lKHJlbmRlckxhbmVzLCB3b3JrSW5Qcm9ncmVzcy5jaGlsZExhbmVzKTsKCiAgICAgICAgICBpZiAoaGFzQ2hpbGRXb3JrKSB7CiAgICAgICAgICAgIHdvcmtJblByb2dyZXNzLmZsYWdzIHw9IFVwZGF0ZTsKICAgICAgICAgIH0KCiAgICAgICAgICB7CiAgICAgICAgICAgIC8vIFJlc2V0IGVmZmVjdCBkdXJhdGlvbnMgZm9yIHRoZSBuZXh0IGV2ZW50dWFsIGVmZmVjdCBwaGFzZS4KICAgICAgICAgICAgLy8gVGhlc2UgYXJlIHJlc2V0IGR1cmluZyByZW5kZXIgdG8gYWxsb3cgdGhlIERldlRvb2xzIGNvbW1pdCBob29rIGEgY2hhbmNlIHRvIHJlYWQgdGhlbSwKICAgICAgICAgICAgdmFyIHN0YXRlTm9kZSA9IHdvcmtJblByb2dyZXNzLnN0YXRlTm9kZTsKICAgICAgICAgICAgc3RhdGVOb2RlLmVmZmVjdER1cmF0aW9uID0gMDsKICAgICAgICAgICAgc3RhdGVOb2RlLnBhc3NpdmVFZmZlY3REdXJhdGlvbiA9IDA7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgU3VzcGVuc2VDb21wb25lbnQ6CiAgICAgICAgewogICAgICAgICAgdmFyIHN0YXRlID0gd29ya0luUHJvZ3Jlc3MubWVtb2l6ZWRTdGF0ZTsKCiAgICAgICAgICBpZiAoc3RhdGUgIT09IG51bGwpIHsKICAgICAgICAgICAgaWYgKHN0YXRlLmRlaHlkcmF0ZWQgIT09IG51bGwpIHsKICAgICAgICAgICAgICBwdXNoU3VzcGVuc2VDb250ZXh0KHdvcmtJblByb2dyZXNzLCBzZXREZWZhdWx0U2hhbGxvd1N1c3BlbnNlQ29udGV4dChzdXNwZW5zZVN0YWNrQ3Vyc29yLmN1cnJlbnQpKTsgLy8gV2Uga25vdyB0aGF0IHRoaXMgY29tcG9uZW50IHdpbGwgc3VzcGVuZCBhZ2FpbiBiZWNhdXNlIGlmIGl0IGhhcwogICAgICAgICAgICAgIC8vIGJlZW4gdW5zdXNwZW5kZWQgaXQgaGFzIGNvbW1pdHRlZCBhcyBhIHJlc29sdmVkIFN1c3BlbnNlIGNvbXBvbmVudC4KICAgICAgICAgICAgICAvLyBJZiBpdCBuZWVkcyB0byBiZSByZXRyaWVkLCBpdCBzaG91bGQgaGF2ZSB3b3JrIHNjaGVkdWxlZCBvbiBpdC4KCiAgICAgICAgICAgICAgd29ya0luUHJvZ3Jlc3MuZmxhZ3MgfD0gRGlkQ2FwdHVyZTsgLy8gV2Ugc2hvdWxkIG5ldmVyIHJlbmRlciB0aGUgY2hpbGRyZW4gb2YgYSBkZWh5ZHJhdGVkIGJvdW5kYXJ5IHVudGlsIHdlCiAgICAgICAgICAgICAgLy8gdXBncmFkZSBpdC4gV2UgcmV0dXJuIG51bGwgaW5zdGVhZCBvZiBiYWlsb3V0T25BbHJlYWR5RmluaXNoZWRXb3JrLgoKICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgfSAvLyBJZiB0aGlzIGJvdW5kYXJ5IGlzIGN1cnJlbnRseSB0aW1lZCBvdXQsIHdlIG5lZWQgdG8gZGVjaWRlCiAgICAgICAgICAgIC8vIHdoZXRoZXIgdG8gcmV0cnkgdGhlIHByaW1hcnkgY2hpbGRyZW4sIG9yIHRvIHNraXAgb3ZlciBpdCBhbmQKICAgICAgICAgICAgLy8gZ28gc3RyYWlnaHQgdG8gdGhlIGZhbGxiYWNrLiBDaGVjayB0aGUgcHJpb3JpdHkgb2YgdGhlIHByaW1hcnkKICAgICAgICAgICAgLy8gY2hpbGQgZnJhZ21lbnQuCgoKICAgICAgICAgICAgdmFyIHByaW1hcnlDaGlsZEZyYWdtZW50ID0gd29ya0luUHJvZ3Jlc3MuY2hpbGQ7CiAgICAgICAgICAgIHZhciBwcmltYXJ5Q2hpbGRMYW5lcyA9IHByaW1hcnlDaGlsZEZyYWdtZW50LmNoaWxkTGFuZXM7CgogICAgICAgICAgICBpZiAoaW5jbHVkZXNTb21lTGFuZShyZW5kZXJMYW5lcywgcHJpbWFyeUNoaWxkTGFuZXMpKSB7CiAgICAgICAgICAgICAgLy8gVGhlIHByaW1hcnkgY2hpbGRyZW4gaGF2ZSBwZW5kaW5nIHdvcmsuIFVzZSB0aGUgbm9ybWFsIHBhdGgKICAgICAgICAgICAgICAvLyB0byBhdHRlbXB0IHRvIHJlbmRlciB0aGUgcHJpbWFyeSBjaGlsZHJlbiBhZ2Fpbi4KICAgICAgICAgICAgICByZXR1cm4gdXBkYXRlU3VzcGVuc2VDb21wb25lbnQoY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIHJlbmRlckxhbmVzKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAvLyBUaGUgcHJpbWFyeSBjaGlsZCBmcmFnbWVudCBkb2VzIG5vdCBoYXZlIHBlbmRpbmcgd29yayBtYXJrZWQKICAgICAgICAgICAgICAvLyBvbiBpdAogICAgICAgICAgICAgIHB1c2hTdXNwZW5zZUNvbnRleHQod29ya0luUHJvZ3Jlc3MsIHNldERlZmF1bHRTaGFsbG93U3VzcGVuc2VDb250ZXh0KHN1c3BlbnNlU3RhY2tDdXJzb3IuY3VycmVudCkpOyAvLyBUaGUgcHJpbWFyeSBjaGlsZHJlbiBkbyBub3QgaGF2ZSBwZW5kaW5nIHdvcmsgd2l0aCBzdWZmaWNpZW50CiAgICAgICAgICAgICAgLy8gcHJpb3JpdHkuIEJhaWxvdXQuCgogICAgICAgICAgICAgIHZhciBjaGlsZCA9IGJhaWxvdXRPbkFscmVhZHlGaW5pc2hlZFdvcmsoY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIHJlbmRlckxhbmVzKTsKCiAgICAgICAgICAgICAgaWYgKGNoaWxkICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAvLyBUaGUgZmFsbGJhY2sgY2hpbGRyZW4gaGF2ZSBwZW5kaW5nIHdvcmsuIFNraXAgb3ZlciB0aGUKICAgICAgICAgICAgICAgIC8vIHByaW1hcnkgY2hpbGRyZW4gYW5kIHdvcmsgb24gdGhlIGZhbGxiYWNrLgogICAgICAgICAgICAgICAgcmV0dXJuIGNoaWxkLnNpYmxpbmc7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIC8vIE5vdGU6IFdlIGNhbiByZXR1cm4gYG51bGxgIGhlcmUgYmVjYXVzZSB3ZSBhbHJlYWR5IGNoZWNrZWQKICAgICAgICAgICAgICAgIC8vIHdoZXRoZXIgdGhlcmUgd2VyZSBuZXN0ZWQgY29udGV4dCBjb25zdW1lcnMsIHZpYSB0aGUgY2FsbCB0bwogICAgICAgICAgICAgICAgLy8gYGJhaWxvdXRPbkFscmVhZHlGaW5pc2hlZFdvcmtgIGFib3ZlLgogICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBwdXNoU3VzcGVuc2VDb250ZXh0KHdvcmtJblByb2dyZXNzLCBzZXREZWZhdWx0U2hhbGxvd1N1c3BlbnNlQ29udGV4dChzdXNwZW5zZVN0YWNrQ3Vyc29yLmN1cnJlbnQpKTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICBjYXNlIFN1c3BlbnNlTGlzdENvbXBvbmVudDoKICAgICAgICB7CiAgICAgICAgICB2YXIgZGlkU3VzcGVuZEJlZm9yZSA9IChjdXJyZW50LmZsYWdzICYgRGlkQ2FwdHVyZSkgIT09IE5vRmxhZ3M7CgogICAgICAgICAgdmFyIF9oYXNDaGlsZFdvcmsgPSBpbmNsdWRlc1NvbWVMYW5lKHJlbmRlckxhbmVzLCB3b3JrSW5Qcm9ncmVzcy5jaGlsZExhbmVzKTsKCiAgICAgICAgICBpZiAoZGlkU3VzcGVuZEJlZm9yZSkgewogICAgICAgICAgICBpZiAoX2hhc0NoaWxkV29yaykgewogICAgICAgICAgICAgIC8vIElmIHNvbWV0aGluZyB3YXMgaW4gZmFsbGJhY2sgc3RhdGUgbGFzdCB0aW1lLCBhbmQgd2UgaGF2ZSBhbGwgdGhlCiAgICAgICAgICAgICAgLy8gc2FtZSBjaGlsZHJlbiB0aGVuIHdlJ3JlIHN0aWxsIGluIHByb2dyZXNzaXZlIGxvYWRpbmcgc3RhdGUuCiAgICAgICAgICAgICAgLy8gU29tZXRoaW5nIG1pZ2h0IGdldCB1bmJsb2NrZWQgYnkgc3RhdGUgdXBkYXRlcyBvciByZXRyaWVzIGluIHRoZQogICAgICAgICAgICAgIC8vIHRyZWUgd2hpY2ggd2lsbCBhZmZlY3QgdGhlIHRhaWwuIFNvIHdlIG5lZWQgdG8gdXNlIHRoZSBub3JtYWwKICAgICAgICAgICAgICAvLyBwYXRoIHRvIGNvbXB1dGUgdGhlIGNvcnJlY3QgdGFpbC4KICAgICAgICAgICAgICByZXR1cm4gdXBkYXRlU3VzcGVuc2VMaXN0Q29tcG9uZW50KGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCByZW5kZXJMYW5lcyk7CiAgICAgICAgICAgIH0gLy8gSWYgbm9uZSBvZiB0aGUgY2hpbGRyZW4gaGFkIGFueSB3b3JrLCB0aGF0IG1lYW5zIHRoYXQgbm9uZSBvZgogICAgICAgICAgICAvLyB0aGVtIGdvdCByZXRyaWVkIHNvIHRoZXknbGwgc3RpbGwgYmUgYmxvY2tlZCBpbiB0aGUgc2FtZSB3YXkKICAgICAgICAgICAgLy8gYXMgYmVmb3JlLiBXZSBjYW4gZmFzdCBiYWlsIG91dC4KCgogICAgICAgICAgICB3b3JrSW5Qcm9ncmVzcy5mbGFncyB8PSBEaWRDYXB0dXJlOwogICAgICAgICAgfSAvLyBJZiBub3RoaW5nIHN1c3BlbmRlZCBiZWZvcmUgYW5kIHdlJ3JlIHJlbmRlcmluZyB0aGUgc2FtZSBjaGlsZHJlbiwKICAgICAgICAgIC8vIHRoZW4gdGhlIHRhaWwgZG9lc24ndCBtYXR0ZXIuIEFueXRoaW5nIG5ldyB0aGF0IHN1c3BlbmRzIHdpbGwgd29yawogICAgICAgICAgLy8gaW4gdGhlICJ0b2dldGhlciIgbW9kZSwgc28gd2UgY2FuIGNvbnRpbnVlIGZyb20gdGhlIHN0YXRlIHdlIGhhZC4KCgogICAgICAgICAgdmFyIHJlbmRlclN0YXRlID0gd29ya0luUHJvZ3Jlc3MubWVtb2l6ZWRTdGF0ZTsKCiAgICAgICAgICBpZiAocmVuZGVyU3RhdGUgIT09IG51bGwpIHsKICAgICAgICAgICAgLy8gUmVzZXQgdG8gdGhlICJ0b2dldGhlciIgbW9kZSBpbiBjYXNlIHdlJ3ZlIHN0YXJ0ZWQgYSBkaWZmZXJlbnQKICAgICAgICAgICAgLy8gdXBkYXRlIGluIHRoZSBwYXN0IGJ1dCBkaWRuJ3QgY29tcGxldGUgaXQuCiAgICAgICAgICAgIHJlbmRlclN0YXRlLnJlbmRlcmluZyA9IG51bGw7CiAgICAgICAgICAgIHJlbmRlclN0YXRlLnRhaWwgPSBudWxsOwogICAgICAgICAgICByZW5kZXJTdGF0ZS5sYXN0RWZmZWN0ID0gbnVsbDsKICAgICAgICAgIH0KCiAgICAgICAgICBwdXNoU3VzcGVuc2VDb250ZXh0KHdvcmtJblByb2dyZXNzLCBzdXNwZW5zZVN0YWNrQ3Vyc29yLmN1cnJlbnQpOwoKICAgICAgICAgIGlmIChfaGFzQ2hpbGRXb3JrKSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gSWYgbm9uZSBvZiB0aGUgY2hpbGRyZW4gaGFkIGFueSB3b3JrLCB0aGF0IG1lYW5zIHRoYXQgbm9uZSBvZgogICAgICAgICAgICAvLyB0aGVtIGdvdCByZXRyaWVkIHNvIHRoZXknbGwgc3RpbGwgYmUgYmxvY2tlZCBpbiB0aGUgc2FtZSB3YXkKICAgICAgICAgICAgLy8gYXMgYmVmb3JlLiBXZSBjYW4gZmFzdCBiYWlsIG91dC4KICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgY2FzZSBPZmZzY3JlZW5Db21wb25lbnQ6CiAgICAgIGNhc2UgTGVnYWN5SGlkZGVuQ29tcG9uZW50OgogICAgICAgIHsKICAgICAgICAgIC8vIE5lZWQgdG8gY2hlY2sgaWYgdGhlIHRyZWUgc3RpbGwgbmVlZHMgdG8gYmUgZGVmZXJyZWQuIFRoaXMgaXMKICAgICAgICAgIC8vIGFsbW9zdCBpZGVudGljYWwgdG8gdGhlIGxvZ2ljIHVzZWQgaW4gdGhlIG5vcm1hbCB1cGRhdGUgcGF0aCwKICAgICAgICAgIC8vIHNvIHdlJ2xsIGp1c3QgZW50ZXIgdGhhdC4gVGhlIG9ubHkgZGlmZmVyZW5jZSBpcyB3ZSdsbCBiYWlsIG91dAogICAgICAgICAgLy8gYXQgdGhlIG5leHQgbGV2ZWwgaW5zdGVhZCBvZiB0aGlzIG9uZSwgYmVjYXVzZSB0aGUgY2hpbGQgcHJvcHMKICAgICAgICAgIC8vIGhhdmUgbm90IGNoYW5nZWQuIFdoaWNoIGlzIGZpbmUuCiAgICAgICAgICAvLyBUT0RPOiBQcm9iYWJseSBzaG91bGQgcmVmYWN0b3IgYGJlZ2luV29ya2AgdG8gc3BsaXQgdGhlIGJhaWxvdXQKICAgICAgICAgIC8vIHBhdGggZnJvbSB0aGUgbm9ybWFsIHBhdGguIEknbSB0ZW1wdGVkIHRvIGRvIGEgbGFiZWxlZCBicmVhayBoZXJlCiAgICAgICAgICAvLyBidXQgSSB3b24ndCA6KQogICAgICAgICAgd29ya0luUHJvZ3Jlc3MubGFuZXMgPSBOb0xhbmVzOwogICAgICAgICAgcmV0dXJuIHVwZGF0ZU9mZnNjcmVlbkNvbXBvbmVudChjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcywgcmVuZGVyTGFuZXMpOwogICAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gYmFpbG91dE9uQWxyZWFkeUZpbmlzaGVkV29yayhjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcywgcmVuZGVyTGFuZXMpOwogIH0KCiAgZnVuY3Rpb24gYmVnaW5Xb3JrKGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCByZW5kZXJMYW5lcykgewogICAgewogICAgICBpZiAod29ya0luUHJvZ3Jlc3MuX2RlYnVnTmVlZHNSZW1vdW50ICYmIGN1cnJlbnQgIT09IG51bGwpIHsKICAgICAgICAvLyBUaGlzIHdpbGwgcmVzdGFydCB0aGUgYmVnaW4gcGhhc2Ugd2l0aCBhIG5ldyBmaWJlci4KICAgICAgICByZXR1cm4gcmVtb3VudEZpYmVyKGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCBjcmVhdGVGaWJlckZyb21UeXBlQW5kUHJvcHMod29ya0luUHJvZ3Jlc3MudHlwZSwgd29ya0luUHJvZ3Jlc3Mua2V5LCB3b3JrSW5Qcm9ncmVzcy5wZW5kaW5nUHJvcHMsIHdvcmtJblByb2dyZXNzLl9kZWJ1Z093bmVyIHx8IG51bGwsIHdvcmtJblByb2dyZXNzLm1vZGUsIHdvcmtJblByb2dyZXNzLmxhbmVzKSk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoY3VycmVudCAhPT0gbnVsbCkgewogICAgICB2YXIgb2xkUHJvcHMgPSBjdXJyZW50Lm1lbW9pemVkUHJvcHM7CiAgICAgIHZhciBuZXdQcm9wcyA9IHdvcmtJblByb2dyZXNzLnBlbmRpbmdQcm9wczsKCiAgICAgIGlmIChvbGRQcm9wcyAhPT0gbmV3UHJvcHMgfHwgaGFzQ29udGV4dENoYW5nZWQoKSB8fCAoIC8vIEZvcmNlIGEgcmUtcmVuZGVyIGlmIHRoZSBpbXBsZW1lbnRhdGlvbiBjaGFuZ2VkIGR1ZSB0byBob3QgcmVsb2FkOgogICAgICAgd29ya0luUHJvZ3Jlc3MudHlwZSAhPT0gY3VycmVudC50eXBlICkpIHsKICAgICAgICAvLyBJZiBwcm9wcyBvciBjb250ZXh0IGNoYW5nZWQsIG1hcmsgdGhlIGZpYmVyIGFzIGhhdmluZyBwZXJmb3JtZWQgd29yay4KICAgICAgICAvLyBUaGlzIG1heSBiZSB1bnNldCBpZiB0aGUgcHJvcHMgYXJlIGRldGVybWluZWQgdG8gYmUgZXF1YWwgbGF0ZXIgKG1lbW8pLgogICAgICAgIGRpZFJlY2VpdmVVcGRhdGUgPSB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIE5laXRoZXIgcHJvcHMgbm9yIGxlZ2FjeSBjb250ZXh0IGNoYW5nZXMuIENoZWNrIGlmIHRoZXJlJ3MgYSBwZW5kaW5nCiAgICAgICAgLy8gdXBkYXRlIG9yIGNvbnRleHQgY2hhbmdlLgogICAgICAgIHZhciBoYXNTY2hlZHVsZWRVcGRhdGVPckNvbnRleHQgPSBjaGVja1NjaGVkdWxlZFVwZGF0ZU9yQ29udGV4dChjdXJyZW50LCByZW5kZXJMYW5lcyk7CgogICAgICAgIGlmICghaGFzU2NoZWR1bGVkVXBkYXRlT3JDb250ZXh0ICYmIC8vIElmIHRoaXMgaXMgdGhlIHNlY29uZCBwYXNzIG9mIGFuIGVycm9yIG9yIHN1c3BlbnNlIGJvdW5kYXJ5LCB0aGVyZQogICAgICAgIC8vIG1heSBub3QgYmUgd29yayBzY2hlZHVsZWQgb24gYGN1cnJlbnRgLCBzbyB3ZSBjaGVjayBmb3IgdGhpcyBmbGFnLgogICAgICAgICh3b3JrSW5Qcm9ncmVzcy5mbGFncyAmIERpZENhcHR1cmUpID09PSBOb0ZsYWdzKSB7CiAgICAgICAgICAvLyBObyBwZW5kaW5nIHVwZGF0ZXMgb3IgY29udGV4dC4gQmFpbCBvdXQgbm93LgogICAgICAgICAgZGlkUmVjZWl2ZVVwZGF0ZSA9IGZhbHNlOwogICAgICAgICAgcmV0dXJuIGF0dGVtcHRFYXJseUJhaWxvdXRJZk5vU2NoZWR1bGVkVXBkYXRlKGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCByZW5kZXJMYW5lcyk7CiAgICAgICAgfQoKICAgICAgICBpZiAoKGN1cnJlbnQuZmxhZ3MgJiBGb3JjZVVwZGF0ZUZvckxlZ2FjeVN1c3BlbnNlKSAhPT0gTm9GbGFncykgewogICAgICAgICAgLy8gVGhpcyBpcyBhIHNwZWNpYWwgY2FzZSB0aGF0IG9ubHkgZXhpc3RzIGZvciBsZWdhY3kgbW9kZS4KICAgICAgICAgIC8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2svcmVhY3QvcHVsbC8xOTIxNi4KICAgICAgICAgIGRpZFJlY2VpdmVVcGRhdGUgPSB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyBBbiB1cGRhdGUgd2FzIHNjaGVkdWxlZCBvbiB0aGlzIGZpYmVyLCBidXQgdGhlcmUgYXJlIG5vIG5ldyBwcm9wcwogICAgICAgICAgLy8gbm9yIGxlZ2FjeSBjb250ZXh0LiBTZXQgdGhpcyB0byBmYWxzZS4gSWYgYW4gdXBkYXRlIHF1ZXVlIG9yIGNvbnRleHQKICAgICAgICAgIC8vIGNvbnN1bWVyIHByb2R1Y2VzIGEgY2hhbmdlZCB2YWx1ZSwgaXQgd2lsbCBzZXQgdGhpcyB0byB0cnVlLiBPdGhlcndpc2UsCiAgICAgICAgICAvLyB0aGUgY29tcG9uZW50IHdpbGwgYXNzdW1lIHRoZSBjaGlsZHJlbiBoYXZlIG5vdCBjaGFuZ2VkIGFuZCBiYWlsIG91dC4KICAgICAgICAgIGRpZFJlY2VpdmVVcGRhdGUgPSBmYWxzZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGRpZFJlY2VpdmVVcGRhdGUgPSBmYWxzZTsKCiAgICAgIGlmIChnZXRJc0h5ZHJhdGluZygpICYmIGlzRm9ya2VkQ2hpbGQod29ya0luUHJvZ3Jlc3MpKSB7CiAgICAgICAgLy8gQ2hlY2sgaWYgdGhpcyBjaGlsZCBiZWxvbmdzIHRvIGEgbGlzdCBvZiBtdWxpcGxlIGNoaWxkcmVuIGluCiAgICAgICAgLy8gaXRzIHBhcmVudC4KICAgICAgICAvLwogICAgICAgIC8vIEluIGEgdHJ1ZSBtdWx0aS10aHJlYWRlZCBpbXBsZW1lbnRhdGlvbiwgd2Ugd291bGQgcmVuZGVyIGNoaWxkcmVuIG9uCiAgICAgICAgLy8gcGFyYWxsZWwgdGhyZWFkcy4gVGhpcyB3b3VsZCByZXByZXNlbnQgdGhlIGJlZ2lubmluZyBvZiBhIG5ldyByZW5kZXIKICAgICAgICAvLyB0aHJlYWQgZm9yIHRoaXMgc3VidHJlZS4KICAgICAgICAvLwogICAgICAgIC8vIFdlIG9ubHkgdXNlIHRoaXMgZm9yIGlkIGdlbmVyYXRpb24gZHVyaW5nIGh5ZHJhdGlvbiwgd2hpY2ggaXMgd2h5IHRoZQogICAgICAgIC8vIGxvZ2ljIGlzIGxvY2F0ZWQgaW4gdGhpcyBzcGVjaWFsIGJyYW5jaC4KICAgICAgICB2YXIgc2xvdEluZGV4ID0gd29ya0luUHJvZ3Jlc3MuaW5kZXg7CiAgICAgICAgdmFyIG51bWJlck9mRm9ya3MgPSBnZXRGb3Jrc0F0TGV2ZWwoKTsKICAgICAgICBwdXNoVHJlZUlkKHdvcmtJblByb2dyZXNzLCBudW1iZXJPZkZvcmtzLCBzbG90SW5kZXgpOwogICAgICB9CiAgICB9IC8vIEJlZm9yZSBlbnRlcmluZyB0aGUgYmVnaW4gcGhhc2UsIGNsZWFyIHBlbmRpbmcgdXBkYXRlIHByaW9yaXR5LgogICAgLy8gVE9ETzogVGhpcyBhc3N1bWVzIHRoYXQgd2UncmUgYWJvdXQgdG8gZXZhbHVhdGUgdGhlIGNvbXBvbmVudCBhbmQgcHJvY2VzcwogICAgLy8gdGhlIHVwZGF0ZSBxdWV1ZS4gSG93ZXZlciwgdGhlcmUncyBhbiBleGNlcHRpb246IFNpbXBsZU1lbW9Db21wb25lbnQKICAgIC8vIHNvbWV0aW1lcyBiYWlscyBvdXQgbGF0ZXIgaW4gdGhlIGJlZ2luIHBoYXNlLiBUaGlzIGluZGljYXRlcyB0aGF0IHdlIHNob3VsZAogICAgLy8gbW92ZSB0aGlzIGFzc2lnbm1lbnQgb3V0IG9mIHRoZSBjb21tb24gcGF0aCBhbmQgaW50byBlYWNoIGJyYW5jaC4KCgogICAgd29ya0luUHJvZ3Jlc3MubGFuZXMgPSBOb0xhbmVzOwoKICAgIHN3aXRjaCAod29ya0luUHJvZ3Jlc3MudGFnKSB7CiAgICAgIGNhc2UgSW5kZXRlcm1pbmF0ZUNvbXBvbmVudDoKICAgICAgICB7CiAgICAgICAgICByZXR1cm4gbW91bnRJbmRldGVybWluYXRlQ29tcG9uZW50KGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCB3b3JrSW5Qcm9ncmVzcy50eXBlLCByZW5kZXJMYW5lcyk7CiAgICAgICAgfQoKICAgICAgY2FzZSBMYXp5Q29tcG9uZW50OgogICAgICAgIHsKICAgICAgICAgIHZhciBlbGVtZW50VHlwZSA9IHdvcmtJblByb2dyZXNzLmVsZW1lbnRUeXBlOwogICAgICAgICAgcmV0dXJuIG1vdW50TGF6eUNvbXBvbmVudChjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcywgZWxlbWVudFR5cGUsIHJlbmRlckxhbmVzKTsKICAgICAgICB9CgogICAgICBjYXNlIEZ1bmN0aW9uQ29tcG9uZW50OgogICAgICAgIHsKICAgICAgICAgIHZhciBDb21wb25lbnQgPSB3b3JrSW5Qcm9ncmVzcy50eXBlOwogICAgICAgICAgdmFyIHVucmVzb2x2ZWRQcm9wcyA9IHdvcmtJblByb2dyZXNzLnBlbmRpbmdQcm9wczsKICAgICAgICAgIHZhciByZXNvbHZlZFByb3BzID0gd29ya0luUHJvZ3Jlc3MuZWxlbWVudFR5cGUgPT09IENvbXBvbmVudCA/IHVucmVzb2x2ZWRQcm9wcyA6IHJlc29sdmVEZWZhdWx0UHJvcHMoQ29tcG9uZW50LCB1bnJlc29sdmVkUHJvcHMpOwogICAgICAgICAgcmV0dXJuIHVwZGF0ZUZ1bmN0aW9uQ29tcG9uZW50KGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCBDb21wb25lbnQsIHJlc29sdmVkUHJvcHMsIHJlbmRlckxhbmVzKTsKICAgICAgICB9CgogICAgICBjYXNlIENsYXNzQ29tcG9uZW50OgogICAgICAgIHsKICAgICAgICAgIHZhciBfQ29tcG9uZW50ID0gd29ya0luUHJvZ3Jlc3MudHlwZTsKICAgICAgICAgIHZhciBfdW5yZXNvbHZlZFByb3BzID0gd29ya0luUHJvZ3Jlc3MucGVuZGluZ1Byb3BzOwoKICAgICAgICAgIHZhciBfcmVzb2x2ZWRQcm9wcyA9IHdvcmtJblByb2dyZXNzLmVsZW1lbnRUeXBlID09PSBfQ29tcG9uZW50ID8gX3VucmVzb2x2ZWRQcm9wcyA6IHJlc29sdmVEZWZhdWx0UHJvcHMoX0NvbXBvbmVudCwgX3VucmVzb2x2ZWRQcm9wcyk7CgogICAgICAgICAgcmV0dXJuIHVwZGF0ZUNsYXNzQ29tcG9uZW50KGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCBfQ29tcG9uZW50LCBfcmVzb2x2ZWRQcm9wcywgcmVuZGVyTGFuZXMpOwogICAgICAgIH0KCiAgICAgIGNhc2UgSG9zdFJvb3Q6CiAgICAgICAgcmV0dXJuIHVwZGF0ZUhvc3RSb290KGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCByZW5kZXJMYW5lcyk7CgogICAgICBjYXNlIEhvc3RDb21wb25lbnQ6CiAgICAgICAgcmV0dXJuIHVwZGF0ZUhvc3RDb21wb25lbnQoY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIHJlbmRlckxhbmVzKTsKCiAgICAgIGNhc2UgSG9zdFRleHQ6CiAgICAgICAgcmV0dXJuIHVwZGF0ZUhvc3RUZXh0KGN1cnJlbnQsIHdvcmtJblByb2dyZXNzKTsKCiAgICAgIGNhc2UgU3VzcGVuc2VDb21wb25lbnQ6CiAgICAgICAgcmV0dXJuIHVwZGF0ZVN1c3BlbnNlQ29tcG9uZW50KGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCByZW5kZXJMYW5lcyk7CgogICAgICBjYXNlIEhvc3RQb3J0YWw6CiAgICAgICAgcmV0dXJuIHVwZGF0ZVBvcnRhbENvbXBvbmVudChjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcywgcmVuZGVyTGFuZXMpOwoKICAgICAgY2FzZSBGb3J3YXJkUmVmOgogICAgICAgIHsKICAgICAgICAgIHZhciB0eXBlID0gd29ya0luUHJvZ3Jlc3MudHlwZTsKICAgICAgICAgIHZhciBfdW5yZXNvbHZlZFByb3BzMiA9IHdvcmtJblByb2dyZXNzLnBlbmRpbmdQcm9wczsKCiAgICAgICAgICB2YXIgX3Jlc29sdmVkUHJvcHMyID0gd29ya0luUHJvZ3Jlc3MuZWxlbWVudFR5cGUgPT09IHR5cGUgPyBfdW5yZXNvbHZlZFByb3BzMiA6IHJlc29sdmVEZWZhdWx0UHJvcHModHlwZSwgX3VucmVzb2x2ZWRQcm9wczIpOwoKICAgICAgICAgIHJldHVybiB1cGRhdGVGb3J3YXJkUmVmKGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCB0eXBlLCBfcmVzb2x2ZWRQcm9wczIsIHJlbmRlckxhbmVzKTsKICAgICAgICB9CgogICAgICBjYXNlIEZyYWdtZW50OgogICAgICAgIHJldHVybiB1cGRhdGVGcmFnbWVudChjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcywgcmVuZGVyTGFuZXMpOwoKICAgICAgY2FzZSBNb2RlOgogICAgICAgIHJldHVybiB1cGRhdGVNb2RlKGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCByZW5kZXJMYW5lcyk7CgogICAgICBjYXNlIFByb2ZpbGVyOgogICAgICAgIHJldHVybiB1cGRhdGVQcm9maWxlcihjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcywgcmVuZGVyTGFuZXMpOwoKICAgICAgY2FzZSBDb250ZXh0UHJvdmlkZXI6CiAgICAgICAgcmV0dXJuIHVwZGF0ZUNvbnRleHRQcm92aWRlcihjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcywgcmVuZGVyTGFuZXMpOwoKICAgICAgY2FzZSBDb250ZXh0Q29uc3VtZXI6CiAgICAgICAgcmV0dXJuIHVwZGF0ZUNvbnRleHRDb25zdW1lcihjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcywgcmVuZGVyTGFuZXMpOwoKICAgICAgY2FzZSBNZW1vQ29tcG9uZW50OgogICAgICAgIHsKICAgICAgICAgIHZhciBfdHlwZTIgPSB3b3JrSW5Qcm9ncmVzcy50eXBlOwogICAgICAgICAgdmFyIF91bnJlc29sdmVkUHJvcHMzID0gd29ya0luUHJvZ3Jlc3MucGVuZGluZ1Byb3BzOyAvLyBSZXNvbHZlIG91dGVyIHByb3BzIGZpcnN0LCB0aGVuIHJlc29sdmUgaW5uZXIgcHJvcHMuCgogICAgICAgICAgdmFyIF9yZXNvbHZlZFByb3BzMyA9IHJlc29sdmVEZWZhdWx0UHJvcHMoX3R5cGUyLCBfdW5yZXNvbHZlZFByb3BzMyk7CgogICAgICAgICAgewogICAgICAgICAgICBpZiAod29ya0luUHJvZ3Jlc3MudHlwZSAhPT0gd29ya0luUHJvZ3Jlc3MuZWxlbWVudFR5cGUpIHsKICAgICAgICAgICAgICB2YXIgb3V0ZXJQcm9wVHlwZXMgPSBfdHlwZTIucHJvcFR5cGVzOwoKICAgICAgICAgICAgICBpZiAob3V0ZXJQcm9wVHlwZXMpIHsKICAgICAgICAgICAgICAgIGNoZWNrUHJvcFR5cGVzKG91dGVyUHJvcFR5cGVzLCBfcmVzb2x2ZWRQcm9wczMsIC8vIFJlc29sdmVkIGZvciBvdXRlciBvbmx5CiAgICAgICAgICAgICAgICAncHJvcCcsIGdldENvbXBvbmVudE5hbWVGcm9tVHlwZShfdHlwZTIpKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBfcmVzb2x2ZWRQcm9wczMgPSByZXNvbHZlRGVmYXVsdFByb3BzKF90eXBlMi50eXBlLCBfcmVzb2x2ZWRQcm9wczMpOwogICAgICAgICAgcmV0dXJuIHVwZGF0ZU1lbW9Db21wb25lbnQoY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIF90eXBlMiwgX3Jlc29sdmVkUHJvcHMzLCByZW5kZXJMYW5lcyk7CiAgICAgICAgfQoKICAgICAgY2FzZSBTaW1wbGVNZW1vQ29tcG9uZW50OgogICAgICAgIHsKICAgICAgICAgIHJldHVybiB1cGRhdGVTaW1wbGVNZW1vQ29tcG9uZW50KGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCB3b3JrSW5Qcm9ncmVzcy50eXBlLCB3b3JrSW5Qcm9ncmVzcy5wZW5kaW5nUHJvcHMsIHJlbmRlckxhbmVzKTsKICAgICAgICB9CgogICAgICBjYXNlIEluY29tcGxldGVDbGFzc0NvbXBvbmVudDoKICAgICAgICB7CiAgICAgICAgICB2YXIgX0NvbXBvbmVudDIgPSB3b3JrSW5Qcm9ncmVzcy50eXBlOwogICAgICAgICAgdmFyIF91bnJlc29sdmVkUHJvcHM0ID0gd29ya0luUHJvZ3Jlc3MucGVuZGluZ1Byb3BzOwoKICAgICAgICAgIHZhciBfcmVzb2x2ZWRQcm9wczQgPSB3b3JrSW5Qcm9ncmVzcy5lbGVtZW50VHlwZSA9PT0gX0NvbXBvbmVudDIgPyBfdW5yZXNvbHZlZFByb3BzNCA6IHJlc29sdmVEZWZhdWx0UHJvcHMoX0NvbXBvbmVudDIsIF91bnJlc29sdmVkUHJvcHM0KTsKCiAgICAgICAgICByZXR1cm4gbW91bnRJbmNvbXBsZXRlQ2xhc3NDb21wb25lbnQoY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIF9Db21wb25lbnQyLCBfcmVzb2x2ZWRQcm9wczQsIHJlbmRlckxhbmVzKTsKICAgICAgICB9CgogICAgICBjYXNlIFN1c3BlbnNlTGlzdENvbXBvbmVudDoKICAgICAgICB7CiAgICAgICAgICByZXR1cm4gdXBkYXRlU3VzcGVuc2VMaXN0Q29tcG9uZW50KGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCByZW5kZXJMYW5lcyk7CiAgICAgICAgfQoKICAgICAgY2FzZSBTY29wZUNvbXBvbmVudDoKICAgICAgICB7CgogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgY2FzZSBPZmZzY3JlZW5Db21wb25lbnQ6CiAgICAgICAgewogICAgICAgICAgcmV0dXJuIHVwZGF0ZU9mZnNjcmVlbkNvbXBvbmVudChjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcywgcmVuZGVyTGFuZXMpOwogICAgICAgIH0KICAgIH0KCiAgICB0aHJvdyBuZXcgRXJyb3IoIlVua25vd24gdW5pdCBvZiB3b3JrIHRhZyAoIiArIHdvcmtJblByb2dyZXNzLnRhZyArICIpLiBUaGlzIGVycm9yIGlzIGxpa2VseSBjYXVzZWQgYnkgYSBidWcgaW4gIiArICdSZWFjdC4gUGxlYXNlIGZpbGUgYW4gaXNzdWUuJyk7CiAgfQoKICBmdW5jdGlvbiBtYXJrVXBkYXRlKHdvcmtJblByb2dyZXNzKSB7CiAgICAvLyBUYWcgdGhlIGZpYmVyIHdpdGggYW4gdXBkYXRlIGVmZmVjdC4gVGhpcyB0dXJucyBhIFBsYWNlbWVudCBpbnRvCiAgICAvLyBhIFBsYWNlbWVudEFuZFVwZGF0ZS4KICAgIHdvcmtJblByb2dyZXNzLmZsYWdzIHw9IFVwZGF0ZTsKICB9CgogIGZ1bmN0aW9uIG1hcmtSZWYkMSh3b3JrSW5Qcm9ncmVzcykgewogICAgd29ya0luUHJvZ3Jlc3MuZmxhZ3MgfD0gUmVmOwoKICAgIHsKICAgICAgd29ya0luUHJvZ3Jlc3MuZmxhZ3MgfD0gUmVmU3RhdGljOwogICAgfQogIH0KCiAgdmFyIGFwcGVuZEFsbENoaWxkcmVuOwogIHZhciB1cGRhdGVIb3N0Q29udGFpbmVyOwogIHZhciB1cGRhdGVIb3N0Q29tcG9uZW50JDE7CiAgdmFyIHVwZGF0ZUhvc3RUZXh0JDE7CgogIHsKICAgIC8vIE11dGF0aW9uIG1vZGUKICAgIGFwcGVuZEFsbENoaWxkcmVuID0gZnVuY3Rpb24gKHBhcmVudCwgd29ya0luUHJvZ3Jlc3MsIG5lZWRzVmlzaWJpbGl0eVRvZ2dsZSwgaXNIaWRkZW4pIHsKICAgICAgLy8gV2Ugb25seSBoYXZlIHRoZSB0b3AgRmliZXIgdGhhdCB3YXMgY3JlYXRlZCBidXQgd2UgbmVlZCByZWN1cnNlIGRvd24gaXRzCiAgICAgIC8vIGNoaWxkcmVuIHRvIGZpbmQgYWxsIHRoZSB0ZXJtaW5hbCBub2Rlcy4KICAgICAgdmFyIG5vZGUgPSB3b3JrSW5Qcm9ncmVzcy5jaGlsZDsKCiAgICAgIHdoaWxlIChub2RlICE9PSBudWxsKSB7CiAgICAgICAgaWYgKG5vZGUudGFnID09PSBIb3N0Q29tcG9uZW50IHx8IG5vZGUudGFnID09PSBIb3N0VGV4dCkgewogICAgICAgICAgYXBwZW5kSW5pdGlhbENoaWxkKHBhcmVudCwgbm9kZS5zdGF0ZU5vZGUpOwogICAgICAgIH0gZWxzZSBpZiAobm9kZS50YWcgPT09IEhvc3RQb3J0YWwpIDsgZWxzZSBpZiAobm9kZS5jaGlsZCAhPT0gbnVsbCkgewogICAgICAgICAgbm9kZS5jaGlsZC5yZXR1cm4gPSBub2RlOwogICAgICAgICAgbm9kZSA9IG5vZGUuY2hpbGQ7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGlmIChub2RlID09PSB3b3JrSW5Qcm9ncmVzcykgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgd2hpbGUgKG5vZGUuc2libGluZyA9PT0gbnVsbCkgewogICAgICAgICAgaWYgKG5vZGUucmV0dXJuID09PSBudWxsIHx8IG5vZGUucmV0dXJuID09PSB3b3JrSW5Qcm9ncmVzcykgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CgogICAgICAgICAgbm9kZSA9IG5vZGUucmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgbm9kZS5zaWJsaW5nLnJldHVybiA9IG5vZGUucmV0dXJuOwogICAgICAgIG5vZGUgPSBub2RlLnNpYmxpbmc7CiAgICAgIH0KICAgIH07CgogICAgdXBkYXRlSG9zdENvbnRhaW5lciA9IGZ1bmN0aW9uIChjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcykgey8vIE5vb3AKICAgIH07CgogICAgdXBkYXRlSG9zdENvbXBvbmVudCQxID0gZnVuY3Rpb24gKGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCB0eXBlLCBuZXdQcm9wcywgcm9vdENvbnRhaW5lckluc3RhbmNlKSB7CiAgICAgIC8vIElmIHdlIGhhdmUgYW4gYWx0ZXJuYXRlLCB0aGF0IG1lYW5zIHRoaXMgaXMgYW4gdXBkYXRlIGFuZCB3ZSBuZWVkIHRvCiAgICAgIC8vIHNjaGVkdWxlIGEgc2lkZS1lZmZlY3QgdG8gZG8gdGhlIHVwZGF0ZXMuCiAgICAgIHZhciBvbGRQcm9wcyA9IGN1cnJlbnQubWVtb2l6ZWRQcm9wczsKCiAgICAgIGlmIChvbGRQcm9wcyA9PT0gbmV3UHJvcHMpIHsKICAgICAgICAvLyBJbiBtdXRhdGlvbiBtb2RlLCB0aGlzIGlzIHN1ZmZpY2llbnQgZm9yIGEgYmFpbG91dCBiZWNhdXNlCiAgICAgICAgLy8gd2Ugd29uJ3QgdG91Y2ggdGhpcyBub2RlIGV2ZW4gaWYgY2hpbGRyZW4gY2hhbmdlZC4KICAgICAgICByZXR1cm47CiAgICAgIH0gLy8gSWYgd2UgZ2V0IHVwZGF0ZWQgYmVjYXVzZSBvbmUgb2Ygb3VyIGNoaWxkcmVuIHVwZGF0ZWQsIHdlIGRvbid0CiAgICAgIC8vIGhhdmUgbmV3UHJvcHMgc28gd2UnbGwgaGF2ZSB0byByZXVzZSB0aGVtLgogICAgICAvLyBUT0RPOiBTcGxpdCB0aGUgdXBkYXRlIEFQSSBhcyBzZXBhcmF0ZSBmb3IgdGhlIHByb3BzIHZzLiBjaGlsZHJlbi4KICAgICAgLy8gRXZlbiBiZXR0ZXIgd291bGQgYmUgaWYgY2hpbGRyZW4gd2VyZW4ndCBzcGVjaWFsIGNhc2VkIGF0IGFsbCB0aG8uCgoKICAgICAgdmFyIGluc3RhbmNlID0gd29ya0luUHJvZ3Jlc3Muc3RhdGVOb2RlOwogICAgICB2YXIgY3VycmVudEhvc3RDb250ZXh0ID0gZ2V0SG9zdENvbnRleHQoKTsgLy8gVE9ETzogRXhwZXJpZW5jaW5nIGFuIGVycm9yIHdoZXJlIG9sZFByb3BzIGlzIG51bGwuIFN1Z2dlc3RzIGEgaG9zdAogICAgICAvLyBjb21wb25lbnQgaXMgaGl0dGluZyB0aGUgcmVzdW1lIHBhdGguIEZpZ3VyZSBvdXQgd2h5LiBQb3NzaWJseQogICAgICAvLyByZWxhdGVkIHRvIGBoaWRkZW5gLgoKICAgICAgdmFyIHVwZGF0ZVBheWxvYWQgPSBwcmVwYXJlVXBkYXRlKGluc3RhbmNlLCB0eXBlLCBvbGRQcm9wcywgbmV3UHJvcHMsIHJvb3RDb250YWluZXJJbnN0YW5jZSwgY3VycmVudEhvc3RDb250ZXh0KTsgLy8gVE9ETzogVHlwZSB0aGlzIHNwZWNpZmljIHRvIHRoaXMgdHlwZSBvZiBjb21wb25lbnQuCgogICAgICB3b3JrSW5Qcm9ncmVzcy51cGRhdGVRdWV1ZSA9IHVwZGF0ZVBheWxvYWQ7IC8vIElmIHRoZSB1cGRhdGUgcGF5bG9hZCBpbmRpY2F0ZXMgdGhhdCB0aGVyZSBpcyBhIGNoYW5nZSBvciBpZiB0aGVyZQogICAgICAvLyBpcyBhIG5ldyByZWYgd2UgbWFyayB0aGlzIGFzIGFuIHVwZGF0ZS4gQWxsIHRoZSB3b3JrIGlzIGRvbmUgaW4gY29tbWl0V29yay4KCiAgICAgIGlmICh1cGRhdGVQYXlsb2FkKSB7CiAgICAgICAgbWFya1VwZGF0ZSh3b3JrSW5Qcm9ncmVzcyk7CiAgICAgIH0KICAgIH07CgogICAgdXBkYXRlSG9zdFRleHQkMSA9IGZ1bmN0aW9uIChjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcywgb2xkVGV4dCwgbmV3VGV4dCkgewogICAgICAvLyBJZiB0aGUgdGV4dCBkaWZmZXJzLCBtYXJrIGl0IGFzIGFuIHVwZGF0ZS4gQWxsIHRoZSB3b3JrIGluIGRvbmUgaW4gY29tbWl0V29yay4KICAgICAgaWYgKG9sZFRleHQgIT09IG5ld1RleHQpIHsKICAgICAgICBtYXJrVXBkYXRlKHdvcmtJblByb2dyZXNzKTsKICAgICAgfQogICAgfTsKICB9CgogIGZ1bmN0aW9uIGN1dE9mZlRhaWxJZk5lZWRlZChyZW5kZXJTdGF0ZSwgaGFzUmVuZGVyZWRBVGFpbEZhbGxiYWNrKSB7CiAgICBpZiAoZ2V0SXNIeWRyYXRpbmcoKSkgewogICAgICAvLyBJZiB3ZSdyZSBoeWRyYXRpbmcsIHdlIHNob3VsZCBjb25zdW1lIGFzIG1hbnkgaXRlbXMgYXMgd2UgY2FuCiAgICAgIC8vIHNvIHdlIGRvbid0IGxlYXZlIGFueSBiZWhpbmQuCiAgICAgIHJldHVybjsKICAgIH0KCiAgICBzd2l0Y2ggKHJlbmRlclN0YXRlLnRhaWxNb2RlKSB7CiAgICAgIGNhc2UgJ2hpZGRlbic6CiAgICAgICAgewogICAgICAgICAgLy8gQW55IGluc2VydGlvbnMgYXQgdGhlIGVuZCBvZiB0aGUgdGFpbCBsaXN0IGFmdGVyIHRoaXMgcG9pbnQKICAgICAgICAgIC8vIHNob3VsZCBiZSBpbnZpc2libGUuIElmIHRoZXJlIGFyZSBhbHJlYWR5IG1vdW50ZWQgYm91bmRhcmllcwogICAgICAgICAgLy8gYW55dGhpbmcgYmVmb3JlIHRoZW0gYXJlIG5vdCBjb25zaWRlcmVkIGZvciBjb2xsYXBzaW5nLgogICAgICAgICAgLy8gVGhlcmVmb3JlIHdlIG5lZWQgdG8gZ28gdGhyb3VnaCB0aGUgd2hvbGUgdGFpbCB0byBmaW5kIGlmCiAgICAgICAgICAvLyB0aGVyZSBhcmUgYW55LgogICAgICAgICAgdmFyIHRhaWxOb2RlID0gcmVuZGVyU3RhdGUudGFpbDsKICAgICAgICAgIHZhciBsYXN0VGFpbE5vZGUgPSBudWxsOwoKICAgICAgICAgIHdoaWxlICh0YWlsTm9kZSAhPT0gbnVsbCkgewogICAgICAgICAgICBpZiAodGFpbE5vZGUuYWx0ZXJuYXRlICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgbGFzdFRhaWxOb2RlID0gdGFpbE5vZGU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRhaWxOb2RlID0gdGFpbE5vZGUuc2libGluZzsKICAgICAgICAgIH0gLy8gTmV4dCB3ZSdyZSBzaW1wbHkgZ29pbmcgdG8gZGVsZXRlIGFsbCBpbnNlcnRpb25zIGFmdGVyIHRoZQogICAgICAgICAgLy8gbGFzdCByZW5kZXJlZCBpdGVtLgoKCiAgICAgICAgICBpZiAobGFzdFRhaWxOb2RlID09PSBudWxsKSB7CiAgICAgICAgICAgIC8vIEFsbCByZW1haW5pbmcgaXRlbXMgaW4gdGhlIHRhaWwgYXJlIGluc2VydGlvbnMuCiAgICAgICAgICAgIHJlbmRlclN0YXRlLnRhaWwgPSBudWxsOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gRGV0YWNoIHRoZSBpbnNlcnRpb24gYWZ0ZXIgdGhlIGxhc3Qgbm9kZSB0aGF0IHdhcyBhbHJlYWR5CiAgICAgICAgICAgIC8vIGluc2VydGVkLgogICAgICAgICAgICBsYXN0VGFpbE5vZGUuc2libGluZyA9IG51bGw7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgY2FzZSAnY29sbGFwc2VkJzoKICAgICAgICB7CiAgICAgICAgICAvLyBBbnkgaW5zZXJ0aW9ucyBhdCB0aGUgZW5kIG9mIHRoZSB0YWlsIGxpc3QgYWZ0ZXIgdGhpcyBwb2ludAogICAgICAgICAgLy8gc2hvdWxkIGJlIGludmlzaWJsZS4gSWYgdGhlcmUgYXJlIGFscmVhZHkgbW91bnRlZCBib3VuZGFyaWVzCiAgICAgICAgICAvLyBhbnl0aGluZyBiZWZvcmUgdGhlbSBhcmUgbm90IGNvbnNpZGVyZWQgZm9yIGNvbGxhcHNpbmcuCiAgICAgICAgICAvLyBUaGVyZWZvcmUgd2UgbmVlZCB0byBnbyB0aHJvdWdoIHRoZSB3aG9sZSB0YWlsIHRvIGZpbmQgaWYKICAgICAgICAgIC8vIHRoZXJlIGFyZSBhbnkuCiAgICAgICAgICB2YXIgX3RhaWxOb2RlID0gcmVuZGVyU3RhdGUudGFpbDsKICAgICAgICAgIHZhciBfbGFzdFRhaWxOb2RlID0gbnVsbDsKCiAgICAgICAgICB3aGlsZSAoX3RhaWxOb2RlICE9PSBudWxsKSB7CiAgICAgICAgICAgIGlmIChfdGFpbE5vZGUuYWx0ZXJuYXRlICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgX2xhc3RUYWlsTm9kZSA9IF90YWlsTm9kZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgX3RhaWxOb2RlID0gX3RhaWxOb2RlLnNpYmxpbmc7CiAgICAgICAgICB9IC8vIE5leHQgd2UncmUgc2ltcGx5IGdvaW5nIHRvIGRlbGV0ZSBhbGwgaW5zZXJ0aW9ucyBhZnRlciB0aGUKICAgICAgICAgIC8vIGxhc3QgcmVuZGVyZWQgaXRlbS4KCgogICAgICAgICAgaWYgKF9sYXN0VGFpbE5vZGUgPT09IG51bGwpIHsKICAgICAgICAgICAgLy8gQWxsIHJlbWFpbmluZyBpdGVtcyBpbiB0aGUgdGFpbCBhcmUgaW5zZXJ0aW9ucy4KICAgICAgICAgICAgaWYgKCFoYXNSZW5kZXJlZEFUYWlsRmFsbGJhY2sgJiYgcmVuZGVyU3RhdGUudGFpbCAhPT0gbnVsbCkgewogICAgICAgICAgICAgIC8vIFdlIHN1c3BlbmRlZCBkdXJpbmcgdGhlIGhlYWQuIFdlIHdhbnQgdG8gc2hvdyBhdCBsZWFzdCBvbmUKICAgICAgICAgICAgICAvLyByb3cgYXQgdGhlIHRhaWwuIFNvIHdlJ2xsIGtlZXAgb24gYW5kIGN1dCBvZmYgdGhlIHJlc3QuCiAgICAgICAgICAgICAgcmVuZGVyU3RhdGUudGFpbC5zaWJsaW5nID0gbnVsbDsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICByZW5kZXJTdGF0ZS50YWlsID0gbnVsbDsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gRGV0YWNoIHRoZSBpbnNlcnRpb24gYWZ0ZXIgdGhlIGxhc3Qgbm9kZSB0aGF0IHdhcyBhbHJlYWR5CiAgICAgICAgICAgIC8vIGluc2VydGVkLgogICAgICAgICAgICBfbGFzdFRhaWxOb2RlLnNpYmxpbmcgPSBudWxsOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIGJ1YmJsZVByb3BlcnRpZXMoY29tcGxldGVkV29yaykgewogICAgdmFyIGRpZEJhaWxvdXQgPSBjb21wbGV0ZWRXb3JrLmFsdGVybmF0ZSAhPT0gbnVsbCAmJiBjb21wbGV0ZWRXb3JrLmFsdGVybmF0ZS5jaGlsZCA9PT0gY29tcGxldGVkV29yay5jaGlsZDsKICAgIHZhciBuZXdDaGlsZExhbmVzID0gTm9MYW5lczsKICAgIHZhciBzdWJ0cmVlRmxhZ3MgPSBOb0ZsYWdzOwoKICAgIGlmICghZGlkQmFpbG91dCkgewogICAgICAvLyBCdWJibGUgdXAgdGhlIGVhcmxpZXN0IGV4cGlyYXRpb24gdGltZS4KICAgICAgaWYgKCAoY29tcGxldGVkV29yay5tb2RlICYgUHJvZmlsZU1vZGUpICE9PSBOb01vZGUpIHsKICAgICAgICAvLyBJbiBwcm9maWxpbmcgbW9kZSwgcmVzZXRDaGlsZEV4cGlyYXRpb25UaW1lIGlzIGFsc28gdXNlZCB0byByZXNldAogICAgICAgIC8vIHByb2ZpbGVyIGR1cmF0aW9ucy4KICAgICAgICB2YXIgYWN0dWFsRHVyYXRpb24gPSBjb21wbGV0ZWRXb3JrLmFjdHVhbER1cmF0aW9uOwogICAgICAgIHZhciB0cmVlQmFzZUR1cmF0aW9uID0gY29tcGxldGVkV29yay5zZWxmQmFzZUR1cmF0aW9uOwogICAgICAgIHZhciBjaGlsZCA9IGNvbXBsZXRlZFdvcmsuY2hpbGQ7CgogICAgICAgIHdoaWxlIChjaGlsZCAhPT0gbnVsbCkgewogICAgICAgICAgbmV3Q2hpbGRMYW5lcyA9IG1lcmdlTGFuZXMobmV3Q2hpbGRMYW5lcywgbWVyZ2VMYW5lcyhjaGlsZC5sYW5lcywgY2hpbGQuY2hpbGRMYW5lcykpOwogICAgICAgICAgc3VidHJlZUZsYWdzIHw9IGNoaWxkLnN1YnRyZWVGbGFnczsKICAgICAgICAgIHN1YnRyZWVGbGFncyB8PSBjaGlsZC5mbGFnczsgLy8gV2hlbiBhIGZpYmVyIGlzIGNsb25lZCwgaXRzIGFjdHVhbER1cmF0aW9uIGlzIHJlc2V0IHRvIDAuIFRoaXMgdmFsdWUgd2lsbAogICAgICAgICAgLy8gb25seSBiZSB1cGRhdGVkIGlmIHdvcmsgaXMgZG9uZSBvbiB0aGUgZmliZXIgKGkuZS4gaXQgZG9lc24ndCBiYWlsb3V0KS4KICAgICAgICAgIC8vIFdoZW4gd29yayBpcyBkb25lLCBpdCBzaG91bGQgYnViYmxlIHRvIHRoZSBwYXJlbnQncyBhY3R1YWxEdXJhdGlvbi4gSWYKICAgICAgICAgIC8vIHRoZSBmaWJlciBoYXMgbm90IGJlZW4gY2xvbmVkIHRob3VnaCwgKG1lYW5pbmcgbm8gd29yayB3YXMgZG9uZSksIHRoZW4KICAgICAgICAgIC8vIHRoaXMgdmFsdWUgd2lsbCByZWZsZWN0IHRoZSBhbW91bnQgb2YgdGltZSBzcGVudCB3b3JraW5nIG9uIGEgcHJldmlvdXMKICAgICAgICAgIC8vIHJlbmRlci4gSW4gdGhhdCBjYXNlIGl0IHNob3VsZCBub3QgYnViYmxlLiBXZSBkZXRlcm1pbmUgd2hldGhlciBpdCB3YXMKICAgICAgICAgIC8vIGNsb25lZCBieSBjb21wYXJpbmcgdGhlIGNoaWxkIHBvaW50ZXIuCgogICAgICAgICAgYWN0dWFsRHVyYXRpb24gKz0gY2hpbGQuYWN0dWFsRHVyYXRpb247CiAgICAgICAgICB0cmVlQmFzZUR1cmF0aW9uICs9IGNoaWxkLnRyZWVCYXNlRHVyYXRpb247CiAgICAgICAgICBjaGlsZCA9IGNoaWxkLnNpYmxpbmc7CiAgICAgICAgfQoKICAgICAgICBjb21wbGV0ZWRXb3JrLmFjdHVhbER1cmF0aW9uID0gYWN0dWFsRHVyYXRpb247CiAgICAgICAgY29tcGxldGVkV29yay50cmVlQmFzZUR1cmF0aW9uID0gdHJlZUJhc2VEdXJhdGlvbjsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgX2NoaWxkID0gY29tcGxldGVkV29yay5jaGlsZDsKCiAgICAgICAgd2hpbGUgKF9jaGlsZCAhPT0gbnVsbCkgewogICAgICAgICAgbmV3Q2hpbGRMYW5lcyA9IG1lcmdlTGFuZXMobmV3Q2hpbGRMYW5lcywgbWVyZ2VMYW5lcyhfY2hpbGQubGFuZXMsIF9jaGlsZC5jaGlsZExhbmVzKSk7CiAgICAgICAgICBzdWJ0cmVlRmxhZ3MgfD0gX2NoaWxkLnN1YnRyZWVGbGFnczsKICAgICAgICAgIHN1YnRyZWVGbGFncyB8PSBfY2hpbGQuZmxhZ3M7IC8vIFVwZGF0ZSB0aGUgcmV0dXJuIHBvaW50ZXIgc28gdGhlIHRyZWUgaXMgY29uc2lzdGVudC4gVGhpcyBpcyBhIGNvZGUKICAgICAgICAgIC8vIHNtZWxsIGJlY2F1c2UgaXQgYXNzdW1lcyB0aGUgY29tbWl0IHBoYXNlIGlzIG5ldmVyIGNvbmN1cnJlbnQgd2l0aAogICAgICAgICAgLy8gdGhlIHJlbmRlciBwaGFzZS4gV2lsbCBhZGRyZXNzIGR1cmluZyByZWZhY3RvciB0byBhbHRlcm5hdGUgbW9kZWwuCgogICAgICAgICAgX2NoaWxkLnJldHVybiA9IGNvbXBsZXRlZFdvcms7CiAgICAgICAgICBfY2hpbGQgPSBfY2hpbGQuc2libGluZzsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGNvbXBsZXRlZFdvcmsuc3VidHJlZUZsYWdzIHw9IHN1YnRyZWVGbGFnczsKICAgIH0gZWxzZSB7CiAgICAgIC8vIEJ1YmJsZSB1cCB0aGUgZWFybGllc3QgZXhwaXJhdGlvbiB0aW1lLgogICAgICBpZiAoIChjb21wbGV0ZWRXb3JrLm1vZGUgJiBQcm9maWxlTW9kZSkgIT09IE5vTW9kZSkgewogICAgICAgIC8vIEluIHByb2ZpbGluZyBtb2RlLCByZXNldENoaWxkRXhwaXJhdGlvblRpbWUgaXMgYWxzbyB1c2VkIHRvIHJlc2V0CiAgICAgICAgLy8gcHJvZmlsZXIgZHVyYXRpb25zLgogICAgICAgIHZhciBfdHJlZUJhc2VEdXJhdGlvbiA9IGNvbXBsZXRlZFdvcmsuc2VsZkJhc2VEdXJhdGlvbjsKICAgICAgICB2YXIgX2NoaWxkMiA9IGNvbXBsZXRlZFdvcmsuY2hpbGQ7CgogICAgICAgIHdoaWxlIChfY2hpbGQyICE9PSBudWxsKSB7CiAgICAgICAgICBuZXdDaGlsZExhbmVzID0gbWVyZ2VMYW5lcyhuZXdDaGlsZExhbmVzLCBtZXJnZUxhbmVzKF9jaGlsZDIubGFuZXMsIF9jaGlsZDIuY2hpbGRMYW5lcykpOyAvLyAiU3RhdGljIiBmbGFncyBzaGFyZSB0aGUgbGlmZXRpbWUgb2YgdGhlIGZpYmVyL2hvb2sgdGhleSBiZWxvbmcgdG8sCiAgICAgICAgICAvLyBzbyB3ZSBzaG91bGQgYnViYmxlIHRob3NlIHVwIGV2ZW4gZHVyaW5nIGEgYmFpbG91dC4gQWxsIHRoZSBvdGhlcgogICAgICAgICAgLy8gZmxhZ3MgaGF2ZSBhIGxpZmV0aW1lIG9ubHkgb2YgYSBzaW5nbGUgcmVuZGVyICsgY29tbWl0LCBzbyB3ZSBzaG91bGQKICAgICAgICAgIC8vIGlnbm9yZSB0aGVtLgoKICAgICAgICAgIHN1YnRyZWVGbGFncyB8PSBfY2hpbGQyLnN1YnRyZWVGbGFncyAmIFN0YXRpY01hc2s7CiAgICAgICAgICBzdWJ0cmVlRmxhZ3MgfD0gX2NoaWxkMi5mbGFncyAmIFN0YXRpY01hc2s7CiAgICAgICAgICBfdHJlZUJhc2VEdXJhdGlvbiArPSBfY2hpbGQyLnRyZWVCYXNlRHVyYXRpb247CiAgICAgICAgICBfY2hpbGQyID0gX2NoaWxkMi5zaWJsaW5nOwogICAgICAgIH0KCiAgICAgICAgY29tcGxldGVkV29yay50cmVlQmFzZUR1cmF0aW9uID0gX3RyZWVCYXNlRHVyYXRpb247CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFyIF9jaGlsZDMgPSBjb21wbGV0ZWRXb3JrLmNoaWxkOwoKICAgICAgICB3aGlsZSAoX2NoaWxkMyAhPT0gbnVsbCkgewogICAgICAgICAgbmV3Q2hpbGRMYW5lcyA9IG1lcmdlTGFuZXMobmV3Q2hpbGRMYW5lcywgbWVyZ2VMYW5lcyhfY2hpbGQzLmxhbmVzLCBfY2hpbGQzLmNoaWxkTGFuZXMpKTsgLy8gIlN0YXRpYyIgZmxhZ3Mgc2hhcmUgdGhlIGxpZmV0aW1lIG9mIHRoZSBmaWJlci9ob29rIHRoZXkgYmVsb25nIHRvLAogICAgICAgICAgLy8gc28gd2Ugc2hvdWxkIGJ1YmJsZSB0aG9zZSB1cCBldmVuIGR1cmluZyBhIGJhaWxvdXQuIEFsbCB0aGUgb3RoZXIKICAgICAgICAgIC8vIGZsYWdzIGhhdmUgYSBsaWZldGltZSBvbmx5IG9mIGEgc2luZ2xlIHJlbmRlciArIGNvbW1pdCwgc28gd2Ugc2hvdWxkCiAgICAgICAgICAvLyBpZ25vcmUgdGhlbS4KCiAgICAgICAgICBzdWJ0cmVlRmxhZ3MgfD0gX2NoaWxkMy5zdWJ0cmVlRmxhZ3MgJiBTdGF0aWNNYXNrOwogICAgICAgICAgc3VidHJlZUZsYWdzIHw9IF9jaGlsZDMuZmxhZ3MgJiBTdGF0aWNNYXNrOyAvLyBVcGRhdGUgdGhlIHJldHVybiBwb2ludGVyIHNvIHRoZSB0cmVlIGlzIGNvbnNpc3RlbnQuIFRoaXMgaXMgYSBjb2RlCiAgICAgICAgICAvLyBzbWVsbCBiZWNhdXNlIGl0IGFzc3VtZXMgdGhlIGNvbW1pdCBwaGFzZSBpcyBuZXZlciBjb25jdXJyZW50IHdpdGgKICAgICAgICAgIC8vIHRoZSByZW5kZXIgcGhhc2UuIFdpbGwgYWRkcmVzcyBkdXJpbmcgcmVmYWN0b3IgdG8gYWx0ZXJuYXRlIG1vZGVsLgoKICAgICAgICAgIF9jaGlsZDMucmV0dXJuID0gY29tcGxldGVkV29yazsKICAgICAgICAgIF9jaGlsZDMgPSBfY2hpbGQzLnNpYmxpbmc7CiAgICAgICAgfQogICAgICB9CgogICAgICBjb21wbGV0ZWRXb3JrLnN1YnRyZWVGbGFncyB8PSBzdWJ0cmVlRmxhZ3M7CiAgICB9CgogICAgY29tcGxldGVkV29yay5jaGlsZExhbmVzID0gbmV3Q2hpbGRMYW5lczsKICAgIHJldHVybiBkaWRCYWlsb3V0OwogIH0KCiAgZnVuY3Rpb24gY29tcGxldGVEZWh5ZHJhdGVkU3VzcGVuc2VCb3VuZGFyeShjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcywgbmV4dFN0YXRlKSB7CiAgICBpZiAoaGFzVW5oeWRyYXRlZFRhaWxOb2RlcygpICYmICh3b3JrSW5Qcm9ncmVzcy5tb2RlICYgQ29uY3VycmVudE1vZGUpICE9PSBOb01vZGUgJiYgKHdvcmtJblByb2dyZXNzLmZsYWdzICYgRGlkQ2FwdHVyZSkgPT09IE5vRmxhZ3MpIHsKICAgICAgd2FybklmVW5oeWRyYXRlZFRhaWxOb2Rlcyh3b3JrSW5Qcm9ncmVzcyk7CiAgICAgIHJlc2V0SHlkcmF0aW9uU3RhdGUoKTsKICAgICAgd29ya0luUHJvZ3Jlc3MuZmxhZ3MgfD0gRm9yY2VDbGllbnRSZW5kZXIgfCBJbmNvbXBsZXRlIHwgU2hvdWxkQ2FwdHVyZTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIHZhciB3YXNIeWRyYXRlZCA9IHBvcEh5ZHJhdGlvblN0YXRlKHdvcmtJblByb2dyZXNzKTsKCiAgICBpZiAobmV4dFN0YXRlICE9PSBudWxsICYmIG5leHRTdGF0ZS5kZWh5ZHJhdGVkICE9PSBudWxsKSB7CiAgICAgIC8vIFdlIG1pZ2h0IGJlIGluc2lkZSBhIGh5ZHJhdGlvbiBzdGF0ZSB0aGUgZmlyc3QgdGltZSB3ZSdyZSBwaWNraW5nIHVwIHRoaXMKICAgICAgLy8gU3VzcGVuc2UgYm91bmRhcnksIGFuZCBhbHNvIGFmdGVyIHdlJ3ZlIHJlZW50ZXJlZCBpdCBmb3IgZnVydGhlciBoeWRyYXRpb24uCiAgICAgIGlmIChjdXJyZW50ID09PSBudWxsKSB7CiAgICAgICAgaWYgKCF3YXNIeWRyYXRlZCkgewogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBIGRlaHlkcmF0ZWQgc3VzcGVuc2UgY29tcG9uZW50IHdhcyBjb21wbGV0ZWQgd2l0aG91dCBhIGh5ZHJhdGVkIG5vZGUuICcgKyAnVGhpcyBpcyBwcm9iYWJseSBhIGJ1ZyBpbiBSZWFjdC4nKTsKICAgICAgICB9CgogICAgICAgIHByZXBhcmVUb0h5ZHJhdGVIb3N0U3VzcGVuc2VJbnN0YW5jZSh3b3JrSW5Qcm9ncmVzcyk7CiAgICAgICAgYnViYmxlUHJvcGVydGllcyh3b3JrSW5Qcm9ncmVzcyk7CgogICAgICAgIHsKICAgICAgICAgIGlmICgod29ya0luUHJvZ3Jlc3MubW9kZSAmIFByb2ZpbGVNb2RlKSAhPT0gTm9Nb2RlKSB7CiAgICAgICAgICAgIHZhciBpc1RpbWVkT3V0U3VzcGVuc2UgPSBuZXh0U3RhdGUgIT09IG51bGw7CgogICAgICAgICAgICBpZiAoaXNUaW1lZE91dFN1c3BlbnNlKSB7CiAgICAgICAgICAgICAgLy8gRG9uJ3QgY291bnQgdGltZSBzcGVudCBpbiBhIHRpbWVkIG91dCBTdXNwZW5zZSBzdWJ0cmVlIGFzIHBhcnQgb2YgdGhlIGJhc2UgZHVyYXRpb24uCiAgICAgICAgICAgICAgdmFyIHByaW1hcnlDaGlsZEZyYWdtZW50ID0gd29ya0luUHJvZ3Jlc3MuY2hpbGQ7CgogICAgICAgICAgICAgIGlmIChwcmltYXJ5Q2hpbGRGcmFnbWVudCAhPT0gbnVsbCkgewogICAgICAgICAgICAgICAgLy8gJEZsb3dGaXhNZSBGbG93IGRvZXNuJ3Qgc3VwcG9ydCB0eXBlIGNhc3RpbmcgaW4gY29tYmluYXRpb24gd2l0aCB0aGUgLT0gb3BlcmF0b3IKICAgICAgICAgICAgICAgIHdvcmtJblByb2dyZXNzLnRyZWVCYXNlRHVyYXRpb24gLT0gcHJpbWFyeUNoaWxkRnJhZ21lbnQudHJlZUJhc2VEdXJhdGlvbjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBXZSBtaWdodCBoYXZlIHJlZW50ZXJlZCB0aGlzIGJvdW5kYXJ5IHRvIGh5ZHJhdGUgaXQuIElmIHNvLCB3ZSBuZWVkIHRvIHJlc2V0IHRoZSBoeWRyYXRpb24KICAgICAgICAvLyBzdGF0ZSBzaW5jZSB3ZSdyZSBub3cgZXhpdGluZyBvdXQgb2YgaXQuIHBvcEh5ZHJhdGlvblN0YXRlIGRvZXNuJ3QgZG8gdGhhdCBmb3IgdXMuCiAgICAgICAgcmVzZXRIeWRyYXRpb25TdGF0ZSgpOwoKICAgICAgICBpZiAoKHdvcmtJblByb2dyZXNzLmZsYWdzICYgRGlkQ2FwdHVyZSkgPT09IE5vRmxhZ3MpIHsKICAgICAgICAgIC8vIFRoaXMgYm91bmRhcnkgZGlkIG5vdCBzdXNwZW5kIHNvIGl0J3Mgbm93IGh5ZHJhdGVkIGFuZCB1bnN1c3BlbmRlZC4KICAgICAgICAgIHdvcmtJblByb2dyZXNzLm1lbW9pemVkU3RhdGUgPSBudWxsOwogICAgICAgIH0gLy8gSWYgbm90aGluZyBzdXNwZW5kZWQsIHdlIG5lZWQgdG8gc2NoZWR1bGUgYW4gZWZmZWN0IHRvIG1hcmsgdGhpcyBib3VuZGFyeQogICAgICAgIC8vIGFzIGhhdmluZyBoeWRyYXRlZCBzbyBldmVudHMga25vdyB0aGF0IHRoZXkncmUgZnJlZSB0byBiZSBpbnZva2VkLgogICAgICAgIC8vIEl0J3MgYWxzbyBhIHNpZ25hbCB0byByZXBsYXkgZXZlbnRzIGFuZCB0aGUgc3VzcGVuc2UgY2FsbGJhY2suCiAgICAgICAgLy8gSWYgc29tZXRoaW5nIHN1c3BlbmRlZCwgc2NoZWR1bGUgYW4gZWZmZWN0IHRvIGF0dGFjaCByZXRyeSBsaXN0ZW5lcnMuCiAgICAgICAgLy8gU28gd2UgbWlnaHQgYXMgd2VsbCBhbHdheXMgbWFyayB0aGlzLgoKCiAgICAgICAgd29ya0luUHJvZ3Jlc3MuZmxhZ3MgfD0gVXBkYXRlOwogICAgICAgIGJ1YmJsZVByb3BlcnRpZXMod29ya0luUHJvZ3Jlc3MpOwoKICAgICAgICB7CiAgICAgICAgICBpZiAoKHdvcmtJblByb2dyZXNzLm1vZGUgJiBQcm9maWxlTW9kZSkgIT09IE5vTW9kZSkgewogICAgICAgICAgICB2YXIgX2lzVGltZWRPdXRTdXNwZW5zZSA9IG5leHRTdGF0ZSAhPT0gbnVsbDsKCiAgICAgICAgICAgIGlmIChfaXNUaW1lZE91dFN1c3BlbnNlKSB7CiAgICAgICAgICAgICAgLy8gRG9uJ3QgY291bnQgdGltZSBzcGVudCBpbiBhIHRpbWVkIG91dCBTdXNwZW5zZSBzdWJ0cmVlIGFzIHBhcnQgb2YgdGhlIGJhc2UgZHVyYXRpb24uCiAgICAgICAgICAgICAgdmFyIF9wcmltYXJ5Q2hpbGRGcmFnbWVudCA9IHdvcmtJblByb2dyZXNzLmNoaWxkOwoKICAgICAgICAgICAgICBpZiAoX3ByaW1hcnlDaGlsZEZyYWdtZW50ICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAvLyAkRmxvd0ZpeE1lIEZsb3cgZG9lc24ndCBzdXBwb3J0IHR5cGUgY2FzdGluZyBpbiBjb21iaW5hdGlvbiB3aXRoIHRoZSAtPSBvcGVyYXRvcgogICAgICAgICAgICAgICAgd29ya0luUHJvZ3Jlc3MudHJlZUJhc2VEdXJhdGlvbiAtPSBfcHJpbWFyeUNoaWxkRnJhZ21lbnQudHJlZUJhc2VEdXJhdGlvbjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgLy8gU3VjY2Vzc2Z1bGx5IGNvbXBsZXRlZCB0aGlzIHRyZWUuIElmIHRoaXMgd2FzIGEgZm9yY2VkIGNsaWVudCByZW5kZXIsCiAgICAgIC8vIHRoZXJlIG1heSBoYXZlIGJlZW4gcmVjb3ZlcmFibGUgZXJyb3JzIGR1cmluZyBmaXJzdCBoeWRyYXRpb24KICAgICAgLy8gYXR0ZW1wdC4gSWYgc28sIGFkZCB0aGVtIHRvIGEgcXVldWUgc28gd2UgY2FuIGxvZyB0aGVtIGluIHRoZQogICAgICAvLyBjb21taXQgcGhhc2UuCiAgICAgIHVwZ3JhZGVIeWRyYXRpb25FcnJvcnNUb1JlY292ZXJhYmxlKCk7IC8vIEZhbGwgdGhyb3VnaCB0byBub3JtYWwgU3VzcGVuc2UgcGF0aAoKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBjb21wbGV0ZVdvcmsoY3VycmVudCwgd29ya0luUHJvZ3Jlc3MsIHJlbmRlckxhbmVzKSB7CiAgICB2YXIgbmV3UHJvcHMgPSB3b3JrSW5Qcm9ncmVzcy5wZW5kaW5nUHJvcHM7IC8vIE5vdGU6IFRoaXMgaW50ZW50aW9uYWxseSBkb2Vzbid0IGNoZWNrIGlmIHdlJ3JlIGh5ZHJhdGluZyBiZWNhdXNlIGNvbXBhcmluZwogICAgLy8gdG8gdGhlIGN1cnJlbnQgdHJlZSBwcm92aWRlciBmaWJlciBpcyBqdXN0IGFzIGZhc3QgYW5kIGxlc3MgZXJyb3ItcHJvbmUuCiAgICAvLyBJZGVhbGx5IHdlIHdvdWxkIGhhdmUgYSBzcGVjaWFsIHZlcnNpb24gb2YgdGhlIHdvcmsgbG9vcCBvbmx5CiAgICAvLyBmb3IgaHlkcmF0aW9uLgoKICAgIHBvcFRyZWVDb250ZXh0KHdvcmtJblByb2dyZXNzKTsKCiAgICBzd2l0Y2ggKHdvcmtJblByb2dyZXNzLnRhZykgewogICAgICBjYXNlIEluZGV0ZXJtaW5hdGVDb21wb25lbnQ6CiAgICAgIGNhc2UgTGF6eUNvbXBvbmVudDoKICAgICAgY2FzZSBTaW1wbGVNZW1vQ29tcG9uZW50OgogICAgICBjYXNlIEZ1bmN0aW9uQ29tcG9uZW50OgogICAgICBjYXNlIEZvcndhcmRSZWY6CiAgICAgIGNhc2UgRnJhZ21lbnQ6CiAgICAgIGNhc2UgTW9kZToKICAgICAgY2FzZSBQcm9maWxlcjoKICAgICAgY2FzZSBDb250ZXh0Q29uc3VtZXI6CiAgICAgIGNhc2UgTWVtb0NvbXBvbmVudDoKICAgICAgICBidWJibGVQcm9wZXJ0aWVzKHdvcmtJblByb2dyZXNzKTsKICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgIGNhc2UgQ2xhc3NDb21wb25lbnQ6CiAgICAgICAgewogICAgICAgICAgdmFyIENvbXBvbmVudCA9IHdvcmtJblByb2dyZXNzLnR5cGU7CgogICAgICAgICAgaWYgKGlzQ29udGV4dFByb3ZpZGVyKENvbXBvbmVudCkpIHsKICAgICAgICAgICAgcG9wQ29udGV4dCh3b3JrSW5Qcm9ncmVzcyk7CiAgICAgICAgICB9CgogICAgICAgICAgYnViYmxlUHJvcGVydGllcyh3b3JrSW5Qcm9ncmVzcyk7CiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CgogICAgICBjYXNlIEhvc3RSb290OgogICAgICAgIHsKICAgICAgICAgIHZhciBmaWJlclJvb3QgPSB3b3JrSW5Qcm9ncmVzcy5zdGF0ZU5vZGU7CiAgICAgICAgICBwb3BIb3N0Q29udGFpbmVyKHdvcmtJblByb2dyZXNzKTsKICAgICAgICAgIHBvcFRvcExldmVsQ29udGV4dE9iamVjdCh3b3JrSW5Qcm9ncmVzcyk7CiAgICAgICAgICByZXNldFdvcmtJblByb2dyZXNzVmVyc2lvbnMoKTsKCiAgICAgICAgICBpZiAoZmliZXJSb290LnBlbmRpbmdDb250ZXh0KSB7CiAgICAgICAgICAgIGZpYmVyUm9vdC5jb250ZXh0ID0gZmliZXJSb290LnBlbmRpbmdDb250ZXh0OwogICAgICAgICAgICBmaWJlclJvb3QucGVuZGluZ0NvbnRleHQgPSBudWxsOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChjdXJyZW50ID09PSBudWxsIHx8IGN1cnJlbnQuY2hpbGQgPT09IG51bGwpIHsKICAgICAgICAgICAgLy8gSWYgd2UgaHlkcmF0ZWQsIHBvcCBzbyB0aGF0IHdlIGNhbiBkZWxldGUgYW55IHJlbWFpbmluZyBjaGlsZHJlbgogICAgICAgICAgICAvLyB0aGF0IHdlcmVuJ3QgaHlkcmF0ZWQuCiAgICAgICAgICAgIHZhciB3YXNIeWRyYXRlZCA9IHBvcEh5ZHJhdGlvblN0YXRlKHdvcmtJblByb2dyZXNzKTsKCiAgICAgICAgICAgIGlmICh3YXNIeWRyYXRlZCkgewogICAgICAgICAgICAgIC8vIElmIHdlIGh5ZHJhdGVkLCB0aGVuIHdlJ2xsIG5lZWQgdG8gc2NoZWR1bGUgYW4gdXBkYXRlIGZvcgogICAgICAgICAgICAgIC8vIHRoZSBjb21taXQgc2lkZS1lZmZlY3RzIG9uIHRoZSByb290LgogICAgICAgICAgICAgIG1hcmtVcGRhdGUod29ya0luUHJvZ3Jlc3MpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGlmIChjdXJyZW50ICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICB2YXIgcHJldlN0YXRlID0gY3VycmVudC5tZW1vaXplZFN0YXRlOwoKICAgICAgICAgICAgICAgIGlmICggLy8gQ2hlY2sgaWYgdGhpcyBpcyBhIGNsaWVudCByb290CiAgICAgICAgICAgICAgICAhcHJldlN0YXRlLmlzRGVoeWRyYXRlZCB8fCAvLyBDaGVjayBpZiB3ZSByZXZlcnRlZCB0byBjbGllbnQgcmVuZGVyaW5nIChlLmcuIGR1ZSB0byBhbiBlcnJvcikKICAgICAgICAgICAgICAgICh3b3JrSW5Qcm9ncmVzcy5mbGFncyAmIEZvcmNlQ2xpZW50UmVuZGVyKSAhPT0gTm9GbGFncykgewogICAgICAgICAgICAgICAgICAvLyBTY2hlZHVsZSBhbiBlZmZlY3QgdG8gY2xlYXIgdGhpcyBjb250YWluZXIgYXQgdGhlIHN0YXJ0IG9mIHRoZQogICAgICAgICAgICAgICAgICAvLyBuZXh0IGNvbW1pdC4gVGhpcyBoYW5kbGVzIHRoZSBjYXNlIG9mIFJlYWN0IHJlbmRlcmluZyBpbnRvIGEKICAgICAgICAgICAgICAgICAgLy8gY29udGFpbmVyIHdpdGggcHJldmlvdXMgY2hpbGRyZW4uIEl0J3MgYWxzbyBzYWZlIHRvIGRvIGZvcgogICAgICAgICAgICAgICAgICAvLyB1cGRhdGVzIHRvbywgYmVjYXVzZSBjdXJyZW50LmNoaWxkIHdvdWxkIG9ubHkgYmUgbnVsbCBpZiB0aGUKICAgICAgICAgICAgICAgICAgLy8gcHJldmlvdXMgcmVuZGVyIHdhcyBudWxsIChzbyB0aGUgY29udGFpbmVyIHdvdWxkIGFscmVhZHkKICAgICAgICAgICAgICAgICAgLy8gYmUgZW1wdHkpLgogICAgICAgICAgICAgICAgICB3b3JrSW5Qcm9ncmVzcy5mbGFncyB8PSBTbmFwc2hvdDsgLy8gSWYgdGhpcyB3YXMgYSBmb3JjZWQgY2xpZW50IHJlbmRlciwgdGhlcmUgbWF5IGhhdmUgYmVlbgogICAgICAgICAgICAgICAgICAvLyByZWNvdmVyYWJsZSBlcnJvcnMgZHVyaW5nIGZpcnN0IGh5ZHJhdGlvbiBhdHRlbXB0LiBJZiBzbywgYWRkCiAgICAgICAgICAgICAgICAgIC8vIHRoZW0gdG8gYSBxdWV1ZSBzbyB3ZSBjYW4gbG9nIHRoZW0gaW4gdGhlIGNvbW1pdCBwaGFzZS4KCiAgICAgICAgICAgICAgICAgIHVwZ3JhZGVIeWRyYXRpb25FcnJvcnNUb1JlY292ZXJhYmxlKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgdXBkYXRlSG9zdENvbnRhaW5lcihjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcyk7CiAgICAgICAgICBidWJibGVQcm9wZXJ0aWVzKHdvcmtJblByb2dyZXNzKTsKCiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CgogICAgICBjYXNlIEhvc3RDb21wb25lbnQ6CiAgICAgICAgewogICAgICAgICAgcG9wSG9zdENvbnRleHQod29ya0luUHJvZ3Jlc3MpOwogICAgICAgICAgdmFyIHJvb3RDb250YWluZXJJbnN0YW5jZSA9IGdldFJvb3RIb3N0Q29udGFpbmVyKCk7CiAgICAgICAgICB2YXIgdHlwZSA9IHdvcmtJblByb2dyZXNzLnR5cGU7CgogICAgICAgICAgaWYgKGN1cnJlbnQgIT09IG51bGwgJiYgd29ya0luUHJvZ3Jlc3Muc3RhdGVOb2RlICE9IG51bGwpIHsKICAgICAgICAgICAgdXBkYXRlSG9zdENvbXBvbmVudCQxKGN1cnJlbnQsIHdvcmtJblByb2dyZXNzLCB0eXBlLCBuZXdQcm9wcywgcm9vdENvbnRhaW5lckluc3RhbmNlKTsKCiAgICAgICAgICAgIGlmIChjdXJyZW50LnJlZiAhPT0gd29ya0luUHJvZ3Jlc3MucmVmKSB7CiAgICAgICAgICAgICAgbWFya1JlZiQxKHdvcmtJblByb2dyZXNzKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaWYgKCFuZXdQcm9wcykgewogICAgICAgICAgICAgIGlmICh3b3JrSW5Qcm9ncmVzcy5zdGF0ZU5vZGUgPT09IG51bGwpIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignV2UgbXVzdCBoYXZlIG5ldyBwcm9wcyBmb3IgbmV3IG1vdW50cy4gVGhpcyBlcnJvciBpcyBsaWtlbHkgJyArICdjYXVzZWQgYnkgYSBidWcgaW4gUmVhY3QuIFBsZWFzZSBmaWxlIGFuIGlzc3VlLicpOwogICAgICAgICAgICAgIH0gLy8gVGhpcyBjYW4gaGFwcGVuIHdoZW4gd2UgYWJvcnQgd29yay4KCgogICAgICAgICAgICAgIGJ1YmJsZVByb3BlcnRpZXMod29ya0luUHJvZ3Jlc3MpOwogICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgY3VycmVudEhvc3RDb250ZXh0ID0gZ2V0SG9zdENvbnRleHQoKTsgLy8gVE9ETzogTW92ZSBjcmVhdGVJbnN0YW5jZSB0byBiZWdpbldvcmsgYW5kIGtlZXAgaXQgb24gYSBjb250ZXh0CiAgICAgICAgICAgIC8vICJzdGFjayIgYXMgdGhlIHBhcmVudC4gVGhlbiBhcHBlbmQgY2hpbGRyZW4gYXMgd2UgZ28gaW4gYmVnaW5Xb3JrCiAgICAgICAgICAgIC8vIG9yIGNvbXBsZXRlV29yayBkZXBlbmRpbmcgb24gd2hldGhlciB3ZSB3YW50IHRvIGFkZCB0aGVtIHRvcC0+ZG93biBvcgogICAgICAgICAgICAvLyBib3R0b20tPnVwLiBUb3AtPmRvd24gaXMgZmFzdGVyIGluIElFMTEuCgogICAgICAgICAgICB2YXIgX3dhc0h5ZHJhdGVkID0gcG9wSHlkcmF0aW9uU3RhdGUod29ya0luUHJvZ3Jlc3MpOwoKICAgICAgICAgICAgaWYgKF93YXNIeWRyYXRlZCkgewogICAgICAgICAgICAgIC8vIFRPRE86IE1vdmUgdGhpcyBhbmQgY3JlYXRlSW5zdGFuY2Ugc3RlcCBpbnRvIHRoZSBiZWdpblBoYXNlCiAgICAgICAgICAgICAgLy8gdG8gY29uc29saWRhdGUuCiAgICAgICAgICAgICAgaWYgKHByZXBhcmVUb0h5ZHJhdGVIb3N0SW5zdGFuY2Uod29ya0luUHJvZ3Jlc3MsIHJvb3RDb250YWluZXJJbnN0YW5jZSwgY3VycmVudEhvc3RDb250ZXh0KSkgewogICAgICAgICAgICAgICAgLy8gSWYgY2hhbmdlcyB0byB0aGUgaHlkcmF0ZWQgbm9kZSBuZWVkIHRvIGJlIGFwcGxpZWQgYXQgdGhlCiAgICAgICAgICAgICAgICAvLyBjb21taXQtcGhhc2Ugd2UgbWFyayB0aGlzIGFzIHN1Y2guCiAgICAgICAgICAgICAgICBtYXJrVXBkYXRlKHdvcmtJblByb2dyZXNzKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgdmFyIGluc3RhbmNlID0gY3JlYXRlSW5zdGFuY2UodHlwZSwgbmV3UHJvcHMsIHJvb3RDb250YWluZXJJbnN0YW5jZSwgY3VycmVudEhvc3RDb250ZXh0LCB3b3JrSW5Qcm9ncmVzcyk7CiAgICAgICAgICAgICAgYXBwZW5kQWxsQ2hpbGRyZW4oaW5zdGFuY2UsIHdvcmtJblByb2dyZXNzLCBmYWxzZSwgZmFsc2UpOwogICAgICAgICAgICAgIHdvcmtJblByb2dyZXNzLnN0YXRlTm9kZSA9IGluc3RhbmNlOyAvLyBDZXJ0YWluIHJlbmRlcmVycyByZXF1aXJlIGNvbW1pdC10aW1lIGVmZmVjdHMgZm9yIGluaXRpYWwgbW91bnQuCiAgICAgICAgICAgICAgLy8gKGVnIERPTSByZW5kZXJlciBzdXBwb3J0cyBhdXRvLWZvY3VzIGZvciBjZXJ0YWluIGVsZW1lbnRzKS4KICAgICAgICAgICAgICAvLyBNYWtlIHN1cmUgc3VjaCByZW5kZXJlcnMgZ2V0IHNjaGVkdWxlZCBmb3IgbGF0ZXIgd29yay4KCiAgICAgICAgICAgICAgaWYgKGZpbmFsaXplSW5pdGlhbENoaWxkcmVuKGluc3RhbmNlLCB0eXBlLCBuZXdQcm9wcywgcm9vdENvbnRhaW5lckluc3RhbmNlKSkgewogICAgICAgICAgICAgICAgbWFya1VwZGF0ZSh3b3JrSW5Qcm9ncmVzcyk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAod29ya0luUHJvZ3Jlc3MucmVmICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgLy8gSWYgdGhlcmUgaXMgYSByZWYgb24gYSBob3N0IG5vZGUgd2UgbmVlZCB0byBzY2hlZHVsZSBhIGNhbGxiYWNrCiAgICAgICAgICAgICAgbWFya1JlZiQxKHdvcmtJblByb2dyZXNzKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGJ1YmJsZVByb3BlcnRpZXMod29ya0luUHJvZ3Jlc3MpOwogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQoKICAgICAgY2FzZSBIb3N0VGV4dDoKICAgICAgICB7CiAgICAgICAgICB2YXIgbmV3VGV4dCA9IG5ld1Byb3BzOwoKICAgICAgICAgIGlmIChjdXJyZW50ICYmIHdvcmtJblByb2dyZXNzLnN0YXRlTm9kZSAhPSBudWxsKSB7CiAgICAgICAgICAgIHZhciBvbGRUZXh0ID0gY3VycmVudC5tZW1vaXplZFByb3BzOyAvLyBJZiB3ZSBoYXZlIGFuIGFsdGVybmF0ZSwgdGhhdCBtZWFucyB0aGlzIGlzIGFuIHVwZGF0ZSBhbmQgd2UgbmVlZAogICAgICAgICAgICAvLyB0byBzY2hlZHVsZSBhIHNpZGUtZWZmZWN0IHRvIGRvIHRoZSB1cGRhdGVzLgoKICAgICAgICAgICAgdXBkYXRlSG9zdFRleHQkMShjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcywgb2xkVGV4dCwgbmV3VGV4dCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAodHlwZW9mIG5ld1RleHQgIT09ICdzdHJpbmcnKSB7CiAgICAgICAgICAgICAgaWYgKHdvcmtJblByb2dyZXNzLnN0YXRlTm9kZSA9PT0gbnVsbCkgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdXZSBtdXN0IGhhdmUgbmV3IHByb3BzIGZvciBuZXcgbW91bnRzLiBUaGlzIGVycm9yIGlzIGxpa2VseSAnICsgJ2NhdXNlZCBieSBhIGJ1ZyBpbiBSZWFjdC4gUGxlYXNlIGZpbGUgYW4gaXNzdWUuJyk7CiAgICAgICAgICAgICAgfSAvLyBUaGlzIGNhbiBoYXBwZW4gd2hlbiB3ZSBhYm9ydCB3b3JrLgoKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmFyIF9yb290Q29udGFpbmVySW5zdGFuY2UgPSBnZXRSb290SG9zdENvbnRhaW5lcigpOwoKICAgICAgICAgICAgdmFyIF9jdXJyZW50SG9zdENvbnRleHQgPSBnZXRIb3N0Q29udGV4dCgpOwoKICAgICAgICAgICAgdmFyIF93YXNIeWRyYXRlZDIgPSBwb3BIeWRyYXRpb25TdGF0ZSh3b3JrSW5Qcm9ncmVzcyk7CgogICAgICAgICAgICBpZiAoX3dhc0h5ZHJhdGVkMikgewogICAgICAgICAgICAgIGlmIChwcmVwYXJlVG9IeWRyYXRlSG9zdFRleHRJbnN0YW5jZSh3b3JrSW5Qcm9ncmVzcykpIHsKICAgICAgICAgICAgICAgIG1hcmtVcGRhdGUod29ya0luUHJvZ3Jlc3MpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB3b3JrSW5Qcm9ncmVzcy5zdGF0ZU5vZGUgPSBjcmVhdGVUZXh0SW5zdGFuY2UobmV3VGV4dCwgX3Jvb3RDb250YWluZXJJbnN0YW5jZSwgX2N1cnJlbnRIb3N0Q29udGV4dCwgd29ya0luUHJvZ3Jlc3MpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgYnViYmxlUHJvcGVydGllcyh3b3JrSW5Qcm9ncmVzcyk7CiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CgogICAgICBjYXNlIFN1c3BlbnNlQ29tcG9uZW50OgogICAgICAgIHsKICAgICAgICAgIHBvcFN1c3BlbnNlQ29udGV4dCh3b3JrSW5Qcm9ncmVzcyk7CiAgICAgICAgICB2YXIgbmV4dFN0YXRlID0gd29ya0luUHJvZ3Jlc3MubWVtb2l6ZWRTdGF0ZTsgLy8gU3BlY2lhbCBwYXRoIGZvciBkZWh5ZHJhdGVkIGJvdW5kYXJpZXMuIFdlIG1heSBldmVudHVhbGx5IG1vdmUgdGhpcwogICAgICAgICAgLy8gdG8gaXRzIG93biBmaWJlciB0eXBlIHNvIHRoYXQgd2UgY2FuIGFkZCBvdGhlciBraW5kcyBvZiBoeWRyYXRpb24KICAgICAgICAgIC8vIGJvdW5kYXJpZXMgdGhhdCBhcmVuJ3QgYXNzb2NpYXRlZCB3aXRoIGEgU3VzcGVuc2UgdHJlZS4gSW4gYW50aWNpcGF0aW9uCiAgICAgICAgICAvLyBvZiBzdWNoIGEgcmVmYWN0b3IsIGFsbCB0aGUgaHlkcmF0aW9uIGxvZ2ljIGlzIGNvbnRhaW5lZCBpbgogICAgICAgICAgLy8gdGhpcyBicmFuY2guCgogICAgICAgICAgaWYgKGN1cnJlbnQgPT09IG51bGwgfHwgY3VycmVudC5tZW1vaXplZFN0YXRlICE9PSBudWxsICYmIGN1cnJlbnQubWVtb2l6ZWRTdGF0ZS5kZWh5ZHJhdGVkICE9PSBudWxsKSB7CiAgICAgICAgICAgIHZhciBmYWxsdGhyb3VnaFRvTm9ybWFsU3VzcGVuc2VQYXRoID0gY29tcGxldGVEZWh5ZHJhdGVkU3VzcGVuc2VCb3VuZGFyeShjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcywgbmV4dFN0YXRlKTsKCiAgICAgICAgICAgIGlmICghZmFsbHRocm91Z2hUb05vcm1hbFN1c3BlbnNlUGF0aCkgewogICAgICAgICAgICAgIGlmICh3b3JrSW5Qcm9ncmVzcy5mbGFncyAmIFNob3VsZENhcHR1cmUpIHsKICAgICAgICAgICAgICAgIC8vIFNwZWNpYWwgY2FzZS4gVGhlcmUgd2VyZSByZW1haW5pbmcgdW5oeWRyYXRlZCBub2Rlcy4gV2UgdHJlYXQKICAgICAgICAgICAgICAgIC8vIHRoaXMgYXMgYSBtaXNtYXRjaC4gUmV2ZXJ0IHRvIGNsaWVudCByZW5kZXJpbmcuCiAgICAgICAgICAgICAgICByZXR1cm4gd29ya0luUHJvZ3Jlc3M7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIC8vIERpZCBub3QgZmluaXNoIGh5ZHJhdGluZywgZWl0aGVyIGJlY2F1c2UgdGhpcyBpcyB0aGUgaW5pdGlhbAogICAgICAgICAgICAgICAgLy8gcmVuZGVyIG9yIGJlY2F1c2Ugc29tZXRoaW5nIHN1c3BlbmRlZC4KICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSAvLyBDb250aW51ZSB3aXRoIHRoZSBub3JtYWwgU3VzcGVuc2UgcGF0aC4KCiAgICAgICAgICB9CgogICAgICAgICAgaWYgKCh3b3JrSW5Qcm9ncmVzcy5mbGFncyAmIERpZENhcHR1cmUpICE9PSBOb0ZsYWdzKSB7CiAgICAgICAgICAgIC8vIFNvbWV0aGluZyBzdXNwZW5kZWQuIFJlLXJlbmRlciB3aXRoIHRoZSBmYWxsYmFjayBjaGlsZHJlbi4KICAgICAgICAgICAgd29ya0luUHJvZ3Jlc3MubGFuZXMgPSByZW5kZXJMYW5lczsgLy8gRG8gbm90IHJlc2V0IHRoZSBlZmZlY3QgbGlzdC4KCiAgICAgICAgICAgIGlmICggKHdvcmtJblByb2dyZXNzLm1vZGUgJiBQcm9maWxlTW9kZSkgIT09IE5vTW9kZSkgewogICAgICAgICAgICAgIHRyYW5zZmVyQWN0dWFsRHVyYXRpb24od29ya0luUHJvZ3Jlc3MpOwogICAgICAgICAgICB9IC8vIERvbid0IGJ1YmJsZSBwcm9wZXJ0aWVzIGluIHRoaXMgY2FzZS4KCgogICAgICAgICAgICByZXR1cm4gd29ya0luUHJvZ3Jlc3M7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIG5leHREaWRUaW1lb3V0ID0gbmV4dFN0YXRlICE9PSBudWxsOwogICAgICAgICAgdmFyIHByZXZEaWRUaW1lb3V0ID0gY3VycmVudCAhPT0gbnVsbCAmJiBjdXJyZW50Lm1lbW9pemVkU3RhdGUgIT09IG51bGw7CiAgICAgICAgICAvLyBhIHBhc3NpdmUgZWZmZWN0LCB3aGljaCBpcyB3aGVuIHdlIHByb2Nlc3MgdGhlIHRyYW5zaXRpb25zCgoKICAgICAgICAgIGlmIChuZXh0RGlkVGltZW91dCAhPT0gcHJldkRpZFRpbWVvdXQpIHsKICAgICAgICAgICAgLy8gYW4gZWZmZWN0IHRvIHRvZ2dsZSB0aGUgc3VidHJlZSdzIHZpc2liaWxpdHkuIFdoZW4gd2Ugc3dpdGNoIGZyb20KICAgICAgICAgICAgLy8gZmFsbGJhY2sgLT4gcHJpbWFyeSwgdGhlIGlubmVyIE9mZnNjcmVlbiBmaWJlciBzY2hlZHVsZXMgdGhpcyBlZmZlY3QKICAgICAgICAgICAgLy8gYXMgcGFydCBvZiBpdHMgbm9ybWFsIGNvbXBsZXRlIHBoYXNlLiBCdXQgd2hlbiB3ZSBzd2l0Y2ggZnJvbQogICAgICAgICAgICAvLyBwcmltYXJ5IC0+IGZhbGxiYWNrLCB0aGUgaW5uZXIgT2Zmc2NyZWVuIGZpYmVyIGRvZXMgbm90IGhhdmUgYSBjb21wbGV0ZQogICAgICAgICAgICAvLyBwaGFzZS4gU28gd2UgbmVlZCB0byBzY2hlZHVsZSBpdHMgZWZmZWN0IGhlcmUuCiAgICAgICAgICAgIC8vCiAgICAgICAgICAgIC8vIFdlIGFsc28gdXNlIHRoaXMgZmxhZyB0byBjb25uZWN0L2Rpc2Nvbm5lY3QgdGhlIGVmZmVjdHMsIGJ1dCB0aGUgc2FtZQogICAgICAgICAgICAvLyBsb2dpYyBhcHBsaWVzOiB3aGVuIHJlLWNvbm5lY3RpbmcsIHRoZSBPZmZzY3JlZW4gZmliZXIncyBjb21wbGV0ZQogICAgICAgICAgICAvLyBwaGFzZSB3aWxsIGhhbmRsZSBzY2hlZHVsaW5nIHRoZSBlZmZlY3QuIEl0J3Mgb25seSB3aGVuIHRoZSBmYWxsYmFjawogICAgICAgICAgICAvLyBpcyBhY3RpdmUgdGhhdCB3ZSBoYXZlIHRvIGRvIGFueXRoaW5nIHNwZWNpYWwuCgoKICAgICAgICAgICAgaWYgKG5leHREaWRUaW1lb3V0KSB7CiAgICAgICAgICAgICAgdmFyIF9vZmZzY3JlZW5GaWJlcjIgPSB3b3JrSW5Qcm9ncmVzcy5jaGlsZDsKICAgICAgICAgICAgICBfb2Zmc2NyZWVuRmliZXIyLmZsYWdzIHw9IFZpc2liaWxpdHk7IC8vIFRPRE86IFRoaXMgd2lsbCBzdGlsbCBzdXNwZW5kIGEgc3luY2hyb25vdXMgdHJlZSBpZiBhbnl0aGluZwogICAgICAgICAgICAgIC8vIGluIHRoZSBjb25jdXJyZW50IHRyZWUgYWxyZWFkeSBzdXNwZW5kZWQgZHVyaW5nIHRoaXMgcmVuZGVyLgogICAgICAgICAgICAgIC8vIFRoaXMgaXMgYSBrbm93biBidWcuCgogICAgICAgICAgICAgIGlmICgod29ya0luUHJvZ3Jlc3MubW9kZSAmIENvbmN1cnJlbnRNb2RlKSAhPT0gTm9Nb2RlKSB7CiAgICAgICAgICAgICAgICAvLyBUT0RPOiBNb3ZlIHRoaXMgYmFjayB0byB0aHJvd0V4Y2VwdGlvbiBiZWNhdXNlIHRoaXMgaXMgdG9vIGxhdGUKICAgICAgICAgICAgICAgIC8vIGlmIHRoaXMgaXMgYSBsYXJnZSB0cmVlIHdoaWNoIGlzIGNvbW1vbiBmb3IgaW5pdGlhbCBsb2Fkcy4gV2UKICAgICAgICAgICAgICAgIC8vIGRvbid0IGtub3cgaWYgd2Ugc2hvdWxkIHJlc3RhcnQgYSByZW5kZXIgb3Igbm90IHVudGlsIHdlIGdldAogICAgICAgICAgICAgICAgLy8gdGhpcyBtYXJrZXIsIGFuZCB0aGlzIGlzIHRvbyBsYXRlLgogICAgICAgICAgICAgICAgLy8gSWYgdGhpcyByZW5kZXIgYWxyZWFkeSBoYWQgYSBwaW5nIG9yIGxvd2VyIHByaSB1cGRhdGVzLAogICAgICAgICAgICAgICAgLy8gYW5kIHRoaXMgaXMgdGhlIGZpcnN0IHRpbWUgd2Uga25vdyB3ZSdyZSBnb2luZyB0byBzdXNwZW5kIHdlCiAgICAgICAgICAgICAgICAvLyBzaG91bGQgYmUgYWJsZSB0byBpbW1lZGlhdGVseSByZXN0YXJ0IGZyb20gd2l0aGluIHRocm93RXhjZXB0aW9uLgogICAgICAgICAgICAgICAgdmFyIGhhc0ludmlzaWJsZUNoaWxkQ29udGV4dCA9IGN1cnJlbnQgPT09IG51bGwgJiYgKHdvcmtJblByb2dyZXNzLm1lbW9pemVkUHJvcHMudW5zdGFibGVfYXZvaWRUaGlzRmFsbGJhY2sgIT09IHRydWUgfHwgIWVuYWJsZVN1c3BlbnNlQXZvaWRUaGlzRmFsbGJhY2spOwoKICAgICAgICAgICAgICAgIGlmIChoYXNJbnZpc2libGVDaGlsZENvbnRleHQgfHwgaGFzU3VzcGVuc2VDb250ZXh0KHN1c3BlbnNlU3RhY2tDdXJzb3IuY3VycmVudCwgSW52aXNpYmxlUGFyZW50U3VzcGVuc2VDb250ZXh0KSkgewogICAgICAgICAgICAgICAgICAvLyBJZiB0aGlzIHdhcyBpbiBhbiBpbnZpc2libGUgdHJlZSBvciBhIG5ldyByZW5kZXIsIHRoZW4gc2hvd2luZwogICAgICAgICAgICAgICAgICAvLyB0aGlzIGJvdW5kYXJ5IGlzIG9rLgogICAgICAgICAgICAgICAgICByZW5kZXJEaWRTdXNwZW5kKCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAvLyBPdGhlcndpc2UsIHdlJ3JlIGdvaW5nIHRvIGhhdmUgdG8gaGlkZSBjb250ZW50IHNvIHdlIHNob3VsZAogICAgICAgICAgICAgICAgICAvLyBzdXNwZW5kIGZvciBsb25nZXIgaWYgcG9zc2libGUuCiAgICAgICAgICAgICAgICAgIHJlbmRlckRpZFN1c3BlbmREZWxheUlmUG9zc2libGUoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgd2FrZWFibGVzID0gd29ya0luUHJvZ3Jlc3MudXBkYXRlUXVldWU7CgogICAgICAgICAgaWYgKHdha2VhYmxlcyAhPT0gbnVsbCkgewogICAgICAgICAgICAvLyBTY2hlZHVsZSBhbiBlZmZlY3QgdG8gYXR0YWNoIGEgcmV0cnkgbGlzdGVuZXIgdG8gdGhlIHByb21pc2UuCiAgICAgICAgICAgIC8vIFRPRE86IE1vdmUgdG8gcGFzc2l2ZSBwaGFzZQogICAgICAgICAgICB3b3JrSW5Qcm9ncmVzcy5mbGFncyB8PSBVcGRhdGU7CiAgICAgICAgICB9CgogICAgICAgICAgYnViYmxlUHJvcGVydGllcyh3b3JrSW5Qcm9ncmVzcyk7CgogICAgICAgICAgewogICAgICAgICAgICBpZiAoKHdvcmtJblByb2dyZXNzLm1vZGUgJiBQcm9maWxlTW9kZSkgIT09IE5vTW9kZSkgewogICAgICAgICAgICAgIGlmIChuZXh0RGlkVGltZW91dCkgewogICAgICAgICAgICAgICAgLy8gRG9uJ3QgY291bnQgdGltZSBzcGVudCBpbiBhIHRpbWVkIG91dCBTdXNwZW5zZSBzdWJ0cmVlIGFzIHBhcnQgb2YgdGhlIGJhc2UgZHVyYXRpb24uCiAgICAgICAgICAgICAgICB2YXIgcHJpbWFyeUNoaWxkRnJhZ21lbnQgPSB3b3JrSW5Qcm9ncmVzcy5jaGlsZDsKCiAgICAgICAgICAgICAgICBpZiAocHJpbWFyeUNoaWxkRnJhZ21lbnQgIT09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgLy8gJEZsb3dGaXhNZSBGbG93IGRvZXNuJ3Qgc3VwcG9ydCB0eXBlIGNhc3RpbmcgaW4gY29tYmluYXRpb24gd2l0aCB0aGUgLT0gb3BlcmF0b3IKICAgICAgICAgICAgICAgICAgd29ya0luUHJvZ3Jlc3MudHJlZUJhc2VEdXJhdGlvbiAtPSBwcmltYXJ5Q2hpbGRGcmFnbWVudC50cmVlQmFzZUR1cmF0aW9uOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KCiAgICAgIGNhc2UgSG9zdFBvcnRhbDoKICAgICAgICBwb3BIb3N0Q29udGFpbmVyKHdvcmtJblByb2dyZXNzKTsKICAgICAgICB1cGRhdGVIb3N0Q29udGFpbmVyKGN1cnJlbnQsIHdvcmtJblByb2dyZXNzKTsKCiAgICAgICAgaWYgKGN1cnJlbnQgPT09IG51bGwpIHsKICAgICAgICAgIHByZXBhcmVQb3J0YWxNb3VudCh3b3JrSW5Qcm9ncmVzcy5zdGF0ZU5vZGUuY29udGFpbmVySW5mbyk7CiAgICAgICAgfQoKICAgICAgICBidWJibGVQcm9wZXJ0aWVzKHdvcmtJblByb2dyZXNzKTsKICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgIGNhc2UgQ29udGV4dFByb3ZpZGVyOgogICAgICAgIC8vIFBvcCBwcm92aWRlciBmaWJlcgogICAgICAgIHZhciBjb250ZXh0ID0gd29ya0luUHJvZ3Jlc3MudHlwZS5fY29udGV4dDsKICAgICAgICBwb3BQcm92aWRlcihjb250ZXh0LCB3b3JrSW5Qcm9ncmVzcyk7CiAgICAgICAgYnViYmxlUHJvcGVydGllcyh3b3JrSW5Qcm9ncmVzcyk7CiAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICBjYXNlIEluY29tcGxldGVDbGFzc0NvbXBvbmVudDoKICAgICAgICB7CiAgICAgICAgICAvLyBTYW1lIGFzIGNsYXNzIGNvbXBvbmVudCBjYXNlLiBJIHB1dCBpdCBkb3duIGhlcmUgc28gdGhhdCB0aGUgdGFncyBhcmUKICAgICAgICAgIC8vIHNlcXVlbnRpYWwgdG8gZW5zdXJlIHRoaXMgc3dpdGNoIGlzIGNvbXBpbGVkIHRvIGEganVtcCB0YWJsZS4KICAgICAgICAgIHZhciBfQ29tcG9uZW50ID0gd29ya0luUHJvZ3Jlc3MudHlwZTsKCiAgICAgICAgICBpZiAoaXNDb250ZXh0UHJvdmlkZXIoX0NvbXBvbmVudCkpIHsKICAgICAgICAgICAgcG9wQ29udGV4dCh3b3JrSW5Qcm9ncmVzcyk7CiAgICAgICAgICB9CgogICAgICAgICAgYnViYmxlUHJvcGVydGllcyh3b3JrSW5Qcm9ncmVzcyk7CiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CgogICAgICBjYXNlIFN1c3BlbnNlTGlzdENvbXBvbmVudDoKICAgICAgICB7CiAgICAgICAgICBwb3BTdXNwZW5zZUNvbnRleHQod29ya0luUHJvZ3Jlc3MpOwogICAgICAgICAgdmFyIHJlbmRlclN0YXRlID0gd29ya0luUHJvZ3Jlc3MubWVtb2l6ZWRTdGF0ZTsKCiAgICAgICAgICBpZiAocmVuZGVyU3RhdGUgPT09IG51bGwpIHsKICAgICAgICAgICAgLy8gV2UncmUgcnVubmluZyBpbiB0aGUgZGVmYXVsdCwgImluZGVwZW5kZW50IiBtb2RlLgogICAgICAgICAgICAvLyBXZSBkb24ndCBkbyBhbnl0aGluZyBpbiB0aGlzIG1vZGUuCiAgICAgICAgICAgIGJ1YmJsZVByb3BlcnRpZXMod29ya0luUHJvZ3Jlc3MpOwogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgZGlkU3VzcGVuZEFscmVhZHkgPSAod29ya0luUHJvZ3Jlc3MuZmxhZ3MgJiBEaWRDYXB0dXJlKSAhPT0gTm9GbGFnczsKICAgICAgICAgIHZhciByZW5kZXJlZFRhaWwgPSByZW5kZXJTdGF0ZS5yZW5kZXJpbmc7CgogICAgICAgICAgaWYgKHJlbmRlcmVkVGFpbCA9PT0gbnVsbCkgewogICAgICAgICAgICAvLyBXZSBqdXN0IHJlbmRlcmVkIHRoZSBoZWFkLgogICAgICAgICAgICBpZiAoIWRpZFN1c3BlbmRBbHJlYWR5KSB7CiAgICAgICAgICAgICAgLy8gVGhpcyBpcyB0aGUgZmlyc3QgcGFzcy4gV2UgbmVlZCB0byBmaWd1cmUgb3V0IGlmIGFueXRoaW5nIGlzIHN0aWxsCiAgICAgICAgICAgICAgLy8gc3VzcGVuZGVkIGluIHRoZSByZW5kZXJlZCBzZXQuCiAgICAgICAgICAgICAgLy8gSWYgbmV3IGNvbnRlbnQgdW5zdXNwZW5kZWQsIGJ1dCB0aGVyZSdzIHN0aWxsIHNvbWUgY29udGVudCB0aGF0CiAgICAgICAgICAgICAgLy8gZGlkbid0LiBUaGVuIHdlIG5lZWQgdG8gZG8gYSBzZWNvbmQgcGFzcyB0aGF0IGZvcmNlcyBldmVyeXRoaW5nCiAgICAgICAgICAgICAgLy8gdG8ga2VlcCBzaG93aW5nIHRoZWlyIGZhbGxiYWNrcy4KICAgICAgICAgICAgICAvLyBXZSBtaWdodCBiZSBzdXNwZW5kZWQgaWYgc29tZXRoaW5nIGluIHRoaXMgcmVuZGVyIHBhc3Mgc3VzcGVuZGVkLCBvcgogICAgICAgICAgICAgIC8vIHNvbWV0aGluZyBpbiB0aGUgcHJldmlvdXMgY29tbWl0dGVkIHBhc3Mgc3VzcGVuZGVkLiBPdGhlcndpc2UsCiAgICAgICAgICAgICAgLy8gdGhlcmUncyBubyBjaGFuY2Ugc28gd2UgY2FuIHNraXAgdGhlIGV4cGVuc2l2ZSBjYWxsIHRvCiAgICAgICAgICAgICAgLy8gZmluZEZpcnN0U3VzcGVuZGVkLgogICAgICAgICAgICAgIHZhciBjYW5ub3RCZVN1c3BlbmRlZCA9IHJlbmRlckhhc05vdFN1c3BlbmRlZFlldCgpICYmIChjdXJyZW50ID09PSBudWxsIHx8IChjdXJyZW50LmZsYWdzICYgRGlkQ2FwdHVyZSkgPT09IE5vRmxhZ3MpOwoKICAgICAgICAgICAgICBpZiAoIWNhbm5vdEJlU3VzcGVuZGVkKSB7CiAgICAgICAgICAgICAgICB2YXIgcm93ID0gd29ya0luUHJvZ3Jlc3MuY2hpbGQ7CgogICAgICAgICAgICAgICAgd2hpbGUgKHJvdyAhPT0gbnVsbCkgewogICAgICAgICAgICAgICAgICB2YXIgc3VzcGVuZGVkID0gZmluZEZpcnN0U3VzcGVuZGVkKHJvdyk7CgogICAgICAgICAgICAgICAgICBpZiAoc3VzcGVuZGVkICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgZGlkU3VzcGVuZEFscmVhZHkgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIHdvcmtJblByb2dyZXNzLmZsYWdzIHw9IERpZENhcHR1cmU7CiAgICAgICAgICAgICAgICAgICAgY3V0T2ZmVGFpbElmTmVlZGVkKHJlbmRlclN0YXRlLCBmYWxzZSk7IC8vIElmIHRoaXMgaXMgYSBuZXdseSBzdXNwZW5kZWQgdHJlZSwgaXQgbWlnaHQgbm90IGdldCBjb21taXR0ZWQgYXMKICAgICAgICAgICAgICAgICAgICAvLyBwYXJ0IG9mIHRoZSBzZWNvbmQgcGFzcy4gSW4gdGhhdCBjYXNlIG5vdGhpbmcgd2lsbCBzdWJzY3JpYmUgdG8KICAgICAgICAgICAgICAgICAgICAvLyBpdHMgdGhlbmFibGVzLiBJbnN0ZWFkLCB3ZSdsbCB0cmFuc2ZlciBpdHMgdGhlbmFibGVzIHRvIHRoZQogICAgICAgICAgICAgICAgICAgIC8vIFN1c3BlbnNlTGlzdCBzbyB0aGF0IGl0IGNhbiByZXRyeSBpZiB0aGV5IHJlc29sdmUuCiAgICAgICAgICAgICAgICAgICAgLy8gVGhlcmUgbWlnaHQgYmUgbXVsdGlwbGUgb2YgdGhlc2UgaW4gdGhlIGxpc3QgYnV0IHNpbmNlIHdlJ3JlCiAgICAgICAgICAgICAgICAgICAgLy8gZ29pbmcgdG8gd2FpdCBmb3IgYWxsIG9mIHRoZW0gYW55d2F5LCBpdCBkb2Vzbid0IHJlYWxseSBtYXR0ZXIKICAgICAgICAgICAgICAgICAgICAvLyB3aGljaCBvbmVzIGdldHMgdG8gcGluZy4gSW4gdGhlb3J5IHdlIGNvdWxkIGdldCBjbGV2ZXIgYW5kIGtlZXAKICAgICAgICAgICAgICAgICAgICAvLyB0cmFjayBvZiBob3cgbWFueSBkZXBlbmRlbmNpZXMgcmVtYWluIGJ1dCBpdCBnZXRzIHRyaWNreSBiZWNhdXNlCiAgICAgICAgICAgICAgICAgICAgLy8gaW4gdGhlIG1lYW50aW1lLCB3ZSBjYW4gYWRkL3JlbW92ZS9jaGFuZ2UgaXRlbXMgYW5kIGRlcGVuZGVuY2llcy4KICAgICAgICAgICAgICAgICAgICAvLyBXZSBtaWdodCBiYWlsIG91dCBvZiB0aGUgbG9vcCBiZWZvcmUgZmluZGluZyBhbnkgYnV0IHRoYXQKICAgICAgICAgICAgICAgICAgICAvLyBkb2Vzbid0IG1hdHRlciBzaW5jZSB0aGF0IG1lYW5zIHRoYXQgdGhlIG90aGVyIGJvdW5kYXJpZXMgdGhhdAogICAgICAgICAgICAgICAgICAgIC8vIHdlIGRpZCBmaW5kIGFscmVhZHkgaGFzIHRoZWlyIGxpc3RlbmVycyBhdHRhY2hlZC4KCiAgICAgICAgICAgICAgICAgICAgdmFyIG5ld1RoZW5hYmxlcyA9IHN1c3BlbmRlZC51cGRhdGVRdWV1ZTsKCiAgICAgICAgICAgICAgICAgICAgaWYgKG5ld1RoZW5hYmxlcyAhPT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgICAgd29ya0luUHJvZ3Jlc3MudXBkYXRlUXVldWUgPSBuZXdUaGVuYWJsZXM7CiAgICAgICAgICAgICAgICAgICAgICB3b3JrSW5Qcm9ncmVzcy5mbGFncyB8PSBVcGRhdGU7CiAgICAgICAgICAgICAgICAgICAgfSAvLyBSZXJlbmRlciB0aGUgd2hvbGUgbGlzdCwgYnV0IHRoaXMgdGltZSwgd2UnbGwgZm9yY2UgZmFsbGJhY2tzCiAgICAgICAgICAgICAgICAgICAgLy8gdG8gc3RheSBpbiBwbGFjZS4KICAgICAgICAgICAgICAgICAgICAvLyBSZXNldCB0aGUgZWZmZWN0IGZsYWdzIGJlZm9yZSBkb2luZyB0aGUgc2Vjb25kIHBhc3Mgc2luY2UgdGhhdCdzIG5vdyBpbnZhbGlkLgogICAgICAgICAgICAgICAgICAgIC8vIFJlc2V0IHRoZSBjaGlsZCBmaWJlcnMgdG8gdGhlaXIgb3JpZ2luYWwgc3RhdGUuCgoKICAgICAgICAgICAgICAgICAgICB3b3JrSW5Qcm9ncmVzcy5zdWJ0cmVlRmxhZ3MgPSBOb0ZsYWdzOwogICAgICAgICAgICAgICAgICAgIHJlc2V0Q2hpbGRGaWJlcnMod29ya0luUHJvZ3Jlc3MsIHJlbmRlckxhbmVzKTsgLy8gU2V0IHVwIHRoZSBTdXNwZW5zZSBDb250ZXh0IHRvIGZvcmNlIHN1c3BlbnNlIGFuZCBpbW1lZGlhdGVseQogICAgICAgICAgICAgICAgICAgIC8vIHJlcmVuZGVyIHRoZSBjaGlsZHJlbi4KCiAgICAgICAgICAgICAgICAgICAgcHVzaFN1c3BlbnNlQ29udGV4dCh3b3JrSW5Qcm9ncmVzcywgc2V0U2hhbGxvd1N1c3BlbnNlQ29udGV4dChzdXNwZW5zZVN0YWNrQ3Vyc29yLmN1cnJlbnQsIEZvcmNlU3VzcGVuc2VGYWxsYmFjaykpOyAvLyBEb24ndCBidWJibGUgcHJvcGVydGllcyBpbiB0aGlzIGNhc2UuCgogICAgICAgICAgICAgICAgICAgIHJldHVybiB3b3JrSW5Qcm9ncmVzcy5jaGlsZDsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgcm93ID0gcm93LnNpYmxpbmc7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAocmVuZGVyU3RhdGUudGFpbCAhPT0gbnVsbCAmJiBub3coKSA+IGdldFJlbmRlclRhcmdldFRpbWUoKSkgewogICAgICAgICAgICAgICAgLy8gV2UgaGF2ZSBhbHJlYWR5IHBhc3NlZCBvdXIgQ1BVIGRlYWRsaW5lIGJ1dCB3ZSBzdGlsbCBoYXZlIHJvd3MKICAgICAgICAgICAgICAgIC8vIGxlZnQgaW4gdGhlIHRhaWwuIFdlJ2xsIGp1c3QgZ2l2ZSB1cCBmdXJ0aGVyIGF0dGVtcHRzIHRvIHJlbmRlcgogICAgICAgICAgICAgICAgLy8gdGhlIG1haW4gY29udGVudCBhbmQgb25seSByZW5kZXIgZmFsbGJhY2tzLgogICAgICAgICAgICAgICAgd29ya0luUHJvZ3Jlc3MuZmxhZ3MgfD0gRGlkQ2FwdHVyZTsKICAgICAgICAgICAgICAgIGRpZFN1c3BlbmRBbHJlYWR5ID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGN1dE9mZlRhaWxJZk5lZWRlZChyZW5kZXJTdGF0ZSwgZmFsc2UpOyAvLyBTaW5jZSBub3RoaW5nIGFjdHVhbGx5IHN1c3BlbmRlZCwgdGhlcmUgd2lsbCBub3RoaW5nIHRvIHBpbmcgdGhpcwogICAgICAgICAgICAgICAgLy8gdG8gZ2V0IGl0IHN0YXJ0ZWQgYmFjayB1cCB0byBhdHRlbXB0IHRoZSBuZXh0IGl0ZW0uIFdoaWxlIGluIHRlcm1zCiAgICAgICAgICAgICAgICAvLyBvZiBwcmlvcml0eSB0aGlzIHdvcmsgaGFzIHRoZSBzYW1lIHByaW9yaXR5IGFzIHRoaXMgY3VycmVudCByZW5kZXIsCiAgICAgICAgICAgICAgICAvLyBpdCdzIG5vdCBwYXJ0IG9mIHRoZSBzYW1lIHRyYW5zaXRpb24gb25jZSB0aGUgdHJhbnNpdGlvbiBoYXMKICAgICAgICAgICAgICAgIC8vIGNvbW1pdHRlZC4gSWYgaXQncyBzeW5jLCB3ZSBzdGlsbCB3YW50IHRvIHlpZWxkIHNvIHRoYXQgaXQgY2FuIGJlCiAgICAgICAgICAgICAgICAvLyBwYWludGVkLiBDb25jZXB0dWFsbHksIHRoaXMgaXMgcmVhbGx5IHRoZSBzYW1lIGFzIHBpbmdpbmcuCiAgICAgICAgICAgICAgICAvLyBXZSBjYW4gdXNlIGFueSBSZXRyeUxhbmUgZXZlbiBpZiBpdCdzIHRoZSBvbmUgY3VycmVudGx5IHJlbmRlcmluZwogICAgICAgICAgICAgICAgLy8gc2luY2Ugd2UncmUgbGVhdmluZyBpdCBiZWhpbmQgb24gdGhpcyBub2RlLgoKICAgICAgICAgICAgICAgIHdvcmtJblByb2dyZXNzLmxhbmVzID0gU29tZVJldHJ5TGFuZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgY3V0T2ZmVGFpbElmTmVlZGVkKHJlbmRlclN0YXRlLCBmYWxzZSk7CiAgICAgICAgICAgIH0gLy8gTmV4dCB3ZSdyZSBnb2luZyB0byByZW5kZXIgdGhlIHRhaWwuCgogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gQXBwZW5kIHRoZSByZW5kZXJlZCByb3cgdG8gdGhlIGNoaWxkIGxpc3QuCiAgICAgICAgICAgIGlmICghZGlkU3VzcGVuZEFscmVhZHkpIHsKICAgICAgICAgICAgICB2YXIgX3N1c3BlbmRlZCA9IGZpbmRGaXJzdFN1c3BlbmRlZChyZW5kZXJlZFRhaWwpOwoKICAgICAgICAgICAgICBpZiAoX3N1c3BlbmRlZCAhPT0gbnVsbCkgewogICAgICAgICAgICAgICAgd29ya0luUHJvZ3Jlc3MuZmxhZ3MgfD0gRGlkQ2FwdHVyZTsKICAgICAgICAgICAgICAgIGRpZFN1c3BlbmRBbHJlYWR5ID0gdHJ1ZTsgLy8gRW5zdXJlIHdlIHRyYW5zZmVyIHRoZSB1cGRhdGUgcXVldWUgdG8gdGhlIHBhcmVudCBzbyB0aGF0IGl0IGRvZXNuJ3QKICAgICAgICAgICAgICAgIC8vIGdldCBsb3N0IGlmIHRoaXMgcm93IGVuZHMgdXAgZHJvcHBlZCBkdXJpbmcgYSBzZWNvbmQgcGFzcy4KCiAgICAgICAgICAgICAgICB2YXIgX25ld1RoZW5hYmxlcyA9IF9zdXNwZW5kZWQudXBkYXRlUXVldWU7CgogICAgICAgICAgICAgICAgaWYgKF9uZXdUaGVuYWJsZXMgIT09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgd29ya0luUHJvZ3Jlc3MudXBkYXRlUXVldWUgPSBfbmV3VGhlbmFibGVzOwogICAgICAgICAgICAgICAgICB3b3JrSW5Qcm9ncmVzcy5mbGFncyB8PSBVcGRhdGU7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgY3V0T2ZmVGFpbElmTmVlZGVkKHJlbmRlclN0YXRlLCB0cnVlKTsgLy8gVGhpcyBtaWdodCBoYXZlIGJlZW4gbW9kaWZpZWQuCgogICAgICAgICAgICAgICAgaWYgKHJlbmRlclN0YXRlLnRhaWwgPT09IG51bGwgJiYgcmVuZGVyU3RhdGUudGFpbE1vZGUgPT09ICdoaWRkZW4nICYmICFyZW5kZXJlZFRhaWwuYWx0ZXJuYXRlICYmICFnZXRJc0h5ZHJhdGluZygpIC8vIFdlIGRvbid0IGN1dCBpdCBpZiB3ZSdyZSBoeWRyYXRpbmcuCiAgICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgICAgICAvLyBXZSdyZSBkb25lLgogICAgICAgICAgICAgICAgICAgIGJ1YmJsZVByb3BlcnRpZXMod29ya0luUHJvZ3Jlc3MpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSBlbHNlIGlmICggLy8gVGhlIHRpbWUgaXQgdG9vayB0byByZW5kZXIgbGFzdCByb3cgaXMgZ3JlYXRlciB0aGFuIHRoZSByZW1haW5pbmcKICAgICAgICAgICAgICAvLyB0aW1lIHdlIGhhdmUgdG8gcmVuZGVyLiBTbyByZW5kZXJpbmcgb25lIG1vcmUgcm93IHdvdWxkIGxpa2VseQogICAgICAgICAgICAgIC8vIGV4Y2VlZCBpdC4KICAgICAgICAgICAgICBub3coKSAqIDIgLSByZW5kZXJTdGF0ZS5yZW5kZXJpbmdTdGFydFRpbWUgPiBnZXRSZW5kZXJUYXJnZXRUaW1lKCkgJiYgcmVuZGVyTGFuZXMgIT09IE9mZnNjcmVlbkxhbmUpIHsKICAgICAgICAgICAgICAgIC8vIFdlIGhhdmUgbm93IHBhc3NlZCBvdXIgQ1BVIGRlYWRsaW5lIGFuZCB3ZSdsbCBqdXN0IGdpdmUgdXAgZnVydGhlcgogICAgICAgICAgICAgICAgLy8gYXR0ZW1wdHMgdG8gcmVuZGVyIHRoZSBtYWluIGNvbnRlbnQgYW5kIG9ubHkgcmVuZGVyIGZhbGxiYWNrcy4KICAgICAgICAgICAgICAgIC8vIFRoZSBhc3N1bXB0aW9uIGlzIHRoYXQgdGhpcyBpcyB1c3VhbGx5IGZhc3Rlci4KICAgICAgICAgICAgICAgIHdvcmtJblByb2dyZXNzLmZsYWdzIHw9IERpZENhcHR1cmU7CiAgICAgICAgICAgICAgICBkaWRTdXNwZW5kQWxyZWFkeSA9IHRydWU7CiAgICAgICAgICAgICAgICBjdXRPZmZUYWlsSWZOZWVkZWQocmVuZGVyU3RhdGUsIGZhbHNlKTsgLy8gU2luY2Ugbm90aGluZyBhY3R1YWxseSBzdXNwZW5kZWQsIHRoZXJlIHdpbGwgbm90aGluZyB0byBwaW5nIHRoaXMKICAgICAgICAgICAgICAgIC8vIHRvIGdldCBpdCBzdGFydGVkIGJhY2sgdXAgdG8gYXR0ZW1wdCB0aGUgbmV4dCBpdGVtLiBXaGlsZSBpbiB0ZXJtcwogICAgICAgICAgICAgICAgLy8gb2YgcHJpb3JpdHkgdGhpcyB3b3JrIGhhcyB0aGUgc2FtZSBwcmlvcml0eSBhcyB0aGlzIGN1cnJlbnQgcmVuZGVyLAogICAgICAgICAgICAgICAgLy8gaXQncyBub3QgcGFydCBvZiB0aGUgc2FtZSB0cmFuc2l0aW9uIG9uY2UgdGhlIHRyYW5zaXRpb24gaGFzCiAgICAgICAgICAgICAgICAvLyBjb21taXR0ZWQuIElmIGl0J3Mgc3luYywgd2Ugc3RpbGwgd2FudCB0byB5aWVsZCBzbyB0aGF0IGl0IGNhbiBiZQogICAgICAgICAgICAgICAgLy8gcGFpbnRlZC4gQ29uY2VwdHVhbGx5LCB0aGlzIGlzIHJlYWxseSB0aGUgc2FtZSBhcyBwaW5naW5nLgogICAgICAgICAgICAgICAgLy8gV2UgY2FuIHVzZSBhbnkgUmV0cnlMYW5lIGV2ZW4gaWYgaXQncyB0aGUgb25lIGN1cnJlbnRseSByZW5kZXJpbmcKICAgICAgICAgICAgICAgIC8vIHNpbmNlIHdlJ3JlIGxlYXZpbmcgaXQgYmVoaW5kIG9uIHRoaXMgbm9kZS4KCiAgICAgICAgICAgICAgICB3b3JrSW5Qcm9ncmVzcy5sYW5lcyA9IFNvbWVSZXRyeUxhbmU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAocmVuZGVyU3RhdGUuaXNCYWNrd2FyZHMpIHsKICAgICAgICAgICAgICAvLyBUaGUgZWZmZWN0IGxpc3Qgb2YgdGhlIGJhY2t3YXJkcyB0YWlsIHdpbGwgaGF2ZSBiZWVuIGFkZGVkCiAgICAgICAgICAgICAgLy8gdG8gdGhlIGVuZC4gVGhpcyBicmVha3MgdGhlIGd1YXJhbnRlZSB0aGF0IGxpZmUtY3ljbGVzIGZpcmUgaW4KICAgICAgICAgICAgICAvLyBzaWJsaW5nIG9yZGVyIGJ1dCB0aGF0IGlzbid0IGEgc3Ryb25nIGd1YXJhbnRlZSBwcm9taXNlZCBieSBSZWFjdC4KICAgICAgICAgICAgICAvLyBFc3BlY2lhbGx5IHNpbmNlIHRoZXNlIG1pZ2h0IGFsc28ganVzdCBwb3AgaW4gZHVyaW5nIGZ1dHVyZSBjb21taXRzLgogICAgICAgICAgICAgIC8vIEFwcGVuZCB0byB0aGUgYmVnaW5uaW5nIG9mIHRoZSBsaXN0LgogICAgICAgICAgICAgIHJlbmRlcmVkVGFpbC5zaWJsaW5nID0gd29ya0luUHJvZ3Jlc3MuY2hpbGQ7CiAgICAgICAgICAgICAgd29ya0luUHJvZ3Jlc3MuY2hpbGQgPSByZW5kZXJlZFRhaWw7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgdmFyIHByZXZpb3VzU2libGluZyA9IHJlbmRlclN0YXRlLmxhc3Q7CgogICAgICAgICAgICAgIGlmIChwcmV2aW91c1NpYmxpbmcgIT09IG51bGwpIHsKICAgICAgICAgICAgICAgIHByZXZpb3VzU2libGluZy5zaWJsaW5nID0gcmVuZGVyZWRUYWlsOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB3b3JrSW5Qcm9ncmVzcy5jaGlsZCA9IHJlbmRlcmVkVGFpbDsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHJlbmRlclN0YXRlLmxhc3QgPSByZW5kZXJlZFRhaWw7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBpZiAocmVuZGVyU3RhdGUudGFpbCAhPT0gbnVsbCkgewogICAgICAgICAgICAvLyBXZSBzdGlsbCBoYXZlIHRhaWwgcm93cyB0byByZW5kZXIuCiAgICAgICAgICAgIC8vIFBvcCBhIHJvdy4KICAgICAgICAgICAgdmFyIG5leHQgPSByZW5kZXJTdGF0ZS50YWlsOwogICAgICAgICAgICByZW5kZXJTdGF0ZS5yZW5kZXJpbmcgPSBuZXh0OwogICAgICAgICAgICByZW5kZXJTdGF0ZS50YWlsID0gbmV4dC5zaWJsaW5nOwogICAgICAgICAgICByZW5kZXJTdGF0ZS5yZW5kZXJpbmdTdGFydFRpbWUgPSBub3coKTsKICAgICAgICAgICAgbmV4dC5zaWJsaW5nID0gbnVsbDsgLy8gUmVzdG9yZSB0aGUgY29udGV4dC4KICAgICAgICAgICAgLy8gVE9ETzogV2UgY2FuIHByb2JhYmx5IGp1c3QgYXZvaWQgcG9wcGluZyBpdCBpbnN0ZWFkIGFuZCBvbmx5CiAgICAgICAgICAgIC8vIHNldHRpbmcgaXQgdGhlIGZpcnN0IHRpbWUgd2UgZ28gZnJvbSBub3Qgc3VzcGVuZGVkIHRvIHN1c3BlbmRlZC4KCiAgICAgICAgICAgIHZhciBzdXNwZW5zZUNvbnRleHQgPSBzdXNwZW5zZVN0YWNrQ3Vyc29yLmN1cnJlbnQ7CgogICAgICAgICAgICBpZiAoZGlkU3VzcGVuZEFscmVhZHkpIHsKICAgICAgICAgICAgICBzdXNwZW5zZUNvbnRleHQgPSBzZXRTaGFsbG93U3VzcGVuc2VDb250ZXh0KHN1c3BlbnNlQ29udGV4dCwgRm9yY2VTdXNwZW5zZUZhbGxiYWNrKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBzdXNwZW5zZUNvbnRleHQgPSBzZXREZWZhdWx0U2hhbGxvd1N1c3BlbnNlQ29udGV4dChzdXNwZW5zZUNvbnRleHQpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdXNoU3VzcGVuc2VDb250ZXh0KHdvcmtJblByb2dyZXNzLCBzdXNwZW5zZUNvbnRleHQpOyAvLyBEbyBhIHBhc3Mgb3ZlciB0aGUgbmV4dCByb3cuCiAgICAgICAgICAgIC8vIERvbid0IGJ1YmJsZSBwcm9wZXJ0aWVzIGluIHRoaXMgY2FzZS4KCiAgICAgICAgICAgIHJldHVybiBuZXh0OwogICAgICAgICAgfQoKICAgICAgICAgIGJ1YmJsZVByb3BlcnRpZXMod29ya0luUHJvZ3Jlc3MpOwogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQoKICAgICAgY2FzZSBTY29wZUNvbXBvbmVudDoKICAgICAgICB7CgogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgY2FzZSBPZmZzY3JlZW5Db21wb25lbnQ6CiAgICAgIGNhc2UgTGVnYWN5SGlkZGVuQ29tcG9uZW50OgogICAgICAgIHsKICAgICAgICAgIHBvcFJlbmRlckxhbmVzKHdvcmtJblByb2dyZXNzKTsKICAgICAgICAgIHZhciBfbmV4dFN0YXRlID0gd29ya0luUHJvZ3Jlc3MubWVtb2l6ZWRTdGF0ZTsKICAgICAgICAgIHZhciBuZXh0SXNIaWRkZW4gPSBfbmV4dFN0YXRlICE9PSBudWxsOwoKICAgICAgICAgIGlmIChjdXJyZW50ICE9PSBudWxsKSB7CiAgICAgICAgICAgIHZhciBfcHJldlN0YXRlID0gY3VycmVudC5tZW1vaXplZFN0YXRlOwogICAgICAgICAgICB2YXIgcHJldklzSGlkZGVuID0gX3ByZXZTdGF0ZSAhPT0gbnVsbDsKCiAgICAgICAgICAgIGlmIChwcmV2SXNIaWRkZW4gIT09IG5leHRJc0hpZGRlbiAmJiAoIC8vIExlZ2FjeUhpZGRlbiBkb2Vzbid0IGRvIGFueSBoaWRpbmcg4oCUIGl0IG9ubHkgcHJlLXJlbmRlcnMuCiAgICAgICAgICAgICFlbmFibGVMZWdhY3lIaWRkZW4gKSkgewogICAgICAgICAgICAgIHdvcmtJblByb2dyZXNzLmZsYWdzIHw9IFZpc2liaWxpdHk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoIW5leHRJc0hpZGRlbiB8fCAod29ya0luUHJvZ3Jlc3MubW9kZSAmIENvbmN1cnJlbnRNb2RlKSA9PT0gTm9Nb2RlKSB7CiAgICAgICAgICAgIGJ1YmJsZVByb3BlcnRpZXMod29ya0luUHJvZ3Jlc3MpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gRG9uJ3QgYnViYmxlIHByb3BlcnRpZXMgZm9yIGhpZGRlbiBjaGlsZHJlbiB1bmxlc3Mgd2UncmUgcmVuZGVyaW5nCiAgICAgICAgICAgIC8vIGF0IG9mZnNjcmVlbiBwcmlvcml0eS4KICAgICAgICAgICAgaWYgKGluY2x1ZGVzU29tZUxhbmUoc3VidHJlZVJlbmRlckxhbmVzLCBPZmZzY3JlZW5MYW5lKSkgewogICAgICAgICAgICAgIGJ1YmJsZVByb3BlcnRpZXMod29ya0luUHJvZ3Jlc3MpOwoKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiB0aGVyZSB3YXMgYW4gaW5zZXJ0aW9uIG9yIHVwZGF0ZSBpbiB0aGUgaGlkZGVuIHN1YnRyZWUuCiAgICAgICAgICAgICAgICAvLyBJZiBzbywgd2UgbmVlZCB0byBoaWRlIHRob3NlIG5vZGVzIGluIHRoZSBjb21taXQgcGhhc2UsIHNvCiAgICAgICAgICAgICAgICAvLyBzY2hlZHVsZSBhIHZpc2liaWxpdHkgZWZmZWN0LgogICAgICAgICAgICAgICAgaWYgKCB3b3JrSW5Qcm9ncmVzcy5zdWJ0cmVlRmxhZ3MgJiAoUGxhY2VtZW50IHwgVXBkYXRlKSkgewogICAgICAgICAgICAgICAgICB3b3JrSW5Qcm9ncmVzcy5mbGFncyB8PSBWaXNpYmlsaXR5OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQoKICAgICAgY2FzZSBDYWNoZUNvbXBvbmVudDoKICAgICAgICB7CgogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQoKICAgICAgY2FzZSBUcmFjaW5nTWFya2VyQ29tcG9uZW50OgogICAgICAgIHsKCiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CiAgICB9CgogICAgdGhyb3cgbmV3IEVycm9yKCJVbmtub3duIHVuaXQgb2Ygd29yayB0YWcgKCIgKyB3b3JrSW5Qcm9ncmVzcy50YWcgKyAiKS4gVGhpcyBlcnJvciBpcyBsaWtlbHkgY2F1c2VkIGJ5IGEgYnVnIGluICIgKyAnUmVhY3QuIFBsZWFzZSBmaWxlIGFuIGlzc3VlLicpOwogIH0KCiAgZnVuY3Rpb24gdW53aW5kV29yayhjdXJyZW50LCB3b3JrSW5Qcm9ncmVzcywgcmVuZGVyTGFuZXMpIHsKICAgIC8vIE5vdGU6IFRoaXMgaW50ZW50aW9uYWxseSBkb2Vzbid0IGNoZWNrIGlmIHdlJ3JlIGh5ZHJhdGluZyBiZWNhdXNlIGNvbXBhcmluZwogICAgLy8gdG8gdGhlIGN1cnJlbnQgdHJlZSBwcm92aWRlciBmaWJlciBpcyBqdXN0IGFzIGZhc3QgYW5kIGxlc3MgZXJyb3ItcHJvbmUuCiAgICAvLyBJZGVhbGx5IHdlIHdvdWxkIGhhdmUgYSBzcGVjaWFsIHZlcnNpb24gb2YgdGhlIHdvcmsgbG9vcCBvbmx5CiAgICAvLyBmb3IgaHlkcmF0aW9uLgogICAgcG9wVHJlZUNvbnRleHQod29ya0luUHJvZ3Jlc3MpOwoKICAgIHN3aXRjaCAod29ya0luUHJvZ3Jlc3MudGFnKSB7CiAgICAgIGNhc2UgQ2xhc3NDb21wb25lbnQ6CiAgICAgICAgewogICAgICAgICAgdmFyIENvbXBvbmVudCA9IHdvcmtJblByb2dyZXNzLnR5cGU7CgogICAgICAgICAgaWYgKGlzQ29udGV4dFByb3ZpZGVyKENvbXBvbmVudCkpIHsKICAgICAgICAgICAgcG9wQ29udGV4dCh3b3JrSW5Qcm9ncmVzcyk7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIGZsYWdzID0gd29ya0luUHJvZ3Jlc3MuZmxhZ3M7CgogICAgICAgICAgaWYgKGZsYWdzICYgU2hvdWxkQ2FwdHVyZSkgewogICAgICAgICAgICB3b3JrSW5Qcm9ncmVzcy5mbGFncyA9IGZsYWdzICYgflNob3VsZENhcHR1cmUgfCBEaWRDYXB0dXJlOwoKICAgICAgICAgICAgaWYgKCAod29ya0luUHJvZ3Jlc3MubW9kZSAmIFByb2ZpbGVNb2RlKSAhPT0gTm9Nb2RlKSB7CiAgICAgICAgICAgICAgdHJhbnNmZXJBY3R1YWxEdXJhdGlvbih3b3JrSW5Qcm9ncmVzcyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiB3b3JrSW5Qcm9ncmVzczsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CgogICAgICBjYXNlIEhvc3RSb290OgogICAgICAgIHsKICAgICAgICAgIHZhciByb290ID0gd29ya0luUHJvZ3Jlc3Muc3RhdGVOb2RlOwogICAgICAgICAgcG9wSG9zdENvbnRhaW5lcih3b3JrSW5Qcm9ncmVzcyk7CiAgICAgICAgICBwb3BUb3BMZXZlbENvbnRleHRPYmplY3Qod29ya0luUHJvZ3Jlc3MpOwogICAgICAgICAgcmVzZXRXb3JrSW5Qcm9ncmVzc1ZlcnNpb25zKCk7CiAgICAgICAgICB2YXIgX2ZsYWdzID0gd29ya0luUHJvZ3Jlc3MuZmxhZ3M7CgogICAgICAgICAgaWYgKChfZmxhZ3MgJiBTaG91bGRDYXB0dXJlKSAhPT0gTm9GbGFncyAmJiAoX2ZsYWdzICYgRGlkQ2FwdHVyZSkgPT09IE5vRmxhZ3MpIHsKICAgICAgICAgICAgLy8gVGhlcmUgd2FzIGFuIGVycm9yIGR1cmluZyByZW5kZXIgdGhhdCB3YXNuJ3QgY2FwdHVyZWQgYnkgYSBzdXNwZW5zZQogICAgICAgICAgICAvLyBib3VuZGFyeS4gRG8gYSBzZWNvbmQgcGFzcyBvbiB0aGUgcm9vdCB0byB1bm1vdW50IHRoZSBjaGlsZHJlbi4KICAgICAgICAgICAgd29ya0luUHJvZ3Jlc3MuZmxhZ3MgPSBfZmxhZ3MgJiB+U2hvdWxkQ2FwdHVyZSB8IERpZENhcHR1cmU7CiAgICAgICAgICAgIHJldHVybiB3b3JrSW5Qcm9ncmVzczsKICAgICAgICAgIH0gLy8gV2UgdW53b3VuZCB0byB0aGUgcm9vdCB3aXRob3V0IGNvbXBsZXRpbmcgaXQuIEV4aXQuCgoKICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KCiAgICAgIGNhc2UgSG9zdENvbXBvbmVudDoKICAgICAgICB7CiAgICAgICAgICAvLyBUT0RPOiBwb3BIeWRyYXRpb25TdGF0ZQogICAgICAgICAgcG9wSG9zdENvbnRleHQod29ya0luUHJvZ3Jlc3MpOwogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQoKICAgICAgY2FzZSBTdXNwZW5zZUNvbXBvbmVudDoKICAgICAgICB7CiAgICAgICAgICBwb3BTdXNwZW5zZUNvbnRleHQod29ya0luUHJvZ3Jlc3MpOwogICAgICAgICAgdmFyIHN1c3BlbnNlU3RhdGUgPSB3b3JrSW5Qcm9ncmVzcy5tZW1vaXplZFN0YXRlOwoKICAgICAgICAgIGlmIChzdXNwZW5zZVN0YXRlICE9PSBudWxsICYmIHN1c3BlbnNlU3RhdGUuZGVoeWRyYXRlZCAhPT0gbnVsbCkgewogICAgICAgICAgICBpZiAod29ya0luUHJvZ3Jlc3MuYWx0ZXJuYXRlID09PSBudWxsKSB7CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaHJldyBpbiBuZXdseSBtb3VudGVkIGRlaHlkcmF0ZWQgY29tcG9uZW50LiBUaGlzIGlzIGxpa2VseSBhIGJ1ZyBpbiAnICsgJ1JlYWN0LiBQbGVhc2UgZmlsZSBhbiBpc3N1ZS4nKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmVzZXRIeWRyYXRpb25TdGF0ZSgpOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciBfZmxhZ3MyID0gd29ya0luUHJvZ3Jlc3MuZmxhZ3M7CgogICAgICAgICAgaWYgKF9mbGFnczIgJiBTaG91bGRDYXB0dXJlKSB7CiAgICAgICAgICAgIHdvcmtJblByb2dyZXNzLmZsYWdzID0gX2ZsYWdzMiAmIH5TaG91bGRDYXB0dXJlIHwgRGlkQ2FwdHVyZTsgLy8gQ2FwdHVyZWQgYSBzdXNwZW5zZSBlZmZlY3QuIFJlLXJlbmRlciB0aGUgYm91bmRhcnkuCgogICAgICAgICAgICBpZiAoICh3b3JrSW5Qcm9ncmVzcy5tb2RlICYgUHJvZmlsZU1vZGUpICE9PSBOb01vZGUpIHsKICAgICAgICAgICAgICB0cmFuc2ZlckFjdHVhbER1cmF0aW9uKHdvcmtJblByb2dyZXNzKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIHdvcmtJblByb2dyZXNzOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KCiAgICAgIGNhc2UgU3VzcGVuc2VMaXN0Q29tcG9uZW50OgogICAgICAgIHsKICAgICAgICAgIHBvcFN1c3BlbnNlQ29udGV4dCh3b3JrSW5Qcm9ncmVzcyk7IC8vIFN1c3BlbnNlTGlzdCBkb2Vzbid0IGFjdHVhbGx5IGNhdGNoIGFueXRoaW5nLiBJdCBzaG91bGQndmUgYmVlbgogICAgICAgICAgLy8gY2F1Z2h0IGJ5IGEgbmVzdGVkIGJvdW5kYXJ5LiBJZiBub3QsIGl0IHNob3VsZCBidWJibGUgdGhyb3VnaC4KCiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CgogICAgICBjYXNlIEhvc3RQb3J0YWw6CiAgICAgICAgcG9wSG9zdENvbnRhaW5lcih3b3JrSW5Qcm9ncmVzcyk7CiAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICBjYXNlIENvbnRleHRQcm92aWRlcjoKICAgICAgICB2YXIgY29udGV4dCA9IHdvcmtJblByb2dyZXNzLnR5cGUuX2NvbnRleHQ7CiAgICAgICAgcG9wUHJvdmlkZXIoY29udGV4dCwgd29ya0luUHJvZ3Jlc3MpOwogICAgICAgIHJldHVybiBudWxsOwoKICAgICAgY2FzZSBPZmZzY3JlZW5Db21wb25lbnQ6CiAgICAgIGNhc2UgTGVnYWN5SGlkZGVuQ29tcG9uZW50OgogICAgICAgIHBvcFJlbmRlckxhbmVzKHdvcmtJblByb2dyZXNzKTsKICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgIGNhc2UgQ2FjaGVDb21wb25lbnQ6CgogICAgICAgIHJldHVybiBudWxsOwoKICAgICAgZGVmYXVsdDoKICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHVud2luZEludGVycnVwdGVkV29yayhjdXJyZW50LCBpbnRlcnJ1cHRlZFdvcmssIHJlbmRlckxhbmVzKSB7CiAgICAvLyBOb3RlOiBUaGlzIGludGVudGlvbmFsbHkgZG9lc24ndCBjaGVjayBpZiB3ZSdyZSBoeWRyYXRpbmcgYmVjYXVzZSBjb21wYXJpbmcKICAgIC8vIHRvIHRoZSBjdXJyZW50IHRyZWUgcHJvdmlkZXIgZmliZXIgaXMganVzdCBhcyBmYXN0IGFuZCBsZXNzIGVycm9yLXByb25lLgogICAgLy8gSWRlYWxseSB3ZSB3b3VsZCBoYXZlIGEgc3BlY2lhbCB2ZXJzaW9uIG9mIHRoZSB3b3JrIGxvb3Agb25seQogICAgLy8gZm9yIGh5ZHJhdGlvbi4KICAgIHBvcFRyZWVDb250ZXh0KGludGVycnVwdGVkV29yayk7CgogICAgc3dpdGNoIChpbnRlcnJ1cHRlZFdvcmsudGFnKSB7CiAgICAgIGNhc2UgQ2xhc3NDb21wb25lbnQ6CiAgICAgICAgewogICAgICAgICAgdmFyIGNoaWxkQ29udGV4dFR5cGVzID0gaW50ZXJydXB0ZWRXb3JrLnR5cGUuY2hpbGRDb250ZXh0VHlwZXM7CgogICAgICAgICAgaWYgKGNoaWxkQ29udGV4dFR5cGVzICE9PSBudWxsICYmIGNoaWxkQ29udGV4dFR5cGVzICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgcG9wQ29udGV4dChpbnRlcnJ1cHRlZFdvcmspOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgIGNhc2UgSG9zdFJvb3Q6CiAgICAgICAgewogICAgICAgICAgdmFyIHJvb3QgPSBpbnRlcnJ1cHRlZFdvcmsuc3RhdGVOb2RlOwogICAgICAgICAgcG9wSG9zdENvbnRhaW5lcihpbnRlcnJ1cHRlZFdvcmspOwogICAgICAgICAgcG9wVG9wTGV2ZWxDb250ZXh0T2JqZWN0KGludGVycnVwdGVkV29yayk7CiAgICAgICAgICByZXNldFdvcmtJblByb2dyZXNzVmVyc2lvbnMoKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgIGNhc2UgSG9zdENvbXBvbmVudDoKICAgICAgICB7CiAgICAgICAgICBwb3BIb3N0Q29udGV4dChpbnRlcnJ1cHRlZFdvcmspOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgY2FzZSBIb3N0UG9ydGFsOgogICAgICAgIHBvcEhvc3RDb250YWluZXIoaW50ZXJydXB0ZWRXb3JrKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgU3VzcGVuc2VDb21wb25lbnQ6CiAgICAgICAgcG9wU3VzcGVuc2VDb250ZXh0KGludGVycnVwdGVkV29yayk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIFN1c3BlbnNlTGlzdENvbXBvbmVudDoKICAgICAgICBwb3BTdXNwZW5zZUNvbnRleHQoaW50ZXJydXB0ZWRXb3JrKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgQ29udGV4dFByb3ZpZGVyOgogICAgICAgIHZhciBjb250ZXh0ID0gaW50ZXJydXB0ZWRXb3JrLnR5cGUuX2NvbnRleHQ7CiAgICAgICAgcG9wUHJvdmlkZXIoY29udGV4dCwgaW50ZXJydXB0ZWRXb3JrKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgT2Zmc2NyZWVuQ29tcG9uZW50OgogICAgICBjYXNlIExlZ2FjeUhpZGRlbkNvbXBvbmVudDoKICAgICAgICBwb3BSZW5kZXJMYW5lcyhpbnRlcnJ1cHRlZFdvcmspOwogICAgICAgIGJyZWFrOwogICAgfQogIH0KCiAgdmFyIGRpZFdhcm5BYm91dFVuZGVmaW5lZFNuYXBzaG90QmVmb3JlVXBkYXRlID0gbnVsbDsKCiAgewogICAgZGlkV2FybkFib3V0VW5kZWZpbmVkU25hcHNob3RCZWZvcmVVcGRhdGUgPSBuZXcgU2V0KCk7CiAgfSAvLyBVc2VkIGR1cmluZyB0aGUgY29tbWl0IHBoYXNlIHRvIHRyYWNrIHRoZSBzdGF0ZSBvZiB0aGUgT2Zmc2NyZWVuIGNvbXBvbmVudCBzdGFjay4KICAvLyBBbGxvd3MgdXMgdG8gYXZvaWQgdHJhdmVyc2luZyB0aGUgcmV0dXJuIHBhdGggdG8gZmluZCB0aGUgbmVhcmVzdCBPZmZzY3JlZW4gYW5jZXN0b3IuCiAgLy8gT25seSB1c2VkIHdoZW4gZW5hYmxlU3VzcGVuc2VMYXlvdXRFZmZlY3RTZW1hbnRpY3MgaXMgZW5hYmxlZC4KCgogIHZhciBvZmZzY3JlZW5TdWJ0cmVlSXNIaWRkZW4gPSBmYWxzZTsKICB2YXIgb2Zmc2NyZWVuU3VidHJlZVdhc0hpZGRlbiA9IGZhbHNlOwogIHZhciBQb3NzaWJseVdlYWtTZXQgPSB0eXBlb2YgV2Vha1NldCA9PT0gJ2Z1bmN0aW9uJyA/IFdlYWtTZXQgOiBTZXQ7CiAgdmFyIG5leHRFZmZlY3QgPSBudWxsOyAvLyBVc2VkIGZvciBQcm9maWxpbmcgYnVpbGRzIHRvIHRyYWNrIHVwZGF0ZXJzLgoKICB2YXIgaW5Qcm9ncmVzc0xhbmVzID0gbnVsbDsKICB2YXIgaW5Qcm9ncmVzc1Jvb3QgPSBudWxsOwogIGZ1bmN0aW9uIHJlcG9ydFVuY2F1Z2h0RXJyb3JJbkRFVihlcnJvcikgewogICAgLy8gV3JhcHBpbmcgZWFjaCBzbWFsbCBwYXJ0IG9mIHRoZSBjb21taXQgcGhhc2UgaW50byBhIGd1YXJkZWQKICAgIC8vIGNhbGxiYWNrIGlzIGEgYml0IHRvbyBzbG93IChodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2svcmVhY3QvcHVsbC8yMTY2NikuCiAgICAvLyBCdXQgd2UgcmVseSBvbiBpdCB0byBzdXJmYWNlIGVycm9ycyB0byBERVYgdG9vbHMgbGlrZSBvdmVybGF5cwogICAgLy8gKGh0dHBzOi8vZ2l0aHViLmNvbS9mYWNlYm9vay9yZWFjdC9pc3N1ZXMvMjE3MTIpLgogICAgLy8gQXMgYSBjb21wcm9taXNlLCByZXRocm93IG9ubHkgY2F1Z2h0IGVycm9ycyBpbiBhIGd1YXJkLgogICAgewogICAgICBpbnZva2VHdWFyZGVkQ2FsbGJhY2sobnVsbCwgZnVuY3Rpb24gKCkgewogICAgICAgIHRocm93IGVycm9yOwogICAgICB9KTsKICAgICAgY2xlYXJDYXVnaHRFcnJvcigpOwogICAgfQogIH0KCiAgdmFyIGNhbGxDb21wb25lbnRXaWxsVW5tb3VudFdpdGhUaW1lciA9IGZ1bmN0aW9uIChjdXJyZW50LCBpbnN0YW5jZSkgewogICAgaW5zdGFuY2UucHJvcHMgPSBjdXJyZW50Lm1lbW9pemVkUHJvcHM7CiAgICBpbnN0YW5jZS5zdGF0ZSA9IGN1cnJlbnQubWVtb2l6ZWRTdGF0ZTsKCiAgICBpZiAoIGN1cnJlbnQubW9kZSAmIFByb2ZpbGVNb2RlKSB7CiAgICAgIHRyeSB7CiAgICAgICAgc3RhcnRMYXlvdXRFZmZlY3RUaW1lcigpOwogICAgICAgIGluc3RhbmNlLmNvbXBvbmVudFdpbGxVbm1vdW50KCk7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgcmVjb3JkTGF5b3V0RWZmZWN0RHVyYXRpb24oY3VycmVudCk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGluc3RhbmNlLmNvbXBvbmVudFdpbGxVbm1vdW50KCk7CiAgICB9CiAgfTsgLy8gQ2FwdHVyZSBlcnJvcnMgc28gdGhleSBkb24ndCBpbnRlcnJ1cHQgbW91bnRpbmcuCgoKICBmdW5jdGlvbiBzYWZlbHlDYWxsQ29tbWl0SG9va0xheW91dEVmZmVjdExpc3RNb3VudChjdXJyZW50LCBuZWFyZXN0TW91bnRlZEFuY2VzdG9yKSB7CiAgICB0cnkgewogICAgICBjb21taXRIb29rRWZmZWN0TGlzdE1vdW50KExheW91dCwgY3VycmVudCk7CiAgICB9IGNhdGNoIChlcnJvcikgewogICAgICBjYXB0dXJlQ29tbWl0UGhhc2VFcnJvcihjdXJyZW50LCBuZWFyZXN0TW91bnRlZEFuY2VzdG9yLCBlcnJvcik7CiAgICB9CiAgfSAvLyBDYXB0dXJlIGVycm9ycyBzbyB0aGV5IGRvbid0IGludGVycnVwdCB1bm1vdW50aW5nLgoKCiAgZnVuY3Rpb24gc2FmZWx5Q2FsbENvbXBvbmVudFdpbGxVbm1vdW50KGN1cnJlbnQsIG5lYXJlc3RNb3VudGVkQW5jZXN0b3IsIGluc3RhbmNlKSB7CiAgICB0cnkgewogICAgICBjYWxsQ29tcG9uZW50V2lsbFVubW91bnRXaXRoVGltZXIoY3VycmVudCwgaW5zdGFuY2UpOwogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgY2FwdHVyZUNvbW1pdFBoYXNlRXJyb3IoY3VycmVudCwgbmVhcmVzdE1vdW50ZWRBbmNlc3RvciwgZXJyb3IpOwogICAgfQogIH0gLy8gQ2FwdHVyZSBlcnJvcnMgc28gdGhleSBkb24ndCBpbnRlcnJ1cHQgbW91bnRpbmcuCgoKICBmdW5jdGlvbiBzYWZlbHlDYWxsQ29tcG9uZW50RGlkTW91bnQoY3VycmVudCwgbmVhcmVzdE1vdW50ZWRBbmNlc3RvciwgaW5zdGFuY2UpIHsKICAgIHRyeSB7CiAgICAgIGluc3RhbmNlLmNvbXBvbmVudERpZE1vdW50KCk7CiAgICB9IGNhdGNoIChlcnJvcikgewogICAgICBjYXB0dXJlQ29tbWl0UGhhc2VFcnJvcihjdXJyZW50LCBuZWFyZXN0TW91bnRlZEFuY2VzdG9yLCBlcnJvcik7CiAgICB9CiAgfSAvLyBDYXB0dXJlIGVycm9ycyBzbyB0aGV5IGRvbid0IGludGVycnVwdCBtb3VudGluZy4KCgogIGZ1bmN0aW9uIHNhZmVseUF0dGFjaFJlZihjdXJyZW50LCBuZWFyZXN0TW91bnRlZEFuY2VzdG9yKSB7CiAgICB0cnkgewogICAgICBjb21taXRBdHRhY2hSZWYoY3VycmVudCk7CiAgICB9IGNhdGNoIChlcnJvcikgewogICAgICBjYXB0dXJlQ29tbWl0UGhhc2VFcnJvcihjdXJyZW50LCBuZWFyZXN0TW91bnRlZEFuY2VzdG9yLCBlcnJvcik7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBzYWZlbHlEZXRhY2hSZWYoY3VycmVudCwgbmVhcmVzdE1vdW50ZWRBbmNlc3RvcikgewogICAgdmFyIHJlZiA9IGN1cnJlbnQucmVmOwoKICAgIGlmIChyZWYgIT09IG51bGwpIHsKICAgICAgaWYgKHR5cGVvZiByZWYgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICB2YXIgcmV0VmFsOwoKICAgICAgICB0cnkgewogICAgICAgICAgaWYgKGVuYWJsZVByb2ZpbGVyVGltZXIgJiYgZW5hYmxlUHJvZmlsZXJDb21taXRIb29rcyAmJiBjdXJyZW50Lm1vZGUgJiBQcm9maWxlTW9kZSkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIHN0YXJ0TGF5b3V0RWZmZWN0VGltZXIoKTsKICAgICAgICAgICAgICByZXRWYWwgPSByZWYobnVsbCk7CiAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgcmVjb3JkTGF5b3V0RWZmZWN0RHVyYXRpb24oY3VycmVudCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldFZhbCA9IHJlZihudWxsKTsKICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgY2FwdHVyZUNvbW1pdFBoYXNlRXJyb3IoY3VycmVudCwgbmVhcmVzdE1vdW50ZWRBbmNlc3RvciwgZXJyb3IpOwogICAgICAgIH0KCiAgICAgICAgewogICAgICAgICAgaWYgKHR5cGVvZiByZXRWYWwgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgICAgZXJyb3IoJ1VuZXhwZWN0ZWQgcmV0dXJuIHZhbHVlIGZyb20gYSBjYWxsYmFjayByZWYgaW4gJXMuICcgKyAnQSBjYWxsYmFjayByZWYgc2hvdWxkIG5vdCByZXR1cm4gYSBmdW5jdGlvbi4nLCBnZXRDb21wb25lbnROYW1lRnJvbUZpYmVyKGN1cnJlbnQpKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmVmLmN1cnJlbnQgPSBudWxsOwogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiBzYWZlbHlDYWxsRGVzdHJveShjdXJyZW50LCBuZWFyZXN0TW91bnRlZEFuY2VzdG9yLCBkZXN0cm95KSB7CiAgICB0cnkgewogICAgICBkZXN0cm95KCk7CiAgICB9IGNhdGNoIChlcnJvcikgewogICAgICBjYXB0dXJlQ29tbWl0UGhhc2VFcnJvcihjdXJyZW50LCBuZWFyZXN0TW91bnRlZEFuY2VzdG9yLCBlcnJvcik7CiAgICB9CiAgfQoKICB2YXIgZm9jdXNlZEluc3RhbmNlSGFuZGxlID0gbnVsbDsKICB2YXIgc2hvdWxkRmlyZUFmdGVyQWN0aXZlSW5zdGFuY2VCbHVyID0gZmFsc2U7CiAgZnVuY3Rpb24gY29tbWl0QmVmb3JlTXV0YXRpb25FZmZlY3RzKHJvb3QsIGZpcnN0Q2hpbGQpIHsKICAgIGZvY3VzZWRJbnN0YW5jZUhhbmRsZSA9IHByZXBhcmVGb3JDb21taXQocm9vdC5jb250YWluZXJJbmZvKTsKICAgIG5leHRFZmZlY3QgPSBmaXJzdENoaWxkOwogICAgY29tbWl0QmVmb3JlTXV0YXRpb25FZmZlY3RzX2JlZ2luKCk7IC8vIFdlIG5vIGxvbmdlciBuZWVkIHRvIHRyYWNrIHRoZSBhY3RpdmUgaW5zdGFuY2UgZmliZXIKCiAgICB2YXIgc2hvdWxkRmlyZSA9IHNob3VsZEZpcmVBZnRlckFjdGl2ZUluc3RhbmNlQmx1cjsKICAgIHNob3VsZEZpcmVBZnRlckFjdGl2ZUluc3RhbmNlQmx1ciA9IGZhbHNlOwogICAgZm9jdXNlZEluc3RhbmNlSGFuZGxlID0gbnVsbDsKICAgIHJldHVybiBzaG91bGRGaXJlOwogIH0KCiAgZnVuY3Rpb24gY29tbWl0QmVmb3JlTXV0YXRpb25FZmZlY3RzX2JlZ2luKCkgewogICAgd2hpbGUgKG5leHRFZmZlY3QgIT09IG51bGwpIHsKICAgICAgdmFyIGZpYmVyID0gbmV4dEVmZmVjdDsgLy8gVGhpcyBwaGFzZSBpcyBvbmx5IHVzZWQgZm9yIGJlZm9yZUFjdGl2ZUluc3RhbmNlQmx1ci4KCiAgICAgIHZhciBjaGlsZCA9IGZpYmVyLmNoaWxkOwoKICAgICAgaWYgKChmaWJlci5zdWJ0cmVlRmxhZ3MgJiBCZWZvcmVNdXRhdGlvbk1hc2spICE9PSBOb0ZsYWdzICYmIGNoaWxkICE9PSBudWxsKSB7CiAgICAgICAgY2hpbGQucmV0dXJuID0gZmliZXI7CiAgICAgICAgbmV4dEVmZmVjdCA9IGNoaWxkOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbW1pdEJlZm9yZU11dGF0aW9uRWZmZWN0c19jb21wbGV0ZSgpOwogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiBjb21taXRCZWZvcmVNdXRhdGlvbkVmZmVjdHNfY29tcGxldGUoKSB7CiAgICB3aGlsZSAobmV4dEVmZmVjdCAhPT0gbnVsbCkgewogICAgICB2YXIgZmliZXIgPSBuZXh0RWZmZWN0OwogICAgICBzZXRDdXJyZW50RmliZXIoZmliZXIpOwoKICAgICAgdHJ5IHsKICAgICAgICBjb21taXRCZWZvcmVNdXRhdGlvbkVmZmVjdHNPbkZpYmVyKGZpYmVyKTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjYXB0dXJlQ29tbWl0UGhhc2VFcnJvcihmaWJlciwgZmliZXIucmV0dXJuLCBlcnJvcik7CiAgICAgIH0KCiAgICAgIHJlc2V0Q3VycmVudEZpYmVyKCk7CiAgICAgIHZhciBzaWJsaW5nID0gZmliZXIuc2libGluZzsKCiAgICAgIGlmIChzaWJsaW5nICE9PSBudWxsKSB7CiAgICAgICAgc2libGluZy5yZXR1cm4gPSBmaWJlci5yZXR1cm47CiAgICAgICAgbmV4dEVmZmVjdCA9IHNpYmxpbmc7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBuZXh0RWZmZWN0ID0gZmliZXIucmV0dXJuOwogICAgfQogIH0KCiAgZnVuY3Rpb24gY29tbWl0QmVmb3JlTXV0YXRpb25FZmZlY3RzT25GaWJlcihmaW5pc2hlZFdvcmspIHsKICAgIHZhciBjdXJyZW50ID0gZmluaXNoZWRXb3JrLmFsdGVybmF0ZTsKICAgIHZhciBmbGFncyA9IGZpbmlzaGVkV29yay5mbGFnczsKCiAgICBpZiAoKGZsYWdzICYgU25hcHNob3QpICE9PSBOb0ZsYWdzKSB7CiAgICAgIHNldEN1cnJlbnRGaWJlcihmaW5pc2hlZFdvcmspOwoKICAgICAgc3dpdGNoIChmaW5pc2hlZFdvcmsudGFnKSB7CiAgICAgICAgY2FzZSBGdW5jdGlvbkNvbXBvbmVudDoKICAgICAgICBjYXNlIEZvcndhcmRSZWY6CiAgICAgICAgY2FzZSBTaW1wbGVNZW1vQ29tcG9uZW50OgogICAgICAgICAgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgY2FzZSBDbGFzc0NvbXBvbmVudDoKICAgICAgICAgIHsKICAgICAgICAgICAgaWYgKGN1cnJlbnQgIT09IG51bGwpIHsKICAgICAgICAgICAgICB2YXIgcHJldlByb3BzID0gY3VycmVudC5tZW1vaXplZFByb3BzOwogICAgICAgICAgICAgIHZhciBwcmV2U3RhdGUgPSBjdXJyZW50Lm1lbW9pemVkU3RhdGU7CiAgICAgICAgICAgICAgdmFyIGluc3RhbmNlID0gZmluaXNoZWRXb3JrLnN0YXRlTm9kZTsgLy8gV2UgY291bGQgdXBkYXRlIGluc3RhbmNlIHByb3BzIGFuZCBzdGF0ZSBoZXJlLAogICAgICAgICAgICAgIC8vIGJ1dCBpbnN0ZWFkIHdlIHJlbHkgb24gdGhlbSBiZWluZyBzZXQgZHVyaW5nIGxhc3QgcmVuZGVyLgogICAgICAgICAgICAgIC8vIFRPRE86IHJldmlzaXQgdGhpcyB3aGVuIHdlIGltcGxlbWVudCByZXN1bWluZy4KCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaWYgKGZpbmlzaGVkV29yay50eXBlID09PSBmaW5pc2hlZFdvcmsuZWxlbWVudFR5cGUgJiYgIWRpZFdhcm5BYm91dFJlYXNzaWduaW5nUHJvcHMpIHsKICAgICAgICAgICAgICAgICAgaWYgKGluc3RhbmNlLnByb3BzICE9PSBmaW5pc2hlZFdvcmsubWVtb2l6ZWRQcm9wcykgewogICAgICAgICAgICAgICAgICAgIGVycm9yKCdFeHBlY3RlZCAlcyBwcm9wcyB0byBtYXRjaCBtZW1vaXplZCBwcm9wcyBiZWZvcmUgJyArICdnZXRTbmFwc2hvdEJlZm9yZVVwZGF0ZS4gJyArICdUaGlzIG1pZ2h0IGVpdGhlciBiZSBiZWNhdXNlIG9mIGEgYnVnIGluIFJlYWN0LCBvciBiZWNhdXNlICcgKyAnYSBjb21wb25lbnQgcmVhc3NpZ25zIGl0cyBvd24gYHRoaXMucHJvcHNgLiAnICsgJ1BsZWFzZSBmaWxlIGFuIGlzc3VlLicsIGdldENvbXBvbmVudE5hbWVGcm9tRmliZXIoZmluaXNoZWRXb3JrKSB8fCAnaW5zdGFuY2UnKTsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgaWYgKGluc3RhbmNlLnN0YXRlICE9PSBmaW5pc2hlZFdvcmsubWVtb2l6ZWRTdGF0ZSkgewogICAgICAgICAgICAgICAgICAgIGVycm9yKCdFeHBlY3RlZCAlcyBzdGF0ZSB0byBtYXRjaCBtZW1vaXplZCBzdGF0ZSBiZWZvcmUgJyArICdnZXRTbmFwc2hvdEJlZm9yZVVwZGF0ZS4gJyArICdUaGlzIG1pZ2h0IGVpdGhlciBiZSBiZWNhdXNlIG9mIGEgYnVnIGluIFJlYWN0LCBvciBiZWNhdXNlICcgKyAnYSBjb21wb25lbnQgcmVhc3NpZ25zIGl0cyBvd24gYHRoaXMuc3RhdGVgLiAnICsgJ1BsZWFzZSBmaWxlIGFuIGlzc3VlLicsIGdldENvbXBvbmVudE5hbWVGcm9tRmliZXIoZmluaXNoZWRXb3JrKSB8fCAnaW5zdGFuY2UnKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdmFyIHNuYXBzaG90ID0gaW5zdGFuY2UuZ2V0U25hcHNob3RCZWZvcmVVcGRhdGUoZmluaXNoZWRXb3JrLmVsZW1lbnRUeXBlID09PSBmaW5pc2hlZFdvcmsudHlwZSA/IHByZXZQcm9wcyA6IHJlc29sdmVEZWZhdWx0UHJvcHMoZmluaXNoZWRXb3JrLnR5cGUsIHByZXZQcm9wcyksIHByZXZTdGF0ZSk7CgogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBkaWRXYXJuU2V0ID0gZGlkV2FybkFib3V0VW5kZWZpbmVkU25hcHNob3RCZWZvcmVVcGRhdGU7CgogICAgICAgICAgICAgICAgaWYgKHNuYXBzaG90ID09PSB1bmRlZmluZWQgJiYgIWRpZFdhcm5TZXQuaGFzKGZpbmlzaGVkV29yay50eXBlKSkgewogICAgICAgICAgICAgICAgICBkaWRXYXJuU2V0LmFkZChmaW5pc2hlZFdvcmsudHlwZSk7CgogICAgICAgICAgICAgICAgICBlcnJvcignJXMuZ2V0U25hcHNob3RCZWZvcmVVcGRhdGUoKTogQSBzbmFwc2hvdCB2YWx1ZSAob3IgbnVsbCkgJyArICdtdXN0IGJlIHJldHVybmVkLiBZb3UgaGF2ZSByZXR1cm5lZCB1bmRlZmluZWQuJywgZ2V0Q29tcG9uZW50TmFtZUZyb21GaWJlcihmaW5pc2hlZFdvcmspKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGluc3RhbmNlLl9fcmVhY3RJbnRlcm5hbFNuYXBzaG90QmVmb3JlVXBkYXRlID0gc25hcHNob3Q7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICBjYXNlIEhvc3RSb290OgogICAgICAgICAgewogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdmFyIHJvb3QgPSBmaW5pc2hlZFdvcmsuc3RhdGVOb2RlOwogICAgICAgICAgICAgIGNsZWFyQ29udGFpbmVyKHJvb3QuY29udGFpbmVySW5mbyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICBjYXNlIEhvc3RDb21wb25lbnQ6CiAgICAgICAgY2FzZSBIb3N0VGV4dDoKICAgICAgICBjYXNlIEhvc3RQb3J0YWw6CiAgICAgICAgY2FzZSBJbmNvbXBsZXRlQ2xhc3NDb21wb25lbnQ6CiAgICAgICAgICAvLyBOb3RoaW5nIHRvIGRvIGZvciB0aGVzZSBjb21wb25lbnQgdHlwZXMKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgewogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoaXMgdW5pdCBvZiB3b3JrIHRhZyBzaG91bGQgbm90IGhhdmUgc2lkZS1lZmZlY3RzLiBUaGlzIGVycm9yIGlzICcgKyAnbGlrZWx5IGNhdXNlZCBieSBhIGJ1ZyBpbiBSZWFjdC4gUGxlYXNlIGZpbGUgYW4gaXNzdWUuJyk7CiAgICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJlc2V0Q3VycmVudEZpYmVyKCk7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBjb21taXRIb29rRWZmZWN0TGlzdFVubW91bnQoZmxhZ3MsIGZpbmlzaGVkV29yaywgbmVhcmVzdE1vdW50ZWRBbmNlc3RvcikgewogICAgdmFyIHVwZGF0ZVF1ZXVlID0gZmluaXNoZWRXb3JrLnVwZGF0ZVF1ZXVlOwogICAgdmFyIGxhc3RFZmZlY3QgPSB1cGRhdGVRdWV1ZSAhPT0gbnVsbCA/IHVwZGF0ZVF1ZXVlLmxhc3RFZmZlY3QgOiBudWxsOwoKICAgIGlmIChsYXN0RWZmZWN0ICE9PSBudWxsKSB7CiAgICAgIHZhciBmaXJzdEVmZmVjdCA9IGxhc3RFZmZlY3QubmV4dDsKICAgICAgdmFyIGVmZmVjdCA9IGZpcnN0RWZmZWN0OwoKICAgICAgZG8gewogICAgICAgIGlmICgoZWZmZWN0LnRhZyAmIGZsYWdzKSA9PT0gZmxhZ3MpIHsKICAgICAgICAgIC8vIFVubW91bnQKICAgICAgICAgIHZhciBkZXN0cm95ID0gZWZmZWN0LmRlc3Ryb3k7CiAgICAgICAgICBlZmZlY3QuZGVzdHJveSA9IHVuZGVmaW5lZDsKCiAgICAgICAgICBpZiAoZGVzdHJveSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpZiAoKGZsYWdzICYgUGFzc2l2ZSQxKSAhPT0gTm9GbGFncyQxKSB7CiAgICAgICAgICAgICAgICBtYXJrQ29tcG9uZW50UGFzc2l2ZUVmZmVjdFVubW91bnRTdGFydGVkKGZpbmlzaGVkV29yayk7CiAgICAgICAgICAgICAgfSBlbHNlIGlmICgoZmxhZ3MgJiBMYXlvdXQpICE9PSBOb0ZsYWdzJDEpIHsKICAgICAgICAgICAgICAgIG1hcmtDb21wb25lbnRMYXlvdXRFZmZlY3RVbm1vdW50U3RhcnRlZChmaW5pc2hlZFdvcmspOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgewogICAgICAgICAgICAgIGlmICgoZmxhZ3MgJiBJbnNlcnRpb24pICE9PSBOb0ZsYWdzJDEpIHsKICAgICAgICAgICAgICAgIHNldElzUnVubmluZ0luc2VydGlvbkVmZmVjdCh0cnVlKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHNhZmVseUNhbGxEZXN0cm95KGZpbmlzaGVkV29yaywgbmVhcmVzdE1vdW50ZWRBbmNlc3RvciwgZGVzdHJveSk7CgogICAgICAgICAgICB7CiAgICAgICAgICAgICAgaWYgKChmbGFncyAmIEluc2VydGlvbikgIT09IE5vRmxhZ3MkMSkgewogICAgICAgICAgICAgICAgc2V0SXNSdW5uaW5nSW5zZXJ0aW9uRWZmZWN0KGZhbHNlKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpZiAoKGZsYWdzICYgUGFzc2l2ZSQxKSAhPT0gTm9GbGFncyQxKSB7CiAgICAgICAgICAgICAgICBtYXJrQ29tcG9uZW50UGFzc2l2ZUVmZmVjdFVubW91bnRTdG9wcGVkKCk7CiAgICAgICAgICAgICAgfSBlbHNlIGlmICgoZmxhZ3MgJiBMYXlvdXQpICE9PSBOb0ZsYWdzJDEpIHsKICAgICAgICAgICAgICAgIG1hcmtDb21wb25lbnRMYXlvdXRFZmZlY3RVbm1vdW50U3RvcHBlZCgpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZWZmZWN0ID0gZWZmZWN0Lm5leHQ7CiAgICAgIH0gd2hpbGUgKGVmZmVjdCAhPT0gZmlyc3RFZmZlY3QpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gY29tbWl0SG9va0VmZmVjdExpc3RNb3VudChmbGFncywgZmluaXNoZWRXb3JrKSB7CiAgICB2YXIgdXBkYXRlUXVldWUgPSBmaW5pc2hlZFdvcmsudXBkYXRlUXVldWU7CiAgICB2YXIgbGFzdEVmZmVjdCA9IHVwZGF0ZVF1ZXVlICE9PSBudWxsID8gdXBkYXRlUXVldWUubGFzdEVmZmVjdCA6IG51bGw7CgogICAgaWYgKGxhc3RFZmZlY3QgIT09IG51bGwpIHsKICAgICAgdmFyIGZpcnN0RWZmZWN0ID0gbGFzdEVmZmVjdC5uZXh0OwogICAgICB2YXIgZWZmZWN0ID0gZmlyc3RFZmZlY3Q7CgogICAgICBkbyB7CiAgICAgICAgaWYgKChlZmZlY3QudGFnICYgZmxhZ3MpID09PSBmbGFncykgewogICAgICAgICAgewogICAgICAgICAgICBpZiAoKGZsYWdzICYgUGFzc2l2ZSQxKSAhPT0gTm9GbGFncyQxKSB7CiAgICAgICAgICAgICAgbWFya0NvbXBvbmVudFBhc3NpdmVFZmZlY3RNb3VudFN0YXJ0ZWQoZmluaXNoZWRXb3JrKTsKICAgICAgICAgICAgfSBlbHNlIGlmICgoZmxhZ3MgJiBMYXlvdXQpICE9PSBOb0ZsYWdzJDEpIHsKICAgICAgICAgICAgICBtYXJrQ29tcG9uZW50TGF5b3V0RWZmZWN0TW91bnRTdGFydGVkKGZpbmlzaGVkV29yayk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gLy8gTW91bnQKCgogICAgICAgICAgdmFyIGNyZWF0ZSA9IGVmZmVjdC5jcmVhdGU7CgogICAgICAgICAgewogICAgICAgICAgICBpZiAoKGZsYWdzICYgSW5zZXJ0aW9uKSAhPT0gTm9GbGFncyQxKSB7CiAgICAgICAgICAgICAgc2V0SXNSdW5uaW5nSW5zZXJ0aW9uRWZmZWN0KHRydWUpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgZWZmZWN0LmRlc3Ryb3kgPSBjcmVhdGUoKTsKCiAgICAgICAgICB7CiAgICAgICAgICAgIGlmICgoZmxhZ3MgJiBJbnNlcnRpb24pICE9PSBOb0ZsYWdzJDEpIHsKICAgICAgICAgICAgICBzZXRJc1J1bm5pbmdJbnNlcnRpb25FZmZlY3QoZmFsc2UpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgewogICAgICAgICAgICBpZiAoKGZsYWdzICYgUGFzc2l2ZSQxKSAhPT0gTm9GbGFncyQxKSB7CiAgICAgICAgICAgICAgbWFya0NvbXBvbmVudFBhc3NpdmVFZmZlY3RNb3VudFN0b3BwZWQoKTsKICAgICAgICAgICAgfSBlbHNlIGlmICgoZmxhZ3MgJiBMYXlvdXQpICE9PSBOb0ZsYWdzJDEpIHsKICAgICAgICAgICAgICBtYXJrQ29tcG9uZW50TGF5b3V0RWZmZWN0TW91bnRTdG9wcGVkKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICB7CiAgICAgICAgICAgIHZhciBkZXN0cm95ID0gZWZmZWN0LmRlc3Ryb3k7CgogICAgICAgICAgICBpZiAoZGVzdHJveSAhPT0gdW5kZWZpbmVkICYmIHR5cGVvZiBkZXN0cm95ICE9PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAgICAgdmFyIGhvb2tOYW1lID0gdm9pZCAwOwoKICAgICAgICAgICAgICBpZiAoKGVmZmVjdC50YWcgJiBMYXlvdXQpICE9PSBOb0ZsYWdzKSB7CiAgICAgICAgICAgICAgICBob29rTmFtZSA9ICd1c2VMYXlvdXRFZmZlY3QnOwogICAgICAgICAgICAgIH0gZWxzZSBpZiAoKGVmZmVjdC50YWcgJiBJbnNlcnRpb24pICE9PSBOb0ZsYWdzKSB7CiAgICAgICAgICAgICAgICBob29rTmFtZSA9ICd1c2VJbnNlcnRpb25FZmZlY3QnOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBob29rTmFtZSA9ICd1c2VFZmZlY3QnOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdmFyIGFkZGVuZHVtID0gdm9pZCAwOwoKICAgICAgICAgICAgICBpZiAoZGVzdHJveSA9PT0gbnVsbCkgewogICAgICAgICAgICAgICAgYWRkZW5kdW0gPSAnIFlvdSByZXR1cm5lZCBudWxsLiBJZiB5b3VyIGVmZmVjdCBkb2VzIG5vdCByZXF1aXJlIGNsZWFuICcgKyAndXAsIHJldHVybiB1bmRlZmluZWQgKG9yIG5vdGhpbmcpLic7CiAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgZGVzdHJveS50aGVuID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAgICAgICBhZGRlbmR1bSA9ICdcblxuSXQgbG9va3MgbGlrZSB5b3Ugd3JvdGUgJyArIGhvb2tOYW1lICsgJyhhc3luYyAoKSA9PiAuLi4pIG9yIHJldHVybmVkIGEgUHJvbWlzZS4gJyArICdJbnN0ZWFkLCB3cml0ZSB0aGUgYXN5bmMgZnVuY3Rpb24gaW5zaWRlIHlvdXIgZWZmZWN0ICcgKyAnYW5kIGNhbGwgaXQgaW1tZWRpYXRlbHk6XG5cbicgKyBob29rTmFtZSArICcoKCkgPT4ge1xuJyArICcgIGFzeW5jIGZ1bmN0aW9uIGZldGNoRGF0YSgpIHtcbicgKyAnICAgIC8vIFlvdSBjYW4gYXdhaXQgaGVyZVxuJyArICcgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBNeUFQSS5nZXREYXRhKHNvbWVJZCk7XG4nICsgJyAgICAvLyAuLi5cbicgKyAnICB9XG4nICsgJyAgZmV0Y2hEYXRhKCk7XG4nICsgIn0sIFtzb21lSWRdKTsgLy8gT3IgW10gaWYgZWZmZWN0IGRvZXNuJ3QgbmVlZCBwcm9wcyBvciBzdGF0ZVxuXG4iICsgJ0xlYXJuIG1vcmUgYWJvdXQgZGF0YSBmZXRjaGluZyB3aXRoIEhvb2tzOiBodHRwczovL3JlYWN0anMub3JnL2xpbmsvaG9va3MtZGF0YS1mZXRjaGluZyc7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGFkZGVuZHVtID0gJyBZb3UgcmV0dXJuZWQ6ICcgKyBkZXN0cm95OwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgZXJyb3IoJyVzIG11c3Qgbm90IHJldHVybiBhbnl0aGluZyBiZXNpZGVzIGEgZnVuY3Rpb24sICcgKyAnd2hpY2ggaXMgdXNlZCBmb3IgY2xlYW4tdXAuJXMnLCBob29rTmFtZSwgYWRkZW5kdW0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBlZmZlY3QgPSBlZmZlY3QubmV4dDsKICAgICAgfSB3aGlsZSAoZWZmZWN0ICE9PSBmaXJzdEVmZmVjdCk7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBjb21taXRQYXNzaXZlRWZmZWN0RHVyYXRpb25zKGZpbmlzaGVkUm9vdCwgZmluaXNoZWRXb3JrKSB7CiAgICB7CiAgICAgIC8vIE9ubHkgUHJvZmlsZXJzIHdpdGggd29yayBpbiB0aGVpciBzdWJ0cmVlIHdpbGwgaGF2ZSBhbiBVcGRhdGUgZWZmZWN0IHNjaGVkdWxlZC4KICAgICAgaWYgKChmaW5pc2hlZFdvcmsuZmxhZ3MgJiBVcGRhdGUpICE9PSBOb0ZsYWdzKSB7CiAgICAgICAgc3dpdGNoIChmaW5pc2hlZFdvcmsudGFnKSB7CiAgICAgICAgICBjYXNlIFByb2ZpbGVyOgogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdmFyIHBhc3NpdmVFZmZlY3REdXJhdGlvbiA9IGZpbmlzaGVkV29yay5zdGF0ZU5vZGUucGFzc2l2ZUVmZmVjdER1cmF0aW9uOwogICAgICAgICAgICAgIHZhciBfZmluaXNoZWRXb3JrJG1lbW9pemUgPSBmaW5pc2hlZFdvcmsubWVtb2l6ZWRQcm9wcywKICAgICAgICAgICAgICAgICAgaWQgPSBfZmluaXNoZWRXb3JrJG1lbW9pemUuaWQsCiAgICAgICAgICAgICAgICAgIG9uUG9zdENvbW1pdCA9IF9maW5pc2hlZFdvcmskbWVtb2l6ZS5vblBvc3RDb21taXQ7IC8vIFRoaXMgdmFsdWUgd2lsbCBzdGlsbCByZWZsZWN0IHRoZSBwcmV2aW91cyBjb21taXQgcGhhc2UuCiAgICAgICAgICAgICAgLy8gSXQgZG9lcyBub3QgZ2V0IHJlc2V0IHVudGlsIHRoZSBzdGFydCBvZiB0aGUgbmV4dCBjb21taXQgcGhhc2UuCgogICAgICAgICAgICAgIHZhciBjb21taXRUaW1lID0gZ2V0Q29tbWl0VGltZSgpOwogICAgICAgICAgICAgIHZhciBwaGFzZSA9IGZpbmlzaGVkV29yay5hbHRlcm5hdGUgPT09IG51bGwgPyAnbW91bnQnIDogJ3VwZGF0ZSc7CgogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmIChpc0N1cnJlbnRVcGRhdGVOZXN0ZWQoKSkgewogICAgICAgICAgICAgICAgICBwaGFzZSA9ICduZXN0ZWQtdXBkYXRlJzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGlmICh0eXBlb2Ygb25Qb3N0Q29tbWl0ID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAgICAgICBvblBvc3RDb21taXQoaWQsIHBoYXNlLCBwYXNzaXZlRWZmZWN0RHVyYXRpb24sIGNvbW1pdFRpbWUpOwogICAgICAgICAgICAgIH0gLy8gQnViYmxlIHRpbWVzIHRvIHRoZSBuZXh0IG5lYXJlc3QgYW5jZXN0b3IgUHJvZmlsZXIuCiAgICAgICAgICAgICAgLy8gQWZ0ZXIgd2UgcHJvY2VzcyB0aGF0IFByb2ZpbGVyLCB3ZSdsbCBidWJibGUgZnVydGhlciB1cC4KCgogICAgICAgICAgICAgIHZhciBwYXJlbnRGaWJlciA9IGZpbmlzaGVkV29yay5yZXR1cm47CgogICAgICAgICAgICAgIG91dGVyOiB3aGlsZSAocGFyZW50RmliZXIgIT09IG51bGwpIHsKICAgICAgICAgICAgICAgIHN3aXRjaCAocGFyZW50RmliZXIudGFnKSB7CiAgICAgICAgICAgICAgICAgIGNhc2UgSG9zdFJvb3Q6CiAgICAgICAgICAgICAgICAgICAgdmFyIHJvb3QgPSBwYXJlbnRGaWJlci5zdGF0ZU5vZGU7CiAgICAgICAgICAgICAgICAgICAgcm9vdC5wYXNzaXZlRWZmZWN0RHVyYXRpb24gKz0gcGFzc2l2ZUVmZmVjdER1cmF0aW9uOwogICAgICAgICAgICAgICAgICAgIGJyZWFrIG91dGVyOwoKICAgICAgICAgICAgICAgICAgY2FzZSBQcm9maWxlcjoKICAgICAgICAgICAgICAgICAgICB2YXIgcGFyZW50U3RhdGVOb2RlID0gcGFyZW50RmliZXIuc3RhdGVOb2RlOwogICAgICAgICAgICAgICAgICAgIHBhcmVudFN0YXRlTm9kZS5wYXNzaXZlRWZmZWN0RHVyYXRpb24gKz0gcGFzc2l2ZUVmZmVjdER1cmF0aW9uOwogICAgICAgICAgICAgICAgICAgIGJyZWFrIG91dGVyOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHBhcmVudEZpYmVyID0gcGFyZW50RmliZXIucmV0dXJuOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIGNvbW1pdExheW91dEVmZmVjdE9uRmliZXIoZmluaXNoZWRSb290LCBjdXJyZW50LCBmaW5pc2hlZFdvcmssIGNvbW1pdHRlZExhbmVzKSB7CiAgICBpZiAoKGZpbmlzaGVkV29yay5mbGFncyAmIExheW91dE1hc2spICE9PSBOb0ZsYWdzKSB7CiAgICAgIHN3aXRjaCAoZmluaXNoZWRXb3JrLnRhZykgewogICAgICAgIGNhc2UgRnVuY3Rpb25Db21wb25lbnQ6CiAgICAgICAgY2FzZSBGb3J3YXJkUmVmOgogICAgICAgIGNhc2UgU2ltcGxlTWVtb0NvbXBvbmVudDoKICAgICAgICAgIHsKICAgICAgICAgICAgaWYgKCAhb2Zmc2NyZWVuU3VidHJlZVdhc0hpZGRlbikgewogICAgICAgICAgICAgIC8vIEF0IHRoaXMgcG9pbnQgbGF5b3V0IGVmZmVjdHMgaGF2ZSBhbHJlYWR5IGJlZW4gZGVzdHJveWVkIChkdXJpbmcgbXV0YXRpb24gcGhhc2UpLgogICAgICAgICAgICAgIC8vIFRoaXMgaXMgZG9uZSB0byBwcmV2ZW50IHNpYmxpbmcgY29tcG9uZW50IGVmZmVjdHMgZnJvbSBpbnRlcmZlcmluZyB3aXRoIGVhY2ggb3RoZXIsCiAgICAgICAgICAgICAgLy8gZS5nLiBhIGRlc3Ryb3kgZnVuY3Rpb24gaW4gb25lIGNvbXBvbmVudCBzaG91bGQgbmV2ZXIgb3ZlcnJpZGUgYSByZWYgc2V0CiAgICAgICAgICAgICAgLy8gYnkgYSBjcmVhdGUgZnVuY3Rpb24gaW4gYW5vdGhlciBjb21wb25lbnQgZHVyaW5nIHRoZSBzYW1lIGNvbW1pdC4KICAgICAgICAgICAgICBpZiAoIGZpbmlzaGVkV29yay5tb2RlICYgUHJvZmlsZU1vZGUpIHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgIHN0YXJ0TGF5b3V0RWZmZWN0VGltZXIoKTsKICAgICAgICAgICAgICAgICAgY29tbWl0SG9va0VmZmVjdExpc3RNb3VudChMYXlvdXQgfCBIYXNFZmZlY3QsIGZpbmlzaGVkV29yayk7CiAgICAgICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgICByZWNvcmRMYXlvdXRFZmZlY3REdXJhdGlvbihmaW5pc2hlZFdvcmspOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBjb21taXRIb29rRWZmZWN0TGlzdE1vdW50KExheW91dCB8IEhhc0VmZmVjdCwgZmluaXNoZWRXb3JrKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICBjYXNlIENsYXNzQ29tcG9uZW50OgogICAgICAgICAgewogICAgICAgICAgICB2YXIgaW5zdGFuY2UgPSBmaW5pc2hlZFdvcmsuc3RhdGVOb2RlOwoKICAgICAgICAgICAgaWYgKGZpbmlzaGVkV29yay5mbGFncyAmIFVwZGF0ZSkgewogICAgICAgICAgICAgIGlmICghb2Zmc2NyZWVuU3VidHJlZVdhc0hpZGRlbikgewogICAgICAgICAgICAgICAgaWYgKGN1cnJlbnQgPT09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgLy8gV2UgY291bGQgdXBkYXRlIGluc3RhbmNlIHByb3BzIGFuZCBzdGF0ZSBoZXJlLAogICAgICAgICAgICAgICAgICAvLyBidXQgaW5zdGVhZCB3ZSByZWx5IG9uIHRoZW0gYmVpbmcgc2V0IGR1cmluZyBsYXN0IHJlbmRlci4KICAgICAgICAgICAgICAgICAgLy8gVE9ETzogcmV2aXNpdCB0aGlzIHdoZW4gd2UgaW1wbGVtZW50IHJlc3VtaW5nLgogICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGZpbmlzaGVkV29yay50eXBlID09PSBmaW5pc2hlZFdvcmsuZWxlbWVudFR5cGUgJiYgIWRpZFdhcm5BYm91dFJlYXNzaWduaW5nUHJvcHMpIHsKICAgICAgICAgICAgICAgICAgICAgIGlmIChpbnN0YW5jZS5wcm9wcyAhPT0gZmluaXNoZWRXb3JrLm1lbW9pemVkUHJvcHMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IoJ0V4cGVjdGVkICVzIHByb3BzIHRvIG1hdGNoIG1lbW9pemVkIHByb3BzIGJlZm9yZSAnICsgJ2NvbXBvbmVudERpZE1vdW50LiAnICsgJ1RoaXMgbWlnaHQgZWl0aGVyIGJlIGJlY2F1c2Ugb2YgYSBidWcgaW4gUmVhY3QsIG9yIGJlY2F1c2UgJyArICdhIGNvbXBvbmVudCByZWFzc2lnbnMgaXRzIG93biBgdGhpcy5wcm9wc2AuICcgKyAnUGxlYXNlIGZpbGUgYW4gaXNzdWUuJywgZ2V0Q29tcG9uZW50TmFtZUZyb21GaWJlcihmaW5pc2hlZFdvcmspIHx8ICdpbnN0YW5jZScpOwogICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgIGlmIChpbnN0YW5jZS5zdGF0ZSAhPT0gZmluaXNoZWRXb3JrLm1lbW9pemVkU3RhdGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IoJ0V4cGVjdGVkICVzIHN0YXRlIHRvIG1hdGNoIG1lbW9pemVkIHN0YXRlIGJlZm9yZSAnICsgJ2NvbXBvbmVudERpZE1vdW50LiAnICsgJ1RoaXMgbWlnaHQgZWl0aGVyIGJlIGJlY2F1c2Ugb2YgYSBidWcgaW4gUmVhY3QsIG9yIGJlY2F1c2UgJyArICdhIGNvbXBvbmVudCByZWFzc2lnbnMgaXRzIG93biBgdGhpcy5zdGF0ZWAuICcgKyAnUGxlYXNlIGZpbGUgYW4gaXNzdWUuJywgZ2V0Q29tcG9uZW50TmFtZUZyb21GaWJlcihmaW5pc2hlZFdvcmspIHx8ICdpbnN0YW5jZScpOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgaWYgKCBmaW5pc2hlZFdvcmsubW9kZSAmIFByb2ZpbGVNb2RlKSB7CiAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0TGF5b3V0RWZmZWN0VGltZXIoKTsKICAgICAgICAgICAgICAgICAgICAgIGluc3RhbmNlLmNvbXBvbmVudERpZE1vdW50KCk7CiAgICAgICAgICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgICAgICAgIHJlY29yZExheW91dEVmZmVjdER1cmF0aW9uKGZpbmlzaGVkV29yayk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGluc3RhbmNlLmNvbXBvbmVudERpZE1vdW50KCk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIHZhciBwcmV2UHJvcHMgPSBmaW5pc2hlZFdvcmsuZWxlbWVudFR5cGUgPT09IGZpbmlzaGVkV29yay50eXBlID8gY3VycmVudC5tZW1vaXplZFByb3BzIDogcmVzb2x2ZURlZmF1bHRQcm9wcyhmaW5pc2hlZFdvcmsudHlwZSwgY3VycmVudC5tZW1vaXplZFByb3BzKTsKICAgICAgICAgICAgICAgICAgdmFyIHByZXZTdGF0ZSA9IGN1cnJlbnQubWVtb2l6ZWRTdGF0ZTsgLy8gV2UgY291bGQgdXBkYXRlIGluc3RhbmNlIHByb3BzIGFuZCBzdGF0ZSBoZXJlLAogICAgICAgICAgICAgICAgICAvLyBidXQgaW5zdGVhZCB3ZSByZWx5IG9uIHRoZW0gYmVpbmcgc2V0IGR1cmluZyBsYXN0IHJlbmRlci4KICAgICAgICAgICAgICAgICAgLy8gVE9ETzogcmV2aXNpdCB0aGlzIHdoZW4gd2UgaW1wbGVtZW50IHJlc3VtaW5nLgoKICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGlmIChmaW5pc2hlZFdvcmsudHlwZSA9PT0gZmluaXNoZWRXb3JrLmVsZW1lbnRUeXBlICYmICFkaWRXYXJuQWJvdXRSZWFzc2lnbmluZ1Byb3BzKSB7CiAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5zdGFuY2UucHJvcHMgIT09IGZpbmlzaGVkV29yay5tZW1vaXplZFByb3BzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yKCdFeHBlY3RlZCAlcyBwcm9wcyB0byBtYXRjaCBtZW1vaXplZCBwcm9wcyBiZWZvcmUgJyArICdjb21wb25lbnREaWRVcGRhdGUuICcgKyAnVGhpcyBtaWdodCBlaXRoZXIgYmUgYmVjYXVzZSBvZiBhIGJ1ZyBpbiBSZWFjdCwgb3IgYmVjYXVzZSAnICsgJ2EgY29tcG9uZW50IHJlYXNzaWducyBpdHMgb3duIGB0aGlzLnByb3BzYC4gJyArICdQbGVhc2UgZmlsZSBhbiBpc3N1ZS4nLCBnZXRDb21wb25lbnROYW1lRnJvbUZpYmVyKGZpbmlzaGVkV29yaykgfHwgJ2luc3RhbmNlJyk7CiAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgaWYgKGluc3RhbmNlLnN0YXRlICE9PSBmaW5pc2hlZFdvcmsubWVtb2l6ZWRTdGF0ZSkgewogICAgICAgICAgICAgICAgICAgICAgICBlcnJvcignRXhwZWN0ZWQgJXMgc3RhdGUgdG8gbWF0Y2ggbWVtb2l6ZWQgc3RhdGUgYmVmb3JlICcgKyAnY29tcG9uZW50RGlkVXBkYXRlLiAnICsgJ1RoaXMgbWlnaHQgZWl0aGVyIGJlIGJlY2F1c2Ugb2YgYSBidWcgaW4gUmVhY3QsIG9yIGJlY2F1c2UgJyArICdhIGNvbXBvbmVudCByZWFzc2lnbnMgaXRzIG93biBgdGhpcy5zdGF0ZWAuICcgKyAnUGxlYXNlIGZpbGUgYW4gaXNzdWUuJywgZ2V0Q29tcG9uZW50TmFtZUZyb21GaWJlcihmaW5pc2hlZFdvcmspIHx8ICdpbnN0YW5jZScpOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgaWYgKCBmaW5pc2hlZFdvcmsubW9kZSAmIFByb2ZpbGVNb2RlKSB7CiAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0TGF5b3V0RWZmZWN0VGltZXIoKTsKICAgICAgICAgICAgICAgICAgICAgIGluc3RhbmNlLmNvbXBvbmVudERpZFVwZGF0ZShwcmV2UHJvcHMsIHByZXZTdGF0ZSwgaW5zdGFuY2UuX19yZWFjdEludGVybmFsU25hcHNob3RCZWZvcmVVcGRhdGUpOwogICAgICAgICAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICAgICAgICByZWNvcmRMYXlvdXRFZmZlY3REdXJhdGlvbihmaW5pc2hlZFdvcmspOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZS5jb21wb25lbnREaWRVcGRhdGUocHJldlByb3BzLCBwcmV2U3RhdGUsIGluc3RhbmNlLl9fcmVhY3RJbnRlcm5hbFNuYXBzaG90QmVmb3JlVXBkYXRlKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSAvLyBUT0RPOiBJIHRoaW5rIHRoaXMgaXMgbm93IGFsd2F5cyBub24tbnVsbCBieSB0aGUgdGltZSBpdCByZWFjaGVzIHRoZQogICAgICAgICAgICAvLyBjb21taXQgcGhhc2UuIENvbnNpZGVyIHJlbW92aW5nIHRoZSB0eXBlIGNoZWNrLgoKCiAgICAgICAgICAgIHZhciB1cGRhdGVRdWV1ZSA9IGZpbmlzaGVkV29yay51cGRhdGVRdWV1ZTsKCiAgICAgICAgICAgIGlmICh1cGRhdGVRdWV1ZSAhPT0gbnVsbCkgewogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmIChmaW5pc2hlZFdvcmsudHlwZSA9PT0gZmluaXNoZWRXb3JrLmVsZW1lbnRUeXBlICYmICFkaWRXYXJuQWJvdXRSZWFzc2lnbmluZ1Byb3BzKSB7CiAgICAgICAgICAgICAgICAgIGlmIChpbnN0YW5jZS5wcm9wcyAhPT0gZmluaXNoZWRXb3JrLm1lbW9pemVkUHJvcHMpIHsKICAgICAgICAgICAgICAgICAgICBlcnJvcignRXhwZWN0ZWQgJXMgcHJvcHMgdG8gbWF0Y2ggbWVtb2l6ZWQgcHJvcHMgYmVmb3JlICcgKyAncHJvY2Vzc2luZyB0aGUgdXBkYXRlIHF1ZXVlLiAnICsgJ1RoaXMgbWlnaHQgZWl0aGVyIGJlIGJlY2F1c2Ugb2YgYSBidWcgaW4gUmVhY3QsIG9yIGJlY2F1c2UgJyArICdhIGNvbXBvbmVudCByZWFzc2lnbnMgaXRzIG93biBgdGhpcy5wcm9wc2AuICcgKyAnUGxlYXNlIGZpbGUgYW4gaXNzdWUuJywgZ2V0Q29tcG9uZW50TmFtZUZyb21GaWJlcihmaW5pc2hlZFdvcmspIHx8ICdpbnN0YW5jZScpOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICBpZiAoaW5zdGFuY2Uuc3RhdGUgIT09IGZpbmlzaGVkV29yay5tZW1vaXplZFN0YXRlKSB7CiAgICAgICAgICAgICAgICAgICAgZXJyb3IoJ0V4cGVjdGVkICVzIHN0YXRlIHRvIG1hdGNoIG1lbW9pemVkIHN0YXRlIGJlZm9yZSAnICsgJ3Byb2Nlc3NpbmcgdGhlIHVwZGF0ZSBxdWV1ZS4gJyArICdUaGlzIG1pZ2h0IGVpdGhlciBiZSBiZWNhdXNlIG9mIGEgYnVnIGluIFJlYWN0LCBvciBiZWNhdXNlICcgKyAnYSBjb21wb25lbnQgcmVhc3NpZ25zIGl0cyBvd24gYHRoaXMuc3RhdGVgLiAnICsgJ1BsZWFzZSBmaWxlIGFuIGlzc3VlLicsIGdldENvbXBvbmVudE5hbWVGcm9tRmliZXIoZmluaXNoZWRXb3JrKSB8fCAnaW5zdGFuY2UnKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0gLy8gV2UgY291bGQgdXBkYXRlIGluc3RhbmNlIHByb3BzIGFuZCBzdGF0ZSBoZXJlLAogICAgICAgICAgICAgIC8vIGJ1dCBpbnN0ZWFkIHdlIHJlbHkgb24gdGhlbSBiZWluZyBzZXQgZHVyaW5nIGxhc3QgcmVuZGVyLgogICAgICAgICAgICAgIC8vIFRPRE86IHJldmlzaXQgdGhpcyB3aGVuIHdlIGltcGxlbWVudCByZXN1bWluZy4KCgogICAgICAgICAgICAgIGNvbW1pdFVwZGF0ZVF1ZXVlKGZpbmlzaGVkV29yaywgdXBkYXRlUXVldWUsIGluc3RhbmNlKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgIGNhc2UgSG9zdFJvb3Q6CiAgICAgICAgICB7CiAgICAgICAgICAgIC8vIFRPRE86IEkgdGhpbmsgdGhpcyBpcyBub3cgYWx3YXlzIG5vbi1udWxsIGJ5IHRoZSB0aW1lIGl0IHJlYWNoZXMgdGhlCiAgICAgICAgICAgIC8vIGNvbW1pdCBwaGFzZS4gQ29uc2lkZXIgcmVtb3ZpbmcgdGhlIHR5cGUgY2hlY2suCiAgICAgICAgICAgIHZhciBfdXBkYXRlUXVldWUgPSBmaW5pc2hlZFdvcmsudXBkYXRlUXVldWU7CgogICAgICAgICAgICBpZiAoX3VwZGF0ZVF1ZXVlICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgdmFyIF9pbnN0YW5jZSA9IG51bGw7CgogICAgICAgICAgICAgIGlmIChmaW5pc2hlZFdvcmsuY2hpbGQgIT09IG51bGwpIHsKICAgICAgICAgICAgICAgIHN3aXRjaCAoZmluaXNoZWRXb3JrLmNoaWxkLnRhZykgewogICAgICAgICAgICAgICAgICBjYXNlIEhvc3RDb21wb25lbnQ6CiAgICAgICAgICAgICAgICAgICAgX2luc3RhbmNlID0gZ2V0UHVibGljSW5zdGFuY2UoZmluaXNoZWRXb3JrLmNoaWxkLnN0YXRlTm9kZSk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgICAgICBjYXNlIENsYXNzQ29tcG9uZW50OgogICAgICAgICAgICAgICAgICAgIF9pbnN0YW5jZSA9IGZpbmlzaGVkV29yay5jaGlsZC5zdGF0ZU5vZGU7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjb21taXRVcGRhdGVRdWV1ZShmaW5pc2hlZFdvcmssIF91cGRhdGVRdWV1ZSwgX2luc3RhbmNlKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgIGNhc2UgSG9zdENvbXBvbmVudDoKICAgICAgICAgIHsKICAgICAgICAgICAgdmFyIF9pbnN0YW5jZTIgPSBmaW5pc2hlZFdvcmsuc3RhdGVOb2RlOyAvLyBSZW5kZXJlcnMgbWF5IHNjaGVkdWxlIHdvcmsgdG8gYmUgZG9uZSBhZnRlciBob3N0IGNvbXBvbmVudHMgYXJlIG1vdW50ZWQKICAgICAgICAgICAgLy8gKGVnIERPTSByZW5kZXJlciBtYXkgc2NoZWR1bGUgYXV0by1mb2N1cyBmb3IgaW5wdXRzIGFuZCBmb3JtIGNvbnRyb2xzKS4KICAgICAgICAgICAgLy8gVGhlc2UgZWZmZWN0cyBzaG91bGQgb25seSBiZSBjb21taXR0ZWQgd2hlbiBjb21wb25lbnRzIGFyZSBmaXJzdCBtb3VudGVkLAogICAgICAgICAgICAvLyBha2Egd2hlbiB0aGVyZSBpcyBubyBjdXJyZW50L2FsdGVybmF0ZS4KCiAgICAgICAgICAgIGlmIChjdXJyZW50ID09PSBudWxsICYmIGZpbmlzaGVkV29yay5mbGFncyAmIFVwZGF0ZSkgewogICAgICAgICAgICAgIHZhciB0eXBlID0gZmluaXNoZWRXb3JrLnR5cGU7CiAgICAgICAgICAgICAgdmFyIHByb3BzID0gZmluaXNoZWRXb3JrLm1lbW9pemVkUHJvcHM7CiAgICAgICAgICAgICAgY29tbWl0TW91bnQoX2luc3RhbmNlMiwgdHlwZSwgcHJvcHMpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgY2FzZSBIb3N0VGV4dDoKICAgICAgICAgIHsKICAgICAgICAgICAgLy8gV2UgaGF2ZSBubyBsaWZlLWN5Y2xlcyBhc3NvY2lhdGVkIHdpdGggdGV4dC4KICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgIGNhc2UgSG9zdFBvcnRhbDoKICAgICAgICAgIHsKICAgICAgICAgICAgLy8gV2UgaGF2ZSBubyBsaWZlLWN5Y2xlcyBhc3NvY2lhdGVkIHdpdGggcG9ydGFscy4KICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgIGNhc2UgUHJvZmlsZXI6CiAgICAgICAgICB7CiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB2YXIgX2ZpbmlzaGVkV29yayRtZW1vaXplMiA9IGZpbmlzaGVkV29yay5tZW1vaXplZFByb3BzLAogICAgICAgICAgICAgICAgICBvbkNvbW1pdCA9IF9maW5pc2hlZFdvcmskbWVtb2l6ZTIub25Db21taXQsCiAgICAgICAgICAgICAgICAgIG9uUmVuZGVyID0gX2ZpbmlzaGVkV29yayRtZW1vaXplMi5vblJlbmRlcjsKICAgICAgICAgICAgICB2YXIgZWZmZWN0RHVyYXRpb24gPSBmaW5pc2hlZFdvcmsuc3RhdGVOb2RlLmVmZmVjdER1cmF0aW9uOwogICAgICAgICAgICAgIHZhciBjb21taXRUaW1lID0gZ2V0Q29tbWl0VGltZSgpOwogICAgICAgICAgICAgIHZhciBwaGFzZSA9IGN1cnJlbnQgPT09IG51bGwgPyAnbW91bnQnIDogJ3VwZGF0ZSc7CgogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmIChpc0N1cnJlbnRVcGRhdGVOZXN0ZWQoKSkgewogICAgICAgICAgICAgICAgICBwaGFzZSA9ICduZXN0ZWQtdXBkYXRlJzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGlmICh0eXBlb2Ygb25SZW5kZXIgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgICAgICAgIG9uUmVuZGVyKGZpbmlzaGVkV29yay5tZW1vaXplZFByb3BzLmlkLCBwaGFzZSwgZmluaXNoZWRXb3JrLmFjdHVhbER1cmF0aW9uLCBmaW5pc2hlZFdvcmsudHJlZUJhc2VEdXJhdGlvbiwgZmluaXNoZWRXb3JrLmFjdHVhbFN0YXJ0VGltZSwgY29tbWl0VGltZSk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG9uQ29tbWl0ID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAgICAgICAgIG9uQ29tbWl0KGZpbmlzaGVkV29yay5tZW1vaXplZFByb3BzLmlkLCBwaGFzZSwgZWZmZWN0RHVyYXRpb24sIGNvbW1pdFRpbWUpOwogICAgICAgICAgICAgICAgfSAvLyBTY2hlZHVsZSBhIHBhc3NpdmUgZWZmZWN0IGZvciB0aGlzIFByb2ZpbGVyIHRvIGNhbGwgb25Qb3N0Q29tbWl0IGhvb2tzLgogICAgICAgICAgICAgICAgLy8gVGhpcyBlZmZlY3Qgc2hvdWxkIGJlIHNjaGVkdWxlZCBldmVuIGlmIHRoZXJlIGlzIG5vIG9uUG9zdENvbW1pdCBjYWxsYmFjayBmb3IgdGhpcyBQcm9maWxlciwKICAgICAgICAgICAgICAgIC8vIGJlY2F1c2UgdGhlIGVmZmVjdCBpcyBhbHNvIHdoZXJlIHRpbWVzIGJ1YmJsZSB0byBwYXJlbnQgUHJvZmlsZXJzLgoKCiAgICAgICAgICAgICAgICBlbnF1ZXVlUGVuZGluZ1Bhc3NpdmVQcm9maWxlckVmZmVjdChmaW5pc2hlZFdvcmspOyAvLyBQcm9wYWdhdGUgbGF5b3V0IGVmZmVjdCBkdXJhdGlvbnMgdG8gdGhlIG5leHQgbmVhcmVzdCBQcm9maWxlciBhbmNlc3Rvci4KICAgICAgICAgICAgICAgIC8vIERvIG5vdCByZXNldCB0aGVzZSB2YWx1ZXMgdW50aWwgdGhlIG5leHQgcmVuZGVyIHNvIERldlRvb2xzIGhhcyBhIGNoYW5jZSB0byByZWFkIHRoZW0gZmlyc3QuCgogICAgICAgICAgICAgICAgdmFyIHBhcmVudEZpYmVyID0gZmluaXNoZWRXb3JrLnJldHVybjsKCiAgICAgICAgICAgICAgICBvdXRlcjogd2hpbGUgKHBhcmVudEZpYmVyICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgIHN3aXRjaCAocGFyZW50RmliZXIudGFnKSB7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBIb3N0Um9vdDoKICAgICAgICAgICAgICAgICAgICAgIHZhciByb290ID0gcGFyZW50RmliZXIuc3RhdGVOb2RlOwogICAgICAgICAgICAgICAgICAgICAgcm9vdC5lZmZlY3REdXJhdGlvbiArPSBlZmZlY3REdXJhdGlvbjsKICAgICAgICAgICAgICAgICAgICAgIGJyZWFrIG91dGVyOwoKICAgICAgICAgICAgICAgICAgICBjYXNlIFByb2ZpbGVyOgogICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmVudFN0YXRlTm9kZSA9IHBhcmVudEZpYmVyLnN0YXRlTm9kZTsKICAgICAgICAgICAgICAgICAgICAgIHBhcmVudFN0YXRlTm9kZS5lZmZlY3REdXJhdGlvbiArPSBlZmZlY3REdXJhdGlvbjsKICAgICAgICAgICAgICAgICAgICAgIGJyZWFrIG91dGVyOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICBwYXJlbnRGaWJlciA9IHBhcmVudEZpYmVyLnJldHVybjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICBjYXNlIFN1c3BlbnNlQ29tcG9uZW50OgogICAgICAgICAgewogICAgICAgICAgICBjb21taXRTdXNwZW5zZUh5ZHJhdGlvbkNhbGxiYWNrcyhmaW5pc2hlZFJvb3QsIGZpbmlzaGVkV29yayk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICBjYXNlIFN1c3BlbnNlTGlzdENvbXBvbmVudDoKICAgICAgICBjYXNlIEluY29tcGxldGVDbGFzc0NvbXBvbmVudDoKICAgICAgICBjYXNlIFNjb3BlQ29tcG9uZW50OgogICAgICAgIGNhc2UgT2Zmc2NyZWVuQ29tcG9uZW50OgogICAgICAgIGNhc2UgTGVnYWN5SGlkZGVuQ29tcG9uZW50OgogICAgICAgIGNhc2UgVHJhY2luZ01hcmtlckNvbXBvbmVudDoKICAgICAgICAgIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoaXMgdW5pdCBvZiB3b3JrIHRhZyBzaG91bGQgbm90IGhhdmUgc2lkZS1lZmZlY3RzLiBUaGlzIGVycm9yIGlzICcgKyAnbGlrZWx5IGNhdXNlZCBieSBhIGJ1ZyBpbiBSZWFjdC4gUGxlYXNlIGZpbGUgYW4gaXNzdWUuJyk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoICFvZmZzY3JlZW5TdWJ0cmVlV2FzSGlkZGVuKSB7CiAgICAgIHsKICAgICAgICBpZiAoZmluaXNoZWRXb3JrLmZsYWdzICYgUmVmKSB7CiAgICAgICAgICBjb21taXRBdHRhY2hSZWYoZmluaXNoZWRXb3JrKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIHJlYXBwZWFyTGF5b3V0RWZmZWN0c09uRmliZXIobm9kZSkgewogICAgLy8gVHVybiBvbiBsYXlvdXQgZWZmZWN0cyBpbiBhIHRyZWUgdGhhdCBwcmV2aW91c2x5IGRpc2FwcGVhcmVkLgogICAgLy8gVE9ETyAoT2Zmc2NyZWVuKSBDaGVjazogZmxhZ3MgJiBMYXlvdXRTdGF0aWMKICAgIHN3aXRjaCAobm9kZS50YWcpIHsKICAgICAgY2FzZSBGdW5jdGlvbkNvbXBvbmVudDoKICAgICAgY2FzZSBGb3J3YXJkUmVmOgogICAgICBjYXNlIFNpbXBsZU1lbW9Db21wb25lbnQ6CiAgICAgICAgewogICAgICAgICAgaWYgKCBub2RlLm1vZGUgJiBQcm9maWxlTW9kZSkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIHN0YXJ0TGF5b3V0RWZmZWN0VGltZXIoKTsKICAgICAgICAgICAgICBzYWZlbHlDYWxsQ29tbWl0SG9va0xheW91dEVmZmVjdExpc3RNb3VudChub2RlLCBub2RlLnJldHVybik7CiAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgcmVjb3JkTGF5b3V0RWZmZWN0RHVyYXRpb24obm9kZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHNhZmVseUNhbGxDb21taXRIb29rTGF5b3V0RWZmZWN0TGlzdE1vdW50KG5vZGUsIG5vZGUucmV0dXJuKTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICBjYXNlIENsYXNzQ29tcG9uZW50OgogICAgICAgIHsKICAgICAgICAgIHZhciBpbnN0YW5jZSA9IG5vZGUuc3RhdGVOb2RlOwoKICAgICAgICAgIGlmICh0eXBlb2YgaW5zdGFuY2UuY29tcG9uZW50RGlkTW91bnQgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgICAgc2FmZWx5Q2FsbENvbXBvbmVudERpZE1vdW50KG5vZGUsIG5vZGUucmV0dXJuLCBpbnN0YW5jZSk7CiAgICAgICAgICB9CgogICAgICAgICAgc2FmZWx5QXR0YWNoUmVmKG5vZGUsIG5vZGUucmV0dXJuKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgIGNhc2UgSG9zdENvbXBvbmVudDoKICAgICAgICB7CiAgICAgICAgICBzYWZlbHlBdHRhY2hSZWYobm9kZSwgbm9kZS5yZXR1cm4pOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gaGlkZU9yVW5oaWRlQWxsQ2hpbGRyZW4oZmluaXNoZWRXb3JrLCBpc0hpZGRlbikgewogICAgLy8gT25seSBoaWRlIG9yIHVuaGlkZSB0aGUgdG9wLW1vc3QgaG9zdCBub2Rlcy4KICAgIHZhciBob3N0U3VidHJlZVJvb3QgPSBudWxsOwoKICAgIHsKICAgICAgLy8gV2Ugb25seSBoYXZlIHRoZSB0b3AgRmliZXIgdGhhdCB3YXMgaW5zZXJ0ZWQgYnV0IHdlIG5lZWQgdG8gcmVjdXJzZSBkb3duIGl0cwogICAgICAvLyBjaGlsZHJlbiB0byBmaW5kIGFsbCB0aGUgdGVybWluYWwgbm9kZXMuCiAgICAgIHZhciBub2RlID0gZmluaXNoZWRXb3JrOwoKICAgICAgd2hpbGUgKHRydWUpIHsKICAgICAgICBpZiAobm9kZS50YWcgPT09IEhvc3RDb21wb25lbnQpIHsKICAgICAgICAgIGlmIChob3N0U3VidHJlZVJvb3QgPT09IG51bGwpIHsKICAgICAgICAgICAgaG9zdFN1YnRyZWVSb290ID0gbm9kZTsKCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgdmFyIGluc3RhbmNlID0gbm9kZS5zdGF0ZU5vZGU7CgogICAgICAgICAgICAgIGlmIChpc0hpZGRlbikgewogICAgICAgICAgICAgICAgaGlkZUluc3RhbmNlKGluc3RhbmNlKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdW5oaWRlSW5zdGFuY2Uobm9kZS5zdGF0ZU5vZGUsIG5vZGUubWVtb2l6ZWRQcm9wcyk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICAgIGNhcHR1cmVDb21taXRQaGFzZUVycm9yKGZpbmlzaGVkV29yaywgZmluaXNoZWRXb3JrLnJldHVybiwgZXJyb3IpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChub2RlLnRhZyA9PT0gSG9zdFRleHQpIHsKICAgICAgICAgIGlmIChob3N0U3VidHJlZVJvb3QgPT09IG51bGwpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICB2YXIgX2luc3RhbmNlMyA9IG5vZGUuc3RhdGVOb2RlOwoKICAgICAgICAgICAgICBpZiAoaXNIaWRkZW4pIHsKICAgICAgICAgICAgICAgIGhpZGVUZXh0SW5zdGFuY2UoX2luc3RhbmNlMyk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHVuaGlkZVRleHRJbnN0YW5jZShfaW5zdGFuY2UzLCBub2RlLm1lbW9pemVkUHJvcHMpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgICBjYXB0dXJlQ29tbWl0UGhhc2VFcnJvcihmaW5pc2hlZFdvcmssIGZpbmlzaGVkV29yay5yZXR1cm4sIGVycm9yKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoKG5vZGUudGFnID09PSBPZmZzY3JlZW5Db21wb25lbnQgfHwgbm9kZS50YWcgPT09IExlZ2FjeUhpZGRlbkNvbXBvbmVudCkgJiYgbm9kZS5tZW1vaXplZFN0YXRlICE9PSBudWxsICYmIG5vZGUgIT09IGZpbmlzaGVkV29yaykgOyBlbHNlIGlmIChub2RlLmNoaWxkICE9PSBudWxsKSB7CiAgICAgICAgICBub2RlLmNoaWxkLnJldHVybiA9IG5vZGU7CiAgICAgICAgICBub2RlID0gbm9kZS5jaGlsZDsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgaWYgKG5vZGUgPT09IGZpbmlzaGVkV29yaykgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgd2hpbGUgKG5vZGUuc2libGluZyA9PT0gbnVsbCkgewogICAgICAgICAgaWYgKG5vZGUucmV0dXJuID09PSBudWxsIHx8IG5vZGUucmV0dXJuID09PSBmaW5pc2hlZFdvcmspIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChob3N0U3VidHJlZVJvb3QgPT09IG5vZGUpIHsKICAgICAgICAgICAgaG9zdFN1YnRyZWVSb290ID0gbnVsbDsKICAgICAgICAgIH0KCiAgICAgICAgICBub2RlID0gbm9kZS5yZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAoaG9zdFN1YnRyZWVSb290ID09PSBub2RlKSB7CiAgICAgICAgICBob3N0U3VidHJlZVJvb3QgPSBudWxsOwogICAgICAgIH0KCiAgICAgICAgbm9kZS5zaWJsaW5nLnJldHVybiA9IG5vZGUucmV0dXJuOwogICAgICAgIG5vZGUgPSBub2RlLnNpYmxpbmc7CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIGNvbW1pdEF0dGFjaFJlZihmaW5pc2hlZFdvcmspIHsKICAgIHZhciByZWYgPSBmaW5pc2hlZFdvcmsucmVmOwoKICAgIGlmIChyZWYgIT09IG51bGwpIHsKICAgICAgdmFyIGluc3RhbmNlID0gZmluaXNoZWRXb3JrLnN0YXRlTm9kZTsKICAgICAgdmFyIGluc3RhbmNlVG9Vc2U7CgogICAgICBzd2l0Y2ggKGZpbmlzaGVkV29yay50YWcpIHsKICAgICAgICBjYXNlIEhvc3RDb21wb25lbnQ6CiAgICAgICAgICBpbnN0YW5jZVRvVXNlID0gZ2V0UHVibGljSW5zdGFuY2UoaW5zdGFuY2UpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICBpbnN0YW5jZVRvVXNlID0gaW5zdGFuY2U7CiAgICAgIH0gLy8gTW92ZWQgb3V0c2lkZSB0byBlbnN1cmUgRENFIHdvcmtzIHdpdGggdGhpcyBmbGFnCgogICAgICBpZiAodHlwZW9mIHJlZiA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIHZhciByZXRWYWw7CgogICAgICAgIGlmICggZmluaXNoZWRXb3JrLm1vZGUgJiBQcm9maWxlTW9kZSkgewogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgc3RhcnRMYXlvdXRFZmZlY3RUaW1lcigpOwogICAgICAgICAgICByZXRWYWwgPSByZWYoaW5zdGFuY2VUb1VzZSk7CiAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICByZWNvcmRMYXlvdXRFZmZlY3REdXJhdGlvbihmaW5pc2hlZFdvcmspOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXRWYWwgPSByZWYoaW5zdGFuY2VUb1VzZSk7CiAgICAgICAgfQoKICAgICAgICB7CiAgICAgICAgICBpZiAodHlwZW9mIHJldFZhbCA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgICBlcnJvcignVW5leHBlY3RlZCByZXR1cm4gdmFsdWUgZnJvbSBhIGNhbGxiYWNrIHJlZiBpbiAlcy4gJyArICdBIGNhbGxiYWNrIHJlZiBzaG91bGQgbm90IHJldHVybiBhIGZ1bmN0aW9uLicsIGdldENvbXBvbmVudE5hbWVGcm9tRmliZXIoZmluaXNoZWRXb3JrKSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHsKICAgICAgICAgIGlmICghcmVmLmhhc093blByb3BlcnR5KCdjdXJyZW50JykpIHsKICAgICAgICAgICAgZXJyb3IoJ1VuZXhwZWN0ZWQgcmVmIG9iamVjdCBwcm92aWRlZCBmb3IgJXMuICcgKyAnVXNlIGVpdGhlciBhIHJlZi1zZXR0ZXIgZnVuY3Rpb24gb3IgUmVhY3QuY3JlYXRlUmVmKCkuJywgZ2V0Q29tcG9uZW50TmFtZUZyb21GaWJlcihmaW5pc2hlZFdvcmspKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJlZi5jdXJyZW50ID0gaW5zdGFuY2VUb1VzZTsKICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gZGV0YWNoRmliZXJNdXRhdGlvbihmaWJlcikgewogICAgLy8gQ3V0IG9mZiB0aGUgcmV0dXJuIHBvaW50ZXIgdG8gZGlzY29ubmVjdCBpdCBmcm9tIHRoZSB0cmVlLgogICAgLy8gVGhpcyBlbmFibGVzIHVzIHRvIGRldGVjdCBhbmQgd2FybiBhZ2FpbnN0IHN0YXRlIHVwZGF0ZXMgb24gYW4gdW5tb3VudGVkIGNvbXBvbmVudC4KICAgIC8vIEl0IGFsc28gcHJldmVudHMgZXZlbnRzIGZyb20gYnViYmxpbmcgZnJvbSB3aXRoaW4gZGlzY29ubmVjdGVkIGNvbXBvbmVudHMuCiAgICAvLwogICAgLy8gSWRlYWxseSwgd2Ugc2hvdWxkIGFsc28gY2xlYXIgdGhlIGNoaWxkIHBvaW50ZXIgb2YgdGhlIHBhcmVudCBhbHRlcm5hdGUgdG8gbGV0IHRoaXMKICAgIC8vIGdldCBHQzplZCBidXQgd2UgZG9uJ3Qga25vdyB3aGljaCBmb3Igc3VyZSB3aGljaCBwYXJlbnQgaXMgdGhlIGN1cnJlbnQKICAgIC8vIG9uZSBzbyB3ZSdsbCBzZXR0bGUgZm9yIEdDOmluZyB0aGUgc3VidHJlZSBvZiB0aGlzIGNoaWxkLgogICAgLy8gVGhpcyBjaGlsZCBpdHNlbGYgd2lsbCBiZSBHQzplZCB3aGVuIHRoZSBwYXJlbnQgdXBkYXRlcyB0aGUgbmV4dCB0aW1lLgogICAgLy8KICAgIC8vIE5vdGUgdGhhdCB3ZSBjYW4ndCBjbGVhciBjaGlsZCBvciBzaWJsaW5nIHBvaW50ZXJzIHlldC4KICAgIC8vIFRoZXkncmUgbmVlZGVkIGZvciBwYXNzaXZlIGVmZmVjdHMgYW5kIGZvciBmaW5kRE9NTm9kZS4KICAgIC8vIFdlIGRlZmVyIHRob3NlIGZpZWxkcywgYW5kIGFsbCBvdGhlciBjbGVhbnVwLCB0byB0aGUgcGFzc2l2ZSBwaGFzZSAoc2VlIGRldGFjaEZpYmVyQWZ0ZXJFZmZlY3RzKS4KICAgIC8vCiAgICAvLyBEb24ndCByZXNldCB0aGUgYWx0ZXJuYXRlIHlldCwgZWl0aGVyLiBXZSBuZWVkIHRoYXQgc28gd2UgY2FuIGRldGFjaCB0aGUKICAgIC8vIGFsdGVybmF0ZSdzIGZpZWxkcyBpbiB0aGUgcGFzc2l2ZSBwaGFzZS4gQ2xlYXJpbmcgdGhlIHJldHVybiBwb2ludGVyIGlzCiAgICAvLyBzdWZmaWNpZW50IGZvciBmaW5kRE9NTm9kZSBzZW1hbnRpY3MuCiAgICB2YXIgYWx0ZXJuYXRlID0gZmliZXIuYWx0ZXJuYXRlOwoKICAgIGlmIChhbHRlcm5hdGUgIT09IG51bGwpIHsKICAgICAgYWx0ZXJuYXRlLnJldHVybiA9IG51bGw7CiAgICB9CgogICAgZmliZXIucmV0dXJuID0gbnVsbDsKICB9CgogIGZ1bmN0aW9uIGRldGFjaEZpYmVyQWZ0ZXJFZmZlY3RzKGZpYmVyKSB7CiAgICB2YXIgYWx0ZXJuYXRlID0gZmliZXIuYWx0ZXJuYXRlOwoKICAgIGlmIChhbHRlcm5hdGUgIT09IG51bGwpIHsKICAgICAgZmliZXIuYWx0ZXJuYXRlID0gbnVsbDsKICAgICAgZGV0YWNoRmliZXJBZnRlckVmZmVjdHMoYWx0ZXJuYXRlKTsKICAgIH0gLy8gTm90ZTogRGVmZW5zaXZlbHkgdXNpbmcgbmVnYXRpb24gaW5zdGVhZCBvZiA8IGluIGNhc2UKICAgIC8vIGBkZWxldGVkVHJlZUNsZWFuVXBMZXZlbGAgaXMgdW5kZWZpbmVkLgoKCiAgICB7CiAgICAgIC8vIENsZWFyIGN5Y2xpY2FsIEZpYmVyIGZpZWxkcy4gVGhpcyBsZXZlbCBhbG9uZSBpcyBkZXNpZ25lZCB0byByb3VnaGx5CiAgICAgIC8vIGFwcHJveGltYXRlIHRoZSBwbGFubmVkIEZpYmVyIHJlZmFjdG9yLiBJbiB0aGF0IHdvcmxkLCBgc2V0U3RhdGVgIHdpbGwgYmUKICAgICAgLy8gYm91bmQgdG8gYSBzcGVjaWFsICJpbnN0YW5jZSIgb2JqZWN0IGluc3RlYWQgb2YgYSBGaWJlci4gVGhlIEluc3RhbmNlCiAgICAgIC8vIG9iamVjdCB3aWxsIG5vdCBoYXZlIGFueSBvZiB0aGVzZSBmaWVsZHMuIEl0IHdpbGwgb25seSBiZSBjb25uZWN0ZWQgdG8KICAgICAgLy8gdGhlIGZpYmVyIHRyZWUgdmlhIGEgc2luZ2xlIGxpbmsgYXQgdGhlIHJvb3QuIFNvIGlmIHRoaXMgbGV2ZWwgYWxvbmUgaXMKICAgICAgLy8gc3VmZmljaWVudCB0byBmaXggbWVtb3J5IGlzc3VlcywgdGhhdCBib2RlcyB3ZWxsIGZvciBvdXIgcGxhbnMuCiAgICAgIGZpYmVyLmNoaWxkID0gbnVsbDsKICAgICAgZmliZXIuZGVsZXRpb25zID0gbnVsbDsKICAgICAgZmliZXIuc2libGluZyA9IG51bGw7IC8vIFRoZSBgc3RhdGVOb2RlYCBpcyBjeWNsaWNhbCBiZWNhdXNlIG9uIGhvc3Qgbm9kZXMgaXQgcG9pbnRzIHRvIHRoZSBob3N0CiAgICAgIC8vIHRyZWUsIHdoaWNoIGhhcyBpdHMgb3duIHBvaW50ZXJzIHRvIGNoaWxkcmVuLCBwYXJlbnRzLCBhbmQgc2libGluZ3MuCiAgICAgIC8vIFRoZSBvdGhlciBob3N0IG5vZGVzIGFsc28gcG9pbnQgYmFjayB0byBmaWJlcnMsIHNvIHdlIHNob3VsZCBkZXRhY2ggdGhhdAogICAgICAvLyBvbmUsIHRvby4KCiAgICAgIGlmIChmaWJlci50YWcgPT09IEhvc3RDb21wb25lbnQpIHsKICAgICAgICB2YXIgaG9zdEluc3RhbmNlID0gZmliZXIuc3RhdGVOb2RlOwoKICAgICAgICBpZiAoaG9zdEluc3RhbmNlICE9PSBudWxsKSB7CiAgICAgICAgICBkZXRhY2hEZWxldGVkSW5zdGFuY2UoaG9zdEluc3RhbmNlKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZpYmVyLnN0YXRlTm9kZSA9IG51bGw7IC8vIEknbSBpbnRlbnRpb25hbGx5IG5vdCBjbGVhcmluZyB0aGUgYHJldHVybmAgZmllbGQgaW4gdGhpcyBsZXZlbC4gV2UKICAgICAgLy8gYWxyZWFkeSBkaXNjb25uZWN0IHRoZSBgcmV0dXJuYCBwb2ludGVyIGF0IHRoZSByb290IG9mIHRoZSBkZWxldGVkCiAgICAgIC8vIHN1YnRyZWUgKGluIGBkZXRhY2hGaWJlck11dGF0aW9uYCkuIEJlc2lkZXMsIGByZXR1cm5gIGJ5IGl0c2VsZiBpcyBub3QKICAgICAgLy8gY3ljbGljYWwg4oCUIGl0J3Mgb25seSBjeWNsaWNhbCB3aGVuIGNvbWJpbmVkIHdpdGggYGNoaWxkYCwgYHNpYmxpbmdgLCBhbmQKICAgICAgLy8gYGFsdGVybmF0ZWAuIEJ1dCB3ZSdsbCBjbGVhciBpdCBpbiB0aGUgbmV4dCBsZXZlbCBhbnl3YXksIGp1c3QgaW4gY2FzZS4KCiAgICAgIHsKICAgICAgICBmaWJlci5fZGVidWdPd25lciA9IG51bGw7CiAgICAgIH0KCiAgICAgIHsKICAgICAgICAvLyBUaGVvcmV0aWNhbGx5LCBub3RoaW5nIGluIGhlcmUgc2hvdWxkIGJlIG5lY2Vzc2FyeSwgYmVjYXVzZSB3ZSBhbHJlYWR5CiAgICAgICAgLy8gZGlzY29ubmVjdGVkIHRoZSBmaWJlciBmcm9tIHRoZSB0cmVlLiBTbyBldmVuIGlmIHNvbWV0aGluZyBsZWFrcyB0aGlzCiAgICAgICAgLy8gcGFydGljdWxhciBmaWJlciwgaXQgd29uJ3QgbGVhayBhbnl0aGluZyBlbHNlCiAgICAgICAgLy8KICAgICAgICAvLyBUaGUgcHVycG9zZSBvZiB0aGlzIGJyYW5jaCBpcyB0byBiZSBzdXBlciBhZ2dyZXNzaXZlIHNvIHdlIGNhbiBtZWFzdXJlCiAgICAgICAgLy8gaWYgdGhlcmUncyBhbnkgZGlmZmVyZW5jZSBpbiBtZW1vcnkgaW1wYWN0LiBJZiB0aGVyZSBpcywgdGhhdCBjb3VsZAogICAgICAgIC8vIGluZGljYXRlIGEgUmVhY3QgbGVhayB3ZSBkb24ndCBrbm93IGFib3V0LgogICAgICAgIGZpYmVyLnJldHVybiA9IG51bGw7CiAgICAgICAgZmliZXIuZGVwZW5kZW5jaWVzID0gbnVsbDsKICAgICAgICBmaWJlci5tZW1vaXplZFByb3BzID0gbnVsbDsKICAgICAgICBmaWJlci5tZW1vaXplZFN0YXRlID0gbnVsbDsKICAgICAgICBmaWJlci5wZW5kaW5nUHJvcHMgPSBudWxsOwogICAgICAgIGZpYmVyLnN0YXRlTm9kZSA9IG51bGw7IC8vIFRPRE86IE1vdmUgdG8gYGNvbW1pdFBhc3NpdmVVbm1vdW50SW5zaWRlRGVsZXRlZFRyZWVPbkZpYmVyYCBpbnN0ZWFkLgoKICAgICAgICBmaWJlci51cGRhdGVRdWV1ZSA9IG51bGw7CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIGdldEhvc3RQYXJlbnRGaWJlcihmaWJlcikgewogICAgdmFyIHBhcmVudCA9IGZpYmVyLnJldHVybjsKCiAgICB3aGlsZSAocGFyZW50ICE9PSBudWxsKSB7CiAgICAgIGlmIChpc0hvc3RQYXJlbnQocGFyZW50KSkgewogICAgICAgIHJldHVybiBwYXJlbnQ7CiAgICAgIH0KCiAgICAgIHBhcmVudCA9IHBhcmVudC5yZXR1cm47CiAgICB9CgogICAgdGhyb3cgbmV3IEVycm9yKCdFeHBlY3RlZCB0byBmaW5kIGEgaG9zdCBwYXJlbnQuIFRoaXMgZXJyb3IgaXMgbGlrZWx5IGNhdXNlZCBieSBhIGJ1ZyAnICsgJ2luIFJlYWN0LiBQbGVhc2UgZmlsZSBhbiBpc3N1ZS4nKTsKICB9CgogIGZ1bmN0aW9uIGlzSG9zdFBhcmVudChmaWJlcikgewogICAgcmV0dXJuIGZpYmVyLnRhZyA9PT0gSG9zdENvbXBvbmVudCB8fCBmaWJlci50YWcgPT09IEhvc3RSb290IHx8IGZpYmVyLnRhZyA9PT0gSG9zdFBvcnRhbDsKICB9CgogIGZ1bmN0aW9uIGdldEhvc3RTaWJsaW5nKGZpYmVyKSB7CiAgICAvLyBXZSdyZSBnb2luZyB0byBzZWFyY2ggZm9yd2FyZCBpbnRvIHRoZSB0cmVlIHVudGlsIHdlIGZpbmQgYSBzaWJsaW5nIGhvc3QKICAgIC8vIG5vZGUuIFVuZm9ydHVuYXRlbHksIGlmIG11bHRpcGxlIGluc2VydGlvbnMgYXJlIGRvbmUgaW4gYSByb3cgd2UgaGF2ZSB0bwogICAgLy8gc2VhcmNoIHBhc3QgdGhlbS4gVGhpcyBsZWFkcyB0byBleHBvbmVudGlhbCBzZWFyY2ggZm9yIHRoZSBuZXh0IHNpYmxpbmcuCiAgICAvLyBUT0RPOiBGaW5kIGEgbW9yZSBlZmZpY2llbnQgd2F5IHRvIGRvIHRoaXMuCiAgICB2YXIgbm9kZSA9IGZpYmVyOwoKICAgIHNpYmxpbmdzOiB3aGlsZSAodHJ1ZSkgewogICAgICAvLyBJZiB3ZSBkaWRuJ3QgZmluZCBhbnl0aGluZywgbGV0J3MgdHJ5IHRoZSBuZXh0IHNpYmxpbmcuCiAgICAgIHdoaWxlIChub2RlLnNpYmxpbmcgPT09IG51bGwpIHsKICAgICAgICBpZiAobm9kZS5yZXR1cm4gPT09IG51bGwgfHwgaXNIb3N0UGFyZW50KG5vZGUucmV0dXJuKSkgewogICAgICAgICAgLy8gSWYgd2UgcG9wIG91dCBvZiB0aGUgcm9vdCBvciBoaXQgdGhlIHBhcmVudCB0aGUgZmliZXIgd2UgYXJlIHRoZQogICAgICAgICAgLy8gbGFzdCBzaWJsaW5nLgogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQoKICAgICAgICBub2RlID0gbm9kZS5yZXR1cm47CiAgICAgIH0KCiAgICAgIG5vZGUuc2libGluZy5yZXR1cm4gPSBub2RlLnJldHVybjsKICAgICAgbm9kZSA9IG5vZGUuc2libGluZzsKCiAgICAgIHdoaWxlIChub2RlLnRhZyAhPT0gSG9zdENvbXBvbmVudCAmJiBub2RlLnRhZyAhPT0gSG9zdFRleHQgJiYgbm9kZS50YWcgIT09IERlaHlkcmF0ZWRGcmFnbWVudCkgewogICAgICAgIC8vIElmIGl0IGlzIG5vdCBob3N0IG5vZGUgYW5kLCB3ZSBtaWdodCBoYXZlIGEgaG9zdCBub2RlIGluc2lkZSBpdC4KICAgICAgICAvLyBUcnkgdG8gc2VhcmNoIGRvd24gdW50aWwgd2UgZmluZCBvbmUuCiAgICAgICAgaWYgKG5vZGUuZmxhZ3MgJiBQbGFjZW1lbnQpIHsKICAgICAgICAgIC8vIElmIHdlIGRvbid0IGhhdmUgYSBjaGlsZCwgdHJ5IHRoZSBzaWJsaW5ncyBpbnN0ZWFkLgogICAgICAgICAgY29udGludWUgc2libGluZ3M7CiAgICAgICAgfSAvLyBJZiB3ZSBkb24ndCBoYXZlIGEgY2hpbGQsIHRyeSB0aGUgc2libGluZ3MgaW5zdGVhZC4KICAgICAgICAvLyBXZSBhbHNvIHNraXAgcG9ydGFscyBiZWNhdXNlIHRoZXkgYXJlIG5vdCBwYXJ0IG9mIHRoaXMgaG9zdCB0cmVlLgoKCiAgICAgICAgaWYgKG5vZGUuY2hpbGQgPT09IG51bGwgfHwgbm9kZS50YWcgPT09IEhvc3RQb3J0YWwpIHsKICAgICAgICAgIGNvbnRpbnVlIHNpYmxpbmdzOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBub2RlLmNoaWxkLnJldHVybiA9IG5vZGU7CiAgICAgICAgICBub2RlID0gbm9kZS5jaGlsZDsKICAgICAgICB9CiAgICAgIH0gLy8gQ2hlY2sgaWYgdGhpcyBob3N0IG5vZGUgaXMgc3RhYmxlIG9yIGFib3V0IHRvIGJlIHBsYWNlZC4KCgogICAgICBpZiAoIShub2RlLmZsYWdzICYgUGxhY2VtZW50KSkgewogICAgICAgIC8vIEZvdW5kIGl0IQogICAgICAgIHJldHVybiBub2RlLnN0YXRlTm9kZTsKICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gY29tbWl0UGxhY2VtZW50KGZpbmlzaGVkV29yaykgewoKCiAgICB2YXIgcGFyZW50RmliZXIgPSBnZXRIb3N0UGFyZW50RmliZXIoZmluaXNoZWRXb3JrKTsgLy8gTm90ZTogdGhlc2UgdHdvIHZhcmlhYmxlcyAqbXVzdCogYWx3YXlzIGJlIHVwZGF0ZWQgdG9nZXRoZXIuCgogICAgc3dpdGNoIChwYXJlbnRGaWJlci50YWcpIHsKICAgICAgY2FzZSBIb3N0Q29tcG9uZW50OgogICAgICAgIHsKICAgICAgICAgIHZhciBwYXJlbnQgPSBwYXJlbnRGaWJlci5zdGF0ZU5vZGU7CgogICAgICAgICAgaWYgKHBhcmVudEZpYmVyLmZsYWdzICYgQ29udGVudFJlc2V0KSB7CiAgICAgICAgICAgIC8vIFJlc2V0IHRoZSB0ZXh0IGNvbnRlbnQgb2YgdGhlIHBhcmVudCBiZWZvcmUgZG9pbmcgYW55IGluc2VydGlvbnMKICAgICAgICAgICAgcmVzZXRUZXh0Q29udGVudChwYXJlbnQpOyAvLyBDbGVhciBDb250ZW50UmVzZXQgZnJvbSB0aGUgZWZmZWN0IHRhZwoKICAgICAgICAgICAgcGFyZW50RmliZXIuZmxhZ3MgJj0gfkNvbnRlbnRSZXNldDsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgYmVmb3JlID0gZ2V0SG9zdFNpYmxpbmcoZmluaXNoZWRXb3JrKTsgLy8gV2Ugb25seSBoYXZlIHRoZSB0b3AgRmliZXIgdGhhdCB3YXMgaW5zZXJ0ZWQgYnV0IHdlIG5lZWQgdG8gcmVjdXJzZSBkb3duIGl0cwogICAgICAgICAgLy8gY2hpbGRyZW4gdG8gZmluZCBhbGwgdGhlIHRlcm1pbmFsIG5vZGVzLgoKICAgICAgICAgIGluc2VydE9yQXBwZW5kUGxhY2VtZW50Tm9kZShmaW5pc2hlZFdvcmssIGJlZm9yZSwgcGFyZW50KTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgIGNhc2UgSG9zdFJvb3Q6CiAgICAgIGNhc2UgSG9zdFBvcnRhbDoKICAgICAgICB7CiAgICAgICAgICB2YXIgX3BhcmVudCA9IHBhcmVudEZpYmVyLnN0YXRlTm9kZS5jb250YWluZXJJbmZvOwoKICAgICAgICAgIHZhciBfYmVmb3JlID0gZ2V0SG9zdFNpYmxpbmcoZmluaXNoZWRXb3JrKTsKCiAgICAgICAgICBpbnNlcnRPckFwcGVuZFBsYWNlbWVudE5vZGVJbnRvQ29udGFpbmVyKGZpbmlzaGVkV29yaywgX2JlZm9yZSwgX3BhcmVudCk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZS1uby1mYWxsdGhyb3VnaAoKICAgICAgZGVmYXVsdDoKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgaG9zdCBwYXJlbnQgZmliZXIuIFRoaXMgZXJyb3IgaXMgbGlrZWx5IGNhdXNlZCBieSBhIGJ1ZyAnICsgJ2luIFJlYWN0LiBQbGVhc2UgZmlsZSBhbiBpc3N1ZS4nKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGluc2VydE9yQXBwZW5kUGxhY2VtZW50Tm9kZUludG9Db250YWluZXIobm9kZSwgYmVmb3JlLCBwYXJlbnQpIHsKICAgIHZhciB0YWcgPSBub2RlLnRhZzsKICAgIHZhciBpc0hvc3QgPSB0YWcgPT09IEhvc3RDb21wb25lbnQgfHwgdGFnID09PSBIb3N0VGV4dDsKCiAgICBpZiAoaXNIb3N0KSB7CiAgICAgIHZhciBzdGF0ZU5vZGUgPSBub2RlLnN0YXRlTm9kZTsKCiAgICAgIGlmIChiZWZvcmUpIHsKICAgICAgICBpbnNlcnRJbkNvbnRhaW5lckJlZm9yZShwYXJlbnQsIHN0YXRlTm9kZSwgYmVmb3JlKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBhcHBlbmRDaGlsZFRvQ29udGFpbmVyKHBhcmVudCwgc3RhdGVOb2RlKTsKICAgICAgfQogICAgfSBlbHNlIGlmICh0YWcgPT09IEhvc3RQb3J0YWwpIDsgZWxzZSB7CiAgICAgIHZhciBjaGlsZCA9IG5vZGUuY2hpbGQ7CgogICAgICBpZiAoY2hpbGQgIT09IG51bGwpIHsKICAgICAgICBpbnNlcnRPckFwcGVuZFBsYWNlbWVudE5vZGVJbnRvQ29udGFpbmVyKGNoaWxkLCBiZWZvcmUsIHBhcmVudCk7CiAgICAgICAgdmFyIHNpYmxpbmcgPSBjaGlsZC5zaWJsaW5nOwoKICAgICAgICB3aGlsZSAoc2libGluZyAhPT0gbnVsbCkgewogICAgICAgICAgaW5zZXJ0T3JBcHBlbmRQbGFjZW1lbnROb2RlSW50b0NvbnRhaW5lcihzaWJsaW5nLCBiZWZvcmUsIHBhcmVudCk7CiAgICAgICAgICBzaWJsaW5nID0gc2libGluZy5zaWJsaW5nOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gaW5zZXJ0T3JBcHBlbmRQbGFjZW1lbnROb2RlKG5vZGUsIGJlZm9yZSwgcGFyZW50KSB7CiAgICB2YXIgdGFnID0gbm9kZS50YWc7CiAgICB2YXIgaXNIb3N0ID0gdGFnID09PSBIb3N0Q29tcG9uZW50IHx8IHRhZyA9PT0gSG9zdFRleHQ7CgogICAgaWYgKGlzSG9zdCkgewogICAgICB2YXIgc3RhdGVOb2RlID0gbm9kZS5zdGF0ZU5vZGU7CgogICAgICBpZiAoYmVmb3JlKSB7CiAgICAgICAgaW5zZXJ0QmVmb3JlKHBhcmVudCwgc3RhdGVOb2RlLCBiZWZvcmUpOwogICAgICB9IGVsc2UgewogICAgICAgIGFwcGVuZENoaWxkKHBhcmVudCwgc3RhdGVOb2RlKTsKICAgICAgfQogICAgfSBlbHNlIGlmICh0YWcgPT09IEhvc3RQb3J0YWwpIDsgZWxzZSB7CiAgICAgIHZhciBjaGlsZCA9IG5vZGUuY2hpbGQ7CgogICAgICBpZiAoY2hpbGQgIT09IG51bGwpIHsKICAgICAgICBpbnNlcnRPckFwcGVuZFBsYWNlbWVudE5vZGUoY2hpbGQsIGJlZm9yZSwgcGFyZW50KTsKICAgICAgICB2YXIgc2libGluZyA9IGNoaWxkLnNpYmxpbmc7CgogICAgICAgIHdoaWxlIChzaWJsaW5nICE9PSBudWxsKSB7CiAgICAgICAgICBpbnNlcnRPckFwcGVuZFBsYWNlbWVudE5vZGUoc2libGluZywgYmVmb3JlLCBwYXJlbnQpOwogICAgICAgICAgc2libGluZyA9IHNpYmxpbmcuc2libGluZzsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9IC8vIFRoZXNlIGFyZSB0cmFja2VkIG9uIHRoZSBzdGFjayBhcyB3ZSByZWN1cnNpdmVseSB0cmF2ZXJzZSBhCiAgLy8gZGVsZXRlZCBzdWJ0cmVlLgogIC8vIFRPRE86IFVwZGF0ZSB0aGVzZSBkdXJpbmcgdGhlIHdob2xlIG11dGF0aW9uIHBoYXNlLCBub3QganVzdCBkdXJpbmcKICAvLyBhIGRlbGV0aW9uLgoKCiAgdmFyIGhvc3RQYXJlbnQgPSBudWxsOwogIHZhciBob3N0UGFyZW50SXNDb250YWluZXIgPSBmYWxzZTsKCiAgZnVuY3Rpb24gY29tbWl0RGVsZXRpb25FZmZlY3RzKHJvb3QsIHJldHVybkZpYmVyLCBkZWxldGVkRmliZXIpIHsKICAgIHsKICAgICAgLy8gV2Ugb25seSBoYXZlIHRoZSB0b3AgRmliZXIgdGhhdCB3YXMgZGVsZXRlZCBidXQgd2UgbmVlZCB0byByZWN1cnNlIGRvd24gaXRzCiAgICAgIC8vIGNoaWxkcmVuIHRvIGZpbmQgYWxsIHRoZSB0ZXJtaW5hbCBub2Rlcy4KICAgICAgLy8gUmVjdXJzaXZlbHkgZGVsZXRlIGFsbCBob3N0IG5vZGVzIGZyb20gdGhlIHBhcmVudCwgZGV0YWNoIHJlZnMsIGNsZWFuCiAgICAgIC8vIHVwIG1vdW50ZWQgbGF5b3V0IGVmZmVjdHMsIGFuZCBjYWxsIGNvbXBvbmVudFdpbGxVbm1vdW50LgogICAgICAvLyBXZSBvbmx5IG5lZWQgdG8gcmVtb3ZlIHRoZSB0b3Btb3N0IGhvc3QgY2hpbGQgaW4gZWFjaCBicmFuY2guIEJ1dCB0aGVuIHdlCiAgICAgIC8vIHN0aWxsIG5lZWQgdG8ga2VlcCB0cmF2ZXJzaW5nIHRvIHVubW91bnQgZWZmZWN0cywgcmVmcywgYW5kIGNXVS4gVE9ETzogV2UKICAgICAgLy8gY291bGQgc3BsaXQgdGhpcyBpbnRvIHR3byBzZXBhcmF0ZSB0cmF2ZXJzYWxzIGZ1bmN0aW9ucywgd2hlcmUgdGhlIHNlY29uZAogICAgICAvLyBvbmUgZG9lc24ndCBpbmNsdWRlIGFueSByZW1vdmVDaGlsZCBsb2dpYy4gVGhpcyBpcyBtYXliZSB0aGUgc2FtZQogICAgICAvLyBmdW5jdGlvbiBhcyAiZGlzYXBwZWFyTGF5b3V0RWZmZWN0cyIgKG9yIHdoYXRldmVyIHRoYXQgdHVybnMgaW50byBhZnRlcgogICAgICAvLyB0aGUgbGF5b3V0IHBoYXNlIGlzIHJlZmFjdG9yZWQgdG8gdXNlIHJlY3Vyc2lvbikuCiAgICAgIC8vIEJlZm9yZSBzdGFydGluZywgZmluZCB0aGUgbmVhcmVzdCBob3N0IHBhcmVudCBvbiB0aGUgc3RhY2sgc28gd2Uga25vdwogICAgICAvLyB3aGljaCBpbnN0YW5jZS9jb250YWluZXIgdG8gcmVtb3ZlIHRoZSBjaGlsZHJlbiBmcm9tLgogICAgICAvLyBUT0RPOiBJbnN0ZWFkIG9mIHNlYXJjaGluZyB1cCB0aGUgZmliZXIgcmV0dXJuIHBhdGggb24gZXZlcnkgZGVsZXRpb24sIHdlCiAgICAgIC8vIGNhbiB0cmFjayB0aGUgbmVhcmVzdCBob3N0IGNvbXBvbmVudCBvbiB0aGUgSlMgc3RhY2sgYXMgd2UgdHJhdmVyc2UgdGhlCiAgICAgIC8vIHRyZWUgZHVyaW5nIHRoZSBjb21taXQgcGhhc2UuIFRoaXMgd291bGQgbWFrZSBpbnNlcnRpb25zIGZhc3RlciwgdG9vLgogICAgICB2YXIgcGFyZW50ID0gcmV0dXJuRmliZXI7CgogICAgICBmaW5kUGFyZW50OiB3aGlsZSAocGFyZW50ICE9PSBudWxsKSB7CiAgICAgICAgc3dpdGNoIChwYXJlbnQudGFnKSB7CiAgICAgICAgICBjYXNlIEhvc3RDb21wb25lbnQ6CiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBob3N0UGFyZW50ID0gcGFyZW50LnN0YXRlTm9kZTsKICAgICAgICAgICAgICBob3N0UGFyZW50SXNDb250YWluZXIgPSBmYWxzZTsKICAgICAgICAgICAgICBicmVhayBmaW5kUGFyZW50OwogICAgICAgICAgICB9CgogICAgICAgICAgY2FzZSBIb3N0Um9vdDoKICAgICAgICAgICAgewogICAgICAgICAgICAgIGhvc3RQYXJlbnQgPSBwYXJlbnQuc3RhdGVOb2RlLmNvbnRhaW5lckluZm87CiAgICAgICAgICAgICAgaG9zdFBhcmVudElzQ29udGFpbmVyID0gdHJ1ZTsKICAgICAgICAgICAgICBicmVhayBmaW5kUGFyZW50OwogICAgICAgICAgICB9CgogICAgICAgICAgY2FzZSBIb3N0UG9ydGFsOgogICAgICAgICAgICB7CiAgICAgICAgICAgICAgaG9zdFBhcmVudCA9IHBhcmVudC5zdGF0ZU5vZGUuY29udGFpbmVySW5mbzsKICAgICAgICAgICAgICBob3N0UGFyZW50SXNDb250YWluZXIgPSB0cnVlOwogICAgICAgICAgICAgIGJyZWFrIGZpbmRQYXJlbnQ7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHBhcmVudCA9IHBhcmVudC5yZXR1cm47CiAgICAgIH0KCiAgICAgIGlmIChob3N0UGFyZW50ID09PSBudWxsKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdFeHBlY3RlZCB0byBmaW5kIGEgaG9zdCBwYXJlbnQuIFRoaXMgZXJyb3IgaXMgbGlrZWx5IGNhdXNlZCBieSAnICsgJ2EgYnVnIGluIFJlYWN0LiBQbGVhc2UgZmlsZSBhbiBpc3N1ZS4nKTsKICAgICAgfQoKICAgICAgY29tbWl0RGVsZXRpb25FZmZlY3RzT25GaWJlcihyb290LCByZXR1cm5GaWJlciwgZGVsZXRlZEZpYmVyKTsKICAgICAgaG9zdFBhcmVudCA9IG51bGw7CiAgICAgIGhvc3RQYXJlbnRJc0NvbnRhaW5lciA9IGZhbHNlOwogICAgfQoKICAgIGRldGFjaEZpYmVyTXV0YXRpb24oZGVsZXRlZEZpYmVyKTsKICB9CgogIGZ1bmN0aW9uIHJlY3Vyc2l2ZWx5VHJhdmVyc2VEZWxldGlvbkVmZmVjdHMoZmluaXNoZWRSb290LCBuZWFyZXN0TW91bnRlZEFuY2VzdG9yLCBwYXJlbnQpIHsKICAgIC8vIFRPRE86IFVzZSBhIHN0YXRpYyBmbGFnIHRvIHNraXAgdHJlZXMgdGhhdCBkb24ndCBoYXZlIHVubW91bnQgZWZmZWN0cwogICAgdmFyIGNoaWxkID0gcGFyZW50LmNoaWxkOwoKICAgIHdoaWxlIChjaGlsZCAhPT0gbnVsbCkgewogICAgICBjb21taXREZWxldGlvbkVmZmVjdHNPbkZpYmVyKGZpbmlzaGVkUm9vdCwgbmVhcmVzdE1vdW50ZWRBbmNlc3RvciwgY2hpbGQpOwogICAgICBjaGlsZCA9IGNoaWxkLnNpYmxpbmc7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBjb21taXREZWxldGlvbkVmZmVjdHNPbkZpYmVyKGZpbmlzaGVkUm9vdCwgbmVhcmVzdE1vdW50ZWRBbmNlc3RvciwgZGVsZXRlZEZpYmVyKSB7CiAgICBvbkNvbW1pdFVubW91bnQoZGVsZXRlZEZpYmVyKTsgLy8gVGhlIGNhc2VzIGluIHRoaXMgb3V0ZXIgc3dpdGNoIG1vZGlmeSB0aGUgc3RhY2sgYmVmb3JlIHRoZXkgdHJhdmVyc2UKICAgIC8vIGludG8gdGhlaXIgc3VidHJlZS4gVGhlcmUgYXJlIHNpbXBsZXIgY2FzZXMgaW4gdGhlIGlubmVyIHN3aXRjaAogICAgLy8gdGhhdCBkb24ndCBtb2RpZnkgdGhlIHN0YWNrLgoKICAgIHN3aXRjaCAoZGVsZXRlZEZpYmVyLnRhZykgewogICAgICBjYXNlIEhvc3RDb21wb25lbnQ6CiAgICAgICAgewogICAgICAgICAgaWYgKCFvZmZzY3JlZW5TdWJ0cmVlV2FzSGlkZGVuKSB7CiAgICAgICAgICAgIHNhZmVseURldGFjaFJlZihkZWxldGVkRmliZXIsIG5lYXJlc3RNb3VudGVkQW5jZXN0b3IpOwogICAgICAgICAgfSAvLyBJbnRlbnRpb25hbCBmYWxsdGhyb3VnaCB0byBuZXh0IGJyYW5jaAoKICAgICAgICB9CiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZS1uby1mYWxsdGhyb3VnaAoKICAgICAgY2FzZSBIb3N0VGV4dDoKICAgICAgICB7CiAgICAgICAgICAvLyBXZSBvbmx5IG5lZWQgdG8gcmVtb3ZlIHRoZSBuZWFyZXN0IGhvc3QgY2hpbGQuIFNldCB0aGUgaG9zdCBwYXJlbnQKICAgICAgICAgIC8vIHRvIGBudWxsYCBvbiB0aGUgc3RhY2sgdG8gaW5kaWNhdGUgdGhhdCBuZXN0ZWQgY2hpbGRyZW4gZG9uJ3QKICAgICAgICAgIC8vIG5lZWQgdG8gYmUgcmVtb3ZlZC4KICAgICAgICAgIHsKICAgICAgICAgICAgdmFyIHByZXZIb3N0UGFyZW50ID0gaG9zdFBhcmVudDsKICAgICAgICAgICAgdmFyIHByZXZIb3N0UGFyZW50SXNDb250YWluZXIgPSBob3N0UGFyZW50SXNDb250YWluZXI7CiAgICAgICAgICAgIGhvc3RQYXJlbnQgPSBudWxsOwogICAgICAgICAgICByZWN1cnNpdmVseVRyYXZlcnNlRGVsZXRpb25FZmZlY3RzKGZpbmlzaGVkUm9vdCwgbmVhcmVzdE1vdW50ZWRBbmNlc3RvciwgZGVsZXRlZEZpYmVyKTsKICAgICAgICAgICAgaG9zdFBhcmVudCA9IHByZXZIb3N0UGFyZW50OwogICAgICAgICAgICBob3N0UGFyZW50SXNDb250YWluZXIgPSBwcmV2SG9zdFBhcmVudElzQ29udGFpbmVyOwoKICAgICAgICAgICAgaWYgKGhvc3RQYXJlbnQgIT09IG51bGwpIHsKICAgICAgICAgICAgICAvLyBOb3cgdGhhdCBhbGwgdGhlIGNoaWxkIGVmZmVjdHMgaGF2ZSB1bm1vdW50ZWQsIHdlIGNhbiByZW1vdmUgdGhlCiAgICAgICAgICAgICAgLy8gbm9kZSBmcm9tIHRoZSB0cmVlLgogICAgICAgICAgICAgIGlmIChob3N0UGFyZW50SXNDb250YWluZXIpIHsKICAgICAgICAgICAgICAgIHJlbW92ZUNoaWxkRnJvbUNvbnRhaW5lcihob3N0UGFyZW50LCBkZWxldGVkRmliZXIuc3RhdGVOb2RlKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmVtb3ZlQ2hpbGQoaG9zdFBhcmVudCwgZGVsZXRlZEZpYmVyLnN0YXRlTm9kZSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgIGNhc2UgRGVoeWRyYXRlZEZyYWdtZW50OgogICAgICAgIHsKICAgICAgICAgIC8vIERlbGV0ZSB0aGUgZGVoeWRyYXRlZCBzdXNwZW5zZSBib3VuZGFyeSBhbmQgYWxsIG9mIGl0cyBjb250ZW50LgoKCiAgICAgICAgICB7CiAgICAgICAgICAgIGlmIChob3N0UGFyZW50ICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgaWYgKGhvc3RQYXJlbnRJc0NvbnRhaW5lcikgewogICAgICAgICAgICAgICAgY2xlYXJTdXNwZW5zZUJvdW5kYXJ5RnJvbUNvbnRhaW5lcihob3N0UGFyZW50LCBkZWxldGVkRmliZXIuc3RhdGVOb2RlKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgY2xlYXJTdXNwZW5zZUJvdW5kYXJ5KGhvc3RQYXJlbnQsIGRlbGV0ZWRGaWJlci5zdGF0ZU5vZGUpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICBjYXNlIEhvc3RQb3J0YWw6CiAgICAgICAgewogICAgICAgICAgewogICAgICAgICAgICAvLyBXaGVuIHdlIGdvIGludG8gYSBwb3J0YWwsIGl0IGJlY29tZXMgdGhlIHBhcmVudCB0byByZW1vdmUgZnJvbS4KICAgICAgICAgICAgdmFyIF9wcmV2SG9zdFBhcmVudCA9IGhvc3RQYXJlbnQ7CiAgICAgICAgICAgIHZhciBfcHJldkhvc3RQYXJlbnRJc0NvbnRhaW5lciA9IGhvc3RQYXJlbnRJc0NvbnRhaW5lcjsKICAgICAgICAgICAgaG9zdFBhcmVudCA9IGRlbGV0ZWRGaWJlci5zdGF0ZU5vZGUuY29udGFpbmVySW5mbzsKICAgICAgICAgICAgaG9zdFBhcmVudElzQ29udGFpbmVyID0gdHJ1ZTsKICAgICAgICAgICAgcmVjdXJzaXZlbHlUcmF2ZXJzZURlbGV0aW9uRWZmZWN0cyhmaW5pc2hlZFJvb3QsIG5lYXJlc3RNb3VudGVkQW5jZXN0b3IsIGRlbGV0ZWRGaWJlcik7CiAgICAgICAgICAgIGhvc3RQYXJlbnQgPSBfcHJldkhvc3RQYXJlbnQ7CiAgICAgICAgICAgIGhvc3RQYXJlbnRJc0NvbnRhaW5lciA9IF9wcmV2SG9zdFBhcmVudElzQ29udGFpbmVyOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICBjYXNlIEZ1bmN0aW9uQ29tcG9uZW50OgogICAgICBjYXNlIEZvcndhcmRSZWY6CiAgICAgIGNhc2UgTWVtb0NvbXBvbmVudDoKICAgICAgY2FzZSBTaW1wbGVNZW1vQ29tcG9uZW50OgogICAgICAgIHsKICAgICAgICAgIGlmICghb2Zmc2NyZWVuU3VidHJlZVdhc0hpZGRlbikgewogICAgICAgICAgICB2YXIgdXBkYXRlUXVldWUgPSBkZWxldGVkRmliZXIudXBkYXRlUXVldWU7CgogICAgICAgICAgICBpZiAodXBkYXRlUXVldWUgIT09IG51bGwpIHsKICAgICAgICAgICAgICB2YXIgbGFzdEVmZmVjdCA9IHVwZGF0ZVF1ZXVlLmxhc3RFZmZlY3Q7CgogICAgICAgICAgICAgIGlmIChsYXN0RWZmZWN0ICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICB2YXIgZmlyc3RFZmZlY3QgPSBsYXN0RWZmZWN0Lm5leHQ7CiAgICAgICAgICAgICAgICB2YXIgZWZmZWN0ID0gZmlyc3RFZmZlY3Q7CgogICAgICAgICAgICAgICAgZG8gewogICAgICAgICAgICAgICAgICB2YXIgX2VmZmVjdCA9IGVmZmVjdCwKICAgICAgICAgICAgICAgICAgICAgIGRlc3Ryb3kgPSBfZWZmZWN0LmRlc3Ryb3ksCiAgICAgICAgICAgICAgICAgICAgICB0YWcgPSBfZWZmZWN0LnRhZzsKCiAgICAgICAgICAgICAgICAgIGlmIChkZXN0cm95ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoKHRhZyAmIEluc2VydGlvbikgIT09IE5vRmxhZ3MkMSkgewogICAgICAgICAgICAgICAgICAgICAgc2FmZWx5Q2FsbERlc3Ryb3koZGVsZXRlZEZpYmVyLCBuZWFyZXN0TW91bnRlZEFuY2VzdG9yLCBkZXN0cm95KTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCh0YWcgJiBMYXlvdXQpICE9PSBOb0ZsYWdzJDEpIHsKICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgbWFya0NvbXBvbmVudExheW91dEVmZmVjdFVubW91bnRTdGFydGVkKGRlbGV0ZWRGaWJlcik7CiAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgaWYgKCBkZWxldGVkRmliZXIubW9kZSAmIFByb2ZpbGVNb2RlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0TGF5b3V0RWZmZWN0VGltZXIoKTsKICAgICAgICAgICAgICAgICAgICAgICAgc2FmZWx5Q2FsbERlc3Ryb3koZGVsZXRlZEZpYmVyLCBuZWFyZXN0TW91bnRlZEFuY2VzdG9yLCBkZXN0cm95KTsKICAgICAgICAgICAgICAgICAgICAgICAgcmVjb3JkTGF5b3V0RWZmZWN0RHVyYXRpb24oZGVsZXRlZEZpYmVyKTsKICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNhZmVseUNhbGxEZXN0cm95KGRlbGV0ZWRGaWJlciwgbmVhcmVzdE1vdW50ZWRBbmNlc3RvciwgZGVzdHJveSk7CiAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBtYXJrQ29tcG9uZW50TGF5b3V0RWZmZWN0VW5tb3VudFN0b3BwZWQoKTsKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIGVmZmVjdCA9IGVmZmVjdC5uZXh0OwogICAgICAgICAgICAgICAgfSB3aGlsZSAoZWZmZWN0ICE9PSBmaXJzdEVmZmVjdCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgcmVjdXJzaXZlbHlUcmF2ZXJzZURlbGV0aW9uRWZmZWN0cyhmaW5pc2hlZFJvb3QsIG5lYXJlc3RNb3VudGVkQW5jZXN0b3IsIGRlbGV0ZWRGaWJlcik7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgY2FzZSBDbGFzc0NvbXBvbmVudDoKICAgICAgICB7CiAgICAgICAgICBpZiAoIW9mZnNjcmVlblN1YnRyZWVXYXNIaWRkZW4pIHsKICAgICAgICAgICAgc2FmZWx5RGV0YWNoUmVmKGRlbGV0ZWRGaWJlciwgbmVhcmVzdE1vdW50ZWRBbmNlc3Rvcik7CiAgICAgICAgICAgIHZhciBpbnN0YW5jZSA9IGRlbGV0ZWRGaWJlci5zdGF0ZU5vZGU7CgogICAgICAgICAgICBpZiAodHlwZW9mIGluc3RhbmNlLmNvbXBvbmVudFdpbGxVbm1vdW50ID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAgICAgc2FmZWx5Q2FsbENvbXBvbmVudFdpbGxVbm1vdW50KGRlbGV0ZWRGaWJlciwgbmVhcmVzdE1vdW50ZWRBbmNlc3RvciwgaW5zdGFuY2UpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgcmVjdXJzaXZlbHlUcmF2ZXJzZURlbGV0aW9uRWZmZWN0cyhmaW5pc2hlZFJvb3QsIG5lYXJlc3RNb3VudGVkQW5jZXN0b3IsIGRlbGV0ZWRGaWJlcik7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgY2FzZSBTY29wZUNvbXBvbmVudDoKICAgICAgICB7CgogICAgICAgICAgcmVjdXJzaXZlbHlUcmF2ZXJzZURlbGV0aW9uRWZmZWN0cyhmaW5pc2hlZFJvb3QsIG5lYXJlc3RNb3VudGVkQW5jZXN0b3IsIGRlbGV0ZWRGaWJlcik7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgY2FzZSBPZmZzY3JlZW5Db21wb25lbnQ6CiAgICAgICAgewogICAgICAgICAgaWYgKCAvLyBUT0RPOiBSZW1vdmUgdGhpcyBkZWFkIGZsYWcKICAgICAgICAgICBkZWxldGVkRmliZXIubW9kZSAmIENvbmN1cnJlbnRNb2RlKSB7CiAgICAgICAgICAgIC8vIElmIHRoaXMgb2Zmc2NyZWVuIGNvbXBvbmVudCBpcyBoaWRkZW4sIHdlIGFscmVhZHkgdW5tb3VudGVkIGl0LiBCZWZvcmUKICAgICAgICAgICAgLy8gZGVsZXRpbmcgdGhlIGNoaWxkcmVuLCB0cmFjayB0aGF0IGl0J3MgYWxyZWFkeSB1bm1vdW50ZWQgc28gdGhhdCB3ZQogICAgICAgICAgICAvLyBkb24ndCBhdHRlbXB0IHRvIHVubW91bnQgdGhlIGVmZmVjdHMgYWdhaW4uCiAgICAgICAgICAgIC8vIFRPRE86IElmIHRoZSB0cmVlIGlzIGhpZGRlbiwgaW4gbW9zdCBjYXNlcyB3ZSBzaG91bGQgYmUgYWJsZSB0byBza2lwCiAgICAgICAgICAgIC8vIG92ZXIgdGhlIG5lc3RlZCBjaGlsZHJlbiBlbnRpcmVseS4gQW4gZXhjZXB0aW9uIGlzIHdlIGhhdmVuJ3QgeWV0IGZvdW5kCiAgICAgICAgICAgIC8vIHRoZSB0b3Btb3N0IGhvc3Qgbm9kZSB0byBkZWxldGUsIHdoaWNoIHdlIGFscmVhZHkgdHJhY2sgb24gdGhlIHN0YWNrLgogICAgICAgICAgICAvLyBCdXQgdGhlIG90aGVyIGNhc2UgaXMgcG9ydGFscywgd2hpY2ggbmVlZCB0byBiZSBkZXRhY2hlZCBubyBtYXR0ZXIgaG93CiAgICAgICAgICAgIC8vIGRlZXBseSB0aGV5IGFyZSBuZXN0ZWQuIFdlIHNob3VsZCB1c2UgYSBzdWJ0cmVlIGZsYWcgdG8gdHJhY2sgd2hldGhlciBhCiAgICAgICAgICAgIC8vIHN1YnRyZWUgaW5jbHVkZXMgYSBuZXN0ZWQgcG9ydGFsLgogICAgICAgICAgICB2YXIgcHJldk9mZnNjcmVlblN1YnRyZWVXYXNIaWRkZW4gPSBvZmZzY3JlZW5TdWJ0cmVlV2FzSGlkZGVuOwogICAgICAgICAgICBvZmZzY3JlZW5TdWJ0cmVlV2FzSGlkZGVuID0gcHJldk9mZnNjcmVlblN1YnRyZWVXYXNIaWRkZW4gfHwgZGVsZXRlZEZpYmVyLm1lbW9pemVkU3RhdGUgIT09IG51bGw7CiAgICAgICAgICAgIHJlY3Vyc2l2ZWx5VHJhdmVyc2VEZWxldGlvbkVmZmVjdHMoZmluaXNoZWRSb290LCBuZWFyZXN0TW91bnRlZEFuY2VzdG9yLCBkZWxldGVkRmliZXIpOwogICAgICAgICAgICBvZmZzY3JlZW5TdWJ0cmVlV2FzSGlkZGVuID0gcHJldk9mZnNjcmVlblN1YnRyZWVXYXNIaWRkZW47CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZWN1cnNpdmVseVRyYXZlcnNlRGVsZXRpb25FZmZlY3RzKGZpbmlzaGVkUm9vdCwgbmVhcmVzdE1vdW50ZWRBbmNlc3RvciwgZGVsZXRlZEZpYmVyKTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICBkZWZhdWx0OgogICAgICAgIHsKICAgICAgICAgIHJlY3Vyc2l2ZWx5VHJhdmVyc2VEZWxldGlvbkVmZmVjdHMoZmluaXNoZWRSb290LCBuZWFyZXN0TW91bnRlZEFuY2VzdG9yLCBkZWxldGVkRmliZXIpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIGNvbW1pdFN1c3BlbnNlQ2FsbGJhY2soZmluaXNoZWRXb3JrKSB7CiAgICAvLyBUT0RPOiBNb3ZlIHRoaXMgdG8gcGFzc2l2ZSBwaGFzZQogICAgdmFyIG5ld1N0YXRlID0gZmluaXNoZWRXb3JrLm1lbW9pemVkU3RhdGU7CiAgfQoKICBmdW5jdGlvbiBjb21taXRTdXNwZW5zZUh5ZHJhdGlvbkNhbGxiYWNrcyhmaW5pc2hlZFJvb3QsIGZpbmlzaGVkV29yaykgewoKICAgIHZhciBuZXdTdGF0ZSA9IGZpbmlzaGVkV29yay5tZW1vaXplZFN0YXRlOwoKICAgIGlmIChuZXdTdGF0ZSA9PT0gbnVsbCkgewogICAgICB2YXIgY3VycmVudCA9IGZpbmlzaGVkV29yay5hbHRlcm5hdGU7CgogICAgICBpZiAoY3VycmVudCAhPT0gbnVsbCkgewogICAgICAgIHZhciBwcmV2U3RhdGUgPSBjdXJyZW50Lm1lbW9pemVkU3RhdGU7CgogICAgICAgIGlmIChwcmV2U3RhdGUgIT09IG51bGwpIHsKICAgICAgICAgIHZhciBzdXNwZW5zZUluc3RhbmNlID0gcHJldlN0YXRlLmRlaHlkcmF0ZWQ7CgogICAgICAgICAgaWYgKHN1c3BlbnNlSW5zdGFuY2UgIT09IG51bGwpIHsKICAgICAgICAgICAgY29tbWl0SHlkcmF0ZWRTdXNwZW5zZUluc3RhbmNlKHN1c3BlbnNlSW5zdGFuY2UpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gYXR0YWNoU3VzcGVuc2VSZXRyeUxpc3RlbmVycyhmaW5pc2hlZFdvcmspIHsKICAgIC8vIElmIHRoaXMgYm91bmRhcnkganVzdCB0aW1lZCBvdXQsIHRoZW4gaXQgd2lsbCBoYXZlIGEgc2V0IG9mIHdha2VhYmxlcy4KICAgIC8vIEZvciBlYWNoIHdha2VhYmxlLCBhdHRhY2ggYSBsaXN0ZW5lciBzbyB0aGF0IHdoZW4gaXQgcmVzb2x2ZXMsIFJlYWN0CiAgICAvLyBhdHRlbXB0cyB0byByZS1yZW5kZXIgdGhlIGJvdW5kYXJ5IGluIHRoZSBwcmltYXJ5IChwcmUtdGltZW91dCkgc3RhdGUuCiAgICB2YXIgd2FrZWFibGVzID0gZmluaXNoZWRXb3JrLnVwZGF0ZVF1ZXVlOwoKICAgIGlmICh3YWtlYWJsZXMgIT09IG51bGwpIHsKICAgICAgZmluaXNoZWRXb3JrLnVwZGF0ZVF1ZXVlID0gbnVsbDsKICAgICAgdmFyIHJldHJ5Q2FjaGUgPSBmaW5pc2hlZFdvcmsuc3RhdGVOb2RlOwoKICAgICAgaWYgKHJldHJ5Q2FjaGUgPT09IG51bGwpIHsKICAgICAgICByZXRyeUNhY2hlID0gZmluaXNoZWRXb3JrLnN0YXRlTm9kZSA9IG5ldyBQb3NzaWJseVdlYWtTZXQoKTsKICAgICAgfQoKICAgICAgd2FrZWFibGVzLmZvckVhY2goZnVuY3Rpb24gKHdha2VhYmxlKSB7CiAgICAgICAgLy8gTWVtb2l6ZSB1c2luZyB0aGUgYm91bmRhcnkgZmliZXIgdG8gcHJldmVudCByZWR1bmRhbnQgbGlzdGVuZXJzLgogICAgICAgIHZhciByZXRyeSA9IHJlc29sdmVSZXRyeVdha2VhYmxlLmJpbmQobnVsbCwgZmluaXNoZWRXb3JrLCB3YWtlYWJsZSk7CgogICAgICAgIGlmICghcmV0cnlDYWNoZS5oYXMod2FrZWFibGUpKSB7CiAgICAgICAgICByZXRyeUNhY2hlLmFkZCh3YWtlYWJsZSk7CgogICAgICAgICAgewogICAgICAgICAgICBpZiAoaXNEZXZUb29sc1ByZXNlbnQpIHsKICAgICAgICAgICAgICBpZiAoaW5Qcm9ncmVzc0xhbmVzICE9PSBudWxsICYmIGluUHJvZ3Jlc3NSb290ICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAvLyBJZiB3ZSBoYXZlIHBlbmRpbmcgd29yayBzdGlsbCwgYXNzb2NpYXRlIHRoZSBvcmlnaW5hbCB1cGRhdGVycyB3aXRoIGl0LgogICAgICAgICAgICAgICAgcmVzdG9yZVBlbmRpbmdVcGRhdGVycyhpblByb2dyZXNzUm9vdCwgaW5Qcm9ncmVzc0xhbmVzKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdGhyb3cgRXJyb3IoJ0V4cGVjdGVkIGZpbmlzaGVkIHJvb3QgYW5kIGxhbmVzIHRvIGJlIHNldC4gVGhpcyBpcyBhIGJ1ZyBpbiBSZWFjdC4nKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICB3YWtlYWJsZS50aGVuKHJldHJ5LCByZXRyeSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9IC8vIFRoaXMgZnVuY3Rpb24gZGV0ZWN0cyB3aGVuIGEgU3VzcGVuc2UgYm91bmRhcnkgZ29lcyBmcm9tIHZpc2libGUgdG8gaGlkZGVuLgogIGZ1bmN0aW9uIGNvbW1pdE11dGF0aW9uRWZmZWN0cyhyb290LCBmaW5pc2hlZFdvcmssIGNvbW1pdHRlZExhbmVzKSB7CiAgICBpblByb2dyZXNzTGFuZXMgPSBjb21taXR0ZWRMYW5lczsKICAgIGluUHJvZ3Jlc3NSb290ID0gcm9vdDsKICAgIHNldEN1cnJlbnRGaWJlcihmaW5pc2hlZFdvcmspOwogICAgY29tbWl0TXV0YXRpb25FZmZlY3RzT25GaWJlcihmaW5pc2hlZFdvcmssIHJvb3QpOwogICAgc2V0Q3VycmVudEZpYmVyKGZpbmlzaGVkV29yayk7CiAgICBpblByb2dyZXNzTGFuZXMgPSBudWxsOwogICAgaW5Qcm9ncmVzc1Jvb3QgPSBudWxsOwogIH0KCiAgZnVuY3Rpb24gcmVjdXJzaXZlbHlUcmF2ZXJzZU11dGF0aW9uRWZmZWN0cyhyb290LCBwYXJlbnRGaWJlciwgbGFuZXMpIHsKICAgIC8vIERlbGV0aW9ucyBlZmZlY3RzIGNhbiBiZSBzY2hlZHVsZWQgb24gYW55IGZpYmVyIHR5cGUuIFRoZXkgbmVlZCB0byBoYXBwZW4KICAgIC8vIGJlZm9yZSB0aGUgY2hpbGRyZW4gZWZmZWN0cyBoYWUgZmlyZWQuCiAgICB2YXIgZGVsZXRpb25zID0gcGFyZW50RmliZXIuZGVsZXRpb25zOwoKICAgIGlmIChkZWxldGlvbnMgIT09IG51bGwpIHsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkZWxldGlvbnMubGVuZ3RoOyBpKyspIHsKICAgICAgICB2YXIgY2hpbGRUb0RlbGV0ZSA9IGRlbGV0aW9uc1tpXTsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgIGNvbW1pdERlbGV0aW9uRWZmZWN0cyhyb290LCBwYXJlbnRGaWJlciwgY2hpbGRUb0RlbGV0ZSk7CiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgIGNhcHR1cmVDb21taXRQaGFzZUVycm9yKGNoaWxkVG9EZWxldGUsIHBhcmVudEZpYmVyLCBlcnJvcik7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgdmFyIHByZXZEZWJ1Z0ZpYmVyID0gZ2V0Q3VycmVudEZpYmVyKCk7CgogICAgaWYgKHBhcmVudEZpYmVyLnN1YnRyZWVGbGFncyAmIE11dGF0aW9uTWFzaykgewogICAgICB2YXIgY2hpbGQgPSBwYXJlbnRGaWJlci5jaGlsZDsKCiAgICAgIHdoaWxlIChjaGlsZCAhPT0gbnVsbCkgewogICAgICAgIHNldEN1cnJlbnRGaWJlcihjaGlsZCk7CiAgICAgICAgY29tbWl0TXV0YXRpb25FZmZlY3RzT25GaWJlcihjaGlsZCwgcm9vdCk7CiAgICAgICAgY2hpbGQgPSBjaGlsZC5zaWJsaW5nOwogICAgICB9CiAgICB9CgogICAgc2V0Q3VycmVudEZpYmVyKHByZXZEZWJ1Z0ZpYmVyKTsKICB9CgogIGZ1bmN0aW9uIGNvbW1pdE11dGF0aW9uRWZmZWN0c09uRmliZXIoZmluaXNoZWRXb3JrLCByb290LCBsYW5lcykgewogICAgdmFyIGN1cnJlbnQgPSBmaW5pc2hlZFdvcmsuYWx0ZXJuYXRlOwogICAgdmFyIGZsYWdzID0gZmluaXNoZWRXb3JrLmZsYWdzOyAvLyBUaGUgZWZmZWN0IGZsYWcgc2hvdWxkIGJlIGNoZWNrZWQgKmFmdGVyKiB3ZSByZWZpbmUgdGhlIHR5cGUgb2YgZmliZXIsCiAgICAvLyBiZWNhdXNlIHRoZSBmaWJlciB0YWcgaXMgbW9yZSBzcGVjaWZpYy4gQW4gZXhjZXB0aW9uIGlzIGFueSBmbGFnIHJlbGF0ZWQKICAgIC8vIHRvIHJlY29uY2lsYXRpb24sIGJlY2F1c2UgdGhvc2UgY2FuIGJlIHNldCBvbiBhbGwgZmliZXIgdHlwZXMuCgogICAgc3dpdGNoIChmaW5pc2hlZFdvcmsudGFnKSB7CiAgICAgIGNhc2UgRnVuY3Rpb25Db21wb25lbnQ6CiAgICAgIGNhc2UgRm9yd2FyZFJlZjoKICAgICAgY2FzZSBNZW1vQ29tcG9uZW50OgogICAgICBjYXNlIFNpbXBsZU1lbW9Db21wb25lbnQ6CiAgICAgICAgewogICAgICAgICAgcmVjdXJzaXZlbHlUcmF2ZXJzZU11dGF0aW9uRWZmZWN0cyhyb290LCBmaW5pc2hlZFdvcmspOwogICAgICAgICAgY29tbWl0UmVjb25jaWxpYXRpb25FZmZlY3RzKGZpbmlzaGVkV29yayk7CgogICAgICAgICAgaWYgKGZsYWdzICYgVXBkYXRlKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgY29tbWl0SG9va0VmZmVjdExpc3RVbm1vdW50KEluc2VydGlvbiB8IEhhc0VmZmVjdCwgZmluaXNoZWRXb3JrLCBmaW5pc2hlZFdvcmsucmV0dXJuKTsKICAgICAgICAgICAgICBjb21taXRIb29rRWZmZWN0TGlzdE1vdW50KEluc2VydGlvbiB8IEhhc0VmZmVjdCwgZmluaXNoZWRXb3JrKTsKICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgICBjYXB0dXJlQ29tbWl0UGhhc2VFcnJvcihmaW5pc2hlZFdvcmssIGZpbmlzaGVkV29yay5yZXR1cm4sIGVycm9yKTsKICAgICAgICAgICAgfSAvLyBMYXlvdXQgZWZmZWN0cyBhcmUgZGVzdHJveWVkIGR1cmluZyB0aGUgbXV0YXRpb24gcGhhc2Ugc28gdGhhdCBhbGwKICAgICAgICAgICAgLy8gZGVzdHJveSBmdW5jdGlvbnMgZm9yIGFsbCBmaWJlcnMgYXJlIGNhbGxlZCBiZWZvcmUgYW55IGNyZWF0ZSBmdW5jdGlvbnMuCiAgICAgICAgICAgIC8vIFRoaXMgcHJldmVudHMgc2libGluZyBjb21wb25lbnQgZWZmZWN0cyBmcm9tIGludGVyZmVyaW5nIHdpdGggZWFjaCBvdGhlciwKICAgICAgICAgICAgLy8gZS5nLiBhIGRlc3Ryb3kgZnVuY3Rpb24gaW4gb25lIGNvbXBvbmVudCBzaG91bGQgbmV2ZXIgb3ZlcnJpZGUgYSByZWYgc2V0CiAgICAgICAgICAgIC8vIGJ5IGEgY3JlYXRlIGZ1bmN0aW9uIGluIGFub3RoZXIgY29tcG9uZW50IGR1cmluZyB0aGUgc2FtZSBjb21taXQuCgoKICAgICAgICAgICAgaWYgKCBmaW5pc2hlZFdvcmsubW9kZSAmIFByb2ZpbGVNb2RlKSB7CiAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHN0YXJ0TGF5b3V0RWZmZWN0VGltZXIoKTsKICAgICAgICAgICAgICAgIGNvbW1pdEhvb2tFZmZlY3RMaXN0VW5tb3VudChMYXlvdXQgfCBIYXNFZmZlY3QsIGZpbmlzaGVkV29yaywgZmluaXNoZWRXb3JrLnJldHVybik7CiAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgICAgIGNhcHR1cmVDb21taXRQaGFzZUVycm9yKGZpbmlzaGVkV29yaywgZmluaXNoZWRXb3JrLnJldHVybiwgZXJyb3IpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgcmVjb3JkTGF5b3V0RWZmZWN0RHVyYXRpb24oZmluaXNoZWRXb3JrKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgY29tbWl0SG9va0VmZmVjdExpc3RVbm1vdW50KExheW91dCB8IEhhc0VmZmVjdCwgZmluaXNoZWRXb3JrLCBmaW5pc2hlZFdvcmsucmV0dXJuKTsKICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICAgICAgY2FwdHVyZUNvbW1pdFBoYXNlRXJyb3IoZmluaXNoZWRXb3JrLCBmaW5pc2hlZFdvcmsucmV0dXJuLCBlcnJvcik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgIGNhc2UgQ2xhc3NDb21wb25lbnQ6CiAgICAgICAgewogICAgICAgICAgcmVjdXJzaXZlbHlUcmF2ZXJzZU11dGF0aW9uRWZmZWN0cyhyb290LCBmaW5pc2hlZFdvcmspOwogICAgICAgICAgY29tbWl0UmVjb25jaWxpYXRpb25FZmZlY3RzKGZpbmlzaGVkV29yayk7CgogICAgICAgICAgaWYgKGZsYWdzICYgUmVmKSB7CiAgICAgICAgICAgIGlmIChjdXJyZW50ICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgc2FmZWx5RGV0YWNoUmVmKGN1cnJlbnQsIGN1cnJlbnQucmV0dXJuKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICBjYXNlIEhvc3RDb21wb25lbnQ6CiAgICAgICAgewogICAgICAgICAgcmVjdXJzaXZlbHlUcmF2ZXJzZU11dGF0aW9uRWZmZWN0cyhyb290LCBmaW5pc2hlZFdvcmspOwogICAgICAgICAgY29tbWl0UmVjb25jaWxpYXRpb25FZmZlY3RzKGZpbmlzaGVkV29yayk7CgogICAgICAgICAgaWYgKGZsYWdzICYgUmVmKSB7CiAgICAgICAgICAgIGlmIChjdXJyZW50ICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgc2FmZWx5RGV0YWNoUmVmKGN1cnJlbnQsIGN1cnJlbnQucmV0dXJuKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHsKICAgICAgICAgICAgLy8gVE9ETzogQ29udGVudFJlc2V0IGdldHMgY2xlYXJlZCBieSB0aGUgY2hpbGRyZW4gZHVyaW5nIHRoZSBjb21taXQKICAgICAgICAgICAgLy8gcGhhc2UuIFRoaXMgaXMgYSByZWZhY3RvciBoYXphcmQgYmVjYXVzZSBpdCBtZWFucyB3ZSBtdXN0IHJlYWQKICAgICAgICAgICAgLy8gZmxhZ3MgdGhlIGZsYWdzIGFmdGVyIGBjb21taXRSZWNvbmNpbGlhdGlvbkVmZmVjdHNgIGhhcyBhbHJlYWR5IHJ1bjsKICAgICAgICAgICAgLy8gdGhlIG9yZGVyIG1hdHRlcnMuIFdlIHNob3VsZCByZWZhY3RvciBzbyB0aGF0IENvbnRlbnRSZXNldCBkb2VzIG5vdAogICAgICAgICAgICAvLyByZWx5IG9uIG11dGF0aW5nIHRoZSBmbGFnIGR1cmluZyBjb21taXQuIExpa2UgYnkgc2V0dGluZyBhIGZsYWcKICAgICAgICAgICAgLy8gZHVyaW5nIHRoZSByZW5kZXIgcGhhc2UgaW5zdGVhZC4KICAgICAgICAgICAgaWYgKGZpbmlzaGVkV29yay5mbGFncyAmIENvbnRlbnRSZXNldCkgewogICAgICAgICAgICAgIHZhciBpbnN0YW5jZSA9IGZpbmlzaGVkV29yay5zdGF0ZU5vZGU7CgogICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICByZXNldFRleHRDb250ZW50KGluc3RhbmNlKTsKICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICAgICAgY2FwdHVyZUNvbW1pdFBoYXNlRXJyb3IoZmluaXNoZWRXb3JrLCBmaW5pc2hlZFdvcmsucmV0dXJuLCBlcnJvcik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoZmxhZ3MgJiBVcGRhdGUpIHsKICAgICAgICAgICAgICB2YXIgX2luc3RhbmNlNCA9IGZpbmlzaGVkV29yay5zdGF0ZU5vZGU7CgogICAgICAgICAgICAgIGlmIChfaW5zdGFuY2U0ICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIC8vIENvbW1pdCB0aGUgd29yayBwcmVwYXJlZCBlYXJsaWVyLgogICAgICAgICAgICAgICAgdmFyIG5ld1Byb3BzID0gZmluaXNoZWRXb3JrLm1lbW9pemVkUHJvcHM7IC8vIEZvciBoeWRyYXRpb24gd2UgcmV1c2UgdGhlIHVwZGF0ZSBwYXRoIGJ1dCB3ZSB0cmVhdCB0aGUgb2xkUHJvcHMKICAgICAgICAgICAgICAgIC8vIGFzIHRoZSBuZXdQcm9wcy4gVGhlIHVwZGF0ZVBheWxvYWQgd2lsbCBjb250YWluIHRoZSByZWFsIGNoYW5nZSBpbgogICAgICAgICAgICAgICAgLy8gdGhpcyBjYXNlLgoKICAgICAgICAgICAgICAgIHZhciBvbGRQcm9wcyA9IGN1cnJlbnQgIT09IG51bGwgPyBjdXJyZW50Lm1lbW9pemVkUHJvcHMgOiBuZXdQcm9wczsKICAgICAgICAgICAgICAgIHZhciB0eXBlID0gZmluaXNoZWRXb3JrLnR5cGU7IC8vIFRPRE86IFR5cGUgdGhlIHVwZGF0ZVF1ZXVlIHRvIGJlIHNwZWNpZmljIHRvIGhvc3QgY29tcG9uZW50cy4KCiAgICAgICAgICAgICAgICB2YXIgdXBkYXRlUGF5bG9hZCA9IGZpbmlzaGVkV29yay51cGRhdGVRdWV1ZTsKICAgICAgICAgICAgICAgIGZpbmlzaGVkV29yay51cGRhdGVRdWV1ZSA9IG51bGw7CgogICAgICAgICAgICAgICAgaWYgKHVwZGF0ZVBheWxvYWQgIT09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBjb21taXRVcGRhdGUoX2luc3RhbmNlNCwgdXBkYXRlUGF5bG9hZCwgdHlwZSwgb2xkUHJvcHMsIG5ld1Byb3BzLCBmaW5pc2hlZFdvcmspOwogICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICAgICAgICAgIGNhcHR1cmVDb21taXRQaGFzZUVycm9yKGZpbmlzaGVkV29yaywgZmluaXNoZWRXb3JrLnJldHVybiwgZXJyb3IpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgIGNhc2UgSG9zdFRleHQ6CiAgICAgICAgewogICAgICAgICAgcmVjdXJzaXZlbHlUcmF2ZXJzZU11dGF0aW9uRWZmZWN0cyhyb290LCBmaW5pc2hlZFdvcmspOwogICAgICAgICAgY29tbWl0UmVjb25jaWxpYXRpb25FZmZlY3RzKGZpbmlzaGVkV29yayk7CgogICAgICAgICAgaWYgKGZsYWdzICYgVXBkYXRlKSB7CiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpZiAoZmluaXNoZWRXb3JrLnN0YXRlTm9kZSA9PT0gbnVsbCkgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGlzIHNob3VsZCBoYXZlIGEgdGV4dCBub2RlIGluaXRpYWxpemVkLiBUaGlzIGVycm9yIGlzIGxpa2VseSAnICsgJ2NhdXNlZCBieSBhIGJ1ZyBpbiBSZWFjdC4gUGxlYXNlIGZpbGUgYW4gaXNzdWUuJyk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB2YXIgdGV4dEluc3RhbmNlID0gZmluaXNoZWRXb3JrLnN0YXRlTm9kZTsKICAgICAgICAgICAgICB2YXIgbmV3VGV4dCA9IGZpbmlzaGVkV29yay5tZW1vaXplZFByb3BzOyAvLyBGb3IgaHlkcmF0aW9uIHdlIHJldXNlIHRoZSB1cGRhdGUgcGF0aCBidXQgd2UgdHJlYXQgdGhlIG9sZFByb3BzCiAgICAgICAgICAgICAgLy8gYXMgdGhlIG5ld1Byb3BzLiBUaGUgdXBkYXRlUGF5bG9hZCB3aWxsIGNvbnRhaW4gdGhlIHJlYWwgY2hhbmdlIGluCiAgICAgICAgICAgICAgLy8gdGhpcyBjYXNlLgoKICAgICAgICAgICAgICB2YXIgb2xkVGV4dCA9IGN1cnJlbnQgIT09IG51bGwgPyBjdXJyZW50Lm1lbW9pemVkUHJvcHMgOiBuZXdUZXh0OwoKICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgY29tbWl0VGV4dFVwZGF0ZSh0ZXh0SW5zdGFuY2UsIG9sZFRleHQsIG5ld1RleHQpOwogICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgICBjYXB0dXJlQ29tbWl0UGhhc2VFcnJvcihmaW5pc2hlZFdvcmssIGZpbmlzaGVkV29yay5yZXR1cm4sIGVycm9yKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgY2FzZSBIb3N0Um9vdDoKICAgICAgICB7CiAgICAgICAgICByZWN1cnNpdmVseVRyYXZlcnNlTXV0YXRpb25FZmZlY3RzKHJvb3QsIGZpbmlzaGVkV29yayk7CiAgICAgICAgICBjb21taXRSZWNvbmNpbGlhdGlvbkVmZmVjdHMoZmluaXNoZWRXb3JrKTsKCiAgICAgICAgICBpZiAoZmxhZ3MgJiBVcGRhdGUpIHsKICAgICAgICAgICAgewogICAgICAgICAgICAgIGlmIChjdXJyZW50ICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICB2YXIgcHJldlJvb3RTdGF0ZSA9IGN1cnJlbnQubWVtb2l6ZWRTdGF0ZTsKCiAgICAgICAgICAgICAgICBpZiAocHJldlJvb3RTdGF0ZS5pc0RlaHlkcmF0ZWQpIHsKICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBjb21taXRIeWRyYXRlZENvbnRhaW5lcihyb290LmNvbnRhaW5lckluZm8pOwogICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICAgICAgICAgIGNhcHR1cmVDb21taXRQaGFzZUVycm9yKGZpbmlzaGVkV29yaywgZmluaXNoZWRXb3JrLnJldHVybiwgZXJyb3IpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgIGNhc2UgSG9zdFBvcnRhbDoKICAgICAgICB7CiAgICAgICAgICByZWN1cnNpdmVseVRyYXZlcnNlTXV0YXRpb25FZmZlY3RzKHJvb3QsIGZpbmlzaGVkV29yayk7CiAgICAgICAgICBjb21taXRSZWNvbmNpbGlhdGlvbkVmZmVjdHMoZmluaXNoZWRXb3JrKTsKCiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgY2FzZSBTdXNwZW5zZUNvbXBvbmVudDoKICAgICAgICB7CiAgICAgICAgICByZWN1cnNpdmVseVRyYXZlcnNlTXV0YXRpb25FZmZlY3RzKHJvb3QsIGZpbmlzaGVkV29yayk7CiAgICAgICAgICBjb21taXRSZWNvbmNpbGlhdGlvbkVmZmVjdHMoZmluaXNoZWRXb3JrKTsKICAgICAgICAgIHZhciBvZmZzY3JlZW5GaWJlciA9IGZpbmlzaGVkV29yay5jaGlsZDsKCiAgICAgICAgICBpZiAob2Zmc2NyZWVuRmliZXIuZmxhZ3MgJiBWaXNpYmlsaXR5KSB7CiAgICAgICAgICAgIHZhciBvZmZzY3JlZW5JbnN0YW5jZSA9IG9mZnNjcmVlbkZpYmVyLnN0YXRlTm9kZTsKICAgICAgICAgICAgdmFyIG5ld1N0YXRlID0gb2Zmc2NyZWVuRmliZXIubWVtb2l6ZWRTdGF0ZTsKICAgICAgICAgICAgdmFyIGlzSGlkZGVuID0gbmV3U3RhdGUgIT09IG51bGw7IC8vIFRyYWNrIHRoZSBjdXJyZW50IHN0YXRlIG9uIHRoZSBPZmZzY3JlZW4gaW5zdGFuY2Ugc28gd2UgY2FuCiAgICAgICAgICAgIC8vIHJlYWQgaXQgZHVyaW5nIGFuIGV2ZW50CgogICAgICAgICAgICBvZmZzY3JlZW5JbnN0YW5jZS5pc0hpZGRlbiA9IGlzSGlkZGVuOwoKICAgICAgICAgICAgaWYgKGlzSGlkZGVuKSB7CiAgICAgICAgICAgICAgdmFyIHdhc0hpZGRlbiA9IG9mZnNjcmVlbkZpYmVyLmFsdGVybmF0ZSAhPT0gbnVsbCAmJiBvZmZzY3JlZW5GaWJlci5hbHRlcm5hdGUubWVtb2l6ZWRTdGF0ZSAhPT0gbnVsbDsKCiAgICAgICAgICAgICAgaWYgKCF3YXNIaWRkZW4pIHsKICAgICAgICAgICAgICAgIC8vIFRPRE86IE1vdmUgdG8gcGFzc2l2ZSBwaGFzZQogICAgICAgICAgICAgICAgbWFya0NvbW1pdFRpbWVPZkZhbGxiYWNrKCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGZsYWdzICYgVXBkYXRlKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgY29tbWl0U3VzcGVuc2VDYWxsYmFjayhmaW5pc2hlZFdvcmspOwogICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICAgIGNhcHR1cmVDb21taXRQaGFzZUVycm9yKGZpbmlzaGVkV29yaywgZmluaXNoZWRXb3JrLnJldHVybiwgZXJyb3IpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBhdHRhY2hTdXNwZW5zZVJldHJ5TGlzdGVuZXJzKGZpbmlzaGVkV29yayk7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgIGNhc2UgT2Zmc2NyZWVuQ29tcG9uZW50OgogICAgICAgIHsKICAgICAgICAgIHZhciBfd2FzSGlkZGVuID0gY3VycmVudCAhPT0gbnVsbCAmJiBjdXJyZW50Lm1lbW9pemVkU3RhdGUgIT09IG51bGw7CgogICAgICAgICAgaWYgKCAvLyBUT0RPOiBSZW1vdmUgdGhpcyBkZWFkIGZsYWcKICAgICAgICAgICBmaW5pc2hlZFdvcmsubW9kZSAmIENvbmN1cnJlbnRNb2RlKSB7CiAgICAgICAgICAgIC8vIEJlZm9yZSBjb21taXR0aW5nIHRoZSBjaGlsZHJlbiwgdHJhY2sgb24gdGhlIHN0YWNrIHdoZXRoZXIgdGhpcwogICAgICAgICAgICAvLyBvZmZzY3JlZW4gc3VidHJlZSB3YXMgYWxyZWFkeSBoaWRkZW4sIHNvIHRoYXQgd2UgZG9uJ3QgdW5tb3VudCB0aGUKICAgICAgICAgICAgLy8gZWZmZWN0cyBhZ2Fpbi4KICAgICAgICAgICAgdmFyIHByZXZPZmZzY3JlZW5TdWJ0cmVlV2FzSGlkZGVuID0gb2Zmc2NyZWVuU3VidHJlZVdhc0hpZGRlbjsKICAgICAgICAgICAgb2Zmc2NyZWVuU3VidHJlZVdhc0hpZGRlbiA9IHByZXZPZmZzY3JlZW5TdWJ0cmVlV2FzSGlkZGVuIHx8IF93YXNIaWRkZW47CiAgICAgICAgICAgIHJlY3Vyc2l2ZWx5VHJhdmVyc2VNdXRhdGlvbkVmZmVjdHMocm9vdCwgZmluaXNoZWRXb3JrKTsKICAgICAgICAgICAgb2Zmc2NyZWVuU3VidHJlZVdhc0hpZGRlbiA9IHByZXZPZmZzY3JlZW5TdWJ0cmVlV2FzSGlkZGVuOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVjdXJzaXZlbHlUcmF2ZXJzZU11dGF0aW9uRWZmZWN0cyhyb290LCBmaW5pc2hlZFdvcmspOwogICAgICAgICAgfQoKICAgICAgICAgIGNvbW1pdFJlY29uY2lsaWF0aW9uRWZmZWN0cyhmaW5pc2hlZFdvcmspOwoKICAgICAgICAgIGlmIChmbGFncyAmIFZpc2liaWxpdHkpIHsKICAgICAgICAgICAgdmFyIF9vZmZzY3JlZW5JbnN0YW5jZSA9IGZpbmlzaGVkV29yay5zdGF0ZU5vZGU7CiAgICAgICAgICAgIHZhciBfbmV3U3RhdGUgPSBmaW5pc2hlZFdvcmsubWVtb2l6ZWRTdGF0ZTsKCiAgICAgICAgICAgIHZhciBfaXNIaWRkZW4gPSBfbmV3U3RhdGUgIT09IG51bGw7CgogICAgICAgICAgICB2YXIgb2Zmc2NyZWVuQm91bmRhcnkgPSBmaW5pc2hlZFdvcms7IC8vIFRyYWNrIHRoZSBjdXJyZW50IHN0YXRlIG9uIHRoZSBPZmZzY3JlZW4gaW5zdGFuY2Ugc28gd2UgY2FuCiAgICAgICAgICAgIC8vIHJlYWQgaXQgZHVyaW5nIGFuIGV2ZW50CgogICAgICAgICAgICBfb2Zmc2NyZWVuSW5zdGFuY2UuaXNIaWRkZW4gPSBfaXNIaWRkZW47CgogICAgICAgICAgICB7CiAgICAgICAgICAgICAgaWYgKF9pc0hpZGRlbikgewogICAgICAgICAgICAgICAgaWYgKCFfd2FzSGlkZGVuKSB7CiAgICAgICAgICAgICAgICAgIGlmICgob2Zmc2NyZWVuQm91bmRhcnkubW9kZSAmIENvbmN1cnJlbnRNb2RlKSAhPT0gTm9Nb2RlKSB7CiAgICAgICAgICAgICAgICAgICAgbmV4dEVmZmVjdCA9IG9mZnNjcmVlbkJvdW5kYXJ5OwogICAgICAgICAgICAgICAgICAgIHZhciBvZmZzY3JlZW5DaGlsZCA9IG9mZnNjcmVlbkJvdW5kYXJ5LmNoaWxkOwoKICAgICAgICAgICAgICAgICAgICB3aGlsZSAob2Zmc2NyZWVuQ2hpbGQgIT09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICAgIG5leHRFZmZlY3QgPSBvZmZzY3JlZW5DaGlsZDsKICAgICAgICAgICAgICAgICAgICAgIGRpc2FwcGVhckxheW91dEVmZmVjdHNfYmVnaW4ob2Zmc2NyZWVuQ2hpbGQpOwogICAgICAgICAgICAgICAgICAgICAgb2Zmc2NyZWVuQ2hpbGQgPSBvZmZzY3JlZW5DaGlsZC5zaWJsaW5nOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgewogICAgICAgICAgICAgIC8vIFRPRE86IFRoaXMgbmVlZHMgdG8gcnVuIHdoZW5ldmVyIHRoZXJlJ3MgYW4gaW5zZXJ0aW9uIG9yIHVwZGF0ZQogICAgICAgICAgICAgIC8vIGluc2lkZSBhIGhpZGRlbiBPZmZzY3JlZW4gdHJlZS4KICAgICAgICAgICAgICBoaWRlT3JVbmhpZGVBbGxDaGlsZHJlbihvZmZzY3JlZW5Cb3VuZGFyeSwgX2lzSGlkZGVuKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICBjYXNlIFN1c3BlbnNlTGlzdENvbXBvbmVudDoKICAgICAgICB7CiAgICAgICAgICByZWN1cnNpdmVseVRyYXZlcnNlTXV0YXRpb25FZmZlY3RzKHJvb3QsIGZpbmlzaGVkV29yayk7CiAgICAgICAgICBjb21taXRSZWNvbmNpbGlhdGlvbkVmZmVjdHMoZmluaXNoZWRXb3JrKTsKCiAgICAgICAgICBpZiAoZmxhZ3MgJiBVcGRhdGUpIHsKICAgICAgICAgICAgYXR0YWNoU3VzcGVuc2VSZXRyeUxpc3RlbmVycyhmaW5pc2hlZFdvcmspOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICBjYXNlIFNjb3BlQ29tcG9uZW50OgogICAgICAgIHsKCiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgZGVmYXVsdDoKICAgICAgICB7CiAgICAgICAgICByZWN1cnNpdmVseVRyYXZlcnNlTXV0YXRpb25FZmZlY3RzKHJvb3QsIGZpbmlzaGVkV29yayk7CiAgICAgICAgICBjb21taXRSZWNvbmNpbGlhdGlvbkVmZmVjdHMoZmluaXNoZWRXb3JrKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiBjb21taXRSZWNvbmNpbGlhdGlvbkVmZmVjdHMoZmluaXNoZWRXb3JrKSB7CiAgICAvLyBQbGFjZW1lbnQgZWZmZWN0cyAoaW5zZXJ0aW9ucywgcmVvcmRlcnMpIGNhbiBiZSBzY2hlZHVsZWQgb24gYW55IGZpYmVyCiAgICAvLyB0eXBlLiBUaGV5IG5lZWRzIHRvIGhhcHBlbiBhZnRlciB0aGUgY2hpbGRyZW4gZWZmZWN0cyBoYXZlIGZpcmVkLCBidXQKICAgIC8vIGJlZm9yZSB0aGUgZWZmZWN0cyBvbiB0aGlzIGZpYmVyIGhhdmUgZmlyZWQuCiAgICB2YXIgZmxhZ3MgPSBmaW5pc2hlZFdvcmsuZmxhZ3M7CgogICAgaWYgKGZsYWdzICYgUGxhY2VtZW50KSB7CiAgICAgIHRyeSB7CiAgICAgICAgY29tbWl0UGxhY2VtZW50KGZpbmlzaGVkV29yayk7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY2FwdHVyZUNvbW1pdFBoYXNlRXJyb3IoZmluaXNoZWRXb3JrLCBmaW5pc2hlZFdvcmsucmV0dXJuLCBlcnJvcik7CiAgICAgIH0gLy8gQ2xlYXIgdGhlICJwbGFjZW1lbnQiIGZyb20gZWZmZWN0IHRhZyBzbyB0aGF0IHdlIGtub3cgdGhhdCB0aGlzIGlzCiAgICAgIC8vIGluc2VydGVkLCBiZWZvcmUgYW55IGxpZmUtY3ljbGVzIGxpa2UgY29tcG9uZW50RGlkTW91bnQgZ2V0cyBjYWxsZWQuCiAgICAgIC8vIFRPRE86IGZpbmRET01Ob2RlIGRvZXNuJ3QgcmVseSBvbiB0aGlzIGFueSBtb3JlIGJ1dCBpc01vdW50ZWQgZG9lcwogICAgICAvLyBhbmQgaXNNb3VudGVkIGlzIGRlcHJlY2F0ZWQgYW55d2F5IHNvIHdlIHNob3VsZCBiZSBhYmxlIHRvIGtpbGwgdGhpcy4KCgogICAgICBmaW5pc2hlZFdvcmsuZmxhZ3MgJj0gflBsYWNlbWVudDsKICAgIH0KCiAgICBpZiAoZmxhZ3MgJiBIeWRyYXRpbmcpIHsKICAgICAgZmluaXNoZWRXb3JrLmZsYWdzICY9IH5IeWRyYXRpbmc7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBjb21taXRMYXlvdXRFZmZlY3RzKGZpbmlzaGVkV29yaywgcm9vdCwgY29tbWl0dGVkTGFuZXMpIHsKICAgIGluUHJvZ3Jlc3NMYW5lcyA9IGNvbW1pdHRlZExhbmVzOwogICAgaW5Qcm9ncmVzc1Jvb3QgPSByb290OwogICAgbmV4dEVmZmVjdCA9IGZpbmlzaGVkV29yazsKICAgIGNvbW1pdExheW91dEVmZmVjdHNfYmVnaW4oZmluaXNoZWRXb3JrLCByb290LCBjb21taXR0ZWRMYW5lcyk7CiAgICBpblByb2dyZXNzTGFuZXMgPSBudWxsOwogICAgaW5Qcm9ncmVzc1Jvb3QgPSBudWxsOwogIH0KCiAgZnVuY3Rpb24gY29tbWl0TGF5b3V0RWZmZWN0c19iZWdpbihzdWJ0cmVlUm9vdCwgcm9vdCwgY29tbWl0dGVkTGFuZXMpIHsKICAgIC8vIFN1c3BlbnNlIGxheW91dCBlZmZlY3RzIHNlbWFudGljcyBkb24ndCBjaGFuZ2UgZm9yIGxlZ2FjeSByb290cy4KICAgIHZhciBpc01vZGVyblJvb3QgPSAoc3VidHJlZVJvb3QubW9kZSAmIENvbmN1cnJlbnRNb2RlKSAhPT0gTm9Nb2RlOwoKICAgIHdoaWxlIChuZXh0RWZmZWN0ICE9PSBudWxsKSB7CiAgICAgIHZhciBmaWJlciA9IG5leHRFZmZlY3Q7CiAgICAgIHZhciBmaXJzdENoaWxkID0gZmliZXIuY2hpbGQ7CgogICAgICBpZiAoIGZpYmVyLnRhZyA9PT0gT2Zmc2NyZWVuQ29tcG9uZW50ICYmIGlzTW9kZXJuUm9vdCkgewogICAgICAgIC8vIEtlZXAgdHJhY2sgb2YgdGhlIGN1cnJlbnQgT2Zmc2NyZWVuIHN0YWNrJ3Mgc3RhdGUuCiAgICAgICAgdmFyIGlzSGlkZGVuID0gZmliZXIubWVtb2l6ZWRTdGF0ZSAhPT0gbnVsbDsKICAgICAgICB2YXIgbmV3T2Zmc2NyZWVuU3VidHJlZUlzSGlkZGVuID0gaXNIaWRkZW4gfHwgb2Zmc2NyZWVuU3VidHJlZUlzSGlkZGVuOwoKICAgICAgICBpZiAobmV3T2Zmc2NyZWVuU3VidHJlZUlzSGlkZGVuKSB7CiAgICAgICAgICAvLyBUaGUgT2Zmc2NyZWVuIHRyZWUgaXMgaGlkZGVuLiBTa2lwIG92ZXIgaXRzIGxheW91dCBlZmZlY3RzLgogICAgICAgICAgY29tbWl0TGF5b3V0TW91bnRFZmZlY3RzX2NvbXBsZXRlKHN1YnRyZWVSb290LCByb290LCBjb21taXR0ZWRMYW5lcyk7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy8gVE9ETyAoT2Zmc2NyZWVuKSBBbHNvIGNoZWNrOiBzdWJ0cmVlRmxhZ3MgJiBMYXlvdXRNYXNrCiAgICAgICAgICB2YXIgY3VycmVudCA9IGZpYmVyLmFsdGVybmF0ZTsKICAgICAgICAgIHZhciB3YXNIaWRkZW4gPSBjdXJyZW50ICE9PSBudWxsICYmIGN1cnJlbnQubWVtb2l6ZWRTdGF0ZSAhPT0gbnVsbDsKICAgICAgICAgIHZhciBuZXdPZmZzY3JlZW5TdWJ0cmVlV2FzSGlkZGVuID0gd2FzSGlkZGVuIHx8IG9mZnNjcmVlblN1YnRyZWVXYXNIaWRkZW47CiAgICAgICAgICB2YXIgcHJldk9mZnNjcmVlblN1YnRyZWVJc0hpZGRlbiA9IG9mZnNjcmVlblN1YnRyZWVJc0hpZGRlbjsKICAgICAgICAgIHZhciBwcmV2T2Zmc2NyZWVuU3VidHJlZVdhc0hpZGRlbiA9IG9mZnNjcmVlblN1YnRyZWVXYXNIaWRkZW47IC8vIFRyYXZlcnNlIHRoZSBPZmZzY3JlZW4gc3VidHJlZSB3aXRoIHRoZSBjdXJyZW50IE9mZnNjcmVlbiBhcyB0aGUgcm9vdC4KCiAgICAgICAgICBvZmZzY3JlZW5TdWJ0cmVlSXNIaWRkZW4gPSBuZXdPZmZzY3JlZW5TdWJ0cmVlSXNIaWRkZW47CiAgICAgICAgICBvZmZzY3JlZW5TdWJ0cmVlV2FzSGlkZGVuID0gbmV3T2Zmc2NyZWVuU3VidHJlZVdhc0hpZGRlbjsKCiAgICAgICAgICBpZiAob2Zmc2NyZWVuU3VidHJlZVdhc0hpZGRlbiAmJiAhcHJldk9mZnNjcmVlblN1YnRyZWVXYXNIaWRkZW4pIHsKICAgICAgICAgICAgLy8gVGhpcyBpcyB0aGUgcm9vdCBvZiBhIHJlYXBwZWFyaW5nIGJvdW5kYXJ5LiBUdXJuIGl0cyBsYXlvdXQgZWZmZWN0cwogICAgICAgICAgICAvLyBiYWNrIG9uLgogICAgICAgICAgICBuZXh0RWZmZWN0ID0gZmliZXI7CiAgICAgICAgICAgIHJlYXBwZWFyTGF5b3V0RWZmZWN0c19iZWdpbihmaWJlcik7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIGNoaWxkID0gZmlyc3RDaGlsZDsKCiAgICAgICAgICB3aGlsZSAoY2hpbGQgIT09IG51bGwpIHsKICAgICAgICAgICAgbmV4dEVmZmVjdCA9IGNoaWxkOwogICAgICAgICAgICBjb21taXRMYXlvdXRFZmZlY3RzX2JlZ2luKGNoaWxkLCAvLyBOZXcgcm9vdDsgYnViYmxlIGJhY2sgdXAgdG8gaGVyZSBhbmQgc3RvcC4KICAgICAgICAgICAgcm9vdCwgY29tbWl0dGVkTGFuZXMpOwogICAgICAgICAgICBjaGlsZCA9IGNoaWxkLnNpYmxpbmc7CiAgICAgICAgICB9IC8vIFJlc3RvcmUgT2Zmc2NyZWVuIHN0YXRlIGFuZCByZXN1bWUgaW4gb3VyLXByb2dyZXNzIHRyYXZlcnNhbC4KCgogICAgICAgICAgbmV4dEVmZmVjdCA9IGZpYmVyOwogICAgICAgICAgb2Zmc2NyZWVuU3VidHJlZUlzSGlkZGVuID0gcHJldk9mZnNjcmVlblN1YnRyZWVJc0hpZGRlbjsKICAgICAgICAgIG9mZnNjcmVlblN1YnRyZWVXYXNIaWRkZW4gPSBwcmV2T2Zmc2NyZWVuU3VidHJlZVdhc0hpZGRlbjsKICAgICAgICAgIGNvbW1pdExheW91dE1vdW50RWZmZWN0c19jb21wbGV0ZShzdWJ0cmVlUm9vdCwgcm9vdCwgY29tbWl0dGVkTGFuZXMpOwogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoKGZpYmVyLnN1YnRyZWVGbGFncyAmIExheW91dE1hc2spICE9PSBOb0ZsYWdzICYmIGZpcnN0Q2hpbGQgIT09IG51bGwpIHsKICAgICAgICBmaXJzdENoaWxkLnJldHVybiA9IGZpYmVyOwogICAgICAgIG5leHRFZmZlY3QgPSBmaXJzdENoaWxkOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbW1pdExheW91dE1vdW50RWZmZWN0c19jb21wbGV0ZShzdWJ0cmVlUm9vdCwgcm9vdCwgY29tbWl0dGVkTGFuZXMpOwogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiBjb21taXRMYXlvdXRNb3VudEVmZmVjdHNfY29tcGxldGUoc3VidHJlZVJvb3QsIHJvb3QsIGNvbW1pdHRlZExhbmVzKSB7CiAgICB3aGlsZSAobmV4dEVmZmVjdCAhPT0gbnVsbCkgewogICAgICB2YXIgZmliZXIgPSBuZXh0RWZmZWN0OwoKICAgICAgaWYgKChmaWJlci5mbGFncyAmIExheW91dE1hc2spICE9PSBOb0ZsYWdzKSB7CiAgICAgICAgdmFyIGN1cnJlbnQgPSBmaWJlci5hbHRlcm5hdGU7CiAgICAgICAgc2V0Q3VycmVudEZpYmVyKGZpYmVyKTsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgIGNvbW1pdExheW91dEVmZmVjdE9uRmliZXIocm9vdCwgY3VycmVudCwgZmliZXIsIGNvbW1pdHRlZExhbmVzKTsKICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgY2FwdHVyZUNvbW1pdFBoYXNlRXJyb3IoZmliZXIsIGZpYmVyLnJldHVybiwgZXJyb3IpOwogICAgICAgIH0KCiAgICAgICAgcmVzZXRDdXJyZW50RmliZXIoKTsKICAgICAgfQoKICAgICAgaWYgKGZpYmVyID09PSBzdWJ0cmVlUm9vdCkgewogICAgICAgIG5leHRFZmZlY3QgPSBudWxsOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIHNpYmxpbmcgPSBmaWJlci5zaWJsaW5nOwoKICAgICAgaWYgKHNpYmxpbmcgIT09IG51bGwpIHsKICAgICAgICBzaWJsaW5nLnJldHVybiA9IGZpYmVyLnJldHVybjsKICAgICAgICBuZXh0RWZmZWN0ID0gc2libGluZzsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIG5leHRFZmZlY3QgPSBmaWJlci5yZXR1cm47CiAgICB9CiAgfQoKICBmdW5jdGlvbiBkaXNhcHBlYXJMYXlvdXRFZmZlY3RzX2JlZ2luKHN1YnRyZWVSb290KSB7CiAgICB3aGlsZSAobmV4dEVmZmVjdCAhPT0gbnVsbCkgewogICAgICB2YXIgZmliZXIgPSBuZXh0RWZmZWN0OwogICAgICB2YXIgZmlyc3RDaGlsZCA9IGZpYmVyLmNoaWxkOyAvLyBUT0RPIChPZmZzY3JlZW4pIENoZWNrOiBmbGFncyAmIChSZWZTdGF0aWMgfCBMYXlvdXRTdGF0aWMpCgogICAgICBzd2l0Y2ggKGZpYmVyLnRhZykgewogICAgICAgIGNhc2UgRnVuY3Rpb25Db21wb25lbnQ6CiAgICAgICAgY2FzZSBGb3J3YXJkUmVmOgogICAgICAgIGNhc2UgTWVtb0NvbXBvbmVudDoKICAgICAgICBjYXNlIFNpbXBsZU1lbW9Db21wb25lbnQ6CiAgICAgICAgICB7CiAgICAgICAgICAgIGlmICggZmliZXIubW9kZSAmIFByb2ZpbGVNb2RlKSB7CiAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHN0YXJ0TGF5b3V0RWZmZWN0VGltZXIoKTsKICAgICAgICAgICAgICAgIGNvbW1pdEhvb2tFZmZlY3RMaXN0VW5tb3VudChMYXlvdXQsIGZpYmVyLCBmaWJlci5yZXR1cm4pOwogICAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICByZWNvcmRMYXlvdXRFZmZlY3REdXJhdGlvbihmaWJlcik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGNvbW1pdEhvb2tFZmZlY3RMaXN0VW5tb3VudChMYXlvdXQsIGZpYmVyLCBmaWJlci5yZXR1cm4pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgY2FzZSBDbGFzc0NvbXBvbmVudDoKICAgICAgICAgIHsKICAgICAgICAgICAgLy8gVE9ETyAoT2Zmc2NyZWVuKSBDaGVjazogZmxhZ3MgJiBSZWZTdGF0aWMKICAgICAgICAgICAgc2FmZWx5RGV0YWNoUmVmKGZpYmVyLCBmaWJlci5yZXR1cm4pOwogICAgICAgICAgICB2YXIgaW5zdGFuY2UgPSBmaWJlci5zdGF0ZU5vZGU7CgogICAgICAgICAgICBpZiAodHlwZW9mIGluc3RhbmNlLmNvbXBvbmVudFdpbGxVbm1vdW50ID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAgICAgc2FmZWx5Q2FsbENvbXBvbmVudFdpbGxVbm1vdW50KGZpYmVyLCBmaWJlci5yZXR1cm4sIGluc3RhbmNlKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgIGNhc2UgSG9zdENvbXBvbmVudDoKICAgICAgICAgIHsKICAgICAgICAgICAgc2FmZWx5RGV0YWNoUmVmKGZpYmVyLCBmaWJlci5yZXR1cm4pOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgY2FzZSBPZmZzY3JlZW5Db21wb25lbnQ6CiAgICAgICAgICB7CiAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoaXMgaXMgYQogICAgICAgICAgICB2YXIgaXNIaWRkZW4gPSBmaWJlci5tZW1vaXplZFN0YXRlICE9PSBudWxsOwoKICAgICAgICAgICAgaWYgKGlzSGlkZGVuKSB7CiAgICAgICAgICAgICAgLy8gTmVzdGVkIE9mZnNjcmVlbiB0cmVlIGlzIGFscmVhZHkgaGlkZGVuLiBEb24ndCBkaXNhcHBlYXIKICAgICAgICAgICAgICAvLyBpdHMgZWZmZWN0cy4KICAgICAgICAgICAgICBkaXNhcHBlYXJMYXlvdXRFZmZlY3RzX2NvbXBsZXRlKHN1YnRyZWVSb290KTsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgIH0gLy8gVE9ETyAoT2Zmc2NyZWVuKSBDaGVjazogc3VidHJlZUZsYWdzICYgTGF5b3V0U3RhdGljCgoKICAgICAgaWYgKGZpcnN0Q2hpbGQgIT09IG51bGwpIHsKICAgICAgICBmaXJzdENoaWxkLnJldHVybiA9IGZpYmVyOwogICAgICAgIG5leHRFZmZlY3QgPSBmaXJzdENoaWxkOwogICAgICB9IGVsc2UgewogICAgICAgIGRpc2FwcGVhckxheW91dEVmZmVjdHNfY29tcGxldGUoc3VidHJlZVJvb3QpOwogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiBkaXNhcHBlYXJMYXlvdXRFZmZlY3RzX2NvbXBsZXRlKHN1YnRyZWVSb290KSB7CiAgICB3aGlsZSAobmV4dEVmZmVjdCAhPT0gbnVsbCkgewogICAgICB2YXIgZmliZXIgPSBuZXh0RWZmZWN0OwoKICAgICAgaWYgKGZpYmVyID09PSBzdWJ0cmVlUm9vdCkgewogICAgICAgIG5leHRFZmZlY3QgPSBudWxsOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIHNpYmxpbmcgPSBmaWJlci5zaWJsaW5nOwoKICAgICAgaWYgKHNpYmxpbmcgIT09IG51bGwpIHsKICAgICAgICBzaWJsaW5nLnJldHVybiA9IGZpYmVyLnJldHVybjsKICAgICAgICBuZXh0RWZmZWN0ID0gc2libGluZzsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIG5leHRFZmZlY3QgPSBmaWJlci5yZXR1cm47CiAgICB9CiAgfQoKICBmdW5jdGlvbiByZWFwcGVhckxheW91dEVmZmVjdHNfYmVnaW4oc3VidHJlZVJvb3QpIHsKICAgIHdoaWxlIChuZXh0RWZmZWN0ICE9PSBudWxsKSB7CiAgICAgIHZhciBmaWJlciA9IG5leHRFZmZlY3Q7CiAgICAgIHZhciBmaXJzdENoaWxkID0gZmliZXIuY2hpbGQ7CgogICAgICBpZiAoZmliZXIudGFnID09PSBPZmZzY3JlZW5Db21wb25lbnQpIHsKICAgICAgICB2YXIgaXNIaWRkZW4gPSBmaWJlci5tZW1vaXplZFN0YXRlICE9PSBudWxsOwoKICAgICAgICBpZiAoaXNIaWRkZW4pIHsKICAgICAgICAgIC8vIE5lc3RlZCBPZmZzY3JlZW4gdHJlZSBpcyBzdGlsbCBoaWRkZW4uIERvbid0IHJlLWFwcGVhciBpdHMgZWZmZWN0cy4KICAgICAgICAgIHJlYXBwZWFyTGF5b3V0RWZmZWN0c19jb21wbGV0ZShzdWJ0cmVlUm9vdCk7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CiAgICAgIH0gLy8gVE9ETyAoT2Zmc2NyZWVuKSBDaGVjazogc3VidHJlZUZsYWdzICYgTGF5b3V0U3RhdGljCgoKICAgICAgaWYgKGZpcnN0Q2hpbGQgIT09IG51bGwpIHsKICAgICAgICAvLyBUaGlzIG5vZGUgbWF5IGhhdmUgYmVlbiByZXVzZWQgZnJvbSBhIHByZXZpb3VzIHJlbmRlciwgc28gd2UgY2FuJ3QKICAgICAgICAvLyBhc3N1bWUgaXRzIHJldHVybiBwb2ludGVyIGlzIGNvcnJlY3QuCiAgICAgICAgZmlyc3RDaGlsZC5yZXR1cm4gPSBmaWJlcjsKICAgICAgICBuZXh0RWZmZWN0ID0gZmlyc3RDaGlsZDsKICAgICAgfSBlbHNlIHsKICAgICAgICByZWFwcGVhckxheW91dEVmZmVjdHNfY29tcGxldGUoc3VidHJlZVJvb3QpOwogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiByZWFwcGVhckxheW91dEVmZmVjdHNfY29tcGxldGUoc3VidHJlZVJvb3QpIHsKICAgIHdoaWxlIChuZXh0RWZmZWN0ICE9PSBudWxsKSB7CiAgICAgIHZhciBmaWJlciA9IG5leHRFZmZlY3Q7IC8vIFRPRE8gKE9mZnNjcmVlbikgQ2hlY2s6IGZsYWdzICYgTGF5b3V0U3RhdGljCgogICAgICBzZXRDdXJyZW50RmliZXIoZmliZXIpOwoKICAgICAgdHJ5IHsKICAgICAgICByZWFwcGVhckxheW91dEVmZmVjdHNPbkZpYmVyKGZpYmVyKTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjYXB0dXJlQ29tbWl0UGhhc2VFcnJvcihmaWJlciwgZmliZXIucmV0dXJuLCBlcnJvcik7CiAgICAgIH0KCiAgICAgIHJlc2V0Q3VycmVudEZpYmVyKCk7CgogICAgICBpZiAoZmliZXIgPT09IHN1YnRyZWVSb290KSB7CiAgICAgICAgbmV4dEVmZmVjdCA9IG51bGw7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgc2libGluZyA9IGZpYmVyLnNpYmxpbmc7CgogICAgICBpZiAoc2libGluZyAhPT0gbnVsbCkgewogICAgICAgIC8vIFRoaXMgbm9kZSBtYXkgaGF2ZSBiZWVuIHJldXNlZCBmcm9tIGEgcHJldmlvdXMgcmVuZGVyLCBzbyB3ZSBjYW4ndAogICAgICAgIC8vIGFzc3VtZSBpdHMgcmV0dXJuIHBvaW50ZXIgaXMgY29ycmVjdC4KICAgICAgICBzaWJsaW5nLnJldHVybiA9IGZpYmVyLnJldHVybjsKICAgICAgICBuZXh0RWZmZWN0ID0gc2libGluZzsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIG5leHRFZmZlY3QgPSBmaWJlci5yZXR1cm47CiAgICB9CiAgfQoKICBmdW5jdGlvbiBjb21taXRQYXNzaXZlTW91bnRFZmZlY3RzKHJvb3QsIGZpbmlzaGVkV29yaywgY29tbWl0dGVkTGFuZXMsIGNvbW1pdHRlZFRyYW5zaXRpb25zKSB7CiAgICBuZXh0RWZmZWN0ID0gZmluaXNoZWRXb3JrOwogICAgY29tbWl0UGFzc2l2ZU1vdW50RWZmZWN0c19iZWdpbihmaW5pc2hlZFdvcmssIHJvb3QsIGNvbW1pdHRlZExhbmVzLCBjb21taXR0ZWRUcmFuc2l0aW9ucyk7CiAgfQoKICBmdW5jdGlvbiBjb21taXRQYXNzaXZlTW91bnRFZmZlY3RzX2JlZ2luKHN1YnRyZWVSb290LCByb290LCBjb21taXR0ZWRMYW5lcywgY29tbWl0dGVkVHJhbnNpdGlvbnMpIHsKICAgIHdoaWxlIChuZXh0RWZmZWN0ICE9PSBudWxsKSB7CiAgICAgIHZhciBmaWJlciA9IG5leHRFZmZlY3Q7CiAgICAgIHZhciBmaXJzdENoaWxkID0gZmliZXIuY2hpbGQ7CgogICAgICBpZiAoKGZpYmVyLnN1YnRyZWVGbGFncyAmIFBhc3NpdmVNYXNrKSAhPT0gTm9GbGFncyAmJiBmaXJzdENoaWxkICE9PSBudWxsKSB7CiAgICAgICAgZmlyc3RDaGlsZC5yZXR1cm4gPSBmaWJlcjsKICAgICAgICBuZXh0RWZmZWN0ID0gZmlyc3RDaGlsZDsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb21taXRQYXNzaXZlTW91bnRFZmZlY3RzX2NvbXBsZXRlKHN1YnRyZWVSb290LCByb290LCBjb21taXR0ZWRMYW5lcywgY29tbWl0dGVkVHJhbnNpdGlvbnMpOwogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiBjb21taXRQYXNzaXZlTW91bnRFZmZlY3RzX2NvbXBsZXRlKHN1YnRyZWVSb290LCByb290LCBjb21taXR0ZWRMYW5lcywgY29tbWl0dGVkVHJhbnNpdGlvbnMpIHsKICAgIHdoaWxlIChuZXh0RWZmZWN0ICE9PSBudWxsKSB7CiAgICAgIHZhciBmaWJlciA9IG5leHRFZmZlY3Q7CgogICAgICBpZiAoKGZpYmVyLmZsYWdzICYgUGFzc2l2ZSkgIT09IE5vRmxhZ3MpIHsKICAgICAgICBzZXRDdXJyZW50RmliZXIoZmliZXIpOwoKICAgICAgICB0cnkgewogICAgICAgICAgY29tbWl0UGFzc2l2ZU1vdW50T25GaWJlcihyb290LCBmaWJlciwgY29tbWl0dGVkTGFuZXMsIGNvbW1pdHRlZFRyYW5zaXRpb25zKTsKICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgY2FwdHVyZUNvbW1pdFBoYXNlRXJyb3IoZmliZXIsIGZpYmVyLnJldHVybiwgZXJyb3IpOwogICAgICAgIH0KCiAgICAgICAgcmVzZXRDdXJyZW50RmliZXIoKTsKICAgICAgfQoKICAgICAgaWYgKGZpYmVyID09PSBzdWJ0cmVlUm9vdCkgewogICAgICAgIG5leHRFZmZlY3QgPSBudWxsOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIHNpYmxpbmcgPSBmaWJlci5zaWJsaW5nOwoKICAgICAgaWYgKHNpYmxpbmcgIT09IG51bGwpIHsKICAgICAgICBzaWJsaW5nLnJldHVybiA9IGZpYmVyLnJldHVybjsKICAgICAgICBuZXh0RWZmZWN0ID0gc2libGluZzsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIG5leHRFZmZlY3QgPSBmaWJlci5yZXR1cm47CiAgICB9CiAgfQoKICBmdW5jdGlvbiBjb21taXRQYXNzaXZlTW91bnRPbkZpYmVyKGZpbmlzaGVkUm9vdCwgZmluaXNoZWRXb3JrLCBjb21taXR0ZWRMYW5lcywgY29tbWl0dGVkVHJhbnNpdGlvbnMpIHsKICAgIHN3aXRjaCAoZmluaXNoZWRXb3JrLnRhZykgewogICAgICBjYXNlIEZ1bmN0aW9uQ29tcG9uZW50OgogICAgICBjYXNlIEZvcndhcmRSZWY6CiAgICAgIGNhc2UgU2ltcGxlTWVtb0NvbXBvbmVudDoKICAgICAgICB7CiAgICAgICAgICBpZiAoIGZpbmlzaGVkV29yay5tb2RlICYgUHJvZmlsZU1vZGUpIHsKICAgICAgICAgICAgc3RhcnRQYXNzaXZlRWZmZWN0VGltZXIoKTsKCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgY29tbWl0SG9va0VmZmVjdExpc3RNb3VudChQYXNzaXZlJDEgfCBIYXNFZmZlY3QsIGZpbmlzaGVkV29yayk7CiAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgcmVjb3JkUGFzc2l2ZUVmZmVjdER1cmF0aW9uKGZpbmlzaGVkV29yayk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbW1pdEhvb2tFZmZlY3RMaXN0TW91bnQoUGFzc2l2ZSQxIHwgSGFzRWZmZWN0LCBmaW5pc2hlZFdvcmspOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIGNvbW1pdFBhc3NpdmVVbm1vdW50RWZmZWN0cyhmaXJzdENoaWxkKSB7CiAgICBuZXh0RWZmZWN0ID0gZmlyc3RDaGlsZDsKICAgIGNvbW1pdFBhc3NpdmVVbm1vdW50RWZmZWN0c19iZWdpbigpOwogIH0KCiAgZnVuY3Rpb24gY29tbWl0UGFzc2l2ZVVubW91bnRFZmZlY3RzX2JlZ2luKCkgewogICAgd2hpbGUgKG5leHRFZmZlY3QgIT09IG51bGwpIHsKICAgICAgdmFyIGZpYmVyID0gbmV4dEVmZmVjdDsKICAgICAgdmFyIGNoaWxkID0gZmliZXIuY2hpbGQ7CgogICAgICBpZiAoKG5leHRFZmZlY3QuZmxhZ3MgJiBDaGlsZERlbGV0aW9uKSAhPT0gTm9GbGFncykgewogICAgICAgIHZhciBkZWxldGlvbnMgPSBmaWJlci5kZWxldGlvbnM7CgogICAgICAgIGlmIChkZWxldGlvbnMgIT09IG51bGwpIHsKICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGVsZXRpb25zLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHZhciBmaWJlclRvRGVsZXRlID0gZGVsZXRpb25zW2ldOwogICAgICAgICAgICBuZXh0RWZmZWN0ID0gZmliZXJUb0RlbGV0ZTsKICAgICAgICAgICAgY29tbWl0UGFzc2l2ZVVubW91bnRFZmZlY3RzSW5zaWRlT2ZEZWxldGVkVHJlZV9iZWdpbihmaWJlclRvRGVsZXRlLCBmaWJlcik7CiAgICAgICAgICB9CgogICAgICAgICAgewogICAgICAgICAgICAvLyBBIGZpYmVyIHdhcyBkZWxldGVkIGZyb20gdGhpcyBwYXJlbnQgZmliZXIsIGJ1dCBpdCdzIHN0aWxsIHBhcnQgb2YKICAgICAgICAgICAgLy8gdGhlIHByZXZpb3VzIChhbHRlcm5hdGUpIHBhcmVudCBmaWJlcidzIGxpc3Qgb2YgY2hpbGRyZW4uIEJlY2F1c2UKICAgICAgICAgICAgLy8gY2hpbGRyZW4gYXJlIGEgbGlua2VkIGxpc3QsIGFuIGVhcmxpZXIgc2libGluZyB0aGF0J3Mgc3RpbGwgYWxpdmUKICAgICAgICAgICAgLy8gd2lsbCBiZSBjb25uZWN0ZWQgdG8gdGhlIGRlbGV0ZWQgZmliZXIgdmlhIGl0cyBgYWx0ZXJuYXRlYDoKICAgICAgICAgICAgLy8KICAgICAgICAgICAgLy8gICBsaXZlIGZpYmVyCiAgICAgICAgICAgIC8vICAgLS1hbHRlcm5hdGUtLT4gcHJldmlvdXMgbGl2ZSBmaWJlcgogICAgICAgICAgICAvLyAgIC0tc2libGluZy0tPiBkZWxldGVkIGZpYmVyCiAgICAgICAgICAgIC8vCiAgICAgICAgICAgIC8vIFdlIGNhbid0IGRpc2Nvbm5lY3QgYGFsdGVybmF0ZWAgb24gbm9kZXMgdGhhdCBoYXZlbid0IGJlZW4gZGVsZXRlZAogICAgICAgICAgICAvLyB5ZXQsIGJ1dCB3ZSBjYW4gZGlzY29ubmVjdCB0aGUgYHNpYmxpbmdgIGFuZCBgY2hpbGRgIHBvaW50ZXJzLgogICAgICAgICAgICB2YXIgcHJldmlvdXNGaWJlciA9IGZpYmVyLmFsdGVybmF0ZTsKCiAgICAgICAgICAgIGlmIChwcmV2aW91c0ZpYmVyICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgdmFyIGRldGFjaGVkQ2hpbGQgPSBwcmV2aW91c0ZpYmVyLmNoaWxkOwoKICAgICAgICAgICAgICBpZiAoZGV0YWNoZWRDaGlsZCAhPT0gbnVsbCkgewogICAgICAgICAgICAgICAgcHJldmlvdXNGaWJlci5jaGlsZCA9IG51bGw7CgogICAgICAgICAgICAgICAgZG8gewogICAgICAgICAgICAgICAgICB2YXIgZGV0YWNoZWRTaWJsaW5nID0gZGV0YWNoZWRDaGlsZC5zaWJsaW5nOwogICAgICAgICAgICAgICAgICBkZXRhY2hlZENoaWxkLnNpYmxpbmcgPSBudWxsOwogICAgICAgICAgICAgICAgICBkZXRhY2hlZENoaWxkID0gZGV0YWNoZWRTaWJsaW5nOwogICAgICAgICAgICAgICAgfSB3aGlsZSAoZGV0YWNoZWRDaGlsZCAhPT0gbnVsbCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgbmV4dEVmZmVjdCA9IGZpYmVyOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKChmaWJlci5zdWJ0cmVlRmxhZ3MgJiBQYXNzaXZlTWFzaykgIT09IE5vRmxhZ3MgJiYgY2hpbGQgIT09IG51bGwpIHsKICAgICAgICBjaGlsZC5yZXR1cm4gPSBmaWJlcjsKICAgICAgICBuZXh0RWZmZWN0ID0gY2hpbGQ7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29tbWl0UGFzc2l2ZVVubW91bnRFZmZlY3RzX2NvbXBsZXRlKCk7CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIGNvbW1pdFBhc3NpdmVVbm1vdW50RWZmZWN0c19jb21wbGV0ZSgpIHsKICAgIHdoaWxlIChuZXh0RWZmZWN0ICE9PSBudWxsKSB7CiAgICAgIHZhciBmaWJlciA9IG5leHRFZmZlY3Q7CgogICAgICBpZiAoKGZpYmVyLmZsYWdzICYgUGFzc2l2ZSkgIT09IE5vRmxhZ3MpIHsKICAgICAgICBzZXRDdXJyZW50RmliZXIoZmliZXIpOwogICAgICAgIGNvbW1pdFBhc3NpdmVVbm1vdW50T25GaWJlcihmaWJlcik7CiAgICAgICAgcmVzZXRDdXJyZW50RmliZXIoKTsKICAgICAgfQoKICAgICAgdmFyIHNpYmxpbmcgPSBmaWJlci5zaWJsaW5nOwoKICAgICAgaWYgKHNpYmxpbmcgIT09IG51bGwpIHsKICAgICAgICBzaWJsaW5nLnJldHVybiA9IGZpYmVyLnJldHVybjsKICAgICAgICBuZXh0RWZmZWN0ID0gc2libGluZzsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIG5leHRFZmZlY3QgPSBmaWJlci5yZXR1cm47CiAgICB9CiAgfQoKICBmdW5jdGlvbiBjb21taXRQYXNzaXZlVW5tb3VudE9uRmliZXIoZmluaXNoZWRXb3JrKSB7CiAgICBzd2l0Y2ggKGZpbmlzaGVkV29yay50YWcpIHsKICAgICAgY2FzZSBGdW5jdGlvbkNvbXBvbmVudDoKICAgICAgY2FzZSBGb3J3YXJkUmVmOgogICAgICBjYXNlIFNpbXBsZU1lbW9Db21wb25lbnQ6CiAgICAgICAgewogICAgICAgICAgaWYgKCBmaW5pc2hlZFdvcmsubW9kZSAmIFByb2ZpbGVNb2RlKSB7CiAgICAgICAgICAgIHN0YXJ0UGFzc2l2ZUVmZmVjdFRpbWVyKCk7CiAgICAgICAgICAgIGNvbW1pdEhvb2tFZmZlY3RMaXN0VW5tb3VudChQYXNzaXZlJDEgfCBIYXNFZmZlY3QsIGZpbmlzaGVkV29yaywgZmluaXNoZWRXb3JrLnJldHVybik7CiAgICAgICAgICAgIHJlY29yZFBhc3NpdmVFZmZlY3REdXJhdGlvbihmaW5pc2hlZFdvcmspOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29tbWl0SG9va0VmZmVjdExpc3RVbm1vdW50KFBhc3NpdmUkMSB8IEhhc0VmZmVjdCwgZmluaXNoZWRXb3JrLCBmaW5pc2hlZFdvcmsucmV0dXJuKTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiBjb21taXRQYXNzaXZlVW5tb3VudEVmZmVjdHNJbnNpZGVPZkRlbGV0ZWRUcmVlX2JlZ2luKGRlbGV0ZWRTdWJ0cmVlUm9vdCwgbmVhcmVzdE1vdW50ZWRBbmNlc3RvcikgewogICAgd2hpbGUgKG5leHRFZmZlY3QgIT09IG51bGwpIHsKICAgICAgdmFyIGZpYmVyID0gbmV4dEVmZmVjdDsgLy8gRGVsZXRpb24gZWZmZWN0cyBmaXJlIGluIHBhcmVudCAtPiBjaGlsZCBvcmRlcgogICAgICAvLyBUT0RPOiBDaGVjayBpZiBmaWJlciBoYXMgYSBQYXNzaXZlU3RhdGljIGZsYWcKCiAgICAgIHNldEN1cnJlbnRGaWJlcihmaWJlcik7CiAgICAgIGNvbW1pdFBhc3NpdmVVbm1vdW50SW5zaWRlRGVsZXRlZFRyZWVPbkZpYmVyKGZpYmVyLCBuZWFyZXN0TW91bnRlZEFuY2VzdG9yKTsKICAgICAgcmVzZXRDdXJyZW50RmliZXIoKTsKICAgICAgdmFyIGNoaWxkID0gZmliZXIuY2hpbGQ7IC8vIFRPRE86IE9ubHkgdHJhdmVyc2Ugc3VidHJlZSBpZiBpdCBoYXMgYSBQYXNzaXZlU3RhdGljIGZsYWcuIChCdXQsIGlmIHdlCiAgICAgIC8vIGRvIHRoaXMsIHN0aWxsIG5lZWQgdG8gaGFuZGxlIGBkZWxldGVkVHJlZUNsZWFuVXBMZXZlbGAgY29ycmVjdGx5LikKCiAgICAgIGlmIChjaGlsZCAhPT0gbnVsbCkgewogICAgICAgIGNoaWxkLnJldHVybiA9IGZpYmVyOwogICAgICAgIG5leHRFZmZlY3QgPSBjaGlsZDsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb21taXRQYXNzaXZlVW5tb3VudEVmZmVjdHNJbnNpZGVPZkRlbGV0ZWRUcmVlX2NvbXBsZXRlKGRlbGV0ZWRTdWJ0cmVlUm9vdCk7CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIGNvbW1pdFBhc3NpdmVVbm1vdW50RWZmZWN0c0luc2lkZU9mRGVsZXRlZFRyZWVfY29tcGxldGUoZGVsZXRlZFN1YnRyZWVSb290KSB7CiAgICB3aGlsZSAobmV4dEVmZmVjdCAhPT0gbnVsbCkgewogICAgICB2YXIgZmliZXIgPSBuZXh0RWZmZWN0OwogICAgICB2YXIgc2libGluZyA9IGZpYmVyLnNpYmxpbmc7CiAgICAgIHZhciByZXR1cm5GaWJlciA9IGZpYmVyLnJldHVybjsKCiAgICAgIHsKICAgICAgICAvLyBSZWN1cnNpdmVseSB0cmF2ZXJzZSB0aGUgZW50aXJlIGRlbGV0ZWQgdHJlZSBhbmQgY2xlYW4gdXAgZmliZXIgZmllbGRzLgogICAgICAgIC8vIFRoaXMgaXMgbW9yZSBhZ2dyZXNzaXZlIHRoYW4gaWRlYWwsIGFuZCB0aGUgbG9uZyB0ZXJtIGdvYWwgaXMgdG8gb25seQogICAgICAgIC8vIGhhdmUgdG8gZGV0YWNoIHRoZSBkZWxldGVkIHRyZWUgYXQgdGhlIHJvb3QuCiAgICAgICAgZGV0YWNoRmliZXJBZnRlckVmZmVjdHMoZmliZXIpOwoKICAgICAgICBpZiAoZmliZXIgPT09IGRlbGV0ZWRTdWJ0cmVlUm9vdCkgewogICAgICAgICAgbmV4dEVmZmVjdCA9IG51bGw7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoc2libGluZyAhPT0gbnVsbCkgewogICAgICAgIHNpYmxpbmcucmV0dXJuID0gcmV0dXJuRmliZXI7CiAgICAgICAgbmV4dEVmZmVjdCA9IHNpYmxpbmc7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBuZXh0RWZmZWN0ID0gcmV0dXJuRmliZXI7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBjb21taXRQYXNzaXZlVW5tb3VudEluc2lkZURlbGV0ZWRUcmVlT25GaWJlcihjdXJyZW50LCBuZWFyZXN0TW91bnRlZEFuY2VzdG9yKSB7CiAgICBzd2l0Y2ggKGN1cnJlbnQudGFnKSB7CiAgICAgIGNhc2UgRnVuY3Rpb25Db21wb25lbnQ6CiAgICAgIGNhc2UgRm9yd2FyZFJlZjoKICAgICAgY2FzZSBTaW1wbGVNZW1vQ29tcG9uZW50OgogICAgICAgIHsKICAgICAgICAgIGlmICggY3VycmVudC5tb2RlICYgUHJvZmlsZU1vZGUpIHsKICAgICAgICAgICAgc3RhcnRQYXNzaXZlRWZmZWN0VGltZXIoKTsKICAgICAgICAgICAgY29tbWl0SG9va0VmZmVjdExpc3RVbm1vdW50KFBhc3NpdmUkMSwgY3VycmVudCwgbmVhcmVzdE1vdW50ZWRBbmNlc3Rvcik7CiAgICAgICAgICAgIHJlY29yZFBhc3NpdmVFZmZlY3REdXJhdGlvbihjdXJyZW50KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbW1pdEhvb2tFZmZlY3RMaXN0VW5tb3VudChQYXNzaXZlJDEsIGN1cnJlbnQsIG5lYXJlc3RNb3VudGVkQW5jZXN0b3IpOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgIH0KICB9IC8vIFRPRE86IFJldXNlIHJlYXBwZWFyTGF5b3V0RWZmZWN0cyB0cmF2ZXJzYWwgaGVyZT8KCgogIGZ1bmN0aW9uIGludm9rZUxheW91dEVmZmVjdE1vdW50SW5ERVYoZmliZXIpIHsKICAgIHsKICAgICAgLy8gV2UgZG9uJ3QgbmVlZCB0byByZS1jaGVjayBTdHJpY3RFZmZlY3RzTW9kZSBoZXJlLgogICAgICAvLyBUaGlzIGZ1bmN0aW9uIGlzIG9ubHkgY2FsbGVkIGlmIHRoYXQgY2hlY2sgaGFzIGFscmVhZHkgcGFzc2VkLgogICAgICBzd2l0Y2ggKGZpYmVyLnRhZykgewogICAgICAgIGNhc2UgRnVuY3Rpb25Db21wb25lbnQ6CiAgICAgICAgY2FzZSBGb3J3YXJkUmVmOgogICAgICAgIGNhc2UgU2ltcGxlTWVtb0NvbXBvbmVudDoKICAgICAgICAgIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICBjb21taXRIb29rRWZmZWN0TGlzdE1vdW50KExheW91dCB8IEhhc0VmZmVjdCwgZmliZXIpOwogICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICAgIGNhcHR1cmVDb21taXRQaGFzZUVycm9yKGZpYmVyLCBmaWJlci5yZXR1cm4sIGVycm9yKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgIGNhc2UgQ2xhc3NDb21wb25lbnQ6CiAgICAgICAgICB7CiAgICAgICAgICAgIHZhciBpbnN0YW5jZSA9IGZpYmVyLnN0YXRlTm9kZTsKCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgaW5zdGFuY2UuY29tcG9uZW50RGlkTW91bnQoKTsKICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgICBjYXB0dXJlQ29tbWl0UGhhc2VFcnJvcihmaWJlciwgZmliZXIucmV0dXJuLCBlcnJvcik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiBpbnZva2VQYXNzaXZlRWZmZWN0TW91bnRJbkRFVihmaWJlcikgewogICAgewogICAgICAvLyBXZSBkb24ndCBuZWVkIHRvIHJlLWNoZWNrIFN0cmljdEVmZmVjdHNNb2RlIGhlcmUuCiAgICAgIC8vIFRoaXMgZnVuY3Rpb24gaXMgb25seSBjYWxsZWQgaWYgdGhhdCBjaGVjayBoYXMgYWxyZWFkeSBwYXNzZWQuCiAgICAgIHN3aXRjaCAoZmliZXIudGFnKSB7CiAgICAgICAgY2FzZSBGdW5jdGlvbkNvbXBvbmVudDoKICAgICAgICBjYXNlIEZvcndhcmRSZWY6CiAgICAgICAgY2FzZSBTaW1wbGVNZW1vQ29tcG9uZW50OgogICAgICAgICAgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIGNvbW1pdEhvb2tFZmZlY3RMaXN0TW91bnQoUGFzc2l2ZSQxIHwgSGFzRWZmZWN0LCBmaWJlcik7CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgY2FwdHVyZUNvbW1pdFBoYXNlRXJyb3IoZmliZXIsIGZpYmVyLnJldHVybiwgZXJyb3IpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gaW52b2tlTGF5b3V0RWZmZWN0VW5tb3VudEluREVWKGZpYmVyKSB7CiAgICB7CiAgICAgIC8vIFdlIGRvbid0IG5lZWQgdG8gcmUtY2hlY2sgU3RyaWN0RWZmZWN0c01vZGUgaGVyZS4KICAgICAgLy8gVGhpcyBmdW5jdGlvbiBpcyBvbmx5IGNhbGxlZCBpZiB0aGF0IGNoZWNrIGhhcyBhbHJlYWR5IHBhc3NlZC4KICAgICAgc3dpdGNoIChmaWJlci50YWcpIHsKICAgICAgICBjYXNlIEZ1bmN0aW9uQ29tcG9uZW50OgogICAgICAgIGNhc2UgRm9yd2FyZFJlZjoKICAgICAgICBjYXNlIFNpbXBsZU1lbW9Db21wb25lbnQ6CiAgICAgICAgICB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgY29tbWl0SG9va0VmZmVjdExpc3RVbm1vdW50KExheW91dCB8IEhhc0VmZmVjdCwgZmliZXIsIGZpYmVyLnJldHVybik7CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgY2FwdHVyZUNvbW1pdFBoYXNlRXJyb3IoZmliZXIsIGZpYmVyLnJldHVybiwgZXJyb3IpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgY2FzZSBDbGFzc0NvbXBvbmVudDoKICAgICAgICAgIHsKICAgICAgICAgICAgdmFyIGluc3RhbmNlID0gZmliZXIuc3RhdGVOb2RlOwoKICAgICAgICAgICAgaWYgKHR5cGVvZiBpbnN0YW5jZS5jb21wb25lbnRXaWxsVW5tb3VudCA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgICAgIHNhZmVseUNhbGxDb21wb25lbnRXaWxsVW5tb3VudChmaWJlciwgZmliZXIucmV0dXJuLCBpbnN0YW5jZSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiBpbnZva2VQYXNzaXZlRWZmZWN0VW5tb3VudEluREVWKGZpYmVyKSB7CiAgICB7CiAgICAgIC8vIFdlIGRvbid0IG5lZWQgdG8gcmUtY2hlY2sgU3RyaWN0RWZmZWN0c01vZGUgaGVyZS4KICAgICAgLy8gVGhpcyBmdW5jdGlvbiBpcyBvbmx5IGNhbGxlZCBpZiB0aGF0IGNoZWNrIGhhcyBhbHJlYWR5IHBhc3NlZC4KICAgICAgc3dpdGNoIChmaWJlci50YWcpIHsKICAgICAgICBjYXNlIEZ1bmN0aW9uQ29tcG9uZW50OgogICAgICAgIGNhc2UgRm9yd2FyZFJlZjoKICAgICAgICBjYXNlIFNpbXBsZU1lbW9Db21wb25lbnQ6CiAgICAgICAgICB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgY29tbWl0SG9va0VmZmVjdExpc3RVbm1vdW50KFBhc3NpdmUkMSB8IEhhc0VmZmVjdCwgZmliZXIsIGZpYmVyLnJldHVybik7CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgY2FwdHVyZUNvbW1pdFBoYXNlRXJyb3IoZmliZXIsIGZpYmVyLnJldHVybiwgZXJyb3IpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CgogIHZhciBDT01QT05FTlRfVFlQRSA9IDA7CiAgdmFyIEhBU19QU0VVRE9fQ0xBU1NfVFlQRSA9IDE7CiAgdmFyIFJPTEVfVFlQRSA9IDI7CiAgdmFyIFRFU1RfTkFNRV9UWVBFID0gMzsKICB2YXIgVEVYVF9UWVBFID0gNDsKCiAgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICdmdW5jdGlvbicgJiYgU3ltYm9sLmZvcikgewogICAgdmFyIHN5bWJvbEZvciA9IFN5bWJvbC5mb3I7CiAgICBDT01QT05FTlRfVFlQRSA9IHN5bWJvbEZvcignc2VsZWN0b3IuY29tcG9uZW50Jyk7CiAgICBIQVNfUFNFVURPX0NMQVNTX1RZUEUgPSBzeW1ib2xGb3IoJ3NlbGVjdG9yLmhhc19wc2V1ZG9fY2xhc3MnKTsKICAgIFJPTEVfVFlQRSA9IHN5bWJvbEZvcignc2VsZWN0b3Iucm9sZScpOwogICAgVEVTVF9OQU1FX1RZUEUgPSBzeW1ib2xGb3IoJ3NlbGVjdG9yLnRlc3RfaWQnKTsKICAgIFRFWFRfVFlQRSA9IHN5bWJvbEZvcignc2VsZWN0b3IudGV4dCcpOwogIH0KICB2YXIgY29tbWl0SG9va3MgPSBbXTsKICBmdW5jdGlvbiBvbkNvbW1pdFJvb3QkMSgpIHsKICAgIHsKICAgICAgY29tbWl0SG9va3MuZm9yRWFjaChmdW5jdGlvbiAoY29tbWl0SG9vaykgewogICAgICAgIHJldHVybiBjb21taXRIb29rKCk7CiAgICAgIH0pOwogICAgfQogIH0KCiAgdmFyIFJlYWN0Q3VycmVudEFjdFF1ZXVlID0gUmVhY3RTaGFyZWRJbnRlcm5hbHMuUmVhY3RDdXJyZW50QWN0UXVldWU7CiAgZnVuY3Rpb24gaXNMZWdhY3lBY3RFbnZpcm9ubWVudChmaWJlcikgewogICAgewogICAgICAvLyBMZWdhY3kgbW9kZS4gV2UgcHJlc2VydmUgdGhlIGJlaGF2aW9yIG9mIFJlYWN0IDE3J3MgYWN0LiBJdCBhc3N1bWVzIGFuCiAgICAgIC8vIGFjdCBlbnZpcm9ubWVudCB3aGVuZXZlciBgamVzdGAgaXMgZGVmaW5lZCwgYnV0IHlvdSBjYW4gc3RpbGwgdHVybiBvZmYKICAgICAgLy8gc3B1cmlvdXMgd2FybmluZ3MgYnkgc2V0dGluZyBJU19SRUFDVF9BQ1RfRU5WSVJPTk1FTlQgZXhwbGljaXRseQogICAgICAvLyB0byBmYWxzZS4KICAgICAgdmFyIGlzUmVhY3RBY3RFbnZpcm9ubWVudEdsb2JhbCA9IC8vICRGbG93RXhwZWN0ZWRFcnJvciDigJMgRmxvdyBkb2Vzbid0IGtub3cgYWJvdXQgSVNfUkVBQ1RfQUNUX0VOVklST05NRU5UIGdsb2JhbAogICAgICB0eXBlb2YgSVNfUkVBQ1RfQUNUX0VOVklST05NRU5UICE9PSAndW5kZWZpbmVkJyA/IElTX1JFQUNUX0FDVF9FTlZJUk9OTUVOVCA6IHVuZGVmaW5lZDsgLy8gJEZsb3dFeHBlY3RlZEVycm9yIC0gRmxvdyBkb2Vzbid0IGtub3cgYWJvdXQgamVzdAoKICAgICAgdmFyIGplc3RJc0RlZmluZWQgPSB0eXBlb2YgamVzdCAhPT0gJ3VuZGVmaW5lZCc7CiAgICAgIHJldHVybiAgamVzdElzRGVmaW5lZCAmJiBpc1JlYWN0QWN0RW52aXJvbm1lbnRHbG9iYWwgIT09IGZhbHNlOwogICAgfQogIH0KICBmdW5jdGlvbiBpc0NvbmN1cnJlbnRBY3RFbnZpcm9ubWVudCgpIHsKICAgIHsKICAgICAgdmFyIGlzUmVhY3RBY3RFbnZpcm9ubWVudEdsb2JhbCA9IC8vICRGbG93RXhwZWN0ZWRFcnJvciDigJMgRmxvdyBkb2Vzbid0IGtub3cgYWJvdXQgSVNfUkVBQ1RfQUNUX0VOVklST05NRU5UIGdsb2JhbAogICAgICB0eXBlb2YgSVNfUkVBQ1RfQUNUX0VOVklST05NRU5UICE9PSAndW5kZWZpbmVkJyA/IElTX1JFQUNUX0FDVF9FTlZJUk9OTUVOVCA6IHVuZGVmaW5lZDsKCiAgICAgIGlmICghaXNSZWFjdEFjdEVudmlyb25tZW50R2xvYmFsICYmIFJlYWN0Q3VycmVudEFjdFF1ZXVlLmN1cnJlbnQgIT09IG51bGwpIHsKICAgICAgICAvLyBUT0RPOiBJbmNsdWRlIGxpbmsgdG8gcmVsZXZhbnQgZG9jdW1lbnRhdGlvbiBwYWdlLgogICAgICAgIGVycm9yKCdUaGUgY3VycmVudCB0ZXN0aW5nIGVudmlyb25tZW50IGlzIG5vdCBjb25maWd1cmVkIHRvIHN1cHBvcnQgJyArICdhY3QoLi4uKScpOwogICAgICB9CgogICAgICByZXR1cm4gaXNSZWFjdEFjdEVudmlyb25tZW50R2xvYmFsOwogICAgfQogIH0KCiAgdmFyIGNlaWwgPSBNYXRoLmNlaWw7CiAgdmFyIFJlYWN0Q3VycmVudERpc3BhdGNoZXIkMiA9IFJlYWN0U2hhcmVkSW50ZXJuYWxzLlJlYWN0Q3VycmVudERpc3BhdGNoZXIsCiAgICAgIFJlYWN0Q3VycmVudE93bmVyJDIgPSBSZWFjdFNoYXJlZEludGVybmFscy5SZWFjdEN1cnJlbnRPd25lciwKICAgICAgUmVhY3RDdXJyZW50QmF0Y2hDb25maWckMyA9IFJlYWN0U2hhcmVkSW50ZXJuYWxzLlJlYWN0Q3VycmVudEJhdGNoQ29uZmlnLAogICAgICBSZWFjdEN1cnJlbnRBY3RRdWV1ZSQxID0gUmVhY3RTaGFyZWRJbnRlcm5hbHMuUmVhY3RDdXJyZW50QWN0UXVldWU7CiAgdmFyIE5vQ29udGV4dCA9CiAgLyogICAgICAgICAgICAgKi8KICAwOwogIHZhciBCYXRjaGVkQ29udGV4dCA9CiAgLyogICAgICAgICAgICAgICAqLwogIDE7CiAgdmFyIFJlbmRlckNvbnRleHQgPQogIC8qICAgICAgICAgICAgICAgICovCiAgMjsKICB2YXIgQ29tbWl0Q29udGV4dCA9CiAgLyogICAgICAgICAgICAgICAgKi8KICA0OwogIHZhciBSb290SW5Qcm9ncmVzcyA9IDA7CiAgdmFyIFJvb3RGYXRhbEVycm9yZWQgPSAxOwogIHZhciBSb290RXJyb3JlZCA9IDI7CiAgdmFyIFJvb3RTdXNwZW5kZWQgPSAzOwogIHZhciBSb290U3VzcGVuZGVkV2l0aERlbGF5ID0gNDsKICB2YXIgUm9vdENvbXBsZXRlZCA9IDU7CiAgdmFyIFJvb3REaWROb3RDb21wbGV0ZSA9IDY7IC8vIERlc2NyaWJlcyB3aGVyZSB3ZSBhcmUgaW4gdGhlIFJlYWN0IGV4ZWN1dGlvbiBzdGFjawoKICB2YXIgZXhlY3V0aW9uQ29udGV4dCA9IE5vQ29udGV4dDsgLy8gVGhlIHJvb3Qgd2UncmUgd29ya2luZyBvbgoKICB2YXIgd29ya0luUHJvZ3Jlc3NSb290ID0gbnVsbDsgLy8gVGhlIGZpYmVyIHdlJ3JlIHdvcmtpbmcgb24KCiAgdmFyIHdvcmtJblByb2dyZXNzID0gbnVsbDsgLy8gVGhlIGxhbmVzIHdlJ3JlIHJlbmRlcmluZwoKICB2YXIgd29ya0luUHJvZ3Jlc3NSb290UmVuZGVyTGFuZXMgPSBOb0xhbmVzOyAvLyBTdGFjayB0aGF0IGFsbG93cyBjb21wb25lbnRzIHRvIGNoYW5nZSB0aGUgcmVuZGVyIGxhbmVzIGZvciBpdHMgc3VidHJlZQogIC8vIFRoaXMgaXMgYSBzdXBlcnNldCBvZiB0aGUgbGFuZXMgd2Ugc3RhcnRlZCB3b3JraW5nIG9uIGF0IHRoZSByb290LiBUaGUgb25seQogIC8vIGNhc2Ugd2hlcmUgaXQncyBkaWZmZXJlbnQgZnJvbSBgd29ya0luUHJvZ3Jlc3NSb290UmVuZGVyTGFuZXNgIGlzIHdoZW4gd2UKICAvLyBlbnRlciBhIHN1YnRyZWUgdGhhdCBpcyBoaWRkZW4gYW5kIG5lZWRzIHRvIGJlIHVuaGlkZGVuOiBTdXNwZW5zZSBhbmQKICAvLyBPZmZzY3JlZW4gY29tcG9uZW50LgogIC8vCiAgLy8gTW9zdCB0aGluZ3MgaW4gdGhlIHdvcmsgbG9vcCBzaG91bGQgZGVhbCB3aXRoIHdvcmtJblByb2dyZXNzUm9vdFJlbmRlckxhbmVzLgogIC8vIE1vc3QgdGhpbmdzIGluIGJlZ2luL2NvbXBsZXRlIHBoYXNlcyBzaG91bGQgZGVhbCB3aXRoIHN1YnRyZWVSZW5kZXJMYW5lcy4KCiAgdmFyIHN1YnRyZWVSZW5kZXJMYW5lcyA9IE5vTGFuZXM7CiAgdmFyIHN1YnRyZWVSZW5kZXJMYW5lc0N1cnNvciA9IGNyZWF0ZUN1cnNvcihOb0xhbmVzKTsgLy8gV2hldGhlciB0byByb290IGNvbXBsZXRlZCwgZXJyb3JlZCwgc3VzcGVuZGVkLCBldGMuCgogIHZhciB3b3JrSW5Qcm9ncmVzc1Jvb3RFeGl0U3RhdHVzID0gUm9vdEluUHJvZ3Jlc3M7IC8vIEEgZmF0YWwgZXJyb3IsIGlmIG9uZSBpcyB0aHJvd24KCiAgdmFyIHdvcmtJblByb2dyZXNzUm9vdEZhdGFsRXJyb3IgPSBudWxsOyAvLyAiSW5jbHVkZWQiIGxhbmVzIHJlZmVyIHRvIGxhbmVzIHRoYXQgd2VyZSB3b3JrZWQgb24gZHVyaW5nIHRoaXMgcmVuZGVyLiBJdCdzCiAgLy8gc2xpZ2h0bHkgZGlmZmVyZW50IHRoYW4gYHJlbmRlckxhbmVzYCBiZWNhdXNlIGByZW5kZXJMYW5lc2AgY2FuIGNoYW5nZSBhcyB5b3UKICAvLyBlbnRlciBhbmQgZXhpdCBhbiBPZmZzY3JlZW4gdHJlZS4gVGhpcyB2YWx1ZSBpcyB0aGUgY29tYmluYXRpb24gb2YgYWxsIHJlbmRlcgogIC8vIGxhbmVzIGZvciB0aGUgZW50aXJlIHJlbmRlciBwaGFzZS4KCiAgdmFyIHdvcmtJblByb2dyZXNzUm9vdEluY2x1ZGVkTGFuZXMgPSBOb0xhbmVzOyAvLyBUaGUgd29yayBsZWZ0IG92ZXIgYnkgY29tcG9uZW50cyB0aGF0IHdlcmUgdmlzaXRlZCBkdXJpbmcgdGhpcyByZW5kZXIuIE9ubHkKICAvLyBpbmNsdWRlcyB1bnByb2Nlc3NlZCB1cGRhdGVzLCBub3Qgd29yayBpbiBiYWlsZWQgb3V0IGNoaWxkcmVuLgoKICB2YXIgd29ya0luUHJvZ3Jlc3NSb290U2tpcHBlZExhbmVzID0gTm9MYW5lczsgLy8gTGFuZXMgdGhhdCB3ZXJlIHVwZGF0ZWQgKGluIGFuIGludGVybGVhdmVkIGV2ZW50KSBkdXJpbmcgdGhpcyByZW5kZXIuCgogIHZhciB3b3JrSW5Qcm9ncmVzc1Jvb3RJbnRlcmxlYXZlZFVwZGF0ZWRMYW5lcyA9IE5vTGFuZXM7IC8vIExhbmVzIHRoYXQgd2VyZSB1cGRhdGVkIGR1cmluZyB0aGUgcmVuZGVyIHBoYXNlICgqbm90KiBhbiBpbnRlcmxlYXZlZCBldmVudCkuCgogIHZhciB3b3JrSW5Qcm9ncmVzc1Jvb3RQaW5nZWRMYW5lcyA9IE5vTGFuZXM7IC8vIEVycm9ycyB0aGF0IGFyZSB0aHJvd24gZHVyaW5nIHRoZSByZW5kZXIgcGhhc2UuCgogIHZhciB3b3JrSW5Qcm9ncmVzc1Jvb3RDb25jdXJyZW50RXJyb3JzID0gbnVsbDsgLy8gVGhlc2UgYXJlIGVycm9ycyB0aGF0IHdlIHJlY292ZXJlZCBmcm9tIHdpdGhvdXQgc3VyZmFjaW5nIHRoZW0gdG8gdGhlIFVJLgogIC8vIFdlIHdpbGwgbG9nIHRoZW0gb25jZSB0aGUgdHJlZSBjb21taXRzLgoKICB2YXIgd29ya0luUHJvZ3Jlc3NSb290UmVjb3ZlcmFibGVFcnJvcnMgPSBudWxsOyAvLyBUaGUgbW9zdCByZWNlbnQgdGltZSB3ZSBjb21taXR0ZWQgYSBmYWxsYmFjay4gVGhpcyBsZXRzIHVzIGVuc3VyZSBhIHRyYWluCiAgLy8gbW9kZWwgd2hlcmUgd2UgZG9uJ3QgY29tbWl0IG5ldyBsb2FkaW5nIHN0YXRlcyBpbiB0b28gcXVpY2sgc3VjY2Vzc2lvbi4KCiAgdmFyIGdsb2JhbE1vc3RSZWNlbnRGYWxsYmFja1RpbWUgPSAwOwogIHZhciBGQUxMQkFDS19USFJPVFRMRV9NUyA9IDUwMDsgLy8gVGhlIGFic29sdXRlIHRpbWUgZm9yIHdoZW4gd2Ugc2hvdWxkIHN0YXJ0IGdpdmluZyB1cCBvbiByZW5kZXJpbmcKICAvLyBtb3JlIGFuZCBwcmVmZXIgQ1BVIHN1c3BlbnNlIGhldXJpc3RpY3MgaW5zdGVhZC4KCiAgdmFyIHdvcmtJblByb2dyZXNzUm9vdFJlbmRlclRhcmdldFRpbWUgPSBJbmZpbml0eTsgLy8gSG93IGxvbmcgYSByZW5kZXIgaXMgc3VwcG9zZWQgdG8gdGFrZSBiZWZvcmUgd2Ugc3RhcnQgZm9sbG93aW5nIENQVQogIC8vIHN1c3BlbnNlIGhldXJpc3RpY3MgYW5kIG9wdCBvdXQgb2YgcmVuZGVyaW5nIG1vcmUgY29udGVudC4KCiAgdmFyIFJFTkRFUl9USU1FT1VUX01TID0gNTAwOwogIHZhciB3b3JrSW5Qcm9ncmVzc1RyYW5zaXRpb25zID0gbnVsbDsKCiAgZnVuY3Rpb24gcmVzZXRSZW5kZXJUaW1lcigpIHsKICAgIHdvcmtJblByb2dyZXNzUm9vdFJlbmRlclRhcmdldFRpbWUgPSBub3coKSArIFJFTkRFUl9USU1FT1VUX01TOwogIH0KCiAgZnVuY3Rpb24gZ2V0UmVuZGVyVGFyZ2V0VGltZSgpIHsKICAgIHJldHVybiB3b3JrSW5Qcm9ncmVzc1Jvb3RSZW5kZXJUYXJnZXRUaW1lOwogIH0KICB2YXIgaGFzVW5jYXVnaHRFcnJvciA9IGZhbHNlOwogIHZhciBmaXJzdFVuY2F1Z2h0RXJyb3IgPSBudWxsOwogIHZhciBsZWdhY3lFcnJvckJvdW5kYXJpZXNUaGF0QWxyZWFkeUZhaWxlZCA9IG51bGw7IC8vIE9ubHkgdXNlZCB3aGVuIGVuYWJsZVByb2ZpbGVyTmVzdGVkVXBkYXRlU2NoZWR1bGVkSG9vayBpcyB0cnVlOwogIHZhciByb290RG9lc0hhdmVQYXNzaXZlRWZmZWN0cyA9IGZhbHNlOwogIHZhciByb290V2l0aFBlbmRpbmdQYXNzaXZlRWZmZWN0cyA9IG51bGw7CiAgdmFyIHBlbmRpbmdQYXNzaXZlRWZmZWN0c0xhbmVzID0gTm9MYW5lczsKICB2YXIgcGVuZGluZ1Bhc3NpdmVQcm9maWxlckVmZmVjdHMgPSBbXTsKICB2YXIgcGVuZGluZ1Bhc3NpdmVUcmFuc2l0aW9ucyA9IG51bGw7IC8vIFVzZSB0aGVzZSB0byBwcmV2ZW50IGFuIGluZmluaXRlIGxvb3Agb2YgbmVzdGVkIHVwZGF0ZXMKCiAgdmFyIE5FU1RFRF9VUERBVEVfTElNSVQgPSA1MDsKICB2YXIgbmVzdGVkVXBkYXRlQ291bnQgPSAwOwogIHZhciByb290V2l0aE5lc3RlZFVwZGF0ZXMgPSBudWxsOwogIHZhciBpc0ZsdXNoaW5nUGFzc2l2ZUVmZmVjdHMgPSBmYWxzZTsKICB2YXIgZGlkU2NoZWR1bGVVcGRhdGVEdXJpbmdQYXNzaXZlRWZmZWN0cyA9IGZhbHNlOwogIHZhciBORVNURURfUEFTU0lWRV9VUERBVEVfTElNSVQgPSA1MDsKICB2YXIgbmVzdGVkUGFzc2l2ZVVwZGF0ZUNvdW50ID0gMDsKICB2YXIgcm9vdFdpdGhQYXNzaXZlTmVzdGVkVXBkYXRlcyA9IG51bGw7IC8vIElmIHR3byB1cGRhdGVzIGFyZSBzY2hlZHVsZWQgd2l0aGluIHRoZSBzYW1lIGV2ZW50LCB3ZSBzaG91bGQgdHJlYXQgdGhlaXIKICAvLyBldmVudCB0aW1lcyBhcyBzaW11bHRhbmVvdXMsIGV2ZW4gaWYgdGhlIGFjdHVhbCBjbG9jayB0aW1lIGhhcyBhZHZhbmNlZAogIC8vIGJldHdlZW4gdGhlIGZpcnN0IGFuZCBzZWNvbmQgY2FsbC4KCiAgdmFyIGN1cnJlbnRFdmVudFRpbWUgPSBOb1RpbWVzdGFtcDsKICB2YXIgY3VycmVudEV2ZW50VHJhbnNpdGlvbkxhbmUgPSBOb0xhbmVzOwogIHZhciBpc1J1bm5pbmdJbnNlcnRpb25FZmZlY3QgPSBmYWxzZTsKICBmdW5jdGlvbiBnZXRXb3JrSW5Qcm9ncmVzc1Jvb3QoKSB7CiAgICByZXR1cm4gd29ya0luUHJvZ3Jlc3NSb290OwogIH0KICBmdW5jdGlvbiByZXF1ZXN0RXZlbnRUaW1lKCkgewogICAgaWYgKChleGVjdXRpb25Db250ZXh0ICYgKFJlbmRlckNvbnRleHQgfCBDb21taXRDb250ZXh0KSkgIT09IE5vQ29udGV4dCkgewogICAgICAvLyBXZSdyZSBpbnNpZGUgUmVhY3QsIHNvIGl0J3MgZmluZSB0byByZWFkIHRoZSBhY3R1YWwgdGltZS4KICAgICAgcmV0dXJuIG5vdygpOwogICAgfSAvLyBXZSdyZSBub3QgaW5zaWRlIFJlYWN0LCBzbyB3ZSBtYXkgYmUgaW4gdGhlIG1pZGRsZSBvZiBhIGJyb3dzZXIgZXZlbnQuCgoKICAgIGlmIChjdXJyZW50RXZlbnRUaW1lICE9PSBOb1RpbWVzdGFtcCkgewogICAgICAvLyBVc2UgdGhlIHNhbWUgc3RhcnQgdGltZSBmb3IgYWxsIHVwZGF0ZXMgdW50aWwgd2UgZW50ZXIgUmVhY3QgYWdhaW4uCiAgICAgIHJldHVybiBjdXJyZW50RXZlbnRUaW1lOwogICAgfSAvLyBUaGlzIGlzIHRoZSBmaXJzdCB1cGRhdGUgc2luY2UgUmVhY3QgeWllbGRlZC4gQ29tcHV0ZSBhIG5ldyBzdGFydCB0aW1lLgoKCiAgICBjdXJyZW50RXZlbnRUaW1lID0gbm93KCk7CiAgICByZXR1cm4gY3VycmVudEV2ZW50VGltZTsKICB9CiAgZnVuY3Rpb24gcmVxdWVzdFVwZGF0ZUxhbmUoZmliZXIpIHsKICAgIC8vIFNwZWNpYWwgY2FzZXMKICAgIHZhciBtb2RlID0gZmliZXIubW9kZTsKCiAgICBpZiAoKG1vZGUgJiBDb25jdXJyZW50TW9kZSkgPT09IE5vTW9kZSkgewogICAgICByZXR1cm4gU3luY0xhbmU7CiAgICB9IGVsc2UgaWYgKCAoZXhlY3V0aW9uQ29udGV4dCAmIFJlbmRlckNvbnRleHQpICE9PSBOb0NvbnRleHQgJiYgd29ya0luUHJvZ3Jlc3NSb290UmVuZGVyTGFuZXMgIT09IE5vTGFuZXMpIHsKICAgICAgLy8gVGhpcyBpcyBhIHJlbmRlciBwaGFzZSB1cGRhdGUuIFRoZXNlIGFyZSBub3Qgb2ZmaWNpYWxseSBzdXBwb3J0ZWQuIFRoZQogICAgICAvLyBvbGQgYmVoYXZpb3IgaXMgdG8gZ2l2ZSB0aGlzIHRoZSBzYW1lICJ0aHJlYWQiIChsYW5lcykgYXMKICAgICAgLy8gd2hhdGV2ZXIgaXMgY3VycmVudGx5IHJlbmRlcmluZy4gU28gaWYgeW91IGNhbGwgYHNldFN0YXRlYCBvbiBhIGNvbXBvbmVudAogICAgICAvLyB0aGF0IGhhcHBlbnMgbGF0ZXIgaW4gdGhlIHNhbWUgcmVuZGVyLCBpdCB3aWxsIGZsdXNoLiBJZGVhbGx5LCB3ZSB3YW50IHRvCiAgICAgIC8vIHJlbW92ZSB0aGUgc3BlY2lhbCBjYXNlIGFuZCB0cmVhdCB0aGVtIGFzIGlmIHRoZXkgY2FtZSBmcm9tIGFuCiAgICAgIC8vIGludGVybGVhdmVkIGV2ZW50LiBSZWdhcmRsZXNzLCB0aGlzIHBhdHRlcm4gaXMgbm90IG9mZmljaWFsbHkgc3VwcG9ydGVkLgogICAgICAvLyBUaGlzIGJlaGF2aW9yIGlzIG9ubHkgYSBmYWxsYmFjay4gVGhlIGZsYWcgb25seSBleGlzdHMgdW50aWwgd2UgY2FuIHJvbGwKICAgICAgLy8gb3V0IHRoZSBzZXRTdGF0ZSB3YXJuaW5nLCBzaW5jZSBleGlzdGluZyBjb2RlIG1pZ2h0IGFjY2lkZW50YWxseSByZWx5IG9uCiAgICAgIC8vIHRoZSBjdXJyZW50IGJlaGF2aW9yLgogICAgICByZXR1cm4gcGlja0FyYml0cmFyeUxhbmUod29ya0luUHJvZ3Jlc3NSb290UmVuZGVyTGFuZXMpOwogICAgfQoKICAgIHZhciBpc1RyYW5zaXRpb24gPSByZXF1ZXN0Q3VycmVudFRyYW5zaXRpb24oKSAhPT0gTm9UcmFuc2l0aW9uOwoKICAgIGlmIChpc1RyYW5zaXRpb24pIHsKICAgICAgaWYgKCBSZWFjdEN1cnJlbnRCYXRjaENvbmZpZyQzLnRyYW5zaXRpb24gIT09IG51bGwpIHsKICAgICAgICB2YXIgdHJhbnNpdGlvbiA9IFJlYWN0Q3VycmVudEJhdGNoQ29uZmlnJDMudHJhbnNpdGlvbjsKCiAgICAgICAgaWYgKCF0cmFuc2l0aW9uLl91cGRhdGVkRmliZXJzKSB7CiAgICAgICAgICB0cmFuc2l0aW9uLl91cGRhdGVkRmliZXJzID0gbmV3IFNldCgpOwogICAgICAgIH0KCiAgICAgICAgdHJhbnNpdGlvbi5fdXBkYXRlZEZpYmVycy5hZGQoZmliZXIpOwogICAgICB9IC8vIFRoZSBhbGdvcml0aG0gZm9yIGFzc2lnbmluZyBhbiB1cGRhdGUgdG8gYSBsYW5lIHNob3VsZCBiZSBzdGFibGUgZm9yIGFsbAogICAgICAvLyB1cGRhdGVzIGF0IHRoZSBzYW1lIHByaW9yaXR5IHdpdGhpbiB0aGUgc2FtZSBldmVudC4gVG8gZG8gdGhpcywgdGhlCiAgICAgIC8vIGlucHV0cyB0byB0aGUgYWxnb3JpdGhtIG11c3QgYmUgdGhlIHNhbWUuCiAgICAgIC8vCiAgICAgIC8vIFRoZSB0cmljayB3ZSB1c2UgaXMgdG8gY2FjaGUgdGhlIGZpcnN0IG9mIGVhY2ggb2YgdGhlc2UgaW5wdXRzIHdpdGhpbiBhbgogICAgICAvLyBldmVudC4gVGhlbiByZXNldCB0aGUgY2FjaGVkIHZhbHVlcyBvbmNlIHdlIGNhbiBiZSBzdXJlIHRoZSBldmVudCBpcwogICAgICAvLyBvdmVyLiBPdXIgaGV1cmlzdGljIGZvciB0aGF0IGlzIHdoZW5ldmVyIHdlIGVudGVyIGEgY29uY3VycmVudCB3b3JrIGxvb3AuCgoKICAgICAgaWYgKGN1cnJlbnRFdmVudFRyYW5zaXRpb25MYW5lID09PSBOb0xhbmUpIHsKICAgICAgICAvLyBBbGwgdHJhbnNpdGlvbnMgd2l0aGluIHRoZSBzYW1lIGV2ZW50IGFyZSBhc3NpZ25lZCB0aGUgc2FtZSBsYW5lLgogICAgICAgIGN1cnJlbnRFdmVudFRyYW5zaXRpb25MYW5lID0gY2xhaW1OZXh0VHJhbnNpdGlvbkxhbmUoKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGN1cnJlbnRFdmVudFRyYW5zaXRpb25MYW5lOwogICAgfSAvLyBVcGRhdGVzIG9yaWdpbmF0aW5nIGluc2lkZSBjZXJ0YWluIFJlYWN0IG1ldGhvZHMsIGxpa2UgZmx1c2hTeW5jLCBoYXZlCiAgICAvLyB0aGVpciBwcmlvcml0eSBzZXQgYnkgdHJhY2tpbmcgaXQgd2l0aCBhIGNvbnRleHQgdmFyaWFibGUuCiAgICAvLwogICAgLy8gVGhlIG9wYXF1ZSB0eXBlIHJldHVybmVkIGJ5IHRoZSBob3N0IGNvbmZpZyBpcyBpbnRlcm5hbGx5IGEgbGFuZSwgc28gd2UgY2FuCiAgICAvLyB1c2UgdGhhdCBkaXJlY3RseS4KICAgIC8vIFRPRE86IE1vdmUgdGhpcyB0eXBlIGNvbnZlcnNpb24gdG8gdGhlIGV2ZW50IHByaW9yaXR5IG1vZHVsZS4KCgogICAgdmFyIHVwZGF0ZUxhbmUgPSBnZXRDdXJyZW50VXBkYXRlUHJpb3JpdHkoKTsKCiAgICBpZiAodXBkYXRlTGFuZSAhPT0gTm9MYW5lKSB7CiAgICAgIHJldHVybiB1cGRhdGVMYW5lOwogICAgfSAvLyBUaGlzIHVwZGF0ZSBvcmlnaW5hdGVkIG91dHNpZGUgUmVhY3QuIEFzayB0aGUgaG9zdCBlbnZpcm9ubWVudCBmb3IgYW4KICAgIC8vIGFwcHJvcHJpYXRlIHByaW9yaXR5LCBiYXNlZCBvbiB0aGUgdHlwZSBvZiBldmVudC4KICAgIC8vCiAgICAvLyBUaGUgb3BhcXVlIHR5cGUgcmV0dXJuZWQgYnkgdGhlIGhvc3QgY29uZmlnIGlzIGludGVybmFsbHkgYSBsYW5lLCBzbyB3ZSBjYW4KICAgIC8vIHVzZSB0aGF0IGRpcmVjdGx5LgogICAgLy8gVE9ETzogTW92ZSB0aGlzIHR5cGUgY29udmVyc2lvbiB0byB0aGUgZXZlbnQgcHJpb3JpdHkgbW9kdWxlLgoKCiAgICB2YXIgZXZlbnRMYW5lID0gZ2V0Q3VycmVudEV2ZW50UHJpb3JpdHkoKTsKICAgIHJldHVybiBldmVudExhbmU7CiAgfQoKICBmdW5jdGlvbiByZXF1ZXN0UmV0cnlMYW5lKGZpYmVyKSB7CiAgICAvLyBUaGlzIGlzIGEgZm9yayBvZiBgcmVxdWVzdFVwZGF0ZUxhbmVgIGRlc2lnbmVkIHNwZWNpZmljYWxseSBmb3IgU3VzcGVuc2UKICAgIC8vICJyZXRyaWVzIiDigJQgYSBzcGVjaWFsIHVwZGF0ZSB0aGF0IGF0dGVtcHRzIHRvIGZsaXAgYSBTdXNwZW5zZSBib3VuZGFyeQogICAgLy8gZnJvbSBpdHMgcGxhY2Vob2xkZXIgc3RhdGUgdG8gaXRzIHByaW1hcnkvcmVzb2x2ZWQgc3RhdGUuCiAgICAvLyBTcGVjaWFsIGNhc2VzCiAgICB2YXIgbW9kZSA9IGZpYmVyLm1vZGU7CgogICAgaWYgKChtb2RlICYgQ29uY3VycmVudE1vZGUpID09PSBOb01vZGUpIHsKICAgICAgcmV0dXJuIFN5bmNMYW5lOwogICAgfQoKICAgIHJldHVybiBjbGFpbU5leHRSZXRyeUxhbmUoKTsKICB9CgogIGZ1bmN0aW9uIHNjaGVkdWxlVXBkYXRlT25GaWJlcihyb290LCBmaWJlciwgbGFuZSwgZXZlbnRUaW1lKSB7CiAgICBjaGVja0Zvck5lc3RlZFVwZGF0ZXMoKTsKCiAgICB7CiAgICAgIGlmIChpc1J1bm5pbmdJbnNlcnRpb25FZmZlY3QpIHsKICAgICAgICBlcnJvcigndXNlSW5zZXJ0aW9uRWZmZWN0IG11c3Qgbm90IHNjaGVkdWxlIHVwZGF0ZXMuJyk7CiAgICAgIH0KICAgIH0KCiAgICB7CiAgICAgIGlmIChpc0ZsdXNoaW5nUGFzc2l2ZUVmZmVjdHMpIHsKICAgICAgICBkaWRTY2hlZHVsZVVwZGF0ZUR1cmluZ1Bhc3NpdmVFZmZlY3RzID0gdHJ1ZTsKICAgICAgfQogICAgfSAvLyBNYXJrIHRoYXQgdGhlIHJvb3QgaGFzIGEgcGVuZGluZyB1cGRhdGUuCgoKICAgIG1hcmtSb290VXBkYXRlZChyb290LCBsYW5lLCBldmVudFRpbWUpOwoKICAgIGlmICgoZXhlY3V0aW9uQ29udGV4dCAmIFJlbmRlckNvbnRleHQpICE9PSBOb0xhbmVzICYmIHJvb3QgPT09IHdvcmtJblByb2dyZXNzUm9vdCkgewogICAgICAvLyBUaGlzIHVwZGF0ZSB3YXMgZGlzcGF0Y2hlZCBkdXJpbmcgdGhlIHJlbmRlciBwaGFzZS4gVGhpcyBpcyBhIG1pc3Rha2UKICAgICAgLy8gaWYgdGhlIHVwZGF0ZSBvcmlnaW5hdGVzIGZyb20gdXNlciBzcGFjZSAod2l0aCB0aGUgZXhjZXB0aW9uIG9mIGxvY2FsCiAgICAgIC8vIGhvb2sgdXBkYXRlcywgd2hpY2ggYXJlIGhhbmRsZWQgZGlmZmVyZW50bHkgYW5kIGRvbid0IHJlYWNoIHRoaXMKICAgICAgLy8gZnVuY3Rpb24pLCBidXQgdGhlcmUgYXJlIHNvbWUgaW50ZXJuYWwgUmVhY3QgZmVhdHVyZXMgdGhhdCB1c2UgdGhpcyBhcwogICAgICAvLyBhbiBpbXBsZW1lbnRhdGlvbiBkZXRhaWwsIGxpa2Ugc2VsZWN0aXZlIGh5ZHJhdGlvbi4KICAgICAgd2FybkFib3V0UmVuZGVyUGhhc2VVcGRhdGVzSW5ERVYoZmliZXIpOyAvLyBUcmFjayBsYW5lcyB0aGF0IHdlcmUgdXBkYXRlZCBkdXJpbmcgdGhlIHJlbmRlciBwaGFzZQogICAgfSBlbHNlIHsKICAgICAgLy8gVGhpcyBpcyBhIG5vcm1hbCB1cGRhdGUsIHNjaGVkdWxlZCBmcm9tIG91dHNpZGUgdGhlIHJlbmRlciBwaGFzZS4gRm9yCiAgICAgIC8vIGV4YW1wbGUsIGR1cmluZyBhbiBpbnB1dCBldmVudC4KICAgICAgewogICAgICAgIGlmIChpc0RldlRvb2xzUHJlc2VudCkgewogICAgICAgICAgYWRkRmliZXJUb0xhbmVzTWFwKHJvb3QsIGZpYmVyLCBsYW5lKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHdhcm5JZlVwZGF0ZXNOb3RXcmFwcGVkV2l0aEFjdERFVihmaWJlcik7CgogICAgICBpZiAocm9vdCA9PT0gd29ya0luUHJvZ3Jlc3NSb290KSB7CiAgICAgICAgLy8gUmVjZWl2ZWQgYW4gdXBkYXRlIHRvIGEgdHJlZSB0aGF0J3MgaW4gdGhlIG1pZGRsZSBvZiByZW5kZXJpbmcuIE1hcmsKICAgICAgICAvLyB0aGF0IHRoZXJlIHdhcyBhbiBpbnRlcmxlYXZlZCB1cGRhdGUgd29yayBvbiB0aGlzIHJvb3QuIFVubGVzcyB0aGUKICAgICAgICAvLyBgZGVmZXJSZW5kZXJQaGFzZVVwZGF0ZVRvTmV4dEJhdGNoYCBmbGFnIGlzIG9mZiBhbmQgdGhpcyBpcyBhIHJlbmRlcgogICAgICAgIC8vIHBoYXNlIHVwZGF0ZS4gSW4gdGhhdCBjYXNlLCB3ZSBkb24ndCB0cmVhdCByZW5kZXIgcGhhc2UgdXBkYXRlcyBhcyBpZgogICAgICAgIC8vIHRoZXkgd2VyZSBpbnRlcmxlYXZlZCwgZm9yIGJhY2t3YXJkcyBjb21wYXQgcmVhc29ucy4KICAgICAgICBpZiAoIChleGVjdXRpb25Db250ZXh0ICYgUmVuZGVyQ29udGV4dCkgPT09IE5vQ29udGV4dCkgewogICAgICAgICAgd29ya0luUHJvZ3Jlc3NSb290SW50ZXJsZWF2ZWRVcGRhdGVkTGFuZXMgPSBtZXJnZUxhbmVzKHdvcmtJblByb2dyZXNzUm9vdEludGVybGVhdmVkVXBkYXRlZExhbmVzLCBsYW5lKTsKICAgICAgICB9CgogICAgICAgIGlmICh3b3JrSW5Qcm9ncmVzc1Jvb3RFeGl0U3RhdHVzID09PSBSb290U3VzcGVuZGVkV2l0aERlbGF5KSB7CiAgICAgICAgICAvLyBUaGUgcm9vdCBhbHJlYWR5IHN1c3BlbmRlZCB3aXRoIGEgZGVsYXksIHdoaWNoIG1lYW5zIHRoaXMgcmVuZGVyCiAgICAgICAgICAvLyBkZWZpbml0ZWx5IHdvbid0IGZpbmlzaC4gU2luY2Ugd2UgaGF2ZSBhIG5ldyB1cGRhdGUsIGxldCdzIG1hcmsgaXQgYXMKICAgICAgICAgIC8vIHN1c3BlbmRlZCBub3csIHJpZ2h0IGJlZm9yZSBtYXJraW5nIHRoZSBpbmNvbWluZyB1cGRhdGUuIFRoaXMgaGFzIHRoZQogICAgICAgICAgLy8gZWZmZWN0IG9mIGludGVycnVwdGluZyB0aGUgY3VycmVudCByZW5kZXIgYW5kIHN3aXRjaGluZyB0byB0aGUgdXBkYXRlLgogICAgICAgICAgLy8gVE9ETzogTWFrZSBzdXJlIHRoaXMgZG9lc24ndCBvdmVycmlkZSBwaW5ncyB0aGF0IGhhcHBlbiB3aGlsZSB3ZSd2ZQogICAgICAgICAgLy8gYWxyZWFkeSBzdGFydGVkIHJlbmRlcmluZy4KICAgICAgICAgIG1hcmtSb290U3VzcGVuZGVkJDEocm9vdCwgd29ya0luUHJvZ3Jlc3NSb290UmVuZGVyTGFuZXMpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgZW5zdXJlUm9vdElzU2NoZWR1bGVkKHJvb3QsIGV2ZW50VGltZSk7CgogICAgICBpZiAobGFuZSA9PT0gU3luY0xhbmUgJiYgZXhlY3V0aW9uQ29udGV4dCA9PT0gTm9Db250ZXh0ICYmIChmaWJlci5tb2RlICYgQ29uY3VycmVudE1vZGUpID09PSBOb01vZGUgJiYgLy8gVHJlYXQgYGFjdGAgYXMgaWYgaXQncyBpbnNpZGUgYGJhdGNoZWRVcGRhdGVzYCwgZXZlbiBpbiBsZWdhY3kgbW9kZS4KICAgICAgISggUmVhY3RDdXJyZW50QWN0UXVldWUkMS5pc0JhdGNoaW5nTGVnYWN5KSkgewogICAgICAgIC8vIEZsdXNoIHRoZSBzeW5jaHJvbm91cyB3b3JrIG5vdywgdW5sZXNzIHdlJ3JlIGFscmVhZHkgd29ya2luZyBvciBpbnNpZGUKICAgICAgICAvLyBhIGJhdGNoLiBUaGlzIGlzIGludGVudGlvbmFsbHkgaW5zaWRlIHNjaGVkdWxlVXBkYXRlT25GaWJlciBpbnN0ZWFkIG9mCiAgICAgICAgLy8gc2NoZWR1bGVDYWxsYmFja0ZvckZpYmVyIHRvIHByZXNlcnZlIHRoZSBhYmlsaXR5IHRvIHNjaGVkdWxlIGEgY2FsbGJhY2sKICAgICAgICAvLyB3aXRob3V0IGltbWVkaWF0ZWx5IGZsdXNoaW5nIGl0LiBXZSBvbmx5IGRvIHRoaXMgZm9yIHVzZXItaW5pdGlhdGVkCiAgICAgICAgLy8gdXBkYXRlcywgdG8gcHJlc2VydmUgaGlzdG9yaWNhbCBiZWhhdmlvciBvZiBsZWdhY3kgbW9kZS4KICAgICAgICByZXNldFJlbmRlclRpbWVyKCk7CiAgICAgICAgZmx1c2hTeW5jQ2FsbGJhY2tzT25seUluTGVnYWN5TW9kZSgpOwogICAgICB9CiAgICB9CiAgfQogIGZ1bmN0aW9uIHNjaGVkdWxlSW5pdGlhbEh5ZHJhdGlvbk9uUm9vdChyb290LCBsYW5lLCBldmVudFRpbWUpIHsKICAgIC8vIFRoaXMgaXMgYSBzcGVjaWFsIGZvcmsgb2Ygc2NoZWR1bGVVcGRhdGVPbkZpYmVyIHRoYXQgaXMgb25seSB1c2VkIHRvCiAgICAvLyBzY2hlZHVsZSB0aGUgaW5pdGlhbCBoeWRyYXRpb24gb2YgYSByb290IHRoYXQgaGFzIGp1c3QgYmVlbiBjcmVhdGVkLiBNb3N0CiAgICAvLyBvZiB0aGUgc3R1ZmYgaW4gc2NoZWR1bGVVcGRhdGVPbkZpYmVyIGNhbiBiZSBza2lwcGVkLgogICAgLy8KICAgIC8vIFRoZSBtYWluIHJlYXNvbiBmb3IgdGhpcyBzZXBhcmF0ZSBwYXRoLCB0aG91Z2gsIGlzIHRvIGRpc3Rpbmd1aXNoIHRoZQogICAgLy8gaW5pdGlhbCBjaGlsZHJlbiBmcm9tIHN1YnNlcXVlbnQgdXBkYXRlcy4gSW4gZnVsbHkgY2xpZW50LXJlbmRlcmVkIHJvb3RzCiAgICAvLyAoY3JlYXRlUm9vdCBpbnN0ZWFkIG9mIGh5ZHJhdGVSb290KSwgYWxsIHRvcC1sZXZlbCByZW5kZXJzIGFyZSBtb2RlbGVkIGFzCiAgICAvLyB1cGRhdGVzLCBidXQgaHlkcmF0aW9uIHJvb3RzIGFyZSBzcGVjaWFsIGJlY2F1c2UgdGhlIGluaXRpYWwgcmVuZGVyIG11c3QKICAgIC8vIG1hdGNoIHdoYXQgd2FzIHJlbmRlcmVkIG9uIHRoZSBzZXJ2ZXIuCiAgICB2YXIgY3VycmVudCA9IHJvb3QuY3VycmVudDsKICAgIGN1cnJlbnQubGFuZXMgPSBsYW5lOwogICAgbWFya1Jvb3RVcGRhdGVkKHJvb3QsIGxhbmUsIGV2ZW50VGltZSk7CiAgICBlbnN1cmVSb290SXNTY2hlZHVsZWQocm9vdCwgZXZlbnRUaW1lKTsKICB9CiAgZnVuY3Rpb24gaXNVbnNhZmVDbGFzc1JlbmRlclBoYXNlVXBkYXRlKGZpYmVyKSB7CiAgICAvLyBDaGVjayBpZiB0aGlzIGlzIGEgcmVuZGVyIHBoYXNlIHVwZGF0ZS4gT25seSBjYWxsZWQgYnkgY2xhc3MgY29tcG9uZW50cywKICAgIC8vIHdoaWNoIHNwZWNpYWwgKGRlcHJlY2F0ZWQpIGJlaGF2aW9yIGZvciBVTlNBRkVfY29tcG9uZW50V2lsbFJlY2VpdmUgcHJvcHMuCiAgICByZXR1cm4gKC8vIFRPRE86IFJlbW92ZSBvdXRkYXRlZCBkZWZlclJlbmRlclBoYXNlVXBkYXRlVG9OZXh0QmF0Y2ggZXhwZXJpbWVudC4gV2UKICAgICAgLy8gZGVjaWRlZCBub3QgdG8gZW5hYmxlIGl0LgogICAgICAgKGV4ZWN1dGlvbkNvbnRleHQgJiBSZW5kZXJDb250ZXh0KSAhPT0gTm9Db250ZXh0CiAgICApOwogIH0gLy8gVXNlIHRoaXMgZnVuY3Rpb24gdG8gc2NoZWR1bGUgYSB0YXNrIGZvciBhIHJvb3QuIFRoZXJlJ3Mgb25seSBvbmUgdGFzayBwZXIKICAvLyByb290OyBpZiBhIHRhc2sgd2FzIGFscmVhZHkgc2NoZWR1bGVkLCB3ZSdsbCBjaGVjayB0byBtYWtlIHN1cmUgdGhlIHByaW9yaXR5CiAgLy8gb2YgdGhlIGV4aXN0aW5nIHRhc2sgaXMgdGhlIHNhbWUgYXMgdGhlIHByaW9yaXR5IG9mIHRoZSBuZXh0IGxldmVsIHRoYXQgdGhlCiAgLy8gcm9vdCBoYXMgd29yayBvbi4gVGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgb24gZXZlcnkgdXBkYXRlLCBhbmQgcmlnaHQgYmVmb3JlCiAgLy8gZXhpdGluZyBhIHRhc2suCgogIGZ1bmN0aW9uIGVuc3VyZVJvb3RJc1NjaGVkdWxlZChyb290LCBjdXJyZW50VGltZSkgewogICAgdmFyIGV4aXN0aW5nQ2FsbGJhY2tOb2RlID0gcm9vdC5jYWxsYmFja05vZGU7IC8vIENoZWNrIGlmIGFueSBsYW5lcyBhcmUgYmVpbmcgc3RhcnZlZCBieSBvdGhlciB3b3JrLiBJZiBzbywgbWFyayB0aGVtIGFzCiAgICAvLyBleHBpcmVkIHNvIHdlIGtub3cgdG8gd29yayBvbiB0aG9zZSBuZXh0LgoKICAgIG1hcmtTdGFydmVkTGFuZXNBc0V4cGlyZWQocm9vdCwgY3VycmVudFRpbWUpOyAvLyBEZXRlcm1pbmUgdGhlIG5leHQgbGFuZXMgdG8gd29yayBvbiwgYW5kIHRoZWlyIHByaW9yaXR5LgoKICAgIHZhciBuZXh0TGFuZXMgPSBnZXROZXh0TGFuZXMocm9vdCwgcm9vdCA9PT0gd29ya0luUHJvZ3Jlc3NSb290ID8gd29ya0luUHJvZ3Jlc3NSb290UmVuZGVyTGFuZXMgOiBOb0xhbmVzKTsKCiAgICBpZiAobmV4dExhbmVzID09PSBOb0xhbmVzKSB7CiAgICAgIC8vIFNwZWNpYWwgY2FzZTogVGhlcmUncyBub3RoaW5nIHRvIHdvcmsgb24uCiAgICAgIGlmIChleGlzdGluZ0NhbGxiYWNrTm9kZSAhPT0gbnVsbCkgewogICAgICAgIGNhbmNlbENhbGxiYWNrJDEoZXhpc3RpbmdDYWxsYmFja05vZGUpOwogICAgICB9CgogICAgICByb290LmNhbGxiYWNrTm9kZSA9IG51bGw7CiAgICAgIHJvb3QuY2FsbGJhY2tQcmlvcml0eSA9IE5vTGFuZTsKICAgICAgcmV0dXJuOwogICAgfSAvLyBXZSB1c2UgdGhlIGhpZ2hlc3QgcHJpb3JpdHkgbGFuZSB0byByZXByZXNlbnQgdGhlIHByaW9yaXR5IG9mIHRoZSBjYWxsYmFjay4KCgogICAgdmFyIG5ld0NhbGxiYWNrUHJpb3JpdHkgPSBnZXRIaWdoZXN0UHJpb3JpdHlMYW5lKG5leHRMYW5lcyk7IC8vIENoZWNrIGlmIHRoZXJlJ3MgYW4gZXhpc3RpbmcgdGFzay4gV2UgbWF5IGJlIGFibGUgdG8gcmV1c2UgaXQuCgogICAgdmFyIGV4aXN0aW5nQ2FsbGJhY2tQcmlvcml0eSA9IHJvb3QuY2FsbGJhY2tQcmlvcml0eTsKCiAgICBpZiAoZXhpc3RpbmdDYWxsYmFja1ByaW9yaXR5ID09PSBuZXdDYWxsYmFja1ByaW9yaXR5ICYmIC8vIFNwZWNpYWwgY2FzZSByZWxhdGVkIHRvIGBhY3RgLiBJZiB0aGUgY3VycmVudGx5IHNjaGVkdWxlZCB0YXNrIGlzIGEKICAgIC8vIFNjaGVkdWxlciB0YXNrLCByYXRoZXIgdGhhbiBhbiBgYWN0YCB0YXNrLCBjYW5jZWwgaXQgYW5kIHJlLXNjaGVkdWxlZAogICAgLy8gb24gdGhlIGBhY3RgIHF1ZXVlLgogICAgISggUmVhY3RDdXJyZW50QWN0UXVldWUkMS5jdXJyZW50ICE9PSBudWxsICYmIGV4aXN0aW5nQ2FsbGJhY2tOb2RlICE9PSBmYWtlQWN0Q2FsbGJhY2tOb2RlKSkgewogICAgICB7CiAgICAgICAgLy8gSWYgd2UncmUgZ29pbmcgdG8gcmUtdXNlIGFuIGV4aXN0aW5nIHRhc2ssIGl0IG5lZWRzIHRvIGV4aXN0LgogICAgICAgIC8vIEFzc3VtZSB0aGF0IGRpc2NyZXRlIHVwZGF0ZSBtaWNyb3Rhc2tzIGFyZSBub24tY2FuY2VsbGFibGUgYW5kIG51bGwuCiAgICAgICAgLy8gVE9ETzogVGVtcG9yYXJ5IHVudGlsIHdlIGNvbmZpcm0gdGhpcyB3YXJuaW5nIGlzIG5vdCBmaXJlZC4KICAgICAgICBpZiAoZXhpc3RpbmdDYWxsYmFja05vZGUgPT0gbnVsbCAmJiBleGlzdGluZ0NhbGxiYWNrUHJpb3JpdHkgIT09IFN5bmNMYW5lKSB7CiAgICAgICAgICBlcnJvcignRXhwZWN0ZWQgc2NoZWR1bGVkIGNhbGxiYWNrIHRvIGV4aXN0LiBUaGlzIGVycm9yIGlzIGxpa2VseSBjYXVzZWQgYnkgYSBidWcgaW4gUmVhY3QuIFBsZWFzZSBmaWxlIGFuIGlzc3VlLicpOwogICAgICAgIH0KICAgICAgfSAvLyBUaGUgcHJpb3JpdHkgaGFzbid0IGNoYW5nZWQuIFdlIGNhbiByZXVzZSB0aGUgZXhpc3RpbmcgdGFzay4gRXhpdC4KCgogICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKGV4aXN0aW5nQ2FsbGJhY2tOb2RlICE9IG51bGwpIHsKICAgICAgLy8gQ2FuY2VsIHRoZSBleGlzdGluZyBjYWxsYmFjay4gV2UnbGwgc2NoZWR1bGUgYSBuZXcgb25lIGJlbG93LgogICAgICBjYW5jZWxDYWxsYmFjayQxKGV4aXN0aW5nQ2FsbGJhY2tOb2RlKTsKICAgIH0gLy8gU2NoZWR1bGUgYSBuZXcgY2FsbGJhY2suCgoKICAgIHZhciBuZXdDYWxsYmFja05vZGU7CgogICAgaWYgKG5ld0NhbGxiYWNrUHJpb3JpdHkgPT09IFN5bmNMYW5lKSB7CiAgICAgIC8vIFNwZWNpYWwgY2FzZTogU3luYyBSZWFjdCBjYWxsYmFja3MgYXJlIHNjaGVkdWxlZCBvbiBhIHNwZWNpYWwKICAgICAgLy8gaW50ZXJuYWwgcXVldWUKICAgICAgaWYgKHJvb3QudGFnID09PSBMZWdhY3lSb290KSB7CiAgICAgICAgaWYgKCBSZWFjdEN1cnJlbnRBY3RRdWV1ZSQxLmlzQmF0Y2hpbmdMZWdhY3kgIT09IG51bGwpIHsKICAgICAgICAgIFJlYWN0Q3VycmVudEFjdFF1ZXVlJDEuZGlkU2NoZWR1bGVMZWdhY3lVcGRhdGUgPSB0cnVlOwogICAgICAgIH0KCiAgICAgICAgc2NoZWR1bGVMZWdhY3lTeW5jQ2FsbGJhY2socGVyZm9ybVN5bmNXb3JrT25Sb290LmJpbmQobnVsbCwgcm9vdCkpOwogICAgICB9IGVsc2UgewogICAgICAgIHNjaGVkdWxlU3luY0NhbGxiYWNrKHBlcmZvcm1TeW5jV29ya09uUm9vdC5iaW5kKG51bGwsIHJvb3QpKTsKICAgICAgfQoKICAgICAgewogICAgICAgIC8vIEZsdXNoIHRoZSBxdWV1ZSBpbiBhIG1pY3JvdGFzay4KICAgICAgICBpZiAoIFJlYWN0Q3VycmVudEFjdFF1ZXVlJDEuY3VycmVudCAhPT0gbnVsbCkgewogICAgICAgICAgLy8gSW5zaWRlIGBhY3RgLCB1c2Ugb3VyIGludGVybmFsIGBhY3RgIHF1ZXVlIHNvIHRoYXQgdGhlc2UgZ2V0IGZsdXNoZWQKICAgICAgICAgIC8vIGF0IHRoZSBlbmQgb2YgdGhlIGN1cnJlbnQgc2NvcGUgZXZlbiB3aGVuIHVzaW5nIHRoZSBzeW5jIHZlcnNpb24KICAgICAgICAgIC8vIG9mIGBhY3RgLgogICAgICAgICAgUmVhY3RDdXJyZW50QWN0UXVldWUkMS5jdXJyZW50LnB1c2goZmx1c2hTeW5jQ2FsbGJhY2tzKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgc2NoZWR1bGVNaWNyb3Rhc2soZnVuY3Rpb24gKCkgewogICAgICAgICAgICAvLyBJbiBTYWZhcmksIGFwcGVuZGluZyBhbiBpZnJhbWUgZm9yY2VzIG1pY3JvdGFza3MgdG8gcnVuLgogICAgICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2svcmVhY3QvaXNzdWVzLzIyNDU5CiAgICAgICAgICAgIC8vIFdlIGRvbid0IHN1cHBvcnQgcnVubmluZyBjYWxsYmFja3MgaW4gdGhlIG1pZGRsZSBvZiByZW5kZXIKICAgICAgICAgICAgLy8gb3IgY29tbWl0IHNvIHdlIG5lZWQgdG8gY2hlY2sgYWdhaW5zdCB0aGF0LgogICAgICAgICAgICBpZiAoKGV4ZWN1dGlvbkNvbnRleHQgJiAoUmVuZGVyQ29udGV4dCB8IENvbW1pdENvbnRleHQpKSA9PT0gTm9Db250ZXh0KSB7CiAgICAgICAgICAgICAgLy8gTm90ZSB0aGF0IHRoaXMgd291bGQgc3RpbGwgcHJlbWF0dXJlbHkgZmx1c2ggdGhlIGNhbGxiYWNrcwogICAgICAgICAgICAgIC8vIGlmIHRoaXMgaGFwcGVucyBvdXRzaWRlIHJlbmRlciBvciBjb21taXQgcGhhc2UgKGUuZy4gaW4gYW4gZXZlbnQpLgogICAgICAgICAgICAgIGZsdXNoU3luY0NhbGxiYWNrcygpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIG5ld0NhbGxiYWNrTm9kZSA9IG51bGw7CiAgICB9IGVsc2UgewogICAgICB2YXIgc2NoZWR1bGVyUHJpb3JpdHlMZXZlbDsKCiAgICAgIHN3aXRjaCAobGFuZXNUb0V2ZW50UHJpb3JpdHkobmV4dExhbmVzKSkgewogICAgICAgIGNhc2UgRGlzY3JldGVFdmVudFByaW9yaXR5OgogICAgICAgICAgc2NoZWR1bGVyUHJpb3JpdHlMZXZlbCA9IEltbWVkaWF0ZVByaW9yaXR5OwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgQ29udGludW91c0V2ZW50UHJpb3JpdHk6CiAgICAgICAgICBzY2hlZHVsZXJQcmlvcml0eUxldmVsID0gVXNlckJsb2NraW5nUHJpb3JpdHk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSBEZWZhdWx0RXZlbnRQcmlvcml0eToKICAgICAgICAgIHNjaGVkdWxlclByaW9yaXR5TGV2ZWwgPSBOb3JtYWxQcmlvcml0eTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIElkbGVFdmVudFByaW9yaXR5OgogICAgICAgICAgc2NoZWR1bGVyUHJpb3JpdHlMZXZlbCA9IElkbGVQcmlvcml0eTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgc2NoZWR1bGVyUHJpb3JpdHlMZXZlbCA9IE5vcm1hbFByaW9yaXR5OwogICAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIG5ld0NhbGxiYWNrTm9kZSA9IHNjaGVkdWxlQ2FsbGJhY2skMShzY2hlZHVsZXJQcmlvcml0eUxldmVsLCBwZXJmb3JtQ29uY3VycmVudFdvcmtPblJvb3QuYmluZChudWxsLCByb290KSk7CiAgICB9CgogICAgcm9vdC5jYWxsYmFja1ByaW9yaXR5ID0gbmV3Q2FsbGJhY2tQcmlvcml0eTsKICAgIHJvb3QuY2FsbGJhY2tOb2RlID0gbmV3Q2FsbGJhY2tOb2RlOwogIH0gLy8gVGhpcyBpcyB0aGUgZW50cnkgcG9pbnQgZm9yIGV2ZXJ5IGNvbmN1cnJlbnQgdGFzaywgaS5lLiBhbnl0aGluZyB0aGF0CiAgLy8gZ29lcyB0aHJvdWdoIFNjaGVkdWxlci4KCgogIGZ1bmN0aW9uIHBlcmZvcm1Db25jdXJyZW50V29ya09uUm9vdChyb290LCBkaWRUaW1lb3V0KSB7CiAgICB7CiAgICAgIHJlc2V0TmVzdGVkVXBkYXRlRmxhZygpOwogICAgfSAvLyBTaW5jZSB3ZSBrbm93IHdlJ3JlIGluIGEgUmVhY3QgZXZlbnQsIHdlIGNhbiBjbGVhciB0aGUgY3VycmVudAogICAgLy8gZXZlbnQgdGltZS4gVGhlIG5leHQgdXBkYXRlIHdpbGwgY29tcHV0ZSBhIG5ldyBldmVudCB0aW1lLgoKCiAgICBjdXJyZW50RXZlbnRUaW1lID0gTm9UaW1lc3RhbXA7CiAgICBjdXJyZW50RXZlbnRUcmFuc2l0aW9uTGFuZSA9IE5vTGFuZXM7CgogICAgaWYgKChleGVjdXRpb25Db250ZXh0ICYgKFJlbmRlckNvbnRleHQgfCBDb21taXRDb250ZXh0KSkgIT09IE5vQ29udGV4dCkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Nob3VsZCBub3QgYWxyZWFkeSBiZSB3b3JraW5nLicpOwogICAgfSAvLyBGbHVzaCBhbnkgcGVuZGluZyBwYXNzaXZlIGVmZmVjdHMgYmVmb3JlIGRlY2lkaW5nIHdoaWNoIGxhbmVzIHRvIHdvcmsgb24sCiAgICAvLyBpbiBjYXNlIHRoZXkgc2NoZWR1bGUgYWRkaXRpb25hbCB3b3JrLgoKCiAgICB2YXIgb3JpZ2luYWxDYWxsYmFja05vZGUgPSByb290LmNhbGxiYWNrTm9kZTsKICAgIHZhciBkaWRGbHVzaFBhc3NpdmVFZmZlY3RzID0gZmx1c2hQYXNzaXZlRWZmZWN0cygpOwoKICAgIGlmIChkaWRGbHVzaFBhc3NpdmVFZmZlY3RzKSB7CiAgICAgIC8vIFNvbWV0aGluZyBpbiB0aGUgcGFzc2l2ZSBlZmZlY3QgcGhhc2UgbWF5IGhhdmUgY2FuY2VsZWQgdGhlIGN1cnJlbnQgdGFzay4KICAgICAgLy8gQ2hlY2sgaWYgdGhlIHRhc2sgbm9kZSBmb3IgdGhpcyByb290IHdhcyBjaGFuZ2VkLgogICAgICBpZiAocm9vdC5jYWxsYmFja05vZGUgIT09IG9yaWdpbmFsQ2FsbGJhY2tOb2RlKSB7CiAgICAgICAgLy8gVGhlIGN1cnJlbnQgdGFzayB3YXMgY2FuY2VsZWQuIEV4aXQuIFdlIGRvbid0IG5lZWQgdG8gY2FsbAogICAgICAgIC8vIGBlbnN1cmVSb290SXNTY2hlZHVsZWRgIGJlY2F1c2UgdGhlIGNoZWNrIGFib3ZlIGltcGxpZXMgZWl0aGVyIHRoYXQKICAgICAgICAvLyB0aGVyZSdzIGEgbmV3IHRhc2ssIG9yIHRoYXQgdGhlcmUncyBubyByZW1haW5pbmcgd29yayBvbiB0aGlzIHJvb3QuCiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgIH0gLy8gRGV0ZXJtaW5lIHRoZSBuZXh0IGxhbmVzIHRvIHdvcmsgb24sIHVzaW5nIHRoZSBmaWVsZHMgc3RvcmVkCiAgICAvLyBvbiB0aGUgcm9vdC4KCgogICAgdmFyIGxhbmVzID0gZ2V0TmV4dExhbmVzKHJvb3QsIHJvb3QgPT09IHdvcmtJblByb2dyZXNzUm9vdCA/IHdvcmtJblByb2dyZXNzUm9vdFJlbmRlckxhbmVzIDogTm9MYW5lcyk7CgogICAgaWYgKGxhbmVzID09PSBOb0xhbmVzKSB7CiAgICAgIC8vIERlZmVuc2l2ZSBjb2RpbmcuIFRoaXMgaXMgbmV2ZXIgZXhwZWN0ZWQgdG8gaGFwcGVuLgogICAgICByZXR1cm4gbnVsbDsKICAgIH0gLy8gV2UgZGlzYWJsZSB0aW1lLXNsaWNpbmcgaW4gc29tZSBjYXNlczogaWYgdGhlIHdvcmsgaGFzIGJlZW4gQ1BVLWJvdW5kCiAgICAvLyBmb3IgdG9vIGxvbmcgKCJleHBpcmVkIiB3b3JrLCB0byBwcmV2ZW50IHN0YXJ2YXRpb24pLCBvciB3ZSdyZSBpbgogICAgLy8gc3luYy11cGRhdGVzLWJ5LWRlZmF1bHQgbW9kZS4KICAgIC8vIFRPRE86IFdlIG9ubHkgY2hlY2sgYGRpZFRpbWVvdXRgIGRlZmVuc2l2ZWx5LCB0byBhY2NvdW50IGZvciBhIFNjaGVkdWxlcgogICAgLy8gYnVnIHdlJ3JlIHN0aWxsIGludmVzdGlnYXRpbmcuIE9uY2UgdGhlIGJ1ZyBpbiBTY2hlZHVsZXIgaXMgZml4ZWQsCiAgICAvLyB3ZSBjYW4gcmVtb3ZlIHRoaXMsIHNpbmNlIHdlIHRyYWNrIGV4cGlyYXRpb24gb3Vyc2VsdmVzLgoKCiAgICB2YXIgc2hvdWxkVGltZVNsaWNlID0gIWluY2x1ZGVzQmxvY2tpbmdMYW5lKHJvb3QsIGxhbmVzKSAmJiAhaW5jbHVkZXNFeHBpcmVkTGFuZShyb290LCBsYW5lcykgJiYgKCAhZGlkVGltZW91dCk7CiAgICB2YXIgZXhpdFN0YXR1cyA9IHNob3VsZFRpbWVTbGljZSA/IHJlbmRlclJvb3RDb25jdXJyZW50KHJvb3QsIGxhbmVzKSA6IHJlbmRlclJvb3RTeW5jKHJvb3QsIGxhbmVzKTsKCiAgICBpZiAoZXhpdFN0YXR1cyAhPT0gUm9vdEluUHJvZ3Jlc3MpIHsKICAgICAgaWYgKGV4aXRTdGF0dXMgPT09IFJvb3RFcnJvcmVkKSB7CiAgICAgICAgLy8gSWYgc29tZXRoaW5nIHRocmV3IGFuIGVycm9yLCB0cnkgcmVuZGVyaW5nIG9uZSBtb3JlIHRpbWUuIFdlJ2xsCiAgICAgICAgLy8gcmVuZGVyIHN5bmNocm9ub3VzbHkgdG8gYmxvY2sgY29uY3VycmVudCBkYXRhIG11dGF0aW9ucywgYW5kIHdlJ2xsCiAgICAgICAgLy8gaW5jbHVkZXMgYWxsIHBlbmRpbmcgdXBkYXRlcyBhcmUgaW5jbHVkZWQuIElmIGl0IHN0aWxsIGZhaWxzIGFmdGVyCiAgICAgICAgLy8gdGhlIHNlY29uZCBhdHRlbXB0LCB3ZSdsbCBnaXZlIHVwIGFuZCBjb21taXQgdGhlIHJlc3VsdGluZyB0cmVlLgogICAgICAgIHZhciBlcnJvclJldHJ5TGFuZXMgPSBnZXRMYW5lc1RvUmV0cnlTeW5jaHJvbm91c2x5T25FcnJvcihyb290KTsKCiAgICAgICAgaWYgKGVycm9yUmV0cnlMYW5lcyAhPT0gTm9MYW5lcykgewogICAgICAgICAgbGFuZXMgPSBlcnJvclJldHJ5TGFuZXM7CiAgICAgICAgICBleGl0U3RhdHVzID0gcmVjb3ZlckZyb21Db25jdXJyZW50RXJyb3Iocm9vdCwgZXJyb3JSZXRyeUxhbmVzKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChleGl0U3RhdHVzID09PSBSb290RmF0YWxFcnJvcmVkKSB7CiAgICAgICAgdmFyIGZhdGFsRXJyb3IgPSB3b3JrSW5Qcm9ncmVzc1Jvb3RGYXRhbEVycm9yOwogICAgICAgIHByZXBhcmVGcmVzaFN0YWNrKHJvb3QsIE5vTGFuZXMpOwogICAgICAgIG1hcmtSb290U3VzcGVuZGVkJDEocm9vdCwgbGFuZXMpOwogICAgICAgIGVuc3VyZVJvb3RJc1NjaGVkdWxlZChyb290LCBub3coKSk7CiAgICAgICAgdGhyb3cgZmF0YWxFcnJvcjsKICAgICAgfQoKICAgICAgaWYgKGV4aXRTdGF0dXMgPT09IFJvb3REaWROb3RDb21wbGV0ZSkgewogICAgICAgIC8vIFRoZSByZW5kZXIgdW53b3VuZCB3aXRob3V0IGNvbXBsZXRpbmcgdGhlIHRyZWUuIFRoaXMgaGFwcGVucyBpbiBzcGVjaWFsCiAgICAgICAgLy8gY2FzZXMgd2hlcmUgbmVlZCB0byBleGl0IHRoZSBjdXJyZW50IHJlbmRlciB3aXRob3V0IHByb2R1Y2luZyBhCiAgICAgICAgLy8gY29uc2lzdGVudCB0cmVlIG9yIGNvbW1pdHRpbmcuCiAgICAgICAgLy8KICAgICAgICAvLyBUaGlzIHNob3VsZCBvbmx5IGhhcHBlbiBkdXJpbmcgYSBjb25jdXJyZW50IHJlbmRlciwgbm90IGEgZGlzY3JldGUgb3IKICAgICAgICAvLyBzeW5jaHJvbm91cyB1cGRhdGUuIFdlIHNob3VsZCBoYXZlIGFscmVhZHkgY2hlY2tlZCBmb3IgdGhpcyB3aGVuIHdlCiAgICAgICAgLy8gdW53b3VuZCB0aGUgc3RhY2suCiAgICAgICAgbWFya1Jvb3RTdXNwZW5kZWQkMShyb290LCBsYW5lcyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gVGhlIHJlbmRlciBjb21wbGV0ZWQuCiAgICAgICAgLy8gQ2hlY2sgaWYgdGhpcyByZW5kZXIgbWF5IGhhdmUgeWllbGRlZCB0byBhIGNvbmN1cnJlbnQgZXZlbnQsIGFuZCBpZiBzbywKICAgICAgICAvLyBjb25maXJtIHRoYXQgYW55IG5ld2x5IHJlbmRlcmVkIHN0b3JlcyBhcmUgY29uc2lzdGVudC4KICAgICAgICAvLyBUT0RPOiBJdCdzIHBvc3NpYmxlIHRoYXQgZXZlbiBhIGNvbmN1cnJlbnQgcmVuZGVyIG1heSBuZXZlciBoYXZlIHlpZWxkZWQKICAgICAgICAvLyB0byB0aGUgbWFpbiB0aHJlYWQsIGlmIGl0IHdhcyBmYXN0IGVub3VnaCwgb3IgaWYgaXQgZXhwaXJlZC4gV2UgY291bGQKICAgICAgICAvLyBza2lwIHRoZSBjb25zaXN0ZW5jeSBjaGVjayBpbiB0aGF0IGNhc2UsIHRvby4KICAgICAgICB2YXIgcmVuZGVyV2FzQ29uY3VycmVudCA9ICFpbmNsdWRlc0Jsb2NraW5nTGFuZShyb290LCBsYW5lcyk7CiAgICAgICAgdmFyIGZpbmlzaGVkV29yayA9IHJvb3QuY3VycmVudC5hbHRlcm5hdGU7CgogICAgICAgIGlmIChyZW5kZXJXYXNDb25jdXJyZW50ICYmICFpc1JlbmRlckNvbnNpc3RlbnRXaXRoRXh0ZXJuYWxTdG9yZXMoZmluaXNoZWRXb3JrKSkgewogICAgICAgICAgLy8gQSBzdG9yZSB3YXMgbXV0YXRlZCBpbiBhbiBpbnRlcmxlYXZlZCBldmVudC4gUmVuZGVyIGFnYWluLAogICAgICAgICAgLy8gc3luY2hyb25vdXNseSwgdG8gYmxvY2sgZnVydGhlciBtdXRhdGlvbnMuCiAgICAgICAgICBleGl0U3RhdHVzID0gcmVuZGVyUm9vdFN5bmMocm9vdCwgbGFuZXMpOyAvLyBXZSBuZWVkIHRvIGNoZWNrIGFnYWluIGlmIHNvbWV0aGluZyB0aHJldwoKICAgICAgICAgIGlmIChleGl0U3RhdHVzID09PSBSb290RXJyb3JlZCkgewogICAgICAgICAgICB2YXIgX2Vycm9yUmV0cnlMYW5lcyA9IGdldExhbmVzVG9SZXRyeVN5bmNocm9ub3VzbHlPbkVycm9yKHJvb3QpOwoKICAgICAgICAgICAgaWYgKF9lcnJvclJldHJ5TGFuZXMgIT09IE5vTGFuZXMpIHsKICAgICAgICAgICAgICBsYW5lcyA9IF9lcnJvclJldHJ5TGFuZXM7CiAgICAgICAgICAgICAgZXhpdFN0YXR1cyA9IHJlY292ZXJGcm9tQ29uY3VycmVudEVycm9yKHJvb3QsIF9lcnJvclJldHJ5TGFuZXMpOyAvLyBXZSBhc3N1bWUgdGhlIHRyZWUgaXMgbm93IGNvbnNpc3RlbnQgYmVjYXVzZSB3ZSBkaWRuJ3QgeWllbGQgdG8gYW55CiAgICAgICAgICAgICAgLy8gY29uY3VycmVudCBldmVudHMuCiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoZXhpdFN0YXR1cyA9PT0gUm9vdEZhdGFsRXJyb3JlZCkgewogICAgICAgICAgICB2YXIgX2ZhdGFsRXJyb3IgPSB3b3JrSW5Qcm9ncmVzc1Jvb3RGYXRhbEVycm9yOwogICAgICAgICAgICBwcmVwYXJlRnJlc2hTdGFjayhyb290LCBOb0xhbmVzKTsKICAgICAgICAgICAgbWFya1Jvb3RTdXNwZW5kZWQkMShyb290LCBsYW5lcyk7CiAgICAgICAgICAgIGVuc3VyZVJvb3RJc1NjaGVkdWxlZChyb290LCBub3coKSk7CiAgICAgICAgICAgIHRocm93IF9mYXRhbEVycm9yOwogICAgICAgICAgfQogICAgICAgIH0gLy8gV2Ugbm93IGhhdmUgYSBjb25zaXN0ZW50IHRyZWUuIFRoZSBuZXh0IHN0ZXAgaXMgZWl0aGVyIHRvIGNvbW1pdCBpdCwKICAgICAgICAvLyBvciwgaWYgc29tZXRoaW5nIHN1c3BlbmRlZCwgd2FpdCB0byBjb21taXQgaXQgYWZ0ZXIgYSB0aW1lb3V0LgoKCiAgICAgICAgcm9vdC5maW5pc2hlZFdvcmsgPSBmaW5pc2hlZFdvcms7CiAgICAgICAgcm9vdC5maW5pc2hlZExhbmVzID0gbGFuZXM7CiAgICAgICAgZmluaXNoQ29uY3VycmVudFJlbmRlcihyb290LCBleGl0U3RhdHVzLCBsYW5lcyk7CiAgICAgIH0KICAgIH0KCiAgICBlbnN1cmVSb290SXNTY2hlZHVsZWQocm9vdCwgbm93KCkpOwoKICAgIGlmIChyb290LmNhbGxiYWNrTm9kZSA9PT0gb3JpZ2luYWxDYWxsYmFja05vZGUpIHsKICAgICAgLy8gVGhlIHRhc2sgbm9kZSBzY2hlZHVsZWQgZm9yIHRoaXMgcm9vdCBpcyB0aGUgc2FtZSBvbmUgdGhhdCdzCiAgICAgIC8vIGN1cnJlbnRseSBleGVjdXRlZC4gTmVlZCB0byByZXR1cm4gYSBjb250aW51YXRpb24uCiAgICAgIHJldHVybiBwZXJmb3JtQ29uY3VycmVudFdvcmtPblJvb3QuYmluZChudWxsLCByb290KTsKICAgIH0KCiAgICByZXR1cm4gbnVsbDsKICB9CgogIGZ1bmN0aW9uIHJlY292ZXJGcm9tQ29uY3VycmVudEVycm9yKHJvb3QsIGVycm9yUmV0cnlMYW5lcykgewogICAgLy8gSWYgYW4gZXJyb3Igb2NjdXJyZWQgZHVyaW5nIGh5ZHJhdGlvbiwgZGlzY2FyZCBzZXJ2ZXIgcmVzcG9uc2UgYW5kIGZhbGwKICAgIC8vIGJhY2sgdG8gY2xpZW50IHNpZGUgcmVuZGVyLgogICAgLy8gQmVmb3JlIHJlbmRlcmluZyBhZ2Fpbiwgc2F2ZSB0aGUgZXJyb3JzIGZyb20gdGhlIHByZXZpb3VzIGF0dGVtcHQuCiAgICB2YXIgZXJyb3JzRnJvbUZpcnN0QXR0ZW1wdCA9IHdvcmtJblByb2dyZXNzUm9vdENvbmN1cnJlbnRFcnJvcnM7CgogICAgaWYgKGlzUm9vdERlaHlkcmF0ZWQocm9vdCkpIHsKICAgICAgLy8gVGhlIHNoZWxsIGZhaWxlZCB0byBoeWRyYXRlLiBTZXQgYSBmbGFnIHRvIGZvcmNlIGEgY2xpZW50IHJlbmRlcmluZwogICAgICAvLyBkdXJpbmcgdGhlIG5leHQgYXR0ZW1wdC4gVG8gZG8gdGhpcywgd2UgY2FsbCBwcmVwYXJlRnJlc2hTdGFjayBub3cKICAgICAgLy8gdG8gY3JlYXRlIHRoZSByb290IHdvcmstaW4tcHJvZ3Jlc3MgZmliZXIuIFRoaXMgaXMgYSBiaXQgd2VpcmQgaW4gdGVybXMKICAgICAgLy8gb2YgZmFjdG9yaW5nLCBiZWNhdXNlIGl0IHJlbGllcyBvbiByZW5kZXJSb290U3luYyBub3QgY2FsbGluZwogICAgICAvLyBwcmVwYXJlRnJlc2hTdGFjayBhZ2FpbiBpbiB0aGUgY2FsbCBiZWxvdywgd2hpY2ggaGFwcGVucyBiZWNhdXNlIHRoZQogICAgICAvLyByb290IGFuZCBsYW5lcyBoYXZlbid0IGNoYW5nZWQuCiAgICAgIC8vCiAgICAgIC8vIFRPRE86IEkgdGhpbmsgd2hhdCB3ZSBzaG91bGQgZG8gaXMgc2V0IEZvcmNlQ2xpZW50UmVuZGVyIGluc2lkZQogICAgICAvLyB0aHJvd0V4Y2VwdGlvbiwgbGlrZSB3ZSBkbyBmb3IgbmVzdGVkIFN1c3BlbnNlIGJvdW5kYXJpZXMuIFRoZSByZWFzb24KICAgICAgLy8gaXQncyBoZXJlIGluc3RlYWQgaXMgc28gd2UgY2FuIHN3aXRjaCB0byB0aGUgc3luY2hyb25vdXMgd29yayBsb29wLCB0b28uCiAgICAgIC8vIFNvbWV0aGluZyB0byBjb25zaWRlciBmb3IgYSBmdXR1cmUgcmVmYWN0b3IuCiAgICAgIHZhciByb290V29ya0luUHJvZ3Jlc3MgPSBwcmVwYXJlRnJlc2hTdGFjayhyb290LCBlcnJvclJldHJ5TGFuZXMpOwogICAgICByb290V29ya0luUHJvZ3Jlc3MuZmxhZ3MgfD0gRm9yY2VDbGllbnRSZW5kZXI7CgogICAgICB7CiAgICAgICAgZXJyb3JIeWRyYXRpbmdDb250YWluZXIocm9vdC5jb250YWluZXJJbmZvKTsKICAgICAgfQogICAgfQoKICAgIHZhciBleGl0U3RhdHVzID0gcmVuZGVyUm9vdFN5bmMocm9vdCwgZXJyb3JSZXRyeUxhbmVzKTsKCiAgICBpZiAoZXhpdFN0YXR1cyAhPT0gUm9vdEVycm9yZWQpIHsKICAgICAgLy8gU3VjY2Vzc2Z1bGx5IGZpbmlzaGVkIHJlbmRlcmluZyBvbiByZXRyeQogICAgICAvLyBUaGUgZXJyb3JzIGZyb20gdGhlIGZhaWxlZCBmaXJzdCBhdHRlbXB0IGhhdmUgYmVlbiByZWNvdmVyZWQuIEFkZAogICAgICAvLyB0aGVtIHRvIHRoZSBjb2xsZWN0aW9uIG9mIHJlY292ZXJhYmxlIGVycm9ycy4gV2UnbGwgbG9nIHRoZW0gaW4gdGhlCiAgICAgIC8vIGNvbW1pdCBwaGFzZS4KICAgICAgdmFyIGVycm9yc0Zyb21TZWNvbmRBdHRlbXB0ID0gd29ya0luUHJvZ3Jlc3NSb290UmVjb3ZlcmFibGVFcnJvcnM7CiAgICAgIHdvcmtJblByb2dyZXNzUm9vdFJlY292ZXJhYmxlRXJyb3JzID0gZXJyb3JzRnJvbUZpcnN0QXR0ZW1wdDsgLy8gVGhlIGVycm9ycyBmcm9tIHRoZSBzZWNvbmQgYXR0ZW1wdCBzaG91bGQgYmUgcXVldWVkIGFmdGVyIHRoZSBlcnJvcnMKICAgICAgLy8gZnJvbSB0aGUgZmlyc3QgYXR0ZW1wdCwgdG8gcHJlc2VydmUgdGhlIGNhdXNhbCBzZXF1ZW5jZS4KCiAgICAgIGlmIChlcnJvcnNGcm9tU2Vjb25kQXR0ZW1wdCAhPT0gbnVsbCkgewogICAgICAgIHF1ZXVlUmVjb3ZlcmFibGVFcnJvcnMoZXJyb3JzRnJvbVNlY29uZEF0dGVtcHQpOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIGV4aXRTdGF0dXM7CiAgfQoKICBmdW5jdGlvbiBxdWV1ZVJlY292ZXJhYmxlRXJyb3JzKGVycm9ycykgewogICAgaWYgKHdvcmtJblByb2dyZXNzUm9vdFJlY292ZXJhYmxlRXJyb3JzID09PSBudWxsKSB7CiAgICAgIHdvcmtJblByb2dyZXNzUm9vdFJlY292ZXJhYmxlRXJyb3JzID0gZXJyb3JzOwogICAgfSBlbHNlIHsKICAgICAgd29ya0luUHJvZ3Jlc3NSb290UmVjb3ZlcmFibGVFcnJvcnMucHVzaC5hcHBseSh3b3JrSW5Qcm9ncmVzc1Jvb3RSZWNvdmVyYWJsZUVycm9ycywgZXJyb3JzKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGZpbmlzaENvbmN1cnJlbnRSZW5kZXIocm9vdCwgZXhpdFN0YXR1cywgbGFuZXMpIHsKICAgIHN3aXRjaCAoZXhpdFN0YXR1cykgewogICAgICBjYXNlIFJvb3RJblByb2dyZXNzOgogICAgICBjYXNlIFJvb3RGYXRhbEVycm9yZWQ6CiAgICAgICAgewogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdSb290IGRpZCBub3QgY29tcGxldGUuIFRoaXMgaXMgYSBidWcgaW4gUmVhY3QuJyk7CiAgICAgICAgfQogICAgICAvLyBGbG93IGtub3dzIGFib3V0IGludmFyaWFudCwgc28gaXQgY29tcGxhaW5zIGlmIEkgYWRkIGEgYnJlYWsKICAgICAgLy8gc3RhdGVtZW50LCBidXQgZXNsaW50IGRvZXNuJ3Qga25vdyBhYm91dCBpbnZhcmlhbnQsIHNvIGl0IGNvbXBsYWlucwogICAgICAvLyBpZiBJIGRvLiBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tZmFsbHRocm91Z2gKCiAgICAgIGNhc2UgUm9vdEVycm9yZWQ6CiAgICAgICAgewogICAgICAgICAgLy8gV2Ugc2hvdWxkIGhhdmUgYWxyZWFkeSBhdHRlbXB0ZWQgdG8gcmV0cnkgdGhpcyB0cmVlLiBJZiB3ZSByZWFjaGVkCiAgICAgICAgICAvLyB0aGlzIHBvaW50LCBpdCBlcnJvcmVkIGFnYWluLiBDb21taXQgaXQuCiAgICAgICAgICBjb21taXRSb290KHJvb3QsIHdvcmtJblByb2dyZXNzUm9vdFJlY292ZXJhYmxlRXJyb3JzLCB3b3JrSW5Qcm9ncmVzc1RyYW5zaXRpb25zKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgIGNhc2UgUm9vdFN1c3BlbmRlZDoKICAgICAgICB7CiAgICAgICAgICBtYXJrUm9vdFN1c3BlbmRlZCQxKHJvb3QsIGxhbmVzKTsgLy8gV2UgaGF2ZSBhbiBhY2NlcHRhYmxlIGxvYWRpbmcgc3RhdGUuIFdlIG5lZWQgdG8gZmlndXJlIG91dCBpZiB3ZQogICAgICAgICAgLy8gc2hvdWxkIGltbWVkaWF0ZWx5IGNvbW1pdCBpdCBvciB3YWl0IGEgYml0LgoKICAgICAgICAgIGlmIChpbmNsdWRlc09ubHlSZXRyaWVzKGxhbmVzKSAmJiAvLyBkbyBub3QgZGVsYXkgaWYgd2UncmUgaW5zaWRlIGFuIGFjdCgpIHNjb3BlCiAgICAgICAgICAhc2hvdWxkRm9yY2VGbHVzaEZhbGxiYWNrc0luREVWKCkpIHsKICAgICAgICAgICAgLy8gVGhpcyByZW5kZXIgb25seSBpbmNsdWRlZCByZXRyaWVzLCBubyB1cGRhdGVzLiBUaHJvdHRsZSBjb21taXR0aW5nCiAgICAgICAgICAgIC8vIHJldHJpZXMgc28gdGhhdCB3ZSBkb24ndCBzaG93IHRvbyBtYW55IGxvYWRpbmcgc3RhdGVzIHRvbyBxdWlja2x5LgogICAgICAgICAgICB2YXIgbXNVbnRpbFRpbWVvdXQgPSBnbG9iYWxNb3N0UmVjZW50RmFsbGJhY2tUaW1lICsgRkFMTEJBQ0tfVEhST1RUTEVfTVMgLSBub3coKTsgLy8gRG9uJ3QgYm90aGVyIHdpdGggYSB2ZXJ5IHNob3J0IHN1c3BlbnNlIHRpbWUuCgogICAgICAgICAgICBpZiAobXNVbnRpbFRpbWVvdXQgPiAxMCkgewogICAgICAgICAgICAgIHZhciBuZXh0TGFuZXMgPSBnZXROZXh0TGFuZXMocm9vdCwgTm9MYW5lcyk7CgogICAgICAgICAgICAgIGlmIChuZXh0TGFuZXMgIT09IE5vTGFuZXMpIHsKICAgICAgICAgICAgICAgIC8vIFRoZXJlJ3MgYWRkaXRpb25hbCB3b3JrIG9uIHRoaXMgcm9vdC4KICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdmFyIHN1c3BlbmRlZExhbmVzID0gcm9vdC5zdXNwZW5kZWRMYW5lczsKCiAgICAgICAgICAgICAgaWYgKCFpc1N1YnNldE9mTGFuZXMoc3VzcGVuZGVkTGFuZXMsIGxhbmVzKSkgewogICAgICAgICAgICAgICAgLy8gV2Ugc2hvdWxkIHByZWZlciB0byByZW5kZXIgdGhlIGZhbGxiYWNrIG9mIGF0IHRoZSBsYXN0CiAgICAgICAgICAgICAgICAvLyBzdXNwZW5kZWQgbGV2ZWwuIFBpbmcgdGhlIGxhc3Qgc3VzcGVuZGVkIGxldmVsIHRvIHRyeQogICAgICAgICAgICAgICAgLy8gcmVuZGVyaW5nIGl0IGFnYWluLgogICAgICAgICAgICAgICAgLy8gRklYTUU6IFdoYXQgaWYgdGhlIHN1c3BlbmRlZCBsYW5lcyBhcmUgSWRsZT8gU2hvdWxkIG5vdCByZXN0YXJ0LgogICAgICAgICAgICAgICAgdmFyIGV2ZW50VGltZSA9IHJlcXVlc3RFdmVudFRpbWUoKTsKICAgICAgICAgICAgICAgIG1hcmtSb290UGluZ2VkKHJvb3QsIHN1c3BlbmRlZExhbmVzKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0gLy8gVGhlIHJlbmRlciBpcyBzdXNwZW5kZWQsIGl0IGhhc24ndCB0aW1lZCBvdXQsIGFuZCB0aGVyZSdzIG5vCiAgICAgICAgICAgICAgLy8gbG93ZXIgcHJpb3JpdHkgd29yayB0byBkby4gSW5zdGVhZCBvZiBjb21taXR0aW5nIHRoZSBmYWxsYmFjawogICAgICAgICAgICAgIC8vIGltbWVkaWF0ZWx5LCB3YWl0IGZvciBtb3JlIGRhdGEgdG8gYXJyaXZlLgoKCiAgICAgICAgICAgICAgcm9vdC50aW1lb3V0SGFuZGxlID0gc2NoZWR1bGVUaW1lb3V0KGNvbW1pdFJvb3QuYmluZChudWxsLCByb290LCB3b3JrSW5Qcm9ncmVzc1Jvb3RSZWNvdmVyYWJsZUVycm9ycywgd29ya0luUHJvZ3Jlc3NUcmFuc2l0aW9ucyksIG1zVW50aWxUaW1lb3V0KTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgfSAvLyBUaGUgd29yayBleHBpcmVkLiBDb21taXQgaW1tZWRpYXRlbHkuCgoKICAgICAgICAgIGNvbW1pdFJvb3Qocm9vdCwgd29ya0luUHJvZ3Jlc3NSb290UmVjb3ZlcmFibGVFcnJvcnMsIHdvcmtJblByb2dyZXNzVHJhbnNpdGlvbnMpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgY2FzZSBSb290U3VzcGVuZGVkV2l0aERlbGF5OgogICAgICAgIHsKICAgICAgICAgIG1hcmtSb290U3VzcGVuZGVkJDEocm9vdCwgbGFuZXMpOwoKICAgICAgICAgIGlmIChpbmNsdWRlc09ubHlUcmFuc2l0aW9ucyhsYW5lcykpIHsKICAgICAgICAgICAgLy8gVGhpcyBpcyBhIHRyYW5zaXRpb24sIHNvIHdlIHNob3VsZCBleGl0IHdpdGhvdXQgY29tbWl0dGluZyBhCiAgICAgICAgICAgIC8vIHBsYWNlaG9sZGVyIGFuZCB3aXRob3V0IHNjaGVkdWxpbmcgYSB0aW1lb3V0LiBEZWxheSBpbmRlZmluaXRlbHkKICAgICAgICAgICAgLy8gdW50aWwgd2UgcmVjZWl2ZSBtb3JlIGRhdGEuCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICghc2hvdWxkRm9yY2VGbHVzaEZhbGxiYWNrc0luREVWKCkpIHsKICAgICAgICAgICAgLy8gVGhpcyBpcyBub3QgYSB0cmFuc2l0aW9uLCBidXQgd2UgZGlkIHRyaWdnZXIgYW4gYXZvaWRlZCBzdGF0ZS4KICAgICAgICAgICAgLy8gU2NoZWR1bGUgYSBwbGFjZWhvbGRlciB0byBkaXNwbGF5IGFmdGVyIGEgc2hvcnQgZGVsYXksIHVzaW5nIHRoZSBKdXN0CiAgICAgICAgICAgIC8vIE5vdGljZWFibGUgRGlmZmVyZW5jZS4KICAgICAgICAgICAgLy8gVE9ETzogSXMgdGhlIEpORCBvcHRpbWl6YXRpb24gd29ydGggdGhlIGFkZGVkIGNvbXBsZXhpdHk/IElmIHRoaXMgaXMKICAgICAgICAgICAgLy8gdGhlIG9ubHkgcmVhc29uIHdlIHRyYWNrIHRoZSBldmVudCB0aW1lLCB0aGVuIHByb2JhYmx5IG5vdC4KICAgICAgICAgICAgLy8gQ29uc2lkZXIgcmVtb3ZpbmcuCiAgICAgICAgICAgIHZhciBtb3N0UmVjZW50RXZlbnRUaW1lID0gZ2V0TW9zdFJlY2VudEV2ZW50VGltZShyb290LCBsYW5lcyk7CiAgICAgICAgICAgIHZhciBldmVudFRpbWVNcyA9IG1vc3RSZWNlbnRFdmVudFRpbWU7CiAgICAgICAgICAgIHZhciB0aW1lRWxhcHNlZE1zID0gbm93KCkgLSBldmVudFRpbWVNczsKCiAgICAgICAgICAgIHZhciBfbXNVbnRpbFRpbWVvdXQgPSBqbmQodGltZUVsYXBzZWRNcykgLSB0aW1lRWxhcHNlZE1zOyAvLyBEb24ndCBib3RoZXIgd2l0aCBhIHZlcnkgc2hvcnQgc3VzcGVuc2UgdGltZS4KCgogICAgICAgICAgICBpZiAoX21zVW50aWxUaW1lb3V0ID4gMTApIHsKICAgICAgICAgICAgICAvLyBJbnN0ZWFkIG9mIGNvbW1pdHRpbmcgdGhlIGZhbGxiYWNrIGltbWVkaWF0ZWx5LCB3YWl0IGZvciBtb3JlIGRhdGEKICAgICAgICAgICAgICAvLyB0byBhcnJpdmUuCiAgICAgICAgICAgICAgcm9vdC50aW1lb3V0SGFuZGxlID0gc2NoZWR1bGVUaW1lb3V0KGNvbW1pdFJvb3QuYmluZChudWxsLCByb290LCB3b3JrSW5Qcm9ncmVzc1Jvb3RSZWNvdmVyYWJsZUVycm9ycywgd29ya0luUHJvZ3Jlc3NUcmFuc2l0aW9ucyksIF9tc1VudGlsVGltZW91dCk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gLy8gQ29tbWl0IHRoZSBwbGFjZWhvbGRlci4KCgogICAgICAgICAgY29tbWl0Um9vdChyb290LCB3b3JrSW5Qcm9ncmVzc1Jvb3RSZWNvdmVyYWJsZUVycm9ycywgd29ya0luUHJvZ3Jlc3NUcmFuc2l0aW9ucyk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICBjYXNlIFJvb3RDb21wbGV0ZWQ6CiAgICAgICAgewogICAgICAgICAgLy8gVGhlIHdvcmsgY29tcGxldGVkLiBSZWFkeSB0byBjb21taXQuCiAgICAgICAgICBjb21taXRSb290KHJvb3QsIHdvcmtJblByb2dyZXNzUm9vdFJlY292ZXJhYmxlRXJyb3JzLCB3b3JrSW5Qcm9ncmVzc1RyYW5zaXRpb25zKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgIGRlZmF1bHQ6CiAgICAgICAgewogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdVbmtub3duIHJvb3QgZXhpdCBzdGF0dXMuJyk7CiAgICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gaXNSZW5kZXJDb25zaXN0ZW50V2l0aEV4dGVybmFsU3RvcmVzKGZpbmlzaGVkV29yaykgewogICAgLy8gU2VhcmNoIHRoZSByZW5kZXJlZCB0cmVlIGZvciBleHRlcm5hbCBzdG9yZSByZWFkcywgYW5kIGNoZWNrIHdoZXRoZXIgdGhlCiAgICAvLyBzdG9yZXMgd2VyZSBtdXRhdGVkIGluIGEgY29uY3VycmVudCBldmVudC4gSW50ZW50aW9uYWxseSB1c2luZyBhbiBpdGVyYXRpdmUKICAgIC8vIGxvb3AgaW5zdGVhZCBvZiByZWN1cnNpb24gc28gd2UgY2FuIGV4aXQgZWFybHkuCiAgICB2YXIgbm9kZSA9IGZpbmlzaGVkV29yazsKCiAgICB3aGlsZSAodHJ1ZSkgewogICAgICBpZiAobm9kZS5mbGFncyAmIFN0b3JlQ29uc2lzdGVuY3kpIHsKICAgICAgICB2YXIgdXBkYXRlUXVldWUgPSBub2RlLnVwZGF0ZVF1ZXVlOwoKICAgICAgICBpZiAodXBkYXRlUXVldWUgIT09IG51bGwpIHsKICAgICAgICAgIHZhciBjaGVja3MgPSB1cGRhdGVRdWV1ZS5zdG9yZXM7CgogICAgICAgICAgaWYgKGNoZWNrcyAhPT0gbnVsbCkgewogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNoZWNrcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgIHZhciBjaGVjayA9IGNoZWNrc1tpXTsKICAgICAgICAgICAgICB2YXIgZ2V0U25hcHNob3QgPSBjaGVjay5nZXRTbmFwc2hvdDsKICAgICAgICAgICAgICB2YXIgcmVuZGVyZWRWYWx1ZSA9IGNoZWNrLnZhbHVlOwoKICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgaWYgKCFvYmplY3RJcyhnZXRTbmFwc2hvdCgpLCByZW5kZXJlZFZhbHVlKSkgewogICAgICAgICAgICAgICAgICAvLyBGb3VuZCBhbiBpbmNvbnNpc3RlbnQgc3RvcmUuCiAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICAgICAgLy8gSWYgYGdldFNuYXBzaG90YCB0aHJvd3MsIHJldHVybiBgZmFsc2VgLiBUaGlzIHdpbGwgc2NoZWR1bGUKICAgICAgICAgICAgICAgIC8vIGEgcmUtcmVuZGVyLCBhbmQgdGhlIGVycm9yIHdpbGwgYmUgcmV0aHJvd24gZHVyaW5nIHJlbmRlci4KICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHZhciBjaGlsZCA9IG5vZGUuY2hpbGQ7CgogICAgICBpZiAobm9kZS5zdWJ0cmVlRmxhZ3MgJiBTdG9yZUNvbnNpc3RlbmN5ICYmIGNoaWxkICE9PSBudWxsKSB7CiAgICAgICAgY2hpbGQucmV0dXJuID0gbm9kZTsKICAgICAgICBub2RlID0gY2hpbGQ7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGlmIChub2RlID09PSBmaW5pc2hlZFdvcmspIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgd2hpbGUgKG5vZGUuc2libGluZyA9PT0gbnVsbCkgewogICAgICAgIGlmIChub2RlLnJldHVybiA9PT0gbnVsbCB8fCBub2RlLnJldHVybiA9PT0gZmluaXNoZWRXb3JrKSB7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIG5vZGUgPSBub2RlLnJldHVybjsKICAgICAgfQoKICAgICAgbm9kZS5zaWJsaW5nLnJldHVybiA9IG5vZGUucmV0dXJuOwogICAgICBub2RlID0gbm9kZS5zaWJsaW5nOwogICAgfSAvLyBGbG93IGRvZXNuJ3Qga25vdyB0aGlzIGlzIHVucmVhY2hhYmxlLCBidXQgZXNsaW50IGRvZXMKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bnJlYWNoYWJsZQoKCiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGZ1bmN0aW9uIG1hcmtSb290U3VzcGVuZGVkJDEocm9vdCwgc3VzcGVuZGVkTGFuZXMpIHsKICAgIC8vIFdoZW4gc3VzcGVuZGluZywgd2Ugc2hvdWxkIGFsd2F5cyBleGNsdWRlIGxhbmVzIHRoYXQgd2VyZSBwaW5nZWQgb3IgKG1vcmUKICAgIC8vIHJhcmVseSwgc2luY2Ugd2UgdHJ5IHRvIGF2b2lkIGl0KSB1cGRhdGVkIGR1cmluZyB0aGUgcmVuZGVyIHBoYXNlLgogICAgLy8gVE9ETzogTG9sIG1heWJlIHRoZXJlJ3MgYSBiZXR0ZXIgd2F5IHRvIGZhY3RvciB0aGlzIGJlc2lkZXMgdGhpcwogICAgLy8gb2Jub3hpb3VzbHkgbmFtZWQgZnVuY3Rpb24gOikKICAgIHN1c3BlbmRlZExhbmVzID0gcmVtb3ZlTGFuZXMoc3VzcGVuZGVkTGFuZXMsIHdvcmtJblByb2dyZXNzUm9vdFBpbmdlZExhbmVzKTsKICAgIHN1c3BlbmRlZExhbmVzID0gcmVtb3ZlTGFuZXMoc3VzcGVuZGVkTGFuZXMsIHdvcmtJblByb2dyZXNzUm9vdEludGVybGVhdmVkVXBkYXRlZExhbmVzKTsKICAgIG1hcmtSb290U3VzcGVuZGVkKHJvb3QsIHN1c3BlbmRlZExhbmVzKTsKICB9IC8vIFRoaXMgaXMgdGhlIGVudHJ5IHBvaW50IGZvciBzeW5jaHJvbm91cyB0YXNrcyB0aGF0IGRvbid0IGdvCiAgLy8gdGhyb3VnaCBTY2hlZHVsZXIKCgogIGZ1bmN0aW9uIHBlcmZvcm1TeW5jV29ya09uUm9vdChyb290KSB7CiAgICB7CiAgICAgIHN5bmNOZXN0ZWRVcGRhdGVGbGFnKCk7CiAgICB9CgogICAgaWYgKChleGVjdXRpb25Db250ZXh0ICYgKFJlbmRlckNvbnRleHQgfCBDb21taXRDb250ZXh0KSkgIT09IE5vQ29udGV4dCkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Nob3VsZCBub3QgYWxyZWFkeSBiZSB3b3JraW5nLicpOwogICAgfQoKICAgIGZsdXNoUGFzc2l2ZUVmZmVjdHMoKTsKICAgIHZhciBsYW5lcyA9IGdldE5leHRMYW5lcyhyb290LCBOb0xhbmVzKTsKCiAgICBpZiAoIWluY2x1ZGVzU29tZUxhbmUobGFuZXMsIFN5bmNMYW5lKSkgewogICAgICAvLyBUaGVyZSdzIG5vIHJlbWFpbmluZyBzeW5jIHdvcmsgbGVmdC4KICAgICAgZW5zdXJlUm9vdElzU2NoZWR1bGVkKHJvb3QsIG5vdygpKTsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgdmFyIGV4aXRTdGF0dXMgPSByZW5kZXJSb290U3luYyhyb290LCBsYW5lcyk7CgogICAgaWYgKHJvb3QudGFnICE9PSBMZWdhY3lSb290ICYmIGV4aXRTdGF0dXMgPT09IFJvb3RFcnJvcmVkKSB7CiAgICAgIC8vIElmIHNvbWV0aGluZyB0aHJldyBhbiBlcnJvciwgdHJ5IHJlbmRlcmluZyBvbmUgbW9yZSB0aW1lLiBXZSdsbCByZW5kZXIKICAgICAgLy8gc3luY2hyb25vdXNseSB0byBibG9jayBjb25jdXJyZW50IGRhdGEgbXV0YXRpb25zLCBhbmQgd2UnbGwgaW5jbHVkZXMKICAgICAgLy8gYWxsIHBlbmRpbmcgdXBkYXRlcyBhcmUgaW5jbHVkZWQuIElmIGl0IHN0aWxsIGZhaWxzIGFmdGVyIHRoZSBzZWNvbmQKICAgICAgLy8gYXR0ZW1wdCwgd2UnbGwgZ2l2ZSB1cCBhbmQgY29tbWl0IHRoZSByZXN1bHRpbmcgdHJlZS4KICAgICAgdmFyIGVycm9yUmV0cnlMYW5lcyA9IGdldExhbmVzVG9SZXRyeVN5bmNocm9ub3VzbHlPbkVycm9yKHJvb3QpOwoKICAgICAgaWYgKGVycm9yUmV0cnlMYW5lcyAhPT0gTm9MYW5lcykgewogICAgICAgIGxhbmVzID0gZXJyb3JSZXRyeUxhbmVzOwogICAgICAgIGV4aXRTdGF0dXMgPSByZWNvdmVyRnJvbUNvbmN1cnJlbnRFcnJvcihyb290LCBlcnJvclJldHJ5TGFuZXMpOwogICAgICB9CiAgICB9CgogICAgaWYgKGV4aXRTdGF0dXMgPT09IFJvb3RGYXRhbEVycm9yZWQpIHsKICAgICAgdmFyIGZhdGFsRXJyb3IgPSB3b3JrSW5Qcm9ncmVzc1Jvb3RGYXRhbEVycm9yOwogICAgICBwcmVwYXJlRnJlc2hTdGFjayhyb290LCBOb0xhbmVzKTsKICAgICAgbWFya1Jvb3RTdXNwZW5kZWQkMShyb290LCBsYW5lcyk7CiAgICAgIGVuc3VyZVJvb3RJc1NjaGVkdWxlZChyb290LCBub3coKSk7CiAgICAgIHRocm93IGZhdGFsRXJyb3I7CiAgICB9CgogICAgaWYgKGV4aXRTdGF0dXMgPT09IFJvb3REaWROb3RDb21wbGV0ZSkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Jvb3QgZGlkIG5vdCBjb21wbGV0ZS4gVGhpcyBpcyBhIGJ1ZyBpbiBSZWFjdC4nKTsKICAgIH0gLy8gV2Ugbm93IGhhdmUgYSBjb25zaXN0ZW50IHRyZWUuIEJlY2F1c2UgdGhpcyBpcyBhIHN5bmMgcmVuZGVyLCB3ZQogICAgLy8gd2lsbCBjb21taXQgaXQgZXZlbiBpZiBzb21ldGhpbmcgc3VzcGVuZGVkLgoKCiAgICB2YXIgZmluaXNoZWRXb3JrID0gcm9vdC5jdXJyZW50LmFsdGVybmF0ZTsKICAgIHJvb3QuZmluaXNoZWRXb3JrID0gZmluaXNoZWRXb3JrOwogICAgcm9vdC5maW5pc2hlZExhbmVzID0gbGFuZXM7CiAgICBjb21taXRSb290KHJvb3QsIHdvcmtJblByb2dyZXNzUm9vdFJlY292ZXJhYmxlRXJyb3JzLCB3b3JrSW5Qcm9ncmVzc1RyYW5zaXRpb25zKTsgLy8gQmVmb3JlIGV4aXRpbmcsIG1ha2Ugc3VyZSB0aGVyZSdzIGEgY2FsbGJhY2sgc2NoZWR1bGVkIGZvciB0aGUgbmV4dAogICAgLy8gcGVuZGluZyBsZXZlbC4KCiAgICBlbnN1cmVSb290SXNTY2hlZHVsZWQocm9vdCwgbm93KCkpOwogICAgcmV0dXJuIG51bGw7CiAgfQoKICBmdW5jdGlvbiBmbHVzaFJvb3Qocm9vdCwgbGFuZXMpIHsKICAgIGlmIChsYW5lcyAhPT0gTm9MYW5lcykgewogICAgICBtYXJrUm9vdEVudGFuZ2xlZChyb290LCBtZXJnZUxhbmVzKGxhbmVzLCBTeW5jTGFuZSkpOwogICAgICBlbnN1cmVSb290SXNTY2hlZHVsZWQocm9vdCwgbm93KCkpOwoKICAgICAgaWYgKChleGVjdXRpb25Db250ZXh0ICYgKFJlbmRlckNvbnRleHQgfCBDb21taXRDb250ZXh0KSkgPT09IE5vQ29udGV4dCkgewogICAgICAgIHJlc2V0UmVuZGVyVGltZXIoKTsKICAgICAgICBmbHVzaFN5bmNDYWxsYmFja3MoKTsKICAgICAgfQogICAgfQogIH0KICBmdW5jdGlvbiBiYXRjaGVkVXBkYXRlcyQxKGZuLCBhKSB7CiAgICB2YXIgcHJldkV4ZWN1dGlvbkNvbnRleHQgPSBleGVjdXRpb25Db250ZXh0OwogICAgZXhlY3V0aW9uQ29udGV4dCB8PSBCYXRjaGVkQ29udGV4dDsKCiAgICB0cnkgewogICAgICByZXR1cm4gZm4oYSk7CiAgICB9IGZpbmFsbHkgewogICAgICBleGVjdXRpb25Db250ZXh0ID0gcHJldkV4ZWN1dGlvbkNvbnRleHQ7IC8vIElmIHRoZXJlIHdlcmUgbGVnYWN5IHN5bmMgdXBkYXRlcywgZmx1c2ggdGhlbSBhdCB0aGUgZW5kIG9mIHRoZSBvdXRlcgogICAgICAvLyBtb3N0IGJhdGNoZWRVcGRhdGVzLWxpa2UgbWV0aG9kLgoKICAgICAgaWYgKGV4ZWN1dGlvbkNvbnRleHQgPT09IE5vQ29udGV4dCAmJiAvLyBUcmVhdCBgYWN0YCBhcyBpZiBpdCdzIGluc2lkZSBgYmF0Y2hlZFVwZGF0ZXNgLCBldmVuIGluIGxlZ2FjeSBtb2RlLgogICAgICAhKCBSZWFjdEN1cnJlbnRBY3RRdWV1ZSQxLmlzQmF0Y2hpbmdMZWdhY3kpKSB7CiAgICAgICAgcmVzZXRSZW5kZXJUaW1lcigpOwogICAgICAgIGZsdXNoU3luY0NhbGxiYWNrc09ubHlJbkxlZ2FjeU1vZGUoKTsKICAgICAgfQogICAgfQogIH0KICBmdW5jdGlvbiBkaXNjcmV0ZVVwZGF0ZXMoZm4sIGEsIGIsIGMsIGQpIHsKICAgIHZhciBwcmV2aW91c1ByaW9yaXR5ID0gZ2V0Q3VycmVudFVwZGF0ZVByaW9yaXR5KCk7CiAgICB2YXIgcHJldlRyYW5zaXRpb24gPSBSZWFjdEN1cnJlbnRCYXRjaENvbmZpZyQzLnRyYW5zaXRpb247CgogICAgdHJ5IHsKICAgICAgUmVhY3RDdXJyZW50QmF0Y2hDb25maWckMy50cmFuc2l0aW9uID0gbnVsbDsKICAgICAgc2V0Q3VycmVudFVwZGF0ZVByaW9yaXR5KERpc2NyZXRlRXZlbnRQcmlvcml0eSk7CiAgICAgIHJldHVybiBmbihhLCBiLCBjLCBkKTsKICAgIH0gZmluYWxseSB7CiAgICAgIHNldEN1cnJlbnRVcGRhdGVQcmlvcml0eShwcmV2aW91c1ByaW9yaXR5KTsKICAgICAgUmVhY3RDdXJyZW50QmF0Y2hDb25maWckMy50cmFuc2l0aW9uID0gcHJldlRyYW5zaXRpb247CgogICAgICBpZiAoZXhlY3V0aW9uQ29udGV4dCA9PT0gTm9Db250ZXh0KSB7CiAgICAgICAgcmVzZXRSZW5kZXJUaW1lcigpOwogICAgICB9CiAgICB9CiAgfSAvLyBPdmVybG9hZCB0aGUgZGVmaW5pdGlvbiB0byB0aGUgdHdvIHZhbGlkIHNpZ25hdHVyZXMuCiAgLy8gV2FybmluZywgdGhpcyBvcHRzLW91dCBvZiBjaGVja2luZyB0aGUgZnVuY3Rpb24gYm9keS4KCiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXJlZGVjbGFyZQogIGZ1bmN0aW9uIGZsdXNoU3luYyhmbikgewogICAgLy8gSW4gbGVnYWN5IG1vZGUsIHdlIGZsdXNoIHBlbmRpbmcgcGFzc2l2ZSBlZmZlY3RzIGF0IHRoZSBiZWdpbm5pbmcgb2YgdGhlCiAgICAvLyBuZXh0IGV2ZW50LCBub3QgYXQgdGhlIGVuZCBvZiB0aGUgcHJldmlvdXMgb25lLgogICAgaWYgKHJvb3RXaXRoUGVuZGluZ1Bhc3NpdmVFZmZlY3RzICE9PSBudWxsICYmIHJvb3RXaXRoUGVuZGluZ1Bhc3NpdmVFZmZlY3RzLnRhZyA9PT0gTGVnYWN5Um9vdCAmJiAoZXhlY3V0aW9uQ29udGV4dCAmIChSZW5kZXJDb250ZXh0IHwgQ29tbWl0Q29udGV4dCkpID09PSBOb0NvbnRleHQpIHsKICAgICAgZmx1c2hQYXNzaXZlRWZmZWN0cygpOwogICAgfQoKICAgIHZhciBwcmV2RXhlY3V0aW9uQ29udGV4dCA9IGV4ZWN1dGlvbkNvbnRleHQ7CiAgICBleGVjdXRpb25Db250ZXh0IHw9IEJhdGNoZWRDb250ZXh0OwogICAgdmFyIHByZXZUcmFuc2l0aW9uID0gUmVhY3RDdXJyZW50QmF0Y2hDb25maWckMy50cmFuc2l0aW9uOwogICAgdmFyIHByZXZpb3VzUHJpb3JpdHkgPSBnZXRDdXJyZW50VXBkYXRlUHJpb3JpdHkoKTsKCiAgICB0cnkgewogICAgICBSZWFjdEN1cnJlbnRCYXRjaENvbmZpZyQzLnRyYW5zaXRpb24gPSBudWxsOwogICAgICBzZXRDdXJyZW50VXBkYXRlUHJpb3JpdHkoRGlzY3JldGVFdmVudFByaW9yaXR5KTsKCiAgICAgIGlmIChmbikgewogICAgICAgIHJldHVybiBmbigpOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICAgIH0KICAgIH0gZmluYWxseSB7CiAgICAgIHNldEN1cnJlbnRVcGRhdGVQcmlvcml0eShwcmV2aW91c1ByaW9yaXR5KTsKICAgICAgUmVhY3RDdXJyZW50QmF0Y2hDb25maWckMy50cmFuc2l0aW9uID0gcHJldlRyYW5zaXRpb247CiAgICAgIGV4ZWN1dGlvbkNvbnRleHQgPSBwcmV2RXhlY3V0aW9uQ29udGV4dDsgLy8gRmx1c2ggdGhlIGltbWVkaWF0ZSBjYWxsYmFja3MgdGhhdCB3ZXJlIHNjaGVkdWxlZCBkdXJpbmcgdGhpcyBiYXRjaC4KICAgICAgLy8gTm90ZSB0aGF0IHRoaXMgd2lsbCBoYXBwZW4gZXZlbiBpZiBiYXRjaGVkVXBkYXRlcyBpcyBoaWdoZXIgdXAKICAgICAgLy8gdGhlIHN0YWNrLgoKICAgICAgaWYgKChleGVjdXRpb25Db250ZXh0ICYgKFJlbmRlckNvbnRleHQgfCBDb21taXRDb250ZXh0KSkgPT09IE5vQ29udGV4dCkgewogICAgICAgIGZsdXNoU3luY0NhbGxiYWNrcygpOwogICAgICB9CiAgICB9CiAgfQogIGZ1bmN0aW9uIGlzQWxyZWFkeVJlbmRlcmluZygpIHsKICAgIC8vIFVzZWQgYnkgdGhlIHJlbmRlcmVyIHRvIHByaW50IGEgd2FybmluZyBpZiBjZXJ0YWluIEFQSXMgYXJlIGNhbGxlZCBmcm9tCiAgICAvLyB0aGUgd3JvbmcgY29udGV4dC4KICAgIHJldHVybiAgKGV4ZWN1dGlvbkNvbnRleHQgJiAoUmVuZGVyQ29udGV4dCB8IENvbW1pdENvbnRleHQpKSAhPT0gTm9Db250ZXh0OwogIH0KICBmdW5jdGlvbiBwdXNoUmVuZGVyTGFuZXMoZmliZXIsIGxhbmVzKSB7CiAgICBwdXNoKHN1YnRyZWVSZW5kZXJMYW5lc0N1cnNvciwgc3VidHJlZVJlbmRlckxhbmVzLCBmaWJlcik7CiAgICBzdWJ0cmVlUmVuZGVyTGFuZXMgPSBtZXJnZUxhbmVzKHN1YnRyZWVSZW5kZXJMYW5lcywgbGFuZXMpOwogICAgd29ya0luUHJvZ3Jlc3NSb290SW5jbHVkZWRMYW5lcyA9IG1lcmdlTGFuZXMod29ya0luUHJvZ3Jlc3NSb290SW5jbHVkZWRMYW5lcywgbGFuZXMpOwogIH0KICBmdW5jdGlvbiBwb3BSZW5kZXJMYW5lcyhmaWJlcikgewogICAgc3VidHJlZVJlbmRlckxhbmVzID0gc3VidHJlZVJlbmRlckxhbmVzQ3Vyc29yLmN1cnJlbnQ7CiAgICBwb3Aoc3VidHJlZVJlbmRlckxhbmVzQ3Vyc29yLCBmaWJlcik7CiAgfQoKICBmdW5jdGlvbiBwcmVwYXJlRnJlc2hTdGFjayhyb290LCBsYW5lcykgewogICAgcm9vdC5maW5pc2hlZFdvcmsgPSBudWxsOwogICAgcm9vdC5maW5pc2hlZExhbmVzID0gTm9MYW5lczsKICAgIHZhciB0aW1lb3V0SGFuZGxlID0gcm9vdC50aW1lb3V0SGFuZGxlOwoKICAgIGlmICh0aW1lb3V0SGFuZGxlICE9PSBub1RpbWVvdXQpIHsKICAgICAgLy8gVGhlIHJvb3QgcHJldmlvdXMgc3VzcGVuZGVkIGFuZCBzY2hlZHVsZWQgYSB0aW1lb3V0IHRvIGNvbW1pdCBhIGZhbGxiYWNrCiAgICAgIC8vIHN0YXRlLiBOb3cgdGhhdCB3ZSBoYXZlIGFkZGl0aW9uYWwgd29yaywgY2FuY2VsIHRoZSB0aW1lb3V0LgogICAgICByb290LnRpbWVvdXRIYW5kbGUgPSBub1RpbWVvdXQ7IC8vICRGbG93Rml4TWUgQ29tcGxhaW5zIG5vVGltZW91dCBpcyBub3QgYSBUaW1lb3V0SUQsIGRlc3BpdGUgdGhlIGNoZWNrIGFib3ZlCgogICAgICBjYW5jZWxUaW1lb3V0KHRpbWVvdXRIYW5kbGUpOwogICAgfQoKICAgIGlmICh3b3JrSW5Qcm9ncmVzcyAhPT0gbnVsbCkgewogICAgICB2YXIgaW50ZXJydXB0ZWRXb3JrID0gd29ya0luUHJvZ3Jlc3MucmV0dXJuOwoKICAgICAgd2hpbGUgKGludGVycnVwdGVkV29yayAhPT0gbnVsbCkgewogICAgICAgIHZhciBjdXJyZW50ID0gaW50ZXJydXB0ZWRXb3JrLmFsdGVybmF0ZTsKICAgICAgICB1bndpbmRJbnRlcnJ1cHRlZFdvcmsoY3VycmVudCwgaW50ZXJydXB0ZWRXb3JrKTsKICAgICAgICBpbnRlcnJ1cHRlZFdvcmsgPSBpbnRlcnJ1cHRlZFdvcmsucmV0dXJuOwogICAgICB9CiAgICB9CgogICAgd29ya0luUHJvZ3Jlc3NSb290ID0gcm9vdDsKICAgIHZhciByb290V29ya0luUHJvZ3Jlc3MgPSBjcmVhdGVXb3JrSW5Qcm9ncmVzcyhyb290LmN1cnJlbnQsIG51bGwpOwogICAgd29ya0luUHJvZ3Jlc3MgPSByb290V29ya0luUHJvZ3Jlc3M7CiAgICB3b3JrSW5Qcm9ncmVzc1Jvb3RSZW5kZXJMYW5lcyA9IHN1YnRyZWVSZW5kZXJMYW5lcyA9IHdvcmtJblByb2dyZXNzUm9vdEluY2x1ZGVkTGFuZXMgPSBsYW5lczsKICAgIHdvcmtJblByb2dyZXNzUm9vdEV4aXRTdGF0dXMgPSBSb290SW5Qcm9ncmVzczsKICAgIHdvcmtJblByb2dyZXNzUm9vdEZhdGFsRXJyb3IgPSBudWxsOwogICAgd29ya0luUHJvZ3Jlc3NSb290U2tpcHBlZExhbmVzID0gTm9MYW5lczsKICAgIHdvcmtJblByb2dyZXNzUm9vdEludGVybGVhdmVkVXBkYXRlZExhbmVzID0gTm9MYW5lczsKICAgIHdvcmtJblByb2dyZXNzUm9vdFBpbmdlZExhbmVzID0gTm9MYW5lczsKICAgIHdvcmtJblByb2dyZXNzUm9vdENvbmN1cnJlbnRFcnJvcnMgPSBudWxsOwogICAgd29ya0luUHJvZ3Jlc3NSb290UmVjb3ZlcmFibGVFcnJvcnMgPSBudWxsOwogICAgZmluaXNoUXVldWVpbmdDb25jdXJyZW50VXBkYXRlcygpOwoKICAgIHsKICAgICAgUmVhY3RTdHJpY3RNb2RlV2FybmluZ3MuZGlzY2FyZFBlbmRpbmdXYXJuaW5ncygpOwogICAgfQoKICAgIHJldHVybiByb290V29ya0luUHJvZ3Jlc3M7CiAgfQoKICBmdW5jdGlvbiBoYW5kbGVFcnJvcihyb290LCB0aHJvd25WYWx1ZSkgewogICAgZG8gewogICAgICB2YXIgZXJyb3JlZFdvcmsgPSB3b3JrSW5Qcm9ncmVzczsKCiAgICAgIHRyeSB7CiAgICAgICAgLy8gUmVzZXQgbW9kdWxlLWxldmVsIHN0YXRlIHRoYXQgd2FzIHNldCBkdXJpbmcgdGhlIHJlbmRlciBwaGFzZS4KICAgICAgICByZXNldENvbnRleHREZXBlbmRlbmNpZXMoKTsKICAgICAgICByZXNldEhvb2tzQWZ0ZXJUaHJvdygpOwogICAgICAgIHJlc2V0Q3VycmVudEZpYmVyKCk7IC8vIFRPRE86IEkgZm91bmQgYW5kIGFkZGVkIHRoaXMgbWlzc2luZyBsaW5lIHdoaWxlIGludmVzdGlnYXRpbmcgYQogICAgICAgIC8vIHNlcGFyYXRlIGlzc3VlLiBXcml0ZSBhIHJlZ3Jlc3Npb24gdGVzdCB1c2luZyBzdHJpbmcgcmVmcy4KCiAgICAgICAgUmVhY3RDdXJyZW50T3duZXIkMi5jdXJyZW50ID0gbnVsbDsKCiAgICAgICAgaWYgKGVycm9yZWRXb3JrID09PSBudWxsIHx8IGVycm9yZWRXb3JrLnJldHVybiA9PT0gbnVsbCkgewogICAgICAgICAgLy8gRXhwZWN0ZWQgdG8gYmUgd29ya2luZyBvbiBhIG5vbi1yb290IGZpYmVyLiBUaGlzIGlzIGEgZmF0YWwgZXJyb3IKICAgICAgICAgIC8vIGJlY2F1c2UgdGhlcmUncyBubyBhbmNlc3RvciB0aGF0IGNhbiBoYW5kbGUgaXQ7IHRoZSByb290IGlzCiAgICAgICAgICAvLyBzdXBwb3NlZCB0byBjYXB0dXJlIGFsbCBlcnJvcnMgdGhhdCB3ZXJlbid0IGNhdWdodCBieSBhbiBlcnJvcgogICAgICAgICAgLy8gYm91bmRhcnkuCiAgICAgICAgICB3b3JrSW5Qcm9ncmVzc1Jvb3RFeGl0U3RhdHVzID0gUm9vdEZhdGFsRXJyb3JlZDsKICAgICAgICAgIHdvcmtJblByb2dyZXNzUm9vdEZhdGFsRXJyb3IgPSB0aHJvd25WYWx1ZTsgLy8gU2V0IGB3b3JrSW5Qcm9ncmVzc2AgdG8gbnVsbC4gVGhpcyByZXByZXNlbnRzIGFkdmFuY2luZyB0byB0aGUgbmV4dAogICAgICAgICAgLy8gc2libGluZywgb3IgdGhlIHBhcmVudCBpZiB0aGVyZSBhcmUgbm8gc2libGluZ3MuIEJ1dCBzaW5jZSB0aGUgcm9vdAogICAgICAgICAgLy8gaGFzIG5vIHNpYmxpbmdzIG5vciBhIHBhcmVudCwgd2Ugc2V0IGl0IHRvIG51bGwuIFVzdWFsbHkgdGhpcyBpcwogICAgICAgICAgLy8gaGFuZGxlZCBieSBgY29tcGxldGVVbml0T2ZXb3JrYCBvciBgdW53aW5kV29ya2AsIGJ1dCBzaW5jZSB3ZSdyZQogICAgICAgICAgLy8gaW50ZW50aW9uYWxseSBub3QgY2FsbGluZyB0aG9zZSwgd2UgbmVlZCBzZXQgaXQgaGVyZS4KICAgICAgICAgIC8vIFRPRE86IENvbnNpZGVyIGNhbGxpbmcgYHVud2luZFdvcmtgIHRvIHBvcCB0aGUgY29udGV4dHMuCgogICAgICAgICAgd29ya0luUHJvZ3Jlc3MgPSBudWxsOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgaWYgKGVuYWJsZVByb2ZpbGVyVGltZXIgJiYgZXJyb3JlZFdvcmsubW9kZSAmIFByb2ZpbGVNb2RlKSB7CiAgICAgICAgICAvLyBSZWNvcmQgdGhlIHRpbWUgc3BlbnQgcmVuZGVyaW5nIGJlZm9yZSBhbiBlcnJvciB3YXMgdGhyb3duLiBUaGlzCiAgICAgICAgICAvLyBhdm9pZHMgaW5hY2N1cmF0ZSBQcm9maWxlciBkdXJhdGlvbnMgaW4gdGhlIGNhc2Ugb2YgYQogICAgICAgICAgLy8gc3VzcGVuZGVkIHJlbmRlci4KICAgICAgICAgIHN0b3BQcm9maWxlclRpbWVySWZSdW5uaW5nQW5kUmVjb3JkRGVsdGEoZXJyb3JlZFdvcmssIHRydWUpOwogICAgICAgIH0KCiAgICAgICAgaWYgKGVuYWJsZVNjaGVkdWxpbmdQcm9maWxlcikgewogICAgICAgICAgbWFya0NvbXBvbmVudFJlbmRlclN0b3BwZWQoKTsKCiAgICAgICAgICBpZiAodGhyb3duVmFsdWUgIT09IG51bGwgJiYgdHlwZW9mIHRocm93blZhbHVlID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgdGhyb3duVmFsdWUudGhlbiA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgICB2YXIgd2FrZWFibGUgPSB0aHJvd25WYWx1ZTsKICAgICAgICAgICAgbWFya0NvbXBvbmVudFN1c3BlbmRlZChlcnJvcmVkV29yaywgd2FrZWFibGUsIHdvcmtJblByb2dyZXNzUm9vdFJlbmRlckxhbmVzKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG1hcmtDb21wb25lbnRFcnJvcmVkKGVycm9yZWRXb3JrLCB0aHJvd25WYWx1ZSwgd29ya0luUHJvZ3Jlc3NSb290UmVuZGVyTGFuZXMpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdGhyb3dFeGNlcHRpb24ocm9vdCwgZXJyb3JlZFdvcmsucmV0dXJuLCBlcnJvcmVkV29yaywgdGhyb3duVmFsdWUsIHdvcmtJblByb2dyZXNzUm9vdFJlbmRlckxhbmVzKTsKICAgICAgICBjb21wbGV0ZVVuaXRPZldvcmsoZXJyb3JlZFdvcmspOwogICAgICB9IGNhdGNoICh5ZXRBbm90aGVyVGhyb3duVmFsdWUpIHsKICAgICAgICAvLyBTb21ldGhpbmcgaW4gdGhlIHJldHVybiBwYXRoIGFsc28gdGhyZXcuCiAgICAgICAgdGhyb3duVmFsdWUgPSB5ZXRBbm90aGVyVGhyb3duVmFsdWU7CgogICAgICAgIGlmICh3b3JrSW5Qcm9ncmVzcyA9PT0gZXJyb3JlZFdvcmsgJiYgZXJyb3JlZFdvcmsgIT09IG51bGwpIHsKICAgICAgICAgIC8vIElmIHRoaXMgYm91bmRhcnkgaGFzIGFscmVhZHkgZXJyb3JlZCwgdGhlbiB3ZSBoYWQgdHJvdWJsZSBwcm9jZXNzaW5nCiAgICAgICAgICAvLyB0aGUgZXJyb3IuIEJ1YmJsZSBpdCB0byB0aGUgbmV4dCBib3VuZGFyeS4KICAgICAgICAgIGVycm9yZWRXb3JrID0gZXJyb3JlZFdvcmsucmV0dXJuOwogICAgICAgICAgd29ya0luUHJvZ3Jlc3MgPSBlcnJvcmVkV29yazsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZXJyb3JlZFdvcmsgPSB3b3JrSW5Qcm9ncmVzczsKICAgICAgICB9CgogICAgICAgIGNvbnRpbnVlOwogICAgICB9IC8vIFJldHVybiB0byB0aGUgbm9ybWFsIHdvcmsgbG9vcC4KCgogICAgICByZXR1cm47CiAgICB9IHdoaWxlICh0cnVlKTsKICB9CgogIGZ1bmN0aW9uIHB1c2hEaXNwYXRjaGVyKCkgewogICAgdmFyIHByZXZEaXNwYXRjaGVyID0gUmVhY3RDdXJyZW50RGlzcGF0Y2hlciQyLmN1cnJlbnQ7CiAgICBSZWFjdEN1cnJlbnREaXNwYXRjaGVyJDIuY3VycmVudCA9IENvbnRleHRPbmx5RGlzcGF0Y2hlcjsKCiAgICBpZiAocHJldkRpc3BhdGNoZXIgPT09IG51bGwpIHsKICAgICAgLy8gVGhlIFJlYWN0IGlzb21vcnBoaWMgcGFja2FnZSBkb2VzIG5vdCBpbmNsdWRlIGEgZGVmYXVsdCBkaXNwYXRjaGVyLgogICAgICAvLyBJbnN0ZWFkIHRoZSBmaXJzdCByZW5kZXJlciB3aWxsIGxhemlseSBhdHRhY2ggb25lLCBpbiBvcmRlciB0byBnaXZlCiAgICAgIC8vIG5pY2VyIGVycm9yIG1lc3NhZ2VzLgogICAgICByZXR1cm4gQ29udGV4dE9ubHlEaXNwYXRjaGVyOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIHByZXZEaXNwYXRjaGVyOwogICAgfQogIH0KCiAgZnVuY3Rpb24gcG9wRGlzcGF0Y2hlcihwcmV2RGlzcGF0Y2hlcikgewogICAgUmVhY3RDdXJyZW50RGlzcGF0Y2hlciQyLmN1cnJlbnQgPSBwcmV2RGlzcGF0Y2hlcjsKICB9CgogIGZ1bmN0aW9uIG1hcmtDb21taXRUaW1lT2ZGYWxsYmFjaygpIHsKICAgIGdsb2JhbE1vc3RSZWNlbnRGYWxsYmFja1RpbWUgPSBub3coKTsKICB9CiAgZnVuY3Rpb24gbWFya1NraXBwZWRVcGRhdGVMYW5lcyhsYW5lKSB7CiAgICB3b3JrSW5Qcm9ncmVzc1Jvb3RTa2lwcGVkTGFuZXMgPSBtZXJnZUxhbmVzKGxhbmUsIHdvcmtJblByb2dyZXNzUm9vdFNraXBwZWRMYW5lcyk7CiAgfQogIGZ1bmN0aW9uIHJlbmRlckRpZFN1c3BlbmQoKSB7CiAgICBpZiAod29ya0luUHJvZ3Jlc3NSb290RXhpdFN0YXR1cyA9PT0gUm9vdEluUHJvZ3Jlc3MpIHsKICAgICAgd29ya0luUHJvZ3Jlc3NSb290RXhpdFN0YXR1cyA9IFJvb3RTdXNwZW5kZWQ7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHJlbmRlckRpZFN1c3BlbmREZWxheUlmUG9zc2libGUoKSB7CiAgICBpZiAod29ya0luUHJvZ3Jlc3NSb290RXhpdFN0YXR1cyA9PT0gUm9vdEluUHJvZ3Jlc3MgfHwgd29ya0luUHJvZ3Jlc3NSb290RXhpdFN0YXR1cyA9PT0gUm9vdFN1c3BlbmRlZCB8fCB3b3JrSW5Qcm9ncmVzc1Jvb3RFeGl0U3RhdHVzID09PSBSb290RXJyb3JlZCkgewogICAgICB3b3JrSW5Qcm9ncmVzc1Jvb3RFeGl0U3RhdHVzID0gUm9vdFN1c3BlbmRlZFdpdGhEZWxheTsKICAgIH0gLy8gQ2hlY2sgaWYgdGhlcmUgYXJlIHVwZGF0ZXMgdGhhdCB3ZSBza2lwcGVkIHRyZWUgdGhhdCBtaWdodCBoYXZlIHVuYmxvY2tlZAogICAgLy8gdGhpcyByZW5kZXIuCgoKICAgIGlmICh3b3JrSW5Qcm9ncmVzc1Jvb3QgIT09IG51bGwgJiYgKGluY2x1ZGVzTm9uSWRsZVdvcmsod29ya0luUHJvZ3Jlc3NSb290U2tpcHBlZExhbmVzKSB8fCBpbmNsdWRlc05vbklkbGVXb3JrKHdvcmtJblByb2dyZXNzUm9vdEludGVybGVhdmVkVXBkYXRlZExhbmVzKSkpIHsKICAgICAgLy8gTWFyayB0aGUgY3VycmVudCByZW5kZXIgYXMgc3VzcGVuZGVkIHNvIHRoYXQgd2Ugc3dpdGNoIHRvIHdvcmtpbmcgb24KICAgICAgLy8gdGhlIHVwZGF0ZXMgdGhhdCB3ZXJlIHNraXBwZWQuIFVzdWFsbHkgd2Ugb25seSBzdXNwZW5kIGF0IHRoZSBlbmQgb2YKICAgICAgLy8gdGhlIHJlbmRlciBwaGFzZS4KICAgICAgLy8gVE9ETzogV2Ugc2hvdWxkIHByb2JhYmx5IGFsd2F5cyBtYXJrIHRoZSByb290IGFzIHN1c3BlbmRlZCBpbW1lZGlhdGVseQogICAgICAvLyAoaW5zaWRlIHRoaXMgZnVuY3Rpb24pLCBzaW5jZSBieSBzdXNwZW5kaW5nIGF0IHRoZSBlbmQgb2YgdGhlIHJlbmRlcgogICAgICAvLyBwaGFzZSBpbnRyb2R1Y2VzIGEgcG90ZW50aWFsIG1pc3Rha2Ugd2hlcmUgd2Ugc3VzcGVuZCBsYW5lcyB0aGF0IHdlcmUKICAgICAgLy8gcGluZ2VkIG9yIHVwZGF0ZWQgd2hpbGUgd2Ugd2VyZSByZW5kZXJpbmcuCiAgICAgIG1hcmtSb290U3VzcGVuZGVkJDEod29ya0luUHJvZ3Jlc3NSb290LCB3b3JrSW5Qcm9ncmVzc1Jvb3RSZW5kZXJMYW5lcyk7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHJlbmRlckRpZEVycm9yKGVycm9yKSB7CiAgICBpZiAod29ya0luUHJvZ3Jlc3NSb290RXhpdFN0YXR1cyAhPT0gUm9vdFN1c3BlbmRlZFdpdGhEZWxheSkgewogICAgICB3b3JrSW5Qcm9ncmVzc1Jvb3RFeGl0U3RhdHVzID0gUm9vdEVycm9yZWQ7CiAgICB9CgogICAgaWYgKHdvcmtJblByb2dyZXNzUm9vdENvbmN1cnJlbnRFcnJvcnMgPT09IG51bGwpIHsKICAgICAgd29ya0luUHJvZ3Jlc3NSb290Q29uY3VycmVudEVycm9ycyA9IFtlcnJvcl07CiAgICB9IGVsc2UgewogICAgICB3b3JrSW5Qcm9ncmVzc1Jvb3RDb25jdXJyZW50RXJyb3JzLnB1c2goZXJyb3IpOwogICAgfQogIH0gLy8gQ2FsbGVkIGR1cmluZyByZW5kZXIgdG8gZGV0ZXJtaW5lIGlmIGFueXRoaW5nIGhhcyBzdXNwZW5kZWQuCiAgLy8gUmV0dXJucyBmYWxzZSBpZiB3ZSdyZSBub3Qgc3VyZS4KCiAgZnVuY3Rpb24gcmVuZGVySGFzTm90U3VzcGVuZGVkWWV0KCkgewogICAgLy8gSWYgc29tZXRoaW5nIGVycm9yZWQgb3IgY29tcGxldGVkLCB3ZSBjYW4ndCByZWFsbHkgYmUgc3VyZSwKICAgIC8vIHNvIHRob3NlIGFyZSBmYWxzZS4KICAgIHJldHVybiB3b3JrSW5Qcm9ncmVzc1Jvb3RFeGl0U3RhdHVzID09PSBSb290SW5Qcm9ncmVzczsKICB9CgogIGZ1bmN0aW9uIHJlbmRlclJvb3RTeW5jKHJvb3QsIGxhbmVzKSB7CiAgICB2YXIgcHJldkV4ZWN1dGlvbkNvbnRleHQgPSBleGVjdXRpb25Db250ZXh0OwogICAgZXhlY3V0aW9uQ29udGV4dCB8PSBSZW5kZXJDb250ZXh0OwogICAgdmFyIHByZXZEaXNwYXRjaGVyID0gcHVzaERpc3BhdGNoZXIoKTsgLy8gSWYgdGhlIHJvb3Qgb3IgbGFuZXMgaGF2ZSBjaGFuZ2VkLCB0aHJvdyBvdXQgdGhlIGV4aXN0aW5nIHN0YWNrCiAgICAvLyBhbmQgcHJlcGFyZSBhIGZyZXNoIG9uZS4gT3RoZXJ3aXNlIHdlJ2xsIGNvbnRpbnVlIHdoZXJlIHdlIGxlZnQgb2ZmLgoKICAgIGlmICh3b3JrSW5Qcm9ncmVzc1Jvb3QgIT09IHJvb3QgfHwgd29ya0luUHJvZ3Jlc3NSb290UmVuZGVyTGFuZXMgIT09IGxhbmVzKSB7CiAgICAgIHsKICAgICAgICBpZiAoaXNEZXZUb29sc1ByZXNlbnQpIHsKICAgICAgICAgIHZhciBtZW1vaXplZFVwZGF0ZXJzID0gcm9vdC5tZW1vaXplZFVwZGF0ZXJzOwoKICAgICAgICAgIGlmIChtZW1vaXplZFVwZGF0ZXJzLnNpemUgPiAwKSB7CiAgICAgICAgICAgIHJlc3RvcmVQZW5kaW5nVXBkYXRlcnMocm9vdCwgd29ya0luUHJvZ3Jlc3NSb290UmVuZGVyTGFuZXMpOwogICAgICAgICAgICBtZW1vaXplZFVwZGF0ZXJzLmNsZWFyKCk7CiAgICAgICAgICB9IC8vIEF0IHRoaXMgcG9pbnQsIG1vdmUgRmliZXJzIHRoYXQgc2NoZWR1bGVkIHRoZSB1cGNvbWluZyB3b3JrIGZyb20gdGhlIE1hcCB0byB0aGUgU2V0LgogICAgICAgICAgLy8gSWYgd2UgYmFpbG91dCBvbiB0aGlzIHdvcmssIHdlJ2xsIG1vdmUgdGhlbSBiYWNrIChsaWtlIGFib3ZlKS4KICAgICAgICAgIC8vIEl0J3MgaW1wb3J0YW50IHRvIG1vdmUgdGhlbSBub3cgaW4gY2FzZSB0aGUgd29yayBzcGF3bnMgbW9yZSB3b3JrIGF0IHRoZSBzYW1lIHByaW9yaXR5IHdpdGggZGlmZmVyZW50IHVwZGF0ZXJzLgogICAgICAgICAgLy8gVGhhdCB3YXkgd2UgY2FuIGtlZXAgdGhlIGN1cnJlbnQgdXBkYXRlIGFuZCBmdXR1cmUgdXBkYXRlcyBzZXBhcmF0ZS4KCgogICAgICAgICAgbW92ZVBlbmRpbmdGaWJlcnNUb01lbW9pemVkKHJvb3QsIGxhbmVzKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHdvcmtJblByb2dyZXNzVHJhbnNpdGlvbnMgPSBnZXRUcmFuc2l0aW9uc0ZvckxhbmVzKCk7CiAgICAgIHByZXBhcmVGcmVzaFN0YWNrKHJvb3QsIGxhbmVzKTsKICAgIH0KCiAgICB7CiAgICAgIG1hcmtSZW5kZXJTdGFydGVkKGxhbmVzKTsKICAgIH0KCiAgICBkbyB7CiAgICAgIHRyeSB7CiAgICAgICAgd29ya0xvb3BTeW5jKCk7CiAgICAgICAgYnJlYWs7CiAgICAgIH0gY2F0Y2ggKHRocm93blZhbHVlKSB7CiAgICAgICAgaGFuZGxlRXJyb3Iocm9vdCwgdGhyb3duVmFsdWUpOwogICAgICB9CiAgICB9IHdoaWxlICh0cnVlKTsKCiAgICByZXNldENvbnRleHREZXBlbmRlbmNpZXMoKTsKICAgIGV4ZWN1dGlvbkNvbnRleHQgPSBwcmV2RXhlY3V0aW9uQ29udGV4dDsKICAgIHBvcERpc3BhdGNoZXIocHJldkRpc3BhdGNoZXIpOwoKICAgIGlmICh3b3JrSW5Qcm9ncmVzcyAhPT0gbnVsbCkgewogICAgICAvLyBUaGlzIGlzIGEgc3luYyByZW5kZXIsIHNvIHdlIHNob3VsZCBoYXZlIGZpbmlzaGVkIHRoZSB3aG9sZSB0cmVlLgogICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCBjb21taXQgYW4gaW5jb21wbGV0ZSByb290LiBUaGlzIGVycm9yIGlzIGxpa2VseSBjYXVzZWQgYnkgYSAnICsgJ2J1ZyBpbiBSZWFjdC4gUGxlYXNlIGZpbGUgYW4gaXNzdWUuJyk7CiAgICB9CgogICAgewogICAgICBtYXJrUmVuZGVyU3RvcHBlZCgpOwogICAgfSAvLyBTZXQgdGhpcyB0byBudWxsIHRvIGluZGljYXRlIHRoZXJlJ3Mgbm8gaW4tcHJvZ3Jlc3MgcmVuZGVyLgoKCiAgICB3b3JrSW5Qcm9ncmVzc1Jvb3QgPSBudWxsOwogICAgd29ya0luUHJvZ3Jlc3NSb290UmVuZGVyTGFuZXMgPSBOb0xhbmVzOwogICAgcmV0dXJuIHdvcmtJblByb2dyZXNzUm9vdEV4aXRTdGF0dXM7CiAgfSAvLyBUaGUgd29yayBsb29wIGlzIGFuIGV4dHJlbWVseSBob3QgcGF0aC4gVGVsbCBDbG9zdXJlIG5vdCB0byBpbmxpbmUgaXQuCgogIC8qKiBAbm9pbmxpbmUgKi8KCgogIGZ1bmN0aW9uIHdvcmtMb29wU3luYygpIHsKICAgIC8vIEFscmVhZHkgdGltZWQgb3V0LCBzbyBwZXJmb3JtIHdvcmsgd2l0aG91dCBjaGVja2luZyBpZiB3ZSBuZWVkIHRvIHlpZWxkLgogICAgd2hpbGUgKHdvcmtJblByb2dyZXNzICE9PSBudWxsKSB7CiAgICAgIHBlcmZvcm1Vbml0T2ZXb3JrKHdvcmtJblByb2dyZXNzKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHJlbmRlclJvb3RDb25jdXJyZW50KHJvb3QsIGxhbmVzKSB7CiAgICB2YXIgcHJldkV4ZWN1dGlvbkNvbnRleHQgPSBleGVjdXRpb25Db250ZXh0OwogICAgZXhlY3V0aW9uQ29udGV4dCB8PSBSZW5kZXJDb250ZXh0OwogICAgdmFyIHByZXZEaXNwYXRjaGVyID0gcHVzaERpc3BhdGNoZXIoKTsgLy8gSWYgdGhlIHJvb3Qgb3IgbGFuZXMgaGF2ZSBjaGFuZ2VkLCB0aHJvdyBvdXQgdGhlIGV4aXN0aW5nIHN0YWNrCiAgICAvLyBhbmQgcHJlcGFyZSBhIGZyZXNoIG9uZS4gT3RoZXJ3aXNlIHdlJ2xsIGNvbnRpbnVlIHdoZXJlIHdlIGxlZnQgb2ZmLgoKICAgIGlmICh3b3JrSW5Qcm9ncmVzc1Jvb3QgIT09IHJvb3QgfHwgd29ya0luUHJvZ3Jlc3NSb290UmVuZGVyTGFuZXMgIT09IGxhbmVzKSB7CiAgICAgIHsKICAgICAgICBpZiAoaXNEZXZUb29sc1ByZXNlbnQpIHsKICAgICAgICAgIHZhciBtZW1vaXplZFVwZGF0ZXJzID0gcm9vdC5tZW1vaXplZFVwZGF0ZXJzOwoKICAgICAgICAgIGlmIChtZW1vaXplZFVwZGF0ZXJzLnNpemUgPiAwKSB7CiAgICAgICAgICAgIHJlc3RvcmVQZW5kaW5nVXBkYXRlcnMocm9vdCwgd29ya0luUHJvZ3Jlc3NSb290UmVuZGVyTGFuZXMpOwogICAgICAgICAgICBtZW1vaXplZFVwZGF0ZXJzLmNsZWFyKCk7CiAgICAgICAgICB9IC8vIEF0IHRoaXMgcG9pbnQsIG1vdmUgRmliZXJzIHRoYXQgc2NoZWR1bGVkIHRoZSB1cGNvbWluZyB3b3JrIGZyb20gdGhlIE1hcCB0byB0aGUgU2V0LgogICAgICAgICAgLy8gSWYgd2UgYmFpbG91dCBvbiB0aGlzIHdvcmssIHdlJ2xsIG1vdmUgdGhlbSBiYWNrIChsaWtlIGFib3ZlKS4KICAgICAgICAgIC8vIEl0J3MgaW1wb3J0YW50IHRvIG1vdmUgdGhlbSBub3cgaW4gY2FzZSB0aGUgd29yayBzcGF3bnMgbW9yZSB3b3JrIGF0IHRoZSBzYW1lIHByaW9yaXR5IHdpdGggZGlmZmVyZW50IHVwZGF0ZXJzLgogICAgICAgICAgLy8gVGhhdCB3YXkgd2UgY2FuIGtlZXAgdGhlIGN1cnJlbnQgdXBkYXRlIGFuZCBmdXR1cmUgdXBkYXRlcyBzZXBhcmF0ZS4KCgogICAgICAgICAgbW92ZVBlbmRpbmdGaWJlcnNUb01lbW9pemVkKHJvb3QsIGxhbmVzKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHdvcmtJblByb2dyZXNzVHJhbnNpdGlvbnMgPSBnZXRUcmFuc2l0aW9uc0ZvckxhbmVzKCk7CiAgICAgIHJlc2V0UmVuZGVyVGltZXIoKTsKICAgICAgcHJlcGFyZUZyZXNoU3RhY2socm9vdCwgbGFuZXMpOwogICAgfQoKICAgIHsKICAgICAgbWFya1JlbmRlclN0YXJ0ZWQobGFuZXMpOwogICAgfQoKICAgIGRvIHsKICAgICAgdHJ5IHsKICAgICAgICB3b3JrTG9vcENvbmN1cnJlbnQoKTsKICAgICAgICBicmVhazsKICAgICAgfSBjYXRjaCAodGhyb3duVmFsdWUpIHsKICAgICAgICBoYW5kbGVFcnJvcihyb290LCB0aHJvd25WYWx1ZSk7CiAgICAgIH0KICAgIH0gd2hpbGUgKHRydWUpOwoKICAgIHJlc2V0Q29udGV4dERlcGVuZGVuY2llcygpOwogICAgcG9wRGlzcGF0Y2hlcihwcmV2RGlzcGF0Y2hlcik7CiAgICBleGVjdXRpb25Db250ZXh0ID0gcHJldkV4ZWN1dGlvbkNvbnRleHQ7CgoKICAgIGlmICh3b3JrSW5Qcm9ncmVzcyAhPT0gbnVsbCkgewogICAgICAvLyBTdGlsbCB3b3JrIHJlbWFpbmluZy4KICAgICAgewogICAgICAgIG1hcmtSZW5kZXJZaWVsZGVkKCk7CiAgICAgIH0KCiAgICAgIHJldHVybiBSb290SW5Qcm9ncmVzczsKICAgIH0gZWxzZSB7CiAgICAgIC8vIENvbXBsZXRlZCB0aGUgdHJlZS4KICAgICAgewogICAgICAgIG1hcmtSZW5kZXJTdG9wcGVkKCk7CiAgICAgIH0gLy8gU2V0IHRoaXMgdG8gbnVsbCB0byBpbmRpY2F0ZSB0aGVyZSdzIG5vIGluLXByb2dyZXNzIHJlbmRlci4KCgogICAgICB3b3JrSW5Qcm9ncmVzc1Jvb3QgPSBudWxsOwogICAgICB3b3JrSW5Qcm9ncmVzc1Jvb3RSZW5kZXJMYW5lcyA9IE5vTGFuZXM7IC8vIFJldHVybiB0aGUgZmluYWwgZXhpdCBzdGF0dXMuCgogICAgICByZXR1cm4gd29ya0luUHJvZ3Jlc3NSb290RXhpdFN0YXR1czsKICAgIH0KICB9CiAgLyoqIEBub2lubGluZSAqLwoKCiAgZnVuY3Rpb24gd29ya0xvb3BDb25jdXJyZW50KCkgewogICAgLy8gUGVyZm9ybSB3b3JrIHVudGlsIFNjaGVkdWxlciBhc2tzIHVzIHRvIHlpZWxkCiAgICB3aGlsZSAod29ya0luUHJvZ3Jlc3MgIT09IG51bGwgJiYgIXNob3VsZFlpZWxkKCkpIHsKICAgICAgcGVyZm9ybVVuaXRPZldvcmsod29ya0luUHJvZ3Jlc3MpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gcGVyZm9ybVVuaXRPZldvcmsodW5pdE9mV29yaykgewogICAgLy8gVGhlIGN1cnJlbnQsIGZsdXNoZWQsIHN0YXRlIG9mIHRoaXMgZmliZXIgaXMgdGhlIGFsdGVybmF0ZS4gSWRlYWxseQogICAgLy8gbm90aGluZyBzaG91bGQgcmVseSBvbiB0aGlzLCBidXQgcmVseWluZyBvbiBpdCBoZXJlIG1lYW5zIHRoYXQgd2UgZG9uJ3QKICAgIC8vIG5lZWQgYW4gYWRkaXRpb25hbCBmaWVsZCBvbiB0aGUgd29yayBpbiBwcm9ncmVzcy4KICAgIHZhciBjdXJyZW50ID0gdW5pdE9mV29yay5hbHRlcm5hdGU7CiAgICBzZXRDdXJyZW50RmliZXIodW5pdE9mV29yayk7CiAgICB2YXIgbmV4dDsKCiAgICBpZiAoICh1bml0T2ZXb3JrLm1vZGUgJiBQcm9maWxlTW9kZSkgIT09IE5vTW9kZSkgewogICAgICBzdGFydFByb2ZpbGVyVGltZXIodW5pdE9mV29yayk7CiAgICAgIG5leHQgPSBiZWdpbldvcmskMShjdXJyZW50LCB1bml0T2ZXb3JrLCBzdWJ0cmVlUmVuZGVyTGFuZXMpOwogICAgICBzdG9wUHJvZmlsZXJUaW1lcklmUnVubmluZ0FuZFJlY29yZERlbHRhKHVuaXRPZldvcmssIHRydWUpOwogICAgfSBlbHNlIHsKICAgICAgbmV4dCA9IGJlZ2luV29yayQxKGN1cnJlbnQsIHVuaXRPZldvcmssIHN1YnRyZWVSZW5kZXJMYW5lcyk7CiAgICB9CgogICAgcmVzZXRDdXJyZW50RmliZXIoKTsKICAgIHVuaXRPZldvcmsubWVtb2l6ZWRQcm9wcyA9IHVuaXRPZldvcmsucGVuZGluZ1Byb3BzOwoKICAgIGlmIChuZXh0ID09PSBudWxsKSB7CiAgICAgIC8vIElmIHRoaXMgZG9lc24ndCBzcGF3biBuZXcgd29yaywgY29tcGxldGUgdGhlIGN1cnJlbnQgd29yay4KICAgICAgY29tcGxldGVVbml0T2ZXb3JrKHVuaXRPZldvcmspOwogICAgfSBlbHNlIHsKICAgICAgd29ya0luUHJvZ3Jlc3MgPSBuZXh0OwogICAgfQoKICAgIFJlYWN0Q3VycmVudE93bmVyJDIuY3VycmVudCA9IG51bGw7CiAgfQoKICBmdW5jdGlvbiBjb21wbGV0ZVVuaXRPZldvcmsodW5pdE9mV29yaykgewogICAgLy8gQXR0ZW1wdCB0byBjb21wbGV0ZSB0aGUgY3VycmVudCB1bml0IG9mIHdvcmssIHRoZW4gbW92ZSB0byB0aGUgbmV4dAogICAgLy8gc2libGluZy4gSWYgdGhlcmUgYXJlIG5vIG1vcmUgc2libGluZ3MsIHJldHVybiB0byB0aGUgcGFyZW50IGZpYmVyLgogICAgdmFyIGNvbXBsZXRlZFdvcmsgPSB1bml0T2ZXb3JrOwoKICAgIGRvIHsKICAgICAgLy8gVGhlIGN1cnJlbnQsIGZsdXNoZWQsIHN0YXRlIG9mIHRoaXMgZmliZXIgaXMgdGhlIGFsdGVybmF0ZS4gSWRlYWxseQogICAgICAvLyBub3RoaW5nIHNob3VsZCByZWx5IG9uIHRoaXMsIGJ1dCByZWx5aW5nIG9uIGl0IGhlcmUgbWVhbnMgdGhhdCB3ZSBkb24ndAogICAgICAvLyBuZWVkIGFuIGFkZGl0aW9uYWwgZmllbGQgb24gdGhlIHdvcmsgaW4gcHJvZ3Jlc3MuCiAgICAgIHZhciBjdXJyZW50ID0gY29tcGxldGVkV29yay5hbHRlcm5hdGU7CiAgICAgIHZhciByZXR1cm5GaWJlciA9IGNvbXBsZXRlZFdvcmsucmV0dXJuOyAvLyBDaGVjayBpZiB0aGUgd29yayBjb21wbGV0ZWQgb3IgaWYgc29tZXRoaW5nIHRocmV3LgoKICAgICAgaWYgKChjb21wbGV0ZWRXb3JrLmZsYWdzICYgSW5jb21wbGV0ZSkgPT09IE5vRmxhZ3MpIHsKICAgICAgICBzZXRDdXJyZW50RmliZXIoY29tcGxldGVkV29yayk7CiAgICAgICAgdmFyIG5leHQgPSB2b2lkIDA7CgogICAgICAgIGlmICggKGNvbXBsZXRlZFdvcmsubW9kZSAmIFByb2ZpbGVNb2RlKSA9PT0gTm9Nb2RlKSB7CiAgICAgICAgICBuZXh0ID0gY29tcGxldGVXb3JrKGN1cnJlbnQsIGNvbXBsZXRlZFdvcmssIHN1YnRyZWVSZW5kZXJMYW5lcyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHN0YXJ0UHJvZmlsZXJUaW1lcihjb21wbGV0ZWRXb3JrKTsKICAgICAgICAgIG5leHQgPSBjb21wbGV0ZVdvcmsoY3VycmVudCwgY29tcGxldGVkV29yaywgc3VidHJlZVJlbmRlckxhbmVzKTsgLy8gVXBkYXRlIHJlbmRlciBkdXJhdGlvbiBhc3N1bWluZyB3ZSBkaWRuJ3QgZXJyb3IuCgogICAgICAgICAgc3RvcFByb2ZpbGVyVGltZXJJZlJ1bm5pbmdBbmRSZWNvcmREZWx0YShjb21wbGV0ZWRXb3JrLCBmYWxzZSk7CiAgICAgICAgfQoKICAgICAgICByZXNldEN1cnJlbnRGaWJlcigpOwoKICAgICAgICBpZiAobmV4dCAhPT0gbnVsbCkgewogICAgICAgICAgLy8gQ29tcGxldGluZyB0aGlzIGZpYmVyIHNwYXduZWQgbmV3IHdvcmsuIFdvcmsgb24gdGhhdCBuZXh0LgogICAgICAgICAgd29ya0luUHJvZ3Jlc3MgPSBuZXh0OwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBUaGlzIGZpYmVyIGRpZCBub3QgY29tcGxldGUgYmVjYXVzZSBzb21ldGhpbmcgdGhyZXcuIFBvcCB2YWx1ZXMgb2ZmCiAgICAgICAgLy8gdGhlIHN0YWNrIHdpdGhvdXQgZW50ZXJpbmcgdGhlIGNvbXBsZXRlIHBoYXNlLiBJZiB0aGlzIGlzIGEgYm91bmRhcnksCiAgICAgICAgLy8gY2FwdHVyZSB2YWx1ZXMgaWYgcG9zc2libGUuCiAgICAgICAgdmFyIF9uZXh0ID0gdW53aW5kV29yayhjdXJyZW50LCBjb21wbGV0ZWRXb3JrKTsgLy8gQmVjYXVzZSB0aGlzIGZpYmVyIGRpZCBub3QgY29tcGxldGUsIGRvbid0IHJlc2V0IGl0cyBsYW5lcy4KCgogICAgICAgIGlmIChfbmV4dCAhPT0gbnVsbCkgewogICAgICAgICAgLy8gSWYgY29tcGxldGluZyB0aGlzIHdvcmsgc3Bhd25lZCBuZXcgd29yaywgZG8gdGhhdCBuZXh0LiBXZSdsbCBjb21lCiAgICAgICAgICAvLyBiYWNrIGhlcmUgYWdhaW4uCiAgICAgICAgICAvLyBTaW5jZSB3ZSdyZSByZXN0YXJ0aW5nLCByZW1vdmUgYW55dGhpbmcgdGhhdCBpcyBub3QgYSBob3N0IGVmZmVjdAogICAgICAgICAgLy8gZnJvbSB0aGUgZWZmZWN0IHRhZy4KICAgICAgICAgIF9uZXh0LmZsYWdzICY9IEhvc3RFZmZlY3RNYXNrOwogICAgICAgICAgd29ya0luUHJvZ3Jlc3MgPSBfbmV4dDsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmICggKGNvbXBsZXRlZFdvcmsubW9kZSAmIFByb2ZpbGVNb2RlKSAhPT0gTm9Nb2RlKSB7CiAgICAgICAgICAvLyBSZWNvcmQgdGhlIHJlbmRlciBkdXJhdGlvbiBmb3IgdGhlIGZpYmVyIHRoYXQgZXJyb3JlZC4KICAgICAgICAgIHN0b3BQcm9maWxlclRpbWVySWZSdW5uaW5nQW5kUmVjb3JkRGVsdGEoY29tcGxldGVkV29yaywgZmFsc2UpOyAvLyBJbmNsdWRlIHRoZSB0aW1lIHNwZW50IHdvcmtpbmcgb24gZmFpbGVkIGNoaWxkcmVuIGJlZm9yZSBjb250aW51aW5nLgoKICAgICAgICAgIHZhciBhY3R1YWxEdXJhdGlvbiA9IGNvbXBsZXRlZFdvcmsuYWN0dWFsRHVyYXRpb247CiAgICAgICAgICB2YXIgY2hpbGQgPSBjb21wbGV0ZWRXb3JrLmNoaWxkOwoKICAgICAgICAgIHdoaWxlIChjaGlsZCAhPT0gbnVsbCkgewogICAgICAgICAgICBhY3R1YWxEdXJhdGlvbiArPSBjaGlsZC5hY3R1YWxEdXJhdGlvbjsKICAgICAgICAgICAgY2hpbGQgPSBjaGlsZC5zaWJsaW5nOwogICAgICAgICAgfQoKICAgICAgICAgIGNvbXBsZXRlZFdvcmsuYWN0dWFsRHVyYXRpb24gPSBhY3R1YWxEdXJhdGlvbjsKICAgICAgICB9CgogICAgICAgIGlmIChyZXR1cm5GaWJlciAhPT0gbnVsbCkgewogICAgICAgICAgLy8gTWFyayB0aGUgcGFyZW50IGZpYmVyIGFzIGluY29tcGxldGUgYW5kIGNsZWFyIGl0cyBzdWJ0cmVlIGZsYWdzLgogICAgICAgICAgcmV0dXJuRmliZXIuZmxhZ3MgfD0gSW5jb21wbGV0ZTsKICAgICAgICAgIHJldHVybkZpYmVyLnN1YnRyZWVGbGFncyA9IE5vRmxhZ3M7CiAgICAgICAgICByZXR1cm5GaWJlci5kZWxldGlvbnMgPSBudWxsOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyBXZSd2ZSB1bndvdW5kIGFsbCB0aGUgd2F5IHRvIHRoZSByb290LgogICAgICAgICAgd29ya0luUHJvZ3Jlc3NSb290RXhpdFN0YXR1cyA9IFJvb3REaWROb3RDb21wbGV0ZTsKICAgICAgICAgIHdvcmtJblByb2dyZXNzID0gbnVsbDsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHZhciBzaWJsaW5nRmliZXIgPSBjb21wbGV0ZWRXb3JrLnNpYmxpbmc7CgogICAgICBpZiAoc2libGluZ0ZpYmVyICE9PSBudWxsKSB7CiAgICAgICAgLy8gSWYgdGhlcmUgaXMgbW9yZSB3b3JrIHRvIGRvIGluIHRoaXMgcmV0dXJuRmliZXIsIGRvIHRoYXQgbmV4dC4KICAgICAgICB3b3JrSW5Qcm9ncmVzcyA9IHNpYmxpbmdGaWJlcjsKICAgICAgICByZXR1cm47CiAgICAgIH0gLy8gT3RoZXJ3aXNlLCByZXR1cm4gdG8gdGhlIHBhcmVudAoKCiAgICAgIGNvbXBsZXRlZFdvcmsgPSByZXR1cm5GaWJlcjsgLy8gVXBkYXRlIHRoZSBuZXh0IHRoaW5nIHdlJ3JlIHdvcmtpbmcgb24gaW4gY2FzZSBzb21ldGhpbmcgdGhyb3dzLgoKICAgICAgd29ya0luUHJvZ3Jlc3MgPSBjb21wbGV0ZWRXb3JrOwogICAgfSB3aGlsZSAoY29tcGxldGVkV29yayAhPT0gbnVsbCk7IC8vIFdlJ3ZlIHJlYWNoZWQgdGhlIHJvb3QuCgoKICAgIGlmICh3b3JrSW5Qcm9ncmVzc1Jvb3RFeGl0U3RhdHVzID09PSBSb290SW5Qcm9ncmVzcykgewogICAgICB3b3JrSW5Qcm9ncmVzc1Jvb3RFeGl0U3RhdHVzID0gUm9vdENvbXBsZXRlZDsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGNvbW1pdFJvb3Qocm9vdCwgcmVjb3ZlcmFibGVFcnJvcnMsIHRyYW5zaXRpb25zKSB7CiAgICAvLyBUT0RPOiBUaGlzIG5vIGxvbmdlciBtYWtlcyBhbnkgc2Vuc2UuIFdlIGFscmVhZHkgd3JhcCB0aGUgbXV0YXRpb24gYW5kCiAgICAvLyBsYXlvdXQgcGhhc2VzLiBTaG91bGQgYmUgYWJsZSB0byByZW1vdmUuCiAgICB2YXIgcHJldmlvdXNVcGRhdGVMYW5lUHJpb3JpdHkgPSBnZXRDdXJyZW50VXBkYXRlUHJpb3JpdHkoKTsKICAgIHZhciBwcmV2VHJhbnNpdGlvbiA9IFJlYWN0Q3VycmVudEJhdGNoQ29uZmlnJDMudHJhbnNpdGlvbjsKCiAgICB0cnkgewogICAgICBSZWFjdEN1cnJlbnRCYXRjaENvbmZpZyQzLnRyYW5zaXRpb24gPSBudWxsOwogICAgICBzZXRDdXJyZW50VXBkYXRlUHJpb3JpdHkoRGlzY3JldGVFdmVudFByaW9yaXR5KTsKICAgICAgY29tbWl0Um9vdEltcGwocm9vdCwgcmVjb3ZlcmFibGVFcnJvcnMsIHRyYW5zaXRpb25zLCBwcmV2aW91c1VwZGF0ZUxhbmVQcmlvcml0eSk7CiAgICB9IGZpbmFsbHkgewogICAgICBSZWFjdEN1cnJlbnRCYXRjaENvbmZpZyQzLnRyYW5zaXRpb24gPSBwcmV2VHJhbnNpdGlvbjsKICAgICAgc2V0Q3VycmVudFVwZGF0ZVByaW9yaXR5KHByZXZpb3VzVXBkYXRlTGFuZVByaW9yaXR5KTsKICAgIH0KCiAgICByZXR1cm4gbnVsbDsKICB9CgogIGZ1bmN0aW9uIGNvbW1pdFJvb3RJbXBsKHJvb3QsIHJlY292ZXJhYmxlRXJyb3JzLCB0cmFuc2l0aW9ucywgcmVuZGVyUHJpb3JpdHlMZXZlbCkgewogICAgZG8gewogICAgICAvLyBgZmx1c2hQYXNzaXZlRWZmZWN0c2Agd2lsbCBjYWxsIGBmbHVzaFN5bmNVcGRhdGVRdWV1ZWAgYXQgdGhlIGVuZCwgd2hpY2gKICAgICAgLy8gbWVhbnMgYGZsdXNoUGFzc2l2ZUVmZmVjdHNgIHdpbGwgc29tZXRpbWVzIHJlc3VsdCBpbiBhZGRpdGlvbmFsCiAgICAgIC8vIHBhc3NpdmUgZWZmZWN0cy4gU28gd2UgbmVlZCB0byBrZWVwIGZsdXNoaW5nIGluIGEgbG9vcCB1bnRpbCB0aGVyZSBhcmUKICAgICAgLy8gbm8gbW9yZSBwZW5kaW5nIGVmZmVjdHMuCiAgICAgIC8vIFRPRE86IE1pZ2h0IGJlIGJldHRlciBpZiBgZmx1c2hQYXNzaXZlRWZmZWN0c2AgZGlkIG5vdCBhdXRvbWF0aWNhbGx5CiAgICAgIC8vIGZsdXNoIHN5bmNocm9ub3VzIHdvcmsgYXQgdGhlIGVuZCwgdG8gYXZvaWQgZmFjdG9yaW5nIGhhemFyZHMgbGlrZSB0aGlzLgogICAgICBmbHVzaFBhc3NpdmVFZmZlY3RzKCk7CiAgICB9IHdoaWxlIChyb290V2l0aFBlbmRpbmdQYXNzaXZlRWZmZWN0cyAhPT0gbnVsbCk7CgogICAgZmx1c2hSZW5kZXJQaGFzZVN0cmljdE1vZGVXYXJuaW5nc0luREVWKCk7CgogICAgaWYgKChleGVjdXRpb25Db250ZXh0ICYgKFJlbmRlckNvbnRleHQgfCBDb21taXRDb250ZXh0KSkgIT09IE5vQ29udGV4dCkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Nob3VsZCBub3QgYWxyZWFkeSBiZSB3b3JraW5nLicpOwogICAgfQoKICAgIHZhciBmaW5pc2hlZFdvcmsgPSByb290LmZpbmlzaGVkV29yazsKICAgIHZhciBsYW5lcyA9IHJvb3QuZmluaXNoZWRMYW5lczsKCiAgICB7CiAgICAgIG1hcmtDb21taXRTdGFydGVkKGxhbmVzKTsKICAgIH0KCiAgICBpZiAoZmluaXNoZWRXb3JrID09PSBudWxsKSB7CgogICAgICB7CiAgICAgICAgbWFya0NvbW1pdFN0b3BwZWQoKTsKICAgICAgfQoKICAgICAgcmV0dXJuIG51bGw7CiAgICB9IGVsc2UgewogICAgICB7CiAgICAgICAgaWYgKGxhbmVzID09PSBOb0xhbmVzKSB7CiAgICAgICAgICBlcnJvcigncm9vdC5maW5pc2hlZExhbmVzIHNob3VsZCBub3QgYmUgZW1wdHkgZHVyaW5nIGEgY29tbWl0LiBUaGlzIGlzIGEgJyArICdidWcgaW4gUmVhY3QuJyk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgcm9vdC5maW5pc2hlZFdvcmsgPSBudWxsOwogICAgcm9vdC5maW5pc2hlZExhbmVzID0gTm9MYW5lczsKCiAgICBpZiAoZmluaXNoZWRXb3JrID09PSByb290LmN1cnJlbnQpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdDYW5ub3QgY29tbWl0IHRoZSBzYW1lIHRyZWUgYXMgYmVmb3JlLiBUaGlzIGVycm9yIGlzIGxpa2VseSBjYXVzZWQgYnkgJyArICdhIGJ1ZyBpbiBSZWFjdC4gUGxlYXNlIGZpbGUgYW4gaXNzdWUuJyk7CiAgICB9IC8vIGNvbW1pdFJvb3QgbmV2ZXIgcmV0dXJucyBhIGNvbnRpbnVhdGlvbjsgaXQgYWx3YXlzIGZpbmlzaGVzIHN5bmNocm9ub3VzbHkuCiAgICAvLyBTbyB3ZSBjYW4gY2xlYXIgdGhlc2Ugbm93IHRvIGFsbG93IGEgbmV3IGNhbGxiYWNrIHRvIGJlIHNjaGVkdWxlZC4KCgogICAgcm9vdC5jYWxsYmFja05vZGUgPSBudWxsOwogICAgcm9vdC5jYWxsYmFja1ByaW9yaXR5ID0gTm9MYW5lOyAvLyBVcGRhdGUgdGhlIGZpcnN0IGFuZCBsYXN0IHBlbmRpbmcgdGltZXMgb24gdGhpcyByb290LiBUaGUgbmV3IGZpcnN0CiAgICAvLyBwZW5kaW5nIHRpbWUgaXMgd2hhdGV2ZXIgaXMgbGVmdCBvbiB0aGUgcm9vdCBmaWJlci4KCiAgICB2YXIgcmVtYWluaW5nTGFuZXMgPSBtZXJnZUxhbmVzKGZpbmlzaGVkV29yay5sYW5lcywgZmluaXNoZWRXb3JrLmNoaWxkTGFuZXMpOwogICAgbWFya1Jvb3RGaW5pc2hlZChyb290LCByZW1haW5pbmdMYW5lcyk7CgogICAgaWYgKHJvb3QgPT09IHdvcmtJblByb2dyZXNzUm9vdCkgewogICAgICAvLyBXZSBjYW4gcmVzZXQgdGhlc2Ugbm93IHRoYXQgdGhleSBhcmUgZmluaXNoZWQuCiAgICAgIHdvcmtJblByb2dyZXNzUm9vdCA9IG51bGw7CiAgICAgIHdvcmtJblByb2dyZXNzID0gbnVsbDsKICAgICAgd29ya0luUHJvZ3Jlc3NSb290UmVuZGVyTGFuZXMgPSBOb0xhbmVzOwogICAgfSAvLyBJZiB0aGVyZSBhcmUgcGVuZGluZyBwYXNzaXZlIGVmZmVjdHMsIHNjaGVkdWxlIGEgY2FsbGJhY2sgdG8gcHJvY2VzcyB0aGVtLgogICAgLy8gRG8gdGhpcyBhcyBlYXJseSBhcyBwb3NzaWJsZSwgc28gaXQgaXMgcXVldWVkIGJlZm9yZSBhbnl0aGluZyBlbHNlIHRoYXQKICAgIC8vIG1pZ2h0IGdldCBzY2hlZHVsZWQgaW4gdGhlIGNvbW1pdCBwaGFzZS4gKFNlZSAjMTY3MTQuKQogICAgLy8gVE9ETzogRGVsZXRlIGFsbCBvdGhlciBwbGFjZXMgdGhhdCBzY2hlZHVsZSB0aGUgcGFzc2l2ZSBlZmZlY3QgY2FsbGJhY2sKICAgIC8vIFRoZXkncmUgcmVkdW5kYW50LgoKCiAgICBpZiAoKGZpbmlzaGVkV29yay5zdWJ0cmVlRmxhZ3MgJiBQYXNzaXZlTWFzaykgIT09IE5vRmxhZ3MgfHwgKGZpbmlzaGVkV29yay5mbGFncyAmIFBhc3NpdmVNYXNrKSAhPT0gTm9GbGFncykgewogICAgICBpZiAoIXJvb3REb2VzSGF2ZVBhc3NpdmVFZmZlY3RzKSB7CiAgICAgICAgcm9vdERvZXNIYXZlUGFzc2l2ZUVmZmVjdHMgPSB0cnVlOwogICAgICAgIC8vIHRvIHN0b3JlIGl0IGluIHBlbmRpbmdQYXNzaXZlVHJhbnNpdGlvbnMgdW50aWwgdGhleSBnZXQgcHJvY2Vzc2VkCiAgICAgICAgLy8gV2UgbmVlZCB0byBwYXNzIHRoaXMgdGhyb3VnaCBhcyBhbiBhcmd1bWVudCB0byBjb21taXRSb290CiAgICAgICAgLy8gYmVjYXVzZSB3b3JrSW5Qcm9ncmVzc1RyYW5zaXRpb25zIG1pZ2h0IGhhdmUgY2hhbmdlZCBiZXR3ZWVuCiAgICAgICAgLy8gdGhlIHByZXZpb3VzIHJlbmRlciBhbmQgY29tbWl0IGlmIHdlIHRocm90dGxlIHRoZSBjb21taXQKICAgICAgICAvLyB3aXRoIHNldFRpbWVvdXQKCiAgICAgICAgcGVuZGluZ1Bhc3NpdmVUcmFuc2l0aW9ucyA9IHRyYW5zaXRpb25zOwogICAgICAgIHNjaGVkdWxlQ2FsbGJhY2skMShOb3JtYWxQcmlvcml0eSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgZmx1c2hQYXNzaXZlRWZmZWN0cygpOyAvLyBUaGlzIHJlbmRlciB0cmlnZ2VyZWQgcGFzc2l2ZSBlZmZlY3RzOiByZWxlYXNlIHRoZSByb290IGNhY2hlIHBvb2wKICAgICAgICAgIC8vICphZnRlciogcGFzc2l2ZSBlZmZlY3RzIGZpcmUgdG8gYXZvaWQgZnJlZWluZyBhIGNhY2hlIHBvb2wgdGhhdCBtYXkKICAgICAgICAgIC8vIGJlIHJlZmVyZW5jZWQgYnkgYSBub2RlIGluIHRoZSB0cmVlIChIb3N0Um9vdCwgQ2FjaGUgYm91bmRhcnkgZXRjKQoKICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0pOwogICAgICB9CiAgICB9IC8vIENoZWNrIGlmIHRoZXJlIGFyZSBhbnkgZWZmZWN0cyBpbiB0aGUgd2hvbGUgdHJlZS4KICAgIC8vIFRPRE86IFRoaXMgaXMgbGVmdCBvdmVyIGZyb20gdGhlIGVmZmVjdCBsaXN0IGltcGxlbWVudGF0aW9uLCB3aGVyZSB3ZSBoYWQKICAgIC8vIHRvIGNoZWNrIGZvciB0aGUgZXhpc3RlbmNlIG9mIGBmaXJzdEVmZmVjdGAgdG8gc2F0aXNmeSBGbG93LiBJIHRoaW5rIHRoZQogICAgLy8gb25seSBvdGhlciByZWFzb24gdGhpcyBvcHRpbWl6YXRpb24gZXhpc3RzIGlzIGJlY2F1c2UgaXQgYWZmZWN0cyBwcm9maWxpbmcuCiAgICAvLyBSZWNvbnNpZGVyIHdoZXRoZXIgdGhpcyBpcyBuZWNlc3NhcnkuCgoKICAgIHZhciBzdWJ0cmVlSGFzRWZmZWN0cyA9IChmaW5pc2hlZFdvcmsuc3VidHJlZUZsYWdzICYgKEJlZm9yZU11dGF0aW9uTWFzayB8IE11dGF0aW9uTWFzayB8IExheW91dE1hc2sgfCBQYXNzaXZlTWFzaykpICE9PSBOb0ZsYWdzOwogICAgdmFyIHJvb3RIYXNFZmZlY3QgPSAoZmluaXNoZWRXb3JrLmZsYWdzICYgKEJlZm9yZU11dGF0aW9uTWFzayB8IE11dGF0aW9uTWFzayB8IExheW91dE1hc2sgfCBQYXNzaXZlTWFzaykpICE9PSBOb0ZsYWdzOwoKICAgIGlmIChzdWJ0cmVlSGFzRWZmZWN0cyB8fCByb290SGFzRWZmZWN0KSB7CiAgICAgIHZhciBwcmV2VHJhbnNpdGlvbiA9IFJlYWN0Q3VycmVudEJhdGNoQ29uZmlnJDMudHJhbnNpdGlvbjsKICAgICAgUmVhY3RDdXJyZW50QmF0Y2hDb25maWckMy50cmFuc2l0aW9uID0gbnVsbDsKICAgICAgdmFyIHByZXZpb3VzUHJpb3JpdHkgPSBnZXRDdXJyZW50VXBkYXRlUHJpb3JpdHkoKTsKICAgICAgc2V0Q3VycmVudFVwZGF0ZVByaW9yaXR5KERpc2NyZXRlRXZlbnRQcmlvcml0eSk7CiAgICAgIHZhciBwcmV2RXhlY3V0aW9uQ29udGV4dCA9IGV4ZWN1dGlvbkNvbnRleHQ7CiAgICAgIGV4ZWN1dGlvbkNvbnRleHQgfD0gQ29tbWl0Q29udGV4dDsgLy8gUmVzZXQgdGhpcyB0byBudWxsIGJlZm9yZSBjYWxsaW5nIGxpZmVjeWNsZXMKCiAgICAgIFJlYWN0Q3VycmVudE93bmVyJDIuY3VycmVudCA9IG51bGw7IC8vIFRoZSBjb21taXQgcGhhc2UgaXMgYnJva2VuIGludG8gc2V2ZXJhbCBzdWItcGhhc2VzLiBXZSBkbyBhIHNlcGFyYXRlIHBhc3MKICAgICAgLy8gb2YgdGhlIGVmZmVjdCBsaXN0IGZvciBlYWNoIHBoYXNlOiBhbGwgbXV0YXRpb24gZWZmZWN0cyBjb21lIGJlZm9yZSBhbGwKICAgICAgLy8gbGF5b3V0IGVmZmVjdHMsIGFuZCBzbyBvbi4KICAgICAgLy8gVGhlIGZpcnN0IHBoYXNlIGEgImJlZm9yZSBtdXRhdGlvbiIgcGhhc2UuIFdlIHVzZSB0aGlzIHBoYXNlIHRvIHJlYWQgdGhlCiAgICAgIC8vIHN0YXRlIG9mIHRoZSBob3N0IHRyZWUgcmlnaHQgYmVmb3JlIHdlIG11dGF0ZSBpdC4gVGhpcyBpcyB3aGVyZQogICAgICAvLyBnZXRTbmFwc2hvdEJlZm9yZVVwZGF0ZSBpcyBjYWxsZWQuCgogICAgICB2YXIgc2hvdWxkRmlyZUFmdGVyQWN0aXZlSW5zdGFuY2VCbHVyID0gY29tbWl0QmVmb3JlTXV0YXRpb25FZmZlY3RzKHJvb3QsIGZpbmlzaGVkV29yayk7CgogICAgICB7CiAgICAgICAgLy8gTWFyayB0aGUgY3VycmVudCBjb21taXQgdGltZSB0byBiZSBzaGFyZWQgYnkgYWxsIFByb2ZpbGVycyBpbiB0aGlzCiAgICAgICAgLy8gYmF0Y2guIFRoaXMgZW5hYmxlcyB0aGVtIHRvIGJlIGdyb3VwZWQgbGF0ZXIuCiAgICAgICAgcmVjb3JkQ29tbWl0VGltZSgpOwogICAgICB9CgoKICAgICAgY29tbWl0TXV0YXRpb25FZmZlY3RzKHJvb3QsIGZpbmlzaGVkV29yaywgbGFuZXMpOwoKICAgICAgcmVzZXRBZnRlckNvbW1pdChyb290LmNvbnRhaW5lckluZm8pOyAvLyBUaGUgd29yay1pbi1wcm9ncmVzcyB0cmVlIGlzIG5vdyB0aGUgY3VycmVudCB0cmVlLiBUaGlzIG11c3QgY29tZSBhZnRlcgogICAgICAvLyB0aGUgbXV0YXRpb24gcGhhc2UsIHNvIHRoYXQgdGhlIHByZXZpb3VzIHRyZWUgaXMgc3RpbGwgY3VycmVudCBkdXJpbmcKICAgICAgLy8gY29tcG9uZW50V2lsbFVubW91bnQsIGJ1dCBiZWZvcmUgdGhlIGxheW91dCBwaGFzZSwgc28gdGhhdCB0aGUgZmluaXNoZWQKICAgICAgLy8gd29yayBpcyBjdXJyZW50IGR1cmluZyBjb21wb25lbnREaWRNb3VudC9VcGRhdGUuCgogICAgICByb290LmN1cnJlbnQgPSBmaW5pc2hlZFdvcms7IC8vIFRoZSBuZXh0IHBoYXNlIGlzIHRoZSBsYXlvdXQgcGhhc2UsIHdoZXJlIHdlIGNhbGwgZWZmZWN0cyB0aGF0IHJlYWQKCiAgICAgIHsKICAgICAgICBtYXJrTGF5b3V0RWZmZWN0c1N0YXJ0ZWQobGFuZXMpOwogICAgICB9CgogICAgICBjb21taXRMYXlvdXRFZmZlY3RzKGZpbmlzaGVkV29yaywgcm9vdCwgbGFuZXMpOwoKICAgICAgewogICAgICAgIG1hcmtMYXlvdXRFZmZlY3RzU3RvcHBlZCgpOwogICAgICB9CiAgICAgIC8vIG9wcG9ydHVuaXR5IHRvIHBhaW50LgoKCiAgICAgIHJlcXVlc3RQYWludCgpOwogICAgICBleGVjdXRpb25Db250ZXh0ID0gcHJldkV4ZWN1dGlvbkNvbnRleHQ7IC8vIFJlc2V0IHRoZSBwcmlvcml0eSB0byB0aGUgcHJldmlvdXMgbm9uLXN5bmMgdmFsdWUuCgogICAgICBzZXRDdXJyZW50VXBkYXRlUHJpb3JpdHkocHJldmlvdXNQcmlvcml0eSk7CiAgICAgIFJlYWN0Q3VycmVudEJhdGNoQ29uZmlnJDMudHJhbnNpdGlvbiA9IHByZXZUcmFuc2l0aW9uOwogICAgfSBlbHNlIHsKICAgICAgLy8gTm8gZWZmZWN0cy4KICAgICAgcm9vdC5jdXJyZW50ID0gZmluaXNoZWRXb3JrOyAvLyBNZWFzdXJlIHRoZXNlIGFueXdheSBzbyB0aGUgZmxhbWVncmFwaCBleHBsaWNpdGx5IHNob3dzIHRoYXQgdGhlcmUgd2VyZQogICAgICAvLyBubyBlZmZlY3RzLgogICAgICAvLyBUT0RPOiBNYXliZSB0aGVyZSdzIGEgYmV0dGVyIHdheSB0byByZXBvcnQgdGhpcy4KCiAgICAgIHsKICAgICAgICByZWNvcmRDb21taXRUaW1lKCk7CiAgICAgIH0KICAgIH0KCiAgICB2YXIgcm9vdERpZEhhdmVQYXNzaXZlRWZmZWN0cyA9IHJvb3REb2VzSGF2ZVBhc3NpdmVFZmZlY3RzOwoKICAgIGlmIChyb290RG9lc0hhdmVQYXNzaXZlRWZmZWN0cykgewogICAgICAvLyBUaGlzIGNvbW1pdCBoYXMgcGFzc2l2ZSBlZmZlY3RzLiBTdGFzaCBhIHJlZmVyZW5jZSB0byB0aGVtLiBCdXQgZG9uJ3QKICAgICAgLy8gc2NoZWR1bGUgYSBjYWxsYmFjayB1bnRpbCBhZnRlciBmbHVzaGluZyBsYXlvdXQgd29yay4KICAgICAgcm9vdERvZXNIYXZlUGFzc2l2ZUVmZmVjdHMgPSBmYWxzZTsKICAgICAgcm9vdFdpdGhQZW5kaW5nUGFzc2l2ZUVmZmVjdHMgPSByb290OwogICAgICBwZW5kaW5nUGFzc2l2ZUVmZmVjdHNMYW5lcyA9IGxhbmVzOwogICAgfSBlbHNlIHsKCiAgICAgIHsKICAgICAgICBuZXN0ZWRQYXNzaXZlVXBkYXRlQ291bnQgPSAwOwogICAgICAgIHJvb3RXaXRoUGFzc2l2ZU5lc3RlZFVwZGF0ZXMgPSBudWxsOwogICAgICB9CiAgICB9IC8vIFJlYWQgdGhpcyBhZ2Fpbiwgc2luY2UgYW4gZWZmZWN0IG1pZ2h0IGhhdmUgdXBkYXRlZCBpdAoKCiAgICByZW1haW5pbmdMYW5lcyA9IHJvb3QucGVuZGluZ0xhbmVzOyAvLyBDaGVjayBpZiB0aGVyZSdzIHJlbWFpbmluZyB3b3JrIG9uIHRoaXMgcm9vdAogICAgLy8gVE9ETzogVGhpcyBpcyBwYXJ0IG9mIHRoZSBgY29tcG9uZW50RGlkQ2F0Y2hgIGltcGxlbWVudGF0aW9uLiBJdHMgcHVycG9zZQogICAgLy8gaXMgdG8gZGV0ZWN0IHdoZXRoZXIgc29tZXRoaW5nIG1pZ2h0IGhhdmUgY2FsbGVkIHNldFN0YXRlIGluc2lkZQogICAgLy8gYGNvbXBvbmVudERpZENhdGNoYC4gVGhlIG1lY2hhbmlzbSBpcyBrbm93biB0byBiZSBmbGF3ZWQgYmVjYXVzZSBgc2V0U3RhdGVgCiAgICAvLyBpbnNpZGUgYGNvbXBvbmVudERpZENhdGNoYCBpcyBpdHNlbGYgZmxhd2VkIOKAlCB0aGF0J3Mgd2h5IHdlIHJlY29tbWVuZAogICAgLy8gYGdldERlcml2ZWRTdGF0ZUZyb21FcnJvcmAgaW5zdGVhZC4gSG93ZXZlciwgaXQgY291bGQgYmUgaW1wcm92ZWQgYnkKICAgIC8vIGNoZWNraW5nIGlmIHJlbWFpbmluZ0xhbmVzIGluY2x1ZGVzIFN5bmMgd29yaywgaW5zdGVhZCBvZiB3aGV0aGVyIHRoZXJlJ3MKICAgIC8vIGFueSB3b3JrIHJlbWFpbmluZyBhdCBhbGwgKHdoaWNoIHdvdWxkIGFsc28gaW5jbHVkZSBzdHVmZiBsaWtlIFN1c3BlbnNlCiAgICAvLyByZXRyaWVzIG9yIHRyYW5zaXRpb25zKS4gSXQncyBiZWVuIGxpa2UgdGhpcyBmb3IgYSB3aGlsZSwgdGhvdWdoLCBzbyBmaXhpbmcKICAgIC8vIGl0IHByb2JhYmx5IGlzbid0IHRoYXQgdXJnZW50LgoKICAgIGlmIChyZW1haW5pbmdMYW5lcyA9PT0gTm9MYW5lcykgewogICAgICAvLyBJZiB0aGVyZSdzIG5vIHJlbWFpbmluZyB3b3JrLCB3ZSBjYW4gY2xlYXIgdGhlIHNldCBvZiBhbHJlYWR5IGZhaWxlZAogICAgICAvLyBlcnJvciBib3VuZGFyaWVzLgogICAgICBsZWdhY3lFcnJvckJvdW5kYXJpZXNUaGF0QWxyZWFkeUZhaWxlZCA9IG51bGw7CiAgICB9CgogICAgewogICAgICBpZiAoIXJvb3REaWRIYXZlUGFzc2l2ZUVmZmVjdHMpIHsKICAgICAgICBjb21taXREb3VibGVJbnZva2VFZmZlY3RzSW5ERVYocm9vdC5jdXJyZW50LCBmYWxzZSk7CiAgICAgIH0KICAgIH0KCiAgICBvbkNvbW1pdFJvb3QoZmluaXNoZWRXb3JrLnN0YXRlTm9kZSwgcmVuZGVyUHJpb3JpdHlMZXZlbCk7CgogICAgewogICAgICBpZiAoaXNEZXZUb29sc1ByZXNlbnQpIHsKICAgICAgICByb290Lm1lbW9pemVkVXBkYXRlcnMuY2xlYXIoKTsKICAgICAgfQogICAgfQoKICAgIHsKICAgICAgb25Db21taXRSb290JDEoKTsKICAgIH0gLy8gQWx3YXlzIGNhbGwgdGhpcyBiZWZvcmUgZXhpdGluZyBgY29tbWl0Um9vdGAsIHRvIGVuc3VyZSB0aGF0IGFueQogICAgLy8gYWRkaXRpb25hbCB3b3JrIG9uIHRoaXMgcm9vdCBpcyBzY2hlZHVsZWQuCgoKICAgIGVuc3VyZVJvb3RJc1NjaGVkdWxlZChyb290LCBub3coKSk7CgogICAgaWYgKHJlY292ZXJhYmxlRXJyb3JzICE9PSBudWxsKSB7CiAgICAgIC8vIFRoZXJlIHdlcmUgZXJyb3JzIGR1cmluZyB0aGlzIHJlbmRlciwgYnV0IHJlY292ZXJlZCBmcm9tIHRoZW0gd2l0aG91dAogICAgICAvLyBuZWVkaW5nIHRvIHN1cmZhY2UgaXQgdG8gdGhlIFVJLiBXZSBsb2cgdGhlbSBoZXJlLgogICAgICB2YXIgb25SZWNvdmVyYWJsZUVycm9yID0gcm9vdC5vblJlY292ZXJhYmxlRXJyb3I7CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlY292ZXJhYmxlRXJyb3JzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdmFyIHJlY292ZXJhYmxlRXJyb3IgPSByZWNvdmVyYWJsZUVycm9yc1tpXTsKICAgICAgICB2YXIgY29tcG9uZW50U3RhY2sgPSByZWNvdmVyYWJsZUVycm9yLnN0YWNrOwogICAgICAgIHZhciBkaWdlc3QgPSByZWNvdmVyYWJsZUVycm9yLmRpZ2VzdDsKICAgICAgICBvblJlY292ZXJhYmxlRXJyb3IocmVjb3ZlcmFibGVFcnJvci52YWx1ZSwgewogICAgICAgICAgY29tcG9uZW50U3RhY2s6IGNvbXBvbmVudFN0YWNrLAogICAgICAgICAgZGlnZXN0OiBkaWdlc3QKICAgICAgICB9KTsKICAgICAgfQogICAgfQoKICAgIGlmIChoYXNVbmNhdWdodEVycm9yKSB7CiAgICAgIGhhc1VuY2F1Z2h0RXJyb3IgPSBmYWxzZTsKICAgICAgdmFyIGVycm9yJDEgPSBmaXJzdFVuY2F1Z2h0RXJyb3I7CiAgICAgIGZpcnN0VW5jYXVnaHRFcnJvciA9IG51bGw7CiAgICAgIHRocm93IGVycm9yJDE7CiAgICB9IC8vIElmIHRoZSBwYXNzaXZlIGVmZmVjdHMgYXJlIHRoZSByZXN1bHQgb2YgYSBkaXNjcmV0ZSByZW5kZXIsIGZsdXNoIHRoZW0KICAgIC8vIHN5bmNocm9ub3VzbHkgYXQgdGhlIGVuZCBvZiB0aGUgY3VycmVudCB0YXNrIHNvIHRoYXQgdGhlIHJlc3VsdCBpcwogICAgLy8gaW1tZWRpYXRlbHkgb2JzZXJ2YWJsZS4gT3RoZXJ3aXNlLCB3ZSBhc3N1bWUgdGhhdCB0aGV5IGFyZSBub3QKICAgIC8vIG9yZGVyLWRlcGVuZGVudCBhbmQgZG8gbm90IG5lZWQgdG8gYmUgb2JzZXJ2ZWQgYnkgZXh0ZXJuYWwgc3lzdGVtcywgc28gd2UKICAgIC8vIGNhbiB3YWl0IHVudGlsIGFmdGVyIHBhaW50LgogICAgLy8gVE9ETzogV2UgY2FuIG9wdGltaXplIHRoaXMgYnkgbm90IHNjaGVkdWxpbmcgdGhlIGNhbGxiYWNrIGVhcmxpZXIuIFNpbmNlIHdlCiAgICAvLyBjdXJyZW50bHkgc2NoZWR1bGUgdGhlIGNhbGxiYWNrIGluIG11bHRpcGxlIHBsYWNlcywgd2lsbCB3YWl0IHVudGlsIHRob3NlCiAgICAvLyBhcmUgY29uc29saWRhdGVkLgoKCiAgICBpZiAoaW5jbHVkZXNTb21lTGFuZShwZW5kaW5nUGFzc2l2ZUVmZmVjdHNMYW5lcywgU3luY0xhbmUpICYmIHJvb3QudGFnICE9PSBMZWdhY3lSb290KSB7CiAgICAgIGZsdXNoUGFzc2l2ZUVmZmVjdHMoKTsKICAgIH0gLy8gUmVhZCB0aGlzIGFnYWluLCBzaW5jZSBhIHBhc3NpdmUgZWZmZWN0IG1pZ2h0IGhhdmUgdXBkYXRlZCBpdAoKCiAgICByZW1haW5pbmdMYW5lcyA9IHJvb3QucGVuZGluZ0xhbmVzOwoKICAgIGlmIChpbmNsdWRlc1NvbWVMYW5lKHJlbWFpbmluZ0xhbmVzLCBTeW5jTGFuZSkpIHsKICAgICAgewogICAgICAgIG1hcmtOZXN0ZWRVcGRhdGVTY2hlZHVsZWQoKTsKICAgICAgfSAvLyBDb3VudCB0aGUgbnVtYmVyIG9mIHRpbWVzIHRoZSByb290IHN5bmNocm9ub3VzbHkgcmUtcmVuZGVycyB3aXRob3V0CiAgICAgIC8vIGZpbmlzaGluZy4gSWYgdGhlcmUgYXJlIHRvbyBtYW55LCBpdCBpbmRpY2F0ZXMgYW4gaW5maW5pdGUgdXBkYXRlIGxvb3AuCgoKICAgICAgaWYgKHJvb3QgPT09IHJvb3RXaXRoTmVzdGVkVXBkYXRlcykgewogICAgICAgIG5lc3RlZFVwZGF0ZUNvdW50Kys7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbmVzdGVkVXBkYXRlQ291bnQgPSAwOwogICAgICAgIHJvb3RXaXRoTmVzdGVkVXBkYXRlcyA9IHJvb3Q7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIG5lc3RlZFVwZGF0ZUNvdW50ID0gMDsKICAgIH0gLy8gSWYgbGF5b3V0IHdvcmsgd2FzIHNjaGVkdWxlZCwgZmx1c2ggaXQgbm93LgoKCiAgICBmbHVzaFN5bmNDYWxsYmFja3MoKTsKCiAgICB7CiAgICAgIG1hcmtDb21taXRTdG9wcGVkKCk7CiAgICB9CgogICAgcmV0dXJuIG51bGw7CiAgfQoKICBmdW5jdGlvbiBmbHVzaFBhc3NpdmVFZmZlY3RzKCkgewogICAgLy8gUmV0dXJucyB3aGV0aGVyIHBhc3NpdmUgZWZmZWN0cyB3ZXJlIGZsdXNoZWQuCiAgICAvLyBUT0RPOiBDb21iaW5lIHRoaXMgY2hlY2sgd2l0aCB0aGUgb25lIGluIGZsdXNoUGFzc2l2ZUVGZmVjdHNJbXBsLiBXZSBzaG91bGQKICAgIC8vIHByb2JhYmx5IGp1c3QgY29tYmluZSB0aGUgdHdvIGZ1bmN0aW9ucy4gSSBiZWxpZXZlIHRoZXkgd2VyZSBvbmx5IHNlcGFyYXRlCiAgICAvLyBpbiB0aGUgZmlyc3QgcGxhY2UgYmVjYXVzZSB3ZSB1c2VkIHRvIHdyYXAgaXQgd2l0aAogICAgLy8gYFNjaGVkdWxlci5ydW5XaXRoUHJpb3JpdHlgLCB3aGljaCBhY2NlcHRzIGEgZnVuY3Rpb24uIEJ1dCBub3cgd2UgdHJhY2sgdGhlCiAgICAvLyBwcmlvcml0eSB3aXRoaW4gUmVhY3QgaXRzZWxmLCBzbyB3ZSBjYW4gbXV0YXRlIHRoZSB2YXJpYWJsZSBkaXJlY3RseS4KICAgIGlmIChyb290V2l0aFBlbmRpbmdQYXNzaXZlRWZmZWN0cyAhPT0gbnVsbCkgewogICAgICB2YXIgcmVuZGVyUHJpb3JpdHkgPSBsYW5lc1RvRXZlbnRQcmlvcml0eShwZW5kaW5nUGFzc2l2ZUVmZmVjdHNMYW5lcyk7CiAgICAgIHZhciBwcmlvcml0eSA9IGxvd2VyRXZlbnRQcmlvcml0eShEZWZhdWx0RXZlbnRQcmlvcml0eSwgcmVuZGVyUHJpb3JpdHkpOwogICAgICB2YXIgcHJldlRyYW5zaXRpb24gPSBSZWFjdEN1cnJlbnRCYXRjaENvbmZpZyQzLnRyYW5zaXRpb247CiAgICAgIHZhciBwcmV2aW91c1ByaW9yaXR5ID0gZ2V0Q3VycmVudFVwZGF0ZVByaW9yaXR5KCk7CgogICAgICB0cnkgewogICAgICAgIFJlYWN0Q3VycmVudEJhdGNoQ29uZmlnJDMudHJhbnNpdGlvbiA9IG51bGw7CiAgICAgICAgc2V0Q3VycmVudFVwZGF0ZVByaW9yaXR5KHByaW9yaXR5KTsKICAgICAgICByZXR1cm4gZmx1c2hQYXNzaXZlRWZmZWN0c0ltcGwoKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBzZXRDdXJyZW50VXBkYXRlUHJpb3JpdHkocHJldmlvdXNQcmlvcml0eSk7CiAgICAgICAgUmVhY3RDdXJyZW50QmF0Y2hDb25maWckMy50cmFuc2l0aW9uID0gcHJldlRyYW5zaXRpb247IC8vIE9uY2UgcGFzc2l2ZSBlZmZlY3RzIGhhdmUgcnVuIGZvciB0aGUgdHJlZSAtIGdpdmluZyBjb21wb25lbnRzIGEKICAgICAgfQogICAgfQoKICAgIHJldHVybiBmYWxzZTsKICB9CiAgZnVuY3Rpb24gZW5xdWV1ZVBlbmRpbmdQYXNzaXZlUHJvZmlsZXJFZmZlY3QoZmliZXIpIHsKICAgIHsKICAgICAgcGVuZGluZ1Bhc3NpdmVQcm9maWxlckVmZmVjdHMucHVzaChmaWJlcik7CgogICAgICBpZiAoIXJvb3REb2VzSGF2ZVBhc3NpdmVFZmZlY3RzKSB7CiAgICAgICAgcm9vdERvZXNIYXZlUGFzc2l2ZUVmZmVjdHMgPSB0cnVlOwogICAgICAgIHNjaGVkdWxlQ2FsbGJhY2skMShOb3JtYWxQcmlvcml0eSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgZmx1c2hQYXNzaXZlRWZmZWN0cygpOwogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIGZsdXNoUGFzc2l2ZUVmZmVjdHNJbXBsKCkgewogICAgaWYgKHJvb3RXaXRoUGVuZGluZ1Bhc3NpdmVFZmZlY3RzID09PSBudWxsKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0gLy8gQ2FjaGUgYW5kIGNsZWFyIHRoZSB0cmFuc2l0aW9ucyBmbGFnCgoKICAgIHZhciB0cmFuc2l0aW9ucyA9IHBlbmRpbmdQYXNzaXZlVHJhbnNpdGlvbnM7CiAgICBwZW5kaW5nUGFzc2l2ZVRyYW5zaXRpb25zID0gbnVsbDsKICAgIHZhciByb290ID0gcm9vdFdpdGhQZW5kaW5nUGFzc2l2ZUVmZmVjdHM7CiAgICB2YXIgbGFuZXMgPSBwZW5kaW5nUGFzc2l2ZUVmZmVjdHNMYW5lczsKICAgIHJvb3RXaXRoUGVuZGluZ1Bhc3NpdmVFZmZlY3RzID0gbnVsbDsgLy8gVE9ETzogVGhpcyBpcyBzb21ldGltZXMgb3V0IG9mIHN5bmMgd2l0aCByb290V2l0aFBlbmRpbmdQYXNzaXZlRWZmZWN0cy4KICAgIC8vIEZpZ3VyZSBvdXQgd2h5IGFuZCBmaXggaXQuIEl0J3Mgbm90IGNhdXNpbmcgYW55IGtub3duIGlzc3VlcyAocHJvYmFibHkKICAgIC8vIGJlY2F1c2UgaXQncyBvbmx5IHVzZWQgZm9yIHByb2ZpbGluZyksIGJ1dCBpdCdzIGEgcmVmYWN0b3IgaGF6YXJkLgoKICAgIHBlbmRpbmdQYXNzaXZlRWZmZWN0c0xhbmVzID0gTm9MYW5lczsKCiAgICBpZiAoKGV4ZWN1dGlvbkNvbnRleHQgJiAoUmVuZGVyQ29udGV4dCB8IENvbW1pdENvbnRleHQpKSAhPT0gTm9Db250ZXh0KSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IGZsdXNoIHBhc3NpdmUgZWZmZWN0cyB3aGlsZSBhbHJlYWR5IHJlbmRlcmluZy4nKTsKICAgIH0KCiAgICB7CiAgICAgIGlzRmx1c2hpbmdQYXNzaXZlRWZmZWN0cyA9IHRydWU7CiAgICAgIGRpZFNjaGVkdWxlVXBkYXRlRHVyaW5nUGFzc2l2ZUVmZmVjdHMgPSBmYWxzZTsKICAgIH0KCiAgICB7CiAgICAgIG1hcmtQYXNzaXZlRWZmZWN0c1N0YXJ0ZWQobGFuZXMpOwogICAgfQoKICAgIHZhciBwcmV2RXhlY3V0aW9uQ29udGV4dCA9IGV4ZWN1dGlvbkNvbnRleHQ7CiAgICBleGVjdXRpb25Db250ZXh0IHw9IENvbW1pdENvbnRleHQ7CiAgICBjb21taXRQYXNzaXZlVW5tb3VudEVmZmVjdHMocm9vdC5jdXJyZW50KTsKICAgIGNvbW1pdFBhc3NpdmVNb3VudEVmZmVjdHMocm9vdCwgcm9vdC5jdXJyZW50LCBsYW5lcywgdHJhbnNpdGlvbnMpOyAvLyBUT0RPOiBNb3ZlIHRvIGNvbW1pdFBhc3NpdmVNb3VudEVmZmVjdHMKCiAgICB7CiAgICAgIHZhciBwcm9maWxlckVmZmVjdHMgPSBwZW5kaW5nUGFzc2l2ZVByb2ZpbGVyRWZmZWN0czsKICAgICAgcGVuZGluZ1Bhc3NpdmVQcm9maWxlckVmZmVjdHMgPSBbXTsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvZmlsZXJFZmZlY3RzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdmFyIF9maWJlciA9IHByb2ZpbGVyRWZmZWN0c1tpXTsKICAgICAgICBjb21taXRQYXNzaXZlRWZmZWN0RHVyYXRpb25zKHJvb3QsIF9maWJlcik7CiAgICAgIH0KICAgIH0KCiAgICB7CiAgICAgIG1hcmtQYXNzaXZlRWZmZWN0c1N0b3BwZWQoKTsKICAgIH0KCiAgICB7CiAgICAgIGNvbW1pdERvdWJsZUludm9rZUVmZmVjdHNJbkRFVihyb290LmN1cnJlbnQsIHRydWUpOwogICAgfQoKICAgIGV4ZWN1dGlvbkNvbnRleHQgPSBwcmV2RXhlY3V0aW9uQ29udGV4dDsKICAgIGZsdXNoU3luY0NhbGxiYWNrcygpOwoKICAgIHsKICAgICAgLy8gSWYgYWRkaXRpb25hbCBwYXNzaXZlIGVmZmVjdHMgd2VyZSBzY2hlZHVsZWQsIGluY3JlbWVudCBhIGNvdW50ZXIuIElmIHRoaXMKICAgICAgLy8gZXhjZWVkcyB0aGUgbGltaXQsIHdlJ2xsIGZpcmUgYSB3YXJuaW5nLgogICAgICBpZiAoZGlkU2NoZWR1bGVVcGRhdGVEdXJpbmdQYXNzaXZlRWZmZWN0cykgewogICAgICAgIGlmIChyb290ID09PSByb290V2l0aFBhc3NpdmVOZXN0ZWRVcGRhdGVzKSB7CiAgICAgICAgICBuZXN0ZWRQYXNzaXZlVXBkYXRlQ291bnQrKzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgbmVzdGVkUGFzc2l2ZVVwZGF0ZUNvdW50ID0gMDsKICAgICAgICAgIHJvb3RXaXRoUGFzc2l2ZU5lc3RlZFVwZGF0ZXMgPSByb290OwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBuZXN0ZWRQYXNzaXZlVXBkYXRlQ291bnQgPSAwOwogICAgICB9CgogICAgICBpc0ZsdXNoaW5nUGFzc2l2ZUVmZmVjdHMgPSBmYWxzZTsKICAgICAgZGlkU2NoZWR1bGVVcGRhdGVEdXJpbmdQYXNzaXZlRWZmZWN0cyA9IGZhbHNlOwogICAgfSAvLyBUT0RPOiBNb3ZlIHRvIGNvbW1pdFBhc3NpdmVNb3VudEVmZmVjdHMKCgogICAgb25Qb3N0Q29tbWl0Um9vdChyb290KTsKCiAgICB7CiAgICAgIHZhciBzdGF0ZU5vZGUgPSByb290LmN1cnJlbnQuc3RhdGVOb2RlOwogICAgICBzdGF0ZU5vZGUuZWZmZWN0RHVyYXRpb24gPSAwOwogICAgICBzdGF0ZU5vZGUucGFzc2l2ZUVmZmVjdER1cmF0aW9uID0gMDsKICAgIH0KCiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGZ1bmN0aW9uIGlzQWxyZWFkeUZhaWxlZExlZ2FjeUVycm9yQm91bmRhcnkoaW5zdGFuY2UpIHsKICAgIHJldHVybiBsZWdhY3lFcnJvckJvdW5kYXJpZXNUaGF0QWxyZWFkeUZhaWxlZCAhPT0gbnVsbCAmJiBsZWdhY3lFcnJvckJvdW5kYXJpZXNUaGF0QWxyZWFkeUZhaWxlZC5oYXMoaW5zdGFuY2UpOwogIH0KICBmdW5jdGlvbiBtYXJrTGVnYWN5RXJyb3JCb3VuZGFyeUFzRmFpbGVkKGluc3RhbmNlKSB7CiAgICBpZiAobGVnYWN5RXJyb3JCb3VuZGFyaWVzVGhhdEFscmVhZHlGYWlsZWQgPT09IG51bGwpIHsKICAgICAgbGVnYWN5RXJyb3JCb3VuZGFyaWVzVGhhdEFscmVhZHlGYWlsZWQgPSBuZXcgU2V0KFtpbnN0YW5jZV0pOwogICAgfSBlbHNlIHsKICAgICAgbGVnYWN5RXJyb3JCb3VuZGFyaWVzVGhhdEFscmVhZHlGYWlsZWQuYWRkKGluc3RhbmNlKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHByZXBhcmVUb1Rocm93VW5jYXVnaHRFcnJvcihlcnJvcikgewogICAgaWYgKCFoYXNVbmNhdWdodEVycm9yKSB7CiAgICAgIGhhc1VuY2F1Z2h0RXJyb3IgPSB0cnVlOwogICAgICBmaXJzdFVuY2F1Z2h0RXJyb3IgPSBlcnJvcjsKICAgIH0KICB9CgogIHZhciBvblVuY2F1Z2h0RXJyb3IgPSBwcmVwYXJlVG9UaHJvd1VuY2F1Z2h0RXJyb3I7CgogIGZ1bmN0aW9uIGNhcHR1cmVDb21taXRQaGFzZUVycm9yT25Sb290KHJvb3RGaWJlciwgc291cmNlRmliZXIsIGVycm9yKSB7CiAgICB2YXIgZXJyb3JJbmZvID0gY3JlYXRlQ2FwdHVyZWRWYWx1ZUF0RmliZXIoZXJyb3IsIHNvdXJjZUZpYmVyKTsKICAgIHZhciB1cGRhdGUgPSBjcmVhdGVSb290RXJyb3JVcGRhdGUocm9vdEZpYmVyLCBlcnJvckluZm8sIFN5bmNMYW5lKTsKICAgIHZhciByb290ID0gZW5xdWV1ZVVwZGF0ZShyb290RmliZXIsIHVwZGF0ZSwgU3luY0xhbmUpOwogICAgdmFyIGV2ZW50VGltZSA9IHJlcXVlc3RFdmVudFRpbWUoKTsKCiAgICBpZiAocm9vdCAhPT0gbnVsbCkgewogICAgICBtYXJrUm9vdFVwZGF0ZWQocm9vdCwgU3luY0xhbmUsIGV2ZW50VGltZSk7CiAgICAgIGVuc3VyZVJvb3RJc1NjaGVkdWxlZChyb290LCBldmVudFRpbWUpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gY2FwdHVyZUNvbW1pdFBoYXNlRXJyb3Ioc291cmNlRmliZXIsIG5lYXJlc3RNb3VudGVkQW5jZXN0b3IsIGVycm9yJDEpIHsKICAgIHsKICAgICAgcmVwb3J0VW5jYXVnaHRFcnJvckluREVWKGVycm9yJDEpOwogICAgICBzZXRJc1J1bm5pbmdJbnNlcnRpb25FZmZlY3QoZmFsc2UpOwogICAgfQoKICAgIGlmIChzb3VyY2VGaWJlci50YWcgPT09IEhvc3RSb290KSB7CiAgICAgIC8vIEVycm9yIHdhcyB0aHJvd24gYXQgdGhlIHJvb3QuIFRoZXJlIGlzIG5vIHBhcmVudCwgc28gdGhlIHJvb3QKICAgICAgLy8gaXRzZWxmIHNob3VsZCBjYXB0dXJlIGl0LgogICAgICBjYXB0dXJlQ29tbWl0UGhhc2VFcnJvck9uUm9vdChzb3VyY2VGaWJlciwgc291cmNlRmliZXIsIGVycm9yJDEpOwogICAgICByZXR1cm47CiAgICB9CgogICAgdmFyIGZpYmVyID0gbnVsbDsKCiAgICB7CiAgICAgIGZpYmVyID0gbmVhcmVzdE1vdW50ZWRBbmNlc3RvcjsKICAgIH0KCiAgICB3aGlsZSAoZmliZXIgIT09IG51bGwpIHsKICAgICAgaWYgKGZpYmVyLnRhZyA9PT0gSG9zdFJvb3QpIHsKICAgICAgICBjYXB0dXJlQ29tbWl0UGhhc2VFcnJvck9uUm9vdChmaWJlciwgc291cmNlRmliZXIsIGVycm9yJDEpOwogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIGlmIChmaWJlci50YWcgPT09IENsYXNzQ29tcG9uZW50KSB7CiAgICAgICAgdmFyIGN0b3IgPSBmaWJlci50eXBlOwogICAgICAgIHZhciBpbnN0YW5jZSA9IGZpYmVyLnN0YXRlTm9kZTsKCiAgICAgICAgaWYgKHR5cGVvZiBjdG9yLmdldERlcml2ZWRTdGF0ZUZyb21FcnJvciA9PT0gJ2Z1bmN0aW9uJyB8fCB0eXBlb2YgaW5zdGFuY2UuY29tcG9uZW50RGlkQ2F0Y2ggPT09ICdmdW5jdGlvbicgJiYgIWlzQWxyZWFkeUZhaWxlZExlZ2FjeUVycm9yQm91bmRhcnkoaW5zdGFuY2UpKSB7CiAgICAgICAgICB2YXIgZXJyb3JJbmZvID0gY3JlYXRlQ2FwdHVyZWRWYWx1ZUF0RmliZXIoZXJyb3IkMSwgc291cmNlRmliZXIpOwogICAgICAgICAgdmFyIHVwZGF0ZSA9IGNyZWF0ZUNsYXNzRXJyb3JVcGRhdGUoZmliZXIsIGVycm9ySW5mbywgU3luY0xhbmUpOwogICAgICAgICAgdmFyIHJvb3QgPSBlbnF1ZXVlVXBkYXRlKGZpYmVyLCB1cGRhdGUsIFN5bmNMYW5lKTsKICAgICAgICAgIHZhciBldmVudFRpbWUgPSByZXF1ZXN0RXZlbnRUaW1lKCk7CgogICAgICAgICAgaWYgKHJvb3QgIT09IG51bGwpIHsKICAgICAgICAgICAgbWFya1Jvb3RVcGRhdGVkKHJvb3QsIFN5bmNMYW5lLCBldmVudFRpbWUpOwogICAgICAgICAgICBlbnN1cmVSb290SXNTY2hlZHVsZWQocm9vdCwgZXZlbnRUaW1lKTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9CgogICAgICBmaWJlciA9IGZpYmVyLnJldHVybjsKICAgIH0KCiAgICB7CiAgICAgIC8vIFRPRE86IFVudGlsIHdlIHJlLWxhbmQgc2tpcFVubW91bnRlZEJvdW5kYXJpZXMgKHNlZSAjMjAxNDcpLCB0aGlzIHdhcm5pbmcKICAgICAgLy8gd2lsbCBmaXJlIGZvciBlcnJvcnMgdGhhdCBhcmUgdGhyb3duIGJ5IGRlc3Ryb3kgZnVuY3Rpb25zIGluc2lkZSBkZWxldGVkCiAgICAgIC8vIHRyZWVzLiBXaGF0IGl0IHNob3VsZCBpbnN0ZWFkIGRvIGlzIHByb3BhZ2F0ZSB0aGUgZXJyb3IgdG8gdGhlIHBhcmVudCBvZgogICAgICAvLyB0aGUgZGVsZXRlZCB0cmVlLiBJbiB0aGUgbWVhbnRpbWUsIGRvIG5vdCBhZGQgdGhpcyB3YXJuaW5nIHRvIHRoZQogICAgICAvLyBhbGxvd2xpc3Q7IHRoaXMgaXMgb25seSBmb3Igb3VyIGludGVybmFsIHVzZS4KICAgICAgZXJyb3IoJ0ludGVybmFsIFJlYWN0IGVycm9yOiBBdHRlbXB0ZWQgdG8gY2FwdHVyZSBhIGNvbW1pdCBwaGFzZSBlcnJvciAnICsgJ2luc2lkZSBhIGRldGFjaGVkIHRyZWUuIFRoaXMgaW5kaWNhdGVzIGEgYnVnIGluIFJlYWN0LiBMaWtlbHkgJyArICdjYXVzZXMgaW5jbHVkZSBkZWxldGluZyB0aGUgc2FtZSBmaWJlciBtb3JlIHRoYW4gb25jZSwgY29tbWl0dGluZyBhbiAnICsgJ2FscmVhZHktZmluaXNoZWQgdHJlZSwgb3IgYW4gaW5jb25zaXN0ZW50IHJldHVybiBwb2ludGVyLlxuXG4nICsgJ0Vycm9yIG1lc3NhZ2U6XG5cbiVzJywgZXJyb3IkMSk7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHBpbmdTdXNwZW5kZWRSb290KHJvb3QsIHdha2VhYmxlLCBwaW5nZWRMYW5lcykgewogICAgdmFyIHBpbmdDYWNoZSA9IHJvb3QucGluZ0NhY2hlOwoKICAgIGlmIChwaW5nQ2FjaGUgIT09IG51bGwpIHsKICAgICAgLy8gVGhlIHdha2VhYmxlIHJlc29sdmVkLCBzbyB3ZSBubyBsb25nZXIgbmVlZCB0byBtZW1vaXplLCBiZWNhdXNlIGl0IHdpbGwKICAgICAgLy8gbmV2ZXIgYmUgdGhyb3duIGFnYWluLgogICAgICBwaW5nQ2FjaGUuZGVsZXRlKHdha2VhYmxlKTsKICAgIH0KCiAgICB2YXIgZXZlbnRUaW1lID0gcmVxdWVzdEV2ZW50VGltZSgpOwogICAgbWFya1Jvb3RQaW5nZWQocm9vdCwgcGluZ2VkTGFuZXMpOwogICAgd2FybklmU3VzcGVuc2VSZXNvbHV0aW9uTm90V3JhcHBlZFdpdGhBY3RERVYocm9vdCk7CgogICAgaWYgKHdvcmtJblByb2dyZXNzUm9vdCA9PT0gcm9vdCAmJiBpc1N1YnNldE9mTGFuZXMod29ya0luUHJvZ3Jlc3NSb290UmVuZGVyTGFuZXMsIHBpbmdlZExhbmVzKSkgewogICAgICAvLyBSZWNlaXZlZCBhIHBpbmcgYXQgdGhlIHNhbWUgcHJpb3JpdHkgbGV2ZWwgYXQgd2hpY2ggd2UncmUgY3VycmVudGx5CiAgICAgIC8vIHJlbmRlcmluZy4gV2UgbWlnaHQgd2FudCB0byByZXN0YXJ0IHRoaXMgcmVuZGVyLiBUaGlzIHNob3VsZCBtaXJyb3IKICAgICAgLy8gdGhlIGxvZ2ljIG9mIHdoZXRoZXIgb3Igbm90IGEgcm9vdCBzdXNwZW5kcyBvbmNlIGl0IGNvbXBsZXRlcy4KICAgICAgLy8gVE9ETzogSWYgd2UncmUgcmVuZGVyaW5nIHN5bmMgZWl0aGVyIGR1ZSB0byBTeW5jLCBCYXRjaGVkIG9yIGV4cGlyZWQsCiAgICAgIC8vIHdlIHNob3VsZCBwcm9iYWJseSBuZXZlciByZXN0YXJ0LgogICAgICAvLyBJZiB3ZSdyZSBzdXNwZW5kZWQgd2l0aCBkZWxheSwgb3IgaWYgaXQncyBhIHJldHJ5LCB3ZSdsbCBhbHdheXMgc3VzcGVuZAogICAgICAvLyBzbyB3ZSBjYW4gYWx3YXlzIHJlc3RhcnQuCiAgICAgIGlmICh3b3JrSW5Qcm9ncmVzc1Jvb3RFeGl0U3RhdHVzID09PSBSb290U3VzcGVuZGVkV2l0aERlbGF5IHx8IHdvcmtJblByb2dyZXNzUm9vdEV4aXRTdGF0dXMgPT09IFJvb3RTdXNwZW5kZWQgJiYgaW5jbHVkZXNPbmx5UmV0cmllcyh3b3JrSW5Qcm9ncmVzc1Jvb3RSZW5kZXJMYW5lcykgJiYgbm93KCkgLSBnbG9iYWxNb3N0UmVjZW50RmFsbGJhY2tUaW1lIDwgRkFMTEJBQ0tfVEhST1RUTEVfTVMpIHsKICAgICAgICAvLyBSZXN0YXJ0IGZyb20gdGhlIHJvb3QuCiAgICAgICAgcHJlcGFyZUZyZXNoU3RhY2socm9vdCwgTm9MYW5lcyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gRXZlbiB0aG91Z2ggd2UgY2FuJ3QgcmVzdGFydCByaWdodCBub3csIHdlIG1pZ2h0IGdldCBhbgogICAgICAgIC8vIG9wcG9ydHVuaXR5IGxhdGVyLiBTbyB3ZSBtYXJrIHRoaXMgcmVuZGVyIGFzIGhhdmluZyBhIHBpbmcuCiAgICAgICAgd29ya0luUHJvZ3Jlc3NSb290UGluZ2VkTGFuZXMgPSBtZXJnZUxhbmVzKHdvcmtJblByb2dyZXNzUm9vdFBpbmdlZExhbmVzLCBwaW5nZWRMYW5lcyk7CiAgICAgIH0KICAgIH0KCiAgICBlbnN1cmVSb290SXNTY2hlZHVsZWQocm9vdCwgZXZlbnRUaW1lKTsKICB9CgogIGZ1bmN0aW9uIHJldHJ5VGltZWRPdXRCb3VuZGFyeShib3VuZGFyeUZpYmVyLCByZXRyeUxhbmUpIHsKICAgIC8vIFRoZSBib3VuZGFyeSBmaWJlciAoYSBTdXNwZW5zZSBjb21wb25lbnQgb3IgU3VzcGVuc2VMaXN0IGNvbXBvbmVudCkKICAgIC8vIHByZXZpb3VzbHkgd2FzIHJlbmRlcmVkIGluIGl0cyBmYWxsYmFjayBzdGF0ZS4gT25lIG9mIHRoZSBwcm9taXNlcyB0aGF0CiAgICAvLyBzdXNwZW5kZWQgaXQgaGFzIHJlc29sdmVkLCB3aGljaCBtZWFucyBhdCBsZWFzdCBwYXJ0IG9mIHRoZSB0cmVlIHdhcwogICAgLy8gbGlrZWx5IHVuYmxvY2tlZC4gVHJ5IHJlbmRlcmluZyBhZ2FpbiwgYXQgYSBuZXcgbGFuZXMuCiAgICBpZiAocmV0cnlMYW5lID09PSBOb0xhbmUpIHsKICAgICAgLy8gVE9ETzogQXNzaWduIHRoaXMgdG8gYHN1c3BlbnNlU3RhdGUucmV0cnlMYW5lYD8gdG8gYXZvaWQKICAgICAgLy8gdW5uZWNlc3NhcnkgZW50YW5nbGVtZW50PwogICAgICByZXRyeUxhbmUgPSByZXF1ZXN0UmV0cnlMYW5lKGJvdW5kYXJ5RmliZXIpOwogICAgfSAvLyBUT0RPOiBTcGVjaWFsIGNhc2UgaWRsZSBwcmlvcml0eT8KCgogICAgdmFyIGV2ZW50VGltZSA9IHJlcXVlc3RFdmVudFRpbWUoKTsKICAgIHZhciByb290ID0gZW5xdWV1ZUNvbmN1cnJlbnRSZW5kZXJGb3JMYW5lKGJvdW5kYXJ5RmliZXIsIHJldHJ5TGFuZSk7CgogICAgaWYgKHJvb3QgIT09IG51bGwpIHsKICAgICAgbWFya1Jvb3RVcGRhdGVkKHJvb3QsIHJldHJ5TGFuZSwgZXZlbnRUaW1lKTsKICAgICAgZW5zdXJlUm9vdElzU2NoZWR1bGVkKHJvb3QsIGV2ZW50VGltZSk7CiAgICB9CiAgfQoKICBmdW5jdGlvbiByZXRyeURlaHlkcmF0ZWRTdXNwZW5zZUJvdW5kYXJ5KGJvdW5kYXJ5RmliZXIpIHsKICAgIHZhciBzdXNwZW5zZVN0YXRlID0gYm91bmRhcnlGaWJlci5tZW1vaXplZFN0YXRlOwogICAgdmFyIHJldHJ5TGFuZSA9IE5vTGFuZTsKCiAgICBpZiAoc3VzcGVuc2VTdGF0ZSAhPT0gbnVsbCkgewogICAgICByZXRyeUxhbmUgPSBzdXNwZW5zZVN0YXRlLnJldHJ5TGFuZTsKICAgIH0KCiAgICByZXRyeVRpbWVkT3V0Qm91bmRhcnkoYm91bmRhcnlGaWJlciwgcmV0cnlMYW5lKTsKICB9CiAgZnVuY3Rpb24gcmVzb2x2ZVJldHJ5V2FrZWFibGUoYm91bmRhcnlGaWJlciwgd2FrZWFibGUpIHsKICAgIHZhciByZXRyeUxhbmUgPSBOb0xhbmU7IC8vIERlZmF1bHQKCiAgICB2YXIgcmV0cnlDYWNoZTsKCiAgICBzd2l0Y2ggKGJvdW5kYXJ5RmliZXIudGFnKSB7CiAgICAgIGNhc2UgU3VzcGVuc2VDb21wb25lbnQ6CiAgICAgICAgcmV0cnlDYWNoZSA9IGJvdW5kYXJ5RmliZXIuc3RhdGVOb2RlOwogICAgICAgIHZhciBzdXNwZW5zZVN0YXRlID0gYm91bmRhcnlGaWJlci5tZW1vaXplZFN0YXRlOwoKICAgICAgICBpZiAoc3VzcGVuc2VTdGF0ZSAhPT0gbnVsbCkgewogICAgICAgICAgcmV0cnlMYW5lID0gc3VzcGVuc2VTdGF0ZS5yZXRyeUxhbmU7CiAgICAgICAgfQoKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgU3VzcGVuc2VMaXN0Q29tcG9uZW50OgogICAgICAgIHJldHJ5Q2FjaGUgPSBib3VuZGFyeUZpYmVyLnN0YXRlTm9kZTsKICAgICAgICBicmVhazsKCiAgICAgIGRlZmF1bHQ6CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdQaW5nZWQgdW5rbm93biBzdXNwZW5zZSBib3VuZGFyeSB0eXBlLiAnICsgJ1RoaXMgaXMgcHJvYmFibHkgYSBidWcgaW4gUmVhY3QuJyk7CiAgICB9CgogICAgaWYgKHJldHJ5Q2FjaGUgIT09IG51bGwpIHsKICAgICAgLy8gVGhlIHdha2VhYmxlIHJlc29sdmVkLCBzbyB3ZSBubyBsb25nZXIgbmVlZCB0byBtZW1vaXplLCBiZWNhdXNlIGl0IHdpbGwKICAgICAgLy8gbmV2ZXIgYmUgdGhyb3duIGFnYWluLgogICAgICByZXRyeUNhY2hlLmRlbGV0ZSh3YWtlYWJsZSk7CiAgICB9CgogICAgcmV0cnlUaW1lZE91dEJvdW5kYXJ5KGJvdW5kYXJ5RmliZXIsIHJldHJ5TGFuZSk7CiAgfSAvLyBDb21wdXRlcyB0aGUgbmV4dCBKdXN0IE5vdGljZWFibGUgRGlmZmVyZW5jZSAoSk5EKSBib3VuZGFyeS4KICAvLyBUaGUgdGhlb3J5IGlzIHRoYXQgYSBwZXJzb24gY2FuJ3QgdGVsbCB0aGUgZGlmZmVyZW5jZSBiZXR3ZWVuIHNtYWxsIGRpZmZlcmVuY2VzIGluIHRpbWUuCiAgLy8gVGhlcmVmb3JlLCBpZiB3ZSB3YWl0IGEgYml0IGxvbmdlciB0aGFuIG5lY2Vzc2FyeSB0aGF0IHdvbid0IHRyYW5zbGF0ZSB0byBhIG5vdGljZWFibGUKICAvLyBkaWZmZXJlbmNlIGluIHRoZSBleHBlcmllbmNlLiBIb3dldmVyLCB3YWl0aW5nIGZvciBsb25nZXIgbWlnaHQgbWVhbiB0aGF0IHdlIGNhbiBhdm9pZAogIC8vIHNob3dpbmcgYW4gaW50ZXJtZWRpYXRlIGxvYWRpbmcgc3RhdGUuIFRoZSBsb25nZXIgd2UgaGF2ZSBhbHJlYWR5IHdhaXRlZCwgdGhlIGhhcmRlciBpdAogIC8vIGlzIHRvIHRlbGwgc21hbGwgZGlmZmVyZW5jZXMgaW4gdGltZS4gVGhlcmVmb3JlLCB0aGUgbG9uZ2VyIHdlJ3ZlIGFscmVhZHkgd2FpdGVkLAogIC8vIHRoZSBsb25nZXIgd2UgY2FuIHdhaXQgYWRkaXRpb25hbGx5LiBBdCBzb21lIHBvaW50IHdlIGhhdmUgdG8gZ2l2ZSB1cCB0aG91Z2guCiAgLy8gV2UgcGljayBhIHRyYWluIG1vZGVsIHdoZXJlIHRoZSBuZXh0IGJvdW5kYXJ5IGNvbW1pdHMgYXQgYSBjb25zaXN0ZW50IHNjaGVkdWxlLgogIC8vIFRoZXNlIHBhcnRpY3VsYXIgbnVtYmVycyBhcmUgdmFndWUgZXN0aW1hdGVzLiBXZSBleHBlY3QgdG8gYWRqdXN0IHRoZW0gYmFzZWQgb24gcmVzZWFyY2guCgogIGZ1bmN0aW9uIGpuZCh0aW1lRWxhcHNlZCkgewogICAgcmV0dXJuIHRpbWVFbGFwc2VkIDwgMTIwID8gMTIwIDogdGltZUVsYXBzZWQgPCA0ODAgPyA0ODAgOiB0aW1lRWxhcHNlZCA8IDEwODAgPyAxMDgwIDogdGltZUVsYXBzZWQgPCAxOTIwID8gMTkyMCA6IHRpbWVFbGFwc2VkIDwgMzAwMCA/IDMwMDAgOiB0aW1lRWxhcHNlZCA8IDQzMjAgPyA0MzIwIDogY2VpbCh0aW1lRWxhcHNlZCAvIDE5NjApICogMTk2MDsKICB9CgogIGZ1bmN0aW9uIGNoZWNrRm9yTmVzdGVkVXBkYXRlcygpIHsKICAgIGlmIChuZXN0ZWRVcGRhdGVDb3VudCA+IE5FU1RFRF9VUERBVEVfTElNSVQpIHsKICAgICAgbmVzdGVkVXBkYXRlQ291bnQgPSAwOwogICAgICByb290V2l0aE5lc3RlZFVwZGF0ZXMgPSBudWxsOwogICAgICB0aHJvdyBuZXcgRXJyb3IoJ01heGltdW0gdXBkYXRlIGRlcHRoIGV4Y2VlZGVkLiBUaGlzIGNhbiBoYXBwZW4gd2hlbiBhIGNvbXBvbmVudCAnICsgJ3JlcGVhdGVkbHkgY2FsbHMgc2V0U3RhdGUgaW5zaWRlIGNvbXBvbmVudFdpbGxVcGRhdGUgb3IgJyArICdjb21wb25lbnREaWRVcGRhdGUuIFJlYWN0IGxpbWl0cyB0aGUgbnVtYmVyIG9mIG5lc3RlZCB1cGRhdGVzIHRvICcgKyAncHJldmVudCBpbmZpbml0ZSBsb29wcy4nKTsKICAgIH0KCiAgICB7CiAgICAgIGlmIChuZXN0ZWRQYXNzaXZlVXBkYXRlQ291bnQgPiBORVNURURfUEFTU0lWRV9VUERBVEVfTElNSVQpIHsKICAgICAgICBuZXN0ZWRQYXNzaXZlVXBkYXRlQ291bnQgPSAwOwogICAgICAgIHJvb3RXaXRoUGFzc2l2ZU5lc3RlZFVwZGF0ZXMgPSBudWxsOwoKICAgICAgICBlcnJvcignTWF4aW11bSB1cGRhdGUgZGVwdGggZXhjZWVkZWQuIFRoaXMgY2FuIGhhcHBlbiB3aGVuIGEgY29tcG9uZW50ICcgKyAiY2FsbHMgc2V0U3RhdGUgaW5zaWRlIHVzZUVmZmVjdCwgYnV0IHVzZUVmZmVjdCBlaXRoZXIgZG9lc24ndCAiICsgJ2hhdmUgYSBkZXBlbmRlbmN5IGFycmF5LCBvciBvbmUgb2YgdGhlIGRlcGVuZGVuY2llcyBjaGFuZ2VzIG9uICcgKyAnZXZlcnkgcmVuZGVyLicpOwogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiBmbHVzaFJlbmRlclBoYXNlU3RyaWN0TW9kZVdhcm5pbmdzSW5ERVYoKSB7CiAgICB7CiAgICAgIFJlYWN0U3RyaWN0TW9kZVdhcm5pbmdzLmZsdXNoTGVnYWN5Q29udGV4dFdhcm5pbmcoKTsKCiAgICAgIHsKICAgICAgICBSZWFjdFN0cmljdE1vZGVXYXJuaW5ncy5mbHVzaFBlbmRpbmdVbnNhZmVMaWZlY3ljbGVXYXJuaW5ncygpOwogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiBjb21taXREb3VibGVJbnZva2VFZmZlY3RzSW5ERVYoZmliZXIsIGhhc1Bhc3NpdmVFZmZlY3RzKSB7CiAgICB7CiAgICAgIC8vIFRPRE8gKFN0cmljdEVmZmVjdHMpIFNob3VsZCB3ZSBzZXQgYSBtYXJrZXIgb24gdGhlIHJvb3QgaWYgaXQgY29udGFpbnMgc3RyaWN0IGVmZmVjdHMKICAgICAgLy8gc28gd2UgZG9uJ3QgdHJhdmVyc2UgdW5uZWNlc3NhcmlseT8gc2ltaWxhciB0byBzdWJ0cmVlRmxhZ3MgYnV0IGp1c3QgYXQgdGhlIHJvb3QgbGV2ZWwuCiAgICAgIC8vIE1heWJlIG5vdCBhIGJpZyBkZWFsIHNpbmNlIHRoaXMgaXMgREVWIG9ubHkgYmVoYXZpb3IuCiAgICAgIHNldEN1cnJlbnRGaWJlcihmaWJlcik7CiAgICAgIGludm9rZUVmZmVjdHNJbkRldihmaWJlciwgTW91bnRMYXlvdXREZXYsIGludm9rZUxheW91dEVmZmVjdFVubW91bnRJbkRFVik7CgogICAgICBpZiAoaGFzUGFzc2l2ZUVmZmVjdHMpIHsKICAgICAgICBpbnZva2VFZmZlY3RzSW5EZXYoZmliZXIsIE1vdW50UGFzc2l2ZURldiwgaW52b2tlUGFzc2l2ZUVmZmVjdFVubW91bnRJbkRFVik7CiAgICAgIH0KCiAgICAgIGludm9rZUVmZmVjdHNJbkRldihmaWJlciwgTW91bnRMYXlvdXREZXYsIGludm9rZUxheW91dEVmZmVjdE1vdW50SW5ERVYpOwoKICAgICAgaWYgKGhhc1Bhc3NpdmVFZmZlY3RzKSB7CiAgICAgICAgaW52b2tlRWZmZWN0c0luRGV2KGZpYmVyLCBNb3VudFBhc3NpdmVEZXYsIGludm9rZVBhc3NpdmVFZmZlY3RNb3VudEluREVWKTsKICAgICAgfQoKICAgICAgcmVzZXRDdXJyZW50RmliZXIoKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGludm9rZUVmZmVjdHNJbkRldihmaXJzdENoaWxkLCBmaWJlckZsYWdzLCBpbnZva2VFZmZlY3RGbikgewogICAgewogICAgICAvLyBXZSBkb24ndCBuZWVkIHRvIHJlLWNoZWNrIFN0cmljdEVmZmVjdHNNb2RlIGhlcmUuCiAgICAgIC8vIFRoaXMgZnVuY3Rpb24gaXMgb25seSBjYWxsZWQgaWYgdGhhdCBjaGVjayBoYXMgYWxyZWFkeSBwYXNzZWQuCiAgICAgIHZhciBjdXJyZW50ID0gZmlyc3RDaGlsZDsKICAgICAgdmFyIHN1YnRyZWVSb290ID0gbnVsbDsKCiAgICAgIHdoaWxlIChjdXJyZW50ICE9PSBudWxsKSB7CiAgICAgICAgdmFyIHByaW1hcnlTdWJ0cmVlRmxhZyA9IGN1cnJlbnQuc3VidHJlZUZsYWdzICYgZmliZXJGbGFnczsKCiAgICAgICAgaWYgKGN1cnJlbnQgIT09IHN1YnRyZWVSb290ICYmIGN1cnJlbnQuY2hpbGQgIT09IG51bGwgJiYgcHJpbWFyeVN1YnRyZWVGbGFnICE9PSBOb0ZsYWdzKSB7CiAgICAgICAgICBjdXJyZW50ID0gY3VycmVudC5jaGlsZDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKChjdXJyZW50LmZsYWdzICYgZmliZXJGbGFncykgIT09IE5vRmxhZ3MpIHsKICAgICAgICAgICAgaW52b2tlRWZmZWN0Rm4oY3VycmVudCk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGN1cnJlbnQuc2libGluZyAhPT0gbnVsbCkgewogICAgICAgICAgICBjdXJyZW50ID0gY3VycmVudC5zaWJsaW5nOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY3VycmVudCA9IHN1YnRyZWVSb290ID0gY3VycmVudC5yZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQoKICB2YXIgZGlkV2FyblN0YXRlVXBkYXRlRm9yTm90WWV0TW91bnRlZENvbXBvbmVudCA9IG51bGw7CiAgZnVuY3Rpb24gd2FybkFib3V0VXBkYXRlT25Ob3RZZXRNb3VudGVkRmliZXJJbkRFVihmaWJlcikgewogICAgewogICAgICBpZiAoKGV4ZWN1dGlvbkNvbnRleHQgJiBSZW5kZXJDb250ZXh0KSAhPT0gTm9Db250ZXh0KSB7CiAgICAgICAgLy8gV2UgbGV0IHRoZSBvdGhlciB3YXJuaW5nIGFib3V0IHJlbmRlciBwaGFzZSB1cGRhdGVzIGRlYWwgd2l0aCB0aGlzIG9uZS4KICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICghKGZpYmVyLm1vZGUgJiBDb25jdXJyZW50TW9kZSkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciB0YWcgPSBmaWJlci50YWc7CgogICAgICBpZiAodGFnICE9PSBJbmRldGVybWluYXRlQ29tcG9uZW50ICYmIHRhZyAhPT0gSG9zdFJvb3QgJiYgdGFnICE9PSBDbGFzc0NvbXBvbmVudCAmJiB0YWcgIT09IEZ1bmN0aW9uQ29tcG9uZW50ICYmIHRhZyAhPT0gRm9yd2FyZFJlZiAmJiB0YWcgIT09IE1lbW9Db21wb25lbnQgJiYgdGFnICE9PSBTaW1wbGVNZW1vQ29tcG9uZW50KSB7CiAgICAgICAgLy8gT25seSB3YXJuIGZvciB1c2VyLWRlZmluZWQgY29tcG9uZW50cywgbm90IGludGVybmFsIG9uZXMgbGlrZSBTdXNwZW5zZS4KICAgICAgICByZXR1cm47CiAgICAgIH0gLy8gV2Ugc2hvdyB0aGUgd2hvbGUgc3RhY2sgYnV0IGRlZHVwZSBvbiB0aGUgdG9wIGNvbXBvbmVudCdzIG5hbWUgYmVjYXVzZQogICAgICAvLyB0aGUgcHJvYmxlbWF0aWMgY29kZSBhbG1vc3QgYWx3YXlzIGxpZXMgaW5zaWRlIHRoYXQgY29tcG9uZW50LgoKCiAgICAgIHZhciBjb21wb25lbnROYW1lID0gZ2V0Q29tcG9uZW50TmFtZUZyb21GaWJlcihmaWJlcikgfHwgJ1JlYWN0Q29tcG9uZW50JzsKCiAgICAgIGlmIChkaWRXYXJuU3RhdGVVcGRhdGVGb3JOb3RZZXRNb3VudGVkQ29tcG9uZW50ICE9PSBudWxsKSB7CiAgICAgICAgaWYgKGRpZFdhcm5TdGF0ZVVwZGF0ZUZvck5vdFlldE1vdW50ZWRDb21wb25lbnQuaGFzKGNvbXBvbmVudE5hbWUpKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBkaWRXYXJuU3RhdGVVcGRhdGVGb3JOb3RZZXRNb3VudGVkQ29tcG9uZW50LmFkZChjb21wb25lbnROYW1lKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBkaWRXYXJuU3RhdGVVcGRhdGVGb3JOb3RZZXRNb3VudGVkQ29tcG9uZW50ID0gbmV3IFNldChbY29tcG9uZW50TmFtZV0pOwogICAgICB9CgogICAgICB2YXIgcHJldmlvdXNGaWJlciA9IGN1cnJlbnQ7CgogICAgICB0cnkgewogICAgICAgIHNldEN1cnJlbnRGaWJlcihmaWJlcik7CgogICAgICAgIGVycm9yKCJDYW4ndCBwZXJmb3JtIGEgUmVhY3Qgc3RhdGUgdXBkYXRlIG9uIGEgY29tcG9uZW50IHRoYXQgaGFzbid0IG1vdW50ZWQgeWV0LiAiICsgJ1RoaXMgaW5kaWNhdGVzIHRoYXQgeW91IGhhdmUgYSBzaWRlLWVmZmVjdCBpbiB5b3VyIHJlbmRlciBmdW5jdGlvbiB0aGF0ICcgKyAnYXN5bmNocm9ub3VzbHkgbGF0ZXIgY2FsbHMgdHJpZXMgdG8gdXBkYXRlIHRoZSBjb21wb25lbnQuIE1vdmUgdGhpcyB3b3JrIHRvICcgKyAndXNlRWZmZWN0IGluc3RlYWQuJyk7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgaWYgKHByZXZpb3VzRmliZXIpIHsKICAgICAgICAgIHNldEN1cnJlbnRGaWJlcihmaWJlcik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJlc2V0Q3VycmVudEZpYmVyKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQogIHZhciBiZWdpbldvcmskMTsKCiAgewogICAgdmFyIGR1bW15RmliZXIgPSBudWxsOwoKICAgIGJlZ2luV29yayQxID0gZnVuY3Rpb24gKGN1cnJlbnQsIHVuaXRPZldvcmssIGxhbmVzKSB7CiAgICAgIC8vIElmIGEgY29tcG9uZW50IHRocm93cyBhbiBlcnJvciwgd2UgcmVwbGF5IGl0IGFnYWluIGluIGEgc3luY2hyb25vdXNseQogICAgICAvLyBkaXNwYXRjaGVkIGV2ZW50LCBzbyB0aGF0IHRoZSBkZWJ1Z2dlciB3aWxsIHRyZWF0IGl0IGFzIGFuIHVuY2F1Z2h0CiAgICAgIC8vIGVycm9yIFNlZSBSZWFjdEVycm9yVXRpbHMgZm9yIG1vcmUgaW5mb3JtYXRpb24uCiAgICAgIC8vIEJlZm9yZSBlbnRlcmluZyB0aGUgYmVnaW4gcGhhc2UsIGNvcHkgdGhlIHdvcmstaW4tcHJvZ3Jlc3Mgb250byBhIGR1bW15CiAgICAgIC8vIGZpYmVyLiBJZiBiZWdpbldvcmsgdGhyb3dzLCB3ZSdsbCB1c2UgdGhpcyB0byByZXNldCB0aGUgc3RhdGUuCiAgICAgIHZhciBvcmlnaW5hbFdvcmtJblByb2dyZXNzQ29weSA9IGFzc2lnbkZpYmVyUHJvcGVydGllc0luREVWKGR1bW15RmliZXIsIHVuaXRPZldvcmspOwoKICAgICAgdHJ5IHsKICAgICAgICByZXR1cm4gYmVnaW5Xb3JrKGN1cnJlbnQsIHVuaXRPZldvcmssIGxhbmVzKTsKICAgICAgfSBjYXRjaCAob3JpZ2luYWxFcnJvcikgewogICAgICAgIGlmIChkaWRTdXNwZW5kT3JFcnJvcldoaWxlSHlkcmF0aW5nREVWKCkgfHwgb3JpZ2luYWxFcnJvciAhPT0gbnVsbCAmJiB0eXBlb2Ygb3JpZ2luYWxFcnJvciA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG9yaWdpbmFsRXJyb3IudGhlbiA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgLy8gRG9uJ3QgcmVwbGF5IHByb21pc2VzLgogICAgICAgICAgLy8gRG9uJ3QgcmVwbGF5IGVycm9ycyBpZiB3ZSBhcmUgaHlkcmF0aW5nIGFuZCBoYXZlIGFscmVhZHkgc3VzcGVuZGVkIG9yIGhhbmRsZWQgYW4gZXJyb3IKICAgICAgICAgIHRocm93IG9yaWdpbmFsRXJyb3I7CiAgICAgICAgfSAvLyBLZWVwIHRoaXMgY29kZSBpbiBzeW5jIHdpdGggaGFuZGxlRXJyb3I7IGFueSBjaGFuZ2VzIGhlcmUgbXVzdCBoYXZlCiAgICAgICAgLy8gY29ycmVzcG9uZGluZyBjaGFuZ2VzIHRoZXJlLgoKCiAgICAgICAgcmVzZXRDb250ZXh0RGVwZW5kZW5jaWVzKCk7CiAgICAgICAgcmVzZXRIb29rc0FmdGVyVGhyb3coKTsgLy8gRG9uJ3QgcmVzZXQgY3VycmVudCBkZWJ1ZyBmaWJlciwgc2luY2Ugd2UncmUgYWJvdXQgdG8gd29yayBvbiB0aGUKICAgICAgICAvLyBzYW1lIGZpYmVyIGFnYWluLgogICAgICAgIC8vIFVud2luZCB0aGUgZmFpbGVkIHN0YWNrIGZyYW1lCgogICAgICAgIHVud2luZEludGVycnVwdGVkV29yayhjdXJyZW50LCB1bml0T2ZXb3JrKTsgLy8gUmVzdG9yZSB0aGUgb3JpZ2luYWwgcHJvcGVydGllcyBvZiB0aGUgZmliZXIuCgogICAgICAgIGFzc2lnbkZpYmVyUHJvcGVydGllc0luREVWKHVuaXRPZldvcmssIG9yaWdpbmFsV29ya0luUHJvZ3Jlc3NDb3B5KTsKCiAgICAgICAgaWYgKCB1bml0T2ZXb3JrLm1vZGUgJiBQcm9maWxlTW9kZSkgewogICAgICAgICAgLy8gUmVzZXQgdGhlIHByb2ZpbGVyIHRpbWVyLgogICAgICAgICAgc3RhcnRQcm9maWxlclRpbWVyKHVuaXRPZldvcmspOwogICAgICAgIH0gLy8gUnVuIGJlZ2luV29yayBhZ2Fpbi4KCgogICAgICAgIGludm9rZUd1YXJkZWRDYWxsYmFjayhudWxsLCBiZWdpbldvcmssIG51bGwsIGN1cnJlbnQsIHVuaXRPZldvcmssIGxhbmVzKTsKCiAgICAgICAgaWYgKGhhc0NhdWdodEVycm9yKCkpIHsKICAgICAgICAgIHZhciByZXBsYXlFcnJvciA9IGNsZWFyQ2F1Z2h0RXJyb3IoKTsKCiAgICAgICAgICBpZiAodHlwZW9mIHJlcGxheUVycm9yID09PSAnb2JqZWN0JyAmJiByZXBsYXlFcnJvciAhPT0gbnVsbCAmJiByZXBsYXlFcnJvci5fc3VwcHJlc3NMb2dnaW5nICYmIHR5cGVvZiBvcmlnaW5hbEVycm9yID09PSAnb2JqZWN0JyAmJiBvcmlnaW5hbEVycm9yICE9PSBudWxsICYmICFvcmlnaW5hbEVycm9yLl9zdXBwcmVzc0xvZ2dpbmcpIHsKICAgICAgICAgICAgLy8gSWYgc3VwcHJlc3NlZCwgbGV0IHRoZSBmbGFnIGNhcnJ5IG92ZXIgdG8gdGhlIG9yaWdpbmFsIGVycm9yIHdoaWNoIGlzIHRoZSBvbmUgd2UnbGwgcmV0aHJvdy4KICAgICAgICAgICAgb3JpZ2luYWxFcnJvci5fc3VwcHJlc3NMb2dnaW5nID0gdHJ1ZTsKICAgICAgICAgIH0KICAgICAgICB9IC8vIFdlIGFsd2F5cyB0aHJvdyB0aGUgb3JpZ2luYWwgZXJyb3IgaW4gY2FzZSB0aGUgc2Vjb25kIHJlbmRlciBwYXNzIGlzIG5vdCBpZGVtcG90ZW50LgogICAgICAgIC8vIFRoaXMgY2FuIGhhcHBlbiBpZiBhIG1lbW9pemVkIGZ1bmN0aW9uIG9yIENvbW1vbkpTIG1vZHVsZSBkb2Vzbid0IHRocm93IGFmdGVyIGZpcnN0IGludm9jYXRpb24uCgoKICAgICAgICB0aHJvdyBvcmlnaW5hbEVycm9yOwogICAgICB9CiAgICB9OwogIH0KCiAgdmFyIGRpZFdhcm5BYm91dFVwZGF0ZUluUmVuZGVyID0gZmFsc2U7CiAgdmFyIGRpZFdhcm5BYm91dFVwZGF0ZUluUmVuZGVyRm9yQW5vdGhlckNvbXBvbmVudDsKCiAgewogICAgZGlkV2FybkFib3V0VXBkYXRlSW5SZW5kZXJGb3JBbm90aGVyQ29tcG9uZW50ID0gbmV3IFNldCgpOwogIH0KCiAgZnVuY3Rpb24gd2FybkFib3V0UmVuZGVyUGhhc2VVcGRhdGVzSW5ERVYoZmliZXIpIHsKICAgIHsKICAgICAgaWYgKGlzUmVuZGVyaW5nICYmICFnZXRJc1VwZGF0aW5nT3BhcXVlVmFsdWVJblJlbmRlclBoYXNlSW5ERVYoKSkgewogICAgICAgIHN3aXRjaCAoZmliZXIudGFnKSB7CiAgICAgICAgICBjYXNlIEZ1bmN0aW9uQ29tcG9uZW50OgogICAgICAgICAgY2FzZSBGb3J3YXJkUmVmOgogICAgICAgICAgY2FzZSBTaW1wbGVNZW1vQ29tcG9uZW50OgogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdmFyIHJlbmRlcmluZ0NvbXBvbmVudE5hbWUgPSB3b3JrSW5Qcm9ncmVzcyAmJiBnZXRDb21wb25lbnROYW1lRnJvbUZpYmVyKHdvcmtJblByb2dyZXNzKSB8fCAnVW5rbm93bic7IC8vIERlZHVwZSBieSB0aGUgcmVuZGVyaW5nIGNvbXBvbmVudCBiZWNhdXNlIGl0J3MgdGhlIG9uZSB0aGF0IG5lZWRzIHRvIGJlIGZpeGVkLgoKICAgICAgICAgICAgICB2YXIgZGVkdXBlS2V5ID0gcmVuZGVyaW5nQ29tcG9uZW50TmFtZTsKCiAgICAgICAgICAgICAgaWYgKCFkaWRXYXJuQWJvdXRVcGRhdGVJblJlbmRlckZvckFub3RoZXJDb21wb25lbnQuaGFzKGRlZHVwZUtleSkpIHsKICAgICAgICAgICAgICAgIGRpZFdhcm5BYm91dFVwZGF0ZUluUmVuZGVyRm9yQW5vdGhlckNvbXBvbmVudC5hZGQoZGVkdXBlS2V5KTsKICAgICAgICAgICAgICAgIHZhciBzZXRTdGF0ZUNvbXBvbmVudE5hbWUgPSBnZXRDb21wb25lbnROYW1lRnJvbUZpYmVyKGZpYmVyKSB8fCAnVW5rbm93bic7CgogICAgICAgICAgICAgICAgZXJyb3IoJ0Nhbm5vdCB1cGRhdGUgYSBjb21wb25lbnQgKGAlc2ApIHdoaWxlIHJlbmRlcmluZyBhICcgKyAnZGlmZmVyZW50IGNvbXBvbmVudCAoYCVzYCkuIFRvIGxvY2F0ZSB0aGUgYmFkIHNldFN0YXRlKCkgY2FsbCBpbnNpZGUgYCVzYCwgJyArICdmb2xsb3cgdGhlIHN0YWNrIHRyYWNlIGFzIGRlc2NyaWJlZCBpbiBodHRwczovL3JlYWN0anMub3JnL2xpbmsvc2V0c3RhdGUtaW4tcmVuZGVyJywgc2V0U3RhdGVDb21wb25lbnROYW1lLCByZW5kZXJpbmdDb21wb25lbnROYW1lLCByZW5kZXJpbmdDb21wb25lbnROYW1lKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgY2FzZSBDbGFzc0NvbXBvbmVudDoKICAgICAgICAgICAgewogICAgICAgICAgICAgIGlmICghZGlkV2FybkFib3V0VXBkYXRlSW5SZW5kZXIpIHsKICAgICAgICAgICAgICAgIGVycm9yKCdDYW5ub3QgdXBkYXRlIGR1cmluZyBhbiBleGlzdGluZyBzdGF0ZSB0cmFuc2l0aW9uIChzdWNoIGFzICcgKyAnd2l0aGluIGByZW5kZXJgKS4gUmVuZGVyIG1ldGhvZHMgc2hvdWxkIGJlIGEgcHVyZSAnICsgJ2Z1bmN0aW9uIG9mIHByb3BzIGFuZCBzdGF0ZS4nKTsKCiAgICAgICAgICAgICAgICBkaWRXYXJuQWJvdXRVcGRhdGVJblJlbmRlciA9IHRydWU7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gcmVzdG9yZVBlbmRpbmdVcGRhdGVycyhyb290LCBsYW5lcykgewogICAgewogICAgICBpZiAoaXNEZXZUb29sc1ByZXNlbnQpIHsKICAgICAgICB2YXIgbWVtb2l6ZWRVcGRhdGVycyA9IHJvb3QubWVtb2l6ZWRVcGRhdGVyczsKICAgICAgICBtZW1vaXplZFVwZGF0ZXJzLmZvckVhY2goZnVuY3Rpb24gKHNjaGVkdWxpbmdGaWJlcikgewogICAgICAgICAgYWRkRmliZXJUb0xhbmVzTWFwKHJvb3QsIHNjaGVkdWxpbmdGaWJlciwgbGFuZXMpOwogICAgICAgIH0pOyAvLyBUaGlzIGZ1bmN0aW9uIGludGVudGlvbmFsbHkgZG9lcyBub3QgY2xlYXIgbWVtb2l6ZWQgdXBkYXRlcnMuCiAgICAgICAgLy8gVGhvc2UgbWF5IHN0aWxsIGJlIHJlbGV2YW50IHRvIHRoZSBjdXJyZW50IGNvbW1pdAogICAgICAgIC8vIGFuZCBhIGZ1dHVyZSBvbmUgKGUuZy4gU3VzcGVuc2UpLgogICAgICB9CiAgICB9CiAgfQogIHZhciBmYWtlQWN0Q2FsbGJhY2tOb2RlID0ge307CgogIGZ1bmN0aW9uIHNjaGVkdWxlQ2FsbGJhY2skMShwcmlvcml0eUxldmVsLCBjYWxsYmFjaykgewogICAgewogICAgICAvLyBJZiB3ZSdyZSBjdXJyZW50bHkgaW5zaWRlIGFuIGBhY3RgIHNjb3BlLCBieXBhc3MgU2NoZWR1bGVyIGFuZCBwdXNoIHRvCiAgICAgIC8vIHRoZSBgYWN0YCBxdWV1ZSBpbnN0ZWFkLgogICAgICB2YXIgYWN0UXVldWUgPSBSZWFjdEN1cnJlbnRBY3RRdWV1ZSQxLmN1cnJlbnQ7CgogICAgICBpZiAoYWN0UXVldWUgIT09IG51bGwpIHsKICAgICAgICBhY3RRdWV1ZS5wdXNoKGNhbGxiYWNrKTsKICAgICAgICByZXR1cm4gZmFrZUFjdENhbGxiYWNrTm9kZTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gc2NoZWR1bGVDYWxsYmFjayhwcmlvcml0eUxldmVsLCBjYWxsYmFjayk7CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIGNhbmNlbENhbGxiYWNrJDEoY2FsbGJhY2tOb2RlKSB7CiAgICBpZiAoIGNhbGxiYWNrTm9kZSA9PT0gZmFrZUFjdENhbGxiYWNrTm9kZSkgewogICAgICByZXR1cm47CiAgICB9IC8vIEluIHByb2R1Y3Rpb24sIGFsd2F5cyBjYWxsIFNjaGVkdWxlci4gVGhpcyBmdW5jdGlvbiB3aWxsIGJlIHN0cmlwcGVkIG91dC4KCgogICAgcmV0dXJuIGNhbmNlbENhbGxiYWNrKGNhbGxiYWNrTm9kZSk7CiAgfQoKICBmdW5jdGlvbiBzaG91bGRGb3JjZUZsdXNoRmFsbGJhY2tzSW5ERVYoKSB7CiAgICAvLyBOZXZlciBmb3JjZSBmbHVzaCBpbiBwcm9kdWN0aW9uLiBUaGlzIGZ1bmN0aW9uIHNob3VsZCBnZXQgc3RyaXBwZWQgb3V0LgogICAgcmV0dXJuICBSZWFjdEN1cnJlbnRBY3RRdWV1ZSQxLmN1cnJlbnQgIT09IG51bGw7CiAgfQoKICBmdW5jdGlvbiB3YXJuSWZVcGRhdGVzTm90V3JhcHBlZFdpdGhBY3RERVYoZmliZXIpIHsKICAgIHsKICAgICAgaWYgKGZpYmVyLm1vZGUgJiBDb25jdXJyZW50TW9kZSkgewogICAgICAgIGlmICghaXNDb25jdXJyZW50QWN0RW52aXJvbm1lbnQoKSkgewogICAgICAgICAgLy8gTm90IGluIGFuIGFjdCBlbnZpcm9ubWVudC4gTm8gbmVlZCB0byB3YXJuLgogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBMZWdhY3kgbW9kZSBoYXMgYWRkaXRpb25hbCBjYXNlcyB3aGVyZSB3ZSBzdXBwcmVzcyBhIHdhcm5pbmcuCiAgICAgICAgaWYgKCFpc0xlZ2FjeUFjdEVudmlyb25tZW50KCkpIHsKICAgICAgICAgIC8vIE5vdCBpbiBhbiBhY3QgZW52aXJvbm1lbnQuIE5vIG5lZWQgdG8gd2Fybi4KICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmIChleGVjdXRpb25Db250ZXh0ICE9PSBOb0NvbnRleHQpIHsKICAgICAgICAgIC8vIExlZ2FjeSBtb2RlIGRvZXNuJ3Qgd2FybiBpZiB0aGUgdXBkYXRlIGlzIGJhdGNoZWQsIGkuZS4KICAgICAgICAgIC8vIGJhdGNoZWRVcGRhdGVzIG9yIGZsdXNoU3luYy4KICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmIChmaWJlci50YWcgIT09IEZ1bmN0aW9uQ29tcG9uZW50ICYmIGZpYmVyLnRhZyAhPT0gRm9yd2FyZFJlZiAmJiBmaWJlci50YWcgIT09IFNpbXBsZU1lbW9Db21wb25lbnQpIHsKICAgICAgICAgIC8vIEZvciBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eSB3aXRoIHByZS1ob29rcyBjb2RlLCBsZWdhY3kgbW9kZSBvbmx5CiAgICAgICAgICAvLyB3YXJucyBmb3IgdXBkYXRlcyB0aGF0IG9yaWdpbmF0ZSBmcm9tIGEgaG9vay4KICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChSZWFjdEN1cnJlbnRBY3RRdWV1ZSQxLmN1cnJlbnQgPT09IG51bGwpIHsKICAgICAgICB2YXIgcHJldmlvdXNGaWJlciA9IGN1cnJlbnQ7CgogICAgICAgIHRyeSB7CiAgICAgICAgICBzZXRDdXJyZW50RmliZXIoZmliZXIpOwoKICAgICAgICAgIGVycm9yKCdBbiB1cGRhdGUgdG8gJXMgaW5zaWRlIGEgdGVzdCB3YXMgbm90IHdyYXBwZWQgaW4gYWN0KC4uLikuXG5cbicgKyAnV2hlbiB0ZXN0aW5nLCBjb2RlIHRoYXQgY2F1c2VzIFJlYWN0IHN0YXRlIHVwZGF0ZXMgc2hvdWxkIGJlICcgKyAnd3JhcHBlZCBpbnRvIGFjdCguLi4pOlxuXG4nICsgJ2FjdCgoKSA9PiB7XG4nICsgJyAgLyogZmlyZSBldmVudHMgdGhhdCB1cGRhdGUgc3RhdGUgKi9cbicgKyAnfSk7XG4nICsgJy8qIGFzc2VydCBvbiB0aGUgb3V0cHV0ICovXG5cbicgKyAiVGhpcyBlbnN1cmVzIHRoYXQgeW91J3JlIHRlc3RpbmcgdGhlIGJlaGF2aW9yIHRoZSB1c2VyIHdvdWxkIHNlZSAiICsgJ2luIHRoZSBicm93c2VyLicgKyAnIExlYXJuIG1vcmUgYXQgaHR0cHM6Ly9yZWFjdGpzLm9yZy9saW5rL3dyYXAtdGVzdHMtd2l0aC1hY3QnLCBnZXRDb21wb25lbnROYW1lRnJvbUZpYmVyKGZpYmVyKSk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIGlmIChwcmV2aW91c0ZpYmVyKSB7CiAgICAgICAgICAgIHNldEN1cnJlbnRGaWJlcihmaWJlcik7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXNldEN1cnJlbnRGaWJlcigpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gd2FybklmU3VzcGVuc2VSZXNvbHV0aW9uTm90V3JhcHBlZFdpdGhBY3RERVYocm9vdCkgewogICAgewogICAgICBpZiAocm9vdC50YWcgIT09IExlZ2FjeVJvb3QgJiYgaXNDb25jdXJyZW50QWN0RW52aXJvbm1lbnQoKSAmJiBSZWFjdEN1cnJlbnRBY3RRdWV1ZSQxLmN1cnJlbnQgPT09IG51bGwpIHsKICAgICAgICBlcnJvcignQSBzdXNwZW5kZWQgcmVzb3VyY2UgZmluaXNoZWQgbG9hZGluZyBpbnNpZGUgYSB0ZXN0LCBidXQgdGhlIGV2ZW50ICcgKyAnd2FzIG5vdCB3cmFwcGVkIGluIGFjdCguLi4pLlxuXG4nICsgJ1doZW4gdGVzdGluZywgY29kZSB0aGF0IHJlc29sdmVzIHN1c3BlbmRlZCBkYXRhIHNob3VsZCBiZSB3cmFwcGVkICcgKyAnaW50byBhY3QoLi4uKTpcblxuJyArICdhY3QoKCkgPT4ge1xuJyArICcgIC8qIGZpbmlzaCBsb2FkaW5nIHN1c3BlbmRlZCBkYXRhICovXG4nICsgJ30pO1xuJyArICcvKiBhc3NlcnQgb24gdGhlIG91dHB1dCAqL1xuXG4nICsgIlRoaXMgZW5zdXJlcyB0aGF0IHlvdSdyZSB0ZXN0aW5nIHRoZSBiZWhhdmlvciB0aGUgdXNlciB3b3VsZCBzZWUgIiArICdpbiB0aGUgYnJvd3Nlci4nICsgJyBMZWFybiBtb3JlIGF0IGh0dHBzOi8vcmVhY3Rqcy5vcmcvbGluay93cmFwLXRlc3RzLXdpdGgtYWN0Jyk7CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIHNldElzUnVubmluZ0luc2VydGlvbkVmZmVjdChpc1J1bm5pbmcpIHsKICAgIHsKICAgICAgaXNSdW5uaW5nSW5zZXJ0aW9uRWZmZWN0ID0gaXNSdW5uaW5nOwogICAgfQogIH0KCiAgLyogZXNsaW50LWRpc2FibGUgcmVhY3QtaW50ZXJuYWwvcHJvZC1lcnJvci1jb2RlcyAqLwogIHZhciByZXNvbHZlRmFtaWx5ID0gbnVsbDsgLy8gJEZsb3dGaXhNZSBGbG93IGdldHMgY29uZnVzZWQgYnkgYSBXZWFrU2V0IGZlYXR1cmUgY2hlY2sgYmVsb3cuCgogIHZhciBmYWlsZWRCb3VuZGFyaWVzID0gbnVsbDsKICB2YXIgc2V0UmVmcmVzaEhhbmRsZXIgPSBmdW5jdGlvbiAoaGFuZGxlcikgewogICAgewogICAgICByZXNvbHZlRmFtaWx5ID0gaGFuZGxlcjsKICAgIH0KICB9OwogIGZ1bmN0aW9uIHJlc29sdmVGdW5jdGlvbkZvckhvdFJlbG9hZGluZyh0eXBlKSB7CiAgICB7CiAgICAgIGlmIChyZXNvbHZlRmFtaWx5ID09PSBudWxsKSB7CiAgICAgICAgLy8gSG90IHJlbG9hZGluZyBpcyBkaXNhYmxlZC4KICAgICAgICByZXR1cm4gdHlwZTsKICAgICAgfQoKICAgICAgdmFyIGZhbWlseSA9IHJlc29sdmVGYW1pbHkodHlwZSk7CgogICAgICBpZiAoZmFtaWx5ID09PSB1bmRlZmluZWQpIHsKICAgICAgICByZXR1cm4gdHlwZTsKICAgICAgfSAvLyBVc2UgdGhlIGxhdGVzdCBrbm93biBpbXBsZW1lbnRhdGlvbi4KCgogICAgICByZXR1cm4gZmFtaWx5LmN1cnJlbnQ7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHJlc29sdmVDbGFzc0ZvckhvdFJlbG9hZGluZyh0eXBlKSB7CiAgICAvLyBObyBpbXBsZW1lbnRhdGlvbiBkaWZmZXJlbmNlcy4KICAgIHJldHVybiByZXNvbHZlRnVuY3Rpb25Gb3JIb3RSZWxvYWRpbmcodHlwZSk7CiAgfQogIGZ1bmN0aW9uIHJlc29sdmVGb3J3YXJkUmVmRm9ySG90UmVsb2FkaW5nKHR5cGUpIHsKICAgIHsKICAgICAgaWYgKHJlc29sdmVGYW1pbHkgPT09IG51bGwpIHsKICAgICAgICAvLyBIb3QgcmVsb2FkaW5nIGlzIGRpc2FibGVkLgogICAgICAgIHJldHVybiB0eXBlOwogICAgICB9CgogICAgICB2YXIgZmFtaWx5ID0gcmVzb2x2ZUZhbWlseSh0eXBlKTsKCiAgICAgIGlmIChmYW1pbHkgPT09IHVuZGVmaW5lZCkgewogICAgICAgIC8vIENoZWNrIGlmIHdlJ3JlIGRlYWxpbmcgd2l0aCBhIHJlYWwgZm9yd2FyZFJlZi4gRG9uJ3Qgd2FudCB0byBjcmFzaCBlYXJseS4KICAgICAgICBpZiAodHlwZSAhPT0gbnVsbCAmJiB0eXBlICE9PSB1bmRlZmluZWQgJiYgdHlwZW9mIHR5cGUucmVuZGVyID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAvLyBGb3J3YXJkUmVmIGlzIHNwZWNpYWwgYmVjYXVzZSBpdHMgcmVzb2x2ZWQgLnR5cGUgaXMgYW4gb2JqZWN0LAogICAgICAgICAgLy8gYnV0IGl0J3MgcG9zc2libGUgdGhhdCB3ZSBvbmx5IGhhdmUgaXRzIGlubmVyIHJlbmRlciBmdW5jdGlvbiBpbiB0aGUgbWFwLgogICAgICAgICAgLy8gSWYgdGhhdCBpbm5lciByZW5kZXIgZnVuY3Rpb24gaXMgZGlmZmVyZW50LCB3ZSdsbCBidWlsZCBhIG5ldyBmb3J3YXJkUmVmIHR5cGUuCiAgICAgICAgICB2YXIgY3VycmVudFJlbmRlciA9IHJlc29sdmVGdW5jdGlvbkZvckhvdFJlbG9hZGluZyh0eXBlLnJlbmRlcik7CgogICAgICAgICAgaWYgKHR5cGUucmVuZGVyICE9PSBjdXJyZW50UmVuZGVyKSB7CiAgICAgICAgICAgIHZhciBzeW50aGV0aWNUeXBlID0gewogICAgICAgICAgICAgICQkdHlwZW9mOiBSRUFDVF9GT1JXQVJEX1JFRl9UWVBFLAogICAgICAgICAgICAgIHJlbmRlcjogY3VycmVudFJlbmRlcgogICAgICAgICAgICB9OwoKICAgICAgICAgICAgaWYgKHR5cGUuZGlzcGxheU5hbWUgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgIHN5bnRoZXRpY1R5cGUuZGlzcGxheU5hbWUgPSB0eXBlLmRpc3BsYXlOYW1lOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gc3ludGhldGljVHlwZTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJldHVybiB0eXBlOwogICAgICB9IC8vIFVzZSB0aGUgbGF0ZXN0IGtub3duIGltcGxlbWVudGF0aW9uLgoKCiAgICAgIHJldHVybiBmYW1pbHkuY3VycmVudDsKICAgIH0KICB9CiAgZnVuY3Rpb24gaXNDb21wYXRpYmxlRmFtaWx5Rm9ySG90UmVsb2FkaW5nKGZpYmVyLCBlbGVtZW50KSB7CiAgICB7CiAgICAgIGlmIChyZXNvbHZlRmFtaWx5ID09PSBudWxsKSB7CiAgICAgICAgLy8gSG90IHJlbG9hZGluZyBpcyBkaXNhYmxlZC4KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHZhciBwcmV2VHlwZSA9IGZpYmVyLmVsZW1lbnRUeXBlOwogICAgICB2YXIgbmV4dFR5cGUgPSBlbGVtZW50LnR5cGU7IC8vIElmIHdlIGdvdCBoZXJlLCB3ZSBrbm93IHR5cGVzIGFyZW4ndCA9PT0gZXF1YWwuCgogICAgICB2YXIgbmVlZHNDb21wYXJlRmFtaWxpZXMgPSBmYWxzZTsKICAgICAgdmFyICQkdHlwZW9mTmV4dFR5cGUgPSB0eXBlb2YgbmV4dFR5cGUgPT09ICdvYmplY3QnICYmIG5leHRUeXBlICE9PSBudWxsID8gbmV4dFR5cGUuJCR0eXBlb2YgOiBudWxsOwoKICAgICAgc3dpdGNoIChmaWJlci50YWcpIHsKICAgICAgICBjYXNlIENsYXNzQ29tcG9uZW50OgogICAgICAgICAgewogICAgICAgICAgICBpZiAodHlwZW9mIG5leHRUeXBlID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAgICAgbmVlZHNDb21wYXJlRmFtaWxpZXMgPSB0cnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgY2FzZSBGdW5jdGlvbkNvbXBvbmVudDoKICAgICAgICAgIHsKICAgICAgICAgICAgaWYgKHR5cGVvZiBuZXh0VHlwZSA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgICAgIG5lZWRzQ29tcGFyZUZhbWlsaWVzID0gdHJ1ZTsKICAgICAgICAgICAgfSBlbHNlIGlmICgkJHR5cGVvZk5leHRUeXBlID09PSBSRUFDVF9MQVpZX1RZUEUpIHsKICAgICAgICAgICAgICAvLyBXZSBkb24ndCBrbm93IHRoZSBpbm5lciB0eXBlIHlldC4KICAgICAgICAgICAgICAvLyBXZSdyZSBnb2luZyB0byBhc3N1bWUgdGhhdCB0aGUgbGF6eSBpbm5lciB0eXBlIGlzIHN0YWJsZSwKICAgICAgICAgICAgICAvLyBhbmQgc28gaXQgaXMgc3VmZmljaWVudCB0byBhdm9pZCByZWNvbmNpbGluZyBpdCBhd2F5LgogICAgICAgICAgICAgIC8vIFdlJ3JlIG5vdCBnb2luZyB0byB1bndyYXAgb3IgYWN0dWFsbHkgdXNlIHRoZSBuZXcgbGF6eSB0eXBlLgogICAgICAgICAgICAgIG5lZWRzQ29tcGFyZUZhbWlsaWVzID0gdHJ1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgIGNhc2UgRm9yd2FyZFJlZjoKICAgICAgICAgIHsKICAgICAgICAgICAgaWYgKCQkdHlwZW9mTmV4dFR5cGUgPT09IFJFQUNUX0ZPUldBUkRfUkVGX1RZUEUpIHsKICAgICAgICAgICAgICBuZWVkc0NvbXBhcmVGYW1pbGllcyA9IHRydWU7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoJCR0eXBlb2ZOZXh0VHlwZSA9PT0gUkVBQ1RfTEFaWV9UWVBFKSB7CiAgICAgICAgICAgICAgbmVlZHNDb21wYXJlRmFtaWxpZXMgPSB0cnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgY2FzZSBNZW1vQ29tcG9uZW50OgogICAgICAgIGNhc2UgU2ltcGxlTWVtb0NvbXBvbmVudDoKICAgICAgICAgIHsKICAgICAgICAgICAgaWYgKCQkdHlwZW9mTmV4dFR5cGUgPT09IFJFQUNUX01FTU9fVFlQRSkgewogICAgICAgICAgICAgIC8vIFRPRE86IGlmIGl0IHdhcyBidXQgY2FuIG5vIGxvbmdlciBiZSBzaW1wbGUsCiAgICAgICAgICAgICAgLy8gd2Ugc2hvdWxkbid0IHNldCB0aGlzLgogICAgICAgICAgICAgIG5lZWRzQ29tcGFyZUZhbWlsaWVzID0gdHJ1ZTsKICAgICAgICAgICAgfSBlbHNlIGlmICgkJHR5cGVvZk5leHRUeXBlID09PSBSRUFDVF9MQVpZX1RZUEUpIHsKICAgICAgICAgICAgICBuZWVkc0NvbXBhcmVGYW1pbGllcyA9IHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9IC8vIENoZWNrIGlmIGJvdGggdHlwZXMgaGF2ZSBhIGZhbWlseSBhbmQgaXQncyB0aGUgc2FtZSBvbmUuCgoKICAgICAgaWYgKG5lZWRzQ29tcGFyZUZhbWlsaWVzKSB7CiAgICAgICAgLy8gTm90ZTogbWVtbygpIGFuZCBmb3J3YXJkUmVmKCkgd2UnbGwgY29tcGFyZSBvdXRlciByYXRoZXIgdGhhbiBpbm5lciB0eXBlLgogICAgICAgIC8vIFRoaXMgbWVhbnMgYm90aCBvZiB0aGVtIG5lZWQgdG8gYmUgcmVnaXN0ZXJlZCB0byBwcmVzZXJ2ZSBzdGF0ZS4KICAgICAgICAvLyBJZiB3ZSB1bndyYXBwZWQgYW5kIGNvbXBhcmVkIHRoZSBpbm5lciB0eXBlcyBmb3Igd3JhcHBlcnMgaW5zdGVhZCwKICAgICAgICAvLyB0aGVuIHdlIHdvdWxkIHJpc2sgZmFsc2VseSBzYXlpbmcgdHdvIHNlcGFyYXRlIG1lbW8oRm9vKQogICAgICAgIC8vIGNhbGxzIGFyZSBlcXVpdmFsZW50IGJlY2F1c2UgdGhleSB3cmFwIHRoZSBzYW1lIEZvbyBmdW5jdGlvbi4KICAgICAgICB2YXIgcHJldkZhbWlseSA9IHJlc29sdmVGYW1pbHkocHJldlR5cGUpOwoKICAgICAgICBpZiAocHJldkZhbWlseSAhPT0gdW5kZWZpbmVkICYmIHByZXZGYW1pbHkgPT09IHJlc29sdmVGYW1pbHkobmV4dFR5cGUpKSB7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9CiAgZnVuY3Rpb24gbWFya0ZhaWxlZEVycm9yQm91bmRhcnlGb3JIb3RSZWxvYWRpbmcoZmliZXIpIHsKICAgIHsKICAgICAgaWYgKHJlc29sdmVGYW1pbHkgPT09IG51bGwpIHsKICAgICAgICAvLyBIb3QgcmVsb2FkaW5nIGlzIGRpc2FibGVkLgogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHR5cGVvZiBXZWFrU2V0ICE9PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoZmFpbGVkQm91bmRhcmllcyA9PT0gbnVsbCkgewogICAgICAgIGZhaWxlZEJvdW5kYXJpZXMgPSBuZXcgV2Vha1NldCgpOwogICAgICB9CgogICAgICBmYWlsZWRCb3VuZGFyaWVzLmFkZChmaWJlcik7CiAgICB9CiAgfQogIHZhciBzY2hlZHVsZVJlZnJlc2ggPSBmdW5jdGlvbiAocm9vdCwgdXBkYXRlKSB7CiAgICB7CiAgICAgIGlmIChyZXNvbHZlRmFtaWx5ID09PSBudWxsKSB7CiAgICAgICAgLy8gSG90IHJlbG9hZGluZyBpcyBkaXNhYmxlZC4KICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBzdGFsZUZhbWlsaWVzID0gdXBkYXRlLnN0YWxlRmFtaWxpZXMsCiAgICAgICAgICB1cGRhdGVkRmFtaWxpZXMgPSB1cGRhdGUudXBkYXRlZEZhbWlsaWVzOwogICAgICBmbHVzaFBhc3NpdmVFZmZlY3RzKCk7CiAgICAgIGZsdXNoU3luYyhmdW5jdGlvbiAoKSB7CiAgICAgICAgc2NoZWR1bGVGaWJlcnNXaXRoRmFtaWxpZXNSZWN1cnNpdmVseShyb290LmN1cnJlbnQsIHVwZGF0ZWRGYW1pbGllcywgc3RhbGVGYW1pbGllcyk7CiAgICAgIH0pOwogICAgfQogIH07CiAgdmFyIHNjaGVkdWxlUm9vdCA9IGZ1bmN0aW9uIChyb290LCBlbGVtZW50KSB7CiAgICB7CiAgICAgIGlmIChyb290LmNvbnRleHQgIT09IGVtcHR5Q29udGV4dE9iamVjdCkgewogICAgICAgIC8vIFN1cGVyIGVkZ2UgY2FzZTogcm9vdCBoYXMgYSBsZWdhY3kgX3JlbmRlclN1YnRyZWUgY29udGV4dAogICAgICAgIC8vIGJ1dCB3ZSBkb24ndCBrbm93IHRoZSBwYXJlbnRDb21wb25lbnQgc28gd2UgY2FuJ3QgcGFzcyBpdC4KICAgICAgICAvLyBKdXN0IGlnbm9yZS4gV2UnbGwgZGVsZXRlIHRoaXMgd2l0aCBfcmVuZGVyU3VidHJlZSBjb2RlIHBhdGggbGF0ZXIuCiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBmbHVzaFBhc3NpdmVFZmZlY3RzKCk7CiAgICAgIGZsdXNoU3luYyhmdW5jdGlvbiAoKSB7CiAgICAgICAgdXBkYXRlQ29udGFpbmVyKGVsZW1lbnQsIHJvb3QsIG51bGwsIG51bGwpOwogICAgICB9KTsKICAgIH0KICB9OwoKICBmdW5jdGlvbiBzY2hlZHVsZUZpYmVyc1dpdGhGYW1pbGllc1JlY3Vyc2l2ZWx5KGZpYmVyLCB1cGRhdGVkRmFtaWxpZXMsIHN0YWxlRmFtaWxpZXMpIHsKICAgIHsKICAgICAgdmFyIGFsdGVybmF0ZSA9IGZpYmVyLmFsdGVybmF0ZSwKICAgICAgICAgIGNoaWxkID0gZmliZXIuY2hpbGQsCiAgICAgICAgICBzaWJsaW5nID0gZmliZXIuc2libGluZywKICAgICAgICAgIHRhZyA9IGZpYmVyLnRhZywKICAgICAgICAgIHR5cGUgPSBmaWJlci50eXBlOwogICAgICB2YXIgY2FuZGlkYXRlVHlwZSA9IG51bGw7CgogICAgICBzd2l0Y2ggKHRhZykgewogICAgICAgIGNhc2UgRnVuY3Rpb25Db21wb25lbnQ6CiAgICAgICAgY2FzZSBTaW1wbGVNZW1vQ29tcG9uZW50OgogICAgICAgIGNhc2UgQ2xhc3NDb21wb25lbnQ6CiAgICAgICAgICBjYW5kaWRhdGVUeXBlID0gdHlwZTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIEZvcndhcmRSZWY6CiAgICAgICAgICBjYW5kaWRhdGVUeXBlID0gdHlwZS5yZW5kZXI7CiAgICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgaWYgKHJlc29sdmVGYW1pbHkgPT09IG51bGwpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0V4cGVjdGVkIHJlc29sdmVGYW1pbHkgdG8gYmUgc2V0IGR1cmluZyBob3QgcmVsb2FkLicpOwogICAgICB9CgogICAgICB2YXIgbmVlZHNSZW5kZXIgPSBmYWxzZTsKICAgICAgdmFyIG5lZWRzUmVtb3VudCA9IGZhbHNlOwoKICAgICAgaWYgKGNhbmRpZGF0ZVR5cGUgIT09IG51bGwpIHsKICAgICAgICB2YXIgZmFtaWx5ID0gcmVzb2x2ZUZhbWlseShjYW5kaWRhdGVUeXBlKTsKCiAgICAgICAgaWYgKGZhbWlseSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICBpZiAoc3RhbGVGYW1pbGllcy5oYXMoZmFtaWx5KSkgewogICAgICAgICAgICBuZWVkc1JlbW91bnQgPSB0cnVlOwogICAgICAgICAgfSBlbHNlIGlmICh1cGRhdGVkRmFtaWxpZXMuaGFzKGZhbWlseSkpIHsKICAgICAgICAgICAgaWYgKHRhZyA9PT0gQ2xhc3NDb21wb25lbnQpIHsKICAgICAgICAgICAgICBuZWVkc1JlbW91bnQgPSB0cnVlOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIG5lZWRzUmVuZGVyID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGZhaWxlZEJvdW5kYXJpZXMgIT09IG51bGwpIHsKICAgICAgICBpZiAoZmFpbGVkQm91bmRhcmllcy5oYXMoZmliZXIpIHx8IGFsdGVybmF0ZSAhPT0gbnVsbCAmJiBmYWlsZWRCb3VuZGFyaWVzLmhhcyhhbHRlcm5hdGUpKSB7CiAgICAgICAgICBuZWVkc1JlbW91bnQgPSB0cnVlOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKG5lZWRzUmVtb3VudCkgewogICAgICAgIGZpYmVyLl9kZWJ1Z05lZWRzUmVtb3VudCA9IHRydWU7CiAgICAgIH0KCiAgICAgIGlmIChuZWVkc1JlbW91bnQgfHwgbmVlZHNSZW5kZXIpIHsKICAgICAgICB2YXIgX3Jvb3QgPSBlbnF1ZXVlQ29uY3VycmVudFJlbmRlckZvckxhbmUoZmliZXIsIFN5bmNMYW5lKTsKCiAgICAgICAgaWYgKF9yb290ICE9PSBudWxsKSB7CiAgICAgICAgICBzY2hlZHVsZVVwZGF0ZU9uRmliZXIoX3Jvb3QsIGZpYmVyLCBTeW5jTGFuZSwgTm9UaW1lc3RhbXApOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGNoaWxkICE9PSBudWxsICYmICFuZWVkc1JlbW91bnQpIHsKICAgICAgICBzY2hlZHVsZUZpYmVyc1dpdGhGYW1pbGllc1JlY3Vyc2l2ZWx5KGNoaWxkLCB1cGRhdGVkRmFtaWxpZXMsIHN0YWxlRmFtaWxpZXMpOwogICAgICB9CgogICAgICBpZiAoc2libGluZyAhPT0gbnVsbCkgewogICAgICAgIHNjaGVkdWxlRmliZXJzV2l0aEZhbWlsaWVzUmVjdXJzaXZlbHkoc2libGluZywgdXBkYXRlZEZhbWlsaWVzLCBzdGFsZUZhbWlsaWVzKTsKICAgICAgfQogICAgfQogIH0KCiAgdmFyIGZpbmRIb3N0SW5zdGFuY2VzRm9yUmVmcmVzaCA9IGZ1bmN0aW9uIChyb290LCBmYW1pbGllcykgewogICAgewogICAgICB2YXIgaG9zdEluc3RhbmNlcyA9IG5ldyBTZXQoKTsKICAgICAgdmFyIHR5cGVzID0gbmV3IFNldChmYW1pbGllcy5tYXAoZnVuY3Rpb24gKGZhbWlseSkgewogICAgICAgIHJldHVybiBmYW1pbHkuY3VycmVudDsKICAgICAgfSkpOwogICAgICBmaW5kSG9zdEluc3RhbmNlc0Zvck1hdGNoaW5nRmliZXJzUmVjdXJzaXZlbHkocm9vdC5jdXJyZW50LCB0eXBlcywgaG9zdEluc3RhbmNlcyk7CiAgICAgIHJldHVybiBob3N0SW5zdGFuY2VzOwogICAgfQogIH07CgogIGZ1bmN0aW9uIGZpbmRIb3N0SW5zdGFuY2VzRm9yTWF0Y2hpbmdGaWJlcnNSZWN1cnNpdmVseShmaWJlciwgdHlwZXMsIGhvc3RJbnN0YW5jZXMpIHsKICAgIHsKICAgICAgdmFyIGNoaWxkID0gZmliZXIuY2hpbGQsCiAgICAgICAgICBzaWJsaW5nID0gZmliZXIuc2libGluZywKICAgICAgICAgIHRhZyA9IGZpYmVyLnRhZywKICAgICAgICAgIHR5cGUgPSBmaWJlci50eXBlOwogICAgICB2YXIgY2FuZGlkYXRlVHlwZSA9IG51bGw7CgogICAgICBzd2l0Y2ggKHRhZykgewogICAgICAgIGNhc2UgRnVuY3Rpb25Db21wb25lbnQ6CiAgICAgICAgY2FzZSBTaW1wbGVNZW1vQ29tcG9uZW50OgogICAgICAgIGNhc2UgQ2xhc3NDb21wb25lbnQ6CiAgICAgICAgICBjYW5kaWRhdGVUeXBlID0gdHlwZTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIEZvcndhcmRSZWY6CiAgICAgICAgICBjYW5kaWRhdGVUeXBlID0gdHlwZS5yZW5kZXI7CiAgICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgdmFyIGRpZE1hdGNoID0gZmFsc2U7CgogICAgICBpZiAoY2FuZGlkYXRlVHlwZSAhPT0gbnVsbCkgewogICAgICAgIGlmICh0eXBlcy5oYXMoY2FuZGlkYXRlVHlwZSkpIHsKICAgICAgICAgIGRpZE1hdGNoID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChkaWRNYXRjaCkgewogICAgICAgIC8vIFdlIGhhdmUgYSBtYXRjaC4gVGhpcyBvbmx5IGRyaWxscyBkb3duIHRvIHRoZSBjbG9zZXN0IGhvc3QgY29tcG9uZW50cy4KICAgICAgICAvLyBUaGVyZSdzIG5vIG5lZWQgdG8gc2VhcmNoIGRlZXBlciBiZWNhdXNlIGZvciB0aGUgcHVycG9zZSBvZiBnaXZpbmcKICAgICAgICAvLyB2aXN1YWwgZmVlZGJhY2ssICJmbGFzaGluZyIgb3V0ZXJtb3N0IHBhcmVudCByZWN0YW5nbGVzIGlzIHN1ZmZpY2llbnQuCiAgICAgICAgZmluZEhvc3RJbnN0YW5jZXNGb3JGaWJlclNoYWxsb3dseShmaWJlciwgaG9zdEluc3RhbmNlcyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gSWYgdGhlcmUncyBubyBtYXRjaCwgbWF5YmUgdGhlcmUgd2lsbCBiZSBvbmUgZnVydGhlciBkb3duIGluIHRoZSBjaGlsZCB0cmVlLgogICAgICAgIGlmIChjaGlsZCAhPT0gbnVsbCkgewogICAgICAgICAgZmluZEhvc3RJbnN0YW5jZXNGb3JNYXRjaGluZ0ZpYmVyc1JlY3Vyc2l2ZWx5KGNoaWxkLCB0eXBlcywgaG9zdEluc3RhbmNlcyk7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoc2libGluZyAhPT0gbnVsbCkgewogICAgICAgIGZpbmRIb3N0SW5zdGFuY2VzRm9yTWF0Y2hpbmdGaWJlcnNSZWN1cnNpdmVseShzaWJsaW5nLCB0eXBlcywgaG9zdEluc3RhbmNlcyk7CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIGZpbmRIb3N0SW5zdGFuY2VzRm9yRmliZXJTaGFsbG93bHkoZmliZXIsIGhvc3RJbnN0YW5jZXMpIHsKICAgIHsKICAgICAgdmFyIGZvdW5kSG9zdEluc3RhbmNlcyA9IGZpbmRDaGlsZEhvc3RJbnN0YW5jZXNGb3JGaWJlclNoYWxsb3dseShmaWJlciwgaG9zdEluc3RhbmNlcyk7CgogICAgICBpZiAoZm91bmRIb3N0SW5zdGFuY2VzKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vIElmIHdlIGRpZG4ndCBmaW5kIGFueSBob3N0IGNoaWxkcmVuLCBmYWxsYmFjayB0byBjbG9zZXN0IGhvc3QgcGFyZW50LgoKCiAgICAgIHZhciBub2RlID0gZmliZXI7CgogICAgICB3aGlsZSAodHJ1ZSkgewogICAgICAgIHN3aXRjaCAobm9kZS50YWcpIHsKICAgICAgICAgIGNhc2UgSG9zdENvbXBvbmVudDoKICAgICAgICAgICAgaG9zdEluc3RhbmNlcy5hZGQobm9kZS5zdGF0ZU5vZGUpOwogICAgICAgICAgICByZXR1cm47CgogICAgICAgICAgY2FzZSBIb3N0UG9ydGFsOgogICAgICAgICAgICBob3N0SW5zdGFuY2VzLmFkZChub2RlLnN0YXRlTm9kZS5jb250YWluZXJJbmZvKTsKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICAgIGNhc2UgSG9zdFJvb3Q6CiAgICAgICAgICAgIGhvc3RJbnN0YW5jZXMuYWRkKG5vZGUuc3RhdGVOb2RlLmNvbnRhaW5lckluZm8pOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAobm9kZS5yZXR1cm4gPT09IG51bGwpIHsKICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRXhwZWN0ZWQgdG8gcmVhY2ggcm9vdCBmaXJzdC4nKTsKICAgICAgICB9CgogICAgICAgIG5vZGUgPSBub2RlLnJldHVybjsKICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gZmluZENoaWxkSG9zdEluc3RhbmNlc0ZvckZpYmVyU2hhbGxvd2x5KGZpYmVyLCBob3N0SW5zdGFuY2VzKSB7CiAgICB7CiAgICAgIHZhciBub2RlID0gZmliZXI7CiAgICAgIHZhciBmb3VuZEhvc3RJbnN0YW5jZXMgPSBmYWxzZTsKCiAgICAgIHdoaWxlICh0cnVlKSB7CiAgICAgICAgaWYgKG5vZGUudGFnID09PSBIb3N0Q29tcG9uZW50KSB7CiAgICAgICAgICAvLyBXZSBnb3QgYSBtYXRjaC4KICAgICAgICAgIGZvdW5kSG9zdEluc3RhbmNlcyA9IHRydWU7CiAgICAgICAgICBob3N0SW5zdGFuY2VzLmFkZChub2RlLnN0YXRlTm9kZSk7IC8vIFRoZXJlIG1heSBzdGlsbCBiZSBtb3JlLCBzbyBrZWVwIHNlYXJjaGluZy4KICAgICAgICB9IGVsc2UgaWYgKG5vZGUuY2hpbGQgIT09IG51bGwpIHsKICAgICAgICAgIG5vZGUuY2hpbGQucmV0dXJuID0gbm9kZTsKICAgICAgICAgIG5vZGUgPSBub2RlLmNoaWxkOwogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBpZiAobm9kZSA9PT0gZmliZXIpIHsKICAgICAgICAgIHJldHVybiBmb3VuZEhvc3RJbnN0YW5jZXM7CiAgICAgICAgfQoKICAgICAgICB3aGlsZSAobm9kZS5zaWJsaW5nID09PSBudWxsKSB7CiAgICAgICAgICBpZiAobm9kZS5yZXR1cm4gPT09IG51bGwgfHwgbm9kZS5yZXR1cm4gPT09IGZpYmVyKSB7CiAgICAgICAgICAgIHJldHVybiBmb3VuZEhvc3RJbnN0YW5jZXM7CiAgICAgICAgICB9CgogICAgICAgICAgbm9kZSA9IG5vZGUucmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgbm9kZS5zaWJsaW5nLnJldHVybiA9IG5vZGUucmV0dXJuOwogICAgICAgIG5vZGUgPSBub2RlLnNpYmxpbmc7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICB2YXIgaGFzQmFkTWFwUG9seWZpbGw7CgogIHsKICAgIGhhc0JhZE1hcFBvbHlmaWxsID0gZmFsc2U7CgogICAgdHJ5IHsKICAgICAgdmFyIG5vbkV4dGVuc2libGVPYmplY3QgPSBPYmplY3QucHJldmVudEV4dGVuc2lvbnMoe30pOwogICAgICAvKiBlc2xpbnQtZGlzYWJsZSBuby1uZXcgKi8KCiAgICAgIG5ldyBNYXAoW1tub25FeHRlbnNpYmxlT2JqZWN0LCBudWxsXV0pOwogICAgICBuZXcgU2V0KFtub25FeHRlbnNpYmxlT2JqZWN0XSk7CiAgICAgIC8qIGVzbGludC1lbmFibGUgbm8tbmV3ICovCiAgICB9IGNhdGNoIChlKSB7CiAgICAgIC8vIFRPRE86IENvbnNpZGVyIHdhcm5pbmcgYWJvdXQgYmFkIHBvbHlmaWxscwogICAgICBoYXNCYWRNYXBQb2x5ZmlsbCA9IHRydWU7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBGaWJlck5vZGUodGFnLCBwZW5kaW5nUHJvcHMsIGtleSwgbW9kZSkgewogICAgLy8gSW5zdGFuY2UKICAgIHRoaXMudGFnID0gdGFnOwogICAgdGhpcy5rZXkgPSBrZXk7CiAgICB0aGlzLmVsZW1lbnRUeXBlID0gbnVsbDsKICAgIHRoaXMudHlwZSA9IG51bGw7CiAgICB0aGlzLnN0YXRlTm9kZSA9IG51bGw7IC8vIEZpYmVyCgogICAgdGhpcy5yZXR1cm4gPSBudWxsOwogICAgdGhpcy5jaGlsZCA9IG51bGw7CiAgICB0aGlzLnNpYmxpbmcgPSBudWxsOwogICAgdGhpcy5pbmRleCA9IDA7CiAgICB0aGlzLnJlZiA9IG51bGw7CiAgICB0aGlzLnBlbmRpbmdQcm9wcyA9IHBlbmRpbmdQcm9wczsKICAgIHRoaXMubWVtb2l6ZWRQcm9wcyA9IG51bGw7CiAgICB0aGlzLnVwZGF0ZVF1ZXVlID0gbnVsbDsKICAgIHRoaXMubWVtb2l6ZWRTdGF0ZSA9IG51bGw7CiAgICB0aGlzLmRlcGVuZGVuY2llcyA9IG51bGw7CiAgICB0aGlzLm1vZGUgPSBtb2RlOyAvLyBFZmZlY3RzCgogICAgdGhpcy5mbGFncyA9IE5vRmxhZ3M7CiAgICB0aGlzLnN1YnRyZWVGbGFncyA9IE5vRmxhZ3M7CiAgICB0aGlzLmRlbGV0aW9ucyA9IG51bGw7CiAgICB0aGlzLmxhbmVzID0gTm9MYW5lczsKICAgIHRoaXMuY2hpbGRMYW5lcyA9IE5vTGFuZXM7CiAgICB0aGlzLmFsdGVybmF0ZSA9IG51bGw7CgogICAgewogICAgICAvLyBOb3RlOiBUaGUgZm9sbG93aW5nIGlzIGRvbmUgdG8gYXZvaWQgYSB2OCBwZXJmb3JtYW5jZSBjbGlmZi4KICAgICAgLy8KICAgICAgLy8gSW5pdGlhbGl6aW5nIHRoZSBmaWVsZHMgYmVsb3cgdG8gc21pcyBhbmQgbGF0ZXIgdXBkYXRpbmcgdGhlbSB3aXRoCiAgICAgIC8vIGRvdWJsZSB2YWx1ZXMgd2lsbCBjYXVzZSBGaWJlcnMgdG8gZW5kIHVwIGhhdmluZyBzZXBhcmF0ZSBzaGFwZXMuCiAgICAgIC8vIFRoaXMgYmVoYXZpb3IvYnVnIGhhcyBzb21ldGhpbmcgdG8gZG8gd2l0aCBPYmplY3QucHJldmVudEV4dGVuc2lvbigpLgogICAgICAvLyBGb3J0dW5hdGVseSB0aGlzIG9ubHkgaW1wYWN0cyBERVYgYnVpbGRzLgogICAgICAvLyBVbmZvcnR1bmF0ZWx5IGl0IG1ha2VzIFJlYWN0IHVudXNhYmx5IHNsb3cgZm9yIHNvbWUgYXBwbGljYXRpb25zLgogICAgICAvLyBUbyB3b3JrIGFyb3VuZCB0aGlzLCBpbml0aWFsaXplIHRoZSBmaWVsZHMgYmVsb3cgd2l0aCBkb3VibGVzLgogICAgICAvLwogICAgICAvLyBMZWFybiBtb3JlIGFib3V0IHRoaXMgaGVyZToKICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL3JlYWN0L2lzc3Vlcy8xNDM2NQogICAgICAvLyBodHRwczovL2J1Z3MuY2hyb21pdW0ub3JnL3AvdjgvaXNzdWVzL2RldGFpbD9pZD04NTM4CiAgICAgIHRoaXMuYWN0dWFsRHVyYXRpb24gPSBOdW1iZXIuTmFOOwogICAgICB0aGlzLmFjdHVhbFN0YXJ0VGltZSA9IE51bWJlci5OYU47CiAgICAgIHRoaXMuc2VsZkJhc2VEdXJhdGlvbiA9IE51bWJlci5OYU47CiAgICAgIHRoaXMudHJlZUJhc2VEdXJhdGlvbiA9IE51bWJlci5OYU47IC8vIEl0J3Mgb2theSB0byByZXBsYWNlIHRoZSBpbml0aWFsIGRvdWJsZXMgd2l0aCBzbWlzIGFmdGVyIGluaXRpYWxpemF0aW9uLgogICAgICAvLyBUaGlzIHdvbid0IHRyaWdnZXIgdGhlIHBlcmZvcm1hbmNlIGNsaWZmIG1lbnRpb25lZCBhYm92ZSwKICAgICAgLy8gYW5kIGl0IHNpbXBsaWZpZXMgb3RoZXIgcHJvZmlsZXIgY29kZSAoaW5jbHVkaW5nIERldlRvb2xzKS4KCiAgICAgIHRoaXMuYWN0dWFsRHVyYXRpb24gPSAwOwogICAgICB0aGlzLmFjdHVhbFN0YXJ0VGltZSA9IC0xOwogICAgICB0aGlzLnNlbGZCYXNlRHVyYXRpb24gPSAwOwogICAgICB0aGlzLnRyZWVCYXNlRHVyYXRpb24gPSAwOwogICAgfQoKICAgIHsKICAgICAgLy8gVGhpcyBpc24ndCBkaXJlY3RseSB1c2VkIGJ1dCBpcyBoYW5keSBmb3IgZGVidWdnaW5nIGludGVybmFsczoKICAgICAgdGhpcy5fZGVidWdTb3VyY2UgPSBudWxsOwogICAgICB0aGlzLl9kZWJ1Z093bmVyID0gbnVsbDsKICAgICAgdGhpcy5fZGVidWdOZWVkc1JlbW91bnQgPSBmYWxzZTsKICAgICAgdGhpcy5fZGVidWdIb29rVHlwZXMgPSBudWxsOwoKICAgICAgaWYgKCFoYXNCYWRNYXBQb2x5ZmlsbCAmJiB0eXBlb2YgT2JqZWN0LnByZXZlbnRFeHRlbnNpb25zID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgT2JqZWN0LnByZXZlbnRFeHRlbnNpb25zKHRoaXMpOwogICAgICB9CiAgICB9CiAgfSAvLyBUaGlzIGlzIGEgY29uc3RydWN0b3IgZnVuY3Rpb24sIHJhdGhlciB0aGFuIGEgUE9KTyBjb25zdHJ1Y3Rvciwgc3RpbGwKICAvLyBwbGVhc2UgZW5zdXJlIHdlIGRvIHRoZSBmb2xsb3dpbmc6CiAgLy8gMSkgTm9ib2R5IHNob3VsZCBhZGQgYW55IGluc3RhbmNlIG1ldGhvZHMgb24gdGhpcy4gSW5zdGFuY2UgbWV0aG9kcyBjYW4gYmUKICAvLyAgICBtb3JlIGRpZmZpY3VsdCB0byBwcmVkaWN0IHdoZW4gdGhleSBnZXQgb3B0aW1pemVkIGFuZCB0aGV5IGFyZSBhbG1vc3QKICAvLyAgICBuZXZlciBpbmxpbmVkIHByb3Blcmx5IGluIHN0YXRpYyBjb21waWxlcnMuCiAgLy8gMikgTm9ib2R5IHNob3VsZCByZWx5IG9uIGBpbnN0YW5jZW9mIEZpYmVyYCBmb3IgdHlwZSB0ZXN0aW5nLiBXZSBzaG91bGQKICAvLyAgICBhbHdheXMga25vdyB3aGVuIGl0IGlzIGEgZmliZXIuCiAgLy8gMykgV2UgbWlnaHQgd2FudCB0byBleHBlcmltZW50IHdpdGggdXNpbmcgbnVtZXJpYyBrZXlzIHNpbmNlIHRoZXkgYXJlIGVhc2llcgogIC8vICAgIHRvIG9wdGltaXplIGluIGEgbm9uLUpJVCBlbnZpcm9ubWVudC4KICAvLyA0KSBXZSBjYW4gZWFzaWx5IGdvIGZyb20gYSBjb25zdHJ1Y3RvciB0byBhIGNyZWF0ZUZpYmVyIG9iamVjdCBsaXRlcmFsIGlmIHRoYXQKICAvLyAgICBpcyBmYXN0ZXIuCiAgLy8gNSkgSXQgc2hvdWxkIGJlIGVhc3kgdG8gcG9ydCB0aGlzIHRvIGEgQyBzdHJ1Y3QgYW5kIGtlZXAgYSBDIGltcGxlbWVudGF0aW9uCiAgLy8gICAgY29tcGF0aWJsZS4KCgogIHZhciBjcmVhdGVGaWJlciA9IGZ1bmN0aW9uICh0YWcsIHBlbmRpbmdQcm9wcywga2V5LCBtb2RlKSB7CiAgICAvLyAkRmxvd0ZpeE1lOiB0aGUgc2hhcGVzIGFyZSBleGFjdCBoZXJlIGJ1dCBGbG93IGRvZXNuJ3QgbGlrZSBjb25zdHJ1Y3RvcnMKICAgIHJldHVybiBuZXcgRmliZXJOb2RlKHRhZywgcGVuZGluZ1Byb3BzLCBrZXksIG1vZGUpOwogIH07CgogIGZ1bmN0aW9uIHNob3VsZENvbnN0cnVjdCQxKENvbXBvbmVudCkgewogICAgdmFyIHByb3RvdHlwZSA9IENvbXBvbmVudC5wcm90b3R5cGU7CiAgICByZXR1cm4gISEocHJvdG90eXBlICYmIHByb3RvdHlwZS5pc1JlYWN0Q29tcG9uZW50KTsKICB9CgogIGZ1bmN0aW9uIGlzU2ltcGxlRnVuY3Rpb25Db21wb25lbnQodHlwZSkgewogICAgcmV0dXJuIHR5cGVvZiB0eXBlID09PSAnZnVuY3Rpb24nICYmICFzaG91bGRDb25zdHJ1Y3QkMSh0eXBlKSAmJiB0eXBlLmRlZmF1bHRQcm9wcyA9PT0gdW5kZWZpbmVkOwogIH0KICBmdW5jdGlvbiByZXNvbHZlTGF6eUNvbXBvbmVudFRhZyhDb21wb25lbnQpIHsKICAgIGlmICh0eXBlb2YgQ29tcG9uZW50ID09PSAnZnVuY3Rpb24nKSB7CiAgICAgIHJldHVybiBzaG91bGRDb25zdHJ1Y3QkMShDb21wb25lbnQpID8gQ2xhc3NDb21wb25lbnQgOiBGdW5jdGlvbkNvbXBvbmVudDsKICAgIH0gZWxzZSBpZiAoQ29tcG9uZW50ICE9PSB1bmRlZmluZWQgJiYgQ29tcG9uZW50ICE9PSBudWxsKSB7CiAgICAgIHZhciAkJHR5cGVvZiA9IENvbXBvbmVudC4kJHR5cGVvZjsKCiAgICAgIGlmICgkJHR5cGVvZiA9PT0gUkVBQ1RfRk9SV0FSRF9SRUZfVFlQRSkgewogICAgICAgIHJldHVybiBGb3J3YXJkUmVmOwogICAgICB9CgogICAgICBpZiAoJCR0eXBlb2YgPT09IFJFQUNUX01FTU9fVFlQRSkgewogICAgICAgIHJldHVybiBNZW1vQ29tcG9uZW50OwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIEluZGV0ZXJtaW5hdGVDb21wb25lbnQ7CiAgfSAvLyBUaGlzIGlzIHVzZWQgdG8gY3JlYXRlIGFuIGFsdGVybmF0ZSBmaWJlciB0byBkbyB3b3JrIG9uLgoKICBmdW5jdGlvbiBjcmVhdGVXb3JrSW5Qcm9ncmVzcyhjdXJyZW50LCBwZW5kaW5nUHJvcHMpIHsKICAgIHZhciB3b3JrSW5Qcm9ncmVzcyA9IGN1cnJlbnQuYWx0ZXJuYXRlOwoKICAgIGlmICh3b3JrSW5Qcm9ncmVzcyA9PT0gbnVsbCkgewogICAgICAvLyBXZSB1c2UgYSBkb3VibGUgYnVmZmVyaW5nIHBvb2xpbmcgdGVjaG5pcXVlIGJlY2F1c2Ugd2Uga25vdyB0aGF0IHdlJ2xsCiAgICAgIC8vIG9ubHkgZXZlciBuZWVkIGF0IG1vc3QgdHdvIHZlcnNpb25zIG9mIGEgdHJlZS4gV2UgcG9vbCB0aGUgIm90aGVyIiB1bnVzZWQKICAgICAgLy8gbm9kZSB0aGF0IHdlJ3JlIGZyZWUgdG8gcmV1c2UuIFRoaXMgaXMgbGF6aWx5IGNyZWF0ZWQgdG8gYXZvaWQgYWxsb2NhdGluZwogICAgICAvLyBleHRyYSBvYmplY3RzIGZvciB0aGluZ3MgdGhhdCBhcmUgbmV2ZXIgdXBkYXRlZC4gSXQgYWxzbyBhbGxvdyB1cyB0bwogICAgICAvLyByZWNsYWltIHRoZSBleHRyYSBtZW1vcnkgaWYgbmVlZGVkLgogICAgICB3b3JrSW5Qcm9ncmVzcyA9IGNyZWF0ZUZpYmVyKGN1cnJlbnQudGFnLCBwZW5kaW5nUHJvcHMsIGN1cnJlbnQua2V5LCBjdXJyZW50Lm1vZGUpOwogICAgICB3b3JrSW5Qcm9ncmVzcy5lbGVtZW50VHlwZSA9IGN1cnJlbnQuZWxlbWVudFR5cGU7CiAgICAgIHdvcmtJblByb2dyZXNzLnR5cGUgPSBjdXJyZW50LnR5cGU7CiAgICAgIHdvcmtJblByb2dyZXNzLnN0YXRlTm9kZSA9IGN1cnJlbnQuc3RhdGVOb2RlOwoKICAgICAgewogICAgICAgIC8vIERFVi1vbmx5IGZpZWxkcwogICAgICAgIHdvcmtJblByb2dyZXNzLl9kZWJ1Z1NvdXJjZSA9IGN1cnJlbnQuX2RlYnVnU291cmNlOwogICAgICAgIHdvcmtJblByb2dyZXNzLl9kZWJ1Z093bmVyID0gY3VycmVudC5fZGVidWdPd25lcjsKICAgICAgICB3b3JrSW5Qcm9ncmVzcy5fZGVidWdIb29rVHlwZXMgPSBjdXJyZW50Ll9kZWJ1Z0hvb2tUeXBlczsKICAgICAgfQoKICAgICAgd29ya0luUHJvZ3Jlc3MuYWx0ZXJuYXRlID0gY3VycmVudDsKICAgICAgY3VycmVudC5hbHRlcm5hdGUgPSB3b3JrSW5Qcm9ncmVzczsKICAgIH0gZWxzZSB7CiAgICAgIHdvcmtJblByb2dyZXNzLnBlbmRpbmdQcm9wcyA9IHBlbmRpbmdQcm9wczsgLy8gTmVlZGVkIGJlY2F1c2UgQmxvY2tzIHN0b3JlIGRhdGEgb24gdHlwZS4KCiAgICAgIHdvcmtJblByb2dyZXNzLnR5cGUgPSBjdXJyZW50LnR5cGU7IC8vIFdlIGFscmVhZHkgaGF2ZSBhbiBhbHRlcm5hdGUuCiAgICAgIC8vIFJlc2V0IHRoZSBlZmZlY3QgdGFnLgoKICAgICAgd29ya0luUHJvZ3Jlc3MuZmxhZ3MgPSBOb0ZsYWdzOyAvLyBUaGUgZWZmZWN0cyBhcmUgbm8gbG9uZ2VyIHZhbGlkLgoKICAgICAgd29ya0luUHJvZ3Jlc3Muc3VidHJlZUZsYWdzID0gTm9GbGFnczsKICAgICAgd29ya0luUHJvZ3Jlc3MuZGVsZXRpb25zID0gbnVsbDsKCiAgICAgIHsKICAgICAgICAvLyBXZSBpbnRlbnRpb25hbGx5IHJlc2V0LCByYXRoZXIgdGhhbiBjb3B5LCBhY3R1YWxEdXJhdGlvbiAmIGFjdHVhbFN0YXJ0VGltZS4KICAgICAgICAvLyBUaGlzIHByZXZlbnRzIHRpbWUgZnJvbSBlbmRsZXNzbHkgYWNjdW11bGF0aW5nIGluIG5ldyBjb21taXRzLgogICAgICAgIC8vIFRoaXMgaGFzIHRoZSBkb3duc2lkZSBvZiByZXNldHRpbmcgdmFsdWVzIGZvciBkaWZmZXJlbnQgcHJpb3JpdHkgcmVuZGVycywKICAgICAgICAvLyBCdXQgd29ya3MgZm9yIHlpZWxkaW5nICh0aGUgY29tbW9uIGNhc2UpIGFuZCBzaG91bGQgc3VwcG9ydCByZXN1bWluZy4KICAgICAgICB3b3JrSW5Qcm9ncmVzcy5hY3R1YWxEdXJhdGlvbiA9IDA7CiAgICAgICAgd29ya0luUHJvZ3Jlc3MuYWN0dWFsU3RhcnRUaW1lID0gLTE7CiAgICAgIH0KICAgIH0gLy8gUmVzZXQgYWxsIGVmZmVjdHMgZXhjZXB0IHN0YXRpYyBvbmVzLgogICAgLy8gU3RhdGljIGVmZmVjdHMgYXJlIG5vdCBzcGVjaWZpYyB0byBhIHJlbmRlci4KCgogICAgd29ya0luUHJvZ3Jlc3MuZmxhZ3MgPSBjdXJyZW50LmZsYWdzICYgU3RhdGljTWFzazsKICAgIHdvcmtJblByb2dyZXNzLmNoaWxkTGFuZXMgPSBjdXJyZW50LmNoaWxkTGFuZXM7CiAgICB3b3JrSW5Qcm9ncmVzcy5sYW5lcyA9IGN1cnJlbnQubGFuZXM7CiAgICB3b3JrSW5Qcm9ncmVzcy5jaGlsZCA9IGN1cnJlbnQuY2hpbGQ7CiAgICB3b3JrSW5Qcm9ncmVzcy5tZW1vaXplZFByb3BzID0gY3VycmVudC5tZW1vaXplZFByb3BzOwogICAgd29ya0luUHJvZ3Jlc3MubWVtb2l6ZWRTdGF0ZSA9IGN1cnJlbnQubWVtb2l6ZWRTdGF0ZTsKICAgIHdvcmtJblByb2dyZXNzLnVwZGF0ZVF1ZXVlID0gY3VycmVudC51cGRhdGVRdWV1ZTsgLy8gQ2xvbmUgdGhlIGRlcGVuZGVuY2llcyBvYmplY3QuIFRoaXMgaXMgbXV0YXRlZCBkdXJpbmcgdGhlIHJlbmRlciBwaGFzZSwgc28KICAgIC8vIGl0IGNhbm5vdCBiZSBzaGFyZWQgd2l0aCB0aGUgY3VycmVudCBmaWJlci4KCiAgICB2YXIgY3VycmVudERlcGVuZGVuY2llcyA9IGN1cnJlbnQuZGVwZW5kZW5jaWVzOwogICAgd29ya0luUHJvZ3Jlc3MuZGVwZW5kZW5jaWVzID0gY3VycmVudERlcGVuZGVuY2llcyA9PT0gbnVsbCA/IG51bGwgOiB7CiAgICAgIGxhbmVzOiBjdXJyZW50RGVwZW5kZW5jaWVzLmxhbmVzLAogICAgICBmaXJzdENvbnRleHQ6IGN1cnJlbnREZXBlbmRlbmNpZXMuZmlyc3RDb250ZXh0CiAgICB9OyAvLyBUaGVzZSB3aWxsIGJlIG92ZXJyaWRkZW4gZHVyaW5nIHRoZSBwYXJlbnQncyByZWNvbmNpbGlhdGlvbgoKICAgIHdvcmtJblByb2dyZXNzLnNpYmxpbmcgPSBjdXJyZW50LnNpYmxpbmc7CiAgICB3b3JrSW5Qcm9ncmVzcy5pbmRleCA9IGN1cnJlbnQuaW5kZXg7CiAgICB3b3JrSW5Qcm9ncmVzcy5yZWYgPSBjdXJyZW50LnJlZjsKCiAgICB7CiAgICAgIHdvcmtJblByb2dyZXNzLnNlbGZCYXNlRHVyYXRpb24gPSBjdXJyZW50LnNlbGZCYXNlRHVyYXRpb247CiAgICAgIHdvcmtJblByb2dyZXNzLnRyZWVCYXNlRHVyYXRpb24gPSBjdXJyZW50LnRyZWVCYXNlRHVyYXRpb247CiAgICB9CgogICAgewogICAgICB3b3JrSW5Qcm9ncmVzcy5fZGVidWdOZWVkc1JlbW91bnQgPSBjdXJyZW50Ll9kZWJ1Z05lZWRzUmVtb3VudDsKCiAgICAgIHN3aXRjaCAod29ya0luUHJvZ3Jlc3MudGFnKSB7CiAgICAgICAgY2FzZSBJbmRldGVybWluYXRlQ29tcG9uZW50OgogICAgICAgIGNhc2UgRnVuY3Rpb25Db21wb25lbnQ6CiAgICAgICAgY2FzZSBTaW1wbGVNZW1vQ29tcG9uZW50OgogICAgICAgICAgd29ya0luUHJvZ3Jlc3MudHlwZSA9IHJlc29sdmVGdW5jdGlvbkZvckhvdFJlbG9hZGluZyhjdXJyZW50LnR5cGUpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgQ2xhc3NDb21wb25lbnQ6CiAgICAgICAgICB3b3JrSW5Qcm9ncmVzcy50eXBlID0gcmVzb2x2ZUNsYXNzRm9ySG90UmVsb2FkaW5nKGN1cnJlbnQudHlwZSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSBGb3J3YXJkUmVmOgogICAgICAgICAgd29ya0luUHJvZ3Jlc3MudHlwZSA9IHJlc29sdmVGb3J3YXJkUmVmRm9ySG90UmVsb2FkaW5nKGN1cnJlbnQudHlwZSk7CiAgICAgICAgICBicmVhazsKICAgICAgfQogICAgfQoKICAgIHJldHVybiB3b3JrSW5Qcm9ncmVzczsKICB9IC8vIFVzZWQgdG8gcmV1c2UgYSBGaWJlciBmb3IgYSBzZWNvbmQgcGFzcy4KCiAgZnVuY3Rpb24gcmVzZXRXb3JrSW5Qcm9ncmVzcyh3b3JrSW5Qcm9ncmVzcywgcmVuZGVyTGFuZXMpIHsKICAgIC8vIFRoaXMgcmVzZXRzIHRoZSBGaWJlciB0byB3aGF0IGNyZWF0ZUZpYmVyIG9yIGNyZWF0ZVdvcmtJblByb2dyZXNzIHdvdWxkCiAgICAvLyBoYXZlIHNldCB0aGUgdmFsdWVzIHRvIGJlZm9yZSBkdXJpbmcgdGhlIGZpcnN0IHBhc3MuIElkZWFsbHkgdGhpcyB3b3VsZG4ndAogICAgLy8gYmUgbmVjZXNzYXJ5IGJ1dCB1bmZvcnR1bmF0ZWx5IG1hbnkgY29kZSBwYXRocyByZWFkcyBmcm9tIHRoZSB3b3JrSW5Qcm9ncmVzcwogICAgLy8gd2hlbiB0aGV5IHNob3VsZCBiZSByZWFkaW5nIGZyb20gY3VycmVudCBhbmQgd3JpdGluZyB0byB3b3JrSW5Qcm9ncmVzcy4KICAgIC8vIFdlIGFzc3VtZSBwZW5kaW5nUHJvcHMsIGluZGV4LCBrZXksIHJlZiwgcmV0dXJuIGFyZSBzdGlsbCB1bnRvdWNoZWQgdG8KICAgIC8vIGF2b2lkIGRvaW5nIGFub3RoZXIgcmVjb25jaWxpYXRpb24uCiAgICAvLyBSZXNldCB0aGUgZWZmZWN0IGZsYWdzIGJ1dCBrZWVwIGFueSBQbGFjZW1lbnQgdGFncywgc2luY2UgdGhhdCdzIHNvbWV0aGluZwogICAgLy8gdGhhdCBjaGlsZCBmaWJlciBpcyBzZXR0aW5nLCBub3QgdGhlIHJlY29uY2lsaWF0aW9uLgogICAgd29ya0luUHJvZ3Jlc3MuZmxhZ3MgJj0gU3RhdGljTWFzayB8IFBsYWNlbWVudDsgLy8gVGhlIGVmZmVjdHMgYXJlIG5vIGxvbmdlciB2YWxpZC4KCiAgICB2YXIgY3VycmVudCA9IHdvcmtJblByb2dyZXNzLmFsdGVybmF0ZTsKCiAgICBpZiAoY3VycmVudCA9PT0gbnVsbCkgewogICAgICAvLyBSZXNldCB0byBjcmVhdGVGaWJlcidzIGluaXRpYWwgdmFsdWVzLgogICAgICB3b3JrSW5Qcm9ncmVzcy5jaGlsZExhbmVzID0gTm9MYW5lczsKICAgICAgd29ya0luUHJvZ3Jlc3MubGFuZXMgPSByZW5kZXJMYW5lczsKICAgICAgd29ya0luUHJvZ3Jlc3MuY2hpbGQgPSBudWxsOwogICAgICB3b3JrSW5Qcm9ncmVzcy5zdWJ0cmVlRmxhZ3MgPSBOb0ZsYWdzOwogICAgICB3b3JrSW5Qcm9ncmVzcy5tZW1vaXplZFByb3BzID0gbnVsbDsKICAgICAgd29ya0luUHJvZ3Jlc3MubWVtb2l6ZWRTdGF0ZSA9IG51bGw7CiAgICAgIHdvcmtJblByb2dyZXNzLnVwZGF0ZVF1ZXVlID0gbnVsbDsKICAgICAgd29ya0luUHJvZ3Jlc3MuZGVwZW5kZW5jaWVzID0gbnVsbDsKICAgICAgd29ya0luUHJvZ3Jlc3Muc3RhdGVOb2RlID0gbnVsbDsKCiAgICAgIHsKICAgICAgICAvLyBOb3RlOiBXZSBkb24ndCByZXNldCB0aGUgYWN0dWFsVGltZSBjb3VudHMuIEl0J3MgdXNlZnVsIHRvIGFjY3VtdWxhdGUKICAgICAgICAvLyBhY3R1YWwgdGltZSBhY3Jvc3MgbXVsdGlwbGUgcmVuZGVyIHBhc3Nlcy4KICAgICAgICB3b3JrSW5Qcm9ncmVzcy5zZWxmQmFzZUR1cmF0aW9uID0gMDsKICAgICAgICB3b3JrSW5Qcm9ncmVzcy50cmVlQmFzZUR1cmF0aW9uID0gMDsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgLy8gUmVzZXQgdG8gdGhlIGNsb25lZCB2YWx1ZXMgdGhhdCBjcmVhdGVXb3JrSW5Qcm9ncmVzcyB3b3VsZCd2ZS4KICAgICAgd29ya0luUHJvZ3Jlc3MuY2hpbGRMYW5lcyA9IGN1cnJlbnQuY2hpbGRMYW5lczsKICAgICAgd29ya0luUHJvZ3Jlc3MubGFuZXMgPSBjdXJyZW50LmxhbmVzOwogICAgICB3b3JrSW5Qcm9ncmVzcy5jaGlsZCA9IGN1cnJlbnQuY2hpbGQ7CiAgICAgIHdvcmtJblByb2dyZXNzLnN1YnRyZWVGbGFncyA9IE5vRmxhZ3M7CiAgICAgIHdvcmtJblByb2dyZXNzLmRlbGV0aW9ucyA9IG51bGw7CiAgICAgIHdvcmtJblByb2dyZXNzLm1lbW9pemVkUHJvcHMgPSBjdXJyZW50Lm1lbW9pemVkUHJvcHM7CiAgICAgIHdvcmtJblByb2dyZXNzLm1lbW9pemVkU3RhdGUgPSBjdXJyZW50Lm1lbW9pemVkU3RhdGU7CiAgICAgIHdvcmtJblByb2dyZXNzLnVwZGF0ZVF1ZXVlID0gY3VycmVudC51cGRhdGVRdWV1ZTsgLy8gTmVlZGVkIGJlY2F1c2UgQmxvY2tzIHN0b3JlIGRhdGEgb24gdHlwZS4KCiAgICAgIHdvcmtJblByb2dyZXNzLnR5cGUgPSBjdXJyZW50LnR5cGU7IC8vIENsb25lIHRoZSBkZXBlbmRlbmNpZXMgb2JqZWN0LiBUaGlzIGlzIG11dGF0ZWQgZHVyaW5nIHRoZSByZW5kZXIgcGhhc2UsIHNvCiAgICAgIC8vIGl0IGNhbm5vdCBiZSBzaGFyZWQgd2l0aCB0aGUgY3VycmVudCBmaWJlci4KCiAgICAgIHZhciBjdXJyZW50RGVwZW5kZW5jaWVzID0gY3VycmVudC5kZXBlbmRlbmNpZXM7CiAgICAgIHdvcmtJblByb2dyZXNzLmRlcGVuZGVuY2llcyA9IGN1cnJlbnREZXBlbmRlbmNpZXMgPT09IG51bGwgPyBudWxsIDogewogICAgICAgIGxhbmVzOiBjdXJyZW50RGVwZW5kZW5jaWVzLmxhbmVzLAogICAgICAgIGZpcnN0Q29udGV4dDogY3VycmVudERlcGVuZGVuY2llcy5maXJzdENvbnRleHQKICAgICAgfTsKCiAgICAgIHsKICAgICAgICAvLyBOb3RlOiBXZSBkb24ndCByZXNldCB0aGUgYWN0dWFsVGltZSBjb3VudHMuIEl0J3MgdXNlZnVsIHRvIGFjY3VtdWxhdGUKICAgICAgICAvLyBhY3R1YWwgdGltZSBhY3Jvc3MgbXVsdGlwbGUgcmVuZGVyIHBhc3Nlcy4KICAgICAgICB3b3JrSW5Qcm9ncmVzcy5zZWxmQmFzZUR1cmF0aW9uID0gY3VycmVudC5zZWxmQmFzZUR1cmF0aW9uOwogICAgICAgIHdvcmtJblByb2dyZXNzLnRyZWVCYXNlRHVyYXRpb24gPSBjdXJyZW50LnRyZWVCYXNlRHVyYXRpb247CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gd29ya0luUHJvZ3Jlc3M7CiAgfQogIGZ1bmN0aW9uIGNyZWF0ZUhvc3RSb290RmliZXIodGFnLCBpc1N0cmljdE1vZGUsIGNvbmN1cnJlbnRVcGRhdGVzQnlEZWZhdWx0T3ZlcnJpZGUpIHsKICAgIHZhciBtb2RlOwoKICAgIGlmICh0YWcgPT09IENvbmN1cnJlbnRSb290KSB7CiAgICAgIG1vZGUgPSBDb25jdXJyZW50TW9kZTsKCiAgICAgIGlmIChpc1N0cmljdE1vZGUgPT09IHRydWUpIHsKICAgICAgICBtb2RlIHw9IFN0cmljdExlZ2FjeU1vZGU7CgogICAgICAgIHsKICAgICAgICAgIG1vZGUgfD0gU3RyaWN0RWZmZWN0c01vZGU7CiAgICAgICAgfQogICAgICB9CiAgICB9IGVsc2UgewogICAgICBtb2RlID0gTm9Nb2RlOwogICAgfQoKICAgIGlmICggaXNEZXZUb29sc1ByZXNlbnQpIHsKICAgICAgLy8gQWx3YXlzIGNvbGxlY3QgcHJvZmlsZSB0aW1pbmdzIHdoZW4gRGV2VG9vbHMgYXJlIHByZXNlbnQuCiAgICAgIC8vIFRoaXMgZW5hYmxlcyBEZXZUb29scyB0byBzdGFydCBjYXB0dXJpbmcgdGltaW5nIGF0IGFueSBwb2ludOKAkwogICAgICAvLyBXaXRob3V0IHNvbWUgbm9kZXMgaW4gdGhlIHRyZWUgaGF2aW5nIGVtcHR5IGJhc2UgdGltZXMuCiAgICAgIG1vZGUgfD0gUHJvZmlsZU1vZGU7CiAgICB9CgogICAgcmV0dXJuIGNyZWF0ZUZpYmVyKEhvc3RSb290LCBudWxsLCBudWxsLCBtb2RlKTsKICB9CiAgZnVuY3Rpb24gY3JlYXRlRmliZXJGcm9tVHlwZUFuZFByb3BzKHR5cGUsIC8vIFJlYWN0JEVsZW1lbnRUeXBlCiAga2V5LCBwZW5kaW5nUHJvcHMsIG93bmVyLCBtb2RlLCBsYW5lcykgewogICAgdmFyIGZpYmVyVGFnID0gSW5kZXRlcm1pbmF0ZUNvbXBvbmVudDsgLy8gVGhlIHJlc29sdmVkIHR5cGUgaXMgc2V0IGlmIHdlIGtub3cgd2hhdCB0aGUgZmluYWwgdHlwZSB3aWxsIGJlLiBJLmUuIGl0J3Mgbm90IGxhenkuCgogICAgdmFyIHJlc29sdmVkVHlwZSA9IHR5cGU7CgogICAgaWYgKHR5cGVvZiB0eXBlID09PSAnZnVuY3Rpb24nKSB7CiAgICAgIGlmIChzaG91bGRDb25zdHJ1Y3QkMSh0eXBlKSkgewogICAgICAgIGZpYmVyVGFnID0gQ2xhc3NDb21wb25lbnQ7CgogICAgICAgIHsKICAgICAgICAgIHJlc29sdmVkVHlwZSA9IHJlc29sdmVDbGFzc0ZvckhvdFJlbG9hZGluZyhyZXNvbHZlZFR5cGUpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB7CiAgICAgICAgICByZXNvbHZlZFR5cGUgPSByZXNvbHZlRnVuY3Rpb25Gb3JIb3RSZWxvYWRpbmcocmVzb2x2ZWRUeXBlKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSBpZiAodHlwZW9mIHR5cGUgPT09ICdzdHJpbmcnKSB7CiAgICAgIGZpYmVyVGFnID0gSG9zdENvbXBvbmVudDsKICAgIH0gZWxzZSB7CiAgICAgIGdldFRhZzogc3dpdGNoICh0eXBlKSB7CiAgICAgICAgY2FzZSBSRUFDVF9GUkFHTUVOVF9UWVBFOgogICAgICAgICAgcmV0dXJuIGNyZWF0ZUZpYmVyRnJvbUZyYWdtZW50KHBlbmRpbmdQcm9wcy5jaGlsZHJlbiwgbW9kZSwgbGFuZXMsIGtleSk7CgogICAgICAgIGNhc2UgUkVBQ1RfU1RSSUNUX01PREVfVFlQRToKICAgICAgICAgIGZpYmVyVGFnID0gTW9kZTsKICAgICAgICAgIG1vZGUgfD0gU3RyaWN0TGVnYWN5TW9kZTsKCiAgICAgICAgICBpZiAoIChtb2RlICYgQ29uY3VycmVudE1vZGUpICE9PSBOb01vZGUpIHsKICAgICAgICAgICAgLy8gU3RyaWN0IGVmZmVjdHMgc2hvdWxkIG5ldmVyIHJ1biBvbiBsZWdhY3kgcm9vdHMKICAgICAgICAgICAgbW9kZSB8PSBTdHJpY3RFZmZlY3RzTW9kZTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSBSRUFDVF9QUk9GSUxFUl9UWVBFOgogICAgICAgICAgcmV0dXJuIGNyZWF0ZUZpYmVyRnJvbVByb2ZpbGVyKHBlbmRpbmdQcm9wcywgbW9kZSwgbGFuZXMsIGtleSk7CgogICAgICAgIGNhc2UgUkVBQ1RfU1VTUEVOU0VfVFlQRToKICAgICAgICAgIHJldHVybiBjcmVhdGVGaWJlckZyb21TdXNwZW5zZShwZW5kaW5nUHJvcHMsIG1vZGUsIGxhbmVzLCBrZXkpOwoKICAgICAgICBjYXNlIFJFQUNUX1NVU1BFTlNFX0xJU1RfVFlQRToKICAgICAgICAgIHJldHVybiBjcmVhdGVGaWJlckZyb21TdXNwZW5zZUxpc3QocGVuZGluZ1Byb3BzLCBtb2RlLCBsYW5lcywga2V5KTsKCiAgICAgICAgY2FzZSBSRUFDVF9PRkZTQ1JFRU5fVFlQRToKICAgICAgICAgIHJldHVybiBjcmVhdGVGaWJlckZyb21PZmZzY3JlZW4ocGVuZGluZ1Byb3BzLCBtb2RlLCBsYW5lcywga2V5KTsKCiAgICAgICAgY2FzZSBSRUFDVF9MRUdBQ1lfSElEREVOX1RZUEU6CgogICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1mYWxsdGhyb3VnaAoKICAgICAgICBjYXNlIFJFQUNUX1NDT1BFX1RZUEU6CgogICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1mYWxsdGhyb3VnaAoKICAgICAgICBjYXNlIFJFQUNUX0NBQ0hFX1RZUEU6CgogICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1mYWxsdGhyb3VnaAoKICAgICAgICBjYXNlIFJFQUNUX1RSQUNJTkdfTUFSS0VSX1RZUEU6CgogICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1mYWxsdGhyb3VnaAoKICAgICAgICBjYXNlIFJFQUNUX0RFQlVHX1RSQUNJTkdfTU9ERV9UWVBFOgoKICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tZmFsbHRocm91Z2gKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIHsKICAgICAgICAgICAgaWYgKHR5cGVvZiB0eXBlID09PSAnb2JqZWN0JyAmJiB0eXBlICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgc3dpdGNoICh0eXBlLiQkdHlwZW9mKSB7CiAgICAgICAgICAgICAgICBjYXNlIFJFQUNUX1BST1ZJREVSX1RZUEU6CiAgICAgICAgICAgICAgICAgIGZpYmVyVGFnID0gQ29udGV4dFByb3ZpZGVyOwogICAgICAgICAgICAgICAgICBicmVhayBnZXRUYWc7CgogICAgICAgICAgICAgICAgY2FzZSBSRUFDVF9DT05URVhUX1RZUEU6CiAgICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgYSBjb25zdW1lcgogICAgICAgICAgICAgICAgICBmaWJlclRhZyA9IENvbnRleHRDb25zdW1lcjsKICAgICAgICAgICAgICAgICAgYnJlYWsgZ2V0VGFnOwoKICAgICAgICAgICAgICAgIGNhc2UgUkVBQ1RfRk9SV0FSRF9SRUZfVFlQRToKICAgICAgICAgICAgICAgICAgZmliZXJUYWcgPSBGb3J3YXJkUmVmOwoKICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHJlc29sdmVkVHlwZSA9IHJlc29sdmVGb3J3YXJkUmVmRm9ySG90UmVsb2FkaW5nKHJlc29sdmVkVHlwZSk7CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIGJyZWFrIGdldFRhZzsKCiAgICAgICAgICAgICAgICBjYXNlIFJFQUNUX01FTU9fVFlQRToKICAgICAgICAgICAgICAgICAgZmliZXJUYWcgPSBNZW1vQ29tcG9uZW50OwogICAgICAgICAgICAgICAgICBicmVhayBnZXRUYWc7CgogICAgICAgICAgICAgICAgY2FzZSBSRUFDVF9MQVpZX1RZUEU6CiAgICAgICAgICAgICAgICAgIGZpYmVyVGFnID0gTGF6eUNvbXBvbmVudDsKICAgICAgICAgICAgICAgICAgcmVzb2x2ZWRUeXBlID0gbnVsbDsKICAgICAgICAgICAgICAgICAgYnJlYWsgZ2V0VGFnOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmFyIGluZm8gPSAnJzsKCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpZiAodHlwZSA9PT0gdW5kZWZpbmVkIHx8IHR5cGVvZiB0eXBlID09PSAnb2JqZWN0JyAmJiB0eXBlICE9PSBudWxsICYmIE9iamVjdC5rZXlzKHR5cGUpLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICAgICAgaW5mbyArPSAnIFlvdSBsaWtlbHkgZm9yZ290IHRvIGV4cG9ydCB5b3VyIGNvbXBvbmVudCBmcm9tIHRoZSBmaWxlICcgKyAiaXQncyBkZWZpbmVkIGluLCBvciB5b3UgbWlnaHQgaGF2ZSBtaXhlZCB1cCBkZWZhdWx0IGFuZCAiICsgJ25hbWVkIGltcG9ydHMuJzsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHZhciBvd25lck5hbWUgPSBvd25lciA/IGdldENvbXBvbmVudE5hbWVGcm9tRmliZXIob3duZXIpIDogbnVsbDsKCiAgICAgICAgICAgICAgaWYgKG93bmVyTmFtZSkgewogICAgICAgICAgICAgICAgaW5mbyArPSAnXG5cbkNoZWNrIHRoZSByZW5kZXIgbWV0aG9kIG9mIGAnICsgb3duZXJOYW1lICsgJ2AuJzsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRWxlbWVudCB0eXBlIGlzIGludmFsaWQ6IGV4cGVjdGVkIGEgc3RyaW5nIChmb3IgYnVpbHQtaW4gJyArICdjb21wb25lbnRzKSBvciBhIGNsYXNzL2Z1bmN0aW9uIChmb3IgY29tcG9zaXRlIGNvbXBvbmVudHMpICcgKyAoImJ1dCBnb3Q6ICIgKyAodHlwZSA9PSBudWxsID8gdHlwZSA6IHR5cGVvZiB0eXBlKSArICIuIiArIGluZm8pKTsKICAgICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHZhciBmaWJlciA9IGNyZWF0ZUZpYmVyKGZpYmVyVGFnLCBwZW5kaW5nUHJvcHMsIGtleSwgbW9kZSk7CiAgICBmaWJlci5lbGVtZW50VHlwZSA9IHR5cGU7CiAgICBmaWJlci50eXBlID0gcmVzb2x2ZWRUeXBlOwogICAgZmliZXIubGFuZXMgPSBsYW5lczsKCiAgICB7CiAgICAgIGZpYmVyLl9kZWJ1Z093bmVyID0gb3duZXI7CiAgICB9CgogICAgcmV0dXJuIGZpYmVyOwogIH0KICBmdW5jdGlvbiBjcmVhdGVGaWJlckZyb21FbGVtZW50KGVsZW1lbnQsIG1vZGUsIGxhbmVzKSB7CiAgICB2YXIgb3duZXIgPSBudWxsOwoKICAgIHsKICAgICAgb3duZXIgPSBlbGVtZW50Ll9vd25lcjsKICAgIH0KCiAgICB2YXIgdHlwZSA9IGVsZW1lbnQudHlwZTsKICAgIHZhciBrZXkgPSBlbGVtZW50LmtleTsKICAgIHZhciBwZW5kaW5nUHJvcHMgPSBlbGVtZW50LnByb3BzOwogICAgdmFyIGZpYmVyID0gY3JlYXRlRmliZXJGcm9tVHlwZUFuZFByb3BzKHR5cGUsIGtleSwgcGVuZGluZ1Byb3BzLCBvd25lciwgbW9kZSwgbGFuZXMpOwoKICAgIHsKICAgICAgZmliZXIuX2RlYnVnU291cmNlID0gZWxlbWVudC5fc291cmNlOwogICAgICBmaWJlci5fZGVidWdPd25lciA9IGVsZW1lbnQuX293bmVyOwogICAgfQoKICAgIHJldHVybiBmaWJlcjsKICB9CiAgZnVuY3Rpb24gY3JlYXRlRmliZXJGcm9tRnJhZ21lbnQoZWxlbWVudHMsIG1vZGUsIGxhbmVzLCBrZXkpIHsKICAgIHZhciBmaWJlciA9IGNyZWF0ZUZpYmVyKEZyYWdtZW50LCBlbGVtZW50cywga2V5LCBtb2RlKTsKICAgIGZpYmVyLmxhbmVzID0gbGFuZXM7CiAgICByZXR1cm4gZmliZXI7CiAgfQoKICBmdW5jdGlvbiBjcmVhdGVGaWJlckZyb21Qcm9maWxlcihwZW5kaW5nUHJvcHMsIG1vZGUsIGxhbmVzLCBrZXkpIHsKICAgIHsKICAgICAgaWYgKHR5cGVvZiBwZW5kaW5nUHJvcHMuaWQgIT09ICdzdHJpbmcnKSB7CiAgICAgICAgZXJyb3IoJ1Byb2ZpbGVyIG11c3Qgc3BlY2lmeSBhbiAiaWQiIG9mIHR5cGUgYHN0cmluZ2AgYXMgYSBwcm9wLiBSZWNlaXZlZCB0aGUgdHlwZSBgJXNgIGluc3RlYWQuJywgdHlwZW9mIHBlbmRpbmdQcm9wcy5pZCk7CiAgICAgIH0KICAgIH0KCiAgICB2YXIgZmliZXIgPSBjcmVhdGVGaWJlcihQcm9maWxlciwgcGVuZGluZ1Byb3BzLCBrZXksIG1vZGUgfCBQcm9maWxlTW9kZSk7CiAgICBmaWJlci5lbGVtZW50VHlwZSA9IFJFQUNUX1BST0ZJTEVSX1RZUEU7CiAgICBmaWJlci5sYW5lcyA9IGxhbmVzOwoKICAgIHsKICAgICAgZmliZXIuc3RhdGVOb2RlID0gewogICAgICAgIGVmZmVjdER1cmF0aW9uOiAwLAogICAgICAgIHBhc3NpdmVFZmZlY3REdXJhdGlvbjogMAogICAgICB9OwogICAgfQoKICAgIHJldHVybiBmaWJlcjsKICB9CgogIGZ1bmN0aW9uIGNyZWF0ZUZpYmVyRnJvbVN1c3BlbnNlKHBlbmRpbmdQcm9wcywgbW9kZSwgbGFuZXMsIGtleSkgewogICAgdmFyIGZpYmVyID0gY3JlYXRlRmliZXIoU3VzcGVuc2VDb21wb25lbnQsIHBlbmRpbmdQcm9wcywga2V5LCBtb2RlKTsKICAgIGZpYmVyLmVsZW1lbnRUeXBlID0gUkVBQ1RfU1VTUEVOU0VfVFlQRTsKICAgIGZpYmVyLmxhbmVzID0gbGFuZXM7CiAgICByZXR1cm4gZmliZXI7CiAgfQogIGZ1bmN0aW9uIGNyZWF0ZUZpYmVyRnJvbVN1c3BlbnNlTGlzdChwZW5kaW5nUHJvcHMsIG1vZGUsIGxhbmVzLCBrZXkpIHsKICAgIHZhciBmaWJlciA9IGNyZWF0ZUZpYmVyKFN1c3BlbnNlTGlzdENvbXBvbmVudCwgcGVuZGluZ1Byb3BzLCBrZXksIG1vZGUpOwogICAgZmliZXIuZWxlbWVudFR5cGUgPSBSRUFDVF9TVVNQRU5TRV9MSVNUX1RZUEU7CiAgICBmaWJlci5sYW5lcyA9IGxhbmVzOwogICAgcmV0dXJuIGZpYmVyOwogIH0KICBmdW5jdGlvbiBjcmVhdGVGaWJlckZyb21PZmZzY3JlZW4ocGVuZGluZ1Byb3BzLCBtb2RlLCBsYW5lcywga2V5KSB7CiAgICB2YXIgZmliZXIgPSBjcmVhdGVGaWJlcihPZmZzY3JlZW5Db21wb25lbnQsIHBlbmRpbmdQcm9wcywga2V5LCBtb2RlKTsKICAgIGZpYmVyLmVsZW1lbnRUeXBlID0gUkVBQ1RfT0ZGU0NSRUVOX1RZUEU7CiAgICBmaWJlci5sYW5lcyA9IGxhbmVzOwogICAgdmFyIHByaW1hcnlDaGlsZEluc3RhbmNlID0gewogICAgICBpc0hpZGRlbjogZmFsc2UKICAgIH07CiAgICBmaWJlci5zdGF0ZU5vZGUgPSBwcmltYXJ5Q2hpbGRJbnN0YW5jZTsKICAgIHJldHVybiBmaWJlcjsKICB9CiAgZnVuY3Rpb24gY3JlYXRlRmliZXJGcm9tVGV4dChjb250ZW50LCBtb2RlLCBsYW5lcykgewogICAgdmFyIGZpYmVyID0gY3JlYXRlRmliZXIoSG9zdFRleHQsIGNvbnRlbnQsIG51bGwsIG1vZGUpOwogICAgZmliZXIubGFuZXMgPSBsYW5lczsKICAgIHJldHVybiBmaWJlcjsKICB9CiAgZnVuY3Rpb24gY3JlYXRlRmliZXJGcm9tSG9zdEluc3RhbmNlRm9yRGVsZXRpb24oKSB7CiAgICB2YXIgZmliZXIgPSBjcmVhdGVGaWJlcihIb3N0Q29tcG9uZW50LCBudWxsLCBudWxsLCBOb01vZGUpOwogICAgZmliZXIuZWxlbWVudFR5cGUgPSAnREVMRVRFRCc7CiAgICByZXR1cm4gZmliZXI7CiAgfQogIGZ1bmN0aW9uIGNyZWF0ZUZpYmVyRnJvbURlaHlkcmF0ZWRGcmFnbWVudChkZWh5ZHJhdGVkTm9kZSkgewogICAgdmFyIGZpYmVyID0gY3JlYXRlRmliZXIoRGVoeWRyYXRlZEZyYWdtZW50LCBudWxsLCBudWxsLCBOb01vZGUpOwogICAgZmliZXIuc3RhdGVOb2RlID0gZGVoeWRyYXRlZE5vZGU7CiAgICByZXR1cm4gZmliZXI7CiAgfQogIGZ1bmN0aW9uIGNyZWF0ZUZpYmVyRnJvbVBvcnRhbChwb3J0YWwsIG1vZGUsIGxhbmVzKSB7CiAgICB2YXIgcGVuZGluZ1Byb3BzID0gcG9ydGFsLmNoaWxkcmVuICE9PSBudWxsID8gcG9ydGFsLmNoaWxkcmVuIDogW107CiAgICB2YXIgZmliZXIgPSBjcmVhdGVGaWJlcihIb3N0UG9ydGFsLCBwZW5kaW5nUHJvcHMsIHBvcnRhbC5rZXksIG1vZGUpOwogICAgZmliZXIubGFuZXMgPSBsYW5lczsKICAgIGZpYmVyLnN0YXRlTm9kZSA9IHsKICAgICAgY29udGFpbmVySW5mbzogcG9ydGFsLmNvbnRhaW5lckluZm8sCiAgICAgIHBlbmRpbmdDaGlsZHJlbjogbnVsbCwKICAgICAgLy8gVXNlZCBieSBwZXJzaXN0ZW50IHVwZGF0ZXMKICAgICAgaW1wbGVtZW50YXRpb246IHBvcnRhbC5pbXBsZW1lbnRhdGlvbgogICAgfTsKICAgIHJldHVybiBmaWJlcjsKICB9IC8vIFVzZWQgZm9yIHN0YXNoaW5nIFdJUCBwcm9wZXJ0aWVzIHRvIHJlcGxheSBmYWlsZWQgd29yayBpbiBERVYuCgogIGZ1bmN0aW9uIGFzc2lnbkZpYmVyUHJvcGVydGllc0luREVWKHRhcmdldCwgc291cmNlKSB7CiAgICBpZiAodGFyZ2V0ID09PSBudWxsKSB7CiAgICAgIC8vIFRoaXMgRmliZXIncyBpbml0aWFsIHByb3BlcnRpZXMgd2lsbCBhbHdheXMgYmUgb3ZlcndyaXR0ZW4uCiAgICAgIC8vIFdlIG9ubHkgdXNlIGEgRmliZXIgdG8gZW5zdXJlIHRoZSBzYW1lIGhpZGRlbiBjbGFzcyBzbyBERVYgaXNuJ3Qgc2xvdy4KICAgICAgdGFyZ2V0ID0gY3JlYXRlRmliZXIoSW5kZXRlcm1pbmF0ZUNvbXBvbmVudCwgbnVsbCwgbnVsbCwgTm9Nb2RlKTsKICAgIH0gLy8gVGhpcyBpcyBpbnRlbnRpb25hbGx5IHdyaXR0ZW4gYXMgYSBsaXN0IG9mIGFsbCBwcm9wZXJ0aWVzLgogICAgLy8gV2UgdHJpZWQgdG8gdXNlIE9iamVjdC5hc3NpZ24oKSBpbnN0ZWFkIGJ1dCB0aGlzIGlzIGNhbGxlZCBpbgogICAgLy8gdGhlIGhvdHRlc3QgcGF0aCwgYW5kIE9iamVjdC5hc3NpZ24oKSB3YXMgdG9vIHNsb3c6CiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2svcmVhY3QvaXNzdWVzLzEyNTAyCiAgICAvLyBUaGlzIGNvZGUgaXMgREVWLW9ubHkgc28gc2l6ZSBpcyBub3QgYSBjb25jZXJuLgoKCiAgICB0YXJnZXQudGFnID0gc291cmNlLnRhZzsKICAgIHRhcmdldC5rZXkgPSBzb3VyY2Uua2V5OwogICAgdGFyZ2V0LmVsZW1lbnRUeXBlID0gc291cmNlLmVsZW1lbnRUeXBlOwogICAgdGFyZ2V0LnR5cGUgPSBzb3VyY2UudHlwZTsKICAgIHRhcmdldC5zdGF0ZU5vZGUgPSBzb3VyY2Uuc3RhdGVOb2RlOwogICAgdGFyZ2V0LnJldHVybiA9IHNvdXJjZS5yZXR1cm47CiAgICB0YXJnZXQuY2hpbGQgPSBzb3VyY2UuY2hpbGQ7CiAgICB0YXJnZXQuc2libGluZyA9IHNvdXJjZS5zaWJsaW5nOwogICAgdGFyZ2V0LmluZGV4ID0gc291cmNlLmluZGV4OwogICAgdGFyZ2V0LnJlZiA9IHNvdXJjZS5yZWY7CiAgICB0YXJnZXQucGVuZGluZ1Byb3BzID0gc291cmNlLnBlbmRpbmdQcm9wczsKICAgIHRhcmdldC5tZW1vaXplZFByb3BzID0gc291cmNlLm1lbW9pemVkUHJvcHM7CiAgICB0YXJnZXQudXBkYXRlUXVldWUgPSBzb3VyY2UudXBkYXRlUXVldWU7CiAgICB0YXJnZXQubWVtb2l6ZWRTdGF0ZSA9IHNvdXJjZS5tZW1vaXplZFN0YXRlOwogICAgdGFyZ2V0LmRlcGVuZGVuY2llcyA9IHNvdXJjZS5kZXBlbmRlbmNpZXM7CiAgICB0YXJnZXQubW9kZSA9IHNvdXJjZS5tb2RlOwogICAgdGFyZ2V0LmZsYWdzID0gc291cmNlLmZsYWdzOwogICAgdGFyZ2V0LnN1YnRyZWVGbGFncyA9IHNvdXJjZS5zdWJ0cmVlRmxhZ3M7CiAgICB0YXJnZXQuZGVsZXRpb25zID0gc291cmNlLmRlbGV0aW9uczsKICAgIHRhcmdldC5sYW5lcyA9IHNvdXJjZS5sYW5lczsKICAgIHRhcmdldC5jaGlsZExhbmVzID0gc291cmNlLmNoaWxkTGFuZXM7CiAgICB0YXJnZXQuYWx0ZXJuYXRlID0gc291cmNlLmFsdGVybmF0ZTsKCiAgICB7CiAgICAgIHRhcmdldC5hY3R1YWxEdXJhdGlvbiA9IHNvdXJjZS5hY3R1YWxEdXJhdGlvbjsKICAgICAgdGFyZ2V0LmFjdHVhbFN0YXJ0VGltZSA9IHNvdXJjZS5hY3R1YWxTdGFydFRpbWU7CiAgICAgIHRhcmdldC5zZWxmQmFzZUR1cmF0aW9uID0gc291cmNlLnNlbGZCYXNlRHVyYXRpb247CiAgICAgIHRhcmdldC50cmVlQmFzZUR1cmF0aW9uID0gc291cmNlLnRyZWVCYXNlRHVyYXRpb247CiAgICB9CgogICAgdGFyZ2V0Ll9kZWJ1Z1NvdXJjZSA9IHNvdXJjZS5fZGVidWdTb3VyY2U7CiAgICB0YXJnZXQuX2RlYnVnT3duZXIgPSBzb3VyY2UuX2RlYnVnT3duZXI7CiAgICB0YXJnZXQuX2RlYnVnTmVlZHNSZW1vdW50ID0gc291cmNlLl9kZWJ1Z05lZWRzUmVtb3VudDsKICAgIHRhcmdldC5fZGVidWdIb29rVHlwZXMgPSBzb3VyY2UuX2RlYnVnSG9va1R5cGVzOwogICAgcmV0dXJuIHRhcmdldDsKICB9CgogIGZ1bmN0aW9uIEZpYmVyUm9vdE5vZGUoY29udGFpbmVySW5mbywgdGFnLCBoeWRyYXRlLCBpZGVudGlmaWVyUHJlZml4LCBvblJlY292ZXJhYmxlRXJyb3IpIHsKICAgIHRoaXMudGFnID0gdGFnOwogICAgdGhpcy5jb250YWluZXJJbmZvID0gY29udGFpbmVySW5mbzsKICAgIHRoaXMucGVuZGluZ0NoaWxkcmVuID0gbnVsbDsKICAgIHRoaXMuY3VycmVudCA9IG51bGw7CiAgICB0aGlzLnBpbmdDYWNoZSA9IG51bGw7CiAgICB0aGlzLmZpbmlzaGVkV29yayA9IG51bGw7CiAgICB0aGlzLnRpbWVvdXRIYW5kbGUgPSBub1RpbWVvdXQ7CiAgICB0aGlzLmNvbnRleHQgPSBudWxsOwogICAgdGhpcy5wZW5kaW5nQ29udGV4dCA9IG51bGw7CiAgICB0aGlzLmNhbGxiYWNrTm9kZSA9IG51bGw7CiAgICB0aGlzLmNhbGxiYWNrUHJpb3JpdHkgPSBOb0xhbmU7CiAgICB0aGlzLmV2ZW50VGltZXMgPSBjcmVhdGVMYW5lTWFwKE5vTGFuZXMpOwogICAgdGhpcy5leHBpcmF0aW9uVGltZXMgPSBjcmVhdGVMYW5lTWFwKE5vVGltZXN0YW1wKTsKICAgIHRoaXMucGVuZGluZ0xhbmVzID0gTm9MYW5lczsKICAgIHRoaXMuc3VzcGVuZGVkTGFuZXMgPSBOb0xhbmVzOwogICAgdGhpcy5waW5nZWRMYW5lcyA9IE5vTGFuZXM7CiAgICB0aGlzLmV4cGlyZWRMYW5lcyA9IE5vTGFuZXM7CiAgICB0aGlzLm11dGFibGVSZWFkTGFuZXMgPSBOb0xhbmVzOwogICAgdGhpcy5maW5pc2hlZExhbmVzID0gTm9MYW5lczsKICAgIHRoaXMuZW50YW5nbGVkTGFuZXMgPSBOb0xhbmVzOwogICAgdGhpcy5lbnRhbmdsZW1lbnRzID0gY3JlYXRlTGFuZU1hcChOb0xhbmVzKTsKICAgIHRoaXMuaWRlbnRpZmllclByZWZpeCA9IGlkZW50aWZpZXJQcmVmaXg7CiAgICB0aGlzLm9uUmVjb3ZlcmFibGVFcnJvciA9IG9uUmVjb3ZlcmFibGVFcnJvcjsKCiAgICB7CiAgICAgIHRoaXMubXV0YWJsZVNvdXJjZUVhZ2VySHlkcmF0aW9uRGF0YSA9IG51bGw7CiAgICB9CgogICAgewogICAgICB0aGlzLmVmZmVjdER1cmF0aW9uID0gMDsKICAgICAgdGhpcy5wYXNzaXZlRWZmZWN0RHVyYXRpb24gPSAwOwogICAgfQoKICAgIHsKICAgICAgdGhpcy5tZW1vaXplZFVwZGF0ZXJzID0gbmV3IFNldCgpOwogICAgICB2YXIgcGVuZGluZ1VwZGF0ZXJzTGFuZU1hcCA9IHRoaXMucGVuZGluZ1VwZGF0ZXJzTGFuZU1hcCA9IFtdOwoKICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IFRvdGFsTGFuZXM7IF9pKyspIHsKICAgICAgICBwZW5kaW5nVXBkYXRlcnNMYW5lTWFwLnB1c2gobmV3IFNldCgpKTsKICAgICAgfQogICAgfQoKICAgIHsKICAgICAgc3dpdGNoICh0YWcpIHsKICAgICAgICBjYXNlIENvbmN1cnJlbnRSb290OgogICAgICAgICAgdGhpcy5fZGVidWdSb290VHlwZSA9IGh5ZHJhdGUgPyAnaHlkcmF0ZVJvb3QoKScgOiAnY3JlYXRlUm9vdCgpJzsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIExlZ2FjeVJvb3Q6CiAgICAgICAgICB0aGlzLl9kZWJ1Z1Jvb3RUeXBlID0gaHlkcmF0ZSA/ICdoeWRyYXRlKCknIDogJ3JlbmRlcigpJzsKICAgICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiBjcmVhdGVGaWJlclJvb3QoY29udGFpbmVySW5mbywgdGFnLCBoeWRyYXRlLCBpbml0aWFsQ2hpbGRyZW4sIGh5ZHJhdGlvbkNhbGxiYWNrcywgaXNTdHJpY3RNb2RlLCBjb25jdXJyZW50VXBkYXRlc0J5RGVmYXVsdE92ZXJyaWRlLCAvLyBUT0RPOiBXZSBoYXZlIHNldmVyYWwgb2YgdGhlc2UgYXJndW1lbnRzIHRoYXQgYXJlIGNvbmNlcHR1YWxseSBwYXJ0IG9mIHRoZQogIC8vIGhvc3QgY29uZmlnLCBidXQgYmVjYXVzZSB0aGV5IGFyZSBwYXNzZWQgaW4gYXQgcnVudGltZSwgd2UgaGF2ZSB0byB0aHJlYWQKICAvLyB0aGVtIHRocm91Z2ggdGhlIHJvb3QgY29uc3RydWN0b3IuIFBlcmhhcHMgd2Ugc2hvdWxkIHB1dCB0aGVtIGFsbCBpbnRvIGEKICAvLyBzaW5nbGUgdHlwZSwgbGlrZSBhIER5bmFtaWNIb3N0Q29uZmlnIHRoYXQgaXMgZGVmaW5lZCBieSB0aGUgcmVuZGVyZXIuCiAgaWRlbnRpZmllclByZWZpeCwgb25SZWNvdmVyYWJsZUVycm9yLCB0cmFuc2l0aW9uQ2FsbGJhY2tzKSB7CiAgICB2YXIgcm9vdCA9IG5ldyBGaWJlclJvb3ROb2RlKGNvbnRhaW5lckluZm8sIHRhZywgaHlkcmF0ZSwgaWRlbnRpZmllclByZWZpeCwgb25SZWNvdmVyYWJsZUVycm9yKTsKICAgIC8vIHN0YXRlTm9kZSBpcyBhbnkuCgoKICAgIHZhciB1bmluaXRpYWxpemVkRmliZXIgPSBjcmVhdGVIb3N0Um9vdEZpYmVyKHRhZywgaXNTdHJpY3RNb2RlKTsKICAgIHJvb3QuY3VycmVudCA9IHVuaW5pdGlhbGl6ZWRGaWJlcjsKICAgIHVuaW5pdGlhbGl6ZWRGaWJlci5zdGF0ZU5vZGUgPSByb290OwoKICAgIHsKICAgICAgdmFyIF9pbml0aWFsU3RhdGUgPSB7CiAgICAgICAgZWxlbWVudDogaW5pdGlhbENoaWxkcmVuLAogICAgICAgIGlzRGVoeWRyYXRlZDogaHlkcmF0ZSwKICAgICAgICBjYWNoZTogbnVsbCwKICAgICAgICAvLyBub3QgZW5hYmxlZCB5ZXQKICAgICAgICB0cmFuc2l0aW9uczogbnVsbCwKICAgICAgICBwZW5kaW5nU3VzcGVuc2VCb3VuZGFyaWVzOiBudWxsCiAgICAgIH07CiAgICAgIHVuaW5pdGlhbGl6ZWRGaWJlci5tZW1vaXplZFN0YXRlID0gX2luaXRpYWxTdGF0ZTsKICAgIH0KCiAgICBpbml0aWFsaXplVXBkYXRlUXVldWUodW5pbml0aWFsaXplZEZpYmVyKTsKICAgIHJldHVybiByb290OwogIH0KCiAgdmFyIFJlYWN0VmVyc2lvbiA9ICcxOC4zLjEnOwoKICBmdW5jdGlvbiBjcmVhdGVQb3J0YWwoY2hpbGRyZW4sIGNvbnRhaW5lckluZm8sIC8vIFRPRE86IGZpZ3VyZSBvdXQgdGhlIEFQSSBmb3IgY3Jvc3MtcmVuZGVyZXIgaW1wbGVtZW50YXRpb24uCiAgaW1wbGVtZW50YXRpb24pIHsKICAgIHZhciBrZXkgPSBhcmd1bWVudHMubGVuZ3RoID4gMyAmJiBhcmd1bWVudHNbM10gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1szXSA6IG51bGw7CgogICAgewogICAgICBjaGVja0tleVN0cmluZ0NvZXJjaW9uKGtleSk7CiAgICB9CgogICAgcmV0dXJuIHsKICAgICAgLy8gVGhpcyB0YWcgYWxsb3cgdXMgdG8gdW5pcXVlbHkgaWRlbnRpZnkgdGhpcyBhcyBhIFJlYWN0IFBvcnRhbAogICAgICAkJHR5cGVvZjogUkVBQ1RfUE9SVEFMX1RZUEUsCiAgICAgIGtleToga2V5ID09IG51bGwgPyBudWxsIDogJycgKyBrZXksCiAgICAgIGNoaWxkcmVuOiBjaGlsZHJlbiwKICAgICAgY29udGFpbmVySW5mbzogY29udGFpbmVySW5mbywKICAgICAgaW1wbGVtZW50YXRpb246IGltcGxlbWVudGF0aW9uCiAgICB9OwogIH0KCiAgdmFyIGRpZFdhcm5BYm91dE5lc3RlZFVwZGF0ZXM7CiAgdmFyIGRpZFdhcm5BYm91dEZpbmROb2RlSW5TdHJpY3RNb2RlOwoKICB7CiAgICBkaWRXYXJuQWJvdXROZXN0ZWRVcGRhdGVzID0gZmFsc2U7CiAgICBkaWRXYXJuQWJvdXRGaW5kTm9kZUluU3RyaWN0TW9kZSA9IHt9OwogIH0KCiAgZnVuY3Rpb24gZ2V0Q29udGV4dEZvclN1YnRyZWUocGFyZW50Q29tcG9uZW50KSB7CiAgICBpZiAoIXBhcmVudENvbXBvbmVudCkgewogICAgICByZXR1cm4gZW1wdHlDb250ZXh0T2JqZWN0OwogICAgfQoKICAgIHZhciBmaWJlciA9IGdldChwYXJlbnRDb21wb25lbnQpOwogICAgdmFyIHBhcmVudENvbnRleHQgPSBmaW5kQ3VycmVudFVubWFza2VkQ29udGV4dChmaWJlcik7CgogICAgaWYgKGZpYmVyLnRhZyA9PT0gQ2xhc3NDb21wb25lbnQpIHsKICAgICAgdmFyIENvbXBvbmVudCA9IGZpYmVyLnR5cGU7CgogICAgICBpZiAoaXNDb250ZXh0UHJvdmlkZXIoQ29tcG9uZW50KSkgewogICAgICAgIHJldHVybiBwcm9jZXNzQ2hpbGRDb250ZXh0KGZpYmVyLCBDb21wb25lbnQsIHBhcmVudENvbnRleHQpOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHBhcmVudENvbnRleHQ7CiAgfQoKICBmdW5jdGlvbiBmaW5kSG9zdEluc3RhbmNlV2l0aFdhcm5pbmcoY29tcG9uZW50LCBtZXRob2ROYW1lKSB7CiAgICB7CiAgICAgIHZhciBmaWJlciA9IGdldChjb21wb25lbnQpOwoKICAgICAgaWYgKGZpYmVyID09PSB1bmRlZmluZWQpIHsKICAgICAgICBpZiAodHlwZW9mIGNvbXBvbmVudC5yZW5kZXIgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVW5hYmxlIHRvIGZpbmQgbm9kZSBvbiBhbiB1bm1vdW50ZWQgY29tcG9uZW50LicpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKGNvbXBvbmVudCkuam9pbignLCcpOwogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJBcmd1bWVudCBhcHBlYXJzIHRvIG5vdCBiZSBhIFJlYWN0Q29tcG9uZW50LiBLZXlzOiAiICsga2V5cyk7CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgaG9zdEZpYmVyID0gZmluZEN1cnJlbnRIb3N0RmliZXIoZmliZXIpOwoKICAgICAgaWYgKGhvc3RGaWJlciA9PT0gbnVsbCkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICBpZiAoaG9zdEZpYmVyLm1vZGUgJiBTdHJpY3RMZWdhY3lNb2RlKSB7CiAgICAgICAgdmFyIGNvbXBvbmVudE5hbWUgPSBnZXRDb21wb25lbnROYW1lRnJvbUZpYmVyKGZpYmVyKSB8fCAnQ29tcG9uZW50JzsKCiAgICAgICAgaWYgKCFkaWRXYXJuQWJvdXRGaW5kTm9kZUluU3RyaWN0TW9kZVtjb21wb25lbnROYW1lXSkgewogICAgICAgICAgZGlkV2FybkFib3V0RmluZE5vZGVJblN0cmljdE1vZGVbY29tcG9uZW50TmFtZV0gPSB0cnVlOwogICAgICAgICAgdmFyIHByZXZpb3VzRmliZXIgPSBjdXJyZW50OwoKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIHNldEN1cnJlbnRGaWJlcihob3N0RmliZXIpOwoKICAgICAgICAgICAgaWYgKGZpYmVyLm1vZGUgJiBTdHJpY3RMZWdhY3lNb2RlKSB7CiAgICAgICAgICAgICAgZXJyb3IoJyVzIGlzIGRlcHJlY2F0ZWQgaW4gU3RyaWN0TW9kZS4gJyArICclcyB3YXMgcGFzc2VkIGFuIGluc3RhbmNlIG9mICVzIHdoaWNoIGlzIGluc2lkZSBTdHJpY3RNb2RlLiAnICsgJ0luc3RlYWQsIGFkZCBhIHJlZiBkaXJlY3RseSB0byB0aGUgZWxlbWVudCB5b3Ugd2FudCB0byByZWZlcmVuY2UuICcgKyAnTGVhcm4gbW9yZSBhYm91dCB1c2luZyByZWZzIHNhZmVseSBoZXJlOiAnICsgJ2h0dHBzOi8vcmVhY3Rqcy5vcmcvbGluay9zdHJpY3QtbW9kZS1maW5kLW5vZGUnLCBtZXRob2ROYW1lLCBtZXRob2ROYW1lLCBjb21wb25lbnROYW1lKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBlcnJvcignJXMgaXMgZGVwcmVjYXRlZCBpbiBTdHJpY3RNb2RlLiAnICsgJyVzIHdhcyBwYXNzZWQgYW4gaW5zdGFuY2Ugb2YgJXMgd2hpY2ggcmVuZGVycyBTdHJpY3RNb2RlIGNoaWxkcmVuLiAnICsgJ0luc3RlYWQsIGFkZCBhIHJlZiBkaXJlY3RseSB0byB0aGUgZWxlbWVudCB5b3Ugd2FudCB0byByZWZlcmVuY2UuICcgKyAnTGVhcm4gbW9yZSBhYm91dCB1c2luZyByZWZzIHNhZmVseSBoZXJlOiAnICsgJ2h0dHBzOi8vcmVhY3Rqcy5vcmcvbGluay9zdHJpY3QtbW9kZS1maW5kLW5vZGUnLCBtZXRob2ROYW1lLCBtZXRob2ROYW1lLCBjb21wb25lbnROYW1lKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgLy8gSWRlYWxseSB0aGlzIHNob3VsZCByZXNldCB0byBwcmV2aW91cyBidXQgdGhpcyBzaG91bGRuJ3QgYmUgY2FsbGVkIGluCiAgICAgICAgICAgIC8vIHJlbmRlciBhbmQgdGhlcmUncyBhbm90aGVyIHdhcm5pbmcgZm9yIHRoYXQgYW55d2F5LgogICAgICAgICAgICBpZiAocHJldmlvdXNGaWJlcikgewogICAgICAgICAgICAgIHNldEN1cnJlbnRGaWJlcihwcmV2aW91c0ZpYmVyKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICByZXNldEN1cnJlbnRGaWJlcigpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gaG9zdEZpYmVyLnN0YXRlTm9kZTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGNyZWF0ZUNvbnRhaW5lcihjb250YWluZXJJbmZvLCB0YWcsIGh5ZHJhdGlvbkNhbGxiYWNrcywgaXNTdHJpY3RNb2RlLCBjb25jdXJyZW50VXBkYXRlc0J5RGVmYXVsdE92ZXJyaWRlLCBpZGVudGlmaWVyUHJlZml4LCBvblJlY292ZXJhYmxlRXJyb3IsIHRyYW5zaXRpb25DYWxsYmFja3MpIHsKICAgIHZhciBoeWRyYXRlID0gZmFsc2U7CiAgICB2YXIgaW5pdGlhbENoaWxkcmVuID0gbnVsbDsKICAgIHJldHVybiBjcmVhdGVGaWJlclJvb3QoY29udGFpbmVySW5mbywgdGFnLCBoeWRyYXRlLCBpbml0aWFsQ2hpbGRyZW4sIGh5ZHJhdGlvbkNhbGxiYWNrcywgaXNTdHJpY3RNb2RlLCBjb25jdXJyZW50VXBkYXRlc0J5RGVmYXVsdE92ZXJyaWRlLCBpZGVudGlmaWVyUHJlZml4LCBvblJlY292ZXJhYmxlRXJyb3IpOwogIH0KICBmdW5jdGlvbiBjcmVhdGVIeWRyYXRpb25Db250YWluZXIoaW5pdGlhbENoaWxkcmVuLCAvLyBUT0RPOiBSZW1vdmUgYGNhbGxiYWNrYCB3aGVuIHdlIGRlbGV0ZSBsZWdhY3kgbW9kZS4KICBjYWxsYmFjaywgY29udGFpbmVySW5mbywgdGFnLCBoeWRyYXRpb25DYWxsYmFja3MsIGlzU3RyaWN0TW9kZSwgY29uY3VycmVudFVwZGF0ZXNCeURlZmF1bHRPdmVycmlkZSwgaWRlbnRpZmllclByZWZpeCwgb25SZWNvdmVyYWJsZUVycm9yLCB0cmFuc2l0aW9uQ2FsbGJhY2tzKSB7CiAgICB2YXIgaHlkcmF0ZSA9IHRydWU7CiAgICB2YXIgcm9vdCA9IGNyZWF0ZUZpYmVyUm9vdChjb250YWluZXJJbmZvLCB0YWcsIGh5ZHJhdGUsIGluaXRpYWxDaGlsZHJlbiwgaHlkcmF0aW9uQ2FsbGJhY2tzLCBpc1N0cmljdE1vZGUsIGNvbmN1cnJlbnRVcGRhdGVzQnlEZWZhdWx0T3ZlcnJpZGUsIGlkZW50aWZpZXJQcmVmaXgsIG9uUmVjb3ZlcmFibGVFcnJvcik7IC8vIFRPRE86IE1vdmUgdGhpcyB0byBGaWJlclJvb3QgY29uc3RydWN0b3IKCiAgICByb290LmNvbnRleHQgPSBnZXRDb250ZXh0Rm9yU3VidHJlZShudWxsKTsgLy8gU2NoZWR1bGUgdGhlIGluaXRpYWwgcmVuZGVyLiBJbiBhIGh5ZHJhdGlvbiByb290LCB0aGlzIGlzIGRpZmZlcmVudCBmcm9tCiAgICAvLyBhIHJlZ3VsYXIgdXBkYXRlIGJlY2F1c2UgdGhlIGluaXRpYWwgcmVuZGVyIG11c3QgbWF0Y2ggd2FzIHdhcyByZW5kZXJlZAogICAgLy8gb24gdGhlIHNlcnZlci4KICAgIC8vIE5PVEU6IFRoaXMgdXBkYXRlIGludGVudGlvbmFsbHkgZG9lc24ndCBoYXZlIGEgcGF5bG9hZC4gV2UncmUgb25seSB1c2luZwogICAgLy8gdGhlIHVwZGF0ZSB0byBzY2hlZHVsZSB3b3JrIG9uIHRoZSByb290IGZpYmVyIChhbmQsIGZvciBsZWdhY3kgcm9vdHMsIHRvCiAgICAvLyBlbnF1ZXVlIHRoZSBjYWxsYmFjayBpZiBvbmUgaXMgcHJvdmlkZWQpLgoKICAgIHZhciBjdXJyZW50ID0gcm9vdC5jdXJyZW50OwogICAgdmFyIGV2ZW50VGltZSA9IHJlcXVlc3RFdmVudFRpbWUoKTsKICAgIHZhciBsYW5lID0gcmVxdWVzdFVwZGF0ZUxhbmUoY3VycmVudCk7CiAgICB2YXIgdXBkYXRlID0gY3JlYXRlVXBkYXRlKGV2ZW50VGltZSwgbGFuZSk7CiAgICB1cGRhdGUuY2FsbGJhY2sgPSBjYWxsYmFjayAhPT0gdW5kZWZpbmVkICYmIGNhbGxiYWNrICE9PSBudWxsID8gY2FsbGJhY2sgOiBudWxsOwogICAgZW5xdWV1ZVVwZGF0ZShjdXJyZW50LCB1cGRhdGUsIGxhbmUpOwogICAgc2NoZWR1bGVJbml0aWFsSHlkcmF0aW9uT25Sb290KHJvb3QsIGxhbmUsIGV2ZW50VGltZSk7CiAgICByZXR1cm4gcm9vdDsKICB9CiAgZnVuY3Rpb24gdXBkYXRlQ29udGFpbmVyKGVsZW1lbnQsIGNvbnRhaW5lciwgcGFyZW50Q29tcG9uZW50LCBjYWxsYmFjaykgewogICAgewogICAgICBvblNjaGVkdWxlUm9vdChjb250YWluZXIsIGVsZW1lbnQpOwogICAgfQoKICAgIHZhciBjdXJyZW50JDEgPSBjb250YWluZXIuY3VycmVudDsKICAgIHZhciBldmVudFRpbWUgPSByZXF1ZXN0RXZlbnRUaW1lKCk7CiAgICB2YXIgbGFuZSA9IHJlcXVlc3RVcGRhdGVMYW5lKGN1cnJlbnQkMSk7CgogICAgewogICAgICBtYXJrUmVuZGVyU2NoZWR1bGVkKGxhbmUpOwogICAgfQoKICAgIHZhciBjb250ZXh0ID0gZ2V0Q29udGV4dEZvclN1YnRyZWUocGFyZW50Q29tcG9uZW50KTsKCiAgICBpZiAoY29udGFpbmVyLmNvbnRleHQgPT09IG51bGwpIHsKICAgICAgY29udGFpbmVyLmNvbnRleHQgPSBjb250ZXh0OwogICAgfSBlbHNlIHsKICAgICAgY29udGFpbmVyLnBlbmRpbmdDb250ZXh0ID0gY29udGV4dDsKICAgIH0KCiAgICB7CiAgICAgIGlmIChpc1JlbmRlcmluZyAmJiBjdXJyZW50ICE9PSBudWxsICYmICFkaWRXYXJuQWJvdXROZXN0ZWRVcGRhdGVzKSB7CiAgICAgICAgZGlkV2FybkFib3V0TmVzdGVkVXBkYXRlcyA9IHRydWU7CgogICAgICAgIGVycm9yKCdSZW5kZXIgbWV0aG9kcyBzaG91bGQgYmUgYSBwdXJlIGZ1bmN0aW9uIG9mIHByb3BzIGFuZCBzdGF0ZTsgJyArICd0cmlnZ2VyaW5nIG5lc3RlZCBjb21wb25lbnQgdXBkYXRlcyBmcm9tIHJlbmRlciBpcyBub3QgYWxsb3dlZC4gJyArICdJZiBuZWNlc3NhcnksIHRyaWdnZXIgbmVzdGVkIHVwZGF0ZXMgaW4gY29tcG9uZW50RGlkVXBkYXRlLlxuXG4nICsgJ0NoZWNrIHRoZSByZW5kZXIgbWV0aG9kIG9mICVzLicsIGdldENvbXBvbmVudE5hbWVGcm9tRmliZXIoY3VycmVudCkgfHwgJ1Vua25vd24nKTsKICAgICAgfQogICAgfQoKICAgIHZhciB1cGRhdGUgPSBjcmVhdGVVcGRhdGUoZXZlbnRUaW1lLCBsYW5lKTsgLy8gQ2F1dGlvbjogUmVhY3QgRGV2VG9vbHMgY3VycmVudGx5IGRlcGVuZHMgb24gdGhpcyBwcm9wZXJ0eQogICAgLy8gYmVpbmcgY2FsbGVkICJlbGVtZW50Ii4KCiAgICB1cGRhdGUucGF5bG9hZCA9IHsKICAgICAgZWxlbWVudDogZWxlbWVudAogICAgfTsKICAgIGNhbGxiYWNrID0gY2FsbGJhY2sgPT09IHVuZGVmaW5lZCA/IG51bGwgOiBjYWxsYmFjazsKCiAgICBpZiAoY2FsbGJhY2sgIT09IG51bGwpIHsKICAgICAgewogICAgICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgIT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgIGVycm9yKCdyZW5kZXIoLi4uKTogRXhwZWN0ZWQgdGhlIGxhc3Qgb3B0aW9uYWwgYGNhbGxiYWNrYCBhcmd1bWVudCB0byBiZSBhICcgKyAnZnVuY3Rpb24uIEluc3RlYWQgcmVjZWl2ZWQ6ICVzLicsIGNhbGxiYWNrKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHVwZGF0ZS5jYWxsYmFjayA9IGNhbGxiYWNrOwogICAgfQoKICAgIHZhciByb290ID0gZW5xdWV1ZVVwZGF0ZShjdXJyZW50JDEsIHVwZGF0ZSwgbGFuZSk7CgogICAgaWYgKHJvb3QgIT09IG51bGwpIHsKICAgICAgc2NoZWR1bGVVcGRhdGVPbkZpYmVyKHJvb3QsIGN1cnJlbnQkMSwgbGFuZSwgZXZlbnRUaW1lKTsKICAgICAgZW50YW5nbGVUcmFuc2l0aW9ucyhyb290LCBjdXJyZW50JDEsIGxhbmUpOwogICAgfQoKICAgIHJldHVybiBsYW5lOwogIH0KICBmdW5jdGlvbiBnZXRQdWJsaWNSb290SW5zdGFuY2UoY29udGFpbmVyKSB7CiAgICB2YXIgY29udGFpbmVyRmliZXIgPSBjb250YWluZXIuY3VycmVudDsKCiAgICBpZiAoIWNvbnRhaW5lckZpYmVyLmNoaWxkKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIHN3aXRjaCAoY29udGFpbmVyRmliZXIuY2hpbGQudGFnKSB7CiAgICAgIGNhc2UgSG9zdENvbXBvbmVudDoKICAgICAgICByZXR1cm4gZ2V0UHVibGljSW5zdGFuY2UoY29udGFpbmVyRmliZXIuY2hpbGQuc3RhdGVOb2RlKTsKCiAgICAgIGRlZmF1bHQ6CiAgICAgICAgcmV0dXJuIGNvbnRhaW5lckZpYmVyLmNoaWxkLnN0YXRlTm9kZTsKICAgIH0KICB9CiAgZnVuY3Rpb24gYXR0ZW1wdFN5bmNocm9ub3VzSHlkcmF0aW9uJDEoZmliZXIpIHsKICAgIHN3aXRjaCAoZmliZXIudGFnKSB7CiAgICAgIGNhc2UgSG9zdFJvb3Q6CiAgICAgICAgewogICAgICAgICAgdmFyIHJvb3QgPSBmaWJlci5zdGF0ZU5vZGU7CgogICAgICAgICAgaWYgKGlzUm9vdERlaHlkcmF0ZWQocm9vdCkpIHsKICAgICAgICAgICAgLy8gRmx1c2ggdGhlIGZpcnN0IHNjaGVkdWxlZCAidXBkYXRlIi4KICAgICAgICAgICAgdmFyIGxhbmVzID0gZ2V0SGlnaGVzdFByaW9yaXR5UGVuZGluZ0xhbmVzKHJvb3QpOwogICAgICAgICAgICBmbHVzaFJvb3Qocm9vdCwgbGFuZXMpOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgIGNhc2UgU3VzcGVuc2VDb21wb25lbnQ6CiAgICAgICAgewogICAgICAgICAgZmx1c2hTeW5jKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIHJvb3QgPSBlbnF1ZXVlQ29uY3VycmVudFJlbmRlckZvckxhbmUoZmliZXIsIFN5bmNMYW5lKTsKCiAgICAgICAgICAgIGlmIChyb290ICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgdmFyIGV2ZW50VGltZSA9IHJlcXVlc3RFdmVudFRpbWUoKTsKICAgICAgICAgICAgICBzY2hlZHVsZVVwZGF0ZU9uRmliZXIocm9vdCwgZmliZXIsIFN5bmNMYW5lLCBldmVudFRpbWUpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsgLy8gSWYgd2UncmUgc3RpbGwgYmxvY2tlZCBhZnRlciB0aGlzLCB3ZSBuZWVkIHRvIGluY3JlYXNlCiAgICAgICAgICAvLyB0aGUgcHJpb3JpdHkgb2YgYW55IHByb21pc2VzIHJlc29sdmluZyB3aXRoaW4gdGhpcwogICAgICAgICAgLy8gYm91bmRhcnkgc28gdGhhdCB0aGV5IG5leHQgYXR0ZW1wdCBhbHNvIGhhcyBoaWdoZXIgcHJpLgoKICAgICAgICAgIHZhciByZXRyeUxhbmUgPSBTeW5jTGFuZTsKICAgICAgICAgIG1hcmtSZXRyeUxhbmVJZk5vdEh5ZHJhdGVkKGZpYmVyLCByZXRyeUxhbmUpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gbWFya1JldHJ5TGFuZUltcGwoZmliZXIsIHJldHJ5TGFuZSkgewogICAgdmFyIHN1c3BlbnNlU3RhdGUgPSBmaWJlci5tZW1vaXplZFN0YXRlOwoKICAgIGlmIChzdXNwZW5zZVN0YXRlICE9PSBudWxsICYmIHN1c3BlbnNlU3RhdGUuZGVoeWRyYXRlZCAhPT0gbnVsbCkgewogICAgICBzdXNwZW5zZVN0YXRlLnJldHJ5TGFuZSA9IGhpZ2hlclByaW9yaXR5TGFuZShzdXNwZW5zZVN0YXRlLnJldHJ5TGFuZSwgcmV0cnlMYW5lKTsKICAgIH0KICB9IC8vIEluY3JlYXNlcyB0aGUgcHJpb3JpdHkgb2YgdGhlbmFibGVzIHdoZW4gdGhleSByZXNvbHZlIHdpdGhpbiB0aGlzIGJvdW5kYXJ5LgoKCiAgZnVuY3Rpb24gbWFya1JldHJ5TGFuZUlmTm90SHlkcmF0ZWQoZmliZXIsIHJldHJ5TGFuZSkgewogICAgbWFya1JldHJ5TGFuZUltcGwoZmliZXIsIHJldHJ5TGFuZSk7CiAgICB2YXIgYWx0ZXJuYXRlID0gZmliZXIuYWx0ZXJuYXRlOwoKICAgIGlmIChhbHRlcm5hdGUpIHsKICAgICAgbWFya1JldHJ5TGFuZUltcGwoYWx0ZXJuYXRlLCByZXRyeUxhbmUpOwogICAgfQogIH0KICBmdW5jdGlvbiBhdHRlbXB0Q29udGludW91c0h5ZHJhdGlvbiQxKGZpYmVyKSB7CiAgICBpZiAoZmliZXIudGFnICE9PSBTdXNwZW5zZUNvbXBvbmVudCkgewogICAgICAvLyBXZSBpZ25vcmUgSG9zdFJvb3RzIGhlcmUgYmVjYXVzZSB3ZSBjYW4ndCBpbmNyZWFzZQogICAgICAvLyB0aGVpciBwcmlvcml0eSBhbmQgdGhleSBzaG91bGQgbm90IHN1c3BlbmQgb24gSS9PLAogICAgICAvLyBzaW5jZSB5b3UgaGF2ZSB0byB3cmFwIGFueXRoaW5nIHRoYXQgbWlnaHQgc3VzcGVuZCBpbgogICAgICAvLyBTdXNwZW5zZS4KICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhciBsYW5lID0gU2VsZWN0aXZlSHlkcmF0aW9uTGFuZTsKICAgIHZhciByb290ID0gZW5xdWV1ZUNvbmN1cnJlbnRSZW5kZXJGb3JMYW5lKGZpYmVyLCBsYW5lKTsKCiAgICBpZiAocm9vdCAhPT0gbnVsbCkgewogICAgICB2YXIgZXZlbnRUaW1lID0gcmVxdWVzdEV2ZW50VGltZSgpOwogICAgICBzY2hlZHVsZVVwZGF0ZU9uRmliZXIocm9vdCwgZmliZXIsIGxhbmUsIGV2ZW50VGltZSk7CiAgICB9CgogICAgbWFya1JldHJ5TGFuZUlmTm90SHlkcmF0ZWQoZmliZXIsIGxhbmUpOwogIH0KICBmdW5jdGlvbiBhdHRlbXB0SHlkcmF0aW9uQXRDdXJyZW50UHJpb3JpdHkkMShmaWJlcikgewogICAgaWYgKGZpYmVyLnRhZyAhPT0gU3VzcGVuc2VDb21wb25lbnQpIHsKICAgICAgLy8gV2UgaWdub3JlIEhvc3RSb290cyBoZXJlIGJlY2F1c2Ugd2UgY2FuJ3QgaW5jcmVhc2UKICAgICAgLy8gdGhlaXIgcHJpb3JpdHkgb3RoZXIgdGhhbiBzeW5jaHJvbm91c2x5IGZsdXNoIGl0LgogICAgICByZXR1cm47CiAgICB9CgogICAgdmFyIGxhbmUgPSByZXF1ZXN0VXBkYXRlTGFuZShmaWJlcik7CiAgICB2YXIgcm9vdCA9IGVucXVldWVDb25jdXJyZW50UmVuZGVyRm9yTGFuZShmaWJlciwgbGFuZSk7CgogICAgaWYgKHJvb3QgIT09IG51bGwpIHsKICAgICAgdmFyIGV2ZW50VGltZSA9IHJlcXVlc3RFdmVudFRpbWUoKTsKICAgICAgc2NoZWR1bGVVcGRhdGVPbkZpYmVyKHJvb3QsIGZpYmVyLCBsYW5lLCBldmVudFRpbWUpOwogICAgfQoKICAgIG1hcmtSZXRyeUxhbmVJZk5vdEh5ZHJhdGVkKGZpYmVyLCBsYW5lKTsKICB9CiAgZnVuY3Rpb24gZmluZEhvc3RJbnN0YW5jZVdpdGhOb1BvcnRhbHMoZmliZXIpIHsKICAgIHZhciBob3N0RmliZXIgPSBmaW5kQ3VycmVudEhvc3RGaWJlcldpdGhOb1BvcnRhbHMoZmliZXIpOwoKICAgIGlmIChob3N0RmliZXIgPT09IG51bGwpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgcmV0dXJuIGhvc3RGaWJlci5zdGF0ZU5vZGU7CiAgfQoKICB2YXIgc2hvdWxkRXJyb3JJbXBsID0gZnVuY3Rpb24gKGZpYmVyKSB7CiAgICByZXR1cm4gbnVsbDsKICB9OwoKICBmdW5jdGlvbiBzaG91bGRFcnJvcihmaWJlcikgewogICAgcmV0dXJuIHNob3VsZEVycm9ySW1wbChmaWJlcik7CiAgfQoKICB2YXIgc2hvdWxkU3VzcGVuZEltcGwgPSBmdW5jdGlvbiAoZmliZXIpIHsKICAgIHJldHVybiBmYWxzZTsKICB9OwoKICBmdW5jdGlvbiBzaG91bGRTdXNwZW5kKGZpYmVyKSB7CiAgICByZXR1cm4gc2hvdWxkU3VzcGVuZEltcGwoZmliZXIpOwogIH0KICB2YXIgb3ZlcnJpZGVIb29rU3RhdGUgPSBudWxsOwogIHZhciBvdmVycmlkZUhvb2tTdGF0ZURlbGV0ZVBhdGggPSBudWxsOwogIHZhciBvdmVycmlkZUhvb2tTdGF0ZVJlbmFtZVBhdGggPSBudWxsOwogIHZhciBvdmVycmlkZVByb3BzID0gbnVsbDsKICB2YXIgb3ZlcnJpZGVQcm9wc0RlbGV0ZVBhdGggPSBudWxsOwogIHZhciBvdmVycmlkZVByb3BzUmVuYW1lUGF0aCA9IG51bGw7CiAgdmFyIHNjaGVkdWxlVXBkYXRlID0gbnVsbDsKICB2YXIgc2V0RXJyb3JIYW5kbGVyID0gbnVsbDsKICB2YXIgc2V0U3VzcGVuc2VIYW5kbGVyID0gbnVsbDsKCiAgewogICAgdmFyIGNvcHlXaXRoRGVsZXRlSW1wbCA9IGZ1bmN0aW9uIChvYmosIHBhdGgsIGluZGV4KSB7CiAgICAgIHZhciBrZXkgPSBwYXRoW2luZGV4XTsKICAgICAgdmFyIHVwZGF0ZWQgPSBpc0FycmF5KG9iaikgPyBvYmouc2xpY2UoKSA6IGFzc2lnbih7fSwgb2JqKTsKCiAgICAgIGlmIChpbmRleCArIDEgPT09IHBhdGgubGVuZ3RoKSB7CiAgICAgICAgaWYgKGlzQXJyYXkodXBkYXRlZCkpIHsKICAgICAgICAgIHVwZGF0ZWQuc3BsaWNlKGtleSwgMSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGRlbGV0ZSB1cGRhdGVkW2tleV07CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdXBkYXRlZDsKICAgICAgfSAvLyAkRmxvd0ZpeE1lIG51bWJlciBvciBzdHJpbmcgaXMgZmluZSBoZXJlCgoKICAgICAgdXBkYXRlZFtrZXldID0gY29weVdpdGhEZWxldGVJbXBsKG9ialtrZXldLCBwYXRoLCBpbmRleCArIDEpOwogICAgICByZXR1cm4gdXBkYXRlZDsKICAgIH07CgogICAgdmFyIGNvcHlXaXRoRGVsZXRlID0gZnVuY3Rpb24gKG9iaiwgcGF0aCkgewogICAgICByZXR1cm4gY29weVdpdGhEZWxldGVJbXBsKG9iaiwgcGF0aCwgMCk7CiAgICB9OwoKICAgIHZhciBjb3B5V2l0aFJlbmFtZUltcGwgPSBmdW5jdGlvbiAob2JqLCBvbGRQYXRoLCBuZXdQYXRoLCBpbmRleCkgewogICAgICB2YXIgb2xkS2V5ID0gb2xkUGF0aFtpbmRleF07CiAgICAgIHZhciB1cGRhdGVkID0gaXNBcnJheShvYmopID8gb2JqLnNsaWNlKCkgOiBhc3NpZ24oe30sIG9iaik7CgogICAgICBpZiAoaW5kZXggKyAxID09PSBvbGRQYXRoLmxlbmd0aCkgewogICAgICAgIHZhciBuZXdLZXkgPSBuZXdQYXRoW2luZGV4XTsgLy8gJEZsb3dGaXhNZSBudW1iZXIgb3Igc3RyaW5nIGlzIGZpbmUgaGVyZQoKICAgICAgICB1cGRhdGVkW25ld0tleV0gPSB1cGRhdGVkW29sZEtleV07CgogICAgICAgIGlmIChpc0FycmF5KHVwZGF0ZWQpKSB7CiAgICAgICAgICB1cGRhdGVkLnNwbGljZShvbGRLZXksIDEpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBkZWxldGUgdXBkYXRlZFtvbGRLZXldOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAvLyAkRmxvd0ZpeE1lIG51bWJlciBvciBzdHJpbmcgaXMgZmluZSBoZXJlCiAgICAgICAgdXBkYXRlZFtvbGRLZXldID0gY29weVdpdGhSZW5hbWVJbXBsKCAvLyAkRmxvd0ZpeE1lIG51bWJlciBvciBzdHJpbmcgaXMgZmluZSBoZXJlCiAgICAgICAgb2JqW29sZEtleV0sIG9sZFBhdGgsIG5ld1BhdGgsIGluZGV4ICsgMSk7CiAgICAgIH0KCiAgICAgIHJldHVybiB1cGRhdGVkOwogICAgfTsKCiAgICB2YXIgY29weVdpdGhSZW5hbWUgPSBmdW5jdGlvbiAob2JqLCBvbGRQYXRoLCBuZXdQYXRoKSB7CiAgICAgIGlmIChvbGRQYXRoLmxlbmd0aCAhPT0gbmV3UGF0aC5sZW5ndGgpIHsKICAgICAgICB3YXJuKCdjb3B5V2l0aFJlbmFtZSgpIGV4cGVjdHMgcGF0aHMgb2YgdGhlIHNhbWUgbGVuZ3RoJyk7CgogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIHsKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5ld1BhdGgubGVuZ3RoIC0gMTsgaSsrKSB7CiAgICAgICAgICBpZiAob2xkUGF0aFtpXSAhPT0gbmV3UGF0aFtpXSkgewogICAgICAgICAgICB3YXJuKCdjb3B5V2l0aFJlbmFtZSgpIGV4cGVjdHMgcGF0aHMgdG8gYmUgdGhlIHNhbWUgZXhjZXB0IGZvciB0aGUgZGVlcGVzdCBrZXknKTsKCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBjb3B5V2l0aFJlbmFtZUltcGwob2JqLCBvbGRQYXRoLCBuZXdQYXRoLCAwKTsKICAgIH07CgogICAgdmFyIGNvcHlXaXRoU2V0SW1wbCA9IGZ1bmN0aW9uIChvYmosIHBhdGgsIGluZGV4LCB2YWx1ZSkgewogICAgICBpZiAoaW5kZXggPj0gcGF0aC5sZW5ndGgpIHsKICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgIH0KCiAgICAgIHZhciBrZXkgPSBwYXRoW2luZGV4XTsKICAgICAgdmFyIHVwZGF0ZWQgPSBpc0FycmF5KG9iaikgPyBvYmouc2xpY2UoKSA6IGFzc2lnbih7fSwgb2JqKTsgLy8gJEZsb3dGaXhNZSBudW1iZXIgb3Igc3RyaW5nIGlzIGZpbmUgaGVyZQoKICAgICAgdXBkYXRlZFtrZXldID0gY29weVdpdGhTZXRJbXBsKG9ialtrZXldLCBwYXRoLCBpbmRleCArIDEsIHZhbHVlKTsKICAgICAgcmV0dXJuIHVwZGF0ZWQ7CiAgICB9OwoKICAgIHZhciBjb3B5V2l0aFNldCA9IGZ1bmN0aW9uIChvYmosIHBhdGgsIHZhbHVlKSB7CiAgICAgIHJldHVybiBjb3B5V2l0aFNldEltcGwob2JqLCBwYXRoLCAwLCB2YWx1ZSk7CiAgICB9OwoKICAgIHZhciBmaW5kSG9vayA9IGZ1bmN0aW9uIChmaWJlciwgaWQpIHsKICAgICAgLy8gRm9yIG5vdywgdGhlICJpZCIgb2Ygc3RhdGVmdWwgaG9va3MgaXMganVzdCB0aGUgc3RhdGVmdWwgaG9vayBpbmRleC4KICAgICAgLy8gVGhpcyBtYXkgY2hhbmdlIGluIHRoZSBmdXR1cmUgd2l0aCBlLmcuIG5lc3RlZCBob29rcy4KICAgICAgdmFyIGN1cnJlbnRIb29rID0gZmliZXIubWVtb2l6ZWRTdGF0ZTsKCiAgICAgIHdoaWxlIChjdXJyZW50SG9vayAhPT0gbnVsbCAmJiBpZCA+IDApIHsKICAgICAgICBjdXJyZW50SG9vayA9IGN1cnJlbnRIb29rLm5leHQ7CiAgICAgICAgaWQtLTsKICAgICAgfQoKICAgICAgcmV0dXJuIGN1cnJlbnRIb29rOwogICAgfTsgLy8gU3VwcG9ydCBEZXZUb29scyBlZGl0YWJsZSB2YWx1ZXMgZm9yIHVzZVN0YXRlIGFuZCB1c2VSZWR1Y2VyLgoKCiAgICBvdmVycmlkZUhvb2tTdGF0ZSA9IGZ1bmN0aW9uIChmaWJlciwgaWQsIHBhdGgsIHZhbHVlKSB7CiAgICAgIHZhciBob29rID0gZmluZEhvb2soZmliZXIsIGlkKTsKCiAgICAgIGlmIChob29rICE9PSBudWxsKSB7CiAgICAgICAgdmFyIG5ld1N0YXRlID0gY29weVdpdGhTZXQoaG9vay5tZW1vaXplZFN0YXRlLCBwYXRoLCB2YWx1ZSk7CiAgICAgICAgaG9vay5tZW1vaXplZFN0YXRlID0gbmV3U3RhdGU7CiAgICAgICAgaG9vay5iYXNlU3RhdGUgPSBuZXdTdGF0ZTsgLy8gV2UgYXJlbid0IGFjdHVhbGx5IGFkZGluZyBhbiB1cGRhdGUgdG8gdGhlIHF1ZXVlLAogICAgICAgIC8vIGJlY2F1c2UgdGhlcmUgaXMgbm8gdXBkYXRlIHdlIGNhbiBhZGQgZm9yIHVzZVJlZHVjZXIgaG9va3MgdGhhdCB3b24ndCB0cmlnZ2VyIGFuIGVycm9yLgogICAgICAgIC8vIChUaGVyZSdzIG5vIGFwcHJvcHJpYXRlIGFjdGlvbiB0eXBlIGZvciBEZXZUb29scyBvdmVycmlkZXMuKQogICAgICAgIC8vIEFzIGEgcmVzdWx0IHRob3VnaCwgUmVhY3Qgd2lsbCBzZWUgdGhlIHNjaGVkdWxlZCB1cGRhdGUgYXMgYSBub29wIGFuZCBiYWlsb3V0LgogICAgICAgIC8vIFNoYWxsb3cgY2xvbmluZyBwcm9wcyB3b3JrcyBhcyBhIHdvcmthcm91bmQgZm9yIG5vdyB0byBieXBhc3MgdGhlIGJhaWxvdXQgY2hlY2suCgogICAgICAgIGZpYmVyLm1lbW9pemVkUHJvcHMgPSBhc3NpZ24oe30sIGZpYmVyLm1lbW9pemVkUHJvcHMpOwogICAgICAgIHZhciByb290ID0gZW5xdWV1ZUNvbmN1cnJlbnRSZW5kZXJGb3JMYW5lKGZpYmVyLCBTeW5jTGFuZSk7CgogICAgICAgIGlmIChyb290ICE9PSBudWxsKSB7CiAgICAgICAgICBzY2hlZHVsZVVwZGF0ZU9uRmliZXIocm9vdCwgZmliZXIsIFN5bmNMYW5lLCBOb1RpbWVzdGFtcCk7CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIG92ZXJyaWRlSG9va1N0YXRlRGVsZXRlUGF0aCA9IGZ1bmN0aW9uIChmaWJlciwgaWQsIHBhdGgpIHsKICAgICAgdmFyIGhvb2sgPSBmaW5kSG9vayhmaWJlciwgaWQpOwoKICAgICAgaWYgKGhvb2sgIT09IG51bGwpIHsKICAgICAgICB2YXIgbmV3U3RhdGUgPSBjb3B5V2l0aERlbGV0ZShob29rLm1lbW9pemVkU3RhdGUsIHBhdGgpOwogICAgICAgIGhvb2subWVtb2l6ZWRTdGF0ZSA9IG5ld1N0YXRlOwogICAgICAgIGhvb2suYmFzZVN0YXRlID0gbmV3U3RhdGU7IC8vIFdlIGFyZW4ndCBhY3R1YWxseSBhZGRpbmcgYW4gdXBkYXRlIHRvIHRoZSBxdWV1ZSwKICAgICAgICAvLyBiZWNhdXNlIHRoZXJlIGlzIG5vIHVwZGF0ZSB3ZSBjYW4gYWRkIGZvciB1c2VSZWR1Y2VyIGhvb2tzIHRoYXQgd29uJ3QgdHJpZ2dlciBhbiBlcnJvci4KICAgICAgICAvLyAoVGhlcmUncyBubyBhcHByb3ByaWF0ZSBhY3Rpb24gdHlwZSBmb3IgRGV2VG9vbHMgb3ZlcnJpZGVzLikKICAgICAgICAvLyBBcyBhIHJlc3VsdCB0aG91Z2gsIFJlYWN0IHdpbGwgc2VlIHRoZSBzY2hlZHVsZWQgdXBkYXRlIGFzIGEgbm9vcCBhbmQgYmFpbG91dC4KICAgICAgICAvLyBTaGFsbG93IGNsb25pbmcgcHJvcHMgd29ya3MgYXMgYSB3b3JrYXJvdW5kIGZvciBub3cgdG8gYnlwYXNzIHRoZSBiYWlsb3V0IGNoZWNrLgoKICAgICAgICBmaWJlci5tZW1vaXplZFByb3BzID0gYXNzaWduKHt9LCBmaWJlci5tZW1vaXplZFByb3BzKTsKICAgICAgICB2YXIgcm9vdCA9IGVucXVldWVDb25jdXJyZW50UmVuZGVyRm9yTGFuZShmaWJlciwgU3luY0xhbmUpOwoKICAgICAgICBpZiAocm9vdCAhPT0gbnVsbCkgewogICAgICAgICAgc2NoZWR1bGVVcGRhdGVPbkZpYmVyKHJvb3QsIGZpYmVyLCBTeW5jTGFuZSwgTm9UaW1lc3RhbXApOwogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICBvdmVycmlkZUhvb2tTdGF0ZVJlbmFtZVBhdGggPSBmdW5jdGlvbiAoZmliZXIsIGlkLCBvbGRQYXRoLCBuZXdQYXRoKSB7CiAgICAgIHZhciBob29rID0gZmluZEhvb2soZmliZXIsIGlkKTsKCiAgICAgIGlmIChob29rICE9PSBudWxsKSB7CiAgICAgICAgdmFyIG5ld1N0YXRlID0gY29weVdpdGhSZW5hbWUoaG9vay5tZW1vaXplZFN0YXRlLCBvbGRQYXRoLCBuZXdQYXRoKTsKICAgICAgICBob29rLm1lbW9pemVkU3RhdGUgPSBuZXdTdGF0ZTsKICAgICAgICBob29rLmJhc2VTdGF0ZSA9IG5ld1N0YXRlOyAvLyBXZSBhcmVuJ3QgYWN0dWFsbHkgYWRkaW5nIGFuIHVwZGF0ZSB0byB0aGUgcXVldWUsCiAgICAgICAgLy8gYmVjYXVzZSB0aGVyZSBpcyBubyB1cGRhdGUgd2UgY2FuIGFkZCBmb3IgdXNlUmVkdWNlciBob29rcyB0aGF0IHdvbid0IHRyaWdnZXIgYW4gZXJyb3IuCiAgICAgICAgLy8gKFRoZXJlJ3Mgbm8gYXBwcm9wcmlhdGUgYWN0aW9uIHR5cGUgZm9yIERldlRvb2xzIG92ZXJyaWRlcy4pCiAgICAgICAgLy8gQXMgYSByZXN1bHQgdGhvdWdoLCBSZWFjdCB3aWxsIHNlZSB0aGUgc2NoZWR1bGVkIHVwZGF0ZSBhcyBhIG5vb3AgYW5kIGJhaWxvdXQuCiAgICAgICAgLy8gU2hhbGxvdyBjbG9uaW5nIHByb3BzIHdvcmtzIGFzIGEgd29ya2Fyb3VuZCBmb3Igbm93IHRvIGJ5cGFzcyB0aGUgYmFpbG91dCBjaGVjay4KCiAgICAgICAgZmliZXIubWVtb2l6ZWRQcm9wcyA9IGFzc2lnbih7fSwgZmliZXIubWVtb2l6ZWRQcm9wcyk7CiAgICAgICAgdmFyIHJvb3QgPSBlbnF1ZXVlQ29uY3VycmVudFJlbmRlckZvckxhbmUoZmliZXIsIFN5bmNMYW5lKTsKCiAgICAgICAgaWYgKHJvb3QgIT09IG51bGwpIHsKICAgICAgICAgIHNjaGVkdWxlVXBkYXRlT25GaWJlcihyb290LCBmaWJlciwgU3luY0xhbmUsIE5vVGltZXN0YW1wKTsKICAgICAgICB9CiAgICAgIH0KICAgIH07IC8vIFN1cHBvcnQgRGV2VG9vbHMgcHJvcHMgZm9yIGZ1bmN0aW9uIGNvbXBvbmVudHMsIGZvcndhcmRSZWYsIG1lbW8sIGhvc3QgY29tcG9uZW50cywgZXRjLgoKCiAgICBvdmVycmlkZVByb3BzID0gZnVuY3Rpb24gKGZpYmVyLCBwYXRoLCB2YWx1ZSkgewogICAgICBmaWJlci5wZW5kaW5nUHJvcHMgPSBjb3B5V2l0aFNldChmaWJlci5tZW1vaXplZFByb3BzLCBwYXRoLCB2YWx1ZSk7CgogICAgICBpZiAoZmliZXIuYWx0ZXJuYXRlKSB7CiAgICAgICAgZmliZXIuYWx0ZXJuYXRlLnBlbmRpbmdQcm9wcyA9IGZpYmVyLnBlbmRpbmdQcm9wczsKICAgICAgfQoKICAgICAgdmFyIHJvb3QgPSBlbnF1ZXVlQ29uY3VycmVudFJlbmRlckZvckxhbmUoZmliZXIsIFN5bmNMYW5lKTsKCiAgICAgIGlmIChyb290ICE9PSBudWxsKSB7CiAgICAgICAgc2NoZWR1bGVVcGRhdGVPbkZpYmVyKHJvb3QsIGZpYmVyLCBTeW5jTGFuZSwgTm9UaW1lc3RhbXApOwogICAgICB9CiAgICB9OwoKICAgIG92ZXJyaWRlUHJvcHNEZWxldGVQYXRoID0gZnVuY3Rpb24gKGZpYmVyLCBwYXRoKSB7CiAgICAgIGZpYmVyLnBlbmRpbmdQcm9wcyA9IGNvcHlXaXRoRGVsZXRlKGZpYmVyLm1lbW9pemVkUHJvcHMsIHBhdGgpOwoKICAgICAgaWYgKGZpYmVyLmFsdGVybmF0ZSkgewogICAgICAgIGZpYmVyLmFsdGVybmF0ZS5wZW5kaW5nUHJvcHMgPSBmaWJlci5wZW5kaW5nUHJvcHM7CiAgICAgIH0KCiAgICAgIHZhciByb290ID0gZW5xdWV1ZUNvbmN1cnJlbnRSZW5kZXJGb3JMYW5lKGZpYmVyLCBTeW5jTGFuZSk7CgogICAgICBpZiAocm9vdCAhPT0gbnVsbCkgewogICAgICAgIHNjaGVkdWxlVXBkYXRlT25GaWJlcihyb290LCBmaWJlciwgU3luY0xhbmUsIE5vVGltZXN0YW1wKTsKICAgICAgfQogICAgfTsKCiAgICBvdmVycmlkZVByb3BzUmVuYW1lUGF0aCA9IGZ1bmN0aW9uIChmaWJlciwgb2xkUGF0aCwgbmV3UGF0aCkgewogICAgICBmaWJlci5wZW5kaW5nUHJvcHMgPSBjb3B5V2l0aFJlbmFtZShmaWJlci5tZW1vaXplZFByb3BzLCBvbGRQYXRoLCBuZXdQYXRoKTsKCiAgICAgIGlmIChmaWJlci5hbHRlcm5hdGUpIHsKICAgICAgICBmaWJlci5hbHRlcm5hdGUucGVuZGluZ1Byb3BzID0gZmliZXIucGVuZGluZ1Byb3BzOwogICAgICB9CgogICAgICB2YXIgcm9vdCA9IGVucXVldWVDb25jdXJyZW50UmVuZGVyRm9yTGFuZShmaWJlciwgU3luY0xhbmUpOwoKICAgICAgaWYgKHJvb3QgIT09IG51bGwpIHsKICAgICAgICBzY2hlZHVsZVVwZGF0ZU9uRmliZXIocm9vdCwgZmliZXIsIFN5bmNMYW5lLCBOb1RpbWVzdGFtcCk7CiAgICAgIH0KICAgIH07CgogICAgc2NoZWR1bGVVcGRhdGUgPSBmdW5jdGlvbiAoZmliZXIpIHsKICAgICAgdmFyIHJvb3QgPSBlbnF1ZXVlQ29uY3VycmVudFJlbmRlckZvckxhbmUoZmliZXIsIFN5bmNMYW5lKTsKCiAgICAgIGlmIChyb290ICE9PSBudWxsKSB7CiAgICAgICAgc2NoZWR1bGVVcGRhdGVPbkZpYmVyKHJvb3QsIGZpYmVyLCBTeW5jTGFuZSwgTm9UaW1lc3RhbXApOwogICAgICB9CiAgICB9OwoKICAgIHNldEVycm9ySGFuZGxlciA9IGZ1bmN0aW9uIChuZXdTaG91bGRFcnJvckltcGwpIHsKICAgICAgc2hvdWxkRXJyb3JJbXBsID0gbmV3U2hvdWxkRXJyb3JJbXBsOwogICAgfTsKCiAgICBzZXRTdXNwZW5zZUhhbmRsZXIgPSBmdW5jdGlvbiAobmV3U2hvdWxkU3VzcGVuZEltcGwpIHsKICAgICAgc2hvdWxkU3VzcGVuZEltcGwgPSBuZXdTaG91bGRTdXNwZW5kSW1wbDsKICAgIH07CiAgfQoKICBmdW5jdGlvbiBmaW5kSG9zdEluc3RhbmNlQnlGaWJlcihmaWJlcikgewogICAgdmFyIGhvc3RGaWJlciA9IGZpbmRDdXJyZW50SG9zdEZpYmVyKGZpYmVyKTsKCiAgICBpZiAoaG9zdEZpYmVyID09PSBudWxsKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIHJldHVybiBob3N0RmliZXIuc3RhdGVOb2RlOwogIH0KCiAgZnVuY3Rpb24gZW1wdHlGaW5kRmliZXJCeUhvc3RJbnN0YW5jZShpbnN0YW5jZSkgewogICAgcmV0dXJuIG51bGw7CiAgfQoKICBmdW5jdGlvbiBnZXRDdXJyZW50RmliZXJGb3JEZXZUb29scygpIHsKICAgIHJldHVybiBjdXJyZW50OwogIH0KCiAgZnVuY3Rpb24gaW5qZWN0SW50b0RldlRvb2xzKGRldlRvb2xzQ29uZmlnKSB7CiAgICB2YXIgZmluZEZpYmVyQnlIb3N0SW5zdGFuY2UgPSBkZXZUb29sc0NvbmZpZy5maW5kRmliZXJCeUhvc3RJbnN0YW5jZTsKICAgIHZhciBSZWFjdEN1cnJlbnREaXNwYXRjaGVyID0gUmVhY3RTaGFyZWRJbnRlcm5hbHMuUmVhY3RDdXJyZW50RGlzcGF0Y2hlcjsKICAgIHJldHVybiBpbmplY3RJbnRlcm5hbHMoewogICAgICBidW5kbGVUeXBlOiBkZXZUb29sc0NvbmZpZy5idW5kbGVUeXBlLAogICAgICB2ZXJzaW9uOiBkZXZUb29sc0NvbmZpZy52ZXJzaW9uLAogICAgICByZW5kZXJlclBhY2thZ2VOYW1lOiBkZXZUb29sc0NvbmZpZy5yZW5kZXJlclBhY2thZ2VOYW1lLAogICAgICByZW5kZXJlckNvbmZpZzogZGV2VG9vbHNDb25maWcucmVuZGVyZXJDb25maWcsCiAgICAgIG92ZXJyaWRlSG9va1N0YXRlOiBvdmVycmlkZUhvb2tTdGF0ZSwKICAgICAgb3ZlcnJpZGVIb29rU3RhdGVEZWxldGVQYXRoOiBvdmVycmlkZUhvb2tTdGF0ZURlbGV0ZVBhdGgsCiAgICAgIG92ZXJyaWRlSG9va1N0YXRlUmVuYW1lUGF0aDogb3ZlcnJpZGVIb29rU3RhdGVSZW5hbWVQYXRoLAogICAgICBvdmVycmlkZVByb3BzOiBvdmVycmlkZVByb3BzLAogICAgICBvdmVycmlkZVByb3BzRGVsZXRlUGF0aDogb3ZlcnJpZGVQcm9wc0RlbGV0ZVBhdGgsCiAgICAgIG92ZXJyaWRlUHJvcHNSZW5hbWVQYXRoOiBvdmVycmlkZVByb3BzUmVuYW1lUGF0aCwKICAgICAgc2V0RXJyb3JIYW5kbGVyOiBzZXRFcnJvckhhbmRsZXIsCiAgICAgIHNldFN1c3BlbnNlSGFuZGxlcjogc2V0U3VzcGVuc2VIYW5kbGVyLAogICAgICBzY2hlZHVsZVVwZGF0ZTogc2NoZWR1bGVVcGRhdGUsCiAgICAgIGN1cnJlbnREaXNwYXRjaGVyUmVmOiBSZWFjdEN1cnJlbnREaXNwYXRjaGVyLAogICAgICBmaW5kSG9zdEluc3RhbmNlQnlGaWJlcjogZmluZEhvc3RJbnN0YW5jZUJ5RmliZXIsCiAgICAgIGZpbmRGaWJlckJ5SG9zdEluc3RhbmNlOiBmaW5kRmliZXJCeUhvc3RJbnN0YW5jZSB8fCBlbXB0eUZpbmRGaWJlckJ5SG9zdEluc3RhbmNlLAogICAgICAvLyBSZWFjdCBSZWZyZXNoCiAgICAgIGZpbmRIb3N0SW5zdGFuY2VzRm9yUmVmcmVzaDogIGZpbmRIb3N0SW5zdGFuY2VzRm9yUmVmcmVzaCAsCiAgICAgIHNjaGVkdWxlUmVmcmVzaDogIHNjaGVkdWxlUmVmcmVzaCAsCiAgICAgIHNjaGVkdWxlUm9vdDogIHNjaGVkdWxlUm9vdCAsCiAgICAgIHNldFJlZnJlc2hIYW5kbGVyOiAgc2V0UmVmcmVzaEhhbmRsZXIgLAogICAgICAvLyBFbmFibGVzIERldlRvb2xzIHRvIGFwcGVuZCBvd25lciBzdGFja3MgdG8gZXJyb3IgbWVzc2FnZXMgaW4gREVWIG1vZGUuCiAgICAgIGdldEN1cnJlbnRGaWJlcjogIGdldEN1cnJlbnRGaWJlckZvckRldlRvb2xzICwKICAgICAgLy8gRW5hYmxlcyBEZXZUb29scyB0byBkZXRlY3QgcmVjb25jaWxlciB2ZXJzaW9uIHJhdGhlciB0aGFuIHJlbmRlcmVyIHZlcnNpb24KICAgICAgLy8gd2hpY2ggbWF5IG5vdCBtYXRjaCBmb3IgdGhpcmQgcGFydHkgcmVuZGVyZXJzLgogICAgICByZWNvbmNpbGVyVmVyc2lvbjogUmVhY3RWZXJzaW9uCiAgICB9KTsKICB9CgogIC8qIGdsb2JhbCByZXBvcnRFcnJvciAqLwoKICB2YXIgZGVmYXVsdE9uUmVjb3ZlcmFibGVFcnJvciA9IHR5cGVvZiByZXBvcnRFcnJvciA9PT0gJ2Z1bmN0aW9uJyA/IC8vIEluIG1vZGVybiBicm93c2VycywgcmVwb3J0RXJyb3Igd2lsbCBkaXNwYXRjaCBhbiBlcnJvciBldmVudCwKICAvLyBlbXVsYXRpbmcgYW4gdW5jYXVnaHQgSmF2YVNjcmlwdCBlcnJvci4KICByZXBvcnRFcnJvciA6IGZ1bmN0aW9uIChlcnJvcikgewogICAgLy8gSW4gb2xkZXIgYnJvd3NlcnMgYW5kIHRlc3QgZW52aXJvbm1lbnRzLCBmYWxsYmFjayB0byBjb25zb2xlLmVycm9yLgogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0LWludGVybmFsL25vLXByb2R1Y3Rpb24tbG9nZ2luZwogICAgY29uc29sZVsnZXJyb3InXShlcnJvcik7CiAgfTsKCiAgZnVuY3Rpb24gUmVhY3RET01Sb290KGludGVybmFsUm9vdCkgewogICAgdGhpcy5faW50ZXJuYWxSb290ID0gaW50ZXJuYWxSb290OwogIH0KCiAgUmVhY3RET01IeWRyYXRpb25Sb290LnByb3RvdHlwZS5yZW5kZXIgPSBSZWFjdERPTVJvb3QucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uIChjaGlsZHJlbikgewogICAgdmFyIHJvb3QgPSB0aGlzLl9pbnRlcm5hbFJvb3Q7CgogICAgaWYgKHJvb3QgPT09IG51bGwpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdDYW5ub3QgdXBkYXRlIGFuIHVubW91bnRlZCByb290LicpOwogICAgfQoKICAgIHsKICAgICAgaWYgKHR5cGVvZiBhcmd1bWVudHNbMV0gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICBlcnJvcigncmVuZGVyKC4uLik6IGRvZXMgbm90IHN1cHBvcnQgdGhlIHNlY29uZCBjYWxsYmFjayBhcmd1bWVudC4gJyArICdUbyBleGVjdXRlIGEgc2lkZSBlZmZlY3QgYWZ0ZXIgcmVuZGVyaW5nLCBkZWNsYXJlIGl0IGluIGEgY29tcG9uZW50IGJvZHkgd2l0aCB1c2VFZmZlY3QoKS4nKTsKICAgICAgfSBlbHNlIGlmIChpc1ZhbGlkQ29udGFpbmVyKGFyZ3VtZW50c1sxXSkpIHsKICAgICAgICBlcnJvcignWW91IHBhc3NlZCBhIGNvbnRhaW5lciB0byB0aGUgc2Vjb25kIGFyZ3VtZW50IG9mIHJvb3QucmVuZGVyKC4uLikuICcgKyAiWW91IGRvbid0IG5lZWQgdG8gcGFzcyBpdCBhZ2FpbiBzaW5jZSB5b3UgYWxyZWFkeSBwYXNzZWQgaXQgdG8gY3JlYXRlIHRoZSByb290LiIpOwogICAgICB9IGVsc2UgaWYgKHR5cGVvZiBhcmd1bWVudHNbMV0gIT09ICd1bmRlZmluZWQnKSB7CiAgICAgICAgZXJyb3IoJ1lvdSBwYXNzZWQgYSBzZWNvbmQgYXJndW1lbnQgdG8gcm9vdC5yZW5kZXIoLi4uKSBidXQgaXQgb25seSBhY2NlcHRzICcgKyAnb25lIGFyZ3VtZW50LicpOwogICAgICB9CgogICAgICB2YXIgY29udGFpbmVyID0gcm9vdC5jb250YWluZXJJbmZvOwoKICAgICAgaWYgKGNvbnRhaW5lci5ub2RlVHlwZSAhPT0gQ09NTUVOVF9OT0RFKSB7CiAgICAgICAgdmFyIGhvc3RJbnN0YW5jZSA9IGZpbmRIb3N0SW5zdGFuY2VXaXRoTm9Qb3J0YWxzKHJvb3QuY3VycmVudCk7CgogICAgICAgIGlmIChob3N0SW5zdGFuY2UpIHsKICAgICAgICAgIGlmIChob3N0SW5zdGFuY2UucGFyZW50Tm9kZSAhPT0gY29udGFpbmVyKSB7CiAgICAgICAgICAgIGVycm9yKCdyZW5kZXIoLi4uKTogSXQgbG9va3MgbGlrZSB0aGUgUmVhY3QtcmVuZGVyZWQgY29udGVudCBvZiB0aGUgJyArICdyb290IGNvbnRhaW5lciB3YXMgcmVtb3ZlZCB3aXRob3V0IHVzaW5nIFJlYWN0LiBUaGlzIGlzIG5vdCAnICsgJ3N1cHBvcnRlZCBhbmQgd2lsbCBjYXVzZSBlcnJvcnMuIEluc3RlYWQsIGNhbGwgJyArICJyb290LnVubW91bnQoKSB0byBlbXB0eSBhIHJvb3QncyBjb250YWluZXIuIik7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgdXBkYXRlQ29udGFpbmVyKGNoaWxkcmVuLCByb290LCBudWxsLCBudWxsKTsKICB9OwoKICBSZWFjdERPTUh5ZHJhdGlvblJvb3QucHJvdG90eXBlLnVubW91bnQgPSBSZWFjdERPTVJvb3QucHJvdG90eXBlLnVubW91bnQgPSBmdW5jdGlvbiAoKSB7CiAgICB7CiAgICAgIGlmICh0eXBlb2YgYXJndW1lbnRzWzBdID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgZXJyb3IoJ3VubW91bnQoLi4uKTogZG9lcyBub3Qgc3VwcG9ydCBhIGNhbGxiYWNrIGFyZ3VtZW50LiAnICsgJ1RvIGV4ZWN1dGUgYSBzaWRlIGVmZmVjdCBhZnRlciByZW5kZXJpbmcsIGRlY2xhcmUgaXQgaW4gYSBjb21wb25lbnQgYm9keSB3aXRoIHVzZUVmZmVjdCgpLicpOwogICAgICB9CiAgICB9CgogICAgdmFyIHJvb3QgPSB0aGlzLl9pbnRlcm5hbFJvb3Q7CgogICAgaWYgKHJvb3QgIT09IG51bGwpIHsKICAgICAgdGhpcy5faW50ZXJuYWxSb290ID0gbnVsbDsKICAgICAgdmFyIGNvbnRhaW5lciA9IHJvb3QuY29udGFpbmVySW5mbzsKCiAgICAgIHsKICAgICAgICBpZiAoaXNBbHJlYWR5UmVuZGVyaW5nKCkpIHsKICAgICAgICAgIGVycm9yKCdBdHRlbXB0ZWQgdG8gc3luY2hyb25vdXNseSB1bm1vdW50IGEgcm9vdCB3aGlsZSBSZWFjdCB3YXMgYWxyZWFkeSAnICsgJ3JlbmRlcmluZy4gUmVhY3QgY2Fubm90IGZpbmlzaCB1bm1vdW50aW5nIHRoZSByb290IHVudGlsIHRoZSAnICsgJ2N1cnJlbnQgcmVuZGVyIGhhcyBjb21wbGV0ZWQsIHdoaWNoIG1heSBsZWFkIHRvIGEgcmFjZSBjb25kaXRpb24uJyk7CiAgICAgICAgfQogICAgICB9CgogICAgICBmbHVzaFN5bmMoZnVuY3Rpb24gKCkgewogICAgICAgIHVwZGF0ZUNvbnRhaW5lcihudWxsLCByb290LCBudWxsLCBudWxsKTsKICAgICAgfSk7CiAgICAgIHVubWFya0NvbnRhaW5lckFzUm9vdChjb250YWluZXIpOwogICAgfQogIH07CgogIGZ1bmN0aW9uIGNyZWF0ZVJvb3QoY29udGFpbmVyLCBvcHRpb25zKSB7CiAgICBpZiAoIWlzVmFsaWRDb250YWluZXIoY29udGFpbmVyKSkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NyZWF0ZVJvb3QoLi4uKTogVGFyZ2V0IGNvbnRhaW5lciBpcyBub3QgYSBET00gZWxlbWVudC4nKTsKICAgIH0KCiAgICB3YXJuSWZSZWFjdERPTUNvbnRhaW5lckluREVWKGNvbnRhaW5lcik7CiAgICB2YXIgaXNTdHJpY3RNb2RlID0gZmFsc2U7CiAgICB2YXIgY29uY3VycmVudFVwZGF0ZXNCeURlZmF1bHRPdmVycmlkZSA9IGZhbHNlOwogICAgdmFyIGlkZW50aWZpZXJQcmVmaXggPSAnJzsKICAgIHZhciBvblJlY292ZXJhYmxlRXJyb3IgPSBkZWZhdWx0T25SZWNvdmVyYWJsZUVycm9yOwogICAgdmFyIHRyYW5zaXRpb25DYWxsYmFja3MgPSBudWxsOwoKICAgIGlmIChvcHRpb25zICE9PSBudWxsICYmIG9wdGlvbnMgIT09IHVuZGVmaW5lZCkgewogICAgICB7CiAgICAgICAgaWYgKG9wdGlvbnMuaHlkcmF0ZSkgewogICAgICAgICAgd2FybignaHlkcmF0ZSB0aHJvdWdoIGNyZWF0ZVJvb3QgaXMgZGVwcmVjYXRlZC4gVXNlIFJlYWN0RE9NQ2xpZW50Lmh5ZHJhdGVSb290KGNvbnRhaW5lciwgPEFwcCAvPikgaW5zdGVhZC4nKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKHR5cGVvZiBvcHRpb25zID09PSAnb2JqZWN0JyAmJiBvcHRpb25zICE9PSBudWxsICYmIG9wdGlvbnMuJCR0eXBlb2YgPT09IFJFQUNUX0VMRU1FTlRfVFlQRSkgewogICAgICAgICAgICBlcnJvcignWW91IHBhc3NlZCBhIEpTWCBlbGVtZW50IHRvIGNyZWF0ZVJvb3QuIFlvdSBwcm9iYWJseSBtZWFudCB0byAnICsgJ2NhbGwgcm9vdC5yZW5kZXIgaW5zdGVhZC4gJyArICdFeGFtcGxlIHVzYWdlOlxuXG4nICsgJyAgbGV0IHJvb3QgPSBjcmVhdGVSb290KGRvbUNvbnRhaW5lcik7XG4nICsgJyAgcm9vdC5yZW5kZXIoPEFwcCAvPik7Jyk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAob3B0aW9ucy51bnN0YWJsZV9zdHJpY3RNb2RlID09PSB0cnVlKSB7CiAgICAgICAgaXNTdHJpY3RNb2RlID0gdHJ1ZTsKICAgICAgfQoKICAgICAgaWYgKG9wdGlvbnMuaWRlbnRpZmllclByZWZpeCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgaWRlbnRpZmllclByZWZpeCA9IG9wdGlvbnMuaWRlbnRpZmllclByZWZpeDsKICAgICAgfQoKICAgICAgaWYgKG9wdGlvbnMub25SZWNvdmVyYWJsZUVycm9yICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBvblJlY292ZXJhYmxlRXJyb3IgPSBvcHRpb25zLm9uUmVjb3ZlcmFibGVFcnJvcjsKICAgICAgfQoKICAgICAgaWYgKG9wdGlvbnMudHJhbnNpdGlvbkNhbGxiYWNrcyAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgdHJhbnNpdGlvbkNhbGxiYWNrcyA9IG9wdGlvbnMudHJhbnNpdGlvbkNhbGxiYWNrczsKICAgICAgfQogICAgfQoKICAgIHZhciByb290ID0gY3JlYXRlQ29udGFpbmVyKGNvbnRhaW5lciwgQ29uY3VycmVudFJvb3QsIG51bGwsIGlzU3RyaWN0TW9kZSwgY29uY3VycmVudFVwZGF0ZXNCeURlZmF1bHRPdmVycmlkZSwgaWRlbnRpZmllclByZWZpeCwgb25SZWNvdmVyYWJsZUVycm9yKTsKICAgIG1hcmtDb250YWluZXJBc1Jvb3Qocm9vdC5jdXJyZW50LCBjb250YWluZXIpOwogICAgdmFyIHJvb3RDb250YWluZXJFbGVtZW50ID0gY29udGFpbmVyLm5vZGVUeXBlID09PSBDT01NRU5UX05PREUgPyBjb250YWluZXIucGFyZW50Tm9kZSA6IGNvbnRhaW5lcjsKICAgIGxpc3RlblRvQWxsU3VwcG9ydGVkRXZlbnRzKHJvb3RDb250YWluZXJFbGVtZW50KTsKICAgIHJldHVybiBuZXcgUmVhY3RET01Sb290KHJvb3QpOwogIH0KCiAgZnVuY3Rpb24gUmVhY3RET01IeWRyYXRpb25Sb290KGludGVybmFsUm9vdCkgewogICAgdGhpcy5faW50ZXJuYWxSb290ID0gaW50ZXJuYWxSb290OwogIH0KCiAgZnVuY3Rpb24gc2NoZWR1bGVIeWRyYXRpb24odGFyZ2V0KSB7CiAgICBpZiAodGFyZ2V0KSB7CiAgICAgIHF1ZXVlRXhwbGljaXRIeWRyYXRpb25UYXJnZXQodGFyZ2V0KTsKICAgIH0KICB9CgogIFJlYWN0RE9NSHlkcmF0aW9uUm9vdC5wcm90b3R5cGUudW5zdGFibGVfc2NoZWR1bGVIeWRyYXRpb24gPSBzY2hlZHVsZUh5ZHJhdGlvbjsKICBmdW5jdGlvbiBoeWRyYXRlUm9vdChjb250YWluZXIsIGluaXRpYWxDaGlsZHJlbiwgb3B0aW9ucykgewogICAgaWYgKCFpc1ZhbGlkQ29udGFpbmVyKGNvbnRhaW5lcikpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdoeWRyYXRlUm9vdCguLi4pOiBUYXJnZXQgY29udGFpbmVyIGlzIG5vdCBhIERPTSBlbGVtZW50LicpOwogICAgfQoKICAgIHdhcm5JZlJlYWN0RE9NQ29udGFpbmVySW5ERVYoY29udGFpbmVyKTsKCiAgICB7CiAgICAgIGlmIChpbml0aWFsQ2hpbGRyZW4gPT09IHVuZGVmaW5lZCkgewogICAgICAgIGVycm9yKCdNdXN0IHByb3ZpZGUgaW5pdGlhbCBjaGlsZHJlbiBhcyBzZWNvbmQgYXJndW1lbnQgdG8gaHlkcmF0ZVJvb3QuICcgKyAnRXhhbXBsZSB1c2FnZTogaHlkcmF0ZVJvb3QoZG9tQ29udGFpbmVyLCA8QXBwIC8+KScpOwogICAgICB9CiAgICB9IC8vIEZvciBub3cgd2UgcmV1c2UgdGhlIHdob2xlIGJhZyBvZiBvcHRpb25zIHNpbmNlIHRoZXkgY29udGFpbgogICAgLy8gdGhlIGh5ZHJhdGlvbiBjYWxsYmFja3MuCgoKICAgIHZhciBoeWRyYXRpb25DYWxsYmFja3MgPSBvcHRpb25zICE9IG51bGwgPyBvcHRpb25zIDogbnVsbDsgLy8gVE9ETzogRGVsZXRlIHRoaXMgb3B0aW9uCgogICAgdmFyIG11dGFibGVTb3VyY2VzID0gb3B0aW9ucyAhPSBudWxsICYmIG9wdGlvbnMuaHlkcmF0ZWRTb3VyY2VzIHx8IG51bGw7CiAgICB2YXIgaXNTdHJpY3RNb2RlID0gZmFsc2U7CiAgICB2YXIgY29uY3VycmVudFVwZGF0ZXNCeURlZmF1bHRPdmVycmlkZSA9IGZhbHNlOwogICAgdmFyIGlkZW50aWZpZXJQcmVmaXggPSAnJzsKICAgIHZhciBvblJlY292ZXJhYmxlRXJyb3IgPSBkZWZhdWx0T25SZWNvdmVyYWJsZUVycm9yOwoKICAgIGlmIChvcHRpb25zICE9PSBudWxsICYmIG9wdGlvbnMgIT09IHVuZGVmaW5lZCkgewogICAgICBpZiAob3B0aW9ucy51bnN0YWJsZV9zdHJpY3RNb2RlID09PSB0cnVlKSB7CiAgICAgICAgaXNTdHJpY3RNb2RlID0gdHJ1ZTsKICAgICAgfQoKICAgICAgaWYgKG9wdGlvbnMuaWRlbnRpZmllclByZWZpeCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgaWRlbnRpZmllclByZWZpeCA9IG9wdGlvbnMuaWRlbnRpZmllclByZWZpeDsKICAgICAgfQoKICAgICAgaWYgKG9wdGlvbnMub25SZWNvdmVyYWJsZUVycm9yICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBvblJlY292ZXJhYmxlRXJyb3IgPSBvcHRpb25zLm9uUmVjb3ZlcmFibGVFcnJvcjsKICAgICAgfQogICAgfQoKICAgIHZhciByb290ID0gY3JlYXRlSHlkcmF0aW9uQ29udGFpbmVyKGluaXRpYWxDaGlsZHJlbiwgbnVsbCwgY29udGFpbmVyLCBDb25jdXJyZW50Um9vdCwgaHlkcmF0aW9uQ2FsbGJhY2tzLCBpc1N0cmljdE1vZGUsIGNvbmN1cnJlbnRVcGRhdGVzQnlEZWZhdWx0T3ZlcnJpZGUsIGlkZW50aWZpZXJQcmVmaXgsIG9uUmVjb3ZlcmFibGVFcnJvcik7CiAgICBtYXJrQ29udGFpbmVyQXNSb290KHJvb3QuY3VycmVudCwgY29udGFpbmVyKTsgLy8gVGhpcyBjYW4ndCBiZSBhIGNvbW1lbnQgbm9kZSBzaW5jZSBoeWRyYXRpb24gZG9lc24ndCB3b3JrIG9uIGNvbW1lbnQgbm9kZXMgYW55d2F5LgoKICAgIGxpc3RlblRvQWxsU3VwcG9ydGVkRXZlbnRzKGNvbnRhaW5lcik7CgogICAgaWYgKG11dGFibGVTb3VyY2VzKSB7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbXV0YWJsZVNvdXJjZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICB2YXIgbXV0YWJsZVNvdXJjZSA9IG11dGFibGVTb3VyY2VzW2ldOwogICAgICAgIHJlZ2lzdGVyTXV0YWJsZVNvdXJjZUZvckh5ZHJhdGlvbihyb290LCBtdXRhYmxlU291cmNlKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBuZXcgUmVhY3RET01IeWRyYXRpb25Sb290KHJvb3QpOwogIH0KICBmdW5jdGlvbiBpc1ZhbGlkQ29udGFpbmVyKG5vZGUpIHsKICAgIHJldHVybiAhIShub2RlICYmIChub2RlLm5vZGVUeXBlID09PSBFTEVNRU5UX05PREUgfHwgbm9kZS5ub2RlVHlwZSA9PT0gRE9DVU1FTlRfTk9ERSB8fCBub2RlLm5vZGVUeXBlID09PSBET0NVTUVOVF9GUkFHTUVOVF9OT0RFIHx8ICFkaXNhYmxlQ29tbWVudHNBc0RPTUNvbnRhaW5lcnMgICkpOwogIH0gLy8gVE9ETzogUmVtb3ZlIHRoaXMgZnVuY3Rpb24gd2hpY2ggYWxzbyBpbmNsdWRlcyBjb21tZW50IG5vZGVzLgogIC8vIFdlIG9ubHkgdXNlIGl0IGluIHBsYWNlcyB0aGF0IGFyZSBjdXJyZW50bHkgbW9yZSByZWxheGVkLgoKICBmdW5jdGlvbiBpc1ZhbGlkQ29udGFpbmVyTGVnYWN5KG5vZGUpIHsKICAgIHJldHVybiAhIShub2RlICYmIChub2RlLm5vZGVUeXBlID09PSBFTEVNRU5UX05PREUgfHwgbm9kZS5ub2RlVHlwZSA9PT0gRE9DVU1FTlRfTk9ERSB8fCBub2RlLm5vZGVUeXBlID09PSBET0NVTUVOVF9GUkFHTUVOVF9OT0RFIHx8IG5vZGUubm9kZVR5cGUgPT09IENPTU1FTlRfTk9ERSAmJiBub2RlLm5vZGVWYWx1ZSA9PT0gJyByZWFjdC1tb3VudC1wb2ludC11bnN0YWJsZSAnKSk7CiAgfQoKICBmdW5jdGlvbiB3YXJuSWZSZWFjdERPTUNvbnRhaW5lckluREVWKGNvbnRhaW5lcikgewogICAgewogICAgICBpZiAoY29udGFpbmVyLm5vZGVUeXBlID09PSBFTEVNRU5UX05PREUgJiYgY29udGFpbmVyLnRhZ05hbWUgJiYgY29udGFpbmVyLnRhZ05hbWUudG9VcHBlckNhc2UoKSA9PT0gJ0JPRFknKSB7CiAgICAgICAgZXJyb3IoJ2NyZWF0ZVJvb3QoKTogQ3JlYXRpbmcgcm9vdHMgZGlyZWN0bHkgd2l0aCBkb2N1bWVudC5ib2R5IGlzICcgKyAnZGlzY291cmFnZWQsIHNpbmNlIGl0cyBjaGlsZHJlbiBhcmUgb2Z0ZW4gbWFuaXB1bGF0ZWQgYnkgdGhpcmQtcGFydHkgJyArICdzY3JpcHRzIGFuZCBicm93c2VyIGV4dGVuc2lvbnMuIFRoaXMgbWF5IGxlYWQgdG8gc3VidGxlICcgKyAncmVjb25jaWxpYXRpb24gaXNzdWVzLiBUcnkgdXNpbmcgYSBjb250YWluZXIgZWxlbWVudCBjcmVhdGVkICcgKyAnZm9yIHlvdXIgYXBwLicpOwogICAgICB9CgogICAgICBpZiAoaXNDb250YWluZXJNYXJrZWRBc1Jvb3QoY29udGFpbmVyKSkgewogICAgICAgIGlmIChjb250YWluZXIuX3JlYWN0Um9vdENvbnRhaW5lcikgewogICAgICAgICAgZXJyb3IoJ1lvdSBhcmUgY2FsbGluZyBSZWFjdERPTUNsaWVudC5jcmVhdGVSb290KCkgb24gYSBjb250YWluZXIgdGhhdCB3YXMgcHJldmlvdXNseSAnICsgJ3Bhc3NlZCB0byBSZWFjdERPTS5yZW5kZXIoKS4gVGhpcyBpcyBub3Qgc3VwcG9ydGVkLicpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBlcnJvcignWW91IGFyZSBjYWxsaW5nIFJlYWN0RE9NQ2xpZW50LmNyZWF0ZVJvb3QoKSBvbiBhIGNvbnRhaW5lciB0aGF0ICcgKyAnaGFzIGFscmVhZHkgYmVlbiBwYXNzZWQgdG8gY3JlYXRlUm9vdCgpIGJlZm9yZS4gSW5zdGVhZCwgY2FsbCAnICsgJ3Jvb3QucmVuZGVyKCkgb24gdGhlIGV4aXN0aW5nIHJvb3QgaW5zdGVhZCBpZiB5b3Ugd2FudCB0byB1cGRhdGUgaXQuJyk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQoKICB2YXIgUmVhY3RDdXJyZW50T3duZXIkMyA9IFJlYWN0U2hhcmVkSW50ZXJuYWxzLlJlYWN0Q3VycmVudE93bmVyOwogIHZhciB0b3BMZXZlbFVwZGF0ZVdhcm5pbmdzOwoKICB7CiAgICB0b3BMZXZlbFVwZGF0ZVdhcm5pbmdzID0gZnVuY3Rpb24gKGNvbnRhaW5lcikgewogICAgICBpZiAoY29udGFpbmVyLl9yZWFjdFJvb3RDb250YWluZXIgJiYgY29udGFpbmVyLm5vZGVUeXBlICE9PSBDT01NRU5UX05PREUpIHsKICAgICAgICB2YXIgaG9zdEluc3RhbmNlID0gZmluZEhvc3RJbnN0YW5jZVdpdGhOb1BvcnRhbHMoY29udGFpbmVyLl9yZWFjdFJvb3RDb250YWluZXIuY3VycmVudCk7CgogICAgICAgIGlmIChob3N0SW5zdGFuY2UpIHsKICAgICAgICAgIGlmIChob3N0SW5zdGFuY2UucGFyZW50Tm9kZSAhPT0gY29udGFpbmVyKSB7CiAgICAgICAgICAgIGVycm9yKCdyZW5kZXIoLi4uKTogSXQgbG9va3MgbGlrZSB0aGUgUmVhY3QtcmVuZGVyZWQgY29udGVudCBvZiB0aGlzICcgKyAnY29udGFpbmVyIHdhcyByZW1vdmVkIHdpdGhvdXQgdXNpbmcgUmVhY3QuIFRoaXMgaXMgbm90ICcgKyAnc3VwcG9ydGVkIGFuZCB3aWxsIGNhdXNlIGVycm9ycy4gSW5zdGVhZCwgY2FsbCAnICsgJ1JlYWN0RE9NLnVubW91bnRDb21wb25lbnRBdE5vZGUgdG8gZW1wdHkgYSBjb250YWluZXIuJyk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgaXNSb290UmVuZGVyZWRCeVNvbWVSZWFjdCA9ICEhY29udGFpbmVyLl9yZWFjdFJvb3RDb250YWluZXI7CiAgICAgIHZhciByb290RWwgPSBnZXRSZWFjdFJvb3RFbGVtZW50SW5Db250YWluZXIoY29udGFpbmVyKTsKICAgICAgdmFyIGhhc05vblJvb3RSZWFjdENoaWxkID0gISEocm9vdEVsICYmIGdldEluc3RhbmNlRnJvbU5vZGUocm9vdEVsKSk7CgogICAgICBpZiAoaGFzTm9uUm9vdFJlYWN0Q2hpbGQgJiYgIWlzUm9vdFJlbmRlcmVkQnlTb21lUmVhY3QpIHsKICAgICAgICBlcnJvcigncmVuZGVyKC4uLik6IFJlcGxhY2luZyBSZWFjdC1yZW5kZXJlZCBjaGlsZHJlbiB3aXRoIGEgbmV3IHJvb3QgJyArICdjb21wb25lbnQuIElmIHlvdSBpbnRlbmRlZCB0byB1cGRhdGUgdGhlIGNoaWxkcmVuIG9mIHRoaXMgbm9kZSwgJyArICd5b3Ugc2hvdWxkIGluc3RlYWQgaGF2ZSB0aGUgZXhpc3RpbmcgY2hpbGRyZW4gdXBkYXRlIHRoZWlyIHN0YXRlICcgKyAnYW5kIHJlbmRlciB0aGUgbmV3IGNvbXBvbmVudHMgaW5zdGVhZCBvZiBjYWxsaW5nIFJlYWN0RE9NLnJlbmRlci4nKTsKICAgICAgfQoKICAgICAgaWYgKGNvbnRhaW5lci5ub2RlVHlwZSA9PT0gRUxFTUVOVF9OT0RFICYmIGNvbnRhaW5lci50YWdOYW1lICYmIGNvbnRhaW5lci50YWdOYW1lLnRvVXBwZXJDYXNlKCkgPT09ICdCT0RZJykgewogICAgICAgIGVycm9yKCdyZW5kZXIoKTogUmVuZGVyaW5nIGNvbXBvbmVudHMgZGlyZWN0bHkgaW50byBkb2N1bWVudC5ib2R5IGlzICcgKyAnZGlzY291cmFnZWQsIHNpbmNlIGl0cyBjaGlsZHJlbiBhcmUgb2Z0ZW4gbWFuaXB1bGF0ZWQgYnkgdGhpcmQtcGFydHkgJyArICdzY3JpcHRzIGFuZCBicm93c2VyIGV4dGVuc2lvbnMuIFRoaXMgbWF5IGxlYWQgdG8gc3VidGxlICcgKyAncmVjb25jaWxpYXRpb24gaXNzdWVzLiBUcnkgcmVuZGVyaW5nIGludG8gYSBjb250YWluZXIgZWxlbWVudCBjcmVhdGVkICcgKyAnZm9yIHlvdXIgYXBwLicpOwogICAgICB9CiAgICB9OwogIH0KCiAgZnVuY3Rpb24gZ2V0UmVhY3RSb290RWxlbWVudEluQ29udGFpbmVyKGNvbnRhaW5lcikgewogICAgaWYgKCFjb250YWluZXIpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgaWYgKGNvbnRhaW5lci5ub2RlVHlwZSA9PT0gRE9DVU1FTlRfTk9ERSkgewogICAgICByZXR1cm4gY29udGFpbmVyLmRvY3VtZW50RWxlbWVudDsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBjb250YWluZXIuZmlyc3RDaGlsZDsKICAgIH0KICB9CgogIGZ1bmN0aW9uIG5vb3BPblJlY292ZXJhYmxlRXJyb3IoKSB7Ly8gVGhpcyBpc24ndCByZWFjaGFibGUgYmVjYXVzZSBvblJlY292ZXJhYmxlRXJyb3IgaXNuJ3QgY2FsbGVkIGluIHRoZQogICAgLy8gbGVnYWN5IEFQSS4KICB9CgogIGZ1bmN0aW9uIGxlZ2FjeUNyZWF0ZVJvb3RGcm9tRE9NQ29udGFpbmVyKGNvbnRhaW5lciwgaW5pdGlhbENoaWxkcmVuLCBwYXJlbnRDb21wb25lbnQsIGNhbGxiYWNrLCBpc0h5ZHJhdGlvbkNvbnRhaW5lcikgewogICAgaWYgKGlzSHlkcmF0aW9uQ29udGFpbmVyKSB7CiAgICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICB2YXIgb3JpZ2luYWxDYWxsYmFjayA9IGNhbGxiYWNrOwoKICAgICAgICBjYWxsYmFjayA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBpbnN0YW5jZSA9IGdldFB1YmxpY1Jvb3RJbnN0YW5jZShyb290KTsKICAgICAgICAgIG9yaWdpbmFsQ2FsbGJhY2suY2FsbChpbnN0YW5jZSk7CiAgICAgICAgfTsKICAgICAgfQoKICAgICAgdmFyIHJvb3QgPSBjcmVhdGVIeWRyYXRpb25Db250YWluZXIoaW5pdGlhbENoaWxkcmVuLCBjYWxsYmFjaywgY29udGFpbmVyLCBMZWdhY3lSb290LCBudWxsLCAvLyBoeWRyYXRpb25DYWxsYmFja3MKICAgICAgZmFsc2UsIC8vIGlzU3RyaWN0TW9kZQogICAgICBmYWxzZSwgLy8gY29uY3VycmVudFVwZGF0ZXNCeURlZmF1bHRPdmVycmlkZSwKICAgICAgJycsIC8vIGlkZW50aWZpZXJQcmVmaXgKICAgICAgbm9vcE9uUmVjb3ZlcmFibGVFcnJvcik7CiAgICAgIGNvbnRhaW5lci5fcmVhY3RSb290Q29udGFpbmVyID0gcm9vdDsKICAgICAgbWFya0NvbnRhaW5lckFzUm9vdChyb290LmN1cnJlbnQsIGNvbnRhaW5lcik7CiAgICAgIHZhciByb290Q29udGFpbmVyRWxlbWVudCA9IGNvbnRhaW5lci5ub2RlVHlwZSA9PT0gQ09NTUVOVF9OT0RFID8gY29udGFpbmVyLnBhcmVudE5vZGUgOiBjb250YWluZXI7CiAgICAgIGxpc3RlblRvQWxsU3VwcG9ydGVkRXZlbnRzKHJvb3RDb250YWluZXJFbGVtZW50KTsKICAgICAgZmx1c2hTeW5jKCk7CiAgICAgIHJldHVybiByb290OwogICAgfSBlbHNlIHsKICAgICAgLy8gRmlyc3QgY2xlYXIgYW55IGV4aXN0aW5nIGNvbnRlbnQuCiAgICAgIHZhciByb290U2libGluZzsKCiAgICAgIHdoaWxlIChyb290U2libGluZyA9IGNvbnRhaW5lci5sYXN0Q2hpbGQpIHsKICAgICAgICBjb250YWluZXIucmVtb3ZlQ2hpbGQocm9vdFNpYmxpbmcpOwogICAgICB9CgogICAgICBpZiAodHlwZW9mIGNhbGxiYWNrID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgdmFyIF9vcmlnaW5hbENhbGxiYWNrID0gY2FsbGJhY2s7CgogICAgICAgIGNhbGxiYWNrID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIGluc3RhbmNlID0gZ2V0UHVibGljUm9vdEluc3RhbmNlKF9yb290KTsKCiAgICAgICAgICBfb3JpZ2luYWxDYWxsYmFjay5jYWxsKGluc3RhbmNlKTsKICAgICAgICB9OwogICAgICB9CgogICAgICB2YXIgX3Jvb3QgPSBjcmVhdGVDb250YWluZXIoY29udGFpbmVyLCBMZWdhY3lSb290LCBudWxsLCAvLyBoeWRyYXRpb25DYWxsYmFja3MKICAgICAgZmFsc2UsIC8vIGlzU3RyaWN0TW9kZQogICAgICBmYWxzZSwgLy8gY29uY3VycmVudFVwZGF0ZXNCeURlZmF1bHRPdmVycmlkZSwKICAgICAgJycsIC8vIGlkZW50aWZpZXJQcmVmaXgKICAgICAgbm9vcE9uUmVjb3ZlcmFibGVFcnJvcik7CgogICAgICBjb250YWluZXIuX3JlYWN0Um9vdENvbnRhaW5lciA9IF9yb290OwogICAgICBtYXJrQ29udGFpbmVyQXNSb290KF9yb290LmN1cnJlbnQsIGNvbnRhaW5lcik7CgogICAgICB2YXIgX3Jvb3RDb250YWluZXJFbGVtZW50ID0gY29udGFpbmVyLm5vZGVUeXBlID09PSBDT01NRU5UX05PREUgPyBjb250YWluZXIucGFyZW50Tm9kZSA6IGNvbnRhaW5lcjsKCiAgICAgIGxpc3RlblRvQWxsU3VwcG9ydGVkRXZlbnRzKF9yb290Q29udGFpbmVyRWxlbWVudCk7IC8vIEluaXRpYWwgbW91bnQgc2hvdWxkIG5vdCBiZSBiYXRjaGVkLgoKICAgICAgZmx1c2hTeW5jKGZ1bmN0aW9uICgpIHsKICAgICAgICB1cGRhdGVDb250YWluZXIoaW5pdGlhbENoaWxkcmVuLCBfcm9vdCwgcGFyZW50Q29tcG9uZW50LCBjYWxsYmFjayk7CiAgICAgIH0pOwogICAgICByZXR1cm4gX3Jvb3Q7CiAgICB9CiAgfQoKICBmdW5jdGlvbiB3YXJuT25JbnZhbGlkQ2FsbGJhY2skMShjYWxsYmFjaywgY2FsbGVyTmFtZSkgewogICAgewogICAgICBpZiAoY2FsbGJhY2sgIT09IG51bGwgJiYgdHlwZW9mIGNhbGxiYWNrICE9PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgZXJyb3IoJyVzKC4uLik6IEV4cGVjdGVkIHRoZSBsYXN0IG9wdGlvbmFsIGBjYWxsYmFja2AgYXJndW1lbnQgdG8gYmUgYSAnICsgJ2Z1bmN0aW9uLiBJbnN0ZWFkIHJlY2VpdmVkOiAlcy4nLCBjYWxsZXJOYW1lLCBjYWxsYmFjayk7CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIGxlZ2FjeVJlbmRlclN1YnRyZWVJbnRvQ29udGFpbmVyKHBhcmVudENvbXBvbmVudCwgY2hpbGRyZW4sIGNvbnRhaW5lciwgZm9yY2VIeWRyYXRlLCBjYWxsYmFjaykgewogICAgewogICAgICB0b3BMZXZlbFVwZGF0ZVdhcm5pbmdzKGNvbnRhaW5lcik7CiAgICAgIHdhcm5PbkludmFsaWRDYWxsYmFjayQxKGNhbGxiYWNrID09PSB1bmRlZmluZWQgPyBudWxsIDogY2FsbGJhY2ssICdyZW5kZXInKTsKICAgIH0KCiAgICB2YXIgbWF5YmVSb290ID0gY29udGFpbmVyLl9yZWFjdFJvb3RDb250YWluZXI7CiAgICB2YXIgcm9vdDsKCiAgICBpZiAoIW1heWJlUm9vdCkgewogICAgICAvLyBJbml0aWFsIG1vdW50CiAgICAgIHJvb3QgPSBsZWdhY3lDcmVhdGVSb290RnJvbURPTUNvbnRhaW5lcihjb250YWluZXIsIGNoaWxkcmVuLCBwYXJlbnRDb21wb25lbnQsIGNhbGxiYWNrLCBmb3JjZUh5ZHJhdGUpOwogICAgfSBlbHNlIHsKICAgICAgcm9vdCA9IG1heWJlUm9vdDsKCiAgICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICB2YXIgb3JpZ2luYWxDYWxsYmFjayA9IGNhbGxiYWNrOwoKICAgICAgICBjYWxsYmFjayA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBpbnN0YW5jZSA9IGdldFB1YmxpY1Jvb3RJbnN0YW5jZShyb290KTsKICAgICAgICAgIG9yaWdpbmFsQ2FsbGJhY2suY2FsbChpbnN0YW5jZSk7CiAgICAgICAgfTsKICAgICAgfSAvLyBVcGRhdGUKCgogICAgICB1cGRhdGVDb250YWluZXIoY2hpbGRyZW4sIHJvb3QsIHBhcmVudENvbXBvbmVudCwgY2FsbGJhY2spOwogICAgfQoKICAgIHJldHVybiBnZXRQdWJsaWNSb290SW5zdGFuY2Uocm9vdCk7CiAgfQoKICB2YXIgZGlkV2FybkFib3V0RmluZERPTU5vZGUgPSBmYWxzZTsKICBmdW5jdGlvbiBmaW5kRE9NTm9kZShjb21wb25lbnRPckVsZW1lbnQpIHsKICAgIHsKICAgICAgaWYgKCFkaWRXYXJuQWJvdXRGaW5kRE9NTm9kZSkgewogICAgICAgIGRpZFdhcm5BYm91dEZpbmRET01Ob2RlID0gdHJ1ZTsKCiAgICAgICAgZXJyb3IoJ2ZpbmRET01Ob2RlIGlzIGRlcHJlY2F0ZWQgYW5kIHdpbGwgYmUgcmVtb3ZlZCBpbiB0aGUgbmV4dCBtYWpvciAnICsgJ3JlbGVhc2UuIEluc3RlYWQsIGFkZCBhIHJlZiBkaXJlY3RseSB0byB0aGUgZWxlbWVudCB5b3Ugd2FudCAnICsgJ3RvIHJlZmVyZW5jZS4gTGVhcm4gbW9yZSBhYm91dCB1c2luZyByZWZzIHNhZmVseSBoZXJlOiAnICsgJ2h0dHBzOi8vcmVhY3Rqcy5vcmcvbGluay9zdHJpY3QtbW9kZS1maW5kLW5vZGUnKTsKICAgICAgfQoKICAgICAgdmFyIG93bmVyID0gUmVhY3RDdXJyZW50T3duZXIkMy5jdXJyZW50OwoKICAgICAgaWYgKG93bmVyICE9PSBudWxsICYmIG93bmVyLnN0YXRlTm9kZSAhPT0gbnVsbCkgewogICAgICAgIHZhciB3YXJuZWRBYm91dFJlZnNJblJlbmRlciA9IG93bmVyLnN0YXRlTm9kZS5fd2FybmVkQWJvdXRSZWZzSW5SZW5kZXI7CgogICAgICAgIGlmICghd2FybmVkQWJvdXRSZWZzSW5SZW5kZXIpIHsKICAgICAgICAgIGVycm9yKCclcyBpcyBhY2Nlc3NpbmcgZmluZERPTU5vZGUgaW5zaWRlIGl0cyByZW5kZXIoKS4gJyArICdyZW5kZXIoKSBzaG91bGQgYmUgYSBwdXJlIGZ1bmN0aW9uIG9mIHByb3BzIGFuZCBzdGF0ZS4gSXQgc2hvdWxkICcgKyAnbmV2ZXIgYWNjZXNzIHNvbWV0aGluZyB0aGF0IHJlcXVpcmVzIHN0YWxlIGRhdGEgZnJvbSB0aGUgcHJldmlvdXMgJyArICdyZW5kZXIsIHN1Y2ggYXMgcmVmcy4gTW92ZSB0aGlzIGxvZ2ljIHRvIGNvbXBvbmVudERpZE1vdW50IGFuZCAnICsgJ2NvbXBvbmVudERpZFVwZGF0ZSBpbnN0ZWFkLicsIGdldENvbXBvbmVudE5hbWVGcm9tVHlwZShvd25lci50eXBlKSB8fCAnQSBjb21wb25lbnQnKTsKICAgICAgICB9CgogICAgICAgIG93bmVyLnN0YXRlTm9kZS5fd2FybmVkQWJvdXRSZWZzSW5SZW5kZXIgPSB0cnVlOwogICAgICB9CiAgICB9CgogICAgaWYgKGNvbXBvbmVudE9yRWxlbWVudCA9PSBudWxsKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIGlmIChjb21wb25lbnRPckVsZW1lbnQubm9kZVR5cGUgPT09IEVMRU1FTlRfTk9ERSkgewogICAgICByZXR1cm4gY29tcG9uZW50T3JFbGVtZW50OwogICAgfQoKICAgIHsKICAgICAgcmV0dXJuIGZpbmRIb3N0SW5zdGFuY2VXaXRoV2FybmluZyhjb21wb25lbnRPckVsZW1lbnQsICdmaW5kRE9NTm9kZScpOwogICAgfQogIH0KICBmdW5jdGlvbiBoeWRyYXRlKGVsZW1lbnQsIGNvbnRhaW5lciwgY2FsbGJhY2spIHsKICAgIHsKICAgICAgZXJyb3IoJ1JlYWN0RE9NLmh5ZHJhdGUgaXMgbm8gbG9uZ2VyIHN1cHBvcnRlZCBpbiBSZWFjdCAxOC4gVXNlIGh5ZHJhdGVSb290ICcgKyAnaW5zdGVhZC4gVW50aWwgeW91IHN3aXRjaCB0byB0aGUgbmV3IEFQSSwgeW91ciBhcHAgd2lsbCBiZWhhdmUgYXMgJyArICJpZiBpdCdzIHJ1bm5pbmcgUmVhY3QgMTcuIExlYXJuICIgKyAnbW9yZTogaHR0cHM6Ly9yZWFjdGpzLm9yZy9saW5rL3N3aXRjaC10by1jcmVhdGVyb290Jyk7CiAgICB9CgogICAgaWYgKCFpc1ZhbGlkQ29udGFpbmVyTGVnYWN5KGNvbnRhaW5lcikpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdUYXJnZXQgY29udGFpbmVyIGlzIG5vdCBhIERPTSBlbGVtZW50LicpOwogICAgfQoKICAgIHsKICAgICAgdmFyIGlzTW9kZXJuUm9vdCA9IGlzQ29udGFpbmVyTWFya2VkQXNSb290KGNvbnRhaW5lcikgJiYgY29udGFpbmVyLl9yZWFjdFJvb3RDb250YWluZXIgPT09IHVuZGVmaW5lZDsKCiAgICAgIGlmIChpc01vZGVyblJvb3QpIHsKICAgICAgICBlcnJvcignWW91IGFyZSBjYWxsaW5nIFJlYWN0RE9NLmh5ZHJhdGUoKSBvbiBhIGNvbnRhaW5lciB0aGF0IHdhcyBwcmV2aW91c2x5ICcgKyAncGFzc2VkIHRvIFJlYWN0RE9NQ2xpZW50LmNyZWF0ZVJvb3QoKS4gVGhpcyBpcyBub3Qgc3VwcG9ydGVkLiAnICsgJ0RpZCB5b3UgbWVhbiB0byBjYWxsIGh5ZHJhdGVSb290KGNvbnRhaW5lciwgZWxlbWVudCk/Jyk7CiAgICAgIH0KICAgIH0gLy8gVE9ETzogdGhyb3cgb3Igd2FybiBpZiB3ZSBjb3VsZG4ndCBoeWRyYXRlPwoKCiAgICByZXR1cm4gbGVnYWN5UmVuZGVyU3VidHJlZUludG9Db250YWluZXIobnVsbCwgZWxlbWVudCwgY29udGFpbmVyLCB0cnVlLCBjYWxsYmFjayk7CiAgfQogIGZ1bmN0aW9uIHJlbmRlcihlbGVtZW50LCBjb250YWluZXIsIGNhbGxiYWNrKSB7CiAgICB7CiAgICAgIGVycm9yKCdSZWFjdERPTS5yZW5kZXIgaXMgbm8gbG9uZ2VyIHN1cHBvcnRlZCBpbiBSZWFjdCAxOC4gVXNlIGNyZWF0ZVJvb3QgJyArICdpbnN0ZWFkLiBVbnRpbCB5b3Ugc3dpdGNoIHRvIHRoZSBuZXcgQVBJLCB5b3VyIGFwcCB3aWxsIGJlaGF2ZSBhcyAnICsgImlmIGl0J3MgcnVubmluZyBSZWFjdCAxNy4gTGVhcm4gIiArICdtb3JlOiBodHRwczovL3JlYWN0anMub3JnL2xpbmsvc3dpdGNoLXRvLWNyZWF0ZXJvb3QnKTsKICAgIH0KCiAgICBpZiAoIWlzVmFsaWRDb250YWluZXJMZWdhY3koY29udGFpbmVyKSkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RhcmdldCBjb250YWluZXIgaXMgbm90IGEgRE9NIGVsZW1lbnQuJyk7CiAgICB9CgogICAgewogICAgICB2YXIgaXNNb2Rlcm5Sb290ID0gaXNDb250YWluZXJNYXJrZWRBc1Jvb3QoY29udGFpbmVyKSAmJiBjb250YWluZXIuX3JlYWN0Um9vdENvbnRhaW5lciA9PT0gdW5kZWZpbmVkOwoKICAgICAgaWYgKGlzTW9kZXJuUm9vdCkgewogICAgICAgIGVycm9yKCdZb3UgYXJlIGNhbGxpbmcgUmVhY3RET00ucmVuZGVyKCkgb24gYSBjb250YWluZXIgdGhhdCB3YXMgcHJldmlvdXNseSAnICsgJ3Bhc3NlZCB0byBSZWFjdERPTUNsaWVudC5jcmVhdGVSb290KCkuIFRoaXMgaXMgbm90IHN1cHBvcnRlZC4gJyArICdEaWQgeW91IG1lYW4gdG8gY2FsbCByb290LnJlbmRlcihlbGVtZW50KT8nKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBsZWdhY3lSZW5kZXJTdWJ0cmVlSW50b0NvbnRhaW5lcihudWxsLCBlbGVtZW50LCBjb250YWluZXIsIGZhbHNlLCBjYWxsYmFjayk7CiAgfQogIGZ1bmN0aW9uIHVuc3RhYmxlX3JlbmRlclN1YnRyZWVJbnRvQ29udGFpbmVyKHBhcmVudENvbXBvbmVudCwgZWxlbWVudCwgY29udGFpbmVyTm9kZSwgY2FsbGJhY2spIHsKICAgIHsKICAgICAgZXJyb3IoJ1JlYWN0RE9NLnVuc3RhYmxlX3JlbmRlclN1YnRyZWVJbnRvQ29udGFpbmVyKCkgaXMgbm8gbG9uZ2VyIHN1cHBvcnRlZCAnICsgJ2luIFJlYWN0IDE4LiBDb25zaWRlciB1c2luZyBhIHBvcnRhbCBpbnN0ZWFkLiBVbnRpbCB5b3Ugc3dpdGNoIHRvICcgKyAidGhlIGNyZWF0ZVJvb3QgQVBJLCB5b3VyIGFwcCB3aWxsIGJlaGF2ZSBhcyBpZiBpdCdzIHJ1bm5pbmcgUmVhY3QgIiArICcxNy4gTGVhcm4gbW9yZTogaHR0cHM6Ly9yZWFjdGpzLm9yZy9saW5rL3N3aXRjaC10by1jcmVhdGVyb290Jyk7CiAgICB9CgogICAgaWYgKCFpc1ZhbGlkQ29udGFpbmVyTGVnYWN5KGNvbnRhaW5lck5vZGUpKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignVGFyZ2V0IGNvbnRhaW5lciBpcyBub3QgYSBET00gZWxlbWVudC4nKTsKICAgIH0KCiAgICBpZiAocGFyZW50Q29tcG9uZW50ID09IG51bGwgfHwgIWhhcyhwYXJlbnRDb21wb25lbnQpKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigncGFyZW50Q29tcG9uZW50IG11c3QgYmUgYSB2YWxpZCBSZWFjdCBDb21wb25lbnQnKTsKICAgIH0KCiAgICByZXR1cm4gbGVnYWN5UmVuZGVyU3VidHJlZUludG9Db250YWluZXIocGFyZW50Q29tcG9uZW50LCBlbGVtZW50LCBjb250YWluZXJOb2RlLCBmYWxzZSwgY2FsbGJhY2spOwogIH0KICB2YXIgZGlkV2FybkFib3V0VW5tb3VudENvbXBvbmVudEF0Tm9kZSA9IGZhbHNlOwogIGZ1bmN0aW9uIHVubW91bnRDb21wb25lbnRBdE5vZGUoY29udGFpbmVyKSB7CiAgICB7CiAgICAgIGlmICghZGlkV2FybkFib3V0VW5tb3VudENvbXBvbmVudEF0Tm9kZSkgewogICAgICAgIGRpZFdhcm5BYm91dFVubW91bnRDb21wb25lbnRBdE5vZGUgPSB0cnVlOwoKICAgICAgICBlcnJvcigndW5tb3VudENvbXBvbmVudEF0Tm9kZSBpcyBkZXByZWNhdGVkIGFuZCB3aWxsIGJlIHJlbW92ZWQgaW4gdGhlICcgKyAnbmV4dCBtYWpvciByZWxlYXNlLiBTd2l0Y2ggdG8gdGhlIGNyZWF0ZVJvb3QgQVBJLiBMZWFybiAnICsgJ21vcmU6IGh0dHBzOi8vcmVhY3Rqcy5vcmcvbGluay9zd2l0Y2gtdG8tY3JlYXRlcm9vdCcpOwogICAgICB9CiAgICB9CgogICAgaWYgKCFpc1ZhbGlkQ29udGFpbmVyTGVnYWN5KGNvbnRhaW5lcikpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCd1bm1vdW50Q29tcG9uZW50QXROb2RlKC4uLik6IFRhcmdldCBjb250YWluZXIgaXMgbm90IGEgRE9NIGVsZW1lbnQuJyk7CiAgICB9CgogICAgewogICAgICB2YXIgaXNNb2Rlcm5Sb290ID0gaXNDb250YWluZXJNYXJrZWRBc1Jvb3QoY29udGFpbmVyKSAmJiBjb250YWluZXIuX3JlYWN0Um9vdENvbnRhaW5lciA9PT0gdW5kZWZpbmVkOwoKICAgICAgaWYgKGlzTW9kZXJuUm9vdCkgewogICAgICAgIGVycm9yKCdZb3UgYXJlIGNhbGxpbmcgUmVhY3RET00udW5tb3VudENvbXBvbmVudEF0Tm9kZSgpIG9uIGEgY29udGFpbmVyIHRoYXQgd2FzIHByZXZpb3VzbHkgJyArICdwYXNzZWQgdG8gUmVhY3RET01DbGllbnQuY3JlYXRlUm9vdCgpLiBUaGlzIGlzIG5vdCBzdXBwb3J0ZWQuIERpZCB5b3UgbWVhbiB0byBjYWxsIHJvb3QudW5tb3VudCgpPycpOwogICAgICB9CiAgICB9CgogICAgaWYgKGNvbnRhaW5lci5fcmVhY3RSb290Q29udGFpbmVyKSB7CiAgICAgIHsKICAgICAgICB2YXIgcm9vdEVsID0gZ2V0UmVhY3RSb290RWxlbWVudEluQ29udGFpbmVyKGNvbnRhaW5lcik7CiAgICAgICAgdmFyIHJlbmRlcmVkQnlEaWZmZXJlbnRSZWFjdCA9IHJvb3RFbCAmJiAhZ2V0SW5zdGFuY2VGcm9tTm9kZShyb290RWwpOwoKICAgICAgICBpZiAocmVuZGVyZWRCeURpZmZlcmVudFJlYWN0KSB7CiAgICAgICAgICBlcnJvcigidW5tb3VudENvbXBvbmVudEF0Tm9kZSgpOiBUaGUgbm9kZSB5b3UncmUgYXR0ZW1wdGluZyB0byB1bm1vdW50ICIgKyAnd2FzIHJlbmRlcmVkIGJ5IGFub3RoZXIgY29weSBvZiBSZWFjdC4nKTsKICAgICAgICB9CiAgICAgIH0gLy8gVW5tb3VudCBzaG91bGQgbm90IGJlIGJhdGNoZWQuCgoKICAgICAgZmx1c2hTeW5jKGZ1bmN0aW9uICgpIHsKICAgICAgICBsZWdhY3lSZW5kZXJTdWJ0cmVlSW50b0NvbnRhaW5lcihudWxsLCBudWxsLCBjb250YWluZXIsIGZhbHNlLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvLyAkRmxvd0ZpeE1lIFRoaXMgc2hvdWxkIHByb2JhYmx5IHVzZSBgZGVsZXRlIGNvbnRhaW5lci5fcmVhY3RSb290Q29udGFpbmVyYAogICAgICAgICAgY29udGFpbmVyLl9yZWFjdFJvb3RDb250YWluZXIgPSBudWxsOwogICAgICAgICAgdW5tYXJrQ29udGFpbmVyQXNSb290KGNvbnRhaW5lcik7CiAgICAgICAgfSk7CiAgICAgIH0pOyAvLyBJZiB5b3UgY2FsbCB1bm1vdW50Q29tcG9uZW50QXROb2RlIHR3aWNlIGluIHF1aWNrIHN1Y2Nlc3Npb24sIHlvdSdsbAogICAgICAvLyBnZXQgYHRydWVgIHR3aWNlLiBUaGF0J3MgcHJvYmFibHkgZmluZT8KCiAgICAgIHJldHVybiB0cnVlOwogICAgfSBlbHNlIHsKICAgICAgewogICAgICAgIHZhciBfcm9vdEVsID0gZ2V0UmVhY3RSb290RWxlbWVudEluQ29udGFpbmVyKGNvbnRhaW5lcik7CgogICAgICAgIHZhciBoYXNOb25Sb290UmVhY3RDaGlsZCA9ICEhKF9yb290RWwgJiYgZ2V0SW5zdGFuY2VGcm9tTm9kZShfcm9vdEVsKSk7IC8vIENoZWNrIGlmIHRoZSBjb250YWluZXIgaXRzZWxmIGlzIGEgUmVhY3Qgcm9vdCBub2RlLgoKICAgICAgICB2YXIgaXNDb250YWluZXJSZWFjdFJvb3QgPSBjb250YWluZXIubm9kZVR5cGUgPT09IEVMRU1FTlRfTk9ERSAmJiBpc1ZhbGlkQ29udGFpbmVyTGVnYWN5KGNvbnRhaW5lci5wYXJlbnROb2RlKSAmJiAhIWNvbnRhaW5lci5wYXJlbnROb2RlLl9yZWFjdFJvb3RDb250YWluZXI7CgogICAgICAgIGlmIChoYXNOb25Sb290UmVhY3RDaGlsZCkgewogICAgICAgICAgZXJyb3IoInVubW91bnRDb21wb25lbnRBdE5vZGUoKTogVGhlIG5vZGUgeW91J3JlIGF0dGVtcHRpbmcgdG8gdW5tb3VudCAiICsgJ3dhcyByZW5kZXJlZCBieSBSZWFjdCBhbmQgaXMgbm90IGEgdG9wLWxldmVsIGNvbnRhaW5lci4gJXMnLCBpc0NvbnRhaW5lclJlYWN0Um9vdCA/ICdZb3UgbWF5IGhhdmUgYWNjaWRlbnRhbGx5IHBhc3NlZCBpbiBhIFJlYWN0IHJvb3Qgbm9kZSBpbnN0ZWFkICcgKyAnb2YgaXRzIGNvbnRhaW5lci4nIDogJ0luc3RlYWQsIGhhdmUgdGhlIHBhcmVudCBjb21wb25lbnQgdXBkYXRlIGl0cyBzdGF0ZSBhbmQgJyArICdyZXJlbmRlciBpbiBvcmRlciB0byByZW1vdmUgdGhpcyBjb21wb25lbnQuJyk7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfQoKICBzZXRBdHRlbXB0U3luY2hyb25vdXNIeWRyYXRpb24oYXR0ZW1wdFN5bmNocm9ub3VzSHlkcmF0aW9uJDEpOwogIHNldEF0dGVtcHRDb250aW51b3VzSHlkcmF0aW9uKGF0dGVtcHRDb250aW51b3VzSHlkcmF0aW9uJDEpOwogIHNldEF0dGVtcHRIeWRyYXRpb25BdEN1cnJlbnRQcmlvcml0eShhdHRlbXB0SHlkcmF0aW9uQXRDdXJyZW50UHJpb3JpdHkkMSk7CiAgc2V0R2V0Q3VycmVudFVwZGF0ZVByaW9yaXR5KGdldEN1cnJlbnRVcGRhdGVQcmlvcml0eSk7CiAgc2V0QXR0ZW1wdEh5ZHJhdGlvbkF0UHJpb3JpdHkocnVuV2l0aFByaW9yaXR5KTsKCiAgewogICAgaWYgKHR5cGVvZiBNYXAgIT09ICdmdW5jdGlvbicgfHwgLy8gJEZsb3dJc3N1ZSBGbG93IGluY29ycmVjdGx5IHRoaW5rcyBNYXAgaGFzIG5vIHByb3RvdHlwZQogICAgTWFwLnByb3RvdHlwZSA9PSBudWxsIHx8IHR5cGVvZiBNYXAucHJvdG90eXBlLmZvckVhY2ggIT09ICdmdW5jdGlvbicgfHwgdHlwZW9mIFNldCAhPT0gJ2Z1bmN0aW9uJyB8fCAvLyAkRmxvd0lzc3VlIEZsb3cgaW5jb3JyZWN0bHkgdGhpbmtzIFNldCBoYXMgbm8gcHJvdG90eXBlCiAgICBTZXQucHJvdG90eXBlID09IG51bGwgfHwgdHlwZW9mIFNldC5wcm90b3R5cGUuY2xlYXIgIT09ICdmdW5jdGlvbicgfHwgdHlwZW9mIFNldC5wcm90b3R5cGUuZm9yRWFjaCAhPT0gJ2Z1bmN0aW9uJykgewogICAgICBlcnJvcignUmVhY3QgZGVwZW5kcyBvbiBNYXAgYW5kIFNldCBidWlsdC1pbiB0eXBlcy4gTWFrZSBzdXJlIHRoYXQgeW91IGxvYWQgYSAnICsgJ3BvbHlmaWxsIGluIG9sZGVyIGJyb3dzZXJzLiBodHRwczovL3JlYWN0anMub3JnL2xpbmsvcmVhY3QtcG9seWZpbGxzJyk7CiAgICB9CiAgfQoKICBzZXRSZXN0b3JlSW1wbGVtZW50YXRpb24ocmVzdG9yZUNvbnRyb2xsZWRTdGF0ZSQzKTsKICBzZXRCYXRjaGluZ0ltcGxlbWVudGF0aW9uKGJhdGNoZWRVcGRhdGVzJDEsIGRpc2NyZXRlVXBkYXRlcywgZmx1c2hTeW5jKTsKCiAgZnVuY3Rpb24gY3JlYXRlUG9ydGFsJDEoY2hpbGRyZW4sIGNvbnRhaW5lcikgewogICAgdmFyIGtleSA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogbnVsbDsKCiAgICBpZiAoIWlzVmFsaWRDb250YWluZXIoY29udGFpbmVyKSkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RhcmdldCBjb250YWluZXIgaXMgbm90IGEgRE9NIGVsZW1lbnQuJyk7CiAgICB9IC8vIFRPRE86IHBhc3MgUmVhY3RET00gcG9ydGFsIGltcGxlbWVudGF0aW9uIGFzIHRoaXJkIGFyZ3VtZW50CiAgICAvLyAkRmxvd0ZpeE1lIFRoZSBGbG93IHR5cGUgaXMgb3BhcXVlIGJ1dCB0aGVyZSdzIG5vIHdheSB0byBhY3R1YWxseSBjcmVhdGUgaXQuCgoKICAgIHJldHVybiBjcmVhdGVQb3J0YWwoY2hpbGRyZW4sIGNvbnRhaW5lciwgbnVsbCwga2V5KTsKICB9CgogIGZ1bmN0aW9uIHJlbmRlclN1YnRyZWVJbnRvQ29udGFpbmVyKHBhcmVudENvbXBvbmVudCwgZWxlbWVudCwgY29udGFpbmVyTm9kZSwgY2FsbGJhY2spIHsKICAgIHJldHVybiB1bnN0YWJsZV9yZW5kZXJTdWJ0cmVlSW50b0NvbnRhaW5lcihwYXJlbnRDb21wb25lbnQsIGVsZW1lbnQsIGNvbnRhaW5lck5vZGUsIGNhbGxiYWNrKTsKICB9CgogIHZhciBJbnRlcm5hbHMgPSB7CiAgICB1c2luZ0NsaWVudEVudHJ5UG9pbnQ6IGZhbHNlLAogICAgLy8gS2VlcCBpbiBzeW5jIHdpdGggUmVhY3RUZXN0VXRpbHMuanMuCiAgICAvLyBUaGlzIGlzIGFuIGFycmF5IGZvciBiZXR0ZXIgbWluaWZpY2F0aW9uLgogICAgRXZlbnRzOiBbZ2V0SW5zdGFuY2VGcm9tTm9kZSwgZ2V0Tm9kZUZyb21JbnN0YW5jZSwgZ2V0RmliZXJDdXJyZW50UHJvcHNGcm9tTm9kZSwgZW5xdWV1ZVN0YXRlUmVzdG9yZSwgcmVzdG9yZVN0YXRlSWZOZWVkZWQsIGJhdGNoZWRVcGRhdGVzJDFdCiAgfTsKCiAgZnVuY3Rpb24gY3JlYXRlUm9vdCQxKGNvbnRhaW5lciwgb3B0aW9ucykgewogICAgewogICAgICBpZiAoIUludGVybmFscy51c2luZ0NsaWVudEVudHJ5UG9pbnQgJiYgIXRydWUpIHsKICAgICAgICBlcnJvcignWW91IGFyZSBpbXBvcnRpbmcgY3JlYXRlUm9vdCBmcm9tICJyZWFjdC1kb20iIHdoaWNoIGlzIG5vdCBzdXBwb3J0ZWQuICcgKyAnWW91IHNob3VsZCBpbnN0ZWFkIGltcG9ydCBpdCBmcm9tICJyZWFjdC1kb20vY2xpZW50Ii4nKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBjcmVhdGVSb290KGNvbnRhaW5lciwgb3B0aW9ucyk7CiAgfQoKICBmdW5jdGlvbiBoeWRyYXRlUm9vdCQxKGNvbnRhaW5lciwgaW5pdGlhbENoaWxkcmVuLCBvcHRpb25zKSB7CiAgICB7CiAgICAgIGlmICghSW50ZXJuYWxzLnVzaW5nQ2xpZW50RW50cnlQb2ludCAmJiAhdHJ1ZSkgewogICAgICAgIGVycm9yKCdZb3UgYXJlIGltcG9ydGluZyBoeWRyYXRlUm9vdCBmcm9tICJyZWFjdC1kb20iIHdoaWNoIGlzIG5vdCBzdXBwb3J0ZWQuICcgKyAnWW91IHNob3VsZCBpbnN0ZWFkIGltcG9ydCBpdCBmcm9tICJyZWFjdC1kb20vY2xpZW50Ii4nKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBoeWRyYXRlUm9vdChjb250YWluZXIsIGluaXRpYWxDaGlsZHJlbiwgb3B0aW9ucyk7CiAgfSAvLyBPdmVybG9hZCB0aGUgZGVmaW5pdGlvbiB0byB0aGUgdHdvIHZhbGlkIHNpZ25hdHVyZXMuCiAgLy8gV2FybmluZywgdGhpcyBvcHRzLW91dCBvZiBjaGVja2luZyB0aGUgZnVuY3Rpb24gYm9keS4KCgogIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1yZWRlY2xhcmUKICBmdW5jdGlvbiBmbHVzaFN5bmMkMShmbikgewogICAgewogICAgICBpZiAoaXNBbHJlYWR5UmVuZGVyaW5nKCkpIHsKICAgICAgICBlcnJvcignZmx1c2hTeW5jIHdhcyBjYWxsZWQgZnJvbSBpbnNpZGUgYSBsaWZlY3ljbGUgbWV0aG9kLiBSZWFjdCBjYW5ub3QgJyArICdmbHVzaCB3aGVuIFJlYWN0IGlzIGFscmVhZHkgcmVuZGVyaW5nLiBDb25zaWRlciBtb3ZpbmcgdGhpcyBjYWxsIHRvICcgKyAnYSBzY2hlZHVsZXIgdGFzayBvciBtaWNybyB0YXNrLicpOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIGZsdXNoU3luYyhmbik7CiAgfQogIHZhciBmb3VuZERldlRvb2xzID0gaW5qZWN0SW50b0RldlRvb2xzKHsKICAgIGZpbmRGaWJlckJ5SG9zdEluc3RhbmNlOiBnZXRDbG9zZXN0SW5zdGFuY2VGcm9tTm9kZSwKICAgIGJ1bmRsZVR5cGU6ICAxICwKICAgIHZlcnNpb246IFJlYWN0VmVyc2lvbiwKICAgIHJlbmRlcmVyUGFja2FnZU5hbWU6ICdyZWFjdC1kb20nCiAgfSk7CgogIHsKICAgIGlmICghZm91bmREZXZUb29scyAmJiBjYW5Vc2VET00gJiYgd2luZG93LnRvcCA9PT0gd2luZG93LnNlbGYpIHsKICAgICAgLy8gSWYgd2UncmUgaW4gQ2hyb21lIG9yIEZpcmVmb3gsIHByb3ZpZGUgYSBkb3dubG9hZCBsaW5rIGlmIG5vdCBpbnN0YWxsZWQuCiAgICAgIGlmIChuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoJ0Nocm9tZScpID4gLTEgJiYgbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCdFZGdlJykgPT09IC0xIHx8IG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZignRmlyZWZveCcpID4gLTEpIHsKICAgICAgICB2YXIgcHJvdG9jb2wgPSB3aW5kb3cubG9jYXRpb24ucHJvdG9jb2w7IC8vIERvbid0IHdhcm4gaW4gZXhvdGljIGNhc2VzIGxpa2UgY2hyb21lLWV4dGVuc2lvbjovLy4KCiAgICAgICAgaWYgKC9eKGh0dHBzP3xmaWxlKTokLy50ZXN0KHByb3RvY29sKSkgewogICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0LWludGVybmFsL25vLXByb2R1Y3Rpb24tbG9nZ2luZwogICAgICAgICAgY29uc29sZS5pbmZvKCclY0Rvd25sb2FkIHRoZSBSZWFjdCBEZXZUb29scyAnICsgJ2ZvciBhIGJldHRlciBkZXZlbG9wbWVudCBleHBlcmllbmNlOiAnICsgJ2h0dHBzOi8vcmVhY3Rqcy5vcmcvbGluay9yZWFjdC1kZXZ0b29scycgKyAocHJvdG9jb2wgPT09ICdmaWxlOicgPyAnXG5Zb3UgbWlnaHQgbmVlZCB0byB1c2UgYSBsb2NhbCBIVFRQIHNlcnZlciAoaW5zdGVhZCBvZiBmaWxlOi8vKTogJyArICdodHRwczovL3JlYWN0anMub3JnL2xpbmsvcmVhY3QtZGV2dG9vbHMtZmFxJyA6ICcnKSwgJ2ZvbnQtd2VpZ2h0OmJvbGQnKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CgogIGV4cG9ydHMuX19TRUNSRVRfSU5URVJOQUxTX0RPX05PVF9VU0VfT1JfWU9VX1dJTExfQkVfRklSRUQgPSBJbnRlcm5hbHM7CiAgZXhwb3J0cy5jcmVhdGVQb3J0YWwgPSBjcmVhdGVQb3J0YWwkMTsKICBleHBvcnRzLmNyZWF0ZVJvb3QgPSBjcmVhdGVSb290JDE7CiAgZXhwb3J0cy5maW5kRE9NTm9kZSA9IGZpbmRET01Ob2RlOwogIGV4cG9ydHMuZmx1c2hTeW5jID0gZmx1c2hTeW5jJDE7CiAgZXhwb3J0cy5oeWRyYXRlID0gaHlkcmF0ZTsKICBleHBvcnRzLmh5ZHJhdGVSb290ID0gaHlkcmF0ZVJvb3QkMTsKICBleHBvcnRzLnJlbmRlciA9IHJlbmRlcjsKICBleHBvcnRzLnVubW91bnRDb21wb25lbnRBdE5vZGUgPSB1bm1vdW50Q29tcG9uZW50QXROb2RlOwogIGV4cG9ydHMudW5zdGFibGVfYmF0Y2hlZFVwZGF0ZXMgPSBiYXRjaGVkVXBkYXRlcyQxOwogIGV4cG9ydHMudW5zdGFibGVfcmVuZGVyU3VidHJlZUludG9Db250YWluZXIgPSByZW5kZXJTdWJ0cmVlSW50b0NvbnRhaW5lcjsKICBleHBvcnRzLnZlcnNpb24gPSBSZWFjdFZlcnNpb247Cgp9KSkpOwo=",mtime:1744325324207},"assets/react.development.js":{data:"data:application/javascript;base64,LyoqCiAqIEBsaWNlbnNlIFJlYWN0CiAqIHJlYWN0LmRldmVsb3BtZW50LmpzCiAqCiAqIENvcHlyaWdodCAoYykgRmFjZWJvb2ssIEluYy4gYW5kIGl0cyBhZmZpbGlhdGVzLgogKgogKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGUKICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLgogKi8KKGZ1bmN0aW9uIChnbG9iYWwsIGZhY3RvcnkpIHsKICB0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgPyBmYWN0b3J5KGV4cG9ydHMpIDoKICB0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQgPyBkZWZpbmUoWydleHBvcnRzJ10sIGZhY3RvcnkpIDoKICAoZ2xvYmFsID0gZ2xvYmFsIHx8IHNlbGYsIGZhY3RvcnkoZ2xvYmFsLlJlYWN0ID0ge30pKTsKfSh0aGlzLCAoZnVuY3Rpb24gKGV4cG9ydHMpIHsgJ3VzZSBzdHJpY3QnOwoKICB2YXIgUmVhY3RWZXJzaW9uID0gJzE4LjIuMCc7CgogIC8vIEFUVEVOVElPTgogIC8vIFdoZW4gYWRkaW5nIG5ldyBzeW1ib2xzIHRvIHRoaXMgZmlsZSwKICAvLyBQbGVhc2UgY29uc2lkZXIgYWxzbyBhZGRpbmcgdG8gJ3JlYWN0LWRldnRvb2xzLXNoYXJlZC9zcmMvYmFja2VuZC9SZWFjdFN5bWJvbHMnCiAgLy8gVGhlIFN5bWJvbCB1c2VkIHRvIHRhZyB0aGUgUmVhY3RFbGVtZW50LWxpa2UgdHlwZXMuCiAgdmFyIFJFQUNUX0VMRU1FTlRfVFlQRSA9IFN5bWJvbC5mb3IoJ3JlYWN0LmVsZW1lbnQnKTsKICB2YXIgUkVBQ1RfUE9SVEFMX1RZUEUgPSBTeW1ib2wuZm9yKCdyZWFjdC5wb3J0YWwnKTsKICB2YXIgUkVBQ1RfRlJBR01FTlRfVFlQRSA9IFN5bWJvbC5mb3IoJ3JlYWN0LmZyYWdtZW50Jyk7CiAgdmFyIFJFQUNUX1NUUklDVF9NT0RFX1RZUEUgPSBTeW1ib2wuZm9yKCdyZWFjdC5zdHJpY3RfbW9kZScpOwogIHZhciBSRUFDVF9QUk9GSUxFUl9UWVBFID0gU3ltYm9sLmZvcigncmVhY3QucHJvZmlsZXInKTsKICB2YXIgUkVBQ1RfUFJPVklERVJfVFlQRSA9IFN5bWJvbC5mb3IoJ3JlYWN0LnByb3ZpZGVyJyk7CiAgdmFyIFJFQUNUX0NPTlRFWFRfVFlQRSA9IFN5bWJvbC5mb3IoJ3JlYWN0LmNvbnRleHQnKTsKICB2YXIgUkVBQ1RfRk9SV0FSRF9SRUZfVFlQRSA9IFN5bWJvbC5mb3IoJ3JlYWN0LmZvcndhcmRfcmVmJyk7CiAgdmFyIFJFQUNUX1NVU1BFTlNFX1RZUEUgPSBTeW1ib2wuZm9yKCdyZWFjdC5zdXNwZW5zZScpOwogIHZhciBSRUFDVF9TVVNQRU5TRV9MSVNUX1RZUEUgPSBTeW1ib2wuZm9yKCdyZWFjdC5zdXNwZW5zZV9saXN0Jyk7CiAgdmFyIFJFQUNUX01FTU9fVFlQRSA9IFN5bWJvbC5mb3IoJ3JlYWN0Lm1lbW8nKTsKICB2YXIgUkVBQ1RfTEFaWV9UWVBFID0gU3ltYm9sLmZvcigncmVhY3QubGF6eScpOwogIHZhciBSRUFDVF9PRkZTQ1JFRU5fVFlQRSA9IFN5bWJvbC5mb3IoJ3JlYWN0Lm9mZnNjcmVlbicpOwogIHZhciBNQVlCRV9JVEVSQVRPUl9TWU1CT0wgPSBTeW1ib2wuaXRlcmF0b3I7CiAgdmFyIEZBVVhfSVRFUkFUT1JfU1lNQk9MID0gJ0BAaXRlcmF0b3InOwogIGZ1bmN0aW9uIGdldEl0ZXJhdG9yRm4obWF5YmVJdGVyYWJsZSkgewogICAgaWYgKG1heWJlSXRlcmFibGUgPT09IG51bGwgfHwgdHlwZW9mIG1heWJlSXRlcmFibGUgIT09ICdvYmplY3QnKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIHZhciBtYXliZUl0ZXJhdG9yID0gTUFZQkVfSVRFUkFUT1JfU1lNQk9MICYmIG1heWJlSXRlcmFibGVbTUFZQkVfSVRFUkFUT1JfU1lNQk9MXSB8fCBtYXliZUl0ZXJhYmxlW0ZBVVhfSVRFUkFUT1JfU1lNQk9MXTsKCiAgICBpZiAodHlwZW9mIG1heWJlSXRlcmF0b3IgPT09ICdmdW5jdGlvbicpIHsKICAgICAgcmV0dXJuIG1heWJlSXRlcmF0b3I7CiAgICB9CgogICAgcmV0dXJuIG51bGw7CiAgfQoKICAvKioKICAgKiBLZWVwcyB0cmFjayBvZiB0aGUgY3VycmVudCBkaXNwYXRjaGVyLgogICAqLwogIHZhciBSZWFjdEN1cnJlbnREaXNwYXRjaGVyID0gewogICAgLyoqCiAgICAgKiBAaW50ZXJuYWwKICAgICAqIEB0eXBlIHtSZWFjdENvbXBvbmVudH0KICAgICAqLwogICAgY3VycmVudDogbnVsbAogIH07CgogIC8qKgogICAqIEtlZXBzIHRyYWNrIG9mIHRoZSBjdXJyZW50IGJhdGNoJ3MgY29uZmlndXJhdGlvbiBzdWNoIGFzIGhvdyBsb25nIGFuIHVwZGF0ZQogICAqIHNob3VsZCBzdXNwZW5kIGZvciBpZiBpdCBuZWVkcyB0by4KICAgKi8KICB2YXIgUmVhY3RDdXJyZW50QmF0Y2hDb25maWcgPSB7CiAgICB0cmFuc2l0aW9uOiBudWxsCiAgfTsKCiAgdmFyIFJlYWN0Q3VycmVudEFjdFF1ZXVlID0gewogICAgY3VycmVudDogbnVsbCwKICAgIC8vIFVzZWQgdG8gcmVwcm9kdWNlIGJlaGF2aW9yIG9mIGBiYXRjaGVkVXBkYXRlc2AgaW4gbGVnYWN5IG1vZGUuCiAgICBpc0JhdGNoaW5nTGVnYWN5OiBmYWxzZSwKICAgIGRpZFNjaGVkdWxlTGVnYWN5VXBkYXRlOiBmYWxzZQogIH07CgogIC8qKgogICAqIEtlZXBzIHRyYWNrIG9mIHRoZSBjdXJyZW50IG93bmVyLgogICAqCiAgICogVGhlIGN1cnJlbnQgb3duZXIgaXMgdGhlIGNvbXBvbmVudCB3aG8gc2hvdWxkIG93biBhbnkgY29tcG9uZW50cyB0aGF0IGFyZQogICAqIGN1cnJlbnRseSBiZWluZyBjb25zdHJ1Y3RlZC4KICAgKi8KICB2YXIgUmVhY3RDdXJyZW50T3duZXIgPSB7CiAgICAvKioKICAgICAqIEBpbnRlcm5hbAogICAgICogQHR5cGUge1JlYWN0Q29tcG9uZW50fQogICAgICovCiAgICBjdXJyZW50OiBudWxsCiAgfTsKCiAgdmFyIFJlYWN0RGVidWdDdXJyZW50RnJhbWUgPSB7fTsKICB2YXIgY3VycmVudEV4dHJhU3RhY2tGcmFtZSA9IG51bGw7CiAgZnVuY3Rpb24gc2V0RXh0cmFTdGFja0ZyYW1lKHN0YWNrKSB7CiAgICB7CiAgICAgIGN1cnJlbnRFeHRyYVN0YWNrRnJhbWUgPSBzdGFjazsKICAgIH0KICB9CgogIHsKICAgIFJlYWN0RGVidWdDdXJyZW50RnJhbWUuc2V0RXh0cmFTdGFja0ZyYW1lID0gZnVuY3Rpb24gKHN0YWNrKSB7CiAgICAgIHsKICAgICAgICBjdXJyZW50RXh0cmFTdGFja0ZyYW1lID0gc3RhY2s7CiAgICAgIH0KICAgIH07IC8vIFN0YWNrIGltcGxlbWVudGF0aW9uIGluamVjdGVkIGJ5IHRoZSBjdXJyZW50IHJlbmRlcmVyLgoKCiAgICBSZWFjdERlYnVnQ3VycmVudEZyYW1lLmdldEN1cnJlbnRTdGFjayA9IG51bGw7CgogICAgUmVhY3REZWJ1Z0N1cnJlbnRGcmFtZS5nZXRTdGFja0FkZGVuZHVtID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgc3RhY2sgPSAnJzsgLy8gQWRkIGFuIGV4dHJhIHRvcCBmcmFtZSB3aGlsZSBhbiBlbGVtZW50IGlzIGJlaW5nIHZhbGlkYXRlZAoKICAgICAgaWYgKGN1cnJlbnRFeHRyYVN0YWNrRnJhbWUpIHsKICAgICAgICBzdGFjayArPSBjdXJyZW50RXh0cmFTdGFja0ZyYW1lOwogICAgICB9IC8vIERlbGVnYXRlIHRvIHRoZSBpbmplY3RlZCByZW5kZXJlci1zcGVjaWZpYyBpbXBsZW1lbnRhdGlvbgoKCiAgICAgIHZhciBpbXBsID0gUmVhY3REZWJ1Z0N1cnJlbnRGcmFtZS5nZXRDdXJyZW50U3RhY2s7CgogICAgICBpZiAoaW1wbCkgewogICAgICAgIHN0YWNrICs9IGltcGwoKSB8fCAnJzsKICAgICAgfQoKICAgICAgcmV0dXJuIHN0YWNrOwogICAgfTsKICB9CgogIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgogIHZhciBlbmFibGVTY29wZUFQSSA9IGZhbHNlOyAvLyBFeHBlcmltZW50YWwgQ3JlYXRlIEV2ZW50IEhhbmRsZSBBUEkuCiAgdmFyIGVuYWJsZUNhY2hlRWxlbWVudCA9IGZhbHNlOwogIHZhciBlbmFibGVUcmFuc2l0aW9uVHJhY2luZyA9IGZhbHNlOyAvLyBObyBrbm93biBidWdzLCBidXQgbmVlZHMgcGVyZm9ybWFuY2UgdGVzdGluZwoKICB2YXIgZW5hYmxlTGVnYWN5SGlkZGVuID0gZmFsc2U7IC8vIEVuYWJsZXMgdW5zdGFibGVfYXZvaWRUaGlzRmFsbGJhY2sgZmVhdHVyZSBpbiBGaWJlcgogIC8vIHN0dWZmLiBJbnRlbmRlZCB0byBlbmFibGUgUmVhY3QgY29yZSBtZW1iZXJzIHRvIG1vcmUgZWFzaWx5IGRlYnVnIHNjaGVkdWxpbmcKICAvLyBpc3N1ZXMgaW4gREVWIGJ1aWxkcy4KCiAgdmFyIGVuYWJsZURlYnVnVHJhY2luZyA9IGZhbHNlOyAvLyBUcmFjayB3aGljaCBGaWJlcihzKSBzY2hlZHVsZSByZW5kZXIgd29yay4KCiAgdmFyIFJlYWN0U2hhcmVkSW50ZXJuYWxzID0gewogICAgUmVhY3RDdXJyZW50RGlzcGF0Y2hlcjogUmVhY3RDdXJyZW50RGlzcGF0Y2hlciwKICAgIFJlYWN0Q3VycmVudEJhdGNoQ29uZmlnOiBSZWFjdEN1cnJlbnRCYXRjaENvbmZpZywKICAgIFJlYWN0Q3VycmVudE93bmVyOiBSZWFjdEN1cnJlbnRPd25lcgogIH07CgogIHsKICAgIFJlYWN0U2hhcmVkSW50ZXJuYWxzLlJlYWN0RGVidWdDdXJyZW50RnJhbWUgPSBSZWFjdERlYnVnQ3VycmVudEZyYW1lOwogICAgUmVhY3RTaGFyZWRJbnRlcm5hbHMuUmVhY3RDdXJyZW50QWN0UXVldWUgPSBSZWFjdEN1cnJlbnRBY3RRdWV1ZTsKICB9CgogIC8vIGJ5IGNhbGxzIHRvIHRoZXNlIG1ldGhvZHMgYnkgYSBCYWJlbCBwbHVnaW4uCiAgLy8KICAvLyBJbiBQUk9EIChvciBpbiBwYWNrYWdlcyB3aXRob3V0IGFjY2VzcyB0byBSZWFjdCBpbnRlcm5hbHMpLAogIC8vIHRoZXkgYXJlIGxlZnQgYXMgdGhleSBhcmUgaW5zdGVhZC4KCiAgZnVuY3Rpb24gd2Fybihmb3JtYXQpIHsKICAgIHsKICAgICAgewogICAgICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4gPiAxID8gX2xlbiAtIDEgOiAwKSwgX2tleSA9IDE7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHsKICAgICAgICAgIGFyZ3NbX2tleSAtIDFdID0gYXJndW1lbnRzW19rZXldOwogICAgICAgIH0KCiAgICAgICAgcHJpbnRXYXJuaW5nKCd3YXJuJywgZm9ybWF0LCBhcmdzKTsKICAgICAgfQogICAgfQogIH0KICBmdW5jdGlvbiBlcnJvcihmb3JtYXQpIHsKICAgIHsKICAgICAgewogICAgICAgIGZvciAodmFyIF9sZW4yID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuMiA+IDEgPyBfbGVuMiAtIDEgOiAwKSwgX2tleTIgPSAxOyBfa2V5MiA8IF9sZW4yOyBfa2V5MisrKSB7CiAgICAgICAgICBhcmdzW19rZXkyIC0gMV0gPSBhcmd1bWVudHNbX2tleTJdOwogICAgICAgIH0KCiAgICAgICAgcHJpbnRXYXJuaW5nKCdlcnJvcicsIGZvcm1hdCwgYXJncyk7CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIHByaW50V2FybmluZyhsZXZlbCwgZm9ybWF0LCBhcmdzKSB7CiAgICAvLyBXaGVuIGNoYW5naW5nIHRoaXMgbG9naWMsIHlvdSBtaWdodCB3YW50IHRvIGFsc28KICAgIC8vIHVwZGF0ZSBjb25zb2xlV2l0aFN0YWNrRGV2Lnd3dy5qcyBhcyB3ZWxsLgogICAgewogICAgICB2YXIgUmVhY3REZWJ1Z0N1cnJlbnRGcmFtZSA9IFJlYWN0U2hhcmVkSW50ZXJuYWxzLlJlYWN0RGVidWdDdXJyZW50RnJhbWU7CiAgICAgIHZhciBzdGFjayA9IFJlYWN0RGVidWdDdXJyZW50RnJhbWUuZ2V0U3RhY2tBZGRlbmR1bSgpOwoKICAgICAgaWYgKHN0YWNrICE9PSAnJykgewogICAgICAgIGZvcm1hdCArPSAnJXMnOwogICAgICAgIGFyZ3MgPSBhcmdzLmNvbmNhdChbc3RhY2tdKTsKICAgICAgfSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaW50ZXJuYWwvc2FmZS1zdHJpbmctY29lcmNpb24KCgogICAgICB2YXIgYXJnc1dpdGhGb3JtYXQgPSBhcmdzLm1hcChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIHJldHVybiBTdHJpbmcoaXRlbSk7CiAgICAgIH0pOyAvLyBDYXJlZnVsOiBSTiBjdXJyZW50bHkgZGVwZW5kcyBvbiB0aGlzIHByZWZpeAoKICAgICAgYXJnc1dpdGhGb3JtYXQudW5zaGlmdCgnV2FybmluZzogJyArIGZvcm1hdCk7IC8vIFdlIGludGVudGlvbmFsbHkgZG9uJ3QgdXNlIHNwcmVhZCAob3IgLmFwcGx5KSBkaXJlY3RseSBiZWNhdXNlIGl0CiAgICAgIC8vIGJyZWFrcyBJRTk6IGh0dHBzOi8vZ2l0aHViLmNvbS9mYWNlYm9vay9yZWFjdC9pc3N1ZXMvMTM2MTAKICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0LWludGVybmFsL25vLXByb2R1Y3Rpb24tbG9nZ2luZwoKICAgICAgRnVuY3Rpb24ucHJvdG90eXBlLmFwcGx5LmNhbGwoY29uc29sZVtsZXZlbF0sIGNvbnNvbGUsIGFyZ3NXaXRoRm9ybWF0KTsKICAgIH0KICB9CgogIHZhciBkaWRXYXJuU3RhdGVVcGRhdGVGb3JVbm1vdW50ZWRDb21wb25lbnQgPSB7fTsKCiAgZnVuY3Rpb24gd2Fybk5vb3AocHVibGljSW5zdGFuY2UsIGNhbGxlck5hbWUpIHsKICAgIHsKICAgICAgdmFyIF9jb25zdHJ1Y3RvciA9IHB1YmxpY0luc3RhbmNlLmNvbnN0cnVjdG9yOwogICAgICB2YXIgY29tcG9uZW50TmFtZSA9IF9jb25zdHJ1Y3RvciAmJiAoX2NvbnN0cnVjdG9yLmRpc3BsYXlOYW1lIHx8IF9jb25zdHJ1Y3Rvci5uYW1lKSB8fCAnUmVhY3RDbGFzcyc7CiAgICAgIHZhciB3YXJuaW5nS2V5ID0gY29tcG9uZW50TmFtZSArICIuIiArIGNhbGxlck5hbWU7CgogICAgICBpZiAoZGlkV2FyblN0YXRlVXBkYXRlRm9yVW5tb3VudGVkQ29tcG9uZW50W3dhcm5pbmdLZXldKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBlcnJvcigiQ2FuJ3QgY2FsbCAlcyBvbiBhIGNvbXBvbmVudCB0aGF0IGlzIG5vdCB5ZXQgbW91bnRlZC4gIiArICdUaGlzIGlzIGEgbm8tb3AsIGJ1dCBpdCBtaWdodCBpbmRpY2F0ZSBhIGJ1ZyBpbiB5b3VyIGFwcGxpY2F0aW9uLiAnICsgJ0luc3RlYWQsIGFzc2lnbiB0byBgdGhpcy5zdGF0ZWAgZGlyZWN0bHkgb3IgZGVmaW5lIGEgYHN0YXRlID0ge307YCAnICsgJ2NsYXNzIHByb3BlcnR5IHdpdGggdGhlIGRlc2lyZWQgc3RhdGUgaW4gdGhlICVzIGNvbXBvbmVudC4nLCBjYWxsZXJOYW1lLCBjb21wb25lbnROYW1lKTsKCiAgICAgIGRpZFdhcm5TdGF0ZVVwZGF0ZUZvclVubW91bnRlZENvbXBvbmVudFt3YXJuaW5nS2V5XSA9IHRydWU7CiAgICB9CiAgfQogIC8qKgogICAqIFRoaXMgaXMgdGhlIGFic3RyYWN0IEFQSSBmb3IgYW4gdXBkYXRlIHF1ZXVlLgogICAqLwoKCiAgdmFyIFJlYWN0Tm9vcFVwZGF0ZVF1ZXVlID0gewogICAgLyoqCiAgICAgKiBDaGVja3Mgd2hldGhlciBvciBub3QgdGhpcyBjb21wb3NpdGUgY29tcG9uZW50IGlzIG1vdW50ZWQuCiAgICAgKiBAcGFyYW0ge1JlYWN0Q2xhc3N9IHB1YmxpY0luc3RhbmNlIFRoZSBpbnN0YW5jZSB3ZSB3YW50IHRvIHRlc3QuCiAgICAgKiBAcmV0dXJuIHtib29sZWFufSBUcnVlIGlmIG1vdW50ZWQsIGZhbHNlIG90aGVyd2lzZS4KICAgICAqIEBwcm90ZWN0ZWQKICAgICAqIEBmaW5hbAogICAgICovCiAgICBpc01vdW50ZWQ6IGZ1bmN0aW9uIChwdWJsaWNJbnN0YW5jZSkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9LAoKICAgIC8qKgogICAgICogRm9yY2VzIGFuIHVwZGF0ZS4gVGhpcyBzaG91bGQgb25seSBiZSBpbnZva2VkIHdoZW4gaXQgaXMga25vd24gd2l0aAogICAgICogY2VydGFpbnR5IHRoYXQgd2UgYXJlICoqbm90KiogaW4gYSBET00gdHJhbnNhY3Rpb24uCiAgICAgKgogICAgICogWW91IG1heSB3YW50IHRvIGNhbGwgdGhpcyB3aGVuIHlvdSBrbm93IHRoYXQgc29tZSBkZWVwZXIgYXNwZWN0IG9mIHRoZQogICAgICogY29tcG9uZW50J3Mgc3RhdGUgaGFzIGNoYW5nZWQgYnV0IGBzZXRTdGF0ZWAgd2FzIG5vdCBjYWxsZWQuCiAgICAgKgogICAgICogVGhpcyB3aWxsIG5vdCBpbnZva2UgYHNob3VsZENvbXBvbmVudFVwZGF0ZWAsIGJ1dCBpdCB3aWxsIGludm9rZQogICAgICogYGNvbXBvbmVudFdpbGxVcGRhdGVgIGFuZCBgY29tcG9uZW50RGlkVXBkYXRlYC4KICAgICAqCiAgICAgKiBAcGFyYW0ge1JlYWN0Q2xhc3N9IHB1YmxpY0luc3RhbmNlIFRoZSBpbnN0YW5jZSB0aGF0IHNob3VsZCByZXJlbmRlci4KICAgICAqIEBwYXJhbSB7P2Z1bmN0aW9ufSBjYWxsYmFjayBDYWxsZWQgYWZ0ZXIgY29tcG9uZW50IGlzIHVwZGF0ZWQuCiAgICAgKiBAcGFyYW0gez9zdHJpbmd9IGNhbGxlck5hbWUgbmFtZSBvZiB0aGUgY2FsbGluZyBmdW5jdGlvbiBpbiB0aGUgcHVibGljIEFQSS4KICAgICAqIEBpbnRlcm5hbAogICAgICovCiAgICBlbnF1ZXVlRm9yY2VVcGRhdGU6IGZ1bmN0aW9uIChwdWJsaWNJbnN0YW5jZSwgY2FsbGJhY2ssIGNhbGxlck5hbWUpIHsKICAgICAgd2Fybk5vb3AocHVibGljSW5zdGFuY2UsICdmb3JjZVVwZGF0ZScpOwogICAgfSwKCiAgICAvKioKICAgICAqIFJlcGxhY2VzIGFsbCBvZiB0aGUgc3RhdGUuIEFsd2F5cyB1c2UgdGhpcyBvciBgc2V0U3RhdGVgIHRvIG11dGF0ZSBzdGF0ZS4KICAgICAqIFlvdSBzaG91bGQgdHJlYXQgYHRoaXMuc3RhdGVgIGFzIGltbXV0YWJsZS4KICAgICAqCiAgICAgKiBUaGVyZSBpcyBubyBndWFyYW50ZWUgdGhhdCBgdGhpcy5zdGF0ZWAgd2lsbCBiZSBpbW1lZGlhdGVseSB1cGRhdGVkLCBzbwogICAgICogYWNjZXNzaW5nIGB0aGlzLnN0YXRlYCBhZnRlciBjYWxsaW5nIHRoaXMgbWV0aG9kIG1heSByZXR1cm4gdGhlIG9sZCB2YWx1ZS4KICAgICAqCiAgICAgKiBAcGFyYW0ge1JlYWN0Q2xhc3N9IHB1YmxpY0luc3RhbmNlIFRoZSBpbnN0YW5jZSB0aGF0IHNob3VsZCByZXJlbmRlci4KICAgICAqIEBwYXJhbSB7b2JqZWN0fSBjb21wbGV0ZVN0YXRlIE5leHQgc3RhdGUuCiAgICAgKiBAcGFyYW0gez9mdW5jdGlvbn0gY2FsbGJhY2sgQ2FsbGVkIGFmdGVyIGNvbXBvbmVudCBpcyB1cGRhdGVkLgogICAgICogQHBhcmFtIHs/c3RyaW5nfSBjYWxsZXJOYW1lIG5hbWUgb2YgdGhlIGNhbGxpbmcgZnVuY3Rpb24gaW4gdGhlIHB1YmxpYyBBUEkuCiAgICAgKiBAaW50ZXJuYWwKICAgICAqLwogICAgZW5xdWV1ZVJlcGxhY2VTdGF0ZTogZnVuY3Rpb24gKHB1YmxpY0luc3RhbmNlLCBjb21wbGV0ZVN0YXRlLCBjYWxsYmFjaywgY2FsbGVyTmFtZSkgewogICAgICB3YXJuTm9vcChwdWJsaWNJbnN0YW5jZSwgJ3JlcGxhY2VTdGF0ZScpOwogICAgfSwKCiAgICAvKioKICAgICAqIFNldHMgYSBzdWJzZXQgb2YgdGhlIHN0YXRlLiBUaGlzIG9ubHkgZXhpc3RzIGJlY2F1c2UgX3BlbmRpbmdTdGF0ZSBpcwogICAgICogaW50ZXJuYWwuIFRoaXMgcHJvdmlkZXMgYSBtZXJnaW5nIHN0cmF0ZWd5IHRoYXQgaXMgbm90IGF2YWlsYWJsZSB0byBkZWVwCiAgICAgKiBwcm9wZXJ0aWVzIHdoaWNoIGlzIGNvbmZ1c2luZy4gVE9ETzogRXhwb3NlIHBlbmRpbmdTdGF0ZSBvciBkb24ndCB1c2UgaXQKICAgICAqIGR1cmluZyB0aGUgbWVyZ2UuCiAgICAgKgogICAgICogQHBhcmFtIHtSZWFjdENsYXNzfSBwdWJsaWNJbnN0YW5jZSBUaGUgaW5zdGFuY2UgdGhhdCBzaG91bGQgcmVyZW5kZXIuCiAgICAgKiBAcGFyYW0ge29iamVjdH0gcGFydGlhbFN0YXRlIE5leHQgcGFydGlhbCBzdGF0ZSB0byBiZSBtZXJnZWQgd2l0aCBzdGF0ZS4KICAgICAqIEBwYXJhbSB7P2Z1bmN0aW9ufSBjYWxsYmFjayBDYWxsZWQgYWZ0ZXIgY29tcG9uZW50IGlzIHVwZGF0ZWQuCiAgICAgKiBAcGFyYW0gez9zdHJpbmd9IE5hbWUgb2YgdGhlIGNhbGxpbmcgZnVuY3Rpb24gaW4gdGhlIHB1YmxpYyBBUEkuCiAgICAgKiBAaW50ZXJuYWwKICAgICAqLwogICAgZW5xdWV1ZVNldFN0YXRlOiBmdW5jdGlvbiAocHVibGljSW5zdGFuY2UsIHBhcnRpYWxTdGF0ZSwgY2FsbGJhY2ssIGNhbGxlck5hbWUpIHsKICAgICAgd2Fybk5vb3AocHVibGljSW5zdGFuY2UsICdzZXRTdGF0ZScpOwogICAgfQogIH07CgogIHZhciBhc3NpZ24gPSBPYmplY3QuYXNzaWduOwoKICB2YXIgZW1wdHlPYmplY3QgPSB7fTsKCiAgewogICAgT2JqZWN0LmZyZWV6ZShlbXB0eU9iamVjdCk7CiAgfQogIC8qKgogICAqIEJhc2UgY2xhc3MgaGVscGVycyBmb3IgdGhlIHVwZGF0aW5nIHN0YXRlIG9mIGEgY29tcG9uZW50LgogICAqLwoKCiAgZnVuY3Rpb24gQ29tcG9uZW50KHByb3BzLCBjb250ZXh0LCB1cGRhdGVyKSB7CiAgICB0aGlzLnByb3BzID0gcHJvcHM7CiAgICB0aGlzLmNvbnRleHQgPSBjb250ZXh0OyAvLyBJZiBhIGNvbXBvbmVudCBoYXMgc3RyaW5nIHJlZnMsIHdlIHdpbGwgYXNzaWduIGEgZGlmZmVyZW50IG9iamVjdCBsYXRlci4KCiAgICB0aGlzLnJlZnMgPSBlbXB0eU9iamVjdDsgLy8gV2UgaW5pdGlhbGl6ZSB0aGUgZGVmYXVsdCB1cGRhdGVyIGJ1dCB0aGUgcmVhbCBvbmUgZ2V0cyBpbmplY3RlZCBieSB0aGUKICAgIC8vIHJlbmRlcmVyLgoKICAgIHRoaXMudXBkYXRlciA9IHVwZGF0ZXIgfHwgUmVhY3ROb29wVXBkYXRlUXVldWU7CiAgfQoKICBDb21wb25lbnQucHJvdG90eXBlLmlzUmVhY3RDb21wb25lbnQgPSB7fTsKICAvKioKICAgKiBTZXRzIGEgc3Vic2V0IG9mIHRoZSBzdGF0ZS4gQWx3YXlzIHVzZSB0aGlzIHRvIG11dGF0ZQogICAqIHN0YXRlLiBZb3Ugc2hvdWxkIHRyZWF0IGB0aGlzLnN0YXRlYCBhcyBpbW11dGFibGUuCiAgICoKICAgKiBUaGVyZSBpcyBubyBndWFyYW50ZWUgdGhhdCBgdGhpcy5zdGF0ZWAgd2lsbCBiZSBpbW1lZGlhdGVseSB1cGRhdGVkLCBzbwogICAqIGFjY2Vzc2luZyBgdGhpcy5zdGF0ZWAgYWZ0ZXIgY2FsbGluZyB0aGlzIG1ldGhvZCBtYXkgcmV0dXJuIHRoZSBvbGQgdmFsdWUuCiAgICoKICAgKiBUaGVyZSBpcyBubyBndWFyYW50ZWUgdGhhdCBjYWxscyB0byBgc2V0U3RhdGVgIHdpbGwgcnVuIHN5bmNocm9ub3VzbHksCiAgICogYXMgdGhleSBtYXkgZXZlbnR1YWxseSBiZSBiYXRjaGVkIHRvZ2V0aGVyLiAgWW91IGNhbiBwcm92aWRlIGFuIG9wdGlvbmFsCiAgICogY2FsbGJhY2sgdGhhdCB3aWxsIGJlIGV4ZWN1dGVkIHdoZW4gdGhlIGNhbGwgdG8gc2V0U3RhdGUgaXMgYWN0dWFsbHkKICAgKiBjb21wbGV0ZWQuCiAgICoKICAgKiBXaGVuIGEgZnVuY3Rpb24gaXMgcHJvdmlkZWQgdG8gc2V0U3RhdGUsIGl0IHdpbGwgYmUgY2FsbGVkIGF0IHNvbWUgcG9pbnQgaW4KICAgKiB0aGUgZnV0dXJlIChub3Qgc3luY2hyb25vdXNseSkuIEl0IHdpbGwgYmUgY2FsbGVkIHdpdGggdGhlIHVwIHRvIGRhdGUKICAgKiBjb21wb25lbnQgYXJndW1lbnRzIChzdGF0ZSwgcHJvcHMsIGNvbnRleHQpLiBUaGVzZSB2YWx1ZXMgY2FuIGJlIGRpZmZlcmVudAogICAqIGZyb20gdGhpcy4qIGJlY2F1c2UgeW91ciBmdW5jdGlvbiBtYXkgYmUgY2FsbGVkIGFmdGVyIHJlY2VpdmVQcm9wcyBidXQgYmVmb3JlCiAgICogc2hvdWxkQ29tcG9uZW50VXBkYXRlLCBhbmQgdGhpcyBuZXcgc3RhdGUsIHByb3BzLCBhbmQgY29udGV4dCB3aWxsIG5vdCB5ZXQgYmUKICAgKiBhc3NpZ25lZCB0byB0aGlzLgogICAqCiAgICogQHBhcmFtIHtvYmplY3R8ZnVuY3Rpb259IHBhcnRpYWxTdGF0ZSBOZXh0IHBhcnRpYWwgc3RhdGUgb3IgZnVuY3Rpb24gdG8KICAgKiAgICAgICAgcHJvZHVjZSBuZXh0IHBhcnRpYWwgc3RhdGUgdG8gYmUgbWVyZ2VkIHdpdGggY3VycmVudCBzdGF0ZS4KICAgKiBAcGFyYW0gez9mdW5jdGlvbn0gY2FsbGJhY2sgQ2FsbGVkIGFmdGVyIHN0YXRlIGlzIHVwZGF0ZWQuCiAgICogQGZpbmFsCiAgICogQHByb3RlY3RlZAogICAqLwoKICBDb21wb25lbnQucHJvdG90eXBlLnNldFN0YXRlID0gZnVuY3Rpb24gKHBhcnRpYWxTdGF0ZSwgY2FsbGJhY2spIHsKICAgIGlmICh0eXBlb2YgcGFydGlhbFN0YXRlICE9PSAnb2JqZWN0JyAmJiB0eXBlb2YgcGFydGlhbFN0YXRlICE9PSAnZnVuY3Rpb24nICYmIHBhcnRpYWxTdGF0ZSAhPSBudWxsKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignc2V0U3RhdGUoLi4uKTogdGFrZXMgYW4gb2JqZWN0IG9mIHN0YXRlIHZhcmlhYmxlcyB0byB1cGRhdGUgb3IgYSAnICsgJ2Z1bmN0aW9uIHdoaWNoIHJldHVybnMgYW4gb2JqZWN0IG9mIHN0YXRlIHZhcmlhYmxlcy4nKTsKICAgIH0KCiAgICB0aGlzLnVwZGF0ZXIuZW5xdWV1ZVNldFN0YXRlKHRoaXMsIHBhcnRpYWxTdGF0ZSwgY2FsbGJhY2ssICdzZXRTdGF0ZScpOwogIH07CiAgLyoqCiAgICogRm9yY2VzIGFuIHVwZGF0ZS4gVGhpcyBzaG91bGQgb25seSBiZSBpbnZva2VkIHdoZW4gaXQgaXMga25vd24gd2l0aAogICAqIGNlcnRhaW50eSB0aGF0IHdlIGFyZSAqKm5vdCoqIGluIGEgRE9NIHRyYW5zYWN0aW9uLgogICAqCiAgICogWW91IG1heSB3YW50IHRvIGNhbGwgdGhpcyB3aGVuIHlvdSBrbm93IHRoYXQgc29tZSBkZWVwZXIgYXNwZWN0IG9mIHRoZQogICAqIGNvbXBvbmVudCdzIHN0YXRlIGhhcyBjaGFuZ2VkIGJ1dCBgc2V0U3RhdGVgIHdhcyBub3QgY2FsbGVkLgogICAqCiAgICogVGhpcyB3aWxsIG5vdCBpbnZva2UgYHNob3VsZENvbXBvbmVudFVwZGF0ZWAsIGJ1dCBpdCB3aWxsIGludm9rZQogICAqIGBjb21wb25lbnRXaWxsVXBkYXRlYCBhbmQgYGNvbXBvbmVudERpZFVwZGF0ZWAuCiAgICoKICAgKiBAcGFyYW0gez9mdW5jdGlvbn0gY2FsbGJhY2sgQ2FsbGVkIGFmdGVyIHVwZGF0ZSBpcyBjb21wbGV0ZS4KICAgKiBAZmluYWwKICAgKiBAcHJvdGVjdGVkCiAgICovCgoKICBDb21wb25lbnQucHJvdG90eXBlLmZvcmNlVXBkYXRlID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7CiAgICB0aGlzLnVwZGF0ZXIuZW5xdWV1ZUZvcmNlVXBkYXRlKHRoaXMsIGNhbGxiYWNrLCAnZm9yY2VVcGRhdGUnKTsKICB9OwogIC8qKgogICAqIERlcHJlY2F0ZWQgQVBJcy4gVGhlc2UgQVBJcyB1c2VkIHRvIGV4aXN0IG9uIGNsYXNzaWMgUmVhY3QgY2xhc3NlcyBidXQgc2luY2UKICAgKiB3ZSB3b3VsZCBsaWtlIHRvIGRlcHJlY2F0ZSB0aGVtLCB3ZSdyZSBub3QgZ29pbmcgdG8gbW92ZSB0aGVtIG92ZXIgdG8gdGhpcwogICAqIG1vZGVybiBiYXNlIGNsYXNzLiBJbnN0ZWFkLCB3ZSBkZWZpbmUgYSBnZXR0ZXIgdGhhdCB3YXJucyBpZiBpdCdzIGFjY2Vzc2VkLgogICAqLwoKCiAgewogICAgdmFyIGRlcHJlY2F0ZWRBUElzID0gewogICAgICBpc01vdW50ZWQ6IFsnaXNNb3VudGVkJywgJ0luc3RlYWQsIG1ha2Ugc3VyZSB0byBjbGVhbiB1cCBzdWJzY3JpcHRpb25zIGFuZCBwZW5kaW5nIHJlcXVlc3RzIGluICcgKyAnY29tcG9uZW50V2lsbFVubW91bnQgdG8gcHJldmVudCBtZW1vcnkgbGVha3MuJ10sCiAgICAgIHJlcGxhY2VTdGF0ZTogWydyZXBsYWNlU3RhdGUnLCAnUmVmYWN0b3IgeW91ciBjb2RlIHRvIHVzZSBzZXRTdGF0ZSBpbnN0ZWFkIChzZWUgJyArICdodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2svcmVhY3QvaXNzdWVzLzMyMzYpLiddCiAgICB9OwoKICAgIHZhciBkZWZpbmVEZXByZWNhdGlvbldhcm5pbmcgPSBmdW5jdGlvbiAobWV0aG9kTmFtZSwgaW5mbykgewogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ29tcG9uZW50LnByb3RvdHlwZSwgbWV0aG9kTmFtZSwgewogICAgICAgIGdldDogZnVuY3Rpb24gKCkgewogICAgICAgICAgd2FybignJXMoLi4uKSBpcyBkZXByZWNhdGVkIGluIHBsYWluIEphdmFTY3JpcHQgUmVhY3QgY2xhc3Nlcy4gJXMnLCBpbmZvWzBdLCBpbmZvWzFdKTsKCiAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9OwoKICAgIGZvciAodmFyIGZuTmFtZSBpbiBkZXByZWNhdGVkQVBJcykgewogICAgICBpZiAoZGVwcmVjYXRlZEFQSXMuaGFzT3duUHJvcGVydHkoZm5OYW1lKSkgewogICAgICAgIGRlZmluZURlcHJlY2F0aW9uV2FybmluZyhmbk5hbWUsIGRlcHJlY2F0ZWRBUElzW2ZuTmFtZV0pOwogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiBDb21wb25lbnREdW1teSgpIHt9CgogIENvbXBvbmVudER1bW15LnByb3RvdHlwZSA9IENvbXBvbmVudC5wcm90b3R5cGU7CiAgLyoqCiAgICogQ29udmVuaWVuY2UgY29tcG9uZW50IHdpdGggZGVmYXVsdCBzaGFsbG93IGVxdWFsaXR5IGNoZWNrIGZvciBzQ1UuCiAgICovCgogIGZ1bmN0aW9uIFB1cmVDb21wb25lbnQocHJvcHMsIGNvbnRleHQsIHVwZGF0ZXIpIHsKICAgIHRoaXMucHJvcHMgPSBwcm9wczsKICAgIHRoaXMuY29udGV4dCA9IGNvbnRleHQ7IC8vIElmIGEgY29tcG9uZW50IGhhcyBzdHJpbmcgcmVmcywgd2Ugd2lsbCBhc3NpZ24gYSBkaWZmZXJlbnQgb2JqZWN0IGxhdGVyLgoKICAgIHRoaXMucmVmcyA9IGVtcHR5T2JqZWN0OwogICAgdGhpcy51cGRhdGVyID0gdXBkYXRlciB8fCBSZWFjdE5vb3BVcGRhdGVRdWV1ZTsKICB9CgogIHZhciBwdXJlQ29tcG9uZW50UHJvdG90eXBlID0gUHVyZUNvbXBvbmVudC5wcm90b3R5cGUgPSBuZXcgQ29tcG9uZW50RHVtbXkoKTsKICBwdXJlQ29tcG9uZW50UHJvdG90eXBlLmNvbnN0cnVjdG9yID0gUHVyZUNvbXBvbmVudDsgLy8gQXZvaWQgYW4gZXh0cmEgcHJvdG90eXBlIGp1bXAgZm9yIHRoZXNlIG1ldGhvZHMuCgogIGFzc2lnbihwdXJlQ29tcG9uZW50UHJvdG90eXBlLCBDb21wb25lbnQucHJvdG90eXBlKTsKICBwdXJlQ29tcG9uZW50UHJvdG90eXBlLmlzUHVyZVJlYWN0Q29tcG9uZW50ID0gdHJ1ZTsKCiAgLy8gYW4gaW1tdXRhYmxlIG9iamVjdCB3aXRoIGEgc2luZ2xlIG11dGFibGUgdmFsdWUKICBmdW5jdGlvbiBjcmVhdGVSZWYoKSB7CiAgICB2YXIgcmVmT2JqZWN0ID0gewogICAgICBjdXJyZW50OiBudWxsCiAgICB9OwoKICAgIHsKICAgICAgT2JqZWN0LnNlYWwocmVmT2JqZWN0KTsKICAgIH0KCiAgICByZXR1cm4gcmVmT2JqZWN0OwogIH0KCiAgdmFyIGlzQXJyYXlJbXBsID0gQXJyYXkuaXNBcnJheTsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXJlZGVjbGFyZQoKICBmdW5jdGlvbiBpc0FycmF5KGEpIHsKICAgIHJldHVybiBpc0FycmF5SW1wbChhKTsKICB9CgogIC8qCiAgICogVGhlIGAnJyArIHZhbHVlYCBwYXR0ZXJuICh1c2VkIGluIGluIHBlcmYtc2Vuc2l0aXZlIGNvZGUpIHRocm93cyBmb3IgU3ltYm9sCiAgICogYW5kIFRlbXBvcmFsLiogdHlwZXMuIFNlZSBodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2svcmVhY3QvcHVsbC8yMjA2NC4KICAgKgogICAqIFRoZSBmdW5jdGlvbnMgaW4gdGhpcyBtb2R1bGUgd2lsbCB0aHJvdyBhbiBlYXNpZXItdG8tdW5kZXJzdGFuZCwKICAgKiBlYXNpZXItdG8tZGVidWcgZXhjZXB0aW9uIHdpdGggYSBjbGVhciBlcnJvcnMgbWVzc2FnZSBtZXNzYWdlIGV4cGxhaW5pbmcgdGhlCiAgICogcHJvYmxlbS4gKEluc3RlYWQgb2YgYSBjb25mdXNpbmcgZXhjZXB0aW9uIHRocm93biBpbnNpZGUgdGhlIGltcGxlbWVudGF0aW9uCiAgICogb2YgdGhlIGB2YWx1ZWAgb2JqZWN0KS4KICAgKi8KICAvLyAkRmxvd0ZpeE1lIG9ubHkgY2FsbGVkIGluIERFViwgc28gdm9pZCByZXR1cm4gaXMgbm90IHBvc3NpYmxlLgogIGZ1bmN0aW9uIHR5cGVOYW1lKHZhbHVlKSB7CiAgICB7CiAgICAgIC8vIHRvU3RyaW5nVGFnIGlzIG5lZWRlZCBmb3IgbmFtZXNwYWNlZCB0eXBlcyBsaWtlIFRlbXBvcmFsLkluc3RhbnQKICAgICAgdmFyIGhhc1RvU3RyaW5nVGFnID0gdHlwZW9mIFN5bWJvbCA9PT0gJ2Z1bmN0aW9uJyAmJiBTeW1ib2wudG9TdHJpbmdUYWc7CiAgICAgIHZhciB0eXBlID0gaGFzVG9TdHJpbmdUYWcgJiYgdmFsdWVbU3ltYm9sLnRvU3RyaW5nVGFnXSB8fCB2YWx1ZS5jb25zdHJ1Y3Rvci5uYW1lIHx8ICdPYmplY3QnOwogICAgICByZXR1cm4gdHlwZTsKICAgIH0KICB9IC8vICRGbG93Rml4TWUgb25seSBjYWxsZWQgaW4gREVWLCBzbyB2b2lkIHJldHVybiBpcyBub3QgcG9zc2libGUuCgoKICBmdW5jdGlvbiB3aWxsQ29lcmNpb25UaHJvdyh2YWx1ZSkgewogICAgewogICAgICB0cnkgewogICAgICAgIHRlc3RTdHJpbmdDb2VyY2lvbih2YWx1ZSk7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIHRlc3RTdHJpbmdDb2VyY2lvbih2YWx1ZSkgewogICAgLy8gSWYgeW91IGVuZGVkIHVwIGhlcmUgYnkgZm9sbG93aW5nIGFuIGV4Y2VwdGlvbiBjYWxsIHN0YWNrLCBoZXJlJ3Mgd2hhdCdzCiAgICAvLyBoYXBwZW5lZDogeW91IHN1cHBsaWVkIGFuIG9iamVjdCBvciBzeW1ib2wgdmFsdWUgdG8gUmVhY3QgKGFzIGEgcHJvcCwga2V5LAogICAgLy8gRE9NIGF0dHJpYnV0ZSwgQ1NTIHByb3BlcnR5LCBzdHJpbmcgcmVmLCBldGMuKSBhbmQgd2hlbiBSZWFjdCB0cmllZCB0bwogICAgLy8gY29lcmNlIGl0IHRvIGEgc3RyaW5nIHVzaW5nIGAnJyArIHZhbHVlYCwgYW4gZXhjZXB0aW9uIHdhcyB0aHJvd24uCiAgICAvLwogICAgLy8gVGhlIG1vc3QgY29tbW9uIHR5cGVzIHRoYXQgd2lsbCBjYXVzZSB0aGlzIGV4Y2VwdGlvbiBhcmUgYFN5bWJvbGAgaW5zdGFuY2VzCiAgICAvLyBhbmQgVGVtcG9yYWwgb2JqZWN0cyBsaWtlIGBUZW1wb3JhbC5JbnN0YW50YC4gQnV0IGFueSBvYmplY3QgdGhhdCBoYXMgYQogICAgLy8gYHZhbHVlT2ZgIG9yIGBbU3ltYm9sLnRvUHJpbWl0aXZlXWAgbWV0aG9kIHRoYXQgdGhyb3dzIHdpbGwgYWxzbyBjYXVzZSB0aGlzCiAgICAvLyBleGNlcHRpb24uIChMaWJyYXJ5IGF1dGhvcnMgZG8gdGhpcyB0byBwcmV2ZW50IHVzZXJzIGZyb20gdXNpbmcgYnVpbHQtaW4KICAgIC8vIG51bWVyaWMgb3BlcmF0b3JzIGxpa2UgYCtgIG9yIGNvbXBhcmlzb24gb3BlcmF0b3JzIGxpa2UgYD49YCBiZWNhdXNlIGN1c3RvbQogICAgLy8gbWV0aG9kcyBhcmUgbmVlZGVkIHRvIHBlcmZvcm0gYWNjdXJhdGUgYXJpdGhtZXRpYyBvciBjb21wYXJpc29uLikKICAgIC8vCiAgICAvLyBUbyBmaXggdGhlIHByb2JsZW0sIGNvZXJjZSB0aGlzIG9iamVjdCBvciBzeW1ib2wgdmFsdWUgdG8gYSBzdHJpbmcgYmVmb3JlCiAgICAvLyBwYXNzaW5nIGl0IHRvIFJlYWN0LiBUaGUgbW9zdCByZWxpYWJsZSB3YXkgaXMgdXN1YWxseSBgU3RyaW5nKHZhbHVlKWAuCiAgICAvLwogICAgLy8gVG8gZmluZCB3aGljaCB2YWx1ZSBpcyB0aHJvd2luZywgY2hlY2sgdGhlIGJyb3dzZXIgb3IgZGVidWdnZXIgY29uc29sZS4KICAgIC8vIEJlZm9yZSB0aGlzIGV4Y2VwdGlvbiB3YXMgdGhyb3duLCB0aGVyZSBzaG91bGQgYmUgYGNvbnNvbGUuZXJyb3JgIG91dHB1dAogICAgLy8gdGhhdCBzaG93cyB0aGUgdHlwZSAoU3ltYm9sLCBUZW1wb3JhbC5QbGFpbkRhdGUsIGV0Yy4pIHRoYXQgY2F1c2VkIHRoZQogICAgLy8gcHJvYmxlbSBhbmQgaG93IHRoYXQgdHlwZSB3YXMgdXNlZDoga2V5LCBhdHJyaWJ1dGUsIGlucHV0IHZhbHVlIHByb3AsIGV0Yy4KICAgIC8vIEluIG1vc3QgY2FzZXMsIHRoaXMgY29uc29sZSBvdXRwdXQgYWxzbyBzaG93cyB0aGUgY29tcG9uZW50IGFuZCBpdHMKICAgIC8vIGFuY2VzdG9yIGNvbXBvbmVudHMgd2hlcmUgdGhlIGV4Y2VwdGlvbiBoYXBwZW5lZC4KICAgIC8vCiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaW50ZXJuYWwvc2FmZS1zdHJpbmctY29lcmNpb24KICAgIHJldHVybiAnJyArIHZhbHVlOwogIH0KICBmdW5jdGlvbiBjaGVja0tleVN0cmluZ0NvZXJjaW9uKHZhbHVlKSB7CiAgICB7CiAgICAgIGlmICh3aWxsQ29lcmNpb25UaHJvdyh2YWx1ZSkpIHsKICAgICAgICBlcnJvcignVGhlIHByb3ZpZGVkIGtleSBpcyBhbiB1bnN1cHBvcnRlZCB0eXBlICVzLicgKyAnIFRoaXMgdmFsdWUgbXVzdCBiZSBjb2VyY2VkIHRvIGEgc3RyaW5nIGJlZm9yZSBiZWZvcmUgdXNpbmcgaXQgaGVyZS4nLCB0eXBlTmFtZSh2YWx1ZSkpOwoKICAgICAgICByZXR1cm4gdGVzdFN0cmluZ0NvZXJjaW9uKHZhbHVlKTsgLy8gdGhyb3cgKHRvIGhlbHAgY2FsbGVycyBmaW5kIHRyb3VibGVzaG9vdGluZyBjb21tZW50cykKICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gZ2V0V3JhcHBlZE5hbWUob3V0ZXJUeXBlLCBpbm5lclR5cGUsIHdyYXBwZXJOYW1lKSB7CiAgICB2YXIgZGlzcGxheU5hbWUgPSBvdXRlclR5cGUuZGlzcGxheU5hbWU7CgogICAgaWYgKGRpc3BsYXlOYW1lKSB7CiAgICAgIHJldHVybiBkaXNwbGF5TmFtZTsKICAgIH0KCiAgICB2YXIgZnVuY3Rpb25OYW1lID0gaW5uZXJUeXBlLmRpc3BsYXlOYW1lIHx8IGlubmVyVHlwZS5uYW1lIHx8ICcnOwogICAgcmV0dXJuIGZ1bmN0aW9uTmFtZSAhPT0gJycgPyB3cmFwcGVyTmFtZSArICIoIiArIGZ1bmN0aW9uTmFtZSArICIpIiA6IHdyYXBwZXJOYW1lOwogIH0gLy8gS2VlcCBpbiBzeW5jIHdpdGggcmVhY3QtcmVjb25jaWxlci9nZXRDb21wb25lbnROYW1lRnJvbUZpYmVyCgoKICBmdW5jdGlvbiBnZXRDb250ZXh0TmFtZSh0eXBlKSB7CiAgICByZXR1cm4gdHlwZS5kaXNwbGF5TmFtZSB8fCAnQ29udGV4dCc7CiAgfSAvLyBOb3RlIHRoYXQgdGhlIHJlY29uY2lsZXIgcGFja2FnZSBzaG91bGQgZ2VuZXJhbGx5IHByZWZlciB0byB1c2UgZ2V0Q29tcG9uZW50TmFtZUZyb21GaWJlcigpIGluc3RlYWQuCgoKICBmdW5jdGlvbiBnZXRDb21wb25lbnROYW1lRnJvbVR5cGUodHlwZSkgewogICAgaWYgKHR5cGUgPT0gbnVsbCkgewogICAgICAvLyBIb3N0IHJvb3QsIHRleHQgbm9kZSBvciBqdXN0IGludmFsaWQgdHlwZS4KICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgewogICAgICBpZiAodHlwZW9mIHR5cGUudGFnID09PSAnbnVtYmVyJykgewogICAgICAgIGVycm9yKCdSZWNlaXZlZCBhbiB1bmV4cGVjdGVkIG9iamVjdCBpbiBnZXRDb21wb25lbnROYW1lRnJvbVR5cGUoKS4gJyArICdUaGlzIGlzIGxpa2VseSBhIGJ1ZyBpbiBSZWFjdC4gUGxlYXNlIGZpbGUgYW4gaXNzdWUuJyk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAodHlwZW9mIHR5cGUgPT09ICdmdW5jdGlvbicpIHsKICAgICAgcmV0dXJuIHR5cGUuZGlzcGxheU5hbWUgfHwgdHlwZS5uYW1lIHx8IG51bGw7CiAgICB9CgogICAgaWYgKHR5cGVvZiB0eXBlID09PSAnc3RyaW5nJykgewogICAgICByZXR1cm4gdHlwZTsKICAgIH0KCiAgICBzd2l0Y2ggKHR5cGUpIHsKICAgICAgY2FzZSBSRUFDVF9GUkFHTUVOVF9UWVBFOgogICAgICAgIHJldHVybiAnRnJhZ21lbnQnOwoKICAgICAgY2FzZSBSRUFDVF9QT1JUQUxfVFlQRToKICAgICAgICByZXR1cm4gJ1BvcnRhbCc7CgogICAgICBjYXNlIFJFQUNUX1BST0ZJTEVSX1RZUEU6CiAgICAgICAgcmV0dXJuICdQcm9maWxlcic7CgogICAgICBjYXNlIFJFQUNUX1NUUklDVF9NT0RFX1RZUEU6CiAgICAgICAgcmV0dXJuICdTdHJpY3RNb2RlJzsKCiAgICAgIGNhc2UgUkVBQ1RfU1VTUEVOU0VfVFlQRToKICAgICAgICByZXR1cm4gJ1N1c3BlbnNlJzsKCiAgICAgIGNhc2UgUkVBQ1RfU1VTUEVOU0VfTElTVF9UWVBFOgogICAgICAgIHJldHVybiAnU3VzcGVuc2VMaXN0JzsKCiAgICB9CgogICAgaWYgKHR5cGVvZiB0eXBlID09PSAnb2JqZWN0JykgewogICAgICBzd2l0Y2ggKHR5cGUuJCR0eXBlb2YpIHsKICAgICAgICBjYXNlIFJFQUNUX0NPTlRFWFRfVFlQRToKICAgICAgICAgIHZhciBjb250ZXh0ID0gdHlwZTsKICAgICAgICAgIHJldHVybiBnZXRDb250ZXh0TmFtZShjb250ZXh0KSArICcuQ29uc3VtZXInOwoKICAgICAgICBjYXNlIFJFQUNUX1BST1ZJREVSX1RZUEU6CiAgICAgICAgICB2YXIgcHJvdmlkZXIgPSB0eXBlOwogICAgICAgICAgcmV0dXJuIGdldENvbnRleHROYW1lKHByb3ZpZGVyLl9jb250ZXh0KSArICcuUHJvdmlkZXInOwoKICAgICAgICBjYXNlIFJFQUNUX0ZPUldBUkRfUkVGX1RZUEU6CiAgICAgICAgICByZXR1cm4gZ2V0V3JhcHBlZE5hbWUodHlwZSwgdHlwZS5yZW5kZXIsICdGb3J3YXJkUmVmJyk7CgogICAgICAgIGNhc2UgUkVBQ1RfTUVNT19UWVBFOgogICAgICAgICAgdmFyIG91dGVyTmFtZSA9IHR5cGUuZGlzcGxheU5hbWUgfHwgbnVsbDsKCiAgICAgICAgICBpZiAob3V0ZXJOYW1lICE9PSBudWxsKSB7CiAgICAgICAgICAgIHJldHVybiBvdXRlck5hbWU7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIGdldENvbXBvbmVudE5hbWVGcm9tVHlwZSh0eXBlLnR5cGUpIHx8ICdNZW1vJzsKCiAgICAgICAgY2FzZSBSRUFDVF9MQVpZX1RZUEU6CiAgICAgICAgICB7CiAgICAgICAgICAgIHZhciBsYXp5Q29tcG9uZW50ID0gdHlwZTsKICAgICAgICAgICAgdmFyIHBheWxvYWQgPSBsYXp5Q29tcG9uZW50Ll9wYXlsb2FkOwogICAgICAgICAgICB2YXIgaW5pdCA9IGxhenlDb21wb25lbnQuX2luaXQ7CgogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIHJldHVybiBnZXRDb21wb25lbnROYW1lRnJvbVR5cGUoaW5pdChwYXlsb2FkKSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKHgpIHsKICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tZmFsbHRocm91Z2gKICAgICAgfQogICAgfQoKICAgIHJldHVybiBudWxsOwogIH0KCiAgdmFyIGhhc093blByb3BlcnR5ID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTsKCiAgdmFyIFJFU0VSVkVEX1BST1BTID0gewogICAga2V5OiB0cnVlLAogICAgcmVmOiB0cnVlLAogICAgX19zZWxmOiB0cnVlLAogICAgX19zb3VyY2U6IHRydWUKICB9OwogIHZhciBzcGVjaWFsUHJvcEtleVdhcm5pbmdTaG93biwgc3BlY2lhbFByb3BSZWZXYXJuaW5nU2hvd24sIGRpZFdhcm5BYm91dFN0cmluZ1JlZnM7CgogIHsKICAgIGRpZFdhcm5BYm91dFN0cmluZ1JlZnMgPSB7fTsKICB9CgogIGZ1bmN0aW9uIGhhc1ZhbGlkUmVmKGNvbmZpZykgewogICAgewogICAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbChjb25maWcsICdyZWYnKSkgewogICAgICAgIHZhciBnZXR0ZXIgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGNvbmZpZywgJ3JlZicpLmdldDsKCiAgICAgICAgaWYgKGdldHRlciAmJiBnZXR0ZXIuaXNSZWFjdFdhcm5pbmcpIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gY29uZmlnLnJlZiAhPT0gdW5kZWZpbmVkOwogIH0KCiAgZnVuY3Rpb24gaGFzVmFsaWRLZXkoY29uZmlnKSB7CiAgICB7CiAgICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKGNvbmZpZywgJ2tleScpKSB7CiAgICAgICAgdmFyIGdldHRlciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoY29uZmlnLCAna2V5JykuZ2V0OwoKICAgICAgICBpZiAoZ2V0dGVyICYmIGdldHRlci5pc1JlYWN0V2FybmluZykgewogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHJldHVybiBjb25maWcua2V5ICE9PSB1bmRlZmluZWQ7CiAgfQoKICBmdW5jdGlvbiBkZWZpbmVLZXlQcm9wV2FybmluZ0dldHRlcihwcm9wcywgZGlzcGxheU5hbWUpIHsKICAgIHZhciB3YXJuQWJvdXRBY2Nlc3NpbmdLZXkgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHsKICAgICAgICBpZiAoIXNwZWNpYWxQcm9wS2V5V2FybmluZ1Nob3duKSB7CiAgICAgICAgICBzcGVjaWFsUHJvcEtleVdhcm5pbmdTaG93biA9IHRydWU7CgogICAgICAgICAgZXJyb3IoJyVzOiBga2V5YCBpcyBub3QgYSBwcm9wLiBUcnlpbmcgdG8gYWNjZXNzIGl0IHdpbGwgcmVzdWx0ICcgKyAnaW4gYHVuZGVmaW5lZGAgYmVpbmcgcmV0dXJuZWQuIElmIHlvdSBuZWVkIHRvIGFjY2VzcyB0aGUgc2FtZSAnICsgJ3ZhbHVlIHdpdGhpbiB0aGUgY2hpbGQgY29tcG9uZW50LCB5b3Ugc2hvdWxkIHBhc3MgaXQgYXMgYSBkaWZmZXJlbnQgJyArICdwcm9wLiAoaHR0cHM6Ly9yZWFjdGpzLm9yZy9saW5rL3NwZWNpYWwtcHJvcHMpJywgZGlzcGxheU5hbWUpOwogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICB3YXJuQWJvdXRBY2Nlc3NpbmdLZXkuaXNSZWFjdFdhcm5pbmcgPSB0cnVlOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHByb3BzLCAna2V5JywgewogICAgICBnZXQ6IHdhcm5BYm91dEFjY2Vzc2luZ0tleSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlCiAgICB9KTsKICB9CgogIGZ1bmN0aW9uIGRlZmluZVJlZlByb3BXYXJuaW5nR2V0dGVyKHByb3BzLCBkaXNwbGF5TmFtZSkgewogICAgdmFyIHdhcm5BYm91dEFjY2Vzc2luZ1JlZiA9IGZ1bmN0aW9uICgpIHsKICAgICAgewogICAgICAgIGlmICghc3BlY2lhbFByb3BSZWZXYXJuaW5nU2hvd24pIHsKICAgICAgICAgIHNwZWNpYWxQcm9wUmVmV2FybmluZ1Nob3duID0gdHJ1ZTsKCiAgICAgICAgICBlcnJvcignJXM6IGByZWZgIGlzIG5vdCBhIHByb3AuIFRyeWluZyB0byBhY2Nlc3MgaXQgd2lsbCByZXN1bHQgJyArICdpbiBgdW5kZWZpbmVkYCBiZWluZyByZXR1cm5lZC4gSWYgeW91IG5lZWQgdG8gYWNjZXNzIHRoZSBzYW1lICcgKyAndmFsdWUgd2l0aGluIHRoZSBjaGlsZCBjb21wb25lbnQsIHlvdSBzaG91bGQgcGFzcyBpdCBhcyBhIGRpZmZlcmVudCAnICsgJ3Byb3AuIChodHRwczovL3JlYWN0anMub3JnL2xpbmsvc3BlY2lhbC1wcm9wcyknLCBkaXNwbGF5TmFtZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIHdhcm5BYm91dEFjY2Vzc2luZ1JlZi5pc1JlYWN0V2FybmluZyA9IHRydWU7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocHJvcHMsICdyZWYnLCB7CiAgICAgIGdldDogd2FybkFib3V0QWNjZXNzaW5nUmVmLAogICAgICBjb25maWd1cmFibGU6IHRydWUKICAgIH0pOwogIH0KCiAgZnVuY3Rpb24gd2FybklmU3RyaW5nUmVmQ2Fubm90QmVBdXRvQ29udmVydGVkKGNvbmZpZykgewogICAgewogICAgICBpZiAodHlwZW9mIGNvbmZpZy5yZWYgPT09ICdzdHJpbmcnICYmIFJlYWN0Q3VycmVudE93bmVyLmN1cnJlbnQgJiYgY29uZmlnLl9fc2VsZiAmJiBSZWFjdEN1cnJlbnRPd25lci5jdXJyZW50LnN0YXRlTm9kZSAhPT0gY29uZmlnLl9fc2VsZikgewogICAgICAgIHZhciBjb21wb25lbnROYW1lID0gZ2V0Q29tcG9uZW50TmFtZUZyb21UeXBlKFJlYWN0Q3VycmVudE93bmVyLmN1cnJlbnQudHlwZSk7CgogICAgICAgIGlmICghZGlkV2FybkFib3V0U3RyaW5nUmVmc1tjb21wb25lbnROYW1lXSkgewogICAgICAgICAgZXJyb3IoJ0NvbXBvbmVudCAiJXMiIGNvbnRhaW5zIHRoZSBzdHJpbmcgcmVmICIlcyIuICcgKyAnU3VwcG9ydCBmb3Igc3RyaW5nIHJlZnMgd2lsbCBiZSByZW1vdmVkIGluIGEgZnV0dXJlIG1ham9yIHJlbGVhc2UuICcgKyAnVGhpcyBjYXNlIGNhbm5vdCBiZSBhdXRvbWF0aWNhbGx5IGNvbnZlcnRlZCB0byBhbiBhcnJvdyBmdW5jdGlvbi4gJyArICdXZSBhc2sgeW91IHRvIG1hbnVhbGx5IGZpeCB0aGlzIGNhc2UgYnkgdXNpbmcgdXNlUmVmKCkgb3IgY3JlYXRlUmVmKCkgaW5zdGVhZC4gJyArICdMZWFybiBtb3JlIGFib3V0IHVzaW5nIHJlZnMgc2FmZWx5IGhlcmU6ICcgKyAnaHR0cHM6Ly9yZWFjdGpzLm9yZy9saW5rL3N0cmljdC1tb2RlLXN0cmluZy1yZWYnLCBjb21wb25lbnROYW1lLCBjb25maWcucmVmKTsKCiAgICAgICAgICBkaWRXYXJuQWJvdXRTdHJpbmdSZWZzW2NvbXBvbmVudE5hbWVdID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CiAgLyoqCiAgICogRmFjdG9yeSBtZXRob2QgdG8gY3JlYXRlIGEgbmV3IFJlYWN0IGVsZW1lbnQuIFRoaXMgbm8gbG9uZ2VyIGFkaGVyZXMgdG8KICAgKiB0aGUgY2xhc3MgcGF0dGVybiwgc28gZG8gbm90IHVzZSBuZXcgdG8gY2FsbCBpdC4gQWxzbywgaW5zdGFuY2VvZiBjaGVjawogICAqIHdpbGwgbm90IHdvcmsuIEluc3RlYWQgdGVzdCAkJHR5cGVvZiBmaWVsZCBhZ2FpbnN0IFN5bWJvbC5mb3IoJ3JlYWN0LmVsZW1lbnQnKSB0byBjaGVjawogICAqIGlmIHNvbWV0aGluZyBpcyBhIFJlYWN0IEVsZW1lbnQuCiAgICoKICAgKiBAcGFyYW0geyp9IHR5cGUKICAgKiBAcGFyYW0geyp9IHByb3BzCiAgICogQHBhcmFtIHsqfSBrZXkKICAgKiBAcGFyYW0ge3N0cmluZ3xvYmplY3R9IHJlZgogICAqIEBwYXJhbSB7Kn0gb3duZXIKICAgKiBAcGFyYW0geyp9IHNlbGYgQSAqdGVtcG9yYXJ5KiBoZWxwZXIgdG8gZGV0ZWN0IHBsYWNlcyB3aGVyZSBgdGhpc2AgaXMKICAgKiBkaWZmZXJlbnQgZnJvbSB0aGUgYG93bmVyYCB3aGVuIFJlYWN0LmNyZWF0ZUVsZW1lbnQgaXMgY2FsbGVkLCBzbyB0aGF0IHdlCiAgICogY2FuIHdhcm4uIFdlIHdhbnQgdG8gZ2V0IHJpZCBvZiBvd25lciBhbmQgcmVwbGFjZSBzdHJpbmcgYHJlZmBzIHdpdGggYXJyb3cKICAgKiBmdW5jdGlvbnMsIGFuZCBhcyBsb25nIGFzIGB0aGlzYCBhbmQgb3duZXIgYXJlIHRoZSBzYW1lLCB0aGVyZSB3aWxsIGJlIG5vCiAgICogY2hhbmdlIGluIGJlaGF2aW9yLgogICAqIEBwYXJhbSB7Kn0gc291cmNlIEFuIGFubm90YXRpb24gb2JqZWN0IChhZGRlZCBieSBhIHRyYW5zcGlsZXIgb3Igb3RoZXJ3aXNlKQogICAqIGluZGljYXRpbmcgZmlsZW5hbWUsIGxpbmUgbnVtYmVyLCBhbmQvb3Igb3RoZXIgaW5mb3JtYXRpb24uCiAgICogQGludGVybmFsCiAgICovCgoKICB2YXIgUmVhY3RFbGVtZW50ID0gZnVuY3Rpb24gKHR5cGUsIGtleSwgcmVmLCBzZWxmLCBzb3VyY2UsIG93bmVyLCBwcm9wcykgewogICAgdmFyIGVsZW1lbnQgPSB7CiAgICAgIC8vIFRoaXMgdGFnIGFsbG93cyB1cyB0byB1bmlxdWVseSBpZGVudGlmeSB0aGlzIGFzIGEgUmVhY3QgRWxlbWVudAogICAgICAkJHR5cGVvZjogUkVBQ1RfRUxFTUVOVF9UWVBFLAogICAgICAvLyBCdWlsdC1pbiBwcm9wZXJ0aWVzIHRoYXQgYmVsb25nIG9uIHRoZSBlbGVtZW50CiAgICAgIHR5cGU6IHR5cGUsCiAgICAgIGtleToga2V5LAogICAgICByZWY6IHJlZiwKICAgICAgcHJvcHM6IHByb3BzLAogICAgICAvLyBSZWNvcmQgdGhlIGNvbXBvbmVudCByZXNwb25zaWJsZSBmb3IgY3JlYXRpbmcgdGhpcyBlbGVtZW50LgogICAgICBfb3duZXI6IG93bmVyCiAgICB9OwoKICAgIHsKICAgICAgLy8gVGhlIHZhbGlkYXRpb24gZmxhZyBpcyBjdXJyZW50bHkgbXV0YXRpdmUuIFdlIHB1dCBpdCBvbgogICAgICAvLyBhbiBleHRlcm5hbCBiYWNraW5nIHN0b3JlIHNvIHRoYXQgd2UgY2FuIGZyZWV6ZSB0aGUgd2hvbGUgb2JqZWN0LgogICAgICAvLyBUaGlzIGNhbiBiZSByZXBsYWNlZCB3aXRoIGEgV2Vha01hcCBvbmNlIHRoZXkgYXJlIGltcGxlbWVudGVkIGluCiAgICAgIC8vIGNvbW1vbmx5IHVzZWQgZGV2ZWxvcG1lbnQgZW52aXJvbm1lbnRzLgogICAgICBlbGVtZW50Ll9zdG9yZSA9IHt9OyAvLyBUbyBtYWtlIGNvbXBhcmluZyBSZWFjdEVsZW1lbnRzIGVhc2llciBmb3IgdGVzdGluZyBwdXJwb3Nlcywgd2UgbWFrZQogICAgICAvLyB0aGUgdmFsaWRhdGlvbiBmbGFnIG5vbi1lbnVtZXJhYmxlICh3aGVyZSBwb3NzaWJsZSwgd2hpY2ggc2hvdWxkCiAgICAgIC8vIGluY2x1ZGUgZXZlcnkgZW52aXJvbm1lbnQgd2UgcnVuIHRlc3RzIGluKSwgc28gdGhlIHRlc3QgZnJhbWV3b3JrCiAgICAgIC8vIGlnbm9yZXMgaXQuCgogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZWxlbWVudC5fc3RvcmUsICd2YWxpZGF0ZWQnLCB7CiAgICAgICAgY29uZmlndXJhYmxlOiBmYWxzZSwKICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogZmFsc2UKICAgICAgfSk7IC8vIHNlbGYgYW5kIHNvdXJjZSBhcmUgREVWIG9ubHkgcHJvcGVydGllcy4KCiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlbGVtZW50LCAnX3NlbGYnLCB7CiAgICAgICAgY29uZmlndXJhYmxlOiBmYWxzZSwKICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSwKICAgICAgICB3cml0YWJsZTogZmFsc2UsCiAgICAgICAgdmFsdWU6IHNlbGYKICAgICAgfSk7IC8vIFR3byBlbGVtZW50cyBjcmVhdGVkIGluIHR3byBkaWZmZXJlbnQgcGxhY2VzIHNob3VsZCBiZSBjb25zaWRlcmVkCiAgICAgIC8vIGVxdWFsIGZvciB0ZXN0aW5nIHB1cnBvc2VzIGFuZCB0aGVyZWZvcmUgd2UgaGlkZSBpdCBmcm9tIGVudW1lcmF0aW9uLgoKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGVsZW1lbnQsICdfc291cmNlJywgewogICAgICAgIGNvbmZpZ3VyYWJsZTogZmFsc2UsCiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsCiAgICAgICAgd3JpdGFibGU6IGZhbHNlLAogICAgICAgIHZhbHVlOiBzb3VyY2UKICAgICAgfSk7CgogICAgICBpZiAoT2JqZWN0LmZyZWV6ZSkgewogICAgICAgIE9iamVjdC5mcmVlemUoZWxlbWVudC5wcm9wcyk7CiAgICAgICAgT2JqZWN0LmZyZWV6ZShlbGVtZW50KTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBlbGVtZW50OwogIH07CiAgLyoqCiAgICogQ3JlYXRlIGFuZCByZXR1cm4gYSBuZXcgUmVhY3RFbGVtZW50IG9mIHRoZSBnaXZlbiB0eXBlLgogICAqIFNlZSBodHRwczovL3JlYWN0anMub3JnL2RvY3MvcmVhY3QtYXBpLmh0bWwjY3JlYXRlZWxlbWVudAogICAqLwoKICBmdW5jdGlvbiBjcmVhdGVFbGVtZW50KHR5cGUsIGNvbmZpZywgY2hpbGRyZW4pIHsKICAgIHZhciBwcm9wTmFtZTsgLy8gUmVzZXJ2ZWQgbmFtZXMgYXJlIGV4dHJhY3RlZAoKICAgIHZhciBwcm9wcyA9IHt9OwogICAgdmFyIGtleSA9IG51bGw7CiAgICB2YXIgcmVmID0gbnVsbDsKICAgIHZhciBzZWxmID0gbnVsbDsKICAgIHZhciBzb3VyY2UgPSBudWxsOwoKICAgIGlmIChjb25maWcgIT0gbnVsbCkgewogICAgICBpZiAoaGFzVmFsaWRSZWYoY29uZmlnKSkgewogICAgICAgIHJlZiA9IGNvbmZpZy5yZWY7CgogICAgICAgIHsKICAgICAgICAgIHdhcm5JZlN0cmluZ1JlZkNhbm5vdEJlQXV0b0NvbnZlcnRlZChjb25maWcpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGhhc1ZhbGlkS2V5KGNvbmZpZykpIHsKICAgICAgICB7CiAgICAgICAgICBjaGVja0tleVN0cmluZ0NvZXJjaW9uKGNvbmZpZy5rZXkpOwogICAgICAgIH0KCiAgICAgICAga2V5ID0gJycgKyBjb25maWcua2V5OwogICAgICB9CgogICAgICBzZWxmID0gY29uZmlnLl9fc2VsZiA9PT0gdW5kZWZpbmVkID8gbnVsbCA6IGNvbmZpZy5fX3NlbGY7CiAgICAgIHNvdXJjZSA9IGNvbmZpZy5fX3NvdXJjZSA9PT0gdW5kZWZpbmVkID8gbnVsbCA6IGNvbmZpZy5fX3NvdXJjZTsgLy8gUmVtYWluaW5nIHByb3BlcnRpZXMgYXJlIGFkZGVkIHRvIGEgbmV3IHByb3BzIG9iamVjdAoKICAgICAgZm9yIChwcm9wTmFtZSBpbiBjb25maWcpIHsKICAgICAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbChjb25maWcsIHByb3BOYW1lKSAmJiAhUkVTRVJWRURfUFJPUFMuaGFzT3duUHJvcGVydHkocHJvcE5hbWUpKSB7CiAgICAgICAgICBwcm9wc1twcm9wTmFtZV0gPSBjb25maWdbcHJvcE5hbWVdOwogICAgICAgIH0KICAgICAgfQogICAgfSAvLyBDaGlsZHJlbiBjYW4gYmUgbW9yZSB0aGFuIG9uZSBhcmd1bWVudCwgYW5kIHRob3NlIGFyZSB0cmFuc2ZlcnJlZCBvbnRvCiAgICAvLyB0aGUgbmV3bHkgYWxsb2NhdGVkIHByb3BzIG9iamVjdC4KCgogICAgdmFyIGNoaWxkcmVuTGVuZ3RoID0gYXJndW1lbnRzLmxlbmd0aCAtIDI7CgogICAgaWYgKGNoaWxkcmVuTGVuZ3RoID09PSAxKSB7CiAgICAgIHByb3BzLmNoaWxkcmVuID0gY2hpbGRyZW47CiAgICB9IGVsc2UgaWYgKGNoaWxkcmVuTGVuZ3RoID4gMSkgewogICAgICB2YXIgY2hpbGRBcnJheSA9IEFycmF5KGNoaWxkcmVuTGVuZ3RoKTsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hpbGRyZW5MZW5ndGg7IGkrKykgewogICAgICAgIGNoaWxkQXJyYXlbaV0gPSBhcmd1bWVudHNbaSArIDJdOwogICAgICB9CgogICAgICB7CiAgICAgICAgaWYgKE9iamVjdC5mcmVlemUpIHsKICAgICAgICAgIE9iamVjdC5mcmVlemUoY2hpbGRBcnJheSk7CiAgICAgICAgfQogICAgICB9CgogICAgICBwcm9wcy5jaGlsZHJlbiA9IGNoaWxkQXJyYXk7CiAgICB9IC8vIFJlc29sdmUgZGVmYXVsdCBwcm9wcwoKCiAgICBpZiAodHlwZSAmJiB0eXBlLmRlZmF1bHRQcm9wcykgewogICAgICB2YXIgZGVmYXVsdFByb3BzID0gdHlwZS5kZWZhdWx0UHJvcHM7CgogICAgICBmb3IgKHByb3BOYW1lIGluIGRlZmF1bHRQcm9wcykgewogICAgICAgIGlmIChwcm9wc1twcm9wTmFtZV0gPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgcHJvcHNbcHJvcE5hbWVdID0gZGVmYXVsdFByb3BzW3Byb3BOYW1lXTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICB7CiAgICAgIGlmIChrZXkgfHwgcmVmKSB7CiAgICAgICAgdmFyIGRpc3BsYXlOYW1lID0gdHlwZW9mIHR5cGUgPT09ICdmdW5jdGlvbicgPyB0eXBlLmRpc3BsYXlOYW1lIHx8IHR5cGUubmFtZSB8fCAnVW5rbm93bicgOiB0eXBlOwoKICAgICAgICBpZiAoa2V5KSB7CiAgICAgICAgICBkZWZpbmVLZXlQcm9wV2FybmluZ0dldHRlcihwcm9wcywgZGlzcGxheU5hbWUpOwogICAgICAgIH0KCiAgICAgICAgaWYgKHJlZikgewogICAgICAgICAgZGVmaW5lUmVmUHJvcFdhcm5pbmdHZXR0ZXIocHJvcHMsIGRpc3BsYXlOYW1lKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gUmVhY3RFbGVtZW50KHR5cGUsIGtleSwgcmVmLCBzZWxmLCBzb3VyY2UsIFJlYWN0Q3VycmVudE93bmVyLmN1cnJlbnQsIHByb3BzKTsKICB9CiAgZnVuY3Rpb24gY2xvbmVBbmRSZXBsYWNlS2V5KG9sZEVsZW1lbnQsIG5ld0tleSkgewogICAgdmFyIG5ld0VsZW1lbnQgPSBSZWFjdEVsZW1lbnQob2xkRWxlbWVudC50eXBlLCBuZXdLZXksIG9sZEVsZW1lbnQucmVmLCBvbGRFbGVtZW50Ll9zZWxmLCBvbGRFbGVtZW50Ll9zb3VyY2UsIG9sZEVsZW1lbnQuX293bmVyLCBvbGRFbGVtZW50LnByb3BzKTsKICAgIHJldHVybiBuZXdFbGVtZW50OwogIH0KICAvKioKICAgKiBDbG9uZSBhbmQgcmV0dXJuIGEgbmV3IFJlYWN0RWxlbWVudCB1c2luZyBlbGVtZW50IGFzIHRoZSBzdGFydGluZyBwb2ludC4KICAgKiBTZWUgaHR0cHM6Ly9yZWFjdGpzLm9yZy9kb2NzL3JlYWN0LWFwaS5odG1sI2Nsb25lZWxlbWVudAogICAqLwoKICBmdW5jdGlvbiBjbG9uZUVsZW1lbnQoZWxlbWVudCwgY29uZmlnLCBjaGlsZHJlbikgewogICAgaWYgKGVsZW1lbnQgPT09IG51bGwgfHwgZWxlbWVudCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigiUmVhY3QuY2xvbmVFbGVtZW50KC4uLik6IFRoZSBhcmd1bWVudCBtdXN0IGJlIGEgUmVhY3QgZWxlbWVudCwgYnV0IHlvdSBwYXNzZWQgIiArIGVsZW1lbnQgKyAiLiIpOwogICAgfQoKICAgIHZhciBwcm9wTmFtZTsgLy8gT3JpZ2luYWwgcHJvcHMgYXJlIGNvcGllZAoKICAgIHZhciBwcm9wcyA9IGFzc2lnbih7fSwgZWxlbWVudC5wcm9wcyk7IC8vIFJlc2VydmVkIG5hbWVzIGFyZSBleHRyYWN0ZWQKCiAgICB2YXIga2V5ID0gZWxlbWVudC5rZXk7CiAgICB2YXIgcmVmID0gZWxlbWVudC5yZWY7IC8vIFNlbGYgaXMgcHJlc2VydmVkIHNpbmNlIHRoZSBvd25lciBpcyBwcmVzZXJ2ZWQuCgogICAgdmFyIHNlbGYgPSBlbGVtZW50Ll9zZWxmOyAvLyBTb3VyY2UgaXMgcHJlc2VydmVkIHNpbmNlIGNsb25lRWxlbWVudCBpcyB1bmxpa2VseSB0byBiZSB0YXJnZXRlZCBieSBhCiAgICAvLyB0cmFuc3BpbGVyLCBhbmQgdGhlIG9yaWdpbmFsIHNvdXJjZSBpcyBwcm9iYWJseSBhIGJldHRlciBpbmRpY2F0b3Igb2YgdGhlCiAgICAvLyB0cnVlIG93bmVyLgoKICAgIHZhciBzb3VyY2UgPSBlbGVtZW50Ll9zb3VyY2U7IC8vIE93bmVyIHdpbGwgYmUgcHJlc2VydmVkLCB1bmxlc3MgcmVmIGlzIG92ZXJyaWRkZW4KCiAgICB2YXIgb3duZXIgPSBlbGVtZW50Ll9vd25lcjsKCiAgICBpZiAoY29uZmlnICE9IG51bGwpIHsKICAgICAgaWYgKGhhc1ZhbGlkUmVmKGNvbmZpZykpIHsKICAgICAgICAvLyBTaWxlbnRseSBzdGVhbCB0aGUgcmVmIGZyb20gdGhlIHBhcmVudC4KICAgICAgICByZWYgPSBjb25maWcucmVmOwogICAgICAgIG93bmVyID0gUmVhY3RDdXJyZW50T3duZXIuY3VycmVudDsKICAgICAgfQoKICAgICAgaWYgKGhhc1ZhbGlkS2V5KGNvbmZpZykpIHsKICAgICAgICB7CiAgICAgICAgICBjaGVja0tleVN0cmluZ0NvZXJjaW9uKGNvbmZpZy5rZXkpOwogICAgICAgIH0KCiAgICAgICAga2V5ID0gJycgKyBjb25maWcua2V5OwogICAgICB9IC8vIFJlbWFpbmluZyBwcm9wZXJ0aWVzIG92ZXJyaWRlIGV4aXN0aW5nIHByb3BzCgoKICAgICAgdmFyIGRlZmF1bHRQcm9wczsKCiAgICAgIGlmIChlbGVtZW50LnR5cGUgJiYgZWxlbWVudC50eXBlLmRlZmF1bHRQcm9wcykgewogICAgICAgIGRlZmF1bHRQcm9wcyA9IGVsZW1lbnQudHlwZS5kZWZhdWx0UHJvcHM7CiAgICAgIH0KCiAgICAgIGZvciAocHJvcE5hbWUgaW4gY29uZmlnKSB7CiAgICAgICAgaWYgKGhhc093blByb3BlcnR5LmNhbGwoY29uZmlnLCBwcm9wTmFtZSkgJiYgIVJFU0VSVkVEX1BST1BTLmhhc093blByb3BlcnR5KHByb3BOYW1lKSkgewogICAgICAgICAgaWYgKGNvbmZpZ1twcm9wTmFtZV0gPT09IHVuZGVmaW5lZCAmJiBkZWZhdWx0UHJvcHMgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAvLyBSZXNvbHZlIGRlZmF1bHQgcHJvcHMKICAgICAgICAgICAgcHJvcHNbcHJvcE5hbWVdID0gZGVmYXVsdFByb3BzW3Byb3BOYW1lXTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHByb3BzW3Byb3BOYW1lXSA9IGNvbmZpZ1twcm9wTmFtZV07CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9IC8vIENoaWxkcmVuIGNhbiBiZSBtb3JlIHRoYW4gb25lIGFyZ3VtZW50LCBhbmQgdGhvc2UgYXJlIHRyYW5zZmVycmVkIG9udG8KICAgIC8vIHRoZSBuZXdseSBhbGxvY2F0ZWQgcHJvcHMgb2JqZWN0LgoKCiAgICB2YXIgY2hpbGRyZW5MZW5ndGggPSBhcmd1bWVudHMubGVuZ3RoIC0gMjsKCiAgICBpZiAoY2hpbGRyZW5MZW5ndGggPT09IDEpIHsKICAgICAgcHJvcHMuY2hpbGRyZW4gPSBjaGlsZHJlbjsKICAgIH0gZWxzZSBpZiAoY2hpbGRyZW5MZW5ndGggPiAxKSB7CiAgICAgIHZhciBjaGlsZEFycmF5ID0gQXJyYXkoY2hpbGRyZW5MZW5ndGgpOwoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGlsZHJlbkxlbmd0aDsgaSsrKSB7CiAgICAgICAgY2hpbGRBcnJheVtpXSA9IGFyZ3VtZW50c1tpICsgMl07CiAgICAgIH0KCiAgICAgIHByb3BzLmNoaWxkcmVuID0gY2hpbGRBcnJheTsKICAgIH0KCiAgICByZXR1cm4gUmVhY3RFbGVtZW50KGVsZW1lbnQudHlwZSwga2V5LCByZWYsIHNlbGYsIHNvdXJjZSwgb3duZXIsIHByb3BzKTsKICB9CiAgLyoqCiAgICogVmVyaWZpZXMgdGhlIG9iamVjdCBpcyBhIFJlYWN0RWxlbWVudC4KICAgKiBTZWUgaHR0cHM6Ly9yZWFjdGpzLm9yZy9kb2NzL3JlYWN0LWFwaS5odG1sI2lzdmFsaWRlbGVtZW50CiAgICogQHBhcmFtIHs/b2JqZWN0fSBvYmplY3QKICAgKiBAcmV0dXJuIHtib29sZWFufSBUcnVlIGlmIGBvYmplY3RgIGlzIGEgUmVhY3RFbGVtZW50LgogICAqIEBmaW5hbAogICAqLwoKICBmdW5jdGlvbiBpc1ZhbGlkRWxlbWVudChvYmplY3QpIHsKICAgIHJldHVybiB0eXBlb2Ygb2JqZWN0ID09PSAnb2JqZWN0JyAmJiBvYmplY3QgIT09IG51bGwgJiYgb2JqZWN0LiQkdHlwZW9mID09PSBSRUFDVF9FTEVNRU5UX1RZUEU7CiAgfQoKICB2YXIgU0VQQVJBVE9SID0gJy4nOwogIHZhciBTVUJTRVBBUkFUT1IgPSAnOic7CiAgLyoqCiAgICogRXNjYXBlIGFuZCB3cmFwIGtleSBzbyBpdCBpcyBzYWZlIHRvIHVzZSBhcyBhIHJlYWN0aWQKICAgKgogICAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgdG8gYmUgZXNjYXBlZC4KICAgKiBAcmV0dXJuIHtzdHJpbmd9IHRoZSBlc2NhcGVkIGtleS4KICAgKi8KCiAgZnVuY3Rpb24gZXNjYXBlKGtleSkgewogICAgdmFyIGVzY2FwZVJlZ2V4ID0gL1s9Ol0vZzsKICAgIHZhciBlc2NhcGVyTG9va3VwID0gewogICAgICAnPSc6ICc9MCcsCiAgICAgICc6JzogJz0yJwogICAgfTsKICAgIHZhciBlc2NhcGVkU3RyaW5nID0ga2V5LnJlcGxhY2UoZXNjYXBlUmVnZXgsIGZ1bmN0aW9uIChtYXRjaCkgewogICAgICByZXR1cm4gZXNjYXBlckxvb2t1cFttYXRjaF07CiAgICB9KTsKICAgIHJldHVybiAnJCcgKyBlc2NhcGVkU3RyaW5nOwogIH0KICAvKioKICAgKiBUT0RPOiBUZXN0IHRoYXQgYSBzaW5nbGUgY2hpbGQgYW5kIGFuIGFycmF5IHdpdGggb25lIGl0ZW0gaGF2ZSB0aGUgc2FtZSBrZXkKICAgKiBwYXR0ZXJuLgogICAqLwoKCiAgdmFyIGRpZFdhcm5BYm91dE1hcHMgPSBmYWxzZTsKICB2YXIgdXNlclByb3ZpZGVkS2V5RXNjYXBlUmVnZXggPSAvXC8rL2c7CgogIGZ1bmN0aW9uIGVzY2FwZVVzZXJQcm92aWRlZEtleSh0ZXh0KSB7CiAgICByZXR1cm4gdGV4dC5yZXBsYWNlKHVzZXJQcm92aWRlZEtleUVzY2FwZVJlZ2V4LCAnJCYvJyk7CiAgfQogIC8qKgogICAqIEdlbmVyYXRlIGEga2V5IHN0cmluZyB0aGF0IGlkZW50aWZpZXMgYSBlbGVtZW50IHdpdGhpbiBhIHNldC4KICAgKgogICAqIEBwYXJhbSB7Kn0gZWxlbWVudCBBIGVsZW1lbnQgdGhhdCBjb3VsZCBjb250YWluIGEgbWFudWFsIGtleS4KICAgKiBAcGFyYW0ge251bWJlcn0gaW5kZXggSW5kZXggdGhhdCBpcyB1c2VkIGlmIGEgbWFudWFsIGtleSBpcyBub3QgcHJvdmlkZWQuCiAgICogQHJldHVybiB7c3RyaW5nfQogICAqLwoKCiAgZnVuY3Rpb24gZ2V0RWxlbWVudEtleShlbGVtZW50LCBpbmRleCkgewogICAgLy8gRG8gc29tZSB0eXBlY2hlY2tpbmcgaGVyZSBzaW5jZSB3ZSBjYWxsIHRoaXMgYmxpbmRseS4gV2Ugd2FudCB0byBlbnN1cmUKICAgIC8vIHRoYXQgd2UgZG9uJ3QgYmxvY2sgcG90ZW50aWFsIGZ1dHVyZSBFUyBBUElzLgogICAgaWYgKHR5cGVvZiBlbGVtZW50ID09PSAnb2JqZWN0JyAmJiBlbGVtZW50ICE9PSBudWxsICYmIGVsZW1lbnQua2V5ICE9IG51bGwpIHsKICAgICAgLy8gRXhwbGljaXQga2V5CiAgICAgIHsKICAgICAgICBjaGVja0tleVN0cmluZ0NvZXJjaW9uKGVsZW1lbnQua2V5KTsKICAgICAgfQoKICAgICAgcmV0dXJuIGVzY2FwZSgnJyArIGVsZW1lbnQua2V5KTsKICAgIH0gLy8gSW1wbGljaXQga2V5IGRldGVybWluZWQgYnkgdGhlIGluZGV4IGluIHRoZSBzZXQKCgogICAgcmV0dXJuIGluZGV4LnRvU3RyaW5nKDM2KTsKICB9CgogIGZ1bmN0aW9uIG1hcEludG9BcnJheShjaGlsZHJlbiwgYXJyYXksIGVzY2FwZWRQcmVmaXgsIG5hbWVTb0ZhciwgY2FsbGJhY2spIHsKICAgIHZhciB0eXBlID0gdHlwZW9mIGNoaWxkcmVuOwoKICAgIGlmICh0eXBlID09PSAndW5kZWZpbmVkJyB8fCB0eXBlID09PSAnYm9vbGVhbicpIHsKICAgICAgLy8gQWxsIG9mIHRoZSBhYm92ZSBhcmUgcGVyY2VpdmVkIGFzIG51bGwuCiAgICAgIGNoaWxkcmVuID0gbnVsbDsKICAgIH0KCiAgICB2YXIgaW52b2tlQ2FsbGJhY2sgPSBmYWxzZTsKCiAgICBpZiAoY2hpbGRyZW4gPT09IG51bGwpIHsKICAgICAgaW52b2tlQ2FsbGJhY2sgPSB0cnVlOwogICAgfSBlbHNlIHsKICAgICAgc3dpdGNoICh0eXBlKSB7CiAgICAgICAgY2FzZSAnc3RyaW5nJzoKICAgICAgICBjYXNlICdudW1iZXInOgogICAgICAgICAgaW52b2tlQ2FsbGJhY2sgPSB0cnVlOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgJ29iamVjdCc6CiAgICAgICAgICBzd2l0Y2ggKGNoaWxkcmVuLiQkdHlwZW9mKSB7CiAgICAgICAgICAgIGNhc2UgUkVBQ1RfRUxFTUVOVF9UWVBFOgogICAgICAgICAgICBjYXNlIFJFQUNUX1BPUlRBTF9UWVBFOgogICAgICAgICAgICAgIGludm9rZUNhbGxiYWNrID0gdHJ1ZTsKICAgICAgICAgIH0KCiAgICAgIH0KICAgIH0KCiAgICBpZiAoaW52b2tlQ2FsbGJhY2spIHsKICAgICAgdmFyIF9jaGlsZCA9IGNoaWxkcmVuOwogICAgICB2YXIgbWFwcGVkQ2hpbGQgPSBjYWxsYmFjayhfY2hpbGQpOyAvLyBJZiBpdCdzIHRoZSBvbmx5IGNoaWxkLCB0cmVhdCB0aGUgbmFtZSBhcyBpZiBpdCB3YXMgd3JhcHBlZCBpbiBhbiBhcnJheQogICAgICAvLyBzbyB0aGF0IGl0J3MgY29uc2lzdGVudCBpZiB0aGUgbnVtYmVyIG9mIGNoaWxkcmVuIGdyb3dzOgoKICAgICAgdmFyIGNoaWxkS2V5ID0gbmFtZVNvRmFyID09PSAnJyA/IFNFUEFSQVRPUiArIGdldEVsZW1lbnRLZXkoX2NoaWxkLCAwKSA6IG5hbWVTb0ZhcjsKCiAgICAgIGlmIChpc0FycmF5KG1hcHBlZENoaWxkKSkgewogICAgICAgIHZhciBlc2NhcGVkQ2hpbGRLZXkgPSAnJzsKCiAgICAgICAgaWYgKGNoaWxkS2V5ICE9IG51bGwpIHsKICAgICAgICAgIGVzY2FwZWRDaGlsZEtleSA9IGVzY2FwZVVzZXJQcm92aWRlZEtleShjaGlsZEtleSkgKyAnLyc7CiAgICAgICAgfQoKICAgICAgICBtYXBJbnRvQXJyYXkobWFwcGVkQ2hpbGQsIGFycmF5LCBlc2NhcGVkQ2hpbGRLZXksICcnLCBmdW5jdGlvbiAoYykgewogICAgICAgICAgcmV0dXJuIGM7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAobWFwcGVkQ2hpbGQgIT0gbnVsbCkgewogICAgICAgIGlmIChpc1ZhbGlkRWxlbWVudChtYXBwZWRDaGlsZCkpIHsKICAgICAgICAgIHsKICAgICAgICAgICAgLy8gVGhlIGBpZmAgc3RhdGVtZW50IGhlcmUgcHJldmVudHMgYXV0by1kaXNhYmxpbmcgb2YgdGhlIHNhZmUKICAgICAgICAgICAgLy8gY29lcmNpb24gRVNMaW50IHJ1bGUsIHNvIHdlIG11c3QgbWFudWFsbHkgZGlzYWJsZSBpdCBiZWxvdy4KICAgICAgICAgICAgLy8gJEZsb3dGaXhNZSBGbG93IGluY29ycmVjdGx5IHRoaW5rcyBSZWFjdC5Qb3J0YWwgZG9lc24ndCBoYXZlIGEga2V5CiAgICAgICAgICAgIGlmIChtYXBwZWRDaGlsZC5rZXkgJiYgKCFfY2hpbGQgfHwgX2NoaWxkLmtleSAhPT0gbWFwcGVkQ2hpbGQua2V5KSkgewogICAgICAgICAgICAgIGNoZWNrS2V5U3RyaW5nQ29lcmNpb24obWFwcGVkQ2hpbGQua2V5KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIG1hcHBlZENoaWxkID0gY2xvbmVBbmRSZXBsYWNlS2V5KG1hcHBlZENoaWxkLCAvLyBLZWVwIGJvdGggdGhlIChtYXBwZWQpIGFuZCBvbGQga2V5cyBpZiB0aGV5IGRpZmZlciwganVzdCBhcwogICAgICAgICAgLy8gdHJhdmVyc2VBbGxDaGlsZHJlbiB1c2VkIHRvIGRvIGZvciBvYmplY3RzIGFzIGNoaWxkcmVuCiAgICAgICAgICBlc2NhcGVkUHJlZml4ICsgKCAvLyAkRmxvd0ZpeE1lIEZsb3cgaW5jb3JyZWN0bHkgdGhpbmtzIFJlYWN0LlBvcnRhbCBkb2Vzbid0IGhhdmUgYSBrZXkKICAgICAgICAgIG1hcHBlZENoaWxkLmtleSAmJiAoIV9jaGlsZCB8fCBfY2hpbGQua2V5ICE9PSBtYXBwZWRDaGlsZC5rZXkpID8gLy8gJEZsb3dGaXhNZSBGbG93IGluY29ycmVjdGx5IHRoaW5rcyBleGlzdGluZyBlbGVtZW50J3Mga2V5IGNhbiBiZSBhIG51bWJlcgogICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0LWludGVybmFsL3NhZmUtc3RyaW5nLWNvZXJjaW9uCiAgICAgICAgICBlc2NhcGVVc2VyUHJvdmlkZWRLZXkoJycgKyBtYXBwZWRDaGlsZC5rZXkpICsgJy8nIDogJycpICsgY2hpbGRLZXkpOwogICAgICAgIH0KCiAgICAgICAgYXJyYXkucHVzaChtYXBwZWRDaGlsZCk7CiAgICAgIH0KCiAgICAgIHJldHVybiAxOwogICAgfQoKICAgIHZhciBjaGlsZDsKICAgIHZhciBuZXh0TmFtZTsKICAgIHZhciBzdWJ0cmVlQ291bnQgPSAwOyAvLyBDb3VudCBvZiBjaGlsZHJlbiBmb3VuZCBpbiB0aGUgY3VycmVudCBzdWJ0cmVlLgoKICAgIHZhciBuZXh0TmFtZVByZWZpeCA9IG5hbWVTb0ZhciA9PT0gJycgPyBTRVBBUkFUT1IgOiBuYW1lU29GYXIgKyBTVUJTRVBBUkFUT1I7CgogICAgaWYgKGlzQXJyYXkoY2hpbGRyZW4pKSB7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHsKICAgICAgICBjaGlsZCA9IGNoaWxkcmVuW2ldOwogICAgICAgIG5leHROYW1lID0gbmV4dE5hbWVQcmVmaXggKyBnZXRFbGVtZW50S2V5KGNoaWxkLCBpKTsKICAgICAgICBzdWJ0cmVlQ291bnQgKz0gbWFwSW50b0FycmF5KGNoaWxkLCBhcnJheSwgZXNjYXBlZFByZWZpeCwgbmV4dE5hbWUsIGNhbGxiYWNrKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgdmFyIGl0ZXJhdG9yRm4gPSBnZXRJdGVyYXRvckZuKGNoaWxkcmVuKTsKCiAgICAgIGlmICh0eXBlb2YgaXRlcmF0b3JGbiA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIHZhciBpdGVyYWJsZUNoaWxkcmVuID0gY2hpbGRyZW47CgogICAgICAgIHsKICAgICAgICAgIC8vIFdhcm4gYWJvdXQgdXNpbmcgTWFwcyBhcyBjaGlsZHJlbgogICAgICAgICAgaWYgKGl0ZXJhdG9yRm4gPT09IGl0ZXJhYmxlQ2hpbGRyZW4uZW50cmllcykgewogICAgICAgICAgICBpZiAoIWRpZFdhcm5BYm91dE1hcHMpIHsKICAgICAgICAgICAgICB3YXJuKCdVc2luZyBNYXBzIGFzIGNoaWxkcmVuIGlzIG5vdCBzdXBwb3J0ZWQuICcgKyAnVXNlIGFuIGFycmF5IG9mIGtleWVkIFJlYWN0RWxlbWVudHMgaW5zdGVhZC4nKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZGlkV2FybkFib3V0TWFwcyA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICB2YXIgaXRlcmF0b3IgPSBpdGVyYXRvckZuLmNhbGwoaXRlcmFibGVDaGlsZHJlbik7CiAgICAgICAgdmFyIHN0ZXA7CiAgICAgICAgdmFyIGlpID0gMDsKCiAgICAgICAgd2hpbGUgKCEoc3RlcCA9IGl0ZXJhdG9yLm5leHQoKSkuZG9uZSkgewogICAgICAgICAgY2hpbGQgPSBzdGVwLnZhbHVlOwogICAgICAgICAgbmV4dE5hbWUgPSBuZXh0TmFtZVByZWZpeCArIGdldEVsZW1lbnRLZXkoY2hpbGQsIGlpKyspOwogICAgICAgICAgc3VidHJlZUNvdW50ICs9IG1hcEludG9BcnJheShjaGlsZCwgYXJyYXksIGVzY2FwZWRQcmVmaXgsIG5leHROYW1lLCBjYWxsYmFjayk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdvYmplY3QnKSB7CiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0LWludGVybmFsL3NhZmUtc3RyaW5nLWNvZXJjaW9uCiAgICAgICAgdmFyIGNoaWxkcmVuU3RyaW5nID0gU3RyaW5nKGNoaWxkcmVuKTsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIk9iamVjdHMgYXJlIG5vdCB2YWxpZCBhcyBhIFJlYWN0IGNoaWxkIChmb3VuZDogIiArIChjaGlsZHJlblN0cmluZyA9PT0gJ1tvYmplY3QgT2JqZWN0XScgPyAnb2JqZWN0IHdpdGgga2V5cyB7JyArIE9iamVjdC5rZXlzKGNoaWxkcmVuKS5qb2luKCcsICcpICsgJ30nIDogY2hpbGRyZW5TdHJpbmcpICsgIikuICIgKyAnSWYgeW91IG1lYW50IHRvIHJlbmRlciBhIGNvbGxlY3Rpb24gb2YgY2hpbGRyZW4sIHVzZSBhbiBhcnJheSAnICsgJ2luc3RlYWQuJyk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gc3VidHJlZUNvdW50OwogIH0KCiAgLyoqCiAgICogTWFwcyBjaGlsZHJlbiB0aGF0IGFyZSB0eXBpY2FsbHkgc3BlY2lmaWVkIGFzIGBwcm9wcy5jaGlsZHJlbmAuCiAgICoKICAgKiBTZWUgaHR0cHM6Ly9yZWFjdGpzLm9yZy9kb2NzL3JlYWN0LWFwaS5odG1sI3JlYWN0Y2hpbGRyZW5tYXAKICAgKgogICAqIFRoZSBwcm92aWRlZCBtYXBGdW5jdGlvbihjaGlsZCwgaW5kZXgpIHdpbGwgYmUgY2FsbGVkIGZvciBlYWNoCiAgICogbGVhZiBjaGlsZC4KICAgKgogICAqIEBwYXJhbSB7Pyp9IGNoaWxkcmVuIENoaWxkcmVuIHRyZWUgY29udGFpbmVyLgogICAqIEBwYXJhbSB7ZnVuY3Rpb24oKiwgaW50KX0gZnVuYyBUaGUgbWFwIGZ1bmN0aW9uLgogICAqIEBwYXJhbSB7Kn0gY29udGV4dCBDb250ZXh0IGZvciBtYXBGdW5jdGlvbi4KICAgKiBAcmV0dXJuIHtvYmplY3R9IE9iamVjdCBjb250YWluaW5nIHRoZSBvcmRlcmVkIG1hcCBvZiByZXN1bHRzLgogICAqLwogIGZ1bmN0aW9uIG1hcENoaWxkcmVuKGNoaWxkcmVuLCBmdW5jLCBjb250ZXh0KSB7CiAgICBpZiAoY2hpbGRyZW4gPT0gbnVsbCkgewogICAgICByZXR1cm4gY2hpbGRyZW47CiAgICB9CgogICAgdmFyIHJlc3VsdCA9IFtdOwogICAgdmFyIGNvdW50ID0gMDsKICAgIG1hcEludG9BcnJheShjaGlsZHJlbiwgcmVzdWx0LCAnJywgJycsIGZ1bmN0aW9uIChjaGlsZCkgewogICAgICByZXR1cm4gZnVuYy5jYWxsKGNvbnRleHQsIGNoaWxkLCBjb3VudCsrKTsKICAgIH0pOwogICAgcmV0dXJuIHJlc3VsdDsKICB9CiAgLyoqCiAgICogQ291bnQgdGhlIG51bWJlciBvZiBjaGlsZHJlbiB0aGF0IGFyZSB0eXBpY2FsbHkgc3BlY2lmaWVkIGFzCiAgICogYHByb3BzLmNoaWxkcmVuYC4KICAgKgogICAqIFNlZSBodHRwczovL3JlYWN0anMub3JnL2RvY3MvcmVhY3QtYXBpLmh0bWwjcmVhY3RjaGlsZHJlbmNvdW50CiAgICoKICAgKiBAcGFyYW0gez8qfSBjaGlsZHJlbiBDaGlsZHJlbiB0cmVlIGNvbnRhaW5lci4KICAgKiBAcmV0dXJuIHtudW1iZXJ9IFRoZSBudW1iZXIgb2YgY2hpbGRyZW4uCiAgICovCgoKICBmdW5jdGlvbiBjb3VudENoaWxkcmVuKGNoaWxkcmVuKSB7CiAgICB2YXIgbiA9IDA7CiAgICBtYXBDaGlsZHJlbihjaGlsZHJlbiwgZnVuY3Rpb24gKCkgewogICAgICBuKys7IC8vIERvbid0IHJldHVybiBhbnl0aGluZwogICAgfSk7CiAgICByZXR1cm4gbjsKICB9CgogIC8qKgogICAqIEl0ZXJhdGVzIHRocm91Z2ggY2hpbGRyZW4gdGhhdCBhcmUgdHlwaWNhbGx5IHNwZWNpZmllZCBhcyBgcHJvcHMuY2hpbGRyZW5gLgogICAqCiAgICogU2VlIGh0dHBzOi8vcmVhY3Rqcy5vcmcvZG9jcy9yZWFjdC1hcGkuaHRtbCNyZWFjdGNoaWxkcmVuZm9yZWFjaAogICAqCiAgICogVGhlIHByb3ZpZGVkIGZvckVhY2hGdW5jKGNoaWxkLCBpbmRleCkgd2lsbCBiZSBjYWxsZWQgZm9yIGVhY2gKICAgKiBsZWFmIGNoaWxkLgogICAqCiAgICogQHBhcmFtIHs/Kn0gY2hpbGRyZW4gQ2hpbGRyZW4gdHJlZSBjb250YWluZXIuCiAgICogQHBhcmFtIHtmdW5jdGlvbigqLCBpbnQpfSBmb3JFYWNoRnVuYwogICAqIEBwYXJhbSB7Kn0gZm9yRWFjaENvbnRleHQgQ29udGV4dCBmb3IgZm9yRWFjaENvbnRleHQuCiAgICovCiAgZnVuY3Rpb24gZm9yRWFjaENoaWxkcmVuKGNoaWxkcmVuLCBmb3JFYWNoRnVuYywgZm9yRWFjaENvbnRleHQpIHsKICAgIG1hcENoaWxkcmVuKGNoaWxkcmVuLCBmdW5jdGlvbiAoKSB7CiAgICAgIGZvckVhY2hGdW5jLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7IC8vIERvbid0IHJldHVybiBhbnl0aGluZy4KICAgIH0sIGZvckVhY2hDb250ZXh0KTsKICB9CiAgLyoqCiAgICogRmxhdHRlbiBhIGNoaWxkcmVuIG9iamVjdCAodHlwaWNhbGx5IHNwZWNpZmllZCBhcyBgcHJvcHMuY2hpbGRyZW5gKSBhbmQKICAgKiByZXR1cm4gYW4gYXJyYXkgd2l0aCBhcHByb3ByaWF0ZWx5IHJlLWtleWVkIGNoaWxkcmVuLgogICAqCiAgICogU2VlIGh0dHBzOi8vcmVhY3Rqcy5vcmcvZG9jcy9yZWFjdC1hcGkuaHRtbCNyZWFjdGNoaWxkcmVudG9hcnJheQogICAqLwoKCiAgZnVuY3Rpb24gdG9BcnJheShjaGlsZHJlbikgewogICAgcmV0dXJuIG1hcENoaWxkcmVuKGNoaWxkcmVuLCBmdW5jdGlvbiAoY2hpbGQpIHsKICAgICAgcmV0dXJuIGNoaWxkOwogICAgfSkgfHwgW107CiAgfQogIC8qKgogICAqIFJldHVybnMgdGhlIGZpcnN0IGNoaWxkIGluIGEgY29sbGVjdGlvbiBvZiBjaGlsZHJlbiBhbmQgdmVyaWZpZXMgdGhhdCB0aGVyZQogICAqIGlzIG9ubHkgb25lIGNoaWxkIGluIHRoZSBjb2xsZWN0aW9uLgogICAqCiAgICogU2VlIGh0dHBzOi8vcmVhY3Rqcy5vcmcvZG9jcy9yZWFjdC1hcGkuaHRtbCNyZWFjdGNoaWxkcmVub25seQogICAqCiAgICogVGhlIGN1cnJlbnQgaW1wbGVtZW50YXRpb24gb2YgdGhpcyBmdW5jdGlvbiBhc3N1bWVzIHRoYXQgYSBzaW5nbGUgY2hpbGQgZ2V0cwogICAqIHBhc3NlZCB3aXRob3V0IGEgd3JhcHBlciwgYnV0IHRoZSBwdXJwb3NlIG9mIHRoaXMgaGVscGVyIGZ1bmN0aW9uIGlzIHRvCiAgICogYWJzdHJhY3QgYXdheSB0aGUgcGFydGljdWxhciBzdHJ1Y3R1cmUgb2YgY2hpbGRyZW4uCiAgICoKICAgKiBAcGFyYW0gez9vYmplY3R9IGNoaWxkcmVuIENoaWxkIGNvbGxlY3Rpb24gc3RydWN0dXJlLgogICAqIEByZXR1cm4ge1JlYWN0RWxlbWVudH0gVGhlIGZpcnN0IGFuZCBvbmx5IGBSZWFjdEVsZW1lbnRgIGNvbnRhaW5lZCBpbiB0aGUKICAgKiBzdHJ1Y3R1cmUuCiAgICovCgoKICBmdW5jdGlvbiBvbmx5Q2hpbGQoY2hpbGRyZW4pIHsKICAgIGlmICghaXNWYWxpZEVsZW1lbnQoY2hpbGRyZW4pKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignUmVhY3QuQ2hpbGRyZW4ub25seSBleHBlY3RlZCB0byByZWNlaXZlIGEgc2luZ2xlIFJlYWN0IGVsZW1lbnQgY2hpbGQuJyk7CiAgICB9CgogICAgcmV0dXJuIGNoaWxkcmVuOwogIH0KCiAgZnVuY3Rpb24gY3JlYXRlQ29udGV4dChkZWZhdWx0VmFsdWUpIHsKICAgIC8vIFRPRE86IFNlY29uZCBhcmd1bWVudCB1c2VkIHRvIGJlIGFuIG9wdGlvbmFsIGBjYWxjdWxhdGVDaGFuZ2VkQml0c2AKICAgIC8vIGZ1bmN0aW9uLiBXYXJuIHRvIHJlc2VydmUgZm9yIGZ1dHVyZSB1c2U/CiAgICB2YXIgY29udGV4dCA9IHsKICAgICAgJCR0eXBlb2Y6IFJFQUNUX0NPTlRFWFRfVFlQRSwKICAgICAgLy8gQXMgYSB3b3JrYXJvdW5kIHRvIHN1cHBvcnQgbXVsdGlwbGUgY29uY3VycmVudCByZW5kZXJlcnMsIHdlIGNhdGVnb3JpemUKICAgICAgLy8gc29tZSByZW5kZXJlcnMgYXMgcHJpbWFyeSBhbmQgb3RoZXJzIGFzIHNlY29uZGFyeS4gV2Ugb25seSBleHBlY3QKICAgICAgLy8gdGhlcmUgdG8gYmUgdHdvIGNvbmN1cnJlbnQgcmVuZGVyZXJzIGF0IG1vc3Q6IFJlYWN0IE5hdGl2ZSAocHJpbWFyeSkgYW5kCiAgICAgIC8vIEZhYnJpYyAoc2Vjb25kYXJ5KTsgUmVhY3QgRE9NIChwcmltYXJ5KSBhbmQgUmVhY3QgQVJUIChzZWNvbmRhcnkpLgogICAgICAvLyBTZWNvbmRhcnkgcmVuZGVyZXJzIHN0b3JlIHRoZWlyIGNvbnRleHQgdmFsdWVzIG9uIHNlcGFyYXRlIGZpZWxkcy4KICAgICAgX2N1cnJlbnRWYWx1ZTogZGVmYXVsdFZhbHVlLAogICAgICBfY3VycmVudFZhbHVlMjogZGVmYXVsdFZhbHVlLAogICAgICAvLyBVc2VkIHRvIHRyYWNrIGhvdyBtYW55IGNvbmN1cnJlbnQgcmVuZGVyZXJzIHRoaXMgY29udGV4dCBjdXJyZW50bHkKICAgICAgLy8gc3VwcG9ydHMgd2l0aGluIGluIGEgc2luZ2xlIHJlbmRlcmVyLiBTdWNoIGFzIHBhcmFsbGVsIHNlcnZlciByZW5kZXJpbmcuCiAgICAgIF90aHJlYWRDb3VudDogMCwKICAgICAgLy8gVGhlc2UgYXJlIGNpcmN1bGFyCiAgICAgIFByb3ZpZGVyOiBudWxsLAogICAgICBDb25zdW1lcjogbnVsbCwKICAgICAgLy8gQWRkIHRoZXNlIHRvIHVzZSBzYW1lIGhpZGRlbiBjbGFzcyBpbiBWTSBhcyBTZXJ2ZXJDb250ZXh0CiAgICAgIF9kZWZhdWx0VmFsdWU6IG51bGwsCiAgICAgIF9nbG9iYWxOYW1lOiBudWxsCiAgICB9OwogICAgY29udGV4dC5Qcm92aWRlciA9IHsKICAgICAgJCR0eXBlb2Y6IFJFQUNUX1BST1ZJREVSX1RZUEUsCiAgICAgIF9jb250ZXh0OiBjb250ZXh0CiAgICB9OwogICAgdmFyIGhhc1dhcm5lZEFib3V0VXNpbmdOZXN0ZWRDb250ZXh0Q29uc3VtZXJzID0gZmFsc2U7CiAgICB2YXIgaGFzV2FybmVkQWJvdXRVc2luZ0NvbnN1bWVyUHJvdmlkZXIgPSBmYWxzZTsKICAgIHZhciBoYXNXYXJuZWRBYm91dERpc3BsYXlOYW1lT25Db25zdW1lciA9IGZhbHNlOwoKICAgIHsKICAgICAgLy8gQSBzZXBhcmF0ZSBvYmplY3QsIGJ1dCBwcm94aWVzIGJhY2sgdG8gdGhlIG9yaWdpbmFsIGNvbnRleHQgb2JqZWN0IGZvcgogICAgICAvLyBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eS4gSXQgaGFzIGEgZGlmZmVyZW50ICQkdHlwZW9mLCBzbyB3ZSBjYW4gcHJvcGVybHkKICAgICAgLy8gd2FybiBmb3IgdGhlIGluY29ycmVjdCB1c2FnZSBvZiBDb250ZXh0IGFzIGEgQ29uc3VtZXIuCiAgICAgIHZhciBDb25zdW1lciA9IHsKICAgICAgICAkJHR5cGVvZjogUkVBQ1RfQ09OVEVYVF9UWVBFLAogICAgICAgIF9jb250ZXh0OiBjb250ZXh0CiAgICAgIH07IC8vICRGbG93Rml4TWU6IEZsb3cgY29tcGxhaW5zIGFib3V0IG5vdCBzZXR0aW5nIGEgdmFsdWUsIHdoaWNoIGlzIGludGVudGlvbmFsIGhlcmUKCiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKENvbnN1bWVyLCB7CiAgICAgICAgUHJvdmlkZXI6IHsKICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICBpZiAoIWhhc1dhcm5lZEFib3V0VXNpbmdDb25zdW1lclByb3ZpZGVyKSB7CiAgICAgICAgICAgICAgaGFzV2FybmVkQWJvdXRVc2luZ0NvbnN1bWVyUHJvdmlkZXIgPSB0cnVlOwoKICAgICAgICAgICAgICBlcnJvcignUmVuZGVyaW5nIDxDb250ZXh0LkNvbnN1bWVyLlByb3ZpZGVyPiBpcyBub3Qgc3VwcG9ydGVkIGFuZCB3aWxsIGJlIHJlbW92ZWQgaW4gJyArICdhIGZ1dHVyZSBtYWpvciByZWxlYXNlLiBEaWQgeW91IG1lYW4gdG8gcmVuZGVyIDxDb250ZXh0LlByb3ZpZGVyPiBpbnN0ZWFkPycpOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gY29udGV4dC5Qcm92aWRlcjsKICAgICAgICAgIH0sCiAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIChfUHJvdmlkZXIpIHsKICAgICAgICAgICAgY29udGV4dC5Qcm92aWRlciA9IF9Qcm92aWRlcjsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIF9jdXJyZW50VmFsdWU6IHsKICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gY29udGV4dC5fY3VycmVudFZhbHVlOwogICAgICAgICAgfSwKICAgICAgICAgIHNldDogZnVuY3Rpb24gKF9jdXJyZW50VmFsdWUpIHsKICAgICAgICAgICAgY29udGV4dC5fY3VycmVudFZhbHVlID0gX2N1cnJlbnRWYWx1ZTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIF9jdXJyZW50VmFsdWUyOiB7CiAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQuX2N1cnJlbnRWYWx1ZTI7CiAgICAgICAgICB9LAogICAgICAgICAgc2V0OiBmdW5jdGlvbiAoX2N1cnJlbnRWYWx1ZTIpIHsKICAgICAgICAgICAgY29udGV4dC5fY3VycmVudFZhbHVlMiA9IF9jdXJyZW50VmFsdWUyOwogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgX3RocmVhZENvdW50OiB7CiAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQuX3RocmVhZENvdW50OwogICAgICAgICAgfSwKICAgICAgICAgIHNldDogZnVuY3Rpb24gKF90aHJlYWRDb3VudCkgewogICAgICAgICAgICBjb250ZXh0Ll90aHJlYWRDb3VudCA9IF90aHJlYWRDb3VudDsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIENvbnN1bWVyOiB7CiAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgaWYgKCFoYXNXYXJuZWRBYm91dFVzaW5nTmVzdGVkQ29udGV4dENvbnN1bWVycykgewogICAgICAgICAgICAgIGhhc1dhcm5lZEFib3V0VXNpbmdOZXN0ZWRDb250ZXh0Q29uc3VtZXJzID0gdHJ1ZTsKCiAgICAgICAgICAgICAgZXJyb3IoJ1JlbmRlcmluZyA8Q29udGV4dC5Db25zdW1lci5Db25zdW1lcj4gaXMgbm90IHN1cHBvcnRlZCBhbmQgd2lsbCBiZSByZW1vdmVkIGluICcgKyAnYSBmdXR1cmUgbWFqb3IgcmVsZWFzZS4gRGlkIHlvdSBtZWFuIHRvIHJlbmRlciA8Q29udGV4dC5Db25zdW1lcj4gaW5zdGVhZD8nKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQuQ29uc3VtZXI7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBkaXNwbGF5TmFtZTogewogICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiBjb250ZXh0LmRpc3BsYXlOYW1lOwogICAgICAgICAgfSwKICAgICAgICAgIHNldDogZnVuY3Rpb24gKGRpc3BsYXlOYW1lKSB7CiAgICAgICAgICAgIGlmICghaGFzV2FybmVkQWJvdXREaXNwbGF5TmFtZU9uQ29uc3VtZXIpIHsKICAgICAgICAgICAgICB3YXJuKCdTZXR0aW5nIGBkaXNwbGF5TmFtZWAgb24gQ29udGV4dC5Db25zdW1lciBoYXMgbm8gZWZmZWN0LiAnICsgIllvdSBzaG91bGQgc2V0IGl0IGRpcmVjdGx5IG9uIHRoZSBjb250ZXh0IHdpdGggQ29udGV4dC5kaXNwbGF5TmFtZSA9ICclcycuIiwgZGlzcGxheU5hbWUpOwoKICAgICAgICAgICAgICBoYXNXYXJuZWRBYm91dERpc3BsYXlOYW1lT25Db25zdW1lciA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOyAvLyAkRmxvd0ZpeE1lOiBGbG93IGNvbXBsYWlucyBhYm91dCBtaXNzaW5nIHByb3BlcnRpZXMgYmVjYXVzZSBpdCBkb2Vzbid0IHVuZGVyc3RhbmQgZGVmaW5lUHJvcGVydHkKCiAgICAgIGNvbnRleHQuQ29uc3VtZXIgPSBDb25zdW1lcjsKICAgIH0KCiAgICB7CiAgICAgIGNvbnRleHQuX2N1cnJlbnRSZW5kZXJlciA9IG51bGw7CiAgICAgIGNvbnRleHQuX2N1cnJlbnRSZW5kZXJlcjIgPSBudWxsOwogICAgfQoKICAgIHJldHVybiBjb250ZXh0OwogIH0KCiAgdmFyIFVuaW5pdGlhbGl6ZWQgPSAtMTsKICB2YXIgUGVuZGluZyA9IDA7CiAgdmFyIFJlc29sdmVkID0gMTsKICB2YXIgUmVqZWN0ZWQgPSAyOwoKICBmdW5jdGlvbiBsYXp5SW5pdGlhbGl6ZXIocGF5bG9hZCkgewogICAgaWYgKHBheWxvYWQuX3N0YXR1cyA9PT0gVW5pbml0aWFsaXplZCkgewogICAgICB2YXIgY3RvciA9IHBheWxvYWQuX3Jlc3VsdDsKICAgICAgdmFyIHRoZW5hYmxlID0gY3RvcigpOyAvLyBUcmFuc2l0aW9uIHRvIHRoZSBuZXh0IHN0YXRlLgogICAgICAvLyBUaGlzIG1pZ2h0IHRocm93IGVpdGhlciBiZWNhdXNlIGl0J3MgbWlzc2luZyBvciB0aHJvd3MuIElmIHNvLCB3ZSB0cmVhdCBpdAogICAgICAvLyBhcyBzdGlsbCB1bmluaXRpYWxpemVkIGFuZCB0cnkgYWdhaW4gbmV4dCB0aW1lLiBXaGljaCBpcyB0aGUgc2FtZSBhcyB3aGF0CiAgICAgIC8vIGhhcHBlbnMgaWYgdGhlIGN0b3Igb3IgYW55IHdyYXBwZXJzIHByb2Nlc3NpbmcgdGhlIGN0b3IgdGhyb3dzLiBUaGlzIG1pZ2h0CiAgICAgIC8vIGVuZCB1cCBmaXhpbmcgaXQgaWYgdGhlIHJlc29sdXRpb24gd2FzIGEgY29uY3VycmVuY3kgYnVnLgoKICAgICAgdGhlbmFibGUudGhlbihmdW5jdGlvbiAobW9kdWxlT2JqZWN0KSB7CiAgICAgICAgaWYgKHBheWxvYWQuX3N0YXR1cyA9PT0gUGVuZGluZyB8fCBwYXlsb2FkLl9zdGF0dXMgPT09IFVuaW5pdGlhbGl6ZWQpIHsKICAgICAgICAgIC8vIFRyYW5zaXRpb24gdG8gdGhlIG5leHQgc3RhdGUuCiAgICAgICAgICB2YXIgcmVzb2x2ZWQgPSBwYXlsb2FkOwogICAgICAgICAgcmVzb2x2ZWQuX3N0YXR1cyA9IFJlc29sdmVkOwogICAgICAgICAgcmVzb2x2ZWQuX3Jlc3VsdCA9IG1vZHVsZU9iamVjdDsKICAgICAgICB9CiAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIGlmIChwYXlsb2FkLl9zdGF0dXMgPT09IFBlbmRpbmcgfHwgcGF5bG9hZC5fc3RhdHVzID09PSBVbmluaXRpYWxpemVkKSB7CiAgICAgICAgICAvLyBUcmFuc2l0aW9uIHRvIHRoZSBuZXh0IHN0YXRlLgogICAgICAgICAgdmFyIHJlamVjdGVkID0gcGF5bG9hZDsKICAgICAgICAgIHJlamVjdGVkLl9zdGF0dXMgPSBSZWplY3RlZDsKICAgICAgICAgIHJlamVjdGVkLl9yZXN1bHQgPSBlcnJvcjsKICAgICAgICB9CiAgICAgIH0pOwoKICAgICAgaWYgKHBheWxvYWQuX3N0YXR1cyA9PT0gVW5pbml0aWFsaXplZCkgewogICAgICAgIC8vIEluIGNhc2UsIHdlJ3JlIHN0aWxsIHVuaW5pdGlhbGl6ZWQsIHRoZW4gd2UncmUgd2FpdGluZyBmb3IgdGhlIHRoZW5hYmxlCiAgICAgICAgLy8gdG8gcmVzb2x2ZS4gU2V0IGl0IGFzIHBlbmRpbmcgaW4gdGhlIG1lYW50aW1lLgogICAgICAgIHZhciBwZW5kaW5nID0gcGF5bG9hZDsKICAgICAgICBwZW5kaW5nLl9zdGF0dXMgPSBQZW5kaW5nOwogICAgICAgIHBlbmRpbmcuX3Jlc3VsdCA9IHRoZW5hYmxlOwogICAgICB9CiAgICB9CgogICAgaWYgKHBheWxvYWQuX3N0YXR1cyA9PT0gUmVzb2x2ZWQpIHsKICAgICAgdmFyIG1vZHVsZU9iamVjdCA9IHBheWxvYWQuX3Jlc3VsdDsKCiAgICAgIHsKICAgICAgICBpZiAobW9kdWxlT2JqZWN0ID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgIGVycm9yKCdsYXp5OiBFeHBlY3RlZCB0aGUgcmVzdWx0IG9mIGEgZHluYW1pYyBpbXAnICsgJ29ydCgpIGNhbGwuICcgKyAnSW5zdGVhZCByZWNlaXZlZDogJXNcblxuWW91ciBjb2RlIHNob3VsZCBsb29rIGxpa2U6IFxuICAnICsgLy8gQnJlYWsgdXAgaW1wb3J0cyB0byBhdm9pZCBhY2NpZGVudGFsbHkgcGFyc2luZyB0aGVtIGFzIGRlcGVuZGVuY2llcy4KICAgICAgICAgICdjb25zdCBNeUNvbXBvbmVudCA9IGxhenkoKCkgPT4gaW1wJyArICJvcnQoJy4vTXlDb21wb25lbnQnKSlcblxuIiArICdEaWQgeW91IGFjY2lkZW50YWxseSBwdXQgY3VybHkgYnJhY2VzIGFyb3VuZCB0aGUgaW1wb3J0PycsIG1vZHVsZU9iamVjdCk7CiAgICAgICAgfQogICAgICB9CgogICAgICB7CiAgICAgICAgaWYgKCEoJ2RlZmF1bHQnIGluIG1vZHVsZU9iamVjdCkpIHsKICAgICAgICAgIGVycm9yKCdsYXp5OiBFeHBlY3RlZCB0aGUgcmVzdWx0IG9mIGEgZHluYW1pYyBpbXAnICsgJ29ydCgpIGNhbGwuICcgKyAnSW5zdGVhZCByZWNlaXZlZDogJXNcblxuWW91ciBjb2RlIHNob3VsZCBsb29rIGxpa2U6IFxuICAnICsgLy8gQnJlYWsgdXAgaW1wb3J0cyB0byBhdm9pZCBhY2NpZGVudGFsbHkgcGFyc2luZyB0aGVtIGFzIGRlcGVuZGVuY2llcy4KICAgICAgICAgICdjb25zdCBNeUNvbXBvbmVudCA9IGxhenkoKCkgPT4gaW1wJyArICJvcnQoJy4vTXlDb21wb25lbnQnKSkiLCBtb2R1bGVPYmplY3QpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIG1vZHVsZU9iamVjdC5kZWZhdWx0OwogICAgfSBlbHNlIHsKICAgICAgdGhyb3cgcGF5bG9hZC5fcmVzdWx0OwogICAgfQogIH0KCiAgZnVuY3Rpb24gbGF6eShjdG9yKSB7CiAgICB2YXIgcGF5bG9hZCA9IHsKICAgICAgLy8gV2UgdXNlIHRoZXNlIGZpZWxkcyB0byBzdG9yZSB0aGUgcmVzdWx0LgogICAgICBfc3RhdHVzOiBVbmluaXRpYWxpemVkLAogICAgICBfcmVzdWx0OiBjdG9yCiAgICB9OwogICAgdmFyIGxhenlUeXBlID0gewogICAgICAkJHR5cGVvZjogUkVBQ1RfTEFaWV9UWVBFLAogICAgICBfcGF5bG9hZDogcGF5bG9hZCwKICAgICAgX2luaXQ6IGxhenlJbml0aWFsaXplcgogICAgfTsKCiAgICB7CiAgICAgIC8vIEluIHByb2R1Y3Rpb24sIHRoaXMgd291bGQganVzdCBzZXQgaXQgb24gdGhlIG9iamVjdC4KICAgICAgdmFyIGRlZmF1bHRQcm9wczsKICAgICAgdmFyIHByb3BUeXBlczsgLy8gJEZsb3dGaXhNZQoKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMobGF6eVR5cGUsIHsKICAgICAgICBkZWZhdWx0UHJvcHM6IHsKICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gZGVmYXVsdFByb3BzOwogICAgICAgICAgfSwKICAgICAgICAgIHNldDogZnVuY3Rpb24gKG5ld0RlZmF1bHRQcm9wcykgewogICAgICAgICAgICBlcnJvcignUmVhY3QubGF6eSguLi4pOiBJdCBpcyBub3Qgc3VwcG9ydGVkIHRvIGFzc2lnbiBgZGVmYXVsdFByb3BzYCB0byAnICsgJ2EgbGF6eSBjb21wb25lbnQgaW1wb3J0LiBFaXRoZXIgc3BlY2lmeSB0aGVtIHdoZXJlIHRoZSBjb21wb25lbnQgJyArICdpcyBkZWZpbmVkLCBvciBjcmVhdGUgYSB3cmFwcGluZyBjb21wb25lbnQgYXJvdW5kIGl0LicpOwoKICAgICAgICAgICAgZGVmYXVsdFByb3BzID0gbmV3RGVmYXVsdFByb3BzOyAvLyBNYXRjaCBwcm9kdWN0aW9uIGJlaGF2aW9yIG1vcmUgY2xvc2VseToKICAgICAgICAgICAgLy8gJEZsb3dGaXhNZQoKICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGxhenlUeXBlLCAnZGVmYXVsdFByb3BzJywgewogICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBwcm9wVHlwZXM6IHsKICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gcHJvcFR5cGVzOwogICAgICAgICAgfSwKICAgICAgICAgIHNldDogZnVuY3Rpb24gKG5ld1Byb3BUeXBlcykgewogICAgICAgICAgICBlcnJvcignUmVhY3QubGF6eSguLi4pOiBJdCBpcyBub3Qgc3VwcG9ydGVkIHRvIGFzc2lnbiBgcHJvcFR5cGVzYCB0byAnICsgJ2EgbGF6eSBjb21wb25lbnQgaW1wb3J0LiBFaXRoZXIgc3BlY2lmeSB0aGVtIHdoZXJlIHRoZSBjb21wb25lbnQgJyArICdpcyBkZWZpbmVkLCBvciBjcmVhdGUgYSB3cmFwcGluZyBjb21wb25lbnQgYXJvdW5kIGl0LicpOwoKICAgICAgICAgICAgcHJvcFR5cGVzID0gbmV3UHJvcFR5cGVzOyAvLyBNYXRjaCBwcm9kdWN0aW9uIGJlaGF2aW9yIG1vcmUgY2xvc2VseToKICAgICAgICAgICAgLy8gJEZsb3dGaXhNZQoKICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGxhenlUeXBlLCAncHJvcFR5cGVzJywgewogICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KCiAgICByZXR1cm4gbGF6eVR5cGU7CiAgfQoKICBmdW5jdGlvbiBmb3J3YXJkUmVmKHJlbmRlcikgewogICAgewogICAgICBpZiAocmVuZGVyICE9IG51bGwgJiYgcmVuZGVyLiQkdHlwZW9mID09PSBSRUFDVF9NRU1PX1RZUEUpIHsKICAgICAgICBlcnJvcignZm9yd2FyZFJlZiByZXF1aXJlcyBhIHJlbmRlciBmdW5jdGlvbiBidXQgcmVjZWl2ZWQgYSBgbWVtb2AgJyArICdjb21wb25lbnQuIEluc3RlYWQgb2YgZm9yd2FyZFJlZihtZW1vKC4uLikpLCB1c2UgJyArICdtZW1vKGZvcndhcmRSZWYoLi4uKSkuJyk7CiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHJlbmRlciAhPT0gJ2Z1bmN0aW9uJykgewogICAgICAgIGVycm9yKCdmb3J3YXJkUmVmIHJlcXVpcmVzIGEgcmVuZGVyIGZ1bmN0aW9uIGJ1dCB3YXMgZ2l2ZW4gJXMuJywgcmVuZGVyID09PSBudWxsID8gJ251bGwnIDogdHlwZW9mIHJlbmRlcik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKHJlbmRlci5sZW5ndGggIT09IDAgJiYgcmVuZGVyLmxlbmd0aCAhPT0gMikgewogICAgICAgICAgZXJyb3IoJ2ZvcndhcmRSZWYgcmVuZGVyIGZ1bmN0aW9ucyBhY2NlcHQgZXhhY3RseSB0d28gcGFyYW1ldGVyczogcHJvcHMgYW5kIHJlZi4gJXMnLCByZW5kZXIubGVuZ3RoID09PSAxID8gJ0RpZCB5b3UgZm9yZ2V0IHRvIHVzZSB0aGUgcmVmIHBhcmFtZXRlcj8nIDogJ0FueSBhZGRpdGlvbmFsIHBhcmFtZXRlciB3aWxsIGJlIHVuZGVmaW5lZC4nKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChyZW5kZXIgIT0gbnVsbCkgewogICAgICAgIGlmIChyZW5kZXIuZGVmYXVsdFByb3BzICE9IG51bGwgfHwgcmVuZGVyLnByb3BUeXBlcyAhPSBudWxsKSB7CiAgICAgICAgICBlcnJvcignZm9yd2FyZFJlZiByZW5kZXIgZnVuY3Rpb25zIGRvIG5vdCBzdXBwb3J0IHByb3BUeXBlcyBvciBkZWZhdWx0UHJvcHMuICcgKyAnRGlkIHlvdSBhY2NpZGVudGFsbHkgcGFzcyBhIFJlYWN0IGNvbXBvbmVudD8nKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICB2YXIgZWxlbWVudFR5cGUgPSB7CiAgICAgICQkdHlwZW9mOiBSRUFDVF9GT1JXQVJEX1JFRl9UWVBFLAogICAgICByZW5kZXI6IHJlbmRlcgogICAgfTsKCiAgICB7CiAgICAgIHZhciBvd25OYW1lOwogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZWxlbWVudFR5cGUsICdkaXNwbGF5TmFtZScsIHsKICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSwKICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gb3duTmFtZTsKICAgICAgICB9LAogICAgICAgIHNldDogZnVuY3Rpb24gKG5hbWUpIHsKICAgICAgICAgIG93bk5hbWUgPSBuYW1lOyAvLyBUaGUgaW5uZXIgY29tcG9uZW50IHNob3VsZG4ndCBpbmhlcml0IHRoaXMgZGlzcGxheSBuYW1lIGluIG1vc3QgY2FzZXMsCiAgICAgICAgICAvLyBiZWNhdXNlIHRoZSBjb21wb25lbnQgbWF5IGJlIHVzZWQgZWxzZXdoZXJlLgogICAgICAgICAgLy8gQnV0IGl0J3MgbmljZSBmb3IgYW5vbnltb3VzIGZ1bmN0aW9ucyB0byBpbmhlcml0IHRoZSBuYW1lLAogICAgICAgICAgLy8gc28gdGhhdCBvdXIgY29tcG9uZW50LXN0YWNrIGdlbmVyYXRpb24gbG9naWMgd2lsbCBkaXNwbGF5IHRoZWlyIGZyYW1lcy4KICAgICAgICAgIC8vIEFuIGFub255bW91cyBmdW5jdGlvbiBnZW5lcmFsbHkgc3VnZ2VzdHMgYSBwYXR0ZXJuIGxpa2U6CiAgICAgICAgICAvLyAgIFJlYWN0LmZvcndhcmRSZWYoKHByb3BzLCByZWYpID0+IHsuLi59KTsKICAgICAgICAgIC8vIFRoaXMga2luZCBvZiBpbm5lciBmdW5jdGlvbiBpcyBub3QgdXNlZCBlbHNld2hlcmUgc28gdGhlIHNpZGUgZWZmZWN0IGlzIG9rYXkuCgogICAgICAgICAgaWYgKCFyZW5kZXIubmFtZSAmJiAhcmVuZGVyLmRpc3BsYXlOYW1lKSB7CiAgICAgICAgICAgIHJlbmRlci5kaXNwbGF5TmFtZSA9IG5hbWU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KCiAgICByZXR1cm4gZWxlbWVudFR5cGU7CiAgfQoKICB2YXIgUkVBQ1RfTU9EVUxFX1JFRkVSRU5DRTsKCiAgewogICAgUkVBQ1RfTU9EVUxFX1JFRkVSRU5DRSA9IFN5bWJvbC5mb3IoJ3JlYWN0Lm1vZHVsZS5yZWZlcmVuY2UnKTsKICB9CgogIGZ1bmN0aW9uIGlzVmFsaWRFbGVtZW50VHlwZSh0eXBlKSB7CiAgICBpZiAodHlwZW9mIHR5cGUgPT09ICdzdHJpbmcnIHx8IHR5cGVvZiB0eXBlID09PSAnZnVuY3Rpb24nKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfSAvLyBOb3RlOiB0eXBlb2YgbWlnaHQgYmUgb3RoZXIgdGhhbiAnc3ltYm9sJyBvciAnbnVtYmVyJyAoZS5nLiBpZiBpdCdzIGEgcG9seWZpbGwpLgoKCiAgICBpZiAodHlwZSA9PT0gUkVBQ1RfRlJBR01FTlRfVFlQRSB8fCB0eXBlID09PSBSRUFDVF9QUk9GSUxFUl9UWVBFIHx8IGVuYWJsZURlYnVnVHJhY2luZyAgfHwgdHlwZSA9PT0gUkVBQ1RfU1RSSUNUX01PREVfVFlQRSB8fCB0eXBlID09PSBSRUFDVF9TVVNQRU5TRV9UWVBFIHx8IHR5cGUgPT09IFJFQUNUX1NVU1BFTlNFX0xJU1RfVFlQRSB8fCBlbmFibGVMZWdhY3lIaWRkZW4gIHx8IHR5cGUgPT09IFJFQUNUX09GRlNDUkVFTl9UWVBFIHx8IGVuYWJsZVNjb3BlQVBJICB8fCBlbmFibGVDYWNoZUVsZW1lbnQgIHx8IGVuYWJsZVRyYW5zaXRpb25UcmFjaW5nICkgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBpZiAodHlwZW9mIHR5cGUgPT09ICdvYmplY3QnICYmIHR5cGUgIT09IG51bGwpIHsKICAgICAgaWYgKHR5cGUuJCR0eXBlb2YgPT09IFJFQUNUX0xBWllfVFlQRSB8fCB0eXBlLiQkdHlwZW9mID09PSBSRUFDVF9NRU1PX1RZUEUgfHwgdHlwZS4kJHR5cGVvZiA9PT0gUkVBQ1RfUFJPVklERVJfVFlQRSB8fCB0eXBlLiQkdHlwZW9mID09PSBSRUFDVF9DT05URVhUX1RZUEUgfHwgdHlwZS4kJHR5cGVvZiA9PT0gUkVBQ1RfRk9SV0FSRF9SRUZfVFlQRSB8fCAvLyBUaGlzIG5lZWRzIHRvIGluY2x1ZGUgYWxsIHBvc3NpYmxlIG1vZHVsZSByZWZlcmVuY2Ugb2JqZWN0CiAgICAgIC8vIHR5cGVzIHN1cHBvcnRlZCBieSBhbnkgRmxpZ2h0IGNvbmZpZ3VyYXRpb24gYW55d2hlcmUgc2luY2UKICAgICAgLy8gd2UgZG9uJ3Qga25vdyB3aGljaCBGbGlnaHQgYnVpbGQgdGhpcyB3aWxsIGVuZCB1cCBiZWluZyB1c2VkCiAgICAgIC8vIHdpdGguCiAgICAgIHR5cGUuJCR0eXBlb2YgPT09IFJFQUNUX01PRFVMRV9SRUZFUkVOQ0UgfHwgdHlwZS5nZXRNb2R1bGVJZCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICBmdW5jdGlvbiBtZW1vKHR5cGUsIGNvbXBhcmUpIHsKICAgIHsKICAgICAgaWYgKCFpc1ZhbGlkRWxlbWVudFR5cGUodHlwZSkpIHsKICAgICAgICBlcnJvcignbWVtbzogVGhlIGZpcnN0IGFyZ3VtZW50IG11c3QgYmUgYSBjb21wb25lbnQuIEluc3RlYWQgJyArICdyZWNlaXZlZDogJXMnLCB0eXBlID09PSBudWxsID8gJ251bGwnIDogdHlwZW9mIHR5cGUpOwogICAgICB9CiAgICB9CgogICAgdmFyIGVsZW1lbnRUeXBlID0gewogICAgICAkJHR5cGVvZjogUkVBQ1RfTUVNT19UWVBFLAogICAgICB0eXBlOiB0eXBlLAogICAgICBjb21wYXJlOiBjb21wYXJlID09PSB1bmRlZmluZWQgPyBudWxsIDogY29tcGFyZQogICAgfTsKCiAgICB7CiAgICAgIHZhciBvd25OYW1lOwogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZWxlbWVudFR5cGUsICdkaXNwbGF5TmFtZScsIHsKICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSwKICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gb3duTmFtZTsKICAgICAgICB9LAogICAgICAgIHNldDogZnVuY3Rpb24gKG5hbWUpIHsKICAgICAgICAgIG93bk5hbWUgPSBuYW1lOyAvLyBUaGUgaW5uZXIgY29tcG9uZW50IHNob3VsZG4ndCBpbmhlcml0IHRoaXMgZGlzcGxheSBuYW1lIGluIG1vc3QgY2FzZXMsCiAgICAgICAgICAvLyBiZWNhdXNlIHRoZSBjb21wb25lbnQgbWF5IGJlIHVzZWQgZWxzZXdoZXJlLgogICAgICAgICAgLy8gQnV0IGl0J3MgbmljZSBmb3IgYW5vbnltb3VzIGZ1bmN0aW9ucyB0byBpbmhlcml0IHRoZSBuYW1lLAogICAgICAgICAgLy8gc28gdGhhdCBvdXIgY29tcG9uZW50LXN0YWNrIGdlbmVyYXRpb24gbG9naWMgd2lsbCBkaXNwbGF5IHRoZWlyIGZyYW1lcy4KICAgICAgICAgIC8vIEFuIGFub255bW91cyBmdW5jdGlvbiBnZW5lcmFsbHkgc3VnZ2VzdHMgYSBwYXR0ZXJuIGxpa2U6CiAgICAgICAgICAvLyAgIFJlYWN0Lm1lbW8oKHByb3BzKSA9PiB7Li4ufSk7CiAgICAgICAgICAvLyBUaGlzIGtpbmQgb2YgaW5uZXIgZnVuY3Rpb24gaXMgbm90IHVzZWQgZWxzZXdoZXJlIHNvIHRoZSBzaWRlIGVmZmVjdCBpcyBva2F5LgoKICAgICAgICAgIGlmICghdHlwZS5uYW1lICYmICF0eXBlLmRpc3BsYXlOYW1lKSB7CiAgICAgICAgICAgIHR5cGUuZGlzcGxheU5hbWUgPSBuYW1lOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9CgogICAgcmV0dXJuIGVsZW1lbnRUeXBlOwogIH0KCiAgZnVuY3Rpb24gcmVzb2x2ZURpc3BhdGNoZXIoKSB7CiAgICB2YXIgZGlzcGF0Y2hlciA9IFJlYWN0Q3VycmVudERpc3BhdGNoZXIuY3VycmVudDsKCiAgICB7CiAgICAgIGlmIChkaXNwYXRjaGVyID09PSBudWxsKSB7CiAgICAgICAgZXJyb3IoJ0ludmFsaWQgaG9vayBjYWxsLiBIb29rcyBjYW4gb25seSBiZSBjYWxsZWQgaW5zaWRlIG9mIHRoZSBib2R5IG9mIGEgZnVuY3Rpb24gY29tcG9uZW50LiBUaGlzIGNvdWxkIGhhcHBlbiBmb3InICsgJyBvbmUgb2YgdGhlIGZvbGxvd2luZyByZWFzb25zOlxuJyArICcxLiBZb3UgbWlnaHQgaGF2ZSBtaXNtYXRjaGluZyB2ZXJzaW9ucyBvZiBSZWFjdCBhbmQgdGhlIHJlbmRlcmVyIChzdWNoIGFzIFJlYWN0IERPTSlcbicgKyAnMi4gWW91IG1pZ2h0IGJlIGJyZWFraW5nIHRoZSBSdWxlcyBvZiBIb29rc1xuJyArICczLiBZb3UgbWlnaHQgaGF2ZSBtb3JlIHRoYW4gb25lIGNvcHkgb2YgUmVhY3QgaW4gdGhlIHNhbWUgYXBwXG4nICsgJ1NlZSBodHRwczovL3JlYWN0anMub3JnL2xpbmsvaW52YWxpZC1ob29rLWNhbGwgZm9yIHRpcHMgYWJvdXQgaG93IHRvIGRlYnVnIGFuZCBmaXggdGhpcyBwcm9ibGVtLicpOwogICAgICB9CiAgICB9IC8vIFdpbGwgcmVzdWx0IGluIGEgbnVsbCBhY2Nlc3MgZXJyb3IgaWYgYWNjZXNzZWQgb3V0c2lkZSByZW5kZXIgcGhhc2UuIFdlCiAgICAvLyBpbnRlbnRpb25hbGx5IGRvbid0IHRocm93IG91ciBvd24gZXJyb3IgYmVjYXVzZSB0aGlzIGlzIGluIGEgaG90IHBhdGguCiAgICAvLyBBbHNvIGhlbHBzIGVuc3VyZSB0aGlzIGlzIGlubGluZWQuCgoKICAgIHJldHVybiBkaXNwYXRjaGVyOwogIH0KICBmdW5jdGlvbiB1c2VDb250ZXh0KENvbnRleHQpIHsKICAgIHZhciBkaXNwYXRjaGVyID0gcmVzb2x2ZURpc3BhdGNoZXIoKTsKCiAgICB7CiAgICAgIC8vIFRPRE86IGFkZCBhIG1vcmUgZ2VuZXJpYyB3YXJuaW5nIGZvciBpbnZhbGlkIHZhbHVlcy4KICAgICAgaWYgKENvbnRleHQuX2NvbnRleHQgIT09IHVuZGVmaW5lZCkgewogICAgICAgIHZhciByZWFsQ29udGV4dCA9IENvbnRleHQuX2NvbnRleHQ7IC8vIERvbid0IGRlZHVwbGljYXRlIGJlY2F1c2UgdGhpcyBsZWdpdGltYXRlbHkgY2F1c2VzIGJ1Z3MKICAgICAgICAvLyBhbmQgbm9ib2R5IHNob3VsZCBiZSB1c2luZyB0aGlzIGluIGV4aXN0aW5nIGNvZGUuCgogICAgICAgIGlmIChyZWFsQ29udGV4dC5Db25zdW1lciA9PT0gQ29udGV4dCkgewogICAgICAgICAgZXJyb3IoJ0NhbGxpbmcgdXNlQ29udGV4dChDb250ZXh0LkNvbnN1bWVyKSBpcyBub3Qgc3VwcG9ydGVkLCBtYXkgY2F1c2UgYnVncywgYW5kIHdpbGwgYmUgJyArICdyZW1vdmVkIGluIGEgZnV0dXJlIG1ham9yIHJlbGVhc2UuIERpZCB5b3UgbWVhbiB0byBjYWxsIHVzZUNvbnRleHQoQ29udGV4dCkgaW5zdGVhZD8nKTsKICAgICAgICB9IGVsc2UgaWYgKHJlYWxDb250ZXh0LlByb3ZpZGVyID09PSBDb250ZXh0KSB7CiAgICAgICAgICBlcnJvcignQ2FsbGluZyB1c2VDb250ZXh0KENvbnRleHQuUHJvdmlkZXIpIGlzIG5vdCBzdXBwb3J0ZWQuICcgKyAnRGlkIHlvdSBtZWFuIHRvIGNhbGwgdXNlQ29udGV4dChDb250ZXh0KSBpbnN0ZWFkPycpOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHJldHVybiBkaXNwYXRjaGVyLnVzZUNvbnRleHQoQ29udGV4dCk7CiAgfQogIGZ1bmN0aW9uIHVzZVN0YXRlKGluaXRpYWxTdGF0ZSkgewogICAgdmFyIGRpc3BhdGNoZXIgPSByZXNvbHZlRGlzcGF0Y2hlcigpOwogICAgcmV0dXJuIGRpc3BhdGNoZXIudXNlU3RhdGUoaW5pdGlhbFN0YXRlKTsKICB9CiAgZnVuY3Rpb24gdXNlUmVkdWNlcihyZWR1Y2VyLCBpbml0aWFsQXJnLCBpbml0KSB7CiAgICB2YXIgZGlzcGF0Y2hlciA9IHJlc29sdmVEaXNwYXRjaGVyKCk7CiAgICByZXR1cm4gZGlzcGF0Y2hlci51c2VSZWR1Y2VyKHJlZHVjZXIsIGluaXRpYWxBcmcsIGluaXQpOwogIH0KICBmdW5jdGlvbiB1c2VSZWYoaW5pdGlhbFZhbHVlKSB7CiAgICB2YXIgZGlzcGF0Y2hlciA9IHJlc29sdmVEaXNwYXRjaGVyKCk7CiAgICByZXR1cm4gZGlzcGF0Y2hlci51c2VSZWYoaW5pdGlhbFZhbHVlKTsKICB9CiAgZnVuY3Rpb24gdXNlRWZmZWN0KGNyZWF0ZSwgZGVwcykgewogICAgdmFyIGRpc3BhdGNoZXIgPSByZXNvbHZlRGlzcGF0Y2hlcigpOwogICAgcmV0dXJuIGRpc3BhdGNoZXIudXNlRWZmZWN0KGNyZWF0ZSwgZGVwcyk7CiAgfQogIGZ1bmN0aW9uIHVzZUluc2VydGlvbkVmZmVjdChjcmVhdGUsIGRlcHMpIHsKICAgIHZhciBkaXNwYXRjaGVyID0gcmVzb2x2ZURpc3BhdGNoZXIoKTsKICAgIHJldHVybiBkaXNwYXRjaGVyLnVzZUluc2VydGlvbkVmZmVjdChjcmVhdGUsIGRlcHMpOwogIH0KICBmdW5jdGlvbiB1c2VMYXlvdXRFZmZlY3QoY3JlYXRlLCBkZXBzKSB7CiAgICB2YXIgZGlzcGF0Y2hlciA9IHJlc29sdmVEaXNwYXRjaGVyKCk7CiAgICByZXR1cm4gZGlzcGF0Y2hlci51c2VMYXlvdXRFZmZlY3QoY3JlYXRlLCBkZXBzKTsKICB9CiAgZnVuY3Rpb24gdXNlQ2FsbGJhY2soY2FsbGJhY2ssIGRlcHMpIHsKICAgIHZhciBkaXNwYXRjaGVyID0gcmVzb2x2ZURpc3BhdGNoZXIoKTsKICAgIHJldHVybiBkaXNwYXRjaGVyLnVzZUNhbGxiYWNrKGNhbGxiYWNrLCBkZXBzKTsKICB9CiAgZnVuY3Rpb24gdXNlTWVtbyhjcmVhdGUsIGRlcHMpIHsKICAgIHZhciBkaXNwYXRjaGVyID0gcmVzb2x2ZURpc3BhdGNoZXIoKTsKICAgIHJldHVybiBkaXNwYXRjaGVyLnVzZU1lbW8oY3JlYXRlLCBkZXBzKTsKICB9CiAgZnVuY3Rpb24gdXNlSW1wZXJhdGl2ZUhhbmRsZShyZWYsIGNyZWF0ZSwgZGVwcykgewogICAgdmFyIGRpc3BhdGNoZXIgPSByZXNvbHZlRGlzcGF0Y2hlcigpOwogICAgcmV0dXJuIGRpc3BhdGNoZXIudXNlSW1wZXJhdGl2ZUhhbmRsZShyZWYsIGNyZWF0ZSwgZGVwcyk7CiAgfQogIGZ1bmN0aW9uIHVzZURlYnVnVmFsdWUodmFsdWUsIGZvcm1hdHRlckZuKSB7CiAgICB7CiAgICAgIHZhciBkaXNwYXRjaGVyID0gcmVzb2x2ZURpc3BhdGNoZXIoKTsKICAgICAgcmV0dXJuIGRpc3BhdGNoZXIudXNlRGVidWdWYWx1ZSh2YWx1ZSwgZm9ybWF0dGVyRm4pOwogICAgfQogIH0KICBmdW5jdGlvbiB1c2VUcmFuc2l0aW9uKCkgewogICAgdmFyIGRpc3BhdGNoZXIgPSByZXNvbHZlRGlzcGF0Y2hlcigpOwogICAgcmV0dXJuIGRpc3BhdGNoZXIudXNlVHJhbnNpdGlvbigpOwogIH0KICBmdW5jdGlvbiB1c2VEZWZlcnJlZFZhbHVlKHZhbHVlKSB7CiAgICB2YXIgZGlzcGF0Y2hlciA9IHJlc29sdmVEaXNwYXRjaGVyKCk7CiAgICByZXR1cm4gZGlzcGF0Y2hlci51c2VEZWZlcnJlZFZhbHVlKHZhbHVlKTsKICB9CiAgZnVuY3Rpb24gdXNlSWQoKSB7CiAgICB2YXIgZGlzcGF0Y2hlciA9IHJlc29sdmVEaXNwYXRjaGVyKCk7CiAgICByZXR1cm4gZGlzcGF0Y2hlci51c2VJZCgpOwogIH0KICBmdW5jdGlvbiB1c2VTeW5jRXh0ZXJuYWxTdG9yZShzdWJzY3JpYmUsIGdldFNuYXBzaG90LCBnZXRTZXJ2ZXJTbmFwc2hvdCkgewogICAgdmFyIGRpc3BhdGNoZXIgPSByZXNvbHZlRGlzcGF0Y2hlcigpOwogICAgcmV0dXJuIGRpc3BhdGNoZXIudXNlU3luY0V4dGVybmFsU3RvcmUoc3Vic2NyaWJlLCBnZXRTbmFwc2hvdCwgZ2V0U2VydmVyU25hcHNob3QpOwogIH0KCiAgLy8gSGVscGVycyB0byBwYXRjaCBjb25zb2xlLmxvZ3MgdG8gYXZvaWQgbG9nZ2luZyBkdXJpbmcgc2lkZS1lZmZlY3QgZnJlZQogIC8vIHJlcGxheWluZyBvbiByZW5kZXIgZnVuY3Rpb24uIFRoaXMgY3VycmVudGx5IG9ubHkgcGF0Y2hlcyB0aGUgb2JqZWN0CiAgLy8gbGF6aWx5IHdoaWNoIHdvbid0IGNvdmVyIGlmIHRoZSBsb2cgZnVuY3Rpb24gd2FzIGV4dHJhY3RlZCBlYWdlcmx5LgogIC8vIFdlIGNvdWxkIGFsc28gZWFnZXJseSBwYXRjaCB0aGUgbWV0aG9kLgogIHZhciBkaXNhYmxlZERlcHRoID0gMDsKICB2YXIgcHJldkxvZzsKICB2YXIgcHJldkluZm87CiAgdmFyIHByZXZXYXJuOwogIHZhciBwcmV2RXJyb3I7CiAgdmFyIHByZXZHcm91cDsKICB2YXIgcHJldkdyb3VwQ29sbGFwc2VkOwogIHZhciBwcmV2R3JvdXBFbmQ7CgogIGZ1bmN0aW9uIGRpc2FibGVkTG9nKCkge30KCiAgZGlzYWJsZWRMb2cuX19yZWFjdERpc2FibGVkTG9nID0gdHJ1ZTsKICBmdW5jdGlvbiBkaXNhYmxlTG9ncygpIHsKICAgIHsKICAgICAgaWYgKGRpc2FibGVkRGVwdGggPT09IDApIHsKICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSByZWFjdC1pbnRlcm5hbC9uby1wcm9kdWN0aW9uLWxvZ2dpbmcgKi8KICAgICAgICBwcmV2TG9nID0gY29uc29sZS5sb2c7CiAgICAgICAgcHJldkluZm8gPSBjb25zb2xlLmluZm87CiAgICAgICAgcHJldldhcm4gPSBjb25zb2xlLndhcm47CiAgICAgICAgcHJldkVycm9yID0gY29uc29sZS5lcnJvcjsKICAgICAgICBwcmV2R3JvdXAgPSBjb25zb2xlLmdyb3VwOwogICAgICAgIHByZXZHcm91cENvbGxhcHNlZCA9IGNvbnNvbGUuZ3JvdXBDb2xsYXBzZWQ7CiAgICAgICAgcHJldkdyb3VwRW5kID0gY29uc29sZS5ncm91cEVuZDsgLy8gaHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL3JlYWN0L2lzc3Vlcy8xOTA5OQoKICAgICAgICB2YXIgcHJvcHMgPSB7CiAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgdmFsdWU6IGRpc2FibGVkTG9nLAogICAgICAgICAgd3JpdGFibGU6IHRydWUKICAgICAgICB9OyAvLyAkRmxvd0ZpeE1lIEZsb3cgdGhpbmtzIGNvbnNvbGUgaXMgaW1tdXRhYmxlLgoKICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhjb25zb2xlLCB7CiAgICAgICAgICBpbmZvOiBwcm9wcywKICAgICAgICAgIGxvZzogcHJvcHMsCiAgICAgICAgICB3YXJuOiBwcm9wcywKICAgICAgICAgIGVycm9yOiBwcm9wcywKICAgICAgICAgIGdyb3VwOiBwcm9wcywKICAgICAgICAgIGdyb3VwQ29sbGFwc2VkOiBwcm9wcywKICAgICAgICAgIGdyb3VwRW5kOiBwcm9wcwogICAgICAgIH0pOwogICAgICAgIC8qIGVzbGludC1lbmFibGUgcmVhY3QtaW50ZXJuYWwvbm8tcHJvZHVjdGlvbi1sb2dnaW5nICovCiAgICAgIH0KCiAgICAgIGRpc2FibGVkRGVwdGgrKzsKICAgIH0KICB9CiAgZnVuY3Rpb24gcmVlbmFibGVMb2dzKCkgewogICAgewogICAgICBkaXNhYmxlZERlcHRoLS07CgogICAgICBpZiAoZGlzYWJsZWREZXB0aCA9PT0gMCkgewogICAgICAgIC8qIGVzbGludC1kaXNhYmxlIHJlYWN0LWludGVybmFsL25vLXByb2R1Y3Rpb24tbG9nZ2luZyAqLwogICAgICAgIHZhciBwcm9wcyA9IHsKICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICB3cml0YWJsZTogdHJ1ZQogICAgICAgIH07IC8vICRGbG93Rml4TWUgRmxvdyB0aGlua3MgY29uc29sZSBpcyBpbW11dGFibGUuCgogICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGNvbnNvbGUsIHsKICAgICAgICAgIGxvZzogYXNzaWduKHt9LCBwcm9wcywgewogICAgICAgICAgICB2YWx1ZTogcHJldkxvZwogICAgICAgICAgfSksCiAgICAgICAgICBpbmZvOiBhc3NpZ24oe30sIHByb3BzLCB7CiAgICAgICAgICAgIHZhbHVlOiBwcmV2SW5mbwogICAgICAgICAgfSksCiAgICAgICAgICB3YXJuOiBhc3NpZ24oe30sIHByb3BzLCB7CiAgICAgICAgICAgIHZhbHVlOiBwcmV2V2FybgogICAgICAgICAgfSksCiAgICAgICAgICBlcnJvcjogYXNzaWduKHt9LCBwcm9wcywgewogICAgICAgICAgICB2YWx1ZTogcHJldkVycm9yCiAgICAgICAgICB9KSwKICAgICAgICAgIGdyb3VwOiBhc3NpZ24oe30sIHByb3BzLCB7CiAgICAgICAgICAgIHZhbHVlOiBwcmV2R3JvdXAKICAgICAgICAgIH0pLAogICAgICAgICAgZ3JvdXBDb2xsYXBzZWQ6IGFzc2lnbih7fSwgcHJvcHMsIHsKICAgICAgICAgICAgdmFsdWU6IHByZXZHcm91cENvbGxhcHNlZAogICAgICAgICAgfSksCiAgICAgICAgICBncm91cEVuZDogYXNzaWduKHt9LCBwcm9wcywgewogICAgICAgICAgICB2YWx1ZTogcHJldkdyb3VwRW5kCiAgICAgICAgICB9KQogICAgICAgIH0pOwogICAgICAgIC8qIGVzbGludC1lbmFibGUgcmVhY3QtaW50ZXJuYWwvbm8tcHJvZHVjdGlvbi1sb2dnaW5nICovCiAgICAgIH0KCiAgICAgIGlmIChkaXNhYmxlZERlcHRoIDwgMCkgewogICAgICAgIGVycm9yKCdkaXNhYmxlZERlcHRoIGZlbGwgYmVsb3cgemVyby4gJyArICdUaGlzIGlzIGEgYnVnIGluIFJlYWN0LiBQbGVhc2UgZmlsZSBhbiBpc3N1ZS4nKTsKICAgICAgfQogICAgfQogIH0KCiAgdmFyIFJlYWN0Q3VycmVudERpc3BhdGNoZXIkMSA9IFJlYWN0U2hhcmVkSW50ZXJuYWxzLlJlYWN0Q3VycmVudERpc3BhdGNoZXI7CiAgdmFyIHByZWZpeDsKICBmdW5jdGlvbiBkZXNjcmliZUJ1aWx0SW5Db21wb25lbnRGcmFtZShuYW1lLCBzb3VyY2UsIG93bmVyRm4pIHsKICAgIHsKICAgICAgaWYgKHByZWZpeCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgLy8gRXh0cmFjdCB0aGUgVk0gc3BlY2lmaWMgcHJlZml4IHVzZWQgYnkgZWFjaCBsaW5lLgogICAgICAgIHRyeSB7CiAgICAgICAgICB0aHJvdyBFcnJvcigpOwogICAgICAgIH0gY2F0Y2ggKHgpIHsKICAgICAgICAgIHZhciBtYXRjaCA9IHguc3RhY2sudHJpbSgpLm1hdGNoKC9cbiggKihhdCApPykvKTsKICAgICAgICAgIHByZWZpeCA9IG1hdGNoICYmIG1hdGNoWzFdIHx8ICcnOwogICAgICAgIH0KICAgICAgfSAvLyBXZSB1c2UgdGhlIHByZWZpeCB0byBlbnN1cmUgb3VyIHN0YWNrcyBsaW5lIHVwIHdpdGggbmF0aXZlIHN0YWNrIGZyYW1lcy4KCgogICAgICByZXR1cm4gJ1xuJyArIHByZWZpeCArIG5hbWU7CiAgICB9CiAgfQogIHZhciByZWVudHJ5ID0gZmFsc2U7CiAgdmFyIGNvbXBvbmVudEZyYW1lQ2FjaGU7CgogIHsKICAgIHZhciBQb3NzaWJseVdlYWtNYXAgPSB0eXBlb2YgV2Vha01hcCA9PT0gJ2Z1bmN0aW9uJyA/IFdlYWtNYXAgOiBNYXA7CiAgICBjb21wb25lbnRGcmFtZUNhY2hlID0gbmV3IFBvc3NpYmx5V2Vha01hcCgpOwogIH0KCiAgZnVuY3Rpb24gZGVzY3JpYmVOYXRpdmVDb21wb25lbnRGcmFtZShmbiwgY29uc3RydWN0KSB7CiAgICAvLyBJZiBzb21ldGhpbmcgYXNrZWQgZm9yIGEgc3RhY2sgaW5zaWRlIGEgZmFrZSByZW5kZXIsIGl0IHNob3VsZCBnZXQgaWdub3JlZC4KICAgIGlmICggIWZuIHx8IHJlZW50cnkpIHsKICAgICAgcmV0dXJuICcnOwogICAgfQoKICAgIHsKICAgICAgdmFyIGZyYW1lID0gY29tcG9uZW50RnJhbWVDYWNoZS5nZXQoZm4pOwoKICAgICAgaWYgKGZyYW1lICE9PSB1bmRlZmluZWQpIHsKICAgICAgICByZXR1cm4gZnJhbWU7CiAgICAgIH0KICAgIH0KCiAgICB2YXIgY29udHJvbDsKICAgIHJlZW50cnkgPSB0cnVlOwogICAgdmFyIHByZXZpb3VzUHJlcGFyZVN0YWNrVHJhY2UgPSBFcnJvci5wcmVwYXJlU3RhY2tUcmFjZTsgLy8gJEZsb3dGaXhNZSBJdCBkb2VzIGFjY2VwdCB1bmRlZmluZWQuCgogICAgRXJyb3IucHJlcGFyZVN0YWNrVHJhY2UgPSB1bmRlZmluZWQ7CiAgICB2YXIgcHJldmlvdXNEaXNwYXRjaGVyOwoKICAgIHsKICAgICAgcHJldmlvdXNEaXNwYXRjaGVyID0gUmVhY3RDdXJyZW50RGlzcGF0Y2hlciQxLmN1cnJlbnQ7IC8vIFNldCB0aGUgZGlzcGF0Y2hlciBpbiBERVYgYmVjYXVzZSB0aGlzIG1pZ2h0IGJlIGNhbGwgaW4gdGhlIHJlbmRlciBmdW5jdGlvbgogICAgICAvLyBmb3Igd2FybmluZ3MuCgogICAgICBSZWFjdEN1cnJlbnREaXNwYXRjaGVyJDEuY3VycmVudCA9IG51bGw7CiAgICAgIGRpc2FibGVMb2dzKCk7CiAgICB9CgogICAgdHJ5IHsKICAgICAgLy8gVGhpcyBzaG91bGQgdGhyb3cuCiAgICAgIGlmIChjb25zdHJ1Y3QpIHsKICAgICAgICAvLyBTb21ldGhpbmcgc2hvdWxkIGJlIHNldHRpbmcgdGhlIHByb3BzIGluIHRoZSBjb25zdHJ1Y3Rvci4KICAgICAgICB2YXIgRmFrZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHRocm93IEVycm9yKCk7CiAgICAgICAgfTsgLy8gJEZsb3dGaXhNZQoKCiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZha2UucHJvdG90eXBlLCAncHJvcHMnLCB7CiAgICAgICAgICBzZXQ6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgLy8gV2UgdXNlIGEgdGhyb3dpbmcgc2V0dGVyIGluc3RlYWQgb2YgZnJvemVuIG9yIG5vbi13cml0YWJsZSBwcm9wcwogICAgICAgICAgICAvLyBiZWNhdXNlIHRoYXQgd29uJ3QgdGhyb3cgaW4gYSBub24tc3RyaWN0IG1vZGUgZnVuY3Rpb24uCiAgICAgICAgICAgIHRocm93IEVycm9yKCk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gJ29iamVjdCcgJiYgUmVmbGVjdC5jb25zdHJ1Y3QpIHsKICAgICAgICAgIC8vIFdlIGNvbnN0cnVjdCBhIGRpZmZlcmVudCBjb250cm9sIGZvciB0aGlzIGNhc2UgdG8gaW5jbHVkZSBhbnkgZXh0cmEKICAgICAgICAgIC8vIGZyYW1lcyBhZGRlZCBieSB0aGUgY29uc3RydWN0IGNhbGwuCiAgICAgICAgICB0cnkgewogICAgICAgICAgICBSZWZsZWN0LmNvbnN0cnVjdChGYWtlLCBbXSk7CiAgICAgICAgICB9IGNhdGNoICh4KSB7CiAgICAgICAgICAgIGNvbnRyb2wgPSB4OwogICAgICAgICAgfQoKICAgICAgICAgIFJlZmxlY3QuY29uc3RydWN0KGZuLCBbXSwgRmFrZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIEZha2UuY2FsbCgpOwogICAgICAgICAgfSBjYXRjaCAoeCkgewogICAgICAgICAgICBjb250cm9sID0geDsKICAgICAgICAgIH0KCiAgICAgICAgICBmbi5jYWxsKEZha2UucHJvdG90eXBlKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIHRocm93IEVycm9yKCk7CiAgICAgICAgfSBjYXRjaCAoeCkgewogICAgICAgICAgY29udHJvbCA9IHg7CiAgICAgICAgfQoKICAgICAgICBmbigpOwogICAgICB9CiAgICB9IGNhdGNoIChzYW1wbGUpIHsKICAgICAgLy8gVGhpcyBpcyBpbmxpbmVkIG1hbnVhbGx5IGJlY2F1c2UgY2xvc3VyZSBkb2Vzbid0IGRvIGl0IGZvciB1cy4KICAgICAgaWYgKHNhbXBsZSAmJiBjb250cm9sICYmIHR5cGVvZiBzYW1wbGUuc3RhY2sgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgLy8gVGhpcyBleHRyYWN0cyB0aGUgZmlyc3QgZnJhbWUgZnJvbSB0aGUgc2FtcGxlIHRoYXQgaXNuJ3QgYWxzbyBpbiB0aGUgY29udHJvbC4KICAgICAgICAvLyBTa2lwcGluZyBvbmUgZnJhbWUgdGhhdCB3ZSBhc3N1bWUgaXMgdGhlIGZyYW1lIHRoYXQgY2FsbHMgdGhlIHR3by4KICAgICAgICB2YXIgc2FtcGxlTGluZXMgPSBzYW1wbGUuc3RhY2suc3BsaXQoJ1xuJyk7CiAgICAgICAgdmFyIGNvbnRyb2xMaW5lcyA9IGNvbnRyb2wuc3RhY2suc3BsaXQoJ1xuJyk7CiAgICAgICAgdmFyIHMgPSBzYW1wbGVMaW5lcy5sZW5ndGggLSAxOwogICAgICAgIHZhciBjID0gY29udHJvbExpbmVzLmxlbmd0aCAtIDE7CgogICAgICAgIHdoaWxlIChzID49IDEgJiYgYyA+PSAwICYmIHNhbXBsZUxpbmVzW3NdICE9PSBjb250cm9sTGluZXNbY10pIHsKICAgICAgICAgIC8vIFdlIGV4cGVjdCBhdCBsZWFzdCBvbmUgc3RhY2sgZnJhbWUgdG8gYmUgc2hhcmVkLgogICAgICAgICAgLy8gVHlwaWNhbGx5IHRoaXMgd2lsbCBiZSB0aGUgcm9vdCBtb3N0IG9uZS4gSG93ZXZlciwgc3RhY2sgZnJhbWVzIG1heSBiZQogICAgICAgICAgLy8gY3V0IG9mZiBkdWUgdG8gbWF4aW11bSBzdGFjayBsaW1pdHMuIEluIHRoaXMgY2FzZSwgb25lIG1heWJlIGN1dCBvZmYKICAgICAgICAgIC8vIGVhcmxpZXIgdGhhbiB0aGUgb3RoZXIuIFdlIGFzc3VtZSB0aGF0IHRoZSBzYW1wbGUgaXMgbG9uZ2VyIG9yIHRoZSBzYW1lCiAgICAgICAgICAvLyBhbmQgdGhlcmUgZm9yIGN1dCBvZmYgZWFybGllci4gU28gd2Ugc2hvdWxkIGZpbmQgdGhlIHJvb3QgbW9zdCBmcmFtZSBpbgogICAgICAgICAgLy8gdGhlIHNhbXBsZSBzb21ld2hlcmUgaW4gdGhlIGNvbnRyb2wuCiAgICAgICAgICBjLS07CiAgICAgICAgfQoKICAgICAgICBmb3IgKDsgcyA+PSAxICYmIGMgPj0gMDsgcy0tLCBjLS0pIHsKICAgICAgICAgIC8vIE5leHQgd2UgZmluZCB0aGUgZmlyc3Qgb25lIHRoYXQgaXNuJ3QgdGhlIHNhbWUgd2hpY2ggc2hvdWxkIGJlIHRoZQogICAgICAgICAgLy8gZnJhbWUgdGhhdCBjYWxsZWQgb3VyIHNhbXBsZSBmdW5jdGlvbiBhbmQgdGhlIGNvbnRyb2wuCiAgICAgICAgICBpZiAoc2FtcGxlTGluZXNbc10gIT09IGNvbnRyb2xMaW5lc1tjXSkgewogICAgICAgICAgICAvLyBJbiBWOCwgdGhlIGZpcnN0IGxpbmUgaXMgZGVzY3JpYmluZyB0aGUgbWVzc2FnZSBidXQgb3RoZXIgVk1zIGRvbid0LgogICAgICAgICAgICAvLyBJZiB3ZSdyZSBhYm91dCB0byByZXR1cm4gdGhlIGZpcnN0IGxpbmUsIGFuZCB0aGUgY29udHJvbCBpcyBhbHNvIG9uIHRoZSBzYW1lCiAgICAgICAgICAgIC8vIGxpbmUsIHRoYXQncyBhIHByZXR0eSBnb29kIGluZGljYXRvciB0aGF0IG91ciBzYW1wbGUgdGhyZXcgYXQgc2FtZSBsaW5lIGFzCiAgICAgICAgICAgIC8vIHRoZSBjb250cm9sLiBJLmUuIGJlZm9yZSB3ZSBlbnRlcmVkIHRoZSBzYW1wbGUgZnJhbWUuIFNvIHdlIGlnbm9yZSB0aGlzIHJlc3VsdC4KICAgICAgICAgICAgLy8gVGhpcyBjYW4gaGFwcGVuIGlmIHlvdSBwYXNzZWQgYSBjbGFzcyB0byBmdW5jdGlvbiBjb21wb25lbnQsIG9yIG5vbi1mdW5jdGlvbi4KICAgICAgICAgICAgaWYgKHMgIT09IDEgfHwgYyAhPT0gMSkgewogICAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAgIHMtLTsKICAgICAgICAgICAgICAgIGMtLTsgLy8gV2UgbWF5IHN0aWxsIGhhdmUgc2ltaWxhciBpbnRlcm1lZGlhdGUgZnJhbWVzIGZyb20gdGhlIGNvbnN0cnVjdCBjYWxsLgogICAgICAgICAgICAgICAgLy8gVGhlIG5leHQgb25lIHRoYXQgaXNuJ3QgdGhlIHNhbWUgc2hvdWxkIGJlIG91ciBtYXRjaCB0aG91Z2guCgogICAgICAgICAgICAgICAgaWYgKGMgPCAwIHx8IHNhbXBsZUxpbmVzW3NdICE9PSBjb250cm9sTGluZXNbY10pIHsKICAgICAgICAgICAgICAgICAgLy8gVjggYWRkcyBhICJuZXciIHByZWZpeCBmb3IgbmF0aXZlIGNsYXNzZXMuIExldCdzIHJlbW92ZSBpdCB0byBtYWtlIGl0IHByZXR0aWVyLgogICAgICAgICAgICAgICAgICB2YXIgX2ZyYW1lID0gJ1xuJyArIHNhbXBsZUxpbmVzW3NdLnJlcGxhY2UoJyBhdCBuZXcgJywgJyBhdCAnKTsgLy8gSWYgb3VyIGNvbXBvbmVudCBmcmFtZSBpcyBsYWJlbGVkICI8YW5vbnltb3VzPiIKICAgICAgICAgICAgICAgICAgLy8gYnV0IHdlIGhhdmUgYSB1c2VyLXByb3ZpZGVkICJkaXNwbGF5TmFtZSIKICAgICAgICAgICAgICAgICAgLy8gc3BsaWNlIGl0IGluIHRvIG1ha2UgdGhlIHN0YWNrIG1vcmUgcmVhZGFibGUuCgoKICAgICAgICAgICAgICAgICAgaWYgKGZuLmRpc3BsYXlOYW1lICYmIF9mcmFtZS5pbmNsdWRlcygnPGFub255bW91cz4nKSkgewogICAgICAgICAgICAgICAgICAgIF9mcmFtZSA9IF9mcmFtZS5yZXBsYWNlKCc8YW5vbnltb3VzPicsIGZuLmRpc3BsYXlOYW1lKTsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZm4gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudEZyYW1lQ2FjaGUuc2V0KGZuLCBfZnJhbWUpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfSAvLyBSZXR1cm4gdGhlIGxpbmUgd2UgZm91bmQuCgoKICAgICAgICAgICAgICAgICAgcmV0dXJuIF9mcmFtZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IHdoaWxlIChzID49IDEgJiYgYyA+PSAwKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9IGZpbmFsbHkgewogICAgICByZWVudHJ5ID0gZmFsc2U7CgogICAgICB7CiAgICAgICAgUmVhY3RDdXJyZW50RGlzcGF0Y2hlciQxLmN1cnJlbnQgPSBwcmV2aW91c0Rpc3BhdGNoZXI7CiAgICAgICAgcmVlbmFibGVMb2dzKCk7CiAgICAgIH0KCiAgICAgIEVycm9yLnByZXBhcmVTdGFja1RyYWNlID0gcHJldmlvdXNQcmVwYXJlU3RhY2tUcmFjZTsKICAgIH0gLy8gRmFsbGJhY2sgdG8ganVzdCB1c2luZyB0aGUgbmFtZSBpZiB3ZSBjb3VsZG4ndCBtYWtlIGl0IHRocm93LgoKCiAgICB2YXIgbmFtZSA9IGZuID8gZm4uZGlzcGxheU5hbWUgfHwgZm4ubmFtZSA6ICcnOwogICAgdmFyIHN5bnRoZXRpY0ZyYW1lID0gbmFtZSA/IGRlc2NyaWJlQnVpbHRJbkNvbXBvbmVudEZyYW1lKG5hbWUpIDogJyc7CgogICAgewogICAgICBpZiAodHlwZW9mIGZuID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgY29tcG9uZW50RnJhbWVDYWNoZS5zZXQoZm4sIHN5bnRoZXRpY0ZyYW1lKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBzeW50aGV0aWNGcmFtZTsKICB9CiAgZnVuY3Rpb24gZGVzY3JpYmVGdW5jdGlvbkNvbXBvbmVudEZyYW1lKGZuLCBzb3VyY2UsIG93bmVyRm4pIHsKICAgIHsKICAgICAgcmV0dXJuIGRlc2NyaWJlTmF0aXZlQ29tcG9uZW50RnJhbWUoZm4sIGZhbHNlKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHNob3VsZENvbnN0cnVjdChDb21wb25lbnQpIHsKICAgIHZhciBwcm90b3R5cGUgPSBDb21wb25lbnQucHJvdG90eXBlOwogICAgcmV0dXJuICEhKHByb3RvdHlwZSAmJiBwcm90b3R5cGUuaXNSZWFjdENvbXBvbmVudCk7CiAgfQoKICBmdW5jdGlvbiBkZXNjcmliZVVua25vd25FbGVtZW50VHlwZUZyYW1lSW5ERVYodHlwZSwgc291cmNlLCBvd25lckZuKSB7CgogICAgaWYgKHR5cGUgPT0gbnVsbCkgewogICAgICByZXR1cm4gJyc7CiAgICB9CgogICAgaWYgKHR5cGVvZiB0eXBlID09PSAnZnVuY3Rpb24nKSB7CiAgICAgIHsKICAgICAgICByZXR1cm4gZGVzY3JpYmVOYXRpdmVDb21wb25lbnRGcmFtZSh0eXBlLCBzaG91bGRDb25zdHJ1Y3QodHlwZSkpOwogICAgICB9CiAgICB9CgogICAgaWYgKHR5cGVvZiB0eXBlID09PSAnc3RyaW5nJykgewogICAgICByZXR1cm4gZGVzY3JpYmVCdWlsdEluQ29tcG9uZW50RnJhbWUodHlwZSk7CiAgICB9CgogICAgc3dpdGNoICh0eXBlKSB7CiAgICAgIGNhc2UgUkVBQ1RfU1VTUEVOU0VfVFlQRToKICAgICAgICByZXR1cm4gZGVzY3JpYmVCdWlsdEluQ29tcG9uZW50RnJhbWUoJ1N1c3BlbnNlJyk7CgogICAgICBjYXNlIFJFQUNUX1NVU1BFTlNFX0xJU1RfVFlQRToKICAgICAgICByZXR1cm4gZGVzY3JpYmVCdWlsdEluQ29tcG9uZW50RnJhbWUoJ1N1c3BlbnNlTGlzdCcpOwogICAgfQoKICAgIGlmICh0eXBlb2YgdHlwZSA9PT0gJ29iamVjdCcpIHsKICAgICAgc3dpdGNoICh0eXBlLiQkdHlwZW9mKSB7CiAgICAgICAgY2FzZSBSRUFDVF9GT1JXQVJEX1JFRl9UWVBFOgogICAgICAgICAgcmV0dXJuIGRlc2NyaWJlRnVuY3Rpb25Db21wb25lbnRGcmFtZSh0eXBlLnJlbmRlcik7CgogICAgICAgIGNhc2UgUkVBQ1RfTUVNT19UWVBFOgogICAgICAgICAgLy8gTWVtbyBtYXkgY29udGFpbiBhbnkgY29tcG9uZW50IHR5cGUgc28gd2UgcmVjdXJzaXZlbHkgcmVzb2x2ZSBpdC4KICAgICAgICAgIHJldHVybiBkZXNjcmliZVVua25vd25FbGVtZW50VHlwZUZyYW1lSW5ERVYodHlwZS50eXBlLCBzb3VyY2UsIG93bmVyRm4pOwoKICAgICAgICBjYXNlIFJFQUNUX0xBWllfVFlQRToKICAgICAgICAgIHsKICAgICAgICAgICAgdmFyIGxhenlDb21wb25lbnQgPSB0eXBlOwogICAgICAgICAgICB2YXIgcGF5bG9hZCA9IGxhenlDb21wb25lbnQuX3BheWxvYWQ7CiAgICAgICAgICAgIHZhciBpbml0ID0gbGF6eUNvbXBvbmVudC5faW5pdDsKCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgLy8gTGF6eSBtYXkgY29udGFpbiBhbnkgY29tcG9uZW50IHR5cGUgc28gd2UgcmVjdXJzaXZlbHkgcmVzb2x2ZSBpdC4KICAgICAgICAgICAgICByZXR1cm4gZGVzY3JpYmVVbmtub3duRWxlbWVudFR5cGVGcmFtZUluREVWKGluaXQocGF5bG9hZCksIHNvdXJjZSwgb3duZXJGbik7CiAgICAgICAgICAgIH0gY2F0Y2ggKHgpIHt9CiAgICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gJyc7CiAgfQoKICB2YXIgbG9nZ2VkVHlwZUZhaWx1cmVzID0ge307CiAgdmFyIFJlYWN0RGVidWdDdXJyZW50RnJhbWUkMSA9IFJlYWN0U2hhcmVkSW50ZXJuYWxzLlJlYWN0RGVidWdDdXJyZW50RnJhbWU7CgogIGZ1bmN0aW9uIHNldEN1cnJlbnRseVZhbGlkYXRpbmdFbGVtZW50KGVsZW1lbnQpIHsKICAgIHsKICAgICAgaWYgKGVsZW1lbnQpIHsKICAgICAgICB2YXIgb3duZXIgPSBlbGVtZW50Ll9vd25lcjsKICAgICAgICB2YXIgc3RhY2sgPSBkZXNjcmliZVVua25vd25FbGVtZW50VHlwZUZyYW1lSW5ERVYoZWxlbWVudC50eXBlLCBlbGVtZW50Ll9zb3VyY2UsIG93bmVyID8gb3duZXIudHlwZSA6IG51bGwpOwogICAgICAgIFJlYWN0RGVidWdDdXJyZW50RnJhbWUkMS5zZXRFeHRyYVN0YWNrRnJhbWUoc3RhY2spOwogICAgICB9IGVsc2UgewogICAgICAgIFJlYWN0RGVidWdDdXJyZW50RnJhbWUkMS5zZXRFeHRyYVN0YWNrRnJhbWUobnVsbCk7CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIGNoZWNrUHJvcFR5cGVzKHR5cGVTcGVjcywgdmFsdWVzLCBsb2NhdGlvbiwgY29tcG9uZW50TmFtZSwgZWxlbWVudCkgewogICAgewogICAgICAvLyAkRmxvd0ZpeE1lIFRoaXMgaXMgb2theSBidXQgRmxvdyBkb2Vzbid0IGtub3cgaXQuCiAgICAgIHZhciBoYXMgPSBGdW5jdGlvbi5jYWxsLmJpbmQoaGFzT3duUHJvcGVydHkpOwoKICAgICAgZm9yICh2YXIgdHlwZVNwZWNOYW1lIGluIHR5cGVTcGVjcykgewogICAgICAgIGlmIChoYXModHlwZVNwZWNzLCB0eXBlU3BlY05hbWUpKSB7CiAgICAgICAgICB2YXIgZXJyb3IkMSA9IHZvaWQgMDsgLy8gUHJvcCB0eXBlIHZhbGlkYXRpb24gbWF5IHRocm93LiBJbiBjYXNlIHRoZXkgZG8sIHdlIGRvbid0IHdhbnQgdG8KICAgICAgICAgIC8vIGZhaWwgdGhlIHJlbmRlciBwaGFzZSB3aGVyZSBpdCBkaWRuJ3QgZmFpbCBiZWZvcmUuIFNvIHdlIGxvZyBpdC4KICAgICAgICAgIC8vIEFmdGVyIHRoZXNlIGhhdmUgYmVlbiBjbGVhbmVkIHVwLCB3ZSdsbCBsZXQgdGhlbSB0aHJvdy4KCiAgICAgICAgICB0cnkgewogICAgICAgICAgICAvLyBUaGlzIGlzIGludGVudGlvbmFsbHkgYW4gaW52YXJpYW50IHRoYXQgZ2V0cyBjYXVnaHQuIEl0J3MgdGhlIHNhbWUKICAgICAgICAgICAgLy8gYmVoYXZpb3IgYXMgd2l0aG91dCB0aGlzIHN0YXRlbWVudCBleGNlcHQgd2l0aCBhIGJldHRlciBtZXNzYWdlLgogICAgICAgICAgICBpZiAodHlwZW9mIHR5cGVTcGVjc1t0eXBlU3BlY05hbWVdICE9PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0LWludGVybmFsL3Byb2QtZXJyb3ItY29kZXMKICAgICAgICAgICAgICB2YXIgZXJyID0gRXJyb3IoKGNvbXBvbmVudE5hbWUgfHwgJ1JlYWN0IGNsYXNzJykgKyAnOiAnICsgbG9jYXRpb24gKyAnIHR5cGUgYCcgKyB0eXBlU3BlY05hbWUgKyAnYCBpcyBpbnZhbGlkOyAnICsgJ2l0IG11c3QgYmUgYSBmdW5jdGlvbiwgdXN1YWxseSBmcm9tIHRoZSBgcHJvcC10eXBlc2AgcGFja2FnZSwgYnV0IHJlY2VpdmVkIGAnICsgdHlwZW9mIHR5cGVTcGVjc1t0eXBlU3BlY05hbWVdICsgJ2AuJyArICdUaGlzIG9mdGVuIGhhcHBlbnMgYmVjYXVzZSBvZiB0eXBvcyBzdWNoIGFzIGBQcm9wVHlwZXMuZnVuY3Rpb25gIGluc3RlYWQgb2YgYFByb3BUeXBlcy5mdW5jYC4nKTsKICAgICAgICAgICAgICBlcnIubmFtZSA9ICdJbnZhcmlhbnQgVmlvbGF0aW9uJzsKICAgICAgICAgICAgICB0aHJvdyBlcnI7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGVycm9yJDEgPSB0eXBlU3BlY3NbdHlwZVNwZWNOYW1lXSh2YWx1ZXMsIHR5cGVTcGVjTmFtZSwgY29tcG9uZW50TmFtZSwgbG9jYXRpb24sIG51bGwsICdTRUNSRVRfRE9fTk9UX1BBU1NfVEhJU19PUl9ZT1VfV0lMTF9CRV9GSVJFRCcpOwogICAgICAgICAgfSBjYXRjaCAoZXgpIHsKICAgICAgICAgICAgZXJyb3IkMSA9IGV4OwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChlcnJvciQxICYmICEoZXJyb3IkMSBpbnN0YW5jZW9mIEVycm9yKSkgewogICAgICAgICAgICBzZXRDdXJyZW50bHlWYWxpZGF0aW5nRWxlbWVudChlbGVtZW50KTsKCiAgICAgICAgICAgIGVycm9yKCclczogdHlwZSBzcGVjaWZpY2F0aW9uIG9mICVzJyArICcgYCVzYCBpcyBpbnZhbGlkOyB0aGUgdHlwZSBjaGVja2VyICcgKyAnZnVuY3Rpb24gbXVzdCByZXR1cm4gYG51bGxgIG9yIGFuIGBFcnJvcmAgYnV0IHJldHVybmVkIGEgJXMuICcgKyAnWW91IG1heSBoYXZlIGZvcmdvdHRlbiB0byBwYXNzIGFuIGFyZ3VtZW50IHRvIHRoZSB0eXBlIGNoZWNrZXIgJyArICdjcmVhdG9yIChhcnJheU9mLCBpbnN0YW5jZU9mLCBvYmplY3RPZiwgb25lT2YsIG9uZU9mVHlwZSwgYW5kICcgKyAnc2hhcGUgYWxsIHJlcXVpcmUgYW4gYXJndW1lbnQpLicsIGNvbXBvbmVudE5hbWUgfHwgJ1JlYWN0IGNsYXNzJywgbG9jYXRpb24sIHR5cGVTcGVjTmFtZSwgdHlwZW9mIGVycm9yJDEpOwoKICAgICAgICAgICAgc2V0Q3VycmVudGx5VmFsaWRhdGluZ0VsZW1lbnQobnVsbCk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGVycm9yJDEgaW5zdGFuY2VvZiBFcnJvciAmJiAhKGVycm9yJDEubWVzc2FnZSBpbiBsb2dnZWRUeXBlRmFpbHVyZXMpKSB7CiAgICAgICAgICAgIC8vIE9ubHkgbW9uaXRvciB0aGlzIGZhaWx1cmUgb25jZSBiZWNhdXNlIHRoZXJlIHRlbmRzIHRvIGJlIGEgbG90IG9mIHRoZQogICAgICAgICAgICAvLyBzYW1lIGVycm9yLgogICAgICAgICAgICBsb2dnZWRUeXBlRmFpbHVyZXNbZXJyb3IkMS5tZXNzYWdlXSA9IHRydWU7CiAgICAgICAgICAgIHNldEN1cnJlbnRseVZhbGlkYXRpbmdFbGVtZW50KGVsZW1lbnQpOwoKICAgICAgICAgICAgZXJyb3IoJ0ZhaWxlZCAlcyB0eXBlOiAlcycsIGxvY2F0aW9uLCBlcnJvciQxLm1lc3NhZ2UpOwoKICAgICAgICAgICAgc2V0Q3VycmVudGx5VmFsaWRhdGluZ0VsZW1lbnQobnVsbCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiBzZXRDdXJyZW50bHlWYWxpZGF0aW5nRWxlbWVudCQxKGVsZW1lbnQpIHsKICAgIHsKICAgICAgaWYgKGVsZW1lbnQpIHsKICAgICAgICB2YXIgb3duZXIgPSBlbGVtZW50Ll9vd25lcjsKICAgICAgICB2YXIgc3RhY2sgPSBkZXNjcmliZVVua25vd25FbGVtZW50VHlwZUZyYW1lSW5ERVYoZWxlbWVudC50eXBlLCBlbGVtZW50Ll9zb3VyY2UsIG93bmVyID8gb3duZXIudHlwZSA6IG51bGwpOwogICAgICAgIHNldEV4dHJhU3RhY2tGcmFtZShzdGFjayk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc2V0RXh0cmFTdGFja0ZyYW1lKG51bGwpOwogICAgICB9CiAgICB9CiAgfQoKICB2YXIgcHJvcFR5cGVzTWlzc3BlbGxXYXJuaW5nU2hvd247CgogIHsKICAgIHByb3BUeXBlc01pc3NwZWxsV2FybmluZ1Nob3duID0gZmFsc2U7CiAgfQoKICBmdW5jdGlvbiBnZXREZWNsYXJhdGlvbkVycm9yQWRkZW5kdW0oKSB7CiAgICBpZiAoUmVhY3RDdXJyZW50T3duZXIuY3VycmVudCkgewogICAgICB2YXIgbmFtZSA9IGdldENvbXBvbmVudE5hbWVGcm9tVHlwZShSZWFjdEN1cnJlbnRPd25lci5jdXJyZW50LnR5cGUpOwoKICAgICAgaWYgKG5hbWUpIHsKICAgICAgICByZXR1cm4gJ1xuXG5DaGVjayB0aGUgcmVuZGVyIG1ldGhvZCBvZiBgJyArIG5hbWUgKyAnYC4nOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuICcnOwogIH0KCiAgZnVuY3Rpb24gZ2V0U291cmNlSW5mb0Vycm9yQWRkZW5kdW0oc291cmNlKSB7CiAgICBpZiAoc291cmNlICE9PSB1bmRlZmluZWQpIHsKICAgICAgdmFyIGZpbGVOYW1lID0gc291cmNlLmZpbGVOYW1lLnJlcGxhY2UoL14uKltcXFwvXS8sICcnKTsKICAgICAgdmFyIGxpbmVOdW1iZXIgPSBzb3VyY2UubGluZU51bWJlcjsKICAgICAgcmV0dXJuICdcblxuQ2hlY2sgeW91ciBjb2RlIGF0ICcgKyBmaWxlTmFtZSArICc6JyArIGxpbmVOdW1iZXIgKyAnLic7CiAgICB9CgogICAgcmV0dXJuICcnOwogIH0KCiAgZnVuY3Rpb24gZ2V0U291cmNlSW5mb0Vycm9yQWRkZW5kdW1Gb3JQcm9wcyhlbGVtZW50UHJvcHMpIHsKICAgIGlmIChlbGVtZW50UHJvcHMgIT09IG51bGwgJiYgZWxlbWVudFByb3BzICE9PSB1bmRlZmluZWQpIHsKICAgICAgcmV0dXJuIGdldFNvdXJjZUluZm9FcnJvckFkZGVuZHVtKGVsZW1lbnRQcm9wcy5fX3NvdXJjZSk7CiAgICB9CgogICAgcmV0dXJuICcnOwogIH0KICAvKioKICAgKiBXYXJuIGlmIHRoZXJlJ3Mgbm8ga2V5IGV4cGxpY2l0bHkgc2V0IG9uIGR5bmFtaWMgYXJyYXlzIG9mIGNoaWxkcmVuIG9yCiAgICogb2JqZWN0IGtleXMgYXJlIG5vdCB2YWxpZC4gVGhpcyBhbGxvd3MgdXMgdG8ga2VlcCB0cmFjayBvZiBjaGlsZHJlbiBiZXR3ZWVuCiAgICogdXBkYXRlcy4KICAgKi8KCgogIHZhciBvd25lckhhc0tleVVzZVdhcm5pbmcgPSB7fTsKCiAgZnVuY3Rpb24gZ2V0Q3VycmVudENvbXBvbmVudEVycm9ySW5mbyhwYXJlbnRUeXBlKSB7CiAgICB2YXIgaW5mbyA9IGdldERlY2xhcmF0aW9uRXJyb3JBZGRlbmR1bSgpOwoKICAgIGlmICghaW5mbykgewogICAgICB2YXIgcGFyZW50TmFtZSA9IHR5cGVvZiBwYXJlbnRUeXBlID09PSAnc3RyaW5nJyA/IHBhcmVudFR5cGUgOiBwYXJlbnRUeXBlLmRpc3BsYXlOYW1lIHx8IHBhcmVudFR5cGUubmFtZTsKCiAgICAgIGlmIChwYXJlbnROYW1lKSB7CiAgICAgICAgaW5mbyA9ICJcblxuQ2hlY2sgdGhlIHRvcC1sZXZlbCByZW5kZXIgY2FsbCB1c2luZyA8IiArIHBhcmVudE5hbWUgKyAiPi4iOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIGluZm87CiAgfQogIC8qKgogICAqIFdhcm4gaWYgdGhlIGVsZW1lbnQgZG9lc24ndCBoYXZlIGFuIGV4cGxpY2l0IGtleSBhc3NpZ25lZCB0byBpdC4KICAgKiBUaGlzIGVsZW1lbnQgaXMgaW4gYW4gYXJyYXkuIFRoZSBhcnJheSBjb3VsZCBncm93IGFuZCBzaHJpbmsgb3IgYmUKICAgKiByZW9yZGVyZWQuIEFsbCBjaGlsZHJlbiB0aGF0IGhhdmVuJ3QgYWxyZWFkeSBiZWVuIHZhbGlkYXRlZCBhcmUgcmVxdWlyZWQgdG8KICAgKiBoYXZlIGEgImtleSIgcHJvcGVydHkgYXNzaWduZWQgdG8gaXQuIEVycm9yIHN0YXR1c2VzIGFyZSBjYWNoZWQgc28gYSB3YXJuaW5nCiAgICogd2lsbCBvbmx5IGJlIHNob3duIG9uY2UuCiAgICoKICAgKiBAaW50ZXJuYWwKICAgKiBAcGFyYW0ge1JlYWN0RWxlbWVudH0gZWxlbWVudCBFbGVtZW50IHRoYXQgcmVxdWlyZXMgYSBrZXkuCiAgICogQHBhcmFtIHsqfSBwYXJlbnRUeXBlIGVsZW1lbnQncyBwYXJlbnQncyB0eXBlLgogICAqLwoKCiAgZnVuY3Rpb24gdmFsaWRhdGVFeHBsaWNpdEtleShlbGVtZW50LCBwYXJlbnRUeXBlKSB7CiAgICBpZiAoIWVsZW1lbnQuX3N0b3JlIHx8IGVsZW1lbnQuX3N0b3JlLnZhbGlkYXRlZCB8fCBlbGVtZW50LmtleSAhPSBudWxsKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBlbGVtZW50Ll9zdG9yZS52YWxpZGF0ZWQgPSB0cnVlOwogICAgdmFyIGN1cnJlbnRDb21wb25lbnRFcnJvckluZm8gPSBnZXRDdXJyZW50Q29tcG9uZW50RXJyb3JJbmZvKHBhcmVudFR5cGUpOwoKICAgIGlmIChvd25lckhhc0tleVVzZVdhcm5pbmdbY3VycmVudENvbXBvbmVudEVycm9ySW5mb10pIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIG93bmVySGFzS2V5VXNlV2FybmluZ1tjdXJyZW50Q29tcG9uZW50RXJyb3JJbmZvXSA9IHRydWU7IC8vIFVzdWFsbHkgdGhlIGN1cnJlbnQgb3duZXIgaXMgdGhlIG9mZmVuZGVyLCBidXQgaWYgaXQgYWNjZXB0cyBjaGlsZHJlbiBhcyBhCiAgICAvLyBwcm9wZXJ0eSwgaXQgbWF5IGJlIHRoZSBjcmVhdG9yIG9mIHRoZSBjaGlsZCB0aGF0J3MgcmVzcG9uc2libGUgZm9yCiAgICAvLyBhc3NpZ25pbmcgaXQgYSBrZXkuCgogICAgdmFyIGNoaWxkT3duZXIgPSAnJzsKCiAgICBpZiAoZWxlbWVudCAmJiBlbGVtZW50Ll9vd25lciAmJiBlbGVtZW50Ll9vd25lciAhPT0gUmVhY3RDdXJyZW50T3duZXIuY3VycmVudCkgewogICAgICAvLyBHaXZlIHRoZSBjb21wb25lbnQgdGhhdCBvcmlnaW5hbGx5IGNyZWF0ZWQgdGhpcyBjaGlsZC4KICAgICAgY2hpbGRPd25lciA9ICIgSXQgd2FzIHBhc3NlZCBhIGNoaWxkIGZyb20gIiArIGdldENvbXBvbmVudE5hbWVGcm9tVHlwZShlbGVtZW50Ll9vd25lci50eXBlKSArICIuIjsKICAgIH0KCiAgICB7CiAgICAgIHNldEN1cnJlbnRseVZhbGlkYXRpbmdFbGVtZW50JDEoZWxlbWVudCk7CgogICAgICBlcnJvcignRWFjaCBjaGlsZCBpbiBhIGxpc3Qgc2hvdWxkIGhhdmUgYSB1bmlxdWUgImtleSIgcHJvcC4nICsgJyVzJXMgU2VlIGh0dHBzOi8vcmVhY3Rqcy5vcmcvbGluay93YXJuaW5nLWtleXMgZm9yIG1vcmUgaW5mb3JtYXRpb24uJywgY3VycmVudENvbXBvbmVudEVycm9ySW5mbywgY2hpbGRPd25lcik7CgogICAgICBzZXRDdXJyZW50bHlWYWxpZGF0aW5nRWxlbWVudCQxKG51bGwpOwogICAgfQogIH0KICAvKioKICAgKiBFbnN1cmUgdGhhdCBldmVyeSBlbGVtZW50IGVpdGhlciBpcyBwYXNzZWQgaW4gYSBzdGF0aWMgbG9jYXRpb24sIGluIGFuCiAgICogYXJyYXkgd2l0aCBhbiBleHBsaWNpdCBrZXlzIHByb3BlcnR5IGRlZmluZWQsIG9yIGluIGFuIG9iamVjdCBsaXRlcmFsCiAgICogd2l0aCB2YWxpZCBrZXkgcHJvcGVydHkuCiAgICoKICAgKiBAaW50ZXJuYWwKICAgKiBAcGFyYW0ge1JlYWN0Tm9kZX0gbm9kZSBTdGF0aWNhbGx5IHBhc3NlZCBjaGlsZCBvZiBhbnkgdHlwZS4KICAgKiBAcGFyYW0geyp9IHBhcmVudFR5cGUgbm9kZSdzIHBhcmVudCdzIHR5cGUuCiAgICovCgoKICBmdW5jdGlvbiB2YWxpZGF0ZUNoaWxkS2V5cyhub2RlLCBwYXJlbnRUeXBlKSB7CiAgICBpZiAodHlwZW9mIG5vZGUgIT09ICdvYmplY3QnKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAoaXNBcnJheShub2RlKSkgewogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGUubGVuZ3RoOyBpKyspIHsKICAgICAgICB2YXIgY2hpbGQgPSBub2RlW2ldOwoKICAgICAgICBpZiAoaXNWYWxpZEVsZW1lbnQoY2hpbGQpKSB7CiAgICAgICAgICB2YWxpZGF0ZUV4cGxpY2l0S2V5KGNoaWxkLCBwYXJlbnRUeXBlKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSBpZiAoaXNWYWxpZEVsZW1lbnQobm9kZSkpIHsKICAgICAgLy8gVGhpcyBlbGVtZW50IHdhcyBwYXNzZWQgaW4gYSB2YWxpZCBsb2NhdGlvbi4KICAgICAgaWYgKG5vZGUuX3N0b3JlKSB7CiAgICAgICAgbm9kZS5fc3RvcmUudmFsaWRhdGVkID0gdHJ1ZTsKICAgICAgfQogICAgfSBlbHNlIGlmIChub2RlKSB7CiAgICAgIHZhciBpdGVyYXRvckZuID0gZ2V0SXRlcmF0b3JGbihub2RlKTsKCiAgICAgIGlmICh0eXBlb2YgaXRlcmF0b3JGbiA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIC8vIEVudHJ5IGl0ZXJhdG9ycyB1c2VkIHRvIHByb3ZpZGUgaW1wbGljaXQga2V5cywKICAgICAgICAvLyBidXQgbm93IHdlIHByaW50IGEgc2VwYXJhdGUgd2FybmluZyBmb3IgdGhlbSBsYXRlci4KICAgICAgICBpZiAoaXRlcmF0b3JGbiAhPT0gbm9kZS5lbnRyaWVzKSB7CiAgICAgICAgICB2YXIgaXRlcmF0b3IgPSBpdGVyYXRvckZuLmNhbGwobm9kZSk7CiAgICAgICAgICB2YXIgc3RlcDsKCiAgICAgICAgICB3aGlsZSAoIShzdGVwID0gaXRlcmF0b3IubmV4dCgpKS5kb25lKSB7CiAgICAgICAgICAgIGlmIChpc1ZhbGlkRWxlbWVudChzdGVwLnZhbHVlKSkgewogICAgICAgICAgICAgIHZhbGlkYXRlRXhwbGljaXRLZXkoc3RlcC52YWx1ZSwgcGFyZW50VHlwZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CiAgLyoqCiAgICogR2l2ZW4gYW4gZWxlbWVudCwgdmFsaWRhdGUgdGhhdCBpdHMgcHJvcHMgZm9sbG93IHRoZSBwcm9wVHlwZXMgZGVmaW5pdGlvbiwKICAgKiBwcm92aWRlZCBieSB0aGUgdHlwZS4KICAgKgogICAqIEBwYXJhbSB7UmVhY3RFbGVtZW50fSBlbGVtZW50CiAgICovCgoKICBmdW5jdGlvbiB2YWxpZGF0ZVByb3BUeXBlcyhlbGVtZW50KSB7CiAgICB7CiAgICAgIHZhciB0eXBlID0gZWxlbWVudC50eXBlOwoKICAgICAgaWYgKHR5cGUgPT09IG51bGwgfHwgdHlwZSA9PT0gdW5kZWZpbmVkIHx8IHR5cGVvZiB0eXBlID09PSAnc3RyaW5nJykgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIHByb3BUeXBlczsKCiAgICAgIGlmICh0eXBlb2YgdHlwZSA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIHByb3BUeXBlcyA9IHR5cGUucHJvcFR5cGVzOwogICAgICB9IGVsc2UgaWYgKHR5cGVvZiB0eXBlID09PSAnb2JqZWN0JyAmJiAodHlwZS4kJHR5cGVvZiA9PT0gUkVBQ1RfRk9SV0FSRF9SRUZfVFlQRSB8fCAvLyBOb3RlOiBNZW1vIG9ubHkgY2hlY2tzIG91dGVyIHByb3BzIGhlcmUuCiAgICAgIC8vIElubmVyIHByb3BzIGFyZSBjaGVja2VkIGluIHRoZSByZWNvbmNpbGVyLgogICAgICB0eXBlLiQkdHlwZW9mID09PSBSRUFDVF9NRU1PX1RZUEUpKSB7CiAgICAgICAgcHJvcFR5cGVzID0gdHlwZS5wcm9wVHlwZXM7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAocHJvcFR5cGVzKSB7CiAgICAgICAgLy8gSW50ZW50aW9uYWxseSBpbnNpZGUgdG8gYXZvaWQgdHJpZ2dlcmluZyBsYXp5IGluaXRpYWxpemVyczoKICAgICAgICB2YXIgbmFtZSA9IGdldENvbXBvbmVudE5hbWVGcm9tVHlwZSh0eXBlKTsKICAgICAgICBjaGVja1Byb3BUeXBlcyhwcm9wVHlwZXMsIGVsZW1lbnQucHJvcHMsICdwcm9wJywgbmFtZSwgZWxlbWVudCk7CiAgICAgIH0gZWxzZSBpZiAodHlwZS5Qcm9wVHlwZXMgIT09IHVuZGVmaW5lZCAmJiAhcHJvcFR5cGVzTWlzc3BlbGxXYXJuaW5nU2hvd24pIHsKICAgICAgICBwcm9wVHlwZXNNaXNzcGVsbFdhcm5pbmdTaG93biA9IHRydWU7IC8vIEludGVudGlvbmFsbHkgaW5zaWRlIHRvIGF2b2lkIHRyaWdnZXJpbmcgbGF6eSBpbml0aWFsaXplcnM6CgogICAgICAgIHZhciBfbmFtZSA9IGdldENvbXBvbmVudE5hbWVGcm9tVHlwZSh0eXBlKTsKCiAgICAgICAgZXJyb3IoJ0NvbXBvbmVudCAlcyBkZWNsYXJlZCBgUHJvcFR5cGVzYCBpbnN0ZWFkIG9mIGBwcm9wVHlwZXNgLiBEaWQgeW91IG1pc3NwZWxsIHRoZSBwcm9wZXJ0eSBhc3NpZ25tZW50PycsIF9uYW1lIHx8ICdVbmtub3duJyk7CiAgICAgIH0KCiAgICAgIGlmICh0eXBlb2YgdHlwZS5nZXREZWZhdWx0UHJvcHMgPT09ICdmdW5jdGlvbicgJiYgIXR5cGUuZ2V0RGVmYXVsdFByb3BzLmlzUmVhY3RDbGFzc0FwcHJvdmVkKSB7CiAgICAgICAgZXJyb3IoJ2dldERlZmF1bHRQcm9wcyBpcyBvbmx5IHVzZWQgb24gY2xhc3NpYyBSZWFjdC5jcmVhdGVDbGFzcyAnICsgJ2RlZmluaXRpb25zLiBVc2UgYSBzdGF0aWMgcHJvcGVydHkgbmFtZWQgYGRlZmF1bHRQcm9wc2AgaW5zdGVhZC4nKTsKICAgICAgfQogICAgfQogIH0KICAvKioKICAgKiBHaXZlbiBhIGZyYWdtZW50LCB2YWxpZGF0ZSB0aGF0IGl0IGNhbiBvbmx5IGJlIHByb3ZpZGVkIHdpdGggZnJhZ21lbnQgcHJvcHMKICAgKiBAcGFyYW0ge1JlYWN0RWxlbWVudH0gZnJhZ21lbnQKICAgKi8KCgogIGZ1bmN0aW9uIHZhbGlkYXRlRnJhZ21lbnRQcm9wcyhmcmFnbWVudCkgewogICAgewogICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKGZyYWdtZW50LnByb3BzKTsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykgewogICAgICAgIHZhciBrZXkgPSBrZXlzW2ldOwoKICAgICAgICBpZiAoa2V5ICE9PSAnY2hpbGRyZW4nICYmIGtleSAhPT0gJ2tleScpIHsKICAgICAgICAgIHNldEN1cnJlbnRseVZhbGlkYXRpbmdFbGVtZW50JDEoZnJhZ21lbnQpOwoKICAgICAgICAgIGVycm9yKCdJbnZhbGlkIHByb3AgYCVzYCBzdXBwbGllZCB0byBgUmVhY3QuRnJhZ21lbnRgLiAnICsgJ1JlYWN0LkZyYWdtZW50IGNhbiBvbmx5IGhhdmUgYGtleWAgYW5kIGBjaGlsZHJlbmAgcHJvcHMuJywga2V5KTsKCiAgICAgICAgICBzZXRDdXJyZW50bHlWYWxpZGF0aW5nRWxlbWVudCQxKG51bGwpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoZnJhZ21lbnQucmVmICE9PSBudWxsKSB7CiAgICAgICAgc2V0Q3VycmVudGx5VmFsaWRhdGluZ0VsZW1lbnQkMShmcmFnbWVudCk7CgogICAgICAgIGVycm9yKCdJbnZhbGlkIGF0dHJpYnV0ZSBgcmVmYCBzdXBwbGllZCB0byBgUmVhY3QuRnJhZ21lbnRgLicpOwoKICAgICAgICBzZXRDdXJyZW50bHlWYWxpZGF0aW5nRWxlbWVudCQxKG51bGwpOwogICAgICB9CiAgICB9CiAgfQogIGZ1bmN0aW9uIGNyZWF0ZUVsZW1lbnRXaXRoVmFsaWRhdGlvbih0eXBlLCBwcm9wcywgY2hpbGRyZW4pIHsKICAgIHZhciB2YWxpZFR5cGUgPSBpc1ZhbGlkRWxlbWVudFR5cGUodHlwZSk7IC8vIFdlIHdhcm4gaW4gdGhpcyBjYXNlIGJ1dCBkb24ndCB0aHJvdy4gV2UgZXhwZWN0IHRoZSBlbGVtZW50IGNyZWF0aW9uIHRvCiAgICAvLyBzdWNjZWVkIGFuZCB0aGVyZSB3aWxsIGxpa2VseSBiZSBlcnJvcnMgaW4gcmVuZGVyLgoKICAgIGlmICghdmFsaWRUeXBlKSB7CiAgICAgIHZhciBpbmZvID0gJyc7CgogICAgICBpZiAodHlwZSA9PT0gdW5kZWZpbmVkIHx8IHR5cGVvZiB0eXBlID09PSAnb2JqZWN0JyAmJiB0eXBlICE9PSBudWxsICYmIE9iamVjdC5rZXlzKHR5cGUpLmxlbmd0aCA9PT0gMCkgewogICAgICAgIGluZm8gKz0gJyBZb3UgbGlrZWx5IGZvcmdvdCB0byBleHBvcnQgeW91ciBjb21wb25lbnQgZnJvbSB0aGUgZmlsZSAnICsgIml0J3MgZGVmaW5lZCBpbiwgb3IgeW91IG1pZ2h0IGhhdmUgbWl4ZWQgdXAgZGVmYXVsdCBhbmQgbmFtZWQgaW1wb3J0cy4iOwogICAgICB9CgogICAgICB2YXIgc291cmNlSW5mbyA9IGdldFNvdXJjZUluZm9FcnJvckFkZGVuZHVtRm9yUHJvcHMocHJvcHMpOwoKICAgICAgaWYgKHNvdXJjZUluZm8pIHsKICAgICAgICBpbmZvICs9IHNvdXJjZUluZm87CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaW5mbyArPSBnZXREZWNsYXJhdGlvbkVycm9yQWRkZW5kdW0oKTsKICAgICAgfQoKICAgICAgdmFyIHR5cGVTdHJpbmc7CgogICAgICBpZiAodHlwZSA9PT0gbnVsbCkgewogICAgICAgIHR5cGVTdHJpbmcgPSAnbnVsbCc7CiAgICAgIH0gZWxzZSBpZiAoaXNBcnJheSh0eXBlKSkgewogICAgICAgIHR5cGVTdHJpbmcgPSAnYXJyYXknOwogICAgICB9IGVsc2UgaWYgKHR5cGUgIT09IHVuZGVmaW5lZCAmJiB0eXBlLiQkdHlwZW9mID09PSBSRUFDVF9FTEVNRU5UX1RZUEUpIHsKICAgICAgICB0eXBlU3RyaW5nID0gIjwiICsgKGdldENvbXBvbmVudE5hbWVGcm9tVHlwZSh0eXBlLnR5cGUpIHx8ICdVbmtub3duJykgKyAiIC8+IjsKICAgICAgICBpbmZvID0gJyBEaWQgeW91IGFjY2lkZW50YWxseSBleHBvcnQgYSBKU1ggbGl0ZXJhbCBpbnN0ZWFkIG9mIGEgY29tcG9uZW50Pyc7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdHlwZVN0cmluZyA9IHR5cGVvZiB0eXBlOwogICAgICB9CgogICAgICB7CiAgICAgICAgZXJyb3IoJ1JlYWN0LmNyZWF0ZUVsZW1lbnQ6IHR5cGUgaXMgaW52YWxpZCAtLSBleHBlY3RlZCBhIHN0cmluZyAoZm9yICcgKyAnYnVpbHQtaW4gY29tcG9uZW50cykgb3IgYSBjbGFzcy9mdW5jdGlvbiAoZm9yIGNvbXBvc2l0ZSAnICsgJ2NvbXBvbmVudHMpIGJ1dCBnb3Q6ICVzLiVzJywgdHlwZVN0cmluZywgaW5mbyk7CiAgICAgIH0KICAgIH0KCiAgICB2YXIgZWxlbWVudCA9IGNyZWF0ZUVsZW1lbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsgLy8gVGhlIHJlc3VsdCBjYW4gYmUgbnVsbGlzaCBpZiBhIG1vY2sgb3IgYSBjdXN0b20gZnVuY3Rpb24gaXMgdXNlZC4KICAgIC8vIFRPRE86IERyb3AgdGhpcyB3aGVuIHRoZXNlIGFyZSBubyBsb25nZXIgYWxsb3dlZCBhcyB0aGUgdHlwZSBhcmd1bWVudC4KCiAgICBpZiAoZWxlbWVudCA9PSBudWxsKSB7CiAgICAgIHJldHVybiBlbGVtZW50OwogICAgfSAvLyBTa2lwIGtleSB3YXJuaW5nIGlmIHRoZSB0eXBlIGlzbid0IHZhbGlkIHNpbmNlIG91ciBrZXkgdmFsaWRhdGlvbiBsb2dpYwogICAgLy8gZG9lc24ndCBleHBlY3QgYSBub24tc3RyaW5nL2Z1bmN0aW9uIHR5cGUgYW5kIGNhbiB0aHJvdyBjb25mdXNpbmcgZXJyb3JzLgogICAgLy8gV2UgZG9uJ3Qgd2FudCBleGNlcHRpb24gYmVoYXZpb3IgdG8gZGlmZmVyIGJldHdlZW4gZGV2IGFuZCBwcm9kLgogICAgLy8gKFJlbmRlcmluZyB3aWxsIHRocm93IHdpdGggYSBoZWxwZnVsIG1lc3NhZ2UgYW5kIGFzIHNvb24gYXMgdGhlIHR5cGUgaXMKICAgIC8vIGZpeGVkLCB0aGUga2V5IHdhcm5pbmdzIHdpbGwgYXBwZWFyLikKCgogICAgaWYgKHZhbGlkVHlwZSkgewogICAgICBmb3IgKHZhciBpID0gMjsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgewogICAgICAgIHZhbGlkYXRlQ2hpbGRLZXlzKGFyZ3VtZW50c1tpXSwgdHlwZSk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAodHlwZSA9PT0gUkVBQ1RfRlJBR01FTlRfVFlQRSkgewogICAgICB2YWxpZGF0ZUZyYWdtZW50UHJvcHMoZWxlbWVudCk7CiAgICB9IGVsc2UgewogICAgICB2YWxpZGF0ZVByb3BUeXBlcyhlbGVtZW50KTsKICAgIH0KCiAgICByZXR1cm4gZWxlbWVudDsKICB9CiAgdmFyIGRpZFdhcm5BYm91dERlcHJlY2F0ZWRDcmVhdGVGYWN0b3J5ID0gZmFsc2U7CiAgZnVuY3Rpb24gY3JlYXRlRmFjdG9yeVdpdGhWYWxpZGF0aW9uKHR5cGUpIHsKICAgIHZhciB2YWxpZGF0ZWRGYWN0b3J5ID0gY3JlYXRlRWxlbWVudFdpdGhWYWxpZGF0aW9uLmJpbmQobnVsbCwgdHlwZSk7CiAgICB2YWxpZGF0ZWRGYWN0b3J5LnR5cGUgPSB0eXBlOwoKICAgIHsKICAgICAgaWYgKCFkaWRXYXJuQWJvdXREZXByZWNhdGVkQ3JlYXRlRmFjdG9yeSkgewogICAgICAgIGRpZFdhcm5BYm91dERlcHJlY2F0ZWRDcmVhdGVGYWN0b3J5ID0gdHJ1ZTsKCiAgICAgICAgd2FybignUmVhY3QuY3JlYXRlRmFjdG9yeSgpIGlzIGRlcHJlY2F0ZWQgYW5kIHdpbGwgYmUgcmVtb3ZlZCBpbiAnICsgJ2EgZnV0dXJlIG1ham9yIHJlbGVhc2UuIENvbnNpZGVyIHVzaW5nIEpTWCAnICsgJ29yIHVzZSBSZWFjdC5jcmVhdGVFbGVtZW50KCkgZGlyZWN0bHkgaW5zdGVhZC4nKTsKICAgICAgfSAvLyBMZWdhY3kgaG9vazogcmVtb3ZlIGl0CgoKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHZhbGlkYXRlZEZhY3RvcnksICd0eXBlJywgewogICAgICAgIGVudW1lcmFibGU6IGZhbHNlLAogICAgICAgIGdldDogZnVuY3Rpb24gKCkgewogICAgICAgICAgd2FybignRmFjdG9yeS50eXBlIGlzIGRlcHJlY2F0ZWQuIEFjY2VzcyB0aGUgY2xhc3MgZGlyZWN0bHkgJyArICdiZWZvcmUgcGFzc2luZyBpdCB0byBjcmVhdGVGYWN0b3J5LicpOwoKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAndHlwZScsIHsKICAgICAgICAgICAgdmFsdWU6IHR5cGUKICAgICAgICAgIH0pOwogICAgICAgICAgcmV0dXJuIHR5cGU7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KCiAgICByZXR1cm4gdmFsaWRhdGVkRmFjdG9yeTsKICB9CiAgZnVuY3Rpb24gY2xvbmVFbGVtZW50V2l0aFZhbGlkYXRpb24oZWxlbWVudCwgcHJvcHMsIGNoaWxkcmVuKSB7CiAgICB2YXIgbmV3RWxlbWVudCA9IGNsb25lRWxlbWVudC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwoKICAgIGZvciAodmFyIGkgPSAyOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgIHZhbGlkYXRlQ2hpbGRLZXlzKGFyZ3VtZW50c1tpXSwgbmV3RWxlbWVudC50eXBlKTsKICAgIH0KCiAgICB2YWxpZGF0ZVByb3BUeXBlcyhuZXdFbGVtZW50KTsKICAgIHJldHVybiBuZXdFbGVtZW50OwogIH0KCiAgdmFyIGVuYWJsZVNjaGVkdWxlckRlYnVnZ2luZyA9IGZhbHNlOwogIHZhciBlbmFibGVQcm9maWxpbmcgPSBmYWxzZTsKICB2YXIgZnJhbWVZaWVsZE1zID0gNTsKCiAgZnVuY3Rpb24gcHVzaChoZWFwLCBub2RlKSB7CiAgICB2YXIgaW5kZXggPSBoZWFwLmxlbmd0aDsKICAgIGhlYXAucHVzaChub2RlKTsKICAgIHNpZnRVcChoZWFwLCBub2RlLCBpbmRleCk7CiAgfQogIGZ1bmN0aW9uIHBlZWsoaGVhcCkgewogICAgcmV0dXJuIGhlYXAubGVuZ3RoID09PSAwID8gbnVsbCA6IGhlYXBbMF07CiAgfQogIGZ1bmN0aW9uIHBvcChoZWFwKSB7CiAgICBpZiAoaGVhcC5sZW5ndGggPT09IDApIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgdmFyIGZpcnN0ID0gaGVhcFswXTsKICAgIHZhciBsYXN0ID0gaGVhcC5wb3AoKTsKCiAgICBpZiAobGFzdCAhPT0gZmlyc3QpIHsKICAgICAgaGVhcFswXSA9IGxhc3Q7CiAgICAgIHNpZnREb3duKGhlYXAsIGxhc3QsIDApOwogICAgfQoKICAgIHJldHVybiBmaXJzdDsKICB9CgogIGZ1bmN0aW9uIHNpZnRVcChoZWFwLCBub2RlLCBpKSB7CiAgICB2YXIgaW5kZXggPSBpOwoKICAgIHdoaWxlIChpbmRleCA+IDApIHsKICAgICAgdmFyIHBhcmVudEluZGV4ID0gaW5kZXggLSAxID4+PiAxOwogICAgICB2YXIgcGFyZW50ID0gaGVhcFtwYXJlbnRJbmRleF07CgogICAgICBpZiAoY29tcGFyZShwYXJlbnQsIG5vZGUpID4gMCkgewogICAgICAgIC8vIFRoZSBwYXJlbnQgaXMgbGFyZ2VyLiBTd2FwIHBvc2l0aW9ucy4KICAgICAgICBoZWFwW3BhcmVudEluZGV4XSA9IG5vZGU7CiAgICAgICAgaGVhcFtpbmRleF0gPSBwYXJlbnQ7CiAgICAgICAgaW5kZXggPSBwYXJlbnRJbmRleDsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBUaGUgcGFyZW50IGlzIHNtYWxsZXIuIEV4aXQuCiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiBzaWZ0RG93bihoZWFwLCBub2RlLCBpKSB7CiAgICB2YXIgaW5kZXggPSBpOwogICAgdmFyIGxlbmd0aCA9IGhlYXAubGVuZ3RoOwogICAgdmFyIGhhbGZMZW5ndGggPSBsZW5ndGggPj4+IDE7CgogICAgd2hpbGUgKGluZGV4IDwgaGFsZkxlbmd0aCkgewogICAgICB2YXIgbGVmdEluZGV4ID0gKGluZGV4ICsgMSkgKiAyIC0gMTsKICAgICAgdmFyIGxlZnQgPSBoZWFwW2xlZnRJbmRleF07CiAgICAgIHZhciByaWdodEluZGV4ID0gbGVmdEluZGV4ICsgMTsKICAgICAgdmFyIHJpZ2h0ID0gaGVhcFtyaWdodEluZGV4XTsgLy8gSWYgdGhlIGxlZnQgb3IgcmlnaHQgbm9kZSBpcyBzbWFsbGVyLCBzd2FwIHdpdGggdGhlIHNtYWxsZXIgb2YgdGhvc2UuCgogICAgICBpZiAoY29tcGFyZShsZWZ0LCBub2RlKSA8IDApIHsKICAgICAgICBpZiAocmlnaHRJbmRleCA8IGxlbmd0aCAmJiBjb21wYXJlKHJpZ2h0LCBsZWZ0KSA8IDApIHsKICAgICAgICAgIGhlYXBbaW5kZXhdID0gcmlnaHQ7CiAgICAgICAgICBoZWFwW3JpZ2h0SW5kZXhdID0gbm9kZTsKICAgICAgICAgIGluZGV4ID0gcmlnaHRJbmRleDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaGVhcFtpbmRleF0gPSBsZWZ0OwogICAgICAgICAgaGVhcFtsZWZ0SW5kZXhdID0gbm9kZTsKICAgICAgICAgIGluZGV4ID0gbGVmdEluZGV4OwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChyaWdodEluZGV4IDwgbGVuZ3RoICYmIGNvbXBhcmUocmlnaHQsIG5vZGUpIDwgMCkgewogICAgICAgIGhlYXBbaW5kZXhdID0gcmlnaHQ7CiAgICAgICAgaGVhcFtyaWdodEluZGV4XSA9IG5vZGU7CiAgICAgICAgaW5kZXggPSByaWdodEluZGV4OwogICAgICB9IGVsc2UgewogICAgICAgIC8vIE5laXRoZXIgY2hpbGQgaXMgc21hbGxlci4gRXhpdC4KICAgICAgICByZXR1cm47CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIGNvbXBhcmUoYSwgYikgewogICAgLy8gQ29tcGFyZSBzb3J0IGluZGV4IGZpcnN0LCB0aGVuIHRhc2sgaWQuCiAgICB2YXIgZGlmZiA9IGEuc29ydEluZGV4IC0gYi5zb3J0SW5kZXg7CiAgICByZXR1cm4gZGlmZiAhPT0gMCA/IGRpZmYgOiBhLmlkIC0gYi5pZDsKICB9CgogIC8vIFRPRE86IFVzZSBzeW1ib2xzPwogIHZhciBJbW1lZGlhdGVQcmlvcml0eSA9IDE7CiAgdmFyIFVzZXJCbG9ja2luZ1ByaW9yaXR5ID0gMjsKICB2YXIgTm9ybWFsUHJpb3JpdHkgPSAzOwogIHZhciBMb3dQcmlvcml0eSA9IDQ7CiAgdmFyIElkbGVQcmlvcml0eSA9IDU7CgogIGZ1bmN0aW9uIG1hcmtUYXNrRXJyb3JlZCh0YXNrLCBtcykgewogIH0KCiAgLyogZXNsaW50LWRpc2FibGUgbm8tdmFyICovCiAgdmFyIGdldEN1cnJlbnRUaW1lOwogIHZhciBoYXNQZXJmb3JtYW5jZU5vdyA9IHR5cGVvZiBwZXJmb3JtYW5jZSA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIHBlcmZvcm1hbmNlLm5vdyA9PT0gJ2Z1bmN0aW9uJzsKCiAgaWYgKGhhc1BlcmZvcm1hbmNlTm93KSB7CiAgICB2YXIgbG9jYWxQZXJmb3JtYW5jZSA9IHBlcmZvcm1hbmNlOwoKICAgIGdldEN1cnJlbnRUaW1lID0gZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gbG9jYWxQZXJmb3JtYW5jZS5ub3coKTsKICAgIH07CiAgfSBlbHNlIHsKICAgIHZhciBsb2NhbERhdGUgPSBEYXRlOwogICAgdmFyIGluaXRpYWxUaW1lID0gbG9jYWxEYXRlLm5vdygpOwoKICAgIGdldEN1cnJlbnRUaW1lID0gZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gbG9jYWxEYXRlLm5vdygpIC0gaW5pdGlhbFRpbWU7CiAgICB9OwogIH0gLy8gTWF4IDMxIGJpdCBpbnRlZ2VyLiBUaGUgbWF4IGludGVnZXIgc2l6ZSBpbiBWOCBmb3IgMzItYml0IHN5c3RlbXMuCiAgLy8gTWF0aC5wb3coMiwgMzApIC0gMQogIC8vIDBiMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExCgoKICB2YXIgbWF4U2lnbmVkMzFCaXRJbnQgPSAxMDczNzQxODIzOyAvLyBUaW1lcyBvdXQgaW1tZWRpYXRlbHkKCiAgdmFyIElNTUVESUFURV9QUklPUklUWV9USU1FT1VUID0gLTE7IC8vIEV2ZW50dWFsbHkgdGltZXMgb3V0CgogIHZhciBVU0VSX0JMT0NLSU5HX1BSSU9SSVRZX1RJTUVPVVQgPSAyNTA7CiAgdmFyIE5PUk1BTF9QUklPUklUWV9USU1FT1VUID0gNTAwMDsKICB2YXIgTE9XX1BSSU9SSVRZX1RJTUVPVVQgPSAxMDAwMDsgLy8gTmV2ZXIgdGltZXMgb3V0CgogIHZhciBJRExFX1BSSU9SSVRZX1RJTUVPVVQgPSBtYXhTaWduZWQzMUJpdEludDsgLy8gVGFza3MgYXJlIHN0b3JlZCBvbiBhIG1pbiBoZWFwCgogIHZhciB0YXNrUXVldWUgPSBbXTsKICB2YXIgdGltZXJRdWV1ZSA9IFtdOyAvLyBJbmNyZW1lbnRpbmcgaWQgY291bnRlci4gVXNlZCB0byBtYWludGFpbiBpbnNlcnRpb24gb3JkZXIuCgogIHZhciB0YXNrSWRDb3VudGVyID0gMTsgLy8gUGF1c2luZyB0aGUgc2NoZWR1bGVyIGlzIHVzZWZ1bCBmb3IgZGVidWdnaW5nLgogIHZhciBjdXJyZW50VGFzayA9IG51bGw7CiAgdmFyIGN1cnJlbnRQcmlvcml0eUxldmVsID0gTm9ybWFsUHJpb3JpdHk7IC8vIFRoaXMgaXMgc2V0IHdoaWxlIHBlcmZvcm1pbmcgd29yaywgdG8gcHJldmVudCByZS1lbnRyYW5jZS4KCiAgdmFyIGlzUGVyZm9ybWluZ1dvcmsgPSBmYWxzZTsKICB2YXIgaXNIb3N0Q2FsbGJhY2tTY2hlZHVsZWQgPSBmYWxzZTsKICB2YXIgaXNIb3N0VGltZW91dFNjaGVkdWxlZCA9IGZhbHNlOyAvLyBDYXB0dXJlIGxvY2FsIHJlZmVyZW5jZXMgdG8gbmF0aXZlIEFQSXMsIGluIGNhc2UgYSBwb2x5ZmlsbCBvdmVycmlkZXMgdGhlbS4KCiAgdmFyIGxvY2FsU2V0VGltZW91dCA9IHR5cGVvZiBzZXRUaW1lb3V0ID09PSAnZnVuY3Rpb24nID8gc2V0VGltZW91dCA6IG51bGw7CiAgdmFyIGxvY2FsQ2xlYXJUaW1lb3V0ID0gdHlwZW9mIGNsZWFyVGltZW91dCA9PT0gJ2Z1bmN0aW9uJyA/IGNsZWFyVGltZW91dCA6IG51bGw7CiAgdmFyIGxvY2FsU2V0SW1tZWRpYXRlID0gdHlwZW9mIHNldEltbWVkaWF0ZSAhPT0gJ3VuZGVmaW5lZCcgPyBzZXRJbW1lZGlhdGUgOiBudWxsOyAvLyBJRSBhbmQgTm9kZS5qcyArIGpzZG9tCgogIHZhciBpc0lucHV0UGVuZGluZyA9IHR5cGVvZiBuYXZpZ2F0b3IgIT09ICd1bmRlZmluZWQnICYmIG5hdmlnYXRvci5zY2hlZHVsaW5nICE9PSB1bmRlZmluZWQgJiYgbmF2aWdhdG9yLnNjaGVkdWxpbmcuaXNJbnB1dFBlbmRpbmcgIT09IHVuZGVmaW5lZCA/IG5hdmlnYXRvci5zY2hlZHVsaW5nLmlzSW5wdXRQZW5kaW5nLmJpbmQobmF2aWdhdG9yLnNjaGVkdWxpbmcpIDogbnVsbDsKCiAgZnVuY3Rpb24gYWR2YW5jZVRpbWVycyhjdXJyZW50VGltZSkgewogICAgLy8gQ2hlY2sgZm9yIHRhc2tzIHRoYXQgYXJlIG5vIGxvbmdlciBkZWxheWVkIGFuZCBhZGQgdGhlbSB0byB0aGUgcXVldWUuCiAgICB2YXIgdGltZXIgPSBwZWVrKHRpbWVyUXVldWUpOwoKICAgIHdoaWxlICh0aW1lciAhPT0gbnVsbCkgewogICAgICBpZiAodGltZXIuY2FsbGJhY2sgPT09IG51bGwpIHsKICAgICAgICAvLyBUaW1lciB3YXMgY2FuY2VsbGVkLgogICAgICAgIHBvcCh0aW1lclF1ZXVlKTsKICAgICAgfSBlbHNlIGlmICh0aW1lci5zdGFydFRpbWUgPD0gY3VycmVudFRpbWUpIHsKICAgICAgICAvLyBUaW1lciBmaXJlZC4gVHJhbnNmZXIgdG8gdGhlIHRhc2sgcXVldWUuCiAgICAgICAgcG9wKHRpbWVyUXVldWUpOwogICAgICAgIHRpbWVyLnNvcnRJbmRleCA9IHRpbWVyLmV4cGlyYXRpb25UaW1lOwogICAgICAgIHB1c2godGFza1F1ZXVlLCB0aW1lcik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gUmVtYWluaW5nIHRpbWVycyBhcmUgcGVuZGluZy4KICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRpbWVyID0gcGVlayh0aW1lclF1ZXVlKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGhhbmRsZVRpbWVvdXQoY3VycmVudFRpbWUpIHsKICAgIGlzSG9zdFRpbWVvdXRTY2hlZHVsZWQgPSBmYWxzZTsKICAgIGFkdmFuY2VUaW1lcnMoY3VycmVudFRpbWUpOwoKICAgIGlmICghaXNIb3N0Q2FsbGJhY2tTY2hlZHVsZWQpIHsKICAgICAgaWYgKHBlZWsodGFza1F1ZXVlKSAhPT0gbnVsbCkgewogICAgICAgIGlzSG9zdENhbGxiYWNrU2NoZWR1bGVkID0gdHJ1ZTsKICAgICAgICByZXF1ZXN0SG9zdENhbGxiYWNrKGZsdXNoV29yayk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFyIGZpcnN0VGltZXIgPSBwZWVrKHRpbWVyUXVldWUpOwoKICAgICAgICBpZiAoZmlyc3RUaW1lciAhPT0gbnVsbCkgewogICAgICAgICAgcmVxdWVzdEhvc3RUaW1lb3V0KGhhbmRsZVRpbWVvdXQsIGZpcnN0VGltZXIuc3RhcnRUaW1lIC0gY3VycmVudFRpbWUpOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gZmx1c2hXb3JrKGhhc1RpbWVSZW1haW5pbmcsIGluaXRpYWxUaW1lKSB7CgoKICAgIGlzSG9zdENhbGxiYWNrU2NoZWR1bGVkID0gZmFsc2U7CgogICAgaWYgKGlzSG9zdFRpbWVvdXRTY2hlZHVsZWQpIHsKICAgICAgLy8gV2Ugc2NoZWR1bGVkIGEgdGltZW91dCBidXQgaXQncyBubyBsb25nZXIgbmVlZGVkLiBDYW5jZWwgaXQuCiAgICAgIGlzSG9zdFRpbWVvdXRTY2hlZHVsZWQgPSBmYWxzZTsKICAgICAgY2FuY2VsSG9zdFRpbWVvdXQoKTsKICAgIH0KCiAgICBpc1BlcmZvcm1pbmdXb3JrID0gdHJ1ZTsKICAgIHZhciBwcmV2aW91c1ByaW9yaXR5TGV2ZWwgPSBjdXJyZW50UHJpb3JpdHlMZXZlbDsKCiAgICB0cnkgewogICAgICBpZiAoZW5hYmxlUHJvZmlsaW5nKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIHJldHVybiB3b3JrTG9vcChoYXNUaW1lUmVtYWluaW5nLCBpbml0aWFsVGltZSk7CiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgIGlmIChjdXJyZW50VGFzayAhPT0gbnVsbCkgewogICAgICAgICAgICB2YXIgY3VycmVudFRpbWUgPSBnZXRDdXJyZW50VGltZSgpOwogICAgICAgICAgICBtYXJrVGFza0Vycm9yZWQoY3VycmVudFRhc2ssIGN1cnJlbnRUaW1lKTsKICAgICAgICAgICAgY3VycmVudFRhc2suaXNRdWV1ZWQgPSBmYWxzZTsKICAgICAgICAgIH0KCiAgICAgICAgICB0aHJvdyBlcnJvcjsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gTm8gY2F0Y2ggaW4gcHJvZCBjb2RlIHBhdGguCiAgICAgICAgcmV0dXJuIHdvcmtMb29wKGhhc1RpbWVSZW1haW5pbmcsIGluaXRpYWxUaW1lKTsKICAgICAgfQogICAgfSBmaW5hbGx5IHsKICAgICAgY3VycmVudFRhc2sgPSBudWxsOwogICAgICBjdXJyZW50UHJpb3JpdHlMZXZlbCA9IHByZXZpb3VzUHJpb3JpdHlMZXZlbDsKICAgICAgaXNQZXJmb3JtaW5nV29yayA9IGZhbHNlOwogICAgfQogIH0KCiAgZnVuY3Rpb24gd29ya0xvb3AoaGFzVGltZVJlbWFpbmluZywgaW5pdGlhbFRpbWUpIHsKICAgIHZhciBjdXJyZW50VGltZSA9IGluaXRpYWxUaW1lOwogICAgYWR2YW5jZVRpbWVycyhjdXJyZW50VGltZSk7CiAgICBjdXJyZW50VGFzayA9IHBlZWsodGFza1F1ZXVlKTsKCiAgICB3aGlsZSAoY3VycmVudFRhc2sgIT09IG51bGwgJiYgIShlbmFibGVTY2hlZHVsZXJEZWJ1Z2dpbmcgKSkgewogICAgICBpZiAoY3VycmVudFRhc2suZXhwaXJhdGlvblRpbWUgPiBjdXJyZW50VGltZSAmJiAoIWhhc1RpbWVSZW1haW5pbmcgfHwgc2hvdWxkWWllbGRUb0hvc3QoKSkpIHsKICAgICAgICAvLyBUaGlzIGN1cnJlbnRUYXNrIGhhc24ndCBleHBpcmVkLCBhbmQgd2UndmUgcmVhY2hlZCB0aGUgZGVhZGxpbmUuCiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIHZhciBjYWxsYmFjayA9IGN1cnJlbnRUYXNrLmNhbGxiYWNrOwoKICAgICAgaWYgKHR5cGVvZiBjYWxsYmFjayA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIGN1cnJlbnRUYXNrLmNhbGxiYWNrID0gbnVsbDsKICAgICAgICBjdXJyZW50UHJpb3JpdHlMZXZlbCA9IGN1cnJlbnRUYXNrLnByaW9yaXR5TGV2ZWw7CiAgICAgICAgdmFyIGRpZFVzZXJDYWxsYmFja1RpbWVvdXQgPSBjdXJyZW50VGFzay5leHBpcmF0aW9uVGltZSA8PSBjdXJyZW50VGltZTsKCiAgICAgICAgdmFyIGNvbnRpbnVhdGlvbkNhbGxiYWNrID0gY2FsbGJhY2soZGlkVXNlckNhbGxiYWNrVGltZW91dCk7CiAgICAgICAgY3VycmVudFRpbWUgPSBnZXRDdXJyZW50VGltZSgpOwoKICAgICAgICBpZiAodHlwZW9mIGNvbnRpbnVhdGlvbkNhbGxiYWNrID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICBjdXJyZW50VGFzay5jYWxsYmFjayA9IGNvbnRpbnVhdGlvbkNhbGxiYWNrOwogICAgICAgIH0gZWxzZSB7CgogICAgICAgICAgaWYgKGN1cnJlbnRUYXNrID09PSBwZWVrKHRhc2tRdWV1ZSkpIHsKICAgICAgICAgICAgcG9wKHRhc2tRdWV1ZSk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBhZHZhbmNlVGltZXJzKGN1cnJlbnRUaW1lKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBwb3AodGFza1F1ZXVlKTsKICAgICAgfQoKICAgICAgY3VycmVudFRhc2sgPSBwZWVrKHRhc2tRdWV1ZSk7CiAgICB9IC8vIFJldHVybiB3aGV0aGVyIHRoZXJlJ3MgYWRkaXRpb25hbCB3b3JrCgoKICAgIGlmIChjdXJyZW50VGFzayAhPT0gbnVsbCkgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0gZWxzZSB7CiAgICAgIHZhciBmaXJzdFRpbWVyID0gcGVlayh0aW1lclF1ZXVlKTsKCiAgICAgIGlmIChmaXJzdFRpbWVyICE9PSBudWxsKSB7CiAgICAgICAgcmVxdWVzdEhvc3RUaW1lb3V0KGhhbmRsZVRpbWVvdXQsIGZpcnN0VGltZXIuc3RhcnRUaW1lIC0gY3VycmVudFRpbWUpOwogICAgICB9CgogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfQoKICBmdW5jdGlvbiB1bnN0YWJsZV9ydW5XaXRoUHJpb3JpdHkocHJpb3JpdHlMZXZlbCwgZXZlbnRIYW5kbGVyKSB7CiAgICBzd2l0Y2ggKHByaW9yaXR5TGV2ZWwpIHsKICAgICAgY2FzZSBJbW1lZGlhdGVQcmlvcml0eToKICAgICAgY2FzZSBVc2VyQmxvY2tpbmdQcmlvcml0eToKICAgICAgY2FzZSBOb3JtYWxQcmlvcml0eToKICAgICAgY2FzZSBMb3dQcmlvcml0eToKICAgICAgY2FzZSBJZGxlUHJpb3JpdHk6CiAgICAgICAgYnJlYWs7CgogICAgICBkZWZhdWx0OgogICAgICAgIHByaW9yaXR5TGV2ZWwgPSBOb3JtYWxQcmlvcml0eTsKICAgIH0KCiAgICB2YXIgcHJldmlvdXNQcmlvcml0eUxldmVsID0gY3VycmVudFByaW9yaXR5TGV2ZWw7CiAgICBjdXJyZW50UHJpb3JpdHlMZXZlbCA9IHByaW9yaXR5TGV2ZWw7CgogICAgdHJ5IHsKICAgICAgcmV0dXJuIGV2ZW50SGFuZGxlcigpOwogICAgfSBmaW5hbGx5IHsKICAgICAgY3VycmVudFByaW9yaXR5TGV2ZWwgPSBwcmV2aW91c1ByaW9yaXR5TGV2ZWw7CiAgICB9CiAgfQoKICBmdW5jdGlvbiB1bnN0YWJsZV9uZXh0KGV2ZW50SGFuZGxlcikgewogICAgdmFyIHByaW9yaXR5TGV2ZWw7CgogICAgc3dpdGNoIChjdXJyZW50UHJpb3JpdHlMZXZlbCkgewogICAgICBjYXNlIEltbWVkaWF0ZVByaW9yaXR5OgogICAgICBjYXNlIFVzZXJCbG9ja2luZ1ByaW9yaXR5OgogICAgICBjYXNlIE5vcm1hbFByaW9yaXR5OgogICAgICAgIC8vIFNoaWZ0IGRvd24gdG8gbm9ybWFsIHByaW9yaXR5CiAgICAgICAgcHJpb3JpdHlMZXZlbCA9IE5vcm1hbFByaW9yaXR5OwogICAgICAgIGJyZWFrOwoKICAgICAgZGVmYXVsdDoKICAgICAgICAvLyBBbnl0aGluZyBsb3dlciB0aGFuIG5vcm1hbCBwcmlvcml0eSBzaG91bGQgcmVtYWluIGF0IHRoZSBjdXJyZW50IGxldmVsLgogICAgICAgIHByaW9yaXR5TGV2ZWwgPSBjdXJyZW50UHJpb3JpdHlMZXZlbDsKICAgICAgICBicmVhazsKICAgIH0KCiAgICB2YXIgcHJldmlvdXNQcmlvcml0eUxldmVsID0gY3VycmVudFByaW9yaXR5TGV2ZWw7CiAgICBjdXJyZW50UHJpb3JpdHlMZXZlbCA9IHByaW9yaXR5TGV2ZWw7CgogICAgdHJ5IHsKICAgICAgcmV0dXJuIGV2ZW50SGFuZGxlcigpOwogICAgfSBmaW5hbGx5IHsKICAgICAgY3VycmVudFByaW9yaXR5TGV2ZWwgPSBwcmV2aW91c1ByaW9yaXR5TGV2ZWw7CiAgICB9CiAgfQoKICBmdW5jdGlvbiB1bnN0YWJsZV93cmFwQ2FsbGJhY2soY2FsbGJhY2spIHsKICAgIHZhciBwYXJlbnRQcmlvcml0eUxldmVsID0gY3VycmVudFByaW9yaXR5TGV2ZWw7CiAgICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICAvLyBUaGlzIGlzIGEgZm9yayBvZiBydW5XaXRoUHJpb3JpdHksIGlubGluZWQgZm9yIHBlcmZvcm1hbmNlLgogICAgICB2YXIgcHJldmlvdXNQcmlvcml0eUxldmVsID0gY3VycmVudFByaW9yaXR5TGV2ZWw7CiAgICAgIGN1cnJlbnRQcmlvcml0eUxldmVsID0gcGFyZW50UHJpb3JpdHlMZXZlbDsKCiAgICAgIHRyeSB7CiAgICAgICAgcmV0dXJuIGNhbGxiYWNrLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgY3VycmVudFByaW9yaXR5TGV2ZWwgPSBwcmV2aW91c1ByaW9yaXR5TGV2ZWw7CiAgICAgIH0KICAgIH07CiAgfQoKICBmdW5jdGlvbiB1bnN0YWJsZV9zY2hlZHVsZUNhbGxiYWNrKHByaW9yaXR5TGV2ZWwsIGNhbGxiYWNrLCBvcHRpb25zKSB7CiAgICB2YXIgY3VycmVudFRpbWUgPSBnZXRDdXJyZW50VGltZSgpOwogICAgdmFyIHN0YXJ0VGltZTsKCiAgICBpZiAodHlwZW9mIG9wdGlvbnMgPT09ICdvYmplY3QnICYmIG9wdGlvbnMgIT09IG51bGwpIHsKICAgICAgdmFyIGRlbGF5ID0gb3B0aW9ucy5kZWxheTsKCiAgICAgIGlmICh0eXBlb2YgZGVsYXkgPT09ICdudW1iZXInICYmIGRlbGF5ID4gMCkgewogICAgICAgIHN0YXJ0VGltZSA9IGN1cnJlbnRUaW1lICsgZGVsYXk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc3RhcnRUaW1lID0gY3VycmVudFRpbWU7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHN0YXJ0VGltZSA9IGN1cnJlbnRUaW1lOwogICAgfQoKICAgIHZhciB0aW1lb3V0OwoKICAgIHN3aXRjaCAocHJpb3JpdHlMZXZlbCkgewogICAgICBjYXNlIEltbWVkaWF0ZVByaW9yaXR5OgogICAgICAgIHRpbWVvdXQgPSBJTU1FRElBVEVfUFJJT1JJVFlfVElNRU9VVDsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgVXNlckJsb2NraW5nUHJpb3JpdHk6CiAgICAgICAgdGltZW91dCA9IFVTRVJfQkxPQ0tJTkdfUFJJT1JJVFlfVElNRU9VVDsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgSWRsZVByaW9yaXR5OgogICAgICAgIHRpbWVvdXQgPSBJRExFX1BSSU9SSVRZX1RJTUVPVVQ7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIExvd1ByaW9yaXR5OgogICAgICAgIHRpbWVvdXQgPSBMT1dfUFJJT1JJVFlfVElNRU9VVDsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgTm9ybWFsUHJpb3JpdHk6CiAgICAgIGRlZmF1bHQ6CiAgICAgICAgdGltZW91dCA9IE5PUk1BTF9QUklPUklUWV9USU1FT1VUOwogICAgICAgIGJyZWFrOwogICAgfQoKICAgIHZhciBleHBpcmF0aW9uVGltZSA9IHN0YXJ0VGltZSArIHRpbWVvdXQ7CiAgICB2YXIgbmV3VGFzayA9IHsKICAgICAgaWQ6IHRhc2tJZENvdW50ZXIrKywKICAgICAgY2FsbGJhY2s6IGNhbGxiYWNrLAogICAgICBwcmlvcml0eUxldmVsOiBwcmlvcml0eUxldmVsLAogICAgICBzdGFydFRpbWU6IHN0YXJ0VGltZSwKICAgICAgZXhwaXJhdGlvblRpbWU6IGV4cGlyYXRpb25UaW1lLAogICAgICBzb3J0SW5kZXg6IC0xCiAgICB9OwoKICAgIGlmIChzdGFydFRpbWUgPiBjdXJyZW50VGltZSkgewogICAgICAvLyBUaGlzIGlzIGEgZGVsYXllZCB0YXNrLgogICAgICBuZXdUYXNrLnNvcnRJbmRleCA9IHN0YXJ0VGltZTsKICAgICAgcHVzaCh0aW1lclF1ZXVlLCBuZXdUYXNrKTsKCiAgICAgIGlmIChwZWVrKHRhc2tRdWV1ZSkgPT09IG51bGwgJiYgbmV3VGFzayA9PT0gcGVlayh0aW1lclF1ZXVlKSkgewogICAgICAgIC8vIEFsbCB0YXNrcyBhcmUgZGVsYXllZCwgYW5kIHRoaXMgaXMgdGhlIHRhc2sgd2l0aCB0aGUgZWFybGllc3QgZGVsYXkuCiAgICAgICAgaWYgKGlzSG9zdFRpbWVvdXRTY2hlZHVsZWQpIHsKICAgICAgICAgIC8vIENhbmNlbCBhbiBleGlzdGluZyB0aW1lb3V0LgogICAgICAgICAgY2FuY2VsSG9zdFRpbWVvdXQoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaXNIb3N0VGltZW91dFNjaGVkdWxlZCA9IHRydWU7CiAgICAgICAgfSAvLyBTY2hlZHVsZSBhIHRpbWVvdXQuCgoKICAgICAgICByZXF1ZXN0SG9zdFRpbWVvdXQoaGFuZGxlVGltZW91dCwgc3RhcnRUaW1lIC0gY3VycmVudFRpbWUpOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBuZXdUYXNrLnNvcnRJbmRleCA9IGV4cGlyYXRpb25UaW1lOwogICAgICBwdXNoKHRhc2tRdWV1ZSwgbmV3VGFzayk7CiAgICAgIC8vIHdhaXQgdW50aWwgdGhlIG5leHQgdGltZSB3ZSB5aWVsZC4KCgogICAgICBpZiAoIWlzSG9zdENhbGxiYWNrU2NoZWR1bGVkICYmICFpc1BlcmZvcm1pbmdXb3JrKSB7CiAgICAgICAgaXNIb3N0Q2FsbGJhY2tTY2hlZHVsZWQgPSB0cnVlOwogICAgICAgIHJlcXVlc3RIb3N0Q2FsbGJhY2soZmx1c2hXb3JrKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBuZXdUYXNrOwogIH0KCiAgZnVuY3Rpb24gdW5zdGFibGVfcGF1c2VFeGVjdXRpb24oKSB7CiAgfQoKICBmdW5jdGlvbiB1bnN0YWJsZV9jb250aW51ZUV4ZWN1dGlvbigpIHsKCiAgICBpZiAoIWlzSG9zdENhbGxiYWNrU2NoZWR1bGVkICYmICFpc1BlcmZvcm1pbmdXb3JrKSB7CiAgICAgIGlzSG9zdENhbGxiYWNrU2NoZWR1bGVkID0gdHJ1ZTsKICAgICAgcmVxdWVzdEhvc3RDYWxsYmFjayhmbHVzaFdvcmspOwogICAgfQogIH0KCiAgZnVuY3Rpb24gdW5zdGFibGVfZ2V0Rmlyc3RDYWxsYmFja05vZGUoKSB7CiAgICByZXR1cm4gcGVlayh0YXNrUXVldWUpOwogIH0KCiAgZnVuY3Rpb24gdW5zdGFibGVfY2FuY2VsQ2FsbGJhY2sodGFzaykgewogICAgLy8gcmVtb3ZlIGZyb20gdGhlIHF1ZXVlIGJlY2F1c2UgeW91IGNhbid0IHJlbW92ZSBhcmJpdHJhcnkgbm9kZXMgZnJvbSBhbgogICAgLy8gYXJyYXkgYmFzZWQgaGVhcCwgb25seSB0aGUgZmlyc3Qgb25lLikKCgogICAgdGFzay5jYWxsYmFjayA9IG51bGw7CiAgfQoKICBmdW5jdGlvbiB1bnN0YWJsZV9nZXRDdXJyZW50UHJpb3JpdHlMZXZlbCgpIHsKICAgIHJldHVybiBjdXJyZW50UHJpb3JpdHlMZXZlbDsKICB9CgogIHZhciBpc01lc3NhZ2VMb29wUnVubmluZyA9IGZhbHNlOwogIHZhciBzY2hlZHVsZWRIb3N0Q2FsbGJhY2sgPSBudWxsOwogIHZhciB0YXNrVGltZW91dElEID0gLTE7IC8vIFNjaGVkdWxlciBwZXJpb2RpY2FsbHkgeWllbGRzIGluIGNhc2UgdGhlcmUgaXMgb3RoZXIgd29yayBvbiB0aGUgbWFpbgogIC8vIHRocmVhZCwgbGlrZSB1c2VyIGV2ZW50cy4gQnkgZGVmYXVsdCwgaXQgeWllbGRzIG11bHRpcGxlIHRpbWVzIHBlciBmcmFtZS4KICAvLyBJdCBkb2VzIG5vdCBhdHRlbXB0IHRvIGFsaWduIHdpdGggZnJhbWUgYm91bmRhcmllcywgc2luY2UgbW9zdCB0YXNrcyBkb24ndAogIC8vIG5lZWQgdG8gYmUgZnJhbWUgYWxpZ25lZDsgZm9yIHRob3NlIHRoYXQgZG8sIHVzZSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUuCgogIHZhciBmcmFtZUludGVydmFsID0gZnJhbWVZaWVsZE1zOwogIHZhciBzdGFydFRpbWUgPSAtMTsKCiAgZnVuY3Rpb24gc2hvdWxkWWllbGRUb0hvc3QoKSB7CiAgICB2YXIgdGltZUVsYXBzZWQgPSBnZXRDdXJyZW50VGltZSgpIC0gc3RhcnRUaW1lOwoKICAgIGlmICh0aW1lRWxhcHNlZCA8IGZyYW1lSW50ZXJ2YWwpIHsKICAgICAgLy8gVGhlIG1haW4gdGhyZWFkIGhhcyBvbmx5IGJlZW4gYmxvY2tlZCBmb3IgYSByZWFsbHkgc2hvcnQgYW1vdW50IG9mIHRpbWU7CiAgICAgIC8vIHNtYWxsZXIgdGhhbiBhIHNpbmdsZSBmcmFtZS4gRG9uJ3QgeWllbGQgeWV0LgogICAgICByZXR1cm4gZmFsc2U7CiAgICB9IC8vIFRoZSBtYWluIHRocmVhZCBoYXMgYmVlbiBibG9ja2VkIGZvciBhIG5vbi1uZWdsaWdpYmxlIGFtb3VudCBvZiB0aW1lLiBXZQoKCiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGZ1bmN0aW9uIHJlcXVlc3RQYWludCgpIHsKCiAgfQoKICBmdW5jdGlvbiBmb3JjZUZyYW1lUmF0ZShmcHMpIHsKICAgIGlmIChmcHMgPCAwIHx8IGZwcyA+IDEyNSkgewogICAgICAvLyBVc2luZyBjb25zb2xlWydlcnJvciddIHRvIGV2YWRlIEJhYmVsIGFuZCBFU0xpbnQKICAgICAgY29uc29sZVsnZXJyb3InXSgnZm9yY2VGcmFtZVJhdGUgdGFrZXMgYSBwb3NpdGl2ZSBpbnQgYmV0d2VlbiAwIGFuZCAxMjUsICcgKyAnZm9yY2luZyBmcmFtZSByYXRlcyBoaWdoZXIgdGhhbiAxMjUgZnBzIGlzIG5vdCBzdXBwb3J0ZWQnKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmIChmcHMgPiAwKSB7CiAgICAgIGZyYW1lSW50ZXJ2YWwgPSBNYXRoLmZsb29yKDEwMDAgLyBmcHMpOwogICAgfSBlbHNlIHsKICAgICAgLy8gcmVzZXQgdGhlIGZyYW1lcmF0ZQogICAgICBmcmFtZUludGVydmFsID0gZnJhbWVZaWVsZE1zOwogICAgfQogIH0KCiAgdmFyIHBlcmZvcm1Xb3JrVW50aWxEZWFkbGluZSA9IGZ1bmN0aW9uICgpIHsKICAgIGlmIChzY2hlZHVsZWRIb3N0Q2FsbGJhY2sgIT09IG51bGwpIHsKICAgICAgdmFyIGN1cnJlbnRUaW1lID0gZ2V0Q3VycmVudFRpbWUoKTsgLy8gS2VlcCB0cmFjayBvZiB0aGUgc3RhcnQgdGltZSBzbyB3ZSBjYW4gbWVhc3VyZSBob3cgbG9uZyB0aGUgbWFpbiB0aHJlYWQKICAgICAgLy8gaGFzIGJlZW4gYmxvY2tlZC4KCiAgICAgIHN0YXJ0VGltZSA9IGN1cnJlbnRUaW1lOwogICAgICB2YXIgaGFzVGltZVJlbWFpbmluZyA9IHRydWU7IC8vIElmIGEgc2NoZWR1bGVyIHRhc2sgdGhyb3dzLCBleGl0IHRoZSBjdXJyZW50IGJyb3dzZXIgdGFzayBzbyB0aGUKICAgICAgLy8gZXJyb3IgY2FuIGJlIG9ic2VydmVkLgogICAgICAvLwogICAgICAvLyBJbnRlbnRpb25hbGx5IG5vdCB1c2luZyBhIHRyeS1jYXRjaCwgc2luY2UgdGhhdCBtYWtlcyBzb21lIGRlYnVnZ2luZwogICAgICAvLyB0ZWNobmlxdWVzIGhhcmRlci4gSW5zdGVhZCwgaWYgYHNjaGVkdWxlZEhvc3RDYWxsYmFja2AgZXJyb3JzLCB0aGVuCiAgICAgIC8vIGBoYXNNb3JlV29ya2Agd2lsbCByZW1haW4gdHJ1ZSwgYW5kIHdlJ2xsIGNvbnRpbnVlIHRoZSB3b3JrIGxvb3AuCgogICAgICB2YXIgaGFzTW9yZVdvcmsgPSB0cnVlOwoKICAgICAgdHJ5IHsKICAgICAgICBoYXNNb3JlV29yayA9IHNjaGVkdWxlZEhvc3RDYWxsYmFjayhoYXNUaW1lUmVtYWluaW5nLCBjdXJyZW50VGltZSk7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgaWYgKGhhc01vcmVXb3JrKSB7CiAgICAgICAgICAvLyBJZiB0aGVyZSdzIG1vcmUgd29yaywgc2NoZWR1bGUgdGhlIG5leHQgbWVzc2FnZSBldmVudCBhdCB0aGUgZW5kCiAgICAgICAgICAvLyBvZiB0aGUgcHJlY2VkaW5nIG9uZS4KICAgICAgICAgIHNjaGVkdWxlUGVyZm9ybVdvcmtVbnRpbERlYWRsaW5lKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlzTWVzc2FnZUxvb3BSdW5uaW5nID0gZmFsc2U7CiAgICAgICAgICBzY2hlZHVsZWRIb3N0Q2FsbGJhY2sgPSBudWxsOwogICAgICAgIH0KICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgaXNNZXNzYWdlTG9vcFJ1bm5pbmcgPSBmYWxzZTsKICAgIH0gLy8gWWllbGRpbmcgdG8gdGhlIGJyb3dzZXIgd2lsbCBnaXZlIGl0IGEgY2hhbmNlIHRvIHBhaW50LCBzbyB3ZSBjYW4KICB9OwoKICB2YXIgc2NoZWR1bGVQZXJmb3JtV29ya1VudGlsRGVhZGxpbmU7CgogIGlmICh0eXBlb2YgbG9jYWxTZXRJbW1lZGlhdGUgPT09ICdmdW5jdGlvbicpIHsKICAgIC8vIE5vZGUuanMgYW5kIG9sZCBJRS4KICAgIC8vIFRoZXJlJ3MgYSBmZXcgcmVhc29ucyBmb3Igd2h5IHdlIHByZWZlciBzZXRJbW1lZGlhdGUuCiAgICAvLwogICAgLy8gVW5saWtlIE1lc3NhZ2VDaGFubmVsLCBpdCBkb2Vzbid0IHByZXZlbnQgYSBOb2RlLmpzIHByb2Nlc3MgZnJvbSBleGl0aW5nLgogICAgLy8gKEV2ZW4gdGhvdWdoIHRoaXMgaXMgYSBET00gZm9yayBvZiB0aGUgU2NoZWR1bGVyLCB5b3UgY291bGQgZ2V0IGhlcmUKICAgIC8vIHdpdGggYSBtaXggb2YgTm9kZS5qcyAxNSssIHdoaWNoIGhhcyBhIE1lc3NhZ2VDaGFubmVsLCBhbmQganNkb20uKQogICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL3JlYWN0L2lzc3Vlcy8yMDc1NgogICAgLy8KICAgIC8vIEJ1dCBhbHNvLCBpdCBydW5zIGVhcmxpZXIgd2hpY2ggaXMgdGhlIHNlbWFudGljIHdlIHdhbnQuCiAgICAvLyBJZiBvdGhlciBicm93c2VycyBldmVyIGltcGxlbWVudCBpdCwgaXQncyBiZXR0ZXIgdG8gdXNlIGl0LgogICAgLy8gQWx0aG91Z2ggYm90aCBvZiB0aGVzZSB3b3VsZCBiZSBpbmZlcmlvciB0byBuYXRpdmUgc2NoZWR1bGluZy4KICAgIHNjaGVkdWxlUGVyZm9ybVdvcmtVbnRpbERlYWRsaW5lID0gZnVuY3Rpb24gKCkgewogICAgICBsb2NhbFNldEltbWVkaWF0ZShwZXJmb3JtV29ya1VudGlsRGVhZGxpbmUpOwogICAgfTsKICB9IGVsc2UgaWYgKHR5cGVvZiBNZXNzYWdlQ2hhbm5lbCAhPT0gJ3VuZGVmaW5lZCcpIHsKICAgIC8vIERPTSBhbmQgV29ya2VyIGVudmlyb25tZW50cy4KICAgIC8vIFdlIHByZWZlciBNZXNzYWdlQ2hhbm5lbCBiZWNhdXNlIG9mIHRoZSA0bXMgc2V0VGltZW91dCBjbGFtcGluZy4KICAgIHZhciBjaGFubmVsID0gbmV3IE1lc3NhZ2VDaGFubmVsKCk7CiAgICB2YXIgcG9ydCA9IGNoYW5uZWwucG9ydDI7CiAgICBjaGFubmVsLnBvcnQxLm9ubWVzc2FnZSA9IHBlcmZvcm1Xb3JrVW50aWxEZWFkbGluZTsKCiAgICBzY2hlZHVsZVBlcmZvcm1Xb3JrVW50aWxEZWFkbGluZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgcG9ydC5wb3N0TWVzc2FnZShudWxsKTsKICAgIH07CiAgfSBlbHNlIHsKICAgIC8vIFdlIHNob3VsZCBvbmx5IGZhbGxiYWNrIGhlcmUgaW4gbm9uLWJyb3dzZXIgZW52aXJvbm1lbnRzLgogICAgc2NoZWR1bGVQZXJmb3JtV29ya1VudGlsRGVhZGxpbmUgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGxvY2FsU2V0VGltZW91dChwZXJmb3JtV29ya1VudGlsRGVhZGxpbmUsIDApOwogICAgfTsKICB9CgogIGZ1bmN0aW9uIHJlcXVlc3RIb3N0Q2FsbGJhY2soY2FsbGJhY2spIHsKICAgIHNjaGVkdWxlZEhvc3RDYWxsYmFjayA9IGNhbGxiYWNrOwoKICAgIGlmICghaXNNZXNzYWdlTG9vcFJ1bm5pbmcpIHsKICAgICAgaXNNZXNzYWdlTG9vcFJ1bm5pbmcgPSB0cnVlOwogICAgICBzY2hlZHVsZVBlcmZvcm1Xb3JrVW50aWxEZWFkbGluZSgpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gcmVxdWVzdEhvc3RUaW1lb3V0KGNhbGxiYWNrLCBtcykgewogICAgdGFza1RpbWVvdXRJRCA9IGxvY2FsU2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgIGNhbGxiYWNrKGdldEN1cnJlbnRUaW1lKCkpOwogICAgfSwgbXMpOwogIH0KCiAgZnVuY3Rpb24gY2FuY2VsSG9zdFRpbWVvdXQoKSB7CiAgICBsb2NhbENsZWFyVGltZW91dCh0YXNrVGltZW91dElEKTsKICAgIHRhc2tUaW1lb3V0SUQgPSAtMTsKICB9CgogIHZhciB1bnN0YWJsZV9yZXF1ZXN0UGFpbnQgPSByZXF1ZXN0UGFpbnQ7CiAgdmFyIHVuc3RhYmxlX1Byb2ZpbGluZyA9ICBudWxsOwoKCgogIHZhciBTY2hlZHVsZXIgPSAvKiNfX1BVUkVfXyovT2JqZWN0LmZyZWV6ZSh7CiAgICBfX3Byb3RvX186IG51bGwsCiAgICB1bnN0YWJsZV9JbW1lZGlhdGVQcmlvcml0eTogSW1tZWRpYXRlUHJpb3JpdHksCiAgICB1bnN0YWJsZV9Vc2VyQmxvY2tpbmdQcmlvcml0eTogVXNlckJsb2NraW5nUHJpb3JpdHksCiAgICB1bnN0YWJsZV9Ob3JtYWxQcmlvcml0eTogTm9ybWFsUHJpb3JpdHksCiAgICB1bnN0YWJsZV9JZGxlUHJpb3JpdHk6IElkbGVQcmlvcml0eSwKICAgIHVuc3RhYmxlX0xvd1ByaW9yaXR5OiBMb3dQcmlvcml0eSwKICAgIHVuc3RhYmxlX3J1bldpdGhQcmlvcml0eTogdW5zdGFibGVfcnVuV2l0aFByaW9yaXR5LAogICAgdW5zdGFibGVfbmV4dDogdW5zdGFibGVfbmV4dCwKICAgIHVuc3RhYmxlX3NjaGVkdWxlQ2FsbGJhY2s6IHVuc3RhYmxlX3NjaGVkdWxlQ2FsbGJhY2ssCiAgICB1bnN0YWJsZV9jYW5jZWxDYWxsYmFjazogdW5zdGFibGVfY2FuY2VsQ2FsbGJhY2ssCiAgICB1bnN0YWJsZV93cmFwQ2FsbGJhY2s6IHVuc3RhYmxlX3dyYXBDYWxsYmFjaywKICAgIHVuc3RhYmxlX2dldEN1cnJlbnRQcmlvcml0eUxldmVsOiB1bnN0YWJsZV9nZXRDdXJyZW50UHJpb3JpdHlMZXZlbCwKICAgIHVuc3RhYmxlX3Nob3VsZFlpZWxkOiBzaG91bGRZaWVsZFRvSG9zdCwKICAgIHVuc3RhYmxlX3JlcXVlc3RQYWludDogdW5zdGFibGVfcmVxdWVzdFBhaW50LAogICAgdW5zdGFibGVfY29udGludWVFeGVjdXRpb246IHVuc3RhYmxlX2NvbnRpbnVlRXhlY3V0aW9uLAogICAgdW5zdGFibGVfcGF1c2VFeGVjdXRpb246IHVuc3RhYmxlX3BhdXNlRXhlY3V0aW9uLAogICAgdW5zdGFibGVfZ2V0Rmlyc3RDYWxsYmFja05vZGU6IHVuc3RhYmxlX2dldEZpcnN0Q2FsbGJhY2tOb2RlLAogICAgZ2V0IHVuc3RhYmxlX25vdyAoKSB7IHJldHVybiBnZXRDdXJyZW50VGltZTsgfSwKICAgIHVuc3RhYmxlX2ZvcmNlRnJhbWVSYXRlOiBmb3JjZUZyYW1lUmF0ZSwKICAgIHVuc3RhYmxlX1Byb2ZpbGluZzogdW5zdGFibGVfUHJvZmlsaW5nCiAgfSk7CgogIHZhciBSZWFjdFNoYXJlZEludGVybmFscyQxID0gewogICAgUmVhY3RDdXJyZW50RGlzcGF0Y2hlcjogUmVhY3RDdXJyZW50RGlzcGF0Y2hlciwKICAgIFJlYWN0Q3VycmVudE93bmVyOiBSZWFjdEN1cnJlbnRPd25lciwKICAgIFJlYWN0Q3VycmVudEJhdGNoQ29uZmlnOiBSZWFjdEN1cnJlbnRCYXRjaENvbmZpZywKICAgIC8vIFJlLWV4cG9ydCB0aGUgc2NoZWR1bGUgQVBJKHMpIGZvciBVTUQgYnVuZGxlcy4KICAgIC8vIFRoaXMgYXZvaWRzIGludHJvZHVjaW5nIGEgZGVwZW5kZW5jeSBvbiBhIG5ldyBVTUQgZ2xvYmFsIGluIGEgbWlub3IgdXBkYXRlLAogICAgLy8gU2luY2UgdGhhdCB3b3VsZCBiZSBhIGJyZWFraW5nIGNoYW5nZSAoZS5nLiBmb3IgYWxsIGV4aXN0aW5nIENvZGVTYW5kYm94ZXMpLgogICAgLy8gVGhpcyByZS1leHBvcnQgaXMgb25seSByZXF1aXJlZCBmb3IgVU1EIGJ1bmRsZXM7CiAgICAvLyBDSlMgYnVuZGxlcyB1c2UgdGhlIHNoYXJlZCBOUE0gcGFja2FnZS4KICAgIFNjaGVkdWxlcjogU2NoZWR1bGVyCiAgfTsKCiAgewogICAgUmVhY3RTaGFyZWRJbnRlcm5hbHMkMS5SZWFjdEN1cnJlbnRBY3RRdWV1ZSA9IFJlYWN0Q3VycmVudEFjdFF1ZXVlOwogICAgUmVhY3RTaGFyZWRJbnRlcm5hbHMkMS5SZWFjdERlYnVnQ3VycmVudEZyYW1lID0gUmVhY3REZWJ1Z0N1cnJlbnRGcmFtZTsKICB9CgogIGZ1bmN0aW9uIHN0YXJ0VHJhbnNpdGlvbihzY29wZSwgb3B0aW9ucykgewogICAgdmFyIHByZXZUcmFuc2l0aW9uID0gUmVhY3RDdXJyZW50QmF0Y2hDb25maWcudHJhbnNpdGlvbjsKICAgIFJlYWN0Q3VycmVudEJhdGNoQ29uZmlnLnRyYW5zaXRpb24gPSB7fTsKICAgIHZhciBjdXJyZW50VHJhbnNpdGlvbiA9IFJlYWN0Q3VycmVudEJhdGNoQ29uZmlnLnRyYW5zaXRpb247CgogICAgewogICAgICBSZWFjdEN1cnJlbnRCYXRjaENvbmZpZy50cmFuc2l0aW9uLl91cGRhdGVkRmliZXJzID0gbmV3IFNldCgpOwogICAgfQoKICAgIHRyeSB7CiAgICAgIHNjb3BlKCk7CiAgICB9IGZpbmFsbHkgewogICAgICBSZWFjdEN1cnJlbnRCYXRjaENvbmZpZy50cmFuc2l0aW9uID0gcHJldlRyYW5zaXRpb247CgogICAgICB7CiAgICAgICAgaWYgKHByZXZUcmFuc2l0aW9uID09PSBudWxsICYmIGN1cnJlbnRUcmFuc2l0aW9uLl91cGRhdGVkRmliZXJzKSB7CiAgICAgICAgICB2YXIgdXBkYXRlZEZpYmVyc0NvdW50ID0gY3VycmVudFRyYW5zaXRpb24uX3VwZGF0ZWRGaWJlcnMuc2l6ZTsKCiAgICAgICAgICBpZiAodXBkYXRlZEZpYmVyc0NvdW50ID4gMTApIHsKICAgICAgICAgICAgd2FybignRGV0ZWN0ZWQgYSBsYXJnZSBudW1iZXIgb2YgdXBkYXRlcyBpbnNpZGUgc3RhcnRUcmFuc2l0aW9uLiAnICsgJ0lmIHRoaXMgaXMgZHVlIHRvIGEgc3Vic2NyaXB0aW9uIHBsZWFzZSByZS13cml0ZSBpdCB0byB1c2UgUmVhY3QgcHJvdmlkZWQgaG9va3MuICcgKyAnT3RoZXJ3aXNlIGNvbmN1cnJlbnQgbW9kZSBndWFyYW50ZWVzIGFyZSBvZmYgdGhlIHRhYmxlLicpOwogICAgICAgICAgfQoKICAgICAgICAgIGN1cnJlbnRUcmFuc2l0aW9uLl91cGRhdGVkRmliZXJzLmNsZWFyKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQoKICB2YXIgZGlkV2FybkFib3V0TWVzc2FnZUNoYW5uZWwgPSBmYWxzZTsKICB2YXIgZW5xdWV1ZVRhc2tJbXBsID0gbnVsbDsKICBmdW5jdGlvbiBlbnF1ZXVlVGFzayh0YXNrKSB7CiAgICBpZiAoZW5xdWV1ZVRhc2tJbXBsID09PSBudWxsKSB7CiAgICAgIHRyeSB7CiAgICAgICAgLy8gcmVhZCByZXF1aXJlIG9mZiB0aGUgbW9kdWxlIG9iamVjdCB0byBnZXQgYXJvdW5kIHRoZSBidW5kbGVycy4KICAgICAgICAvLyB3ZSBkb24ndCB3YW50IHRoZW0gdG8gZGV0ZWN0IGEgcmVxdWlyZSBhbmQgYnVuZGxlIGEgTm9kZSBwb2x5ZmlsbC4KICAgICAgICB2YXIgcmVxdWlyZVN0cmluZyA9ICgncmVxdWlyZScgKyBNYXRoLnJhbmRvbSgpKS5zbGljZSgwLCA3KTsKICAgICAgICB2YXIgbm9kZVJlcXVpcmUgPSBtb2R1bGUgJiYgbW9kdWxlW3JlcXVpcmVTdHJpbmddOyAvLyBhc3N1bWluZyB3ZSdyZSBpbiBub2RlLCBsZXQncyB0cnkgdG8gZ2V0IG5vZGUncwogICAgICAgIC8vIHZlcnNpb24gb2Ygc2V0SW1tZWRpYXRlLCBieXBhc3NpbmcgZmFrZSB0aW1lcnMgaWYgYW55LgoKICAgICAgICBlbnF1ZXVlVGFza0ltcGwgPSBub2RlUmVxdWlyZS5jYWxsKG1vZHVsZSwgJ3RpbWVycycpLnNldEltbWVkaWF0ZTsKICAgICAgfSBjYXRjaCAoX2VycikgewogICAgICAgIC8vIHdlJ3JlIGluIGEgYnJvd3NlcgogICAgICAgIC8vIHdlIGNhbid0IHVzZSByZWd1bGFyIHRpbWVycyBiZWNhdXNlIHRoZXkgbWF5IHN0aWxsIGJlIGZha2VkCiAgICAgICAgLy8gc28gd2UgdHJ5IE1lc3NhZ2VDaGFubmVsK3Bvc3RNZXNzYWdlIGluc3RlYWQKICAgICAgICBlbnF1ZXVlVGFza0ltcGwgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHsKICAgICAgICAgIHsKICAgICAgICAgICAgaWYgKGRpZFdhcm5BYm91dE1lc3NhZ2VDaGFubmVsID09PSBmYWxzZSkgewogICAgICAgICAgICAgIGRpZFdhcm5BYm91dE1lc3NhZ2VDaGFubmVsID0gdHJ1ZTsKCiAgICAgICAgICAgICAgaWYgKHR5cGVvZiBNZXNzYWdlQ2hhbm5lbCA9PT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICAgICAgICAgIGVycm9yKCdUaGlzIGJyb3dzZXIgZG9lcyBub3QgaGF2ZSBhIE1lc3NhZ2VDaGFubmVsIGltcGxlbWVudGF0aW9uLCAnICsgJ3NvIGVucXVldWluZyB0YXNrcyB2aWEgYXdhaXQgYWN0KGFzeW5jICgpID0+IC4uLikgd2lsbCBmYWlsLiAnICsgJ1BsZWFzZSBmaWxlIGFuIGlzc3VlIGF0IGh0dHBzOi8vZ2l0aHViLmNvbS9mYWNlYm9vay9yZWFjdC9pc3N1ZXMgJyArICdpZiB5b3UgZW5jb3VudGVyIHRoaXMgd2FybmluZy4nKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgY2hhbm5lbCA9IG5ldyBNZXNzYWdlQ2hhbm5lbCgpOwogICAgICAgICAgY2hhbm5lbC5wb3J0MS5vbm1lc3NhZ2UgPSBjYWxsYmFjazsKICAgICAgICAgIGNoYW5uZWwucG9ydDIucG9zdE1lc3NhZ2UodW5kZWZpbmVkKTsKICAgICAgICB9OwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIGVucXVldWVUYXNrSW1wbCh0YXNrKTsKICB9CgogIHZhciBhY3RTY29wZURlcHRoID0gMDsKICB2YXIgZGlkV2Fybk5vQXdhaXRBY3QgPSBmYWxzZTsKICBmdW5jdGlvbiBhY3QoY2FsbGJhY2spIHsKICAgIHsKICAgICAgLy8gYGFjdGAgY2FsbHMgY2FuIGJlIG5lc3RlZCwgc28gd2UgdHJhY2sgdGhlIGRlcHRoLiBUaGlzIHJlcHJlc2VudHMgdGhlCiAgICAgIC8vIG51bWJlciBvZiBgYWN0YCBzY29wZXMgb24gdGhlIHN0YWNrLgogICAgICB2YXIgcHJldkFjdFNjb3BlRGVwdGggPSBhY3RTY29wZURlcHRoOwogICAgICBhY3RTY29wZURlcHRoKys7CgogICAgICBpZiAoUmVhY3RDdXJyZW50QWN0UXVldWUuY3VycmVudCA9PT0gbnVsbCkgewogICAgICAgIC8vIFRoaXMgaXMgdGhlIG91dGVybW9zdCBgYWN0YCBzY29wZS4gSW5pdGlhbGl6ZSB0aGUgcXVldWUuIFRoZSByZWNvbmNpbGVyCiAgICAgICAgLy8gd2lsbCBkZXRlY3QgdGhlIHF1ZXVlIGFuZCB1c2UgaXQgaW5zdGVhZCBvZiBTY2hlZHVsZXIuCiAgICAgICAgUmVhY3RDdXJyZW50QWN0UXVldWUuY3VycmVudCA9IFtdOwogICAgICB9CgogICAgICB2YXIgcHJldklzQmF0Y2hpbmdMZWdhY3kgPSBSZWFjdEN1cnJlbnRBY3RRdWV1ZS5pc0JhdGNoaW5nTGVnYWN5OwogICAgICB2YXIgcmVzdWx0OwoKICAgICAgdHJ5IHsKICAgICAgICAvLyBVc2VkIHRvIHJlcHJvZHVjZSBiZWhhdmlvciBvZiBgYmF0Y2hlZFVwZGF0ZXNgIGluIGxlZ2FjeSBtb2RlLiBPbmx5CiAgICAgICAgLy8gc2V0IHRvIGB0cnVlYCB3aGlsZSB0aGUgZ2l2ZW4gY2FsbGJhY2sgaXMgZXhlY3V0ZWQsIG5vdCBmb3IgdXBkYXRlcwogICAgICAgIC8vIHRyaWdnZXJlZCBkdXJpbmcgYW4gYXN5bmMgZXZlbnQsIGJlY2F1c2UgdGhpcyBpcyBob3cgdGhlIGxlZ2FjeQogICAgICAgIC8vIGltcGxlbWVudGF0aW9uIG9mIGBhY3RgIGJlaGF2ZWQuCiAgICAgICAgUmVhY3RDdXJyZW50QWN0UXVldWUuaXNCYXRjaGluZ0xlZ2FjeSA9IHRydWU7CiAgICAgICAgcmVzdWx0ID0gY2FsbGJhY2soKTsgLy8gUmVwbGljYXRlIGJlaGF2aW9yIG9mIG9yaWdpbmFsIGBhY3RgIGltcGxlbWVudGF0aW9uIGluIGxlZ2FjeSBtb2RlLAogICAgICAgIC8vIHdoaWNoIGZsdXNoZWQgdXBkYXRlcyBpbW1lZGlhdGVseSBhZnRlciB0aGUgc2NvcGUgZnVuY3Rpb24gZXhpdHMsIGV2ZW4KICAgICAgICAvLyBpZiBpdCdzIGFuIGFzeW5jIGZ1bmN0aW9uLgoKICAgICAgICBpZiAoIXByZXZJc0JhdGNoaW5nTGVnYWN5ICYmIFJlYWN0Q3VycmVudEFjdFF1ZXVlLmRpZFNjaGVkdWxlTGVnYWN5VXBkYXRlKSB7CiAgICAgICAgICB2YXIgcXVldWUgPSBSZWFjdEN1cnJlbnRBY3RRdWV1ZS5jdXJyZW50OwoKICAgICAgICAgIGlmIChxdWV1ZSAhPT0gbnVsbCkgewogICAgICAgICAgICBSZWFjdEN1cnJlbnRBY3RRdWV1ZS5kaWRTY2hlZHVsZUxlZ2FjeVVwZGF0ZSA9IGZhbHNlOwogICAgICAgICAgICBmbHVzaEFjdFF1ZXVlKHF1ZXVlKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgcG9wQWN0U2NvcGUocHJldkFjdFNjb3BlRGVwdGgpOwogICAgICAgIHRocm93IGVycm9yOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIFJlYWN0Q3VycmVudEFjdFF1ZXVlLmlzQmF0Y2hpbmdMZWdhY3kgPSBwcmV2SXNCYXRjaGluZ0xlZ2FjeTsKICAgICAgfQoKICAgICAgaWYgKHJlc3VsdCAhPT0gbnVsbCAmJiB0eXBlb2YgcmVzdWx0ID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgcmVzdWx0LnRoZW4gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICB2YXIgdGhlbmFibGVSZXN1bHQgPSByZXN1bHQ7IC8vIFRoZSBjYWxsYmFjayBpcyBhbiBhc3luYyBmdW5jdGlvbiAoaS5lLiByZXR1cm5lZCBhIHByb21pc2UpLiBXYWl0CiAgICAgICAgLy8gZm9yIGl0IHRvIHJlc29sdmUgYmVmb3JlIGV4aXRpbmcgdGhlIGN1cnJlbnQgc2NvcGUuCgogICAgICAgIHZhciB3YXNBd2FpdGVkID0gZmFsc2U7CiAgICAgICAgdmFyIHRoZW5hYmxlID0gewogICAgICAgICAgdGhlbjogZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgICAgICB3YXNBd2FpdGVkID0gdHJ1ZTsKICAgICAgICAgICAgdGhlbmFibGVSZXN1bHQudGhlbihmdW5jdGlvbiAocmV0dXJuVmFsdWUpIHsKICAgICAgICAgICAgICBwb3BBY3RTY29wZShwcmV2QWN0U2NvcGVEZXB0aCk7CgogICAgICAgICAgICAgIGlmIChhY3RTY29wZURlcHRoID09PSAwKSB7CiAgICAgICAgICAgICAgICAvLyBXZSd2ZSBleGl0ZWQgdGhlIG91dGVybW9zdCBhY3Qgc2NvcGUuIFJlY3Vyc2l2ZWx5IGZsdXNoIHRoZQogICAgICAgICAgICAgICAgLy8gcXVldWUgdW50aWwgdGhlcmUncyBubyByZW1haW5pbmcgd29yay4KICAgICAgICAgICAgICAgIHJlY3Vyc2l2ZWx5Rmx1c2hBc3luY0FjdFdvcmsocmV0dXJuVmFsdWUsIHJlc29sdmUsIHJlamVjdCk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJlc29sdmUocmV0dXJuVmFsdWUpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICAgICAgLy8gVGhlIGNhbGxiYWNrIHRocmV3IGFuIGVycm9yLgogICAgICAgICAgICAgIHBvcEFjdFNjb3BlKHByZXZBY3RTY29wZURlcHRoKTsKICAgICAgICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICB7CiAgICAgICAgICBpZiAoIWRpZFdhcm5Ob0F3YWl0QWN0ICYmIHR5cGVvZiBQcm9taXNlICE9PSAndW5kZWZpbmVkJykgewogICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW5kZWYKICAgICAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbiAoKSB7fSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgaWYgKCF3YXNBd2FpdGVkKSB7CiAgICAgICAgICAgICAgICBkaWRXYXJuTm9Bd2FpdEFjdCA9IHRydWU7CgogICAgICAgICAgICAgICAgZXJyb3IoJ1lvdSBjYWxsZWQgYWN0KGFzeW5jICgpID0+IC4uLikgd2l0aG91dCBhd2FpdC4gJyArICdUaGlzIGNvdWxkIGxlYWQgdG8gdW5leHBlY3RlZCB0ZXN0aW5nIGJlaGF2aW91ciwgJyArICdpbnRlcmxlYXZpbmcgbXVsdGlwbGUgYWN0IGNhbGxzIGFuZCBtaXhpbmcgdGhlaXIgJyArICdzY29wZXMuICcgKyAnWW91IHNob3VsZCAtIGF3YWl0IGFjdChhc3luYyAoKSA9PiAuLi4pOycpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdGhlbmFibGU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFyIHJldHVyblZhbHVlID0gcmVzdWx0OyAvLyBUaGUgY2FsbGJhY2sgaXMgbm90IGFuIGFzeW5jIGZ1bmN0aW9uLiBFeGl0IHRoZSBjdXJyZW50IHNjb3BlCiAgICAgICAgLy8gaW1tZWRpYXRlbHksIHdpdGhvdXQgYXdhaXRpbmcuCgogICAgICAgIHBvcEFjdFNjb3BlKHByZXZBY3RTY29wZURlcHRoKTsKCiAgICAgICAgaWYgKGFjdFNjb3BlRGVwdGggPT09IDApIHsKICAgICAgICAgIC8vIEV4aXRpbmcgdGhlIG91dGVybW9zdCBhY3Qgc2NvcGUuIEZsdXNoIHRoZSBxdWV1ZS4KICAgICAgICAgIHZhciBfcXVldWUgPSBSZWFjdEN1cnJlbnRBY3RRdWV1ZS5jdXJyZW50OwoKICAgICAgICAgIGlmIChfcXVldWUgIT09IG51bGwpIHsKICAgICAgICAgICAgZmx1c2hBY3RRdWV1ZShfcXVldWUpOwogICAgICAgICAgICBSZWFjdEN1cnJlbnRBY3RRdWV1ZS5jdXJyZW50ID0gbnVsbDsKICAgICAgICAgIH0gLy8gUmV0dXJuIGEgdGhlbmFibGUuIElmIHRoZSB1c2VyIGF3YWl0cyBpdCwgd2UnbGwgZmx1c2ggYWdhaW4gaW4KICAgICAgICAgIC8vIGNhc2UgYWRkaXRpb25hbCB3b3JrIHdhcyBzY2hlZHVsZWQgYnkgYSBtaWNyb3Rhc2suCgoKICAgICAgICAgIHZhciBfdGhlbmFibGUgPSB7CiAgICAgICAgICAgIHRoZW46IGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICAgICAgICAvLyBDb25maXJtIHdlIGhhdmVuJ3QgcmUtZW50ZXJlZCBhbm90aGVyIGBhY3RgIHNjb3BlLCBpbiBjYXNlCiAgICAgICAgICAgICAgLy8gdGhlIHVzZXIgZG9lcyBzb21ldGhpbmcgd2VpcmQgbGlrZSBhd2FpdCB0aGUgdGhlbmFibGUKICAgICAgICAgICAgICAvLyBtdWx0aXBsZSB0aW1lcy4KICAgICAgICAgICAgICBpZiAoUmVhY3RDdXJyZW50QWN0UXVldWUuY3VycmVudCA9PT0gbnVsbCkgewogICAgICAgICAgICAgICAgLy8gUmVjdXJzaXZlbHkgZmx1c2ggdGhlIHF1ZXVlIHVudGlsIHRoZXJlJ3Mgbm8gcmVtYWluaW5nIHdvcmsuCiAgICAgICAgICAgICAgICBSZWFjdEN1cnJlbnRBY3RRdWV1ZS5jdXJyZW50ID0gW107CiAgICAgICAgICAgICAgICByZWN1cnNpdmVseUZsdXNoQXN5bmNBY3RXb3JrKHJldHVyblZhbHVlLCByZXNvbHZlLCByZWplY3QpOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZXNvbHZlKHJldHVyblZhbHVlKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH07CiAgICAgICAgICByZXR1cm4gX3RoZW5hYmxlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyBTaW5jZSB3ZSdyZSBpbnNpZGUgYSBuZXN0ZWQgYGFjdGAgc2NvcGUsIHRoZSByZXR1cm5lZCB0aGVuYWJsZQogICAgICAgICAgLy8gaW1tZWRpYXRlbHkgcmVzb2x2ZXMuIFRoZSBvdXRlciBzY29wZSB3aWxsIGZsdXNoIHRoZSBxdWV1ZS4KICAgICAgICAgIHZhciBfdGhlbmFibGUyID0gewogICAgICAgICAgICB0aGVuOiBmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgICAgICAgcmVzb2x2ZShyZXR1cm5WYWx1ZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH07CiAgICAgICAgICByZXR1cm4gX3RoZW5hYmxlMjsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIHBvcEFjdFNjb3BlKHByZXZBY3RTY29wZURlcHRoKSB7CiAgICB7CiAgICAgIGlmIChwcmV2QWN0U2NvcGVEZXB0aCAhPT0gYWN0U2NvcGVEZXB0aCAtIDEpIHsKICAgICAgICBlcnJvcignWW91IHNlZW0gdG8gaGF2ZSBvdmVybGFwcGluZyBhY3QoKSBjYWxscywgdGhpcyBpcyBub3Qgc3VwcG9ydGVkLiAnICsgJ0JlIHN1cmUgdG8gYXdhaXQgcHJldmlvdXMgYWN0KCkgY2FsbHMgYmVmb3JlIG1ha2luZyBhIG5ldyBvbmUuICcpOwogICAgICB9CgogICAgICBhY3RTY29wZURlcHRoID0gcHJldkFjdFNjb3BlRGVwdGg7CiAgICB9CiAgfQoKICBmdW5jdGlvbiByZWN1cnNpdmVseUZsdXNoQXN5bmNBY3RXb3JrKHJldHVyblZhbHVlLCByZXNvbHZlLCByZWplY3QpIHsKICAgIHsKICAgICAgdmFyIHF1ZXVlID0gUmVhY3RDdXJyZW50QWN0UXVldWUuY3VycmVudDsKCiAgICAgIGlmIChxdWV1ZSAhPT0gbnVsbCkgewogICAgICAgIHRyeSB7CiAgICAgICAgICBmbHVzaEFjdFF1ZXVlKHF1ZXVlKTsKICAgICAgICAgIGVucXVldWVUYXNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgaWYgKHF1ZXVlLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICAgIC8vIE5vIGFkZGl0aW9uYWwgd29yayB3YXMgc2NoZWR1bGVkLiBGaW5pc2guCiAgICAgICAgICAgICAgUmVhY3RDdXJyZW50QWN0UXVldWUuY3VycmVudCA9IG51bGw7CiAgICAgICAgICAgICAgcmVzb2x2ZShyZXR1cm5WYWx1ZSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgLy8gS2VlcCBmbHVzaGluZyB3b3JrIHVudGlsIHRoZXJlJ3Mgbm9uZSBsZWZ0LgogICAgICAgICAgICAgIHJlY3Vyc2l2ZWx5Rmx1c2hBc3luY0FjdFdvcmsocmV0dXJuVmFsdWUsIHJlc29sdmUsIHJlamVjdCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICByZXNvbHZlKHJldHVyblZhbHVlKTsKICAgICAgfQogICAgfQogIH0KCiAgdmFyIGlzRmx1c2hpbmcgPSBmYWxzZTsKCiAgZnVuY3Rpb24gZmx1c2hBY3RRdWV1ZShxdWV1ZSkgewogICAgewogICAgICBpZiAoIWlzRmx1c2hpbmcpIHsKICAgICAgICAvLyBQcmV2ZW50IHJlLWVudHJhbmNlLgogICAgICAgIGlzRmx1c2hpbmcgPSB0cnVlOwogICAgICAgIHZhciBpID0gMDsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgIGZvciAoOyBpIDwgcXVldWUubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgdmFyIGNhbGxiYWNrID0gcXVldWVbaV07CgogICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgY2FsbGJhY2sgPSBjYWxsYmFjayh0cnVlKTsKICAgICAgICAgICAgfSB3aGlsZSAoY2FsbGJhY2sgIT09IG51bGwpOwogICAgICAgICAgfQoKICAgICAgICAgIHF1ZXVlLmxlbmd0aCA9IDA7CiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgIC8vIElmIHNvbWV0aGluZyB0aHJvd3MsIGxlYXZlIHRoZSByZW1haW5pbmcgY2FsbGJhY2tzIG9uIHRoZSBxdWV1ZS4KICAgICAgICAgIHF1ZXVlID0gcXVldWUuc2xpY2UoaSArIDEpOwogICAgICAgICAgdGhyb3cgZXJyb3I7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIGlzRmx1c2hpbmcgPSBmYWxzZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CgogIHZhciBjcmVhdGVFbGVtZW50JDEgPSAgY3JlYXRlRWxlbWVudFdpdGhWYWxpZGF0aW9uIDsKICB2YXIgY2xvbmVFbGVtZW50JDEgPSAgY2xvbmVFbGVtZW50V2l0aFZhbGlkYXRpb24gOwogIHZhciBjcmVhdGVGYWN0b3J5ID0gIGNyZWF0ZUZhY3RvcnlXaXRoVmFsaWRhdGlvbiA7CiAgdmFyIENoaWxkcmVuID0gewogICAgbWFwOiBtYXBDaGlsZHJlbiwKICAgIGZvckVhY2g6IGZvckVhY2hDaGlsZHJlbiwKICAgIGNvdW50OiBjb3VudENoaWxkcmVuLAogICAgdG9BcnJheTogdG9BcnJheSwKICAgIG9ubHk6IG9ubHlDaGlsZAogIH07CgogIGV4cG9ydHMuQ2hpbGRyZW4gPSBDaGlsZHJlbjsKICBleHBvcnRzLkNvbXBvbmVudCA9IENvbXBvbmVudDsKICBleHBvcnRzLkZyYWdtZW50ID0gUkVBQ1RfRlJBR01FTlRfVFlQRTsKICBleHBvcnRzLlByb2ZpbGVyID0gUkVBQ1RfUFJPRklMRVJfVFlQRTsKICBleHBvcnRzLlB1cmVDb21wb25lbnQgPSBQdXJlQ29tcG9uZW50OwogIGV4cG9ydHMuU3RyaWN0TW9kZSA9IFJFQUNUX1NUUklDVF9NT0RFX1RZUEU7CiAgZXhwb3J0cy5TdXNwZW5zZSA9IFJFQUNUX1NVU1BFTlNFX1RZUEU7CiAgZXhwb3J0cy5fX1NFQ1JFVF9JTlRFUk5BTFNfRE9fTk9UX1VTRV9PUl9ZT1VfV0lMTF9CRV9GSVJFRCA9IFJlYWN0U2hhcmVkSW50ZXJuYWxzJDE7CiAgZXhwb3J0cy5jbG9uZUVsZW1lbnQgPSBjbG9uZUVsZW1lbnQkMTsKICBleHBvcnRzLmNyZWF0ZUNvbnRleHQgPSBjcmVhdGVDb250ZXh0OwogIGV4cG9ydHMuY3JlYXRlRWxlbWVudCA9IGNyZWF0ZUVsZW1lbnQkMTsKICBleHBvcnRzLmNyZWF0ZUZhY3RvcnkgPSBjcmVhdGVGYWN0b3J5OwogIGV4cG9ydHMuY3JlYXRlUmVmID0gY3JlYXRlUmVmOwogIGV4cG9ydHMuZm9yd2FyZFJlZiA9IGZvcndhcmRSZWY7CiAgZXhwb3J0cy5pc1ZhbGlkRWxlbWVudCA9IGlzVmFsaWRFbGVtZW50OwogIGV4cG9ydHMubGF6eSA9IGxhenk7CiAgZXhwb3J0cy5tZW1vID0gbWVtbzsKICBleHBvcnRzLnN0YXJ0VHJhbnNpdGlvbiA9IHN0YXJ0VHJhbnNpdGlvbjsKICBleHBvcnRzLnVuc3RhYmxlX2FjdCA9IGFjdDsKICBleHBvcnRzLnVzZUNhbGxiYWNrID0gdXNlQ2FsbGJhY2s7CiAgZXhwb3J0cy51c2VDb250ZXh0ID0gdXNlQ29udGV4dDsKICBleHBvcnRzLnVzZURlYnVnVmFsdWUgPSB1c2VEZWJ1Z1ZhbHVlOwogIGV4cG9ydHMudXNlRGVmZXJyZWRWYWx1ZSA9IHVzZURlZmVycmVkVmFsdWU7CiAgZXhwb3J0cy51c2VFZmZlY3QgPSB1c2VFZmZlY3Q7CiAgZXhwb3J0cy51c2VJZCA9IHVzZUlkOwogIGV4cG9ydHMudXNlSW1wZXJhdGl2ZUhhbmRsZSA9IHVzZUltcGVyYXRpdmVIYW5kbGU7CiAgZXhwb3J0cy51c2VJbnNlcnRpb25FZmZlY3QgPSB1c2VJbnNlcnRpb25FZmZlY3Q7CiAgZXhwb3J0cy51c2VMYXlvdXRFZmZlY3QgPSB1c2VMYXlvdXRFZmZlY3Q7CiAgZXhwb3J0cy51c2VNZW1vID0gdXNlTWVtbzsKICBleHBvcnRzLnVzZVJlZHVjZXIgPSB1c2VSZWR1Y2VyOwogIGV4cG9ydHMudXNlUmVmID0gdXNlUmVmOwogIGV4cG9ydHMudXNlU3RhdGUgPSB1c2VTdGF0ZTsKICBleHBvcnRzLnVzZVN5bmNFeHRlcm5hbFN0b3JlID0gdXNlU3luY0V4dGVybmFsU3RvcmU7CiAgZXhwb3J0cy51c2VUcmFuc2l0aW9uID0gdXNlVHJhbnNpdGlvbjsKICBleHBvcnRzLnZlcnNpb24gPSBSZWFjdFZlcnNpb247Cgp9KSkpOwo=",mtime:1744325324271},"assets/react.production.min.js":{data:"data:application/javascript;base64,LyoqCiAqIEBsaWNlbnNlIFJlYWN0CiAqIHJlYWN0LnByb2R1Y3Rpb24ubWluLmpzCiAqCiAqIENvcHlyaWdodCAoYykgRmFjZWJvb2ssIEluYy4gYW5kIGl0cyBhZmZpbGlhdGVzLgogKgogKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGUKICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLgogKi8KKGZ1bmN0aW9uKCl7J3VzZSBzdHJpY3QnOyhmdW5jdGlvbihjLHgpeyJvYmplY3QiPT09dHlwZW9mIGV4cG9ydHMmJiJ1bmRlZmluZWQiIT09dHlwZW9mIG1vZHVsZT94KGV4cG9ydHMpOiJmdW5jdGlvbiI9PT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZShbImV4cG9ydHMiXSx4KTooYz1jfHxzZWxmLHgoYy5SZWFjdD17fSkpfSkodGhpcyxmdW5jdGlvbihjKXtmdW5jdGlvbiB4KGEpe2lmKG51bGw9PT1hfHwib2JqZWN0IiE9PXR5cGVvZiBhKXJldHVybiBudWxsO2E9ViYmYVtWXXx8YVsiQEBpdGVyYXRvciJdO3JldHVybiJmdW5jdGlvbiI9PT10eXBlb2YgYT9hOm51bGx9ZnVuY3Rpb24gdyhhLGIsZSl7dGhpcy5wcm9wcz1hO3RoaXMuY29udGV4dD1iO3RoaXMucmVmcz1XO3RoaXMudXBkYXRlcj1lfHxYfWZ1bmN0aW9uIFkoKXt9ZnVuY3Rpb24gSyhhLGIsZSl7dGhpcy5wcm9wcz1hO3RoaXMuY29udGV4dD1iO3RoaXMucmVmcz1XO3RoaXMudXBkYXRlcj1lfHxYfWZ1bmN0aW9uIFooYSxiLAplKXt2YXIgbSxkPXt9LGM9bnVsbCxoPW51bGw7aWYobnVsbCE9Yilmb3IobSBpbiB2b2lkIDAhPT1iLnJlZiYmKGg9Yi5yZWYpLHZvaWQgMCE9PWIua2V5JiYoYz0iIitiLmtleSksYilhYS5jYWxsKGIsbSkmJiFiYS5oYXNPd25Qcm9wZXJ0eShtKSYmKGRbbV09YlttXSk7dmFyIGw9YXJndW1lbnRzLmxlbmd0aC0yO2lmKDE9PT1sKWQuY2hpbGRyZW49ZTtlbHNlIGlmKDE8bCl7Zm9yKHZhciBmPUFycmF5KGwpLGs9MDtrPGw7aysrKWZba109YXJndW1lbnRzW2srMl07ZC5jaGlsZHJlbj1mfWlmKGEmJmEuZGVmYXVsdFByb3BzKWZvcihtIGluIGw9YS5kZWZhdWx0UHJvcHMsbCl2b2lkIDA9PT1kW21dJiYoZFttXT1sW21dKTtyZXR1cm57JCR0eXBlb2Y6eSx0eXBlOmEsa2V5OmMscmVmOmgscHJvcHM6ZCxfb3duZXI6TC5jdXJyZW50fX1mdW5jdGlvbiBuYShhLGIpe3JldHVybnskJHR5cGVvZjp5LHR5cGU6YS50eXBlLGtleTpiLHJlZjphLnJlZixwcm9wczphLnByb3BzLF9vd25lcjphLl9vd25lcn19CmZ1bmN0aW9uIE0oYSl7cmV0dXJuIm9iamVjdCI9PT10eXBlb2YgYSYmbnVsbCE9PWEmJmEuJCR0eXBlb2Y9PT15fWZ1bmN0aW9uIG9hKGEpe3ZhciBiPXsiPSI6Ij0wIiwiOiI6Ij0yIn07cmV0dXJuIiQiK2EucmVwbGFjZSgvWz06XS9nLGZ1bmN0aW9uKGEpe3JldHVybiBiW2FdfSl9ZnVuY3Rpb24gTihhLGIpe3JldHVybiJvYmplY3QiPT09dHlwZW9mIGEmJm51bGwhPT1hJiZudWxsIT1hLmtleT9vYSgiIithLmtleSk6Yi50b1N0cmluZygzNil9ZnVuY3Rpb24gQihhLGIsZSxtLGQpe3ZhciBjPXR5cGVvZiBhO2lmKCJ1bmRlZmluZWQiPT09Y3x8ImJvb2xlYW4iPT09YylhPW51bGw7dmFyIGg9ITE7aWYobnVsbD09PWEpaD0hMDtlbHNlIHN3aXRjaChjKXtjYXNlICJzdHJpbmciOmNhc2UgIm51bWJlciI6aD0hMDticmVhaztjYXNlICJvYmplY3QiOnN3aXRjaChhLiQkdHlwZW9mKXtjYXNlIHk6Y2FzZSBwYTpoPSEwfX1pZihoKXJldHVybiBoPWEsZD1kKGgpLGE9IiI9PT1tPyIuIisKTihoLDApOm0sY2EoZCk/KGU9IiIsbnVsbCE9YSYmKGU9YS5yZXBsYWNlKGRhLCIkJi8iKSsiLyIpLEIoZCxiLGUsIiIsZnVuY3Rpb24oYSl7cmV0dXJuIGF9KSk6bnVsbCE9ZCYmKE0oZCkmJihkPW5hKGQsZSsoIWQua2V5fHxoJiZoLmtleT09PWQua2V5PyIiOigiIitkLmtleSkucmVwbGFjZShkYSwiJCYvIikrIi8iKSthKSksYi5wdXNoKGQpKSwxO2g9MDttPSIiPT09bT8iLiI6bSsiOiI7aWYoY2EoYSkpZm9yKHZhciBsPTA7bDxhLmxlbmd0aDtsKyspe2M9YVtsXTt2YXIgZj1tK04oYyxsKTtoKz1CKGMsYixlLGYsZCl9ZWxzZSBpZihmPXgoYSksImZ1bmN0aW9uIj09PXR5cGVvZiBmKWZvcihhPWYuY2FsbChhKSxsPTA7IShjPWEubmV4dCgpKS5kb25lOyljPWMudmFsdWUsZj1tK04oYyxsKyspLGgrPUIoYyxiLGUsZixkKTtlbHNlIGlmKCJvYmplY3QiPT09Yyl0aHJvdyBiPVN0cmluZyhhKSxFcnJvcigiT2JqZWN0cyBhcmUgbm90IHZhbGlkIGFzIGEgUmVhY3QgY2hpbGQgKGZvdW5kOiAiKwooIltvYmplY3QgT2JqZWN0XSI9PT1iPyJvYmplY3Qgd2l0aCBrZXlzIHsiK09iamVjdC5rZXlzKGEpLmpvaW4oIiwgIikrIn0iOmIpKyIpLiBJZiB5b3UgbWVhbnQgdG8gcmVuZGVyIGEgY29sbGVjdGlvbiBvZiBjaGlsZHJlbiwgdXNlIGFuIGFycmF5IGluc3RlYWQuIik7cmV0dXJuIGh9ZnVuY3Rpb24gQyhhLGIsZSl7aWYobnVsbD09YSlyZXR1cm4gYTt2YXIgYz1bXSxkPTA7QihhLGMsIiIsIiIsZnVuY3Rpb24oYSl7cmV0dXJuIGIuY2FsbChlLGEsZCsrKX0pO3JldHVybiBjfWZ1bmN0aW9uIHFhKGEpe2lmKC0xPT09YS5fc3RhdHVzKXt2YXIgYj1hLl9yZXN1bHQ7Yj1iKCk7Yi50aGVuKGZ1bmN0aW9uKGIpe2lmKDA9PT1hLl9zdGF0dXN8fC0xPT09YS5fc3RhdHVzKWEuX3N0YXR1cz0xLGEuX3Jlc3VsdD1ifSxmdW5jdGlvbihiKXtpZigwPT09YS5fc3RhdHVzfHwtMT09PWEuX3N0YXR1cylhLl9zdGF0dXM9MixhLl9yZXN1bHQ9Yn0pOy0xPT09YS5fc3RhdHVzJiYoYS5fc3RhdHVzPQowLGEuX3Jlc3VsdD1iKX1pZigxPT09YS5fc3RhdHVzKXJldHVybiBhLl9yZXN1bHQuZGVmYXVsdDt0aHJvdyBhLl9yZXN1bHQ7fWZ1bmN0aW9uIE8oYSxiKXt2YXIgZT1hLmxlbmd0aDthLnB1c2goYik7YTpmb3IoOzA8ZTspe3ZhciBjPWUtMT4+PjEsZD1hW2NdO2lmKDA8RChkLGIpKWFbY109YixhW2VdPWQsZT1jO2Vsc2UgYnJlYWsgYX19ZnVuY3Rpb24gcChhKXtyZXR1cm4gMD09PWEubGVuZ3RoP251bGw6YVswXX1mdW5jdGlvbiBFKGEpe2lmKDA9PT1hLmxlbmd0aClyZXR1cm4gbnVsbDt2YXIgYj1hWzBdLGU9YS5wb3AoKTtpZihlIT09Yil7YVswXT1lO2E6Zm9yKHZhciBjPTAsZD1hLmxlbmd0aCxrPWQ+Pj4xO2M8azspe3ZhciBoPTIqKGMrMSktMSxsPWFbaF0sZj1oKzEsZz1hW2ZdO2lmKDA+RChsLGUpKWY8ZCYmMD5EKGcsbCk/KGFbY109ZyxhW2ZdPWUsYz1mKTooYVtjXT1sLGFbaF09ZSxjPWgpO2Vsc2UgaWYoZjxkJiYwPkQoZyxlKSlhW2NdPWcsYVtmXT1lLGM9ZjtlbHNlIGJyZWFrIGF9fXJldHVybiBifQpmdW5jdGlvbiBEKGEsYil7dmFyIGM9YS5zb3J0SW5kZXgtYi5zb3J0SW5kZXg7cmV0dXJuIDAhPT1jP2M6YS5pZC1iLmlkfWZ1bmN0aW9uIFAoYSl7Zm9yKHZhciBiPXAocik7bnVsbCE9PWI7KXtpZihudWxsPT09Yi5jYWxsYmFjaylFKHIpO2Vsc2UgaWYoYi5zdGFydFRpbWU8PWEpRShyKSxiLnNvcnRJbmRleD1iLmV4cGlyYXRpb25UaW1lLE8ocSxiKTtlbHNlIGJyZWFrO2I9cChyKX19ZnVuY3Rpb24gUShhKXt6PSExO1AoYSk7aWYoIXUpaWYobnVsbCE9PXAocSkpdT0hMCxSKFMpO2Vsc2V7dmFyIGI9cChyKTtudWxsIT09YiYmVChRLGIuc3RhcnRUaW1lLWEpfX1mdW5jdGlvbiBTKGEsYil7dT0hMTt6JiYoej0hMSxlYShBKSxBPS0xKTtGPSEwO3ZhciBjPWs7dHJ5e1AoYik7Zm9yKG49cChxKTtudWxsIT09biYmKCEobi5leHBpcmF0aW9uVGltZT5iKXx8YSYmIWZhKCkpOyl7dmFyIG09bi5jYWxsYmFjaztpZigiZnVuY3Rpb24iPT09dHlwZW9mIG0pe24uY2FsbGJhY2s9bnVsbDsKaz1uLnByaW9yaXR5TGV2ZWw7dmFyIGQ9bShuLmV4cGlyYXRpb25UaW1lPD1iKTtiPXYoKTsiZnVuY3Rpb24iPT09dHlwZW9mIGQ/bi5jYWxsYmFjaz1kOm49PT1wKHEpJiZFKHEpO1AoYil9ZWxzZSBFKHEpO249cChxKX1pZihudWxsIT09bil2YXIgZz0hMDtlbHNle3ZhciBoPXAocik7bnVsbCE9PWgmJlQoUSxoLnN0YXJ0VGltZS1iKTtnPSExfXJldHVybiBnfWZpbmFsbHl7bj1udWxsLGs9YyxGPSExfX1mdW5jdGlvbiBmYSgpe3JldHVybiB2KCktaGE8aWE/ITE6ITB9ZnVuY3Rpb24gUihhKXtHPWE7SHx8KEg9ITAsSSgpKX1mdW5jdGlvbiBUKGEsYil7QT1qYShmdW5jdGlvbigpe2EodigpKX0sYil9dmFyIHk9U3ltYm9sLmZvcigicmVhY3QuZWxlbWVudCIpLHBhPVN5bWJvbC5mb3IoInJlYWN0LnBvcnRhbCIpLHJhPVN5bWJvbC5mb3IoInJlYWN0LmZyYWdtZW50Iiksc2E9U3ltYm9sLmZvcigicmVhY3Quc3RyaWN0X21vZGUiKSx0YT1TeW1ib2wuZm9yKCJyZWFjdC5wcm9maWxlciIpLAp1YT1TeW1ib2wuZm9yKCJyZWFjdC5wcm92aWRlciIpLHZhPVN5bWJvbC5mb3IoInJlYWN0LmNvbnRleHQiKSx3YT1TeW1ib2wuZm9yKCJyZWFjdC5mb3J3YXJkX3JlZiIpLHhhPVN5bWJvbC5mb3IoInJlYWN0LnN1c3BlbnNlIikseWE9U3ltYm9sLmZvcigicmVhY3QubWVtbyIpLHphPVN5bWJvbC5mb3IoInJlYWN0LmxhenkiKSxWPVN5bWJvbC5pdGVyYXRvcixYPXtpc01vdW50ZWQ6ZnVuY3Rpb24oYSl7cmV0dXJuITF9LGVucXVldWVGb3JjZVVwZGF0ZTpmdW5jdGlvbihhLGIsYyl7fSxlbnF1ZXVlUmVwbGFjZVN0YXRlOmZ1bmN0aW9uKGEsYixjLG0pe30sZW5xdWV1ZVNldFN0YXRlOmZ1bmN0aW9uKGEsYixjLG0pe319LGthPU9iamVjdC5hc3NpZ24sVz17fTt3LnByb3RvdHlwZS5pc1JlYWN0Q29tcG9uZW50PXt9O3cucHJvdG90eXBlLnNldFN0YXRlPWZ1bmN0aW9uKGEsYil7aWYoIm9iamVjdCIhPT10eXBlb2YgYSYmImZ1bmN0aW9uIiE9PXR5cGVvZiBhJiZudWxsIT1hKXRocm93IEVycm9yKCJzZXRTdGF0ZSguLi4pOiB0YWtlcyBhbiBvYmplY3Qgb2Ygc3RhdGUgdmFyaWFibGVzIHRvIHVwZGF0ZSBvciBhIGZ1bmN0aW9uIHdoaWNoIHJldHVybnMgYW4gb2JqZWN0IG9mIHN0YXRlIHZhcmlhYmxlcy4iKTsKdGhpcy51cGRhdGVyLmVucXVldWVTZXRTdGF0ZSh0aGlzLGEsYiwic2V0U3RhdGUiKX07dy5wcm90b3R5cGUuZm9yY2VVcGRhdGU9ZnVuY3Rpb24oYSl7dGhpcy51cGRhdGVyLmVucXVldWVGb3JjZVVwZGF0ZSh0aGlzLGEsImZvcmNlVXBkYXRlIil9O1kucHJvdG90eXBlPXcucHJvdG90eXBlO3ZhciB0PUsucHJvdG90eXBlPW5ldyBZO3QuY29uc3RydWN0b3I9SztrYSh0LHcucHJvdG90eXBlKTt0LmlzUHVyZVJlYWN0Q29tcG9uZW50PSEwO3ZhciBjYT1BcnJheS5pc0FycmF5LGFhPU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHksTD17Y3VycmVudDpudWxsfSxiYT17a2V5OiEwLHJlZjohMCxfX3NlbGY6ITAsX19zb3VyY2U6ITB9LGRhPS9cLysvZyxnPXtjdXJyZW50Om51bGx9LEo9e3RyYW5zaXRpb246bnVsbH07aWYoIm9iamVjdCI9PT10eXBlb2YgcGVyZm9ybWFuY2UmJiJmdW5jdGlvbiI9PT10eXBlb2YgcGVyZm9ybWFuY2Uubm93KXt2YXIgQWE9cGVyZm9ybWFuY2U7CnZhciB2PWZ1bmN0aW9uKCl7cmV0dXJuIEFhLm5vdygpfX1lbHNle3ZhciBsYT1EYXRlLEJhPWxhLm5vdygpO3Y9ZnVuY3Rpb24oKXtyZXR1cm4gbGEubm93KCktQmF9fXZhciBxPVtdLHI9W10sQ2E9MSxuPW51bGwsaz0zLEY9ITEsdT0hMSx6PSExLGphPSJmdW5jdGlvbiI9PT10eXBlb2Ygc2V0VGltZW91dD9zZXRUaW1lb3V0Om51bGwsZWE9ImZ1bmN0aW9uIj09PXR5cGVvZiBjbGVhclRpbWVvdXQ/Y2xlYXJUaW1lb3V0Om51bGwsbWE9InVuZGVmaW5lZCIhPT10eXBlb2Ygc2V0SW1tZWRpYXRlP3NldEltbWVkaWF0ZTpudWxsOyJ1bmRlZmluZWQiIT09dHlwZW9mIG5hdmlnYXRvciYmdm9pZCAwIT09bmF2aWdhdG9yLnNjaGVkdWxpbmcmJnZvaWQgMCE9PW5hdmlnYXRvci5zY2hlZHVsaW5nLmlzSW5wdXRQZW5kaW5nJiZuYXZpZ2F0b3Iuc2NoZWR1bGluZy5pc0lucHV0UGVuZGluZy5iaW5kKG5hdmlnYXRvci5zY2hlZHVsaW5nKTt2YXIgSD0hMSxHPW51bGwsQT0tMSxpYT01LGhhPQotMSxVPWZ1bmN0aW9uKCl7aWYobnVsbCE9PUcpe3ZhciBhPXYoKTtoYT1hO3ZhciBiPSEwO3RyeXtiPUcoITAsYSl9ZmluYWxseXtiP0koKTooSD0hMSxHPW51bGwpfX1lbHNlIEg9ITF9O2lmKCJmdW5jdGlvbiI9PT10eXBlb2YgbWEpdmFyIEk9ZnVuY3Rpb24oKXttYShVKX07ZWxzZSBpZigidW5kZWZpbmVkIiE9PXR5cGVvZiBNZXNzYWdlQ2hhbm5lbCl7dD1uZXcgTWVzc2FnZUNoYW5uZWw7dmFyIERhPXQucG9ydDI7dC5wb3J0MS5vbm1lc3NhZ2U9VTtJPWZ1bmN0aW9uKCl7RGEucG9zdE1lc3NhZ2UobnVsbCl9fWVsc2UgST1mdW5jdGlvbigpe2phKFUsMCl9O3Q9e1JlYWN0Q3VycmVudERpc3BhdGNoZXI6ZyxSZWFjdEN1cnJlbnRPd25lcjpMLFJlYWN0Q3VycmVudEJhdGNoQ29uZmlnOkosU2NoZWR1bGVyOntfX3Byb3RvX186bnVsbCx1bnN0YWJsZV9JbW1lZGlhdGVQcmlvcml0eToxLHVuc3RhYmxlX1VzZXJCbG9ja2luZ1ByaW9yaXR5OjIsdW5zdGFibGVfTm9ybWFsUHJpb3JpdHk6MywKdW5zdGFibGVfSWRsZVByaW9yaXR5OjUsdW5zdGFibGVfTG93UHJpb3JpdHk6NCx1bnN0YWJsZV9ydW5XaXRoUHJpb3JpdHk6ZnVuY3Rpb24oYSxiKXtzd2l0Y2goYSl7Y2FzZSAxOmNhc2UgMjpjYXNlIDM6Y2FzZSA0OmNhc2UgNTpicmVhaztkZWZhdWx0OmE9M312YXIgYz1rO2s9YTt0cnl7cmV0dXJuIGIoKX1maW5hbGx5e2s9Y319LHVuc3RhYmxlX25leHQ6ZnVuY3Rpb24oYSl7c3dpdGNoKGspe2Nhc2UgMTpjYXNlIDI6Y2FzZSAzOnZhciBiPTM7YnJlYWs7ZGVmYXVsdDpiPWt9dmFyIGM9aztrPWI7dHJ5e3JldHVybiBhKCl9ZmluYWxseXtrPWN9fSx1bnN0YWJsZV9zY2hlZHVsZUNhbGxiYWNrOmZ1bmN0aW9uKGEsYixjKXt2YXIgZT12KCk7Im9iamVjdCI9PT10eXBlb2YgYyYmbnVsbCE9PWM/KGM9Yy5kZWxheSxjPSJudW1iZXIiPT09dHlwZW9mIGMmJjA8Yz9lK2M6ZSk6Yz1lO3N3aXRjaChhKXtjYXNlIDE6dmFyIGQ9LTE7YnJlYWs7Y2FzZSAyOmQ9MjUwO2JyZWFrO2Nhc2UgNTpkPQoxMDczNzQxODIzO2JyZWFrO2Nhc2UgNDpkPTFFNDticmVhaztkZWZhdWx0OmQ9NUUzfWQ9YytkO2E9e2lkOkNhKyssY2FsbGJhY2s6Yixwcmlvcml0eUxldmVsOmEsc3RhcnRUaW1lOmMsZXhwaXJhdGlvblRpbWU6ZCxzb3J0SW5kZXg6LTF9O2M+ZT8oYS5zb3J0SW5kZXg9YyxPKHIsYSksbnVsbD09PXAocSkmJmE9PT1wKHIpJiYoej8oZWEoQSksQT0tMSk6ej0hMCxUKFEsYy1lKSkpOihhLnNvcnRJbmRleD1kLE8ocSxhKSx1fHxGfHwodT0hMCxSKFMpKSk7cmV0dXJuIGF9LHVuc3RhYmxlX2NhbmNlbENhbGxiYWNrOmZ1bmN0aW9uKGEpe2EuY2FsbGJhY2s9bnVsbH0sdW5zdGFibGVfd3JhcENhbGxiYWNrOmZ1bmN0aW9uKGEpe3ZhciBiPWs7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGM9aztrPWI7dHJ5e3JldHVybiBhLmFwcGx5KHRoaXMsYXJndW1lbnRzKX1maW5hbGx5e2s9Y319fSx1bnN0YWJsZV9nZXRDdXJyZW50UHJpb3JpdHlMZXZlbDpmdW5jdGlvbigpe3JldHVybiBrfSx1bnN0YWJsZV9zaG91bGRZaWVsZDpmYSwKdW5zdGFibGVfcmVxdWVzdFBhaW50OmZ1bmN0aW9uKCl7fSx1bnN0YWJsZV9jb250aW51ZUV4ZWN1dGlvbjpmdW5jdGlvbigpe3V8fEZ8fCh1PSEwLFIoUykpfSx1bnN0YWJsZV9wYXVzZUV4ZWN1dGlvbjpmdW5jdGlvbigpe30sdW5zdGFibGVfZ2V0Rmlyc3RDYWxsYmFja05vZGU6ZnVuY3Rpb24oKXtyZXR1cm4gcChxKX0sZ2V0IHVuc3RhYmxlX25vdygpe3JldHVybiB2fSx1bnN0YWJsZV9mb3JjZUZyYW1lUmF0ZTpmdW5jdGlvbihhKXswPmF8fDEyNTxhP2NvbnNvbGUuZXJyb3IoImZvcmNlRnJhbWVSYXRlIHRha2VzIGEgcG9zaXRpdmUgaW50IGJldHdlZW4gMCBhbmQgMTI1LCBmb3JjaW5nIGZyYW1lIHJhdGVzIGhpZ2hlciB0aGFuIDEyNSBmcHMgaXMgbm90IHN1cHBvcnRlZCIpOmlhPTA8YT9NYXRoLmZsb29yKDFFMy9hKTo1fSx1bnN0YWJsZV9Qcm9maWxpbmc6bnVsbH19O2MuQ2hpbGRyZW49e21hcDpDLGZvckVhY2g6ZnVuY3Rpb24oYSxiLGMpe0MoYSxmdW5jdGlvbigpe2IuYXBwbHkodGhpcywKYXJndW1lbnRzKX0sYyl9LGNvdW50OmZ1bmN0aW9uKGEpe3ZhciBiPTA7QyhhLGZ1bmN0aW9uKCl7YisrfSk7cmV0dXJuIGJ9LHRvQXJyYXk6ZnVuY3Rpb24oYSl7cmV0dXJuIEMoYSxmdW5jdGlvbihhKXtyZXR1cm4gYX0pfHxbXX0sb25seTpmdW5jdGlvbihhKXtpZighTShhKSl0aHJvdyBFcnJvcigiUmVhY3QuQ2hpbGRyZW4ub25seSBleHBlY3RlZCB0byByZWNlaXZlIGEgc2luZ2xlIFJlYWN0IGVsZW1lbnQgY2hpbGQuIik7cmV0dXJuIGF9fTtjLkNvbXBvbmVudD13O2MuRnJhZ21lbnQ9cmE7Yy5Qcm9maWxlcj10YTtjLlB1cmVDb21wb25lbnQ9SztjLlN0cmljdE1vZGU9c2E7Yy5TdXNwZW5zZT14YTtjLl9fU0VDUkVUX0lOVEVSTkFMU19ET19OT1RfVVNFX09SX1lPVV9XSUxMX0JFX0ZJUkVEPXQ7Yy5jbG9uZUVsZW1lbnQ9ZnVuY3Rpb24oYSxiLGMpe2lmKG51bGw9PT1hfHx2b2lkIDA9PT1hKXRocm93IEVycm9yKCJSZWFjdC5jbG9uZUVsZW1lbnQoLi4uKTogVGhlIGFyZ3VtZW50IG11c3QgYmUgYSBSZWFjdCBlbGVtZW50LCBidXQgeW91IHBhc3NlZCAiKwphKyIuIik7dmFyIGU9a2Eoe30sYS5wcm9wcyksZD1hLmtleSxrPWEucmVmLGg9YS5fb3duZXI7aWYobnVsbCE9Yil7dm9pZCAwIT09Yi5yZWYmJihrPWIucmVmLGg9TC5jdXJyZW50KTt2b2lkIDAhPT1iLmtleSYmKGQ9IiIrYi5rZXkpO2lmKGEudHlwZSYmYS50eXBlLmRlZmF1bHRQcm9wcyl2YXIgbD1hLnR5cGUuZGVmYXVsdFByb3BzO2ZvcihmIGluIGIpYWEuY2FsbChiLGYpJiYhYmEuaGFzT3duUHJvcGVydHkoZikmJihlW2ZdPXZvaWQgMD09PWJbZl0mJnZvaWQgMCE9PWw/bFtmXTpiW2ZdKX12YXIgZj1hcmd1bWVudHMubGVuZ3RoLTI7aWYoMT09PWYpZS5jaGlsZHJlbj1jO2Vsc2UgaWYoMTxmKXtsPUFycmF5KGYpO2Zvcih2YXIgZz0wO2c8ZjtnKyspbFtnXT1hcmd1bWVudHNbZysyXTtlLmNoaWxkcmVuPWx9cmV0dXJueyQkdHlwZW9mOnksdHlwZTphLnR5cGUsa2V5OmQscmVmOmsscHJvcHM6ZSxfb3duZXI6aH19O2MuY3JlYXRlQ29udGV4dD1mdW5jdGlvbihhKXthPXskJHR5cGVvZjp2YSwKX2N1cnJlbnRWYWx1ZTphLF9jdXJyZW50VmFsdWUyOmEsX3RocmVhZENvdW50OjAsUHJvdmlkZXI6bnVsbCxDb25zdW1lcjpudWxsLF9kZWZhdWx0VmFsdWU6bnVsbCxfZ2xvYmFsTmFtZTpudWxsfTthLlByb3ZpZGVyPXskJHR5cGVvZjp1YSxfY29udGV4dDphfTtyZXR1cm4gYS5Db25zdW1lcj1hfTtjLmNyZWF0ZUVsZW1lbnQ9WjtjLmNyZWF0ZUZhY3Rvcnk9ZnVuY3Rpb24oYSl7dmFyIGI9Wi5iaW5kKG51bGwsYSk7Yi50eXBlPWE7cmV0dXJuIGJ9O2MuY3JlYXRlUmVmPWZ1bmN0aW9uKCl7cmV0dXJue2N1cnJlbnQ6bnVsbH19O2MuZm9yd2FyZFJlZj1mdW5jdGlvbihhKXtyZXR1cm57JCR0eXBlb2Y6d2EscmVuZGVyOmF9fTtjLmlzVmFsaWRFbGVtZW50PU07Yy5sYXp5PWZ1bmN0aW9uKGEpe3JldHVybnskJHR5cGVvZjp6YSxfcGF5bG9hZDp7X3N0YXR1czotMSxfcmVzdWx0OmF9LF9pbml0OnFhfX07Yy5tZW1vPWZ1bmN0aW9uKGEsYil7cmV0dXJueyQkdHlwZW9mOnlhLHR5cGU6YSwKY29tcGFyZTp2b2lkIDA9PT1iP251bGw6Yn19O2Muc3RhcnRUcmFuc2l0aW9uPWZ1bmN0aW9uKGEsYil7Yj1KLnRyYW5zaXRpb247Si50cmFuc2l0aW9uPXt9O3RyeXthKCl9ZmluYWxseXtKLnRyYW5zaXRpb249Yn19O2MudW5zdGFibGVfYWN0PWZ1bmN0aW9uKGEpe3Rocm93IEVycm9yKCJhY3QoLi4uKSBpcyBub3Qgc3VwcG9ydGVkIGluIHByb2R1Y3Rpb24gYnVpbGRzIG9mIFJlYWN0LiIpO307Yy51c2VDYWxsYmFjaz1mdW5jdGlvbihhLGIpe3JldHVybiBnLmN1cnJlbnQudXNlQ2FsbGJhY2soYSxiKX07Yy51c2VDb250ZXh0PWZ1bmN0aW9uKGEpe3JldHVybiBnLmN1cnJlbnQudXNlQ29udGV4dChhKX07Yy51c2VEZWJ1Z1ZhbHVlPWZ1bmN0aW9uKGEsYil7fTtjLnVzZURlZmVycmVkVmFsdWU9ZnVuY3Rpb24oYSl7cmV0dXJuIGcuY3VycmVudC51c2VEZWZlcnJlZFZhbHVlKGEpfTtjLnVzZUVmZmVjdD1mdW5jdGlvbihhLGIpe3JldHVybiBnLmN1cnJlbnQudXNlRWZmZWN0KGEsCmIpfTtjLnVzZUlkPWZ1bmN0aW9uKCl7cmV0dXJuIGcuY3VycmVudC51c2VJZCgpfTtjLnVzZUltcGVyYXRpdmVIYW5kbGU9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBnLmN1cnJlbnQudXNlSW1wZXJhdGl2ZUhhbmRsZShhLGIsYyl9O2MudXNlSW5zZXJ0aW9uRWZmZWN0PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGcuY3VycmVudC51c2VJbnNlcnRpb25FZmZlY3QoYSxiKX07Yy51c2VMYXlvdXRFZmZlY3Q9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gZy5jdXJyZW50LnVzZUxheW91dEVmZmVjdChhLGIpfTtjLnVzZU1lbW89ZnVuY3Rpb24oYSxiKXtyZXR1cm4gZy5jdXJyZW50LnVzZU1lbW8oYSxiKX07Yy51c2VSZWR1Y2VyPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gZy5jdXJyZW50LnVzZVJlZHVjZXIoYSxiLGMpfTtjLnVzZVJlZj1mdW5jdGlvbihhKXtyZXR1cm4gZy5jdXJyZW50LnVzZVJlZihhKX07Yy51c2VTdGF0ZT1mdW5jdGlvbihhKXtyZXR1cm4gZy5jdXJyZW50LnVzZVN0YXRlKGEpfTsKYy51c2VTeW5jRXh0ZXJuYWxTdG9yZT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIGcuY3VycmVudC51c2VTeW5jRXh0ZXJuYWxTdG9yZShhLGIsYyl9O2MudXNlVHJhbnNpdGlvbj1mdW5jdGlvbigpe3JldHVybiBnLmN1cnJlbnQudXNlVHJhbnNpdGlvbigpfTtjLnZlcnNpb249IjE4LjIuMCJ9KTsKfSkoKTsK",mtime:1744325324272},"assets/excalidraw.min.css":{data:"data:text/css;base64,LnBvcG92ZXJ7cG9zaXRpb246YWJzb2x1dGU7ei1pbmRleDoxMH0ucG9wb3ZlciAuY292ZXJ7cG9zaXRpb246Zml4ZWQ7dG9wOjA7bGVmdDowO3JpZ2h0OjA7Ym90dG9tOjB9CgouY29udGV4dC1tZW51e3Bvc2l0aW9uOnJlbGF0aXZlO2JvcmRlci1yYWRpdXM6NHB4O2JveC1zaGFkb3c6MHB4IDNweCAxMHB4IHJnYmEoMCwwLDAsMC4yKTtwYWRkaW5nOjA7bGlzdC1zdHlsZTpub25lO3VzZXItc2VsZWN0Om5vbmU7bWFyZ2luOi0wLjI1cmVtIDAgMCAwLjEyNXJlbTtwYWRkaW5nOjAuMjVyZW0gMDtiYWNrZ3JvdW5kLWNvbG9yOiNmMWYzZjU7Ym9yZGVyOjFweCBzb2xpZCAjYWRiNWJkfS5jb250ZXh0LW1lbnUtb3B0aW9ue3Bvc2l0aW9uOnJlbGF0aXZlO3dpZHRoOjEwMCU7bWluLXdpZHRoOjkuNXJlbTttYXJnaW46MDtwYWRkaW5nOjAuMjVyZW0gMXJlbSAwLjI1cmVtIDEuMjVyZW07dGV4dC1hbGlnbjpzdGFydDtib3JkZXItcmFkaXVzOjA7YmFja2dyb3VuZC1jb2xvcjp0cmFuc3BhcmVudDtib3JkZXI6bm9uZTt3aGl0ZS1zcGFjZTpub3dyYXB9LmNvbnRleHQtbWVudS1vcHRpb246aG92ZXJ7Y29sb3I6I2ZmZjtiYWNrZ3JvdW5kLWNvbG9yOiMzMzlhZjB9LmNvbnRleHQtbWVudS1vcHRpb246Zm9jdXN7ei1pbmRleDoxfQoKOnJvb3R7LS1idXR0b24tZ3JheS0xOiAjZTllY2VmOy0tYnV0dG9uLWdyYXktMjogI2NlZDRkYTstLWJ1dHRvbi1ncmF5LTM6ICNhZGI1YmQ7LS1idXR0b24tYmx1ZTogI2E1ZDhmZn0uVG9vbEljb257ZGlzcGxheTppbmxpbmUtZmxleDthbGlnbi1pdGVtczpjZW50ZXI7cG9zaXRpb246cmVsYXRpdmU7Zm9udC1mYW1pbHk6Q2FzY2FkaWE7Y3Vyc29yOnBvaW50ZXI7YmFja2dyb3VuZC1jb2xvcjp2YXIoLS1idXR0b24tZ3JheS0xKTstd2Via2l0LXRhcC1oaWdobGlnaHQtY29sb3I6dHJhbnNwYXJlbnQ7Ym9yZGVyLXJhZGl1czp2YXIoLS1zcGFjZS1mYWN0b3IpfS5Ub29sSWNvbl9faWNvbnt3aWR0aDoyLjVyZW07aGVpZ2h0OjIuNXJlbTtkaXNwbGF5OmZsZXg7anVzdGlmeS1jb250ZW50OmNlbnRlcjthbGlnbi1pdGVtczpjZW50ZXI7Ym9yZGVyLXJhZGl1czp2YXIoLS1zcGFjZS1mYWN0b3IpfS5Ub29sSWNvbl9faWNvbiBzdmd7cG9zaXRpb246cmVsYXRpdmU7aGVpZ2h0OjFlbX0uVG9vbEljb25fX2ljb24rLlRvb2xJY29uX19sYWJlbHttYXJnaW4taW5saW5lLXN0YXJ0OjB9LlRvb2xJY29uX19sYWJlbHtmb250LWZhbWlseTp2YXIoLS11aS1mb250KTttYXJnaW46MCAwLjhlbTt0ZXh0LW92ZXJmbG93OmVsbGlwc2lzfS5Ub29sSWNvbl9zaXplX3MgLlRvb2xJY29uX19pY29ue3dpZHRoOjEuNHJlbTtoZWlnaHQ6MS40cmVtO2ZvbnQtc2l6ZTowLjhlbX0uZXhjYWxpZHJhdyAuVG9vbEljb25fdHlwZV9idXR0b24sLk1vZGFsIC5Ub29sSWNvbl90eXBlX2J1dHRvbiwuVG9vbEljb25fdHlwZV9idXR0b257cGFkZGluZzowO2JvcmRlcjpub25lO21hcmdpbjowO2ZvbnQtc2l6ZTppbmhlcml0fS5leGNhbGlkcmF3IC5Ub29sSWNvbl90eXBlX2J1dHRvbjpob3ZlciwuTW9kYWwgLlRvb2xJY29uX3R5cGVfYnV0dG9uOmhvdmVyLC5Ub29sSWNvbl90eXBlX2J1dHRvbjpob3ZlcntiYWNrZ3JvdW5kLWNvbG9yOnZhcigtLWJ1dHRvbi1ncmF5LTEpfS5leGNhbGlkcmF3IC5Ub29sSWNvbl90eXBlX2J1dHRvbjphY3RpdmUsLk1vZGFsIC5Ub29sSWNvbl90eXBlX2J1dHRvbjphY3RpdmUsLlRvb2xJY29uX3R5cGVfYnV0dG9uOmFjdGl2ZXtiYWNrZ3JvdW5kLWNvbG9yOnZhcigtLWJ1dHRvbi1ncmF5LTIpfS5leGNhbGlkcmF3IC5Ub29sSWNvbl90eXBlX2J1dHRvbjpmb2N1cywuTW9kYWwgLlRvb2xJY29uX3R5cGVfYnV0dG9uOmZvY3VzLC5Ub29sSWNvbl90eXBlX2J1dHRvbjpmb2N1c3tib3gtc2hhZG93OjAgMCAwIDJweCB2YXIoLS1idXR0b24tYmx1ZSl9LmV4Y2FsaWRyYXcgLlRvb2xJY29uX3R5cGVfYnV0dG9uLlRvb2xJY29uLS1zZWxlY3RlZCwuTW9kYWwgLlRvb2xJY29uX3R5cGVfYnV0dG9uLlRvb2xJY29uLS1zZWxlY3RlZCwuVG9vbEljb25fdHlwZV9idXR0b24uVG9vbEljb24tLXNlbGVjdGVke2JhY2tncm91bmQtY29sb3I6dmFyKC0tYnV0dG9uLWdyYXktMil9LmV4Y2FsaWRyYXcgLlRvb2xJY29uX3R5cGVfYnV0dG9uLlRvb2xJY29uLS1zZWxlY3RlZDphY3RpdmUsLk1vZGFsIC5Ub29sSWNvbl90eXBlX2J1dHRvbi5Ub29sSWNvbi0tc2VsZWN0ZWQ6YWN0aXZlLC5Ub29sSWNvbl90eXBlX2J1dHRvbi5Ub29sSWNvbi0tc2VsZWN0ZWQ6YWN0aXZle2JhY2tncm91bmQtY29sb3I6dmFyKC0tYnV0dG9uLWdyYXktMyl9LmV4Y2FsaWRyYXcgLlRvb2xJY29uX3R5cGVfYnV0dG9uLS1zaG93LC5Nb2RhbCAuVG9vbEljb25fdHlwZV9idXR0b24tLXNob3csLlRvb2xJY29uX3R5cGVfYnV0dG9uLS1zaG93e3Zpc2liaWxpdHk6dmlzaWJsZX0uZXhjYWxpZHJhdyAuVG9vbEljb25fdHlwZV9idXR0b24tLWhpZGUsLk1vZGFsIC5Ub29sSWNvbl90eXBlX2J1dHRvbi0taGlkZSwuVG9vbEljb25fdHlwZV9idXR0b24tLWhpZGV7dmlzaWJpbGl0eTpoaWRkZW59LlRvb2xJY29uX3R5cGVfcmFkaW8sLlRvb2xJY29uX3R5cGVfY2hlY2tib3h7cG9zaXRpb246YWJzb2x1dGU7b3BhY2l0eTowO3BvaW50ZXItZXZlbnRzOm5vbmV9LlRvb2xJY29uX3R5cGVfcmFkaW86Y2hlY2tlZCsuVG9vbEljb25fX2ljb24sLlRvb2xJY29uX3R5cGVfY2hlY2tib3g6Y2hlY2tlZCsuVG9vbEljb25fX2ljb257YmFja2dyb3VuZC1jb2xvcjp2YXIoLS1idXR0b24tZ3JheS0yKX0uVG9vbEljb25fdHlwZV9yYWRpbzpmb2N1cysuVG9vbEljb25fX2ljb24sLlRvb2xJY29uX3R5cGVfY2hlY2tib3g6Zm9jdXMrLlRvb2xJY29uX19pY29ue2JveC1zaGFkb3c6MCAwIDAgMnB4IHZhcigtLWJ1dHRvbi1ibHVlKX0uVG9vbEljb25fdHlwZV9yYWRpbzphY3RpdmUrLlRvb2xJY29uX19pY29uLC5Ub29sSWNvbl90eXBlX2NoZWNrYm94OmFjdGl2ZSsuVG9vbEljb25fX2ljb257YmFja2dyb3VuZC1jb2xvcjp2YXIoLS1idXR0b24tZ3JheS0zKX0uVG9vbEljb25fdHlwZV9mbG9hdGluZ3tiYWNrZ3JvdW5kLWNvbG9yOnRyYW5zcGFyZW50fS5Ub29sSWNvbl90eXBlX2Zsb2F0aW5nOmhvdmVye2JhY2tncm91bmQtY29sb3I6dHJhbnNwYXJlbnR9LlRvb2xJY29uX3R5cGVfZmxvYXRpbmc6YWN0aXZle2JhY2tncm91bmQtY29sb3I6dHJhbnNwYXJlbnR9LlRvb2xJY29uX3R5cGVfZmxvYXRpbmc6Zm9jdXN7Ym94LXNoYWRvdzpub25lfS5Ub29sSWNvbl90eXBlX2Zsb2F0aW5nIC5Ub29sSWNvbl9faWNvbnt3aWR0aDoycmVtO2hlaWdodDoyZW19LlRvb2xJY29uLlRvb2xJY29uX19sb2NrLlRvb2xJY29uX3R5cGVfZmxvYXRpbmd7bWFyZ2luLWxlZnQ6MC4xcmVtfS5Ub29sSWNvbl9fa2V5YmluZGluZ3twb3NpdGlvbjphYnNvbHV0ZTtib3R0b206MnB4O3JpZ2h0OjNweDtmb250LXNpemU6MC41ZW07Y29sb3I6dmFyKC0tYnV0dG9uLWdyYXktMyk7Zm9udC1mYW1pbHk6dmFyKC0tdWktZm9udCk7dXNlci1zZWxlY3Q6bm9uZX1AbWVkaWEgKG1heC13aWR0aDogNDI1cHgpey5TaGFwZSAuVG9vbEljb25fX2ljb257d2lkdGg6MnJlbTtoZWlnaHQ6MnJlbX0uU2hhcGUgLlRvb2xJY29uX19pY29uIHN2Z3toZWlnaHQ6MC44ZW19fUBtZWRpYSAobWF4LXdpZHRoOiAzNjBweCl7LlRvb2xJY29uLlRvb2xJY29uX19sb2Nre2Rpc3BsYXk6aW5saW5lLWJsb2NrO3Bvc2l0aW9uOmFic29sdXRlO3RvcDo2MHB4O3JpZ2h0Oi04cHg7bWFyZ2luLWxlZnQ6MDtib3JkZXItcmFkaXVzOjIwcHggMCAwIDIwcHg7YmFja2dyb3VuZC1jb2xvcjp2YXIoLS1idXR0b24tZ3JheS0xKX0uVG9vbEljb24uVG9vbEljb25fX2xvY2s6aG92ZXJ7YmFja2dyb3VuZC1jb2xvcjp2YXIoLS1idXR0b24tZ3JheS0xKX0uVG9vbEljb24uVG9vbEljb25fX2xvY2s6YWN0aXZle2JhY2tncm91bmQtY29sb3I6dmFyKC0tYnV0dG9uLWdyYXktMil9LlRvb2xJY29uLlRvb2xJY29uX19sb2NrIC5Ub29sSWNvbl9faWNvbntib3JkZXItcmFkaXVzOmluaGVyaXR9LlRvb2xJY29uLlRvb2xJY29uX19sb2NrIHN2Z3twb3NpdGlvbjpzdGF0aWN9fTpyb290W2Rpcj0ibHRyIl0gLnVubG9ja2VkLWljb257bGVmdDoycHh9OnJvb3RbZGlyPSJydGwiXSAudW5sb2NrZWQtaWNvbntyaWdodDoycHh9CgouY29sb3ItcGlja2Vye2JhY2tncm91bmQ6I2ZmZjtib3JkZXI6MHB4IHNvbGlkIHJnYmEoMjU1LDI1NSwyNTUsMC4yNSk7Ym94LXNoYWRvdzpyZ2JhKDAsMCwwLDAuMjUpIDBweCAxcHggNHB4O2JvcmRlci1yYWRpdXM6NHB4O3Bvc2l0aW9uOmFic29sdXRlfTpyb290W2Rpcj0ibHRyIl0gLmNvbG9yLXBpY2tlcntsZWZ0Oi01LjVweH06cm9vdFtkaXI9InJ0bCJdIC5jb2xvci1waWNrZXJ7cmlnaHQ6LTUuNXB4fS5jb2xvci1waWNrZXItY29udHJvbC1jb250YWluZXJ7ZGlzcGxheTpncmlkO2dyaWQtdGVtcGxhdGUtY29sdW1uczphdXRvIDFmcjthbGlnbi1pdGVtczpjZW50ZXJ9LmNvbG9yLXBpY2tlci10cmlhbmdsZXt3aWR0aDowcHg7aGVpZ2h0OjBweDtib3JkZXItc3R5bGU6c29saWQ7Ym9yZGVyLXdpZHRoOjBweCA5cHggMTBweDtib3JkZXItY29sb3I6dHJhbnNwYXJlbnQgdHJhbnNwYXJlbnQgI2ZmZjtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6LTEwcHh9OnJvb3RbZGlyPSJsdHIiXSAuY29sb3ItcGlja2VyLXRyaWFuZ2xle2xlZnQ6MTJweH06cm9vdFtkaXI9InJ0bCJdIC5jb2xvci1waWNrZXItdHJpYW5nbGV7cmlnaHQ6MTJweH0uY29sb3ItcGlja2VyLXRyaWFuZ2xlLXNoYWRvd3tib3JkZXItY29sb3I6dHJhbnNwYXJlbnQgdHJhbnNwYXJlbnQgcmdiYSgwLDAsMCwwLjEpO3RvcDotMTFweH0uY29sb3ItcGlja2VyLWNvbnRlbnR7cGFkZGluZzowLjVyZW07ZGlzcGxheTpncmlkO2dyaWQtdGVtcGxhdGUtY29sdW1uczpyZXBlYXQoNSwgYXV0byk7Z3JpZC1nYXA6MC41cmVtfS5jb2xvci1waWNrZXItY29udGVudCAuY29sb3ItaW5wdXQtY29udGFpbmVye2dyaWQtY29sdW1uOjEgLyBzcGFuIDV9LmV4Y2FsaWRyYXcgLmNvbG9yLXBpY2tlci1zd2F0Y2h7cG9zaXRpb246cmVsYXRpdmU7aGVpZ2h0OjEuODc1cmVtO3dpZHRoOjEuODc1cmVtO2N1cnNvcjpwb2ludGVyO2JvcmRlci1yYWRpdXM6NHB4O21hcmdpbjowO2JveC1zaXppbmc6Ym9yZGVyLWJveDtib3JkZXI6MXB4IHNvbGlkICNkZGQ7YmFja2dyb3VuZC1jb2xvcjpjdXJyZW50Q29sb3IgIWltcG9ydGFudH0uZXhjYWxpZHJhdyAuY29sb3ItcGlja2VyLXN3YXRjaDpmb2N1c3tib3gtc2hhZG93OjAgMCA0cHggMXB4IGN1cnJlbnRDb2xvcjtib3JkZXItY29sb3I6IzMzOWFmMH0uY29sb3ItcGlja2VyLXRyYW5zcGFyZW50e2JvcmRlci1yYWRpdXM6NHB4O2JveC1zaGFkb3c6cmdiYSgwLDAsMCwwLjEpIDBweCAwcHggMHB4IDFweCBpbnNldDtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MHB4O3JpZ2h0OjBweDtib3R0b206MHB4O2xlZnQ6MHB4fS5jb2xvci1waWNrZXItdHJhbnNwYXJlbnQsLmNvbG9yLXBpY2tlci1sYWJlbC1zd2F0Y2h7YmFja2dyb3VuZDp1cmwoImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBQkFBQUFBUUNBWUFBQUFmOC85aEFBQUFNVWxFUVZRNFQyTmtZR0FRWWNBUDN1Q1RaaHcxZ0dHWWhBR0JaSUEvbllEQ2dCREFtOUJHRFdBQUp5UkNnTGFCQ0FBZ1h3aXh6QVMwcGdBQUFBQkpSVTVFcmtKZ2dnPT0iKSBsZWZ0IGNlbnRlcn0uY29sb3ItcGlja2VyLWhhc2h7YmFja2dyb3VuZDojZGVlMmU2O2hlaWdodDoxLjg3NXJlbTt3aWR0aDoxLjg3NXJlbTtjb2xvcjojNDk1MDU3O2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcjtwb3NpdGlvbjpyZWxhdGl2ZX06cm9vdFtkaXI9Imx0ciJdIC5jb2xvci1waWNrZXItaGFzaHtib3JkZXItcmFkaXVzOjRweCAwcHggMHB4IDRweH06cm9vdFtkaXI9InJ0bCJdIC5jb2xvci1waWNrZXItaGFzaHtib3JkZXItcmFkaXVzOjBweCA0cHggNHB4IDBweH0uY29sb3ItaW5wdXQtY29udGFpbmVyOmZvY3VzLXdpdGhpbiAuY29sb3ItcGlja2VyLWhhc2h7Ym94LXNoYWRvdzowIDAgMCAycHggI2E1ZDhmZn0uY29sb3ItaW5wdXQtY29udGFpbmVyOmZvY3VzLXdpdGhpbiAuY29sb3ItcGlja2VyLWhhc2g6OmJlZm9yZSwuY29sb3ItaW5wdXQtY29udGFpbmVyOmZvY3VzLXdpdGhpbiAuY29sb3ItcGlja2VyLWhhc2g6OmFmdGVye2NvbnRlbnQ6IiI7d2lkdGg6MXB4O2hlaWdodDoxMDAlO3Bvc2l0aW9uOmFic29sdXRlO3RvcDowfS5jb2xvci1pbnB1dC1jb250YWluZXI6Zm9jdXMtd2l0aGluIC5jb2xvci1waWNrZXItaGFzaDo6YmVmb3Jle2JhY2tncm91bmQ6I2RlZTJlNn06cm9vdFtkaXI9Imx0ciJdIC5jb2xvci1pbnB1dC1jb250YWluZXI6Zm9jdXMtd2l0aGluIC5jb2xvci1waWNrZXItaGFzaDo6YmVmb3Jle3JpZ2h0Oi0xcHh9OnJvb3RbZGlyPSJydGwiXSAuY29sb3ItaW5wdXQtY29udGFpbmVyOmZvY3VzLXdpdGhpbiAuY29sb3ItcGlja2VyLWhhc2g6OmJlZm9yZXtsZWZ0Oi0xcHh9LmNvbG9yLWlucHV0LWNvbnRhaW5lcjpmb2N1cy13aXRoaW4gLmNvbG9yLXBpY2tlci1oYXNoOjphZnRlcntiYWNrZ3JvdW5kOiNmZmZ9OnJvb3RbZGlyPSJsdHIiXSAuY29sb3ItaW5wdXQtY29udGFpbmVyOmZvY3VzLXdpdGhpbiAuY29sb3ItcGlja2VyLWhhc2g6OmFmdGVye3JpZ2h0Oi0ycHh9OnJvb3RbZGlyPSJydGwiXSAuY29sb3ItaW5wdXQtY29udGFpbmVyOmZvY3VzLXdpdGhpbiAuY29sb3ItcGlja2VyLWhhc2g6OmFmdGVye2xlZnQ6LTJweH0uY29sb3ItaW5wdXQtY29udGFpbmVye2Rpc3BsYXk6ZmxleH0uY29sb3ItcGlja2VyLWlucHV0e3dpZHRoOjEyY2g7bWFyZ2luOjA7Zm9udC1zaXplOjFyZW07Y29sb3I6IzM0M2E0MDtib3JkZXI6MHB4O291dGxpbmU6bm9uZTtoZWlnaHQ6MS43NWVtO2JveC1zaGFkb3c6I2RlZTJlNiAwcHggMHB4IDBweCAxcHggaW5zZXQ7ZmxvYXQ6bGVmdDtwYWRkaW5nOjFweDtwYWRkaW5nLWlubGluZS1zdGFydDowLjVlbTthcHBlYXJhbmNlOm5vbmV9OnJvb3RbZGlyPSJsdHIiXSAuY29sb3ItcGlja2VyLWlucHV0e2JvcmRlci1yYWRpdXM6MHB4IDRweCA0cHggMHB4fTpyb290W2Rpcj0icnRsIl0gLmNvbG9yLXBpY2tlci1pbnB1dHtib3JkZXItcmFkaXVzOjRweCAwcHggMHB4IDRweH0uZXhjYWxpZHJhdyAuY29sb3ItcGlja2VyLWxhYmVsLXN3YXRjaHtoZWlnaHQ6MS44NzVyZW07d2lkdGg6MS44NzVyZW07bWFyZ2luLWlubGluZS1lbmQ6MC4yNXJlbTtib3JkZXI6MXB4IHNvbGlkICNkZWUyZTY7cG9zaXRpb246cmVsYXRpdmU7b3ZlcmZsb3c6aGlkZGVuO2JhY2tncm91bmQtY29sb3I6dHJhbnNwYXJlbnQgIWltcG9ydGFudH0uZXhjYWxpZHJhdyAuY29sb3ItcGlja2VyLWxhYmVsLXN3YXRjaDphZnRlcntjb250ZW50OiIiO3Bvc2l0aW9uOmFic29sdXRlO3RvcDowO2xlZnQ6MDt3aWR0aDoxMDAlO2hlaWdodDoxMDAlO2JhY2tncm91bmQ6dmFyKC0tc3dhdGNoLWNvbG9yKX0uY29sb3ItcGlja2VyLWtleWJpbmRpbmd7cG9zaXRpb246YWJzb2x1dGU7Ym90dG9tOjJweDtmb250LXNpemU6MC43ZW07Y29sb3I6I2NjY306cm9vdFtkaXI9Imx0ciJdIC5jb2xvci1waWNrZXIta2V5YmluZGluZ3tyaWdodDoycHh9OnJvb3RbZGlyPSJydGwiXSAuY29sb3ItcGlja2VyLWtleWJpbmRpbmd7bGVmdDoycHh9CgouVGV4dElucHV0e2Rpc3BsYXk6aW5saW5lLWJsb2NrO2JvcmRlcjoxLjVweCBzb2xpZCAjZTllY2VmO2xpbmUtaGVpZ2h0OjE7cGFkZGluZzowLjc1cmVtO3doaXRlLXNwYWNlOm5vd3JhcDtib3JkZXItcmFkaXVzOnZhcigtLXNwYWNlLWZhY3Rvcik7YmFja2dyb3VuZC1jb2xvcjojZmZmfS5UZXh0SW5wdXQ6bm90KDpmb2N1cyk6aG92ZXJ7YmFja2dyb3VuZC1jb2xvcjojZjFmM2Y1fS5UZXh0SW5wdXQ6Zm9jdXN7b3V0bGluZTpub25lO2JveC1zaGFkb3c6MCAwIDAgMnB4ICMzMzlhZjB9CgouQXZhdGFye3dpZHRoOjIuNXJlbTtoZWlnaHQ6Mi41cmVtO2JvcmRlci1yYWRpdXM6MS4yNXJlbTtkaXNwbGF5OmZsZXg7anVzdGlmeS1jb250ZW50OmNlbnRlcjthbGlnbi1pdGVtczpjZW50ZXI7Y29sb3I6I2ZmZjtjdXJzb3I6cG9pbnRlcjtmb250LXNpemU6MC44cmVtO2ZvbnQtd2VpZ2h0OjUwMH0KCi5Jc2xhbmR7LS1wYWRkaW5nOiAwO2JhY2tncm91bmQtY29sb3I6dmFyKC0tYmctY29sb3ItaXNsYW5kKTtiYWNrZHJvcC1maWx0ZXI6c2F0dXJhdGUoMTAwJSkgYmx1cigxMHB4KTtib3gtc2hhZG93OnZhcigtLXNoYWRvdy1pc2xhbmQpO2JvcmRlci1yYWRpdXM6dmFyKC0tYm9yZGVyLXJhZGl1cy1tKTtwYWRkaW5nOmNhbGModmFyKC0tcGFkZGluZykgKiB2YXIoLS1zcGFjZS1mYWN0b3IpKTtwb3NpdGlvbjpyZWxhdGl2ZTt0cmFuc2l0aW9uOmJveC1zaGFkb3cgMC41cyBlYXNlLWluLW91dH0uSXNsYW5kLnplbi1tb2Rle2JveC1zaGFkb3c6bm9uZX0KCi5TdGFja3stLWdhcDogMDtkaXNwbGF5OmdyaWQ7Z2FwOmNhbGModmFyKC0tc3BhY2UtZmFjdG9yKSAqIHZhcigtLWdhcCkpfS5TdGFja192ZXJ0aWNhbHtncmlkLXRlbXBsYXRlLWNvbHVtbnM6YXV0bztncmlkLWF1dG8tZmxvdzpyb3c7Z3JpZC1hdXRvLXJvd3M6bWluLWNvbnRlbnR9LlN0YWNrX2hvcml6b250YWx7Z3JpZC10ZW1wbGF0ZS1yb3dzOmF1dG87Z3JpZC1hdXRvLWZsb3c6Y29sdW1uO2dyaWQtYXV0by1jb2x1bW5zOm1pbi1jb250ZW50fQoKLkZpeGVkU2lkZUNvbnRhaW5lcnstLW1hcmdpbjogMC4yNXJlbTtwb3NpdGlvbjphYnNvbHV0ZTtwb2ludGVyLWV2ZW50czpub25lfS5GaXhlZFNpZGVDb250YWluZXI+Kntwb2ludGVyLWV2ZW50czphbGx9LkZpeGVkU2lkZUNvbnRhaW5lcl9zaWRlX3RvcHtsZWZ0OnZhcigtLW1hcmdpbik7dG9wOnZhcigtLW1hcmdpbik7cmlnaHQ6dmFyKC0tbWFyZ2luKTt6LWluZGV4OjJ9LkZpeGVkU2lkZUNvbnRhaW5lcl9zaWRlX3RvcC56ZW4tbW9kZXtyaWdodDo0MnB4fQoKLlVzZXJMaXN0e3BvaW50ZXItZXZlbnRzOm5vbmU7cGFkZGluZzp2YXIoLS1zcGFjZS1mYWN0b3IpIDQwcHggdmFyKC0tc3BhY2UtZmFjdG9yKSB2YXIoLS1zcGFjZS1mYWN0b3IpO2Rpc3BsYXk6ZmxleDtmbGV4LXdyYXA6d3JhcDtqdXN0aWZ5LWNvbnRlbnQ6ZmxleC1lbmR9LlVzZXJMaXN0Pip7cG9pbnRlci1ldmVudHM6YWxsO21hcmdpbjowIDAgdmFyKC0tc3BhY2UtZmFjdG9yKSB2YXIoLS1zcGFjZS1mYWN0b3IpfS5Vc2VyTGlzdF9tb2JpbGV7cGFkZGluZzowO2p1c3RpZnktY29udGVudDpub3JtYWx9LlVzZXJMaXN0X21vYmlsZT4qe21hcmdpbjowIHZhcigtLXNwYWNlLWZhY3RvcikgdmFyKC0tc3BhY2UtZmFjdG9yKSAwfQoKLkV4cG9ydERpYWxvZ19fcHJldmlld3stLXByZXZpZXctcGFkZGluZzogY2FsYyh2YXIoLS1zcGFjZS1mYWN0b3IpICogNCk7YmFja2dyb3VuZDp1cmwoImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBQkFBQUFBUUNBWUFBQUFmOC85aEFBQUFNVWxFUVZRNFQyTmtZR0FRWWNBUDN1Q1RaaHcxZ0dHWWhBR0JaSUEvbllEQ2dCREFtOUJHRFdBQUp5UkNnTGFCQ0FBZ1h3aXh6QVMwcGdBQUFBQkpSVTVFcmtKZ2dnPT0iKSBsZWZ0IGNlbnRlcjt0ZXh0LWFsaWduOmNlbnRlcjtwYWRkaW5nOnZhcigtLXByZXZpZXctcGFkZGluZyk7bWFyZ2luLWJvdHRvbTpjYWxjKHZhcigtLXNwYWNlLWZhY3RvcikgKiAzKX0uRXhwb3J0RGlhbG9nX19wcmV2aWV3IGNhbnZhc3ttYXgtd2lkdGg6Y2FsYygxMDAlIC0gdmFyKC0tcHJldmlldy1wYWRkaW5nKSAqIDIpO21heC1oZWlnaHQ6MjVyZW19LkV4cG9ydERpYWxvZ19fYWN0aW9uc3t3aWR0aDoxMDAlO2Rpc3BsYXk6ZmxleDtncmlkLWdhcDpjYWxjKHZhcigtLXNwYWNlLWZhY3RvcikgKiAyKTthbGlnbi1pdGVtczp0b3A7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW59LkV4cG9ydERpYWxvZ19fbmFtZXtncmlkLWNvbHVtbjpwcm9qZWN0LW5hbWU7bWFyZ2luOmF1dG99QG1lZGlhIChtYXgtd2lkdGg6IDU1MHB4KXsuRXhwb3J0RGlhbG9ne2Rpc3BsYXk6ZmxleDtmbGV4LWRpcmVjdGlvbjpjb2x1bW59LkV4cG9ydERpYWxvZ19fYWN0aW9uc3tmbGV4LWRpcmVjdGlvbjpjb2x1bW47YWxpZ24taXRlbXM6Y2VudGVyfS5FeHBvcnREaWFsb2dfX2FjdGlvbnM+KnttYXJnaW4tYm90dG9tOmNhbGModmFyKC0tc3BhY2UtZmFjdG9yKSAqIDMpfX1AbWVkaWEgKG1heC13aWR0aDogNjAwcHgpLCAobWF4LWhlaWdodDogNTAwcHgpIGFuZCAobWF4LXdpZHRoOiAxMDAwcHgpey5FeHBvcnREaWFsb2dfX3ByZXZpZXcgY2FudmFze21heC1oZWlnaHQ6MzB2aH0uRXhwb3J0RGlhbG9nX19kaWFsb2csLkV4cG9ydERpYWxvZ19fZGlhbG9nIC5Jc2xhbmR7aGVpZ2h0OjEwMCU7Ym94LXNpemluZzpib3JkZXItYm94fS5FeHBvcnREaWFsb2dfX2RpYWxvZyAuSXNsYW5ke292ZXJmbG93LXk6YXV0b319CgouTW9kYWx7cG9zaXRpb246Zml4ZWQ7dG9wOjA7bGVmdDowO3JpZ2h0OjA7Ym90dG9tOjA7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO292ZXJmbG93OmF1dG87cGFkZGluZzpjYWxjKHZhcigtLXNwYWNlLWZhY3RvcikgKiAxMCl9Lk1vZGFsX19iYWNrZ3JvdW5ke3Bvc2l0aW9uOmZpeGVkO3RvcDowO2xlZnQ6MDtyaWdodDowO2JvdHRvbTowO3otaW5kZXg6MTtiYWNrZ3JvdW5kLWNvbG9yOnJnYmEoMCwwLDAsMC4zKTtiYWNrZHJvcC1maWx0ZXI6Ymx1cigycHgpfS5Nb2RhbF9fY29udGVudHtwb3NpdGlvbjpyZWxhdGl2ZTt6LWluZGV4OjI7d2lkdGg6MTAwJTttYXgtd2lkdGg6dmFyKC0tbWF4LXdpZHRoKTtvcGFjaXR5OjA7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoMTBweCk7YW5pbWF0aW9uOk1vZGFsX19jb250ZW50X2ZhZGUtaW4gMC4xcyBlYXNlLW91dCAwLjA1cyBmb3J3YXJkcztwb3NpdGlvbjpyZWxhdGl2ZTtiYWNrZ3JvdW5kOiNmZmY7YmFja2Ryb3AtZmlsdGVyOm5vbmV9QG1lZGlhIChtYXgtd2lkdGg6IDYwMHB4KSwgKG1heC1oZWlnaHQ6IDUwMHB4KSBhbmQgKG1heC13aWR0aDogMTAwMHB4KXsuTW9kYWxfX2NvbnRlbnR7bWF4LXdpZHRoOjEwMCV9fUBrZXlmcmFtZXMgTW9kYWxfX2NvbnRlbnRfZmFkZS1pbntmcm9te29wYWNpdHk6MDt0cmFuc2Zvcm06dHJhbnNsYXRlWSgxMHB4KX10b3tvcGFjaXR5OjE7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoMCl9fS5Nb2RhbF9fY2xvc2V7d2lkdGg6Y2FsYyh2YXIoLS1zcGFjZS1mYWN0b3IpICogNyk7aGVpZ2h0OmNhbGModmFyKC0tc3BhY2UtZmFjdG9yKSAqIDcpO2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcn0uTW9kYWxfX2Nsb3NlIHN2Z3toZWlnaHQ6Y2FsYyh2YXIoLS1zcGFjZS1mYWN0b3IpICogNSl9Lk1vZGFsX19jbG9zZS0tZmxvYXRpbmd7cG9zaXRpb246YWJzb2x1dGU7cmlnaHQ6Y2FsYyh2YXIoLS1zcGFjZS1mYWN0b3IpICogNSk7dG9wOmNhbGModmFyKC0tc3BhY2UtZmFjdG9yKSAqIDUpfUBtZWRpYSAobWF4LXdpZHRoOiA2MDBweCksIChtYXgtaGVpZ2h0OiA1MDBweCkgYW5kIChtYXgtd2lkdGg6IDEwMDBweCl7Lk1vZGFse3BhZGRpbmc6MH0uTW9kYWxfX2NvbnRlbnR7cG9zaXRpb246Zml4ZWQ7dG9wOjA7bGVmdDowO3JpZ2h0OjA7Ym90dG9tOjB9fQoKLkRpYWxvZ19fdGl0bGV7ZGlzcGxheTpncmlkO2FsaWduLWl0ZW1zOmNlbnRlcjttYXJnaW4tdG9wOjA7Z3JpZC10ZW1wbGF0ZS1jb2x1bW5zOjFmciBjYWxjKHZhcigtLXNwYWNlLWZhY3RvcikgKiA3KTtncmlkLWdhcDp2YXIoLS1tZXRyaWMpfS5EaWFsb2dfX3RpdGxlQ29udGVudHtmbGV4OjF9LkRpYWxvZyAuTW9kYWxfX2Nsb3Nle21hcmdpbjowfUBtZWRpYSAobWF4LXdpZHRoOiA2MDBweCksIChtYXgtaGVpZ2h0OiA1MDBweCkgYW5kIChtYXgtd2lkdGg6IDEwMDBweCl7LkRpYWxvZ3stLW1ldHJpYzogY2FsYyh2YXIoLS1zcGFjZS1mYWN0b3IpICogNCk7LS1pbnNldC1sZWZ0OiBtYXgodmFyKC0tbWV0cmljKSwgdmFyKC0tc2FsKSk7LS1pbnNldC1yaWdodDogbWF4KHZhcigtLW1ldHJpYyksIHZhcigtLXNhcikpfS5EaWFsb2dfX3RpdGxle2dyaWQtdGVtcGxhdGUtY29sdW1uczpjYWxjKHZhcigtLXNwYWNlLWZhY3RvcikgKiA3KSAxZnIgY2FsYyggdmFyKC0tc3BhY2UtZmFjdG9yKSAqIDcpO3Bvc2l0aW9uOnN0aWNreTt0b3A6Y2FsYygtMSAqIHZhcigtLW1ldHJpYykpO21hcmdpbjpjYWxjKC0xICogdmFyKC0taW5zZXQtcmlnaHQpKTttYXJnaW4tdG9wOmNhbGMoLTEgKiB2YXIoLS1tZXRyaWMpKTttYXJnaW4tYm90dG9tOnZhcigtLW1ldHJpYyk7cGFkZGluZzpjYWxjKHZhcigtLXNwYWNlLWZhY3RvcikgKiAyKTtwYWRkaW5nLWxlZnQ6dmFyKC0taW5zZXQtbGVmdCk7cGFkZGluZy1yaWdodDp2YXIoLS1pbnNldC1yaWdodCk7YmFja2dyb3VuZDp3aGl0ZTtmb250LXNpemU6MS4yNWVtO2JveC1zaXppbmc6Ym9yZGVyLWJveDtib3JkZXItYm90dG9tOjFweCBzb2xpZCAjY2VkNGRhO3otaW5kZXg6MX0uRGlhbG9nX190aXRsZUNvbnRlbnR7dGV4dC1hbGlnbjpjZW50ZXJ9LkRpYWxvZyAuSXNsYW5ke3dpZHRoOjEwMHZ3O2hlaWdodDoxMDAlO2JveC1zaXppbmc6Ym9yZGVyLWJveDtvdmVyZmxvdy15OmF1dG87cGFkZGluZy1sZWZ0Om1heChjYWxjKHZhcigtLXBhZGRpbmcpICogdmFyKC0tc3BhY2UtZmFjdG9yKSksIHZhcigtLXNhbCkpO3BhZGRpbmctcmlnaHQ6bWF4KGNhbGModmFyKC0tcGFkZGluZykgKiB2YXIoLS1zcGFjZS1mYWN0b3IpKSwgdmFyKC0tc2FyKSk7cGFkZGluZy1ib3R0b206bWF4KGNhbGModmFyKC0tcGFkZGluZykgKiB2YXIoLS1zcGFjZS1mYWN0b3IpKSwgdmFyKC0tc2FiKSl9LkRpYWxvZyAuTW9kYWxfX2Nsb3Nle29yZGVyOi0xfX0KCi5IaW50Vmlld2Vye2NvbG9yOiM4NjhlOTY7Zm9udC1zaXplOjAuOHJlbTtsZWZ0OjUwJTtwb2ludGVyLWV2ZW50czpub25lO3Bvc2l0aW9uOmFic29sdXRlO3RvcDo1NHB4O3RyYW5zZm9ybTp0cmFuc2xhdGVYKGNhbGMoLTUwJSAtIDE2cHgpKTt3aGl0ZS1zcGFjZTpwcmU7dGV4dC1hbGlnbjpjZW50ZXJ9QG1lZGlhIChtYXgtd2lkdGg6IDYwMHB4KSwgKG1heC1oZWlnaHQ6IDUwMHB4KSBhbmQgKG1heC13aWR0aDogMTAwMHB4KXsuSGludFZpZXdlcntwb3NpdGlvbjpzdGF0aWM7dHJhbnNmb3JtOm5vbmU7bWFyZ2luLXRvcDowLjVyZW19fS5IaW50Vmlld2VyPnNwYW57YmFja2dyb3VuZC1jb2xvcjpyZ2JhKDI1NSwyNTUsMjU1LDAuODgpO3BhZGRpbmc6MC4ycmVtIDAuNHJlbTtib3JkZXItcmFkaXVzOjNweH0KCi5Sb29tRGlhbG9nLW1vZGFsQnV0dG9uLmlzLWNvbGxhYm9yYXRpbmd7YmFja2dyb3VuZC1jb2xvcjojZWJmYmVlO2NvbG9yOiMyYjhhM2V9LlJvb21EaWFsb2ctbW9kYWxCdXR0b24tY29sbGFib3JhdG9yc3ttaW4td2lkdGg6MWVtO3Bvc2l0aW9uOmFic29sdXRlO2JvdHRvbTotNXB4O3JpZ2h0Oi01cHg7cGFkZGluZzozcHg7Ym9yZGVyLXJhZGl1czo1MCU7YmFja2dyb3VuZC1jb2xvcjojNDBjMDU3O2NvbG9yOiNmZmY7Zm9udC1zaXplOjAuN2VtO2ZvbnQtZmFtaWx5OnZhcigtLXVpLWZvbnQpfS5Sb29tRGlhbG9nLWxpbmtDb250YWluZXJ7ZGlzcGxheTpmbGV4O21hcmdpbjoxLjVlbSAwfS5Sb29tRGlhbG9nLWxpbmt7bWluLXdpZHRoOjA7ZmxleDoxIDEgYXV0bzttYXJnaW4tbGVmdDoxZW07ZGlzcGxheTppbmxpbmUtYmxvY2s7Y3Vyc29yOnBvaW50ZXI7Ym9yZGVyOm5vbmU7aGVpZ2h0OjIuNXJlbTtsaW5lLWhlaWdodDoyLjVyZW07cGFkZGluZzowIDAuNXJlbTt3aGl0ZS1zcGFjZTpub3dyYXA7Ym9yZGVyLXJhZGl1czp2YXIoLS1zcGFjZS1mYWN0b3IpO2JhY2tncm91bmQtY29sb3I6dmFyKC0tYnV0dG9uLWdyYXktMSl9LlJvb21EaWFsb2ctdXNlcm5hbWVDb250YWluZXJ7ZGlzcGxheTpmbGV4O21hcmdpbjoxLjVlbSAwO2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcn0uUm9vbURpYWxvZy11c2VybmFtZXthcHBlYXJhbmNlOm5vbmU7bWluLXdpZHRoOjA7ZmxleDoxIDEgYXV0bzttYXJnaW4tbGVmdDoxZW07aGVpZ2h0OjIuNXJlbTtmb250LXNpemU6MWVtO2xpbmUtaGVpZ2h0OjEuNTtwYWRkaW5nOjAgMC41cmVtfS5Sb29tRGlhbG9nLXNlc3Npb25TdGFydEJ1dHRvbkNvbnRhaW5lcntkaXNwbGF5OmZsZXg7anVzdGlmeS1jb250ZW50OmNlbnRlcn0uTW9kYWwgLlJvb21EaWFsb2ctc3RvcFNlc3Npb257YmFja2dyb3VuZC1jb2xvcjojZmZlM2UzO2NvbG9yOiNjOTJhMmF9CgouVG9vbHRpcHtwb3NpdGlvbjpyZWxhdGl2ZX0uVG9vbHRpcF9fbGFiZWx7LS1hcnJvdy1zaXplOiA0cHg7dmlzaWJpbGl0eTpoaWRkZW47d2lkdGg6MTBjaDtiYWNrZ3JvdW5kOiMwMDA7Y29sb3I6I2ZmZjt0ZXh0LWFsaWduOmNlbnRlcjtib3JkZXItcmFkaXVzOjRweDtwYWRkaW5nOjRweDtwb3NpdGlvbjphYnNvbHV0ZTt6LWluZGV4OjEwO2ZvbnQtc2l6ZTowLjdyZW07bGluZS1oZWlnaHQ6MS41O3RvcDpjYWxjKDEwMCUgKyB2YXIoLS1hcnJvdy1zaXplKSArIDNweCk7bGVmdDpjYWxjKC01MCUgKyB2YXIoLS1hcnJvdy1zaXplKSAvIDIgLSAxcHgpO3dvcmQtd3JhcDpicmVhay13b3JkfS5Ub29sdGlwX19sYWJlbDo6YWZ0ZXJ7Y29udGVudDoiIjtib3JkZXI6dmFyKC0tYXJyb3ctc2l6ZSkgc29saWQgdHJhbnNwYXJlbnQ7Ym9yZGVyLWJvdHRvbS1jb2xvcjojMDAwO3Bvc2l0aW9uOmFic29sdXRlO2JvdHRvbToxMDAlO2xlZnQ6Y2FsYyg1MCUgLSB2YXIoLS1hcnJvdy1zaXplKSl9Ym9keTphY3RpdmUgLlRvb2x0aXA6bm90KDpob3Zlcil7cG9pbnRlci1ldmVudHM6bm9uZX1ib2R5Om5vdCg6YWN0aXZlKSAuVG9vbHRpcDpob3ZlciAuVG9vbHRpcF9fbGFiZWx7dmlzaWJpbGl0eTp2aXNpYmxlfS5Ub29sdGlwX19sYWJlbDpob3Zlcnt2aXNpYmlsaXR5OnZpc2libGV9CgoubGF5ZXItdWlfX2xpYnJhcnl7bWFyZ2luOmF1dG87ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyfS5sYXllci11aV9fbGlicmFyeS1tZXNzYWdle3BhZGRpbmc6MTBweCAyMHB4O21heC13aWR0aDoyMDBweH0ubGF5ZXItdWlfX2xpYnJhcnktaXRlbXN7bWF4LWhlaWdodDo1MHZoO292ZXJmbG93OmF1dG99LmxheWVyLXVpX193cmFwcGVyIC5lbmNyeXB0ZWQtaWNvbntwb3NpdGlvbjpyZWxhdGl2ZTttYXJnaW4taW5saW5lLXN0YXJ0OjE1cHg7ZGlzcGxheTpmbGV4O2p1c3RpZnktY29udGVudDpjZW50ZXI7YWxpZ24taXRlbXM6Y2VudGVyO2JvcmRlci1yYWRpdXM6dmFyKC0tc3BhY2UtZmFjdG9yKTtjb2xvcjojMmI4YTNlfS5sYXllci11aV9fd3JhcHBlciAuZW5jcnlwdGVkLWljb24gc3Zne3dpZHRoOjEuMnJlbTtoZWlnaHQ6MS4ycmVtfS5sYXllci11aV9fd3JhcHBlciAuZW5jcnlwdGVkLWljb24udG9vbHRpcCAudG9vbHRpcC10ZXh0e3Zpc2liaWxpdHk6aGlkZGVuO3dpZHRoOjIwcmVtO2JvdHRvbTpjYWxjKDUwJSArIDAuOHJlbSArIDZweCk7YmFja2dyb3VuZC1jb2xvcjojMDAwO2NvbG9yOiNmZmY7dGV4dC1hbGlnbjpjZW50ZXI7Ym9yZGVyLXJhZGl1czo2cHg7cGFkZGluZzo1cHg7cG9zaXRpb246YWJzb2x1dGU7ei1pbmRleDoxMDtmb250LXNpemU6MTNweDtsaW5lLWhlaWdodDoxLjU7d2hpdGUtc3BhY2U6cHJlLXdyYXB9OnJvb3RbZGlyPSJsdHIiXSAubGF5ZXItdWlfX3dyYXBwZXIgLmVuY3J5cHRlZC1pY29uLnRvb2x0aXAgLnRvb2x0aXAtdGV4dHtsZWZ0Oi01cHh9OnJvb3RbZGlyPSJydGwiXSAubGF5ZXItdWlfX3dyYXBwZXIgLmVuY3J5cHRlZC1pY29uLnRvb2x0aXAgLnRvb2x0aXAtdGV4dHtyaWdodDotNXB4fS5sYXllci11aV9fd3JhcHBlciAuZW5jcnlwdGVkLWljb24udG9vbHRpcCAudG9vbHRpcC10ZXh0OjphZnRlcnstLXNpemU6IDZweDtjb250ZW50OiIiO2JvcmRlcjp2YXIoLS1zaXplKSBzb2xpZCB0cmFuc3BhcmVudDtib3JkZXItdG9wLWNvbG9yOiMwMDA7cG9zaXRpb246YWJzb2x1dGU7Ym90dG9tOmNhbGMoLTIgKiB2YXIoLS1zaXplKSl9OnJvb3RbZGlyPSJsdHIiXSAubGF5ZXItdWlfX3dyYXBwZXIgLmVuY3J5cHRlZC1pY29uLnRvb2x0aXAgLnRvb2x0aXAtdGV4dDo6YWZ0ZXJ7bGVmdDpjYWxjKDVweCArIHZhcigtLXNpemUpIC8gMil9OnJvb3RbZGlyPSJydGwiXSAubGF5ZXItdWlfX3dyYXBwZXIgLmVuY3J5cHRlZC1pY29uLnRvb2x0aXAgLnRvb2x0aXAtdGV4dDo6YWZ0ZXJ7cmlnaHQ6Y2FsYyg1cHggKyB2YXIoLS1zaXplKSAvIDIpfWJvZHk6YWN0aXZlIC5sYXllci11aV9fd3JhcHBlciAuZW5jcnlwdGVkLWljb24udG9vbHRpcDpub3QoOmhvdmVyKXtwb2ludGVyLWV2ZW50czpub25lfWJvZHk6bm90KDphY3RpdmUpIC5sYXllci11aV9fd3JhcHBlciAuZW5jcnlwdGVkLWljb24udG9vbHRpcDpob3ZlciAudG9vbHRpcC10ZXh0e3Zpc2liaWxpdHk6dmlzaWJsZX0ubGF5ZXItdWlfX3dyYXBwZXIgLmVuY3J5cHRlZC1pY29uIC50b29sdGlwLXRleHQ6aG92ZXJ7dmlzaWJpbGl0eTp2aXNpYmxlfS5sYXllci11aV9fd3JhcHBlcl9fZ2l0aHViLWNvcm5lcnt0b3A6MDtwb3NpdGlvbjphYnNvbHV0ZTt3aWR0aDo0MHB4fTpyb290W2Rpcj0ibHRyIl0gLmxheWVyLXVpX193cmFwcGVyX19naXRodWItY29ybmVye3JpZ2h0OjB9OnJvb3RbZGlyPSJydGwiXSAubGF5ZXItdWlfX3dyYXBwZXJfX2dpdGh1Yi1jb3JuZXJ7bGVmdDowfS5sYXllci11aV9fd3JhcHBlcl9fZm9vdGVye3Bvc2l0aW9uOmFic29sdXRlO2JvdHRvbTowcHg7d2lkdGg6MTkwcHh9OnJvb3RbZGlyPSJsdHIiXSAubGF5ZXItdWlfX3dyYXBwZXJfX2Zvb3RlcntyaWdodDowfTpyb290W2Rpcj0icnRsIl0gLmxheWVyLXVpX193cmFwcGVyX19mb290ZXJ7bGVmdDowfS5sYXllci11aV9fd3JhcHBlciAuemVuLW1vZGUtdHJhbnNpdGlvbnt0cmFuc2l0aW9uOnRyYW5zZm9ybSAwLjVzIGVhc2UtaW4tb3V0fTpyb290W2Rpcj0ibHRyIl0gLmxheWVyLXVpX193cmFwcGVyIC56ZW4tbW9kZS10cmFuc2l0aW9uLnRyYW5zaXRpb24tbGVmdHt0cmFuc2Zvcm06dHJhbnNsYXRlKC05OTlweCwgMCl9OnJvb3RbZGlyPSJsdHIiXSAubGF5ZXItdWlfX3dyYXBwZXIgLnplbi1tb2RlLXRyYW5zaXRpb24udHJhbnNpdGlvbi1yaWdodHt0cmFuc2Zvcm06dHJhbnNsYXRlKDk5OXB4LCAwcHgpfTpyb290W2Rpcj0icnRsIl0gLmxheWVyLXVpX193cmFwcGVyIC56ZW4tbW9kZS10cmFuc2l0aW9uLnRyYW5zaXRpb24tbGVmdHt0cmFuc2Zvcm06dHJhbnNsYXRlKDk5OXB4LCAwKX06cm9vdFtkaXI9InJ0bCJdIC5sYXllci11aV9fd3JhcHBlciAuemVuLW1vZGUtdHJhbnNpdGlvbi50cmFuc2l0aW9uLXJpZ2h0e3RyYW5zZm9ybTp0cmFuc2xhdGUoLTk5OXB4LCAwKX0ubGF5ZXItdWlfX3dyYXBwZXIgLnplbi1tb2RlLXRyYW5zaXRpb24uQXBwLW1lbnVfYm90dG9tLS10cmFuc2l0aW9uLWxlZnR7dHJhbnNmb3JtOnRyYW5zbGF0ZSgtOTJweCwgMCl9LmxheWVyLXVpX193cmFwcGVyIC5kaXNhYmxlLXplbi1tb2Rle2hlaWdodDozMHB4O3Bvc2l0aW9uOmFic29sdXRlO2JvdHRvbToxMHB4O3JpZ2h0OjE1cHg7Zm9udC1zaXplOjEwcHg7cGFkZGluZzoxMHB4O2ZvbnQtd2VpZ2h0OjUwMDtvcGFjaXR5OjA7dmlzaWJpbGl0eTpoaWRkZW47dHJhbnNpdGlvbjp2aXNpYmlsaXR5IDBzIGxpbmVhciAwcywgb3BhY2l0eSAwLjVzfS5sYXllci11aV9fd3JhcHBlciAuZGlzYWJsZS16ZW4tbW9kZS0tdmlzaWJsZXtvcGFjaXR5OjE7dmlzaWJpbGl0eTp2aXNpYmxlO3RyYW5zaXRpb246dmlzaWJpbGl0eSAwcyBsaW5lYXIgMzAwbXMsIG9wYWNpdHkgMC41czt0cmFuc2l0aW9uLWRlbGF5OjAuOHN9CgoubGlicmFyeS11bml0e2FsaWduLWl0ZW1zOmNlbnRlcjtib3JkZXI6MXB4IHNvbGlkICNjY2M7ZGlzcGxheTpmbGV4O2p1c3RpZnktY29udGVudDpjZW50ZXI7cG9zaXRpb246cmVsYXRpdmU7d2lkdGg6NjNweDtoZWlnaHQ6NjNweH0ubGlicmFyeS11bml0X19kcmFnZ2Vye2Rpc3BsYXk6ZmxleDtoZWlnaHQ6MTAwJTt3aWR0aDoxMDAlfS5saWJyYXJ5LXVuaXRfX2RyYWdnZXI+c3Zne2ZsZXgtZ3JvdzoxO21heC1oZWlnaHQ6MTAwJTttYXgtd2lkdGg6MTAwJX0ubGlicmFyeS11bml0X19yZW1vdmVGcm9tTGlicmFyeSwubGlicmFyeS11bml0X19yZW1vdmVGcm9tTGlicmFyeTpob3ZlciwubGlicmFyeS11bml0X19yZW1vdmVGcm9tTGlicmFyeTphY3RpdmV7YWxpZ24taXRlbXM6Y2VudGVyO2JhY2tncm91bmQ6bm9uZTtib3JkZXI6bm9uZTtkaXNwbGF5OmZsZXg7anVzdGlmeS1jb250ZW50OmNlbnRlcjttYXJnaW46MDtwYWRkaW5nOjA7cG9zaXRpb246YWJzb2x1dGU7cmlnaHQ6NXB4O3RvcDo1cHh9LmxpYnJhcnktdW5pdF9fcmVtb3ZlRnJvbUxpYnJhcnk+c3Zne2hlaWdodDoxNnB4O3dpZHRoOjE2cHh9LmxpYnJhcnktdW5pdF9fcHVsc2V7dHJhbnNmb3JtOnNjYWxlKDEpO2FuaW1hdGlvbjpsaWJyYXJ5LXVuaXRfX3B1bHNlLWFuaW1hdGlvbiAxcyBlYXNlLWluIGluZmluaXRlfS5saWJyYXJ5LXVuaXRfX2FkZGVye3Bvc2l0aW9uOmFic29sdXRlO2xlZnQ6NTAlO3RvcDo1MCU7d2lkdGg6MjBweDtoZWlnaHQ6MjBweDttYXJnaW4tbGVmdDotMTBweDttYXJnaW4tdG9wOi0xMHB4O3BvaW50ZXItZXZlbnRzOm5vbmV9LmxpYnJhcnktdW5pdF9fYWN0aXZle2N1cnNvcjpwb2ludGVyfUBrZXlmcmFtZXMgbGlicmFyeS11bml0X19wdWxzZS1hbmltYXRpb257MCV7dHJhbnNmb3JtOnNjYWxlKDAuOTUpfTUwJXt0cmFuc2Zvcm06c2NhbGUoMSl9MTAwJXt0cmFuc2Zvcm06c2NhbGUoMC45NSl9fQoKQGZvbnQtZmFjZXtmb250LWZhbWlseToiVmlyZ2lsIjtzcmM6dXJsKEZHX1ZpcmdpbC53b2ZmMik7Zm9udC1kaXNwbGF5OnN3YXB9QGZvbnQtZmFjZXtmb250LWZhbWlseToiQ2FzY2FkaWEiO3NyYzp1cmwoQ2FzY2FkaWEud29mZjIpO2ZvbnQtZGlzcGxheTpzd2FwfQoKLnZpc3VhbGx5LWhpZGRlbntwb3NpdGlvbjphYnNvbHV0ZSAhaW1wb3J0YW50O2hlaWdodDoxcHg7d2lkdGg6MXB4O292ZXJmbG93OmhpZGRlbjtjbGlwOnJlY3QoMXB4LCAxcHgsIDFweCwgMXB4KTt3aGl0ZS1zcGFjZTpub3dyYXB9LkxvYWRpbmdNZXNzYWdle3Bvc2l0aW9uOmFic29sdXRlO3RvcDowO3JpZ2h0OjA7Ym90dG9tOjA7bGVmdDowO3otaW5kZXg6OTk5O2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcjtwb2ludGVyLWV2ZW50czpub25lfS5Mb2FkaW5nTWVzc2FnZSBzcGFue2JhY2tncm91bmQtY29sb3I6cmdiYSgyNTUsMjU1LDI1NSwwLjgpO2JvcmRlci1yYWRpdXM6NXB4O3BhZGRpbmc6MC44ZW0gMS4yZW07Zm9udC1zaXplOjEuM2VtfQoKOnJvb3R7LS10ZXh0LWNvbG9yLXByaW1hcnk6ICMzNDNhNDA7LS1iZy1jb2xvci1tYWluOiAjZmZmOy0tc2hhZG93LWlzbGFuZDogMCAxcHggNXB4IHJnYmEoMCwgMCwgMCwgMC4xNSk7LS1iZy1jb2xvci1pc2xhbmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC45KTstLWJvcmRlci1yYWRpdXMtbTogNHB4Oy0tc3BhY2UtZmFjdG9yOiAwLjI1cmVtfTpyb290ey0tc2F0OiBlbnYoc2FmZS1hcmVhLWluc2V0LXRvcCk7LS1zYWI6IGVudihzYWZlLWFyZWEtaW5zZXQtYm90dG9tKTstLXNhbDogZW52KHNhZmUtYXJlYS1pbnNldC1sZWZ0KTstLXNhcjogZW52KHNhZmUtYXJlYS1pbnNldC1yaWdodCk7LS10ZXh0LWNvbG9yLXByaW1hcnk6ICMzNDNhNDA7LS1iZy1jb2xvci1tYWluOiAjZmZmOy0tc2hhZG93LWlzbGFuZDogMCAxcHggNXB4IHJnYmEoMCwwLDAsMC4xNSk7LS1ib3JkZXItcmFkaXVzLW06IDRweDstLXNwYWNlLWZhY3RvcjogMC4yNXJlbX0uZXhjYWxpZHJhd3tkaXNwbGF5OmZsZXg7cG9zaXRpb246Zml4ZWQ7dG9wOjA7Ym90dG9tOjA7bGVmdDowO3JpZ2h0OjB9LmV4Y2FsaWRyYXcgW2NvbnRlbnRlZGl0YWJsZV17dXNlci1zZWxlY3Q6YXV0bztjdXJzb3I6dGV4dH0uZXhjYWxpZHJhdyBjYW52YXN7dG91Y2gtYWN0aW9uOm5vbmU7dXNlci1zZWxlY3Q6bm9uZTtpbWFnZS1yZW5kZXJpbmc6cGl4ZWxhdGVkO2ltYWdlLXJlbmRlcmluZzotbW96LWNyaXNwLWVkZ2VzfS5leGNhbGlkcmF3IC5GaXhlZFNpZGVDb250YWluZXJ7cGFkZGluZy10b3A6dmFyKC0tc2F0LCAwcHgpO3BhZGRpbmctcmlnaHQ6dmFyKC0tc2FyLCAwcHgpO3BhZGRpbmctYm90dG9tOnZhcigtLXNhYiwgMHB4KTtwYWRkaW5nLWxlZnQ6dmFyKC0tc2FsLCAwcHgpfS5leGNhbGlkcmF3IC5wYW5lbFJvd3tkaXNwbGF5OmZsZXg7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW59LmV4Y2FsaWRyYXcgLnBhbmVsQ29sdW1ue2Rpc3BsYXk6ZmxleDtmbGV4LWRpcmVjdGlvbjpjb2x1bW59LmV4Y2FsaWRyYXcgLnBhbmVsQ29sdW1uIGgzLC5leGNhbGlkcmF3IC5wYW5lbENvbHVtbiBsZWdlbmQsLmV4Y2FsaWRyYXcgLnBhbmVsQ29sdW1uIC5jb250cm9sLWxhYmVse21hcmdpbi10b3A6MC4zMzNyZW07bWFyZ2luLWJvdHRvbTowLjMzM3JlbTtmb250LXNpemU6MC43NXJlbTtjb2xvcjp2YXIoLS10ZXh0LWNvbG9yLXByaW1hcnkpO2ZvbnQtd2VpZ2h0OmJvbGQ7ZGlzcGxheTpibG9ja30uZXhjYWxpZHJhdyAucGFuZWxDb2x1bW4gLmNvbnRyb2wtbGFiZWwgaW5wdXR7ZGlzcGxheTpibG9jazt3aWR0aDoxMDAlfS5leGNhbGlkcmF3IC5wYW5lbENvbHVtbiBoMzpmaXJzdC1jaGlsZCwuZXhjYWxpZHJhdyAucGFuZWxDb2x1bW4gbGVnZW5kOmZpcnN0LWNoaWxkLC5leGNhbGlkcmF3IC5wYW5lbENvbHVtbiAuY29udHJvbC1sYWJlbDpmaXJzdC1jaGlsZHttYXJnaW4tdG9wOjB9LmV4Y2FsaWRyYXcgLnBhbmVsQ29sdW1uIGxlZ2VuZHtwYWRkaW5nOjB9LmV4Y2FsaWRyYXcgLnBhbmVsQ29sdW1uIC5idXR0b25MaXN0e2ZsZXgtd3JhcDp3cmFwfS5leGNhbGlkcmF3IC5wYW5lbENvbHVtbiAuYnV0dG9uTGlzdCBsYWJlbHttYXJnaW4tcmlnaHQ6MC4yNXJlbTtmb250LXNpemU6MC43NXJlbTtkaXNwbGF5OmlubGluZS1ibG9ja30uZXhjYWxpZHJhdyAucGFuZWxDb2x1bW4gLmJ1dHRvbkxpc3QgaW5wdXRbdHlwZT0icmFkaW8iXXtvcGFjaXR5OjA7cG9zaXRpb246YWJzb2x1dGU7cG9pbnRlci1ldmVudHM6bm9uZX0uZXhjYWxpZHJhdyAucGFuZWxDb2x1bW4gLmJ1dHRvbkxpc3QgLlRvb2xJY29ue21hcmdpbjowIDVweH0uZXhjYWxpZHJhdyAucGFuZWxDb2x1bW4gLmJ1dHRvbkxpc3QgLlRvb2xJY29uX19pY29ue3dpZHRoOjI4cHg7aGVpZ2h0OjI4cHh9LmV4Y2FsaWRyYXcgLnBhbmVsQ29sdW1uIGZpZWxkc2V0e21hcmdpbjowO21hcmdpbi10b3A6MC4zMzNyZW07cGFkZGluZzowO2JvcmRlcjpub25lfS5leGNhbGlkcmF3IC5kaXZpZGVye3dpZHRoOjFweDtiYWNrZ3JvdW5kLWNvbG9yOiNlOWVjZWY7bWFyZ2luOjFweH0uZXhjYWxpZHJhdyAuYnV0dG9uTGlzdCBsYWJlbDpmb2N1cy13aXRoaW4sLmV4Y2FsaWRyYXcgaW5wdXQ6Zm9jdXN7b3V0bGluZTp0cmFuc3BhcmVudDtib3gtc2hhZG93OjAgMCAwIDJweCAjYTVkOGZmfS5leGNhbGlkcmF3IC5hY3RpdmUsLmV4Y2FsaWRyYXcgLmJ1dHRvbkxpc3QgbGFiZWwuYWN0aXZle2JhY2tncm91bmQtY29sb3I6I2NlZDRkYX0uZXhjYWxpZHJhdyAuYWN0aXZlOmhvdmVyLC5leGNhbGlkcmF3IC5idXR0b25MaXN0IGxhYmVsLmFjdGl2ZTpob3ZlcntiYWNrZ3JvdW5kLWNvbG9yOiNjZWQ0ZGF9LmV4Y2FsaWRyYXcgLmFjdGl2ZTphY3RpdmUsLmV4Y2FsaWRyYXcgLmJ1dHRvbkxpc3QgbGFiZWwuYWN0aXZlOmFjdGl2ZXtiYWNrZ3JvdW5kLWNvbG9yOiNhZGI1YmR9LmV4Y2FsaWRyYXcgLkFwcC1ib3R0b20tYmFye3Bvc2l0aW9uOmFic29sdXRlO3RvcDowO2JvdHRvbTowO2xlZnQ6MDtyaWdodDowOy0tYmFyLXBhZGRpbmc6IGNhbGMoNCAqIHZhcigtLXNwYWNlLWZhY3RvcikpO3BhZGRpbmctdG9wOm1heCh2YXIoLS1iYXItcGFkZGluZyksIHZhcigtLXNhdCwgMHB4KSk7cGFkZGluZy1yaWdodDp2YXIoLS1zYXIsIDBweCk7cGFkZGluZy1ib3R0b206dmFyKC0tc2FiLCAwcHgpO3BhZGRpbmctbGVmdDp2YXIoLS1zYWwsIDBweCk7ei1pbmRleDo0O2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpmbGV4LWVuZDtwb2ludGVyLWV2ZW50czpub25lfS5leGNhbGlkcmF3IC5BcHAtYm90dG9tLWJhcj4uSXNsYW5ke3dpZHRoOjEwMCU7bWF4LXdpZHRoOjEwMCU7bWluLXdpZHRoOjEwMCU7Ym94LXNpemluZzpib3JkZXItYm94O21heC1oZWlnaHQ6MTAwJTtkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246Y29sdW1uO3BvaW50ZXItZXZlbnRzOmluaXRpYWx9LmV4Y2FsaWRyYXcgLkFwcC10b29sYmFye3dpZHRoOjEwMCU7Ym94LXNpemluZzpib3JkZXItYm94fS5leGNhbGlkcmF3IC5BcHAtdG9vbGJhci1jb250ZW50e2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW59LmV4Y2FsaWRyYXcgLkFwcC1tb2JpbGUtbWVudXt3aWR0aDoxMDAlO292ZXJmbG93LXg6dmlzaWJsZTtvdmVyZmxvdy15OmF1dG87Ym94LXNpemluZzpib3JkZXItYm94O21hcmdpbi1ib3R0b206dmFyKC0tYmFyLXBhZGRpbmcpfS5leGNhbGlkcmF3IC5BcHAtbWVudXtkaXNwbGF5OmdyaWR9LmV4Y2FsaWRyYXcgLkFwcC1tZW51X3RvcHtncmlkLXRlbXBsYXRlLWNvbHVtbnM6MWZyIGF1dG8gMWZyO2dyaWQtZ2FwOjRweDthbGlnbi1pdGVtczpmbGV4LXN0YXJ0O2N1cnNvcjpkZWZhdWx0O3BvaW50ZXItZXZlbnRzOm5vbmUgIWltcG9ydGFudH0uZXhjYWxpZHJhdyAuQXBwLW1lbnVfdG9wPip7cG9pbnRlci1ldmVudHM6YWxsfS5leGNhbGlkcmF3IC5BcHAtbWVudV90b3A+KjpmaXJzdC1jaGlsZHtqdXN0aWZ5LXNlbGY6ZmxleC1zdGFydH0uZXhjYWxpZHJhdyAuQXBwLW1lbnVfdG9wPio6bGFzdC1jaGlsZHtqdXN0aWZ5LXNlbGY6ZmxleC1lbmR9LmV4Y2FsaWRyYXcgLkFwcC1tZW51X2JvdHRvbXtwb3NpdGlvbjphYnNvbHV0ZTtib3R0b206MDtncmlkLXRlbXBsYXRlLWNvbHVtbnM6MWZyIGF1dG8gMWZyO2dyaWQtZ2FwOjRweDthbGlnbi1pdGVtczpmbGV4LXN0YXJ0O2N1cnNvcjpkZWZhdWx0O3BvaW50ZXItZXZlbnRzOm5vbmUgIWltcG9ydGFudDtsZWZ0OjAuMjVyZW19LmV4Y2FsaWRyYXcgLkFwcC1tZW51X2JvdHRvbS0tdHJhbnNpdGlvbi1sZWZ0IHNlY3Rpb257d2lkdGg6MTg1cHh9LmV4Y2FsaWRyYXcgLkFwcC1tZW51X2JvdHRvbSBzZWN0aW9ue2Rpc3BsYXk6ZmxleH0uZXhjYWxpZHJhdyAuQXBwLW1lbnVfYm90dG9tPip7cG9pbnRlci1ldmVudHM6YWxsfS5leGNhbGlkcmF3IC5BcHAtbWVudV9ib3R0b20+KjpmaXJzdC1jaGlsZHtqdXN0aWZ5LXNlbGY6ZmxleC1zdGFydH0uZXhjYWxpZHJhdyAuQXBwLW1lbnVfYm90dG9tPio6bGFzdC1jaGlsZHtqdXN0aWZ5LXNlbGY6ZmxleC1lbmR9LmV4Y2FsaWRyYXcgLkFwcC1tZW51X2xlZnR7Z3JpZC10ZW1wbGF0ZS1yb3dzOjFmciBhdXRvIDFmcjtoZWlnaHQ6MTAwJX0uZXhjYWxpZHJhdyAuQXBwLW1lbnVfcmlnaHR7Z3JpZC10ZW1wbGF0ZS1yb3dzOjFmcjtoZWlnaHQ6MTAwJX0uZXhjYWxpZHJhdyAuQXBwLW1lbnVfX2xlZnR7b3ZlcmZsb3cteTphdXRvO21heC1oZWlnaHQ6Y2FsYygxMDB2aCAtIDIzNnB4KX0uZXhjYWxpZHJhdyAuRXJyb3JTcGxhc2h7bWluLWhlaWdodDoxMDB2aDtwYWRkaW5nOjIwcHggMDtvdmVyZmxvdzphdXRvO2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcjt1c2VyLXNlbGVjdDp0ZXh0fS5leGNhbGlkcmF3IC5FcnJvclNwbGFzaCAuRXJyb3JTcGxhc2gtbWVzc2FnZUNvbnRhaW5lcntkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246Y29sdW1uO2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO3BhZGRpbmc6NDBweDtiYWNrZ3JvdW5kLWNvbG9yOiNmZmUzZTM7Ym9yZGVyOjNweCBzb2xpZCAjYzkyYTJhfS5leGNhbGlkcmF3IC5FcnJvclNwbGFzaCAuRXJyb3JTcGxhc2gtcGFyYWdyYXBoe21hcmdpbjoxNXB4IDA7bWF4LXdpZHRoOjYwMHB4fS5leGNhbGlkcmF3IC5FcnJvclNwbGFzaCAuRXJyb3JTcGxhc2gtcGFyYWdyYXBoLmFsaWduLWNlbnRlcnt0ZXh0LWFsaWduOmNlbnRlcn0uZXhjYWxpZHJhdyAuRXJyb3JTcGxhc2ggLmJpZ2dlciwuZXhjYWxpZHJhdyAuRXJyb3JTcGxhc2ggLmJpZ2dlciBidXR0b257Zm9udC1zaXplOjEuMWVtfS5leGNhbGlkcmF3IC5FcnJvclNwbGFzaCAuc21hbGxlciwuZXhjYWxpZHJhdyAuRXJyb3JTcGxhc2ggLnNtYWxsZXIgYnV0dG9ue2ZvbnQtc2l6ZTowLjllbX0uZXhjYWxpZHJhdyAuRXJyb3JTcGxhc2ggLkVycm9yU3BsYXNoLWRldGFpbHN7ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOmNvbHVtbjthbGlnbi1pdGVtczpmbGV4LXN0YXJ0fS5leGNhbGlkcmF3IC5FcnJvclNwbGFzaCAuRXJyb3JTcGxhc2gtZGV0YWlscyB0ZXh0YXJlYXt3aWR0aDoxMDAlO21hcmdpbjoxMHB4IDA7Zm9udC1mYW1pbHk6IkNhc2NhZGlhIjtmb250LXNpemU6MC44ZW19LmV4Y2FsaWRyYXcgLmRyb3Bkb3duLXNlbGVjdHtoZWlnaHQ6MS41cmVtO3BhZGRpbmc6MDtwYWRkaW5nLWlubGluZS1zdGFydDowLjVyZW07cGFkZGluZy1pbmxpbmUtZW5kOjEuNXJlbTtiYWNrZ3JvdW5kLWNvbG9yOiNlOWVjZWY7Ym9yZGVyLXJhZGl1czp2YXIoLS1zcGFjZS1mYWN0b3IpO2JvcmRlcjoxcHggc29saWQgI2NlZDRkYTtmb250LXNpemU6MC44cmVtO291dGxpbmU6bm9uZTthcHBlYXJhbmNlOm5vbmU7YmFja2dyb3VuZC1pbWFnZTp1cmwoImh0dHBzOi8vZnJlZS11c2UuczMtdXMtd2VzdC0yLmFtYXpvbmF3cy5jb20vdXAtc29ydC5zdmciKTtiYWNrZ3JvdW5kLXJlcGVhdDpuby1yZXBlYXQ7YmFja2dyb3VuZC1wb3NpdGlvbjpyaWdodCAwLjdyZW0gdG9wIDUwJSwgMCAwO2JhY2tncm91bmQtc2l6ZTowLjY1ZW0gYXV0bywgMTAwJX06cm9vdFtkaXI9InJ0bCJdIC5leGNhbGlkcmF3IC5kcm9wZG93bi1zZWxlY3R7YmFja2dyb3VuZC1wb3NpdGlvbjpsZWZ0IDAuN3JlbSB0b3AgNTAlLCAwIDB9LmV4Y2FsaWRyYXcgLmRyb3Bkb3duLXNlbGVjdDpmb2N1c3tib3gtc2hhZG93OjAgMCAwIDJweCAjYTVkOGZmfS5leGNhbGlkcmF3IC5kcm9wZG93bi1zZWxlY3Q6aG92ZXJ7YmFja2dyb3VuZC1jb2xvcjojY2VkNGRhfS5leGNhbGlkcmF3IC5kcm9wZG93bi1zZWxlY3Q6YWN0aXZle2JhY2tncm91bmQtY29sb3I6I2NlZDRkYX0uZXhjYWxpZHJhdyAuZHJvcGRvd24tc2VsZWN0LmRyb3Bkb3duLXNlbGVjdC0tZmxvYXRpbmd7cG9zaXRpb246YWJzb2x1dGU7bWFyZ2luOjAuNWVtfS5leGNhbGlkcmF3IC5kcm9wZG93bi1zZWxlY3RfX2xhbmd1YWdlLmRyb3Bkb3duLXNlbGVjdC0tZmxvYXRpbmd7cG9zaXRpb246YWJzb2x1dGU7Ym90dG9tOjEwcHh9OnJvb3RbZGlyPSJsdHIiXSAuZXhjYWxpZHJhdyAuZHJvcGRvd24tc2VsZWN0X19sYW5ndWFnZS5kcm9wZG93bi1zZWxlY3QtLWZsb2F0aW5ne3JpZ2h0OjQ0cHh9OnJvb3RbZGlyPSJydGwiXSAuZXhjYWxpZHJhdyAuZHJvcGRvd24tc2VsZWN0X19sYW5ndWFnZS5kcm9wZG93bi1zZWxlY3QtLWZsb2F0aW5ne2xlZnQ6NDRweH0uZXhjYWxpZHJhdyAuekluZGV4QnV0dG9ue21hcmdpbjowIDVweDtwYWRkaW5nOjVweDtkaXNwbGF5OmlubGluZS1mbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyfS5leGNhbGlkcmF3IC56SW5kZXhCdXR0b24gc3Zne3dpZHRoOjE4cHg7aGVpZ2h0OjE4cHh9LmV4Y2FsaWRyYXcgLnNjcm9sbC1iYWNrLXRvLWNvbnRlbnR7cG9zaXRpb246Zml4ZWQ7bGVmdDo1MCU7Ym90dG9tOjMwcHg7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTUwJSk7cGFkZGluZzoxMHB4IDIwcHh9LmV4Y2FsaWRyYXcgLmhlbHAtaWNvbntwb3NpdGlvbjphYnNvbHV0ZTtjdXJzb3I6cG9pbnRlcjtmaWxsOiM4NjhlOTY7Ym90dG9tOjE0cHh9OnJvb3RbZGlyPSJsdHIiXSAuZXhjYWxpZHJhdyAuaGVscC1pY29ue3JpZ2h0OjE0cHh9OnJvb3RbZGlyPSJydGwiXSAuZXhjYWxpZHJhdyAuaGVscC1pY29ue2xlZnQ6MTRweH1AbWVkaWEgKG1heC13aWR0aDogNjAwcHgpLCAobWF4LWhlaWdodDogNTAwcHgpIGFuZCAobWF4LXdpZHRoOiAxMDAwcHgpey5leGNhbGlkcmF3IGFzaWRle2Rpc3BsYXk6bm9uZX0uZXhjYWxpZHJhdyAuc2Nyb2xsLWJhY2stdG8tY29udGVudHtib3R0b206Y2FsYyg4MHB4ICsgdmFyKC0tc2FiLCAwcHgpKTt6LWluZGV4Oi0xfX06cm9vdFtkaXI9InJ0bCJdIC5leGNhbGlkcmF3IC5ydGwtbWlycm9ye3RyYW5zZm9ybTpzY2FsZVgoLTEpfS5leGNhbGlkcmF3IC5naXRodWItY29ybmVye3Bvc2l0aW9uOmFic29sdXRlO3RvcDowO3otaW5kZXg6Mn06cm9vdFtkaXI9Imx0ciJdIC5leGNhbGlkcmF3IC5naXRodWItY29ybmVye3JpZ2h0OjB9OnJvb3RbZGlyPSJydGwiXSAuZXhjYWxpZHJhdyAuZ2l0aHViLWNvcm5lcntsZWZ0OjB9LmV4Y2FsaWRyYXcgLnplbi1tb2RlLXZpc2liaWxpdHl7dmlzaWJpbGl0eTp2aXNpYmxlO29wYWNpdHk6MTtoZWlnaHQ6YXV0bzt3aWR0aDphdXRvO3RyYW5zaXRpb246b3BhY2l0eSAwLjVzfS5leGNhbGlkcmF3IC56ZW4tbW9kZS12aXNpYmlsaXR5Lnplbi1tb2RlLXZpc2liaWxpdHktLWhpZGRlbnt2aXNpYmlsaXR5OmhpZGRlbjtvcGFjaXR5OjA7aGVpZ2h0OjA7d2lkdGg6MDt0cmFuc2l0aW9uOm9wYWNpdHkgMC41c30uZXhjYWxpZHJhdyAuZGlzYWJsZS1wb2ludGVyRXZlbnRze3BvaW50ZXItZXZlbnRzOm5vbmUgIWltcG9ydGFudH0uZXhjYWxpZHJhdyBhLC5Nb2RhbCBhe2ZvbnQtd2VpZ2h0OjUwMDt0ZXh0LWRlY29yYXRpb246bm9uZTtjb2xvcjojMWM3ZWQ2fS5leGNhbGlkcmF3IGE6aG92ZXIsLk1vZGFsIGE6aG92ZXJ7dGV4dC1kZWNvcmF0aW9uOnVuZGVybGluZX0uZXhjYWxpZHJhdyBidXR0b24sLmV4Y2FsaWRyYXcgLmJ1dHRvbkxpc3QgbGFiZWwsLk1vZGFsIGJ1dHRvbiwuTW9kYWwgLmJ1dHRvbkxpc3QgbGFiZWx7dXNlci1zZWxlY3Q6bm9uZTtiYWNrZ3JvdW5kLWNvbG9yOiNlOWVjZWY7Ym9yZGVyOjA7Ym9yZGVyLXJhZGl1czo0cHg7bWFyZ2luOjAuMTI1cmVtIDA7cGFkZGluZzowLjI1cmVtO3doaXRlLXNwYWNlOm5vd3JhcDtjdXJzb3I6cG9pbnRlcn0uZXhjYWxpZHJhdyBidXR0b246Zm9jdXMsLmV4Y2FsaWRyYXcgLmJ1dHRvbkxpc3QgbGFiZWw6Zm9jdXMsLk1vZGFsIGJ1dHRvbjpmb2N1cywuTW9kYWwgLmJ1dHRvbkxpc3QgbGFiZWw6Zm9jdXN7b3V0bGluZTp0cmFuc3BhcmVudDtib3gtc2hhZG93OjAgMCAwIDJweCAjYTVkOGZmfS5leGNhbGlkcmF3IGJ1dHRvbjpob3ZlciwuZXhjYWxpZHJhdyAuYnV0dG9uTGlzdCBsYWJlbDpob3ZlciwuTW9kYWwgYnV0dG9uOmhvdmVyLC5Nb2RhbCAuYnV0dG9uTGlzdCBsYWJlbDpob3ZlcntiYWNrZ3JvdW5kLWNvbG9yOiNjZWQ0ZGF9LmV4Y2FsaWRyYXcgYnV0dG9uOmFjdGl2ZSwuZXhjYWxpZHJhdyAuYnV0dG9uTGlzdCBsYWJlbDphY3RpdmUsLk1vZGFsIGJ1dHRvbjphY3RpdmUsLk1vZGFsIC5idXR0b25MaXN0IGxhYmVsOmFjdGl2ZXtiYWNrZ3JvdW5kLWNvbG9yOiNhZGI1YmR9LmV4Y2FsaWRyYXcgYnV0dG9uOmRpc2FibGVkLC5leGNhbGlkcmF3IC5idXR0b25MaXN0IGxhYmVsOmRpc2FibGVkLC5Nb2RhbCBidXR0b246ZGlzYWJsZWQsLk1vZGFsIC5idXR0b25MaXN0IGxhYmVsOmRpc2FibGVke2N1cnNvcjpub3QtYWxsb3dlZH1AbWVkaWEgcHJpbnR7LkFwcC1ib3R0b20tYmFyLC5GaXhlZFNpZGVDb250YWluZXIsLmxheWVyLXVpX193cmFwcGVye2Rpc3BsYXk6bm9uZX19Cgo=",mtime:1744325324273}},imports:["https://get.silverbullet.md/global.plug.json"],functions:{excalidrawWidget:{path:"./excalidraw.ts:widget",codeWidget:"excalidraw"},ExcalidrawViewer:{path:"./excalidraw.ts:viewer",editor:["excalidraw"]}}},NI={manifest:u,functionMapping:h};Y(h,u,self.postMessage);export{NI as plug};
